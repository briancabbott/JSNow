From parrt at cs.usfca.edu  Wed Nov  1 09:09:03 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 1 Nov 2006 09:09:03 -0800
Subject: [stringtemplate-interest] nulls & templates...
In-Reply-To: <2E909902FD3A03419E3A905908AE3DD402862EF5@UKNSM201.emea.corp.eds.com>
References: <2E909902FD3A03419E3A905908AE3DD402862EF5@UKNSM201.emea.corp.eds.com>
Message-ID: <CB7359B1-AF1B-4643-ABC3-DA696D6C58E0@cs.usfca.edu>


On Oct 31, 2006, at 11:42 PM, Hill, Robert wrote:

> How cool _is_ it? I'll tell you.. Damn cool ;)

:)  Yeah, very consistent... it comes from being a language and  
grammar guy. many of the languages I look at are really bizarre and,  
while they become popular, it annoys me that someone with more  
training didn't write the grammar ;)

> Oh yeh, that's right, gang up on me all at once ;)

heh heh heh ;)

Ter

From markcooke666 at yahoo.co.uk  Wed Nov  8 09:23:24 2006
From: markcooke666 at yahoo.co.uk (Mark Cooke)
Date: Wed, 8 Nov 2006 17:23:24 +0000 (GMT)
Subject: [stringtemplate-interest] Dynamic attribute reference?
Message-ID: <20061108172324.1718.qmail@web27907.mail.ukl.yahoo.com>

Hi,
I've not found a way to get this to work...

I have a "model" in a code generator which is
basically a database table of strings (ID, lang1Text,
..., langNText) which I want to generate separate java
.properties files from.

What I ideally want to do is have a template which can
be used for every language, and just repeatedly apply
it, changing the language each time.
I can't seem to find a way of doing this with
stringTemplate.
(I Think I'm basically asking - can I doubly nest
attribute references for property refs - i.e.
String.<<language>Text> where if language was
"English" String.getEnglishText() would be called?

Note: I'm looking at different "engines" comparing
usability, ease of writing, running templates for
re-writing a code generator which uses horrible string
concatenation...
...So please don't respond with RTFM!

TIA,
  Mark.

Send instant messages to your online friends http://uk.messenger.yahoo.com 

From parrt at cs.usfca.edu  Wed Nov  8 09:37:25 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 8 Nov 2006 09:37:25 -0800
Subject: [stringtemplate-interest] Dynamic attribute reference?
In-Reply-To: <20061108172324.1718.qmail@web27907.mail.ukl.yahoo.com>
References: <20061108172324.1718.qmail@web27907.mail.ukl.yahoo.com>
Message-ID: <D29DE0B8-3DF8-4C45-B2CA-1109A05E48A5@cs.usfca.edu>


On Nov 8, 2006, at 9:23 AM, Mark Cooke wrote:

> Hi,
> I've not found a way to get this to work...
>
> I have a "model" in a code generator which is
> basically a database table of strings (ID, lang1Text,
> ..., langNText) which I want to generate separate java
> .properties files from.
>
> What I ideally want to do is have a template which can
> be used for every language, and just repeatedly apply
> it, changing the language each time.
> I can't seem to find a way of doing this with
> stringTemplate.
> (I Think I'm basically asking - can I doubly nest
> attribute references for property refs - i.e.
> String.<<language>Text> where if language was
> "English" String.getEnglishText() would be called?

Hi Mark.  Sure you can.  Use <(attr)()> to instantiate the template  
whose name is stored in attr rather than creating an attr template  
like <attr()> does.  Will that help?  You can also do <aMap. 
(keyNameInAttr)> to get the value for a key name stored in an  
attribute. :)

Also try <x.(language+"Text")>, etc...  Ain't that cool?

> Note: I'm looking at different "engines" comparing
> usability, ease of writing, running templates for
> re-writing a code generator which uses horrible string
> concatenation...

Yes, that is the pain.  ST is the answer.  I guarantee that the ANTLR  
v3 code generator is extremely complicated and that all backends are  
completely encapsulated in templates with no model-based computation  
nor is there a single char literal from the model that is emitted.

Ter


From caleb.lyness at ezswitch.net  Wed Nov  8 12:46:33 2006
From: caleb.lyness at ezswitch.net (Caleb Lyness)
Date: Wed, 08 Nov 2006 21:46:33 +0100
Subject: [stringtemplate-interest] Attribute not found exception? Revisited
Message-ID: <45524229.8020401@ezswitch.net>

Ahoy!

With ref to the following thread:
http://www.antlr.org:8080/pipermail/stringtemplate-interest/2006-March/000291.html

* I am looking for a way to ask a template what attributes it is
using/wanting.
So far I have overloaded a Map class which records which keys are requested.
I pass this in as the attributes list. At the end of a template gen I
know what was
requested and what was not.

*Q:* Can I do this with out actually rendering, (via toString())... i.e.
is there another way?

* Sometimes its useful to know (say for testing) that a "required"
string is missing. What is
required and what is not is quite specific to the template. Here is how
I do it for the HTML
I am generating:

$if (checkAttributes)$
<!--
$reqAttr;null=missingAttribute("reqAttr")$
$serviceCode;null=missingAttribute("serviceCode")$
-->
$endif$

If the checkAttributes attribute is true/specified the html comment is
"rendered". If the
value is "required" by this template then it is listed in this comment.
When the comment
is rendered either the value is rendered or if the attribute is missing
it spits out a string
which can be easily found including the name of the missing attribute.

The template shown is defined in a group file as:

missingAttribute(attributeName) ::= "TEST:FAIL - Missing attribute:
\$$attributeName$\$"

The output will look something like this:

   <p>       
  
   <!--
   TEST:FAIL - Missing attribute: $reqAttr$
   1
   -->
   You have recei

The unit tests can then search for these failure messages and make the
test fall over. The comments prevent
the test stuff from breaking the final output... :-)

For maps you can use a default to generate a string which can be caught
in the test too. Its a pity
the key of the map is not treated as an attribute. That would make this
possible:

amap ::= [
  "2":     "value 2",
  "5":     "Other",
  default: "Unknown reason: $key$"
]

With this you could generate the fail message AND report the failing
value....
Perhaps someone else can think of a way to solve this one...

Cheers
     Caleb

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061108/d5affb15/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3269 bytes
Desc: S/MIME Cryptographic Signature
Url : http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061108/d5affb15/attachment.bin 

From kroepke at classdump.org  Thu Nov  9 03:27:08 2006
From: kroepke at classdump.org (Kay Roepke)
Date: Thu, 9 Nov 2006 12:27:08 +0100
Subject: [stringtemplate-interest] moved bugs from wiki to jira bugtracker
Message-ID: <06D96B0B-E61E-42A0-9916-4FF971BE9149@classdump.org>

Hi people!

I have moved the open bugs/issues from the wiki to our JIRA bug  
tracker and added comments on the wiki
pages to the new locations.

In future please also look at the bug database for possible issues:
http://www.antlr.org:8888/browse/ST

cheers,

-k



From markcooke666 at yahoo.co.uk  Thu Nov  9 05:32:59 2006
From: markcooke666 at yahoo.co.uk (Mark Cooke)
Date: Thu, 9 Nov 2006 13:32:59 +0000 (GMT)
Subject: [stringtemplate-interest] Dynamic attribute reference?
Message-ID: <20061109133259.61376.qmail@web27901.mail.ukl.yahoo.com>

In my reply to Terence's response, I accidentally
replied soley to him, so for the benefit of the
list...
> Speedy response! Thanks!
> I thought I was doing something wrong.
> I like (and have just tried) the (language+"Text")
> method, but I get a parse exception;
> problem parsing template 'properties'
> line 1:64: expecting '}', found '<EOF>'
>
> My template group (.stg file) is just this:
> group strings;
>
> properties(Strings, language) ::= "<Strings: {
String
> | <String.UniqueStringId>=<String.(language+"Text")>
> <\n>}>"
>
> Have I gotten the wrong end of the stick here? What
am
> I doing wrong?

The nested "Text" pisses it off.  Try <<...>> as the
outer template  
"string" :)

Ter


Send instant messages to your online friends http://uk.messenger.yahoo.com 

From jjsnyders at rcn.com  Thu Nov  9 07:41:17 2006
From: jjsnyders at rcn.com (John Snyders)
Date: Thu, 9 Nov 2006 10:41:17 -0500
Subject: [stringtemplate-interest] Attribute not found exception?
	Revisited
In-Reply-To: <45524229.8020401@ezswitch.net>
Message-ID: <PMEOJKDLMMHOHNEAMPBGGECHCAAA.jjsnyders@rcn.com>


  -----Original Message-----
  From: stringtemplate-interest-bounces at antlr.org
[mailto:stringtemplate-interest-bounces at antlr.org]On Behalf Of Caleb Lyness
  Sent: Wednesday, November 08, 2006 3:47 PM
  To: StringTemplate
  Subject: [stringtemplate-interest] Attribute not found exception?
Revisited


  Ahoy!

  With ref to the following thread:

http://www.antlr.org:8080/pipermail/stringtemplate-interest/2006-March/00029
1.html

  * I am looking for a way to ask a template what attributes it is
using/wanting.
  [John Snyders] This is interesting and seems to imply that the template
(view) is in charge of defining the set of attributes. I usually think of
the model/controler as being the one that defines the set of attributes
available to the view. Perhaps a minor distinction since they both have to
work together.  Are you asking this question to determine if the model is
generating stuff that the view does need? Like a good Java IDE will tell you
when you have unused variables.
  So far I have overloaded a Map class which records which keys are
requested.
  I pass this in as the attributes list. At the end of a template gen I know
what was
  requested and what was not.
  [John Snyders] Nice solution but how does it handle conditional logic in
the template? Also this would force a particular data model. Specifically
all access would need to go throught the map or something that looked like a
map. How could you tell that a scalar attribute ($foo$) was used?

  Q: Can I do this with out actually rendering, (via toString())... i.e. is
there another way?
  [John Snyders] In theory the parsed template should know about all the
attribute references. An alternate tree walk could report on all possible
attribute references. What it wouldn't know is if the references was to a
map key, property, field etc.

  * Sometimes its useful to know (say for testing) that a "required" string
is missing. What is
  required and what is not is quite specific to the template. Here is how I
do it for the HTML
  I am generating:
  [John Snyders] This is a seperate problem right? This is the case I think
is more interesting and important. The model/controler defines what
attributes will be available under what conditions. This contract should be
unit testable.  Using a template to do this as you describe is a nice way to
unit test the contract without having to instrument the model/controler.
Your example has instrumented the actual template. I think it would be
better to somehow substitute a special unit test template. It should check
more than just what is required but what is expected for a given request.
Has anyone created extensions to JUnit to do this?

  $if (checkAttributes)$
  <!--
  $reqAttr;null=missingAttribute("reqAttr")$
  $serviceCode;null=missingAttribute("serviceCode")$
  -->
  $endif$

  If the checkAttributes attribute is true/specified the html comment is
"rendered". If the
  value is "required" by this template then it is listed in this comment.
When the comment
  is rendered either the value is rendered or if the attribute is missing it
spits out a string
  which can be easily found including the name of the missing attribute.

  The template shown is defined in a group file as:

  missingAttribute(attributeName) ::= "TEST:FAIL - Missing attribute:
\$$attributeName$\$"

  The output will look something like this:

     <p>

     <!--
     TEST:FAIL - Missing attribute: $reqAttr$
     1
     -->
     You have recei

  The unit tests can then search for these failure messages and make the
test fall over. The comments prevent
  the test stuff from breaking the final output... :-)

  For maps you can use a default to generate a string which can be caught in
the test too. Its a pity
  the key of the map is not treated as an attribute. That would make this
possible:
  [John Snyders] From my view I would not be as concerned with maps because
they are under the control of the template and therefore not part of the
boundary I would want to test.

  amap ::= [
    "2":     "value 2",
    "5":     "Other",
    default: "Unknown reason: $key$"
  ]

  With this you could generate the fail message AND report the failing
value....
  Perhaps someone else can think of a way to solve this one...
  [John Snyders] Not off the top of my head

  Cheers
       Caleb

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061109/726e4712/attachment.html 

From caleb.lyness at ezswitch.net  Fri Nov 10 08:04:51 2006
From: caleb.lyness at ezswitch.net (Caleb Lyness)
Date: Fri, 10 Nov 2006 17:04:51 +0100
Subject: [stringtemplate-interest] Attribute not found exception?
	Revisited
In-Reply-To: <PMEOJKDLMMHOHNEAMPBGGECHCAAA.jjsnyders@rcn.com>
References: <PMEOJKDLMMHOHNEAMPBGGECHCAAA.jjsnyders@rcn.com>
Message-ID: <4554A323.7040705@ezswitch.net>


>     With ref to the following thread:
>     http://www.antlr.org:8080/pipermail/stringtemplate-interest/2006-March/000291.html
>
>     * I am looking for a way to ask a template what attributes it is
>     using/wanting.
>     [John Snyders] This is interesting and seems to imply that the
>     template (view) is in charge of defining the set of attributes. I
>     usually think of the model/controler as being the one that defines
>     the set of attributes available to the view. Perhaps a minor
>     distinction since they both have to work together.  Are you asking
>     this question to determine if the model is generating stuff that
>     the view does need? Like a good Java IDE will tell you when you
>     have unused variables.
>
That is the idea. This comes from the position where some one else
designs the view (customer department, web designer or whoever) and the
developer is  responsible for providing the necessaries data. While most
of  the time the data will fit the model, occasionally the model needs
to be updated to contain the data needed to achieve the desired output.
As a developer I don't want to sift through N (esp as N gets big)
templates to find the parameters that are new and need to be added to
the model.
>
>     So far I have overloaded a Map class which records which keys are
>     requested.
>     I pass this in as the attributes list. At the end of a template
>     gen I know what was
>     requested and what was not.
>     [John Snyders] Nice solution but how does it handle conditional
>     logic in the template?
>
Conditional logic in the template does cause a problem, in that if a
certain path is followed then it will not know all the parameters...
Hmmm, but do we really want to know all the parameters, or only those
that we need to complete  the given concrete instance....
>
>     Also this would force a particular data model. Specifically all
>     access would need to go throught the map or something that looked
>     like a map. How could you tell that a scalar attribute ($foo$) was
>     used?
>
Err. But this is situation current in ST as far as I know. ST refers to
a map internally which has name->object. One can either set this map up via
|*setAttribute
<http://www.stringtemplate.org/doc/api/org/antlr/stringtemplate/StringTemplate.html#setAttribute%28java.lang.String,%20java.lang.Object%29>*(java.lang.String name,
java.lang.Object value)| and friends or via |*setAttributes
<http://www.stringtemplate.org/doc/api/org/antlr/stringtemplate/StringTemplate.html#setAttributes%28java.util.Map%29>*(java.util.Map attributes).
I am using | |*setAttributes
<http://www.stringtemplate.org/doc/api/org/antlr/stringtemplate/StringTemplate.html#setAttributes%28java.util.Map%29>.*|
Perhaps I am missing your point, but the scalar attribute is handled in
the normal way.

>
>     *Q:* Can I do this with out actually rendering, (via
>     toString())... i.e. is there another way?
>     [John Snyders] In theory the parsed template should know about all
>     the attribute references. An alternate tree walk could report on
>     all possible attribute references. What it wouldn't know is if the
>     references was to a map key, property, field etc.
>
Hmmm, I it wonder... could be possible to use this approach to find the
conditional blocks... hmmm. i.e. As I have it now I do not know if the
attribute was being queried for a condition or for a value. As far as I
understand the conditional blocks are controlled by an attribute (either
null/set or true/false). The attributes in a conditional block are not
neccessarily required for a given  rendering of the template. The query
for any/all attributes is marked using the extended map. Once you know
the attribute is part of a conditional block you can toggle its state
and rerun the process above to give a new set of attributes... Then you
land up with a bunch of attributes needed for a given set of "states".

references to maps can be resolved by querying the  template group for a
map with the given name. For example:
        System.out.println("-----\nmissed keys");
        Set<String> keys = attributes.getMissedKeys();
        for (String key: keys) {
            // Check if the key was a map reference:
            Map result = templateGroup.getMap(key);
            if (result == null) {
                System.out.println("key: "+key);               
            }
        }

Properties are something I have not though about yet... will have to
think about it for a while:

$user.name$
$user.gender$

Currently I know that I need an attribute user. But I am not checking if
the properties exists.
Perhaps a dynamic wrapper/proxy class, which my map will insert when the
value is requested... I will have to think some more on this.
One needs a way to handle $user.name.lastname$ and
$user.bla.bla........fred$
>
>
>     * Sometimes its useful to know (say for testing) that a "required"
>     string is missing. What is
>     required and what is not is quite specific to the template. Here
>     is how I do it for the HTML
>     I am generating:
>     [John Snyders] This is a seperate problem right? This is the
>     case I think is more interesting and important. 
>
It is separate,  but at the same time related.
>
>     The model/controler defines what attributes will be available
>     under what conditions. This contract should be unit testable.
>      Using a template to do this as you describe is a nice way to unit
>     test the contract without having to instrument the
>     model/controler. Your example has instrumented the actual template. 
>
Correct
>
>     I think it would be better to somehow substitute a special unit
>     test template. It should check more than just what is required but
>     what is expected for a given request. Has anyone created
>     extensions to JUnit to do this?
>
This is where that relationship above comes in... There is only a
marginal difference between required and expected in my eyes (unless you
can provide me with solid counter example). By querying the template for
what attributes it uses you can find out what is "expected". Expected by
this definition is different in that the value may be unset. Or have I
miss understood you?

>
>     $if (checkAttributes)$
>     <!--
>     $reqAttr;null=missingAttribute("reqAttr")$
>     $serviceCode;null=missingAttribute("serviceCode")$
>     -->
>     $endif$
>
>     If the checkAttributes attribute is true/specified the html
>     comment is "rendered". If the
>     value is "required" by this template then it is listed in this
>     comment. When the comment
>     is rendered either the value is rendered or if the attribute is
>     missing it spits out a string
>     which can be easily found including the name of the missing attribute.
>
>     The template shown is defined in a group file as:
>
>     missingAttribute(attributeName) ::= "TEST:FAIL - Missing
>     attribute: \$$attributeName$\$"
>
>     The output will look something like this:
>
>        <p>       
>       
>        <!--
>        TEST:FAIL - Missing attribute: $reqAttr$
>        1
>        -->
>        You have recei
>
>     The unit tests can then search for these failure messages and make
>     the test fall over. The comments prevent
>     the test stuff from breaking the final output... :-)
>
>     For maps you can use a default to generate a string which can be
>     caught in the test too. Its a pity
>     the key of the map is not treated as an attribute. That would make
>     this possible:
>     [John Snyders] From my view I would not be as concerned with maps
>     because they are under the control of the template and therefore
>     not part of the boundary I would want to test.
>
Ah, but the key may be defined by the model and not the template.
Consider:   $amap.(num)$, where num is coming from the data model. Then
we have case for wanting to test...
>
>
>     amap ::= [
>       "2":     "value 2",
>       "5":     "Other",
>       default: "Unknown reason: $key$"
>     ]
>
>     With this you could generate the fail message AND report the
>     failing value....
>     Perhaps someone else can think of a way to solve this one...
>     [John Snyders] Not off the top of my head
>
:-)

Thanks for the lively discussion :-D

I have streamlined the template a bit... I got bit annoyed with having
to entering the comment :-P

requiredAttribute(ref,attr) ::= <<
  $if (checkRequiredAttributes)$
  $if(!attr)$
  <!-- #FAILED ~ Missing attribute: \$$ref$\$ -->
  $endif$
  $endif$
>>

Now I have one liners...

$requiredAttribute(ref="code",attr=code)$

Can anyone think of way of avoid the the double parameter....

Also not that this check will have false positives for boolean
attributes set to false.

Cheers
    Caleb


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061110/8f3c47cb/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3269 bytes
Desc: S/MIME Cryptographic Signature
Url : http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061110/8f3c47cb/attachment.bin 

From jjsnyders at rcn.com  Fri Nov 10 09:05:33 2006
From: jjsnyders at rcn.com (John Snyders)
Date: Fri, 10 Nov 2006 12:05:33 -0500
Subject: [stringtemplate-interest] Attribute not found exception?
	Revisited
In-Reply-To: <4554A323.7040705@ezswitch.net>
Message-ID: <PMEOJKDLMMHOHNEAMPBGEECKCAAA.jjsnyders@rcn.com>

Response in this color
-John
      So far I have overloaded a Map class which records which keys are
requested.
      I pass this in as the attributes list. At the end of a template gen I
know what was
      requested and what was not.
      [John Snyders] Nice solution but how does it handle conditional logic
in the template?

  Conditional logic in the template does cause a problem, in that if a
certain path is followed then it will not know all the parameters... Hmmm,
but do we really want to know all the parameters, or only those that we need
to complete  the given concrete instance....

      Also this would force a particular data model. Specifically all access
would need to go throught the map or something that looked like a map. How
could you tell that a scalar attribute ($foo$) was used?

  Err. But this is situation current in ST as far as I know. ST refers to a
map internally which has name->object. One can either set this map up via
  setAttribute(java.lang.String name, java.lang.Object value) and friends or
via setAttributes(java.util.Map attributes). I am using setAttributes.
Perhaps I am missing your point, but the scalar attribute is handled in the
normal way.

  [John Snyders] I had not used setAttributes only setAttribute. I see what
you mean now.


      Q: Can I do this with out actually rendering, (via toString())... i.e.
is there another way?
      [John Snyders] In theory the parsed template should know about all the
attribute references. An alternate tree walk could report on all possible
attribute references. What it wouldn't know is if the references was to a
map key, property, field etc.

  Hmmm, I it wonder... could be possible to use this approach to find the
conditional blocks... hmmm. i.e. As I have it now I do not know if the
attribute was being queried for a condition or for a value. As far as I
understand the conditional blocks are controlled by an attribute (either
null/set or true/false). The attributes in a conditional block are not
neccessarily required for a given  rendering of the template. The query for
any/all attributes is marked using the extended map. Once you know the
attribute is part of a conditional block you can toggle its state and rerun
the process above to give a new set of attributes... Then you land up with a
bunch of attributes needed for a given set of "states".

  references to maps can be resolved by querying the  template group for a
map with the given name. For example:
          System.out.println("-----\nmissed keys");
          Set<String> keys = attributes.getMissedKeys();
          for (String key: keys) {
              // Check if the key was a map reference:
              Map result = templateGroup.getMap(key);
              if (result == null) {
                  System.out.println("key: "+key);
              }
          }

  Properties are something I have not though about yet... will have to think
about it for a while:

  $user.name$
  $user.gender$

  Currently I know that I need an attribute user. But I am not checking if
the properties exists.
  Perhaps a dynamic wrapper/proxy class, which my map will insert when the
value is requested... I will have to think some more on this.
  One needs a way to handle $user.name.lastname$ and
$user.bla.bla........fred$
  [John Snyders] Having ST tell you directly from the AST would avoid this.
Have you tried using the information here
http://www.antlr.org/wiki/display/ST/Debugging


      * Sometimes its useful to know (say for testing) that a "required"
string is missing. What is
      required and what is not is quite specific to the template. Here is
how I do it for the HTML
      I am generating:
      [John Snyders] This is a seperate problem right? This is the case I
think is more interesting and important.
  It is separate,  but at the same time related.
      The model/controler defines what attributes will be available under
what conditions. This contract should be unit testable.  Using a template to
do this as you describe is a nice way to unit test the contract without
having to instrument the model/controler. Your example has instrumented the
actual template.
  Correct

      I think it would be better to somehow substitute a special unit test
template. It should check more than just what is required but what is
expected for a given request. Has anyone created extensions to JUnit to do
this?

  This is where that relationship above comes in... There is only a marginal
difference between required and expected in my eyes (unless you can provide
me with solid counter example). By querying the template for what attributes
it uses you can find out what is "expected". Expected by this definition is
different in that the value may be unset. Or have I miss understood you?
  [John Snyders] I think we are saying the same thing


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061110/005d7fc5/attachment-0001.html 

From misc at n4te.com  Fri Nov 10 17:44:23 2006
From: misc at n4te.com (Nate)
Date: Fri, 10 Nov 2006 17:44:23 -0800
Subject: [stringtemplate-interest] use template groups in a WAR
Message-ID: <45552AF7.4080904@n4te.com>

I am writing a web application. I want to use StringTemplate to generate 
the HTML pages. I want users to be able to select a "skin" from a list. 
Each skin would use a different set of templates to display the HTML.

My initial impression is that I'd use a different StringTemplateGroup 
for each skin. I imagined a file structure like this...

skins/redtheme/page.st
skins/redtheme/etc.st
skins/bluetheme/page.st
skins/bluetheme/etc.st

...the code would be something like...

skinName = "redtheme";
group = new StringTemplateGroup(skinName, "skins");
group.getInstanceOf("page");
group.getInstanceOf("etc");

This works fine on the filesystem. Now I zip my application up into a 
WAR file and suddenly the templates cannot be found. Next I think I 
should look up templates using the classpath. StringTemplate 
documentation leads me to think I need to use code like this...

skinName = "redtheme";
group = new StringTemplateGroup("allSkins");
group.getInstanceOf("skins/" + skinName + "/page");
group.getInstanceOf("skins/" + skinName + "/etc");

There is no "rootDir" when using the classpath, so I cannot use the a 
StringTemplateGroup for each skin, like I could on the filesystem.

What is the solution? How do other people do it? Why does it work so 
differently when JARed or WARed?

Regards,
Nathan Sweet


From jmrenouard at gmail.com  Sun Nov 12 02:50:12 2006
From: jmrenouard at gmail.com (Jean-Marie Renouard)
Date: Sun, 12 Nov 2006 11:50:12 +0100
Subject: [stringtemplate-interest] use template groups in a WAR
In-Reply-To: <45552AF7.4080904@n4te.com>
References: <45552AF7.4080904@n4te.com>
Message-ID: <a304d4e60611120250o8761125lf1e4a241b697b2ff@mail.gmail.com>

Hello,

Several solutions exist :
1) Use a jar for template in the WEB-INF/lib
2) place your templates in the classpath : WEB-INF/classes for example.
so in your case,
WEB-INF/classes/skins/...

Have a nice week :)
Jean-Marie

On 11/11/06, Nate <misc at n4te.com> wrote:
>
> I am writing a web application. I want to use StringTemplate to generate
> the HTML pages. I want users to be able to select a "skin" from a list.
> Each skin would use a different set of templates to display the HTML.
>
> My initial impression is that I'd use a different StringTemplateGroup
> for each skin. I imagined a file structure like this...
>
> skins/redtheme/page.st
> skins/redtheme/etc.st
> skins/bluetheme/page.st
> skins/bluetheme/etc.st
>
> ...the code would be something like...
>
> skinName = "redtheme";
> group = new StringTemplateGroup(skinName, "skins");
> group.getInstanceOf("page");
> group.getInstanceOf("etc");
>
> This works fine on the filesystem. Now I zip my application up into a
> WAR file and suddenly the templates cannot be found. Next I think I
> should look up templates using the classpath. StringTemplate
> documentation leads me to think I need to use code like this...
>
> skinName = "redtheme";
> group = new StringTemplateGroup("allSkins");
> group.getInstanceOf("skins/" + skinName + "/page");
> group.getInstanceOf("skins/" + skinName + "/etc");
>
> There is no "rootDir" when using the classpath, so I cannot use the a
> StringTemplateGroup for each skin, like I could on the filesystem.
>
> What is the solution? How do other people do it? Why does it work so
> differently when JARed or WARed?
>
> Regards,
> Nathan Sweet
>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>



-- 
Cordialement,
Jean-Marie Renouard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061112/b9789ef7/attachment.html 

From misc at n4te.com  Sun Nov 12 21:59:20 2006
From: misc at n4te.com (Nate)
Date: Sun, 12 Nov 2006 21:59:20 -0800
Subject: [stringtemplate-interest] use template groups in a WAR
In-Reply-To: <a304d4e60611120250o8761125lf1e4a241b697b2ff@mail.gmail.com>
References: <45552AF7.4080904@n4te.com>
	<a304d4e60611120250o8761125lf1e4a241b697b2ff@mail.gmail.com>
Message-ID: <455809B8.8030003@n4te.com>

Hi Jean-Marie,

I think the question was misunderstood. If I put the skins on the 
classpath, whether in a JAR or in the classes directory of the WAR, then 
the only way to access the skins is by their absolute path in the 
classpath. To do this, I create a StringTemplateGroup with no rootDir. 
For example...

skinName = "redtheme";
group = new StringTemplateGroup("allSkins");
group.getInstanceOf("skins/" + skinName + "/page");
group.getInstanceOf("skins/" + skinName + "/etc");

This is not what I want. I want to use a StringTemplateGroup from the 
classpath just like I do from the filesystem. This is how I use it from 
the filesystem...

skinName = "redtheme";
group = new StringTemplateGroup(skinName, "skins");
group.getInstanceOf("page");
group.getInstanceOf ("etc");

I have the following three questions:

1. How can I use a StringTemplateGroup from the classpath just like I do 
from the filesystem?

2. If this is not possible, what is the workaround that people use? I 
cannot imagine this being a rare request.

3. If there is no workaround, will a reasonable patch be excepted? The 
current constructors would stay the same and function in the same way. 
My patch would add a constructor StringTemplateGroup(name, rootDir, 
isClasspath) that functions as expected.

Thanks,
-Nate


Jean-Marie Renouard wrote:

> Hello,
>
> Several solutions exist :
> 1) Use a jar for template in the WEB-INF/lib
> 2) place your templates in the classpath : WEB-INF/classes for example.
> so in your case,
> WEB-INF/classes/skins/...
>
> Have a nice week :)
> Jean-Marie
>
> On 11/11/06, *Nate* <misc at n4te.com <mailto:misc at n4te.com>> wrote:
>
>     I am writing a web application. I want to use StringTemplate to
>     generate
>     the HTML pages. I want users to be able to select a "skin" from a
>     list.
>     Each skin would use a different set of templates to display the HTML.
>
>     My initial impression is that I'd use a different StringTemplateGroup
>     for each skin. I imagined a file structure like this...
>
>     skins/redtheme/page.st
>     skins/redtheme/etc.st
>     skins/bluetheme/page.st
>     skins/bluetheme/etc.st
>
>     ...the code would be something like...
>
>     skinName = "redtheme";
>     group = new StringTemplateGroup(skinName, "skins");
>     group.getInstanceOf("page");
>     group.getInstanceOf ("etc");
>
>     This works fine on the filesystem. Now I zip my application up into a
>     WAR file and suddenly the templates cannot be found. Next I think I
>     should look up templates using the classpath. StringTemplate
>     documentation leads me to think I need to use code like this...
>
>     skinName = "redtheme";
>     group = new StringTemplateGroup("allSkins");
>     group.getInstanceOf("skins/" + skinName + "/page");
>     group.getInstanceOf("skins/" + skinName + "/etc");
>
>     There is no "rootDir" when using the classpath, so I cannot use the a
>     StringTemplateGroup for each skin, like I could on the filesystem.
>
>     What is the solution? How do other people do it? Why does it work so
>     differently when JARed or WARed?
>
>     Regards,
>     Nathan Sweet
>
>     _______________________________________________
>     stringtemplate-interest mailing list
>     stringtemplate-interest at antlr.org
>     <mailto:stringtemplate-interest at antlr.org>
>     http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>     <http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest>
>
>
>
>
> -- 
> Cordialement,
> Jean-Marie Renouard 


From harry.karadimas at hmn.aphp.fr  Mon Nov 13 04:45:49 2006
From: harry.karadimas at hmn.aphp.fr (Harry Karadimas)
Date: Mon, 13 Nov 2006 13:45:49 +0100
Subject: [stringtemplate-interest] use template groups in a WAR
In-Reply-To: <mailman.5.1163275202.1726.stringtemplate-interest@antlr.org>
References: <mailman.5.1163275202.1726.stringtemplate-interest@antlr.org>
Message-ID: <455868FD.6020801@hmn.aphp.fr>

Put your files in /WEB-INF/classes, and try "/" in front of your path, e.g.

*/*skins/redtheme/etc.st

                                                       Harry Karadimas
/______________________________________________________________________
Dr Harry Karadimas  Medecin Ingenieur resp. Recherche et Developpement
Departement d'Information Hospitalier
CHU Henri Mondor 51, av. du Mal de Lattre de Tassigny   94010  CRETEIL
tel : (00 33 1) 49 81 21 79                fax : (00 33 1) 49 81 27 08
secr.: (00 33 1) 49 81 23 82 m.el.:harry.karadimas at hmn.ap-hop-paris.fr
/



stringtemplate-interest-request at antlr.org a ?crit :
> Send stringtemplate-interest mailing list submissions to
> 	stringtemplate-interest at antlr.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
> or, via email, send a message with subject or body 'help' to
> 	stringtemplate-interest-request at antlr.org
>
> You can reach the person managing the list at
> 	stringtemplate-interest-owner at antlr.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of stringtemplate-interest digest..."
>
>
> Today's Topics:
>
>    1. use template groups in a WAR (Nate)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 10 Nov 2006 17:44:23 -0800
> From: Nate <misc at n4te.com>
> Subject: [stringtemplate-interest] use template groups in a WAR
> To: stringtemplate-interest at antlr.org
> Message-ID: <45552AF7.4080904 at n4te.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> I am writing a web application. I want to use StringTemplate to generate 
> the HTML pages. I want users to be able to select a "skin" from a list. 
> Each skin would use a different set of templates to display the HTML.
>
> My initial impression is that I'd use a different StringTemplateGroup 
> for each skin. I imagined a file structure like this...
>
> skins/redtheme/page.st
> skins/redtheme/etc.st
> skins/bluetheme/page.st
> skins/bluetheme/etc.st
>
> ...the code would be something like...
>
> skinName = "redtheme";
> group = new StringTemplateGroup(skinName, "skins");
> group.getInstanceOf("page");
> group.getInstanceOf("etc");
>
> This works fine on the filesystem. Now I zip my application up into a 
> WAR file and suddenly the templates cannot be found. Next I think I 
> should look up templates using the classpath. StringTemplate 
> documentation leads me to think I need to use code like this...
>
> skinName = "redtheme";
> group = new StringTemplateGroup("allSkins");
> group.getInstanceOf("skins/" + skinName + "/page");
> group.getInstanceOf("skins/" + skinName + "/etc");
>
> There is no "rootDir" when using the classpath, so I cannot use the a 
> StringTemplateGroup for each skin, like I could on the filesystem.
>
> What is the solution? How do other people do it? Why does it work so 
> differently when JARed or WARed?
>
> Regards,
> Nathan Sweet
>
>
>
> ------------------------------
>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>
>
> End of stringtemplate-interest Digest, Vol 20, Issue 5
> ******************************************************
>
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061113/5039284a/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: harry.karadimas.vcf
Type: text/x-vcard
Size: 407 bytes
Desc: not available
Url : http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061113/5039284a/attachment.vcf 

From misc at n4te.com  Mon Nov 13 11:26:30 2006
From: misc at n4te.com (Nate)
Date: Mon, 13 Nov 2006 11:26:30 -0800
Subject: [stringtemplate-interest] use template groups in a WAR
In-Reply-To: <455868FD.6020801@hmn.aphp.fr>
References: <mailman.5.1163275202.1726.stringtemplate-interest@antlr.org>
	<455868FD.6020801@hmn.aphp.fr>
Message-ID: <4558C6E6.8060407@n4te.com>

Hi Harry, please see my list message in reply to Jean-Marie (sent 
11/12/06). I realize that I can access templates on the classpath using 
a path relative to the root of the classpath. However, I want to access 
templates on the classpath based on a root directory. This can be done 
on the filesystem and, IMHO, should also be possible on the classpath.

Thanks,
-Nate


Harry Karadimas wrote:
> Put your files in /WEB-INF/classes, and try "/" in front of your path, 
> e.g.
> */*skins/redtheme/etc.st
>                                                        Harry Karadimas
> /______________________________________________________________________
> Dr Harry Karadimas  Medecin Ingenieur resp. Recherche et Developpement
> Departement d'Information Hospitalier
> CHU Henri Mondor 51, av. du Mal de Lattre de Tassigny   94010  CRETEIL
> tel : (00 33 1) 49 81 21 79                fax : (00 33 1) 49 81 27 08
> secr.: (00 33 1) 49 81 23 82 m.el.:harry.karadimas at hmn.ap-hop-paris.fr
> /
>
>
> stringtemplate-interest-request at antlr.org a ?crit :
>> Send stringtemplate-interest mailing list submissions to
>> 	stringtemplate-interest at antlr.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>> 	http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>> or, via email, send a message with subject or body 'help' to
>> 	stringtemplate-interest-request at antlr.org
>>
>> You can reach the person managing the list at
>> 	stringtemplate-interest-owner at antlr.org
>>
>> When replying, please edit your Subject line so it is more specific
>> than "Re: Contents of stringtemplate-interest digest..."
>>
>>
>> Today's Topics:
>>
>>    1. use template groups in a WAR (Nate)
>>
>>
>> ----------------------------------------------------------------------
>>
>> Message: 1
>> Date: Fri, 10 Nov 2006 17:44:23 -0800
>> From: Nate <misc at n4te.com>
>> Subject: [stringtemplate-interest] use template groups in a WAR
>> To: stringtemplate-interest at antlr.org
>> Message-ID: <45552AF7.4080904 at n4te.com>
>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>
>> I am writing a web application. I want to use StringTemplate to generate 
>> the HTML pages. I want users to be able to select a "skin" from a list. 
>> Each skin would use a different set of templates to display the HTML.
>>
>> My initial impression is that I'd use a different StringTemplateGroup 
>> for each skin. I imagined a file structure like this...
>>
>> skins/redtheme/page.st
>> skins/redtheme/etc.st
>> skins/bluetheme/page.st
>> skins/bluetheme/etc.st
>>
>> ...the code would be something like...
>>
>> skinName = "redtheme";
>> group = new StringTemplateGroup(skinName, "skins");
>> group.getInstanceOf("page");
>> group.getInstanceOf("etc");
>>
>> This works fine on the filesystem. Now I zip my application up into a 
>> WAR file and suddenly the templates cannot be found. Next I think I 
>> should look up templates using the classpath. StringTemplate 
>> documentation leads me to think I need to use code like this...
>>
>> skinName = "redtheme";
>> group = new StringTemplateGroup("allSkins");
>> group.getInstanceOf("skins/" + skinName + "/page");
>> group.getInstanceOf("skins/" + skinName + "/etc");
>>
>> There is no "rootDir" when using the classpath, so I cannot use the a 
>> StringTemplateGroup for each skin, like I could on the filesystem.
>>
>> What is the solution? How do other people do it? Why does it work so 
>> differently when JARed or WARed?
>>
>> Regards,
>> Nathan Sweet
>>     


From misc at n4te.com  Mon Nov 13 11:56:28 2006
From: misc at n4te.com (Nate)
Date: Mon, 13 Nov 2006 11:56:28 -0800
Subject: [stringtemplate-interest] use template groups in a WAR
In-Reply-To: <4558C6E6.8060407@n4te.com>
References: <mailman.5.1163275202.1726.stringtemplate-interest@antlr.org>	<455868FD.6020801@hmn.aphp.fr>
	<4558C6E6.8060407@n4te.com>
Message-ID: <4558CDEC.6030100@n4te.com>

Below is the solution I came up with. It is nice that the internals of 
StringTemplateGroup are exposed as protected members so that this is 
even possible. However, I feel this is something StringTemplate should 
provide out of the box. Unfortunately, simply including the class below 
may prove confusing since the StringTemplateGroup class also provides a 
way to load templates through the classpath. A simple "@see 
ClasspathTemplateGroup" javadoc tag in the StringTemplateGroup class may 
be sufficient to clear this up.

-Nate

public class ClasspathTemplateGroup extends StringTemplateGroup {
    private final String classpathRootDir;

    public ClasspathTemplateGroup (String name, String classpathRootDir) {
        super(name);
        if (!classpathRootDir.endsWith("/")) classpathRootDir += "/";
        this.classpathRootDir = classpathRootDir;
    }

    protected StringTemplate loadTemplateFromBeneathRootDirOrCLASSPATH 
(String fileName) {
        return 
super.loadTemplateFromBeneathRootDirOrCLASSPATH(classpathRootDir + 
fileName);
    }
}


Nate wrote:
> Hi Harry, please see my list message in reply to Jean-Marie (sent 
> 11/12/06). I realize that I can access templates on the classpath using 
> a path relative to the root of the classpath. However, I want to access 
> templates on the classpath based on a root directory. This can be done 
> on the filesystem and, IMHO, should also be possible on the classpath.
>
> Thanks,
> -Nate
>
>
> Harry Karadimas wrote:
>   
>> Put your files in /WEB-INF/classes, and try "/" in front of your path, 
>> e.g.
>> */*skins/redtheme/etc.st
>>                                                        Harry Karadimas
>> /______________________________________________________________________
>> Dr Harry Karadimas  Medecin Ingenieur resp. Recherche et Developpement
>> Departement d'Information Hospitalier
>> CHU Henri Mondor 51, av. du Mal de Lattre de Tassigny   94010  CRETEIL
>> tel : (00 33 1) 49 81 21 79                fax : (00 33 1) 49 81 27 08
>> secr.: (00 33 1) 49 81 23 82 m.el.:harry.karadimas at hmn.ap-hop-paris.fr
>> /
>>
>>
>> stringtemplate-interest-request at antlr.org a ?crit :
>>     
>>> Send stringtemplate-interest mailing list submissions to
>>> 	stringtemplate-interest at antlr.org
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>> 	http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>>> or, via email, send a message with subject or body 'help' to
>>> 	stringtemplate-interest-request at antlr.org
>>>
>>> You can reach the person managing the list at
>>> 	stringtemplate-interest-owner at antlr.org
>>>
>>> When replying, please edit your Subject line so it is more specific
>>> than "Re: Contents of stringtemplate-interest digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>    1. use template groups in a WAR (Nate)
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Fri, 10 Nov 2006 17:44:23 -0800
>>> From: Nate <misc at n4te.com>
>>> Subject: [stringtemplate-interest] use template groups in a WAR
>>> To: stringtemplate-interest at antlr.org
>>> Message-ID: <45552AF7.4080904 at n4te.com>
>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>>
>>> I am writing a web application. I want to use StringTemplate to generate 
>>> the HTML pages. I want users to be able to select a "skin" from a list. 
>>> Each skin would use a different set of templates to display the HTML.
>>>
>>> My initial impression is that I'd use a different StringTemplateGroup 
>>> for each skin. I imagined a file structure like this...
>>>
>>> skins/redtheme/page.st
>>> skins/redtheme/etc.st
>>> skins/bluetheme/page.st
>>> skins/bluetheme/etc.st
>>>
>>> ...the code would be something like...
>>>
>>> skinName = "redtheme";
>>> group = new StringTemplateGroup(skinName, "skins");
>>> group.getInstanceOf("page");
>>> group.getInstanceOf("etc");
>>>
>>> This works fine on the filesystem. Now I zip my application up into a 
>>> WAR file and suddenly the templates cannot be found. Next I think I 
>>> should look up templates using the classpath. StringTemplate 
>>> documentation leads me to think I need to use code like this...
>>>
>>> skinName = "redtheme";
>>> group = new StringTemplateGroup("allSkins");
>>> group.getInstanceOf("skins/" + skinName + "/page");
>>> group.getInstanceOf("skins/" + skinName + "/etc");
>>>
>>> There is no "rootDir" when using the classpath, so I cannot use the a 
>>> StringTemplateGroup for each skin, like I could on the filesystem.
>>>
>>> What is the solution? How do other people do it? Why does it work so 
>>> differently when JARed or WARed?
>>>
>>> Regards,
>>> Nathan Sweet

From misc at n4te.com  Mon Nov 13 12:09:08 2006
From: misc at n4te.com (Nate)
Date: Mon, 13 Nov 2006 12:09:08 -0800
Subject: [stringtemplate-interest] inconsistency: return null or throw
	exception
Message-ID: <4558D0E4.1010401@n4te.com>

The method StringTemplateGroup#lookupTemplate(StringTemplate, String) 
throws an IllegalArgumentException the first time a template is not 
found. Subsequent requests for the same template do not throw the 
IllegalArgumentException and instead return null. What is the reason for 
this inconsistency? IMO, the method should either always through the 
exception OR it should always return null. Currently I have to write 
code like the following to handle if the template was not found.

-Nate

StringTemplate template = null;
try {
    template = templateGroup.getInstanceOf(templateName);
} catch (RuntimeException ignored) {
    // getInstanceOf throws an IllegalArgumentException only the first 
time a template is not found.
}
if (template == null) {
   // Handle template not found.
}


From misc at n4te.com  Mon Nov 13 12:18:23 2006
From: misc at n4te.com (Nate)
Date: Mon, 13 Nov 2006 12:18:23 -0800
Subject: [stringtemplate-interest] use template groups in a WAR
In-Reply-To: <4558CDEC.6030100@n4te.com>
References: <mailman.5.1163275202.1726.stringtemplate-interest@antlr.org>	<455868FD.6020801@hmn.aphp.fr>	<4558C6E6.8060407@n4te.com>
	<4558CDEC.6030100@n4te.com>
Message-ID: <4558D30F.4080207@n4te.com>

Sorry for all the emails, but I was missing a part of the class below. 
In the constructor, the line should be...

this.classpathRootDir = classpathRootDir + name + '/';


Nate wrote:
> Below is the solution I came up with. It is nice that the internals of 
> StringTemplateGroup are exposed as protected members so that this is 
> even possible. However, I feel this is something StringTemplate should 
> provide out of the box. Unfortunately, simply including the class below 
> may prove confusing since the StringTemplateGroup class also provides a 
> way to load templates through the classpath. A simple "@see 
> ClasspathTemplateGroup" javadoc tag in the StringTemplateGroup class may 
> be sufficient to clear this up.
>
> -Nate
>
> public class ClasspathTemplateGroup extends StringTemplateGroup {
>     private final String classpathRootDir;
>
>     public ClasspathTemplateGroup (String name, String classpathRootDir) {
>         super(name);
>         if (!classpathRootDir.endsWith("/")) classpathRootDir += "/";
>         this.classpathRootDir = classpathRootDir;
>     }
>
>     protected StringTemplate loadTemplateFromBeneathRootDirOrCLASSPATH 
> (String fileName) {
>         return 
> super.loadTemplateFromBeneathRootDirOrCLASSPATH(classpathRootDir + 
> fileName);
>     }
> }
>
>
> Nate wrote:
>   
>> Hi Harry, please see my list message in reply to Jean-Marie (sent 
>> 11/12/06). I realize that I can access templates on the classpath using 
>> a path relative to the root of the classpath. However, I want to access 
>> templates on the classpath based on a root directory. This can be done 
>> on the filesystem and, IMHO, should also be possible on the classpath.
>>
>> Thanks,
>> -Nate
>>
>>
>> Harry Karadimas wrote:
>>   
>>     
>>> Put your files in /WEB-INF/classes, and try "/" in front of your path, 
>>> e.g.
>>> */*skins/redtheme/etc.st
>>>                                                        Harry Karadimas
>>> /______________________________________________________________________
>>> Dr Harry Karadimas  Medecin Ingenieur resp. Recherche et Developpement
>>> Departement d'Information Hospitalier
>>> CHU Henri Mondor 51, av. du Mal de Lattre de Tassigny   94010  CRETEIL
>>> tel : (00 33 1) 49 81 21 79                fax : (00 33 1) 49 81 27 08
>>> secr.: (00 33 1) 49 81 23 82 m.el.:harry.karadimas at hmn.ap-hop-paris.fr
>>> /
>>>
>>>
>>> stringtemplate-interest-request at antlr.org a ?crit :
>>>     
>>>       
>>>> Send stringtemplate-interest mailing list submissions to
>>>> 	stringtemplate-interest at antlr.org
>>>>
>>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>> 	http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>>>> or, via email, send a message with subject or body 'help' to
>>>> 	stringtemplate-interest-request at antlr.org
>>>>
>>>> You can reach the person managing the list at
>>>> 	stringtemplate-interest-owner at antlr.org
>>>>
>>>> When replying, please edit your Subject line so it is more specific
>>>> than "Re: Contents of stringtemplate-interest digest..."
>>>>
>>>>
>>>> Today's Topics:
>>>>
>>>>    1. use template groups in a WAR (Nate)
>>>>
>>>>
>>>> ----------------------------------------------------------------------
>>>>
>>>> Message: 1
>>>> Date: Fri, 10 Nov 2006 17:44:23 -0800
>>>> From: Nate <misc at n4te.com>
>>>> Subject: [stringtemplate-interest] use template groups in a WAR
>>>> To: stringtemplate-interest at antlr.org
>>>> Message-ID: <45552AF7.4080904 at n4te.com>
>>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>>>
>>>> I am writing a web application. I want to use StringTemplate to generate 
>>>> the HTML pages. I want users to be able to select a "skin" from a list. 
>>>> Each skin would use a different set of templates to display the HTML.
>>>>
>>>> My initial impression is that I'd use a different StringTemplateGroup 
>>>> for each skin. I imagined a file structure like this...
>>>>
>>>> skins/redtheme/page.st
>>>> skins/redtheme/etc.st
>>>> skins/bluetheme/page.st
>>>> skins/bluetheme/etc.st
>>>>
>>>> ...the code would be something like...
>>>>
>>>> skinName = "redtheme";
>>>> group = new StringTemplateGroup(skinName, "skins");
>>>> group.getInstanceOf("page");
>>>> group.getInstanceOf("etc");
>>>>
>>>> This works fine on the filesystem. Now I zip my application up into a 
>>>> WAR file and suddenly the templates cannot be found. Next I think I 
>>>> should look up templates using the classpath. StringTemplate 
>>>> documentation leads me to think I need to use code like this...
>>>>
>>>> skinName = "redtheme";
>>>> group = new StringTemplateGroup("allSkins");
>>>> group.getInstanceOf("skins/" + skinName + "/page");
>>>> group.getInstanceOf("skins/" + skinName + "/etc");
>>>>
>>>> There is no "rootDir" when using the classpath, so I cannot use the a 
>>>> StringTemplateGroup for each skin, like I could on the filesystem.
>>>>
>>>> What is the solution? How do other people do it? Why does it work so 
>>>> differently when JARed or WARed?
>>>>
>>>> Regards,
>>>> Nathan Sweet

From harry.karadimas at hmn.aphp.fr  Tue Nov 14 08:21:53 2006
From: harry.karadimas at hmn.aphp.fr (Harry Karadimas)
Date: Tue, 14 Nov 2006 17:21:53 +0100
Subject: [stringtemplate-interest] use template groups in a WAR
In-Reply-To: <4558C6E6.8060407@n4te.com>
References: <mailman.5.1163275202.1726.stringtemplate-interest@antlr.org>
	<455868FD.6020801@hmn.aphp.fr> <4558C6E6.8060407@n4te.com>
Message-ID: <4559ED21.6070801@hmn.aphp.fr>

Hi Nate,

You are right, I made a simple application to try out what you suggested.

The code is here :

    InputStream ins =
      getClass().getResourceAsStream("/stringtemplate_test/grouptest.stg");
    InputStreamReader in = new InputStreamReader(ins);
    StringTemplateGroup g = 
      new StringTemplateGroup(in);
    StringTemplate st = g.getInstanceOf("hello");
    String r = st.toString();    
    System.out.println("r="+r);


If I use this template :

group grouptest;
hello() ::= "<world()>"
world() ::= "Hello from inside of group"


I will as expected get the following output :

r=Hello from inside of group


Now if I remove the declaration for world(), and put instead a template 
file |world.st|, st won't find the
template, wether I put it in the classpath at 
stringtemplate_test/world.st, the local filesystem, etc.

I ran the program with a debugger, and in fact it seems that st while 
parsing the group records
records that it didn't find the template and associates the special 
value NOT_FOUND_ST with the name.
So any further attempt to load the template will fail.
As I can see from the comment of "templatesDefinedInGroupFile" variable, 
this is what was intended,
so I guess for now either everything is inside a group file, or 
everything is inside individual template files.
There does not seem to be any inbetween.
I guess this could be customized using StringTemplateGroupLoader, but I 
didn't check further.

Hope this helps,

                                                       Harry Karadimas
/______________________________________________________________________
Dr Harry Karadimas  Medecin Ingenieur resp. Recherche et Developpement
Departement d'Information Hospitalier
CHU Henri Mondor 51, av. du Mal de Lattre de Tassigny   94010  CRETEIL
tel : (00 33 1) 49 81 21 79                fax : (00 33 1) 49 81 27 08
secr.: (00 33 1) 49 81 23 82 m.el.:harry.karadimas at hmn.ap-hop-paris.fr
/



Nate a ?crit :
> Hi Harry, please see my list message in reply to Jean-Marie (sent 
> 11/12/06). I realize that I can access templates on the classpath 
> using a path relative to the root of the classpath. However, I want to 
> access templates on the classpath based on a root directory. This can 
> be done on the filesystem and, IMHO, should also be possible on the 
> classpath.
>
> Thanks,
> -Nate
>
>
> Harry Karadimas wrote:
>> Put your files in /WEB-INF/classes, and try "/" in front of your 
>> path, e.g.
>> */*skins/redtheme/etc.st
>>                                                        Harry Karadimas
>> /______________________________________________________________________
>> Dr Harry Karadimas  Medecin Ingenieur resp. Recherche et Developpement
>> Departement d'Information Hospitalier
>> CHU Henri Mondor 51, av. du Mal de Lattre de Tassigny   94010  CRETEIL
>> tel : (00 33 1) 49 81 21 79                fax : (00 33 1) 49 81 27 08
>> secr.: (00 33 1) 49 81 23 82 m.el.:harry.karadimas at hmn.ap-hop-paris.fr
>> /
>>
>>
>> stringtemplate-interest-request at antlr.org a ?crit :
>>> Send stringtemplate-interest mailing list submissions to
>>>     stringtemplate-interest at antlr.org
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>     http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>>> or, via email, send a message with subject or body 'help' to
>>>     stringtemplate-interest-request at antlr.org
>>>
>>> You can reach the person managing the list at
>>>     stringtemplate-interest-owner at antlr.org
>>>
>>> When replying, please edit your Subject line so it is more specific
>>> than "Re: Contents of stringtemplate-interest digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>    1. use template groups in a WAR (Nate)
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Fri, 10 Nov 2006 17:44:23 -0800
>>> From: Nate <misc at n4te.com>
>>> Subject: [stringtemplate-interest] use template groups in a WAR
>>> To: stringtemplate-interest at antlr.org
>>> Message-ID: <45552AF7.4080904 at n4te.com>
>>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>>
>>> I am writing a web application. I want to use StringTemplate to 
>>> generate the HTML pages. I want users to be able to select a "skin" 
>>> from a list. Each skin would use a different set of templates to 
>>> display the HTML.
>>>
>>> My initial impression is that I'd use a different 
>>> StringTemplateGroup for each skin. I imagined a file structure like 
>>> this...
>>>
>>> skins/redtheme/page.st
>>> skins/redtheme/etc.st
>>> skins/bluetheme/page.st
>>> skins/bluetheme/etc.st
>>>
>>> ...the code would be something like...
>>>
>>> skinName = "redtheme";
>>> group = new StringTemplateGroup(skinName, "skins");
>>> group.getInstanceOf("page");
>>> group.getInstanceOf("etc");
>>>
>>> This works fine on the filesystem. Now I zip my application up into 
>>> a WAR file and suddenly the templates cannot be found. Next I think 
>>> I should look up templates using the classpath. StringTemplate 
>>> documentation leads me to think I need to use code like this...
>>>
>>> skinName = "redtheme";
>>> group = new StringTemplateGroup("allSkins");
>>> group.getInstanceOf("skins/" + skinName + "/page");
>>> group.getInstanceOf("skins/" + skinName + "/etc");
>>>
>>> There is no "rootDir" when using the classpath, so I cannot use the 
>>> a StringTemplateGroup for each skin, like I could on the filesystem.
>>>
>>> What is the solution? How do other people do it? Why does it work so 
>>> differently when JARed or WARed?
>>>
>>> Regards,
>>> Nathan Sweet
>>>     
>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061114/6cdb1df0/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: harry.karadimas.vcf
Type: text/x-vcard
Size: 407 bytes
Desc: not available
Url : http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061114/6cdb1df0/attachment.vcf 

From misc at n4te.com  Tue Nov 14 15:09:34 2006
From: misc at n4te.com (Nate)
Date: Tue, 14 Nov 2006 15:09:34 -0800
Subject: [stringtemplate-interest] best way to expose xml in template
Message-ID: <455A4CAE.5030606@n4te.com>

My application gets all of its data from a server as XML. What is a good 
way to expose this data to my StringTemplate templates? I could use a 
parser such as XOM, stuff the data into Lists or Maps and then push 
those into the templates as attributes. Are there other solutions?

Thanks,
-Nate

From rajesh.kathgave at gmail.com  Tue Nov 14 21:52:52 2006
From: rajesh.kathgave at gmail.com (rajesh kathgave)
Date: Wed, 15 Nov 2006 11:22:52 +0530
Subject: [stringtemplate-interest] drools with stringtemplate
Message-ID: <903fcb530611142152t6e688bd6oe3c6f023bf5cdcd6@mail.gmail.com>

Hello all,
This is raj. I am trying to use StringTemplate to dynamically build
.drl(drools)file.If there is anyone working on the same issue let us share
the info together.
Regards,
Raj.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061115/02fcf036/attachment.html 

From parrt at cs.usfca.edu  Wed Nov 15 10:11:38 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 15 Nov 2006 10:11:38 -0800
Subject: [stringtemplate-interest] behind in my email
Message-ID: <E2BC213D-A1A3-4A6D-8DF8-AED0824FA241@cs.usfca.edu>

hi, I'm way behind in email at the moment...will catch up soon.

Ter

From rob.hill at blueyonder.co.uk  Sat Nov 18 11:44:38 2006
From: rob.hill at blueyonder.co.uk (Robert Hill)
Date: Sat, 18 Nov 2006 19:44:38 -0000
Subject: [stringtemplate-interest] String template 3.0 bug.
Message-ID: <20061118194452.89863190505@www.antlr.org>

Hi all, just found another odd ST3 bug,

Mismatched <endif> tags aren't reported, but they stop processing the
template at that point. A bit difficult to find if they templates are
nested, and the <if><endif> expansion is small. Watch out!

Cheers!
Rob




From rhill03 at EDS.com  Tue Nov 21 23:27:28 2006
From: rhill03 at EDS.com (Hill, Robert)
Date: Wed, 22 Nov 2006 07:27:28 -0000
Subject: [stringtemplate-interest] Output string lengths..
Message-ID: <2E909902FD3A03419E3A905908AE3DD402A06D64@UKNSM201.emea.corp.eds.com>

Is there anyway I can make each string in a list be rendered at a
minimum length? 
Id like some things to line up in columns, and want to avoid any sort of
formatting occuring in the code, before I stuff the strings into the
templates.

Is this a job for a custom format renderer, or is there a way to do this
directly within string template?

Ta!

Regards, 

Rob

Robert Hill
Information Engineer
E	UKIMEA DWP ACU, Hallamshire Business Park, 100 Napier St,
Sheffield. S11 8HD
email:	rhill03 at eds.com
Office:	+44 114 291 1928
Mobile:	+44 7903 185 516


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061122/c63359cc/attachment.html 

From parrt at cs.usfca.edu  Mon Nov 27 09:05:01 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 27 Nov 2006 09:05:01 -0800
Subject: [stringtemplate-interest] public sign-up off on the wiki
Message-ID: <E556E8B4-A37F-4767-9BD4-C4E0013513FA@cs.usfca.edu>

Hi, I had to turn off public sign-up of new users because some jerk  
was signing up with a bunch of spam usernames.  If you would like to  
be a user of the wiki so that you can add content, please e-mail me  
and I will add you.  I need your full name and e-mail address.

Thanks,
Ter

From misc at n4te.com  Mon Nov 27 13:59:15 2006
From: misc at n4te.com (Nate)
Date: Mon, 27 Nov 2006 13:59:15 -0800
Subject: [stringtemplate-interest] super template named default
Message-ID: <456B5FB3.5050000@n4te.com>

Template file:
group moo : default;

Error:
template group parse error
line 1:13: expecting ID, found 'default'

If I rename the "default" template to something else it works. :(

-Nate

From misc at n4te.com  Mon Nov 27 14:17:42 2006
From: misc at n4te.com (Nate)
Date: Mon, 27 Nov 2006 14:17:42 -0800
Subject: [stringtemplate-interest] group loading is messy
Message-ID: <456B6406.5060804@n4te.com>

Why is group loading so messy?

The worst part is that a .ST group file and a directory containing 
templates are really two different kinds of groups. Eg, I have this 
directory structure...

redskin/template1.st
redskin/template2.st
blueskin/template2.st

I want blueskin to extend redskin. The way I ended up doing this is to 
create a text file named "supergroup" which contains the name of the 
super group, which I manually load and call setSuperGroup. Why can't I 
have a .ST file that defines the template group and the directory? This 
way I could define the super group in the .ST file as well as templates 
AND I could have template files in the same directory. Currently I can't 
mix defining templates in a group file and using a directory of templates.

I am feeling frustrated by the StringTemplate API. It feels like there 
has been a few development iterations that added major new features, but 
did so without breaking the older API. The result is an API that is 
awkward and frustrating to use. Are there plans for the next iteration 
of StringTemplate to break backwards compatibility so that the API can 
be cleaned up?

-Nate


From caleb.lyness at ezswitch.net  Mon Nov 27 15:36:02 2006
From: caleb.lyness at ezswitch.net (Caleb Lyness)
Date: Tue, 28 Nov 2006 00:36:02 +0100
Subject: [stringtemplate-interest] group loading is messy
In-Reply-To: <456B6406.5060804@n4te.com>
References: <456B6406.5060804@n4te.com>
Message-ID: <456B7662.3030906@ezswitch.net>

Nate wrote:
> Why is group loading so messy?
>   
Because you are using a square peg for a round hole?
> The worst part is that a .ST group file and a directory containing 
> templates are really two different kinds of groups. Eg, I have this 
> directory structure...
>
> redskin/template1.st
> redskin/template2.st
> blueskin/template2.st
>
> I want blueskin to extend redskin. The way I ended up doing this is to 
> create a text file named "supergroup" which contains the name of the 
> super group, which I manually load and call setSuperGroup. Why can't I 
> have a .ST file that defines the template group and the directory? This 
> way I could define the super group in the .ST file as well as templates 
> AND I could have template files in the same directory. Currently I can't 
> mix defining templates in a group file and using a directory of templates.
Group file (stg) and template files serve a different purpose.

I have something similar though,

generic/template1.st
generic/template2.st
generic/resgroup1.stg

skin1/template2.st

skin2/template1.st
generic/resgroup1.st

I wrote a wee class which loads the group file in a hierarchically way
and I removed my custom class loader and replaced it with something based
on the one email /you /sent a couple of weeks back (Thanks - its a
simple solution).

I wanted something like this:
skin/template.st -> generic/template.st -> skin/resgroup1.st ->
generic/resgroup1.st

(Actually a little more complex, because I have common templates and
language based templates too,
but it illustrates the example)

So for the first part:

final Vector<File>        searchPath = new Vector<File>(4);
....
// Fill in the search path with the thing you want to inherit from in
order. Like you would with the jar classpath
,,,,

        templateGroup = new StringTemplateGroup("templates") {
            protected StringTemplate
loadTemplateFromBeneathRootDirOrCLASSPATH (String fileName)
            {
                for (File dir: searchPath) {                   
                    String file = new File(dir,fileName).toString();   
               
                    StringTemplate result =
super.loadTemplateFromBeneathRootDirOrCLASSPATH(file);
                    if (result != null) {        
                        return result;
                    }
                }
                return null;
            }
        };
        templateGroup.setSuperGroup(resourceGroup);

There is nothing stopping you from defining a resource group which knows
how to define the search path
for your templates. That way you don't need to hard code 'em. If you are
complaining about having to manually
join the group templates and template files.


Cheers
     Caleb
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061128/7e17766a/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3269 bytes
Desc: S/MIME Cryptographic Signature
Url : http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061128/7e17766a/attachment.bin 

From jbriant at highmoonstudios.com  Mon Nov 27 17:48:33 2006
From: jbriant at highmoonstudios.com (Jamie Briant)
Date: Mon, 27 Nov 2006 17:48:33 -0800
Subject: [stringtemplate-interest] ST# woes
Message-ID: <DDE09233DE8FB842BC45AAC0A8218E0A0341F70D@hermes.sammystudios.com>

I've downloaded the C# StringTemplate 2.2 project and built it. Then I
downloaded the examples from the 2.2 wiki page. However, all the
StringTemplate classes etc are in the namespace "antlr.stringtemplate",
while the example project references "Antlr.StringTemplate". All the
accessors are "getFoo" but the examples use "GetFoo". Any help
appreciated!

 

James Briant

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061127/e91581a5/attachment.html 

From parrt at cs.usfca.edu  Mon Nov 27 18:09:52 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 27 Nov 2006 18:09:52 -0800
Subject: [stringtemplate-interest] super template named default
In-Reply-To: <456B5FB3.5050000@n4te.com>
References: <456B5FB3.5050000@n4te.com>
Message-ID: <34BA57D4-616E-4702-BE22-BDE9953ED1CA@cs.usfca.edu>

Hi. sorry about that.  I need a better error message on this but you  
cannot use keywords for method names.  I believe default is the key  
word in the map construct.

Terence
On Nov 27, 2006, at 1:59 PM, Nate wrote:

> Template file:
> group moo : default;
>
> Error:
> template group parse error
> line 1:13: expecting ID, found 'default'
>
> If I rename the "default" template to something else it works. :(
>
> -Nate
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest


From misc at n4te.com  Mon Nov 27 18:34:58 2006
From: misc at n4te.com (Nate)
Date: Mon, 27 Nov 2006 18:34:58 -0800
Subject: [stringtemplate-interest] super template named default
In-Reply-To: <34BA57D4-616E-4702-BE22-BDE9953ED1CA@cs.usfca.edu>
References: <456B5FB3.5050000@n4te.com>
	<34BA57D4-616E-4702-BE22-BDE9953ED1CA@cs.usfca.edu>
Message-ID: <456BA052.7030903@n4te.com>

Ah, of course you are right. Isn't it possible to know that we are in 
the context of parsing a group definition (where the keyword would be a 
valid group name) and not map declaration?

-Nate


Terence Parr wrote:

>Hi. sorry about that.  I need a better error message on this but you  
>cannot use keywords for method names.  I believe default is the key  
>word in the map construct.
>
>Terence
>On Nov 27, 2006, at 1:59 PM, Nate wrote:
>
>  
>
>>Template file:
>>group moo : default;
>>
>>Error:
>>template group parse error
>>line 1:13: expecting ID, found 'default'
>>
>>If I rename the "default" template to something else it works. :(
>>
>>-Nate
>>_______________________________________________
>>stringtemplate-interest mailing list
>>stringtemplate-interest at antlr.org
>>http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>>    
>>
>
>_______________________________________________
>stringtemplate-interest mailing list
>stringtemplate-interest at antlr.org
>http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>  
>

From Kunle_Odutola at hotmail.com  Tue Nov 28 05:39:26 2006
From: Kunle_Odutola at hotmail.com (Kunle Odutola)
Date: Tue, 28 Nov 2006 13:39:26 -0000
Subject: [stringtemplate-interest] ST# woes
References: <DDE09233DE8FB842BC45AAC0A8218E0A0341F70D@hermes.sammystudios.com>
Message-ID: <BAY120-DAV899B694956FBAA472390C81E50@phx.gbl>

You want ST# 2.3 or later. Grab 3.0 unless you have a specific reason not
to.

Kunle

----- Original Message ----- 
From: "Jamie Briant" <jbriant at highmoonstudios.com>
To: <stringtemplate-interest at antlr.org>
Sent: Tuesday, November 28, 2006 1:48 AM
Subject: [stringtemplate-interest] ST# woes


I've downloaded the C# StringTemplate 2.2 project and built it. Then I
downloaded the examples from the 2.2 wiki page. However, all the
StringTemplate classes etc are in the namespace "antlr.stringtemplate",
while the example project references "Antlr.StringTemplate". All the
accessors are "getFoo" but the examples use "GetFoo". Any help
appreciated!



James Briant




----------------------------------------------------------------------------
----


> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>


From jab.antlr at species.org  Tue Nov 28 08:35:00 2006
From: jab.antlr at species.org (James Briant)
Date: Tue, 28 Nov 2006 08:35:00 -0800
Subject: [stringtemplate-interest] C# 3.0?
Message-ID: <e063fb510611280835o22630228xa80bb92681fbb264@mail.gmail.com>

I tried unsuccessfully using group files with 2.3b5. Do you have any example
projects that use group files? The specific problem was that it expected
$foo$ instead of <foo> and I also had trouble trying to figure out how to
load group files automatically. Is 3.0 available for download for C#?

Thanks,

Jamie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061128/9c2ad284/attachment.html 

From Kunle_Odutola at hotmail.com  Tue Nov 28 10:21:51 2006
From: Kunle_Odutola at hotmail.com (Kunle Odutola)
Date: Tue, 28 Nov 2006 18:21:51 -0000
Subject: [stringtemplate-interest] C# 3.0?
References: <e063fb510611280835o22630228xa80bb92681fbb264@mail.gmail.com>
Message-ID: <BAY120-DAV89FF6DDC794F39C86497981E50@phx.gbl>

Hi,

> I tried unsuccessfully using group files with 2.3b5.

They work fine.

> Do you have any example projects that use group files?

The documentation should have examples.

> The specific problem was that it expected
> $foo$ instead of <foo> and I also had trouble trying to figure out how to
> load group files automatically.

You might need to specify a specific template lexer.
AngleBracketTemplateLexer does <..> and DefaultTemplateLexer does $..$

> Is 3.0 available for download for C#?

Should be on the site. Ter?


Kunle




From jbriant at highmoonstudios.com  Tue Nov 28 10:31:33 2006
From: jbriant at highmoonstudios.com (Jamie Briant)
Date: Tue, 28 Nov 2006 10:31:33 -0800
Subject: [stringtemplate-interest] C# 3.0?
Message-ID: <DDE09233DE8FB842BC45AAC0A8218E0A0341F710@hermes.sammystudios.com>

I think my problem is group files. The documentation (both the html file
in the zip and the wiki) load a group file using a string reader, and
then hints that they are named with ".stg". I have large templates that
would best go in a .st file (such as an xml file), but I also have lots
of little templates that I'd like in a .stg file. How does one have the
.stg file reference other templates or groups that they extend??

Thanks!

Jamie

-----Original Message-----
From: stringtemplate-interest-bounces at antlr.org
[mailto:stringtemplate-interest-bounces at antlr.org] On Behalf Of Kunle
Odutola
Sent: Tuesday, November 28, 2006 10:22 AM
To: stringtemplate-interest at antlr.org
Subject: Re: [stringtemplate-interest] C# 3.0?

Hi,

> I tried unsuccessfully using group files with 2.3b5.

They work fine.

> Do you have any example projects that use group files?

The documentation should have examples.

> The specific problem was that it expected
> $foo$ instead of <foo> and I also had trouble trying to figure out how
to
> load group files automatically.

You might need to specify a specific template lexer.
AngleBracketTemplateLexer does <..> and DefaultTemplateLexer does $..$

> Is 3.0 available for download for C#?

Should be on the site. Ter?


Kunle



_______________________________________________
stringtemplate-interest mailing list
stringtemplate-interest at antlr.org
http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest

From parrt at cs.usfca.edu  Tue Nov 28 11:47:19 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 28 Nov 2006 11:47:19 -0800
Subject: [stringtemplate-interest] C# 3.0?
In-Reply-To: <BAY120-DAV89FF6DDC794F39C86497981E50@phx.gbl>
References: <e063fb510611280835o22630228xa80bb92681fbb264@mail.gmail.com>
	<BAY120-DAV89FF6DDC794F39C86497981E50@phx.gbl>
Message-ID: <67CF1972-7F04-425A-BEBC-00A39429C898@cs.usfca.edu>

Crap!  I still have that in my list of e-mail Windows open... crap, I  
will do that today!
Ter
On Nov 28, 2006, at 10:21 AM, Kunle Odutola wrote:

> Hi,
>
>> I tried unsuccessfully using group files with 2.3b5.
>
> They work fine.
>
>> Do you have any example projects that use group files?
>
> The documentation should have examples.
>
>> The specific problem was that it expected
>> $foo$ instead of <foo> and I also had trouble trying to figure out  
>> how to
>> load group files automatically.
>
> You might need to specify a specific template lexer.
> AngleBracketTemplateLexer does <..> and DefaultTemplateLexer does $..$
>
>> Is 3.0 available for download for C#?
>
> Should be on the site. Ter?
>
>
> Kunle
>
>
>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest


From misc at n4te.com  Tue Nov 28 12:48:16 2006
From: misc at n4te.com (Nate)
Date: Tue, 28 Nov 2006 12:48:16 -0800
Subject: [stringtemplate-interest] group loading is messy
In-Reply-To: <456B7662.3030906@ezswitch.net>
References: <456B6406.5060804@n4te.com> <456B7662.3030906@ezswitch.net>
Message-ID: <456CA090.6010300@n4te.com>

I see. I guess my problem is that it is so loosely defined. I expected 
some features out of the box. When I find they don't exist, I go to look 
at how to implement them and run into a somewhat daunting API. I 
shouldn't have to hack on the StringTemplate internals to get the 
behavior I desire. If I were off the beaten path, then is would be great 
that this is possible at all. However, I feel like I am doing standard 
stuff that most users will do.

A parallel might be JDOM vs XOM. They both do the same thing, but with 
the XOM API there is only one way to do a task. This may seem less 
powerful, but with a carefully designed API it doesn't have to be.

Looking at the StringTemplate source, there are many protected members. 
These are part of the public API and can't be changed without 
potentially breaking people's code. When the internals are exposed like 
this it allows people to extend the class and muck around, but it also 
means that if the software goes through an iteration that adds major new 
features, this legacy API must be maintained. The StringTemplate API 
feels to me as if this had happened. It doesn't feel "tight".

For example, have you ever tried to load template files with an 
extension other than "st"? Apparently this can only be done by extending 
StringTemplateGroup and overriding getFileNameFromTemplateName, which 
consists of this code...
    return templateName+".st";
Oops! Don't forget to also override getTemplateNameFromFileName which 
consists of this code...
    String name = fileName;
    int suffix = name.lastIndexOf(".st");
    if ( suffix>=0 ) {
        name = name.substring(0, suffix);
    }
    return name;
Are there other methods that need to be overridden? The way to find out 
is to read the StringTemplate code, potentially all of the code.

Anyway, I don't mean to knock StringTemplate too hard as I do think it 
is great. I just think the API could use some TLC. It seems the 
necessary changes could be made if a release were made that is not 
backwards compatible.

-Nate


Caleb Lyness wrote:
> Nate wrote:
>> Why is group loading so messy?
>>   
> Because you are using a square peg for a round hole?
>> The worst part is that a .ST group file and a directory containing 
>> templates are really two different kinds of groups. Eg, I have this 
>> directory structure...
>>
>> redskin/template1.st
>> redskin/template2.st
>> blueskin/template2.st
>>
>> I want blueskin to extend redskin. The way I ended up doing this is to 
>> create a text file named "supergroup" which contains the name of the 
>> super group, which I manually load and call setSuperGroup. Why can't I 
>> have a .ST file that defines the template group and the directory? This 
>> way I could define the super group in the .ST file as well as templates 
>> AND I could have template files in the same directory. Currently I can't 
>> mix defining templates in a group file and using a directory of templates.
> Group file (stg) and template files serve a different purpose.
>
> I have something similar though,
>
> generic/template1.st
> generic/template2.st
> generic/resgroup1.stg
>
> skin1/template2.st
>
> skin2/template1.st
> generic/resgroup1.st
>
> I wrote a wee class which loads the group file in a hierarchically way
> and I removed my custom class loader and replaced it with something based
> on the one email /you /sent a couple of weeks back (Thanks - its a 
> simple solution).
>
> I wanted something like this:
> skin/template.st -> generic/template.st -> skin/resgroup1.st -> 
> generic/resgroup1.st
>
> (Actually a little more complex, because I have common templates and 
> language based templates too,
> but it illustrates the example)
>
> So for the first part:
>
> final Vector<File>        searchPath = new Vector<File>(4);
> ....
> // Fill in the search path with the thing you want to inherit from in 
> order. Like you would with the jar classpath
> ,,,,
>
>         templateGroup = new StringTemplateGroup("templates") {
>             protected StringTemplate 
> loadTemplateFromBeneathRootDirOrCLASSPATH (String fileName)
>             {
>                 for (File dir: searchPath) {                   
>                     String file = new 
> File(dir,fileName).toString();                   
>                     StringTemplate result = 
> super.loadTemplateFromBeneathRootDirOrCLASSPATH(file);
>                     if (result != null) {        
>                         return result;
>                     }
>                 }
>                 return null;
>             }
>         };
>         templateGroup.setSuperGroup(resourceGroup);
>
> There is nothing stopping you from defining a resource group which 
> knows how to define the search path
> for your templates. That way you don't need to hard code 'em. If you 
> are complaining about having to manually
> join the group templates and template files.
>
>
> Cheers
>      Caleb


From parrt at cs.usfca.edu  Tue Nov 28 15:25:52 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 28 Nov 2006 15:25:52 -0800
Subject: [stringtemplate-interest] ST# 3.0.1 posted
Message-ID: <17EB4C03-5AA3-4B76-B873-A000B63E96D1@cs.usfca.edu>

Here it is...Kunle and Michael had it done earlier, but like a moron,  
I forgot to post.

http://www.stringtemplate.org/download.html

Terence

From parrt at cs.usfca.edu  Tue Nov 28 17:27:29 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 28 Nov 2006 17:27:29 -0800
Subject: [stringtemplate-interest] Attribute not found exception?
	Revisited
In-Reply-To: <45524229.8020401@ezswitch.net>
References: <45524229.8020401@ezswitch.net>
Message-ID: <D642C961-E1E8-4D88-8B32-B1F532CFB418@cs.usfca.edu>


On Nov 8, 2006, at 12:46 PM, Caleb Lyness wrote:
>
> With ref to the following thread:
> http://www.antlr.org:8080/pipermail/stringtemplate-interest/2006- 
> March/000291.html
>
> * I am looking for a way to ask a template what attributes it is  
> using/wanting.
> So far I have overloaded a Map class which records which keys are  
> requested.
> I pass this in as the attributes list. At the end of a template gen  
> I know what was
> requested and what was not.
>
> Q: Can I do this with out actually rendering, (via toString())...  
> i.e. is there another way?

Hi Caleb.  Can you override StringTemplate.	public Object getAttribute 
(String name)?  Then map ST name to Set of attribute names.  This  
will catch every reference to an attribute with in every template,  
but it does not say which are optional.  Hmm... to track those that  
are missing but referenced, it seems like you could override  
something in ASTExpr to render "missing attr" or something.
Ter

From parrt at cs.usfca.edu  Tue Nov 28 17:29:27 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 28 Nov 2006 17:29:27 -0800
Subject: [stringtemplate-interest] best way to expose xml in template
In-Reply-To: <455A4CAE.5030606@n4te.com>
References: <455A4CAE.5030606@n4te.com>
Message-ID: <5532E9E7-D27B-42A9-8491-9F0124C57624@cs.usfca.edu>


On Nov 14, 2006, at 3:09 PM, Nate wrote:

> My application gets all of its data from a server as XML. What is a  
> good
> way to expose this data to my StringTemplate templates? I could use a
> parser such as XOM, stuff the data into Lists or Maps and then push
> those into the templates as attributes. Are there other solutions?

Send in an object that implements the Map interface. In this way you  
can ask for some named data. Would be very very sure that you have no  
side effects in the map implementation of get().
Ter


From parrt at cs.usfca.edu  Tue Nov 28 17:30:56 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 28 Nov 2006 17:30:56 -0800
Subject: [stringtemplate-interest] String template 3.0 bug.
In-Reply-To: <20061118194452.89863190505@www.antlr.org>
References: <20061118194452.89863190505@www.antlr.org>
Message-ID: <EEE231A7-FD78-4987-B6BE-90E9EB269302@cs.usfca.edu>

Added bug report:

http://www.antlr.org:8888/browse/ST-8

Ter
On Nov 18, 2006, at 11:44 AM, Robert Hill wrote:

> Hi all, just found another odd ST3 bug,
>
> Mismatched <endif> tags aren't reported, but they stop processing the
> template at that point. A bit difficult to find if they templates are
> nested, and the <if><endif> expansion is small. Watch out!
>
> Cheers!
> Rob
>
>
>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest


From parrt at cs.usfca.edu  Tue Nov 28 17:32:39 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 28 Nov 2006 17:32:39 -0800
Subject: [stringtemplate-interest] Output string lengths..
In-Reply-To: <2E909902FD3A03419E3A905908AE3DD402A06D64@UKNSM201.emea.corp.eds.com>
References: <2E909902FD3A03419E3A905908AE3DD402A06D64@UKNSM201.emea.corp.eds.com>
Message-ID: <81CEAAA6-68FB-44C3-B357-AFB87E82303D@cs.usfca.edu>


On Nov 21, 2006, at 11:27 PM, Hill, Robert wrote:

> Is there anyway I can make each string in a list be rendered at a  
> minimum length?
I cannot think of anything off the top of my head, other than some  
kind of renderer that automatically pads the toString() output of its  
wrapped object if the output is less than a particular length.

Ter


From rhill03 at eds.com  Wed Nov 29 02:50:49 2006
From: rhill03 at eds.com (Hill, Robert)
Date: Wed, 29 Nov 2006 10:50:49 -0000
Subject: [stringtemplate-interest] Output string lengths..
In-Reply-To: <81CEAAA6-68FB-44C3-B357-AFB87E82303D@cs.usfca.edu>
Message-ID: <2E909902FD3A03419E3A905908AE3DD402A07A13@UKNSM201.emea.corp.eds.com>

Ok, cheers Ter
	I'll write myself a custom renderer to do this. 

Thanks!

Rob

Robert Hill
Information Engineer
EDS UKIMEA DWP ACU, Hallamshire Business Park, 100 Napier St, Sheffield.
S11 8HD
email:	rhill03 at eds.com
Office:	+44 114 291 1928
Mobile:	+44 7903 185 516

 

>-----Original Message-----
>From: stringtemplate-interest-bounces at antlr.org 
>[mailto:stringtemplate-interest-bounces at antlr.org] On Behalf 
>Of Terence Parr
>Sent: 29 November 2006 01:33
>To: StringTemplate
>Subject: Re: [stringtemplate-interest] Output string lengths..
>
>
>On Nov 21, 2006, at 11:27 PM, Hill, Robert wrote:
>
>> Is there anyway I can make each string in a list be rendered at a 
>> minimum length?
>I cannot think of anything off the top of my head, other than 
>some kind of renderer that automatically pads the toString() 
>output of its wrapped object if the output is less than a 
>particular length.
>
>Ter
>
>_______________________________________________
>stringtemplate-interest mailing list
>stringtemplate-interest at antlr.org
>http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>

From Kunle_Odutola at hotmail.com  Wed Nov 29 04:13:11 2006
From: Kunle_Odutola at hotmail.com (Kunle Odutola)
Date: Wed, 29 Nov 2006 12:13:11 -0000
Subject: [stringtemplate-interest] C# 3.0?
References: <DDE09233DE8FB842BC45AAC0A8218E0A0341F710@hermes.sammystudios.com>
Message-ID: <BAY120-DAV16104D98A7E028CA21652981E40@phx.gbl>

Hi,

> I think my problem is group files. The documentation (both the html file
> in the zip and the wiki) load a group file using a string reader, and
> then hints that they are named with ".stg". I have large templates that
> would best go in a .st file (such as an xml file), but I also have lots
> of little templates that I'd like in a .stg file. How does one have the
> .stg file reference other templates or groups that they extend??

Use the group inheritance feature. Have the group that manages your .st
templates (groupST) be the supergroup of the .stg based ST group (groupSTG).

Templates in groupSTG can then refer to templates in groupST as usual and
they will be located (assuming unique names across both groups).

Kunle


From jjsnyders at rcn.com  Wed Nov 29 07:37:53 2006
From: jjsnyders at rcn.com (John Snyders)
Date: Wed, 29 Nov 2006 10:37:53 -0500
Subject: [stringtemplate-interest] Output string lengths..
In-Reply-To: <81CEAAA6-68FB-44C3-B357-AFB87E82303D@cs.usfca.edu>
Message-ID: <PMEOJKDLMMHOHNEAMPBGOEEDCAAA.jjsnyders@rcn.com>

I think that this is another case for the option syntax. For example:

$name;pad=20$

This would make sure that the value of name was padded with enough space
characters so that it was at least 20 characters.

The reason I think that option syntax is preferred over a custom renderer is
that this is another case where the template needs to be in control over the
format.

The render is fine for making sure the rules of HTML or SQL are followed and
also good at localization but when the template needs to decide on the
format the option syntax is the way to go.

-John

-----Original Message-----
From: stringtemplate-interest-bounces at antlr.org
[mailto:stringtemplate-interest-bounces at antlr.org]On Behalf Of Terence
Parr
Sent: Tuesday, November 28, 2006 8:33 PM
To: StringTemplate
Subject: Re: [stringtemplate-interest] Output string lengths..



On Nov 21, 2006, at 11:27 PM, Hill, Robert wrote:

> Is there anyway I can make each string in a list be rendered at a
> minimum length?
I cannot think of anything off the top of my head, other than some
kind of renderer that automatically pads the toString() output of its
wrapped object if the output is less than a particular length.

Ter

_______________________________________________
stringtemplate-interest mailing list
stringtemplate-interest at antlr.org
http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest

From parrt at cs.usfca.edu  Wed Nov 29 08:29:40 2006
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 29 Nov 2006 08:29:40 -0800
Subject: [stringtemplate-interest] Output string lengths..
In-Reply-To: <2E909902FD3A03419E3A905908AE3DD402A07A13@UKNSM201.emea.corp.eds.com>
References: <2E909902FD3A03419E3A905908AE3DD402A07A13@UKNSM201.emea.corp.eds.com>
Message-ID: <7F0BF976-6DEC-4A6A-8C8E-759D977D5E96@cs.usfca.edu>

You could add this to the FAQ for ST too :)

Ter
On Nov 29, 2006, at 2:50 AM, Hill, Robert wrote:

> Ok, cheers Ter
> 	I'll write myself a custom renderer to do this.
>
> Thanks!
>
> Rob
>
> Robert Hill
> Information Engineer
> EDS UKIMEA DWP ACU, Hallamshire Business Park, 100 Napier St,  
> Sheffield.
> S11 8HD
> email:	rhill03 at eds.com
> Office:	+44 114 291 1928
> Mobile:	+44 7903 185 516
>
>
>
>> -----Original Message-----
>> From: stringtemplate-interest-bounces at antlr.org
>> [mailto:stringtemplate-interest-bounces at antlr.org] On Behalf
>> Of Terence Parr
>> Sent: 29 November 2006 01:33
>> To: StringTemplate
>> Subject: Re: [stringtemplate-interest] Output string lengths..
>>
>>
>> On Nov 21, 2006, at 11:27 PM, Hill, Robert wrote:
>>
>>> Is there anyway I can make each string in a list be rendered at a
>>> minimum length?
>> I cannot think of anything off the top of my head, other than
>> some kind of renderer that automatically pads the toString()
>> output of its wrapped object if the output is less than a
>> particular length.
>>
>> Ter
>>
>> _______________________________________________
>> stringtemplate-interest mailing list
>> stringtemplate-interest at antlr.org
>> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest
>>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org:8080/mailman/listinfo/stringtemplate-interest


From jjsnyders at rcn.com  Wed Nov 29 11:01:48 2006
From: jjsnyders at rcn.com (John Snyders)
Date: Wed, 29 Nov 2006 14:01:48 -0500
Subject: [stringtemplate-interest] Output string lengths..
In-Reply-To: <2E909902FD3A03419E3A905908AE3DD402A06D64@UKNSM201.emea.corp.eds.com>
Message-ID: <PMEOJKDLMMHOHNEAMPBGMEEECAAA.jjsnyders@rcn.com>

Output string lengths..Here is a crazy thought.

If you could iterate over the characters in a string then the template could
do the padding.
I created a function "chars" which returns an iterator for its string
argument.
For example
  $s1$
  $chars(s1); separator="-"$
will produce
  SOMETHING
  S-O-M-E-T-H-I-N-G
when s1="SOMETHING"

With these attributes added in the controller:
  test.setAttribute("s1", "SOMETHING");
  test.setAttribute("s2", "NOTHING");
  test.setAttribute("space40", "                                        ");

This template
  |$chars(s1),chars(space40): { ch, sp | $ch;null={$sp$}$}$|
  |$chars(s2),chars(space40): { ch, sp | $ch;null={$sp$}$}$|

produces this output
  |SOMETHING                               |
  |NOTHING                                 |
(forgive the proportional font of this email)

Does the chars function have any other use? Well it could be used to do what
the CSS pseudo element ":first-letter" does. For example:
  <span class="fancy">$first(chars(s1))$</span>$rest(chars(s1))$
produces:
  <span class="fancy">S</span>OMETHING

This gives some stylistic control over individual letters to the template.

What do people think, is the chars function useful?
As for padding, I'm not sure I like this solution better than the pad
option.

-John

Here is the code just incase someone wants to play with this:

Added to ASTExpr.java
private static class StringIterator implements Iterator
{
 private String str;
 private int index;
 public StringIterator(String str) {
  this.str = str;
  index = 0;
 }
 public boolean hasNext() {
  return index < str.length();
 }

 public Object next() {
  String next = String.valueOf(str.charAt(index));
  index++;
  return next;
 }

 public void remove() {
  throw new UnsupportedOperationException();
 }

}

public Object chars(Object attribute) {
 if ( attribute==null ) {
  return null;
 }
 Object chars = null;
 if ( attribute instanceof String ) {
  String str = (String)attribute;
  chars = new StringIterator(str);
 }
 else if ( attribute instanceof StringTemplate )
 {
    StringTemplate st = (StringTemplate)attribute;
    String str = st.toString();
    chars = new StringIterator(str);
 }

 return chars;
}

Add this to eval.g near trunc
      | "chars" a=singleFunctionArg {value=chunk.chars(a);}

Add this to action.g near trunc
     |   "chars"





-----Original Message-----
From: stringtemplate-interest-bounces at antlr.org
[mailto:stringtemplate-interest-bounces at antlr.org]On Behalf Of Hill, Robert
Sent: Wednesday, November 22, 2006 2:27 AM
To: StringTemplate
Subject: [stringtemplate-interest] Output string lengths..


  Is there anyway I can make each string in a list be rendered at a minimum
length?
  Id like some things to line up in columns, and want to avoid any sort of
formatting occuring in the code, before I stuff the strings into the
templates.

  Is this a job for a custom format renderer, or is there a way to do this
directly within string template?

  Ta!

  Regards,

  Rob

  Robert Hill
  Information Engineer
  E       UKIMEA DWP ACU, Hallamshire Business Park, 100 Napier St,
Sheffield. S11 8HD
  email:  rhill03 at eds.com
  Office: +44 114 291 1928
  Mobile: +44 7903 185 516


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061129/11fbcdca/attachment.html 

From rob.hill at blueyonder.co.uk  Wed Nov 29 14:06:42 2006
From: rob.hill at blueyonder.co.uk (Rob Hill)
Date: Wed, 29 Nov 2006 22:06:42 -0000
Subject: [stringtemplate-interest] Output string lengths..
In-Reply-To: <PMEOJKDLMMHOHNEAMPBGMEEECAAA.jjsnyders@rcn.com>
References: <2E909902FD3A03419E3A905908AE3DD402A06D64@UKNSM201.emea.corp.eds.com>
	<PMEOJKDLMMHOHNEAMPBGMEEECAAA.jjsnyders@rcn.com>
Message-ID: <001b01c71402$a7019f60$f504de20$@hill@blueyonder.co.uk>

Lol , nice ;)

 

My rather smaller frontal lobe was thinking

 

<str; format="%.40s"; >

Same kind of thing as the null= attribute.

 

Obviously your pad method is far more flexible, but is complete overkill for
what i required.

In fact after re-visiting my padded string requirement, it's far simpler to
pad the string before I stuff it in the template.

 

After writing a custom renderer, i couldn't see the point in actually adding
all the code to put the padding in a class, and then set the renderer, when
i could just pad the string using the same function before i insert it into
the template.

?

Infact, im not sure i see the point in custom renderers at all now i think
about it.?

I may have lost the plot though, it seems to happen frighteningly often
these days!

 

I do like the chars function though, and i think it would be nice addition
to the ST repertoire.

 

Cheers,

Rob

 

 

 

From: stringtemplate-interest-bounces at antlr.org
[mailto:stringtemplate-interest-bounces at antlr.org] On Behalf Of John Snyders
Sent: 29 November 2006 19:02
To: Hill, Robert; StringTemplate
Subject: Re: [stringtemplate-interest] Output string lengths..

 

Here is a crazy thought.

 

If you could iterate over the characters in a string then the template could
do the padding.

I created a function "chars" which returns an iterator for its string
argument.

For example 

  $s1$
  $chars(s1); separator="-"$

will produce

  SOMETHING
  S-O-M-E-T-H-I-N-G

when s1="SOMETHING"

 

With these attributes added in the controller:

  test.setAttribute("s1", "SOMETHING");
  test.setAttribute("s2", "NOTHING");
  test.setAttribute("space40", "                                        ");

This template

  |$chars(s1),chars(space40): { ch, sp | $ch;null={$sp$}$}$|
  |$chars(s2),chars(space40): { ch, sp | $ch;null={$sp$}$}$|

produces this output

 |SOMETHING                               |
|NOTHING                                 |
(forgive the proportional font of this email)

 

Does the chars function have any other use? Well it could be used to do what
the CSS pseudo element ":first-letter" does. For example:

  <span class="fancy">$first(chars(s1))$</span>$rest(chars(s1))$
produces:

  <span class="fancy">S</span>OMETHING

 

This gives some stylistic control over individual letters to the template.

 

What do people think, is the chars function useful? 

As for padding, I'm not sure I like this solution better than the pad
option.

 

-John

 

Here is the code just incase someone wants to play with this:

 

Added to ASTExpr.java

private static class StringIterator implements Iterator
{
 private String str;
 private int index;
 public StringIterator(String str) {
  this.str = str;
  index = 0;
 }
 public boolean hasNext() {
  return index < str.length();
 }

 

 public Object next() {
  String next = String.valueOf(str.charAt(index));
  index++;
  return next;
 }

 

 public void remove() {
  throw new UnsupportedOperationException();
 }
  
}

 

public Object chars(Object attribute) {
 if ( attribute==null ) {
  return null;
 }
 Object chars = null;
 if ( attribute instanceof String ) {
  String str = (String)attribute;
  chars = new StringIterator(str);
 }
 else if ( attribute instanceof StringTemplate )
 {
    StringTemplate st = (StringTemplate)attribute;
    String str = st.toString();
    chars = new StringIterator(str);
 }

 

 return chars;
}

Add this to eval.g near trunc
      | "chars" a=singleFunctionArg {value=chunk.chars(a);}

 

Add this to action.g near trunc
     |   "chars"

 

 

 

 

 

-----Original Message-----
From: stringtemplate-interest-bounces at antlr.org
[mailto:stringtemplate-interest-bounces at antlr.org]On Behalf Of Hill, Robert
Sent: Wednesday, November 22, 2006 2:27 AM
To: StringTemplate
Subject: [stringtemplate-interest] Output string lengths..

Is there anyway I can make each string in a list be rendered at a minimum
length? 
Id like some things to line up in columns, and want to avoid any sort of
formatting occuring in the code, before I stuff the strings into the
templates.

Is this a job for a custom format renderer, or is there a way to do this
directly within string template? 

Ta! 

Regards, 

Rob 

Robert Hill 
Information Engineer 
E       UKIMEA DWP ACU, Hallamshire Business Park, 100 Napier St, Sheffield.
S11 8HD 
email:  rhill03 at eds.com 
Office: +44 114 291 1928 
Mobile: +44 7903 185 516 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org:8080/pipermail/stringtemplate-interest/attachments/20061129/eef71861/attachment.html 

