From zhaotq at gmail.com  Tue Mar  2 07:01:21 2010
From: zhaotq at gmail.com (Cliff Zhao)
Date: Tue, 2 Mar 2010 10:01:21 -0500
Subject: [stringtemplate-interest] String Template v4
Message-ID: <ef28a20a1003020701jcbba280sdca68e883b41baa0@mail.gmail.com>

Is there any documentation about String Template V4?

It seems that ST v4 has a lot of changes from v3 and not compatible with v3.

Any runtime requirement change to v4? It depends on antlr 2.7.7 or 3?

Thanks.

Best Regards,
Cliff Zhao
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100302/a72742cd/attachment.html 

From parrt at cs.usfca.edu  Wed Mar  3 11:01:03 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 3 Mar 2010 11:01:03 -0800
Subject: [stringtemplate-interest] String Template v4
In-Reply-To: <ef28a20a1003020701jcbba280sdca68e883b41baa0@mail.gmail.com>
References: <ef28a20a1003020701jcbba280sdca68e883b41baa0@mail.gmail.com>
Message-ID: <606B678B-4487-4802-9FEC-1FE7051B8FBA@cs.usfca.edu>

Hi. I don't have any documentation yet because I haven't really released it. It should be more or less backward-compatible with the only main difference being no group header at this point on STG files.
The unit tests help a lot.
It depends purely on v3, which is one of the big motivations to rewrite it.
Ter
On Mar 2, 2010, at 7:01 AM, Cliff Zhao wrote:

> Is there any documentation about String Template V4?
> 
> It seems that ST v4 has a lot of changes from v3 and not compatible with v3.
> 
> Any runtime requirement change to v4? It depends on antlr 2.7.7 or 3?
> 
> Thanks.
> 
> Best Regards,
> Cliff Zhao
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From zhaotq at gmail.com  Thu Mar  4 11:19:16 2010
From: zhaotq at gmail.com (Cliff Zhao)
Date: Thu, 4 Mar 2010 14:19:16 -0500
Subject: [stringtemplate-interest] Problem in StringTemplate V4
Message-ID: <ef28a20a1003041119j698c2806j32ac5deaee1fd5a3@mail.gmail.com>

I run into problem for StringTemplate V4. It failed in my Windows XP
environment.

I did some debug, and found the problem is about forward slash (/) and back
slash(\).

The File(name).getParent() return OS-specific path. On Windows, it is "\".
So, when I load a template in a group like
group.getInstanceOf("admin/home"), it returns null.
The code in STGroupDir.java:

    public CompiledST loadTemplateFile(String fileName) {
        //System.out.println("load "+fileName+" from "+root);
        String prefix = new File(fileName).getParent();
        if ( !prefix.endsWith("/") ) prefix += "/";
        try {
            String templateName = Misc.getFileNameNoSuffix(fileName);
            URL f = new URL(root+fileName);
            ANTLRInputStream fs = new ANTLRInputStream(f.openStream(),
encoding);
            if ( ErrorManager.v3_mode) {
                String template = fs.toString(); // needs > ANTLR 3.2
                template = template.trim();
                String justName = new File(templateName).getName();
                defineTemplate(prefix,
                               new CommonToken(GroupParser.ID,justName),
                               null,
                               template);
            }
            else {
                GroupLexer lexer = new GroupLexer(fs);
                fs.name = fileName;
                CommonTokenStream tokens = new CommonTokenStream(lexer);
                GroupParser parser = new GroupParser(tokens);
                parser.group = this;
=A=====>                parser.templateDef(prefix);
            }
=B=====>            return templates.get(templateName);
        }

After the A point, the templates variable contains one entry {
"\admin/home", --parsed ST--}.
At the B point, the templateName is "/admin/home". It is a mismatch!

Could you fix it?

Thank you very much.

Best Regards,
Cliff Zhao
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100304/fdb37fd3/attachment.html 

From zhaotq at gmail.com  Thu Mar  4 13:24:39 2010
From: zhaotq at gmail.com (Cliff Zhao)
Date: Thu, 4 Mar 2010 16:24:39 -0500
Subject: [stringtemplate-interest] Feature Request for StringTemplate v4:
	STGroupDir taking URL parameter
Message-ID: <ef28a20a1003041324u4115e173g799297c431b028f@mail.gmail.com>

Terence,
I would like to see another set of STGroupDir constructors that take an URL
instead of dirName. It will give me a great flexibility to integrate
StringTemplate into a web application. That way, I can put my templates into
/WEB-INF/templates and use servletContext.getResource("/WEB-INF/templates")
to get the group URL, then initialize the STGroupDir by new STGroupDir(url,
'$','$').

Thank you very much.

Best Regards,
Cliff Zhao
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100304/f0c3405d/attachment.html 

From parrt at cs.usfca.edu  Thu Mar  4 14:43:34 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 4 Mar 2010 14:43:34 -0800
Subject: [stringtemplate-interest] Problem in StringTemplate V4
In-Reply-To: <ef28a20a1003041119j698c2806j32ac5deaee1fd5a3@mail.gmail.com>
References: <ef28a20a1003041119j698c2806j32ac5deaee1fd5a3@mail.gmail.com>
Message-ID: <C19BE722-21AD-4DF7-9F06-8E174B641765@cs.usfca.edu>

Hi. interesting. dang windoze.  ok, so I want ST4 to always use / as the dir separator for consistency across platforms.  how do we fix?  Should I convert all \ to /?
Ter
On Mar 4, 2010, at 11:19 AM, Cliff Zhao wrote:

> I run into problem for StringTemplate V4. It failed in my Windows XP environment.
> 
> I did some debug, and found the problem is about forward slash (/) and back slash(\). 
> 
> The File(name).getParent() return OS-specific path. On Windows, it is "\". So, when I load a template in a group like group.getInstanceOf("admin/home"), it returns null.
> The code in STGroupDir.java:
> 
>     public CompiledST loadTemplateFile(String fileName) {
>         //System.out.println("load "+fileName+" from "+root);
>         String prefix = new File(fileName).getParent();
>         if ( !prefix.endsWith("/") ) prefix += "/";
>         try {
>             String templateName = Misc.getFileNameNoSuffix(fileName);
>             URL f = new URL(root+fileName);
>             ANTLRInputStream fs = new ANTLRInputStream(f.openStream(), encoding);
>             if ( ErrorManager.v3_mode) {
>                 String template = fs.toString(); // needs > ANTLR 3.2
>                 template = template.trim();
>                 String justName = new File(templateName).getName();
>                 defineTemplate(prefix,
>                                new CommonToken(GroupParser.ID,justName),
>                                null,
>                                template);
>             }
>             else {
>                 GroupLexer lexer = new GroupLexer(fs);
>                 fs.name = fileName;
>                 CommonTokenStream tokens = new CommonTokenStream(lexer);
>                 GroupParser parser = new GroupParser(tokens);
>                 parser.group = this;
> =A=====>                parser.templateDef(prefix);
>             }
> =B=====>            return templates.get(templateName);
>         }
> 
> After the A point, the templates variable contains one entry { "\admin/home", --parsed ST--}.
> At the B point, the templateName is "/admin/home". It is a mismatch!
> 
> Could you fix it?
> 
> Thank you very much.
> 
> Best Regards,
> Cliff Zhao
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From parrt at cs.usfca.edu  Thu Mar  4 14:56:07 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 4 Mar 2010 14:56:07 -0800
Subject: [stringtemplate-interest] Feature Request for StringTemplate
	v4: STGroupDir taking URL parameter
In-Reply-To: <ef28a20a1003041324u4115e173g799297c431b028f@mail.gmail.com>
References: <ef28a20a1003041324u4115e173g799297c431b028f@mail.gmail.com>
Message-ID: <780D2127-B3FE-4936-82A7-424443BB4E99@cs.usfca.edu>

I added

	public STGroupDir(URL root, String encoding,
					  char delimiterStartChar, char delimiterStopChar)
	{
		super(delimiterStartChar, delimiterStopChar);
		this.root = root;
		this.encoding = encoding;
	}


and

	public STGroupFile(URL url, String encoding,
					   char delimiterStartChar, char delimiterStopChar)
	{
		super(delimiterStartChar, delimiterStopChar);
		this.url = url;
		this.encoding = encoding;
	}


Will that work?
Ter
On Mar 4, 2010, at 1:24 PM, Cliff Zhao wrote:

> Terence,
> I would like to see another set of STGroupDir constructors that take an URL instead of dirName. It will give me a great flexibility to integrate StringTemplate into a web application. That way, I can put my templates into /WEB-INF/templates and use servletContext.getResource("/WEB-INF/templates") to get the group URL, then initialize the STGroupDir by new STGroupDir(url, '$','$').
> 
> Thank you very much.
> 
> Best Regards,
> Cliff Zhao 
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From leo at finalresort.org  Sun Mar  7 07:17:10 2010
From: leo at finalresort.org (Leo R. Lundgren)
Date: Sun, 7 Mar 2010 16:17:10 +0100
Subject: [stringtemplate-interest] Angel brackets and HTML/XML
Message-ID: <CA105445-F18A-476F-81E3-70BD2EC0F0D5@finalresort.org>

Hello,

I just started trying out ST and it seems really nice. But I  
encountered an issue when using <..> as delimiters in a HTML template.  
I've been searching and reading but can't find a clear explanation as  
to why this is happening, and if there is a workaround.


In short; my template looks like this:

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd 
">

<html lang="sv-SE">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Test</title>
	</head>
	<body>
		<h2>Hello <name></h2>
		<button id="uploadButton">Upload file</button>
	</body>
</html>


And my Java code like this:

	protected void doGet(HttpServletRequest request, HttpServletResponse  
response) throws ServletException, IOException {
	    String templatePath = getServletContext().getRealPath("/WEB-INF/ 
view");
	    StringTemplateGroup group =  new StringTemplateGroup("view",  
templatePath, AngleBracketTemplateLexer.class);
	    group.setRefreshInterval(0);

	    StringTemplate view = group.getInstanceOf("index");
		view.setAttribute("name", "World");

		PrintWriter out = response.getWriter();
		out.write(view.toString());
	}


When requesting the page, i get this exception:

problem parsing template 'index'
line 12:6: expecting '!', found 'l'
	at  
org 
.antlr 
.stringtemplate 
.language 
.AngleBracketTemplateLexer.nextToken(AngleBracketTemplateLexer.java:149)
	at antlr.TokenBuffer.fill(TokenBuffer.java:69)
	at antlr.TokenBuffer.LA(TokenBuffer.java:80)
	at antlr.LLkParser.LA(LLkParser.java:52)
	at  
org 
.antlr 
.stringtemplate.language.TemplateParser.template(TemplateParser.java: 
103)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplate.breakTemplateIntoChunks(StringTemplate.java:850)
	at  
org 
.antlr.stringtemplate.StringTemplate.setTemplate(StringTemplate.java: 
441)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.defineTemplate(StringTemplateGroup.java:679)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.loadTemplate(StringTemplateGroup.java:553)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.loadTemplate(StringTemplateGroup.java:629)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplateGroup 
.loadTemplateFromBeneathRootDirOrCLASSPATH(StringTemplateGroup.java:597)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:480)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
	at  
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
	...


Apparently the problem is the first line in the template, where  
there's a ! in the first tag.
But even if I remove the ! (not valid, I know, just for testing) I get  
the parsing error (only the "problem parsing template 'index'" message  
and stacktrace).
If I remove everything above the <h2> line, I get output.
In any case, if I use $$ notation instead of <..>, everything works.

So, is possible to use <..> when making HTML or XML templates, without  
getting errors like this, or is it not recommended?

The reason I'm even considering <..> is because the Five Minute  
Introduction says they are the standard delimiters since version 2.3.
However, on the "Setting the expression delimiters" page in the wiki,  
it says the opposite.
It seems to me that the latter is correct, can someone verify?

In any case, I think <..> looks slightly cleaner than $$ all over the  
place, but it certianly does clash with the tags in general, so maybe  
it's better to skip them.

Thanks,

-|


From leo at finalresort.org  Sun Mar  7 14:14:15 2010
From: leo at finalresort.org (Leo R. Lundgren)
Date: Sun, 7 Mar 2010 23:14:15 +0100
Subject: [stringtemplate-interest] Angel brackets and HTML/XML
In-Reply-To: <CA105445-F18A-476F-81E3-70BD2EC0F0D5@finalresort.org>
References: <CA105445-F18A-476F-81E3-70BD2EC0F0D5@finalresort.org>
Message-ID: <C3D94497-A04B-4A5A-A95F-D6C6CA017277@finalresort.org>

I found the anser to why <!DOCTYPE ...> gave an error. It is obviously  
because of the comment syntax in ST (<! .. !>).

I did find another thing that is missing in the Five Minute  
Introduction, namely the <(expr)(argument-list)>. It's not in the list  
of expressions. Maybe it could be added at the same time that the text  
regarding which delimiter type is default in ST is adjusted.

However, I am still getting "problem parsing template 'index'", when  
the template I try to use is:

\<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd 
">

<html lang="sv-SE">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Test</title>
	</head>
	<body>
		<h2>Hello <name></h2>
		<button id="uploadButton">Upload file</button>
	</body>
</html>

(I added the \ before the DOCTYPE in order to stop the previously  
mentioned error.)

After some further testing I presume that it's simply not viable to  
use <..> for HTML/XML templates. It seems that ST tries to parse all  
tags, and leaves them blank when then it doesn't find a valid attribute.

Thanks,

// Leo


7 mar 2010 kl. 16.17 skrev Leo R. Lundgren:

> Hello,
>
> I just started trying out ST and it seems really nice. But I
> encountered an issue when using <..> as delimiters in a HTML template.
> I've been searching and reading but can't find a clear explanation as
> to why this is happening, and if there is a workaround.
>
>
> In short; my template looks like this:
>
> <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd
> ">
>
> <html lang="sv-SE">
> 	<head>
> 		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
> 		<title>Test</title>
> 	</head>
> 	<body>
> 		<h2>Hello <name></h2>
> 		<button id="uploadButton">Upload file</button>
> 	</body>
> </html>
>
>
> And my Java code like this:
>
> 	protected void doGet(HttpServletRequest request, HttpServletResponse
> response) throws ServletException, IOException {
> 	    String templatePath = getServletContext().getRealPath("/WEB-INF/
> view");
> 	    StringTemplateGroup group =  new StringTemplateGroup("view",
> templatePath, AngleBracketTemplateLexer.class);
> 	    group.setRefreshInterval(0);
>
> 	    StringTemplate view = group.getInstanceOf("index");
> 		view.setAttribute("name", "World");
>
> 		PrintWriter out = response.getWriter();
> 		out.write(view.toString());
> 	}
>
>
> When requesting the page, i get this exception:
>
> problem parsing template 'index'
> line 12:6: expecting '!', found 'l'
> 	at
> org
> .antlr
> .stringtemplate
> .language
> .AngleBracketTemplateLexer.nextToken(AngleBracketTemplateLexer.java: 
> 149)
> 	at antlr.TokenBuffer.fill(TokenBuffer.java:69)
> 	at antlr.TokenBuffer.LA(TokenBuffer.java:80)
> 	at antlr.LLkParser.LA(LLkParser.java:52)
> 	at
> org
> .antlr
> .stringtemplate.language.TemplateParser.template(TemplateParser.java:
> 103)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplate.breakTemplateIntoChunks(StringTemplate.java:850)
> 	at
> org
> .antlr.stringtemplate.StringTemplate.setTemplate(StringTemplate.java:
> 441)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplateGroup.defineTemplate(StringTemplateGroup.java:679)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplateGroup.loadTemplate(StringTemplateGroup.java:553)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplateGroup.loadTemplate(StringTemplateGroup.java:629)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplateGroup
> .loadTemplateFromBeneathRootDirOrCLASSPATH(StringTemplateGroup.java: 
> 597)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:480)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
> 	at
> org
> .antlr
> .stringtemplate
> .StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
> 	...
>
>
> Apparently the problem is the first line in the template, where
> there's a ! in the first tag.
> But even if I remove the ! (not valid, I know, just for testing) I get
> the parsing error (only the "problem parsing template 'index'" message
> and stacktrace).
> If I remove everything above the <h2> line, I get output.
> In any case, if I use $$ notation instead of <..>, everything works.
>
> So, is possible to use <..> when making HTML or XML templates, without
> getting errors like this, or is it not recommended?
>
> The reason I'm even considering <..> is because the Five Minute
> Introduction says they are the standard delimiters since version 2.3.
> However, on the "Setting the expression delimiters" page in the wiki,
> it says the opposite.
> It seems to me that the latter is correct, can someone verify?
>
> In any case, I think <..> looks slightly cleaner than $$ all over the
> place, but it certianly does clash with the tags in general, so maybe
> it's better to skip them.


From markwright at internode.on.net  Mon Mar  8 16:25:23 2010
From: markwright at internode.on.net (Mark Wright)
Date: Tue, 9 Mar 2010 11:25:23 +1100
Subject: [stringtemplate-interest] Angel brackets and HTML/XML
In-Reply-To: <C3D94497-A04B-4A5A-A95F-D6C6CA017277@finalresort.org>
References: <CA105445-F18A-476F-81E3-70BD2EC0F0D5@finalresort.org>
	<C3D94497-A04B-4A5A-A95F-D6C6CA017277@finalresort.org>
Message-ID: <20100309002523.GD25549@internode.on.net>

I think that any < or > that is not a stringtemplate delimeter
should be escaped with \ like \< and \> .
Hope that helps.

Regards, Mark

From jimi at temporal-wave.com  Mon Mar  8 16:54:52 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 08 Mar 2010 16:54:52 -0800
Subject: [stringtemplate-interest] Angel brackets and HTML/XML
In-Reply-To: <20100309002523.GD25549@internode.on.net>
Message-ID: <462dc1bbd152e344936bb606b05cfe0e@temporal-wave.com>

Why not change the delimiters to be $ instead? Makes it easier to do HTML/XML as you need only escape the dollar.

Jim

> -----Original Message-----
> From: stringtemplate-interest-bounces at antlr.org [mailto:stringtemplate-
> interest-bounces at antlr.org] On Behalf Of Mark Wright
> Sent: Monday, March 08, 2010 4:25 PM
> To: Leo R. Lundgren
> Cc: stringtemplate-interest at antlr.org
> Subject: Re: [stringtemplate-interest] Angel brackets and HTML/XML
> 
> I think that any < or > that is not a stringtemplate delimeter
> should be escaped with \ like \< and \> .
> Hope that helps.
> 
> Regards, Mark
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest




From leo at finalresort.org  Mon Mar  8 17:04:35 2010
From: leo at finalresort.org (Leo R. Lundgren)
Date: Tue, 9 Mar 2010 02:04:35 +0100
Subject: [stringtemplate-interest] Angel brackets and HTML/XML
In-Reply-To: <462dc1bbd152e344936bb606b05cfe0e@temporal-wave.com>
References: <462dc1bbd152e344936bb606b05cfe0e@temporal-wave.com>
Message-ID: <9FD37A84-50AA-467F-AC5A-9424E5E5A408@finalresort.org>

Indeed, that's the way I do it now. It's somewhat naive to think that  
there would be efficient attribute handling when the delimiters are  
the same as the rest of the template.

I just don't really like the $$ syntax. But I'll get used to it :)


9 mar 2010 kl. 01.54 skrev Jim Idle:

> Why not change the delimiters to be $ instead? Makes it easier to do  
> HTML/XML as you need only escape the dollar.
>
> Jim
>
>> -----Original Message-----
>> From: stringtemplate-interest-bounces at antlr.org [mailto:stringtemplate-
>> interest-bounces at antlr.org] On Behalf Of Mark Wright
>> Sent: Monday, March 08, 2010 4:25 PM
>> To: Leo R. Lundgren
>> Cc: stringtemplate-interest at antlr.org
>> Subject: Re: [stringtemplate-interest] Angel brackets and HTML/XML
>>
>> I think that any < or > that is not a stringtemplate delimeter
>> should be escaped with \ like \< and \> .
>> Hope that helps.
>>
>> Regards, Mark


-|


From harald_m_mueller at gmx.de  Fri Mar 12 11:15:22 2010
From: harald_m_mueller at gmx.de (Harald Mueller)
Date: Fri, 12 Mar 2010 20:15:22 +0100
Subject: [stringtemplate-interest] Why an == operator is sometimes necessary,
 and how to implement it (ST3/C#)
Message-ID: <20100312191522.133220@gmx.net>

Hi -

as we all know, ST does not have any expression operators in its language, and that is almost always a good thing. However, in a well-worn code generator we use to create triggers in an SQL database, we finally got to the point where we needed an equals operator in $if(...)$. Here is why; and how we implemented it.

The problem is as follows: Input to the generation is (a) a list of SQL tables; (b) the FROM part of an SQL statement, which is a tree of join nodes; each join node points to a table (and of course has information about the joined columns and inner/outer etc., but that's not important); and (c) a replacement string (typically "INSERTED" or "DELETED"; but there are more).
The job to do is to write a trigger for each table in the join tree, such that the table itself is replaced with the replacement string.

A small example:
(a) T1, T2
(b) ... FROM T1 INNER JOIN T2 INNER JOIN T3
(c) "INSERTED"
Result:
... FROM INSERTED INNER JOIN T2 INNER JOIN T3
... FROM T1 INNER JOIN INSERTED INNER JOIN T3

The example below is a simplified version of the above, however, its ST template marks nodes in a tree with an arrow (<--) if the node's "table name" is equal to the "replacement table".

Here is the model, together with the "equals operator":

    public class Table {
        public string Name;
    }

    public class Join {
        public readonly string Name;
        public readonly Table JoinedTable;
        public readonly List<Join> Children;
        public Join(string name, Table joinedTable, params Join[] children) {
            Name = name;
            JoinedTable = joinedTable;
            Children = new List<Join>(children);
        }
    }

Here are the templates - first the Main template, then the recursive one for printing the tree.

Main(Target, Tables) ::= <<
    $Tables:PrintTreeReplacingTable(Target=Target,Replace=it)$
>>

PrintTreeReplacingTable(Target,Replace) ::= <<
    $Target.Name$ $if(Target.NameIsReplace.(Replace.Name))$ <--	$endif$
	$Target.Children:PrintTreeReplacingTable(Target=it,Replace=Replace)$

>>

The important idea here is the expression

    Target.NameIsReplace.(Replace.Name)

where .NameEquals is a property that returns an IDictionary. The (Replacement.Name) then passes in a value which is in effect the parameter of a single-arg function which implements "Target.Name == Replace.Name" - that's the whole trick.

So we extend Join with the following additional property

    public IDictionary NameEquals {
        get {
            return new Equals(JoinedTable.Name);
        }
    }

and the class Equals, which is implemented as follows:

    class Equals : DictionaryBase, IDictionary {
        private readonly string _tn;

        public Equals(string tn) {
            _tn = tn;
        }

        bool IDictionary.Contains(object key) {
            return key.ToString() == _tn;
        }

        object IDictionary.this[object key] {
            get {
                return key.ToString() == _tn;
            }
            set { throw new NotImplementedException(); }
        }
    }

That's it. Maybe it helps someone.
And maybe someone's got an idea how this works without that IDictionary trick - but we didn't see how!

Regards
Harald M.

-- 
GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01

From harald_m_mueller at gmx.de  Fri Mar 12 11:23:58 2010
From: harald_m_mueller at gmx.de (Harald Mueller)
Date: Fri, 12 Mar 2010 20:23:58 +0100
Subject: [stringtemplate-interest] Why an == operator is sometimes
 necessary, and how to implement it (ST3/C#)
In-Reply-To: <20100312191522.133220@gmx.net>
References: <20100312191522.133220@gmx.net>
Message-ID: <20100312192358.133240@gmx.net>

Ahem - I mixed up two versions of my code: NameIsReplace is just the same as NameEquals.
And for those who want to try it - below is some test code - not the tersest one, but that's how we used it.

Regards
Harald M.

static void Main() {
    var sb = new StringBuilder();
    using (TextWriter tw = new StringWriter(sb)) {
        string ressourceName = typeof(Program).Namespace + ".Templ.stg";
        Stream baseStream = Assembly.GetExecutingAssembly().GetManifestResourceStream(ressourceName);
        StringTemplateGroup g = new StringTemplateGroup(new StreamReader(baseStream), typeof(DefaultTemplateLexer));
        StringTemplate st = g.GetTemplateDefinition("Init");

        Table t1 = new Table { Name = "T1" };
        Table t2 = new Table { Name = "T2" };
        Table t3 = new Table { Name = "T3" };
        st.SetAttribute("Tables", new[] { t1, t2, t3 });
        st.SetAttribute("Target",
            new Join("1", t1,
                new Join("1.1", t1),
                new Join("1.2", t2,
                    new Join("1.2.1", t1,
                        new Join("1.2.1.1", t1)
                    ),
                    new Join("1.2.2", t2),
                    new Join("1.2.3", t3)
                    )));
        st.Write(new AutoIndentWriter(tw));
    }
    Console.WriteLine(sb.ToString());
}

-- 
GMX DSL: Internet, Telefon und Entertainment f?r nur 19,99 EUR/mtl.!
http://portal.gmx.net/de/go/dsl01

From leo at finalresort.org  Mon Mar 15 10:11:07 2010
From: leo at finalresort.org (Leo R. Lundgren)
Date: Mon, 15 Mar 2010 18:11:07 +0100
Subject: [stringtemplate-interest] UTF-8 not displaying correctly
Message-ID: <F30257B1-4359-46ED-B605-852B30937639@finalresort.org>

Hi,

I am building a small servlet application using Eclipse, Tomcat 6, JRE  
1.6, ST 3.2. Here is a ViewHandler I'm using to wrap ST functionality:

	public class ViewHandler {
		private StringTemplateGroup templateGroup;
		private Map<String, String> attributes = new HashMap<String,  
String>();

		public ViewHandler(String viewBasePath) {
			templateGroup = new StringTemplateGroup("default", viewBasePath);
		}

		public void setAttribute(String name, String value) {
			attributes.put(name, value);
		}

		public String getOutput(String viewName) {
			StringTemplate view = templateGroup.getInstanceOf(viewName);
			view.setAttributes(attributes);
			return view.toString();
		}

		public void render(Writer out, String viewName) throws IOException {
			out.write(getOutput(viewName));
		}
	}

The handler is used like this in a servlet:

	protected void doGet(HttpServletRequest request, HttpServletResponse  
response) throws ServletException, IOException {
		super.doGet(request, response);
		
		String viewBasePath = getServletContext().getRealPath("/WEB-INF/ 
view");
		ViewHandler viewHandler = new ViewHandler(viewBasePath);
		viewHandler.setAttribute("fileName", "test.png");
		viewHandler.setAttribute("contentTemplate", "uploadFile");

		viewHandler.render(response.getWriter(), "index");
	}

It does what it is supposed to; The output I get is the contents of  
the index.st template, with attributes replaced like they should be,  
and the content template included as expected.

However, swedish characters such as ??? that are part of static  
strings in the template files are shown in the browser(s) as question  
marks. I know this indicates coding/charset problems. An example  
string (from the template files) that is not displayed correctly is:

	<input type="button" class="cancelUploadButton" value="Avbryt  
ins?ttning">

The '?' in the last word becomes a question mark in the browser.


So, I have:
- Checked the encoding settings in Eclipse, in all places I can find  
that seem to relate to the source files and/or template files.
- Checked the encoding of the related template files (both in their  
properties and using an external editor that loads them fine as UTF-8).
- Verified that the HTTP response headers say UTF-8 as the charset.  
The same goes for the HTML code itself, it's UTF-8 all the way.

The only thing I haven't found to be apparently fine is when I open  
the .java files from my project using another editor (TextMate, which  
has always handled encodings fine for me); Normally TextMate displays  
the encoding used/discovered from loading the file (for the template  
files it says UTF-8), but for the Java source files it doesn't display  
anything.
However there are no static strings in the source files other than  
template names and attributes, so I'm not sure that would matter. But  
maybe it does, assuming there's something wrong with how the source  
files are saved by eclipse.

Can someone shed some light on this issue? As I see it I've got UTF-8  
everywhere (apart from possibly the Java source files, which I guess  
could be the issue), and it should work. But maybe I need to change  
something with regards to ST to have it work with UTF-8? If not, any  
other ideas?

Thank you,

// Leo


From parrt at cs.usfca.edu  Mon Mar 15 11:50:03 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 15 Mar 2010 11:50:03 -0700
Subject: [stringtemplate-interest] UTF-8 not displaying correctly
In-Reply-To: <F30257B1-4359-46ED-B605-852B30937639@finalresort.org>
References: <F30257B1-4359-46ED-B605-852B30937639@finalresort.org>
Message-ID: <1AB8C1C8-196D-458E-A9AD-99F27A3A8497@cs.usfca.edu>

Hi. You have to tell ST to use a UTF-8 encoding. should be option to StringTemplateGroup or something.
Ter
On Mar 15, 2010, at 10:11 AM, Leo R. Lundgren wrote:

> Hi,
> 
> I am building a small servlet application using Eclipse, Tomcat 6, JRE  
> 1.6, ST 3.2. Here is a ViewHandler I'm using to wrap ST functionality:
> 
> 	public class ViewHandler {
> 		private StringTemplateGroup templateGroup;
> 		private Map<String, String> attributes = new HashMap<String,  
> String>();
> 
> 		public ViewHandler(String viewBasePath) {
> 			templateGroup = new StringTemplateGroup("default", viewBasePath);
> 		}
> 
> 		public void setAttribute(String name, String value) {
> 			attributes.put(name, value);
> 		}
> 
> 		public String getOutput(String viewName) {
> 			StringTemplate view = templateGroup.getInstanceOf(viewName);
> 			view.setAttributes(attributes);
> 			return view.toString();
> 		}
> 
> 		public void render(Writer out, String viewName) throws IOException {
> 			out.write(getOutput(viewName));
> 		}
> 	}
> 
> The handler is used like this in a servlet:
> 
> 	protected void doGet(HttpServletRequest request, HttpServletResponse  
> response) throws ServletException, IOException {
> 		super.doGet(request, response);
> 		
> 		String viewBasePath = getServletContext().getRealPath("/WEB-INF/ 
> view");
> 		ViewHandler viewHandler = new ViewHandler(viewBasePath);
> 		viewHandler.setAttribute("fileName", "test.png");
> 		viewHandler.setAttribute("contentTemplate", "uploadFile");
> 
> 		viewHandler.render(response.getWriter(), "index");
> 	}
> 
> It does what it is supposed to; The output I get is the contents of  
> the index.st template, with attributes replaced like they should be,  
> and the content template included as expected.
> 
> However, swedish characters such as ??? that are part of static  
> strings in the template files are shown in the browser(s) as question  
> marks. I know this indicates coding/charset problems. An example  
> string (from the template files) that is not displayed correctly is:
> 
> 	<input type="button" class="cancelUploadButton" value="Avbryt  
> ins?ttning">
> 
> The '?' in the last word becomes a question mark in the browser.
> 
> 
> So, I have:
> - Checked the encoding settings in Eclipse, in all places I can find  
> that seem to relate to the source files and/or template files.
> - Checked the encoding of the related template files (both in their  
> properties and using an external editor that loads them fine as UTF-8).
> - Verified that the HTTP response headers say UTF-8 as the charset.  
> The same goes for the HTML code itself, it's UTF-8 all the way.
> 
> The only thing I haven't found to be apparently fine is when I open  
> the .java files from my project using another editor (TextMate, which  
> has always handled encodings fine for me); Normally TextMate displays  
> the encoding used/discovered from loading the file (for the template  
> files it says UTF-8), but for the Java source files it doesn't display  
> anything.
> However there are no static strings in the source files other than  
> template names and attributes, so I'm not sure that would matter. But  
> maybe it does, assuming there's something wrong with how the source  
> files are saved by eclipse.
> 
> Can someone shed some light on this issue? As I see it I've got UTF-8  
> everywhere (apart from possibly the Java source files, which I guess  
> could be the issue), and it should work. But maybe I need to change  
> something with regards to ST to have it work with UTF-8? If not, any  
> other ideas?
> 
> Thank you,
> 
> // Leo
> 
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From leo at finalresort.org  Mon Mar 15 15:48:06 2010
From: leo at finalresort.org (Leo R. Lundgren)
Date: Mon, 15 Mar 2010 23:48:06 +0100
Subject: [stringtemplate-interest] UTF-8 not displaying correctly
In-Reply-To: <1AB8C1C8-196D-458E-A9AD-99F27A3A8497@cs.usfca.edu>
References: <F30257B1-4359-46ED-B605-852B30937639@finalresort.org>
	<1AB8C1C8-196D-458E-A9AD-99F27A3A8497@cs.usfca.edu>
Message-ID: <A61B5F64-A58B-4993-92AF-E6C2AD88170E@finalresort.org>

Hi,

I found StringTemplateGroup. setFileCharEncoding() which takes a  
parameter that seems to be the same as  
java.io.InputStreamReader(InputStream in, String charsetName) accepts.  
I added it to my ViewHandler:

	public class ViewHandler {
		private StringTemplateGroup templateGroup;
		private Map<String, String> attributes = new HashMap<String,  
String>();

		public ViewHandler(String viewBasePath) {
			templateGroup = new StringTemplateGroup("default", viewBasePath);
			System.out.println(templateGroup.getFileCharEncoding());
			templateGroup.setFileCharEncoding("UTF-8");
			System.out.println(templateGroup.getFileCharEncoding());
		}

		public void setAttribute(String name, String value) {
			attributes.put(name, value);
		}

		public String getOutput(String viewName) {
			StringTemplate view = templateGroup.getInstanceOf(viewName,  
attributes);
			return view.toString();
		}

		public void render(Writer out, String viewName) throws IOException {
			out.write(getOutput(viewName));
		}
	}

Watching the console at the time of a request, it seems that UTF-8 is  
already the default in the system. In any case, that is what the  
option is set to. Still no go in the output however, the encoding  
issue remains.

I have checked all encoding settings for the files properties and they  
all say UTF-8 (inherited from container).
I also tried templateGroup.setFileCharEncoding("ISO-8859-1") instead,  
and it did change the <?> to a couple of junk characters instead, so  
it's not right.
I'd also like to clarify that my previous information regarding the  
HTTP response headers carrying a charset in them was wrong; there is  
no such header sent. However, the browser adheres to the HTML meta tag  
defining a charset, that I am sure of.

After some testing, I've found that there is /one/ thing that makes  
the page display correctly; If in the HTML of the template I set the  
charset to iso-8859-1 instead of utf-8, so that the browser parses the  
contents as latin1, it displays correctly. I can't really draw any  
other conclusion from this than that what the browser is sent is coded  
as latin1?

At http://www.stringtemplate.org/api/org/antlr/stringtemplate/PathGroupLoader.html 
  I found the description "A brain dead loader that looks only in the  
directory(ies) you specify in the ctor. You may specify the char  
encoding. NOTE: this does not work when you jar things up! Use  
CommonGroupLoader instead in that case".

Reading the note in the description, and also reading http://www.stringtemplate.org/api/org/antlr/stringtemplate/CommonGroupLoader.html 
  , I get the feeling that it's not the actual char encoding that  
doesn't work when "jar'ed up", but rather the loader class itself. But  
is this something I should try anyway? If so, how do I use the group  
loader?

I did check with some Eclipse guys and they didn't feel that it was  
Eclipse not saving files correctly. Personally, I don't know since I  
havent used Eclipse long enough to form an opinion based on experience  
in it.

Silly question maybe, but could it be that ST just *reads* the  
template files using UTF-8 (or the set encoding), but then outputs it  
using Latin1?

For reference, here's the beginning of the index HTML template:

	<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd 
">
	<html lang="sv-SE">
		<head>
			<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
			<title>MyApp</title>
			<link rel="stylesheet" type="text/css" href="css/common.css">
		</head>
		<body>
			? ? ? <!-- test characters -->
			$(contentTemplate)()$
		</body>
	</html>

Many thanks,

Regards, Leo


15 mar 2010 kl. 19.50 skrev Terence Parr:

> Hi. You have to tell ST to use a UTF-8 encoding. should be option to  
> StringTemplateGroup or something.
> Ter
> On Mar 15, 2010, at 10:11 AM, Leo R. Lundgren wrote:
>
>> Hi,
>>
>> I am building a small servlet application using Eclipse, Tomcat 6,  
>> JRE
>> 1.6, ST 3.2. Here is a ViewHandler I'm using to wrap ST  
>> functionality:
>>
>> 	public class ViewHandler {
>> 		private StringTemplateGroup templateGroup;
>> 		private Map<String, String> attributes = new HashMap<String,
>> String>();
>>
>> 		public ViewHandler(String viewBasePath) {
>> 			templateGroup = new StringTemplateGroup("default", viewBasePath);
>> 		}
>>
>> 		public void setAttribute(String name, String value) {
>> 			attributes.put(name, value);
>> 		}
>>
>> 		public String getOutput(String viewName) {
>> 			StringTemplate view = templateGroup.getInstanceOf(viewName);
>> 			view.setAttributes(attributes);
>> 			return view.toString();
>> 		}
>>
>> 		public void render(Writer out, String viewName) throws  
>> IOException {
>> 			out.write(getOutput(viewName));
>> 		}
>> 	}
>>
>> The handler is used like this in a servlet:
>>
>> 	protected void doGet(HttpServletRequest request, HttpServletResponse
>> response) throws ServletException, IOException {
>> 		super.doGet(request, response);
>> 		
>> 		String viewBasePath = getServletContext().getRealPath("/WEB-INF/
>> view");
>> 		ViewHandler viewHandler = new ViewHandler(viewBasePath);
>> 		viewHandler.setAttribute("fileName", "test.png");
>> 		viewHandler.setAttribute("contentTemplate", "uploadFile");
>>
>> 		viewHandler.render(response.getWriter(), "index");
>> 	}
>>
>> It does what it is supposed to; The output I get is the contents of
>> the index.st template, with attributes replaced like they should be,
>> and the content template included as expected.
>>
>> However, swedish characters such as ??? that are part of static
>> strings in the template files are shown in the browser(s) as question
>> marks. I know this indicates coding/charset problems. An example
>> string (from the template files) that is not displayed correctly is:
>>
>> 	<input type="button" class="cancelUploadButton" value="Avbryt
>> ins?ttning">
>>
>> The '?' in the last word becomes a question mark in the browser.
>>
>>
>> So, I have:
>> - Checked the encoding settings in Eclipse, in all places I can find
>> that seem to relate to the source files and/or template files.
>> - Checked the encoding of the related template files (both in their
>> properties and using an external editor that loads them fine as  
>> UTF-8).
>> - Verified that the HTTP response headers say UTF-8 as the charset.
>> The same goes for the HTML code itself, it's UTF-8 all the way.
>>
>> The only thing I haven't found to be apparently fine is when I open
>> the .java files from my project using another editor (TextMate, which
>> has always handled encodings fine for me); Normally TextMate displays
>> the encoding used/discovered from loading the file (for the template
>> files it says UTF-8), but for the Java source files it doesn't  
>> display
>> anything.
>> However there are no static strings in the source files other than
>> template names and attributes, so I'm not sure that would matter. But
>> maybe it does, assuming there's something wrong with how the source
>> files are saved by eclipse.
>>
>> Can someone shed some light on this issue? As I see it I've got UTF-8
>> everywhere (apart from possibly the Java source files, which I guess
>> could be the issue), and it should work. But maybe I need to change
>> something with regards to ST to have it work with UTF-8? If not, any
>> other ideas?
>>
>> Thank you,
>>
>> // Leo
>>
>> _______________________________________________
>> stringtemplate-interest mailing list
>> stringtemplate-interest at antlr.org
>> http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>



-|


From leo at finalresort.org  Mon Mar 15 15:58:47 2010
From: leo at finalresort.org (Leo R. Lundgren)
Date: Mon, 15 Mar 2010 23:58:47 +0100
Subject: [stringtemplate-interest] UTF-8 not displaying correctly
In-Reply-To: <A61B5F64-A58B-4993-92AF-E6C2AD88170E@finalresort.org>
References: <F30257B1-4359-46ED-B605-852B30937639@finalresort.org>
	<1AB8C1C8-196D-458E-A9AD-99F27A3A8497@cs.usfca.edu>
	<A61B5F64-A58B-4993-92AF-E6C2AD88170E@finalresort.org>
Message-ID: <937FF692-1D2D-41F3-B1E8-E2EF9BBB4F47@finalresort.org>

To clarify the combination of  
StringTemplateGroup.setFileCharEncoding() and HTML meta charset I have  
tried, and their results:

	setFileCharEncoding("UTF-8")
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	Result: Characters NOT displayed correctly in browser ("<?>"-sign/ 
character displayed where there should be one "?").

	setFileCharEncoding("ISO-8859-1")
	<meta http-equiv="Content-Type" content="text/html;  
charset=iso-8859-1">
	Result: Characters NOT displayed correctly in browser (dual junk  
chars where there should be one "?").

	setFileCharEncoding("UTF-8")
	<meta http-equiv="Content-Type" content="text/html;  
charset=iso-8859-1">
	Result: Characters displayed correctly in browser.

	setFileCharEncoding("ISO-8859-1")
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	Result: Characters displayed correctly in browser.

Pretty confusing.

// Leo


15 mar 2010 kl. 23.48 skrev Leo R. Lundgren:

> Hi,
>
> I found StringTemplateGroup. setFileCharEncoding() which takes a
> parameter that seems to be the same as
> java.io.InputStreamReader(InputStream in, String charsetName) accepts.
> I added it to my ViewHandler:
>
> 	public class ViewHandler {
> 		private StringTemplateGroup templateGroup;
> 		private Map<String, String> attributes = new HashMap<String,
> String>();
>
> 		public ViewHandler(String viewBasePath) {
> 			templateGroup = new StringTemplateGroup("default", viewBasePath);
> 			System.out.println(templateGroup.getFileCharEncoding());
> 			templateGroup.setFileCharEncoding("UTF-8");
> 			System.out.println(templateGroup.getFileCharEncoding());
> 		}
>
> 		public void setAttribute(String name, String value) {
> 			attributes.put(name, value);
> 		}
>
> 		public String getOutput(String viewName) {
> 			StringTemplate view = templateGroup.getInstanceOf(viewName,
> attributes);
> 			return view.toString();
> 		}
>
> 		public void render(Writer out, String viewName) throws IOException {
> 			out.write(getOutput(viewName));
> 		}
> 	}
>
> Watching the console at the time of a request, it seems that UTF-8 is
> already the default in the system. In any case, that is what the
> option is set to. Still no go in the output however, the encoding
> issue remains.
>
> I have checked all encoding settings for the files properties and they
> all say UTF-8 (inherited from container).
> I also tried templateGroup.setFileCharEncoding("ISO-8859-1") instead,
> and it did change the <?> to a couple of junk characters instead, so
> it's not right.
> I'd also like to clarify that my previous information regarding the
> HTTP response headers carrying a charset in them was wrong; there is
> no such header sent. However, the browser adheres to the HTML meta tag
> defining a charset, that I am sure of.
>
> After some testing, I've found that there is /one/ thing that makes
> the page display correctly; If in the HTML of the template I set the
> charset to iso-8859-1 instead of utf-8, so that the browser parses the
> contents as latin1, it displays correctly. I can't really draw any
> other conclusion from this than that what the browser is sent is coded
> as latin1?
>
> At http://www.stringtemplate.org/api/org/antlr/stringtemplate/PathGroupLoader.html
>  I found the description "A brain dead loader that looks only in the
> directory(ies) you specify in the ctor. You may specify the char
> encoding. NOTE: this does not work when you jar things up! Use
> CommonGroupLoader instead in that case".
>
> Reading the note in the description, and also reading http://www.stringtemplate.org/api/org/antlr/stringtemplate/CommonGroupLoader.html
>  , I get the feeling that it's not the actual char encoding that
> doesn't work when "jar'ed up", but rather the loader class itself. But
> is this something I should try anyway? If so, how do I use the group
> loader?
>
> I did check with some Eclipse guys and they didn't feel that it was
> Eclipse not saving files correctly. Personally, I don't know since I
> havent used Eclipse long enough to form an opinion based on experience
> in it.
>
> Silly question maybe, but could it be that ST just *reads* the
> template files using UTF-8 (or the set encoding), but then outputs it
> using Latin1?
>
> For reference, here's the beginning of the index HTML template:
>
> 	<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd
> ">
> 	<html lang="sv-SE">
> 		<head>
> 			<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
> 			<title>MyApp</title>
> 			<link rel="stylesheet" type="text/css" href="css/common.css">
> 		</head>
> 		<body>
> 			? ? ? <!-- test characters -->
> 			$(contentTemplate)()$
> 		</body>
> 	</html>
>
> Many thanks,
>
> Regards, Leo
>
>
> 15 mar 2010 kl. 19.50 skrev Terence Parr:
>
>> Hi. You have to tell ST to use a UTF-8 encoding. should be option to
>> StringTemplateGroup or something.
>> Ter
>> On Mar 15, 2010, at 10:11 AM, Leo R. Lundgren wrote:
>>
>>> Hi,
>>>
>>> I am building a small servlet application using Eclipse, Tomcat 6,
>>> JRE
>>> 1.6, ST 3.2. Here is a ViewHandler I'm using to wrap ST
>>> functionality:
>>>
>>> 	public class ViewHandler {
>>> 		private StringTemplateGroup templateGroup;
>>> 		private Map<String, String> attributes = new HashMap<String,
>>> String>();
>>>
>>> 		public ViewHandler(String viewBasePath) {
>>> 			templateGroup = new StringTemplateGroup("default", viewBasePath);
>>> 		}
>>>
>>> 		public void setAttribute(String name, String value) {
>>> 			attributes.put(name, value);
>>> 		}
>>>
>>> 		public String getOutput(String viewName) {
>>> 			StringTemplate view = templateGroup.getInstanceOf(viewName);
>>> 			view.setAttributes(attributes);
>>> 			return view.toString();
>>> 		}
>>>
>>> 		public void render(Writer out, String viewName) throws
>>> IOException {
>>> 			out.write(getOutput(viewName));
>>> 		}
>>> 	}
>>>
>>> The handler is used like this in a servlet:
>>>
>>> 	protected void doGet(HttpServletRequest request,  
>>> HttpServletResponse
>>> response) throws ServletException, IOException {
>>> 		super.doGet(request, response);
>>> 		
>>> 		String viewBasePath = getServletContext().getRealPath("/WEB-INF/
>>> view");
>>> 		ViewHandler viewHandler = new ViewHandler(viewBasePath);
>>> 		viewHandler.setAttribute("fileName", "test.png");
>>> 		viewHandler.setAttribute("contentTemplate", "uploadFile");
>>>
>>> 		viewHandler.render(response.getWriter(), "index");
>>> 	}
>>>
>>> It does what it is supposed to; The output I get is the contents of
>>> the index.st template, with attributes replaced like they should be,
>>> and the content template included as expected.
>>>
>>> However, swedish characters such as ??? that are part of static
>>> strings in the template files are shown in the browser(s) as  
>>> question
>>> marks. I know this indicates coding/charset problems. An example
>>> string (from the template files) that is not displayed correctly is:
>>>
>>> 	<input type="button" class="cancelUploadButton" value="Avbryt
>>> ins?ttning">
>>>
>>> The '?' in the last word becomes a question mark in the browser.
>>>
>>>
>>> So, I have:
>>> - Checked the encoding settings in Eclipse, in all places I can find
>>> that seem to relate to the source files and/or template files.
>>> - Checked the encoding of the related template files (both in their
>>> properties and using an external editor that loads them fine as
>>> UTF-8).
>>> - Verified that the HTTP response headers say UTF-8 as the charset.
>>> The same goes for the HTML code itself, it's UTF-8 all the way.
>>>
>>> The only thing I haven't found to be apparently fine is when I open
>>> the .java files from my project using another editor (TextMate,  
>>> which
>>> has always handled encodings fine for me); Normally TextMate  
>>> displays
>>> the encoding used/discovered from loading the file (for the template
>>> files it says UTF-8), but for the Java source files it doesn't
>>> display
>>> anything.
>>> However there are no static strings in the source files other than
>>> template names and attributes, so I'm not sure that would matter.  
>>> But
>>> maybe it does, assuming there's something wrong with how the source
>>> files are saved by eclipse.
>>>
>>> Can someone shed some light on this issue? As I see it I've got  
>>> UTF-8
>>> everywhere (apart from possibly the Java source files, which I guess
>>> could be the issue), and it should work. But maybe I need to change
>>> something with regards to ST to have it work with UTF-8? If not, any
>>> other ideas?
>>>
>>> Thank you,
>>>
>>> // Leo
>>>
>>> _______________________________________________
>>> stringtemplate-interest mailing list
>>> stringtemplate-interest at antlr.org
>>> http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>>
>
>
>
> -|
>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest



-|


From leo at finalresort.org  Mon Mar 15 17:11:03 2010
From: leo at finalresort.org (Leo R. Lundgren)
Date: Tue, 16 Mar 2010 01:11:03 +0100
Subject: [stringtemplate-interest] UTF-8 not displaying correctly
	[SOLVED]
In-Reply-To: <937FF692-1D2D-41F3-B1E8-E2EF9BBB4F47@finalresort.org>
References: <F30257B1-4359-46ED-B605-852B30937639@finalresort.org>
	<1AB8C1C8-196D-458E-A9AD-99F27A3A8497@cs.usfca.edu>
	<A61B5F64-A58B-4993-92AF-E6C2AD88170E@finalresort.org>
	<937FF692-1D2D-41F3-B1E8-E2EF9BBB4F47@finalresort.org>
Message-ID: <85DA2907-C601-4533-B78A-855F21352653@finalresort.org>

Hey,

I found the cause of the problem. It's quite simple once found.

I needed to tell the PrintWriter of the servlet response to use UTF-8,  
as I take it this is because the PrintWriter doesn't just forward/ 
output a stream of bytes, but actually handle the characters in a way  
it's designed to.

I added response.setCharacterEncoding("UTF-8"); to my doGet() method  
in the servlet, and everything is fine now.

Thank you for your time!

// Leo


15 mar 2010 kl. 23.58 skrev Leo R. Lundgren:

> To clarify the combination of
> StringTemplateGroup.setFileCharEncoding() and HTML meta charset I have
> tried, and their results:
>
> 	setFileCharEncoding("UTF-8")
> 	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
> 	Result: Characters NOT displayed correctly in browser ("<?>"-sign/
> character displayed where there should be one "?").
>
> 	setFileCharEncoding("ISO-8859-1")
> 	<meta http-equiv="Content-Type" content="text/html;
> charset=iso-8859-1">
> 	Result: Characters NOT displayed correctly in browser (dual junk
> chars where there should be one "?").
>
> 	setFileCharEncoding("UTF-8")
> 	<meta http-equiv="Content-Type" content="text/html;
> charset=iso-8859-1">
> 	Result: Characters displayed correctly in browser.
>
> 	setFileCharEncoding("ISO-8859-1")
> 	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
> 	Result: Characters displayed correctly in browser.
>
> Pretty confusing.
>
> // Leo
>
>
> 15 mar 2010 kl. 23.48 skrev Leo R. Lundgren:
>
>> Hi,
>>
>> I found StringTemplateGroup. setFileCharEncoding() which takes a
>> parameter that seems to be the same as
>> java.io.InputStreamReader(InputStream in, String charsetName)  
>> accepts.
>> I added it to my ViewHandler:
>>
>> 	public class ViewHandler {
>> 		private StringTemplateGroup templateGroup;
>> 		private Map<String, String> attributes = new HashMap<String,
>> String>();
>>
>> 		public ViewHandler(String viewBasePath) {
>> 			templateGroup = new StringTemplateGroup("default", viewBasePath);
>> 			System.out.println(templateGroup.getFileCharEncoding());
>> 			templateGroup.setFileCharEncoding("UTF-8");
>> 			System.out.println(templateGroup.getFileCharEncoding());
>> 		}
>>
>> 		public void setAttribute(String name, String value) {
>> 			attributes.put(name, value);
>> 		}
>>
>> 		public String getOutput(String viewName) {
>> 			StringTemplate view = templateGroup.getInstanceOf(viewName,
>> attributes);
>> 			return view.toString();
>> 		}
>>
>> 		public void render(Writer out, String viewName) throws  
>> IOException {
>> 			out.write(getOutput(viewName));
>> 		}
>> 	}
>>
>> Watching the console at the time of a request, it seems that UTF-8 is
>> already the default in the system. In any case, that is what the
>> option is set to. Still no go in the output however, the encoding
>> issue remains.
>>
>> I have checked all encoding settings for the files properties and  
>> they
>> all say UTF-8 (inherited from container).
>> I also tried templateGroup.setFileCharEncoding("ISO-8859-1") instead,
>> and it did change the <?> to a couple of junk characters instead, so
>> it's not right.
>> I'd also like to clarify that my previous information regarding the
>> HTTP response headers carrying a charset in them was wrong; there is
>> no such header sent. However, the browser adheres to the HTML meta  
>> tag
>> defining a charset, that I am sure of.
>>
>> After some testing, I've found that there is /one/ thing that makes
>> the page display correctly; If in the HTML of the template I set the
>> charset to iso-8859-1 instead of utf-8, so that the browser parses  
>> the
>> contents as latin1, it displays correctly. I can't really draw any
>> other conclusion from this than that what the browser is sent is  
>> coded
>> as latin1?
>>
>> At http://www.stringtemplate.org/api/org/antlr/stringtemplate/PathGroupLoader.html
>> I found the description "A brain dead loader that looks only in the
>> directory(ies) you specify in the ctor. You may specify the char
>> encoding. NOTE: this does not work when you jar things up! Use
>> CommonGroupLoader instead in that case".
>>
>> Reading the note in the description, and also reading http://www.stringtemplate.org/api/org/antlr/stringtemplate/CommonGroupLoader.html
>> , I get the feeling that it's not the actual char encoding that
>> doesn't work when "jar'ed up", but rather the loader class itself.  
>> But
>> is this something I should try anyway? If so, how do I use the group
>> loader?
>>
>> I did check with some Eclipse guys and they didn't feel that it was
>> Eclipse not saving files correctly. Personally, I don't know since I
>> havent used Eclipse long enough to form an opinion based on  
>> experience
>> in it.
>>
>> Silly question maybe, but could it be that ST just *reads* the
>> template files using UTF-8 (or the set encoding), but then outputs it
>> using Latin1?
>>
>> For reference, here's the beginning of the index HTML template:
>>
>> 	<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd
>> ">
>> 	<html lang="sv-SE">
>> 		<head>
>> 			<meta http-equiv="Content-Type" content="text/html;  
>> charset=utf-8">
>> 			<title>MyApp</title>
>> 			<link rel="stylesheet" type="text/css" href="css/common.css">
>> 		</head>
>> 		<body>
>> 			? ? ? <!-- test characters -->
>> 			$(contentTemplate)()$
>> 		</body>
>> 	</html>
>>
>> Many thanks,
>>
>> Regards, Leo
>>
>>
>> 15 mar 2010 kl. 19.50 skrev Terence Parr:
>>
>>> Hi. You have to tell ST to use a UTF-8 encoding. should be option to
>>> StringTemplateGroup or something.
>>> Ter
>>> On Mar 15, 2010, at 10:11 AM, Leo R. Lundgren wrote:
>>>
>>>> Hi,
>>>>
>>>> I am building a small servlet application using Eclipse, Tomcat 6,
>>>> JRE
>>>> 1.6, ST 3.2. Here is a ViewHandler I'm using to wrap ST
>>>> functionality:
>>>>
>>>> 	public class ViewHandler {
>>>> 		private StringTemplateGroup templateGroup;
>>>> 		private Map<String, String> attributes = new HashMap<String,
>>>> String>();
>>>>
>>>> 		public ViewHandler(String viewBasePath) {
>>>> 			templateGroup = new StringTemplateGroup("default",  
>>>> viewBasePath);
>>>> 		}
>>>>
>>>> 		public void setAttribute(String name, String value) {
>>>> 			attributes.put(name, value);
>>>> 		}
>>>>
>>>> 		public String getOutput(String viewName) {
>>>> 			StringTemplate view = templateGroup.getInstanceOf(viewName);
>>>> 			view.setAttributes(attributes);
>>>> 			return view.toString();
>>>> 		}
>>>>
>>>> 		public void render(Writer out, String viewName) throws
>>>> IOException {
>>>> 			out.write(getOutput(viewName));
>>>> 		}
>>>> 	}
>>>>
>>>> The handler is used like this in a servlet:
>>>>
>>>> 	protected void doGet(HttpServletRequest request,
>>>> HttpServletResponse
>>>> response) throws ServletException, IOException {
>>>> 		super.doGet(request, response);
>>>> 		
>>>> 		String viewBasePath = getServletContext().getRealPath("/WEB-INF/
>>>> view");
>>>> 		ViewHandler viewHandler = new ViewHandler(viewBasePath);
>>>> 		viewHandler.setAttribute("fileName", "test.png");
>>>> 		viewHandler.setAttribute("contentTemplate", "uploadFile");
>>>>
>>>> 		viewHandler.render(response.getWriter(), "index");
>>>> 	}
>>>>
>>>> It does what it is supposed to; The output I get is the contents of
>>>> the index.st template, with attributes replaced like they should  
>>>> be,
>>>> and the content template included as expected.
>>>>
>>>> However, swedish characters such as ??? that are part of static
>>>> strings in the template files are shown in the browser(s) as
>>>> question
>>>> marks. I know this indicates coding/charset problems. An example
>>>> string (from the template files) that is not displayed correctly  
>>>> is:
>>>>
>>>> 	<input type="button" class="cancelUploadButton" value="Avbryt
>>>> ins?ttning">
>>>>
>>>> The '?' in the last word becomes a question mark in the browser.
>>>>
>>>>
>>>> So, I have:
>>>> - Checked the encoding settings in Eclipse, in all places I can  
>>>> find
>>>> that seem to relate to the source files and/or template files.
>>>> - Checked the encoding of the related template files (both in their
>>>> properties and using an external editor that loads them fine as
>>>> UTF-8).
>>>> - Verified that the HTTP response headers say UTF-8 as the charset.
>>>> The same goes for the HTML code itself, it's UTF-8 all the way.
>>>>
>>>> The only thing I haven't found to be apparently fine is when I open
>>>> the .java files from my project using another editor (TextMate,
>>>> which
>>>> has always handled encodings fine for me); Normally TextMate
>>>> displays
>>>> the encoding used/discovered from loading the file (for the  
>>>> template
>>>> files it says UTF-8), but for the Java source files it doesn't
>>>> display
>>>> anything.
>>>> However there are no static strings in the source files other than
>>>> template names and attributes, so I'm not sure that would matter.
>>>> But
>>>> maybe it does, assuming there's something wrong with how the source
>>>> files are saved by eclipse.
>>>>
>>>> Can someone shed some light on this issue? As I see it I've got
>>>> UTF-8
>>>> everywhere (apart from possibly the Java source files, which I  
>>>> guess
>>>> could be the issue), and it should work. But maybe I need to change
>>>> something with regards to ST to have it work with UTF-8? If not,  
>>>> any
>>>> other ideas?
>>>>
>>>> Thank you,
>>>>
>>>> // Leo
>>>>
>>>> _______________________________________________
>>>> stringtemplate-interest mailing list
>>>> stringtemplate-interest at antlr.org
>>>> http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>>>
>>
>>
>>
>> -|
>>
>> _______________________________________________
>> stringtemplate-interest mailing list
>> stringtemplate-interest at antlr.org
>> http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>
>
>
> -|
>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest



-|


From parrt at cs.usfca.edu  Mon Mar 15 17:14:49 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 15 Mar 2010 17:14:49 -0700
Subject: [stringtemplate-interest] UTF-8 not displaying correctly
	[SOLVED]
In-Reply-To: <85DA2907-C601-4533-B78A-855F21352653@finalresort.org>
References: <F30257B1-4359-46ED-B605-852B30937639@finalresort.org>
	<1AB8C1C8-196D-458E-A9AD-99F27A3A8497@cs.usfca.edu>
	<A61B5F64-A58B-4993-92AF-E6C2AD88170E@finalresort.org>
	<937FF692-1D2D-41F3-B1E8-E2EF9BBB4F47@finalresort.org>
	<85DA2907-C601-4533-B78A-855F21352653@finalresort.org>
Message-ID: <CFDA8384-7315-48DE-8B81-EBC16726EA90@cs.usfca.edu>

hooray! sorry I'm slow to respond. I'm neckdeep inside antlr v4 DFA algorithms. my head hurts.
Ter


From bortuzar at gmail.com  Tue Mar 16 08:40:16 2010
From: bortuzar at gmail.com (Benjamin Ortuzar Seconde)
Date: Tue, 16 Mar 2010 15:40:16 +0000
Subject: [stringtemplate-interest] hastable attribute
Message-ID: <3a0cf5161003160840q783b47b3tdb7cdb4feda46b67@mail.gmail.com>

In C# I have a hastable. The hastable key is the 'source' name, the hastable
value is a List<string>
How can use StringTemplate to print something similar to:

*Source1:
- Title1
- Title2

*Source2:
- Title3
- Title4
..

OR should I do this in a different way?

Thanks in advance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100316/1c9f0c76/attachment.html 

From parrt at cs.usfca.edu  Wed Mar 17 10:57:44 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 17 Mar 2010 10:57:44 -0700
Subject: [stringtemplate-interest] hastable attribute
In-Reply-To: <3a0cf5161003160840q783b47b3tdb7cdb4feda46b67@mail.gmail.com>
References: <3a0cf5161003160840q783b47b3tdb7cdb4feda46b67@mail.gmail.com>
Message-ID: <C33BE2C3-7C98-49E6-8C88-18D15ACC43C4@cs.usfca.edu>

should be in the doc.

> StringTemplate interprets Map objects to have two predefined properties: keys and values that yield a list of all keys and the list of all values, respectively. When applying a template to a map, StringTemplate iterates over the values so that <aMap> is a shorthand for <aMap.values>. Similarly <aMap.keys> walks over the keys. You can list all of the elements in a map like this:
> 
> <aMap.keys:{k| <k> maps to <aMap.(k)>}>.

k is source here and aMap.(k) would get you the value (a list).
T
On Mar 16, 2010, at 8:40 AM, Benjamin Ortuzar Seconde wrote:

> In C# I have a hastable. The hastable key is the 'source' name, the hastable value is a List<string>
> How can use StringTemplate to print something similar to:
> 
> *Source1:
> - Title1
> - Title2
> 
> *Source2:
> - Title3
> - Title4
> ..
> 
> OR should I do this in a different way?
> 
> Thanks in advance
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From parrt at cs.usfca.edu  Fri Mar 19 12:26:14 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 19 Mar 2010 12:26:14 -0700
Subject: [stringtemplate-interest] just fixed bug in st4, pushed
Message-ID: <10A97988-B8A0-455E-9BC1-82FB212C6DA2@cs.usfca.edu>

howdy, when referencing templates from other groups, ST4 sometimes looked up the wrong template.  Pushed to 

http://www.stringtemplate.org/download/trunk

Ter

From parrt at cs.usfca.edu  Mon Mar 22 11:13:53 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 22 Mar 2010 11:13:53 -0700
Subject: [stringtemplate-interest] Asking template for its Attributes
	prior to running it
In-Reply-To: <3c47535d1003210533m7c2a3eeu5b0158edc641254b@mail.gmail.com>
References: <mailman.28.1269172652.3065.stringtemplate-interest@antlr.org>
	<3c47535d1003210533m7c2a3eeu5b0158edc641254b@mail.gmail.com>
Message-ID: <7186C810-A34E-4016-BB4B-F85EF6C92EB7@cs.usfca.edu>

hi. do you mean from code or within a template? The template should give you back a map of the attributes no problem from Java code or whatever your target is.
Ter
On Mar 21, 2010, at 5:33 AM, Martin Clausen wrote:

> I know this is in the FAQ
> (http://www.antlr.org/wiki/pages/viewpage.action?pageId=1817), but the
> answer is not there.
> 
> Is there a way of asking template for its Attributes prior to running
> it? I can live with the answer not including an Attributes found in
> conditionally included templates etc.
> 
> Thanks for any help.
> 
> /mac


From martin.clausen at gmail.com  Mon Mar 22 12:16:05 2010
From: martin.clausen at gmail.com (Martin Clausen)
Date: Mon, 22 Mar 2010 20:16:05 +0100
Subject: [stringtemplate-interest] Asking template for its Attributes
	prior to running it
In-Reply-To: <7186C810-A34E-4016-BB4B-F85EF6C92EB7@cs.usfca.edu>
References: <mailman.28.1269172652.3065.stringtemplate-interest@antlr.org>
	<3c47535d1003210533m7c2a3eeu5b0158edc641254b@mail.gmail.com>
	<7186C810-A34E-4016-BB4B-F85EF6C92EB7@cs.usfca.edu>
Message-ID: <3c47535d1003221216q21de2567h43981ebc0bb24c7a@mail.gmail.com>

>From code (Java). The trick is that I need the attributes before the
template is run. Which method will give me that? I tried getAttributes
but that returns empty.

On Mon, Mar 22, 2010 at 7:13 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> hi. do you mean from code or within a template? The template should give you back a map of the attributes no problem from Java code or whatever your target is.
> Ter
> On Mar 21, 2010, at 5:33 AM, Martin Clausen wrote:
>
>> I know this is in the FAQ
>> (http://www.antlr.org/wiki/pages/viewpage.action?pageId=1817), but the
>> answer is not there.
>>
>> Is there a way of asking template for its Attributes prior to running
>> it? I can live with the answer not including an Attributes found in
>> conditionally included templates etc.
>>
>> Thanks for any help.
>>
>> /mac
>
>

From parrt at cs.usfca.edu  Mon Mar 22 12:39:58 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 22 Mar 2010 12:39:58 -0700
Subject: [stringtemplate-interest] Asking template for its Attributes
	prior to running it
In-Reply-To: <3c47535d1003221216q21de2567h43981ebc0bb24c7a@mail.gmail.com>
References: <mailman.28.1269172652.3065.stringtemplate-interest@antlr.org>
	<3c47535d1003210533m7c2a3eeu5b0158edc641254b@mail.gmail.com>
	<7186C810-A34E-4016-BB4B-F85EF6C92EB7@cs.usfca.edu>
	<3c47535d1003221216q21de2567h43981ebc0bb24c7a@mail.gmail.com>
Message-ID: <28093968-7B1C-4692-937B-4877761A13C9@cs.usfca.edu>

ah. then there are no attributes for that template.
Ter
On Mar 22, 2010, at 12:16 PM, Martin Clausen wrote:

>> From code (Java). The trick is that I need the attributes before the
> template is run. Which method will give me that? I tried getAttributes
> but that returns empty.
> 
> On Mon, Mar 22, 2010 at 7:13 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>> hi. do you mean from code or within a template? The template should give you back a map of the attributes no problem from Java code or whatever your target is.
>> Ter
>> On Mar 21, 2010, at 5:33 AM, Martin Clausen wrote:
>> 
>>> I know this is in the FAQ
>>> (http://www.antlr.org/wiki/pages/viewpage.action?pageId=1817), but the
>>> answer is not there.
>>> 
>>> Is there a way of asking template for its Attributes prior to running
>>> it? I can live with the answer not including an Attributes found in
>>> conditionally included templates etc.
>>> 
>>> Thanks for any help.
>>> 
>>> /mac
>> 
>> 


From parrt at cs.usfca.edu  Tue Mar 23 14:26:58 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 23 Mar 2010 14:26:58 -0700
Subject: [stringtemplate-interest] Why an == operator is sometimes
	necessary, and how to implement it (ST3/C#)
In-Reply-To: <20100312191522.133220@gmx.net>
References: <20100312191522.133220@gmx.net>
Message-ID: <A0F904A5-0790-4E84-B5BC-18E6DC80A69B@cs.usfca.edu>

Hi Harald, it still seems to me that deciding what replacements to do is part of the model not the view. I encapsulate the translation rules primarily in the model unless they are fixed one-to-one mappings, in which case I can do a static map in the template group file.   personally, I figure out what to generate and then ask ST to dump it out in the right format.

Ter
On Mar 12, 2010, at 11:15 AM, Harald Mueller wrote:

> Hi -
> 
> as we all know, ST does not have any expression operators in its language, and that is almost always a good thing. However, in a well-worn code generator we use to create triggers in an SQL database, we finally got to the point where we needed an equals operator in $if(...)$. Here is why; and how we implemented it.
> 
> The problem is as follows: Input to the generation is (a) a list of SQL tables; (b) the FROM part of an SQL statement, which is a tree of join nodes; each join node points to a table (and of course has information about the joined columns and inner/outer etc., but that's not important); and (c) a replacement string (typically "INSERTED" or "DELETED"; but there are more).
> The job to do is to write a trigger for each table in the join tree, such that the table itself is replaced with the replacement string.
> 
> A small example:
> (a) T1, T2
> (b) ... FROM T1 INNER JOIN T2 INNER JOIN T3
> (c) "INSERTED"
> Result:
> ... FROM INSERTED INNER JOIN T2 INNER JOIN T3
> ... FROM T1 INNER JOIN INSERTED INNER JOIN T3
> 
> The example below is a simplified version of the above, however, its ST template marks nodes in a tree with an arrow (<--) if the node's "table name" is equal to the "replacement table".
> 
> Here is the model, together with the "equals operator":
> 
>    public class Table {
>        public string Name;
>    }
> 
>    public class Join {
>        public readonly string Name;
>        public readonly Table JoinedTable;
>        public readonly List<Join> Children;
>        public Join(string name, Table joinedTable, params Join[] children) {
>            Name = name;
>            JoinedTable = joinedTable;
>            Children = new List<Join>(children);
>        }
>    }
> 
> Here are the templates - first the Main template, then the recursive one for printing the tree.
> 
> Main(Target, Tables) ::= <<
>    $Tables:PrintTreeReplacingTable(Target=Target,Replace=it)$
>>> 
> 
> PrintTreeReplacingTable(Target,Replace) ::= <<
>    $Target.Name$ $if(Target.NameIsReplace.(Replace.Name))$ <--	$endif$
> 	$Target.Children:PrintTreeReplacingTable(Target=it,Replace=Replace)$
> 
>>> 
> 
> The important idea here is the expression
> 
>    Target.NameIsReplace.(Replace.Name)
> 
> where .NameEquals is a property that returns an IDictionary. The (Replacement.Name) then passes in a value which is in effect the parameter of a single-arg function which implements "Target.Name == Replace.Name" - that's the whole trick.
> 
> So we extend Join with the following additional property
> 
>    public IDictionary NameEquals {
>        get {
>            return new Equals(JoinedTable.Name);
>        }
>    }
> 
> and the class Equals, which is implemented as follows:
> 
>    class Equals : DictionaryBase, IDictionary {
>        private readonly string _tn;
> 
>        public Equals(string tn) {
>            _tn = tn;
>        }
> 
>        bool IDictionary.Contains(object key) {
>            return key.ToString() == _tn;
>        }
> 
>        object IDictionary.this[object key] {
>            get {
>                return key.ToString() == _tn;
>            }
>            set { throw new NotImplementedException(); }
>        }
>    }
> 
> That's it. Maybe it helps someone.
> And maybe someone's got an idea how this works without that IDictionary trick - but we didn't see how!
> 
> Regards
> Harald M.
> 
> -- 
> GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
> Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From parrt at cs.usfca.edu  Tue Mar 23 14:35:29 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 23 Mar 2010 14:35:29 -0700
Subject: [stringtemplate-interest] Problem in StringTemplate V4
In-Reply-To: <ef28a20a1003041737r489457b6yd2254777f180a40a@mail.gmail.com>
References: <ef28a20a1003041119j698c2806j32ac5deaee1fd5a3@mail.gmail.com>
	<C19BE722-21AD-4DF7-9F06-8E174B641765@cs.usfca.edu>
	<ef28a20a1003041737r489457b6yd2254777f180a40a@mail.gmail.com>
Message-ID: <0D62D567-5CD0-4EF9-BC6E-566C48EBBA90@cs.usfca.edu>

Hi. what about when you make a group dir at root C:\foo ?  Doesn't that mess up when i load a template called T? I'd get a URL of C:\foo/T.stg here:

            groupFileURL = new URL(root+parent+".stg");

Ter
On Mar 4, 2010, at 5:37 PM, Cliff Zhao wrote:

> I did a quick fix as below:
> 1. Add a method in the Misc class:
> public static String getParent(String name) {
>     if (name==null) return null;
>     int pos=name.lastIndexOf('/');
>     if (pos<=0) return "/";
>     return name.substring(0, pos+1);
> }
> 2. Replace "new File(something).getParent()" with "Misc.getParent(something)"
> 
> It worked for me. I am not sure if it is a good fix, since I am not so deep in the StringTemplate code.
> 
> Best Regards,
> Cliff Zhao
> 
> On Thu, Mar 4, 2010 at 5:43 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Hi. interesting. dang windoze.  ok, so I want ST4 to always use / as the dir separator for consistency across platforms.  how do we fix?  Should I convert all \ to /?
> Ter
> On Mar 4, 2010, at 11:19 AM, Cliff Zhao wrote:
> 
> > I run into problem for StringTemplate V4. It failed in my Windows XP environment.
> >
> > I did some debug, and found the problem is about forward slash (/) and back slash(\).
> >
> > The File(name).getParent() return OS-specific path. On Windows, it is "\". So, when I load a template in a group like group.getInstanceOf("admin/home"), it returns null.
> > The code in STGroupDir.java:
> >
> >     public CompiledST loadTemplateFile(String fileName) {
> >         //System.out.println("load "+fileName+" from "+root);
> >         String prefix = new File(fileName).getParent();
> >         if ( !prefix.endsWith("/") ) prefix += "/";
> >         try {
> >             String templateName = Misc.getFileNameNoSuffix(fileName);
> >             URL f = new URL(root+fileName);
> >             ANTLRInputStream fs = new ANTLRInputStream(f.openStream(), encoding);
> >             if ( ErrorManager.v3_mode) {
> >                 String template = fs.toString(); // needs > ANTLR 3.2
> >                 template = template.trim();
> >                 String justName = new File(templateName).getName();
> >                 defineTemplate(prefix,
> >                                new CommonToken(GroupParser.ID,justName),
> >                                null,
> >                                template);
> >             }
> >             else {
> >                 GroupLexer lexer = new GroupLexer(fs);
> >                 fs.name = fileName;
> >                 CommonTokenStream tokens = new CommonTokenStream(lexer);
> >                 GroupParser parser = new GroupParser(tokens);
> >                 parser.group = this;
> > =A=====>                parser.templateDef(prefix);
> >             }
> > =B=====>            return templates.get(templateName);
> >         }
> >
> > After the A point, the templates variable contains one entry { "\admin/home", --parsed ST--}.
> > At the B point, the templateName is "/admin/home". It is a mismatch!
> >
> > Could you fix it?
> >
> > Thank you very much.
> >
> > Best Regards,
> > Cliff Zhao
> > _______________________________________________
> > stringtemplate-interest mailing list
> > stringtemplate-interest at antlr.org
> > http://www.antlr.org/mailman/listinfo/stringtemplate-interest
> 
> 


From harald_m_mueller at gmx.de  Tue Mar 23 15:49:37 2010
From: harald_m_mueller at gmx.de (Harald Mueller)
Date: Tue, 23 Mar 2010 23:49:37 +0100
Subject: [stringtemplate-interest] Why an == operator is sometimes
 necessary, and how to implement it (ST3/C#)
Message-ID: <20100323224937.77540@gmx.net>

Hi Terence -

The problem, in that case, is that the model cannot decide what replacement to do because the loop over the things that define waht to replace happens in ST. 
With a "standard two layered design" with a model and templates accessing the model, you don't "get back" this information, unless using a trick like the one I described.

Now, we both know that there are alternatives to that design: One can do a four-layer design (an inner model [layer 1] is used by local templates [layer 2] to create code snippets into a "parts model" [3], which is then assembled by assembly templates [4]). Or a three-layered version, where a coded [3] loop tells the model about the replacements and then uses templates [2] to get information out of the updated model [1].

However, when I did the latter, it got awfully ugly - pieces of SQL code at various levels. As long as the decision about the replacement could be made in a loop that was "very external" to the generated code (in our case, when we simply created trigger code per SQL table), we could "fix up" the model "in time" to return different information through properties (the 3-layered design). Still, this introduced mutable models, where one had to *know* at which time the model was in which state to deliver the correct replacements.

When, however, those loops had to be multiplied at a more than one place with boilerplate SQL in between, we'd have needed a 4-layered design ... and that would have been a large rewrite (and redesign) for a seemingly small piece of information.

But I stop here with general arguments ... just show me how, with a standard two-layered design, you can get the output of my example :-) [warning: I might make it more complex if your solution is too easily done, but my example was too much simplified ;-) ... did anyone say I'd have to be fair?]. If we can agree on the result, I'll happily rewrite our code (well, it's a real project, so I might not have the time and money to do it ...).

Regards

Harald

-- 
GMX DSL: Internet, Telefon und Entertainment f?r nur 19,99 EUR/mtl.!
http://portal.gmx.net/de/go/dsl02

From andrew.bradnan at gmail.com  Tue Mar 23 17:35:23 2010
From: andrew.bradnan at gmail.com (Andrew Bradnan)
Date: Tue, 23 Mar 2010 17:35:23 -0700
Subject: [stringtemplate-interest] Whitespace
Message-ID: <8a5e9b781003231735g45102fb6qbd2b0f3681c1e84f@mail.gmail.com>

Is there anyway to specify how much whitespace comes before the start of
a template?
Currently I have an attribute with a count.  I'd like to turn that into "\t"
* count (in Python speak).  So if count was 10, I'd like 10 tabs before my
template started.
Thanks,
-- 
/Andrew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100323/c0d36f24/attachment.html 

From richard.m.catlin at gmail.com  Wed Mar 24 15:39:03 2010
From: richard.m.catlin at gmail.com (Richard Catlin)
Date: Wed, 24 Mar 2010 15:39:03 -0700
Subject: [stringtemplate-interest] Help needed with separator
Message-ID: <f34319e41003241539wfd01efer1cb05e1eb5da2497@mail.gmail.com>

I am building a parameter list for a method, such as:

public void method1(String param1, int param2) {
..
}

    <parameters: {p | <p.type> <p.name><comma()>}>

How do I prevent a comma from coming after the last parameter?
This is in a *.stg file called by Antlr.

Thanks for you any help.

Richard Catlin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100324/c19627bc/attachment.html 

From parrt at cs.usfca.edu  Wed Mar 24 15:55:57 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 24 Mar 2010 15:55:57 -0700
Subject: [stringtemplate-interest] Help needed with separator
In-Reply-To: <f34319e41003241539wfd01efer1cb05e1eb5da2497@mail.gmail.com>
References: <f34319e41003241539wfd01efer1cb05e1eb5da2497@mail.gmail.com>
Message-ID: <877B8A1B-3D17-4FD2-8B28-B63E54D37FD1@cs.usfca.edu>

separator=comma() as option :)
Ter
On Mar 24, 2010, at 3:39 PM, Richard Catlin wrote:

> I am building a parameter list for a method, such as:
> 
> public void method1(String param1, int param2) {
> ..
> }
> 
>     <parameters: {p | <p.type> <p.name><comma()>}>
> 
> How do I prevent a comma from coming after the last parameter?
> This is in a *.stg file called by Antlr.
> 
> Thanks for you any help.
> 
> Richard Catlin
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From parrt at cs.usfca.edu  Thu Mar 25 12:13:06 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 25 Mar 2010 12:13:06 -0700
Subject: [stringtemplate-interest] Whitespace
In-Reply-To: <8a5e9b781003231735g45102fb6qbd2b0f3681c1e84f@mail.gmail.com>
References: <8a5e9b781003231735g45102fb6qbd2b0f3681c1e84f@mail.gmail.com>
Message-ID: <CC32F427-5C46-4326-BB70-A782740EB361@cs.usfca.edu>


On Mar 23, 2010, at 5:35 PM, Andrew Bradnan wrote:

> Is there anyway to specify how much whitespace comes before the start of a template?

Unfortunately not. ST consumes all the white space before and after templates.

> Currently I have an attribute with a count.  I'd like to turn that into "\t" * count (in Python speak).  So if count was 10, I'd like 10 tabs before my template started.

Oh. that's easy using a renderer.

<x; format="10">

Then, for the type of variable x, register a renderer that knows how to interpret 10.

Ter

From anthonyu at cs.ucla.edu  Thu Mar 25 14:18:57 2010
From: anthonyu at cs.ucla.edu (Anthony Urso)
Date: Thu, 25 Mar 2010 14:18:57 -0700
Subject: [stringtemplate-interest] "it" equivalent within parallel list
	iteration?
Message-ID: <ba72f77f1003251418y68bc4c94k34e2723f7068e3c@mail.gmail.com>

How do I access the current list entries during parallel list
iteration? E.g. what "it" would do in non-parallel list iteration?

Cheers,
Anthony

From parrt at cs.usfca.edu  Thu Mar 25 14:20:32 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 25 Mar 2010 14:20:32 -0700
Subject: [stringtemplate-interest] "it" equivalent within parallel list
	iteration?
In-Reply-To: <ba72f77f1003251418y68bc4c94k34e2723f7068e3c@mail.gmail.com>
References: <ba72f77f1003251418y68bc4c94k34e2723f7068e3c@mail.gmail.com>
Message-ID: <A013AD71-7C5C-4922-863B-A97680BEF28E@cs.usfca.edu>

You need to define "parameters":

<names,phones:{n,p | ...}>

Ter
On Mar 25, 2010, at 2:18 PM, Anthony Urso wrote:

> How do I access the current list entries during parallel list
> iteration? E.g. what "it" would do in non-parallel list iteration?
> 
> Cheers,
> Anthony
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From sterini at gmail.com  Thu Mar 25 21:42:03 2010
From: sterini at gmail.com (Ilya Sterin)
Date: Fri, 26 Mar 2010 00:42:03 -0400
Subject: [stringtemplate-interest] Template validation
Message-ID: <67d2b0c71003252142q65c4a343ud0efe50aa88cda3b@mail.gmail.com>

Is there a way to validate a template synchronously.   I see there is
a StringTemplateErrorListener which allows to listen to an error
event, but it doesn't fit very well into my current model.  We
basically have a factory which generates templates by retrieving them
from storage (these templates are user defined) and then we construct
a StringTemplate using the text.  Currently, no exception is thrown
and StringTemplate logs parsing errors

action parse error; template context is [anonymous
if(isIntervalFull)_subtemplate]
line 1:1: unexpected token: Congrats
at org.antlr.stringtemplate.language.ActionParser.primaryExpr(ActionParser.java:813)
at org.antlr.stringtemplate.language.ActionParser.expr(ActionParser.java:539)
...

Is there a way to either force the parser to throw an exception and/or
is there a way to validate the template text synchronously?

Thanks.

--Ilya

From parrt at cs.usfca.edu  Fri Mar 26 11:26:51 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 26 Mar 2010 11:26:51 -0700
Subject: [stringtemplate-interest] Template validation
In-Reply-To: <67d2b0c71003252142q65c4a343ud0efe50aa88cda3b@mail.gmail.com>
References: <67d2b0c71003252142q65c4a343ud0efe50aa88cda3b@mail.gmail.com>
Message-ID: <03510FAA-035F-4F7A-91A5-68C819C41AB2@cs.usfca.edu>

Can you have the listener throw an exception?
Ter
On Mar 25, 2010, at 9:42 PM, Ilya Sterin wrote:

> Is there a way to validate a template synchronously.   I see there is
> a StringTemplateErrorListener which allows to listen to an error
> event, but it doesn't fit very well into my current model.  We
> basically have a factory which generates templates by retrieving them
> from storage (these templates are user defined) and then we construct
> a StringTemplate using the text.  Currently, no exception is thrown
> and StringTemplate logs parsing errors
> 
> action parse error; template context is [anonymous
> if(isIntervalFull)_subtemplate]
> line 1:1: unexpected token: Congrats
> at org.antlr.stringtemplate.language.ActionParser.primaryExpr(ActionParser.java:813)
> at org.antlr.stringtemplate.language.ActionParser.expr(ActionParser.java:539)
> ...
> 
> Is there a way to either force the parser to throw an exception and/or
> is there a way to validate the template text synchronously?
> 
> Thanks.
> 
> --Ilya
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From richard.m.catlin at gmail.com  Fri Mar 26 14:08:42 2010
From: richard.m.catlin at gmail.com (Richard Catlin)
Date: Fri, 26 Mar 2010 14:08:42 -0700
Subject: [stringtemplate-interest] Help needed with separator
In-Reply-To: <877B8A1B-3D17-4FD2-8B28-B63E54D37FD1@cs.usfca.edu>
References: <f34319e41003241539wfd01efer1cb05e1eb5da2497@mail.gmail.com>
	<877B8A1B-3D17-4FD2-8B28-B63E54D37FD1@cs.usfca.edu>
Message-ID: <f34319e41003261408m1ca07c71jab3e74f11f376702@mail.gmail.com>

It works.  Thanks.

<attributes : {attribute | <attribute.type> <attribute.name
>};separator=comma()>


On Wed, Mar 24, 2010 at 3:55 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> separator=comma() as option :)
> Ter
> On Mar 24, 2010, at 3:39 PM, Richard Catlin wrote:
>
> > I am building a parameter list for a method, such as:
> >
> > public void method1(String param1, int param2) {
> > ..
> > }
> >
> >     <parameters: {p | <p.type> <p.name><comma()>}>
> >
> > How do I prevent a comma from coming after the last parameter?
> > This is in a *.stg file called by Antlr.
> >
> > Thanks for you any help.
> >
> > Richard Catlin
> > _______________________________________________
> > stringtemplate-interest mailing list
> > stringtemplate-interest at antlr.org
> > http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100326/91af22bb/attachment.html 

From richard.m.catlin at gmail.com  Fri Mar 26 14:10:29 2010
From: richard.m.catlin at gmail.com (Richard Catlin)
Date: Fri, 26 Mar 2010 14:10:29 -0700
Subject: [stringtemplate-interest] Way to merge/save changes to
	generated code
Message-ID: <f34319e41003261410i318ae34fndb2646f89a0538bd@mail.gmail.com>

I am using Antlr/StringTemplate to generate files, such as a SessionFacade:

public class SessionFacade() {

}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100326/780c2d12/attachment.html 

From richard.m.catlin at gmail.com  Fri Mar 26 14:16:26 2010
From: richard.m.catlin at gmail.com (Richard Catlin)
Date: Fri, 26 Mar 2010 14:16:26 -0700
Subject: [stringtemplate-interest] Way to merge/save changes to generated
	code
Message-ID: <f34319e41003261416l266b833fi56cf8ff5d00b4d57@mail.gmail.com>

I am using Antlr/StringTemplate to generate a SessionFacde class.  I then
need to fill in some of the methods.  Is there a way to merge/save the user
hand written code, if the file is regenerated.  I thought using SVN would at
least allow me to diff the file and cut and paste the user hand written
code, but was wondering if anyone has a better strategy for automating.
Other tools like Acceleo have a merge/lost feature.  "lost" is user code
that could not be merged due to a change in the generated code, such as a
method deletion.

For instance, a Session Facade may be:

public class SessionFacade1 {
  public String method1() {
    /* User hand-written code */
    return "hello";
    /* end User hand-written code */
  }
}

Thanks for any help.
Richard Catlin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100326/4031b498/attachment.html 

From gerald at certiv.net  Fri Mar 26 14:49:58 2010
From: gerald at certiv.net (Gerald Rosenberg)
Date: Fri, 26 Mar 2010 14:49:58 -0700
Subject: [stringtemplate-interest] Way to merge/save changes to
 generated code
In-Reply-To: <f34319e41003261416l266b833fi56cf8ff5d00b4d57@mail.gmail.com>
References: <f34319e41003261416l266b833fi56cf8ff5d00b4d57@mail.gmail.com>
Message-ID: <4BAD2C06.3020208@certiv.net>

XText uses a convenient strategy of external fragments, thereby avoiding 
most if not all diff/merge issues.  Empty fragments are generated iff 
the files do not exist.  The generated code just delegates to named 
fragments where customization is anticipated.

// regenerable
public class SessionFacade1 {
   public String method1(Object arg) {
     String response = SessionFacade1Fragment.method1(arg);
     if (!response.isEmpty()) return response;
     return "hello";
   }
}

// generated once
public class SessionFacade1Fragment {
   public static String method1(Object arg) {
     /* User hand-written code */
     return "";
     /* end User hand-written code */
   }
}

On 3/26/2010 2:16 PM, Richard Catlin wrote:
> I am using Antlr/StringTemplate to generate a SessionFacde class.  I 
> then need to fill in some of the methods.  Is there a way to 
> merge/save the user hand written code, if the file is regenerated.  I 
> thought using SVN would at least allow me to diff the file and cut and 
> paste the user hand written code, but was wondering if anyone has a 
> better strategy for automating.  Other tools like Acceleo have a 
> merge/lost feature.  "lost" is user code that could not be merged due 
> to a change in the generated code, such as a method deletion.
>
> For instance, a Session Facade may be:
>
> public class SessionFacade1 {
>   public String method1() {
>     /* User hand-written code */
>     return "hello";
>     /* end User hand-written code */
>   }
> }
>
> Thanks for any help.
> Richard Catlin
>
>
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>    
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20100326/7b49483a/attachment.html 

From sterini at gmail.com  Fri Mar 26 21:36:25 2010
From: sterini at gmail.com (Ilya Sterin)
Date: Sat, 27 Mar 2010 00:36:25 -0400
Subject: [stringtemplate-interest] Template validation
In-Reply-To: <03510FAA-035F-4F7A-91A5-68C819C41AB2@cs.usfca.edu>
References: <67d2b0c71003252142q65c4a343ud0efe50aa88cda3b@mail.gmail.com>
	<03510FAA-035F-4F7A-91A5-68C819C41AB2@cs.usfca.edu>
Message-ID: <67d2b0c71003262136o1c6ce6b3t4249eacd1c323f12@mail.gmail.com>

Yes, that's what I ended up doing.

Thanks.

On Fri, Mar 26, 2010 at 2:26 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Can you have the listener throw an exception?
> Ter
> On Mar 25, 2010, at 9:42 PM, Ilya Sterin wrote:
>
>> Is there a way to validate a template synchronously. ? I see there is
>> a StringTemplateErrorListener which allows to listen to an error
>> event, but it doesn't fit very well into my current model. ?We
>> basically have a factory which generates templates by retrieving them
>> from storage (these templates are user defined) and then we construct
>> a StringTemplate using the text. ?Currently, no exception is thrown
>> and StringTemplate logs parsing errors
>>
>> action parse error; template context is [anonymous
>> if(isIntervalFull)_subtemplate]
>> line 1:1: unexpected token: Congrats
>> at org.antlr.stringtemplate.language.ActionParser.primaryExpr(ActionParser.java:813)
>> at org.antlr.stringtemplate.language.ActionParser.expr(ActionParser.java:539)
>> ...
>>
>> Is there a way to either force the parser to throw an exception and/or
>> is there a way to validate the template text synchronously?
>>
>> Thanks.
>>
>> --Ilya
>> _______________________________________________
>> stringtemplate-interest mailing list
>> stringtemplate-interest at antlr.org
>> http://www.antlr.org/mailman/listinfo/stringtemplate-interest
>
>

