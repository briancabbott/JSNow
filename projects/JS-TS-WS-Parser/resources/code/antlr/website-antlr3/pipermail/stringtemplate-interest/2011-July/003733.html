<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [stringtemplate-interest] Exception when adding to a	string-based template
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:stringtemplate-interest%40antlr.org?Subject=Re:%20%5Bstringtemplate-interest%5D%20Exception%20when%20adding%20to%20a%0A%09string-based%20template&In-Reply-To=%3CB7D6AC32-B616-4D23-A08F-C094B4D46F59%40cs.usfca.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003732.html">
   <LINK REL="Next"  HREF="003734.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[stringtemplate-interest] Exception when adding to a	string-based template</H1>
    <B>Terence Parr</B> 
    <A HREF="mailto:stringtemplate-interest%40antlr.org?Subject=Re:%20%5Bstringtemplate-interest%5D%20Exception%20when%20adding%20to%20a%0A%09string-based%20template&In-Reply-To=%3CB7D6AC32-B616-4D23-A08F-C094B4D46F59%40cs.usfca.edu%3E"
       TITLE="[stringtemplate-interest] Exception when adding to a	string-based template">parrt at cs.usfca.edu
       </A><BR>
    <I>Tue Jul 26 14:15:39 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003732.html">[stringtemplate-interest] Exception when adding to a string-based	template
</A></li>
        <LI>Next message: <A HREF="003734.html">[stringtemplate-interest] C# updates for ANTLR 3.4,	StringTemplate 4.0.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3733">[ date ]</a>
              <a href="thread.html#3733">[ thread ]</a>
              <a href="subject.html#3733">[ subject ]</a>
              <a href="author.html#3733">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi James, yes it looks like it only creates a locals array if the prototype had locals...The weird thing is though that, I see add() checking for an empty locals array if there are no formal arguments.

Have you added any arguments before you do the clone? that could be the difference... that might give me a clue about how to shore up the software.

 thanks,
T
On Jul 25, 2011, at 12:42 AM, James Briant wrote:

&gt;<i> I'm creating a simple template using proto = new ST(&quot;stuff&quot;), and then creating a new version of it with new ST(proto). When I got to add a property used in the template, I get an NPE:
</I>&gt;<i> 
</I>&gt;<i> java.lang.NullPointerException
</I>&gt;<i> 	at org.stringtemplate.v4.ST.add(ST.java:210)
</I>&gt;<i> 
</I>&gt;<i> Which is here, in public synchronized ST add(String name, Object value) {
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt;		Object curvalue = locals[arg.index];
</I>&gt;<i> 
</I>&gt;<i> locals is null.
</I>&gt;<i> 
</I>&gt;<i> This happens the second time I clone the ST. The first time thru it works because it updates impl.formalArguments and locals - but of course the second time thru formalArguments is retained (through the shared impl) but locals is new.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> stringtemplate-interest mailing list
</I>&gt;<i> <A HREF="http://www.antlr.org/mailman/listinfo/stringtemplate-interest">stringtemplate-interest at antlr.org</A>
</I>&gt;<i> <A HREF="http://www.antlr.org/mailman/listinfo/stringtemplate-interest">http://www.antlr.org/mailman/listinfo/stringtemplate-interest</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20110726/69431ea6/attachment.html">http://www.antlr.org/pipermail/stringtemplate-interest/attachments/20110726/69431ea6/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003732.html">[stringtemplate-interest] Exception when adding to a string-based	template
</A></li>
	<LI>Next message: <A HREF="003734.html">[stringtemplate-interest] C# updates for ANTLR 3.4,	StringTemplate 4.0.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3733">[ date ]</a>
              <a href="thread.html#3733">[ thread ]</a>
              <a href="subject.html#3733">[ subject ]</a>
              <a href="author.html#3733">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/stringtemplate-interest">More information about the stringtemplate-interest
mailing list</a><br>
</body></html>
