<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Bug report; generated C(++) code inappropriately initialises non-primitive return values
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Bug%20report%3B%0A%20generated%20C%28%2B%2B%29%20code%20inappropriately%20initialises%20non-primitive%0A%20return%20values&In-Reply-To=%3C49D0E3A7.5050106%40temporal-wave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="033776.html">
   <LINK REL="Next"  HREF="033762.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Bug report; generated C(++) code inappropriately initialises non-primitive return values</H1>
    <B>Jim Idle</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Bug%20report%3B%0A%20generated%20C%28%2B%2B%29%20code%20inappropriately%20initialises%20non-primitive%0A%20return%20values&In-Reply-To=%3C49D0E3A7.5050106%40temporal-wave.com%3E"
       TITLE="[antlr-interest] Bug report; generated C(++) code inappropriately initialises non-primitive return values">jimi at temporal-wave.com
       </A><BR>
    <I>Mon Mar 30 08:22:15 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="033776.html">[antlr-interest] Bug report; generated C(++) code inappropriately initialises non-primitive	return values
</A></li>
        <LI>Next message: <A HREF="033762.html">[antlr-interest] Bug report;	generated C code fails to compile with empty scopes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33771">[ date ]</a>
              <a href="thread.html#33771">[ thread ]</a>
              <a href="subject.html#33771">[ subject ]</a>
              <a href="author.html#33771">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Richard Thrippleton wrote:
&gt;<i> When I have a rule of the form
</I>&gt;<i>
</I>&gt;<i> &quot;rule returns [std::vector&lt;int&gt; foo]
</I>&gt;<i> ...&quot;
</I>&gt;<i>
</I>&gt;<i> the generated code for that rule will start with
</I>&gt;<i>
</I>&gt;<i> &quot;std::vector&lt;int&gt; foo = NULL;&quot;
</I>&gt;<i>
</I>&gt;<i> which will (obviously) not compile. I've modified the relevant .stg to 
</I>&gt;<i> prevent it generating initialisation code for return values (declaration 
</I>&gt;<i> only), and not encountered any issues in my grammars thus far.
</I>&gt;<i>   
</I>Yeah - you can't really do that I think. ANTLR does not support very 
complex return type declarations and you are probably just &quot;getting away 
with that&quot;. I believe I looked in to not initializing return variables 
and there is some reason that you cannot just disable that 
initialization, but it may just be the behavioral requirements of the 
return value for the rule reference. I do know that sometimes the 
complex declarations will fail though and it is better to use a typedef 
type. We could do with the ability to not initialize things that we 
don't know about really.

A better approach would be to return a pointer rather than the vector, 
or to pass in the reference as a parameter to the rule.

Jim
</PRE>













<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="033776.html">[antlr-interest] Bug report; generated C(++) code inappropriately initialises non-primitive	return values
</A></li>
	<LI>Next message: <A HREF="033762.html">[antlr-interest] Bug report;	generated C code fails to compile with empty scopes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#33771">[ date ]</a>
              <a href="thread.html#33771">[ thread ]</a>
              <a href="subject.html#33771">[ subject ]</a>
              <a href="author.html#33771">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
