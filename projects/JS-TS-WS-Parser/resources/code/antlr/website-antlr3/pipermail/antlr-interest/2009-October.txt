From luca.ligreci at gmail.com  Thu Oct  1 00:37:17 2009
From: luca.ligreci at gmail.com (Luca Li Greci)
Date: Thu, 1 Oct 2009 08:37:17 +0100
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <4AC371EC.7060006@temporal-wave.com>
References: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>
	<7ca0370d0909291235s65a5cb8co26dfc0683167f49b@mail.gmail.com>
	<4AC26339.5040708@temporal-wave.com>
	<7ca0370d0909300247x44f91e06laee20e2142ea0635@mail.gmail.com>
	<4AC371EC.7060006@temporal-wave.com>
Message-ID: <7ca0370d0910010037k4800e56fqc02458057e986f73@mail.gmail.com>

2009/9/30 Jim Idle <jimi at temporal-wave.com>

>  On 09/30/2009 02:47 AM, Luca Li Greci wrote:
>
>
> You said that when the grammar is under src/main/antlr3* *the maven plugin
> automatically picks up all grammar defined under any subdirectories (such
> as org/mycompany/myproduct) so that the maven parameters include, lib, and
> the @parser::header {package org.mycompany.myproduct;}
>
>
> You still need the package in the @headers for each .g file.
>
> Jim
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

Hi Jim,

I'm going to refactor my project to use what we discuss.

Reading the documentation I can see that the src/main/antlr3/imports is used
to collect all the additional grammars, I assume that this happens when a
grammar is divided in several imported grammars.

Do I need to use @parser::header {package org.mycompany.myproduct;} for all
of grammars in src/main/antlr3/imports ?

If I don't need to do this could, then it could explain the weird java
classes I saw generated, and I could split up my grammar in 5 "blocks".

Thank you very much for helping me!

Luca


-- 
Victor Hugo wrote, ?The future has many names: For the weak, it means the
unattainable. For the fearful, it means the unknown. For the courageous, it
means opportunity.?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091001/17fa0535/attachment.html 

From naveen.chwl at googlemail.com  Thu Oct  1 03:13:50 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Thu, 1 Oct 2009 11:13:50 +0100
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another
	solution?
Message-ID: <56eb2660910010313w72fd61f5hc2abbcbe30807905@mail.gmail.com>

I am trying to write an English grammar with ANTLR and have simplified a
particular problem to a particular subset for your convenience. (I'm using
ANTLRWorks 1.3)

grammar predicate;


predicate : 'verb' complement?;

      complement: indirectObject? object;

                indirectObject :  nounPhrase;

                object : nounPhrase;

                               nounPhrase : 'the' adjectivePhrase? 'noun';

                                            adjectivePhrase : '<Ving>'
complement?;

gives

"error(211): predicate.g:7:14: [fatal] rule complement has non-LL(*)
decision due to recursive rule invocations reachable from alts 1,2.  Resolve
by left-factoring or using syntactic predicates or using backtrack=true
option."

Is somebody easily able to left-factor this while preserving the grammar? Or
syntactically predicating if better? Sorry if I sound daft! I should say
that taking away the "?" from either adjectivePhrase or indirectObject does
not produce this error, but they are necessary.

Many thanks!
N
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091001/af0bed59/attachment.html 

From antlr at mirality.co.nz  Thu Oct  1 04:48:03 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 02 Oct 2009 00:48:03 +1300
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another
 solution?
In-Reply-To: <56eb2660910010313w72fd61f5hc2abbcbe30807905@mail.gmail.com
 >
References: <56eb2660910010313w72fd61f5hc2abbcbe30807905@mail.gmail.com>
Message-ID: <20091001114826.7B4113418446@www.antlr.org>

At 23:13 1/10/2009, Naveen Chawla wrote:
>       complement: indirectObject? object;
>
>       indirectObject :  nounPhrase;
>
>       object : nounPhrase;
>
>       nounPhrase : 'the' adjectivePhrase? 'noun';
>
>      adjectivePhrase : '<Ving>' complement?;
>
>gives
>
>"error(211): predicate.g:7:14: [fatal] rule complement has 
>non-LL(*) decision due to recursive rule invocations reachable 
>from alts 1,2.  Resolve by left-factoring or using syntactic 
>predicates or using backtrack=true option."

The problem with this is that at the left edge of complement, it 
needs to evaluate whether indirectObject is present or not.  To do 
that, it attempts to match a nounPhrase, which will attempt to 
match an adjectivePhrase, which brings it right back to the left 
edge of complement -- and since that's optional too, it has to 
continue scanning forward into a death spiral.

As written here, you should be able to fix it by switching the 
optionality in the complement rule:
   complement: object object?;

I suspect that in your real grammar the indirectObject and object 
rules aren't actually equivalent though, so this may not help 
much. :)


From naveen.chwl at googlemail.com  Thu Oct  1 05:24:07 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Thu, 1 Oct 2009 13:24:07 +0100
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another
	solution?
In-Reply-To: <4ac49700.8615f10a.3f39.1ebdSMTPIN_ADDED@mx.google.com>
References: <56eb2660910010313w72fd61f5hc2abbcbe30807905@mail.gmail.com>
	<4ac49700.8615f10a.3f39.1ebdSMTPIN_ADDED@mx.google.com>
Message-ID: <56eb2660910010524l794275a9h8938e041f2c9e6e6@mail.gmail.com>

Thanks so much! Yes, I tried complement: object object? coincidentally just
before I read your message and it worked. Good news is that in the real
grammar they ARE actually equivalent. But is there no way of making
'indirectObject' and 'object' appear as they are in the end structure if
there are 2 'object's in a row (they have slightly different meanings even
though syntactically the same)? Would a syntactic predicate solve this? For
example, complement: (indirectObject object)=>indirectObject object |
object; Is this the right one? (it doesn't seem to work on ANTLRWorks) Many
many thanks, N

2009/10/1 Gavin Lambert <antlr at mirality.co.nz>

> At 23:13 1/10/2009, Naveen Chawla wrote:
>
>>      complement: indirectObject? object;
>>
>>      indirectObject :  nounPhrase;
>>
>>      object : nounPhrase;
>>
>>      nounPhrase : 'the' adjectivePhrase? 'noun';
>>
>>     adjectivePhrase : '<Ving>' complement?;
>>
>> gives
>>
>> "error(211): predicate.g:7:14: [fatal] rule complement has non-LL(*)
>> decision due to recursive rule invocations reachable from alts 1,2.  Resolve
>> by left-factoring or using syntactic predicates or using backtrack=true
>> option."
>>
>
> The problem with this is that at the left edge of complement, it needs to
> evaluate whether indirectObject is present or not.  To do that, it attempts
> to match a nounPhrase, which will attempt to match an adjectivePhrase, which
> brings it right back to the left edge of complement -- and since that's
> optional too, it has to continue scanning forward into a death spiral.
>
> As written here, you should be able to fix it by switching the optionality
> in the complement rule:
>  complement: object object?;
>
> I suspect that in your real grammar the indirectObject and object rules
> aren't actually equivalent though, so this may not help much. :)
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091001/97e232ef/attachment.html 

From Heiko.Folkerts at david-bs.de  Thu Oct  1 06:20:46 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Thu, 1 Oct 2009 15:20:46 +0200
Subject: [antlr-interest] Modifying and printing AST under C target
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF130325F998@DC2>

Hello,
I have a parser that creates an AST. Now I want to annotate the AST with own data. It would be enough to change the payload coresponding to each node. Afterwards I want to print out the AST so I can write unit tests to check everything works as expected.

When I use the ASTLabelType pANTLR3_BASE_TREE and set the $type attribute within a rule I can run the parser, but the function toStringTree only prints out the tokentext. But I'd like to get also the type of the token in the output to check whether the assignment to the $type-Attribute was correct.

I tried using pANTLR3_COMMON_TREE but when running the function tostring (tostringTree is only in pANTLR3_BASE_TREE) my program crashes. 

So: 1. Do I have to use the base tree or the common tree?
2. If I need the common tree what do I have to do to use it correctly?

Thx
Heiko


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From jimi at temporal-wave.com  Thu Oct  1 07:13:35 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 01 Oct 2009 07:13:35 -0700
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another
	solution?
In-Reply-To: <56eb2660910010313w72fd61f5hc2abbcbe30807905@mail.gmail.com>
Message-ID: <fd58d5210be85c4098811821a9b93707@temporal-wave.com>

You are trying to be too literal and imply context in the rules. Complement has an optional indirectObject, which is a nounPhrase, followed by an object, which is also a nounPhrase, don't use two rule to ask for the same token sequence and then make one of them an optional lead in. Use object object? And imply that the first is an indirect object if the second is present. However, parsing English isn't as easy as this of course ;-)

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Thursday, October 01, 2009 3:14 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another solution?

 

I am trying to write an English grammar with ANTLR and have simplified a particular problem to a particular subset for your convenience. (I'm using ANTLRWorks 1.3)

 

grammar predicate;


  
predicate : 'verb' complement?;

 

      complement: indirectObject? object;

              

                indirectObject :  nounPhrase;
    
                object : nounPhrase;

 
                               nounPhrase : 'the' adjectivePhrase? 'noun';

 

                                            adjectivePhrase : '<Ving>' complement?;

 

gives

 

"error(211): predicate.g:7:14: [fatal] rule complement has non-LL(*) decision due to recursive rule invocations reachable from alts 1,2.  Resolve by left-factoring or using syntactic predicates or using backtrack=true option."

 

Is somebody easily able to left-factor this while preserving the grammar? Or syntactically predicating if better? Sorry if I sound daft! I should say that taking away the "?" from either adjectivePhrase or indirectObject does not produce this error, but they are necessary.

 

Many thanks!

N 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091001/4d95ccb5/attachment.html 

From jimi at temporal-wave.com  Thu Oct  1 07:16:26 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 01 Oct 2009 07:16:26 -0700
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another
	solution?
In-Reply-To: <56eb2660910010524l794275a9h8938e041f2c9e6e6@mail.gmail.com>
Message-ID: <55bddbba3157624e9357edd6a24993c9@temporal-wave.com>

You would have to use ((object object)=>object)? Which is expensive and is using a hammer to crack a nut ;-)

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Thursday, October 01, 2009 5:24 AM
To: Gavin Lambert
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Left factor? Syntactic predicates? Or another solution?

 

Thanks so much! Yes, I tried complement: object object? coincidentally just before I read your message and it worked. Good news is that in the real grammar they ARE actually equivalent. But is there no way of making 'indirectObject' and 'object' appear as they are in the end structure if there are 2 'object's in a row (they have slightly different meanings even though syntactically the same)? Would a syntactic predicate solve this? For example, complement: (indirectObject object)=>indirectObject object | object; Is this the right one? (it doesn't seem to work on ANTLRWorks) Many many thanks, N

2009/10/1 Gavin Lambert <antlr at mirality.co.nz>

At 23:13 1/10/2009, Naveen Chawla wrote:

     complement: indirectObject? object;

     indirectObject :  nounPhrase;

     object : nounPhrase;

     nounPhrase : 'the' adjectivePhrase? 'noun';

    adjectivePhrase : '<Ving>' complement?;

gives

"error(211): predicate.g:7:14: [fatal] rule complement has non-LL(*) decision due to recursive rule invocations reachable from alts 1,2.  Resolve by left-factoring or using syntactic predicates or using backtrack=true option."

 

The problem with this is that at the left edge of complement, it needs to evaluate whether indirectObject is present or not.  To do that, it attempts to match a nounPhrase, which will attempt to match an adjectivePhrase, which brings it right back to the left edge of complement -- and since that's optional too, it has to continue scanning forward into a death spiral.

As written here, you should be able to fix it by switching the optionality in the complement rule:
 complement: object object?;

I suspect that in your real grammar the indirectObject and object rules aren't actually equivalent though, so this may not help much. :)

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091001/7be54cef/attachment.html 

From jimi at temporal-wave.com  Thu Oct  1 07:18:32 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 01 Oct 2009 07:18:32 -0700
Subject: [antlr-interest] Modifying and printing AST under C target
In-Reply-To: <93FCBF72DCE7634481C5DF1654D8FF130325F998@DC2>
Message-ID: <d097eaa630039c4f895f699d50194c11@temporal-wave.com>

You don't need to do that. There is a user field in the COMMON_TREE node that you can use to store a pointer to your own data - this is much simpler. If you use a custom node, it must really embed COMMON_TREE, which embeds BASE_TREE. Each of these has super pointers to the larger structure but passes around BASE_TREE (though the pointers are void * in the grammar).

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Heiko Folkerts
Sent: Thursday, October 01, 2009 6:21 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Modifying and printing AST under C target

Hello,
I have a parser that creates an AST. Now I want to annotate the AST with own data. It would be enough to change the payload coresponding to each node. Afterwards I want to print out the AST so I can write unit tests to check everything works as expected.

When I use the ASTLabelType pANTLR3_BASE_TREE and set the $type attribute within a rule I can run the parser, but the function toStringTree only prints out the tokentext. But I'd like to get also the type of the token in the output to check whether the assignment to the $type-Attribute was correct.

I tried using pANTLR3_COMMON_TREE but when running the function tostring (tostringTree is only in pANTLR3_BASE_TREE) my program crashes. 

So: 1. Do I have to use the base tree or the common tree?
2. If I need the common tree what do I have to do to use it correctly?

Thx
Heiko


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address




From grabner at icg.tugraz.at  Thu Oct  1 09:07:01 2009
From: grabner at icg.tugraz.at (Markus Grabner)
Date: Thu, 1 Oct 2009 18:07:01 +0200
Subject: [antlr-interest] MATLAB grammar for antlr v3
Message-ID: <200910011807.01541.grabner@icg.tugraz.at>


	Hi!

    There has been some discussion about a MATLAB grammar a while ago:

http://www.antlr.org/pipermail/antlr-interest/2002-May/001041.html

Does anybody know if these efforts have been finished? If not, I'm considering 
to write a MATLAB grammar from scratch. Most of it should be easy, although 
there is one problem I'm not sure how to deal with. The matrix transposition 
operator and string literal delimiter share the same character (a single 
apostrophe '), i.e.,

A'   means matrix A transposed, while
'A'   means string literal with value A.

Can these be distinguished by context (the transposition operator may occur 
only after a matrix expression, while the string literal may only be an 
operand to an expression)? Any hint is appreciated!

	Thanks & kind regards,
		Markus


-- 
Markus Grabner - Computer Graphics and Vision
Graz University of Technology, Inffeldgasse 16a/II, 8010 Graz, Austria
Phone: +43/316/873-5041, Fax: +43/316/873-5050
WWW: http://www.icg.tugraz.at/Members/grabner

From antlr at mirality.co.nz  Thu Oct  1 11:44:28 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 02 Oct 2009 07:44:28 +1300
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another
 solution?
In-Reply-To: <56eb2660910010524l794275a9h8938e041f2c9e6e6@mail.gmail.com
 >
References: <56eb2660910010313w72fd61f5hc2abbcbe30807905@mail.gmail.com>
	<4ac49700.8615f10a.3f39.1ebdSMTPIN_ADDED@mx.google.com>
	<56eb2660910010524l794275a9h8938e041f2c9e6e6@mail.gmail.com>
Message-ID: <20091001184459.E893D341847F@www.antlr.org>

At 01:24 2/10/2009, Naveen Chawla wrote:
>Thanks so much! Yes, I tried complement: object object? 
>coincidentally just before I read your message and it worked. 
>Good news is that in the real grammar they ARE actually 
>equivalent. But is there no way of making 'indirectObject' and 
>'object' appear as they are in the end structure if there are 2 
>'object's in a row (they have slightly different meanings even 
>though syntactically the same)? Would a syntactic predicate solve 
>this? For example, complement: (indirectObject 
>object)=>indirectObject object | object; Is this the right one? 
>(it doesn't seem to work on ANTLRWorks) Many many thanks, N

Which rules it passes through shouldn't have any bearing on the 
semantic meaning; the rules should just be concerned with matching 
logical units of tokens.

You can assign different meanings to the objects via altering the 
output AST, eg:

complement
   : (o1=object -> ^(DIRECT $o1))
     (o2=object -> ^(INDIRECT_DIRECT $o1 $o2))?
   ;
(There are lots of other possible tree layouts, of course.)

If you're carrying out some action directly rather than outputting 
an AST, you can still use a similar technique (putting some of the 
code inside the optional block) to get different behaviour if the 
second object is actually present.


From kaleb.pederson at gmail.com  Thu Oct  1 12:12:17 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Thu, 1 Oct 2009 12:12:17 -0700
Subject: [antlr-interest] Disambiguating Decimal and Integer '.'
Message-ID: <f14c01620910011212na7bec3did0c2b017576d0e3c@mail.gmail.com>

Everything is an object in the language I'm creating.  Thus, I allow:

"string".someFunction(), and
1234.equals(1234)

I'm using the latter as a testcase.  It's being parsed as follows:

1234. =>
    1. Take object production
    2. Take alt2
    3. Consume 1234
    4. See '.'
    4. Try DECIMAL production
    5. Consume '.'
    6. Throw execption because expected INTEGER is not found

After parsing the above the DECIMAL non-terminal throws an exception
since the missing INTEGER non-terminal isn't present.  How can I get
ANTLR to accept the INTEGER production instead?

And here's the relevant grammar portions:

object
    :   ID ('.' ID)* objectSuffix?
    |   literal ('.' ID objectSuffix)?;

objectSuffix
    :   '(' arguments? ')';

arguments
    :   argument (',' argument)*;

argument
    :   object;

literal:
    QUOTED_STRING
    |   INTEGER
    |   DECIMAL;



fragment NUMBER: '0'..'9';

INTEGER
    :   NUMBER+;

DECIMAL
    :   INTEGER '.' INTEGER;

fragment ID_BASIC_CHARSET: ('a'..'z' | 'A'..'Z' | '_');

ID  :    ID_BASIC_CHARSET (ID_BASIC_CHARSET | NUMBER)*;


As an alternative, I tried the following (IIRC):

object
    :   ID ('.' ID)* objectSuffix?
    |   (INTEGER '.' ID objectSuffix) => INTEGER '.' ID objectSuffix
    |   literal ('.' ID objectSuffix)?;

I didn't step through the above, but it seemed to give the exact same
behavior as the above cases.  I believe there's enough syntactical
information that I should be able to make this work.  Suggestions?

Thanks.

--Kaleb
http://twitter.com/kalebpederson
http://kalebpederson.com

From antlr at mirality.co.nz  Thu Oct  1 13:06:54 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 02 Oct 2009 09:06:54 +1300
Subject: [antlr-interest] Disambiguating Decimal and Integer '.'
In-Reply-To: <f14c01620910011212na7bec3did0c2b017576d0e3c@mail.gmail.com
 >
References: <f14c01620910011212na7bec3did0c2b017576d0e3c@mail.gmail.com>
Message-ID: <20091001200716.EDCBB3418479@www.antlr.org>

At 08:12 2/10/2009, Kaleb Pederson wrote:
 >INTEGER
 >    :   NUMBER+;
 >
 >DECIMAL
 >    :   INTEGER '.' INTEGER;

You should have a look at the wiki and the mailing list 
archives.  This is a fairly common problem with a fairly simple 
solution:

fragment INTEGER : NUMBER+ ;

DECIMAL
   :  INTEGER ('.' INTEGER | { $type = INTEGER; })
   ;

If that doesn't work by itself, you can add a predicate to force a 
two-character lookahead:

DECIMAL
   :  INTEGER (('.' NUMBER) => '.' INTEGER | { $type = INTEGER; })
   ;


From naveen.chwl at googlemail.com  Thu Oct  1 13:35:12 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Thu, 1 Oct 2009 21:35:12 +0100
Subject: [antlr-interest] Left factor? Syntactic predicates? Or another
	solution?
In-Reply-To: <4ac4f89d.0b02be0a.643d.ffffc90dSMTPIN_ADDED@mx.google.com>
References: <56eb2660910010313w72fd61f5hc2abbcbe30807905@mail.gmail.com>
	<4ac49700.8615f10a.3f39.1ebdSMTPIN_ADDED@mx.google.com>
	<56eb2660910010524l794275a9h8938e041f2c9e6e6@mail.gmail.com>
	<4ac4f89d.0b02be0a.643d.ffffc90dSMTPIN_ADDED@mx.google.com>
Message-ID: <56eb2660910011335uff2e6f5vcbebef4efb5b2e60@mail.gmail.com>

Thanks!

2009/10/1 Gavin Lambert <antlr at mirality.co.nz>

> At 01:24 2/10/2009, Naveen Chawla wrote:
>
>> Thanks so much! Yes, I tried complement: object object? coincidentally
>> just before I read your message and it worked. Good news is that in the real
>> grammar they ARE actually equivalent. But is there no way of making
>> 'indirectObject' and 'object' appear as they are in the end structure if
>> there are 2 'object's in a row (they have slightly different meanings even
>> though syntactically the same)? Would a syntactic predicate solve this? For
>> example, complement: (indirectObject object)=>indirectObject object |
>> object; Is this the right one? (it doesn't seem to work on ANTLRWorks) Many
>> many thanks, N
>>
>
> Which rules it passes through shouldn't have any bearing on the semantic
> meaning; the rules should just be concerned with matching logical units of
> tokens.
>
> You can assign different meanings to the objects via altering the output
> AST, eg:
>
> complement
>  : (o1=object -> ^(DIRECT $o1))
>    (o2=object -> ^(INDIRECT_DIRECT $o1 $o2))?
>  ;
> (There are lots of other possible tree layouts, of course.)
>
> If you're carrying out some action directly rather than outputting an AST,
> you can still use a similar technique (putting some of the code inside the
> optional block) to get different behaviour if the second object is actually
> present.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091001/0c0c2b85/attachment.html 

From invite+kjdmmd3mw~1m at facebookmail.com  Thu Oct  1 14:12:37 2009
From: invite+kjdmmd3mw~1m at facebookmail.com (Shibin CK)
Date: Thu, 1 Oct 2009 14:12:37 -0700
Subject: [antlr-interest] Check out my photos on Facebook
Message-ID: <b65bc5342706cdea28d9759ba21b289e@localhost.localdomain>


I set up a Facebook profile where I can post my pictures, videos and events and I want to add you as a friend so you can see it. First, you need to join Facebook! Once you join, you can also create your own profile.

Thanks,
Shibin

To sign up for Facebook, follow the link below:
http://www.facebook.com/p.php?i=596178134&k=5VC45VVXQT6G6BD1RA55R4TWT6BAZY2GUPCW&r


antlr-interest at antlr.org was invited to join Facebook by Shibin CK. If you do not wish to receive this type of email from Facebook in the future, please click on the link below to unsubscribe.
http://www.facebook.com/o.php?k=ba7304&u=100000331239547&mid=12f1873G5af32438907bG0G8
Facebook's offices are located at 1601 S. California Ave., Palo Alto, CA 94304.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091001/75ee8d84/attachment.html 

From shibinck at gmail.com  Thu Oct  1 14:18:34 2009
From: shibinck at gmail.com (shibinck)
Date: Fri, 2 Oct 2009 02:48:34 +0530
Subject: [antlr-interest] Check out my photos on Facebook
In-Reply-To: <b65bc5342706cdea28d9759ba21b289e@localhost.localdomain>
References: <b65bc5342706cdea28d9759ba21b289e@localhost.localdomain>
Message-ID: <c2247ac0910011418w4f09afc6m5e269957e00620e0@mail.gmail.com>

sorry :)
-shibin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091002/58148d7b/attachment.html 

From kaleb.pederson at gmail.com  Thu Oct  1 15:46:33 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Thu, 1 Oct 2009 15:46:33 -0700
Subject: [antlr-interest] Disambiguating Decimal and Integer '.'
In-Reply-To: <4ac50beb.0302be0a.4826.727dSMTPIN_ADDED@mx.google.com>
References: <f14c01620910011212na7bec3did0c2b017576d0e3c@mail.gmail.com>
	<4ac50beb.0302be0a.4826.727dSMTPIN_ADDED@mx.google.com>
Message-ID: <200910011546.33118.kaleb.pederson@gmail.com>

On Thursday 01 October 2009 01:06:54 pm Gavin Lambert wrote:
> At 08:12 2/10/2009, Kaleb Pederson wrote:
>  >INTEGER
>  >    :   NUMBER+;
>  >
>  >DECIMAL
>  >    :   INTEGER '.' INTEGER;
> 
> You should have a look at the wiki and the mailing list 
> archives.  This is a fairly common problem with a fairly simple 
> solution:

I've looked, read, and re-read, but apparently I don't know exactly what to look for, so thanks for pointing it out.  I'd be interested to any references in the wiki or archives if you have them.  My google-fu and not-so-random searching didn't bring up anything useful.

> fragment INTEGER : NUMBER+ ;
> 
> DECIMAL
>    :  INTEGER ('.' INTEGER | { $type = INTEGER; })
>    ;

This did not work, nor did adding an options {k=2;} statement.

> If that doesn't work by itself, you can add a predicate to force a 
> two-character lookahead:
> 
> DECIMAL
>    :  INTEGER (('.' NUMBER) => '.' INTEGER | { $type = INTEGER; })
>    ;

This worked great, thank you!  I would not have thought to try something like that.  I was attempting to have the DECIMAL non-terminal avoided, rather than allowing it to match the same thing as an INTEGER and changing the type on it.  Perhaps that caused some tunnel vision.

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

From jimi at temporal-wave.com  Thu Oct  1 15:49:53 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 01 Oct 2009 15:49:53 -0700
Subject: [antlr-interest] Disambiguating Decimal and Integer '.'
In-Reply-To: <200910011546.33118.kaleb.pederson@gmail.com>
Message-ID: <c758d960f176074da1d4d7f8c871fd85@temporal-wave.com>

Wiki - front page - lexing for dot, range, .....

http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point%2C+dot%2C+range%2C+time+specs

This grammar also caters for 999.toString() type things as it comes from JavaFX.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Kaleb Pederson
> Sent: Thursday, October 01, 2009 3:47 PM
> To: Gavin Lambert
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Disambiguating Decimal and Integer '.'
> 
> On Thursday 01 October 2009 01:06:54 pm Gavin Lambert wrote:
> > At 08:12 2/10/2009, Kaleb Pederson wrote:
> >  >INTEGER
> >  >    :   NUMBER+;
> >  >
> >  >DECIMAL
> >  >    :   INTEGER '.' INTEGER;
> >
> > You should have a look at the wiki and the mailing list
> > archives.  This is a fairly common problem with a fairly simple
> > solution:
> 
> I've looked, read, and re-read, but apparently I don't know exactly
> what to look for, so thanks for pointing it out.  I'd be interested to
> any references in the wiki or archives if you have them.  My google-fu
> and not-so-random searching didn't bring up anything useful.
> 
> > fragment INTEGER : NUMBER+ ;
> >
> > DECIMAL
> >    :  INTEGER ('.' INTEGER | { $type = INTEGER; })
> >    ;
> 
> This did not work, nor did adding an options {k=2;} statement.
> 
> > If that doesn't work by itself, you can add a predicate to force a
> > two-character lookahead:
> >
> > DECIMAL
> >    :  INTEGER (('.' NUMBER) => '.' INTEGER | { $type = INTEGER; })
> >    ;
> 
> This worked great, thank you!  I would not have thought to try
> something like that.  I was attempting to have the DECIMAL non-terminal
> avoided, rather than allowing it to match the same thing as an INTEGER
> and changing the type on it.  Perhaps that caused some tunnel vision.
> 
> --Kaleb
> 
> http://twitter.com/kalebpederson
> http://kalebpederson.com
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From kaleb.pederson at gmail.com  Thu Oct  1 17:18:51 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Thu, 1 Oct 2009 17:18:51 -0700
Subject: [antlr-interest] Disambiguating Decimal and Integer '.'
In-Reply-To: <c758d960f176074da1d4d7f8c871fd85@temporal-wave.com>
References: <c758d960f176074da1d4d7f8c871fd85@temporal-wave.com>
Message-ID: <200910011718.51318.kaleb.pederson@gmail.com>

Thanks Jim!

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

On Thursday 01 October 2009 03:49:53 pm Jim Idle wrote:
> Wiki - front page - lexing for dot, range, .....
> 
> http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point%2C+dot%2C+range%2C+time+specs
> 
> This grammar also caters for 999.toString() type things as it comes from JavaFX.
> 
> Jim
> 
> > -----Original Message-----
> > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > bounces at antlr.org] On Behalf Of Kaleb Pederson
> > Sent: Thursday, October 01, 2009 3:47 PM
> > To: Gavin Lambert
> > Cc: antlr-interest at antlr.org
> > Subject: Re: [antlr-interest] Disambiguating Decimal and Integer '.'
> > 
> > On Thursday 01 October 2009 01:06:54 pm Gavin Lambert wrote:
> > > At 08:12 2/10/2009, Kaleb Pederson wrote:
> > >  >INTEGER
> > >  >    :   NUMBER+;
> > >  >
> > >  >DECIMAL
> > >  >    :   INTEGER '.' INTEGER;
> > >
> > > You should have a look at the wiki and the mailing list
> > > archives.  This is a fairly common problem with a fairly simple
> > > solution:
> > 
> > I've looked, read, and re-read, but apparently I don't know exactly
> > what to look for, so thanks for pointing it out.  I'd be interested to
> > any references in the wiki or archives if you have them.  My google-fu
> > and not-so-random searching didn't bring up anything useful.
> > 
> > > fragment INTEGER : NUMBER+ ;
> > >
> > > DECIMAL
> > >    :  INTEGER ('.' INTEGER | { $type = INTEGER; })
> > >    ;
> > 
> > This did not work, nor did adding an options {k=2;} statement.
> > 
> > > If that doesn't work by itself, you can add a predicate to force a
> > > two-character lookahead:
> > >
> > > DECIMAL
> > >    :  INTEGER (('.' NUMBER) => '.' INTEGER | { $type = INTEGER; })
> > >    ;
> > 
> > This worked great, thank you!  I would not have thought to try
> > something like that.  I was attempting to have the DECIMAL non-terminal
> > avoided, rather than allowing it to match the same thing as an INTEGER
> > and changing the type on it.  Perhaps that caused some tunnel vision.
> > 
> > --Kaleb
> > 
> > http://twitter.com/kalebpederson
> > http://kalebpederson.com
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> > email-address
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 

From mail at martin-probst.com  Fri Oct  2 05:34:47 2009
From: mail at martin-probst.com (Martin Probst)
Date: Fri, 2 Oct 2009 14:34:47 +0200
Subject: [antlr-interest] Rewrite rule and optional parts
Message-ID: <6dca08520910020534w4eda7ebcu1d6619b9f110fd97@mail.gmail.com>

Hi,

I have a rewrite rule like this:

rule: FOO (BAR baz)? BAM -> ^(FOO (^BAR baz BAM)? BAM);

For more generality, I'd like to include the BAM twice in the tree.
Believe me, that actually makes sense when the names are not BAM and
BAZ ;-)

The problem is that ANTLR generates this code:

if ( stream_BAR.hasNext()||stream_baz.hasNext()||stream_BAM.hasNext() ) {
  // construct optional tree part, causes EmptyRewriteStream exception
if BAR doesn't exist
}

Is there any particular reason why that is a disjunction and not a
conjunction? I.e., for the tree construction part not to cause errors,
you need all of the nodes present, not one of them.

Thanks,
Martin

From kirby.bohling at gmail.com  Fri Oct  2 11:49:02 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Fri, 2 Oct 2009 13:49:02 -0500
Subject: [antlr-interest] Ambiguous resolution with | and + operator
Message-ID: <3cac8fdf0910021149k64664aadt1673df12397e9d82@mail.gmail.com>

I'm working on parsing an existing markup language that has specific
characters that are delimiters in special cases.  I've trimmed it
down.  There are subsets of markup that are special at various points.
 In this example ':', '=' could both be special in some contexts, and
not in others.  Text and white space are tokenized, but rarely
special.

grammar t;

options { output=AST; }

tokens { INLINE_TEXT; }

inline_text: ((safe_text) => safe_text)+ -> ^(INLINE_TEXT safe_text+);
safe_text: (TEXT|WHITESPACE);

inline_text_with_colon:
(inline_text_with_colon_rewrite_dummy)
-> ^(INLINE_TEXT inline_text_with_colon_rewrite_dummy);

inline_text_with_colon_bad:
((inline_text_with_colon_rewrite_dummy) =>
inline_text_with_colon_rewrite_dummy)
-> ^(INLINE_TEXT inline_text_with_colon_rewrite_dummy);

inline_text_with_colon_rewrite_dummy: (safe_text|COLON)+;
foo: (inline_text|EQUAL_SIGN)+;
bar:	(inline_text_with_colon|EQUAL_SIGN)+ ;
bar_bad:	(inline_text_with_colon_bad|EQUAL_SIGN)+;

TEXT:	'A'..'Z' | 'a'..'z';
WHITESPACE:	 ' ';
EQUAL_SIGN: '=';
COLON: ':';

Using ANTLR 3.1.3, with the above grammar, I get
"inline_text_with_colon_bad" has an ambiguous decision.  ANTLRWorks
1.3 clearly shows the issue.  Actually I don't understand why it is is
happening.  There are two cases:  If a ':' is seen just prior to
safe_text, or just after exiting safe_text it claims it is ambiguous.
I thought that the greedy nature would keep it consuming, and
"exiting" the loop should not be an option.  Clearly the DFA does not
agree with my interpretation.

I just want to make sure that using a Syntactic Predicate was the
correct solution.  If you remove the predicate from inline_text, or
inline_text_with_colon, the grammars are ambiguous.  You can see that
in inline_text_with_colon_bad is ambiguous, and is no different from
inline_text_with_colon.

As a side note, is there anyway to avoid needing the rewrite dummy?
Every time I try and rewrite/reparent something with an parenthesis
and an or condition, I get an error.  I have a lot of dummy rules that
serve no other purpose other then allowing me to do the rewrite.

Thanks in advance,
   Kirby

From naveen.chwl at googlemail.com  Fri Oct  2 14:10:21 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Fri, 2 Oct 2009 22:10:21 +0100
Subject: [antlr-interest] Enforcing a right associativity,
	to resolve an ambiguity (simple 	grammar included)
Message-ID: <56eb2660910021410u691f1e58x4d83882082b571e4@mail.gmail.com>

Hi,

I'm a little bit stumped. You might find this easy. I'm trying to develop an
English parser and have come across a real ambiguity in English, on
which, for the time being, I just want to enforce simple right
associativity:

e.g. Recommending drinking while driving is dangerous.

(Is it referring to the person driving while they are recommending drinking,
or the person recommending drinking-during-driving?)

This is not a problem. Since they are both equally valid in English, for the
time being I just want to enforce right associativity (maybe later give a
user option to change the tree), but I cannot figure out how!! Here is the
grammar I want to make right-associative (simplified for your convenience):

grammar prep;
sentence: nounPhrase 'verb';

            nounPhrase: 'Ving' complement? prepPhr?;

                           complement : nounPhrase 'noun'? ;

                           prepPhr: 'preposition' nounPhrase;


Ambiguous sentence example: "Ving Ving preposition Ving verb"
Ambiguity: "preposition" can be a prepPhr belonging to the first "Ving"
(nounPhrase) OR the second "Ving" (nounPhrase). I want prepPhr to always
belong to the last occurring 'Ving' (nounPhrase). So I want to
enforce, using the example sentence (right associativity):

 sentence{
         nounPhrase{
                   'Ving'
                    complement{
                                nounPhrase{
                                             'Ving'
                                              prepPhr{
                                                           'preposition'
                                                           nounPhrase{
                                                                          'Ving'
                                                            }
                                              }
                                }
                   }
         }
         'verb'
}

instead of

 sentence{
         nounPhrase{
                   'Ving'
                    complement{
                                nounPhrase{
                                             'Ving'
                                }
                     }
                     prepPhr{
                                'preposition'
                                nounPhrase{
                                             'Ving'
                                 }
                      }
         }
         'verb'
}

while preserving the grammar.
Anybody have as easy idea how? Sorry if I sound newbie, I'm stumped.

Regards,
N
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091002/f924fc2e/attachment.html 

From naveen.chwl at googlemail.com  Sat Oct  3 02:44:30 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Sat, 3 Oct 2009 10:44:30 +0100
Subject: [antlr-interest] Enforcing a right associativity,
	to resolve an ambiguity (simple 	grammar included)
In-Reply-To: <56eb2660910021410u691f1e58x4d83882082b571e4@mail.gmail.com>
References: <56eb2660910021410u691f1e58x4d83882082b571e4@mail.gmail.com>
Message-ID: <56eb2660910030244h4edc13aq48cc02f4cf7a2db3@mail.gmail.com>

To be clear, I want prepPhr to always belong to the last occuring 'Ving'
(nounPhrase) before it (i.e. drinking-while-driving)

2009/10/2 Naveen Chawla <naveen.chwl at googlemail.com>

> Hi,
>
> I'm a little bit stumped. You might find this easy. I'm trying to develop
> an English parser and have come across a real ambiguity in English, on
> which, for the time being, I just want to enforce simple right
> associativity:
>
> e.g. Recommending drinking while driving is dangerous.
>
> (Is it referring to the person driving while they are recommending
> drinking, or the person recommending drinking-during-driving?)
>
> This is not a problem. Since they are both equally valid in English, for
> the time being I just want to enforce right associativity (maybe later give
> a user option to change the tree), but I cannot figure out how!! Here is the
> grammar I want to make right-associative (simplified for your convenience):
>
> grammar prep;
> sentence: nounPhrase 'verb';
>
>             nounPhrase: 'Ving' complement? prepPhr?;
>
>                            complement : nounPhrase 'noun'? ;
>
>                            prepPhr: 'preposition' nounPhrase;
>
>
> Ambiguous sentence example: "Ving Ving preposition Ving verb"
> Ambiguity: "preposition" can be a prepPhr belonging to the first "Ving"
> (nounPhrase) OR the second "Ving" (nounPhrase). I want prepPhr to always
> belong to the last occurring 'Ving' (nounPhrase). So I want to
> enforce, using the example sentence (right associativity):
>
>  sentence{
>          nounPhrase{
>                    'Ving'
>                     complement{
>                                 nounPhrase{
>                                              'Ving'
>                                               prepPhr{
>                                                            'preposition'
>                                                            nounPhrase{
>
>                                                                           'Ving'
>                                                             }
>                                               }
>                                 }
>                    }
>          }
>          'verb'
> }
>
> instead of
>
>  sentence{
>          nounPhrase{
>                    'Ving'
>                     complement{
>                                 nounPhrase{
>                                              'Ving'
>                                 }
>                      }
>                      prepPhr{
>                                 'preposition'
>                                 nounPhrase{
>                                              'Ving'
>                                  }
>                       }
>          }
>          'verb'
> }
>
> while preserving the grammar.
> Anybody have as easy idea how? Sorry if I sound newbie, I'm stumped.
>
> Regards,
> N
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091003/d7d3d4d0/attachment.html 

From andy.wagner2 at gmail.com  Sat Oct  3 10:14:09 2009
From: andy.wagner2 at gmail.com (Andy Wagner)
Date: Sat, 3 Oct 2009 10:14:09 -0700
Subject: [antlr-interest] Error Recovery Issues
Message-ID: <e5da39d90910031014o3037833ar421b4075f5c65dff@mail.gmail.com>

I have just converted a large grammar from v2 to v3 for almost the sole
purpose of better error recovery. Specifically I was interested in the token
addition/deletion features which isn't workign with my current grammar. A
generic example of what I would expect to work is similar to

a = b
c = d ;

I would expect antlr to insert a semi-colon at the end of the first line,
but instead giving 2 no viable alternative messages.

Am I doing something wrong in my grammar which as I said is derived from a
grammar in version 2, or are my expectations of this feature not correct?
If my expectations are incorrect is there another way to detect this
behavior even with hand written exception handlers?

Thanks,
Andy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091003/4cb49fcc/attachment.html 

From jcs_cmj at bellsouth.net  Sat Oct  3 13:10:53 2009
From: jcs_cmj at bellsouth.net (Charles Jenkins)
Date: Sat, 3 Oct 2009 13:10:53 -0700 (PDT)
Subject: [antlr-interest] Using ANTLR on Vista
Message-ID: <96503.37291.qm@web180612.mail.sp1.yahoo.com>

Can anyone point me to instructions for installing and using ANTLR at the command line on a Vista machine? Do I have to rebuild the libraries from the sources, or can I use the jar file?

Chuck Jenkins


From jimi at temporal-wave.com  Sat Oct  3 14:16:39 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 03 Oct 2009 14:16:39 -0700
Subject: [antlr-interest] Using ANTLR on Vista
In-Reply-To: <96503.37291.qm@web180612.mail.sp1.yahoo.com>
Message-ID: <1c6fa24ca788334c84b24c5220fad507@temporal-wave.com>

It's just Java, so:

Java -jar \path\to\downloaded\jar\antlr-3.2.jar mygrammar.g

please read the instructions on the Wiki.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Charles Jenkins
> Sent: Saturday, October 03, 2009 1:11 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Using ANTLR on Vista
> 
> Can anyone point me to instructions for installing and using ANTLR at
> the command line on a Vista machine? Do I have to rebuild the libraries
> from the sources, or can I use the jar file?
> 
> Chuck Jenkins
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From yurushkin at rambler.ru  Sat Oct  3 14:48:00 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 04 Oct 2009 01:48:00 +0400
Subject: [antlr-interest] [c target] debugging using antlrworks
Message-ID: <op.u08uuaokt3jqlu@win-mupvrp0jyrf>

Good day...

I generated parser grammar with -debug option, but nothing works.
I haven't understood how to customize parser init code - there are no
examples.

There is antlr3DebugListenerNew() method, but i don't know how to use it.
Could u help me, please?


-- 
Best regards,
Michael

From elliot at WPI.EDU  Sat Oct  3 15:24:33 2009
From: elliot at WPI.EDU (Pennington, Elliot)
Date: Sat, 3 Oct 2009 18:24:33 -0400
Subject: [antlr-interest] Older Grammar in ANTLR 3
Message-ID: <3A2150CB-6E18-4260-9D45-1475FE7EE9F1@wpi.edu>

Howdy All,

I've got an old grammar that used to work in ANTLR 2 but that now  
fails in ANTLR 3. I'd like to make the switch, but I'm at a loss as to  
how to fix this. For the following example code:

--------------

void input_a() {
    integer a, bb, xyz, b3, c, p, q;
    real b;
    a = b3;
    b = -2.5;
    xyz = 2 + a + bb + c - p / q;
    a = xyz * ( p + q );
    p = a - xyz - p;
}

-------------

I get this tree result:

-------------

def
	function_declaration
		type
  			void
		input_a
		(
		)
		code_block
			FailedPredicateException(code_block,{can't deal with predicates  
yet}?)
			FailedPredicateException(code_block,{synpred2_javalet}?)

------------

Here's the grammar I'm using. Has anyone seen anything like this  
before for a grammar that worked in ANTLR 2? I'm not sure how to get  
it to parse properly so I don't get the failed predicate exception.

Thanks,

Elliot

------------

grammar Javalet;
options {
	backtrack = true;
	output=AST;
	ASTLabelType=CommonTree;
	k=2;
	}
tokens	{
	FUNCTION = 'function';
}

@header {package javalet.compiler;}
@lexer::header{package javalet.compiler;}

def 	:	function_declaration
	;


code_block
	:	'{' statement* '}' -> (statement)*
	|	statement
	;

statement
	:	block_statement
	|	variable_declaration ';' -> variable_declaration
	|	assignment ';' -> assignment
	;

block_statement
	:	IF '(' value_0 ')' code_block
		(else_block)? -> ^(IF value_0 code_block (else_block)?)
	|	WHILE '(' value_0 ')' code_block -> ^(WHILE value_0 code_block)
	;

else_block
	:	ELSE code_block -> ^(ELSE code_block)
	;

assignment
	:	ID EQ value_0 -> ^(EQ ID value_0)
	;

variable_declaration
	:	type ID (',' ID)* -> ^(type ID*)
	;

function_declaration
	:	type ID '(' ')' code_block -> ^('function' type ID code_block)
	;

operator_0
	:	LOGICAL_OR
	;
	
LOGICAL_OR
	:	'||'
	;

operator_1
	:	LOGICAL_AND
	;

LOGICAL_AND
	:	'&&'
	;

operator_2
	:	LOGICAL_EQUALITY
	|	LOGICAL_INEQUALITY
	|	LOGICAL_GREATER_THAN
	|	LOGICAL_LESS_THAN
	|	LOGICAL_GREATER_THAN_OR_EQUAL
	|	LOGICAL_LESS_THAN_OR_EQUAL
	;

LOGICAL_EQUALITY
	:	'=='
	;

LOGICAL_INEQUALITY
	:	'!='
	;

LOGICAL_GREATER_THAN
	:	'>'
	;

LOGICAL_LESS_THAN
	:	'<'
	;

LOGICAL_GREATER_THAN_OR_EQUAL
	:	'>='
	;

LOGICAL_LESS_THAN_OR_EQUAL
	:	'<='
	;

operator_3
	:	ADD
	|	SUBTRACT
	;

ADD	:	'+';
SUBTRACT:	'-';

operator_4
	:	MULTIPLY
	|	DIVIDE
	;

MULTIPLY:	'*';
DIVIDE	:	'/';

value_0
	:	value_1 operator_0 value_0 -> ^(operator_0 value_1 value_0)
	|	value_1
	;

value_1
	:	value_2 operator_1 value_1 -> ^(operator_1 value_2 value_1)
	|	value_2
	;

value_2
	:	value_3 operator_2 value_2 -> ^(operator_2 value_3 value_2)
	|	value_3
	;

value_3
	:	value_4 operator_3 value_3 -> ^(operator_3 value_4 value_3)
	|	value_4
	;

value_4
	:	value_5 operator_4 value_4 -> ^(operator_4 value_5 value_4)
	|	value_5
	;

value_5
	:	'(' value_0 ')' -> ^(value_0)
	|	num
	;


num
	:	(REAL|INTEGER|ID)
	;

WS	:	(' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
	;

COMMENT	:	'/*' .* '*/' {$channel=HIDDEN;}
  	;

LINE_COMMENT
	:	'//' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;} ;

//fragment
IF	:	'if' ;

//fragment
ELSE	:	'else' ;

//fragment
WHILE	:	'while' ;


//fragment
DO	:	'do' ;

//fragment
FOR	:	'for' ;

//fragment
EQ	:	'='
	;

fragment
DIGIT	:	'0'..'9' ;

fragment
LETTER	:	('a'..'z'|'A'..'Z') ;

type	:	TYPE_VOID
	|	TYPE_INTEGER
	|	TYPE_REAL
	;
	
TYPE_VOID
	:	'void'
	;
TYPE_INTEGER
	:	'integer'
	;
TYPE_REAL
	:	'real'
	;

INTEGER	:	(DIGIT)+ ;

REAL	:	('+'|'-') (DIGIT)+ '.' (DIGIT)+ ;

ID	:	LETTER ('_' | DIGIT | LETTER)* ;

____________

elliot at wpi.edu
Worcester Polytechnic Institute '09
Computer Science


From antlr at mirality.co.nz  Sat Oct  3 15:40:47 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 04 Oct 2009 11:40:47 +1300
Subject: [antlr-interest] [c target] debugging using antlrworks
In-Reply-To: <op.u08uuaokt3jqlu@win-mupvrp0jyrf>
References: <op.u08uuaokt3jqlu@win-mupvrp0jyrf>
Message-ID: <20091003224117.71ED03418433@www.antlr.org>

At 10:48 4/10/2009, =?koi8-r?B?4NLV28vJziDtycjBycw=?= wrote:
 >I generated parser grammar with -debug option, but nothing 
works.
 >I haven't understood how to customize parser init code - there 
are
 >no examples.

There are examples for the standard C parser init code.  Have a 
look at the downloads page.

 >There is antlr3DebugListenerNew() method, but i don't know how 
to
 >use it.

You don't need to; the runtime takes care of the debugging code 
internally.  Just use your normal startup code; when compiled with 
-debug, it will pause during startup waiting for ANTLRWorks to use 
the Debug Remote command.

Make sure you're using the correct ports; the port number was 
changed a while back, so it's possible that one or the other is 
using the wrong port number.  Try using the netstat command to 
check for listening ports after starting your parser, to see which 
port it's using.


From jbb at acm.org  Sat Oct  3 16:08:07 2009
From: jbb at acm.org (John B. Brodie)
Date: Sat, 03 Oct 2009 19:08:07 -0400
Subject: [antlr-interest] Older Grammar in ANTLR 3
In-Reply-To: <3A2150CB-6E18-4260-9D45-1475FE7EE9F1@wpi.edu>
References: <3A2150CB-6E18-4260-9D45-1475FE7EE9F1@wpi.edu>
Message-ID: <1254611287.13466.13.camel@gecko.home.org>

Greetings!
On Sat, 2009-10-03 at 18:24 -0400, Pennington, Elliot wrote:
> Howdy All,
> 
> I've got an old grammar that used to work in ANTLR 2 but that now  
> fails in ANTLR 3. I'd like to make the switch, but I'm at a loss as to  
> how to fix this. For the following example code:
> 
> --------------
> 
> void input_a() {
>     integer a, bb, xyz, b3, c, p, q;
>     real b;
>     a = b3;
>     b = -2.5;
>     xyz = 2 + a + bb + c - p / q;
>     a = xyz * ( p + q );
>     p = a - xyz - p;
> }
> 
> -------------
> 
> I get this tree result:
> 
> -------------
> 
> def
> 	function_declaration
> 		type
>   			void
> 		input_a
> 		(
> 		)
> 		code_block
> 			FailedPredicateException(code_block,{can't deal with predicates  
> yet}?)
> 			FailedPredicateException(code_block,{synpred2_javalet}?)
> 
> ------------
> 
> Here's the grammar I'm using. Has anyone seen anything like this  
> before for a grammar that worked in ANTLR 2? I'm not sure how to get  
> it to parse properly so I don't get the failed predicate exception.
> 

I don't get any failed predicate exceptions!

I replaced your two @header thingys with the following test driver:

// begin ----- cut here ----- cut here -----
@members {
    private static final String [] x = new String[]{
       " void input_a() { \n"
       + "     integer a, bb, xyz, b3, c, p, q; \n"
       + "     real b; \n"
       + "     a = b3; \n"
       + "     b = -2.5; \n"
       + "     xyz = 2 + a + bb + c - p / q; \n"
       + "     a = xyz * ( p + q ); \n"
       + "     p = a - xyz - p; \n"
       + " } \n"
    };

    public static void main(String [] args) {
        for( int i = 0; i < x.length; ++i ) {
            try {
                System.out.println("about to parse:`"+x[i]+"`");
                JavaletLexer lexer = new JavaletLexer(new
ANTLRStringStream(x[i]));
                CommonTokenStream tokens = new CommonTokenStream(lexer);

                JavaletParser parser = new JavaletParser(tokens);
                JavaletParser.start_return p_result = parser.start();

                CommonTree ast = p_result.tree;
                if( ast == null ) {
                   System.out.println("resultant tree: is NULL");
                } else {
                   System.out.println("resultant tree: " +
ast.toStringTree());
                }
                System.out.println();
            } catch(Exception e) {
                e.printStackTrace();
            }
        }
    }
}

//@header {package javalet.compiler;}
//@lexer::header{package javalet.compiler;}

start : def /*EOF!*/;

// end ----- cut here ----- cut here -----

Note that I do not use ANTLRWorks. Are you, by any chance, trying to
exercise your grammar in AW's interpreter? If so, try using the debugger
instead... or even better, use the command-line tools.

> Thanks,

You are welcome, hope this helps....
   -jbb

> ------------
> 
> grammar Javalet;
> options {
> 	backtrack = true;
> 	output=AST;
> 	ASTLabelType=CommonTree;
> 	k=2;
> 	}
> tokens	{
> 	FUNCTION = 'function';
> }
> 
> @header {package javalet.compiler;}
> @lexer::header{package javalet.compiler;}
> 
> def 	:	function_declaration
> 	;
> 
> 
> code_block
> 	:	'{' statement* '}' -> (statement)*
> 	|	statement
> 	;
> 
> statement
> 	:	block_statement
> 	|	variable_declaration ';' -> variable_declaration
> 	|	assignment ';' -> assignment
> 	;
> 
> block_statement
> 	:	IF '(' value_0 ')' code_block
> 		(else_block)? -> ^(IF value_0 code_block (else_block)?)
> 	|	WHILE '(' value_0 ')' code_block -> ^(WHILE value_0 code_block)
> 	;
> 
> else_block
> 	:	ELSE code_block -> ^(ELSE code_block)
> 	;
> 
> assignment
> 	:	ID EQ value_0 -> ^(EQ ID value_0)
> 	;
> 
> variable_declaration
> 	:	type ID (',' ID)* -> ^(type ID*)
> 	;
> 
> function_declaration
> 	:	type ID '(' ')' code_block -> ^('function' type ID code_block)
> 	;
> 
> operator_0
> 	:	LOGICAL_OR
> 	;
> 	
> LOGICAL_OR
> 	:	'||'
> 	;
> 
> operator_1
> 	:	LOGICAL_AND
> 	;
> 
> LOGICAL_AND
> 	:	'&&'
> 	;
> 
> operator_2
> 	:	LOGICAL_EQUALITY
> 	|	LOGICAL_INEQUALITY
> 	|	LOGICAL_GREATER_THAN
> 	|	LOGICAL_LESS_THAN
> 	|	LOGICAL_GREATER_THAN_OR_EQUAL
> 	|	LOGICAL_LESS_THAN_OR_EQUAL
> 	;
> 
> LOGICAL_EQUALITY
> 	:	'=='
> 	;
> 
> LOGICAL_INEQUALITY
> 	:	'!='
> 	;
> 
> LOGICAL_GREATER_THAN
> 	:	'>'
> 	;
> 
> LOGICAL_LESS_THAN
> 	:	'<'
> 	;
> 
> LOGICAL_GREATER_THAN_OR_EQUAL
> 	:	'>='
> 	;
> 
> LOGICAL_LESS_THAN_OR_EQUAL
> 	:	'<='
> 	;
> 
> operator_3
> 	:	ADD
> 	|	SUBTRACT
> 	;
> 
> ADD	:	'+';
> SUBTRACT:	'-';
> 
> operator_4
> 	:	MULTIPLY
> 	|	DIVIDE
> 	;
> 
> MULTIPLY:	'*';
> DIVIDE	:	'/';
> 
> value_0
> 	:	value_1 operator_0 value_0 -> ^(operator_0 value_1 value_0)
> 	|	value_1
> 	;
> 
> value_1
> 	:	value_2 operator_1 value_1 -> ^(operator_1 value_2 value_1)
> 	|	value_2
> 	;
> 
> value_2
> 	:	value_3 operator_2 value_2 -> ^(operator_2 value_3 value_2)
> 	|	value_3
> 	;
> 
> value_3
> 	:	value_4 operator_3 value_3 -> ^(operator_3 value_4 value_3)
> 	|	value_4
> 	;
> 
> value_4
> 	:	value_5 operator_4 value_4 -> ^(operator_4 value_5 value_4)
> 	|	value_5
> 	;
> 
> value_5
> 	:	'(' value_0 ')' -> ^(value_0)
> 	|	num
> 	;
> 
> 
> num
> 	:	(REAL|INTEGER|ID)
> 	;
> 
> WS	:	(' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
> 	;
> 
> COMMENT	:	'/*' .* '*/' {$channel=HIDDEN;}
>   	;
> 
> LINE_COMMENT
> 	:	'//' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;} ;
> 
> //fragment
> IF	:	'if' ;
> 
> //fragment
> ELSE	:	'else' ;
> 
> //fragment
> WHILE	:	'while' ;
> 
> 
> //fragment
> DO	:	'do' ;
> 
> //fragment
> FOR	:	'for' ;
> 
> //fragment
> EQ	:	'='
> 	;
> 
> fragment
> DIGIT	:	'0'..'9' ;
> 
> fragment
> LETTER	:	('a'..'z'|'A'..'Z') ;
> 
> type	:	TYPE_VOID
> 	|	TYPE_INTEGER
> 	|	TYPE_REAL
> 	;
> 	
> TYPE_VOID
> 	:	'void'
> 	;
> TYPE_INTEGER
> 	:	'integer'
> 	;
> TYPE_REAL
> 	:	'real'
> 	;
> 
> INTEGER	:	(DIGIT)+ ;
> 
> REAL	:	('+'|'-') (DIGIT)+ '.' (DIGIT)+ ;
> 
> ID	:	LETTER ('_' | DIGIT | LETTER)* ;
> 
> ____________
> 
> elliot at wpi.edu
> Worcester Polytechnic Institute '09
> Computer Science
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address



From parrt at cs.usfca.edu  Sat Oct  3 17:52:21 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 3 Oct 2009 17:52:21 -0700
Subject: [antlr-interest] extra interpreter section from book on wiki now
Message-ID: <A5028FD4-B026-4BCC-AC64-D4E8749E9056@cs.usfca.edu>

Hi, i had a complicated interpreter in the book but I took it out.   
It's now here on the wiki:

http://www.antlr.org/wiki/display/ANTLR3/Pie

It's an implementation for a dynamically-typed Python-like language  
called Pie.

Source attached to page.

Ter

From boylan.mark at gmail.com  Sun Oct  4 01:07:06 2009
From: boylan.mark at gmail.com (Mark Boylan)
Date: Sun, 4 Oct 2009 04:07:06 -0400
Subject: [antlr-interest] Out of Memory
Message-ID: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>

Hi.

My grammar is working really well with smaller test files, but I run
out of heap space on large files. Unfortunately, my users will expect
to be able to load pretty big files occasionally (~1GB).

Looking at the code documentation for the Antlr3 stream classes, it
looks like they copy the entire stream. I'm  thinking that I need to
write a custom implementation of IntStream or CharStream that buffers
the input. Is that the right way to solve this? Can someone point me
in the right direction?

Thanks!

 - mark

From antlr_bill at yeah.net  Sun Oct  4 08:55:42 2009
From: antlr_bill at yeah.net (antlr_bill)
Date: Sun, 4 Oct 2009 23:55:42 +0800 (CST)
Subject: [antlr-interest] help on rewritting the tree
Message-ID: <2015991478.171821254671742974.JavaMail.coremail@app4.yeah.net>

can someone please help on this ?
i have an rule like this :

a:
 :   ID( ABC )? (DOT ID (ABC)? )*
;
how to rewrite it into a tree grammer ?
i am dont understand on how to make it repeatable ,
i wrote it like this :
->^(V
        (ID( ABC)?)
        ^(V ((DOT ID) (ABC)?)* )
    )
;
 V is am imaginary token



THANKS
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091004/ed043766/attachment.html 

From jimi at temporal-wave.com  Sun Oct  4 09:38:49 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 04 Oct 2009 09:38:49 -0700
Subject: [antlr-interest] help on rewritting the tree
In-Reply-To: <2015991478.171821254671742974.JavaMail.coremail@app4.yeah.net>
Message-ID: <5baa9751df13214ea635bcf70c940b49@temporal-wave.com>

a: b -> ^(V b) ;

 

b : part (DOT^ part )* ;

 

part:  ID( ABC )? ;

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of antlr_bill
Sent: Sunday, October 04, 2009 8:56 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] help on rewritting the tree

 

can someone please help on this ?
i have an rule like this :

a:
 :   ID( ABC )? (DOT ID (ABC)? )*
;
how to rewrite it into a tree grammer ?

 

 

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091004/8d8019da/attachment.html 

From antlr_bill at yeah.net  Sun Oct  4 10:06:43 2009
From: antlr_bill at yeah.net (antlr_bill)
Date: Mon, 5 Oct 2009 01:06:43 +0800 (CST)
Subject: [antlr-interest] help on rewritting the tree
In-Reply-To: <5baa9751df13214ea635bcf70c940b49@temporal-wave.com>
References: <5baa9751df13214ea635bcf70c940b49@temporal-wave.com>
Message-ID: <1792399744.251254676003154.JavaMail.coremail@app4.yeah.net>

Hi Jim, thanks for you quick reply !

do you mean i should break them into pieces ?
cause the tree structure only can have two children in maximum

if so ,so how about this one? break them too ? 

javaSource
    :   (packageDeclaration)? (importDeclaration)* (typeDeclaration)*
    ->^(V packageDeclaration? importDeclaration* typeDeclaration*)
    ;

here means the java source file can contain  package and import and type ,three kinds of element 
but i wrote that tree like that , is it right ?

any article about this ? i read the book of antlr many times on the tree grammer ,but still didnt get all of it 

thanks again!


BILL


?2009-10-05?"Jim Idle" <jimi at temporal-wave.com> ??? -----????-----
???:"Jim Idle" <jimi at temporal-wave.com>
????:2009?10?5? ???
???:"antlr-interest at antlr.org" <antlr-interest at antlr.org>
??:Re: [antlr-interest] help on rewritting the tree



a: b -> ^(V b) ;

 

b : part (DOT^ part )* ;

 

part:  ID( ABC )? ;

 

Jim

 

From:antlr-interest-bounces at antlr.org[mailto:antlr-interest-bounces at antlr.org]On Behalf Ofantlr_bill
Sent:Sunday, October 04, 2009 8:56 AM
To:antlr-interest at antlr.org
Subject:[antlr-interest] help on rewritting the tree

 

can someone please help on this ?
i have an rule like this :

a:
 :   ID( ABC )? (DOT ID (ABC)? )*
;
how to rewrite it into a tree grammer ?

 

 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/0f5a29bc/attachment.html 

From jimi at temporal-wave.com  Mon Oct  5 10:32:02 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 05 Oct 2009 10:32:02 -0700
Subject: [antlr-interest] [SPAM] Re:Re:  help on rewritting the tree
In-Reply-To: <1792399744.251254676003154.JavaMail.coremail@app4.yeah.net>
Message-ID: <a2de46278a3f0746ba2848a67836fe31@temporal-wave.com>

ANTLR trees can have many children. Your javaSource rule will be fine, but because all elements are optional you need:

 

J: ^(V etc)

  | V // Empty translation unit

;

 

It is easier to see how the tree is going if you break it down and do not try to create sub trees in a rewrite rule. When you create subtrees, the created node does not properly have the start and end tokens for the sub tree and so on because these happen at rulePostProcessing, not within a rewrite.

 

Don?t use imaginary nodes unless they are necessary to create an unambiguous tree, so the DOT token is just fine as a root node for each element of a compound and you probably only need the imaginary as a root for the whole reference.

 

Jim

 

From: antlr_bill [mailto:antlr_bill at yeah.net] 
Sent: Sunday, October 04, 2009 10:07 AM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: [SPAM] Re:Re: [antlr-interest] help on rewritting the tree

 

Hi Jim, thanks for you quick reply !

do you mean i should break them into pieces ?
cause the tree structure only can have two children in maximum

if so ,so how about this one? break them too ? 

javaSource
    :   (packageDeclaration)? (importDeclaration)* (typeDeclaration)*
    ->^(V packageDeclaration? importDeclaration* typeDeclaration*)
    ;

here means the java source file can contain  package and import and type ,three kinds of element 
but i wrote that tree like that , is it right ?

any article about this ? i read the book of antlr many times on the tree grammer ,but still didnt get all of it 

thanks again!


BILL


?2009-10-05?"Jim Idle" <jimi at temporal-wave.com> ??? 

-----????-----
???:"Jim Idle" <jimi at temporal-wave.com>
????:2009?10?5? ???
???:"antlr-interest at antlr.org" <antlr-interest at antlr.org>
??:Re: [antlr-interest] help on rewritting the tree

a: b -> ^(V b) ;

 

b : part (DOT^ part )* ;

 

part:  ID( ABC )? ;

 

Jim

 

From: antlr-interest-bounces at antlr.org[mailto:antlr-interest-bounces at antlr.org]On Behalf Ofantlr_bill
Sent:Sunday, October 04, 2009 8:56 AM
To:antlr-interest at antlr.org
Subject:[antlr-interest] help on rewritting the tree

 

can someone please help on this ?
i have an rule like this :

a:
 :   ID( ABC )? (DOT ID (ABC)? )*
;
how to rewrite it into a tree grammer ?

 

 

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/e1b81723/attachment.html 

From boylan.mark at gmail.com  Sun Oct  4 16:18:31 2009
From: boylan.mark at gmail.com (Mark Boylan)
Date: Sun, 4 Oct 2009 19:18:31 -0400
Subject: [antlr-interest] Out of Memory
In-Reply-To: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>
References: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>
Message-ID: <f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com>

Answering my own question :)

I wrote a class named ANTLRMemoryMappedFileStream which is nearly a
complete ripoff of ANTLRStringStream, except backed by a memory-mapped
file. That solved the buffering problem. But now, I get an
OutOfMemoryError in the parser with my big test file.

I'm parsing chess games in PGN (portable game notation) format. A game
in PGN format is usually under 1k, but a PGN file can contain many
games. Most PGN files have several thousand games and those are no
problem for Antlr and my grammar. But, PGN files with a million or
more games are not rare -- especially in the case where a database
user wants to restore an entire collection, or move it to a new chess
database management program (like the one I'm working on). So, it's
important for me to be able to do parse these huge files.

I'm wondering if it's possible for the Parser to notify the Stream
that a game has been parsed. At that point, the Stream implementation
can flip the buffer. Does that sound like something that might work?
Is that possible?



On Sun, Oct 4, 2009 at 4:07 AM, Mark Boylan <boylan.mark at gmail.com> wrote:
> Hi.
>
> My grammar is working really well with smaller test files, but I run
> out of heap space on large files. Unfortunately, my users will expect
> to be able to load pretty big files occasionally (~1GB).
>
> Looking at the code documentation for the Antlr3 stream classes, it
> looks like they copy the entire stream. I'm ?thinking that I need to
> write a custom implementation of IntStream or CharStream that buffers
> the input. Is that the right way to solve this? Can someone point me
> in the right direction?
>
> Thanks!
>
> ?- mark
>

From antlr_bill at yeah.net  Sun Oct  4 20:32:10 2009
From: antlr_bill at yeah.net (antlr_bill)
Date: Mon, 5 Oct 2009 11:32:10 +0800 (CST)
Subject: [antlr-interest] help on rewritting the tree
In-Reply-To: <a2de46278a3f0746ba2848a67836fe31@temporal-wave.com>
References: <a2de46278a3f0746ba2848a67836fe31@temporal-wave.com>
Message-ID: <1845553775.24221254713530270.JavaMail.coremail@app8.yeah.net>

thanks jim again,
i am rereading the 'the definitve antlr reference'
seems i misunderstanded at this .

aexpr
: mexpr ('+' ^ mexpr)*
;
the explanation on the book is here
All nonsuffixed tokens are subtree leaf nodes (operands), and the elements
suffixed with ^ are subtree root nodes (operators). The only rule
that uses a rewrite is atom. The parenthesized expression alternative is
much clearer when you say explicitly -> expr rather than putting ! on
the left parenthesis and right parenthesis tokens.

but i still not quite  understand the meaning of the node suffixed with ^ 


thanks,
BILL



?2009-10-06?"Jim Idle" <jimi at temporal-wave.com> ??? -----????-----
???:"Jim Idle" <jimi at temporal-wave.com>
????:2009?10?6? ???
???:
??:"antlr-interest at antlr.org" <antlr-interest at antlr.org>
??:Re: [antlr-interest] [SPAM] Re:Re: help on rewritting the tree



ANTLR trees can have many children. Your javaSource rule will be fine, but because all elements are optional you need:

 

J: ^(V etc)

  | V // Empty translation unit

;

 

It is easier to see how the tree is going if you break it down and do not try to create sub trees in a rewrite rule. When you create subtrees, the created node does not properly have the start and end tokens for the sub tree and so on because these happen at rulePostProcessing, not within a rewrite.

 

Don?t use imaginary nodes unless they are necessary to create an unambiguous tree, so the DOT token is just fine as a root node for each element of a compound and you probably only need the imaginary as a root for the whole reference.

 

Jim

 

From:antlr_bill [mailto:antlr_bill at yeah.net]
Sent:Sunday, October 04, 2009 10:07 AM
To:Jim Idle
Cc:antlr-interest at antlr.org
Subject:[SPAM] Re:Re: [antlr-interest] help on rewritting the tree

 

Hi Jim, thanks for you quick reply !

do you mean i should break them into pieces ?
cause the tree structure only can have two children in maximum

if so ,so how about this one? break them too ?

javaSource
    :   (packageDeclaration)? (importDeclaration)* (typeDeclaration)*
    ->^(V packageDeclaration? importDeclaration* typeDeclaration*)
    ;

here means the java source file can contain  package and import and type ,three kinds of element
but i wrote that tree like that , is it right ?

any article about this ? i read the book of antlr many times on the tree grammer ,but still didnt get all of it

thanks again!


BILL


?2009-10-05?"Jim Idle" <jimi at temporal-wave.com>???

-----????-----
???:"Jim Idle" <jimi at temporal-wave.com>
????:2009?10?5? ???
???:"antlr-interest at antlr.org" <antlr-interest at antlr.org>
??:Re: [antlr-interest] help on rewritting the tree

a: b -> ^(V b) ;

 

b : part (DOT^ part )* ;

 

part:  ID( ABC )? ;

 

Jim

 

From:antlr-interest-bounces at antlr.org[mailto:antlr-interest-bounces at antlr.org]On Behalf Ofantlr_bill
Sent:Sunday, October 04, 2009 8:56 AM
To:antlr-interest at antlr.org
Subject:[antlr-interest] help on rewritting the tree

 

can someone please help on this ?
i have an rule like this :

a:
 :   ID( ABC )? (DOT ID (ABC)? )*
;
how to rewrite it into a tree grammer ?

 

 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/71b50bf6/attachment.html 

From indhu.b at s7software.com  Mon Oct  5 01:18:50 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Mon, 5 Oct 2009 13:48:50 +0530
Subject: [antlr-interest] Out of Memory
In-Reply-To: <f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com>
References: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>
	<f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com>
Message-ID: <009e01ca4594$780106d0$68031470$@b@s7software.com>

Is it possible to write a separate program to break the PGN files into
separate games and pass each game to the lexer/parser? That will be a simple
solution assuming there is an easy way to split games in a PGN file.


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mark Boylan
Sent: Monday, October 05, 2009 4:49 AM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Out of Memory

Answering my own question :)

I wrote a class named ANTLRMemoryMappedFileStream which is nearly a
complete ripoff of ANTLRStringStream, except backed by a memory-mapped
file. That solved the buffering problem. But now, I get an
OutOfMemoryError in the parser with my big test file.

I'm parsing chess games in PGN (portable game notation) format. A game
in PGN format is usually under 1k, but a PGN file can contain many
games. Most PGN files have several thousand games and those are no
problem for Antlr and my grammar. But, PGN files with a million or
more games are not rare -- especially in the case where a database
user wants to restore an entire collection, or move it to a new chess
database management program (like the one I'm working on). So, it's
important for me to be able to do parse these huge files.

I'm wondering if it's possible for the Parser to notify the Stream
that a game has been parsed. At that point, the Stream implementation
can flip the buffer. Does that sound like something that might work?
Is that possible?



On Sun, Oct 4, 2009 at 4:07 AM, Mark Boylan <boylan.mark at gmail.com> wrote:
> Hi.
>
> My grammar is working really well with smaller test files, but I run
> out of heap space on large files. Unfortunately, my users will expect
> to be able to load pretty big files occasionally (~1GB).
>
> Looking at the code documentation for the Antlr3 stream classes, it
> looks like they copy the entire stream. I'm ?thinking that I need to
> write a custom implementation of IntStream or CharStream that buffers
> the input. Is that the right way to solve this? Can someone point me
> in the right direction?
>
> Thanks!
>
> ?- mark
>

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From yurushkin at rambler.ru  Mon Oct  5 02:48:06 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Mon, 05 Oct 2009 13:48:06 +0400
Subject: [antlr-interest] [c target] debugging using antlrworks
In-Reply-To: <20091004201235.46E36D858C7@mx21.rambler.ru>
References: <op.u08uuaokt3jqlu@win-mupvrp0jyrf>
	<20091003230457.E988410AA840@mx17.rambler.ru>
	<op.u09l1pbnt3jqlu@win-mupvrp0jyrf>
	<20091004201235.46E36D858C7@mx21.rambler.ru>
Message-ID: <op.u1bmuglmt3jqlu@win-mupvrp0jyrf>

> Then you have something wrong in one of your rules.  Specifically, you  
> have a line that says "progName = $program_stmt.progName" in the wrong  
> place, or using the wrong syntax; ANTLR is trying to treat it as a  
> predicate instead of an action.  This also might explain why the  
> debugger is not stopping.
>
> If you want further help with that, then you'll need to post the rule.

I used your grammar (with small modification). the same result...


MyLexer.g
=================================
lexer grammar MyLexer;

options
{
    language = C;
}


ID  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
       ;

INT :	('0'..'9')+
       ;

WS  :   (   ' '
           |   '\t'
           |   '\r'
           |   '\n'
           )+
           { $channel=HIDDEN; }
       ;


MyParser.g
=================================

parser grammar MyParser;

options
{
       language	= C;
       tokenVocab = MyLexer;
}

@members
{
       ANTLR3_BOOLEAN enableEnum = ANTLR3_FALSE;
}

statement[ANTLR3_BOOLEAN asIDs]

       @init
       {
	enableEnum  = $asIDs;
       }
       : identifier    {printf("enum is an ID\n");}
       | enumAsKeyword {printf("enum is a keyword\n");}
       ;

identifier
       : ID
       | enumAsID
       ;

enumAsKeyword : {enableEnum}? enum1 ;

enumAsID : {!enableEnum}? enum1 ;


enum1: ID ;





MyParser.cpp
=================================

#include    <antlr3.h>
#include <stdio.h>
#include "generated/MyLexer.h"
#include "generated/MyParser.h"

int ANTLR3_CDECL
main	(int argc, char *argv[])
{
        pANTLR3_UINT8	    fName;

       pANTLR3_INPUT_STREAM    input;

       pMyLexer		    lxr;

       pANTLR3_COMMON_TOKEN_STREAM	    tstream;

       pMyParser				psr;
	fName	=(pANTLR3_UINT8)"out/test.txt"; // Note in VS2005 debug, working
directory must be configured

       input	= antlr3AsciiFileStreamNew(fName);

       if ( (ANTLR3_UINT64)input < 0 )
       {
	switch((ANTLR3_UINT64)input)
	{
	case    ANTLR3_ERR_NOMEM:

	    fprintf(stderr, "Unable to open file %s due to malloc() failure1\n",
(char *)fName);
	    exit(1);
	    break;

	default:

	    fprintf(stderr, "Failed to open file %s - exit with code %d\n", (char
*)fName, (ANTLR3_UINT64)input);
	    exit((int)((ANTLR3_UINT64)input));
	    break;
	}
       }

       // Our input stream is now open and all set to go, so we can create a
new instance of our
       // lexer and set the lexer input to our input stream:
       //  (file | memory | ?) --> inputstream -> lexer --> tokenstream -->
parser ( --> treeparser )?
       //
       lxr	    = MyLexerNew(input);	    // CLexerNew is generated by ANTLR

       // Need to check for errors
       //
       if ( (ANTLR3_UINT64)lxr < 0 )
       {
	switch((ANTLR3_UINT64)lxr)
	{
	case    ANTLR3_ERR_NOMEM:

	    fprintf(stderr, "Unable to create the lexer due to malloc()
failure1\n");
	    exit(1);
	    break;

	default:

	    fprintf(stderr, "Failed to create lexer - exit with code %d\n",
(ANTLR3_UINT64)lxr);
	    exit((int)((ANTLR3_UINT64)lxr));
	    break;
	}
       }

       tstream = antlr3CommonTokenStreamSourceNew(ANTLR3_SIZE_HINT,
TOKENSOURCE(lxr));

       if ((ANTLR3_UINT64)tstream == ANTLR3_ERR_NOMEM)
       {
	fprintf(stderr, "Out of memory trying to allocate token stream\n");
	exit(ANTLR3_ERR_NOMEM);
       }

       // Finally, now that we have our lexer constructed, we can create the
parser
       //
       psr	    = MyParserNew(tstream);  // CParserNew is generated by ANTLR3

       if ((ANTLR3_UINT64)tstream == ANTLR3_ERR_NOMEM)
       {
	fprintf(stderr, "Out of memory trying to allocate parser\n");
	exit(ANTLR3_ERR_NOMEM);
       }

       psr->statement(psr, ANTLR3_TRUE);    // First see enum as a keyword


       psr	    ->free  (psr);	    psr = NULL;
       tstream ->free  (tstream);	    tstream = NULL;
       lxr	    ->free  (lxr);	    lxr = NULL;
       input   ->close (input);	    input = NULL;

       return 0;
}

===============================================
How do I use antlrworks debugger:
1) I generate lexer and parser using -debug option.
2) I run my project. It starts to listen antlrworks (standard port, I
checked).
3) I open MyParser.g grammar and click "Remote debug". I use standard port.
4) My parser continies to work... and stops when it reach
		    "DBG->enterRule(DBG, getGrammarFileName(), (const char
*)"statement");"  line
5) In this procedure parser transmits some info to debugger and waits.
6) I click "Step forward" and parser continies it work and returns.. In
AntlrWorks I tried to use breakpoints and "step over" button - no results.

-- 
Best regards,
Michael

From boylan.mark at gmail.com  Mon Oct  5 05:16:42 2009
From: boylan.mark at gmail.com (Mark Boylan)
Date: Mon, 5 Oct 2009 08:16:42 -0400
Subject: [antlr-interest] Out of Memory
In-Reply-To: <2359950434082543486@unknownmsgid>
References: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>
	<f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com>
	<2359950434082543486@unknownmsgid>
Message-ID: <f4426c3f0910050516m75f0089bxe7e9609a364dafbd@mail.gmail.com>

It feels a little redundant, but I think that is the right solution.


On Mon, Oct 5, 2009 at 4:18 AM, Indhu Bharathi <indhu.b at s7software.com> wrote:
> Is it possible to write a separate program to break the PGN files into
> separate games and pass each game to the lexer/parser? That will be a simple
> solution assuming there is an easy way to split games in a PGN file.
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mark Boylan
> Sent: Monday, October 05, 2009 4:49 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Out of Memory
>
> Answering my own question :)
>
> I wrote a class named ANTLRMemoryMappedFileStream which is nearly a
> complete ripoff of ANTLRStringStream, except backed by a memory-mapped
> file. That solved the buffering problem. But now, I get an
> OutOfMemoryError in the parser with my big test file.
>
> I'm parsing chess games in PGN (portable game notation) format. A game
> in PGN format is usually under 1k, but a PGN file can contain many
> games. Most PGN files have several thousand games and those are no
> problem for Antlr and my grammar. But, PGN files with a million or
> more games are not rare -- especially in the case where a database
> user wants to restore an entire collection, or move it to a new chess
> database management program (like the one I'm working on). So, it's
> important for me to be able to do parse these huge files.
>
> I'm wondering if it's possible for the Parser to notify the Stream
> that a game has been parsed. At that point, the Stream implementation
> can flip the buffer. Does that sound like something that might work?
> Is that possible?
>
>
>
> On Sun, Oct 4, 2009 at 4:07 AM, Mark Boylan <boylan.mark at gmail.com> wrote:
>> Hi.
>>
>> My grammar is working really well with smaller test files, but I run
>> out of heap space on large files. Unfortunately, my users will expect
>> to be able to load pretty big files occasionally (~1GB).
>>
>> Looking at the code documentation for the Antlr3 stream classes, it
>> looks like they copy the entire stream. I'm ?thinking that I need to
>> write a custom implementation of IntStream or CharStream that buffers
>> the input. Is that the right way to solve this? Can someone point me
>> in the right direction?
>>
>> Thanks!
>>
>> ?- mark
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From naveen.chwl at googlemail.com  Mon Oct  5 07:02:19 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 5 Oct 2009 15:02:19 +0100
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
Message-ID: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>

If I do

(a ~b)=> a

meaning "take this alternative if you encounter an a when not followed by b"

I get a syntax error: unexpected token b
Is it the right syntax to use '~'?

N
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/3dac910f/attachment.html 

From Gordon.Tyler at quest.com  Mon Oct  5 07:04:27 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Mon, 5 Oct 2009 07:04:27 -0700
Subject: [antlr-interest] Out of Memory
In-Reply-To: <f4426c3f0910050516m75f0089bxe7e9609a364dafbd@mail.gmail.com>
References: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>
	<f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com>
	<2359950434082543486@unknownmsgid>
	<f4426c3f0910050516m75f0089bxe7e9609a364dafbd@mail.gmail.com>
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01C23B9667@alvxmbw04.prod.quest.corp>

Bear in mind that the on-disk representation of a data structure is most likely more efficient than the in-memory representation. So if you intend to load the entirety of your 1GB file into memory, you will probably be using more than 1GB of memory. This can be a problem on Win32 systems where it becomes difficult to allocate more than ~1.4GB of memory to the Java heap.

Unless there is some funky options in ANTLR which allows you to throw away parts of the parsed data as you've processed it, it sounds like you might need a hand-written stream processor.

You could also try just generating and using an ANTLR lexer in combination with a stream processor. Since it generates a stream of tokens, it shouldn't have the same difficulties of needing to maintain parsed data structures in memory, while still doing some of the grunt-work required to process the file. Thus your hand-written parser should have better control over what stays in memory.

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mark Boylan
Sent: October 5, 2009 8:17 AM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Out of Memory

It feels a little redundant, but I think that is the right solution.


On Mon, Oct 5, 2009 at 4:18 AM, Indhu Bharathi <indhu.b at s7software.com> wrote:
> Is it possible to write a separate program to break the PGN files into
> separate games and pass each game to the lexer/parser? That will be a simple
> solution assuming there is an easy way to split games in a PGN file.
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mark Boylan
> Sent: Monday, October 05, 2009 4:49 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Out of Memory
>
> Answering my own question :)
>
> I wrote a class named ANTLRMemoryMappedFileStream which is nearly a
> complete ripoff of ANTLRStringStream, except backed by a memory-mapped
> file. That solved the buffering problem. But now, I get an
> OutOfMemoryError in the parser with my big test file.
>
> I'm parsing chess games in PGN (portable game notation) format. A game
> in PGN format is usually under 1k, but a PGN file can contain many
> games. Most PGN files have several thousand games and those are no
> problem for Antlr and my grammar. But, PGN files with a million or
> more games are not rare -- especially in the case where a database
> user wants to restore an entire collection, or move it to a new chess
> database management program (like the one I'm working on). So, it's
> important for me to be able to do parse these huge files.
>
> I'm wondering if it's possible for the Parser to notify the Stream
> that a game has been parsed. At that point, the Stream implementation
> can flip the buffer. Does that sound like something that might work?
> Is that possible?
>
>
>
> On Sun, Oct 4, 2009 at 4:07 AM, Mark Boylan <boylan.mark at gmail.com> wrote:
>> Hi.
>>
>> My grammar is working really well with smaller test files, but I run
>> out of heap space on large files. Unfortunately, my users will expect
>> to be able to load pretty big files occasionally (~1GB).
>>
>> Looking at the code documentation for the Antlr3 stream classes, it
>> looks like they copy the entire stream. I'm ?thinking that I need to
>> write a custom implementation of IntStream or CharStream that buffers
>> the input. Is that the right way to solve this? Can someone point me
>> in the right direction?
>>
>> Thanks!
>>
>> ?- mark
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From naveen.chwl at googlemail.com  Mon Oct  5 07:14:06 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 5 Oct 2009 15:14:06 +0100
Subject: [antlr-interest] A wish
Message-ID: <56eb2660910050714p435aeaedgae0ee91cab4dceb1@mail.gmail.com>

I wish "Decision can match input such as ... using multiple alternatives"
would show the whole phrase that raises the ambiguity, and not just the
token.

Is there an easy way to find this out?
Would it be easy for it to be introduced into ANTLR, or do I always have to
see only the token every time (and not be able to know the phrase)?

N
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/cc9beeee/attachment.html 

From indhu.b at s7software.com  Mon Oct  5 07:22:19 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Mon, 5 Oct 2009 19:52:19 +0530
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
Message-ID: <014701ca45c7$405262f0$c0f728d0$@b@s7software.com>

Try something like:

 

(a)=> ((b)=>/*nothing*/ | a)

 

I remember facing similar problem. I guess you can't use '~' in a syntactic
predicate.

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Monday, October 05, 2009 7:32 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to do "not" in a syntactic predicate?

 

If I do

 

(a ~b)=> a

 

meaning "take this alternative if you encounter an a when not followed by b"

 

I get a syntax error: unexpected token b

Is it the right syntax to use '~'?

 

N

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/e37d540f/attachment.html 

From indhu.b at s7software.com  Mon Oct  5 07:29:56 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Mon, 5 Oct 2009 19:59:56 +0530
Subject: [antlr-interest] A wish
In-Reply-To: <56eb2660910050714p435aeaedgae0ee91cab4dceb1@mail.gmail.com>
References: <56eb2660910050714p435aeaedgae0ee91cab4dceb1@mail.gmail.com>
Message-ID: <014c01ca45c8$4fe11fd0$efa35f70$@b@s7software.com>

ANTLRWORKS already has this feature. Compile your grammar in ANTLRWORKS.
When there is an ambiguity, the rule will be marked in red and you can check
the "Syntax diagram" tab to graphically see the ambiguity.

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Monday, October 05, 2009 7:44 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] A wish

 

I wish "Decision can match input such as ... using multiple alternatives"
would show the whole phrase that raises the ambiguity, and not just the
token.

 

Is there an easy way to find this out?

Would it be easy for it to be introduced into ANTLR, or do I always have to
see only the token every time (and not be able to know the phrase)?

 

N

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/f3129409/attachment.html 

From naveen.chwl at googlemail.com  Mon Oct  5 07:54:12 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 5 Oct 2009 15:54:12 +0100
Subject: [antlr-interest] A wish
In-Reply-To: <-4881157702829426566@unknownmsgid>
References: <56eb2660910050714p435aeaedgae0ee91cab4dceb1@mail.gmail.com>
	<-4881157702829426566@unknownmsgid>
Message-ID: <56eb2660910050754m2fb21515hb62a5d38eeeb299b@mail.gmail.com>

Yes but unfortunately the syntax diagram shows only the path surrounding
that particular token. Not the phrase which raises that ambiguity. I'm happy
with the syntax diagram as it is, just want to know the preceding phrase
which raises that ambiguity. I wonder if this is actually impossible for the
ANTLR developers to give, or if it's really easy, or if there's already an
ANTLR option to see it in the warning/error message.

2009/10/5 Indhu Bharathi <indhu.b at s7software.com>

>  ANTLRWORKS already has this feature. Compile your grammar in ANTLRWORKS.
> When there is an ambiguity, the rule will be marked in red and you can check
> the ?Syntax diagram? tab to graphically see the ambiguity.
>
>
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Monday, October 05, 2009 7:44 PM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] A wish
>
>
>
> I wish "Decision can match input such as ... using multiple alternatives"
> would show the whole phrase that raises the ambiguity, and not just the
> token.
>
>
>
> Is there an easy way to find this out?
>
> Would it be easy for it to be introduced into ANTLR, or do I always have to
> see only the token every time (and not be able to know the phrase)?
>
>
>
> N
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/6625eb2d/attachment.html 

From naveen.chwl at googlemail.com  Mon Oct  5 10:13:08 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 5 Oct 2009 18:13:08 +0100
Subject: [antlr-interest] Enforcing a right associativity,
	to resolve an ambiguity (simple 	grammar included)
In-Reply-To: <56eb2660910030244h4edc13aq48cc02f4cf7a2db3@mail.gmail.com>
References: <56eb2660910021410u691f1e58x4d83882082b571e4@mail.gmail.com>
	<56eb2660910030244h4edc13aq48cc02f4cf7a2db3@mail.gmail.com>
Message-ID: <56eb2660910051013k2ceb8839xab3b03b5120f7568@mail.gmail.com>

Ok, so I found out that if you want it bound to the latest thing, that is
the "greedy" option, fortunately that is the way ANTLR automatically
resolves such ambiguities by default. According to p.276 ch.11 "The
Definitive ANTLR Reference": "ANTLR generates a warning, but you can safely
ignore it".

Thanks.

2009/10/3 Naveen Chawla <naveen.chwl at googlemail.com>

> To be clear, I want prepPhr to always belong to the last occuring 'Ving'
> (nounPhrase) before it (i.e. drinking-while-driving)
>
> 2009/10/2 Naveen Chawla <naveen.chwl at googlemail.com>
>
>  Hi,
>>
>> I'm a little bit stumped. You might find this easy. I'm trying to develop
>> an English parser and have come across a real ambiguity in English, on
>> which, for the time being, I just want to enforce simple right
>> associativity:
>>
>> e.g. Recommending drinking while driving is dangerous.
>>
>> (Is it referring to the person driving while they are recommending
>> drinking, or the person recommending drinking-during-driving?)
>>
>> This is not a problem. Since they are both equally valid in English, for
>> the time being I just want to enforce right associativity (maybe later give
>> a user option to change the tree), but I cannot figure out how!! Here is the
>> grammar I want to make right-associative (simplified for your convenience):
>>
>> grammar prep;
>> sentence: nounPhrase 'verb';
>>
>>             nounPhrase: 'Ving' complement? prepPhr?;
>>
>>                            complement : nounPhrase 'noun'? ;
>>
>>                            prepPhr: 'preposition' nounPhrase;
>>
>>
>> Ambiguous sentence example: "Ving Ving preposition Ving verb"
>> Ambiguity: "preposition" can be a prepPhr belonging to the first "Ving"
>> (nounPhrase) OR the second "Ving" (nounPhrase). I want prepPhr to always
>> belong to the last occurring 'Ving' (nounPhrase). So I want to
>> enforce, using the example sentence (right associativity):
>>
>>  sentence{
>>          nounPhrase{
>>                    'Ving'
>>                     complement{
>>                                 nounPhrase{
>>                                              'Ving'
>>                                               prepPhr{
>>                                                            'preposition'
>>                                                            nounPhrase{
>>
>>                                                                           'Ving'
>>                                                             }
>>                                               }
>>                                 }
>>                    }
>>          }
>>          'verb'
>> }
>>
>> instead of
>>
>>  sentence{
>>          nounPhrase{
>>                    'Ving'
>>                     complement{
>>                                 nounPhrase{
>>                                              'Ving'
>>                                 }
>>                      }
>>                      prepPhr{
>>                                 'preposition'
>>                                 nounPhrase{
>>                                              'Ving'
>>                                  }
>>                       }
>>          }
>>          'verb'
>> }
>>
>> while preserving the grammar.
>> Anybody have as easy idea how? Sorry if I sound newbie, I'm stumped.
>>
>> Regards,
>> N
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/1074ed4f/attachment.html 

From jimi at temporal-wave.com  Mon Oct  5 10:36:54 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 05 Oct 2009 10:36:54 -0700
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
Message-ID: <9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>

Use a semantic predicate rather than syntactic. You possibly need a bated predicate here too:

 

{ input.LA(1) == A && input.LA(2) != B}?=>

 

However, if you need that kind of syntactic predicate, then I suggest you may be approaching your problem incorrectly.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Monday, October 05, 2009 7:02 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to do "not" in a syntactic predicate?

 

If I do

 

(a ~b)=> a

 

meaning "take this alternative if you encounter an a when not followed by b"

 

I get a syntax error: unexpected token b

Is it the right syntax to use '~'?

 

N



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091005/3470dece/attachment.html 

From kaleb.pederson at gmail.com  Mon Oct  5 13:37:53 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Mon, 5 Oct 2009 13:37:53 -0700
Subject: [antlr-interest] Unit testing grammar productions and injecting EOF
Message-ID: <f14c01620910051337u6606bcc7k50bee7273cc2a8bd@mail.gmail.com>

I have a grammar that contains the following production:

objectMember : functionExpression | ID;

The unit tests for the above production, however, sometimes passed and
sometimes failed.  After some investigation, I found that the reason
for the failure was that EOF wasn't in the expected follow set, which
makes sense when I'm parsing the whole language.

As a workaround, I changed my production, adding EOF as an optional
terminal as follows:

objectMember : functionExpression EOF? | ID EOF?;

Everything now works but I'm curious if a better solution for testing
individual grammar productions exists.  Suggestions or alternatives?

Thanks.

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

From antlr at mirality.co.nz  Mon Oct  5 13:51:02 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 06 Oct 2009 09:51:02 +1300
Subject: [antlr-interest] [c target] debugging using antlrworks
In-Reply-To: <op.u1apijeqt3jqlu@win-mupvrp0jyrf>
References: <op.u08uuaokt3jqlu@win-mupvrp0jyrf>
	<20091003230457.E988410AA840@mx17.rambler.ru>
	<op.u09l1pbnt3jqlu@win-mupvrp0jyrf>
	<20091004201235.46E36D858C7@mx21.rambler.ru>
	<op.u1apijeqt3jqlu@win-mupvrp0jyrf>
Message-ID: <20091005205128.7CF35341840C@www.antlr.org>

At 10:48 5/10/2009, =?koi8-r?B?4NLV28vJziDtycjBycw=?= wrote:
 >I used your grammar (with small modification). the same 
result...

Don't forget to use Reply All to keep replies on-list...

 >1) I generate lexer and parser using -debug option.
 >2) I run my project. It starts to listen antlrworks (standard 
port,
 >I checked).
 >3) I open MyParser.g grammar and click "Remote debug". I use
 >standard port.
 >4) My parser continies to work... and stops when it reach
 >		    "DBG->enterRule(DBG, getGrammarFileName(), (const char
 >*)"statement");"  line
 >5) In this procedure parser transmits some info to debugger and
 >waits.
 >6) I click "Step forward" and parser continies it work and
 >returns.. In AntlrWorks I tried to use breakpoints and "step
 >over" button - no results.

Possibly your parser is not matching anything.  Try adding EOF to 
the end of your top-level rule; this tells it that it must consume 
all the input or generate an error.

Remember, the ANTLRWorks debugger is useless for finding problems 
with lexer rules; you really need to write unit tests in order to 
verify those before worrying about what's going on in your parser 
rules.


From kirby.bohling at gmail.com  Mon Oct  5 16:37:05 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Mon, 5 Oct 2009 18:37:05 -0500
Subject: [antlr-interest] Out of Memory
In-Reply-To: <f4426c3f0910050516m75f0089bxe7e9609a364dafbd@mail.gmail.com>
References: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com> 
	<f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com> 
	<2359950434082543486@unknownmsgid>
	<f4426c3f0910050516m75f0089bxe7e9609a364dafbd@mail.gmail.com>
Message-ID: <3cac8fdf0910051637w7bcb74e6v7a800ae108564084@mail.gmail.com>

On Mon, Oct 5, 2009 at 7:16 AM, Mark Boylan <boylan.mark at gmail.com> wrote:
> It feels a little redundant, but I think that is the right solution.
>

Assuming you have something like: game_list: game*;

Couldn't you do that in the lexer/parser?  Just don't match EOF on the
start rule?  That you can just have something like:

parser.game_prefix();
while (game_or_end_return = parser.game_or_end()) {
// Process game here
// make sure it you didn't hit the end case here.
}

That might not make the lexer dump everything, but I thought that
would get the parser to not have everything in there.

I haven't actually tried it with huge amounts of memory, but I thought
that was the way it worked.  Maybe save where you are at in the file
when that finishes and create a new lexer and seek to the proper place
in the file if it doesn't actually clean up after itself.  I think
you're correct, it's silly to write something smart enough to split
the files by hand, when you have a grammar capable of dealing with it.

Kirby


>
> On Mon, Oct 5, 2009 at 4:18 AM, Indhu Bharathi <indhu.b at s7software.com> wrote:
>> Is it possible to write a separate program to break the PGN files into
>> separate games and pass each game to the lexer/parser? That will be a simple
>> solution assuming there is an easy way to split games in a PGN file.
>>
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org
>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mark Boylan
>> Sent: Monday, October 05, 2009 4:49 AM
>> To: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] Out of Memory
>>
>> Answering my own question :)
>>
>> I wrote a class named ANTLRMemoryMappedFileStream which is nearly a
>> complete ripoff of ANTLRStringStream, except backed by a memory-mapped
>> file. That solved the buffering problem. But now, I get an
>> OutOfMemoryError in the parser with my big test file.
>>
>> I'm parsing chess games in PGN (portable game notation) format. A game
>> in PGN format is usually under 1k, but a PGN file can contain many
>> games. Most PGN files have several thousand games and those are no
>> problem for Antlr and my grammar. But, PGN files with a million or
>> more games are not rare -- especially in the case where a database
>> user wants to restore an entire collection, or move it to a new chess
>> database management program (like the one I'm working on). So, it's
>> important for me to be able to do parse these huge files.
>>
>> I'm wondering if it's possible for the Parser to notify the Stream
>> that a game has been parsed. At that point, the Stream implementation
>> can flip the buffer. Does that sound like something that might work?
>> Is that possible?
>>
>>
>>
>> On Sun, Oct 4, 2009 at 4:07 AM, Mark Boylan <boylan.mark at gmail.com> wrote:
>>> Hi.
>>>
>>> My grammar is working really well with smaller test files, but I run
>>> out of heap space on large files. Unfortunately, my users will expect
>>> to be able to load pretty big files occasionally (~1GB).
>>>
>>> Looking at the code documentation for the Antlr3 stream classes, it
>>> looks like they copy the entire stream. I'm ?thinking that I need to
>>> write a custom implementation of IntStream or CharStream that buffers
>>> the input. Is that the right way to solve this? Can someone point me
>>> in the right direction?
>>>
>>> Thanks!
>>>
>>> ?- mark
>>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From antlr at mirality.co.nz  Tue Oct  6 01:48:08 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 06 Oct 2009 21:48:08 +1300
Subject: [antlr-interest] Out of Memory
In-Reply-To: <3cac8fdf0910051637w7bcb74e6v7a800ae108564084@mail.gmail.co
 m>
References: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>
	<f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com>
	<2359950434082543486@unknownmsgid>
	<f4426c3f0910050516m75f0089bxe7e9609a364dafbd@mail.gmail.com>
	<3cac8fdf0910051637w7bcb74e6v7a800ae108564084@mail.gmail.com>
Message-ID: <20091006084835.38586341845A@www.antlr.org>

At 12:37 6/10/2009, Kirby Bohling wrote:
 >Couldn't you do that in the lexer/parser?  Just don't match EOF 
on
 >the start rule?  That you can just have something like:
 >
 >parser.game_prefix();
 >while (game_or_end_return = parser.game_or_end()) {
 >// Process game here
 >// make sure it you didn't hit the end case here.
 >}
 >
 >That might not make the lexer dump everything, but I thought 
that
 >would get the parser to not have everything in there.

Unfortunately not; the default behaviour of the lexer/token-stream 
is to translate the entire input into tokens before processing 
parser rules.  So you'd at least need to use a modified one that 
tokenises only as much as required each time; I think there's an 
example of this on the Wiki.


From gwlist at grahamwideman.com  Tue Oct  6 03:15:05 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 06 Oct 2009 03:15:05 -0700
Subject: [antlr-interest] Why BANG after rule id ?
Message-ID: <4.1.20091006030250.02964ba8@grahamwideman.com>

Hi folks:

I see in the ANTLR grammar that you can place a BANG (exclamation point) after the initial rule id in a rule. Indeed it's used in the ANTLR v3 grammar itself:

----------------------------
range!
  :  c1=CHAR_LITERAL RANGE c2=CHAR_LITERAL elementOptions?
    -> ^(CHAR_RANGE[$c1,".."] $c1 $c2 elementOptions?)
;
----------------------------

Could someone illuminate what this ! does? 

Thanks,   Graham




From Heiko.Folkerts at david-bs.de  Tue Oct  6 05:15:13 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Tue, 6 Oct 2009 14:15:13 +0200
Subject: [antlr-interest] Using tree parsers in the C Target
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF130325FAE8@DC2>

Hello,
I have a parser called TFSSBase which creates an AST. Now I wrote a tree parser called TFSSTree. Now I want to use TFSSTree to process the output from TFSSBase. But the methods in TFSSTree accept a pointer to TFSSTree instead of the AST generated from the TFSSBase parser. How would I hand the AST from TFSSBase to TFSSTree?

Thx in advance


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From yurushkin at rambler.ru  Tue Oct  6 06:40:16 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Tue, 06 Oct 2009 17:40:16 +0400
Subject: [antlr-interest] [c target] debugging using antlrworks
In-Reply-To: <20091005205115.5981F89A48A@mx22.rambler.ru>
References: <op.u08uuaokt3jqlu@win-mupvrp0jyrf>
	<20091003230457.E988410AA840@mx17.rambler.ru>
	<op.u09l1pbnt3jqlu@win-mupvrp0jyrf>
	<20091004201235.46E36D858C7@mx21.rambler.ru>
	<op.u1apijeqt3jqlu@win-mupvrp0jyrf>
	<20091005205115.5981F89A48A@mx22.rambler.ru>
Message-ID: <op.u1dr9ekht3jqlu@win-mupvrp0jyrf>

>  >1) I generate lexer and parser using -debug option.
>  >2) I run my project. It starts to listen antlrworks (standard port,
>  >I checked).
>  >3) I open MyParser.g grammar and click "Remote debug". I use
>  >standard port.
>  >4) My parser continies to work... and stops when it reach
>  >		    "DBG->enterRule(DBG, getGrammarFileName(), (const char
>  >*)"statement");"  line
>  >5) In this procedure parser transmits some info to debugger and
>  >waits.
>  >6) I click "Step forward" and parser continies it work and
>  >returns.. In AntlrWorks I tried to use breakpoints and "step
>  >over" button - no results.
>
> Possibly your parser is not matching anything.  Try adding EOF to the  
> end of your top-level rule; this tells it that it must consume all the  
> input or generate an error.
>
> Remember, the ANTLRWorks debugger is useless for finding problems with  
> lexer rules; you really need to write unit tests in order to verify  
> those before worrying about what's going on in your parser rules.

It's not MY parser.. I used code example from ANTLRWORKS   
("C/hoistedPredicates" example).
I generated debug version of this project, but debugger doesnt work  
correctly (see my last message).
Could u check this example (with the antlrworks debugger)? If you'll get  
positive result, please, send me your project! Your example will help me  
very mutch!

have a nice working day,
Michael

From boylan.mark at gmail.com  Tue Oct  6 06:54:12 2009
From: boylan.mark at gmail.com (Mark Boylan)
Date: Tue, 6 Oct 2009 09:54:12 -0400
Subject: [antlr-interest] Out of Memory
In-Reply-To: <4acb0455.1002be0a.04f2.fffffe7bSMTPIN_ADDED@mx.google.com>
References: <f4426c3f0910040107w22dc4369l832cb25b58abc0a0@mail.gmail.com>
	<f4426c3f0910041618u4dec5062hfeb9900b3ff10acf@mail.gmail.com>
	<2359950434082543486@unknownmsgid>
	<f4426c3f0910050516m75f0089bxe7e9609a364dafbd@mail.gmail.com>
	<3cac8fdf0910051637w7bcb74e6v7a800ae108564084@mail.gmail.com>
	<4acb0455.1002be0a.04f2.fffffe7bSMTPIN_ADDED@mx.google.com>
Message-ID: <f4426c3f0910060654i121dd738uf68e704826ae6f27@mail.gmail.com>

I ended up writing a Reader class that returns one game from the file
with each call to next(), which I can then pass to the parser.

In the end, I think this will work better for me. This way, I can show
progress. I can report errors in unreadable files by line number. I
can hold games with parsing or validation errors in a list and offer
the user the opportunity to make corrections -- and it fits in nicely
with the builder pattern.

The more I think about it, the more I think that preprocessing the
file was the best way to do it all along.



On Tue, Oct 6, 2009 at 4:48 AM, Gavin Lambert <antlr at mirality.co.nz> wrote:
> At 12:37 6/10/2009, Kirby Bohling wrote:
>>Couldn't you do that in the lexer/parser? ?Just don't match EOF on
>>the start rule? ?That you can just have something like:
>>
>>parser.game_prefix();
>>while (game_or_end_return = parser.game_or_end()) {
>>// Process game here
>>// make sure it you didn't hit the end case here.
>>}
>>
>>That might not make the lexer dump everything, but I thought that
>>would get the parser to not have everything in there.
>
> Unfortunately not; the default behaviour of the lexer/token-stream is to
> translate the entire input into tokens before processing parser rules. ?So
> you'd at least need to use a modified one that tokenises only as much as
> required each time; I think there's an example of this on the Wiki.
>
>

From troy.daniels at baesystems.com  Tue Oct  6 07:13:04 2009
From: troy.daniels at baesystems.com (Daniels, Troy (US SSA))
Date: Tue, 6 Oct 2009 10:13:04 -0400
Subject: [antlr-interest] Unit testing grammar productions and injecting
	EOF
Message-ID: <814i1h$4e03ta@dmzms99801.na.baesystems.com>

 

> -----Original Message-----
> 
> 
> As a workaround, I changed my production, adding EOF as an 
> optional terminal as follows:
> 
> objectMember : functionExpression EOF? | ID EOF?;
> 
> Everything now works but I'm curious if a better solution for 
> testing individual grammar productions exists.  Suggestions 
> or alternatives?
> 

While it's not the best answer, you could change your test code so that
instead of passing "foo", it passed "foo junk".  That way, your fix is
in the test code, and the production grammar says what you want it to
say.  Better would be for Antlr to include EOF in the follow set if it's
possible.

Troy

> Thanks.
> 
> --Kaleb
> 
> http://twitter.com/kalebpederson
> http://kalebpederson.com
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 

From Timothy.Bocek at bsci.com  Tue Oct  6 10:41:11 2009
From: Timothy.Bocek at bsci.com (Bocek, Timothy (RDM))
Date: Tue, 6 Oct 2009 12:41:11 -0500
Subject: [antlr-interest] @members and the lexer in 3.0.1
Message-ID: <955FE80A1773E2438A7352CD7727F225F95398@STPEVS07.ad.guidant.com>

I am using the python target in antlr 3.0.1.  I'm not able to upgrade
for nontechnical reasons.  I am trying to get an exception thrown on any
recognition error, and have gotten as far as

@members {
	def emitErrorMessage(self, msg):
		raise Exception(msg)
}

And this seems to work for parser errors (in addition to overriding the
recoverFrom methods).  However, the lexer still just writes its errors
to stdout instead of throwing an exception.  Upon inspection of the
generated code, it looks like the @members section is only applying to
the lexer, not the parser.  

Is there an @members equivalent for the lexer?  Or some way to make
@members apply to the lexer as well?  Or is this just a bug in the
version I'm using which is fixed in a later one?

Thanks
Tim Bocek
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091006/e9f1ec99/attachment.html 

From kirby.bohling at gmail.com  Tue Oct  6 11:13:32 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Tue, 6 Oct 2009 13:13:32 -0500
Subject: [antlr-interest] @members and the lexer in 3.0.1
In-Reply-To: <955FE80A1773E2438A7352CD7727F225F95398@STPEVS07.ad.guidant.com>
References: <955FE80A1773E2438A7352CD7727F225F95398@STPEVS07.ad.guidant.com>
Message-ID: <3cac8fdf0910061113i50186e16yc8ad3964bc5a4f2d@mail.gmail.com>

On Tue, Oct 6, 2009 at 12:41 PM, Bocek, Timothy (RDM)
<Timothy.Bocek at bsci.com> wrote:
<snip...>
> Is there an @members equivalent for the lexer?? Or some way to make @members
> apply to the lexer as well?? Or is this just a bug in the version I'm using
> which is fixed in a later one?
>

I don't see an obvious reference online, and I know the answer that
I'm searching for...

This describes it fairly tersely, but doesn't explicitly have an
example of what you are asking about.  I believe that the @header and
@members handle this situation identically.
http://www.antlr.org/wiki/display/ANTLR3/Grammars

@lexer::members {
}

I believe is the correct syntax.

I always use separate lexers, parsers and walkers, so I don't have an
example of that handy I can cut and paste.

It's described in section 4.6 of "The Definitive ANTLR Reference" if
you have a copy of that (well worth the price of admission, I highly
recommend it if you use ANTLR for anything).

Thanks,
   Kirby


> Thanks
> Tim Bocek
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From jimi at temporal-wave.com  Tue Oct  6 11:25:40 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 06 Oct 2009 11:25:40 -0700
Subject: [antlr-interest] Using tree parsers in the C Target
In-Reply-To: <93FCBF72DCE7634481C5DF1654D8FF130325FAE8@DC2>
Message-ID: <581e3ab9e8ab504998e2188511a52af0@temporal-wave.com>

Download the examples tar and look at the tree parsers in the C examples :-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Heiko Folkerts
> Sent: Tuesday, October 06, 2009 5:15 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Using tree parsers in the C Target
> 
> Hello,
> I have a parser called TFSSBase which creates an AST. Now I wrote a
> tree parser called TFSSTree. Now I want to use TFSSTree to process the
> output from TFSSBase. But the methods in TFSSTree accept a pointer to
> TFSSTree instead of the AST generated from the TFSSBase parser. How
> would I hand the AST from TFSSBase to TFSSTree?
> 
> Thx in advance
> 
> 
> Mit freundlichem Gru?
> Heiko Folkerts
> Systementwicklung und -design
> --
> ______________________________________________
> DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
> Tel.: +49 531 24379-14
> Fax.: +49 531 24379-79
> E-Mail: mailto:Heiko.Folkerts at david-bs.de
> WWW:   http://www.david-bs.de
> Eintragung: Amtsgericht Braunschweig, HRB 3167
> Gesch?ftsf?hrer: Frank Ptok
> ______________________________________________
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From frank.du at riskmetrics.com  Tue Oct  6 12:21:28 2009
From: frank.du at riskmetrics.com (Frank Du)
Date: Tue, 6 Oct 2009 15:21:28 -0400
Subject: [antlr-interest] how to provide exception information in language
	execution?
Message-ID: <ACF14F1689EFEF438B46DADFB73B46E937F296AA@mail-ab01.rmg-ny.com>

Dear All,

I wrote a parser and tree walker. When running the language, the following information helps diagnostics:

1.      What is the line number that throws out an exception?
2.      How to provide stack trace information?

Could someone show me how to construct such information, or point me to the relative documentation? Thank you so much! Have a nice day!

Best Regards,
Frank

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091006/f12de2ed/attachment.html 

From kaleb.pederson at gmail.com  Tue Oct  6 13:33:09 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Tue, 6 Oct 2009 13:33:09 -0700
Subject: [antlr-interest] Unit testing grammar productions and injecting
	EOF
In-Reply-To: <814i1h$4e03ta@dmzms99801.na.baesystems.com>
References: <814i1h$4e03ta@dmzms99801.na.baesystems.com>
Message-ID: <f14c01620910061333h41f468efi522d2b37d05600ac@mail.gmail.com>

On Tue, Oct 6, 2009 at 7:13 AM, Daniels, Troy (US SSA)
<troy.daniels at baesystems.com> wrote:
>
>> As a workaround, I changed my production, adding EOF as an
>> optional terminal as follows:
>>
>> objectMember : functionExpression EOF? | ID EOF?;
>>
>> Everything now works but I'm curious if a better solution for
>> testing individual grammar productions exists. ?Suggestions
>> or alternatives?
>>
>
> While it's not the best answer, you could change your test code so that
> instead of passing "foo", it passed "foo junk". ?That way, your fix is
> in the test code, and the production grammar says what you want it to
> say. ?Better would be for Antlr to include EOF in the follow set if it's
> possible.

Thanks for the suggestion Troy.  You're right, that's certainly a
valid workaround.  I could look through the generated follow set and
choose one of the permitted tokens, but that would clutter the tests
and leave them less readable.  Of course, if I don't clutter the tests
with the extra symbol, I have to clutter the grammar with the extra
EOF, but I'm preferential to that at the moment as it currently only
occurs in that one production, but I'll keep your suggestion in mind.

Thanks.

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

From javicid at gmail.com  Tue Oct  6 13:56:29 2009
From: javicid at gmail.com (=?ISO-8859-1?Q?Javi_=C1lvarez?=)
Date: Tue, 6 Oct 2009 22:56:29 +0200
Subject: [antlr-interest] Problem displaying diagrams
Message-ID: <34ca83450910061356w71529da7p892a2388b6fb921e@mail.gmail.com>

Hi there,

I'm a MacOS X user (Leopard 10.6.1). I've downloaded AntlrWorks and I'm
trying to build a grammar, but when I generate the parse tree or the AST I
can only see the boxes but not the values inside, sometimes a lot of Qs
inside the boxes appear.

Anyone with the same problem?

Thanks.

-- Javi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091006/898521de/attachment.html 

From kaleb.pederson at gmail.com  Tue Oct  6 14:18:55 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Tue, 6 Oct 2009 14:18:55 -0700
Subject: [antlr-interest] Why BANG after rule id ?
In-Reply-To: <4.1.20091006030250.02964ba8@grahamwideman.com>
References: <4.1.20091006030250.02964ba8@grahamwideman.com>
Message-ID: <200910061418.55228.kaleb.pederson@gmail.com>

On Tuesday 06 October 2009 03:15:05 am Graham Wideman wrote:
> Hi folks:
> 
> I see in the ANTLR grammar that you can place a BANG (exclamation point) after the initial rule id in a rule. Indeed it's used in the ANTLR v3 grammar itself:
> 
> ----------------------------
> range!
>   :  c1=CHAR_LITERAL RANGE c2=CHAR_LITERAL elementOptions?
>     -> ^(CHAR_RANGE[$c1,".."] $c1 $c2 elementOptions?)
> ;
> ----------------------------
> 
> Could someone illuminate what this ! does?

The exclamation mark is placed on a node when that node should not be present in the AST when output=AST for a grammar.

See:

http://jnb.ociweb.com/jnb/jnbJun2008.html#CreatingASTs
http://www.antlr.org/wiki/display/ANTLR3/Tree+construction

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

From kirby.bohling at gmail.com  Tue Oct  6 14:57:45 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Tue, 6 Oct 2009 16:57:45 -0500
Subject: [antlr-interest] Why BANG after rule id ?
In-Reply-To: <200910061418.55228.kaleb.pederson@gmail.com>
References: <4.1.20091006030250.02964ba8@grahamwideman.com> 
	<200910061418.55228.kaleb.pederson@gmail.com>
Message-ID: <3cac8fdf0910061457l787b956cjde747c5ece144d1a@mail.gmail.com>

On Tue, Oct 6, 2009 at 4:18 PM, Kaleb Pederson <kaleb.pederson at gmail.com> wrote:
> On Tuesday 06 October 2009 03:15:05 am Graham Wideman wrote:
>> Hi folks:
>>
>> I see in the ANTLR grammar that you can place a BANG (exclamation point) after the initial rule id in a rule. Indeed it's used in the ANTLR v3 grammar itself:
>>
>> ----------------------------
>> range!
>> ? : ?c1=CHAR_LITERAL RANGE c2=CHAR_LITERAL elementOptions?
>> ? ? -> ^(CHAR_RANGE[$c1,".."] $c1 $c2 elementOptions?)
>> ;
>> ----------------------------
>>
>> Could someone illuminate what this ! does?
>
> The exclamation mark is placed on a node when that node should not be present in the AST when output=AST for a grammar.
>
> See:
>
> http://jnb.ociweb.com/jnb/jnbJun2008.html#CreatingASTs
> http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
>

Kaleb,

Neither of your example sites talk about what he is discussing.  It
isn't applied to a node, it is applied to a rule
definition/declaration, not to a rule invoked as part of the
production of a rule.  I checked every '!' in those links and none of
them mention are used like that, or as far as I can tell have a usage
similarly.  I don't know much about ANTLRv2, but I thought the ANTLRv3
wasn't self hosting, so the grammar for ANTLRv3 was written in
ANTLRv2.  Or at least that was the case during the early parts of
ANTLRv3.  Graham, you might try researching ANTLRv2 and see what it
does.

I'm guessing that this is mostly likely what you are looking for,
assuming that I'm correct and the grammar you are looking at is really
an ANTLRv2 grammar:
http://www.antlr2.org/doc/lexer.html#Manipulating_Token_Text_and_Objects

Kirby

From kaleb.pederson at gmail.com  Tue Oct  6 14:58:43 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Tue, 6 Oct 2009 14:58:43 -0700
Subject: [antlr-interest] Why BANG after rule id ?
In-Reply-To: <200910061418.55228.kaleb.pederson@gmail.com>
References: <4.1.20091006030250.02964ba8@grahamwideman.com>
	<200910061418.55228.kaleb.pederson@gmail.com>
Message-ID: <200910061458.43706.kaleb.pederson@gmail.com>

Well I wasn't paying enough attention to the question, so the answer I gave probably wasn't right :(.  The exclamation mark is used as I indicated when following an element or range within a rule, but I've never actually seen it used as in the example you provided.  I looked at the grammar description documentation (http://www.antlr.org/wiki/display/ANTLR3/Grammars), but don't see it present in the documentation.

It's definitely supported as indicated by the '!' in this grammar rule:

rule
scope {
    String name;
}
    :   DOC_COMMENT?
        ( modifier=('protected'|'public'|'private'|'fragment') )?
        id {$rule::name = $id.text;}
        '!'?
        ( arg=ARG_ACTION )?
        ( 'returns' rt=ARG_ACTION  )?
        throwsSpec? optionsSpec? ruleScopeSpec? ruleAction*
        ':' altList ';'
        exceptionGroup?
        -> ^( RULE id {modifier!=null?adaptor.create(modifier):null} ^(ARG[$arg] $arg)? ^('returns' $rt)?
              throwsSpec? optionsSpec? ruleScopeSpec? ruleAction*
              altList
              exceptionGroup?
              EOR["EOR"]
            )
    ;

Sorry I can't be of more help.

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

On Tuesday 06 October 2009 02:18:55 pm Kaleb Pederson wrote:
> On Tuesday 06 October 2009 03:15:05 am Graham Wideman wrote:
> > Hi folks:
> > 
> > I see in the ANTLR grammar that you can place a BANG (exclamation point) after the initial rule id in a rule. Indeed it's used in the ANTLR v3 grammar itself:
> > 
> > ----------------------------
> > range!
> >   :  c1=CHAR_LITERAL RANGE c2=CHAR_LITERAL elementOptions?
> >     -> ^(CHAR_RANGE[$c1,".."] $c1 $c2 elementOptions?)
> > ;
> > ----------------------------
> > 
> > Could someone illuminate what this ! does?
> 
> The exclamation mark is placed on a node when that node should not be present in the AST when output=AST for a grammar.
> 
> See:
> 
> http://jnb.ociweb.com/jnb/jnbJun2008.html#CreatingASTs
> http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
> 
> --Kaleb
> 
> http://twitter.com/kalebpederson
> http://kalebpederson.com
> 

From naveen.chwl at googlemail.com  Tue Oct  6 15:02:09 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Tue, 6 Oct 2009 23:02:09 +0100
Subject: [antlr-interest] Help writing a particular semantic predicate
Message-ID: <56eb2660910061502w319965dbr24aaaa4c62320d86@mail.gmail.com>

grammar x;

x:  a b;

     a: 'i' a? | c? 'j';     // Question, how would I write the semantic
predicates: if this "a" is followed by 'v1' choose the first alternative, if
not choose the second alternative

          c: 'i';

     b: 'v1' | 'v2';
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091006/bddb08de/attachment.html 

From kaleb.pederson at gmail.com  Tue Oct  6 15:46:35 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Tue, 6 Oct 2009 15:46:35 -0700
Subject: [antlr-interest] Why BANG after rule id ?
In-Reply-To: <3cac8fdf0910061457l787b956cjde747c5ece144d1a@mail.gmail.com>
References: <4.1.20091006030250.02964ba8@grahamwideman.com>
	<200910061418.55228.kaleb.pederson@gmail.com>
	<3cac8fdf0910061457l787b956cjde747c5ece144d1a@mail.gmail.com>
Message-ID: <f14c01620910061546qcb4d6a5sb94bff255dc13ff7@mail.gmail.com>

On Tue, Oct 6, 2009 at 2:57 PM, Kirby Bohling <kirby.bohling at gmail.com> wrote:
> Kaleb,
>
> Neither of your example sites talk about what he is discussing. ?It
> isn't applied to a node, it is applied to a rule
> definition/declaration, not to a rule invoked as part of the
> production of a rule.

Yeah, thanks for gently pointing that out :).  I noticed and sent out
my correction at almost the exact same time you did.

> I'm guessing that this is mostly likely what you are looking for,
> assuming that I'm correct and the grammar you are looking at is really
> an ANTLRv2 grammar:
> http://www.antlr2.org/doc/lexer.html#Manipulating_Token_Text_and_Objects

The fragment he quoted is actually from the ANTLR v3 grammar for
ANTLR.  It's available int the 3.2 source under
tool/src/main/antlr3/org/antlr/grammar/v3/ANTLRv3.g.  The version 2
grammar is available under
tool/src/main/antlr2/org/antlr/grammar/v2/antlr.g.

The rule that I quoted in my response is also from the v3 grammar.

If I were to guess, I'd say that the feature you reference in v2 is
probably making a comeback in version 3, but that's guess. I gave it a
cursory test in ANTLRWorks 1.3.0 and didn't see a visible difference
in the AST/Parse Tree.

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

From gwlist at grahamwideman.com  Tue Oct  6 15:51:46 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 06 Oct 2009 15:51:46 -0700
Subject: [antlr-interest] Why BANG after rule id ?
Message-ID: <4.1.20091006155029.02cf4be8@grahamwideman.com>

Hi Kaleb and Kirby,

Thanks for taking a look at this. Like you both, I did not find this documented anywhere.

The grammar fragment that I showed as an example (rule range) was from the ANTLR v3 grammar, and is itself a v3 grammar, and ANTLR 3 processes it with no complaint.

Kaleb quotes the relevant part of the v3 grammar that shows the "!" being accepted.  But if you look at that rule, what does it do when it recognizes the "!" ?  The way I read it, it does nothing, or am I missing something that happens automatically or by some other means?

I inspected the code that ANTLR3 generates for the rule "rule", and I see where the '!' is recognized, and where it's matched (consumed) but the code seems to do nothing with that info.

I too am unsure whether this grammar is the actual spec that ANTLR 3 uses, so I ran ANTLR 3 on the ANTLR v3 grammar with "range!" changed to "range", and this seemed to make no difference in code generated for the range rule, aside from changes in variable numbers (which thus gives a lot of diff results, so easy to overlook something).

Anyhow, it looks to me like a '!' in this position is recognized but ignored -- either a vestige of a no-longer active feature, or an anticipation of a future feature?

-- Graham

=============================
rule
scope {
  String name;
}
  : DOC_COMMENT?
    ( modifier=('protected'|'public'|'private'|'fragment') )?
    id {$rule::name = $id.text;}
    '!'?
    ( arg=ARG_ACTION )?
    ( 'returns' rt=ARG_ACTION  )?
    throwsSpec? optionsSpec? ruleScopeSpec? ruleAction*
   ':' altList ';'
    exceptionGroup?
    -> ^( RULE id {modifier!=null?adaptor.create(modifier):null} 
          ^(ARG[$arg] $arg)?
          ^('returns' $rt)?
          throwsSpec? optionsSpec? ruleScopeSpec? ruleAction*
          altList
          exceptionGroup?
          EOR["EOR"]
        )
;


From naveen.chwl at googlemail.com  Tue Oct  6 16:03:11 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Wed, 7 Oct 2009 00:03:11 +0100
Subject: [antlr-interest] Help writing a particular semantic predicate
In-Reply-To: <56eb2660910061502w319965dbr24aaaa4c62320d86@mail.gmail.com>
References: <56eb2660910061502w319965dbr24aaaa4c62320d86@mail.gmail.com>
Message-ID: <56eb2660910061603q40aa2f1en7e08557fca4cc458@mail.gmail.com>

Ok, I've solved my particular problem using token lookaheads, but I was
wondering if there is a way of doing non-terminal symbol lookaheads in
semantic predicates?

2009/10/6 Naveen Chawla <naveen.chwl at googlemail.com>

> grammar x;
>
> x:  a b;
>
>      a: 'i' a? | c? 'j';     // Question, how would I write the semantic
> predicates: if this "a" is followed by 'v1' choose the first alternative, if
> not choose the second alternative
>
>           c: 'i';
>
>      b: 'v1' | 'v2';
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/e0dfd765/attachment.html 

From indhu.b at s7software.com  Tue Oct  6 19:49:21 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Wed, 7 Oct 2009 08:19:21 +0530
Subject: [antlr-interest] Help writing a particular semantic predicate
In-Reply-To: <56eb2660910061603q40aa2f1en7e08557fca4cc458@mail.gmail.com>
References: <56eb2660910061502w319965dbr24aaaa4c62320d86@mail.gmail.com>
	<56eb2660910061603q40aa2f1en7e08557fca4cc458@mail.gmail.com>
Message-ID: <004b01ca46f8$c596d270$50c47750$@b@s7software.com>

In that case you have to use syntactic predicate.

 

Cheers, Indhu

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Wednesday, October 07, 2009 4:33 AM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Help writing a particular semantic predicate

 

Ok, I've solved my particular problem using token lookaheads, but I was
wondering if there is a way of doing non-terminal symbol lookaheads in
semantic predicates?

2009/10/6 Naveen Chawla <naveen.chwl at googlemail.com>

grammar x;

 

x:  a b;

 

     a: 'i' a? | c? 'j';     // Question, how would I write the semantic
predicates: if this "a" is followed by 'v1' choose the first alternative, if
not choose the second alternative

 

          c: 'i';

 

     b: 'v1' | 'v2';

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/01b3fa31/attachment.html 

From darien at technofovea.com  Tue Oct  6 22:54:01 2009
From: darien at technofovea.com (Darien A Hager)
Date: Tue, 06 Oct 2009 22:54:01 -0700
Subject: [antlr-interest] Tree parser action only gets text for first token
	in rule
Message-ID: <4ACC2CF9.2020109@technofovea.com>

My tree-parser is finding the right structure, but I'm getting 
unexpected results where I want the text (in a rule) of an entire 
subtree, but instead get the text of the very first token. When I had 
this as a unified grammar, it seemed to work OK. Here's the grammar in 
my tree parser that doesn't seem to be working.

______________
keyval[Node selfNode]      :    ^(KV ^(KEY k=text) ^(VALUE v=text))
   {
       selfNode.addAttribute($k.text,$v.text);
   }
   ;

text
   :    QSTRING|(CHAR+)      ;
______________

In my custom Node class, instead of getting an attribute of of k1 = v1, 
only the very first CHAR token comes through in the rule, yielding k=v, 
even though it seems the entire thing was matched. So in the real world, 
the pairing Classname=SomeClass becomes C=S. I'm not sure if I'm missing 
some magic in how I invoke things in the Java runtime, or whether it's a 
grammar issue.

Here's more details. The test case input data, a key/value pair:
____________________________________________
k1    v1
____________________________________________

This is lexed and turned into an AST. Here's the stream of token names 
and text values the tree-parser gets as its' input, with the text value 
of each character:
____________________________________________
KV
DOWN
KEY
DOWN
CHAR    k
CHAR    1
UP
VALUE
DOWN
CHAR    v
CHAR    1
UP
UP
____________________________________________

I've tried breaking it off into it's own rule and using $rulename.text, 
all sorts of things. Lastly, here's the example Java runtime set-up in 
case I'm using the wrong subclass somewhere:

_____________________________________________
       InputStream is = 
this.getClass().getResourceAsStream(TEST_DATA_FILE);
       // Do lexing
       CharStream cs = new ANTLRInputStream(is);
       BaseValveFormatLexer lexer = new BaseValveFormatLexer(cs);
       //printTokens(lexer);

       // Build AST of this "keyval" rule
       CommonTokenStream tokens = new CommonTokenStream(); 
//TokenRewriteStream?
       tokens.setTokenSource(lexer);
       BaseValveFormat parser = new BaseValveFormat(tokens);
       BaseValveFormat.keyval_return ret = parser.keyval();

       // Set up for sending to tree parser:
       CommonTree tree = (CommonTree) ret.getTree();
       //printTree(tree,0);
       CommonTreeNodeStream ctns = new CommonTreeNodeStream(tree);
       ctns.setTokenStream(parser.getTokenStream());
       //printTreeNodes(ctns);

       // Start traversal of the keyval AST section, modifying our 
"Node" element
       BaseValveFormatWalker walker = new BaseValveFormatWalker(ctns);
       Node n = new Node();
       walker.keyval(n);

       System.out.println(n.getAttributes()); // Print the wrong thing. :(
______________________________________________

Thanks in advance,
--Darien A. Hager.




From dmarin at sice.com  Wed Oct  7 03:38:30 2009
From: dmarin at sice.com (=?iso-8859-1?Q?David_Mar=EDn_Carre=F1o?=)
Date: Wed, 7 Oct 2009 12:38:30 +0200
Subject: [antlr-interest] How to stop tree-parsing
Message-ID: <6F67E43066DC4AC7BC787595D7078019@PDMCSICALC>

I am developing a formula evaluation software, using an ANTLR lexer, parser
and tree-parser.

I have some doubts about how to specify grammar and semantic actions for a
?return? clause.
Now, a return clause is specified as ^(RETURN expression).

Is there any easy way for stopping tree-parsing and return a value to the
caller?

Thanks a lot
--
David Mar?n Carre?o 
S.I.C.E. 
Direcci?n T?cnica. 
Tfno 91 623 22 30
E-mail: dmarin at sice.com
?




From bahler at research.telcordia.com  Wed Oct  7 07:18:39 2009
From: bahler at research.telcordia.com (Lisa Bahler)
Date: Wed, 07 Oct 2009 10:18:39 -0400
Subject: [antlr-interest] C++ grammar for ANTLR v3 ?
Message-ID: <4ACCA33F.6010708@research.telcordia.com>

I'm looking for a C++ grammar for ANTLR v3.  Does one exist?  If not 
yet, what is the status?



From jimi at temporal-wave.com  Wed Oct  7 07:36:18 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Oct 2009 07:36:18 -0700
Subject: [antlr-interest] Help writing a particular semantic predicate
In-Reply-To: <56eb2660910061603q40aa2f1en7e08557fca4cc458@mail.gmail.com>
Message-ID: <ebd52a801b03aa478ab71d69af5b739f@temporal-wave.com>

Actually, your approach is wrong here. What you want to aim at in the parser is to accept all the syntax that can possibly be good but if it is not, can be rejected using semantic checks later. This is because a good semantic error such as "not able to use 'v2' when you utilize 'b'" is much more useful to your user than "Unexpected token 'v2' at....". Doing this will also simplify your grammar and usually make it a lot faster. So, just allow either of the options, set a flag and print the error message if it is incorrect. Then you have implemented only the syntax you wish in a much cleaner way. If you are producing an AST then it is usually easier to check for these things in a special semantic pass of the AST.

 

Jim 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Tuesday, October 06, 2009 4:03 PM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Help writing a particular semantic predicate

 

Ok, I've solved my particular problem using token lookaheads, but I was wondering if there is a way of doing non-terminal symbol lookaheads in semantic predicates?

2009/10/6 Naveen Chawla <naveen.chwl at googlemail.com>

grammar x;

 

x:  a b;

 

     a: 'i' a? | c? 'j';     // Question, how would I write the semantic predicates: if this "a" is followed by 'v1' choose the first alternative, if not choose the second alternative

 

          c: 'i';

 

     b: 'v1' | 'v2';

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/3b9c5729/attachment.html 

From yurushkin at rambler.ru  Wed Oct  7 08:19:34 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Wed, 07 Oct 2009 19:19:34 +0400
Subject: [antlr-interest] [c target]  tracing
In-Reply-To: <20091005205115.5981F89A48A@mx22.rambler.ru>
References: <op.u08uuaokt3jqlu@win-mupvrp0jyrf>
	<20091003230457.E988410AA840@mx17.rambler.ru>
	<op.u09l1pbnt3jqlu@win-mupvrp0jyrf>
	<20091004201235.46E36D858C7@mx21.rambler.ru>
	<op.u1apijeqt3jqlu@win-mupvrp0jyrf>
	<20091005205115.5981F89A48A@mx22.rambler.ru>
Message-ID: <op.u1friwngt3jqlu@win-mupvrp0jyrf>

Use C traget.
Have added -trace option... But it have generated JAVA code for every rule

"System.out.println("exit entity_decl "+LT(1)+" failed="+failed+"  
backtracking="+BACKTRACKING);"

??? why java not C?

What about -debug option? It's also not working (see my last message).  
Could u write small tutorial with examples. Without them it's difficult yo  
use your system for C target.

have a nice working day,
Michael

From jimi at temporal-wave.com  Wed Oct  7 08:27:32 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Oct 2009 08:27:32 -0700
Subject: [antlr-interest] [c target]  tracing
In-Reply-To: <op.u1friwngt3jqlu@win-mupvrp0jyrf>
Message-ID: <dea30eeced32b349b60170c6985bfccd@temporal-wave.com>

Debug should work OK from a parser but tree parser debugging probably isn't too hot. Up to press nobody has really needed to use it. The trace option isn't really implemented but the conditionals are still in the template so that I can come back to it some day. In general I find it more useful to debug the generated C code with a good C level debugger. VS2008 is a great debugger and the Netbeans C project interfacing to the GNU debugger is getting better with every release. Using the C level debugger (especially VS2008) lets you examine all the data structures too.


I will get to fixing up those features, but have not had any time to do so lately. Sorry about that.

Jim



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of ??????? ??????
> Sent: Wednesday, October 07, 2009 8:20 AM
> To: Gavin Lambert; antlr-interest at antlr.org
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] [c target] tracing
> 
> Use C traget.
> Have added -trace option... But it have generated JAVA code for every
> rule
> 
> "System.out.println("exit entity_decl "+LT(1)+" failed="+failed+"
> backtracking="+BACKTRACKING);"
> 
> ??? why java not C?
> 
> What about -debug option? It's also not working (see my last message).
> Could u write small tutorial with examples. Without them it's difficult
> yo
> use your system for C target.
> 
> have a nice working day,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From ellery-newcomer at utulsa.edu  Wed Oct  7 10:41:09 2009
From: ellery-newcomer at utulsa.edu (Ellery Newcomer)
Date: Wed, 7 Oct 2009 12:41:09 -0500
Subject: [antlr-interest] Why BANG after rule id ?
In-Reply-To: <4.1.20091006155029.02cf4be8@grahamwideman.com>
References: <4.1.20091006155029.02cf4be8@grahamwideman.com>
Message-ID: <9a9b08180910071041h12a1657y88fd630858aafb3@mail.gmail.com>

On Tue, Oct 6, 2009 at 5:51 PM, Graham Wideman <gwlist at grahamwideman.com>wrote:

>
> Anyhow, it looks to me like a '!' in this position is recognized but
> ignored -- either a vestige of a no-longer active feature, or an
> anticipation of a future feature?
>
> -- Graham
>
>
In ANTLR v2, it turns off AST construction for the entire rule, which is
necessary if you're building the AST for that rule entirely by hand.
Guessing v3 is smart enough not to need it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/0125ad0b/attachment.html 

From jimi at temporal-wave.com  Wed Oct  7 11:15:12 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Oct 2009 11:15:12 -0700
Subject: [antlr-interest] MSBUILD/Vs2008
Message-ID: <cacca9fab7c0d348a904246add55b329@temporal-wave.com>

Has anyone worked out the exact configuration for MSBUILD instructions for adding in to csproj files in VS2008 with the C# target? The Wiki version may have worked fine for VS2005 but in VS2008 it does not encapsulate dependencies properly and the .cs files get compiled before the .g files, which means you have to build twice. Also, it does not cover 'clean' and 'rebuild' etc. I suspect that this is easy to work out for someone that already knows MSBUILD well, but I don't and don't particularly want to spend the time doing so right now ;-)

 

Cheers,

 

Jim



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/f41a2567/attachment.html 

From sharwell at pixelminegames.com  Wed Oct  7 11:28:32 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Wed, 7 Oct 2009 13:28:32 -0500
Subject: [antlr-interest] MSBUILD/Vs2008
In-Reply-To: <cacca9fab7c0d348a904246add55b329@temporal-wave.com>
References: <cacca9fab7c0d348a904246add55b329@temporal-wave.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A0123F4B5@Bloodymary.ironwillgames.com>

I disabled the clean due to problems with P4 having the generated files
readonly on disk. You can use it as a base for future improvements if
you want.

 

This forces the correct build order so you only have to build once (I
included the import line just so you see where I placed it). This
configuration uses the C# port of the tool to generate grammars.

 

  <PropertyGroup>

    <!-- This forces the correct build order since ANTLR tool generates
.cs files -->

    <UseHostCompilerIfAvailable>False</UseHostCompilerIfAvailable>

  </PropertyGroup>

  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />

  <PropertyGroup>

 
<Antlr3ToolPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</Antlr3ToolP
ath>

 
<CoreCompileDependsOn>$(CoreCompileDependsOn);GenerateAntlrCode</CoreCom
pileDependsOn>

 
<CoreCleanDependsOn>$(CoreCleanDependsOn);CleanAntlrCode</CoreCleanDepen
dsOn>

    <PostBuildEvent>

    </PostBuildEvent>

  </PropertyGroup>

  <Target Name="GenerateAntlrCode" Inputs="@(Antlr3)"
Outputs="%(OutputFiles)">

    <Message Importance="normal" Text="Antlr: Transforming '@(Antlr3)'
to '%(Antlr3.OutputFiles)'" />

    <!--<Exec Command="java -cp
%22$(Antlr3ToolPath)\antlr3.jar;$(Antlr3ToolPath)\antlr-2.7.7.jar;$(Antl
r3ToolPath)\stringtemplate-3.1b1.jar%22 org.antlr.Tool -lib
%22%(RootDir)%(Directory).%22 -message-format vs2005 @(Antlr3)"
Outputs="%(OutputFiles)" />-->

    <Exec Command="%22$(Antlr3ToolPath)\Antlr3.exe%22
-Xconversiontimeout 5000 -lib %22%(RootDir)%(Directory).%22
-message-format vs2005 @(Antlr3)" Outputs="%(OutputFiles)" />

  </Target>

  <Target Name="CleanAntlrCode">

    <ItemGroup>

      <_CleanAntlrFileWrites
Include="@(Antlr3->'%(RelativeDir)%(Filename).tokens')" />

    </ItemGroup>

    <Message Importance="normal" Text="Antlr: Deleting output files
'@(_CleanAntlrFileWrites)'" />

    <!-- NOT FULLY TESTED: Uncomment this line to actually delete
grammar outputs on clean. -->

    <!--<Delete Files="@(_CleanAntlrFileWrites)" />-->

  </Target>

 

Here is my msbuild items for a lexer grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ActionAnalysisLexer.g3">

 
<OutputFiles>Grammars\ActionAnalysisLexer.cs;Grammars\ActionAnalysisLexe
r.tokens</OutputFiles>

    </Antlr3>

    <Compile Include="Grammars\ActionAnalysisLexer.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ActionAnalysisLexer.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ActionAnalysisLexerHelper.cs">

      <DependentUpon>ActionAnalysisLexer.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

For a combined grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ANTLR.g3">

 
<OutputFiles>Grammars\ANTLRParser.cs;Grammars\ANTLRLexer.cs;Grammars\ANT
LR.tokens</OutputFiles>

      <CopyToOutputDirectory>Always</CopyToOutputDirectory>

    </Antlr3>

    <Compile Include="Grammars\ANTLRParser.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRParserHelper.cs">

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRLexer.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRLexerHelper.cs">

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

A tree grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ANTLRTreePrinter.g3">

 
<OutputFiles>Grammars\ANTLRTreePrinter.cs;Grammars\ANTLRTreePrinter.toke
ns</OutputFiles>

    </Antlr3>

    <Compile Include="Grammars\ANTLRTreePrinter.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLRTreePrinter.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRTreePrinterHelper.cs">

      <DependentUpon>ANTLRTreePrinter.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

Sam

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Wednesday, October 07, 2009 1:15 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] MSBUILD/Vs2008

 

Has anyone worked out the exact configuration for MSBUILD instructions
for adding in to csproj files in VS2008 with the C# target? The Wiki
version may have worked fine for VS2005 but in VS2008 it does not
encapsulate dependencies properly and the .cs files get compiled before
the .g files, which means you have to build twice. Also, it does not
cover 'clean' and 'rebuild' etc. I suspect that this is easy to work out
for someone that already knows MSBUILD well, but I don't and don't
particularly want to spend the time doing so right now ;-)

 

Cheers,

 

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/1b0642c5/attachment.html 

From sharwell at pixelminegames.com  Wed Oct  7 11:29:50 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Wed, 7 Oct 2009 13:29:50 -0500
Subject: [antlr-interest] C++ grammar for ANTLR v3 ?
In-Reply-To: <4ACCA33F.6010708@research.telcordia.com>
References: <4ACCA33F.6010708@research.telcordia.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A0123F4B6@Bloodymary.ironwillgames.com>

The only complete working grammar for ANTLR v3 written in ANTLR v3 is
the set of grammars in my C# port, and they use the CSharp3 target. The
C# port of the ANTLR tool uses these grammars internally for all its
processing, so they are tested working. It would take a significant
amount of work to port them to C++ due to the fact that they rely
heavily on the rest of the ANTLR tool's code for processing the
information gathered in parsing.

There is another ANTLR v3 grammar written in ANTLR v3 targeting Java (I
believe), but I'm not sure what its status is. I do know it's not the
primary grammar used in the Java version of the tool.

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lisa Bahler
Sent: Wednesday, October 07, 2009 9:19 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] C++ grammar for ANTLR v3 ?

I'm looking for a C++ grammar for ANTLR v3.  Does one exist?  If not 
yet, what is the status?



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jimi at temporal-wave.com  Wed Oct  7 11:34:19 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Oct 2009 11:34:19 -0700
Subject: [antlr-interest] MSBUILD/Vs2008
In-Reply-To: <86403CA0939415448BCCB83855EFE09A0123F4B5@Bloodymary.ironwillgames.com>
Message-ID: <b765ef554653da47a8f1f3f70ea2cfa4@temporal-wave.com>

Cool. Perhps you can put this in the Wiki artivcle?

 

One question - when I have 3 grammar files in the project, is that just the one ItemGroup or multiple, one per .g file?

 

Jim

 

From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: Wednesday, October 07, 2009 11:29 AM
To: Jim Idle; antlr-interest at antlr.org
Subject: RE: [antlr-interest] MSBUILD/Vs2008

 

I disabled the clean due to problems with P4 having the generated files readonly on disk. You can use it as a base for future improvements if you want.

 

This forces the correct build order so you only have to build once (I included the import line just so you see where I placed it). This configuration uses the C# port of the tool to generate grammars.

 

  <PropertyGroup>

    <!-- This forces the correct build order since ANTLR tool generates .cs files -->

    <UseHostCompilerIfAvailable>False</UseHostCompilerIfAvailable>

  </PropertyGroup>

  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />

  <PropertyGroup>

    <Antlr3ToolPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</Antlr3ToolPath>

    <CoreCompileDependsOn>$(CoreCompileDependsOn);GenerateAntlrCode</CoreCompileDependsOn>

    <CoreCleanDependsOn>$(CoreCleanDependsOn);CleanAntlrCode</CoreCleanDependsOn>

    <PostBuildEvent>

    </PostBuildEvent>

  </PropertyGroup>

  <Target Name="GenerateAntlrCode" Inputs="@(Antlr3)" Outputs="%(OutputFiles)">

    <Message Importance="normal" Text="Antlr: Transforming '@(Antlr3)' to '%(Antlr3.OutputFiles)'" />

    <!--<Exec Command="java -cp %22$(Antlr3ToolPath)\antlr3.jar;$(Antlr3ToolPath)\antlr-2.7.7.jar;$(Antlr3ToolPath)\stringtemplate-3.1b1.jar%22 org.antlr.Tool -lib %22%(RootDir)%(Directory).%22 -message-format vs2005 @(Antlr3)" Outputs="%(OutputFiles)" />-->

    <Exec Command="%22$(Antlr3ToolPath)\Antlr3.exe%22 -Xconversiontimeout 5000 -lib %22%(RootDir)%(Directory).%22 -message-format vs2005 @(Antlr3)" Outputs="%(OutputFiles)" />

  </Target>

  <Target Name="CleanAntlrCode">

    <ItemGroup>

      <_CleanAntlrFileWrites Include="@(Antlr3->'%(RelativeDir)%(Filename).tokens')" />

    </ItemGroup>

    <Message Importance="normal" Text="Antlr: Deleting output files '@(_CleanAntlrFileWrites)'" />

    <!-- NOT FULLY TESTED: Uncomment this line to actually delete grammar outputs on clean. -->

    <!--<Delete Files="@(_CleanAntlrFileWrites)" />-->

  </Target>

 

Here is my msbuild items for a lexer grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ActionAnalysisLexer.g3">

      <OutputFiles>Grammars\ActionAnalysisLexer.cs;Grammars\ActionAnalysisLexer.tokens</OutputFiles>

    </Antlr3>

    <Compile Include="Grammars\ActionAnalysisLexer.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ActionAnalysisLexer.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ActionAnalysisLexerHelper.cs">

      <DependentUpon>ActionAnalysisLexer.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

For a combined grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ANTLR.g3">

      <OutputFiles>Grammars\ANTLRParser.cs;Grammars\ANTLRLexer.cs;Grammars\ANTLR.tokens</OutputFiles>

      <CopyToOutputDirectory>Always</CopyToOutputDirectory>

    </Antlr3>

    <Compile Include="Grammars\ANTLRParser.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRParserHelper.cs">

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRLexer.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRLexerHelper.cs">

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

A tree grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ANTLRTreePrinter.g3">

      <OutputFiles>Grammars\ANTLRTreePrinter.cs;Grammars\ANTLRTreePrinter.tokens</OutputFiles>

    </Antlr3>

    <Compile Include="Grammars\ANTLRTreePrinter.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLRTreePrinter.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRTreePrinterHelper.cs">

      <DependentUpon>ANTLRTreePrinter.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

Sam

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Wednesday, October 07, 2009 1:15 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] MSBUILD/Vs2008

 

Has anyone worked out the exact configuration for MSBUILD instructions for adding in to csproj files in VS2008 with the C# target? The Wiki version may have worked fine for VS2005 but in VS2008 it does not encapsulate dependencies properly and the .cs files get compiled before the .g files, which means you have to build twice. Also, it does not cover 'clean' and 'rebuild' etc. I suspect that this is easy to work out for someone that already knows MSBUILD well, but I don't and don't particularly want to spend the time doing so right now ;-)

 

Cheers,

 

Jim



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/05fd65d1/attachment.html 

From jimi at temporal-wave.com  Wed Oct  7 11:39:21 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Oct 2009 11:39:21 -0700
Subject: [antlr-interest] C++ grammar for ANTLR v3 ?
In-Reply-To: <86403CA0939415448BCCB83855EFE09A0123F4B6@Bloodymary.ironwillgames.com>
Message-ID: <878b7c83020c2f42b2ec7f377474006d@temporal-wave.com>

I think that the OP meant is there a set of grammars that parse C++, but are written for ANTLR v3 rather than v2? As far as I know, the answer is no. C++ is not the easiest thing to parse and it cannot be done purely with grammar.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Sam Harwell
> Sent: Wednesday, October 07, 2009 11:30 AM
> To: bahler at research.telcordia.com; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] C++ grammar for ANTLR v3 ?
> 
> The only complete working grammar for ANTLR v3 written in ANTLR v3 is
> the set of grammars in my C# port, and they use the CSharp3 target. The
> C# port of the ANTLR tool uses these grammars internally for all its
> processing, so they are tested working. It would take a significant
> amount of work to port them to C++ due to the fact that they rely
> heavily on the rest of the ANTLR tool's code for processing the
> information gathered in parsing.
> 
> There is another ANTLR v3 grammar written in ANTLR v3 targeting Java (I
> believe), but I'm not sure what its status is. I do know it's not the
> primary grammar used in the Java version of the tool.
> 
> Sam
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lisa Bahler
> Sent: Wednesday, October 07, 2009 9:19 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] C++ grammar for ANTLR v3 ?
> 
> I'm looking for a C++ grammar for ANTLR v3.  Does one exist?  If not
> yet, what is the status?
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From antlr at mirality.co.nz  Wed Oct  7 13:33:36 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 08 Oct 2009 09:33:36 +1300
Subject: [antlr-interest] Unit testing grammar productions and injecting
 EOF
In-Reply-To: <f14c01620910051337u6606bcc7k50bee7273cc2a8bd@mail.gmail.co
 m>
References: <f14c01620910051337u6606bcc7k50bee7273cc2a8bd@mail.gmail.com>
Message-ID: <20091007203403.EA6A1341840D@www.antlr.org>

At 09:37 6/10/2009, Kaleb Pederson wrote:
 >After some investigation, I found that the reason for the
 >failure was that EOF wasn't in the expected follow set,
 >which makes sense when I'm parsing the whole language.
 >
 >As a workaround, I changed my production, adding EOF as an
 >optional terminal as follows:
 >
 >objectMember : functionExpression EOF? | ID EOF?;
 >
 >Everything now works but I'm curious if a better solution for
 >testing individual grammar productions exists.  Suggestions or
 >alternatives?

Well, for starters, that rule above is better expressed like this:

objectMember : (functionExpression | ID) EOF? ;

Also, I haven't tested this, but you could try leaving the 
original rule unmodified and then adding another rule like so (not 
called by anything):

test : (objectMember | everyOtherRuleToTest) EOF ;

Then just call the original method (objectMember) in your unit 
tests.  That might do the trick.


From kaleb.pederson at gmail.com  Wed Oct  7 13:51:37 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Wed, 7 Oct 2009 13:51:37 -0700
Subject: [antlr-interest] Best practices for AST building
Message-ID: <f14c01620910071351i532995fdwb710ad2110a71e46@mail.gmail.com>

Can anybody recommend some good links to best practices for AST building?

In the past, I've manually built heterogeneous trees via the actions
associated with various productions.  This works, but I'm hoping to
find something better.

I've been looking at the ANTLR examples and how they generate ASTs,
but I haven't yet decided if they all or some subset of them represent
best practices or not.  I've yet to take a look at Mantra, but am
going to do that as next.

Other suggestions?

Thanks.

--Kaleb

http://twitter.com/kalebpederson
http://kalebpederson.com

From sharwell at pixelminegames.com  Wed Oct  7 16:20:16 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Wed, 7 Oct 2009 18:20:16 -0500
Subject: [antlr-interest] MSBUILD/Vs2008
In-Reply-To: <b765ef554653da47a8f1f3f70ea2cfa4@temporal-wave.com>
References: <86403CA0939415448BCCB83855EFE09A0123F4B5@Bloodymary.ironwillgames.com>
	<b765ef554653da47a8f1f3f70ea2cfa4@temporal-wave.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A0123F4C6@Bloodymary.ironwillgames.com>

I like to keep one item group for each of the files, but neither order
nor grouping make a difference in functionality.

 

I didn't make a wiki article because it still seems makeshift support.
I'd like to finish the following first:

 

*         Improve the build dependency detection, especially for
grammars that depend on the .tokens file from other grammars.

*         Create a working Clean target (which carries over to Rebuild).
For this to work with source control, I need to make sure that:

o   The generated code files are not written to disk if their contents
haven't changed.

o   The same source file always generates the same output file, which
means removing relative paths and timestamps from the comments.

*         Create a Visual Studio template for adding a grammar to the
project without editing the project file manually. If this doesn't work
as well as I'd like, I would integrate the full functionality into my
Visual Studio language service for ANTLR and StringTemplate
<http://wiki.pixelminegames.com/index.php?title=Tools:nFringe:Antlr:Feat
ures> .

 

Sam

 

From: Jim Idle [mailto:jimi at temporal-wave.com] 
Sent: Wednesday, October 07, 2009 1:34 PM
To: Sam Harwell; antlr-interest at antlr.org
Subject: RE: [antlr-interest] MSBUILD/Vs2008

 

Cool. Perhps you can put this in the Wiki artivcle?

 

One question - when I have 3 grammar files in the project, is that just
the one ItemGroup or multiple, one per .g file?

 

Jim

 

From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: Wednesday, October 07, 2009 11:29 AM
To: Jim Idle; antlr-interest at antlr.org
Subject: RE: [antlr-interest] MSBUILD/Vs2008

 

I disabled the clean due to problems with P4 having the generated files
readonly on disk. You can use it as a base for future improvements if
you want.

 

This forces the correct build order so you only have to build once (I
included the import line just so you see where I placed it). This
configuration uses the C# port of the tool to generate grammars.

 

  <PropertyGroup>

    <!-- This forces the correct build order since ANTLR tool generates
.cs files -->

    <UseHostCompilerIfAvailable>False</UseHostCompilerIfAvailable>

  </PropertyGroup>

  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />

  <PropertyGroup>

 
<Antlr3ToolPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</Antlr3ToolP
ath>

 
<CoreCompileDependsOn>$(CoreCompileDependsOn);GenerateAntlrCode</CoreCom
pileDependsOn>

 
<CoreCleanDependsOn>$(CoreCleanDependsOn);CleanAntlrCode</CoreCleanDepen
dsOn>

    <PostBuildEvent>

    </PostBuildEvent>

  </PropertyGroup>

  <Target Name="GenerateAntlrCode" Inputs="@(Antlr3)"
Outputs="%(OutputFiles)">

    <Message Importance="normal" Text="Antlr: Transforming '@(Antlr3)'
to '%(Antlr3.OutputFiles)'" />

    <!--<Exec Command="java -cp
%22$(Antlr3ToolPath)\antlr3.jar;$(Antlr3ToolPath)\antlr-2.7.7.jar;$(Antl
r3ToolPath)\stringtemplate-3.1b1.jar%22 org.antlr.Tool -lib
%22%(RootDir)%(Directory).%22 -message-format vs2005 @(Antlr3)"
Outputs="%(OutputFiles)" />-->

    <Exec Command="%22$(Antlr3ToolPath)\Antlr3.exe%22
-Xconversiontimeout 5000 -lib %22%(RootDir)%(Directory).%22
-message-format vs2005 @(Antlr3)" Outputs="%(OutputFiles)" />

  </Target>

  <Target Name="CleanAntlrCode">

    <ItemGroup>

      <_CleanAntlrFileWrites
Include="@(Antlr3->'%(RelativeDir)%(Filename).tokens')" />

    </ItemGroup>

    <Message Importance="normal" Text="Antlr: Deleting output files
'@(_CleanAntlrFileWrites)'" />

    <!-- NOT FULLY TESTED: Uncomment this line to actually delete
grammar outputs on clean. -->

    <!--<Delete Files="@(_CleanAntlrFileWrites)" />-->

  </Target>

 

Here is my msbuild items for a lexer grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ActionAnalysisLexer.g3">

 
<OutputFiles>Grammars\ActionAnalysisLexer.cs;Grammars\ActionAnalysisLexe
r.tokens</OutputFiles>

    </Antlr3>

    <Compile Include="Grammars\ActionAnalysisLexer.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ActionAnalysisLexer.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ActionAnalysisLexerHelper.cs">

      <DependentUpon>ActionAnalysisLexer.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

For a combined grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ANTLR.g3">

 
<OutputFiles>Grammars\ANTLRParser.cs;Grammars\ANTLRLexer.cs;Grammars\ANT
LR.tokens</OutputFiles>

      <CopyToOutputDirectory>Always</CopyToOutputDirectory>

    </Antlr3>

    <Compile Include="Grammars\ANTLRParser.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRParserHelper.cs">

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRLexer.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRLexerHelper.cs">

      <DependentUpon>ANTLR.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

A tree grammar:

 

  <ItemGroup>

    <Antlr3 Include="Grammars\ANTLRTreePrinter.g3">

 
<OutputFiles>Grammars\ANTLRTreePrinter.cs;Grammars\ANTLRTreePrinter.toke
ns</OutputFiles>

    </Antlr3>

    <Compile Include="Grammars\ANTLRTreePrinter.cs">

      <AutoGen>True</AutoGen>

      <DesignTime>True</DesignTime>

      <DependentUpon>ANTLRTreePrinter.g3</DependentUpon>

    </Compile>

    <Compile Include="Grammars\ANTLRTreePrinterHelper.cs">

      <DependentUpon>ANTLRTreePrinter.g3</DependentUpon>

    </Compile>

  </ItemGroup>

 

Sam

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Wednesday, October 07, 2009 1:15 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] MSBUILD/Vs2008

 

Has anyone worked out the exact configuration for MSBUILD instructions
for adding in to csproj files in VS2008 with the C# target? The Wiki
version may have worked fine for VS2005 but in VS2008 it does not
encapsulate dependencies properly and the .cs files get compiled before
the .g files, which means you have to build twice. Also, it does not
cover 'clean' and 'rebuild' etc. I suspect that this is easy to work out
for someone that already knows MSBUILD well, but I don't and don't
particularly want to spend the time doing so right now ;-)

 

Cheers,

 

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/2321e9db/attachment.html 

From bluedoze+antlr at gmail.com  Wed Oct  7 16:42:42 2009
From: bluedoze+antlr at gmail.com (Blue Doze)
Date: Wed, 7 Oct 2009 16:42:42 -0700
Subject: [antlr-interest] ambiguous grammar???
Message-ID: <9a4a22410910071642h6f81a443w4a2cdb16f7c41ae6@mail.gmail.com>

Hi,

I have a couple of rules that I don't know how to make them not ambiguous

First rule is:
STRING_LITERAL
    :  '"' ( EscapeSequence | ~('\\'|'"') )* '"'
    ;


The second one is:

math_formula :  '"' expression '"' ;

The expression rule is similar to C expression rule.

Appreciate any help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/7f20f3ba/attachment.html 

From bluedoze+antlr at gmail.com  Wed Oct  7 17:23:22 2009
From: bluedoze+antlr at gmail.com (Blue Doze)
Date: Wed, 7 Oct 2009 17:23:22 -0700
Subject: [antlr-interest] ambiguous grammar???
In-Reply-To: <9a4a22410910071642h6f81a443w4a2cdb16f7c41ae6@mail.gmail.com>
References: <9a4a22410910071642h6f81a443w4a2cdb16f7c41ae6@mail.gmail.com>
Message-ID: <9a4a22410910071723y29a675f5p256a089e4cb2be4b@mail.gmail.com>

More clarification to the rules
the math_forumla will be on the LHS, e.g. for the syntax

"variable_name" = "&array[2]"
where the variable_name shall be a STRING, and the &array[2] shall be an
expression.


On Wed, Oct 7, 2009 at 4:42 PM, Blue Doze
<bluedoze+antlr at gmail.com<bluedoze%2Bantlr at gmail.com>
> wrote:

> Hi,
>
> I have a couple of rules that I don't know how to make them not ambiguous
>
> First rule is:
> STRING_LITERAL
>     :  '"' ( EscapeSequence | ~('\\'|'"') )* '"'
>     ;
>
>
> The second one is:
>
> math_formula :  '"' expression '"' ;
>
> The expression rule is similar to C expression rule.
>
> Appreciate any help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/f221fa5c/attachment.html 

From bluedoze+antlr at gmail.com  Wed Oct  7 17:24:18 2009
From: bluedoze+antlr at gmail.com (Blue Doze)
Date: Wed, 7 Oct 2009 17:24:18 -0700
Subject: [antlr-interest] ambiguous grammar???
In-Reply-To: <9a4a22410910071722l38fb1a18tc1cfa10563192d32@mail.gmail.com>
References: <9a4a22410910071642h6f81a443w4a2cdb16f7c41ae6@mail.gmail.com>
	<9a4a22410910071722l38fb1a18tc1cfa10563192d32@mail.gmail.com>
Message-ID: <9a4a22410910071724w6235db07k39363fe8fe17a003@mail.gmail.com>

Sorry, the math_formula is RHS

On Wed, Oct 7, 2009 at 5:22 PM, Blue Doze <bluedoze at gmail.com> wrote:

> More clarification to the rules
> the math_forumla will be on the LHS, e.g. for the syntax
>
> "variable_name" = "&array[2]"
> where the variable_name shall be a STRING, and the &array[2] shall be an
> expression.
>
>
>
> On Wed, Oct 7, 2009 at 4:42 PM, Blue Doze <bluedoze+antlr at gmail.com<bluedoze%2Bantlr at gmail.com>
> > wrote:
>
>> Hi,
>>
>> I have a couple of rules that I don't know how to make them not ambiguous
>>
>> First rule is:
>> STRING_LITERAL
>>     :  '"' ( EscapeSequence | ~('\\'|'"') )* '"'
>>     ;
>>
>>
>> The second one is:
>>
>> math_formula :  '"' expression '"' ;
>>
>> The expression rule is similar to C expression rule.
>>
>> Appreciate any help.
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091007/c2af1c0f/attachment.html 

From micha-1 at fantasymail.de  Thu Oct  8 07:54:01 2009
From: micha-1 at fantasymail.de (michael)
Date: Thu, 8 Oct 2009 16:54:01 +0200
Subject: [antlr-interest] heterogeneous nodes and tree rewriting
Message-ID: <200910081654.01449.micha-1@fantasymail.de>

I have a tree parser which output a new ast (tree rewriting).
The parser has attached some NodeData to some tree nodes, and one of my tree 
rewrite rules should just copy this node, like:

rule_x: NODE<NodeData> ; /* should copy NodeData, but doesn't */

If I do this then the node data is not duplicated.
If have to do:
rule_x: NODE {
	NodeData d = (NodeData)$NODE;
	} -> NODE<NodeData>[d]
;


I thought the incoming data is copied in case of an empty rule (see 
Tree construction during tree parsing in
http://www.antlr.org/wiki/display/ANTLR3/Tree+construction ) ??

cheers
 Michael

 

From micha-1 at fantasymail.de  Thu Oct  8 08:13:57 2009
From: micha-1 at fantasymail.de (michael)
Date: Thu, 8 Oct 2009 17:13:57 +0200
Subject: [antlr-interest] heterogeneous nodes and tree rewriting
In-Reply-To: <200910081654.01449.micha-1@fantasymail.de>
References: <200910081654.01449.micha-1@fantasymail.de>
Message-ID: <200910081713.57301.micha-1@fantasymail.de>

Am Donnerstag, 8. Oktober 2009 16:54:01 schrieb michael:
> I have a tree parser which output a new ast (tree rewriting).
> The parser has attached some NodeData to some tree nodes, and one of my
> tree rewrite rules should just copy this node, like:

sorry for the noise, it was of cause my bug :-)

 Michael


From gerald at certiv.net  Thu Oct  8 08:31:31 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Thu, 08 Oct 2009 08:31:31 -0700
Subject: [antlr-interest] AntlrDT v1.1.x pre-release
In-Reply-To: <200909210700.n8L70dcT011373@zinc.newtechlaw.com>
References: <200909210700.n8L70dcT011373@zinc.newtechlaw.com>
Message-ID: <200910081531.n98FVcWK010504@zinc.newtechlaw.com>

Second pre-release

www.certiv.net/download/certiv-antlrdt-1.1.1.zip

Changes: http://www.certiv.net/downloads/antlrdtdownload.html
Requirements: http://www.certiv.net/projects/antlrdt.html#requirements

Formatter now also handles/formats all variants of 'scope'

At 12:00 AM 9/21/2009, Gerald Rosenberg wrote:
>A pre-release version of AntlrDT is available for testing:
>
>www.certiv.net/download/certiv-antlrdt-1.1.0.zip
>
>New feature in this release is a hybrid grammar formatter:
>   -- uses a Tree Pattern Matcher-based formatter to format Antlr elements
>   -- uses the JDT platform formatter to format Java elements
>(header/member/action code/etc).
>
>The JDT formatter can be disabled -- Antlr element formatting alone
>should still work with other native languages.
>
>Fair number of formatting style options are implemented (default
>configuration is all-off).  Trying to craft wrapping and alignment
>operations to respect manual formatting choices (read: going slow in
>these areas, trying to figure out what makes sense to do).
>
>Use is standard: ctrl-shift-f to format, ctrl-z to undo, changes show
>in standard fashion in the diff-gutter bar.  Any formatting failures
>are reported in the <eclipse_home>/AntlrDT.log file.
>
>Feedback on stability/failures/further style option controls desired
>would be appreciated.
>
>Gerald
>
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From antlr at mirality.co.nz  Thu Oct  8 12:23:04 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 09 Oct 2009 08:23:04 +1300
Subject: [antlr-interest] MSBUILD/Vs2008
In-Reply-To: <86403CA0939415448BCCB83855EFE09A0123F4C6@Bloodymary.ironwi
	llgames.com>
References: <86403CA0939415448BCCB83855EFE09A0123F4B5@Bloodymary.ironwillgames.com>
	<b765ef554653da47a8f1f3f70ea2cfa4@temporal-wave.com>
	<86403CA0939415448BCCB83855EFE09A0123F4C6@Bloodymary.ironwillgames.com>
Message-ID: <20091008192332.B40AE341840D@www.antlr.org>

At 12:20 8/10/2009, Sam Harwell wrote:
>?         Create a working Clean target (which 
>carries over to Rebuild). For this to work with 
>source control, I need to make sure that:
>o   The generated code files are not written to 
>disk if their contents haven?t changed.
>o   The same source file always generates the 
>same output file, which means removing relative 
>paths and timestamps from the comments.

Or, you know, you could just exclude the 
generated files from source control.  Provided 
that all developers have access to ANTLR (and can 
thus rebuild it) -- which they'd need anyway if 
it's integrated into the project like this -- 
then there's no need for the generated files to 
be in source control.  They can just be 
regenerated whenever required.


From parrt at cs.usfca.edu  Thu Oct  8 14:08:45 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 8 Oct 2009 14:08:45 -0700
Subject: [antlr-interest] any interest in toy version of ST for learning
	purposes?
Message-ID: <2125F8F7-3B4F-418C-B103-BFF8D9A74DD7@cs.usfca.edu>

Hi,

I'm in the process of rebuilding ST from the ground up. The previous  
version works well, but it's hard for me to maintain because it uses a  
tree-based interpreter. Further, it uses v2 ANTLR not v3. In order to  
remove the dependencies in ST and in v3 itself on ANTLR v2, I'm  
rebuilding both (though only the front end of ANTLR). The  
functionality will be effectively the same, with some slight  
differences in syntax. Lots of little things cleaned up and so on.

I'm working in my playground at the moment to create the core of the  
new system before moving back into my repository. I have created a  
very simple bytecode compiler and interpreter that handles the  
canonical operations:

1. attribute reference: <name>, <user.id>
2. template inclusion: <searchbox(args)>
3. map template to attribute(s): <names:bold:italics>
4. conditional inclusion: <if(x)>foo<elseif(y)>bar<else>ick<endif>

The code seems pretty doggone clean to me. It's only when you start  
dealing with separators and auto indentation and anchoring output  
values, that the code becomes difficult to understand. I am about to  
embark on that beast.

Should I cut this version out and make it an example? I don't have any  
text  describing how it works, but there are about 50 unit tests for  
the compiler and interpreter. Would this be useful to people?

Ter

From sharwell at pixelminegames.com  Thu Oct  8 14:20:59 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 8 Oct 2009 16:20:59 -0500
Subject: [antlr-interest] MSBUILD/Vs2008
In-Reply-To: <BLOODYMARYwEMzXgcof00005f58@Bloodymary.ironwillgames.com>
References: <86403CA0939415448BCCB83855EFE09A0123F4B5@Bloodymary.ironwillgames.com>
	<b765ef554653da47a8f1f3f70ea2cfa4@temporal-wave.com>
	<86403CA0939415448BCCB83855EFE09A0123F4C6@Bloodymary.ironwillgames.com>
	<BLOODYMARYwEMzXgcof00005f58@Bloodymary.ironwillgames.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A0123F4CF@Bloodymary.ironwillgames.com>

I thought about that, but then you run into a problem if you want the
generated source files visible in your project. As soon as you add the
files to the project, Visual Studio starts pestering you to add them to
source control. I don't add the .tokens files to source control, but I
generally do like having the *Lexer/*Parser.cs files available. I'm
certainly open to any kind of suggestions (project/MSBUILD targets files
and/or Visual Studio extension ideas for my language service package)
for easing the integration of grammars into Visual C# projects.

Sam

-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Thursday, October 08, 2009 2:23 PM
To: Sam Harwell; Jim Idle; antlr-interest at antlr.org
Subject: Re: [antlr-interest] MSBUILD/Vs2008

At 12:20 8/10/2009, Sam Harwell wrote:
>*         Create a working Clean target (which 
>carries over to Rebuild). For this to work with 
>source control, I need to make sure that:
>o   The generated code files are not written to 
>disk if their contents haven't changed.
>o   The same source file always generates the 
>same output file, which means removing relative 
>paths and timestamps from the comments.

Or, you know, you could just exclude the 
generated files from source control.  Provided 
that all developers have access to ANTLR (and can 
thus rebuild it) -- which they'd need anyway if 
it's integrated into the project like this -- 
then there's no need for the generated files to 
be in source control.  They can just be 
regenerated whenever required.


From ales.teska at gmail.com  Thu Oct  8 14:33:10 2009
From: ales.teska at gmail.com (Ales Teska)
Date: Thu, 8 Oct 2009 23:33:10 +0200
Subject: [antlr-interest] Bug in ANTLR C runtime - Incorrect
	getCharPositionInLine on first line
Message-ID: <99AEB24B-DD53-43C5-A482-5D5E8C0274CB@gmail.com>

Hi,

I'm using ANTLR3 in one of my project and it seems that I found small  
bug in ANTLR C (version 3.2, 3.1.3 is also corrupted).
I do not know if this is correct way of reporting bugs but ...

ANTLR3 C runtime returns incorrect values of CharPositionInLine for  
tokens on first line of input. This is eventually propagated to tokens.
I wrote small program to demonstrate this behavior - it is available  
here: http://devel-www.cyber.cz/files/tmp/antlrc3-bug-pack.zip

Bug causes token stream post-processing a little bit more complicated  
than it can ideally be ...

Here is expected output (produced by Python target).
First character is from input.txt, second is result of  
getCharPositionInLine():

--- cut --- cut --- cut ---
1 0
2 2
3 4
\n 5
1 0
2 2
3 4
\n 5
--- cut --- cut --- cut ---

and here is actual output from C target:

--- cut --- cut --- cut ---
1 4294967295
2 1
3 3
\n 4
1 0
2 2
3 4
\n 5
--- cut --- cut --- cut ---

Please notice that first token has undefined value in  
getCharPositionInLine() and rest till end of line is shifted by -1.

Workaround is to set ctx->pLexer->input->charPositionInLine to zero  
after constructing lexer and before actual lexing/parsing.

Regards,
Ales Teska

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2371 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20091008/2e224983/attachment.bin 

From parrt at cs.usfca.edu  Thu Oct  8 14:36:12 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 8 Oct 2009 14:36:12 -0700
Subject: [antlr-interest] any interest in toy version of ST for learning
	purposes?
In-Reply-To: <2125F8F7-3B4F-418C-B103-BFF8D9A74DD7@cs.usfca.edu>
References: <2125F8F7-3B4F-418C-B103-BFF8D9A74DD7@cs.usfca.edu>
Message-ID: <E987D2E9-8F93-4A23-AC8B-F6C48E0FAC7D@cs.usfca.edu>

Oh, why not...dumped it up on the wiki:

http://www.antlr.org/wiki/display/ANTLR3/Toy+ST+implementation

Ter


From jimi at temporal-wave.com  Fri Oct  9 15:01:19 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 09 Oct 2009 18:01:19 -0400
Subject: [antlr-interest] MSBUILD/Vs2008
In-Reply-To: <86403CA0939415448BCCB83855EFE09A0123F4CF@Bloodymary.ironwillgames.com>
Message-ID: <afda2ae4994754428138673711ed4aaf@temporal-wave.com>

VS is pretty good at just allowing you to exclude file from source code while making them part of the project, I do it all the time. Add to the project, select source control, select remove from source control. Then take a look at the project file to see how it annotates it - I would think that MSBUILD can do that without having to name the files in advance? Or no?

Why does everyone think it is such a good idea to configure build tools with XML? It's a bloody stupid idea.

Jim

> -----Original Message-----
> From: Sam Harwell [mailto:sharwell at pixelminegames.com]
> Sent: Thursday, October 08, 2009 5:21 PM
> To: Gavin Lambert; Jim Idle; antlr-interest at antlr.org
> Subject: RE: [antlr-interest] MSBUILD/Vs2008
> 
> I thought about that, but then you run into a problem if you want the
> generated source files visible in your project. As soon as you add the
> files to the project, Visual Studio starts pestering you to add them to
> source control. I don't add the .tokens files to source control, but I
> generally do like having the *Lexer/*Parser.cs files available. I'm
> certainly open to any kind of suggestions (project/MSBUILD targets
> files
> and/or Visual Studio extension ideas for my language service package)
> for easing the integration of grammars into Visual C# projects.
> 
> Sam
> 
> -----Original Message-----
> From: Gavin Lambert [mailto:antlr at mirality.co.nz]
> Sent: Thursday, October 08, 2009 2:23 PM
> To: Sam Harwell; Jim Idle; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] MSBUILD/Vs2008
> 
> At 12:20 8/10/2009, Sam Harwell wrote:
> >*         Create a working Clean target (which
> >carries over to Rebuild). For this to work with
> >source control, I need to make sure that:
> >o   The generated code files are not written to
> >disk if their contents haven't changed.
> >o   The same source file always generates the
> >same output file, which means removing relative
> >paths and timestamps from the comments.
> 
> Or, you know, you could just exclude the
> generated files from source control.  Provided
> that all developers have access to ANTLR (and can
> thus rebuild it) -- which they'd need anyway if
> it's integrated into the project like this --
> then there's no need for the generated files to
> be in source control.  They can just be
> regenerated whenever required.





From jimi at temporal-wave.com  Fri Oct  9 15:02:14 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 09 Oct 2009 18:02:14 -0400
Subject: [antlr-interest] Bug in ANTLR C runtime - Incorrect
	getCharPositionInLine on first line
In-Reply-To: <99AEB24B-DD53-43C5-A482-5D5E8C0274CB@gmail.com>
Message-ID: <7ab08af9c5e76146bbbb410831ecfaf8@temporal-wave.com>

Yes - you have to special case it. However, you only ever come across this while developing really ;-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Ales Teska
> Sent: Thursday, October 08, 2009 5:33 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Bug in ANTLR C runtime - Incorrect
> getCharPositionInLine on first line
> 
> Hi,
> 
> I'm using ANTLR3 in one of my project and it seems that I found small
> bug in ANTLR C (version 3.2, 3.1.3 is also corrupted).
> I do not know if this is correct way of reporting bugs but ...
> 
> ANTLR3 C runtime returns incorrect values of CharPositionInLine for
> tokens on first line of input. This is eventually propagated to tokens.
> I wrote small program to demonstrate this behavior - it is available
> here: http://devel-www.cyber.cz/files/tmp/antlrc3-bug-pack.zip
> 
> Bug causes token stream post-processing a little bit more complicated
> than it can ideally be ...
> 
> Here is expected output (produced by Python target).
> First character is from input.txt, second is result of
> getCharPositionInLine():
> 
> --- cut --- cut --- cut ---
> 1 0
> 2 2
> 3 4
> \n 5
> 1 0
> 2 2
> 3 4
> \n 5
> --- cut --- cut --- cut ---
> 
> and here is actual output from C target:
> 
> --- cut --- cut --- cut ---
> 1 4294967295
> 2 1
> 3 3
> \n 4
> 1 0
> 2 2
> 3 4
> \n 5
> --- cut --- cut --- cut ---
> 
> Please notice that first token has undefined value in
> getCharPositionInLine() and rest till end of line is shifted by -1.
> 
> Workaround is to set ctx->pLexer->input->charPositionInLine to zero
> after constructing lexer and before actual lexing/parsing.
> 
> Regards,
> Ales Teska





From gwlist at grahamwideman.com  Thu Oct  8 15:34:10 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Thu, 08 Oct 2009 15:34:10 -0700
Subject: [antlr-interest] Harwell C#: where to get?
In-Reply-To: <7ab08af9c5e76146bbbb410831ecfaf8@temporal-wave.com>
References: <99AEB24B-DD53-43C5-A482-5D5E8C0274CB@gmail.com>
Message-ID: <4.1.20091008153041.01711f50@grahamwideman.com>

Hi Sam (or others able to answer),

I gather from your recent post "C++ grammar for ANTLR v3?" that your code includes a grammar for ANTLR v3 written in v3 grammar language?

If so, is it available, and where? At this stage I really am just looking for the .g file(s).

Thanks,

Graham

From wclodius at los-alamos.net  Thu Oct  8 21:10:21 2009
From: wclodius at los-alamos.net (William B. Clodius)
Date: Thu, 8 Oct 2009 22:10:21 -0600
Subject: [antlr-interest] Undocumented error message
Message-ID: <671C939F-0949-4CBF-85F4-B1D08DE6F1CB@los-alamos.net>

As a hobby I have started using ANTLR V3 to design a language. So far  
I am at the pure syntax stage, building up a grammar that is intended  
to be pure LL(*), in the expectation that it will allow me to provide  
more specific and clearer error messages than is typically provided by  
an LR(n) parser. I have so far not deliberately added actions,  
syntactic predicates, etc. Today I have been getting error messages in  
the console of ANTLR-Works 1.3 for which I have found no documentation  
on the net. Yesterday I downloaded the most recent upgrade so I  
suspect the message was added in the recent upgrade. I also have a  
question about the general syntax of the messages. The message is of  
the form

[20:55:24] error(130): ...:163:15: rule comparison has no defined  
parameters

where comparison is my name for the syntactic rule for relational  
expressions, and ... represents the name of my grammar file. It turned  
out that I had misremembered ANTLR's EBNF syntax and had used square  
brackets as delimiters. However I did not use them in the comparison  
rule, but rather in the immediately following rule. Further the 163  
was not the line number of the start of the comparison rule, or the  
following rule, but the line with the colon of the following rule.  
This leads to the following questions:

First, what kind of parameters are expected for a rule in ANTLR and  
how do I define them?

Second the error messages have a regular syntax for which I have seen  
no definition. What is the meaning of the numbers in  [20:55:24]? I  
had thought that the number where the 163 appears was the line number  
of the start of the error, is it? What is the meaning of the number  
15? Is there someplace error(130) is documented?


From darien at technofovea.com  Thu Oct  8 21:12:57 2009
From: darien at technofovea.com (Darien A Hager)
Date: Thu, 08 Oct 2009 21:12:57 -0700
Subject: [antlr-interest] Tree parser action only gets text for first
 token	in rule
In-Reply-To: <4ACC2CF9.2020109@technofovea.com>
References: <4ACC2CF9.2020109@technofovea.com>
Message-ID: <4ACEB849.507@technofovea.com>

I haven't solved the core problem, but there is a workaround: In my case I was able to alter my lexer rules so that the rule text matched a single token. But in trying to do so, I ran into a different problem.


This is what didn't work: I tried to use a rule in the AST-emitting parser to combine all the text into one imaginary token:

______________________
text
	:	QSTRING|(CHAR+)
	->	TEXTVAL[$text.text]
	;
______________________

This created a valid-looking stream of tree nodes going to the tree parser, however... the tree parser would always error out, claiming it found "test text here" instead of TEXTVAL. The TEXTVAL token would have the correct token number, but it's token *name* would somehow match the text payload...?

Anyway, my gut feeling is that there should still be *some* way to specify "all text within this subtree" in an tree-parser, and I'm still interested if someone knows what it is.

--Darien A. Hager


From dahvid.minor at gmail.com  Fri Oct  9 02:14:40 2009
From: dahvid.minor at gmail.com (David Minor)
Date: Fri, 9 Oct 2009 11:14:40 +0200
Subject: [antlr-interest] stuck on tree parsing, need help
Message-ID: <a2a61e1e0910090214w5e15d163kaaa650a9a1791f0d@mail.gmail.com>

Hi I'm a newbie,
I'm sure I've done something stupid here, but the error messages seem to be
all pointing to the wrong problem.  PearGrammer.g seems to be OK but
PearGrammerTree.g complains about an undefined rule, that is defined right
above it. Punctuation problem? Unmatched comments? I can't find it.
Thanks,
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091009/0d741b28/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PearGrammerTree.g
Type: application/octet-stream
Size: 5703 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20091009/0d741b28/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PearGrammer.g
Type: application/octet-stream
Size: 9838 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20091009/0d741b28/attachment-0001.obj 

From pgquiles at elpauer.org  Fri Oct  9 08:53:56 2009
From: pgquiles at elpauer.org (Pau Garcia i Quiles)
Date: Fri, 9 Oct 2009 17:53:56 +0200
Subject: [antlr-interest] Learning ANTLR
Message-ID: <3af572ac0910090853l21772c9cqffe64439201d6707@mail.gmail.com>

Hello,

I know nothing about ANTLR. Zero.

But I want to learn!

So: what book should I use to get started with it? The old one (
http://pragprog.com/titles/tpdsl/language-design-patterns ) or the new
one ( http://pragprog.com/titles/tpdsl/language-design-patterns ) ?
What version of ANTLR is used in the new book? Will there be a new
edition of the old book for ANTLR 3.2 ?

Thank you.

-- 
Pau Garcia i Quiles
http://www.elpauer.org
(Due to my workload, I may need 10 days to answer)

From reid at lanl.gov  Fri Oct  9 09:24:35 2009
From: reid at lanl.gov (Reid Rivenburgh)
Date: Fri, 09 Oct 2009 10:24:35 -0600
Subject: [antlr-interest] Whitespace question
Message-ID: <4ACF63C3.70804@lanl.gov>

Hi.  I've been using ANTLR (ANTLRWorks, actually, which is very nice) to 
implement a project-specific search language, sort of like google's. 
I've gotten it mostly working, though it's taken some time and 
experimentation to understand the details.  In my grammar, I've defined 
a searchTerms parser rule, which is one or more searchTerm:

	searchTerm+;

searchTerm matches a SEARCH_TERM token, which can be a number or word 
(with some special characters like '*' allowed).  The number is the 
usual definition for a floating point number:

	('-'|'+')?((DIGIT+)|(DIGIT*'.'DIGIT+));

which I hope is correct.  (DIGIT is the fragment 0..9.)  I'm also 
sending whitespace to the HIDDEN channel, as is often recommended.  It 
seems like a side effect of this is that this input:

4.66.34

which isn't a valid number, gets parsed as two different terms: 4.66 and 
.34.  Is there some way to require whitespace between my search terms so 
that input isn't allowed?  When I was parsing words, this wasn't a 
problem.  I wouldn't be surprised if my design is a bit wrong still, and 
that's what's put me in this position.

I can't post the entire grammar, unfortunately.

Thanks for any pointers,
Reid

From indhu.b at s7software.com  Fri Oct  9 10:20:28 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 9 Oct 2009 22:50:28 +0530
Subject: [antlr-interest] Whitespace question
In-Reply-To: <4ACF63C3.70804@lanl.gov>
References: <4ACF63C3.70804@lanl.gov>
Message-ID: <000001ca4904$ccf5ad30$66e10790$@b@s7software.com>

Try something like

 

r     :     lbl=searchTerm ({spaceFollows($lbl.stop)}?=> lbl=searchTerm)*

      ;

 

@members {

      public boolean spaceFollows(Token tkn) {

            return input.get(tkn.getTokenIndex()+1).getType()==WS;

      }

}

 

Cheers,

 

Indhu Bharathi

 <http://www.s7software.com/> S7 Software Solutions

 

 

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Reid Rivenburgh
Sent: Friday, October 09, 2009 9:55 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Whitespace question

 

Hi.  I've been using ANTLR (ANTLRWorks, actually, which is very nice) to 

implement a project-specific search language, sort of like google's. 

I've gotten it mostly working, though it's taken some time and 

experimentation to understand the details.  In my grammar, I've defined 

a searchTerms parser rule, which is one or more searchTerm:

 

      searchTerm+;

 

searchTerm matches a SEARCH_TERM token, which can be a number or word 

(with some special characters like '*' allowed).  The number is the 

usual definition for a floating point number:

 

      ('-'|'+')?((DIGIT+)|(DIGIT*'.'DIGIT+));

 

which I hope is correct.  (DIGIT is the fragment 0..9.)  I'm also 

sending whitespace to the HIDDEN channel, as is often recommended.  It 

seems like a side effect of this is that this input:

 

4.66.34

 

which isn't a valid number, gets parsed as two different terms: 4.66 and 

.34.  Is there some way to require whitespace between my search terms so 

that input isn't allowed?  When I was parsing words, this wasn't a 

problem.  I wouldn't be surprised if my design is a bit wrong still, and 

that's what's put me in this position.

 

I can't post the entire grammar, unfortunately.

 

Thanks for any pointers,

Reid

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest

Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091009/2d834fcc/attachment.html 

From reid at lanl.gov  Fri Oct  9 11:35:47 2009
From: reid at lanl.gov (Reid Rivenburgh)
Date: Fri, 09 Oct 2009 12:35:47 -0600
Subject: [antlr-interest] Whitespace question
In-Reply-To: <000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
References: <4ACF63C3.70804@lanl.gov>
	<000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
Message-ID: <4ACF8283.2010107@lanl.gov>

Indhu Bharathi wrote:
> Try something like
> 
> 
> r     :     lbl=searchTerm ({spaceFollows($lbl.stop)}?=> lbl=searchTerm)*
>       ;
> 
> @members {
>       public boolean spaceFollows(Token tkn) {
>             return input.get(tkn.getTokenIndex()+1).getType()==WS;
>       }
> }

Interesting, thanks for the tip.  Since you offered a fix, then, I 
assume this isn't a situation that indicates a fundamental design flaw? 
    That's good news, at least!

Thanks,
Reid

From cmundi at gmail.com  Fri Oct  9 11:58:59 2009
From: cmundi at gmail.com (C. Mundi)
Date: Fri, 9 Oct 2009 11:58:59 -0700
Subject: [antlr-interest] Learning ANTLR
In-Reply-To: <3af572ac0910090853l21772c9cqffe64439201d6707@mail.gmail.com>
References: <3af572ac0910090853l21772c9cqffe64439201d6707@mail.gmail.com>
Message-ID: <e794390910091158k2dbfe554t27b234c4d83dc5ca@mail.gmail.com>

You may want both at once.  The new book emphasizes concepts with
examples implemented using antlr.  The old book is all about the antlr
tool.  My advice: get the new book.  If you're really jazzed about
what's in it, then you'll get the first book.  Terence and his
publisher might like you to buy both books at once...good for the
economic recovery.  :)


On 10/9/09, Pau Garcia i Quiles <pgquiles at elpauer.org> wrote:
> Hello,
>
> I know nothing about ANTLR. Zero.
>
> But I want to learn!
>
> So: what book should I use to get started with it? The old one (
> http://pragprog.com/titles/tpdsl/language-design-patterns ) or the new
> one ( http://pragprog.com/titles/tpdsl/language-design-patterns ) ?
> What version of ANTLR is used in the new book? Will there be a new
> edition of the old book for ANTLR 3.2 ?
>
> Thank you.
>
> --
> Pau Garcia i Quiles
> http://www.elpauer.org
> (Due to my workload, I may need 10 days to answer)
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From martijn.reuvers at gmail.com  Fri Oct  9 12:00:05 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Fri, 9 Oct 2009 21:00:05 +0200
Subject: [antlr-interest] Learning ANTLR
In-Reply-To: <3af572ac0910090853l21772c9cqffe64439201d6707@mail.gmail.com>
References: <3af572ac0910090853l21772c9cqffe64439201d6707@mail.gmail.com>
Message-ID: <c376e6ec0910091200g522416d0mb589f225dbfd0745@mail.gmail.com>

Hello Paul,

The new book uses antlr 3.2. As for starting, I guess both would be
useful. The second book uses antlr in several examples, but is not
written for antlr specifically. So for the basics of antlr perhaps you
should start with the older book. The new book though, teaches you a
lot about the things antlr is silently doing for you (how lexer &
parsers & treewalkers work e.g.). So it depends on what you want to
learn and what to do with antlr. =)

Martijn

On Fri, Oct 9, 2009 at 5:53 PM, Pau Garcia i Quiles
<pgquiles at elpauer.org> wrote:
> Hello,
>
> I know nothing about ANTLR. Zero.
>
> But I want to learn!
>
> So: what book should I use to get started with it? The old one (
> http://pragprog.com/titles/tpdsl/language-design-patterns ) or the new
> one ( http://pragprog.com/titles/tpdsl/language-design-patterns ) ?
> What version of ANTLR is used in the new book? Will there be a new
> edition of the old book for ANTLR 3.2 ?
>
> Thank you.
>
> --
> Pau Garcia i Quiles
> http://www.elpauer.org
> (Due to my workload, I may need 10 days to answer)
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From pgquiles at elpauer.org  Fri Oct  9 12:28:31 2009
From: pgquiles at elpauer.org (Pau Garcia i Quiles)
Date: Fri, 9 Oct 2009 21:28:31 +0200
Subject: [antlr-interest] Learning ANTLR
In-Reply-To: <e794390910091158k2dbfe554t27b234c4d83dc5ca@mail.gmail.com>
References: <3af572ac0910090853l21772c9cqffe64439201d6707@mail.gmail.com>
	<e794390910091158k2dbfe554t27b234c4d83dc5ca@mail.gmail.com>
Message-ID: <3af572ac0910091228s62e7c00ex86c43d463452a342@mail.gmail.com>

Hello,

Thanks. I'm indeed buying both books.

On Fri, Oct 9, 2009 at 8:58 PM, C. Mundi <cmundi at gmail.com> wrote:
> You may want both at once. ?The new book emphasizes concepts with
> examples implemented using antlr. ?The old book is all about the antlr
> tool. ?My advice: get the new book. ?If you're really jazzed about
> what's in it, then you'll get the first book. ?Terence and his
> publisher might like you to buy both books at once...good for the
> economic recovery. ?:)
>
>
> On 10/9/09, Pau Garcia i Quiles <pgquiles at elpauer.org> wrote:
>> Hello,
>>
>> I know nothing about ANTLR. Zero.
>>
>> But I want to learn!
>>
>> So: what book should I use to get started with it? The old one (
>> http://pragprog.com/titles/tpdsl/language-design-patterns ) or the new
>> one ( http://pragprog.com/titles/tpdsl/language-design-patterns ) ?
>> What version of ANTLR is used in the new book? Will there be a new
>> edition of the old book for ANTLR 3.2 ?
>>
>> Thank you.
>>
>> --
>> Pau Garcia i Quiles
>> http://www.elpauer.org
>> (Due to my workload, I may need 10 days to answer)
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>



-- 
Pau Garcia i Quiles
http://www.elpauer.org
(Due to my workload, I may need 10 days to answer)

From gwlist at grahamwideman.com  Fri Oct  9 12:47:03 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Fri, 09 Oct 2009 12:47:03 -0700
Subject: [antlr-interest] Whitespace question
In-Reply-To: <4ACF8283.2010107@lanl.gov>
References: <000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
	<4ACF63C3.70804@lanl.gov>
	<000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
Message-ID: <4.1.20091009123429.02d44ef8@grahamwideman.com>

At 10/9/2009 12:35 PM, Reid Rivenburgh wrote:
>Indhu Bharathi wrote:
>> Try something like
>> 
>> r     :     lbl=searchTerm ({spaceFollows($lbl.stop)}?=> lbl=searchTerm)*
>>       ;
>> 
>> @members {
>>       public boolean spaceFollows(Token tkn) {
>>             return input.get(tkn.getTokenIndex()+1).getType()==WS;
>>       }
>> }
>
>Interesting, thanks for the tip.  Since you offered a fix, then, I 
>assume this isn't a situation that indicates a fundamental design flaw? 

What Indu provided was not a "fix" for a "fundamental design flaw" per se, it was one way to handle a tricky language problem.

You are free to *not* send whitespace to an invisible channel -- then it will appear in the stream of tokens that you can make rules about. Your grammar can then specify explicitly where whitespace is required or permitted.  But in most languages that means that you have to handle whitespace in almost every rule, which is tedious.  Throwing the whitespace away is usually the desirable strategy, and greatly simplifies the grammar.

But that means that you end up needing to "special case" the places where your grammar *does* require whitespace.  There are several alternatives, including, for example, checking that the beginning of the subsequent token is two or more character positions after the end of your number token.

But in fact, that may not be sufficient either. For example you may want to permit a closing parenthesis to directly follow your numbers, and thus not required whitespace in that case.

So it's a matter of clarifying some of the fiddly details allowed/disallowed in your language, and deciding whether it's worth dealing with whitespace using grammar, or generally ignoring the whitespace and adding code (ACTIONS) where needed to handle a special case.

-- Graham


From ales.teska at gmail.com  Fri Oct  9 14:19:30 2009
From: ales.teska at gmail.com (Ales Teska)
Date: Fri, 9 Oct 2009 23:19:30 +0200
Subject: [antlr-interest] Python 3 grammar for C target
Message-ID: <C38E5054-C0AF-46D3-B68B-C73C2E7D8E55@gmail.com>

Dear all,

during work on my project I created ANTLR 3 grammar for Python 3.1 for  
C target.
I decided to support ANTLR community by releasing this part to public  
domain.

So grammar with supporting C code and test/demo application is here:
http://devel-www.cyber.cz/files/python3grammarC.tar.gz
MD5 chksum: 3434fed733bd29cb232b321817a5fddc

It is really fresh (but thoroughly tested) thing.
The only missing part I know is PEP 3131 (Supporting Non-ASCII  
Identifiers).
And of course this grammar requires backtracing to be turned on - I  
will try to correct this in the near future
but it is not a highest priority for me as its current speed (C  
language) is awesome already and I have to move on.

Your review is welcomed ;-)

Regards,
Ales Teska

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2371 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20091009/38d9c52a/attachment.bin 

From reid at lanl.gov  Fri Oct  9 14:34:31 2009
From: reid at lanl.gov (Reid Rivenburgh)
Date: Fri, 09 Oct 2009 15:34:31 -0600
Subject: [antlr-interest] Whitespace question
In-Reply-To: <4.1.20091009123429.02d44ef8@grahamwideman.com>
References: <000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
	<4ACF63C3.70804@lanl.gov>
	<000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
	<4.1.20091009123429.02d44ef8@grahamwideman.com>
Message-ID: <4ACFAC67.9070903@lanl.gov>

Graham Wideman wrote:
> At 10/9/2009 12:35 PM, Reid Rivenburgh wrote:
>> Indhu Bharathi wrote:
>>> Try something like
>>>
>>> r     :     lbl=searchTerm ({spaceFollows($lbl.stop)}?=> lbl=searchTerm)*
>>>       ;
>>>
>>> @members {
>>>       public boolean spaceFollows(Token tkn) {
>>>             return input.get(tkn.getTokenIndex()+1).getType()==WS;
>>>       }
>>> }
>> Interesting, thanks for the tip.  Since you offered a fix, then, I 
>> assume this isn't a situation that indicates a fundamental design flaw? 
> 
> What Indu provided was not a "fix" for a "fundamental design flaw" per se, it was one way to handle a tricky language problem.
> 
> You are free to *not* send whitespace to an invisible channel -- then it will appear in the stream of tokens that you can make rules about. Your grammar can then specify explicitly where whitespace is required or permitted.  But in most languages that means that you have to handle whitespace in almost every rule, which is tedious.  Throwing the whitespace away is usually the desirable strategy, and greatly simplifies the grammar.
> 
> But that means that you end up needing to "special case" the places where your grammar *does* require whitespace.  There are several alternatives, including, for example, checking that the beginning of the subsequent token is two or more character positions after the end of your number token.
> 
> But in fact, that may not be sufficient either. For example you may want to permit a closing parenthesis to directly follow your numbers, and thus not required whitespace in that case.
> 
> So it's a matter of clarifying some of the fiddly details allowed/disallowed in your language, and deciding whether it's worth dealing with whitespace using grammar, or generally ignoring the whitespace and adding code (ACTIONS) where needed to handle a special case.

Thanks for the clarification, Graham.  It sure seemed like my issue 
would be a FAQ, but I didn't see all that much about it, which made me 
suspect I had done something deeply wrong.  But what you've described 
matches my understanding, and it's reassuring that it's normal that 
there will sometimes be fiddly details like this to work out.  In my 
particular case, I think it's okay to let a few illegal constructs 
through and catch them further down the line.  I was just hoping that I 
would be able to easily write a tighter grammar.

Reid

From parrt at cs.usfca.edu  Fri Oct  9 14:53:14 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 9 Oct 2009 14:53:14 -0700
Subject: [antlr-interest] Python 3 grammar for C target
In-Reply-To: <C38E5054-C0AF-46D3-B68B-C73C2E7D8E55@gmail.com>
References: <C38E5054-C0AF-46D3-B68B-C73C2E7D8E55@gmail.com>
Message-ID: <608F5395-5DE8-47D2-B16C-248FA030A659@cs.usfca.edu>

adding to grammar list.

http://antlr.org/grammar/list

Ter
On Oct 9, 2009, at 2:19 PM, Ales Teska wrote:

> Dear all,
>
> during work on my project I created ANTLR 3 grammar for Python 3.1  
> for C target.
> I decided to support ANTLR community by releasing this part to  
> public domain.
>
> So grammar with supporting C code and test/demo application is here:
> http://devel-www.cyber.cz/files/python3grammarC.tar.gz
> MD5 chksum: 3434fed733bd29cb232b321817a5fddc
>
> It is really fresh (but thoroughly tested) thing.
> The only missing part I know is PEP 3131 (Supporting Non-ASCII  
> Identifiers).
> And of course this grammar requires backtracing to be turned on - I  
> will try to correct this in the near future
> but it is not a highest priority for me as its current speed (C  
> language) is awesome already and I have to move on.
>
> Your review is welcomed ;-)
>
> Regards,
> Ales Teska
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From antlr at mirality.co.nz  Fri Oct  9 17:22:45 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 10 Oct 2009 13:22:45 +1300
Subject: [antlr-interest] Whitespace question
In-Reply-To: <4ACFAC67.9070903@lanl.gov>
References: <000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
	<4ACF63C3.70804@lanl.gov>
	<000001ca4904$ccf5ad30$66e10790$@b@s7software.com>
	<4.1.20091009123429.02d44ef8@grahamwideman.com>
	<4ACFAC67.9070903@lanl.gov>
Message-ID: <20091010002303.3E9A4341844A@www.antlr.org>

At 10:34 10/10/2009, Reid Rivenburgh wrote:
 >In my particular case, I think it's okay to let a few illegal
 >constructs through and catch them further down the line.  I was
 >just hoping that I would be able to easily write a tighter
 >grammar.

As Jim Idle is fond of pointing out, it's often better to make the 
grammar fairly tolerant and deal with errors as late as possible 
(usually in the tree parser) -- that way you have more contextual 
information and can often produce a better error message.


From jimi at temporal-wave.com  Sat Oct 10 18:42:38 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 11 Oct 2009 07:12:38 +0530
Subject: [antlr-interest] Whitespace question
In-Reply-To: <20091010002303.3E9A4341844A@www.antlr.org>
Message-ID: <d5b4f28b92a6a14b943d0dd8130f7eab@temporal-wave.com>

Indeed I am fond of saying this ;-) For a great example of how much better you can get with those sorts of messages I always quote Visual Studio 2008 and C#. Other examples can be found of course. With these sorts of error catches you can say things like "It looks like you are missing the xyz construct here", or "You cannot use the abc clause in conjunction with the def clause", instead of "Syntax error at PRINT" and so on.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Gavin Lambert
> Sent: Saturday, October 10, 2009 5:53 AM
> To: Reid Rivenburgh; Graham Wideman
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Whitespace question
> 
> At 10:34 10/10/2009, Reid Rivenburgh wrote:
>  >In my particular case, I think it's okay to let a few illegal
>  >constructs through and catch them further down the line.  I was
>  >just hoping that I would be able to easily write a tighter
>  >grammar.
> 
> As Jim Idle is fond of pointing out, it's often better to make the
> grammar fairly tolerant and deal with errors as late as possible
> (usually in the tree parser) -- that way you have more contextual
> information and can often produce a better error message.
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Sat Oct 10 18:45:04 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 11 Oct 2009 07:15:04 +0530
Subject: [antlr-interest] Python 3 grammar for C target
In-Reply-To: <608F5395-5DE8-47D2-B16C-248FA030A659@cs.usfca.edu>
Message-ID: <b7adf2b00ba3224f8aa4f041b5c326b0@temporal-wave.com>

Cool contribution - perhaps the first for the C target :-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Terence Parr
> Sent: Saturday, October 10, 2009 3:23 AM
> To: Ales Teska
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Python 3 grammar for C target
> 
> adding to grammar list.
> 
> http://antlr.org/grammar/list
> 
> Ter
> On Oct 9, 2009, at 2:19 PM, Ales Teska wrote:
> 
> > Dear all,
> >
> > during work on my project I created ANTLR 3 grammar for Python 3.1
> > for C target.
> > I decided to support ANTLR community by releasing this part to
> > public domain.
> >
> > So grammar with supporting C code and test/demo application is here:
> > http://devel-www.cyber.cz/files/python3grammarC.tar.gz
> > MD5 chksum: 3434fed733bd29cb232b321817a5fddc
> >
> > It is really fresh (but thoroughly tested) thing.
> > The only missing part I know is PEP 3131 (Supporting Non-ASCII
> > Identifiers).
> > And of course this grammar requires backtracing to be turned on - I
> > will try to correct this in the near future
> > but it is not a highest priority for me as its current speed (C
> > language) is awesome already and I have to move on.
> >
> > Your review is welcomed ;-)
> >
> > Regards,
> > Ales Teska
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-
> interest/your-email-address
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From sivaits4u at gmail.com  Fri Oct  9 22:17:54 2009
From: sivaits4u at gmail.com (Siva B)
Date: Sat, 10 Oct 2009 10:47:54 +0530
Subject: [antlr-interest] antrl installation hep plz...
Message-ID: <581ce2790910092217m20413b3fp162253bf41a9526e@mail.gmail.com>

Hello friends,
I am new to antlr .
I want to write a translator.
I am not getting how exactly to use antlr.
Can anybody give me some guidence.
I followed the antlr ref guide but there is no correct approach to install
and write a some application.
where to start .
More over when i am tryoing to install using README, those also not clear.
How should in do it .
using maven or ant ?
The procedure that is given like add the jar files to CLASSPATH . is that
only solution ?
then what next ?
plz help me i am struggling for few days...


How to build(or install) it ?
and How to use it..
plz help me.

Thanks
Kiso
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091010/bd9f6688/attachment.html 

From stoneyrh at gmail.com  Sat Oct 10 07:59:32 2009
From: stoneyrh at gmail.com (Ronghui Yu)
Date: Sat, 10 Oct 2009 22:59:32 +0800
Subject: [antlr-interest] Is it possible to include another grammar file?
Message-ID: <4AD0A154.2040508@gmail.com>

Hi, All,

I would like to divide a large grammar file into serveral pieces, so
that some pieces of them can be auto-generated according to some other
materials, but the main grammar file doesn't get affected. Is it
possible to include those pieces in the main grammar file?

Thanks.

-- 
Ronghui Yu <mailto:stoneyrh at 163.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091010/bf73c6d2/attachment.html 

From indhu.b at s7software.com  Sat Oct 10 11:49:53 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Sun, 11 Oct 2009 00:19:53 +0530
Subject: [antlr-interest] Is it possible to include another grammar file?
In-Reply-To: <4AD0A154.2040508@gmail.com>
References: <4AD0A154.2040508@gmail.com>
Message-ID: <000001ca49da$7727b6b0$65772410$@b@s7software.com>

Refer 'composite grammar' from wiki.

 

http://www.antlr.org/wiki/display/ANTLR3/Composite+Grammars

 

Cheers,

 

Indhu Bharathi

 <http://www.s7software.com/> S7 Software Solutions

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Ronghui Yu
Sent: Saturday, October 10, 2009 8:30 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Is it possible to include another grammar file?

 

Hi, All,

I would like to divide a large grammar file into serveral pieces, so that
some pieces of them can be auto-generated according to some other materials,
but the main grammar file doesn't get affected. Is it possible to include
those pieces in the main grammar file?

Thanks.

-- 
Ronghui Yu <mailto:stoneyrh at 163.com>  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091011/718fc643/attachment.html 

From mulhern at gmail.com  Sat Oct 10 14:14:58 2009
From: mulhern at gmail.com (mulhern)
Date: Sat, 10 Oct 2009 16:14:58 -0500
Subject: [antlr-interest] Keep ANTLRWORKS from connecting to remote debugger
Message-ID: <54f15b6e0910101414uac5266di12d3fdc4970af5c7@mail.gmail.com>

Hi!

I'm using ANTLRWORKS 1.3. I'm unable to prevent it from trying to connect to
the remote debugger in spite of the fact that I'm generating code in the
default target language, Java.

What could be causing this and how can I prevent it?

Thanks!

- mulhern
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091010/5ab76e43/attachment.html 

From ger.hobbelt at bermuda-holding.com  Sat Oct 10 14:28:43 2009
From: ger.hobbelt at bermuda-holding.com (Ger Hobbelt)
Date: Sat, 10 Oct 2009 23:28:43 +0200
Subject: [antlr-interest] MSBUILD/Vs2008 > [OT 80/20]
Message-ID: <561cc61d0910101428u46f3d5del4a12e473ea51b0e8@mail.gmail.com>

On Sat, Oct 10, 2009 at 12:01 AM, Jim Idle <jimi at temporal-wave.com> wrote:
> VS is pretty good at just allowing you to exclude file from source code
> while making them part of the project, I do it all the time. Add to the
> project, select source control, select remove from source control. Then
> take a look at the project file to see how it annotates it - I would think
> that MSBUILD can do that without having to name the files in
> advance? Or no?



> Why does everyone think it is such a good idea to configure build tools
> with XML? It's a bloody stupid idea.

Hear! Hear!


(Well, this stuff is sold as being 'configuration' but what it really
is is rather more a kind of [meta]programming and XML ain't no
programming language. Bad architectural mistake, but by now almost
everyone is 'borged up and assimilated. Plus there's the CASE process
fantasy lurking in the background, where you draw your design,
double-click on the developer to generate code+conf for building, then
get up and fetch a coffee from the dispenser while R2D2 chugs away. To
many, using XML in that scenario for those conf files sounds like K-Y
jelly to prevent interface friction burns as it's simple machine
readable and one [config] parser rule them all. And what was ever
wrong with that, now. ;-) )



BTW: MSBuild can Include and Exclude files, but I've never got it to
do exactly what you asked. Not saying it's not doable, but checking
the docs didn't reveal the required incantation yet. Which leads me to
guess you're close to SOL now.


Meanwhile, you might go and hack around the issue like this fellow did
under different circumstances:

http://brennan.offwhite.net/blog/2006/11/29/msbuild-dependencies-3of7/

the trick here would be to do like he did and make source control
ignore a specific directory, then modify the target output to write
all not-be-be-VSS-d files to that directory, so they won't be included
in the source control party, and take it from there, build-wise.


-- 
Met vriendelijke groeten / Best regards,

Ger Hobbelt

--------------------------------------------------
web:    http://www.hobbelt.com/
        http://www.hebbut.net/
mail:   ger at hobbelt.com
mobile: +31-6-11 120 978
--------------------------------------------------

From antlr at mirality.co.nz  Sat Oct 10 17:25:45 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 11 Oct 2009 13:25:45 +1300
Subject: [antlr-interest] MSBUILD/Vs2008
In-Reply-To: <afda2ae4994754428138673711ed4aaf@temporal-wave.com>
References: <86403CA0939415448BCCB83855EFE09A0123F4CF@Bloodymary.ironwillgames.com>
	<afda2ae4994754428138673711ed4aaf@temporal-wave.com>
Message-ID: <20091011002559.DDC89341843A@www.antlr.org>

At 11:01 10/10/2009, Jim Idle wrote:
 >Why does everyone think it is such a good idea to configure 
build
 >tools with XML? It's a bloody stupid idea.

Better XML than something even more obscure and esoteric.

XML is much more extensible than, say, a makefile.


From stoneyrh at gmail.com  Sat Oct 10 21:13:47 2009
From: stoneyrh at gmail.com (Ronghui Yu)
Date: Sun, 11 Oct 2009 12:13:47 +0800
Subject: [antlr-interest] Is it possible to include another grammar file?
In-Reply-To: <000001ca49da$7727b6b0$65772410$@b@s7software.com>
References: <4AD0A154.2040508@gmail.com>
	<000001ca49da$7727b6b0$65772410$@b@s7software.com>
Message-ID: <4AD15B7B.7090701@gmail.com>

Got it

Thank you very much

Indhu Bharathi ??:
>
> Refer 'composite grammar' from wiki.
>
>  
>
> http://www.antlr.org/wiki/display/ANTLR3/Composite+Grammars
>
>  
>
> Cheers,
>
>  
>
> Indhu Bharathi
>
> S7 Software Solutions <http://www.s7software.com/>
>
>  
>
>  
>
> *From:* antlr-interest-bounces at antlr.org 
> [mailto:antlr-interest-bounces at antlr.org] *On Behalf Of *Ronghui Yu
> *Sent:* Saturday, October 10, 2009 8:30 PM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] Is it possible to include another grammar 
> file?
>
>  
>
> Hi, All,
>
> I would like to divide a large grammar file into serveral pieces, so 
> that some pieces of them can be auto-generated according to some other 
> materials, but the main grammar file doesn't get affected. Is it 
> possible to include those pieces in the main grammar file?
>
> Thanks.
>
> -- 
> Ronghui Yu <mailto:stoneyrh at 163.com>
>

-- 
Ronghui Yu <mailto:stoneyrh at 163.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091011/74d7be12/attachment.html 

From darien at technofovea.com  Sun Oct 11 01:53:55 2009
From: darien at technofovea.com (Darien A Hager)
Date: Sun, 11 Oct 2009 01:53:55 -0700
Subject: [antlr-interest] antrl installation hep plz...
In-Reply-To: <581ce2790910092217m20413b3fp162253bf41a9526e@mail.gmail.com>
References: <581ce2790910092217m20413b3fp162253bf41a9526e@mail.gmail.com>
Message-ID: <4AD19D23.4090104@technofovea.com>

Siva B wrote:
> Hello friends,
> I am new to antlr .
> I want to write a translator.
> I am not getting how exactly to use antlr.
If you just want to experiment with what it can do, download the 
AntlrWorks program and run it.
http://antlr.org/works
You can use it to help write your grammar (.g) files, then preview how 
they work, and finally use it to generate the .java files that you can 
copy into your project.

There are two parts of ANTLR. The first part is the generator, and the 
second part is the runtime. The "generator" part is a Java application 
that takes .g files and generates .java files. That part is included in 
AntlrWorks, and you do not need the JAR for it anywhere, not after 
you've done the .g->.java step. The only time you need that JAR is if 
you want Maven to automatically take your .g files and make .java files 
for you as part of your compiling process, but when starting out just 
use AntlrWorks to do it manually.

The "runtime" JAR is what you need for your project. (There are also 
other versions of it for other programming languages.) You can download 
the runtime from this page, under "Runtime Libraries"
http://antlr.org/download.html

Maven is not required. ANT is not required. But you *could* use either 
one to automate certain steps, if you really want to.

--Darien



From joanpujol at gmail.com  Sun Oct 11 03:07:43 2009
From: joanpujol at gmail.com (Joan Pujol)
Date: Sun, 11 Oct 2009 12:07:43 +0200
Subject: [antlr-interest] Lexer for a grammar similar to a template engine
Message-ID: <d2d18a10910110307n6e2942bfs7cbc36e1ad168618@mail.gmail.com>

Hi ,

I'm trying to do a grammar to parse expressions in a document in a
template engine basis.
The expressions are enclosed in ${}  (for example ${name}) and can be
in an enclosed in arbitrary document content.

Ideally what I need from the parser for input:   Hello ${name}.  Would
be similar to:

OTHER ^EXPR(ID)

I've tried that grammar but it doesn't works. If I enter an input that
contains $ or { in enters in an infinite bucle:

Grammar:
----
OTHER:	(
	    {input.LA(1)!='$' && input.LA(2)!='{'}? . 	
	)+;
	
ID  :	('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
    ;
	
line	: (OTHER
	  | expr )*;

expr	: '${' ID '}';
---

I'm sure I'm missing some basic concept but have passed more than
three or four years from my last antlr parser and I've to refresh my
parsing abilities.
Some one can orient me of how to solve that? or what I'm doing wrong?

Can I do that in one parser or is better to use one parser to separate
arbitrary content of expressions and then use another parser for the
expressions?

A lot of thanks in advance,


-- 
Joan Jes?s Pujol Espinar
http://www.joanpujol.cat
http://lujop.deviantart.com

From gwlist at grahamwideman.com  Sun Oct 11 03:43:15 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Sun, 11 Oct 2009 03:43:15 -0700
Subject: [antlr-interest] Lexer for a grammar similar to a template
 engine
In-Reply-To: <d2d18a10910110307n6e2942bfs7cbc36e1ad168618@mail.gmail.com
 >
Message-ID: <4.1.20091011033717.00cf75e0@grahamwideman.com>

First off, your OTHER rule should contain OR not AND if you want to accept '$' or '{' when they are not part of '${'.  

Other than that, it should be possible to write this without resorting to an action (semantic predicate), which would allow visualizing in ANTLRworks and so on.

-- Graham

>I've tried that grammar but it doesn't works. If I enter an input that
>contains $ or { in enters in an infinite bucle:
>
>Grammar:
>----
>OTHER:	(
>	    {input.LA(1)!='$' && input.LA(2)!='{'}? . 	
>	)+;
>	
>ID  :	('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
>    ;
>	
>line	: (OTHER
>	  | expr )*;
>
>expr	: '${' ID '}';
>---
>
>I'm sure I'm missing some basic concept but have passed more than
>three or four years from my last antlr parser and I've to refresh my
>parsing abilities.
>Some one can orient me of how to solve that? or what I'm doing wrong?
>
>Can I do that in one parser or is better to use one parser to separate
>arbitrary content of expressions and then use another parser for the
>expressions?
>
>A lot of thanks in advance,
>
>
>-- 
>Joan Jes??s Pujol Espinar
>http://www.joanpujol.cat
>http://lujop.deviantart.com
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From antlr at mirality.co.nz  Sun Oct 11 13:00:00 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 12 Oct 2009 09:00:00 +1300
Subject: [antlr-interest] Lexer for a grammar similar to a template
 engine
In-Reply-To: <4.1.20091011033717.00cf75e0@grahamwideman.com>
References: <d2d18a10910110307n6e2942bfs7cbc36e1ad168618@mail.gmail.com >
	<4.1.20091011033717.00cf75e0@grahamwideman.com>
Message-ID: <20091011200013.C2C54341840C@www.antlr.org>

At 23:43 11/10/2009, Graham Wideman wrote:
 >First off, your OTHER rule should contain OR not AND if you want 
to
 >accept '$' or '{' when they are not part of '${'.
 >
 >Other than that, it should be possible to write this without
 >resorting to an action (semantic predicate), which would allow
 >visualizing in ANTLRworks and so on.

It's probably best to do the initial split at "replacement string" 
vs. "everything else".  Then you can further evaluate the 
replacement string at the parser level:

file: ( TEXT    { /* print out the text */ }
       | STRING  { /* look up and fill in the replacement */ }
       )* EOF;

STRING: '${' (~'}')* '}';

TEXT: (~'$' | '$' ~'{')+;


From jo at joanpujol.cat  Sun Oct 11 13:48:02 2009
From: jo at joanpujol.cat (Joan Pujol)
Date: Sun, 11 Oct 2009 22:48:02 +0200
Subject: [antlr-interest] Lexer for a grammar similar to a template
	engine
In-Reply-To: <4ad2394c.1002be0a.656d.0512SMTPIN_ADDED@mx.google.com>
References: <4.1.20091011033717.00cf75e0@grahamwideman.com>
	<4ad2394c.1002be0a.656d.0512SMTPIN_ADDED@mx.google.com>
Message-ID: <d2d18a10910111348u57412f6gd9b8b256df7d62a5@mail.gmail.com>

Thanks Gavin and Graham,

Gavin:
But when you say that you can further evaluate at parser level what do you mean?
What do you say is use another lexer+parser to parse the STRINGs
tokens, doesn't you? Because the expressions will be a lot more
complex to be parsed without prior lexer separation of tokens.

Graham:
You're right, I've corrected what you say changing the AND but what I
don't understand is why if I put an input of for example:
'Hello?  --> It works.
But If I put "Hello ${" it enters in infinite recursion saying:
line 1:5 rule OTHER failed predicate: {input.LA(1)!='$' ||
input.LA(2)!='{'}? infinite times.


Cheers,

-- 
Joan Jes?s Pujol Espinar
http://www.joanpujol.cat
http://lujop.deviantart.com

From jo at joanpujol.cat  Sun Oct 11 14:41:44 2009
From: jo at joanpujol.cat (Joan Pujol)
Date: Sun, 11 Oct 2009 23:41:44 +0200
Subject: [antlr-interest] Lexer for a grammar similar to a template
	engine
In-Reply-To: <d2d18a10910111348u57412f6gd9b8b256df7d62a5@mail.gmail.com>
References: <4.1.20091011033717.00cf75e0@grahamwideman.com>
	<4ad2394c.1002be0a.656d.0512SMTPIN_ADDED@mx.google.com>
	<d2d18a10910111348u57412f6gd9b8b256df7d62a5@mail.gmail.com>
Message-ID: <d2d18a10910111441u2342d917ndff000d3cdb195fb@mail.gmail.com>

Hi Gavin,

When I looked at your grammar it seemed correct to me but I tested it
in ANTLRWorks and I can't see why it doesn't work.

If you test with input "Hello ${name} it gives me a lexer error: line
1:7 mismatched character '{' expecting set null

I've looked at generated code and I see that when the lexer enters at
mTEXT rule it only can exit (correctly) if it reaches the end of
input.
And I don't understand why. I suppose that is something with the new
ANTLR3 lexers, or that I've to refresh some parsing theory, but I'm
absolutely lost.

A lot of thanks in advance,




On Sun, Oct 11, 2009 at 10:48 PM, Joan Pujol <jo at joanpujol.cat> wrote:
> Thanks Gavin and Graham,
>
> Gavin:
> But when you say that you can further evaluate at parser level what do you mean?
> What do you say is use another lexer+parser to parse the STRINGs
> tokens, doesn't you? Because the expressions will be a lot more
> complex to be parsed without prior lexer separation of tokens.
>
> Graham:
> You're right, I've corrected what you say changing the AND but what I
> don't understand is why if I put an input of for example:
> 'Hello? ?--> It works.
> But If I put "Hello ${" it enters in infinite recursion saying:
> line 1:5 rule OTHER failed predicate: {input.LA(1)!='$' ||
> input.LA(2)!='{'}? infinite times.
>
>
> Cheers,
>
> --
> Joan Jes?s Pujol Espinar
> http://www.joanpujol.cat
> http://lujop.deviantart.com
>



-- 
Joan Jes?s Pujol Espinar
http://www.joanpujol.cat
http://lujop.deviantart.com

From darien at technofovea.com  Sun Oct 11 14:58:22 2009
From: darien at technofovea.com (Darien A Hager)
Date: Sun, 11 Oct 2009 14:58:22 -0700
Subject: [antlr-interest] Undocumented error message
In-Reply-To: <671C939F-0949-4CBF-85F4-B1D08DE6F1CB@los-alamos.net>
References: <671C939F-0949-4CBF-85F4-B1D08DE6F1CB@los-alamos.net>
Message-ID: <4AD254FE.3030201@technofovea.com>

William B. Clodius wrote:
> First, what kind of parameters are expected for a rule in ANTLR and  
> how do I define them?
This may or may not answer your question, but the following example 
should give a similar error.
________________________________________
parser grammar temp;
tokens{
   MYTOK;
}

foo [Tshirt x]
   :    msg=bar[x]
   {
       System.out.println(msg);
   }
   ;

bar returns [String message]
   :    MYTOK      {
       message = "I went and parsed stuff and all I got was this lousy 
T-shirt that says "+x.getFrontText();
   }
   ;
________________________________________


What this flawed grammar is intended to do is pass an object of type 
Thingy in when executing the rule "foo". And then every time the rule 
"foo" goes and calls rule "bar", "bar" will also have access to that 
object. To fix it, I need to add an input parameter (really, a 
positional function argument) to the final rule:
________________________________________
bar [Tshirt x] returns [String message]
________________________________________

At least for me, the error message numbers mean the line/column where I 
tried to put bar[x] while bar was unable to accept any arguments.

--Darien

From hjrnunes at student.dei.uc.pt  Sun Oct 11 17:30:17 2009
From: hjrnunes at student.dei.uc.pt (Henrique)
Date: Mon, 12 Oct 2009 00:30:17 +0000
Subject: [antlr-interest] Multiple file parsing
Message-ID: <ac8968760910111730y70d1398bw4f1a0ac60aa8e135@mail.gmail.com>

Hi everyone.
I'm using ANTLR for parsing context-free grammars accepted for the program
Context Free Art.
I'm using the python runtime and what happens is while I'm parsing multiple
files, one after the other, it seems my data structures get not only the
content of the file currently being parsed but also everything else
previously parsed in previous files... I've looked it up and it seems to be
coming from the ANTLR generated code.
What could be causing this? What is the right way of ensuring contents don't
propagate between parsings? I'm closing the files after being parsed but
still it happens...

Henrique Nunes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091012/34eab078/attachment.html 

From Heiko.Folkerts at david-bs.de  Mon Oct 12 00:01:32 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Mon, 12 Oct 2009 09:01:32 +0200
Subject: [antlr-interest] Error reporting in mismatchset
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF130325FC30@DC2>

Hi,
I have to following piece of grammar from wich I want to create a helpful errormessage:
Statecheck: OBJECT COMPERATOR statearg SEMI;
Statearg: PARAMREF | STATE;

Now if I give the input 
Motor =; 
Where Motor is recognized as OBJECT and = recognized as COMPERATOR I get an mismatched set exception. That's right, since a statearg is expected. 

Since this is a tree parser I get an unexpected node exception which is meaningless to our users. In the resulting exception neither the expecting nor the expecting set fields are set so I cannot create a helpful errormessage from it. I'd like to change the behaviour so that I can generate more helpful errormessages for this and other similar cases. 

I tried to specify a manual exception handler as explained in the ANTLR reference but the code isn't reached because recoverFromMismatchedToken catches and handles the error allready.

So what should I override to make things work and do it the right way?

Thx

Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From Nicola.Musatti at objectway.it  Mon Oct 12 01:14:24 2009
From: Nicola.Musatti at objectway.it (Nicola Musatti)
Date: Mon, 12 Oct 2009 10:14:24 +0200
Subject: [antlr-interest] Whitespace question
In-Reply-To: <4779_1255105540_4ACF6402_4779_184217_1_4ACF63C3.70804@lanl.gov>
References: <4779_1255105540_4ACF6402_4779_184217_1_4ACF63C3.70804@lanl.gov>
Message-ID: <18514_1255335265_n9C8EO1g008148_4AD2E560.9070909@ObjectWay.it>

Reid Rivenburgh wrote:
[...]
> In my grammar, I've defined 
> a searchTerms parser rule, which is one or more searchTerm:
> 
> 	searchTerm+;
> 
> searchTerm matches a SEARCH_TERM token, which can be a number or word 
> (with some special characters like '*' allowed).  The number is the 
> usual definition for a floating point number:
> 
> 	('-'|'+')?((DIGIT+)|(DIGIT*'.'DIGIT+));
> 
> which I hope is correct.  (DIGIT is the fragment 0..9.)  I'm also 
> sending whitespace to the HIDDEN channel, as is often recommended.  It 
> seems like a side effect of this is that this input:
> 
> 4.66.34
> 
> which isn't a valid number, gets parsed as two different terms: 4.66 and 
> .34.  Is there some way to require whitespace between my search terms so 
> that input isn't allowed?  When I was parsing words, this wasn't a 
> problem.  I wouldn't be surprised if my design is a bit wrong still, and 
> that's what's put me in this position.

I would say that in most languages this problem doesn't arise because 
the syntax doesn't allow two numbers in a row. If this is the case also 
in your language, you should express it in your grammar. Otherwise you 
may want to recognize numbers with more than one decimal point, but mark 
them as errors, e.g. assuming you defined a boolean error variable in an 
appropriate place:

('-'|'+')?((DIGIT+)|(DIGIT*'.'DIGIT+(('.'DIGIT+) { error = true; )*));

Here's a larger example of this approach, also due to Jim Idle: 
http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point%2C+dot%2C+range%2C+time+specs

Hope this helps.

Cheers,
Nicola Musatti

-- 
La presente comunicazione potrebbe contenere informazioni riservate e/o protette
da segreto professionale ed e' indirizzata esclusivamente ai destinatari della
medesima qui indicati. Se avete ricevuto per errore la presente comunicazione,
siete invitati a segnalarcelo, rispondendo a questo stesso indirizzo di e-mail,
e a cancellare il presente messaggio dal Vostro sistema. E' strettamente proibito
e potrebbe essere fonte di violazione di legge qualsiasi uso, comunicazione, copia
o diffusione dei contenuti di questa comunicazione da parte di chi la abbia
ricevuta per errore o in violazione degli scopi della presente.
Il messaggio e' stato analizzato alla ricerca di virus o contenuti pericolosi
ed e' risultato NON infetto.


From hugo.pcd at gmail.com  Mon Oct 12 02:38:57 2009
From: hugo.pcd at gmail.com (Hugo Picado)
Date: Mon, 12 Oct 2009 10:38:57 +0100
Subject: [antlr-interest] [SOLVED] ANTLR3 C runtime in HP-UX
Message-ID: <3c2632090910120238r71904eadpe800019e56d39a41@mail.gmail.com>

Hi,

When compiling libantlr3c-3.2 in HP-UX it gives the following error:

Error 172: "src/antlr3debughandlers.c", line 302 # Undeclared variable
'TCP_NODELAY'.
                    setsockopt(delboy->socket, SOL_SOCKET, TCP_NODELAY,
(const void *)&optVal, sizeof(optVal));


To solve this problem it is enough to have the following include in the file
src/antlr3debughandlers.c:

#include  <netinet/tcp.h>


Terence, please consider this in a next release.

Best regards,
Hugo.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091012/83f9f167/attachment.html 

From arne.schroeder at gmail.com  Mon Oct 12 02:47:25 2009
From: arne.schroeder at gmail.com (=?ISO-8859-1?Q?Arne_Schr=F6der?=)
Date: Mon, 12 Oct 2009 11:47:25 +0200
Subject: [antlr-interest] MismatchedTokenException in loop
Message-ID: <d972facc0910120247q246a6afdje5ee4c1ec4a50cc1@mail.gmail.com>

Hi,

I am trying to parse the following input:

[
   MSG1:
   MSG2: cmd1 cmd2
   MSG3: cmd3
]

which means on MSG1 and MSG2 commands cmd1 and cmd2 should be executed, on
MSG3 the command cmd3 should be executed.

I tried the following grammar:

grammar msg_test;
msg_list: LSQUARE msg_impl* RSQUARE ;
msg_impl: (ID COLON)+ stmnt* ;
stmnt   : ID | INT ;
LSQUARE : '[' ;
RSQUARE : ']' ;
COLON   : ':' ;
ID      : ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*;
INT     : '0'..'9'+;
WS      : ( ' ' | '\t' | '\r' | '\n' ) {$channel=HIDDEN;};

But this results in the following warning:
[10:59:35] warning(200): msg_test.g:3:20: Decision can match input such as
"ID" using multiple alternatives: 1, 2

When I run the parser I get a MismatchedTokenException on cmd2.

When changing msg_impl by removing + to

msg_impl: (ID COLON) stmnt* ;

the parser works fine (no warnings, the input is being parsed), but the
"connection" between MSG1 and MSG2 is lost and I cannot create an AST-Node
containing all messages that should be handled the same way.

It seems as if the COLON is not used in the stmnt* lookahead part to break
out of the loop. Why? Can I force it somehow?

Thanks for help and best regards
Christian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091012/5610f61e/attachment.html 

From martin.potier at gmail.com  Mon Oct 12 05:14:23 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Mon, 12 Oct 2009 14:14:23 +0200
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
Message-ID: <4AD31D9F.9060106@gmail.com>

Hi,

There's something I can't explain : in the lexer, a terminal defined
with '[' is perfectly matched. If i modify it to '[[' it is ignored. Did
I miss something ?

Is that a remaining behaviour from ANTLR 2 ?

Thanks

--
Martin

From indhu.b at s7software.com  Mon Oct 12 05:23:43 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Mon, 12 Oct 2009 17:53:43 +0530
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
In-Reply-To: <4AD31D9F.9060106@gmail.com>
References: <4AD31D9F.9060106@gmail.com>
Message-ID: <005201ca4b36$d75e5040$861af0c0$@b@s7software.com>

Can you post a small sample where the problem exists?

 

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Potier
Sent: Monday, October 12, 2009 5:44 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?

 

Hi,

 

There's something I can't explain : in the lexer, a terminal defined

with '[' is perfectly matched. If i modify it to '[[' it is ignored. Did

I miss something ?

 

Is that a remaining behaviour from ANTLR 2 ?

 

Thanks

 

--

Martin

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest

Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091012/ea756bb9/attachment.html 

From martin.potier at gmail.com  Mon Oct 12 05:28:54 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Mon, 12 Oct 2009 14:28:54 +0200
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
In-Reply-To: <005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
References: <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
Message-ID: <4AD32106.1040704@gmail.com>

certainly :


link
	: LO PURETEXT ('|' PURETEXT)? LE
	;


LO	: '[[';		// Link opening
LE	: ']]';		// Link ending

PURETEXT
	:  ( ESC_SEQ | ~('\\'|TM1|TM2|TM3|TM4|ULM|LO|LE|OLM|BM|IM|UM|'|'|'\n') )+
	;


Indhu Bharathi a ?crit :
> Can you post a small sample where the problem exists?
> 
>  
> 
>  
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Potier
> Sent: Monday, October 12, 2009 5:44 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
> 
>  
> 
> Hi,
> 
>  
> 
> There's something I can't explain : in the lexer, a terminal defined
> 
> with '[' is perfectly matched. If i modify it to '[[' it is ignored. Did
> 
> I miss something ?
> 
>  
> 
> Is that a remaining behaviour from ANTLR 2 ?
> 
>  
> 
> Thanks
> 
>  
> 
> --
> 
> Martin
> 
>  
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> 
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 

From indhu.b at s7software.com  Mon Oct 12 05:35:36 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Mon, 12 Oct 2009 18:05:36 +0530
Subject: [antlr-interest] MismatchedTokenException in loop
In-Reply-To: <d972facc0910120247q246a6afdje5ee4c1ec4a50cc1@mail.gmail.com>
References: <d972facc0910120247q246a6afdje5ee4c1ec4a50cc1@mail.gmail.com>
Message-ID: <005701ca4b38$810af070$8320d150$@b@s7software.com>

You can get what you want by changing ?msg_impl? rule to 

 

msg_impl

                : ( (ID COLON)=> ID COLON)+ stmnt* 

                ;

 

This way the parser with look ahead to see if there is a COLON before it
matches the text with ?ID COLON?.

 

Though the above solution will fix your problem, I?m not sure if this is an
elegant way of fixing this problem. I would vote for parser checking only
the syntax and the symantics handled by tree walkers. You can establish the
relation between messages while tree walking.

 

Cheers,

 

Indhu Bharathi

 <http://www.s7software.com/> S7 Software Solutions

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Arne Schr?der
Sent: Monday, October 12, 2009 3:17 PM
To: ANTLR-Mailing-List
Subject: [antlr-interest] MismatchedTokenException in loop

 

Hi,

I am trying to parse the following input:

[
   MSG1:
   MSG2: cmd1 cmd2
   MSG3: cmd3
]

which means on MSG1 and MSG2 commands cmd1 and cmd2 should be executed, on
MSG3 the command cmd3 should be executed.

I tried the following grammar:

grammar msg_test;    
msg_list: LSQUARE msg_impl* RSQUARE ;
msg_impl: (ID COLON)+ stmnt* ;
stmnt   : ID | INT ;
LSQUARE : '[' ;    
RSQUARE : ']' ;
COLON   : ':' ;
ID      : ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*;
INT     : '0'..'9'+;
WS      : ( ' ' | '\t' | '\r' | '\n' ) {$channel=HIDDEN;};

But this results in the following warning:
[10:59:35] warning(200): msg_test.g:3:20: Decision can match input such as
"ID" using multiple alternatives: 1, 2

When I run the parser I get a MismatchedTokenException on cmd2. 

When changing msg_impl by removing + to 

msg_impl: (ID COLON) stmnt* ;

the parser works fine (no warnings, the input is being parsed), but the
"connection" between MSG1 and MSG2 is lost and I cannot create an AST-Node
containing all messages that should be handled the same way.

It seems as if the COLON is not used in the stmnt* lookahead part to break
out of the loop. Why? Can I force it somehow?

Thanks for help and best regards
Christian

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091012/0355b6b2/attachment.html 

From martin.potier at gmail.com  Mon Oct 12 06:59:37 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Mon, 12 Oct 2009 15:59:37 +0200
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
In-Reply-To: <005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
References: <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
Message-ID: <4AD33649.4010708@gmail.com>

I pasted the whole grammar.
http://pastebin.com/m3ef40d4a

I someone know how to fix this, please tell me.
It's been 3 days already that I'm trying to understand why this won't
work as expected.

--
Martin

Indhu Bharathi a ?crit :
> Can you post a small sample where the problem exists?
> 
>  
> 
>  
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Potier
> Sent: Monday, October 12, 2009 5:44 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
> 
>  
> 
> Hi,
> 
>  
> 
> There's something I can't explain : in the lexer, a terminal defined
> 
> with '[' is perfectly matched. If i modify it to '[[' it is ignored. Did
> 
> I miss something ?
> 
>  
> 
> Is that a remaining behaviour from ANTLR 2 ?
> 
>  
> 
> Thanks
> 
>  
> 
> --
> 
> Martin
> 
>  
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> 
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 

From martin.potier at gmail.com  Mon Oct 12 07:19:34 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Mon, 12 Oct 2009 16:19:34 +0200
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
In-Reply-To: <005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
References: <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
Message-ID: <4AD33AF6.7090508@gmail.com>

Actually I have the same issue with any double symbol I use.
It works with [ but not with [[, with $ but not with $$, etc.

--
Martin

From antlr at mirality.co.nz  Mon Oct 12 10:28:47 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 13 Oct 2009 06:28:47 +1300
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
In-Reply-To: <4AD32106.1040704@gmail.com>
References: <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
	<4AD32106.1040704@gmail.com>
Message-ID: <20091012172919.13B103418417@www.antlr.org>

At 01:28 13/10/2009, Martin Potier wrote:
 >LO	: '[[';		// Link opening
 >LE	: ']]';		// Link ending
 >
 >PURETEXT
 >	:  ( ESC_SEQ |
 >~('\\'|TM1|TM2|TM3|TM4|ULM|LO|LE|OLM|BM|IM|UM|'|'|'\n') )+
 >	;

~ is a set operation; at the lexer level, you can only use single 
characters (or rules that result in simple alternatives of single 
characters).

Thus if you want to exclude '[['/']]' from the rule while keeping 
'['/']', you'll need to use this instead (assuming all the others 
are single characters):

PURETEXT
   : ( ESC_SEQ
     | '[' ~'['
     | ']' ~']'
     | ~('\\'|TM1|TM2|TM3|TM4|ULM|'['|']'|OLM|BM|IM|UM|'|'|'\n')
     )+
   ;


From joanpujol at gmail.com  Mon Oct 12 14:19:59 2009
From: joanpujol at gmail.com (Joan Pujol)
Date: Mon, 12 Oct 2009 23:19:59 +0200
Subject: [antlr-interest] I can't understand lexer behaivour. Lexers are
	LL(*)?
Message-ID: <d2d18a10910121419x50451e7fta4245801d0ddb04b@mail.gmail.com>

Hi,

I've a problem with the lexer. Given that grammar:


TEXT	:	(~'$' | '$' ~'{')+;
OTHER	:	 .;
program	:	(TEXT|OTHER)+;

If I try with input     'Hola ${ ' it does'nt works. And I can't understand why.
If I look at generated code of rule TEXT it doesn't use a lookahead of
 2. In fact when it finds a '$' it enters in the subrule '$' ~'{
without using LA(2) to see that the next caracter is a { and that then
it can't enter the subrule.
In fact as it only compares LA(1)='$' it enters the subrule but then
when it founds the{ it fails with a lexical error.

And I can't understand why the lexer isn't capable to generate code to
compare with LA(1)='$' and LA(2)!='{' to enter the subrule.

Is that the correct behaivour? Why de lexer can aproximate the K=2?
Someone can explain why?

A lot of thanks in advance,




-- 
Joan Jes?s Pujol Espinar
http://www.joanpujol.cat
http://lujop.deviantart.com

From gwlist at grahamwideman.com  Mon Oct 12 14:52:27 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Mon, 12 Oct 2009 14:52:27 -0700
Subject: [antlr-interest] Gavin: Lexer 2-char seq handling
In-Reply-To: <20091012172919.13B103418417@www.antlr.org>
References: <4AD32106.1040704@gmail.com> <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
	<4AD32106.1040704@gmail.com>
Message-ID: <4.1.20091012144513.02d30198@grahamwideman.com>

Hi Gavin (and Joan and Martin):

In the last couple of days you've advised on how to handle lexer rules that eat a sequence of chars that should stop when it gets to some 2-char sequence:

']]' in Martin's case
'${' in Joan's case

In looking into this, I see the same thing in the generated code that Joan reports: Namely that the rule handling eating the string doesn't look ahead to see the second character during the "select an alternative" phase, so tries to eat it, but then in the "match and consume" phase it does detect that the not-part-of-this-rule character-pair is there, and throws an exception.

You clearly expect this to work -- is there some extra nuance to this? Like a particular option that must be set?

FWIW, using ANTLR 3.2.

Thanks,

Graham


From legoharyanto at gmail.com  Mon Oct 12 15:21:12 2009
From: legoharyanto at gmail.com (Lego Haryanto)
Date: Mon, 12 Oct 2009 15:21:12 -0700
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
Message-ID: <45418a3a0910121521j4def4ev3f9caaaea5772b4c@mail.gmail.com>

I just recently noticed that the generated code from my lexer grammar
contains something like the following snippet:

            .
            .
            else if ( (((LA17_0 >= 'A') && (LA17_0 <= 'Z'))) )
            {
                alt17=2;
            }
            else if ( (((LA17_0 >= 'a') && (LA17_0 <= 'z'))) )
            {
                alt17=3;
            }
            else if ( (((LA17_0 >= 0x00A0) && (LA17_0 <= 0xD7FF))) )
            {
                alt17=4;
            }
            .
            .

The generated code seems to comfortably use 'A' ... 'Z' literals.  This may
not be good if let's say I compile the generated code in an IBM z/OS EBCDIC
environment as ['A' .. 'Z'] range contains more than just the 26 alphabet
codes and the value of the codes are not the same as the ones in Unicode
character set.

I'm expecting something like in the third expression where 'A' is written
explicitly as 0x0041 (Unicode for 'A').

Please confirm.

-Lego
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091012/76847c2b/attachment.html 

From kirby.bohling at gmail.com  Mon Oct 12 16:02:05 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Mon, 12 Oct 2009 18:02:05 -0500
Subject: [antlr-interest] I can't understand lexer behaivour. Lexers are
	LL(*)?
In-Reply-To: <d2d18a10910121419x50451e7fta4245801d0ddb04b@mail.gmail.com>
References: <d2d18a10910121419x50451e7fta4245801d0ddb04b@mail.gmail.com>
Message-ID: <3cac8fdf0910121602j438f374fhae72c8e9bb950a03@mail.gmail.com>

On Mon, Oct 12, 2009 at 4:19 PM, Joan Pujol <joanpujol at gmail.com> wrote:
> Hi,
>
> I've a problem with the lexer. Given that grammar:
>
>
> TEXT ? ?: ? ? ? (~'$' | '$' ~'{')+;
> OTHER ? : ? ? ? ?.;
> program : ? ? ? (TEXT|OTHER)+;
>
> If I try with input ? ? 'Hola ${ ' it does'nt works. And I can't understand why.
> If I look at generated code of rule TEXT it doesn't use a lookahead of
> ?2. In fact when it finds a '$' it enters in the subrule '$' ~'{
> without using LA(2) to see that the next caracter is a { and that then
> it can't enter the subrule.
> In fact as it only compares LA(1)='$' it enters the subrule but then
> when it founds the{ it fails with a lexical error.
>
> And I can't understand why the lexer isn't capable to generate code to
> compare with LA(1)='$' and LA(2)!='{' to enter the subrule.
>
> Is that the correct behaivour? Why de lexer can aproximate the K=2?
> Someone can explain why?
>
> A lot of thanks in advance,
>


There are far too many threads that refer to the FAQ entry, but not
enough actual links (I've always found it hard to find while searching
the FAQ, maybe I'm just blind or something).

See here:
http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point,+dot,+range,+time+specs

This is a common problem.  Terrance gave some discussion in this thread:

http://www.antlr.org/pipermail/antlr-interest/2007-October/024273.html

It'd be great if the lexer would emit errors/warnings noting that
there is input that can end in a no mans land and the lexer will blow
up.  I don't think it will do that as of 3.1.3 (I haven't played with
newer versions).

The crux of the problem is (with my limited understanding):  Once the
lexer/DFA decides: "A longer match *MIGHT* exist", there is no more
backing up, or use a rule that matched the longest prefix so far.  So
if a rule looks like it might match longer input, the rules that match
the shorter input are thrown away.  A trivial case would be something
like this:

(From memory, I haven't actually put this into ANTLRWorks, but I know
I've seen something similar to this setup have problems where
lookahead was the only solution):
ONE_BRACE: '{';
THREE_BRACE: '{{{';


If you feed it the input of '{{', it will blow up upon inside the
lexer, despite the fact that the would would match ONE_BRACE,
ONE_BRACE.  Once the lexer/DFA decides, there have been enough braces
that it could match a longer rule then ONE_BRACE any more, the lexer
will never emit "ONE_BRACE"...  So the THREE_BRACE is all that is
left, once the "match" is called, it gives some type of
RecognitionException.  It might work around that if backtracking is
enabled, I'm not sure.  I know I've had problems like this where
enabling backtracking resolved some of them, but not others.  It's
annoying, but ANTLR is useful enough I just get over it.

I'm assuming that the it is because the '$' ~'{' is longer and could
match, so the lexer/DFA has decided that the OTHER rule is no longer
an option.  You might try manually using the lookahead or a predicate
like the following:

// Syntactic Predicate I believe
TEXT    :       (~'$' |  ('$' ~'{') => ('$' ~'{'))+;

// or

// Semantic Predicate implementing simple look ahead I believe
TEXT    :       (~'$' | { input.LA(1) == '$' && input.LA(2) != '{' } |  '$')+;

The first one is slower, but I believe more portable, the second one
is faster, but the lexer will have to be adjusted for each language
target (the first one would work in the Java and C targets, the second
one would only work in the Java target as I understand it).

Cheers,
   Kirby


>
>
>
> --
> Joan Jes?s Pujol Espinar
> http://www.joanpujol.cat
> http://lujop.deviantart.com
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From joanpujol at gmail.com  Mon Oct 12 16:42:00 2009
From: joanpujol at gmail.com (Joan Pujol)
Date: Tue, 13 Oct 2009 01:42:00 +0200
Subject: [antlr-interest] I can't understand lexer behaivour. Lexers are
	LL(*)?
In-Reply-To: <3cac8fdf0910121602j438f374fhae72c8e9bb950a03@mail.gmail.com>
References: <d2d18a10910121419x50451e7fta4245801d0ddb04b@mail.gmail.com>
	<3cac8fdf0910121602j438f374fhae72c8e9bb950a03@mail.gmail.com>
Message-ID: <d2d18a10910121642k3ad43ddco2d3c8e3a5407f454@mail.gmail.com>

Thanks Kirby,

But if that is correct the lexer is LL(1), isn't it?
I think that for my grammar (~'$' | '$' ~'{')+ only LL(2) is needed to
see (without any backtracking) which is the correct rule, isn't it?

I've read the old thread you said but still I don't understand what is
the exact logic of the lexer. And why it needs the syntactic
predicates in my case.
In the old thread someone points that lexer rules can't see other
rules, but in my case the lexer only needs to see that rule to view
that when it encounters ${ it has to end the token because there are
no alternatives to continue the token.


Cheers,

On Tue, Oct 13, 2009 at 1:02 AM, Kirby Bohling <kirby.bohling at gmail.com> wrote:
> On Mon, Oct 12, 2009 at 4:19 PM, Joan Pujol <joanpujol at gmail.com> wrote:
>> Hi,
>>
>> I've a problem with the lexer. Given that grammar:
>>
>>
>> TEXT ? ?: ? ? ? (~'$' | '$' ~'{')+;
>> OTHER ? : ? ? ? ?.;
>> program : ? ? ? (TEXT|OTHER)+;
>>
>> If I try with input ? ? 'Hola ${ ' it does'nt works. And I can't understand why.
>> If I look at generated code of rule TEXT it doesn't use a lookahead of
>> ?2. In fact when it finds a '$' it enters in the subrule '$' ~'{
>> without using LA(2) to see that the next caracter is a { and that then
>> it can't enter the subrule.
>> In fact as it only compares LA(1)='$' it enters the subrule but then
>> when it founds the{ it fails with a lexical error.
>>
>> And I can't understand why the lexer isn't capable to generate code to
>> compare with LA(1)='$' and LA(2)!='{' to enter the subrule.
>>
>> Is that the correct behaivour? Why de lexer can aproximate the K=2?
>> Someone can explain why?
>>
>> A lot of thanks in advance,
>>
>
>
> There are far too many threads that refer to the FAQ entry, but not
> enough actual links (I've always found it hard to find while searching
> the FAQ, maybe I'm just blind or something).
>
> See here:
> http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point,+dot,+range,+time+specs
>
> This is a common problem. ?Terrance gave some discussion in this thread:
>
> http://www.antlr.org/pipermail/antlr-interest/2007-October/024273.html
>
> It'd be great if the lexer would emit errors/warnings noting that
> there is input that can end in a no mans land and the lexer will blow
> up. ?I don't think it will do that as of 3.1.3 (I haven't played with
> newer versions).
>
> The crux of the problem is (with my limited understanding): ?Once the
> lexer/DFA decides: "A longer match *MIGHT* exist", there is no more
> backing up, or use a rule that matched the longest prefix so far. ?So
> if a rule looks like it might match longer input, the rules that match
> the shorter input are thrown away. ?A trivial case would be something
> like this:
>
> (From memory, I haven't actually put this into ANTLRWorks, but I know
> I've seen something similar to this setup have problems where
> lookahead was the only solution):
> ONE_BRACE: '{';
> THREE_BRACE: '{{{';
>
>
> If you feed it the input of '{{', it will blow up upon inside the
> lexer, despite the fact that the would would match ONE_BRACE,
> ONE_BRACE. ?Once the lexer/DFA decides, there have been enough braces
> that it could match a longer rule then ONE_BRACE any more, the lexer
> will never emit "ONE_BRACE"... ?So the THREE_BRACE is all that is
> left, once the "match" is called, it gives some type of
> RecognitionException. ?It might work around that if backtracking is
> enabled, I'm not sure. ?I know I've had problems like this where
> enabling backtracking resolved some of them, but not others. ?It's
> annoying, but ANTLR is useful enough I just get over it.
>
> I'm assuming that the it is because the '$' ~'{' is longer and could
> match, so the lexer/DFA has decided that the OTHER rule is no longer
> an option. ?You might try manually using the lookahead or a predicate
> like the following:
>
> // Syntactic Predicate I believe
> TEXT ? ?: ? ? ? (~'$' | ?('$' ~'{') => ('$' ~'{'))+;
>
> // or
>
> // Semantic Predicate implementing simple look ahead I believe
> TEXT ? ?: ? ? ? (~'$' | { input.LA(1) == '$' && input.LA(2) != '{' } | ?'$')+;
>
> The first one is slower, but I believe more portable, the second one
> is faster, but the lexer will have to be adjusted for each language
> target (the first one would work in the Java and C targets, the second
> one would only work in the Java target as I understand it).
>
> Cheers,
> ? Kirby
>
>
>>
>>
>>
>> --
>> Joan Jes?s Pujol Espinar
>> http://www.joanpujol.cat
>> http://lujop.deviantart.com
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>



-- 
Joan Jes?s Pujol Espinar
http://www.joanpujol.cat
http://lujop.deviantart.com

From gwlist at grahamwideman.com  Mon Oct 12 17:33:18 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Mon, 12 Oct 2009 17:33:18 -0700
Subject: [antlr-interest] More on Lexer 2-char seq handling
In-Reply-To: <4.1.20091012144513.02d30198@grahamwideman.com>
References: <20091012172919.13B103418417@www.antlr.org>
	<4AD32106.1040704@gmail.com> <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
	<4AD32106.1040704@gmail.com>
Message-ID: <4.1.20091012172016.02d30198@grahamwideman.com>

Hi folks:

Further to the discussion on lexer matching sequence that should stop before some multi-character pattern:

I read Kirby's post with interest, including the list discussions pointed to.  I'm not sure what to make of it.  The oddity to me is that ANTLR *almost* generates the right things:

1. mTokens does the right thing.

2. The lexer rule code that matches/consumes the string in question does look ahead and see the error it would make if it consumed the end-before-this pattern.

3. ANTLR just doesn't generate the code to look ahead and *predict* that it should *stop*, it only looks ahead enough to predict which alternative *might* succeed based on the first character.

Making matters quite odd is that you can fake ANTLR into generating the correct look-ahead, though not completely desirable code, as shown below:

In his last post Gavin recommended how to fix Martin Potier's PURETEXT token rule:
-------------------------
PURETEXT: 
  ( 
      '[' ~'['
    | ']' ~']'
    | ~('\\' | '[' | ']' | '|' | '\n' )
  )+ 
 ;
-------------------------
(I removed mentions of tokens that Martin didn't give a definition for).

However, this fails in the manner described above.  Instead, the grammar below contains a solution of sorts.

-------------------------
grammar Potier;

links: link+
 ;

link:
  LO PURETEXT ('|' PURETEXT)? LE 
    {System.out.println("Link: " + $link.text); }
  ;

LO	: '[[';		// Link opening
LE	: ']]';		// Link ending

PURETEXT: 
  ( 
      '[' ~'['
    | ']' ~']'
    | ~('\\' | '[' | ']' | '|' | '\n' )
  )+ 
  ']]'   // And delete the match("]]") from gen code
 ;
-------------------------

The only thing I've added is the additional requirement that PURETEXT end with ']]'. This prompts ANTLR to generate LA(2) lookahead prediction code for the ()+ block, and break out on seeing ']]' coming up.  

Now of course we don't want to include ']]' in PURETEXT, and this can be fixed by editing the match("]]"); out of the generated rule.

That results in the desired behavior, but obviously is a silly thing to have to do.

I have to admit that this seems like a problem with the algorithm that ANTLR uses to determine LA(>1) lookahead when generating the lexer code.

-- Graham










From gwlist at grahamwideman.com  Mon Oct 12 19:03:54 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Mon, 12 Oct 2009 19:03:54 -0700
Subject: [antlr-interest] More on Lexer 2-char seq handling
In-Reply-To: <4.1.20091012172016.02d30198@grahamwideman.com>
References: <4.1.20091012144513.02d30198@grahamwideman.com>
	<20091012172919.13B103418417@www.antlr.org>
	<4AD32106.1040704@gmail.com> <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
	<4AD32106.1040704@gmail.com>
Message-ID: <4.1.20091012185052.015f76d8@grahamwideman.com>

By way of completeness, here I add to my previous message a way to get ANTLR to generate a functioning rule method with the desired lookahead detection for "stop before this 2-char sequence", without hand editing the generated code.

Sticking with a variant of Martin Potier's grammar:

-------------------------------------
grammar Potier;

file: (link | PURETEXT)+
 ;

link:
  LO PURETEXT ('|' PURETEXT)? LE 
    {System.out.println("Link: " + $link.text); }
  ;

LO	: '[[';		// Link opening
LE	: ']]';		// Link ending

PURETEXT: 
  ( 
      '[' ~'['
    | ']' ~']'
    | ~('\\' | '[' | ']' | '|' | '\n' )
  )+ 
  ( (']]' | '[[') { input.seek( input.index()-2); })?  // Rewind the [[ or ]]
 ;
-------------------------------------

... which seems to properly digest input like:

  [[ghi]] tuv [[j[k]l]] qrs 

Outputing from the println:
  Link: [[ghi]]
  Link: [[j[k]l]]

In case it's not obvious, the key here is that the PURETEXT lexer rule *includes* the "stop before this" symbols, but then rewinds the stream (ie: seek back 2 chars).  For the example's sake, I made this optional ()? in case PURETEXT is used NOT within [[ ]].

Adding the "stop before this" part to PURETEXT causes the appropriate lookahead pattern match ("prediction") to get generated, so it seems very odd that this same code can't result from just:
-------------------
PURETEXT: 
  ( 
      '[' ~'['
    | ']' ~']'
    | ~('\\' | '[' | ']' | '|' | '\n' )
  )+
-------------------

... which instead generates code that is guaranteed to fail. Ie: it doesn't even produce code that could be construed as an alternate correct interpretation.

-- Graham


 





From david-sarah at jacaranda.org  Mon Oct 12 19:17:05 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 13 Oct 2009 03:17:05 +0100
Subject: [antlr-interest] More on Lexer 2-char seq handling
In-Reply-To: <4.1.20091012172016.02d30198@grahamwideman.com>
References: <20091012172919.13B103418417@www.antlr.org>	<4AD32106.1040704@gmail.com>
	<4AD31D9F.9060106@gmail.com>	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>	<4AD32106.1040704@gmail.com>
	<4.1.20091012172016.02d30198@grahamwideman.com>
Message-ID: <4AD3E321.5080609@jacaranda.org>

Graham Wideman wrote:
> Hi folks:
> 
> Further to the discussion on lexer matching sequence that should stop before some multi-character pattern:
> 
> I read Kirby's post with interest, including the list discussions pointed to.  I'm not sure what to make of it.  The oddity to me is that ANTLR *almost* generates the right things:
> 
> 1. mTokens does the right thing.
> 
> 2. The lexer rule code that matches/consumes the string in question does look ahead and see the error it would make if it consumed the end-before-this pattern.
> 
> 3. ANTLR just doesn't generate the code to look ahead and *predict* that it should *stop*, it only looks ahead enough to predict which alternative *might* succeed based on the first character.

Yes, I get the impression that ANTLR lexers use a weaker recognition
strategy than ANTLR parsers. The problems seem to occur when you try to do
something in a lexer, that would work in a parser (with tokens in place of
characters) only because of the stronger recognition strategy.

However, I haven't been able to find documentation of what exactly the
difference is -- the description of LL(*) in the 'Definitive Guide'
chapter 11 does not seem to make a distinction between lexing and parsing.
(It does say that ANTLR does not generate ambiguity warnings for a lexer
that it would generate for a parser, instead preferring rules that are
specified first in the grammar. But that doesn't seem to be relevant to
this lookahead issue.)

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From gwlist at grahamwideman.com  Mon Oct 12 19:45:52 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Mon, 12 Oct 2009 19:45:52 -0700
Subject: [antlr-interest] Does lexer EVER use longest match?
In-Reply-To: <4.1.20091012172016.02d30198@grahamwideman.com>
References: <4.1.20091012144513.02d30198@grahamwideman.com>
	<20091012172919.13B103418417@www.antlr.org>
	<4AD32106.1040704@gmail.com> <4AD31D9F.9060106@gmail.com>
	<005201ca4b36$d75e5040$861af0c0$@b@s7software.com>
	<4AD32106.1040704@gmail.com>
Message-ID: <4.1.20091012193814.031bcff8@grahamwideman.com>

Hi folks:

I've been scouring the list archives trying to scrape together a better understanding of what variants of lexer code ANTLR might generate.

I keep seeing assertions that ANTLR lexers use longest match to select between otherwise ambiguous alternatives, and other assertions that it doesn't.  

In the code I see generated, I don't see any longest match logic, but maybe it only appears under particluar grammar arrangements or options?

Or are people using "longest match" when they really mean "once mToken has chosen a rule, then that rule will act greedy" (unless greedy=false)?

I'd appreciate if someone could clarify with an example that shows where longest match comes into play.  Or confirm that ANTLR actually doesn't use that strategy?

Thanks,

Graham

From gwlist at grahamwideman.com  Tue Oct 13 02:19:08 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 13 Oct 2009 02:19:08 -0700
Subject: [antlr-interest] Does lexer EVER use longest match?
In-Reply-To: <3cac8fdf0910122113l2acdd734h5c64198eec796dfd@mail.gmail.co
 m>
References: <4.1.20091012193814.031bcff8@grahamwideman.com>
	<4.1.20091012144513.02d30198@grahamwideman.com>
	<20091012172919.13B103418417@www.antlr.org>
	<4AD31D9F.9060106@gmail.com> <4AD32106.1040704@gmail.com>
	<4.1.20091012172016.02d30198@grahamwideman.com>
	<4.1.20091012193814.031bcff8@grahamwideman.com>
Message-ID: <4.1.20091013015256.02ef2f60@grahamwideman.com>

(Kirby sent me a lengthy email on observations about ANTLR's lexer behavior, prompting me to nose around some more...)

Thanks Kirby for your lengthy comments.

Actually, I guess I was aware that mToken would indeed choose the longest *fixed-length* alternative -- what I was really puzzling over was patterns where the length of the match isn't fixed -- so some pattern with repeats or alternate combinations in the middle.

I now see that doing this can prompt ANTLR to produce a DFA for mToken to use (instead of ifs and switches), and this indeed seems to be able to find the longest match for alternative variable-length patterns.  Example:

-------------------------------
grammar Test02;

file
  : (X1 | X2 | X3 | X4 | X5 | X6)+ EOF
  ;

X1: 'ab';
X2: 'cd';
X3: 'ef';
X4: 'xy'; 
X5: 'abc' .* 'pq';
X6: X1 .* X4;
-------------------------------
(And noting the special non-greedy behavior of .*)

This correctly eats: 'abcdefpqxy' as X6, despite the possibility of getting sidetracked onto X5.

OK, I think I'm satisfied on this particular point. Within the scope of the lexer, it does at least make an effort to choose the longest match. I'm not sure what limitations there may be on this. (And obviously since lexing is independent of parsing, ANTLR's code does not make alternative lexer decisions based on ability to *parse* a larger chunk.)

-- Graham




From kirby.bohling at gmail.com  Tue Oct 13 02:49:06 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Tue, 13 Oct 2009 04:49:06 -0500
Subject: [antlr-interest] Fwd:  Does lexer EVER use longest match?
In-Reply-To: <3cac8fdf0910122113l2acdd734h5c64198eec796dfd@mail.gmail.com>
References: <4.1.20091012144513.02d30198@grahamwideman.com> 
	<20091012172919.13B103418417@www.antlr.org>
	<4AD31D9F.9060106@gmail.com> <4AD32106.1040704@gmail.com>
	<4.1.20091012172016.02d30198@grahamwideman.com> 
	<4.1.20091012193814.031bcff8@grahamwideman.com>
	<3cac8fdf0910122113l2acdd734h5c64198eec796dfd@mail.gmail.com>
Message-ID: <3cac8fdf0910130249o213cd904w763ab5b74bddff8b@mail.gmail.com>

Oops!  I meant to reply to the list, thanks for pointing out I failed
to do that.

On Mon, Oct 12, 2009 at 9:45 PM, Graham Wideman
<gwlist at grahamwideman.com> wrote:
> Hi folks:
>
> I've been scouring the list archives trying to scrape together a better understanding of what variants of lexer code ANTLR might generate.
>
> I keep seeing assertions that ANTLR lexers use longest match to select between otherwise ambiguous alternatives, and other assertions that it doesn't.
>
> In the code I see generated, I don't see any longest match logic, but maybe it only appears under particluar grammar arrangements or options?
>
> Or are people using "longest match" when they really mean "once mToken has chosen a rule, then that rule will act greedy" (unless greedy=false)?
>
> I'd appreciate if someone could clarify with an example that shows where longest match comes into play. ?Or confirm that ANTLR actually doesn't use that strategy?
>

I believe it does use longest match, it can easily handle:

OPEN_TABLE: '{|';
OPEN_TEMPLATE: '{{';
OPEN_FUNC: '{{{';
OPEN_CURLY: '{';

It'll handle all of those without issue and '{{{' will generate
OPEN_FUNC not OPEN_TEMPLATE followed by OPEN_CURLY, or 3 OPEN_CURLY's.
?In fact, I don't think you even have to put them in the "proper"
order. ?The big difference here is that there is no series of
characters where in the middle, it is invalid. ?That is the problem
with most of these. ?Folks expect that the lexer will backout to the
last valid point if there is a point where it could have previously
exited cleanly. ?That just isn't the case. ?The lexer finishes what it
starts, or errors out. ?So don't let it start something unless you
know it can successfully finish it.

As to another threads assertion that the lexer is LL(1), that is not
the case. ?If two lexer rules match for 20 characters, the lexer will
look ahead 21 character to identify which rule it is. ?As long as it
is not LL ambiguous, I believe it's no big deal. ?To prove that try
doing:

FA: .. 'a';
FB: .. 'b';
F_OTHER: .. ~('a'|'b');
start: (FA|FB|F_OTHER)+ EOF;

Put in 'ffa', 'ffb' 'ffc' and that should return FA, FB, F_OTHER
respectively, and in this case, it had to look ahead at least 3
characters to determine which rule it is. ?It'll blow up if you don't
have a multiple of 3 characters, but that is a different problem
(starting something it can't finish).

So if you have rules like:

TILDA: '~'
T3: '~~~';
T4: '~~~~';
T5: '~~~~~';

If you give it input of '~', '~~~', '~~~~', '~~~~~', and '~~~~~~', it
will do what you expect (TILDA, T3, T4, T5, and T5 followed by TILDA
respectively). ?However, the input of '~~' will screw up the lexer and
cause an exception.

I believe this is because each rule is thrown out once it no longer
matches. ?So on the first '~', the DFA knows that all 4 rules are
potential outcomes. ?Once it sees the second '~', it knows that only
T3, T4, or T5 are valid inputs. ?The next input is EOF, which isn't a
valid option for any of the existing live rules, so the lexer punts an
error/exception.

You can easily use lookahead to make T3, T4, T5 invalid rules if there
aren't enough TILDA's prior to matching the first character, options
T3, T4, T5 are eliminated by the lookahead, TILDA is the only valid
option. ?Upon the second '~', it doesn't match TILDA any longer and
TILDA was the last valid rule, so emit TILDA (had there been multiple
valid rules, it would have emitted the first one listed). ?So emit one
TILDA and start lexing with the second '~' character.

The problem is when the lexer is "mid-rule", and then has a mismatch.
It does not go back to the last valid match at a boundary (in this
case above with no look ahead predicates, it would not fall back to a
single '~' and emit TILDA). ?It is not at the end of *ANY* rule when
the EOF is the next character from the Lexer. ?So you aren't at a
valid boundary case of any lexer rule, and the next character makes
all of the currently valid alternatives fail the lexer errors out.
This is also why Joan Pujol's lexer is having issues, in the other
thread. ?The '$' character matches but the following '{' can't be
matched, and is not at a valid boundary condition. ?Thus an exception
(the OTHER rule can only match one character, so by the second
character it is no longer a valid option, so TEXT was the only option,
it started the second alternative, and couldn't finish it).

I think if you generate the NFA/DFA's for the lexer, a lot of this
becomes more apparent, but I've always had problems. ?Until sitting
down and thinking clearly about this and the problems I've had, the
lexer was mostly black magic.

Now if you enable backtracking on the lexer, it'll help with some of
these problems. ?I can't say for sure what backtracking will do in the
lexer, but I know it does change behavior.

Hopefully somebody will correct me if I'm wrong, but with the problems
I've seen, and the solutions I've cooked up to work around them, I
believe this to be a mostly accurate description.

None of this is because I understand LL(*) parsing, it is mostly
empirically gained knowledge by screwing with a lexer that has lots of
these types of problems. ?In the end, it's almost always easier to lex
single characters if it is ambiguous and you need context to figure it
out. ?Deal with it in the parser, where backtracking works just like
you think it does. ?I ended up throwing away all of the "{{{", "{{",
"{", and "{|" in the grammar I was working on and just lexed each "{"
and "|" separately, and then parsed them and created imaginary tokens.

Cheers,
? Kirby

> Thanks,
>
> Graham
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From yurushkin at rambler.ru  Tue Oct 13 03:37:22 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Tue, 13 Oct 2009 14:37:22 +0400
Subject: [antlr-interest] caseSensitive = false in C taget ??
Message-ID: <op.u1qigkp7t3jqlu@win-mupvrp0jyrf>

this option doesn't work. But i want to use it... what can i do?


-- 
Best regards,
Michael

From indhu.b at s7software.com  Tue Oct 13 03:57:31 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Tue, 13 Oct 2009 16:27:31 +0530
Subject: [antlr-interest] caseSensitive = false in C taget ??
In-Reply-To: <op.u1qigkp7t3jqlu@win-mupvrp0jyrf>
References: <op.u1qigkp7t3jqlu@win-mupvrp0jyrf>
Message-ID: <011801ca4bf3$f6e0bc60$e4a23520$@b@s7software.com>

AFAIK, there is no shortcut.

You will have to write something like

HELLO	:	( ('H'|'h') ('E'|'e') ('L'|'l') ('L'|'l') ('O'|'o') )
	;


You can make it more readable using fragments.

HELLO : H E L L O

fragment H: ('H'|'h')

fragment E: ('E'|'e')

fragment L: ('L'|'l')

fragment O: ('O'|'o')


If you don't care about case in the complete text, you can consider creating
your own Stream subclassing StringStream or write a wrapper on top of it and
emit all characters in lower case. Then you parser needs to handle only
lower case.

Cheers, Indhu


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of ??????? ??????
Sent: Tuesday, October 13, 2009 4:07 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] caseSensitive = false in C taget ??

this option doesn't work. But i want to use it... what can i do?


-- 
Best regards,
Michael

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From antlr_bill at yeah.net  Tue Oct 13 07:51:45 2009
From: antlr_bill at yeah.net (antlr_bill)
Date: Tue, 13 Oct 2009 22:51:45 +0800 (CST)
Subject: [antlr-interest] can i do it like this ?
Message-ID: <842542834.182781255445505752.JavaMail.coremail@app8.yeah.net>

Hi All,
I am still thinking about how to write the grammer ,after some research ,i found the grammer is always too complicated cause it need to parse the complicated sources ,so surely we need to write the grammer all manually .
but how about the tree grammer ? can I simply copy all the grammer into the tree grammer file and include them by ^(   ),also add an imaginary node . like this :
//here is a  grammer which meet a class or an interface of Java source

classOrInterace:
       PUBLIC? (INTERFACE | CLASS ) IDENTIFIER '{'
       classOrInterfaceBody
       '}'
;
so here can I write a tree grammer for this rule as below ?
classOrInterace:
       PUBLIC? (INTERFACE | CLASS ) IDENTIFIER '{'
       classOrInterfaceBody
       '}'
-> ^( CLASS_OR_INTERFACE PUBLIC? (INTERFACE | CLASS ) IDENTIFIER classOrInterfaceBody)
;


the green are the grammer ,and the blue and red are the tree grammer !!!

repeat again ,no matter how the grammer looks like ,i just copy all of them ,and add the ^( ) also an imaginary node , can I do it ?

the reason why I wanna do like this ? cause sometime I dont care about the efficiency ,i just wanna find a general way which I can write a program to generate all the code for me , sure the best way is write the tree grammer manually too , but because now I am not so familiar with the tree grammer and this wonderful antlr project ,so I am learning it and also trying to find a way to write an demo of an translator .


can somebody here tell me whether i can do it as i just described ,and more important thing is what should it learn if i wanna write the tree grammer manually !! 

it there a conclusion of antlr which can as an dictionary ? as a newbie of antlr ,i am not sure i learned all of the features of antlr ,

Thanks 

BILL at 20009



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/a45e0733/attachment.html 

From postmaster at workstreamautomation.com  Tue Oct 13 08:13:35 2009
From: postmaster at workstreamautomation.com (postmaster)
Date: Tue, 13 Oct 2009 16:13:35 +0100
Subject: [antlr-interest]  bison/yacc to antlr; antlr pretty printer.
Message-ID: <4AD4991F.8070007@workstreamautomation.com>

I have a yacc grammar that I want to convert to Antlr. I saw a reference 
from Loring Craymer posted in 2006, suggesting there was a Bison to  
antlr converter at the antlr.org site. Can someone point me in the right 
direction? This would give me a starting point for the language I'm 
trying to parse  - I can than hand modify!
Thanks
ushaikh

From indhu.b at s7software.com  Tue Oct 13 08:28:36 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Tue, 13 Oct 2009 20:58:36 +0530
Subject: [antlr-interest] bison/yacc to antlr; antlr pretty printer.
In-Reply-To: <4AD4991F.8070007@workstreamautomation.com>
References: <4AD4991F.8070007@workstreamautomation.com>
Message-ID: <013e01ca4c19$d580ec90$8082c5b0$@b@s7software.com>

http://www.antlr.org/share/list has bison to ANTLR converter. I guess this
should work fine for YACC grammars.

Cheers, Indhu


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of postmaster
Sent: Tuesday, October 13, 2009 8:44 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] bison/yacc to antlr; antlr pretty printer.

I have a yacc grammar that I want to convert to Antlr. I saw a reference 
from Loring Craymer posted in 2006, suggesting there was a Bison to  
antlr converter at the antlr.org site. Can someone point me in the right 
direction? This would give me a starting point for the language I'm 
trying to parse  - I can than hand modify!
Thanks
ushaikh

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From andersen at ontologyworks.com  Tue Oct 13 08:39:02 2009
From: andersen at ontologyworks.com (Bill Andersen)
Date: Tue, 13 Oct 2009 11:39:02 -0400
Subject: [antlr-interest] Choosing AST rewrite based on test
Message-ID: <0D13FA51-3E2D-410C-98DC-F774CBDAB34C@ontologyworks.com>

Hi All

I have the following rule in a tree grammar (BTW, rewrite = true  
here).  Both AS_TEXT and AS_NAME are imaginary tokens.

text_block
	: ^(AS_TEXT text_option* name? phrase+ )	
	  -> ?????
	;

what I want for the ????? part is the rewrite

	^(AS_TEXT name phrase+)

if the optional name was present in the input tree, and

	^(AS_TEXT { <generated-name> } phrase+)

if no name was present in the input tree.  One variant I tried was

text_block
	: ^(AS_TEXT text_option* name? phrase+ )	
	  -> ^(AS_TEXT { ($name.tree == null) ? pm.generateName() :  
$name.tree } phrase+)
	;

where pm is a helper class instance and generateName looks like

CommonTree generateName() {
   String name = ....
   return new CommonTree( new CommonToken(AS_NAME, name) );
}

First question is, is this a good approach to "filling in a blank" in  
a rewritten tree?  If not, please advise.  If so, I'll post another  
message showing what I did and the null pointer exception that results.

Thanks in advance!

	.bill

Bill Andersen
Ontology Works, Inc. (www.ontologyworks.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204





From ellery-newcomer at utulsa.edu  Tue Oct 13 08:50:09 2009
From: ellery-newcomer at utulsa.edu (Ellery Newcomer)
Date: Tue, 13 Oct 2009 10:50:09 -0500
Subject: [antlr-interest] ANTLR, D
Message-ID: <4AD4A1B1.5090309@utulsa.edu>

Hello.

I've been playing with ANTLR for D code generation, and I have it more
or less working for current D compilers.

It lives here: http://www.dsource.org/projects/antlrd

Note it is v2.7.7

From jsrs701 at yahoo.com  Tue Oct 13 09:00:58 2009
From: jsrs701 at yahoo.com (J. Stephen Riley Silber)
Date: Tue, 13 Oct 2009 09:00:58 -0700 (PDT)
Subject: [antlr-interest] Does lexer EVER use longest match?
In-Reply-To: <4.1.20091013015256.02ef2f60@grahamwideman.com>
References: <4.1.20091012193814.031bcff8@grahamwideman.com>
	<4.1.20091012144513.02d30198@grahamwideman.com>
	<20091012172919.13B103418417@www.antlr.org>
	<4AD31D9F.9060106@gmail.com> <4AD32106.1040704@gmail.com>
	<4.1.20091012172016.02d30198@grahamwideman.com>
	<4.1.20091012193814.031bcff8@grahamwideman.com>
	<4.1.20091013015256.02ef2f60@grahamwideman.com>
Message-ID: <496043.17841.qm@web33306.mail.mud.yahoo.com>

Ter,

This is an issue that enough of us run into and eventually figure out how to hack around.  I honestly can't remember if it's covered in the First Book, but might this be a candidate for inclusion in a later edition, a kind of anti-pattern to be on the lookout for?




________________________________
From: Graham Wideman <gwlist at grahamwideman.com>
To: antlr-interest at antlr.org
Sent: Tue, October 13, 2009 2:19:08 AM
Subject: Re: [antlr-interest] Does lexer EVER use longest match?

(Kirby sent me a lengthy email on observations about ANTLR's lexer behavior, prompting me to nose around some more...)

Thanks Kirby for your lengthy comments.

Actually, I guess I was aware that mToken would indeed choose the longest *fixed-length* alternative -- what I was really puzzling over was patterns where the length of the match isn't fixed -- so some pattern with repeats or alternate combinations in the middle.

I now see that doing this can prompt ANTLR to produce a DFA for mToken to use (instead of ifs and switches), and this indeed seems to be able to find the longest match for alternative variable-length patterns.  Example:

-------------------------------
grammar Test02;

file
  : (X1 | X2 | X3 | X4 | X5 | X6)+ EOF
  ;

X1: 'ab';
X2: 'cd';
X3: 'ef';
X4: 'xy'; 
X5: 'abc' .* 'pq';
X6: X1 .* X4;
-------------------------------
(And noting the special non-greedy behavior of .*)

This correctly eats: 'abcdefpqxy' as X6, despite the possibility of getting sidetracked onto X5.

OK, I think I'm satisfied on this particular point. Within the scope of the lexer, it does at least make an effort to choose the longest match. I'm not sure what limitations there may be on this. (And obviously since lexing is independent of parsing, ANTLR's code does not make alternative lexer decisions based on ability to *parse* a larger chunk.)

-- Graham




List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/c90d1a50/attachment.html 

From kirby.bohling at gmail.com  Tue Oct 13 09:10:54 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Tue, 13 Oct 2009 11:10:54 -0500
Subject: [antlr-interest] Choosing AST rewrite based on test
In-Reply-To: <0D13FA51-3E2D-410C-98DC-F774CBDAB34C@ontologyworks.com>
References: <0D13FA51-3E2D-410C-98DC-F774CBDAB34C@ontologyworks.com>
Message-ID: <3cac8fdf0910130910t4435791bxbaf0ba84c4e4669c@mail.gmail.com>

On Tue, Oct 13, 2009 at 10:39 AM, Bill Andersen
<andersen at ontologyworks.com> wrote:
> Hi All
>
> I have the following rule in a tree grammar (BTW, rewrite = true
> here). ?Both AS_TEXT and AS_NAME are imaginary tokens.
>
> text_block
> ? ? ? ?: ^(AS_TEXT text_option* name? phrase+ )
> ? ? ? ? ?-> ?????
> ? ? ? ?;
>
> what I want for the ????? part is the rewrite
<snip...>

Bill couldn't you do that "the other way"?  I mean by write a rule like this:

text_block: ^(AS_TEXT text_option* optional_or_gen_name phrase+)
;

optional_or_gen_name:
   (
     name -> ^(NAME_NODE name)
   |
     -> ^(GEN_NAME_NODE)
   )
;

I threw together a quick example that shows the syntax works in a
parser (I'd assume it'd work in a tree grammar).  I think this will
accomplish what you want.  Not sure if you wanted the name to be it's
own subtree, but I generally make rooted trees because it eliminates
backtracking.


Cheers,
    Kirby

// Sample grammar that compiles in ANTLRWorks 1.3 for me.
grammar foo;

options {
rewrite=true;
output=AST;
}

tokens {
NAME;
GEN_NAME;
}

text_block:
	(text_option* name? phrase+ )
	;
	
text_option
	:	 '(' TEXT ')'
	;
	
TEXT:	'a'..'z'
	;

// after GEN_NAME add a { } block to attach the generated name to the token.
gen_or_name
	:	(name -> ^(NAME name) | -> ^(GEN_NAME) )
	;

name:	'{' TEXT '}'
	;
	
phrase
	:	TEXT
	;

From cummings at kjchome.homeip.net  Tue Oct 13 09:30:57 2009
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Tue, 13 Oct 2009 12:30:57 -0400
Subject: [antlr-interest] bison/yacc to antlr; antlr pretty printer.
In-Reply-To: <013e01ca4c19$d580ec90$8082c5b0$@b@s7software.com>
References: <4AD4991F.8070007@workstreamautomation.com>
	<013e01ca4c19$d580ec90$8082c5b0$@b@s7software.com>
Message-ID: <4AD4AB41.5000408@kjchome.homeip.net>

On 10/13/2009 11:28 AM, Indhu Bharathi wrote:
> http://www.antlr.org/share/list has bison to ANTLR converter. I guess this
> should work fine for YACC grammars.

Note this is a Bison => ANTLR v2.7.6 converter.

It will require some work by hand to make the resulting code work with
the current v3 ANTLR....

> Cheers, Indhu

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From espakm at gmail.com  Tue Oct 13 09:33:32 2009
From: espakm at gmail.com (=?ISO-8859-1?B?RXNw4WsgTWlrbPNz?=)
Date: Tue, 13 Oct 2009 18:33:32 +0200
Subject: [antlr-interest] accepting nested code blocks
Message-ID: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>

Hi,

I want to create a lexer rule accepting nested code blocks.

I tried out the example of the Definitive ANTLR Reference (Section 4.3), but
it does not work.
It accepts only such inputs which do not contain any character other than
curly braces. Moreover, one closing brace is enough.

The error is the following:
MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125

The original code of the book:

fragment
CODE[boolean stripCurlies]:
  '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
  {
    if ( stripCurlies ) {
      setText(getText().substring(1, getText().length()));
    }
  }
  ;

The simplified version of the rule results the same:
fragment
Block: '{' ( Block | ~('{'|'}') )* '}';

I use ANTLR 3.2.

Does anybody have an idea, how to get around this?

Thanks,

Miklos
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/dcf56e53/attachment.html 

From indhu.b at s7software.com  Tue Oct 13 10:06:01 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Tue, 13 Oct 2009 22:36:01 +0530
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
Message-ID: <015701ca4c27$715c2460$54146d20$@b@s7software.com>

Balanced parenthesis cannot be expressed using regular expression which
means you cannot recognize it using lexer. You need a push down automata
which means you need a parser to recognize it. Try doing it using parser
rules.

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
Sent: Tuesday, October 13, 2009 10:04 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] accepting nested code blocks

 

Hi,

I want to create a lexer rule accepting nested code blocks.

I tried out the example of the Definitive ANTLR Reference (Section 4.3), but
it does not work.
It accepts only such inputs which do not contain any character other than
curly braces. Moreover, one closing brace is enough.

The error is the following:
MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125

The original code of the book:

fragment
CODE[boolean stripCurlies]:
  '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
  {
    if ( stripCurlies ) {
      setText(getText().substring(1, getText().length()));
    }
  }
  ;

The simplified version of the rule results the same:
fragment
Block: '{' ( Block | ~('{'|'}') )* '}';

I use ANTLR 3.2.

Does anybody have an idea, how to get around this?

Thanks,

Miklos

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/94f21a7c/attachment.html 

From espakm at gmail.com  Tue Oct 13 10:41:25 2009
From: espakm at gmail.com (=?ISO-8859-1?B?RXNw4WsgTWlrbPNz?=)
Date: Tue, 13 Oct 2009 19:41:25 +0200
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <3820714377830943170@unknownmsgid>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
	<3820714377830943170@unknownmsgid>
Message-ID: <e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>

Hi,

I understand your point of view, but the book states explicitly the following:

"ANTLR generates recursive-descent recognizers
for lexers just as it does for parsers and tree parsers. Consequently,
ANTLR supports recursive lexer rules, unlike other tools such as lex."

Using recursion it should be possible to create such a lexer rule. If
not, what it can be used for?

My original problem is that the input files contain a JavaScript
function definition. The other parts of the input are covered by the
grammar. However, I do not need to check the validity of the JS
function, just extract it as is, and pass to the JS engine later. So
if it is not necessary, I do not want to parse it.

Is it possible somehow? Or should I denote the beginning and the end
of the JS function by some special token to allow catching it by a
lexer rule?

Cheers,
Miklos

2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
> Balanced parenthesis cannot be expressed using regular expression which
> means you cannot recognize it using lexer. You need a push down automata
> which means you need a parser to recognize it. Try doing it using parser
> rules.
>
>
>
> Cheers, Indhu
>
>
>
>
>
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
> Sent: Tuesday, October 13, 2009 10:04 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] accepting nested code blocks
>
>
>
> Hi,
>
> I want to create a lexer rule accepting nested code blocks.
>
> I tried out the example of the Definitive ANTLR Reference (Section 4.3), but
> it does not work.
> It accepts only such inputs which do not contain any character other than
> curly braces. Moreover, one closing brace is enough.
>
> The error is the following:
> MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125
>
> The original code of the book:
>
> fragment
> CODE[boolean stripCurlies]:
> ? '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
> ? {
> ??? if ( stripCurlies ) {
> ????? setText(getText().substring(1, getText().length()));
> ??? }
> ? }
> ? ;
>
> The simplified version of the rule results the same:
> fragment
> Block: '{' ( Block | ~('{'|'}') )* '}';
>
> I use ANTLR 3.2.
>
> Does anybody have an idea, how to get around this?
>
> Thanks,
>
> Miklos

From evanpmeth at gmail.com  Tue Oct 13 10:46:23 2009
From: evanpmeth at gmail.com (Evan Metheny)
Date: Tue, 13 Oct 2009 10:46:23 -0700
Subject: [antlr-interest] Learning the basics of ANTLR
Message-ID: <843e610f0910131046h5fc2f894x713def94847041e1@mail.gmail.com>

Alright I am currently trying to learn ANTLR via the definitive guide
book. My current questions regards the following XML Grammar. What I
am trying to do is; re-write the grammar from the XMLLexer.g example
to be a parser and lexer grammar, I am doing this as an exercise to
try to understand ANTLR.

When debugging under ANTLR Works 1.3 i get a missing token exception
on GENERIC_ID within the "attribute" parser rule. I tried problem
solving by changing it to a non-fragment lexer rule and to a parser
rule, but this causes the beginning XML declaration to break. I cant
understand why it would break the recognition of "XML" when its before
the attribute call.

Any help would be much appreciated for me to understand this situation better.


XML.g:
-----------------------------------------------------------------

grammar XML;

options {
backtrack = true;
}

document
	:	xmldecl WS? doctype
	;

doctype
    :
        '<!DOCTYPE' WS? GENERIC_ID

        WS?
        (
            ( 'SYSTEM' WS? VALUE
            | 'PUBLIC' WS? VALUE WS? VALUE
            )
            ( WS )?
        )?
        ( INTERNAL_DTD

        )?
		'>'
	;

INTERNAL_DTD : '[' (options {greedy=false;} : .)* ']' ;

pi :
        '<?' GENERIC_ID WS?

        ( attribute WS? )*  '?>'
	;

xmldecl :
        '<?' ('x'|'X') ('m'|'M') ('l'|'L') WS?

        attribute  '?>'
	;


element
    : ( start_tag
            (element
            | PCDATA

            | cdata

            | comment

            | pi
            )*
            end_tag
        | emptyelement
        )
    ;

start_tag
    : '<' WS? GENERIC_ID WS?

        ( attribute WS? )* '>'
    ;

emptyelement
    : '<' WS? GENERIC_ID WS?

        ( attribute WS? )* '/>'
    ;

attribute
    : GENERIC_ID WS? '=' WS? VALUE

    ;

end_tag
    : '</' WS? GENERIC_ID WS? '>'

    ;

comment
	:	'<!--' (options {greedy=false;} : .)* '-->'
	;

cdata
	:	'<![CDATA[' (options {greedy=false;} : .)* ']]>'
	;



fragment GENERIC_ID
    : ( LETTER | '_' | ':')
        ( options {greedy=true;} :
        LETTER | '0'..'9' | '.' | '-' | '_' | ':' )*
	;

fragment LETTER
	: 'a'..'z'
	| 'A'..'Z'
	;


 WS  :
        (   ' '
        |   '\t'
        |  ( '\n'
            |	'\r\n'
            |	'\r'
            )
        )+
    ;

fragment PCDATA : (~'<')+ ;

fragment VALUE :
        ( '\"' (~'\"')* '\"'
        | '\'' (~'\'')* '\''
        )
	;

From indhu.b at s7software.com  Tue Oct 13 10:54:33 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Tue, 13 Oct 2009 23:24:33 +0530
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>	
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
Message-ID: <016201ca4c2e$3a497660$aedc6320$@b@s7software.com>

Wow. I never noticed this.

r	:	BLOCK
	;

BLOCK
	:	'{' BLOCK? '}'
	;
	
works! Thanks for pointing it out.

Cheers, Indhu


-----Original Message-----
From: Esp?k Mikl?s [mailto:espakm at gmail.com] 
Sent: Tuesday, October 13, 2009 11:11 PM
To: Indhu Bharathi
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] accepting nested code blocks

Hi,

I understand your point of view, but the book states explicitly the
following:

"ANTLR generates recursive-descent recognizers
for lexers just as it does for parsers and tree parsers. Consequently,
ANTLR supports recursive lexer rules, unlike other tools such as lex."

Using recursion it should be possible to create such a lexer rule. If
not, what it can be used for?

My original problem is that the input files contain a JavaScript
function definition. The other parts of the input are covered by the
grammar. However, I do not need to check the validity of the JS
function, just extract it as is, and pass to the JS engine later. So
if it is not necessary, I do not want to parse it.

Is it possible somehow? Or should I denote the beginning and the end
of the JS function by some special token to allow catching it by a
lexer rule?

Cheers,
Miklos

2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
> Balanced parenthesis cannot be expressed using regular expression which
> means you cannot recognize it using lexer. You need a push down automata
> which means you need a parser to recognize it. Try doing it using parser
> rules.
>
>
>
> Cheers, Indhu
>
>
>
>
>
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
> Sent: Tuesday, October 13, 2009 10:04 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] accepting nested code blocks
>
>
>
> Hi,
>
> I want to create a lexer rule accepting nested code blocks.
>
> I tried out the example of the Definitive ANTLR Reference (Section 4.3),
but
> it does not work.
> It accepts only such inputs which do not contain any character other than
> curly braces. Moreover, one closing brace is enough.
>
> The error is the following:
> MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125
>
> The original code of the book:
>
> fragment
> CODE[boolean stripCurlies]:
> ? '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
> ? {
> ??? if ( stripCurlies ) {
> ????? setText(getText().substring(1, getText().length()));
> ??? }
> ? }
> ? ;
>
> The simplified version of the rule results the same:
> fragment
> Block: '{' ( Block | ~('{'|'}') )* '}';
>
> I use ANTLR 3.2.
>
> Does anybody have an idea, how to get around this?
>
> Thanks,
>
> Miklos


From mwil at lle.rochester.edu  Tue Oct 13 11:03:44 2009
From: mwil at lle.rochester.edu (Mark Wilson)
Date: Tue, 13 Oct 2009 14:03:44 -0400
Subject: [antlr-interest] ANTLRWorks question
Message-ID: <bc98c53a0910131103y1cad6d79x397a9d0728b90a88@mail.gmail.com>

I used the ANTLRWorks wizard to start my grammar.  There appears to be
something wrong with the STRING token, basically something like "Joe" does
not parse correctly in the interpreter.  This is what the rule looks like:

STRING
    :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
    ;

What is this supposed to do?

Thanks,
Mark Wilson

-- 
Mark Wilson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/168b1c1c/attachment.html 

From indhu.b at s7software.com  Tue Oct 13 11:04:02 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Tue, 13 Oct 2009 23:34:02 +0530
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>	
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
Message-ID: <016301ca4c2f$8c5d0240$a51706c0$@b@s7software.com>

I tried the following 

r	:	BLOCK
	;
	
BLOCK
	: '{' ( BLOCK | ~('{'|'}') )* '}'
	;	

And it works fine for inputs like "{{}}" ,
"{hsdgjsahdj{hasdjhsahdj}sdjhjsd}", etc

What is the input you are trying to match? Why are you using 'fragment'?

Cheers, Indhu


-----Original Message-----
From: Esp?k Mikl?s [mailto:espakm at gmail.com] 
Sent: Tuesday, October 13, 2009 11:11 PM
To: Indhu Bharathi
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] accepting nested code blocks

Hi,

I understand your point of view, but the book states explicitly the
following:

"ANTLR generates recursive-descent recognizers
for lexers just as it does for parsers and tree parsers. Consequently,
ANTLR supports recursive lexer rules, unlike other tools such as lex."

Using recursion it should be possible to create such a lexer rule. If
not, what it can be used for?

My original problem is that the input files contain a JavaScript
function definition. The other parts of the input are covered by the
grammar. However, I do not need to check the validity of the JS
function, just extract it as is, and pass to the JS engine later. So
if it is not necessary, I do not want to parse it.

Is it possible somehow? Or should I denote the beginning and the end
of the JS function by some special token to allow catching it by a
lexer rule?

Cheers,
Miklos

2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
> Balanced parenthesis cannot be expressed using regular expression which
> means you cannot recognize it using lexer. You need a push down automata
> which means you need a parser to recognize it. Try doing it using parser
> rules.
>
>
>
> Cheers, Indhu
>
>
>
>
>
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
> Sent: Tuesday, October 13, 2009 10:04 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] accepting nested code blocks
>
>
>
> Hi,
>
> I want to create a lexer rule accepting nested code blocks.
>
> I tried out the example of the Definitive ANTLR Reference (Section 4.3),
but
> it does not work.
> It accepts only such inputs which do not contain any character other than
> curly braces. Moreover, one closing brace is enough.
>
> The error is the following:
> MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125
>
> The original code of the book:
>
> fragment
> CODE[boolean stripCurlies]:
> ? '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
> ? {
> ??? if ( stripCurlies ) {
> ????? setText(getText().substring(1, getText().length()));
> ??? }
> ? }
> ? ;
>
> The simplified version of the rule results the same:
> fragment
> Block: '{' ( Block | ~('{'|'}') )* '}';
>
> I use ANTLR 3.2.
>
> Does anybody have an idea, how to get around this?
>
> Thanks,
>
> Miklos


From indhu.b at s7software.com  Tue Oct 13 11:10:25 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Tue, 13 Oct 2009 23:40:25 +0530
Subject: [antlr-interest] ANTLRWorks question
In-Reply-To: <bc98c53a0910131103y1cad6d79x397a9d0728b90a88@mail.gmail.com>
References: <bc98c53a0910131103y1cad6d79x397a9d0728b90a88@mail.gmail.com>
Message-ID: <016a01ca4c30$70c04370$5240ca50$@b@s7software.com>

Prefer using debugger instead of interpreter. Interpreter doesn't work as
expected sometimes (when you are using semantic predicates).

 

That said, for this particular case it seems to works fine.

 

r              :               STRING

                ;

                

STRING

    :  '"' ( ~('\\'|'"') )* '"'

    ;

 

Are you using semantic predicates somewhere else that causes the interpreter
to fail?

 

BTW, what is the error message you get?

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mark Wilson
Sent: Tuesday, October 13, 2009 11:34 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLRWorks question

 

I used the ANTLRWorks wizard to start my grammar.  There appears to be
something wrong with the STRING token, basically something like "Joe" does
not parse correctly in the interpreter.  This is what the rule looks like:

STRING
    :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
    ;

What is this supposed to do?  

Thanks,
Mark Wilson

-- 
Mark Wilson

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/10bf6810/attachment.html 

From gwlist at grahamwideman.com  Tue Oct 13 11:11:44 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 13 Oct 2009 11:11:44 -0700
Subject: [antlr-interest] Learning the basics of ANTLR
In-Reply-To: <843e610f0910131046h5fc2f894x713def94847041e1@mail.gmail.co
 m>
Message-ID: <4.1.20091013110732.02f0e790@grahamwideman.com>

You've defined GENERIC_ID as a fragment.

Fragments can only be part of another lexer rule, they are not stand-alone token-producing lexer rules.  Henxe the missing token exception.

Also:
> I cant
>understand why it would break the recognition of "XML" when its before
>the attribute call.

So far as I know, there is no impact of order in which the lexer and parser rules appear in the .g file.

-- Graham



--------------------------------
At 10/13/2009 10:46 AM, Evan Metheny wrote:
>Alright I am currently trying to learn ANTLR via the definitive guide
>book. My current questions regards the following XML Grammar. What I
>am trying to do is; re-write the grammar from the XMLLexer.g example
>to be a parser and lexer grammar, I am doing this as an exercise to
>try to understand ANTLR.
>
>When debugging under ANTLR Works 1.3 i get a missing token exception
>on GENERIC_ID within the "attribute" parser rule. I tried problem
>solving by changing it to a non-fragment lexer rule and to a parser
>rule, but this causes the beginning XML declaration to break. I cant
>understand why it would break the recognition of "XML" when its before
>the attribute call.
>
>Any help would be much appreciated for me to understand this situation better.
>
>
>XML.g:
>-----------------------------------------------------------------
>
>grammar XML;
>
>options {
>backtrack = true;
>}
>
>document
>	:	xmldecl WS? doctype
>	;
>
>doctype
>    :
>        '<!DOCTYPE' WS? GENERIC_ID
>
>        WS?
>        (
>            ( 'SYSTEM' WS? VALUE
>            | 'PUBLIC' WS? VALUE WS? VALUE
>            )
>            ( WS )?
>        )?
>        ( INTERNAL_DTD
>
>        )?
>		'>'
>	;
>
>INTERNAL_DTD : '[' (options {greedy=false;} : .)* ']' ;
>
>pi :
>        '<?' GENERIC_ID WS?
>
>        ( attribute WS? )*  '?>'
>	;
>
>xmldecl :
>        '<?' ('x'|'X') ('m'|'M') ('l'|'L') WS?
>
>        attribute  '?>'
>	;
>
>
>element
>    : ( start_tag
>            (element
>            | PCDATA
>
>            | cdata
>
>            | comment
>
>            | pi
>            )*
>            end_tag
>        | emptyelement
>        )
>    ;
>
>start_tag
>    : '<' WS? GENERIC_ID WS?
>
>        ( attribute WS? )* '>'
>    ;
>
>emptyelement
>    : '<' WS? GENERIC_ID WS?
>
>        ( attribute WS? )* '/>'
>    ;
>
>attribute
>    : GENERIC_ID WS? '=' WS? VALUE
>
>    ;
>
>end_tag
>    : '</' WS? GENERIC_ID WS? '>'
>
>    ;
>
>comment
>	:	'<!--' (options {greedy=false;} : .)* '-->'
>	;
>
>cdata
>	:	'<![CDATA[' (options {greedy=false;} : .)* ']]>'
>	;
>
>
>
>fragment GENERIC_ID
>    : ( LETTER | '_' | ':')
>        ( options {greedy=true;} :
>        LETTER | '0'..'9' | '.' | '-' | '_' | ':' )*
>	;
>
>fragment LETTER
>	: 'a'..'z'
>	| 'A'..'Z'
>	;
>
>
> WS  :
>        (   ' '
>        |   '\t'
>        |  ( '\n'
>            |	'\r\n'
>            |	'\r'
>            )
>        )+
>    ;
>
>fragment PCDATA : (~'<')+ ;
>
>fragment VALUE :
>        ( '\"' (~'\"')* '\"'
>        | '\'' (~'\'')* '\''
>        )
>	;
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From gwlist at grahamwideman.com  Tue Oct 13 11:43:37 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 13 Oct 2009 11:43:37 -0700
Subject: [antlr-interest] Learning the basics of ANTLR
In-Reply-To: <843e610f0910131124y123e19d1gaa278274a2c4863e@mail.gmail.co
 m>
References: <4.1.20091013110732.02f0e790@grahamwideman.com>
	<4.1.20091013110732.02f0e790@grahamwideman.com>
Message-ID: <4.1.20091013114023.03308ae8@grahamwideman.com>

You haven't shown your revised grammar. However, in the old grammar the xmldecl rule says that an attribute is required, so feeding in just:

xml

will not satisfy xmldecl.

-- Graham

At 10/13/2009 11:24 AM, Evan Metheny wrote:
>Thanks for the response Graham
>
>> Fragments can only be part of another lexer rule, they are not stand-alone 
>token-producing lexer rules.  Henxe the missing token exception.
>
>OK that makes sense, when changing fragment GENERIC_ID to GENERIC_ID.
>The "xmldecl" rule breaks with "mismatched set exception" when trying
>to recognize "xml". Thats what i was trying to explain with:
>
>>
>> Also:
>>> I cant
>>>understand why it would break the recognition of "XML" when its before
>>>the attribute call.
>>
>> So far as I know, there is no impact of order in which the lexer and 
>parser rules appear in the .g file.
>
>Thanks
>
>-Evan


From mwil at lle.rochester.edu  Tue Oct 13 12:07:58 2009
From: mwil at lle.rochester.edu (Mark Wilson)
Date: Tue, 13 Oct 2009 15:07:58 -0400
Subject: [antlr-interest] ANTLRWorks question
In-Reply-To: <-8952719744029055968@unknownmsgid>
References: <bc98c53a0910131103y1cad6d79x397a9d0728b90a88@mail.gmail.com>
	<-8952719744029055968@unknownmsgid>
Message-ID: <bc98c53a0910131207t64992e99oa2a5ca97f5724313@mail.gmail.com>

Hi Indhu,

I get "Mismatched token exception".  If remove the ESC_SEQ tokens/rules and
make it look as below, it works okay.  If I add the ESC_SEQ (see below)
stuff back in, it will work IF I place an escape sequence as the first
character.  Seems to work okay in the debugger (I'm very new to ANTLR),
though.  I don't see why this wouldn't work in the interpreter, but then
again I don't know much yet.  I have no predicates or anything, just
experimenting with ANTLRWorks wizard generated parser...

Thanks!

STRING
    :    '"' ( ESC_SEQ | ~('\\'|'"') )* '"';

fragment
ESC_SEQ
    :'\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
    | OCTAL_ESC
    | UNICODE_ESC


fragment
OCTAL_ESC
    :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7')
    ;

fragment
UNICODE_ESC
    :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
    ;

On Tue, Oct 13, 2009 at 2:10 PM, Indhu Bharathi <indhu.b at s7software.com>wrote:

>  Prefer using debugger instead of interpreter. Interpreter doesn?t work as
> expected sometimes (when you are using semantic predicates).
>
>
>
> That said, for this particular case it seems to works fine.
>
>
>
> r              :               STRING
>
>                 ;
>
>
>
> STRING
>
>     :  '"' ( ~('\\'|'"') )* '"'
>
>     ;
>
>
>
> Are you using semantic predicates somewhere else that causes the
> interpreter to fail?
>
>
>
> BTW, what is the error message you get?
>
>
>
> Cheers, Indhu
>
>
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Mark Wilson
> *Sent:* Tuesday, October 13, 2009 11:34 PM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] ANTLRWorks question
>
>
>
> I used the ANTLRWorks wizard to start my grammar.  There appears to be
> something wrong with the STRING token, basically something like "Joe" does
> not parse correctly in the interpreter.  This is what the rule looks like:
>
> STRING
>     :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
>     ;
>
> What is this supposed to do?
>
> Thanks,
> Mark Wilson
>
> --
> Mark Wilson
>



-- 
Mark Wilson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/f91524c9/attachment.html 

From espakm at gmail.com  Tue Oct 13 12:16:32 2009
From: espakm at gmail.com (=?ISO-8859-1?B?RXNw4WsgTWlrbPNz?=)
Date: Tue, 13 Oct 2009 21:16:32 +0200
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <-438686297222296206@unknownmsgid>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
	<-438686297222296206@unknownmsgid>
Message-ID: <e2a1d9720910131216t6047a6abp5ec0b789123a6d8a@mail.gmail.com>

This is exactly what I want, but it does not work for me. Incredible!
Do you use 3.2, too?

I just used 'fragment' because it was there in the example of the
book. (Although it was used there for another reason.) I also tried it
without 'fragment'.

Cheers,
Miklos

2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
> I tried the following
>
> r ? ? ? : ? ? ? BLOCK
> ? ? ? ?;
>
> BLOCK
> ? ? ? ?: '{' ( BLOCK | ~('{'|'}') )* '}'
> ? ? ? ?;
>
> And it works fine for inputs like "{{}}" ,
> "{hsdgjsahdj{hasdjhsahdj}sdjhjsd}", etc
>
> What is the input you are trying to match? Why are you using 'fragment'?
>
> Cheers, Indhu
>
>
> -----Original Message-----
> From: Esp?k Mikl?s [mailto:espakm at gmail.com]
> Sent: Tuesday, October 13, 2009 11:11 PM
> To: Indhu Bharathi
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] accepting nested code blocks
>
> Hi,
>
> I understand your point of view, but the book states explicitly the
> following:
>
> "ANTLR generates recursive-descent recognizers
> for lexers just as it does for parsers and tree parsers. Consequently,
> ANTLR supports recursive lexer rules, unlike other tools such as lex."
>
> Using recursion it should be possible to create such a lexer rule. If
> not, what it can be used for?
>
> My original problem is that the input files contain a JavaScript
> function definition. The other parts of the input are covered by the
> grammar. However, I do not need to check the validity of the JS
> function, just extract it as is, and pass to the JS engine later. So
> if it is not necessary, I do not want to parse it.
>
> Is it possible somehow? Or should I denote the beginning and the end
> of the JS function by some special token to allow catching it by a
> lexer rule?
>
> Cheers,
> Miklos
>
> 2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
>> Balanced parenthesis cannot be expressed using regular expression which
>> means you cannot recognize it using lexer. You need a push down automata
>> which means you need a parser to recognize it. Try doing it using parser
>> rules.
>>
>>
>>
>> Cheers, Indhu
>>
>>
>>
>>
>>
>> From: antlr-interest-bounces at antlr.org
>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
>> Sent: Tuesday, October 13, 2009 10:04 PM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] accepting nested code blocks
>>
>>
>>
>> Hi,
>>
>> I want to create a lexer rule accepting nested code blocks.
>>
>> I tried out the example of the Definitive ANTLR Reference (Section 4.3),
> but
>> it does not work.
>> It accepts only such inputs which do not contain any character other than
>> curly braces. Moreover, one closing brace is enough.
>>
>> The error is the following:
>> MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125
>>
>> The original code of the book:
>>
>> fragment
>> CODE[boolean stripCurlies]:
>> ? '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
>> ? {
>> ??? if ( stripCurlies ) {
>> ????? setText(getText().substring(1, getText().length()));
>> ??? }
>> ? }
>> ? ;
>>
>> The simplified version of the rule results the same:
>> fragment
>> Block: '{' ( Block | ~('{'|'}') )* '}';
>>
>> I use ANTLR 3.2.
>>
>> Does anybody have an idea, how to get around this?
>>
>> Thanks,
>>
>> Miklos
>
>

From gwlist at grahamwideman.com  Tue Oct 13 12:21:53 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 13 Oct 2009 12:21:53 -0700
Subject: [antlr-interest] Learning the basics of ANTLR
In-Reply-To: <843e610f0910131150g3729fc42n66e48adfac213669@mail.gmail.co
 m>
References: <4.1.20091013114023.03308ae8@grahamwideman.com>
	<4.1.20091013110732.02f0e790@grahamwideman.com>
	<4.1.20091013114023.03308ae8@grahamwideman.com>
Message-ID: <4.1.20091013120452.03334438@grahamwideman.com>

Evan;

(Please also reply to the list so others can help as well.)

I think the problem here may be that the xmldecl parser rule is looking for explicit characters, whereas the lexer has absorbed these into a single GENERIC_ID.  Take a look how other grammars handle keywords vs ids, and also search for info on case insensitivity, which is a special problem. 

-- Graham


At 10/13/2009 11:50 AM, Evan Metheny wrote:
>INPUT
>------------------------------------------------------------------------
><?xml version='1.0'?>
><!DOCTYPE component [
><!ELEMENT component (PCDATA|sub)*>
><!ATTLIST component
>          attr CDATA #IMPLIED
>          attr2 CDATA #IMPLIED
>>
><!ELMENT sub EMPTY>
>
>]>
><component attr="val'ue" attr2='val"ue'>
><!-- This is a comment -->
>Text
><![CDATA[huhu]]>
>????
>&amp;
>&lt;
><?xtal cursor='11'?>
><sub/>
><sub></sub>
></component>
>
>
>
>
>XML.g
>--------------------------------
>
>grammar XML;
>
>options {
>backtrack = true;
>}
>
>document
>	:	xmldecl WS? doctype
>	;
>
>doctype
>    :
>        '<!DOCTYPE' WS? GENERIC_ID
>
>        WS?
>        (
>            ( 'SYSTEM' WS? VALUE
>
>
>            | 'PUBLIC' WS? VALUE WS? VALUE
>
>
>            )
>            ( WS )?
>        )?
>        ( INTERNAL_DTD
>
>        )?
>		'>'
>	;
>
>INTERNAL_DTD : '[' (options {greedy=false;} : .)* ']' ;
>
>pi :
>        '<?' GENERIC_ID WS?
>
>        ( attribute WS? )*  '?>'
>	;
>
>xmldecl :
>        '<?' ('x'|'X') ('m'|'M') ('l'|'L') WS?
>
>        ( attribute WS? )*  '?>'
>	;
>
>
>element
>    : ( start_tag
>            (element
>            | PCDATA
>
>            | cdata
>
>            | comment
>
>            | pi
>            )*
>            end_tag
>        | emptyelement
>        )
>    ;
>
>start_tag
>    : '<' WS? GENERIC_ID WS?
>
>        ( attribute WS? )* '>'
>    ;
>
>emptyelement
>    : '<' WS? GENERIC_ID WS?
>
>        ( attribute WS? )* '/>'
>    ;
>
>attribute
>    : GENERIC_ID WS? '=' WS? VALUE
>
>    ;
>
>end_tag
>    : '</' WS? GENERIC_ID WS? '>'
>
>    ;
>
>comment
>	:	'<!--' (options {greedy=false;} : .)* '-->'
>	;
>
>cdata
>	:	'<![CDATA[' (options {greedy=false;} : .)* ']]>'
>	;
>
>
>
>GENERIC_ID
>    : ( LETTER | '_' | ':')
>        ( options {greedy=true;} :
>        LETTER | '0'..'9' | '.' | '-' | '_' | ':' )*
>	;
>
>fragment LETTER
>	: 'a'..'z'
>	| 'A'..'Z'
>	;
>
>
> WS  :
>        (   ' '
>        |   '\t'
>        |  ( '\n'
>            |	'\r\n'
>            |	'\r'
>            )
>        )+
>    ;
>
>fragment PCDATA : (~'<')+ ;
>
>fragment VALUE :
>        ( '\"' (~'\"')* '\"'
>        | '\'' (~'\'')* '\''
>        )
>	;
>
>
>On Tue, Oct 13, 2009 at 11:43 AM, Graham Wideman
><gwlist at grahamwideman.com> wrote:
>> You haven't shown your revised grammar. However, in the old grammar the 
>xmldecl rule says that an attribute is required, so feeding in just:
>>
>> xml
>>
>> will not satisfy xmldecl.
>>
>> -- Graham
>>
>> At 10/13/2009 11:24 AM, Evan Metheny wrote:
>>>Thanks for the response Graham
>>>
>>>> Fragments can only be part of another lexer rule, they are not stand-alone
>>>token-producing lexer rules.  Henxe the missing token exception.
>>>
>>>OK that makes sense, when changing fragment GENERIC_ID to GENERIC_ID.
>>>The "xmldecl" rule breaks with "mismatched set exception" when trying
>>>to recognize "xml". Thats what i was trying to explain with:
>>>
>>>>
>>>> Also:
>>>>> I cant
>>>>>understand why it would break the recognition of "XML" when its before
>>>>>the attribute call.
>>>>
>>>> So far as I know, there is no impact of order in which the lexer and
>>>parser rules appear in the .g file.
>>>
>>>Thanks
>>>
>>>-Evan
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>


From gwlist at grahamwideman.com  Tue Oct 13 12:48:07 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 13 Oct 2009 12:48:07 -0700
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <e2a1d9720910131216t6047a6abp5ec0b789123a6d8a@mail.gmail.co
 m>
References: <-438686297222296206@unknownmsgid>
	<e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
	<-438686297222296206@unknownmsgid>
Message-ID: <4.1.20091013123725.02fd2ec0@grahamwideman.com>

Miklos:

Seems like a bug in AW interpreter.

At 10/13/2009 09:16 PM, Esp?k Mikl?sbPNz wrote:
>This is exactly what I want, but it does not work for me. Incredible!
>Do you use 3.2, too?

I'm using 3.2 and AW 1.3.  For me this grammar fails in AW interpreter, but
works if i compile it.

------------------------------
grammar Test03;

file
        :        (b=Block {System.out.println("Block:" + $b.text); })+ EOF
        ;

Block: '{' ( Block | ~('{'|'}') )* '}';
------------------------------

Test input:
{abc}{def}{{xyz}}

Output from compiled program:
Block:{abc}
Block:{def}
Block:{{xyz}}

Errors from AW (in console):
[12:39:19] Interpreting...
[12:39:19] problem matching token at 1:2 MismatchedTokenException(97!=125)
[12:39:19] problem matching token at 1:3 MismatchedTokenException(98!=123)
[12:39:19] problem matching token at 1:4 MismatchedTokenException(99!=123)
[12:39:19] problem matching token at 1:5 MismatchedTokenException(125!=123)
[12:39:19] problem matching token at 1:7 MismatchedTokenException(100!=125)
[12:39:19] problem matching token at 1:8 MismatchedTokenException(101!=123)
[12:39:19] problem matching token at 1:9 MismatchedTokenException(102!=123)
[12:39:19] problem matching token at 1:10 MismatchedTokenException(125!=123)

So this seems like a bug in AW interpreter.

-- Graham

From espakm at gmail.com  Tue Oct 13 12:52:16 2009
From: espakm at gmail.com (=?ISO-8859-1?B?RXNw4WsgTWlrbPNz?=)
Date: Tue, 13 Oct 2009 21:52:16 +0200
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <4.1.20091013123725.02fd2ec0@grahamwideman.com>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
	<-438686297222296206@unknownmsgid>
	<4.1.20091013123725.02fd2ec0@grahamwideman.com>
Message-ID: <e2a1d9720910131252m6000b61em778b4cc98f20756@mail.gmail.com>

OMG!

I tested it in the ANTLR IDE, and it fails as well.

On Tue, Oct 13, 2009 at 9:48 PM, Graham Wideman
<gwlist at grahamwideman.com> wrote:
> Miklos:
>
> Seems like a bug in AW interpreter.
>
> At 10/13/2009 09:16 PM, Esp?k Mikl?sbPNz wrote:
>>This is exactly what I want, but it does not work for me. Incredible!
>>Do you use 3.2, too?
>
> I'm using 3.2 and AW 1.3. ?For me this grammar fails in AW interpreter, but
> works if i compile it.
>
> ------------------------------
> grammar Test03;
>
> file
> ? ? ? ?: ? ? ? ?(b=Block {System.out.println("Block:" + $b.text); })+ EOF
> ? ? ? ?;
>
> Block: '{' ( Block | ~('{'|'}') )* '}';
> ------------------------------
>
> Test input:
> {abc}{def}{{xyz}}
>
> Output from compiled program:
> Block:{abc}
> Block:{def}
> Block:{{xyz}}
>
> Errors from AW (in console):
> [12:39:19] Interpreting...
> [12:39:19] problem matching token at 1:2 MismatchedTokenException(97!=125)
> [12:39:19] problem matching token at 1:3 MismatchedTokenException(98!=123)
> [12:39:19] problem matching token at 1:4 MismatchedTokenException(99!=123)
> [12:39:19] problem matching token at 1:5 MismatchedTokenException(125!=123)
> [12:39:19] problem matching token at 1:7 MismatchedTokenException(100!=125)
> [12:39:19] problem matching token at 1:8 MismatchedTokenException(101!=123)
> [12:39:19] problem matching token at 1:9 MismatchedTokenException(102!=123)
> [12:39:19] problem matching token at 1:10 MismatchedTokenException(125!=123)
>
> So this seems like a bug in AW interpreter.
>
> -- Graham
>

From gerald at certiv.net  Tue Oct 13 13:06:33 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Tue, 13 Oct 2009 13:06:33 -0700
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.co
 m>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
Message-ID: <200910132015.n9DKFq02021595@zinc.newtechlaw.com>

The book and Indhu are both correct.  How to 
proceed is more a matter of what you know about 
the content between the delimiter pair, its 
complexity,  and what you want out of it.  There 
are modal lexers, island grammars, and parser-evaluation alternatives.

The recursive lexer rule definition does not 
handle quoted strings, which in the case of 
JavaScript will prove fatal.  I believe there is 
a way to avoid this problem, only using pure 
lexer rules, but it will be complex and the 
margin is too small to contain the proof.

However, if all you want is a single token 
containing the clob between a balanced set of 
delimiters, there is this simple approach:

@lexer::members {

public boolean pairMatch(int limit) {
     return Helper.pairMatch(input, limit);
   }
}

BRACE_BLOCK
   :  '{' { pairMatch(500) }?
   ;

and include the attached helper in your 
build.  This version recognizes nested delimiters 
subject to line comments and both single and double quoted strings.



At 10:41 AM 10/13/2009, Esp?k Mikl?s wrote:
>Hi,
>
>I understand your point of view, but the book states explicitly the following:
>
>"ANTLR generates recursive-descent recognizers
>for lexers just as it does for parsers and tree parsers. Consequently,
>ANTLR supports recursive lexer rules, unlike other tools such as lex."
>
>Using recursion it should be possible to create such a lexer rule. If
>not, what it can be used for?
>
>My original problem is that the input files contain a JavaScript
>function definition. The other parts of the input are covered by the
>grammar. However, I do not need to check the validity of the JS
>function, just extract it as is, and pass to the JS engine later. So
>if it is not necessary, I do not want to parse it.
>
>Is it possible somehow? Or should I denote the beginning and the end
>of the JS function by some special token to allow catching it by a
>lexer rule?
>
>Cheers,
>Miklos
>
>2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
> > Balanced parenthesis cannot be expressed using regular expression which
> > means you cannot recognize it using lexer. You need a push down automata
> > which means you need a parser to recognize it. Try doing it using parser
> > rules.
> >
> >
> >
> > Cheers, Indhu
> >
> >
> >
> >
> >
> > From: antlr-interest-bounces at antlr.org
> > [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
> > Sent: Tuesday, October 13, 2009 10:04 PM
> > To: antlr-interest at antlr.org
> > Subject: [antlr-interest] accepting nested code blocks
> >
> >
> >
> > Hi,
> >
> > I want to create a lexer rule accepting nested code blocks.
> >
> > I tried out the example of the Definitive 
> ANTLR Reference (Section 4.3), but
> > it does not work.
> > It accepts only such inputs which do not contain any character other than
> > curly braces. Moreover, one closing brace is enough.
> >
> > The error is the following:
> > MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125
> >
> > The original code of the book:
> >
> > fragment
> > CODE[boolean stripCurlies]:
> >   '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
> >   {
> >     if ( stripCurlies ) {
> >       setText(getText().substring(1, getText().length()));
> >     }
> >   }
> >   ;
> >
> > The simplified version of the rule results the same:
> > fragment
> > Block: '{' ( Block | ~('{'|'}') )* '}';
> >
> > I use ANTLR 3.2.
> >
> > Does anybody have an idea, how to get around this?
> >
> > Thanks,
> >
> > Miklos
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091013/5591051f/attachment.html 
-------------- next part --------------

import org.antlr.runtime.ANTLRStringStream;
import org.antlr.runtime.CharStream;

public class Helper {

	private static boolean debug = false;

	public static boolean pairMatch(CharStream input, int limit) {
		return pairMatch(input, limit, '{', '}');
	}

	public static boolean pairMatch(CharStream input, int limit, char open, char close) {
		int nest = 1; // already matched & consumed open char
		boolean done = false;
		while (!done && limit > 0) {
			int la_1 = input.LA(1);
			if (la_1 == -1) return false;
			if (la_1 == '\\') {
				int la_2 = input.LA(2);
				if (la_2 == -1) return false;
				consume(input, limit);
				consume(input, limit);
			} else if (la_1 == '/') {
				int la_2 = input.LA(2);
				if (la_2 == -1) return false;
				if (la_2 == '/') { // consume '//' to eol
					consume(input, limit);
					do {
						consume(input, limit);
						la_1 = input.LA(1);
						if (la_1 == -1) return false;
					} while (!(la_1 == '\r' || la_1 == '\n'));
				} else {
					consume(input, limit);
				}
			} else if (la_1 == '\'' || la_1 == '"') {
				boolean goodString = matchString(input, limit, (char) la_1);
				if (!goodString) return false;
			} else if (la_1 == open) {
				nest++;
				consume(input, limit);
			} else if (la_1 == close) {
				nest--;
				consume(input, limit);
				if (nest == 0) done = true;
			} else {
				consume(input, limit);
			}
		}
		if (limit == 0) return false;
		return true;
	}

	private static boolean matchString(CharStream input, int limit, char c) {
		consume(input, limit); // already matched open char
		boolean done = false;
		while (!done && limit > 0) {
			int la_1 = input.LA(1);
			if (la_1 == -1) return false;
			if (la_1 == '\\') {
				int la_2 = input.LA(2);
				if (la_2 == -1) return false;
				consume(input, limit);
				consume(input, limit);
			} else if (la_1 == c) {
				consume(input, limit);
				done = true;
			} else {
				consume(input, limit);
			}
		}
		if (limit == 0) return false;
		return true;
	}

	private static void consume(CharStream input, int limit) {
		if (debug) System.out.print((char) input.LA(1));
		input.consume();
		limit--;
	}

	// //////////////////////////////////////////////////////////////////////////

	public static void main(String[] args) {
		debug = true;
		ANTLRStringStream input = new ANTLRStringStream(t2);
		boolean result = pairMatch(input, 1000);
		System.out.println("Result: " + result);
	}

	public static final String t1 = "hel'lo}and";
	public static final String t2 = "h{ell}o}and";
	public static final String t3 = "run(\"A{}\"); }";
}

From espakm at gmail.com  Tue Oct 13 13:19:03 2009
From: espakm at gmail.com (=?ISO-8859-1?B?RXNw4WsgTWlrbPNz?=)
Date: Tue, 13 Oct 2009 22:19:03 +0200
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <e2a1d9720910131252m6000b61em778b4cc98f20756@mail.gmail.com>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
	<-438686297222296206@unknownmsgid>
	<4.1.20091013123725.02fd2ec0@grahamwideman.com>
	<e2a1d9720910131252m6000b61em778b4cc98f20756@mail.gmail.com>
Message-ID: <e2a1d9720910131319t514b932bp9a3f1db477fa92d2@mail.gmail.com>

Yes, it fails only in interpreted mode.

If I drop down the combo and choose "Run (Java)", it succeeds.

It was mentioned here, that the interpreted mode does not support
predicates, but it is not the case now.
http://antlrv3ide.sourceforge.net/doc/gettingstarted/basictutorial/runningantlrgrammars.html

I will report this as a bug tomorrow.

Thanks for all,

Miklos

From espakm at gmail.com  Tue Oct 13 13:31:46 2009
From: espakm at gmail.com (=?ISO-8859-1?B?RXNw4WsgTWlrbPNz?=)
Date: Tue, 13 Oct 2009 22:31:46 +0200
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <200910132015.n9DKFq02021595@zinc.newtechlaw.com>
References: <e2a1d9720910130933w6a960f9ej58ed992d6efdf806@mail.gmail.com>
	<3820714377830943170@unknownmsgid>
	<e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
	<200910132015.n9DKFq02021595@zinc.newtechlaw.com>
Message-ID: <e2a1d9720910131331q6ecbabf5hbedc4fe989bf0285@mail.gmail.com>

Thank you very much, I will try this code.

The problem was that I tested my grammar in interpreted mode, and it
failed because of a bug in the interpreted mode.
After compiling and running, the same grammar behaves well.

However, your code is much more safe. I need a JavaScript function
only to specify a computation, so I do not have to deal with character
and string literals.

Thank you again,
Miklos

On Tue, Oct 13, 2009 at 10:06 PM, Gerald Rosenberg <gerald at certiv.net> wrote:
> The book and Indhu are both correct.? How to proceed is more a matter of
> what you know about the content between the delimiter pair, its complexity,
> and what you want out of it.? There are modal lexers, island grammars, and
> parser-evaluation alternatives.
>
> The recursive lexer rule definition does not handle quoted strings, which in
> the case of JavaScript will prove fatal.? I believe there is a way to avoid
> this problem, only using pure lexer rules, but it will be complex and the
> margin is too small to contain the proof.
>
> However, if all you want is a single token containing the clob between a
> balanced set of delimiters, there is this simple approach:
>
> @lexer ::members {
>
> public boolean pairMatch(int limit) {
> ??? return Helper.pairMatch(input, limit);
> ? }
> }
>
> BRACE_BLOCK
> ? :? '{' { pairMatch(500) }?
> ? ;
>
> and include the attached helper in your build.? This version recognizes
> nested delimiters subject to line comments and both single and double quoted
> strings.
>
>
>
> At 10:41 AM 10/13/2009, Esp?k Mikl?s wrote:
>
> Hi,
>
> I understand your point of view, but the book states explicitly the
> following:
>
> "ANTLR generates recursive-descent recognizers
> for lexers just as it does for parsers and tree parsers. Consequently,
> ANTLR supports recursive lexer rules, unlike other tools such as lex."
>
> Using recursion it should be possible to create such a lexer rule. If
> not, what it can be used for?
>
> My original problem is that the input files contain a JavaScript
> function definition. The other parts of the input are covered by the
> grammar. However, I do not need to check the validity of the JS
> function, just extract it as is, and pass to the JS engine later. So
> if it is not necessary, I do not want to parse it.
>
> Is it possible somehow? Or should I denote the beginning and the end
> of the JS function by some special token to allow catching it by a
> lexer rule?
>
> Cheers,
> Miklos
>
> 2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
>> Balanced parenthesis cannot be expressed using regular expression which
>> means you cannot recognize it using lexer. You need a push down automata
>> which means you need a parser to recognize it. Try doing it using parser
>> rules.
>>
>>
>>
>> Cheers, Indhu
>>
>>
>>
>>
>>
>> From: antlr-interest-bounces at antlr.org
>> [ mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
>> Sent: Tuesday, October 13, 2009 10:04 PM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] accepting nested code blocks
>>
>>
>>
>> Hi,
>>
>> I want to create a lexer rule accepting nested code blocks.
>>
>> I tried out the example of the Definitive ANTLR Reference (Section 4.3),
>> but
>> it does not work.
>> It accepts only such inputs which do not contain any character other than
>> curly braces. Moreover, one closing brace is enough.
>>
>> The error is the following:
>> MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting 125
>>
>> The original code of the book:
>>
>> fragment
>> CODE[boolean stripCurlies]:
>>?? '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
>>?? {
>>???? if ( stripCurlies ) {
>>?????? setText(getText().substring(1, getText().length()));
>>???? }
>>?? }
>>?? ;
>>
>> The simplified version of the rule results the same:
>> fragment
>> Block: '{' ( Block | ~('{'|'}') )* '}';
>>
>> I use ANTLR 3.2.
>>
>> Does anybody have an idea, how to get around this?
>>
>> Thanks,
>>
>> Miklos
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From lgcraymer at yahoo.com  Tue Oct 13 22:16:45 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Tue, 13 Oct 2009 22:16:45 -0700 (PDT)
Subject: [antlr-interest] bison/yacc to antlr; antlr pretty printer.
In-Reply-To: <4AD4AB41.5000408@kjchome.homeip.net>
References: <4AD4991F.8070007@workstreamautomation.com>
	<013e01ca4c19$d580ec90$8082c5b0$@b@s7software.com>
	<4AD4AB41.5000408@kjchome.homeip.net>
Message-ID: <342653.36612.qm@web55905.mail.re3.yahoo.com>

One other thing:  you will have to generate the java files from the grammars.

--Loring




----- Original Message ----
> From: Kevin J. Cummings <cummings at kjchome.homeip.net>
> To: antlr-interest at antlr.org
> Sent: Tue, October 13, 2009 9:30:57 AM
> Subject: Re: [antlr-interest] bison/yacc to antlr; antlr pretty printer.
> 
> On 10/13/2009 11:28 AM, Indhu Bharathi wrote:
> > http://www.antlr.org/share/list has bison to ANTLR converter. I guess this
> > should work fine for YACC grammars.
> 
> Note this is a Bison => ANTLR v2.7.6 converter.
> 
> It will require some work by hand to make the resulting code work with
> the current v3 ANTLR....
> 
> > Cheers, Indhu
> 
> -- 
> Kevin J. Cummings
> kjchome at rcn.com
> cummings at kjchome.homeip.net
> cummings at kjc386.framingham.ma.us
> Registered Linux User #1232 (http://counter.li.org)
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From sivaits4u at gmail.com  Tue Oct 13 23:51:36 2009
From: sivaits4u at gmail.com (Siva B)
Date: Wed, 14 Oct 2009 12:21:36 +0530
Subject: [antlr-interest] any language compiler(or interpreter)
Message-ID: <581ce2790910132351r2230715bx6b5c3f12af5cc6e4@mail.gmail.com>

Hi,
Anybody implemented any simple language compiler(or interpreter)
Can you just post it for reference.

Good if you have tried it in python

Thanks
Kiso
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091014/fb9e9fce/attachment.html 

From gwlist at grahamwideman.com  Wed Oct 14 01:36:11 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Wed, 14 Oct 2009 01:36:11 -0700
Subject: [antlr-interest] Learning the basics of ANTLR
In-Reply-To: <4.1.20091013110732.02f0e790@grahamwideman.com>
References: <843e610f0910131046h5fc2f894x713def94847041e1@mail.gmail.co m>
Message-ID: <4.1.20091014012408.015f4990@grahamwideman.com>

Just a minor fixup for anyone who stumbles on this thread. Yesterday I wrote:

>So far as I know, there is no impact of order in which the lexer and parser 
>rules appear in the .g file.

... I later realized this could be misleading. I meant order of lexer rules relative to parser rules. Ie: lexer rules can come before, after or intermingled with parser rules.

By contrast, there *is* an impact to the order in which lexer rules are presented, for example, relative to each other. 

At least, that's today's understanding :-).

-- Graham


From gwlist at grahamwideman.com  Wed Oct 14 02:23:47 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Wed, 14 Oct 2009 02:23:47 -0700
Subject: [antlr-interest] Learning the basics of ANTLR
In-Reply-To: <843e610f0910131150g3729fc42n66e48adfac213669@mail.gmail.co
 m>
References: <4.1.20091013114023.03308ae8@grahamwideman.com>
	<4.1.20091013110732.02f0e790@grahamwideman.com>
	<4.1.20091013114023.03308ae8@grahamwideman.com>
Message-ID: <4.1.20091014021522.0311fae8@grahamwideman.com>

Hi Evan -- couple more points on your xml grammar directly relating to your questions.

1. On checking, as I suspected yesterday, the pattern:

('x'|'X') ('m'|'M') ('l'|'L')

... is not scoring a hit because the parser slurps up "xml" as a GENERIC_ID, not as a sequence of three single-character tokens for the three letters. You can verify by temporarily changing the rule to look for 'xml' instead, and you'll see that work.

FWIW, specifying a literal like this in the parser causes ANTLR to generate a token and recognizer code for it in the lexer.

To get the case-insensitive effect, you could create a lexer rule:
XML: ('x'|'X')  ('m'|'M') ('l'|'L') ;
... and use the XML token in the parser xmldecl rule.

2. The attribute parser rule refers to VALUE, which is defined as a lexer fragment. As a lexer fragment, it doesn't generate a token, and consequently the parser will never see it.  

(I believe it's a known issue that ANTLR doesn't flag this as an error.)

Hope that helps,

Graham



From loic.queran at gmail.com  Wed Oct 14 02:26:41 2009
From: loic.queran at gmail.com (=?ISO-8859-1?Q?Lo=EFc_Qu=E9ran?=)
Date: Wed, 14 Oct 2009 11:26:41 +0200
Subject: [antlr-interest] Syntactic predicates in lexer
Message-ID: <30d50a200910140226h402073b6lfabd7621eb4bc889@mail.gmail.com>

Hi,

This is probably a very simple question, but I can't get syntactic
predicates to work in lexer rules:


AssignmentOperatorOrKeywordMarker
  : ':=' => AssignmentOperator
  | ':' => KeywordMarker
  ;

KeywordMarker
  :    ':'
  ;

AssignmentOperator
  :    ':='
  ;

What I want to achieve is to have the lexer produce an assignment operator
':=' token instead of a keyword marker ':' whenever possible.
The error is  "unexpected token: ':='" at AssignmentOperatorOrKeywordMarker
rule definition.

Any help would be welcomed.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091014/03c81f07/attachment.html 

From naveen.chwl at googlemail.com  Wed Oct 14 03:19:45 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Wed, 14 Oct 2009 11:19:45 +0100
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
Message-ID: <56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>

Jim, being new to predicates I realised soon after this that you were
talking about token lookaheads. And yes I do need a syntactic lookahead (but
thas is negative). In beginner-speak, one of my "smaller" rules is
"consuming" something that should belong to a "larger" rule. This would be
correct if that particular something (e.g. "a") was *not* followed by a
syntactic construct conforming to "b". Hence (a !b)=>a (for the smaller
rule) seems the simplest solution to this to me. Is Indhu's version correct
for doing this trick? It doesn't seem to work for me (but I might be doing
something else wrong). If not correct, what is the correct way? My target is
Java.

2009/10/5 Jim Idle <jimi at temporal-wave.com>

>  Use a semantic predicate rather than syntactic. You possibly need a bated
> predicate here too:
>
>
>
> { input.LA(1) == A && input.LA(2) != B}?=>
>
>
>
> However, if you need that kind of syntactic predicate, then I suggest you
> may be approaching your problem incorrectly.
>
>
>
> Jim
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Monday, October 05, 2009 7:02 AM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] How to do "not" in a syntactic predicate?
>
>
>
> If I do
>
>
>
> (a ~b)=> a
>
>
>
> meaning "take this alternative if you encounter an a when not followed by
> b"
>
>
>
> I get a syntax error: unexpected token b
>
> Is it the right syntax to use '~'?
>
>
>
> N
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091014/3119e3be/attachment.html 

From indhu.b at s7software.com  Wed Oct 14 03:20:48 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Wed, 14 Oct 2009 15:50:48 +0530
Subject: [antlr-interest] Syntactic predicates in lexer
In-Reply-To: <30d50a200910140226h402073b6lfabd7621eb4bc889@mail.gmail.com>
References: <30d50a200910140226h402073b6lfabd7621eb4bc889@mail.gmail.com>
Message-ID: <009f01ca4cb7$ff7479b0$fe5d6d10$@b@s7software.com>

Doesn?t a simple approach like the one shown below work?

 

r              :               ASSIGNMENTOP  |  KEYWORDMARKER

                ;

 

ASSIGNMENTOP              :               ':='          ;

                

KEYWORDMARKER          :               ':'             ;

 

I assume you want a different token for ?:=? and ?:?. If I understood the
problem wrong, let me know.

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lo?c Qu?ran
Sent: Wednesday, October 14, 2009 2:57 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Syntactic predicates in lexer

 

Hi,

This is probably a very simple question, but I can't get syntactic
predicates to work in lexer rules:


AssignmentOperatorOrKeywordMarker
  : ':=' => AssignmentOperator
  | ':' => KeywordMarker
  ;
  
KeywordMarker
  :    ':'
  ;
    
AssignmentOperator
  :    ':='
  ;

What I want to achieve is to have the lexer produce an assignment operator
':=' token instead of a keyword marker ':' whenever possible.
The error is  "unexpected token: ':='" at AssignmentOperatorOrKeywordMarker
rule definition.

Any help would be welcomed.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091014/55204e52/attachment.html 

From indhu.b at s7software.com  Wed Oct 14 04:19:04 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Wed, 14 Oct 2009 16:49:04 +0530
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
	<56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>
Message-ID: <00b601ca4cc0$23514180$69f3c480$@b@s7software.com>

The other say I replied from my ipod and was not able to test it with ANTLR.
I checked it now and the code doesn't work for me too. However you can try a
variant:

 

q             :               a ((b)=>NOWAY | /*nothing*/)

                ;

 

fragment NOWAY

                :               ;

 

This is tested J But note that this is only a hack and use it only when
there is no other alternative. 

 

Going by your "one of my "smaller" rules is "consuming" something that
should belong to a "larger" rule" description, it looks like you can solve
that problem by turning off greedy. Grep for 'greedy' in the book or wiki.

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Wednesday, October 14, 2009 3:50 PM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] How to do "not" in a syntactic predicate?

 

Jim, being new to predicates I realised soon after this that you were
talking about token lookaheads. And yes I do need a syntactic lookahead (but
thas is negative). In beginner-speak, one of my "smaller" rules is
"consuming" something that should belong to a "larger" rule. This would be
correct if that particular something (e.g. "a") was *not* followed by a
syntactic construct conforming to "b". Hence (a !b)=>a (for the smaller
rule) seems the simplest solution to this to me. Is Indhu's version correct
for doing this trick? It doesn't seem to work for me (but I might be doing
something else wrong). If not correct, what is the correct way? My target is
Java.

2009/10/5 Jim Idle <jimi at temporal-wave.com>

Use a semantic predicate rather than syntactic. You possibly need a bated
predicate here too:

 

{ input.LA(1) == A && input.LA(2) != B}?=>

 

However, if you need that kind of syntactic predicate, then I suggest you
may be approaching your problem incorrectly.

 

Jim

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Monday, October 05, 2009 7:02 AM 


To: antlr-interest at antlr.org
Subject: [antlr-interest] How to do "not" in a syntactic predicate?

 

If I do

 

(a ~b)=> a

 

meaning "take this alternative if you encounter an a when not followed by b"

 

I get a syntax error: unexpected token b

Is it the right syntax to use '~'?

 

N



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091014/17604a11/attachment.html 

From andersen at ontologyworks.com  Wed Oct 14 08:20:59 2009
From: andersen at ontologyworks.com (Bill Andersen)
Date: Wed, 14 Oct 2009 11:20:59 -0400
Subject: [antlr-interest] AST rewrite infinite loop
Message-ID: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>

Hi folks

I have this production

assertion
	: sentence -> ^(ASSERTION NAME["foo"] sentence)
	;

in a tree grammar with rewrite = true.  This is meant to tack a name  
onto the results of parsing a 'sentence'.  Thing is when I parse a  
sample input I get an infinite tree that looks like this

(ASSERTION foo
	(ASSERTION foo
		(ASSERTION foo
			(ASSERTION foo
				(ASSERTION foo
					....

Thing is that the sentence production does not call assertion,  
otherwise I could understand why my rewrite might get itself reparsed  
or something.

Any idea what's happening here and how to stop it?

	.bill

Bill Andersen
Ontology Works, Inc. (www.ontologyworks.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204





From evanpmeth at gmail.com  Wed Oct 14 10:51:09 2009
From: evanpmeth at gmail.com (Evan Metheny)
Date: Wed, 14 Oct 2009 10:51:09 -0700
Subject: [antlr-interest] any language compiler(or interpreter)
In-Reply-To: <843e610f0910141049lf5a0f1al6291b4a893f82394@mail.gmail.com>
References: <581ce2790910132351r2230715bx6b5c3f12af5cc6e4@mail.gmail.com>
	<843e610f0910141049lf5a0f1al6291b4a893f82394@mail.gmail.com>
Message-ID: <843e610f0910141051p50916988k9f4599bcbeab2e1d@mail.gmail.com>

On Wed, Oct 14, 2009 at 10:49 AM, Evan Metheny <evanpmeth at gmail.com> wrote:
> Kiso,
>
> Look up the book "The Definitive ANTLR Reference" by Terence Parr for
> complete information on ANTLR.
>
> Check out the website specifically the wiki:
> http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3+Wiki+Home
> and
> http://www.antlr.org/wiki/display/ANTLR3/Antlr3PythonTarget
>
> Here is an example lexer parser and tree walking sequence : (from the book)
> http://www.antlr.org/wiki/display/ANTLR3/Example
>
>
> Evan
>
>
>
>
>
> On Tue, Oct 13, 2009 at 11:51 PM, Siva B <sivaits4u at gmail.com> wrote:
>> Hi,
>> Anybody implemented any simple language compiler(or interpreter)
>> Can you just post it for reference.
>>
>> Good if you have tried it in python
>>
>> Thanks
>> Kiso
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>

From naveen.chwl at googlemail.com  Wed Oct 14 11:08:08 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Wed, 14 Oct 2009 19:08:08 +0100
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <3544215969333489941@unknownmsgid>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
	<56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>
	<3544215969333489941@unknownmsgid>
Message-ID: <56eb2660910141108p3fd3d377gb737887a421142be@mail.gmail.com>

Yikes, that doesn't seem to work, it seems to give a normal positive
predicate for me. (Or something). But not "if a not followed by b" => a.

?

2009/10/14 Indhu Bharathi <indhu.b at s7software.com>

>  The other say I replied from my ipod and was not able to test it with
> ANTLR. I checked it now and the code doesn?t work for me too. However you
> can try a variant:
>
>
>
> q             :               a ((b)=>NOWAY | /*nothing*/)
>
>                 ;
>
>
>
> fragment NOWAY
>
>                 :               ;
>
>
>
> This is tested J But note that this is only a hack and use it only when
> there is no other alternative.
>
>
>
> Going by your ?one of my "smaller" rules is "consuming" something that
> should belong to a "larger" rule? description, it looks like you can solve
> that problem by turning off greedy. Grep for ?greedy? in the book or wiki.
>
>
>
> Cheers, Indhu
>
>
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Wednesday, October 14, 2009 3:50 PM
> *To:* Jim Idle
> *Cc:* antlr-interest at antlr.org
> *Subject:* Re: [antlr-interest] How to do "not" in a syntactic predicate?
>
>
>
> Jim, being new to predicates I realised soon after this that you were
> talking about token lookaheads. And yes I do need a syntactic lookahead (but
> thas is negative). In beginner-speak, one of my "smaller" rules is
> "consuming" something that should belong to a "larger" rule. This would be
> correct if that particular something (e.g. "a") was *not* followed by a
> syntactic construct conforming to "b". Hence (a !b)=>a (for the smaller
> rule) seems the simplest solution to this to me. Is Indhu's version correct
> for doing this trick? It doesn't seem to work for me (but I might be doing
> something else wrong). If not correct, what is the correct way? My target is
> Java.
>
> 2009/10/5 Jim Idle <jimi at temporal-wave.com>
>
> Use a semantic predicate rather than syntactic. You possibly need a bated
> predicate here too:
>
>
>
> { input.LA(1) == A && input.LA(2) != B}?=>
>
>
>
> However, if you need that kind of syntactic predicate, then I suggest you
> may be approaching your problem incorrectly.
>
>
>
> Jim
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Monday, October 05, 2009 7:02 AM
>
>
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] How to do "not" in a syntactic predicate?
>
>
>
> If I do
>
>
>
> (a ~b)=> a
>
>
>
> meaning "take this alternative if you encounter an a when not followed by
> b"
>
>
>
> I get a syntax error: unexpected token b
>
> Is it the right syntax to use '~'?
>
>
>
> N
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091014/8f65e7a5/attachment.html 

From indhu.b at s7software.com  Wed Oct 14 11:35:00 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Thu, 15 Oct 2009 00:05:00 +0530
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <56eb2660910141108p3fd3d377gb737887a421142be@mail.gmail.com>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>	
	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>	
	<56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>	
	<3544215969333489941@unknownmsgid>
	<56eb2660910141108p3fd3d377gb737887a421142be@mail.gmail.com>
Message-ID: <000601ca4cfd$0a0a6250$1e1f26f0$@b@s7software.com>

Here is the complete grammar:

 

grammar Test;

 

q             :               a ((b)=>NOWAY | /*nothing*/);

 

a              :               'asd';

b             :               'qwe';

 

fragment NOWAY:          ;

 

 

'q' will accept "asd" but not "asdqwe". Am I missing something?

 

 

BTW, if you can post a simplified example of your exact problem, you might
get more elegant solutions. This is only a hack for the specific problem you
posted. Maybe your original problem can be solved in a more elegant way.
Cases that require hacks of this kind are very rare and arises only while
parsing some very obscure languages. 

 

Cheers, Indhu

 

 

From: Naveen Chawla [mailto:naveen.chwl at googlemail.com] 
Sent: Wednesday, October 14, 2009 11:38 PM
To: Indhu Bharathi
Cc: Jim Idle; antlr-interest at antlr.org
Subject: Re: [antlr-interest] How to do "not" in a syntactic predicate?

 

Yikes, that doesn't seem to work, it seems to give a normal positive
predicate for me. (Or something). But not "if a not followed by b" => a.

 

?

2009/10/14 Indhu Bharathi <indhu.b at s7software.com>

The other say I replied from my ipod and was not able to test it with ANTLR.
I checked it now and the code doesn't work for me too. However you can try a
variant:

 

q             :               a ((b)=>NOWAY | /*nothing*/)

                ;

 

fragment NOWAY

                :               ;

 

This is tested J But note that this is only a hack and use it only when
there is no other alternative. 

 

Going by your "one of my "smaller" rules is "consuming" something that
should belong to a "larger" rule" description, it looks like you can solve
that problem by turning off greedy. Grep for 'greedy' in the book or wiki.

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Wednesday, October 14, 2009 3:50 PM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] How to do "not" in a syntactic predicate?

 

Jim, being new to predicates I realised soon after this that you were
talking about token lookaheads. And yes I do need a syntactic lookahead (but
thas is negative). In beginner-speak, one of my "smaller" rules is
"consuming" something that should belong to a "larger" rule. This would be
correct if that particular something (e.g. "a") was *not* followed by a
syntactic construct conforming to "b". Hence (a !b)=>a (for the smaller
rule) seems the simplest solution to this to me. Is Indhu's version correct
for doing this trick? It doesn't seem to work for me (but I might be doing
something else wrong). If not correct, what is the correct way? My target is
Java.

2009/10/5 Jim Idle <jimi at temporal-wave.com>

Use a semantic predicate rather than syntactic. You possibly need a bated
predicate here too:

 

{ input.LA(1) == A && input.LA(2) != B}?=>

 

However, if you need that kind of syntactic predicate, then I suggest you
may be approaching your problem incorrectly.

 

Jim

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Monday, October 05, 2009 7:02 AM 


To: antlr-interest at antlr.org
Subject: [antlr-interest] How to do "not" in a syntactic predicate?

 

If I do

 

(a ~b)=> a

 

meaning "take this alternative if you encounter an a when not followed by b"

 

I get a syntax error: unexpected token b

Is it the right syntax to use '~'?

 

N



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091015/9e8bc123/attachment.html 

From kirby.bohling at gmail.com  Wed Oct 14 11:41:29 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Wed, 14 Oct 2009 13:41:29 -0500
Subject: [antlr-interest] AST rewrite infinite loop
In-Reply-To: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>
References: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>
Message-ID: <3cac8fdf0910141141r3bf9ea50k24462ff8f28b9208@mail.gmail.com>

I'm not sure what is going on there.  I'd start by removing the
NAME["foo"] from that rule and see what happens.

You might also try including a simplified version of sentence that
continues to have that problem.  In my experience, the process of
minimizing the test case to submit to the list identifies the problem.

Thanks,
   Kirby


On Wed, Oct 14, 2009 at 10:20 AM, Bill Andersen
<andersen at ontologyworks.com> wrote:
> Hi folks
>
> I have this production
>
> assertion
> ? ? ? ?: sentence -> ^(ASSERTION NAME["foo"] sentence)
> ? ? ? ?;
>
> in a tree grammar with rewrite = true. ?This is meant to tack a name
> onto the results of parsing a 'sentence'. ?Thing is when I parse a
> sample input I get an infinite tree that looks like this
>
> (ASSERTION foo
> ? ? ? ?(ASSERTION foo
> ? ? ? ? ? ? ? ?(ASSERTION foo
> ? ? ? ? ? ? ? ? ? ? ? ?(ASSERTION foo
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?(ASSERTION foo
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?....
>
> Thing is that the sentence production does not call assertion,
> otherwise I could understand why my rewrite might get itself reparsed
> or something.
>
> Any idea what's happening here and how to stop it?
>
> ? ? ? ?.bill
>
> Bill Andersen
> Ontology Works, Inc. (www.ontologyworks.com)
> 3600 O'Donnell Street, Suite 600
> Baltimore, MD 21224
> Office: +1.410.675.1201
> Cell: +1.443.858.6444
> Fax: +1.410.675.1204
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From parrt at cs.usfca.edu  Wed Oct 14 12:07:35 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 14 Oct 2009 12:07:35 -0700
Subject: [antlr-interest] any language compiler(or interpreter)
In-Reply-To: <581ce2790910132351r2230715bx6b5c3f12af5cc6e4@mail.gmail.com>
References: <581ce2790910132351r2230715bx6b5c3f12af5cc6e4@mail.gmail.com>
Message-ID: <C24AAF5B-5889-49B5-BB01-13DECDE23FA1@cs.usfca.edu>

new lang impl book is what you want

http://pragprog.com/titles/tpdsl/language-design-patterns

also

http://www.antlr.org/wiki/display/ANTLR3/Pie
http://www.antlr.org/wiki/display/ANTLR3/LLVM
http://www.antlr.org/wiki/display/ANTLR3/Toy+ST+implementation

Ter
On Oct 13, 2009, at 11:51 PM, Siva B wrote:

> Hi,
> Anybody implemented any simple language compiler(or interpreter)
> Can you just post it for reference.
>
> Good if you have tried it in python
>
> Thanks
> Kiso
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From tmarcoe at comcast.net  Wed Oct 14 12:27:30 2009
From: tmarcoe at comcast.net (tmarcoe at comcast.net)
Date: Wed, 14 Oct 2009 19:27:30 +0000 (UTC)
Subject: [antlr-interest] ANTLR input and output
In-Reply-To: <1439331976.2709441255547686176.JavaMail.root@sz0171a.emeryville.ca.mail.comcast.net>
Message-ID: <913354183.2713241255548450154.JavaMail.root@sz0171a.emeryville.ca.mail.comcast.net>



Hello, 



I am a bit new to ANTLR (I love it by the way) so if this is an obvious question, forgive me in advance. 



I am in the process of writing a rule engine. I know that Sun came up with the JS94 standard but I have some ideas to enhance that standard. In order to do this, I'm using ANTLR for the rule definition language, which brings me to my question. 



How do I get values in and out of the script from my Java code. I do have a way to do this but I didn't want to reinvent the wheel, if there is already something in place to do this. I thought I remembered something in the documentation but I can't seem to find it now. 



Tim - 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091014/c6c0ecdf/attachment.html 

From andersen at ontologyworks.com  Wed Oct 14 13:15:37 2009
From: andersen at ontologyworks.com (Bill Andersen)
Date: Wed, 14 Oct 2009 16:15:37 -0400
Subject: [antlr-interest] AST rewrite infinite loop
In-Reply-To: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>
References: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>
Message-ID: <57DCC22A-BFC3-4DA2-B6AF-F89F3DA982F6@ontologyworks.com>

FYI, all.  The problem described does NOT occur without rewrite = true

On Oct 14, 2009, at 11:20 , Bill Andersen wrote:

> Hi folks
>
> I have this production
>
> assertion
> 	: sentence -> ^(ASSERTION NAME["foo"] sentence)
> 	;
>
> in a tree grammar with rewrite = true.  This is meant to tack a name
> onto the results of parsing a 'sentence'.  Thing is when I parse a
> sample input I get an infinite tree that looks like this
>
> (ASSERTION foo
> 	(ASSERTION foo
> 		(ASSERTION foo
> 			(ASSERTION foo
> 				(ASSERTION foo
> 					....
>
> Thing is that the sentence production does not call assertion,
> otherwise I could understand why my rewrite might get itself reparsed
> or something.
>
> Any idea what's happening here and how to stop it?
>
> 	.bill
>
> Bill Andersen
> Ontology Works, Inc. (www.ontologyworks.com)
> 3600 O'Donnell Street, Suite 600
> Baltimore, MD 21224
> Office: +1.410.675.1201
> Cell: +1.443.858.6444
> Fax: +1.410.675.1204
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

Bill Andersen
Ontology Works, Inc. (www.ontologyworks.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204





From jbb at acm.org  Wed Oct 14 13:38:23 2009
From: jbb at acm.org (John B. Brodie)
Date: Wed, 14 Oct 2009 16:38:23 -0400
Subject: [antlr-interest] AST rewrite infinite loop
In-Reply-To: <57DCC22A-BFC3-4DA2-B6AF-F89F3DA982F6@ontologyworks.com>
References: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>
	<57DCC22A-BFC3-4DA2-B6AF-F89F3DA982F6@ontologyworks.com>
Message-ID: <1255552703.11174.7.camel@gecko.home.org>

Greetings!

On Wed, 2009-10-14 at 16:15 -0400, Bill Andersen wrote:
> FYI, all.  The problem described does NOT occur without rewrite = true
> 
Isn't rewrite = true for Tree grammars only? -- your rule below looks
like a Parser rule to me - altho can't really tell for sure...

> On Oct 14, 2009, at 11:20 , Bill Andersen wrote:
> 
> > Hi folks
> >
> > I have this production
> >
> > assertion
> > 	: sentence -> ^(ASSERTION NAME["foo"] sentence)
> > 	;

Appended below is a COMPLETE Parsing example using just this rule.

And it WORKS just fine.

Could you please modify this complete example so that it will
demonstrate the error you are seeing. And then maybe someone will be
better able to figure out what is the cause.

Thank You
   -jbb

> >
> > in a tree grammar with rewrite = true.  This is meant to tack a name
> > onto the results of parsing a 'sentence'.  Thing is when I parse a
> > sample input I get an infinite tree that looks like this
> >
> > (ASSERTION foo
> > 	(ASSERTION foo
> > 		(ASSERTION foo
> > 			(ASSERTION foo
> > 				(ASSERTION foo
> > 					....
> >
> > Thing is that the sentence production does not call assertion,
> > otherwise I could understand why my rewrite might get itself reparsed
> > or something.
> >
> > Any idea what's happening here and how to stop it?

//-----begin cut here ----- cut here ----- cut here -----

grammar Test;

options {
    output = AST;
    ASTLabelType = CommonTree;
}

tokens {
   ASSERTION;
   NAME;
}

@members {
    private static final String [] x = new String[]{
       "a sentence goes here"
    };

    public static void main(String [] args) {
        for( int i = 0; i < x.length; ++i ) {
            try {
                System.out.println("about to parse:`"+x[i]+"`");
                TestLexer lexer = new TestLexer(new
ANTLRStringStream(x[i]));
                CommonTokenStream tokens = new CommonTokenStream(lexer);

                TestParser parser = new TestParser(tokens);
                TestParser.start_return p_result = parser.start();

                CommonTree ast = p_result.tree;
                if( ast == null ) {
                   System.out.println("resultant tree: is NULL");
                } else {
                   System.out.println("resultant tree: " +
ast.toStringTree());
                }
                System.out.println();
            } catch(Exception e) {
                e.printStackTrace();
            }
        }
    }
}

start : assertion EOF!;
         
assertion : sentence -> ^(ASSERTION NAME["foo"] sentence) ;

sentence : 'a sentence goes here' ;

WS : ( ' ' | '\t' | '\r' | '\n' )+ { $channel=HIDDEN; } ;

// ----- end cut here ----- cut here ----- cut here -----



From evanpmeth at gmail.com  Wed Oct 14 15:42:55 2009
From: evanpmeth at gmail.com (Evan Metheny)
Date: Wed, 14 Oct 2009 15:42:55 -0700
Subject: [antlr-interest] ANTLR input and output
In-Reply-To: <913354183.2713241255548450154.JavaMail.root@sz0171a.emeryville.ca.mail.comcast.net>
References: <1439331976.2709441255547686176.JavaMail.root@sz0171a.emeryville.ca.mail.comcast.net>
	<913354183.2713241255548450154.JavaMail.root@sz0171a.emeryville.ca.mail.comcast.net>
Message-ID: <843e610f0910141542t7d241bb5p3544a086f603c8a3@mail.gmail.com>

Tim,

Not exactly sure what you are trying to ask, but ill take a stab at
it.  Im not sure what Sun's JS94 Standard is? Im guessing it has to do
with some sort of data traversal techniques. But I am unclear how
ANTLR relates, except for the fact that antlr could probably be used
to re-write this JS94 standard the way you want.

>How do I get values in and out of the script from my Java code.
Im not sure on this one either, This script you are talking about is
presumably ANTLR itself or what you created in ANTLR?
ANTLR's output can be in any of the target languages you want: java,
python, etc.
So if your writing your "program" in Java it can easily be
incorporated. This is because the code generated from the grammar
files by ANTLR is written in the TARGET language you desire.




On Wed, Oct 14, 2009 at 12:27 PM,  <tmarcoe at comcast.net> wrote:
> Hello,
>
>
>
> I am a bit new to ANTLR (I love it by the way) so if this is an obvious
> question, forgive me in advance.
>
>
>
> I am in the process of writing a rule engine. I know that Sun came up with
> the JS94 standard but I have some ideas to enhance that standard. In order
> to do this, I'm using ANTLR for the rule definition language, which brings
> me to my question.
>
>
>
> How do I get values in and out of the script from my Java code. I do have a
> way to do this but I didn't want to reinvent the wheel, if there is already
> something in place to do this. I thought I remembered something in the
> documentation but I can't seem to find it now.
>
>
>
> Tim -
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From andersen at ontologyworks.com  Wed Oct 14 15:46:23 2009
From: andersen at ontologyworks.com (Bill Andersen)
Date: Wed, 14 Oct 2009 18:46:23 -0400
Subject: [antlr-interest] AST rewrite infinite loop
In-Reply-To: <1255552703.11174.7.camel@gecko.home.org>
References: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>
	<57DCC22A-BFC3-4DA2-B6AF-F89F3DA982F6@ontologyworks.com>
	<1255552703.11174.7.camel@gecko.home.org>
Message-ID: <D910BE31-7FA6-4DB8-A95A-753639756A7C@ontologyworks.com>


On Oct 14, 2009, at 16:38 , John B. Brodie wrote:

> Greetings!
>
> On Wed, 2009-10-14 at 16:15 -0400, Bill Andersen wrote:
>> FYI, all.  The problem described does NOT occur without rewrite =  
>> true
>>
> Isn't rewrite = true for Tree grammars only? -- your rule below looks
> like a Parser rule to me - altho can't really tell for sure...

Nah, it's a tree grammar, 'sentence' bundles up a bunch of different  
AST patterns for sentences, like

sentence
	: ^(ATOM term+)
	| ^(IMPL sentence sentence)
	| ...
	;

>> On Oct 14, 2009, at 11:20 , Bill Andersen wrote:
>>
>>> Hi folks
>>>
>>> I have this production
>>>
>>> assertion
>>> 	: sentence -> ^(ASSERTION NAME["foo"] sentence)
>>> 	;
>
> Appended below is a COMPLETE Parsing example using just this rule.
>
> And it WORKS just fine.
>
> Could you please modify this complete example so that it will
> demonstrate the error you are seeing. And then maybe someone will be
> better able to figure out what is the cause.
>
> Thank You
>   -jbb
>
>>>
>>> in a tree grammar with rewrite = true.  This is meant to tack a name
>>> onto the results of parsing a 'sentence'.  Thing is when I parse a
>>> sample input I get an infinite tree that looks like this
>>>
>>> (ASSERTION foo
>>> 	(ASSERTION foo
>>> 		(ASSERTION foo
>>> 			(ASSERTION foo
>>> 				(ASSERTION foo
>>> 					....
>>>
>>> Thing is that the sentence production does not call assertion,
>>> otherwise I could understand why my rewrite might get itself  
>>> reparsed
>>> or something.
>>>
>>> Any idea what's happening here and how to stop it?
>
> //-----begin cut here ----- cut here ----- cut here -----
>
> grammar Test;
>
> options {
>    output = AST;
>    ASTLabelType = CommonTree;
> }
>
> tokens {
>   ASSERTION;
>   NAME;
> }
>
> @members {
>    private static final String [] x = new String[]{
>       "a sentence goes here"
>    };
>
>    public static void main(String [] args) {
>        for( int i = 0; i < x.length; ++i ) {
>            try {
>                System.out.println("about to parse:`"+x[i]+"`");
>                TestLexer lexer = new TestLexer(new
> ANTLRStringStream(x[i]));
>                CommonTokenStream tokens = new CommonTokenStream 
> (lexer);
>
>                TestParser parser = new TestParser(tokens);
>                TestParser.start_return p_result = parser.start();
>
>                CommonTree ast = p_result.tree;
>                if( ast == null ) {
>                   System.out.println("resultant tree: is NULL");
>                } else {
>                   System.out.println("resultant tree: " +
> ast.toStringTree());
>                }
>                System.out.println();
>            } catch(Exception e) {
>                e.printStackTrace();
>            }
>        }
>    }
> }
>
> start : assertion EOF!;
>
> assertion : sentence -> ^(ASSERTION NAME["foo"] sentence) ;
>
> sentence : 'a sentence goes here' ;
>
> WS : ( ' ' | '\t' | '\r' | '\n' )+ { $channel=HIDDEN; } ;
>
> // ----- end cut here ----- cut here ----- cut here -----
>
>

Bill Andersen
Ontology Works, Inc. (www.ontologyworks.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204





From gerald at certiv.net  Wed Oct 14 16:21:34 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Wed, 14 Oct 2009 16:21:34 -0700
Subject: [antlr-interest] AST rewrite infinite loop
In-Reply-To: <D910BE31-7FA6-4DB8-A95A-753639756A7C@ontologyworks.com>
References: <EDA1D76D-3587-4DCD-9C19-13B57ECEE9FA@ontologyworks.com>
	<57DCC22A-BFC3-4DA2-B6AF-F89F3DA982F6@ontologyworks.com>
	<1255552703.11174.7.camel@gecko.home.org>
	<D910BE31-7FA6-4DB8-A95A-753639756A7C@ontologyworks.com>
Message-ID: <200910142321.n9ENLo9h010297@zinc.newtechlaw.com>

At 03:46 PM 10/14/2009, Bill Andersen wrote:

>On Oct 14, 2009, at 16:38 , John B. Brodie wrote:
>
> > Greetings!
> >
> > On Wed, 2009-10-14 at 16:15 -0400, Bill Andersen wrote:
> >> FYI, all.  The problem described does NOT occur without rewrite =
> >> true
> >>
> > Isn't rewrite = true for Tree grammars only? -- your rule below looks
> > like a Parser rule to me - altho can't really tell for sure...
>
>Nah, it's a tree grammar, 'sentence' bundles up a bunch of different
>AST patterns for sentences, like
>
>sentence
>         : ^(ATOM term+)
>         | ^(IMPL sentence sentence)
>         | ...
>         ;

So, the "assertion" tree grammar rule will match on every instance of 
a "sentence" node in the AST.

If the rewrite is being performed in place, the tree pattern match 
will recurse infinitely on the rewritten nodes.  This would match 
your reported results, including the consequence of turning rewrite 
off.  Have to check the generated tree parser code to verify that 
this is what is going on.

If the rewrite is unique -- the source AST does not contain ASSERTION 
rooted sentence nodes that you want to rewrite -- you can add a 
predicate to prevent the recursion.

assertion : { !hasParent(ASSERTION) }? sentence -> ^(ASSERTION 
NAME["foo"] sentence)





> >> On Oct 14, 2009, at 11:20 , Bill Andersen wrote:
> >>
> >>> Hi folks
> >>>
> >>> I have this production
> >>>
> >>> assertion
> >>>     : sentence -> ^(ASSERTION NAME["foo"] sentence)
> >>>     ;
> >
> > Appended below is a COMPLETE Parsing example using just this rule.
> >
> > And it WORKS just fine.
> >
> > Could you please modify this complete example so that it will
> > demonstrate the error you are seeing. And then maybe someone will be
> > better able to figure out what is the cause.
> >
> > Thank You
> >   -jbb
> >
> >>>
> >>> in a tree grammar with rewrite = true.  This is meant to tack a name
> >>> onto the results of parsing a 'sentence'.  Thing is when I parse a
> >>> sample input I get an infinite tree that looks like this
> >>>
> >>> (ASSERTION foo
> >>>     (ASSERTION foo
> >>>             (ASSERTION foo
> >>>                     (ASSERTION foo
> >>>                             (ASSERTION foo
> >>>                                     ....
> >>>
> >>> Thing is that the sentence production does not call assertion,
> >>> otherwise I could understand why my rewrite might get itself
> >>> reparsed
> >>> or something.
> >>>
> >>> Any idea what's happening here and how to stop it?
> >


From evanpmeth at gmail.com  Wed Oct 14 18:11:29 2009
From: evanpmeth at gmail.com (Evan Metheny)
Date: Wed, 14 Oct 2009 18:11:29 -0700
Subject: [antlr-interest] ANTLR input and output
In-Reply-To: <2139103245.2788381255562247315.JavaMail.root@sz0171a.emeryville.ca.mail.comcast.net>
References: <2139103245.2788381255562247315.JavaMail.root@sz0171a.emeryville.ca.mail.comcast.net>
Message-ID: <843e610f0910141811y79bfa81cl41057e33ee1877ed@mail.gmail.com>

Tim, (Please reply to the mail group as well)
-------------------------
On Wed, Oct 14, 2009 at 4:17 PM,  <tmarcoe at comcast.net> wrote:
> Wow! Thank you for getting back with me so soon. To clear things up, let me
> give you a for instance. This will also give you a glimps of a rule engine
> (which I think will grow in popularity, by the way):
>
> Let's say that I have a form, written in Java, that assigns Medicaid account
> numbers to dispurse funds to the medical staff.
>
> What I want to do is gather all of the applicable demographic information
> and determine an account number, based upon the aforementioned information.
> For example, I would take the age, facility of care, sex of the indivual (to
> flag a pregnacy test to a male) and anything else to determine what Medicade
> account the state will draw from (I actually worked on?a system like this in
> PA).
>
> The problem is that these rules are constantly changing because... well...
> it's the government. So, what if we define our own language (that's where
> ANTLR comes in), have our core application written in Java but have the
> business decision information written in our new language. That will help 2
> ways:
>
>
> It will further seperate the data from the core application.
> It will be more easily modified, without having to go through a whole
> development cycle, just to change data.
>
> Now for the question:
>
> Using our above example, I have my demographic information gathered from the
> tables, in Java so I need to execute my ANTRL generated script which will
> gather the information from my core application (the first part that I'm
> having trouble with), process it and send out the result back to the core
> application (the second part that I'm having trouble with). To add humor to
> the issue: "it seems that what goes on in an ANTLR generated script, stays
> in an ANTLR generated script." I just need to be able to pass in and out
> data structures between my core application and my ANTLR generated script.
>
> Does that help clear in up?
>
>
>
> Once again, thank you for getting back to me so quickly.
>
>
>
> Tim -

--------------











>
>
>
> ----- Original Message -----
>
> From: "Evan Metheny" <evanpmeth at gmail.com>
> To: <tmarcoe at comcast.net>
> Cc: <antlr-interest at antlr.org>
> Sent: Wednesday, October 14, 2009 5:42 PM
> Subject: Re: [antlr-interest] ANTLR input and output
>> Tim,
>>
>> Not exactly sure what you are trying to ask, but ill take a stab at
>> it.? Im not sure what Sun's JS94 Standard is? Im guessing it has to do
>> with some sort of data traversal techniques. But I am unclear how
>> ANTLR relates, except for the fact that antlr could probably be used
>> to re-write this JS94 standard the way you want.
>>
>>>How do I get values in and out of the script from my Java code.
>> Im not sure on this one either, This script you are talking about is
>> presumably ANTLR itself or what you created in ANTLR?
>> ANTLR's output can be in any of the target languages you want: java,
>> python, etc.
>> So if your writing your "program" in Java it can easily be
>> incorporated. This is because the code generated from the grammar
>> files by ANTLR is written in the TARGET language you desire.
>>
>>
>>
>>
>> On Wed, Oct 14, 2009 at 12:27 PM,? <tmarcoe at comcast.net> wrote:
>>> Hello,
>>>
>>>
>>>
>>> I am a bit new to ANTLR (I love it by the way) so if this is an obvious
>>> question, forgive me in advance.
>>>
>>>
>>>
>>> I am in the process of writing a rule engine. I know that Sun came up
>>> with
>>> the JS94 standard but I have some ideas to enhance that standard. In
>>> order
>>> to do this, I'm using ANTLR for the rule definition language, which
>>> brings
>>> me to my question.
>>>
>>>
>>>
>>> How do I get values in and out of the script from my Java code. I do have
>>> a
>>> way to do this but I didn't want to reinvent the wheel, if there is
>>> already
>>> something in place to do this. I thought I remembered something in the
>>> documentation but I can't seem to find it now.
>>>
>>>
>>>
>>> Tim -
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>

From espakm at gmail.com  Thu Oct 15 01:49:56 2009
From: espakm at gmail.com (=?ISO-8859-1?B?RXNw4WsgTWlrbPNz?=)
Date: Thu, 15 Oct 2009 10:49:56 +0200
Subject: [antlr-interest] maven plugin, grammars for testing
Message-ID: <e2a1d9720910150149u249c644tcfb141ee82353017@mail.gmail.com>

Hi,

I created a grammar that allows writing simple tests for a term rewriting
system.
I placed the grammar under src/test/antlr3/<my package>/ .

This directory is not processed by the antlr3 plugin by default, so I added
a new execution to the plugin, specifying the the source directory mentioned
above. The sources are generated to target/generated-sources.

The problem is that this directory is not in the source path of the compiler
plugin at the test-compile phase. I also tried to set the outputDirectory to
target/generated-test-sources, but nothing changed. The source path
contained only src/test/java and I did not find any way to add another
directory to it.

The only solution was to set the output directory to src/test/java what is
not a nice solution.

      <plugin>
        <groupId>org.antlr</groupId>
        <artifactId>antlr3-maven-plugin</artifactId>
          <executions>
            <execution>
              <id>default</id>
              <goals>
                <goal>antlr</goal>
              </goals>
            </execution>
            <execution>
              <id>test</id>
              <phase>generate-test-sources</phase>
              <goals>
                <goal>antlr</goal>
              </goals>
              <configuration>
                <sourceDirectory>src/test/antlr3</sourceDirectory>

<!--outputDirectory>target/generated-sources</outputDirectory-->

<!--outputDirectory>target/generated-test-sources</outputDirectory-->
                <outputDirectory>src/test/java</outputDirectory>
              </configuration>
            </execution>
          </executions>
      </plugin>

Is it possible to add target/generated-test-sources directory to the source
path of the compiler plugin for the test-compile phase?

I think, it would be a comfortable default behaviour if the plugin would
process src/test/antlr3 by default and it would generate sources under
target/generated-test-sources. (If there is a way to add that directory to
the source path of the compiler.)

Thanks,
Miklos
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091015/d27bef3d/attachment.html 

From jimi at temporal-wave.com  Fri Oct 16 02:52:08 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 16 Oct 2009 15:22:08 +0530
Subject: [antlr-interest] [SOLVED] ANTLR3 C runtime in HP-UX
In-Reply-To: <3c2632090910120238r71904eadpe800019e56d39a41@mail.gmail.com>
Message-ID: <746d22b54d17f44281e57deb1e18ccd9@temporal-wave.com>

What version of HPUX is this? I have it fixed for the versions I have come across I think. HPUX is such a bag of nails; it is always the odd man out.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Hugo Picado
Sent: Monday, October 12, 2009 3:09 PM
To: antlr-interest at antlr.org ANTLR
Subject: [antlr-interest] [SOLVED] ANTLR3 C runtime in HP-UX

 

Hi,

 

When compiling libantlr3c-3.2 in HP-UX it gives the following error:

 

Error 172: "src/antlr3debughandlers.c", line 302 # Undeclared variable 'TCP_NODELAY'.
                    setsockopt(delboy->socket, SOL_SOCKET, TCP_NODELAY, (const void *)&optVal, sizeof(optVal));

 

 

To solve this problem it is enough to have the following include in the file src/antlr3debughandlers.c:

 

#include  <netinet/tcp.h>

 

 

Terence, please consider this in a next release.

 

Best regards,

Hugo.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/10999aff/attachment.html 

From jimi at temporal-wave.com  Fri Oct 16 02:56:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 16 Oct 2009 15:26:59 +0530
Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
In-Reply-To: <4AD32106.1040704@gmail.com>
Message-ID: <7e427f8f6f5f354ca646cb9d30145f50@temporal-wave.com>

LO LE and PURETEXT are ambiguous - you should eb getting warnings about that (which yuou should not ignore). 

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Martin Potier
> Sent: Monday, October 12, 2009 5:59 PM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] [LEXER] Unwanted behaviour ?
> 
> certainly :
> 
> 
> link
> 	: LO PURETEXT ('|' PURETEXT)? LE
> 	;
> 
> 
> LO	: '[[';		// Link opening
> LE	: ']]';		// Link ending
> 
> PURETEXT
> 	:  ( ESC_SEQ |
> ~('\\'|TM1|TM2|TM3|TM4|ULM|LO|LE|OLM|BM|IM|UM|'|'|'\n') )+
> 	;
> 
> 
> Indhu Bharathi a ?crit :
> > Can you post a small sample where the problem exists?
> >
> >
> >
> >
> >
> > -----Original Message-----
> > From: antlr-interest-bounces at antlr.org
> > [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Potier
> > Sent: Monday, October 12, 2009 5:44 PM
> > To: antlr-interest at antlr.org
> > Subject: [antlr-interest] [LEXER] Unwanted behaviour ?
> >
> >
> >
> > Hi,
> >
> >
> >
> > There's something I can't explain : in the lexer, a terminal defined
> >
> > with '[' is perfectly matched. If i modify it to '[[' it is ignored.
> Did
> >
> > I miss something ?
> >
> >
> >
> > Is that a remaining behaviour from ANTLR 2 ?
> >
> >
> >
> > Thanks
> >
> >
> >
> > --
> >
> > Martin
> >
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-
> address
> >
> >
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Fri Oct 16 03:07:22 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 16 Oct 2009 15:37:22 +0530
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <45418a3a0910121521j4def4ev3f9caaaea5772b4c@mail.gmail.com>
Message-ID: <201275d04ee5c5439ec7c0e65d4e52cf@temporal-wave.com>

ANTLR works internally with 32 bit Unicode (UTF32), not EBCDIC, even if it is in 8 bit mode. So you need to convert the EBCDIC to Unicode 8 bits and use the ?ASCII? input stream. A simple way to do this would be to write your own EBCDIC input stream that just converted to Unicode code points (essentially EBCDIC->ASCII) on the fly via a lookup table. Trivial and should be pretty quick.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lego Haryanto
Sent: Tuesday, October 13, 2009 3:51 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

I just recently noticed that the generated code from my lexer grammar contains something like the following snippet:

            .
            .
            else if ( (((LA17_0 >= 'A') && (LA17_0 <= 'Z'))) ) 
            {
                alt17=2;
            }
            else if ( (((LA17_0 >= 'a') && (LA17_0 <= 'z'))) ) 
            {
                alt17=3;
            }
            else if ( (((LA17_0 >= 0x00A0) && (LA17_0 <= 0xD7FF))) ) 
            {
                alt17=4;
            }
            .
            .

The generated code seems to comfortably use 'A' ... 'Z' literals.  This may not be good if let's say I compile the generated code in an IBM z/OS EBCDIC environment as ['A' .. 'Z'] range contains more than just the 26 alphabet codes and the value of the codes are not the same as the ones in Unicode character set.

I'm expecting something like in the third expression where 'A' is written explicitly as 0x0041 (Unicode for 'A').

Please confirm.

-Lego



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/8ce78c4b/attachment.html 

From jimi at temporal-wave.com  Fri Oct 16 03:49:46 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 16 Oct 2009 16:19:46 +0530
Subject: [antlr-interest] caseSensitive = false in C taget ??
In-Reply-To: <op.u1qigkp7t3jqlu@win-mupvrp0jyrf>
Message-ID: <e4df1b745df5214cbacc0631c523c8ca@temporal-wave.com>

There is no such option in ANTLR 3.

If you want to use ANTLR 3 target, then read the documentation and also the article on case insensitive parsing (which is in the Wiki), which tells you how to do this. You may wish to read up on ANTLR 3 before starting though.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of ??????? ??????
> Sent: Tuesday, October 13, 2009 4:07 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] caseSensitive = false in C taget ??
> 
> this option doesn't work. But i want to use it... what can i do?
> 
> 
> --
> Best regards,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Fri Oct 16 03:50:29 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 16 Oct 2009 16:20:29 +0530
Subject: [antlr-interest] caseSensitive = false in C taget ??
In-Reply-To: <011801ca4bf3$f6e0bc60$e4a23520$@b@s7software.com>
Message-ID: <86845d8555fb104693aada28ba795c32@temporal-wave.com>

There is. Please read the documentation otherwise there is little point in me writing it ;-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Indhu Bharathi
> Sent: Tuesday, October 13, 2009 4:28 PM
> To: ??????? ??????; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] caseSensitive = false in C taget ??
> 
> AFAIK, there is no shortcut.
> 
> You will have to write something like
> 
> HELLO	:	( ('H'|'h') ('E'|'e') ('L'|'l') ('L'|'l') ('O'|'o') )
> 	;
> 
> 
> You can make it more readable using fragments.
> 
> HELLO : H E L L O
> 
> fragment H: ('H'|'h')
> 
> fragment E: ('E'|'e')
> 
> fragment L: ('L'|'l')
> 
> fragment O: ('O'|'o')
> 
> 
> If you don't care about case in the complete text, you can consider
> creating
> your own Stream subclassing StringStream or write a wrapper on top of
> it and
> emit all characters in lower case. Then you parser needs to handle only
> lower case.
> 
> Cheers, Indhu
> 
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of ??????? ??????
> Sent: Tuesday, October 13, 2009 4:07 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] caseSensitive = false in C taget ??
> 
> this option doesn't work. But i want to use it... what can i do?
> 
> 
> --
> Best regards,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From naveen.chwl at googlemail.com  Thu Oct 15 04:13:47 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Thu, 15 Oct 2009 12:13:47 +0100
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <191938162188708907@unknownmsgid>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
	<56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>
	<3544215969333489941@unknownmsgid>
	<56eb2660910141108p3fd3d377gb737887a421142be@mail.gmail.com>
	<191938162188708907@unknownmsgid>
Message-ID: <56eb2660910150413t558fda56q4d78888086f5cf09@mail.gmail.com>

Yes, if you put "sentence: q b;" above q then it accepts "asdqwe", even
though the *a* in q is followed by *b*. And in fact, on my side, accepts *a*
regardless of what it's followed by. So the predicate seems to have no
effect, on my side.

I haven't yet been able to reproduce the problem itself in simpler form,
and I agree about trying to find other ways, although unable so far. A
working workaround of "not followed by" would fix the whole problem though.

Jim posted in 2007 a PEG-style "followed by" solution using "foo: a
{input.mark();} b {input.rewind();}".. which "takes *a* and *b* and then
rewinds as if it it has just taken *a* "  so I was wondering if there was a
solution for "not followed by" using mark(), rewind() and maybe reset()
which "takes *a* and *b* and then (something or another?)..." ?
2009/10/14 Indhu Bharathi <indhu.b at s7software.com>

>  Here is the complete grammar:
>
>
>
> grammar Test;
>
>
>
> q             :               a ((b)=>NOWAY | /*nothing*/);
>
>
>
> a              :               'asd';
>
> b             :               'qwe';
>
>
>
> fragment NOWAY:          ;
>
>
>
>
>
> ?q? will accept ?asd? but not ?asdqwe?. Am I missing something?
>
>
>
>
>
> BTW, if you can post a simplified example of your exact problem, you might
> get more elegant solutions. This is only a hack for the specific problem you
> posted. Maybe your original problem can be solved in a more elegant way.
> Cases that require hacks of this kind are very rare and arises only while
> parsing some very obscure languages.
>
>
>
> Cheers, Indhu
>
>
>
>
>
> *From:* Naveen Chawla [mailto:naveen.chwl at googlemail.com]
> *Sent:* Wednesday, October 14, 2009 11:38 PM
> *To:* Indhu Bharathi
> *Cc:* Jim Idle; antlr-interest at antlr.org
>
> *Subject:* Re: [antlr-interest] How to do "not" in a syntactic predicate?
>
>
>
> Yikes, that doesn't seem to work, it seems to give a normal positive
> predicate for me. (Or something). But not "if a not followed by b" => a.
>
>
>
> ?
>
> 2009/10/14 Indhu Bharathi <indhu.b at s7software.com>
>
> The other say I replied from my ipod and was not able to test it with
> ANTLR. I checked it now and the code doesn?t work for me too. However you
> can try a variant:
>
>
>
> q             :               a ((b)=>NOWAY | /*nothing*/)
>
>                 ;
>
>
>
> fragment NOWAY
>
>                 :               ;
>
>
>
> This is tested J But note that this is only a hack and use it only when
> there is no other alternative.
>
>
>
> Going by your ?one of my "smaller" rules is "consuming" something that
> should belong to a "larger" rule? description, it looks like you can solve
> that problem by turning off greedy. Grep for ?greedy? in the book or wiki.
>
>
>
> Cheers, Indhu
>
>
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Wednesday, October 14, 2009 3:50 PM
> *To:* Jim Idle
> *Cc:* antlr-interest at antlr.org
> *Subject:* Re: [antlr-interest] How to do "not" in a syntactic predicate?
>
>
>
> Jim, being new to predicates I realised soon after this that you were
> talking about token lookaheads. And yes I do need a syntactic lookahead (but
> thas is negative). In beginner-speak, one of my "smaller" rules is
> "consuming" something that should belong to a "larger" rule. This would be
> correct if that particular something (e.g. "a") was *not* followed by a
> syntactic construct conforming to "b". Hence (a !b)=>a (for the smaller
> rule) seems the simplest solution to this to me. Is Indhu's version correct
> for doing this trick? It doesn't seem to work for me (but I might be doing
> something else wrong). If not correct, what is the correct way? My target is
> Java.
>
> 2009/10/5 Jim Idle <jimi at temporal-wave.com>
>
> Use a semantic predicate rather than syntactic. You possibly need a bated
> predicate here too:
>
>
>
> { input.LA(1) == A && input.LA(2) != B}?=>
>
>
>
> However, if you need that kind of syntactic predicate, then I suggest you
> may be approaching your problem incorrectly.
>
>
>
> Jim
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Monday, October 05, 2009 7:02 AM
>
>
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] How to do "not" in a syntactic predicate?
>
>
>
> If I do
>
>
>
> (a ~b)=> a
>
>
>
> meaning "take this alternative if you encounter an a when not followed by
> b"
>
>
>
> I get a syntax error: unexpected token b
>
> Is it the right syntax to use '~'?
>
>
>
> N
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091015/4a05b357/attachment.html 

From legoharyanto at gmail.com  Thu Oct 15 07:56:44 2009
From: legoharyanto at gmail.com (Lego Haryanto)
Date: Thu, 15 Oct 2009 07:56:44 -0700
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <201275d04ee5c5439ec7c0e65d4e52cf@temporal-wave.com>
References: <45418a3a0910121521j4def4ev3f9caaaea5772b4c@mail.gmail.com>
	<201275d04ee5c5439ec7c0e65d4e52cf@temporal-wave.com>
Message-ID: <45418a3a0910150756j62214253s565d084fd455477a@mail.gmail.com>

Jim, thanks for your response ...

I know that in the EBCDIC system we feed a Unicode stream into the lexer,
thus I'm pretty sure when the generated lexer code I pasted before is
executed, it is already operating on the 32-bit unicode stream.

The problem is more about the native C compilation in an EBCDIC system like
IBM z/OS mainframe.

To see if a character from the Unicode stream is an 'A', we have to compare
with a value 0x0041 ... If we match it with a native 'A' in the code, this
will not be a match in an EBCDIC C compilation.

Best,
-Lego

On Fri, Oct 16, 2009 at 3:07 AM, Jim Idle <jimi at temporal-wave.com> wrote:

>  ANTLR works internally with 32 bit Unicode (UTF32), not EBCDIC, even if
> it is in 8 bit mode. So you need to convert the EBCDIC to Unicode 8 bits and
> use the ?ASCII? input stream. A simple way to do this would be to write your
> own EBCDIC input stream that just converted to Unicode code points
> (essentially EBCDIC->ASCII) on the fly via a lookup table. Trivial and
> should be pretty quick.
>
>
>
> Jim
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Lego Haryanto
> *Sent:* Tuesday, October 13, 2009 3:51 AM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] ANTLR C: Question regarding the portability of
> generated lexer C code
>
>
>
> I just recently noticed that the generated code from my lexer grammar
> contains something like the following snippet:
>
>             .
>             .
>             else if ( (((LA17_0 >= 'A') && (LA17_0 <= 'Z'))) )
>             {
>                 alt17=2;
>             }
>             else if ( (((LA17_0 >= 'a') && (LA17_0 <= 'z'))) )
>             {
>                 alt17=3;
>             }
>             else if ( (((LA17_0 >= 0x00A0) && (LA17_0 <= 0xD7FF))) )
>             {
>                 alt17=4;
>             }
>             .
>             .
>
> The generated code seems to comfortably use 'A' ... 'Z' literals.  This may
> not be good if let's say I compile the generated code in an IBM z/OS EBCDIC
> environment as ['A' .. 'Z'] range contains more than just the 26 alphabet
> codes and the value of the codes are not the same as the ones in Unicode
> character set.
>
> I'm expecting something like in the third expression where 'A' is written
> explicitly as 0x0041 (Unicode for 'A').
>
> Please confirm.
>
> -Lego
>



-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091015/455f4ea2/attachment.html 

From antlr_bill at yeah.net  Thu Oct 15 09:20:02 2009
From: antlr_bill at yeah.net (antlr_bill)
Date: Fri, 16 Oct 2009 00:20:02 +0800 (CST)
Subject: [antlr-interest] how to write this rule's tree gramer
Message-ID: <769610366.255561255623602108.JavaMail.coremail@app3.yeah.net>

Hi ,
I not sure whether I wrote the tree grammer are right , so please take look and give some comments please, that will help a lot.

here is a grammer to parse the java source .
fileDeclaration 
    :   ( (annotations)? packageDeclaration )? (importDeclaration)* (typeDeclaration)* 
    ;
so i defined an imaginary token named FILEDEC and rewrite the tree grammer as 
->^( FILEDEC ( (annotations)? packageDeclaration )? (importDeclaration)* (typeDeclaration)* )
because all in the grammer are rules too. so I used an imaginary token here.

but this one below, there is a ',' can be the root of the subtree
expressionList 
    :   expression (',' expression)*
    ;
so I rewrote the tree as this ,EXP is an imaginary token also
->^(EXP expression (','^ expression)* )

right ? or any better way ? I am really need you help 

Thanks a lot
waitting online :)

BILL YUAN


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/f5ab16ae/attachment.html 

From kaleb.pederson at gmail.com  Thu Oct 15 10:48:35 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Thu, 15 Oct 2009 10:48:35 -0700
Subject: [antlr-interest] Customizing the GUnit test rig
Message-ID: <f14c01620910151048t42e2081br93c7f9cae063c4f6@mail.gmail.com>

Is it possible to customize the test rig used by GUnit?

I have a tree walker that does semantic analysis while walking the AST
created by my parser, but I'd like to be able to turn off everything
but the tree walking.  GUnit currently compiles and runs everything
exactly as is, including the semantic analysis.  I am using a Facade,
so I can replace the semantic analysis engine with a Fake/Stub/Mock if
I can somehow define my own test rig.  Any suggestions on how this may
be accomplished?

I am constrained a bit by the maven-gunit-plugin which doesn't yet
support generating JUnit tests.

Thanks.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From david-sarah at jacaranda.org  Thu Oct 15 12:30:05 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 15 Oct 2009 20:30:05 +0100
Subject: [antlr-interest] ANTLR C: Question regarding the portability
 of	generated lexer C code
In-Reply-To: <45418a3a0910150756j62214253s565d084fd455477a@mail.gmail.com>
References: <45418a3a0910121521j4def4ev3f9caaaea5772b4c@mail.gmail.com>	<201275d04ee5c5439ec7c0e65d4e52cf@temporal-wave.com>
	<45418a3a0910150756j62214253s565d084fd455477a@mail.gmail.com>
Message-ID: <4AD7783D.1060005@jacaranda.org>

Lego Haryanto wrote:
> Jim, thanks for your response ...
> 
> I know that in the EBCDIC system we feed a Unicode stream into the lexer,
> thus I'm pretty sure when the generated lexer code I pasted before is
> executed, it is already operating on the 32-bit unicode stream.
> 
> The problem is more about the native C compilation in an EBCDIC system like
> IBM z/OS mainframe.
> 
> To see if a character from the Unicode stream is an 'A', we have to compare
> with a value 0x0041 ... If we match it with a native 'A' in the code, this
> will not be a match in an EBCDIC C compilation.

The z/OS C compiler is able to compile in a mode where string and character
literals are treated as ISO-8859-1.
<http://lists.gnupg.org/pipermail/gcrypt-devel/2009-July/001469.html>

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From andersen at ontologyworks.com  Thu Oct 15 12:52:23 2009
From: andersen at ontologyworks.com (Bill Andersen)
Date: Thu, 15 Oct 2009 15:52:23 -0400
Subject: [antlr-interest] String template return val propagation
Message-ID: <F5FD04DD-E24C-4A50-86D7-A17CAF201FBB@ontologyworks.com>

Hi all

I have the following grammar fragment (with template output) that  
parses an AST and translates it to a text representation.  The parsing  
works fine and I'm reading in the template group just fine.

The problem that seems to be happening below is that 'prefixed_name'  
is being correctly recognized and the template returned, but the  
'name' production is not passing that template back up to the 'name'  
non-terminal in the top rule for inclusion in the template rewrite.   
Is there some switch I'm forgetting to set or do I need to do  
something explicit with the second rule to make sure the template gets  
propagated.

Thanks in advance

text_block
	: ^(AS_TEXT name phrase+)
	  -> text(name={$name.st})
	;

name
	: prefixed_name
	;
	
prefixed_name
	: ^(AS_NAME AS_NAME_NS AS_NAME_LOCAL)
	  -> name(ns={$AS_NAME_NS.text},local={$AS_NAME_LOCAL.text})
	;


	.bill



From parrt at cs.usfca.edu  Thu Oct 15 14:03:30 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 15 Oct 2009 14:03:30 -0700
Subject: [antlr-interest] String template return val propagation
In-Reply-To: <F5FD04DD-E24C-4A50-86D7-A17CAF201FBB@ontologyworks.com>
References: <F5FD04DD-E24C-4A50-86D7-A17CAF201FBB@ontologyworks.com>
Message-ID: <4AE3E00B-39A1-4BCF-96DB-52CB532E355F@cs.usfca.edu>

On Oct 15, 2009, at 12:52 PM, Bill Andersen wrote:

Hi Bill

> text_block
> 	: ^(AS_TEXT name phrase+)
> 	  -> text(name={$name.st})
> 	;
>
> name
> 	: prefixed_name

-> {$prefixed_name.st}

must manually pass thru rules like this.
Ter

From legoharyanto at gmail.com  Thu Oct 15 14:28:41 2009
From: legoharyanto at gmail.com (Lego Haryanto)
Date: Thu, 15 Oct 2009 14:28:41 -0700
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <4AD7783D.1060005@jacaranda.org>
References: <45418a3a0910121521j4def4ev3f9caaaea5772b4c@mail.gmail.com>
	<201275d04ee5c5439ec7c0e65d4e52cf@temporal-wave.com>
	<45418a3a0910150756j62214253s565d084fd455477a@mail.gmail.com>
	<4AD7783D.1060005@jacaranda.org>
Message-ID: <45418a3a0910151428o189ed32bx1e18046bc607e1c0@mail.gmail.com>

Thanks for the response, ...

Unfortunately, it won't work in our situation without major changes.  We
already have legacy C code which is compiled with default/native, and while
we can use a different compile option for the ANTLR generated code, I'm not
sure if it's good moving forward with mixed compilation rules.

The argument remains that it means the generated C lexer code has to be
compiled by an ASCII-based compiler which may not be that portable.

Best,
-Lego

On Thu, Oct 15, 2009 at 12:30 PM, David-Sarah Hopwood <
david-sarah at jacaranda.org> wrote:

> Lego Haryanto wrote:
> > Jim, thanks for your response ...
> >
> > I know that in the EBCDIC system we feed a Unicode stream into the lexer,
> > thus I'm pretty sure when the generated lexer code I pasted before is
> > executed, it is already operating on the 32-bit unicode stream.
> >
> > The problem is more about the native C compilation in an EBCDIC system
> like
> > IBM z/OS mainframe.
> >
> > To see if a character from the Unicode stream is an 'A', we have to
> compare
> > with a value 0x0041 ... If we match it with a native 'A' in the code,
> this
> > will not be a match in an EBCDIC C compilation.
>
> The z/OS C compiler is able to compile in a mode where string and character
> literals are treated as ISO-8859-1.
> <http://lists.gnupg.org/pipermail/gcrypt-devel/2009-July/001469.html>
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091015/611d94e5/attachment.html 

From mikesamuel at gmail.com  Thu Oct 15 19:58:26 2009
From: mikesamuel at gmail.com (Mike Samuel)
Date: Thu, 15 Oct 2009 19:58:26 -0700
Subject: [antlr-interest] Example code-generation target that outputs a
	state machine
Message-ID: <178b8d440910151958n2cc3a1c1xe6280e58b5d24581@mail.gmail.com>

I'd like to derive a state machine that recognizes a combined lexical
grammar of JS/HTML/CSS (hacked so that JS has a regular lexical
grammar) and a mapping from states to the production they're part of.
I need to keep the number of states small.

I saw something tantalizing about "dfaState() String Template" at
http://www.antlr.org/wiki/display/ANTLR3/How+to+build+an+ANTLR+code+generation+target
but am still unsure how to proceed.

Is this possible with ANTLR, and if so, does anyone know of existing
code I could adapt?

For background, my end goal is to bolt string interpolation onto
javascript, but in a way that doesn't introduce XSS problems as
described at
http://google-caja.googlecode.com/svn/changes/mikesamuel/string-interpolation-29-Jan-2008/trunk/src/js/com/google/caja/interp/index.html
And I'd like to explore using this as a way to address a lot of
injection problems in PHP by subtly changing the semantics of its
string interpolation.

cheers,
mike

From antlr_bill at yeah.net  Fri Oct 16 00:00:38 2009
From: antlr_bill at yeah.net (antlr_bill)
Date: Fri, 16 Oct 2009 15:00:38 +0800 (CST)
Subject: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS
Message-ID: <755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>

I DONT HAVE ANY WORDS ANYMORE,
YEAH I REALLY WANNA GET SOME HELP FROM HERE 
BUT SEEMS IT'S IMPOSSIBLE
SURE ANTLR IS A GREAT PROJECT ,
BUT ...
ANYWAY ,SORRY THAT I DONT KNOW HOW TO UNSUBSCRIBE FROM THIS MAILIST

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/f99d4bdf/attachment.html 

From david-sarah at jacaranda.org  Fri Oct 16 00:50:37 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 16 Oct 2009 08:50:37 +0100
Subject: [antlr-interest] Example code-generation target that outputs a
 state machine
In-Reply-To: <178b8d440910151958n2cc3a1c1xe6280e58b5d24581@mail.gmail.com>
References: <178b8d440910151958n2cc3a1c1xe6280e58b5d24581@mail.gmail.com>
Message-ID: <4AD825CD.5040100@jacaranda.org>

Mike Samuel wrote:
> I'd like to derive a state machine that recognizes a combined lexical
> grammar of JS/HTML/CSS (hacked so that JS has a regular lexical
> grammar) and a mapping from states to the production they're part of.
> I need to keep the number of states small.
> 
> I saw something tantalizing about "dfaState() String Template" at
> http://www.antlr.org/wiki/display/ANTLR3/How+to+build+an+ANTLR+code+generation+target
> but am still unsure how to proceed.
> 
> Is this possible with ANTLR, and if so, does anyone know of existing
> code I could adapt?
> 
> For background, my end goal is to bolt string interpolation onto
> javascript, but in a way that doesn't introduce XSS problems as
> described at
> http://google-caja.googlecode.com/svn/changes/mikesamuel/string-interpolation-29-Jan-2008/trunk/src/js/com/google/caja/interp/index.html

Sounds like a fun project.

ANTLR normally only generates explicit DFAs when there is a nontrivial
decision between alternatives of a rule. In the case of the ECMAScript 5
lexical grammar I'm using, it only generates two DFAs, one for the main
tokens rule, and one for DecimalLiteral.

You can get ANTLRWorks to show a state machine diagram for any particular
decision, or for the tokens rule, but they're not particularly
enlightening. In principle, ANTLR computes all the information needed to
produce a pure FSM lexer, but I don't think it provides any way to actually
generate one, at least not without a lot of work. If that's definitely
what you need, ANTLR is probably not the right tool.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From dahvid.minor at gmail.com  Fri Oct 16 01:16:23 2009
From: dahvid.minor at gmail.com (David Minor)
Date: Fri, 16 Oct 2009 10:16:23 +0200
Subject: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS
In-Reply-To: <755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>
References: <755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>
Message-ID: <a2a61e1e0910160116j69de19d2ob9260c1c3b97a0fc@mail.gmail.com>

I wouldn't shout about it, but I also have received scant (or no help) on
this forum. I'm not a parasite, I purchased the book, but... well... I'm
using Gold now and so far so good. I check back every now and then to see if
I got and answer. The unsubscribe link is at the bottom of this message.


2009/10/16 antlr_bill <antlr_bill at yeah.net>

> I DONT HAVE ANY WORDS ANYMORE,
> YEAH I REALLY WANNA GET SOME HELP FROM HERE
> BUT SEEMS IT'S IMPOSSIBLE
> SURE ANTLR IS A GREAT PROJECT ,
> BUT ...
> ANYWAY ,SORRY THAT I DONT KNOW HOW TO UNSUBSCRIBE FROM THIS MAILIST
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/efd40af8/attachment.html 

From gwlist at grahamwideman.com  Fri Oct 16 02:31:34 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Fri, 16 Oct 2009 02:31:34 -0700
Subject: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS
In-Reply-To: <a2a61e1e0910160116j69de19d2ob9260c1c3b97a0fc@mail.gmail.co
 m>
References: <755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>
	<755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>
Message-ID: <4.1.20091016014553.06b071b0@grahamwideman.com>

David:

> I also have received scant (or no help) on this forum

I see that you started two threads.  In one, Jim Idle gave you a thoughtful
response, and suggested some questions to pursue.  You did post some more, and
nobody answered so far as I can see. That could be because the subject line on
your post got wrapped after the first word, so that it appears as just "saving"
-- not a title that would attract much attention.

Your second thread was last week "stuck on tree parsing", in which you posted
two grammars as attachments of 300 and 500 lines each, and then asked:
"PearGrammerTree.g complains about an undefined rule, that is defined right
above it" ...  without mentioning what rule you are talking about.

So here you miss out on the possibility that someone could just glance at the
problem area, in the body of the email, and spot a problem. Instead, you're
obliging someone to have to fetch the attachments and run ANTLR or AW on them
(you don't mention which, what version etc) just to see where there might be a
problem, with no guarantee it's even the same problem you're seeing.

In short, doubtless inadvertantly, you happened to present your messages in a
manner most likely not to be quickly answerable by knowledgeable list members.

If you had simply mentioned which rule had the problem, and inserted the
relevant part of the file in your email (so that looking at the attachment was
optional) then it is possible that someone could just eyeball it and spot an
obvious problem. 

I should also say that one customary line of troubleshooting advice is to
whittle down the troublesome sample so that it's much smaller. Often that
causes the problem to become more conspicuous, and even if not makes for a much
better example to ask for help about.

For what it's worth, I did just run ANTLR on your files, and on
PearGramerTree.g it gave not just one error, but the following:

=============================
F:\Proj\ANTLR\Test\Minor>java -jar D:\Antlr20090923\antlr-3.2.jar
PearGrammerTree.g
error(100): PearGrammerTree.g:117:6: syntax error: antlr:
PearGrammerTree.g:117:6: unexpected token: roi_identifier
error(100): PearGrammerTree.g:123:1: syntax error: antlr:
PearGrammerTree.g:123:1: unexpected token: data_scope_expr
error(100): PearGrammerTree.g:124:6: syntax error: antlr:
PearGrammerTree.g:124:6: unexpected token: IDENTIFIER
error(100): PearGrammerTree.g:127:1: syntax error: antlr:
PearGrammerTree.g:127:1: unexpected token: parameter
error(100): PearGrammerTree.g:129:20: syntax error: antlr:
PearGrammerTree.g:129:20: expecting RPAREN, found '|'
error(100): PearGrammerTree.g:138:2: syntax error: antlr:
PearGrammerTree.g:138:2: expecting RPAREN, found ';'
error(100): PearGrammerTree.g:141:1: syntax error: antlr:
PearGrammerTree.g:141:1: unexpected token: param_list
error(100): PearGrammerTree.g:142:6: syntax error: antlr:
PearGrammerTree.g:142:6: unexpected token: parameter
error(100): PearGrammerTree.g:145:1: syntax error: antlr:
PearGrammerTree.g:145:1: unexpected token: input_param_list
error(100): PearGrammerTree.g:147:2: syntax error: antlr:
PearGrammerTree.g:147:2: expecting RPAREN, found ';'
error(100): PearGrammerTree.g:149:1: syntax error: antlr:
PearGrammerTree.g:149:1: unexpected token: output_param_list
error(100): PearGrammerTree.g:307:4: syntax error: antlr:
PearGrammerTree.g:307:4: unexpected token: binding_expr
error(100): PearGrammerTree.g:315:1: syntax error: antlr:
PearGrammerTree.g:315:1: unexpected token: expression
error(100): PearGrammerTree.g:317:2: syntax error: antlr:
PearGrammerTree.g:317:2: expecting RPAREN, found ';'
error(100): PearGrammerTree.g:319:1: syntax error: antlr:
PearGrammerTree.g:319:1: unexpected token: program
error(106): PearGrammerTree.g:109:17: reference to undefined rule: param_list
error(106): PearGrammerTree.g:150:17: reference to undefined rule: param_list
error(106): PearGrammerTree.g:155:6: reference to undefined rule:
output_param_list
error(106): PearGrammerTree.g:154:22: reference to undefined rule:
output_param_list
error(106): PearGrammerTree.g:177:14: reference to undefined rule:
data_scope_expr
error(106): PearGrammerTree.g:173:11: reference to undefined rule:
data_scope_expr
error(106): PearGrammerTree.g:154:5: reference to undefined rule:
input_param_list
error(106): PearGrammerTree.g:320:4: reference to undefined rule: expression
error(106): PearGrammerTree.g:285:11: reference to undefined rule:
data_scope_expr
error(106): PearGrammerTree.g:156:5: reference to undefined rule:
input_param_list
===============================

Many of these report undefined rules not because that particular rule has a
problem per se, but because some rule it depends on has a problem. It's
probably worth looking at the "unexpected token" errors with a view to
determining if the syntax you've used is legit.

-- Graham

At 10/16/2009 10:16 AM, David Minor wrote: 
>
> I wouldn't shout about it, but I also have received scant (or no help) on
> this forum. I'm not a parasite, I purchased the book, but... well... I'm
> using Gold now and so far so good. I check back every now and then to see if
> I got and answer. The unsubscribe link is at the bottom of this message.



From newsreply at areeda.com  Fri Oct 16 02:44:52 2009
From: newsreply at areeda.com (Joseph Areeda)
Date: Fri, 16 Oct 2009 02:44:52 -0700
Subject: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS
In-Reply-To: <a2a61e1e0910160116j69de19d2ob9260c1c3b97a0fc@mail.gmail.com>
References: <755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>
	<a2a61e1e0910160116j69de19d2ob9260c1c3b97a0fc@mail.gmail.com>
Message-ID: <4AD84094.1080001@areeda.com>

I wouldn't want to get in the way of a good pity party but my experience 
has been the opposite.

I'm new to antlr, purchased the book, downloaded free software and got 
my project working in record time (for me).

I had help along the way and have watched others get helpful responses 
to their questions.

I wonder what are your expectations from a user mailing list?  It's 
really not customer support of a commercial product or free consulting 
services on your project.  It's a community of people with a common 
interest. 

May I suggest simple well formed questions that people can answer 
quickly from experience rather than ones that take a lot of work to 
understand. If the question is something like here's a 3 line grammar 
that doesn't work with this input, I've seen very good answers come 
quickly.  I've also seen questions like (OK this is hyperbole) I'm 
trying to translate Japanese into Sanskrit, attached is my grammar file 
it's only 80MB,  for some reason the past perfect tense is getting into 
an infinite loop, please help.

Joe

David Minor wrote:
> I wouldn't shout about it, but I also have received scant (or no help) 
> on this forum. I'm not a parasite, I purchased the book, but... 
> well... I'm using Gold now and so far so good. I check back every now 
> and then to see if I got and answer. The unsubscribe link is at the 
> bottom of this message.
>
>
> 2009/10/16 antlr_bill <antlr_bill at yeah.net <mailto:antlr_bill at yeah.net>>
>
>     I DONT HAVE ANY WORDS ANYMORE,
>     YEAH I REALLY WANNA GET SOME HELP FROM HERE
>     BUT SEEMS IT'S IMPOSSIBLE
>     SURE ANTLR IS A GREAT PROJECT ,
>     BUT ...
>     ANYWAY ,SORRY THAT I DONT KNOW HOW TO UNSUBSCRIBE FROM THIS MAILIST
>
>
>
>     List: http://www.antlr.org/mailman/listinfo/antlr-interest
>     Unsubscribe:
>     http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/ca26d474/attachment.html 

From phungngochieu at gmail.com  Fri Oct 16 03:33:23 2009
From: phungngochieu at gmail.com (Hieu Phung)
Date: Fri, 16 Oct 2009 18:33:23 +0800
Subject: [antlr-interest] [Antlr + ST] Huge output string - OutOfMemoryError
Message-ID: <2d17b250910160333r724d552naf49a1966efc0fcc@mail.gmail.com>

Hi all,

I am writing a program using Antlr and StringTemplate to translate an input
file to an XML file. Input is small but output is huge: 720KB input file
will generate about 100MB output file. When my input reached 7608KB, I got
OOM error

time taken in second: 18 - file size in KB: 4804
time taken in second: 20 - file size in KB: 5205
time taken in second: 20 - file size in KB: 5605
time taken in second: 21 - file size in KB: 6006
time taken in second: 23 - file size in KB: 6406
time taken in second: 25 - file size in KB: 6806
time taken in second: 31 - file size in KB: 7207

at size 7608KB:
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
        at java.util.Arrays.copyOf(Arrays.java:2882)
        at
java.lang.AbstractStringBuilder.expandCapacity(AbstractStringBuilder.java:100)
        at
java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:572)
        at java.lang.StringBuffer.append(StringBuffer.java:320)
        at java.io.StringWriter.write(StringWriter.java:60)
        at
org.antlr.stringtemplate.AutoIndentWriter.write(AutoIndentWriter.java:172)
        at
org.antlr.stringtemplate.language.ASTExpr.writePOJO(ASTExpr.java:702)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:683)
        at
org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
        at
org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
        at
org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
        at
org.antlr.stringtemplate.language.ASTExpr.writeTemplate(ASTExpr.java:750)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:680)
        at
org.antlr.stringtemplate.language.ASTExpr.writeIterableValue(ASTExpr.java:792)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:682)
        at
org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
        at
org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
        at
org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
        at
org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1670)
        at
org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1661)
        at FFMParser.file(FFMParser.java:127)
        at CSVTest.main(CSVTest.java:33)

Is there any suggestion so that program can generate 1GB file?

1)       Having multiple templates, each template generates small string,
then write the small strings to file.
My input has format: ((Part1) (Part2)+ (Part3)). For each part2, there is an
xml element in the output. I can have 3 templates here. In Antlr action, I
will write each part to file when parsing is done for the part.

2)       Any template engine that could write to file directly, instead of
returning a string...? (This might not be proper to discussed here :D)

I hope problem is stated clearly. Please let me know if you need more
information. Any suggestion is much appreciated. Thank you.

Regards,

Helen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/10495bd3/attachment.html 

From naveen.chwl at googlemail.com  Fri Oct 16 03:51:02 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Fri, 16 Oct 2009 11:51:02 +0100
Subject: [antlr-interest] How do I output an alert box or something in the
	console in ANTLRWorks, in grammar actions?
Message-ID: <56eb2660910160351r3d2b1862u2b3e5699d506180d@mail.gmail.com>

System.out.println("a string") doesn't seem to output anything, and
Window.alert("a string") doesn't work.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/9a84c995/attachment.html 

From naveen.chwl at googlemail.com  Fri Oct 16 04:39:30 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Fri, 16 Oct 2009 12:39:30 +0100
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <56eb2660910150413t558fda56q4d78888086f5cf09@mail.gmail.com>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
	<56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>
	<3544215969333489941@unknownmsgid>
	<56eb2660910141108p3fd3d377gb737887a421142be@mail.gmail.com>
	<191938162188708907@unknownmsgid>
	<56eb2660910150413t558fda56q4d78888086f5cf09@mail.gmail.com>
Message-ID: <56eb2660910160439x7b449bdave27da7750a3372c2@mail.gmail.com>

So, does anybody have a way of doing "Take *a* IF not followed by *b* (both
syntactic constructs)" ?

i.e.
q: (a !b)=> a;                        //("!" or "not" doesn't exist in
ANTLR)

I have unsuccessfully tried the following:

q: (a b?)=> {mark = input.mark();} a {bFoundYet=false; i=input.index();} b?
{if(input.index()>i){bFoundYet=true;input.rewind(mark);} }
{bFoundYet==false}?=> ;       //"mark" and "bFound" are my own variables,
already declared

Obviously something is wrong here and there may be a much, much simpler way.
Or I'm nearly right.

2009/10/15 Naveen Chawla <naveen.chwl at googlemail.com>

> Yes, if you put "sentence: q b;" above q then it accepts "asdqwe", even
> though the *a* in q is followed by *b*. And in fact, on my side, accepts *a*
> regardless of what it's followed by. So the predicate seems to have no
> effect, on my side.
>
> I haven't yet been able to reproduce the problem itself in simpler form,
> and I agree about trying to find other ways, although unable so far. A
> working workaround of "not followed by" would fix the whole problem though.
>
> Jim posted in 2007 a PEG-style "followed by" solution using "foo: a
> {input.mark();} b {input.rewind();}".. which "takes *a* and *b* and then
> rewinds as if it it has just taken *a* "  so I was wondering if there was a
> solution for "not followed by" using mark(), rewind() and maybe reset()
> which "takes *a* and *b* and then (something or another?)..." ?
>   2009/10/14 Indhu Bharathi <indhu.b at s7software.com>
>
>>  Here is the complete grammar:
>>
>>
>>
>> grammar Test;
>>
>>
>>
>> q             :               a ((b)=>NOWAY | /*nothing*/);
>>
>>
>>
>> a              :               'asd';
>>
>> b             :               'qwe';
>>
>>
>>
>> fragment NOWAY:          ;
>>
>>
>>
>>
>>
>> ?q? will accept ?asd? but not ?asdqwe?. Am I missing something?
>>
>>
>>
>>
>>
>> BTW, if you can post a simplified example of your exact problem, you might
>> get more elegant solutions. This is only a hack for the specific problem you
>> posted. Maybe your original problem can be solved in a more elegant way.
>> Cases that require hacks of this kind are very rare and arises only while
>> parsing some very obscure languages.
>>
>>
>>
>> Cheers, Indhu
>>
>>
>>
>>
>>
>> *From:* Naveen Chawla [mailto:naveen.chwl at googlemail.com]
>> *Sent:* Wednesday, October 14, 2009 11:38 PM
>> *To:* Indhu Bharathi
>> *Cc:* Jim Idle; antlr-interest at antlr.org
>>
>> *Subject:* Re: [antlr-interest] How to do "not" in a syntactic predicate?
>>
>>
>>
>> Yikes, that doesn't seem to work, it seems to give a normal positive
>> predicate for me. (Or something). But not "if a not followed by b" => a.
>>
>>
>>
>> ?
>>
>> 2009/10/14 Indhu Bharathi <indhu.b at s7software.com>
>>
>> The other say I replied from my ipod and was not able to test it with
>> ANTLR. I checked it now and the code doesn?t work for me too. However you
>> can try a variant:
>>
>>
>>
>> q             :               a ((b)=>NOWAY | /*nothing*/)
>>
>>                 ;
>>
>>
>>
>> fragment NOWAY
>>
>>                 :               ;
>>
>>
>>
>> This is tested J But note that this is only a hack and use it only when
>> there is no other alternative.
>>
>>
>>
>> Going by your ?one of my "smaller" rules is "consuming" something that
>> should belong to a "larger" rule? description, it looks like you can
>> solve that problem by turning off greedy. Grep for ?greedy? in the book or
>> wiki.
>>
>>
>>
>> Cheers, Indhu
>>
>>
>>
>>
>>
>> *From:* antlr-interest-bounces at antlr.org [mailto:
>> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
>> *Sent:* Wednesday, October 14, 2009 3:50 PM
>> *To:* Jim Idle
>> *Cc:* antlr-interest at antlr.org
>> *Subject:* Re: [antlr-interest] How to do "not" in a syntactic predicate?
>>
>>
>>
>> Jim, being new to predicates I realised soon after this that you were
>> talking about token lookaheads. And yes I do need a syntactic lookahead (but
>> thas is negative). In beginner-speak, one of my "smaller" rules is
>> "consuming" something that should belong to a "larger" rule. This would be
>> correct if that particular something (e.g. "a") was *not* followed by a
>> syntactic construct conforming to "b". Hence (a !b)=>a (for the smaller
>> rule) seems the simplest solution to this to me. Is Indhu's version correct
>> for doing this trick? It doesn't seem to work for me (but I might be doing
>> something else wrong). If not correct, what is the correct way? My target is
>> Java.
>>
>> 2009/10/5 Jim Idle <jimi at temporal-wave.com>
>>
>> Use a semantic predicate rather than syntactic. You possibly need a bated
>> predicate here too:
>>
>>
>>
>> { input.LA(1) == A && input.LA(2) != B}?=>
>>
>>
>>
>> However, if you need that kind of syntactic predicate, then I suggest you
>> may be approaching your problem incorrectly.
>>
>>
>>
>> Jim
>>
>>
>>
>> *From:* antlr-interest-bounces at antlr.org [mailto:
>> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
>> *Sent:* Monday, October 05, 2009 7:02 AM
>>
>>
>> *To:* antlr-interest at antlr.org
>> *Subject:* [antlr-interest] How to do "not" in a syntactic predicate?
>>
>>
>>
>> If I do
>>
>>
>>
>> (a ~b)=> a
>>
>>
>>
>> meaning "take this alternative if you encounter an a when not followed by
>> b"
>>
>>
>>
>> I get a syntax error: unexpected token b
>>
>> Is it the right syntax to use '~'?
>>
>>
>>
>> N
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>>
>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/beb3141c/attachment.html 

From indhu.b at s7software.com  Fri Oct 16 04:56:45 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 16 Oct 2009 17:26:45 +0530
Subject: [antlr-interest] How do I output an alert box or something in
	the	console in ANTLRWorks, in grammar actions?
In-Reply-To: <56eb2660910160351r3d2b1862u2b3e5699d506180d@mail.gmail.com>
References: <56eb2660910160351r3d2b1862u2b3e5699d506180d@mail.gmail.com>
Message-ID: <00a801ca4e57$bc7c3b60$3574b220$@b@s7software.com>

Sustem.out.println will print in the output tab.

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Friday, October 16, 2009 4:21 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How do I output an alert box or something in the
console in ANTLRWorks, in grammar actions?

 

System.out.println("a string") doesn't seem to output anything, and
Window.alert("a string") doesn't work. 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/02d381a1/attachment.html 

From naveen.chwl at googlemail.com  Fri Oct 16 08:13:44 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Fri, 16 Oct 2009 16:13:44 +0100
Subject: [antlr-interest] How do I output an alert box or something in
	the console in ANTLRWorks, in grammar actions?
In-Reply-To: <2836697654555485100@unknownmsgid>
References: <56eb2660910160351r3d2b1862u2b3e5699d506180d@mail.gmail.com>
	<2836697654555485100@unknownmsgid>
Message-ID: <56eb2660910160813q5566dbbexc93a18e2a6c0a346@mail.gmail.com>

Thanks Indhu! This might help me a lot now.

2009/10/16 Indhu Bharathi <indhu.b at s7software.com>

>  Sustem.out.println will print in the output tab.
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Friday, October 16, 2009 4:21 PM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] How do I output an alert box or something in
> the console in ANTLRWorks, in grammar actions?
>
>
>
> System.out.println("a string") doesn't seem to output anything, and
> Window.alert("a string") doesn't work.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091016/bdda5c8f/attachment.html 

From news at heliks.nl  Fri Oct 16 09:11:04 2009
From: news at heliks.nl (Robert van der Hulst)
Date: Fri, 16 Oct 2009 18:11:04 +0200
Subject: [antlr-interest] Which version do I need for a CSharp target and VS
	2008
Message-ID: <364129671.20091016181104@heliks.nl>

I am using Antlr 2.7.6 (CPP target) at this moment for our Language project.

I  need  to  do make some serious changes, so I am considering to move
the project to Antlr 3 and a CSharp

Which version do people recommend that I should use.

I looked at the Antlr website and found two options:

- CSharp
- CSharp3

but  I  am  not  sure  if they are both available for the latest Antlr build.

Which one do you recommend ?

I   would   also  like  to have a binary that does not need Java (like
there is for Antlr 2). Does that exist ?

Finally:  Who has experience using Antlr in a VS 2008 environment (and
setting up the necessary MsBuild steps to automate the build process)?

-- 
Robert van der Hulst


From bob at wentworth.bz  Fri Oct 16 10:39:36 2009
From: bob at wentworth.bz (Robert Wentworth)
Date: Fri, 16 Oct 2009 13:39:36 -0400
Subject: [antlr-interest] Semantic predicates
Message-ID: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>

There appears to be something fundamental that I am not "getting"  
about the way semantic predicates work. In the grammar below, the  
input "cat" is recognized using the rule "cat" but in not recognized  
by either the rule "expr" or the rule "pexpr". Could someone explain  
to me why this is so and what the fix is?

Thanks,
Bob Wentworth

//======================================================


grammar ATest;

options {
	backtrack = true;
	memoize = true;
	output = template;
}

@parser::header { package dummy; }
@lexer::header { package dummy; }


WS  :   ( ' '
         | '\t'
         | '\r'
         | '\n'
         ) {$channel=HIDDEN;}
     ;

WHEN 	:	'when' ;

WORD	: ('a'..'z')+ ;

expr	:	cat
		| cat WHEN dog
		| dog
		;
		
pexpr	:	{input.LT(1).getText().equals("cat")}?=> cat
		| {input.LT(1).getText().equals("cat")}?=> cat WHEN dog
		| {input.LT(1).getText().equals("dog")}?=> dog
		;

cat	: {input.LT(1).getText().equals("cat")}?=> WORD ;

dog	: {input.LT(1).getText().equals("dog")}?=> WORD ;


From kaleb.pederson at gmail.com  Fri Oct 16 12:21:33 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Fri, 16 Oct 2009 12:21:33 -0700
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute access
	on rule scope
Message-ID: <f14c01620910161221j7c5939dalf29aa867e6890538@mail.gmail.com>

I'm getting an error that doesn't make any sense, either because I've
missed something fundamental or I've stumbled across a bug. I'm doing
some type checking within a tree parser.  I have a plusMinusExpression
which can either be a negation or a subtraction expression.  In order
to to check to see which it is, I have `if ($rhs != null)` within my
action.  That line, however, causes the following error:

SemanticChecker.g:163:3: missing attribute access on rule scope: rhs

The grammar fragment follows:

plusMinusExpression returns [Type type]
	:	^(PLUS lhs=baseExpression rhs=baseExpression) { /*...*/ }
		|	^(MINUS lhs=baseExpression rhs=baseExpression?)
		{
			typeChecker.assertIsNumericType($lhs.type);
			if ($rhs != null)
			{
				typeChecker.assertIsNumericType($rhs.type);
				typeChecker.assertEqualTypes($lhs.type, $rhs.type);
			}
			$type = $lhs.type;
		}
	;
Am I missing something fundamental or should this work? I tried
changing rhs to something unique throughout the application, but the
error persists.  I see the exact same behavior on both ANTLR-3.1 and
3.2.

Thanks.

--
Kaleb Pederson
Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From kaleb.pederson at gmail.com  Fri Oct 16 12:35:51 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Fri, 16 Oct 2009 12:35:51 -0700
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>
References: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>
Message-ID: <f14c01620910161235o6c1c69acw4130873266732493@mail.gmail.com>

On Fri, Oct 16, 2009 at 10:39 AM, Robert Wentworth <bob at wentworth.bz> wrote:
> There appears to be something fundamental that I am not "getting"
> about the way semantic predicates work. In the grammar below, the
> input "cat" is recognized using the rule "cat" but in not recognized
> by either the rule "expr" or the rule "pexpr". Could someone explain
> to me why this is so and what the fix is?

[... snip ...]
> cat     : {input.LT(1).getText().equals("cat")}?=> WORD ;
>
> dog     : {input.LT(1).getText().equals("dog")}?=> WORD ;

You're using a gated semantic predicate.  A gated semantic predicate
is used to distinguish between multiple alternatives, but as you have
only one alternative, this isn't what you want. See
https://wincent.com/wiki/ANTLR_predicates for more information on
predicates.

> expr ? ?: ? ? ? cat
> ? ? ? ? ? ? ? ?| cat WHEN dog
> ? ? ? ? ? ? ? ?| dog

You could do:

expr: cat (WHEN dog)? | dog;

You should also be able to use a syntactic predicate:

expr: (cat WHEN)=> cat WHEN dog
    | cat
    | dog;

HTH,

--
Kaleb Pederson
Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From kaleb.pederson at gmail.com  Fri Oct 16 12:44:35 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Fri, 16 Oct 2009 12:44:35 -0700
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <56eb2660910160439x7b449bdave27da7750a3372c2@mail.gmail.com>
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
	<56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>
	<3544215969333489941@unknownmsgid>
	<56eb2660910141108p3fd3d377gb737887a421142be@mail.gmail.com>
	<191938162188708907@unknownmsgid>
	<56eb2660910150413t558fda56q4d78888086f5cf09@mail.gmail.com>
	<56eb2660910160439x7b449bdave27da7750a3372c2@mail.gmail.com>
Message-ID: <f14c01620910161244t4c421732pfc7b2891e75ffc12@mail.gmail.com>

On Fri, Oct 16, 2009 at 4:39 AM, Naveen Chawla
<naveen.chwl at googlemail.com> wrote:
> So, does anybody have a way of doing "Take *a* IF not followed by *b* (both
> syntactic constructs)" ?
>
> i.e.
> q: (a !b)=> a;??????????????????????? //("!" or "not"?doesn't exist in
> ANTLR)

I think that would be a nice syntax for ANTLR to support.

I would guess that you could generally accomplish the same thing by
placing the "opposite" syntactic predicate on your other
alternative(s) in your production.  In other words:

(a b)=> alternative_1
| alternative_2 ...

Rather than:

(a !b)=> alternative_2
| alternative_1

--
Kaleb Pederson
Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From andersen at ontologyworks.com  Fri Oct 16 13:10:08 2009
From: andersen at ontologyworks.com (Bill Andersen)
Date: Fri, 16 Oct 2009 16:10:08 -0400
Subject: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS
In-Reply-To: <4AD84094.1080001@areeda.com>
References: <755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>
	<a2a61e1e0910160116j69de19d2ob9260c1c3b97a0fc@mail.gmail.com>
	<4AD84094.1080001@areeda.com>
Message-ID: <6CD7B472-B72B-4490-9D57-28931B49A823@ontologyworks.com>

To those complaining about the ANTLR list...

I've heard this complaint before and have even felt the same way from  
time to time.  But I'm still here.

No matter what anyone says and even if you have the book, if you don't  
live and breathe language design, starting out with ANTLR isn't really  
that easy.  So you have to stumble around a bit and after a while,  
you'll get better with the lingo and better at asking tighter, more  
targeted questions that are worthy of the time of the busy folks on  
this list to answer.  They *will* help you, but only if you help them  
help you.

But if you ask a big, amorphous, poorly worded question (as I have on  
a number of occasions) don't expect a lot of help.  I'm certain that  
it's not personal.

Just hang in there, take your lumps and, after a while you'll learn  
and find you'll get a lot more help.  In the end it's way worth it.   
ANTLR is great stuff.

	.bill

Bill Andersen
Ontology Works, Inc. (www.ontologyworks.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204





From bob at wentworth.bz  Fri Oct 16 13:39:27 2009
From: bob at wentworth.bz (Robert Wentworth)
Date: Fri, 16 Oct 2009 16:39:27 -0400
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <f14c01620910161235o6c1c69acw4130873266732493@mail.gmail.com>
References: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>
	<f14c01620910161235o6c1c69acw4130873266732493@mail.gmail.com>
Message-ID: <A4D3E574-860E-482B-BF44-13E2ECE8DFFF@wentworth.bz>

Kaleb,

Thanks for your response. Although I've read the web page you  
referenced and the ANTLR book chapter on semantic predicates, I remain  
with just as many questions as I started out with.

Note that the point of my example is to understand how semantic  
predicates can be used in this sort of context. I am not interested in  
a solution to the toy problem that doesn't use semantic predicates.  
There are obviously simpler ways of solving the toy problem, but the  
example is meant as a vehicle for understanding how to use semantic  
predicates to solve more complicated problems.

On Oct 16, 2009, at 3:35 PM, Kaleb Pederson wrote:

> On Fri, Oct 16, 2009 at 10:39 AM, Robert Wentworth  
> <bob at wentworth.bz> wrote:
>> There appears to be something fundamental that I am not "getting"
>> about the way semantic predicates work. In the grammar below, the
>> input "cat" is recognized using the rule "cat" but in not recognized
>> by either the rule "expr" or the rule "pexpr". Could someone explain
>> to me why this is so and what the fix is?
>
> [... snip ...]
>> cat     : {input.LT(1).getText().equals("cat")}?=> WORD ;
>>
>> dog     : {input.LT(1).getText().equals("dog")}?=> WORD ;
>
> You're using a gated semantic predicate.  A gated semantic predicate
> is used to distinguish between multiple alternatives, but as you have
> only one alternative, this isn't what you want.

My understanding was that gated predicates are hoisted into rules that  
indirectly reference them, at which point they should influence the  
decision in "expr".

> See
> https://wincent.com/wiki/ANTLR_predicates for more information on
> predicates.
>
>> expr    :       cat
>>                | cat WHEN dog
>>                | dog
>
> You could do:
>
> expr: cat (WHEN dog)? | dog;


In any event, this doesn't match "cat" either, retaining the old  
definition of the rule "cat" with the semantic predicate. (And taking  
out the semantic predicate would change the grammar.)

>
> You should also be able to use a syntactic predicate:
>
> expr: (cat WHEN)=> cat WHEN dog
>    | cat
>    | dog;

Isn't this done implicity, without the explicit syntactic predicate?

>
> HTH,
>
> --
> Kaleb Pederson
> Twitter - http://twitter.com/kalebpederson
> Blog - http://kalebpederson.com
>


From andreas.meyer at smartshift.de  Fri Oct 16 14:08:37 2009
From: andreas.meyer at smartshift.de (Andreas Meyer)
Date: Fri, 16 Oct 2009 23:08:37 +0200
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>
References: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>
Message-ID: <4AD8E0D5.4090907@smartshift.de>

Robert Wentworth schrieb:
> There appears to be something fundamental that I am not "getting"  
> about the way semantic predicates work. In the grammar below, the  
> input "cat" is recognized using the rule "cat" but in not recognized  
> by either the rule "expr" or the rule "pexpr". Could someone explain  
> to me why this is so and what the fix is?
>   

I think the generated code is wrong. Looking at the decision-code for 
expr, it seems that the only input expr can accept is plain "dog":

        try {
            if ( state.backtracking>0 && alreadyParsedRule(input, 1) ) { 
return retval; }
            // C:\\projects\\test\\ATest\\ATest.g:24:6: ( cat | cat WHEN 
dog | dog )
            int alt1=3;
            int LA1_0 = input.LA(1);

            if ( (LA1_0==WORD) && 
((input.LT(1).getText().equals("dog")))) { ... }
            else { throw ... }
 
and indeed, using ANTLRWorks, dog is accepted.

From david-sarah at jacaranda.org  Fri Oct 16 14:15:07 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 16 Oct 2009 22:15:07 +0100
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
 access	on rule scope
In-Reply-To: <f14c01620910161221j7c5939dalf29aa867e6890538@mail.gmail.com>
References: <f14c01620910161221j7c5939dalf29aa867e6890538@mail.gmail.com>
Message-ID: <4AD8E25B.1020501@jacaranda.org>

Kaleb Pederson wrote:
> I'm getting an error that doesn't make any sense, either because I've
> missed something fundamental or I've stumbled across a bug. I'm doing
> some type checking within a tree parser.  I have a plusMinusExpression
> which can either be a negation or a subtraction expression.  In order
> to to check to see which it is, I have `if ($rhs != null)` within my
> action.  That line, however, causes the following error:
> 
> SemanticChecker.g:163:3: missing attribute access on rule scope: rhs

You can use "if ($rhs.tree != null)".

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From boughtonp at gmail.com  Fri Oct 16 14:28:00 2009
From: boughtonp at gmail.com (Peter Boughton)
Date: Fri, 16 Oct 2009 22:28:00 +0100
Subject: [antlr-interest] "No Past Experience Required"
Message-ID: <5d97c170910161428w8022bd2sd9ea6117525e6320@mail.gmail.com>

Hi all,

I'm looking to figure out ANTLR and so I'm reading this page:
http://www.antlr.org/wiki/display/ANTLR3/Quick+Starter+on+Parser+Grammars+-+No+Past+Experience+Required

But there are a number of things I'm stuck on - and so I'm asking here
for both a good explanation and so that someone with edit permission
can hopefully update the wiki page to actually be "no past experience"
and more helpful for future newbies.


"Left recursion."
Maybe it's me being dim, but it took me a while to figure how "a : a B
| C ;" translated to "a : C B*;" - and whilst I get it now, perhaps a
quick sentence to explain the transition might be helpful for the wiki
page?


"syntactic predicates"
So, they're an advanced category discussed in a book... yippee! I
don't have the book, and the absolute earliest I could get it (if I
choose to) is Tuesday, so that's not particularly helpful. If they're
going to be mentioned, they should at least have a brief explanation
of when they apply, and preferably a link to an online resource that
covers them.
(I tried reading the Wikipedia article, but that waffles on without
being very helpful.)

Can anyone provide [a link to] a good, concise definition of syntactic
predicates and semantic predicates and any other terms like this - for
that matter, is there a good online glossary for all this sort of
compiler/parser related stuff?


"Difference between lexer and parser rules"
This whole paragraph leaves me going "wha?". I don't know what the
difference between a lexer and a parser is, so attempting to explain
the difference between their rules doesn't mean much yet.

There's a vague suggestion that lexers look at literals (whether
explicit or combined via multiple rules), and parsers look at
everything else, but even then I'm not sure I get the implications of
that?

What's a symbolic name?

In the example, what does the "EQUALS='=';" syntax do? Should that be
a colon, or is something else happening?
What about IMAGINERY_TOKEN - what's that doing?

I'm now confused about tokens and non-terminal symbols - they are
obviously different, but how?

In the example for "How to build a grammar from a language
specification", the FILE rule is not in the tokens section
Does that make it a non-terminal symbol?
Is this example grammar handled by a lexer or a parser or both?


I do have some other questions, but they're not directly related to
the wiki page, so I'll leave them for a later email, once I have a
better idea of what's what.


Thanks,

Peter

From kaleb.pederson at gmail.com  Fri Oct 16 14:32:24 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Fri, 16 Oct 2009 14:32:24 -0700
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
	access on rule scope
In-Reply-To: <4AD8E25B.1020501@jacaranda.org>
References: <f14c01620910161221j7c5939dalf29aa867e6890538@mail.gmail.com>
	<4AD8E25B.1020501@jacaranda.org>
Message-ID: <f14c01620910161432t18ca5759lb6ac3e89fc70b5ab@mail.gmail.com>

On Fri, Oct 16, 2009 at 2:15 PM, David-Sarah Hopwood
<david-sarah at jacaranda.org> wrote:
> Kaleb Pederson wrote:
>> I'm getting an error that doesn't make any sense, either because I've
>> missed something fundamental or I've stumbled across a bug. I'm doing
>> some type checking within a tree parser. ?I have a plusMinusExpression
>> which can either be a negation or a subtraction expression. ?In order
>> to to check to see which it is, I have `if ($rhs != null)` within my
>> action. ?That line, however, causes the following error:
>>
>> SemanticChecker.g:163:3: missing attribute access on rule scope: rhs
>
> You can use "if ($rhs.tree != null)".

You're right, thank you.  Here's what ANTLR generates:

...
if ((rhs!=null?((CommonTree)rhs.tree):null) != null)
{
	typeChecker.assertIsNumericType((rhs!=null?rhs.type:null));
	typeChecker.assertEqualTypes((lhs!=null?lhs.type:null),
(rhs!=null?rhs.type:null));
}

So it places a guard around my check making sure that it only happens
if rhs isn't null.  To pose my next question, isn't what I had
perfectly legal? I.e. Isn't it pefectly legal to reference $labelName
without referencing an attribute, such as in my null check?

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From andreas.meyer at smartshift.de  Fri Oct 16 14:35:48 2009
From: andreas.meyer at smartshift.de (Andreas Meyer)
Date: Fri, 16 Oct 2009 23:35:48 +0200
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <4AD8E0D5.4090907@smartshift.de>
References: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>
	<4AD8E0D5.4090907@smartshift.de>
Message-ID: <4AD8E734.3080603@smartshift.de>

Andreas Meyer schrieb:
> Robert Wentworth schrieb:
>   
>> There appears to be something fundamental that I am not "getting"  
>> [...] 
>>     
>
> I think the generated code is wrong. [...]
>   
btw, when changing the gated semantic predicates:
> > cat     : {input.LT(1).getText().equals("cat")}?=> WORD ;
> >
> > dog     : {input.LT(1).getText().equals("dog")}?=> WORD ;
>   
into plain semantic predicates
> > cat     : {input.LT(1).getText().equals("cat")}? WORD ;
> >
> > dog     : {input.LT(1).getText().equals("dog")}? WORD ;
>   
the generated code looks good and expr can accept cat, cat when dog and 
dog. Now, as the other poster already mentioned, gated semantic 
predicates are there to distinguish between alternatives (that are not 
syntactically ambiguous). Maybe that's where ANTLR (or the user?!) get's 
confused, because cat only has one alternative (which get's effectively 
disabled if the predicate fails), but the context in which it is used 
has more alternatives, which effectively boil down to the same gated 
predicates.

Best,
Andreas Meyer

From david-sarah at jacaranda.org  Fri Oct 16 15:58:19 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 16 Oct 2009 23:58:19 +0100
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
 access on rule scope
In-Reply-To: <f14c01620910161432t18ca5759lb6ac3e89fc70b5ab@mail.gmail.com>
References: <f14c01620910161221j7c5939dalf29aa867e6890538@mail.gmail.com>	<4AD8E25B.1020501@jacaranda.org>
	<f14c01620910161432t18ca5759lb6ac3e89fc70b5ab@mail.gmail.com>
Message-ID: <4AD8FA8B.8080503@jacaranda.org>

Kaleb Pederson wrote:
> On Fri, Oct 16, 2009 at 2:15 PM, David-Sarah Hopwood
> <david-sarah at jacaranda.org> wrote:
>> Kaleb Pederson wrote:
>>> I'm getting an error that doesn't make any sense, either because I've
>>> missed something fundamental or I've stumbled across a bug. I'm doing
>>> some type checking within a tree parser.  I have a plusMinusExpression
>>> which can either be a negation or a subtraction expression.  In order
>>> to to check to see which it is, I have `if ($rhs != null)` within my
>>> action.  That line, however, causes the following error:
>>>
>>> SemanticChecker.g:163:3: missing attribute access on rule scope: rhs
>>
>> You can use "if ($rhs.tree != null)".
> 
> You're right, thank you.  Here's what ANTLR generates:
> 
> ...
> if ((rhs!=null?((CommonTree)rhs.tree):null) != null)
> {
> 	typeChecker.assertIsNumericType((rhs!=null?rhs.type:null));
> 	typeChecker.assertEqualTypes((lhs!=null?lhs.type:null),
> (rhs!=null?rhs.type:null));
> }
> 
> So it places a guard around my check making sure that it only happens
> if rhs isn't null.  To pose my next question, isn't what I had
> perfectly legal? I.e. Isn't it pefectly legal to reference $labelName
> without referencing an attribute, such as in my null check?

The syntax $labelName can be used in a parser or lexer grammar to refer
to a Token object, in cases where the reference is statically guaranteed
to correspond to a single token or fragment.

In a tree grammar, or in other cases in a parser grammar, the reference
might correspond to more than one token. So there are two possible design
choices for that situation: either make $labelName evaluate to something
other than a Token object reference, or disallow it. Making it evaluate to
something other than a Token would be inconsistent and possibly error-
prone, so disallowing it is reasonable.

In the case where all you're doing is testing the reference against null,
it may seem as though it wouldn't matter whether it corresponds to a
single token or more than one token. But ANTLR doesn't analyse
expressions in the target language, so it can't special-case this
situation.

This restriction tripped me up as well when I first came across it.
Arguably, it would have been better to *always* require an attribute
access -- say, "$labelName.token" in cases where you want a Token, and
"$labelName.isPresent" to test whether labelName matched any tokens
(or characters in the case of a lexer grammar).
That would have been easier to remember, and more consistent between
different kinds of grammar. Currently lexer grammars are not even self-
consistent: depending on context a bare $labelName reference evaluates
sometimes to an integer code point value, and sometimes to a Token
object reference.


[The other thing I think is suboptimal about ANTLR's behaviour in this
area (at least the Java target; I haven't checked other targets) is
that it generates a variable in the target language that has the same
name as the label. This means that leaving off the '$' will result in
code that may compile, and if it does compile, usually does something
unintended. It also causes errors if a label name matches a target
language keyword. Just mangling the name slightly would have prevented
these problems, although doing so now might be incompatible with any
grammars that rely on this property of the generated code.]

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Fri Oct 16 16:12:01 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sat, 17 Oct 2009 00:12:01 +0100
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <4AD8E734.3080603@smartshift.de>
References: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>	<4AD8E0D5.4090907@smartshift.de>
	<4AD8E734.3080603@smartshift.de>
Message-ID: <4AD8FDC1.3040705@jacaranda.org>

Andreas Meyer wrote:
> Andreas Meyer schrieb:
>> Robert Wentworth schrieb:
>>   
>>> There appears to be something fundamental that I am not "getting"  
>>> [...] 
>>>     
>> I think the generated code is wrong. [...]
>>   
> btw, when changing the gated semantic predicates:
>>> cat     : {input.LT(1).getText().equals("cat")}?=> WORD ;
>>>
>>> dog     : {input.LT(1).getText().equals("dog")}?=> WORD ;
>>   
> into plain semantic predicates
>>> cat     : {input.LT(1).getText().equals("cat")}? WORD ;
>>>
>>> dog     : {input.LT(1).getText().equals("dog")}? WORD ;
>>   
> the generated code looks good and expr can accept cat, cat when dog and 
> dog. Now, as the other poster already mentioned, gated semantic 
> predicates are there to distinguish between alternatives (that are not 
> syntactically ambiguous). Maybe that's where ANTLR (or the user?!) get's 
> confused, because cat only has one alternative (which get's effectively 
> disabled if the predicate fails), but the context in which it is used 
> has more alternatives, which effectively boil down to the same gated 
> predicates.

I think we have to interpret this as an ANTLR bug, not the grammar writer
being confused. Conceptually, a gated semantic predicate with a single
alternative has a clear meaning: if the predicate fails then it should be
equivalent to a rule that never matches. It would be very strange for it
to mean anything else.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From kaleb.pederson at gmail.com  Fri Oct 16 16:17:17 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Fri, 16 Oct 2009 16:17:17 -0700
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
	access on rule scope
In-Reply-To: <4AD8FA8B.8080503@jacaranda.org>
References: <f14c01620910161221j7c5939dalf29aa867e6890538@mail.gmail.com>
	<4AD8E25B.1020501@jacaranda.org>
	<f14c01620910161432t18ca5759lb6ac3e89fc70b5ab@mail.gmail.com>
	<4AD8FA8B.8080503@jacaranda.org>
Message-ID: <f14c01620910161617o67edf8e0t3ecc5a031b68752c@mail.gmail.com>

On Fri, Oct 16, 2009 at 3:58 PM, David-Sarah Hopwood
<david-sarah at jacaranda.org> wrote:
> Kaleb Pederson wrote:
>> To pose my next question, isn't what I had
>> perfectly legal? I.e. Isn't it pefectly legal to reference $labelName
>> without referencing an attribute, such as in my null check?
>
> The syntax $labelName can be used in a parser or lexer grammar to refer
> to a Token object, in cases where the reference is statically guaranteed
> to correspond to a single token or fragment.
>
> In a tree grammar, or in other cases in a parser grammar, the reference
> might correspond to more than one token. So there are two possible design
> choices for that situation: either make $labelName evaluate to something
> other than a Token object reference, or disallow it. Making it evaluate to
> something other than a Token would be inconsistent and possibly error-
> prone, so disallowing it is reasonable.

Ahh, that's the difference.  In this case I'm working with a tree
grammar which doesn't behave the same.

> In the case where all you're doing is testing the reference against null,
> it may seem as though it wouldn't matter whether it corresponds to a
> single token or more than one token. But ANTLR doesn't analyse
> expressions in the target language, so it can't special-case this
> situation.

True, and this even holds for comments in the target language, which
bit me once.

> This restriction tripped me up as well when I first came across it.
> Arguably, it would have been better to *always* require an attribute
> access -- say, "$labelName.token" in cases where you want a Token, and
> "$labelName.isPresent" to test whether labelName matched any tokens
> (or characters in the case of a lexer grammar).
> That would have been easier to remember, and more consistent between
> different kinds of grammar. Currently lexer grammars are not even self-
> consistent: depending on context a bare $labelName reference evaluates
> sometimes to an integer code point value, and sometimes to a Token
> object reference.

I'll have to remember that.

> [The other thing I think is suboptimal about ANTLR's behaviour in this
> area (at least the Java target; I haven't checked other targets) is
> that it generates a variable in the target language that has the same
> name as the label. This means that leaving off the '$' will result in
> code that may compile, and if it does compile, usually does something
> unintended. It also causes errors if a label name matches a target
> language keyword. Just mangling the name slightly would have prevented
> these problems, although doing so now might be incompatible with any
> grammars that rely on this property of the generated code.]

Thanks for the great explanation and details.

--
Kaleb Pederson
Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From antlr at mirality.co.nz  Fri Oct 16 16:42:25 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 17 Oct 2009 12:42:25 +1300
Subject: [antlr-interest] How to do "not" in a syntactic predicate?
In-Reply-To: <56eb2660910160439x7b449bdave27da7750a3372c2@mail.gmail.com
 >
References: <56eb2660910050702k3bd3b2c1m85df891ea3ec3b4c@mail.gmail.com>
	<9365a7c78ef3f745833c2e3c85c5054d@temporal-wave.com>
	<56eb2660910140319k2d250a9dy85f4a0f7519cdd0b@mail.gmail.com>
	<3544215969333489941@unknownmsgid>
	<56eb2660910141108p3fd3d377gb737887a421142be@mail.gmail.com>
	<191938162188708907@unknownmsgid>
	<56eb2660910150413t558fda56q4d78888086f5cf09@mail.gmail.com>
	<56eb2660910160439x7b449bdave27da7750a3372c2@mail.gmail.com>
Message-ID: <20091016234254.53FB2341840C@www.antlr.org>

At 00:39 17/10/2009, Naveen Chawla wrote:
>So, does anybody have a way of doing "Take *a* IF not followed by 
>*b* (both syntactic constructs)" ?
>
>i.e.
>q: (a !b)=> a;                        //("!" or "not" doesn't 
>exist in ANTLR)

Actually there is a negation operator, ~ -- but this operates on 
sets, not on sequences.  So in the lexer you can use "any single 
character not in this set" and in the parser you can use "any 
single token not in this set", but you can't get it to match on 
longer sequences without splitting them up into single-char/token 
decisions.

Without knowing more about what your a and b are, it's hard to 
give any more specific advice; for example, if b is a fixed 
sequence, such as DOT STAR, then you can do the above like so:

q : (a (~DOT | DOT ~STAR)) => a
   | /* nothing */
   ;

(I'm fairly sure you have to explicitly provide an alternative, 
either explicitly like this or via ?; if you don't then I think 
ANTLR will discard the predicate.  With no alternatives a 
predicate is useless.)

If b is not a fixed sequence, then you still need to provide the 
alternative choice, but by reversing the predicate:

q : (a b) => /* nothing */
   | a
   ;

Note that I haven't actually tested either of these, but in 
principle they ought to work. :)


From horst.dehmer at inode.at  Fri Oct 16 17:06:59 2009
From: horst.dehmer at inode.at (Horst Dehmer)
Date: Sat, 17 Oct 2009 02:06:59 +0200
Subject: [antlr-interest] "No Past Experience Required"
In-Reply-To: <5d97c170910161428w8022bd2sd9ea6117525e6320@mail.gmail.com>
Message-ID: <C6FED743.8DC%horst.dehmer@inode.at>

Hello Peter,

i myself am not too familiar with ANTLR 3 (and parser generators in general)
and for that reason i feel tempted to try to give some answers.

A symbol is a 'word' in a grammar, like a word in a natural language. A
symbol can be a terminal (symbol) which can no further be 'reduced', like
reserved words in a programming language: 'for', 'while', 'if'... You get
the picture. Non-terminals are the left side of a grammar (production) rule.
Non-terminals are reduced during parsing according to the defined grammar
and the stream of available tokens.

A lexer usually takes a character stream as an input and converts it in a
stream of tokens. The characters 'f', 'o', 'r', ' ', '(' for example become
the tokens 'for' and '('. In the old times (and still today with certain
lexers) lexer rules were defined just by regular expressions, which
restricts the class of what can be recognized by a parser pretty much
compared to ANTLR.

The parser takes a token stream as a input and tries to recognize a higher
level order. Think of it as sentences of a language following a certain
grammar. The rules which make up a parser grammar are usually much more
complex than lexer rules. (E)BNF can not be expressed by regular expression.

LL(k), LL(*) parsers (top-down, results are build by working their way from
left to right) are classes of parsers which are not very popular. I might be
wrong (or to old) but LR parsers are much more common. So maybe have a quick
look at lex/yacc. For me that's the father of all parser generators (for C).

Predicates (syntactic and semantic) help a LL parser determine which 'way to
go' or which alternatives to ignore. I guess they are quite unique to LL
parsers which have the "problem" with left-recursion or common prefix, which
really is no problem once you got your head around it.

For what it's worth: i would not start with ANTLR to build my first
grammars. The documentation is far too sophisticated for my taste and you
definitivly have to have some experiences to get started. If you don't know
what to look for even the book is useless. Don't get me wrong ANTLR 3 is a
very powerful and reliable tool, but before you use it make sure you really
need it. If you'd like to stick to ANTLR, have a look at the example
grammars. There are lots of 'em around and they give good hints on how to
solve promlems. 

And last but not least, if you are really interested in things, read the
Dragon Book: Principles of Compiler Design, by Alfred Aho and Jeffrey D.
Ullman

Regards,

Horst

PS: For those recognizing my errors and misunderstandings, help Peter to get
going.


On 16.10.09 23:28, "Peter Boughton" <boughtonp at gmail.com> wrote:

> Hi all,
> 
> I'm looking to figure out ANTLR and so I'm reading this page:
> http://www.antlr.org/wiki/display/ANTLR3/Quick+Starter+on+Parser+Grammars+-+No
> +Past+Experience+Required
> 
> But there are a number of things I'm stuck on - and so I'm asking here
> for both a good explanation and so that someone with edit permission
> can hopefully update the wiki page to actually be "no past experience"
> and more helpful for future newbies.
> 
> 
> "Left recursion."
> Maybe it's me being dim, but it took me a while to figure how "a : a B
> | C ;" translated to "a : C B*;" - and whilst I get it now, perhaps a
> quick sentence to explain the transition might be helpful for the wiki
> page?
> 
> 
> "syntactic predicates"
> So, they're an advanced category discussed in a book... yippee! I
> don't have the book, and the absolute earliest I could get it (if I
> choose to) is Tuesday, so that's not particularly helpful. If they're
> going to be mentioned, they should at least have a brief explanation
> of when they apply, and preferably a link to an online resource that
> covers them.
> (I tried reading the Wikipedia article, but that waffles on without
> being very helpful.)
> 
> Can anyone provide [a link to] a good, concise definition of syntactic
> predicates and semantic predicates and any other terms like this - for
> that matter, is there a good online glossary for all this sort of
> compiler/parser related stuff?
> 
> 
> "Difference between lexer and parser rules"
> This whole paragraph leaves me going "wha?". I don't know what the
> difference between a lexer and a parser is, so attempting to explain
> the difference between their rules doesn't mean much yet.
> 
> There's a vague suggestion that lexers look at literals (whether
> explicit or combined via multiple rules), and parsers look at
> everything else, but even then I'm not sure I get the implications of
> that?
> 
> What's a symbolic name?
> 
> In the example, what does the "EQUALS='=';" syntax do? Should that be
> a colon, or is something else happening?
> What about IMAGINERY_TOKEN - what's that doing?
> 
> I'm now confused about tokens and non-terminal symbols - they are
> obviously different, but how?
> 
> In the example for "How to build a grammar from a language
> specification", the FILE rule is not in the tokens section
> Does that make it a non-terminal symbol?
> Is this example grammar handled by a lexer or a parser or both?
> 
> 
> I do have some other questions, but they're not directly related to
> the wiki page, so I'll leave them for a later email, once I have a
> better idea of what's what.
> 
> 
> Thanks,
> 
> Peter
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



From jbb at acm.org  Fri Oct 16 19:08:11 2009
From: jbb at acm.org (John B. Brodie)
Date: Fri, 16 Oct 2009 22:08:11 -0400
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
 access on rule scope
Message-ID: <1255745291.2920.82.camel@gecko.home.org>

Greetings!

Sorry about this message, I think I have broken any threading to the
original message. I am replying from the mail-list archive and seem to
be unable to figure out how to graft my reply into its proper thread.
Sorry.

On Fri Oct 16 12:21:33 PDT 2009, Kaleb Pederson asked:
> I'm getting an error that doesn't make any sense, either because I've
> missed something fundamental or I've stumbled across a bug. I'm doing
> some type checking within a tree parser.  I have a plusMinusExpression
> which can either be a negation or a subtraction expression.  In order
> to to check to see which it is, I have `if ($rhs != null)` within my
> action.  That line, however, causes the following error:
> 
> SemanticChecker.g:163:3: missing attribute access on rule scope: rhs
> 
> The grammar fragment follows:
> 
> plusMinusExpression returns [Type type]
> 	:	^(PLUS lhs=baseExpression rhs=baseExpression) { /*...*/ }
> 		|	^(MINUS lhs=baseExpression rhs=baseExpression?)
> 		{
> 			typeChecker.assertIsNumericType($lhs.type);
> 			if ($rhs != null)
> 			{
> 				typeChecker.assertIsNumericType($rhs.type);
> 				typeChecker.assertEqualTypes($lhs.type, $rhs.type);
> 			}
> 			$type = $lhs.type;
> 		}
> 	;

Others in this thread have pointed out that you should use ($rhs.tree != null) in your if statement.

I would like to, respectfully, suggest that you are doing the Wrong Thing(TM) in your action code.
And it is wrong on two levels - the first mis-use is rather shallow and the second is a rather more
deeper mis-use.

I mean nothing personal nor pejorative by these comments. I am just trying to point out a couple
of "better" ways to do the above. And of course "better" is a qualitative assessment unique to each
reader of this message (e.g. what is "better" to me may not be "better" to you...).



The first, shallow, mis-use (IMHO) is to not simply let the Tree Walker code decide for you whether
or not the rhs tree node is present. That is, instead of

   | ^(MINUS lhs=baseExpression rhs=baseExpression?) { /* figure out what to do */ }

do something like this:

   | ^(MINUS lhs=baseExpression) { /* handle the 1-arity '-' operator here */ }
   | ^(MINUS lhs=baseExpression rhs=baseExpression) { /* handle the 2-arity subtraction here */ }

e.g. the Tree Walker code has to already poke around in your tree in order to determine whether or 
not the rhs is present (as part of its tree pattern matching) --- so let it control the invocation
of your actions.



The second, i think deeper, mis-use is that you have (apparently) discarded information discovered
during parsing and AST creation that you could use to guide your subsequent AST processing.

Surely in your Parser the 1-arity '-' appears in a different syntactic context from the 2-arity '-'
operator ---- so when parsing "a+-b" we know that the '-' must be the 1-arity operator, but when we
parse "a-b" we know that the '-' must be the 2-arity operator.

So I suggest to you that your Parser should differentiate the MINUS tree --- since, I assert, that
it already does so as part of the parse --- by creating a different (with imaginary root) node for
the 1-arity case. So "a+-b" obtains the tree (PLUS a (NEGATE b)) and "a-b" obtains the tree
(MINUS a b) or something similar in accord with your taste...

And so, with this approach, in all of your post-processing of the AST, the 1-arity and 2-arity
operations have already been differentiated in the tree itself and therefore can be directly
determined --- no need to noodle around about whether or not 1 or 2 children are present.

Your Mileage May Vary.



Hope this helps...
   -jbb
(again, sorry for breaking the threading of the replies to the original message)

and there is also the possibility of having ONLY the 2-arity '-' operator because in Algebra
the 1-arity '-' is an implicit 2-arity operation involving zero. so the "a+-b" would become
(PLUS a (MINUS 0 b)) --- but this just tends to break my brain so i do not do that..... ;-)

and, please, can we just not discuss the whole treatment of 2-arity '-' as an addition
with multiply by -1 ..... my brain tends to just shutdown at that prospect ;-)



From jimi at temporal-wave.com  Fri Oct 16 19:08:17 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 17 Oct 2009 07:38:17 +0530
Subject: [antlr-interest] accepting nested code blocks
In-Reply-To: <e2a1d9720910131041l3199cda8na2e468865af8323f@mail.gmail.com>
Message-ID: <f3b182cb4581ec48bd38321d28cdb8f2@temporal-wave.com>

Yes you can do it - you probably need to keep state flags and either trigger lexer rules based upon them or perhaps better would be to trigger an external lexer. The main problem is error recovery - what does your lexer do if the Javascript does not have perfectly matched '{' '}' and so the lexer rules drops out. 

However, if all you need do is consume the JS and say "this is a blob of JS", then I would write a small method that knows how to consume a Javascript function. Probably easier than writing it all out as recursive lexer rules. 

I have used this recursive technique for embedded XML and similar.

However, another thought is that if you have any control over the language, you should change it so that it does not just arbitrarily generate Javascript but delimits it in some reasonable way with say << javascript >> or some other delimiter. Then your lexer can just pick that out and strip off the delimiters.

Jim


> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Esp?k Mikl?s
> Sent: Tuesday, October 13, 2009 11:11 PM
> To: Indhu Bharathi
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] accepting nested code blocks
> 
> Hi,
> 
> I understand your point of view, but the book states explicitly the
> following:
> 
> "ANTLR generates recursive-descent recognizers
> for lexers just as it does for parsers and tree parsers. Consequently,
> ANTLR supports recursive lexer rules, unlike other tools such as lex."
> 
> Using recursion it should be possible to create such a lexer rule. If
> not, what it can be used for?
> 
> My original problem is that the input files contain a JavaScript
> function definition. The other parts of the input are covered by the
> grammar. However, I do not need to check the validity of the JS
> function, just extract it as is, and pass to the JS engine later. So
> if it is not necessary, I do not want to parse it.
> 
> Is it possible somehow? Or should I denote the beginning and the end
> of the JS function by some special token to allow catching it by a
> lexer rule?
> 
> Cheers,
> Miklos
> 
> 2009/10/13 Indhu Bharathi <indhu.b at s7software.com>:
> > Balanced parenthesis cannot be expressed using regular expression
> which
> > means you cannot recognize it using lexer. You need a push down
> automata
> > which means you need a parser to recognize it. Try doing it using
> parser
> > rules.
> >
> >
> >
> > Cheers, Indhu
> >
> >
> >
> >
> >
> > From: antlr-interest-bounces at antlr.org
> > [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Esp?k Mikl?s
> > Sent: Tuesday, October 13, 2009 10:04 PM
> > To: antlr-interest at antlr.org
> > Subject: [antlr-interest] accepting nested code blocks
> >
> >
> >
> > Hi,
> >
> > I want to create a lexer rule accepting nested code blocks.
> >
> > I tried out the example of the Definitive ANTLR Reference (Section
> 4.3), but
> > it does not work.
> > It accepts only such inputs which do not contain any character other
> than
> > curly braces. Moreover, one closing brace is enough.
> >
> > The error is the following:
> > MismatchedTokenException: line 1:1 mismatched input UNKNOW expecting
> 125
> >
> > The original code of the book:
> >
> > fragment
> > CODE[boolean stripCurlies]:
> > ? '{' ( CODE[stripCurlies] | ~('{' |'}' ) )* '}'
> > ? {
> > ??? if ( stripCurlies ) {
> > ????? setText(getText().substring(1, getText().length()));
> > ??? }
> > ? }
> > ? ;
> >
> > The simplified version of the rule results the same:
> > fragment
> > Block: '{' ( Block | ~('{'|'}') )* '}';
> >
> > I use ANTLR 3.2.
> >
> > Does anybody have an idea, how to get around this?
> >
> > Thanks,
> >
> > Miklos
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From mikesamuel at gmail.com  Fri Oct 16 20:01:13 2009
From: mikesamuel at gmail.com (Mike Samuel)
Date: Fri, 16 Oct 2009 20:01:13 -0700
Subject: [antlr-interest] Example code-generation target that outputs a
	state machine
Message-ID: <178b8d440910162001o3ac299bclf0c9fa82450a1f8d@mail.gmail.com>

> Mike Samuel wrote:
> > I'd like to derive a state machine that recognizes a combined lexical
> > grammar of JS/HTML/CSS (hacked so that JS has a regular lexical
> > grammar) and a mapping from states to the production they're part of.
> > I need to keep the number of states small.
> >
> > I saw something tantalizing about "dfaState() String Template" at
> > http://www.antlr.org/wiki/display/ANTLR3/How+to+build+an+ANTLR+code+generation+target
> > but am still unsure how to proceed.
> >
> > Is this possible with ANTLR, and if so, does anyone know of existing
> > code I could adapt?
> >
> > For background, my end goal is to bolt string interpolation onto
> > javascript, but in a way that doesn't introduce XSS problems as
> > described at
> > http://google-caja.googlecode.com/svn/changes/mikesamuel/string-interpolation-29-Jan-2008/trunk/src/js/com/google/caja/interp/index.html

David-Sarah Hopwood wrote:
> Sounds like a fun project.

> ANTLR normally only generates explicit DFAs when there is a nontrivial
> decision between alternatives of a rule. In the case of the ECMAScript 5
> lexical grammar I'm using, it only generates two DFAs, one for the main
> tokens rule, and one for DecimalLiteral.

> You can get ANTLRWorks to show a state machine diagram for any particular
> decision, or for the tokens rule, but they're not particularly
> enlightening. In principle, ANTLR computes all the information needed to
> produce a pure FSM lexer, but I don't think it provides any way to actually
> generate one, at least not without a lot of work. If that's definitely
> what you need, ANTLR is probably not the right tool.

Thanks for the response, David-Sarah.  Fancy running into you here.  I
guess you're using ANTLR for Jacaranda then?
How do you get a lexical grammar to distinguish division
operators/regex literal using ES5 rules, or are you using the lexical
grammar from Waldemar's JS 1.9 then?

I poked about a bit more, and when I generate a lexer, I get code that
looks like the below which sees to create instances of
org.antlr.runtime.DFA as described at
http://www.antlr.org/api/Java/classorg_1_1antlr_1_1runtime_1_1_d_f_a.html
.  I think I can probably poke at those to produce both (1) an
alphabet reduction, and (2) a transition table.
It won't integrate nicely into a build from grammar, and it's hacky,
but if the DFA just isn't exposed to code-generation targets, then
it'll be easier than trying to engineer a way through the front door.

======
    static final short[] DFA19_eot = DFA.unpackEncodedString(DFA19_eotS);
    // more unpacking elided

    static {
        int numStates = DFA19_transitionS.length;
        DFA19_transition = new short[numStates][];
        for (int i=0; i<numStates; i++) {
            DFA19_transition[i] = DFA.unpackEncodedString(DFA19_transitionS[i]);
        }
    }

    class DFA19 extends DFA {

        public DFA19(BaseRecognizer recognizer) {
            this.recognizer = recognizer;
            this.decisionNumber = 19;
            this.eot = DFA19_eot;
            // more grabbing of statics elided
        }
        public String getDescription() {
            return /* large chunks of my grammar elided */;
        }
    }

From david-sarah at jacaranda.org  Fri Oct 16 22:38:20 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sat, 17 Oct 2009 06:38:20 +0100
Subject: [antlr-interest] Example code-generation target that outputs a
 state machine
In-Reply-To: <178b8d440910162001o3ac299bclf0c9fa82450a1f8d@mail.gmail.com>
References: <178b8d440910162001o3ac299bclf0c9fa82450a1f8d@mail.gmail.com>
Message-ID: <4AD9584C.40703@jacaranda.org>

Mike Samuel wrote:
>> Mike Samuel wrote:
>>> For background, my end goal is to bolt string interpolation onto
>>> javascript, but in a way that doesn't introduce XSS problems as
>>> described at
>>> http://google-caja.googlecode.com/svn/changes/mikesamuel/string-interpolation-29-Jan-2008/trunk/src/js/com/google/caja/interp/index.html
> 
> David-Sarah Hopwood wrote:
>> Sounds like a fun project.
> 
>> ANTLR normally only generates explicit DFAs when there is a nontrivial
>> decision between alternatives of a rule. In the case of the ECMAScript 5
>> lexical grammar I'm using, it only generates two DFAs, one for the main
>> tokens rule, and one for DecimalLiteral.
> 
>> You can get ANTLRWorks to show a state machine diagram for any particular
>> decision, or for the tokens rule, but they're not particularly
>> enlightening. In principle, ANTLR computes all the information needed to
>> produce a pure FSM lexer, but I don't think it provides any way to actually
>> generate one, at least not without a lot of work. If that's definitely
>> what you need, ANTLR is probably not the right tool.
> 
> Thanks for the response, David-Sarah.  Fancy running into you here.  I
> guess you're using ANTLR for Jacaranda then?

Yes. Should be released fairly soon.

> How do you get a lexical grammar to distinguish division
> operators/regex literal using ES5 rules, or are you using the lexical
> grammar from Waldemar's JS 1.9 then?

I'm using feedback from the parser to the lexer. I looked carefully at
trying to use a finite state machine for this, but that approach can't
work if you want to parse full ES5 in all corner cases. The problematic
cases are things like "while (expr) /regexp/;", because it's impossible
to tell whether the '/' is part of a regexp literal without counting
whether the parentheses in 'expr' are balanced. Since expressions are
obviously not a regular language, that would require an infinite state
machine; parser -> lexer feedback turns out to be simpler.

Actually, if I had known how much complexity parsing regexp literals
correctly was going to add, I wouldn't have bothered; it's horrendous.
But that part is done now and seems to work.

Here's the comment I wrote about it:

====
ES5 says,

# There are two goal symbols for the lexical grammar. The InputElementDiv
# symbol is used in those syntactic grammar contexts where a leading
# division (/) or division-assignment (/=) operator is permitted. The
# InputElementRegExp symbol is used in other syntactic grammar contexts.

("Permitted" means syntactically valid in the *ES5* grammar.)

We don't quite follow this specification literally: we lex as a
RegularExpressionLiteral only in expression contexts, where a
regexp literal is permitted, rather than in all contexts where a
DivisionPunctuator is *not* permitted. This is equivalent for
syntactically valid input, since there are no contexts in which
both are permitted (the ES3 spec suggested otherwise, but see
<http://bugs.ecmascript.org/ticket/463>).

This has the advantage that for error recovery it is more sensible to
lex a misplaced '/' or '/=' as a misplaced DivPunctuator, rather than
as part of a RegularExpressionLiteral, since the latter are less
common (and would result in code up to the next '/' being ignored).

Implementation:

The lexer first lexes '/' as part of a DIV or DIVASSIGN token
(see the DIV rule in Punctuators above). If the parser finds such a
token in an expression context, then it resets the lexer and its
input stream so that the '/' will be the next char to be consumed.
A flag is also set in the lexer so that the next invocation of the
DIV rule will expect a regular expression literal. Then, the token
stream is reset to before the DIV or DIVASSIGN, discarding that
token and any following tokens read due to lookahead. This ensures
that when rewriting, the rewritten token stream does not contain
spurious tokens.

To support this functionality we must use a custom LazyTokenRewriteStream.
If the usual CommonTokenStream or TokenRewriteStream were used, the
lexer would lex all tokens on the first call to it (see the fillBuffer()
method of CommonTokenStream). Even if that were not the case, the lexer
necessarily runs ahead of the parser, due to token lookahead in the
parser. If the lexer may be reset, then lexing too far ahead is
inefficient, and more importantly causes spurious errors to be reported.

To solve this problem, LazyTokenRewriteStream only lexes tokens that
have been requested (typically by consume() or LA(k)). Each JacarandaToken
object records the errors associated with that token, so that these errors
can be reported only if the token remains part of the final token stream.
This also has the advantage of reporting all errors in the order of their
associated token position, which is a deterministic order independent of
lookahead depth.
====

> I poked about a bit more, and when I generate a lexer, I get code that
> looks like the below which sees to create instances of
> org.antlr.runtime.DFA as described at
> http://www.antlr.org/api/Java/classorg_1_1antlr_1_1runtime_1_1_d_f_a.html
> .  I think I can probably poke at those to produce both (1) an
> alphabet reduction, and (2) a transition table.

Probably -- but as I said, only two (of about 42) of the decisions in an
ES5 lexer (written straightforwardly following the spec) generate DFAs;
the rest generate 'if' and 'switch' statements. Both of these DFAs are
just about exactly what you would write by hand, so I don't think you're
gaining much by using ANTLR to generate them.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Sat Oct 17 20:42:05 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 09:12:05 +0530
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <45418a3a0910150756j62214253s565d084fd455477a@mail.gmail.com>
Message-ID: <5808eaa5e8e4b1429d2f9c617a0c3f00@temporal-wave.com>

However, I am pretty sure that all the C compilers on such systems allow specification of ASCII assumptions rather than the stupid EBCDIC (designed by committee to be stupid). For instance I know that the zOS compiler allows this. EBCDIC is a ridiculous encoding, which I won?t be supporting directly I am afraid.

 

So, compile the code with ASCII assumptions and feed the EBCDIC as 8 bit Unicode and you will be fine.

 

Jim

 

From: Lego Haryanto [mailto:legoharyanto at gmail.com] 
Sent: Thursday, October 15, 2009 8:27 PM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

Jim, thanks for your response ...

I know that in the EBCDIC system we feed a Unicode stream into the lexer, thus I'm pretty sure when the generated lexer code I pasted before is executed, it is already operating on the 32-bit unicode stream.

The problem is more about the native C compilation in an EBCDIC system like IBM z/OS mainframe.

To see if a character from the Unicode stream is an 'A', we have to compare with a value 0x0041 ... If we match it with a native 'A' in the code, this will not be a match in an EBCDIC C compilation.

Best,
-Lego

On Fri, Oct 16, 2009 at 3:07 AM, Jim Idle <jimi at temporal-wave.com> wrote:

ANTLR works internally with 32 bit Unicode (UTF32), not EBCDIC, even if it is in 8 bit mode. So you need to convert the EBCDIC to Unicode 8 bits and use the ?ASCII? input stream. A simple way to do this would be to write your own EBCDIC input stream that just converted to Unicode code points (essentially EBCDIC->ASCII) on the fly via a lookup table. Trivial and should be pretty quick.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lego Haryanto
Sent: Tuesday, October 13, 2009 3:51 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

I just recently noticed that the generated code from my lexer grammar contains something like the following snippet:

            .
            .
            else if ( (((LA17_0 >= 'A') && (LA17_0 <= 'Z'))) ) 
            {
                alt17=2;
            }
            else if ( (((LA17_0 >= 'a') && (LA17_0 <= 'z'))) ) 
            {
                alt17=3;
            }
            else if ( (((LA17_0 >= 0x00A0) && (LA17_0 <= 0xD7FF))) ) 
            {
                alt17=4;
            }
            .
            .

The generated code seems to comfortably use 'A' ... 'Z' literals.  This may not be good if let's say I compile the generated code in an IBM z/OS EBCDIC environment as ['A' .. 'Z'] range contains more than just the 26 alphabet codes and the value of the codes are not the same as the ones in Unicode character set.

I'm expecting something like in the third expression where 'A' is written explicitly as 0x0041 (Unicode for 'A').

Please confirm.

-Lego




-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/c62d3b58/attachment.html 

From jimi at temporal-wave.com  Sat Oct 17 20:53:56 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 09:23:56 +0530
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <45418a3a0910151428o189ed32bx1e18046bc607e1c0@mail.gmail.com>
Message-ID: <2055ffa9a6906a49ad387c9917884ab2@temporal-wave.com>

Well, you could pay me to make an EBCDIC version ;) However, there is in practice no problem with mixing this ? I have done it before on zOS.

 

I think that you need to look at this in the opposite light in that it isn?t that ANTLR code isn?t portable, but your lexer specification (and the fact that EBCDIC is stupid).

 

Why are you specifying your rule as:

 

ID: ?a?..?z?

 

When that is not a valid range in your target environment? 

 

Change the ranges to:

 

ID: ?a?..?k? | ?l?..?t? ?

 

Or whatever the valid ranges are. ANLTR might be ?clever? here and assuming ASCII, may merge those ranges, so you might need to fold the ranges into fragments and so on. However, if you rework your lexer rules, I am sure that this can be done in portable fashion that does not require ASCII assumptions within the compiler.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lego Haryanto
Sent: Friday, October 16, 2009 2:59 AM
To: David-Sarah Hopwood
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

Thanks for the response, ...

Unfortunately, it won't work in our situation without major changes.  We already have legacy C code which is compiled with default/native, and while we can use a different compile option for the ANTLR generated code, I'm not sure if it's good moving forward with mixed compilation rules.

The argument remains that it means the generated C lexer code has to be compiled by an ASCII-based compiler which may not be that portable.

Best,
-Lego

On Thu, Oct 15, 2009 at 12:30 PM, David-Sarah Hopwood <david-sarah at jacaranda.org> wrote:

Lego Haryanto wrote:
> Jim, thanks for your response ...
>
> I know that in the EBCDIC system we feed a Unicode stream into the lexer,
> thus I'm pretty sure when the generated lexer code I pasted before is
> executed, it is already operating on the 32-bit unicode stream.
>
> The problem is more about the native C compilation in an EBCDIC system like
> IBM z/OS mainframe.
>
> To see if a character from the Unicode stream is an 'A', we have to compare
> with a value 0x0041 ... If we match it with a native 'A' in the code, this
> will not be a match in an EBCDIC C compilation.

The z/OS C compiler is able to compile in a mode where string and character
literals are treated as ISO-8859-1.
<http://lists.gnupg.org/pipermail/gcrypt-devel/2009-July/001469.html>

--
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address




-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/bbdee716/attachment.html 

From jimi at temporal-wave.com  Sat Oct 17 20:48:05 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 09:18:05 +0530
Subject: [antlr-interest] String template return val propagation
In-Reply-To: <F5FD04DD-E24C-4A50-86D7-A17CAF201FBB@ontologyworks.com>
Message-ID: <ee84ccd9c38f594ab63661c347386e2d@temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Bill Andersen
> Sent: Friday, October 16, 2009 1:22 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] String template return val propagation
> 

> Thanks in advance
> 
> text_block
> 	: ^(AS_TEXT name phrase+)
> 	  -> text(name={$name.st})
> 	;
> 
> name
> 	: prefixed_name

		{ $st = prefixed_name.st; }

You need to be explicit here :-)

> 	;
> 





From jimi at temporal-wave.com  Sat Oct 17 21:00:49 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 09:30:49 +0530
Subject: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS
In-Reply-To: <a2a61e1e0910160116j69de19d2ob9260c1c3b97a0fc@mail.gmail.com>
Message-ID: <0a2d0ea32ae43f40b3f36a7e91b9df1c@temporal-wave.com>

Perhaps you guys are not asking the right questions. There is a tendency for some people to jump straight in to huge grammars without the appropriate practicing on smaller examples (which are provided). I try to answer everyone if I can but I am travelling at the moment and don't have lots of spare time. If no one else is jumping in, then I suggest that your questions are more akin to "can you write this for me" than you realize and that going back to basics might help. Switching to other parser generators won't get you over the fundamental problems of not having enough experience, you will just encounter different problems at different stages.

 

One does need to help oneself sometimes and perhaps consider what the basic reason is that others are not having similar problems.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of David Minor
Sent: Friday, October 16, 2009 1:46 PM
To: antlr_bill
Cc: antlr-interest
Subject: Re: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS

 

I wouldn't shout about it, but I also have received scant (or no help) on this forum. I'm not a parasite, I purchased the book, but... well... I'm using Gold now and so far so good. I check back every now and then to see if I got and answer. The unsubscribe link is at the bottom of this message.



2009/10/16 antlr_bill <antlr_bill at yeah.net>

I DONT HAVE ANY WORDS ANYMORE,
YEAH I REALLY WANNA GET SOME HELP FROM HERE 
BUT SEEMS IT'S IMPOSSIBLE
SURE ANTLR IS A GREAT PROJECT ,
BUT ...
ANYWAY ,SORRY THAT I DONT KNOW HOW TO UNSUBSCRIBE FROM THIS MAILIST



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/ff7e7c4f/attachment.html 

From jimi at temporal-wave.com  Sat Oct 17 21:05:39 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 09:35:39 +0530
Subject: [antlr-interest] [Antlr + ST] Huge output string -
	OutOfMemoryError
In-Reply-To: <2d17b250910160333r724d552naf49a1966efc0fcc@mail.gmail.com>
Message-ID: <d6e63684c91bda43a9dd01ec27d445f5@temporal-wave.com>

Run Java with   - Xmx1500M

 

Or some other option that increases available memory size. However this could point to something that can be better organized in terms of recursion or whatever.

 

You may also consider running Java with a better garbage collector such as:

 

-Xincgc

 

JIm

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Hieu Phung
Sent: Friday, October 16, 2009 4:03 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] [Antlr + ST] Huge output string - OutOfMemoryError

 

Hi all,

I am writing a program using Antlr and StringTemplate to translate an input file to an XML file. Input is small but output is huge: 720KB input file will generate about 100MB output file. When my input reached 7608KB, I got OOM error

time taken in second: 18 - file size in KB: 4804
time taken in second: 20 - file size in KB: 5205
time taken in second: 20 - file size in KB: 5605
time taken in second: 21 - file size in KB: 6006
time taken in second: 23 - file size in KB: 6406
time taken in second: 25 - file size in KB: 6806
time taken in second: 31 - file size in KB: 7207

at size 7608KB:
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
        at java.util.Arrays.copyOf(Arrays.java:2882)
        at java.lang.AbstractStringBuilder.expandCapacity(AbstractStringBuilder.java:100)
        at java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:572)
        at java.lang.StringBuffer.append(StringBuffer.java:320)
        at java.io.StringWriter.write(StringWriter.java:60)
        at org.antlr.stringtemplate.AutoIndentWriter.write(AutoIndentWriter.java:172)
        at org.antlr.stringtemplate.language.ASTExpr.writePOJO(ASTExpr.java:702)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:683)
        at org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
        at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
        at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
        at org.antlr.stringtemplate.language.ASTExpr.writeTemplate(ASTExpr.java:750)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:680)
        at org.antlr.stringtemplate.language.ASTExpr.writeIterableValue(ASTExpr.java:792)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:682)
        at org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
        at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
        at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
        at org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1670)
        at org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1661)
        at FFMParser.file(FFMParser.java:127)
        at CSVTest.main(CSVTest.java:33)
       
Is there any suggestion so that program can generate 1GB file?

1)       Having multiple templates, each template generates small string, then write the small strings to file.
My input has format: ((Part1) (Part2)+ (Part3)). For each part2, there is an xml element in the output. I can have 3 templates here. In Antlr action, I will write each part to file when parsing is done for the part.

2)       Any template engine that could write to file directly, instead of returning a string...? (This might not be proper to discussed here :D)

I hope problem is stated clearly. Please let me know if you need more information. Any suggestion is much appreciated. Thank you.

Regards,

Helen

 

 

 

 

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/14b5a6fb/attachment.html 

From jimi at temporal-wave.com  Sat Oct 17 21:07:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 09:37:59 +0530
Subject: [antlr-interest] Which version do I need for a CSharp target
	and VS 2008
In-Reply-To: <364129671.20091016181104@heliks.nl>
Message-ID: <d51d8b651df9c44eb15d8ef4106931a1@temporal-wave.com>

Not sure if the Csharp3 target is ready for production yet - I wanted to ask this myself as I would like to switch to it if it is ;-)

But I use Csharp2 as the target, and the runtime is on the download pages.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Robert van der Hulst
> Sent: Friday, October 16, 2009 9:41 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Which version do I need for a CSharp target
> and VS 2008
> 
> I am using Antlr 2.7.6 (CPP target) at this moment for our Language
> project.
> 
> I  need  to  do make some serious changes, so I am considering to move
> the project to Antlr 3 and a CSharp
> 
> Which version do people recommend that I should use.
> 
> I looked at the Antlr website and found two options:
> 
> - CSharp
> - CSharp3
> 
> but  I  am  not  sure  if they are both available for the latest Antlr
> build.
> 
> Which one do you recommend ?
> 
> I   would   also  like  to have a binary that does not need Java (like
> there is for Antlr 2). Does that exist ?
> 
> Finally:  Who has experience using Antlr in a VS 2008 environment (and
> setting up the necessary MsBuild steps to automate the build process)?
> 
> --
> Robert van der Hulst
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Sat Oct 17 21:13:31 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 09:43:31 +0530
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
	access on rule scope
In-Reply-To: <f14c01620910161221j7c5939dalf29aa867e6890538@mail.gmail.com>
Message-ID: <f7f69124feb49b4287e107c386e4811b@temporal-wave.com>

You need to rewrite the unary operators with imaginary tokens in your parser, which then means your tree parser need not care:

unary:  PLUS unary -> ^(UPLUS unary)
     | primary
     ;

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Kaleb Pederson
> Sent: Saturday, October 17, 2009 12:52 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
> access on rule scope
> 
> I'm getting an error that doesn't make any sense, either because I've
> missed something fundamental or I've stumbled across a bug. I'm doing
> some type checking within a tree parser.  I have a plusMinusExpression
> which can either be a negation or a subtraction expression.  In order
> to to check to see which it is, I have `if ($rhs != null)` within my
> action.  That line, however, causes the following error:
> 
> SemanticChecker.g:163:3: missing attribute access on rule scope: rhs
> 
> The grammar fragment follows:
> 
> plusMinusExpression returns [Type type]
> 	:	^(PLUS lhs=baseExpression rhs=baseExpression) { /*...*/ }
> 		|	^(MINUS lhs=baseExpression rhs=baseExpression?)
> 		{
> 			typeChecker.assertIsNumericType($lhs.type);
> 			if ($rhs != null)
> 			{
> 				typeChecker.assertIsNumericType($rhs.type);
> 				typeChecker.assertEqualTypes($lhs.type,
> $rhs.type);
> 			}
> 			$type = $lhs.type;
> 		}
> 	;
> Am I missing something fundamental or should this work? I tried
> changing rhs to something unique throughout the application, but the
> error persists.  I see the exact same behavior on both ANTLR-3.1 and
> 3.2.
> 
> Thanks.
> 
> --
> Kaleb Pederson
> Twitter - http://twitter.com/kalebpederson
> Blog - http://kalebpederson.com
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From david-sarah at jacaranda.org  Fri Oct 16 23:27:06 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sat, 17 Oct 2009 07:27:06 +0100
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
 generated lexer C code
In-Reply-To: <2055ffa9a6906a49ad387c9917884ab2@temporal-wave.com>
References: <2055ffa9a6906a49ad387c9917884ab2@temporal-wave.com>
Message-ID: <4AD963BA.1010301@jacaranda.org>

Jim Idle wrote:
[...]
> Change the ranges to:
> 
> ID: ?a?..?k? | ?l?..?t? ?

I doubt that will work. The generated code sometimes uses character
literals, sometimes string literals, and sometimes Unicode code point
values. The code can't be compiled as EBCDIC because the code point
values are not EBCDIC codes.

It would be easier to hack the C target so that it avoids character
literals, and uses only \x escapes in string literals.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From legoharyanto at gmail.com  Sat Oct 17 00:00:44 2009
From: legoharyanto at gmail.com (Lego Haryanto)
Date: Sat, 17 Oct 2009 00:00:44 -0700
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <2055ffa9a6906a49ad387c9917884ab2@temporal-wave.com>
References: <45418a3a0910151428o189ed32bx1e18046bc607e1c0@mail.gmail.com>
	<2055ffa9a6906a49ad387c9917884ab2@temporal-wave.com>
Message-ID: <45418a3a0910170000u35a7c221y459344356961bb76@mail.gmail.com>

Well, you could pay me to make an EBCDIC version ;) However, there is in
practice no problem with mixing this ? I have done it before on zOS.
>
> Jim, no worries, I'm not asking you or anyone to write the code for me,
especially when there's a workaround for this :)


>
> I think that you need to look at this in the opposite light in that it
> isn?t that ANTLR code isn?t portable, but your lexer specification (and the
> fact that EBCDIC is stupid).
>
>
>
> Why are you specifying your rule as:
>
>
>
> ID: ?a?..?z?
>
>
> When that is not a valid range in your target environment?
>
>
>
> Change the ranges to:
>
>
>
> ID: ?a?..?k? | ?l?..?t? ?
>
>
>
> Or whatever the valid ranges are. ANLTR might be ?clever? here and assuming
> ASCII, may merge those ranges, so you might need to fold the ranges into
> fragments and so on. However, if you rework your lexer rules, I am sure that
> this can be done in portable fashion that does not require ASCII assumptions
> within the compiler.
>
> Believe it or not, I specified something like: *ID: '\u0041' .. '\u005a'*in my lexer specification, so I doubt I did it incorrectly.  I have all the
intention to parse Unicode stream from the beginning.  The generated code
interestingly shows up as character literals.  From that perspective alone,
I still thinks the generated C code is not portable.

We have a massive platform ranges to deal with, so, mixing the compilation
rules for a bunch of files is probably going to be shot down even when we
all know it's possible to do so.  It might be easier for me to somehow
modify the code generator code to spit out unicode value as is and not to
generate literals even if they're printable.

Best,
-Lego

>
>
> Jim
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Lego Haryanto
> *Sent:* Friday, October 16, 2009 2:59 AM
> *To:* David-Sarah Hopwood
> *Cc:* antlr-interest at antlr.org
> *Subject:* Re: [antlr-interest] ANTLR C: Question regarding the
> portability of generated lexer C code
>
>
>
> Thanks for the response, ...
>
>
> Unfortunately, it won't work in our situation without major changes.  We
> already have legacy C code which is compiled with default/native, and while
> we can use a different compile option for the ANTLR generated code, I'm not
> sure if it's good moving forward with mixed compilation rules.
>
> The argument remains that it means the generated C lexer code has to be
> compiled by an ASCII-based compiler which may not be that portable.
>
> Best,
> -Lego
>
> On Thu, Oct 15, 2009 at 12:30 PM, David-Sarah Hopwood <
> david-sarah at jacaranda.org> wrote:
>
> Lego Haryanto wrote:
> > Jim, thanks for your response ...
> >
> > I know that in the EBCDIC system we feed a Unicode stream into the lexer,
> > thus I'm pretty sure when the generated lexer code I pasted before is
> > executed, it is already operating on the 32-bit unicode stream.
> >
> > The problem is more about the native C compilation in an EBCDIC system
> like
> > IBM z/OS mainframe.
> >
> > To see if a character from the Unicode stream is an 'A', we have to
> compare
> > with a value 0x0041 ... If we match it with a native 'A' in the code,
> this
> > will not be a match in an EBCDIC C compilation.
>
> The z/OS C compiler is able to compile in a mode where string and character
> literals are treated as ISO-8859-1.
> <http://lists.gnupg.org/pipermail/gcrypt-devel/2009-July/001469.html>
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
>
> --
> Fear of the LORD is the beginning of knowledge (Proverbs 1:7)
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>


-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091017/5735956b/attachment.html 

From legoharyanto at gmail.com  Sat Oct 17 00:04:38 2009
From: legoharyanto at gmail.com (Lego Haryanto)
Date: Sat, 17 Oct 2009 00:04:38 -0700
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <4AD963BA.1010301@jacaranda.org>
References: <2055ffa9a6906a49ad387c9917884ab2@temporal-wave.com>
	<4AD963BA.1010301@jacaranda.org>
Message-ID: <45418a3a0910170004v3c092c0dm799b31f2faf5c639@mail.gmail.com>

Thanks, ... yes that's precisely what intend to do ... and you are very
correct, changing that lexer spec isn't going to help.

Best,
-Lego

On Fri, Oct 16, 2009 at 11:27 PM, David-Sarah Hopwood <
david-sarah at jacaranda.org> wrote:

> Jim Idle wrote:
> [...]
> > Change the ranges to:
> >
> > ID: ?a?..?k? | ?l?..?t? ?
>
> I doubt that will work. The generated code sometimes uses character
> literals, sometimes string literals, and sometimes Unicode code point
> values. The code can't be compiled as EBCDIC because the code point
> values are not EBCDIC codes.
>
> It would be easier to hack the C target so that it avoids character
> literals, and uses only \x escapes in string literals.
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091017/c8f3c1b8/attachment.html 

From jimi at temporal-wave.com  Sun Oct 18 01:09:17 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 13:39:17 +0530
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <2055ffa9a6906a49ad387c9917884ab2@temporal-wave.com>
Message-ID: <2079732c4ef4454ba40db68e74862749@temporal-wave.com>

So, having a little spare time I did a little experimentation and all you need do is be careful how you specify your ranges. Here is a rule that matches lower case ID in EBCDIC compatible ways, but is still compatible with ASCII/Unicode. You can extrapolate for the rest.

 

ID : (?a?..?I? {} | ?j?..?r? {} | ?s?..?y? {} | ?z? {})

 

Note that the empty actions are there to prevent ANTLR from merging the ranges assuming Unicode character points.

 

However, for the sake of performance, you might be better scrapping ranges altogether and generating a switch instead. ANTLR 3.2 C target does its best to generate switch() instead of table driven DFA or If() because the C compilers are usually excellent at optimizing switch() and it results in code that avoids CPU data cache misses (DFA tables). It would be trivial for you to encode that in your own Inlinable) function and use it as a gated predicate for your ID  rule.

 

Similar care with all your lexer rule specifications will result in EBCDIC compatible, portable C code being generated.

 

Jim

 

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Sunday, October 18, 2009 9:24 AM
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

Well, you could pay me to make an EBCDIC version ;) However, there is in practice no problem with mixing this ? I have done it before on zOS.

 

I think that you need to look at this in the opposite light in that it isn?t that ANTLR code isn?t portable, but your lexer specification (and the fact that EBCDIC is stupid).

 

Why are you specifying your rule as:

 

ID: ?a?..?z?

 

When that is not a valid range in your target environment? 

 

Change the ranges to:

 

ID: ?a?..?k? | ?l?..?t? ?

 

Or whatever the valid ranges are. ANLTR might be ?clever? here and assuming ASCII, may merge those ranges, so you might need to fold the ranges into fragments and so on. However, if you rework your lexer rules, I am sure that this can be done in portable fashion that does not require ASCII assumptions within the compiler.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lego Haryanto
Sent: Friday, October 16, 2009 2:59 AM
To: David-Sarah Hopwood
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

Thanks for the response, ...

Unfortunately, it won't work in our situation without major changes.  We already have legacy C code which is compiled with default/native, and while we can use a different compile option for the ANTLR generated code, I'm not sure if it's good moving forward with mixed compilation rules.

The argument remains that it means the generated C lexer code has to be compiled by an ASCII-based compiler which may not be that portable.

Best,
-Lego

On Thu, Oct 15, 2009 at 12:30 PM, David-Sarah Hopwood <david-sarah at jacaranda.org> wrote:

Lego Haryanto wrote:
> Jim, thanks for your response ...
>
> I know that in the EBCDIC system we feed a Unicode stream into the lexer,
> thus I'm pretty sure when the generated lexer code I pasted before is
> executed, it is already operating on the 32-bit unicode stream.
>
> The problem is more about the native C compilation in an EBCDIC system like
> IBM z/OS mainframe.
>
> To see if a character from the Unicode stream is an 'A', we have to compare
> with a value 0x0041 ... If we match it with a native 'A' in the code, this
> will not be a match in an EBCDIC C compilation.

The z/OS C compiler is able to compile in a mode where string and character
literals are treated as ISO-8859-1.
<http://lists.gnupg.org/pipermail/gcrypt-devel/2009-July/001469.html>

--
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address




-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/296c701d/attachment.html 

From jimi at temporal-wave.com  Sun Oct 18 01:12:06 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 13:42:06 +0530
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <4AD963BA.1010301@jacaranda.org>
Message-ID: <9a47993dfdbe084eb54841c1930026f4@temporal-wave.com>

No - it works, but you have to be careful to avoid ANTLR merging the ranges. See my later post.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of David-Sarah Hopwood
> Sent: Saturday, October 17, 2009 11:57 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] ANTLR C: Question regarding the
> portability of generated lexer C code
> 
> Jim Idle wrote:
> [...]
> > Change the ranges to:
> >
> > ID: ?a?..?k? | ?l?..?t? ?
> 
> I doubt that will work. The generated code sometimes uses character
> literals, sometimes string literals, and sometimes Unicode code point
> values. The code can't be compiled as EBCDIC because the code point
> values are not EBCDIC codes.
> 
> It would be easier to hack the C target so that it avoids character
> literals, and uses only \x escapes in string literals.
> 
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From legoharyanto at gmail.com  Sat Oct 17 01:19:20 2009
From: legoharyanto at gmail.com (Lego Haryanto)
Date: Sat, 17 Oct 2009 01:19:20 -0700
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <9a47993dfdbe084eb54841c1930026f4@temporal-wave.com>
References: <4AD963BA.1010301@jacaranda.org>
	<9a47993dfdbe084eb54841c1930026f4@temporal-wave.com>
Message-ID: <45418a3a0910170119y508f32bap422199b5c3596982@mail.gmail.com>

Jim, I'm not sure which time zone you're in, I'm assuming it's already after
midnight ... I do appreciate your taking time on this.
I'll try your suggestion in my z/OS env next week.  I'll update this thread
with the result.

Thanks,
-Lego

On Sun, Oct 18, 2009 at 1:12 AM, Jim Idle <jimi at temporal-wave.com> wrote:

> No - it works, but you have to be careful to avoid ANTLR merging the
> ranges. See my later post.
>
> Jim
>
> > -----Original Message-----
> > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > bounces at antlr.org] On Behalf Of David-Sarah Hopwood
> > Sent: Saturday, October 17, 2009 11:57 AM
> > To: antlr-interest at antlr.org
> > Subject: Re: [antlr-interest] ANTLR C: Question regarding the
> > portability of generated lexer C code
> >
> > Jim Idle wrote:
> > [...]
> > > Change the ranges to:
> > >
> > > ID: ?a?..?k? | ?l?..?t? ?
> >
> > I doubt that will work. The generated code sometimes uses character
> > literals, sometimes string literals, and sometimes Unicode code point
> > values. The code can't be compiled as EBCDIC because the code point
> > values are not EBCDIC codes.
> >
> > It would be easier to hack the C target so that it avoids character
> > literals, and uses only \x escapes in string literals.
> >
> > --
> > David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> > email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091017/8b74e9f0/attachment-0001.html 

From jimi at temporal-wave.com  Sun Oct 18 01:38:42 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 14:08:42 +0530
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <45418a3a0910150756j62214253s565d084fd455477a@mail.gmail.com>
Message-ID: <9e83d31dc00f9d49bbce4e15eda1e57f@temporal-wave.com>

A couple of other things though on this now I think about it.

 

1)      To avoid problems with various systems ideas about what wide_t is, character strings are encoded in their ASCII hex forms ? this would have to be avoided by encoding ?C? ?h? ?a? ?r?

2)      Use ?\n? etc rather than unicode code points in your rules;

3)      Use 3.2 and ensure that you get switches generated for everything and not DFA tables;

 

I cannot immediately think of anything else that would get in the way. However, if you hack together anything then send me the changes you had to make as if they are reasonable then I am willing to add them to the C target J If the main thing is the encoding in ASCII form of string literals then it might be reasonable to add an ebcdic option to the command line and only those targets where it is an issue would look at it. I just don?t want to embark on huge changes just to accommodate IBM.

 

I am not sure how true it is or not, but a friend of mine worked for IBM in Florida and met a guy who was (or at least said he was) on the development committee for EBCDIC. He claimed that he had deliberately thrown in outrageous suggestions (but I don?t know if it was out of disgust or a bizarre sense of humor), and that some of them were adopted. 

 

Anyway, you have my sympathies trying to work on the C stuff on zOS. I was pioneer on using it and I can only hope that it is more mature these days. If I can help you, then I will J

 

Jim

 

From: Lego Haryanto [mailto:legoharyanto at gmail.com] 
Sent: Thursday, October 15, 2009 8:27 PM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

Jim, thanks for your response ...

I know that in the EBCDIC system we feed a Unicode stream into the lexer, thus I'm pretty sure when the generated lexer code I pasted before is executed, it is already operating on the 32-bit unicode stream.

The problem is more about the native C compilation in an EBCDIC system like IBM z/OS mainframe.

To see if a character from the Unicode stream is an 'A', we have to compare with a value 0x0041 ... If we match it with a native 'A' in the code, this will not be a match in an EBCDIC C compilation.

Best,
-Lego

On Fri, Oct 16, 2009 at 3:07 AM, Jim Idle <jimi at temporal-wave.com> wrote:

ANTLR works internally with 32 bit Unicode (UTF32), not EBCDIC, even if it is in 8 bit mode. So you need to convert the EBCDIC to Unicode 8 bits and use the ?ASCII? input stream. A simple way to do this would be to write your own EBCDIC input stream that just converted to Unicode code points (essentially EBCDIC->ASCII) on the fly via a lookup table. Trivial and should be pretty quick.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Lego Haryanto
Sent: Tuesday, October 13, 2009 3:51 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

I just recently noticed that the generated code from my lexer grammar contains something like the following snippet:

            .
            .
            else if ( (((LA17_0 >= 'A') && (LA17_0 <= 'Z'))) ) 
            {
                alt17=2;
            }
            else if ( (((LA17_0 >= 'a') && (LA17_0 <= 'z'))) ) 
            {
                alt17=3;
            }
            else if ( (((LA17_0 >= 0x00A0) && (LA17_0 <= 0xD7FF))) ) 
            {
                alt17=4;
            }
            .
            .

The generated code seems to comfortably use 'A' ... 'Z' literals.  This may not be good if let's say I compile the generated code in an IBM z/OS EBCDIC environment as ['A' .. 'Z'] range contains more than just the 26 alphabet codes and the value of the codes are not the same as the ones in Unicode character set.

I'm expecting something like in the third expression where 'A' is written explicitly as 0x0041 (Unicode for 'A').

Please confirm.

-Lego




-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/2d9dd459/attachment.html 

From jimi at temporal-wave.com  Sun Oct 18 02:06:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 18 Oct 2009 14:36:59 +0530
Subject: [antlr-interest] ANTLR C: Question regarding the portability of
	generated lexer C code
In-Reply-To: <45418a3a0910170119y508f32bap422199b5c3596982@mail.gmail.com>
Message-ID: <4869b0dde8b5ed47bab32fe11da250cb@temporal-wave.com>

Normally I am in US Pacific, but this week and next I am in the India timezone.

 

Jim

 

From: Lego Haryanto [mailto:legoharyanto at gmail.com] 
Sent: Saturday, October 17, 2009 1:49 PM
To: Jim Idle
Cc: David-Sarah Hopwood; antlr-interest at antlr.org
Subject: Re: [antlr-interest] ANTLR C: Question regarding the portability of generated lexer C code

 

Jim, I'm not sure which time zone you're in, I'm assuming it's already after midnight ... I do appreciate your taking time on this.

 

I'll try your suggestion in my z/OS env next week.  I'll update this thread with the result. 

 

Thanks,

-Lego

On Sun, Oct 18, 2009 at 1:12 AM, Jim Idle <jimi at temporal-wave.com> wrote:

No - it works, but you have to be careful to avoid ANTLR merging the ranges. See my later post.

Jim


> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-

> bounces at antlr.org] On Behalf Of David-Sarah Hopwood
> Sent: Saturday, October 17, 2009 11:57 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] ANTLR C: Question regarding the
> portability of generated lexer C code
>

> Jim Idle wrote:
> [...]
> > Change the ranges to:
> >
> > ID: ?a?..?k? | ?l?..?t? ?
>
> I doubt that will work. The generated code sometimes uses character
> literals, sometimes string literals, and sometimes Unicode code point
> values. The code can't be compiled as EBCDIC because the code point
> values are not EBCDIC codes.
>
> It would be easier to hack the C target so that it avoids character
> literals, and uses only \x escapes in string literals.
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address




-- 
Fear of the LORD is the beginning of knowledge (Proverbs 1:7)



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/7b8cccc2/attachment.html 

From dahvid.minor at gmail.com  Sat Oct 17 09:27:46 2009
From: dahvid.minor at gmail.com (David Minor)
Date: Sat, 17 Oct 2009 18:27:46 +0200
Subject: [antlr-interest] SEEMS NOBODY HERE LIKE TO HELP OTHERS
In-Reply-To: <4.1.20091016014553.06b071b0@grahamwideman.com>
References: <755902049.408851255676438280.JavaMail.coremail@app5.yeah.net>
	<4.1.20091016014553.06b071b0@grahamwideman.com>
Message-ID: <a2a61e1e0910170927j21900c6fi4d8ac70201edfe45@mail.gmail.com>

Thanks Graham,
For you thoughtful advice, I'll consider everything you said in future
postings. You get the same errors I get on my grammar.  I've done a bit of
work trying to simplify the problem and didn't succeed, it would just push
the error down a line.  I ported the grammar to Gold (took about two hours),
and Golds LARL parser clued me in to a couple of ambiguities that I needed
to fix. If I was to continue this project in Antlr I would re-port the
Grammar back with my fixes and see how that works. I have a feeling the
error messages are so far off it's hard to find.
Regards,
David

On Fri, Oct 16, 2009 at 11:31 AM, Graham Wideman
<gwlist at grahamwideman.com>wrote:

> David:
>
> > I also have received scant (or no help) on this forum
>
> I see that you started two threads.  In one, Jim Idle gave you a thoughtful
> response, and suggested some questions to pursue.  You did post some more,
> and
> nobody answered so far as I can see. That could be because the subject line
> on
> your post got wrapped after the first word, so that it appears as just
> "saving"
> -- not a title that would attract much attention.
>
> Your second thread was last week "stuck on tree parsing", in which you
> posted
> two grammars as attachments of 300 and 500 lines each, and then asked:
> "PearGrammerTree.g complains about an undefined rule, that is defined right
> above it" ...  without mentioning what rule you are talking about.
>
> So here you miss out on the possibility that someone could just glance at
> the
> problem area, in the body of the email, and spot a problem. Instead, you're
> obliging someone to have to fetch the attachments and run ANTLR or AW on
> them
> (you don't mention which, what version etc) just to see where there might
> be a
> problem, with no guarantee it's even the same problem you're seeing.
>
> In short, doubtless inadvertantly, you happened to present your messages in
> a
> manner most likely not to be quickly answerable by knowledgeable list
> members.
>
> If you had simply mentioned which rule had the problem, and inserted the
> relevant part of the file in your email (so that looking at the attachment
> was
> optional) then it is possible that someone could just eyeball it and spot
> an
> obvious problem.
>
> I should also say that one customary line of troubleshooting advice is to
> whittle down the troublesome sample so that it's much smaller. Often that
> causes the problem to become more conspicuous, and even if not makes for a
> much
> better example to ask for help about.
>
> For what it's worth, I did just run ANTLR on your files, and on
> PearGramerTree.g it gave not just one error, but the following:
>
> =============================
> F:\Proj\ANTLR\Test\Minor>java -jar D:\Antlr20090923\antlr-3.2.jar
> PearGrammerTree.g
> error(100): PearGrammerTree.g:117:6: syntax error: antlr:
> PearGrammerTree.g:117:6: unexpected token: roi_identifier
> error(100): PearGrammerTree.g:123:1: syntax error: antlr:
> PearGrammerTree.g:123:1: unexpected token: data_scope_expr
> error(100): PearGrammerTree.g:124:6: syntax error: antlr:
> PearGrammerTree.g:124:6: unexpected token: IDENTIFIER
> error(100): PearGrammerTree.g:127:1: syntax error: antlr:
> PearGrammerTree.g:127:1: unexpected token: parameter
> error(100): PearGrammerTree.g:129:20: syntax error: antlr:
> PearGrammerTree.g:129:20: expecting RPAREN, found '|'
> error(100): PearGrammerTree.g:138:2: syntax error: antlr:
> PearGrammerTree.g:138:2: expecting RPAREN, found ';'
> error(100): PearGrammerTree.g:141:1: syntax error: antlr:
> PearGrammerTree.g:141:1: unexpected token: param_list
> error(100): PearGrammerTree.g:142:6: syntax error: antlr:
> PearGrammerTree.g:142:6: unexpected token: parameter
> error(100): PearGrammerTree.g:145:1: syntax error: antlr:
> PearGrammerTree.g:145:1: unexpected token: input_param_list
> error(100): PearGrammerTree.g:147:2: syntax error: antlr:
> PearGrammerTree.g:147:2: expecting RPAREN, found ';'
> error(100): PearGrammerTree.g:149:1: syntax error: antlr:
> PearGrammerTree.g:149:1: unexpected token: output_param_list
> error(100): PearGrammerTree.g:307:4: syntax error: antlr:
> PearGrammerTree.g:307:4: unexpected token: binding_expr
> error(100): PearGrammerTree.g:315:1: syntax error: antlr:
> PearGrammerTree.g:315:1: unexpected token: expression
> error(100): PearGrammerTree.g:317:2: syntax error: antlr:
> PearGrammerTree.g:317:2: expecting RPAREN, found ';'
> error(100): PearGrammerTree.g:319:1: syntax error: antlr:
> PearGrammerTree.g:319:1: unexpected token: program
> error(106): PearGrammerTree.g:109:17: reference to undefined rule:
> param_list
> error(106): PearGrammerTree.g:150:17: reference to undefined rule:
> param_list
> error(106): PearGrammerTree.g:155:6: reference to undefined rule:
> output_param_list
> error(106): PearGrammerTree.g:154:22: reference to undefined rule:
> output_param_list
> error(106): PearGrammerTree.g:177:14: reference to undefined rule:
> data_scope_expr
> error(106): PearGrammerTree.g:173:11: reference to undefined rule:
> data_scope_expr
> error(106): PearGrammerTree.g:154:5: reference to undefined rule:
> input_param_list
> error(106): PearGrammerTree.g:320:4: reference to undefined rule:
> expression
> error(106): PearGrammerTree.g:285:11: reference to undefined rule:
> data_scope_expr
> error(106): PearGrammerTree.g:156:5: reference to undefined rule:
> input_param_list
> ===============================
>
> Many of these report undefined rules not because that particular rule has a
> problem per se, but because some rule it depends on has a problem. It's
> probably worth looking at the "unexpected token" errors with a view to
> determining if the syntax you've used is legit.
>
> -- Graham
>
> At 10/16/2009 10:16 AM, David Minor wrote:
> >
> > I wouldn't shout about it, but I also have received scant (or no help) on
> > this forum. I'm not a parasite, I purchased the book, but... well... I'm
> > using Gold now and so far so good. I check back every now and then to see
> if
> > I got and answer. The unsubscribe link is at the bottom of this message.
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091017/5938e1cb/attachment.html 

From kferrio at gmail.com  Sat Oct 17 10:02:13 2009
From: kferrio at gmail.com (kferrio at gmail.com)
Date: Sat, 17 Oct 2009 17:02:13 +0000
Subject: [antlr-interest] Which version do I need for a CSharp targetand
	VS 2008
In-Reply-To: <d51d8b651df9c44eb15d8ef4106931a1@temporal-wave.com>
References: <364129671.20091016181104@heliks.nl><d51d8b651df9c44eb15d8ef4106931a1@temporal-wave.com>
Message-ID: <1464599794-1255798740-cardhu_decombobulator_blackberry.rim.net-1674446918-@bda430.bisx.prod.on.blackberry>

I've also been waiting and watching, reluctant to ask a question which might sound like prodding.  I have glanced at Sam Harrell's code in version control, and it appears to be written to very high internal best practices.  This is not to say anything against the existing CSharp2 runtime, which is also excellent.  Choices are good, and this is one I look forward to having.

Kyle

Sent from my Verizon Wireless BlackBerry

-----Original Message-----
From: "Jim Idle" <jimi at temporal-wave.com>
Date: Sun, 18 Oct 2009 09:37:59 
To: antlr-interest at antlr.org<antlr-interest at antlr.org>
Subject: Re: [antlr-interest] Which version do I need for a CSharp target
	and VS 2008

Not sure if the Csharp3 target is ready for production yet - I wanted to ask this myself as I would like to switch to it if it is ;-)

But I use Csharp2 as the target, and the runtime is on the download pages.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Robert van der Hulst
> Sent: Friday, October 16, 2009 9:41 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Which version do I need for a CSharp target
> and VS 2008
> 
> I am using Antlr 2.7.6 (CPP target) at this moment for our Language
> project.
> 
> I  need  to  do make some serious changes, so I am considering to move
> the project to Antlr 3 and a CSharp
> 
> Which version do people recommend that I should use.
> 
> I looked at the Antlr website and found two options:
> 
> - CSharp
> - CSharp3
> 
> but  I  am  not  sure  if they are both available for the latest Antlr
> build.
> 
> Which one do you recommend ?
> 
> I   would   also  like  to have a binary that does not need Java (like
> there is for Antlr 2). Does that exist ?
> 
> Finally:  Who has experience using Antlr in a VS 2008 environment (and
> setting up the necessary MsBuild steps to automate the build process)?
> 
> --
> Robert van der Hulst
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From naveen.chwl at googlemail.com  Sat Oct 17 10:15:25 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Sat, 17 Oct 2009 18:15:25 +0100
Subject: [antlr-interest] How to make a syntactic predicate exit a rule
	completely
Message-ID: <56eb2660910171015j23545d90kf83f454d3b271ec7@mail.gmail.com>

Ok, so even if all syntactic predicates have failed in a particular
rule, that rule is still included as "matched" in that analysis! Is this
true or are my tests wrong? This is not what I hoped. I was hoping that upon
complete failure of all syntactic predicates in a rule, the rule becomes
disregarded, and that "disregarding" is cascaded as far up as possible, and
an alternative path is attempted. Is this how it's works, or am I missing
something? Or is there a way, using actions, to "force" the exiting of a
particular rule as if it had not been matched at all?

Many regards,
N
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091017/3c13182f/attachment.html 

From parrt at cs.usfca.edu  Sat Oct 17 10:24:43 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 17 Oct 2009 10:24:43 -0700
Subject: [antlr-interest] [Antlr + ST] Huge output string -
	OutOfMemoryError
In-Reply-To: <d6e63684c91bda43a9dd01ec27d445f5@temporal-wave.com>
References: <d6e63684c91bda43a9dd01ec27d445f5@temporal-wave.com>
Message-ID: <F582A1CF-2F80-495A-8362-2B5E9F463679@cs.usfca.edu>

An important note about using ST: don't translate toString and then  
emit. Send in a Writer to write().  No need to buffer in memory.   
CC'ing the other list.
Ter

On Oct 17, 2009, at 9:05 PM, Jim Idle wrote:

> Run Java with   - Xmx1500M
>
> Or some other option that increases available memory size. However  
> this could point to something that can be better organized in terms  
> of recursion or whatever.
>
> You may also consider running Java with a better garbage collector  
> such as:
>
> -Xincgc
>
> JIm
>
>
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org 
> ] On Behalf Of Hieu Phung
> Sent: Friday, October 16, 2009 4:03 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] [Antlr + ST] Huge output string -  
> OutOfMemoryError
>
> Hi all,
>
> I am writing a program using Antlr and StringTemplate to translate  
> an input file to an XML file. Input is small but output is huge:  
> 720KB input file will generate about 100MB output file. When my  
> input reached 7608KB, I got OOM error
>
> time taken in second: 18 - file size in KB: 4804
> time taken in second: 20 - file size in KB: 5205
> time taken in second: 20 - file size in KB: 5605
> time taken in second: 21 - file size in KB: 6006
> time taken in second: 23 - file size in KB: 6406
> time taken in second: 25 - file size in KB: 6806
> time taken in second: 31 - file size in KB: 7207
>
> at size 7608KB:
> Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
>         at java.util.Arrays.copyOf(Arrays.java:2882)
>         at  
> java 
> .lang 
> .AbstractStringBuilder.expandCapacity(AbstractStringBuilder.java:100)
>         at  
> java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:572)
>         at java.lang.StringBuffer.append(StringBuffer.java:320)
>         at java.io.StringWriter.write(StringWriter.java:60)
>         at  
> org 
> .antlr.stringtemplate.AutoIndentWriter.write(AutoIndentWriter.java: 
> 172)
>         at  
> org.antlr.stringtemplate.language.ASTExpr.writePOJO(ASTExpr.java:702)
>         at  
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:683)
>         at  
> org 
> .antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java: 
> 660)
>         at  
> org 
> .antlr 
> .stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java: 
> 86)
>         at  
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
>         at  
> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
>         at  
> org.antlr.stringtemplate.language.ASTExpr.writeTemplate(ASTExpr.java: 
> 750)
>         at  
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:680)
>         at  
> org 
> .antlr 
> .stringtemplate.language.ASTExpr.writeIterableValue(ASTExpr.java:792)
>         at  
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:682)
>         at  
> org 
> .antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java: 
> 660)
>         at  
> org 
> .antlr 
> .stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java: 
> 86)
>         at  
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
>         at  
> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
>         at  
> org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java: 
> 1670)
>         at  
> org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java: 
> 1661)
>         at FFMParser.file(FFMParser.java:127)
>         at CSVTest.main(CSVTest.java:33)
>
> Is there any suggestion so that program can generate 1GB file?
>
> 1)       Having multiple templates, each template generates small  
> string, then write the small strings to file.
> My input has format: ((Part1) (Part2)+ (Part3)). For each part2,  
> there is an xml element in the output. I can have 3 templates here.  
> In Antlr action, I will write each part to file when parsing is done  
> for the part.
>
> 2)       Any template engine that could write to file directly,  
> instead of returning a string...? (This might not be proper to  
> discussed here :D)
>
> I hope problem is stated clearly. Please let me know if you need  
> more information. Any suggestion is much appreciated. Thank you.
> Regards,
> Helen
>
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091017/d0ed042b/attachment.html 

From cmundi at gmail.com  Sat Oct 17 10:28:42 2009
From: cmundi at gmail.com (C. Mundi)
Date: Sat, 17 Oct 2009 10:28:42 -0700
Subject: [antlr-interest] Which version do I need for a CSharp target
	and VS 2008
Message-ID: <e794390910171028s8afe96pc03ecb890186afad@mail.gmail.com>

Sam Harwell : I apologize for mis-spelling your name in this thread.
I failed to notice that my mail client decided your name was "wrong"
before I hit send.'  Sorry about that!

Kyle


On 10/17/09, kferrio at gmail.com <kferrio at gmail.com> wrote:
> I've also been waiting and watching, reluctant to ask a question which might
> sound like prodding.  I have glanced at Sam Harrell's code in version
> control, and it appears to be written to very high internal best practices.
> This is not to say anything against the existing CSharp2 runtime, which is
> also excellent.  Choices are good, and this is one I look forward to having.
>
> Kyle
>
> Sent from my Verizon Wireless BlackBerry
>
> -----Original Message-----
> From: "Jim Idle" <jimi at temporal-wave.com>
> Date: Sun, 18 Oct 2009 09:37:59
> To: antlr-interest at antlr.org<antlr-interest at antlr.org>
> Subject: Re: [antlr-interest] Which version do I need for a CSharp target
> 	and VS 2008
>
> Not sure if the Csharp3 target is ready for production yet - I wanted to ask
> this myself as I would like to switch to it if it is ;-)
>
> But I use Csharp2 as the target, and the runtime is on the download pages.
>
> Jim
>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Robert van der Hulst
>> Sent: Friday, October 16, 2009 9:41 PM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] Which version do I need for a CSharp target
>> and VS 2008
>>
>> I am using Antlr 2.7.6 (CPP target) at this moment for our Language
>> project.
>>
>> I  need  to  do make some serious changes, so I am considering to move
>> the project to Antlr 3 and a CSharp
>>
>> Which version do people recommend that I should use.
>>
>> I looked at the Antlr website and found two options:
>>
>> - CSharp
>> - CSharp3
>>
>> but  I  am  not  sure  if they are both available for the latest Antlr
>> build.
>>
>> Which one do you recommend ?
>>
>> I   would   also  like  to have a binary that does not need Java (like
>> there is for Antlr 2). Does that exist ?
>>
>> Finally:  Who has experience using Antlr in a VS 2008 environment (and
>> setting up the necessary MsBuild steps to automate the build process)?
>>
>> --
>> Robert van der Hulst
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From JALuber at gmx.de  Sat Oct 17 10:48:47 2009
From: JALuber at gmx.de (Johannes Luber)
Date: Sat, 17 Oct 2009 19:48:47 +0200
Subject: [antlr-interest] Which version do I need for a CSharp
 target	and VS 2008
In-Reply-To: <d51d8b651df9c44eb15d8ef4106931a1@temporal-wave.com>
References: <d51d8b651df9c44eb15d8ef4106931a1@temporal-wave.com>
Message-ID: <20091017174847.325640@gmx.net>

> Not sure if the Csharp3 target is ready for production yet - I wanted to
> ask this myself as I would like to switch to it if it is ;-)
> 
> But I use Csharp2 as the target, and the runtime is on the download pages.
> 
> Jim

First off, CSharp, CSharp2 and CSharp3 are all different targets, although CSharp and CSharp2 share a lot implementationwise. That being said, don't use CSharp, as it will be removed for the 3.2 update. CSharp2 will have its public interface changed (basically simple renames) to align it to one of CSharp3. So if you want save 5 minutes you could start out with CSharp3 - BUT I don't know about bugs lurking in that implementation.

CSharp3 is being used in ST 3.2, in a C# port of ANLTR and the maintainer's internal projects, so I'd take it as a big clue that it does work sufficiently in those cases. Still CSharp3 lacks the kind of exposure CSharp2 has (which is used in e.g. NHibernate). Considering that the longterm plan is to obsolete CSharp2 in favor of CSharp3 you might want to try it out now.

Johannes
> 
> > -----Original Message-----
> > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > bounces at antlr.org] On Behalf Of Robert van der Hulst
> > Sent: Friday, October 16, 2009 9:41 PM
> > To: antlr-interest at antlr.org
> > Subject: [antlr-interest] Which version do I need for a CSharp target
> > and VS 2008
> > 
> > I am using Antlr 2.7.6 (CPP target) at this moment for our Language
> > project.
> > 
> > I  need  to  do make some serious changes, so I am considering to move
> > the project to Antlr 3 and a CSharp
> > 
> > Which version do people recommend that I should use.
> > 
> > I looked at the Antlr website and found two options:
> > 
> > - CSharp
> > - CSharp3
> > 
> > but  I  am  not  sure  if they are both available for the latest Antlr
> > build.
> > 
> > Which one do you recommend ?
> > 
> > I   would   also  like  to have a binary that does not need Java (like
> > there is for Antlr 2). Does that exist ?
> > 
> > Finally:  Who has experience using Antlr in a VS 2008 environment (and
> > setting up the necessary MsBuild steps to automate the build process)?
> > 
> > --
> > Robert van der Hulst
> > 
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> > email-address
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-- 
GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01

From kferrio at gmail.com  Sat Oct 17 11:10:07 2009
From: kferrio at gmail.com (Kyle Ferrio)
Date: Sat, 17 Oct 2009 11:10:07 -0700
Subject: [antlr-interest] "No Past Experience Required"
In-Reply-To: <C6FED743.8DC%horst.dehmer@inode.at>
References: <5d97c170910161428w8022bd2sd9ea6117525e6320@mail.gmail.com>
	<C6FED743.8DC%horst.dehmer@inode.at>
Message-ID: <4608cec10910171110i7517dc29v78b7d15bf62df556@mail.gmail.com>

On Fri, Oct 16, 2009 at 5:06 PM, Horst Dehmer <horst.dehmer at inode.at> wrote:

> Hello Peter,
>
> i myself am not too familiar with ANTLR 3 (and parser generators in
> general)
> and for that reason i feel tempted to try to give some answers.
>
> A symbol is a 'word' in a grammar, like a word in a natural language. A
> symbol can be a terminal (symbol) which can no further be 'reduced', like
> reserved words in a programming language: 'for', 'while', 'if'... You get
> the picture. Non-terminals are the left side of a grammar (production)
> rule.
> Non-terminals are reduced during parsing according to the defined grammar
> and the stream of available tokens.
>
> A lexer usually takes a character stream as an input and converts it in a
> stream of tokens. The characters 'f', 'o', 'r', ' ', '(' for example become
> the tokens 'for' and '('. In the old times (and still today with certain
> lexers) lexer rules were defined just by regular expressions, which
> restricts the class of what can be recognized by a parser pretty much
> compared to ANTLR.
>
> The parser takes a token stream as a input and tries to recognize a higher
> level order. Think of it as sentences of a language following a certain
> grammar. The rules which make up a parser grammar are usually much more
> complex than lexer rules. (E)BNF can not be expressed by regular
> expression.
>
> LL(k), LL(*) parsers (top-down, results are build by working their way from
> left to right) are classes of parsers which are not very popular. I might
> be
> wrong (or to old) but LR parsers are much more common. So maybe have a
> quick
> look at lex/yacc. For me that's the father of all parser generators (for
> C).
>
> Predicates (syntactic and semantic) help a LL parser determine which 'way
> to
> go' or which alternatives to ignore. I guess they are quite unique to LL
> parsers which have the "problem" with left-recursion or common prefix,
> which
> really is no problem once you got your head around it.
>
> For what it's worth: i would not start with ANTLR to build my first
> grammars. The documentation is far too sophisticated for my taste and you
> definitivly have to have some experiences to get started. If you don't know
> what to look for even the book is useless. Don't get me wrong ANTLR 3 is a
> very powerful and reliable tool, but before you use it make sure you really
> need it. If you'd like to stick to ANTLR, have a look at the example
> grammars. There are lots of 'em around and they give good hints on how to
> solve promlems.
>
> And last but not least, if you are really interested in things, read the
> Dragon Book: Principles of Compiler Design, by Alfred Aho and Jeffrey D.
> Ullman
>
> Regards,
>
> Horst
>
> PS: For those recognizing my errors and misunderstandings, help Peter to
> get
> going.
>
>
> On 16.10.09 23:28, "Peter Boughton" <boughtonp at gmail.com> wrote:
>
> > Hi all,
> >
> > I'm looking to figure out ANTLR and so I'm reading this page:
> >
> http://www.antlr.org/wiki/display/ANTLR3/Quick+Starter+on+Parser+Grammars+-+No
> > +Past+Experience+Required
> >
> > But there are a number of things I'm stuck on - and so I'm asking here
> > for both a good explanation and so that someone with edit permission
> > can hopefully update the wiki page to actually be "no past experience"
> > and more helpful for future newbies.
> >
> >
> > "Left recursion."
> > Maybe it's me being dim, but it took me a while to figure how "a : a B
> > | C ;" translated to "a : C B*;" - and whilst I get it now, perhaps a
> > quick sentence to explain the transition might be helpful for the wiki
> > page?
> >
> >
> > "syntactic predicates"
> > So, they're an advanced category discussed in a book... yippee! I
> > don't have the book, and the absolute earliest I could get it (if I
> > choose to) is Tuesday, so that's not particularly helpful. If they're
> > going to be mentioned, they should at least have a brief explanation
> > of when they apply, and preferably a link to an online resource that
> > covers them.
> > (I tried reading the Wikipedia article, but that waffles on without
> > being very helpful.)
> >
> > Can anyone provide [a link to] a good, concise definition of syntactic
> > predicates and semantic predicates and any other terms like this - for
> > that matter, is there a good online glossary for all this sort of
> > compiler/parser related stuff?
> >
> >
> > "Difference between lexer and parser rules"
> > This whole paragraph leaves me going "wha?". I don't know what the
> > difference between a lexer and a parser is, so attempting to explain
> > the difference between their rules doesn't mean much yet.
> >
> > There's a vague suggestion that lexers look at literals (whether
> > explicit or combined via multiple rules), and parsers look at
> > everything else, but even then I'm not sure I get the implications of
> > that?
> >
> > What's a symbolic name?
> >
> > In the example, what does the "EQUALS='=';" syntax do? Should that be
> > a colon, or is something else happening?
> > What about IMAGINERY_TOKEN - what's that doing?
> >
> > I'm now confused about tokens and non-terminal symbols - they are
> > obviously different, but how?
> >
> > In the example for "How to build a grammar from a language
> > specification", the FILE rule is not in the tokens section
> > Does that make it a non-terminal symbol?
> > Is this example grammar handled by a lexer or a parser or both?
> >
> >
> > I do have some other questions, but they're not directly related to
> > the wiki page, so I'll leave them for a later email, once I have a
> > better idea of what's what.
> >
> >
> > Thanks,
> >
> > Peter
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


It would be hard to deny that ANTLR has a significant learning curve.  That
might not not too surprising, given what we customarily expect from machine
translation tools.  After all, the clever behaviors we want must come from
someplace.  That said, as someone raised on lex and yacc, I have to admit
that getting my brain wrapped around those tools was just as hard for me.
(A few people who have read the lex/yacc man pages and O'Reilly books might
agree with me.)  If you believe that writing parsers and grammars has the
potential to be hard, then the choice of tool comes down to questions like
the capability and maturity of the tool, the maintainability of your code,
and the availability of high-quality support.

Several tools -- notably lex and yacc -- excel in capability and maturity.
Personally, I find nontrivial grammars created with those tools to be
tedious to maintain and particular brittle with respect to my mistakes
during maintenance activities.  And the ANTLR community benefits from a
wealth of knowledgable and generous folks, to whom I am indebted for much of
my appreciation of ANTLR.   That's my opinion; everyone has to form his own.

Looking at Ales Teska's recently posted ANTLR3 grammar for python (
http://devel-www.cyber.cz/files/python3grammarC.tar.gz) may help form an
opinion.  If you can more or less follow that, there's a good chance you'll
enjoy using ANTLR productively.  I also found Cedric Cuche's Objective-C
grammar (http://antlr.org/grammar/1212699960054/ObjectiveC2ansi.g) very
helpful.  There are plenty of other fine exampes on antlr.org; these are
just a couple which happen to show how easy it can be to write
rich-yet-maintainable grammars with ANTLR.

As always, your mileage may vary.  Every situation has unique
considerations.  Good luck in any event.

Kyle
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091017/6b443d79/attachment.html 

From jimi at temporal-wave.com  Sun Oct 18 23:51:44 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 19 Oct 2009 12:21:44 +0530
Subject: [antlr-interest] How to make a syntactic predicate exit a rule
	completely
In-Reply-To: <56eb2660910171015j23545d90kf83f454d3b271ec7@mail.gmail.com>
Message-ID: <4dcb1f275cac834387e587ed64ce6ffc@temporal-wave.com>

I really think you are beginning to make this way more complicated than it really is. You need to step away from your current pursuit of predicates and so on and go back to fundamentals. You are trying to get the parser to do way more than parser should do. I know it is tempting because it seems that the parser will do a lot of validation for you, but it is (generally) the wrong way. You want your parser to be as simple as possible, accepting anything that is good syntax from a pure string together of tokens point of view, THEN apply semantics to see if anything fails. This way you r parser rules can accept all the clauses that might be correct (as in all syntactically sound combinations), then reject the incorrect ones by semantic analysis. Your parser will be simpler, your users will thank you for the improved error messages and the whole thing will be easier to maintain.

 

Basically if you find yourself in the nitty-gritty like this, you are probably heading down the wrong path or flogging a dead horse ;-) You could use backtracking mode for this, but then your error messages will be even more arbitrary.

 

For the predicate, don't forget that the prediction will still select a rule and try the predicate. Perhaps you could use gated predicates on the 'invocation' of the rule so that it is not 'called' if it won't match, but once you are in a rule you have to do something like this;



r : (pred1)=>rule1

 | (pred2)=>rule2

 | // neither of the above, match nothing

 ;

 

But then you start need to set state flags, test the flags, etc. You soon end up with a lot more work than just using a semantic analysis phase after the initial parse. You will also have to deal with the absence of flags due to syntax errors and so on, whereas if you defer to semantic analysis as a separate phase, then you will be able to rely on a sound syntax.

 

So:

 

1)      Don't try to influence the paths the parser takes - let the tokens do that;

2)      Afterwards, in the tree walk, determine whether the various combinations of clauses are correct, issue good errors here if not;

3)      Generate code (or whatever it is you are doing) in the knowledge that it is all good from here.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Saturday, October 17, 2009 10:45 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to make a syntactic predicate exit a rule completely

 

Ok, so even if all syntactic predicates have failed in a particular rule, that rule is still included as "matched" in that analysis! Is this true or are my tests wrong? This is not what I hoped. I was hoping that upon complete failure of all syntactic predicates in a rule, the rule becomes disregarded, and that "disregarding" is cascaded as far up as possible, and an alternative path is attempted. Is this how it's works, or am I missing something? Or is there a way, using actions, to "force" the exiting of a particular rule as if it had not been matched at all?

 

Many regards,

N



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091019/1122a08d/attachment.html 

From jimi at temporal-wave.com  Sun Oct 18 23:58:14 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 19 Oct 2009 12:28:14 +0530
Subject: [antlr-interest]
	=?iso-8859-1?q?Which_version_do_I_need_for_a_CSh?=
	=?iso-8859-1?q?arp_target=09and_VS_2008?=
In-Reply-To: <20091017174847.325640@gmx.net>
Message-ID: <a4b1cf60d51aa046be1693b0540d0365@temporal-wave.com>

Johannes,

Is there some trick to getting the CSharp2 runtime to behave like Java in error recovery/detection? The MissingToken and extraneous token stuff is never called because the Mismatch() routine is commented out in the runtime. So basically all you ever get is an NVA, whereas Java and C will work ou that a token is missing or extraneous and give better error messages. I can see that the recovery code is there, but it is never invoked? Pointers?

Cheers,

Jim


> -----Original Message-----
> From: Johannes Luber [mailto:JALuber at gmx.de]
> Sent: Saturday, October 17, 2009 11:19 PM
> To: Jim Idle; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Which version do I need for a CSharp
> target and VS 2008
> 
> > Not sure if the Csharp3 target is ready for production yet - I wanted
> to
> > ask this myself as I would like to switch to it if it is ;-)
> >
> > But I use Csharp2 as the target, and the runtime is on the download
> pages.
> >
> > Jim
> 
> First off, CSharp, CSharp2 and CSharp3 are all different targets,
> although CSharp and CSharp2 share a lot implementationwise. That being
> said, don't use CSharp, as it will be removed for the 3.2 update.
> CSharp2 will have its public interface changed (basically simple
> renames) to align it to one of CSharp3. So if you want save 5 minutes
> you could start out with CSharp3 - BUT I don't know about bugs lurking
> in that implementation.
> 
> CSharp3 is being used in ST 3.2, in a C# port of ANLTR and the
> maintainer's internal projects, so I'd take it as a big clue that it
> does work sufficiently in those cases. Still CSharp3 lacks the kind of
> exposure CSharp2 has (which is used in e.g. NHibernate). Considering
> that the longterm plan is to obsolete CSharp2 in favor of CSharp3 you
> might want to try it out now.
> 
> Johannes
> >
> > > -----Original Message-----
> > > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > > bounces at antlr.org] On Behalf Of Robert van der Hulst
> > > Sent: Friday, October 16, 2009 9:41 PM
> > > To: antlr-interest at antlr.org
> > > Subject: [antlr-interest] Which version do I need for a CSharp
> target
> > > and VS 2008
> > >
> > > I am using Antlr 2.7.6 (CPP target) at this moment for our Language
> > > project.
> > >
> > > I  need  to  do make some serious changes, so I am considering to
> move
> > > the project to Antlr 3 and a CSharp
> > >
> > > Which version do people recommend that I should use.
> > >
> > > I looked at the Antlr website and found two options:
> > >
> > > - CSharp
> > > - CSharp3
> > >
> > > but  I  am  not  sure  if they are both available for the latest
> Antlr
> > > build.
> > >
> > > Which one do you recommend ?
> > >
> > > I   would   also  like  to have a binary that does not need Java
> (like
> > > there is for Antlr 2). Does that exist ?
> > >
> > > Finally:  Who has experience using Antlr in a VS 2008 environment
> (and
> > > setting up the necessary MsBuild steps to automate the build
> process)?
> > >
> > > --
> > > Robert van der Hulst
> > >
> > >
> > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > Unsubscribe: http://www.antlr.org/mailman/options/antlr-
> interest/your-
> > > email-address
> >
> >
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-
> address
> 
> --
> GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
> Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01




From naveen.chwl at googlemail.com  Sun Oct 18 06:28:16 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Sun, 18 Oct 2009 14:28:16 +0100
Subject: [antlr-interest] How to make a syntactic predicate exit a rule
	completely
In-Reply-To: <4dcb1f275cac834387e587ed64ce6ffc@temporal-wave.com>
References: <56eb2660910171015j23545d90kf83f454d3b271ec7@mail.gmail.com>
	<4dcb1f275cac834387e587ed64ce6ffc@temporal-wave.com>
Message-ID: <56eb2660910180628y5f2dac6bnbb184c954fcd79d8@mail.gmail.com>

Dear Jim,

I agree with you. I am on what I believe to be the last "hurdle" of my
grammar:

(simplified)

grammar conjunctive;    //using ANTLRWorks

englishSentence : (adverbPhrase ','?)* simpleSentence;
           adverbPhrase: 'con' simpleSentence | prepPhr;

           simpleSentence : nounPhrase verbPhrase;

                       nounPhrase: ('noun' prepPhr)=> 'noun' prepPhr |
'noun';

                                  prepPhr: 'prep' nounPhrase;

                       verbPhrase: 'verb' complement? adverbPhrase?;

                                   complement: (object object)=> object
object | object;

                                               object:
nounPhrase;

Problem sentence: "con noun verb noun verb" SHOULD give adverbPhrase
simpleSentence (but doesn't, instead consuming the second "noun" as a
*complement* to the verbPhrase, leaving an impossible simpleSentence)

My proposed solution was: Make sure that for something to be an "object", it
must not be followed by a verbPhrase. This is so that it is not consumed by
a possible *complement?*, IF it is part of a new simpleSentence (i.e. if it
is the subject of a sentence).
I believe my entire grammar is completed, as soon as this problem is fixed.

2009/10/19 Jim Idle <jimi at temporal-wave.com>

>  I really think you are beginning to make this way more complicated than
> it really is. You need to step away from your current pursuit of predicates
> and so on and go back to fundamentals. You are trying to get the parser to
> do way more than parser should do. I know it is tempting because it seems
> that the parser will do a lot of validation for you, but it is (generally)
> the wrong way. You want your parser to be as simple as possible, accepting
> anything that is good syntax from a pure string together of tokens point of
> view, THEN apply semantics to see if anything fails. This way you r parser
> rules can accept all the clauses that might be correct (as in all
> syntactically sound combinations), then reject the incorrect ones by
> semantic analysis. Your parser will be simpler, your users will thank you
> for the improved error messages and the whole thing will be easier to
> maintain.
>
>
>
> Basically if you find yourself in the nitty-gritty like this, you are
> probably heading down the wrong path or flogging a dead horse ;-) You could
> use backtracking mode for this, but then your error messages will be even
> more arbitrary.
>
>
>
> For the predicate, don?t forget that the prediction will still select a
> rule and try the predicate. Perhaps you could use gated predicates on the
> ?invocation? of the rule so that it is not ?called? if it won?t match, but
> once you are in a rule you have to do something like this;
>
> r : (pred1)=>rule1
>
>  | (pred2)=>rule2
>
>  | // neither of the above, match nothing
>
>  ;
>
>
>
> But then you start need to set state flags, test the flags, etc. You soon
> end up with a lot more work than just using a semantic analysis phase after
> the initial parse. You will also have to deal with the absence of flags due
> to syntax errors and so on, whereas if you defer to semantic analysis as a
> separate phase, then you will be able to rely on a sound syntax.
>
>
>
> So:
>
>
>
> 1)      Don?t try to influence the paths the parser takes ? let the tokens
> do that;
>
> 2)      Afterwards, in the tree walk, determine whether the various
> combinations of clauses are correct, issue good errors here if not;
>
> 3)      Generate code (or whatever it is you are doing) in the knowledge
> that it is all good from here.
>
>
>
> Jim
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Saturday, October 17, 2009 10:45 PM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] How to make a syntactic predicate exit a rule
> completely
>
>
>
> Ok, so even if all syntactic predicates have failed in a particular
> rule, that rule is still included as "matched" in that analysis! Is this
> true or are my tests wrong? This is not what I hoped. I was hoping that upon
> complete failure of all syntactic predicates in a rule, the rule becomes
> disregarded, and that "disregarding" is cascaded as far up as possible, and
> an alternative path is attempted. Is this how it's works, or am I missing
> something? Or is there a way, using actions, to "force" the exiting of a
> particular rule as if it had not been matched at all?
>
>
>
> Many regards,
>
> N
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/f8eba0bc/attachment.html 

From JALuber at gmx.de  Sun Oct 18 11:37:31 2009
From: JALuber at gmx.de (Johannes Luber)
Date: Sun, 18 Oct 2009 20:37:31 +0200
Subject: [antlr-interest] Which version do I need for a CSharp
 target	and VS 2008
In-Reply-To: <a4b1cf60d51aa046be1693b0540d0365@temporal-wave.com>
References: <a4b1cf60d51aa046be1693b0540d0365@temporal-wave.com>
Message-ID: <20091018183731.259330@gmx.net>

> Johannes,
> 
> Is there some trick to getting the CSharp2 runtime to behave like Java in
> error recovery/detection? The MissingToken and extraneous token stuff is
> never called because the Mismatch() routine is commented out in the runtime.
> So basically all you ever get is an NVA, whereas Java and C will work ou
> that a token is missing or extraneous and give better error messages. I can
> see that the recovery code is there, but it is never invoked? Pointers?
> 
> Cheers,
> 
> Jim

Do I understand correctly that there is some inconsistency between the runtimes? I've looked into BaseRecognizer.java and I can't find mismatch() there. Where is the missing code based in Java?

Johannes
> 
> 
> > -----Original Message-----
> > From: Johannes Luber [mailto:JALuber at gmx.de]
> > Sent: Saturday, October 17, 2009 11:19 PM
> > To: Jim Idle; antlr-interest at antlr.org
> > Subject: Re: [antlr-interest] Which version do I need for a CSharp
> > target and VS 2008
> > 
> > > Not sure if the Csharp3 target is ready for production yet - I wanted
> > to
> > > ask this myself as I would like to switch to it if it is ;-)
> > >
> > > But I use Csharp2 as the target, and the runtime is on the download
> > pages.
> > >
> > > Jim
> > 
> > First off, CSharp, CSharp2 and CSharp3 are all different targets,
> > although CSharp and CSharp2 share a lot implementationwise. That being
> > said, don't use CSharp, as it will be removed for the 3.2 update.
> > CSharp2 will have its public interface changed (basically simple
> > renames) to align it to one of CSharp3. So if you want save 5 minutes
> > you could start out with CSharp3 - BUT I don't know about bugs lurking
> > in that implementation.
> > 
> > CSharp3 is being used in ST 3.2, in a C# port of ANLTR and the
> > maintainer's internal projects, so I'd take it as a big clue that it
> > does work sufficiently in those cases. Still CSharp3 lacks the kind of
> > exposure CSharp2 has (which is used in e.g. NHibernate). Considering
> > that the longterm plan is to obsolete CSharp2 in favor of CSharp3 you
> > might want to try it out now.
> > 
> > Johannes
> > >
> > > > -----Original Message-----
> > > > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > > > bounces at antlr.org] On Behalf Of Robert van der Hulst
> > > > Sent: Friday, October 16, 2009 9:41 PM
> > > > To: antlr-interest at antlr.org
> > > > Subject: [antlr-interest] Which version do I need for a CSharp
> > target
> > > > and VS 2008
> > > >
> > > > I am using Antlr 2.7.6 (CPP target) at this moment for our Language
> > > > project.
> > > >
> > > > I  need  to  do make some serious changes, so I am considering to
> > move
> > > > the project to Antlr 3 and a CSharp
> > > >
> > > > Which version do people recommend that I should use.
> > > >
> > > > I looked at the Antlr website and found two options:
> > > >
> > > > - CSharp
> > > > - CSharp3
> > > >
> > > > but  I  am  not  sure  if they are both available for the latest
> > Antlr
> > > > build.
> > > >
> > > > Which one do you recommend ?
> > > >
> > > > I   would   also  like  to have a binary that does not need Java
> > (like
> > > > there is for Antlr 2). Does that exist ?
> > > >
> > > > Finally:  Who has experience using Antlr in a VS 2008 environment
> > (and
> > > > setting up the necessary MsBuild steps to automate the build
> > process)?
> > > >
> > > > --
> > > > Robert van der Hulst
> > > >
> > > >
> > > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > > Unsubscribe: http://www.antlr.org/mailman/options/antlr-
> > interest/your-
> > > > email-address
> > >
> > >
> > >
> > >
> > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > Unsubscribe:
> > > http://www.antlr.org/mailman/options/antlr-interest/your-email-
> > address
> > 
> > --
> > GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
> > Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01
> 
> 

-- 
GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01

From naveen.chwl at googlemail.com  Sun Oct 18 11:45:04 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Sun, 18 Oct 2009 19:45:04 +0100
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <4AD8FDC1.3040705@jacaranda.org>
References: <7086EEA5-93DF-4D8B-9D8D-26ED5A1519E5@wentworth.bz>
	<4AD8E0D5.4090907@smartshift.de> <4AD8E734.3080603@smartshift.de>
	<4AD8FDC1.3040705@jacaranda.org>
Message-ID: <56eb2660910181145r3a0ba2afmcda6654cadffaead@mail.gmail.com>

Yes, I alluded to that in another thread, "How to make a syntactic predicate
exit a rule completely". I am a beginner in this area, but I think that what
you said is true of syntactic predicates as well. I think it would make
ANTLR more powerful, if this feature existed (of not matching a rule if all
or the only predicate(s) fail in it), but as Jim pointed out, there could be
problems such as bad development practices. If you do use predicates,
it would seem more intuitive to work that way.

2009/10/17 David-Sarah Hopwood david-sarah at jacaranda.org



> I think we have to interpret this as an ANTLR bug, not the grammar writer
> being confused. Conceptually, a gated semantic predicate with a single
> alternative has a clear meaning: if the predicate fails then it should be
> equivalent to a rule that never matches. It would be very strange for it
> to mean anything else.
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/8bd21baa/attachment.html 

From sharwell at pixelminegames.com  Sun Oct 18 12:02:47 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Sun, 18 Oct 2009 14:02:47 -0500
Subject: [antlr-interest] Which version do I need for a CSharp targetand
	VS 2008
References: <e794390910171028s8afe96pc03ecb890186afad@mail.gmail.com>
Message-ID: <DD5A5D428FE040429CCDF377FAA892840152DDDC@martini.ironwillgames.com>

I didn't even notice. :)

Also, feel free to prod any time you don't get an answer. I don't take
offense - my day to day is pretty crazy since I'm a grad student so
things slip around all the time. If you don't want to prod on the list,
you can always send me messages directly.

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of C. Mundi
Sent: Saturday, October 17, 2009 12:29 PM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Which version do I need for a CSharp
targetand VS 2008

Sam Harwell : I apologize for mis-spelling your name in this thread.
I failed to notice that my mail client decided your name was "wrong"
before I hit send.'  Sorry about that!

Kyle


From sharwell at pixelminegames.com  Sun Oct 18 12:34:54 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Sun, 18 Oct 2009 14:34:54 -0500
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports of
	ANTLR and StringTemplate
Message-ID: <DD5A5D428FE040429CCDF377FAA892840152DDDD@martini.ironwillgames.com>

Hi everyone,

 

Here's a status update that I know many people are asking for. For each
portion, I'll talk about the status of the code in Perforce. At the end,
I'll talk about the status of the posted binaries.

 

Basic Status

 

StringTemplate and the ANTLR Tool: Up-to-date with the Java version for
all targets as of August 4, 2009, which covers all of the changes made
earlier in the year and over the summer.

 

CSharp3 Target: working and extensively used in the ANTLR Tool,
StringTemplate, and the commercial projects I use ANTLR for. I haven't
tested the -profile and -debug modes because I don't use them, however
the templates should be "close to working". Currently, the CSharp3
target can only be used when generating grammars from the C# port of the
tool.

 

Design Changes

 

1.       Rather than package the target templates as resources in the
tool's executable, I've chosen a flat file layout. That way, the
templates for a target can be updated without recompiling the tool. The
targets themselves are also implemented as individual DLL's.

2.       The CSharp3 target declares rules as private methods by
default. Rules can be made public by simply marking them as such in the
grammar: "public compile_unit : declaration*;" I have updated the Java
target's code generation to support this as well, but it's not checked
in.

3.       StringTemplate has code for a high speed dynamically compiled
interpreter. By default, the build doesn't enable this mode, but when
it's turned on the output appears to work correctly. I need to do
another round of tests, but at this point the C# ports of the ANTLR Tool
and StringTemplate should be significantly faster than the Java version.
We've hit a brick wall preventing further optimization without rewriting
ST, but the work on STv4 should give another order of magnitude
improvement in template rendering performance.

 

Things Holding Me Up

 

1.       I haven't finalized the way I'm going to do assembly
versioning, although I think I've got that worked out now. I'll send a
separate mail to the list regarding this.

2.       StringTemplate is only tested in regards to code generation for
the ANTLR tool. In particular, its ability to locate templates in
resources or on the file system is not documented and may or may not
behave as people expect.

3.       I'm still making periodic changes to the API as I finalize
things, and breaking changes in production code aren't good. I don't
want to suggest replacing the CSharp2 target until the CSharp3 target is
more tested by other people.

 

Things I want to do, but not really holding up the builds

 

I really want to package a clean integration of ANTLR+CSharp3 for
MSBuild. We need this. This would include at least MSBuild targets file
and templates for adding grammars to a project. Unfortunately, there are
many issues I still need to resolve for this to be a reality, most of
which have answers in shades of gray.

 

Status of the Posted Build

 

The build available for download was uploaded on fairly short notice.
Mistakes (by me) included not having the assembly version set correctly
and not posting the source code from the build with the binaries. I've
been trying to wrap some of these things up before posting another
build.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/2fa7c83d/attachment.html 

From jeffreycameron at gmail.com  Sun Oct 18 14:01:57 2009
From: jeffreycameron at gmail.com (Jeffrey Cameron)
Date: Sun, 18 Oct 2009 17:01:57 -0400
Subject: [antlr-interest] Combining multiple tokens
Message-ID: <b86c7fa10910181401t2172c81fp81c028d39908db80@mail.gmail.com>

I have two parser rules in my grammar where I am trying to wrap the
complete, concatenated text of a series of tokens into a single token for a
tree grammar.  The rules look like this:
*#1:*

cell : (~(VBAR|EOL))* ;

in this case I would like to write something like this:

cell : (~(VBAR|EOL))* -> TABLECELL[$cell.text] ;

but when I put that syntax in I get an exception.

*#2:*

line_to_eol : ( options {greedy=false;} : . )* EOL ;

I would like to do something like the same as above but ignore the EOL
token, so something like this:

line_to_eol : stuff+=( options {greedy=false;} : . )* EOL ->
TEXT[$stuff.text] ;

Can someone tell me when I am doing wrong in here and how to correct it? I'm
a bit stuck here and every other part of my grammar is working as expected.

Thanks in advance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/6cc791b2/attachment.html 

From yurushkin at rambler.ru  Sun Oct 18 14:07:08 2009
From: yurushkin at rambler.ru (=?windows-1251?B?zOj14OjrIN7w8/jq6O0=?=)
Date: Mon, 19 Oct 2009 01:07:08 +0400
Subject: [antlr-interest] [c target] memory leaks during error recovery
Message-ID: <429405675.1255900028.26223784.8256@mcgi62.rambler.ru>

Good day,
I have the rule

myRule[returns Type1 res] :
 rule1, rule2, rule3, rule4... ruleN { res = f($rule1, $rule2,..., ,
$ruleN) }
 ;

it's all ok.
BUT if ruleN will fire exception, rule1, rule2.. rule(N-1) subtrees will
be forgotten!!!
How can I manage such situations?? can you write me right code for such
rule, that gives answer on my question?
thanks

PS: I tried to use "catch" attribute .. but it needs errorCode. It's not
good, because there're may be different errors.

--
Best regards,
Michael

From gwlist at grahamwideman.com  Sun Oct 18 14:24:42 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Sun, 18 Oct 2009 14:24:42 -0700
Subject: [antlr-interest] Combining multiple tokens
In-Reply-To: <b86c7fa10910181401t2172c81fp81c028d39908db80@mail.gmail.co
 m>
Message-ID: <4.1.20091018142036.016d4248@grahamwideman.com>

I'm not entirely sure I understand the particulars of what you're trying to do
but...

At 10/18/2009 05:01 PM, Jeffrey Cameron wrote: 
>
> I have two parser rules in my grammar where I am trying to wrap the complete,
> concatenated text of a series of tokens into a single token for a tree
> grammar.  The rules look like this:
>
> #1:
>
> cell : (~(VBAR|EOL))* ;
>
> in this case I would like to write something like this:
>
> cell : (~(VBAR|EOL))* -> TABLECELL[$cell.text] ;


I think you probably want syntax that's more like:

-> ^(TABLECELL, $cell)

See:
http://www.antlr.org/wiki/display/ANTLR3/Tree+construction

If that doesn't get you going, it might be good to post clarifying:

> I am trying to wrap the complete, concatenated text 
> of a series of tokens into a single token for a tree grammar.

... are you are writing this *in* a tree grammar, or in a combined grammar
trying to produce a tree?  Also describe what actual errors you are seeing.

-- Graham
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/2cfbab19/attachment.html 

From naveen.chwl at googlemail.com  Sun Oct 18 16:23:11 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 19 Oct 2009 00:23:11 +0100
Subject: [antlr-interest] How to make a syntactic predicate exit a rule
	completely
In-Reply-To: <56eb2660910180628y5f2dac6bnbb184c954fcd79d8@mail.gmail.com>
References: <56eb2660910171015j23545d90kf83f454d3b271ec7@mail.gmail.com>
	<4dcb1f275cac834387e587ed64ce6ffc@temporal-wave.com>
	<56eb2660910180628y5f2dac6bnbb184c954fcd79d8@mail.gmail.com>
Message-ID: <56eb2660910181623k8a8f7efx1f2563d1bb05619d@mail.gmail.com>

Dear Jim,

I've solved it!

I did so as follows:

 (simplified)

grammar conjunctive;    //using ANTLRWorks

englishSentence : (adverbPhrase ','?)* simpleSentence;
           adverbPhrase: 'con' simpleSentence | prepPhr;

           simpleSentence : nounPhrase verbPhrase;

                       nounPhrase: ('noun' prepPhr)=> 'noun' prepPhr |
'noun';

                                  prepPhr: 'prep' nounPhrase;

                       //rule changed
                       verbPhrase: ('verb' object object? verbPhrase)=>
'verb' adverbPhrase? | 'verb' complement? adverbPhrase?;

                                   complement: (object object)=> object
object | object;

                                               object: nounPhrase;

Which is to say that "if the verb is followed by an object (or two) but then
followed by a verbPhrase, discount the fact that there may be a complement
for that verb, otherwise act normally as though there might".  It doesn't
handle two *objects* properly but I can easily do that now.

My entire English structure grammar is done now I believe, subject to
further tests. You helped clarify some things.


2009/10/18 Naveen Chawla <naveen.chwl at googlemail.com>

> Dear Jim,
>
> I agree with you. I am on what I believe to be the last "hurdle" of my
> grammar:
>
> (simplified)
>
> grammar conjunctive;    //using ANTLRWorks
>
> englishSentence : (adverbPhrase ','?)* simpleSentence;
>            adverbPhrase: 'con' simpleSentence | prepPhr;
>
>            simpleSentence : nounPhrase verbPhrase;
>
>                        nounPhrase: ('noun' prepPhr)=> 'noun' prepPhr |
> 'noun';
>
>                                   prepPhr: 'prep' nounPhrase;
>
>                        verbPhrase: 'verb' complement? adverbPhrase?;
>
>                                    complement: (object object)=> object
> object | object;
>
>                                                object:
> nounPhrase;
>
> Problem sentence: "con noun verb noun verb" SHOULD give adverbPhrase
> simpleSentence (but doesn't, instead consuming the second "noun" as a
> *complement* to the verbPhrase, leaving an impossible simpleSentence)
>
> My proposed solution was: Make sure that for something to be an "object",
> it must not be followed by a verbPhrase. This is so that it is not consumed
> by a possible *complement?*, IF it is part of a new simpleSentence (i.e. if
> it is the subject of a sentence).
> I believe my entire grammar is completed, as soon as this problem is fixed.
>
> 2009/10/19 Jim Idle <jimi at temporal-wave.com>
>
>>    I really think you are beginning to make this way more complicated
>> than it really is. You need to step away from your current pursuit of
>> predicates and so on and go back to fundamentals. You are trying to get the
>> parser to do way more than parser should do. I know it is tempting because
>> it seems that the parser will do a lot of validation for you, but it is
>> (generally) the wrong way. You want your parser to be as simple as possible,
>> accepting anything that is good syntax from a pure string together of tokens
>> point of view, THEN apply semantics to see if anything fails. This way you r
>> parser rules can accept all the clauses that might be correct (as in all
>> syntactically sound combinations), then reject the incorrect ones by
>> semantic analysis. Your parser will be simpler, your users will thank you
>> for the improved error messages and the whole thing will be easier to
>> maintain.
>>
>>
>>
>> Basically if you find yourself in the nitty-gritty like this, you are
>> probably heading down the wrong path or flogging a dead horse ;-) You could
>> use backtracking mode for this, but then your error messages will be even
>> more arbitrary.
>>
>>
>>
>> For the predicate, don?t forget that the prediction will still select a
>> rule and try the predicate. Perhaps you could use gated predicates on the
>> ?invocation? of the rule so that it is not ?called? if it won?t match, but
>> once you are in a rule you have to do something like this;
>>
>> r : (pred1)=>rule1
>>
>>  | (pred2)=>rule2
>>
>>  | // neither of the above, match nothing
>>
>>  ;
>>
>>
>>
>> But then you start need to set state flags, test the flags, etc. You soon
>> end up with a lot more work than just using a semantic analysis phase after
>> the initial parse. You will also have to deal with the absence of flags due
>> to syntax errors and so on, whereas if you defer to semantic analysis as a
>> separate phase, then you will be able to rely on a sound syntax.
>>
>>
>>
>> So:
>>
>>
>>
>> 1)      Don?t try to influence the paths the parser takes ? let the
>> tokens do that;
>>
>> 2)      Afterwards, in the tree walk, determine whether the various
>> combinations of clauses are correct, issue good errors here if not;
>>
>> 3)      Generate code (or whatever it is you are doing) in the knowledge
>> that it is all good from here.
>>
>>
>>
>> Jim
>>
>>
>>
>> *From:* antlr-interest-bounces at antlr.org [mailto:
>> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
>> *Sent:* Saturday, October 17, 2009 10:45 PM
>> *To:* antlr-interest at antlr.org
>> *Subject:* [antlr-interest] How to make a syntactic predicate exit a rule
>> completely
>>
>>
>>
>> Ok, so even if all syntactic predicates have failed in a particular
>> rule, that rule is still included as "matched" in that analysis! Is this
>> true or are my tests wrong? This is not what I hoped. I was hoping that upon
>> complete failure of all syntactic predicates in a rule, the rule becomes
>> disregarded, and that "disregarding" is cascaded as far up as possible, and
>> an alternative path is attempted. Is this how it's works, or am I missing
>> something? Or is there a way, using actions, to "force" the exiting of a
>> particular rule as if it had not been matched at all?
>>
>>
>>
>> Many regards,
>>
>> N
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091019/58353daf/attachment.html 

From jimi at temporal-wave.com  Tue Oct 20 00:40:44 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 13:10:44 +0530
Subject: [antlr-interest]
	=?iso-8859-1?q?Which_version_do_I_need_for_a_CSh?=
	=?iso-8859-1?q?arp_target=09and_VS_2008?=
In-Reply-To: <20091018183731.259330@gmx.net>
Message-ID: <cdfb741351c45343bb5b854084008b5c@temporal-wave.com>

Look at the routine Mismatch() (capital M). It is commented out and all that is left seems to be the original recovery/syntax error logic, despite the fact that the routines to detect missing and extraneous tokens are within the class. So Csharp2 never reports anything but syntax error, where the other runtimes will enter the logic to calculate followsets and so on and report accordingly.

If you follow the logic path from a mismatch in Java vs CSharp2, you will see where it diverges. You can do this manually with a small grammar such as:

R : A COMMA B ;

Generate that Java and CSharp2 code and trace the path that would happen if the COMMA was missing ( A B ). 

My feeling is that it is just a minor oversight in what methods are implemented, or something wasn't quite finished off at dome point.

Jim

> -----Original Message-----
> From: Johannes Luber [mailto:JALuber at gmx.de]
> Sent: Monday, October 19, 2009 12:08 AM
> To: Jim Idle; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Which version do I need for a CSharp
> target and VS 2008
> 
> > Johannes,
> >
> > Is there some trick to getting the CSharp2 runtime to behave like
> Java in
> > error recovery/detection? The MissingToken and extraneous token stuff
> is
> > never called because the Mismatch() routine is commented out in the
> runtime.
> > So basically all you ever get is an NVA, whereas Java and C will work
> ou
> > that a token is missing or extraneous and give better error messages.
> I can
> > see that the recovery code is there, but it is never invoked?
> Pointers?
> >
> > Cheers,
> >
> > Jim
> 
> Do I understand correctly that there is some inconsistency between the
> runtimes? I've looked into BaseRecognizer.java and I can't find
> mismatch() there. Where is the missing code based in Java?
> 
> Johannes
> >
> >
> > > -----Original Message-----
> > > From: Johannes Luber [mailto:JALuber at gmx.de]
> > > Sent: Saturday, October 17, 2009 11:19 PM
> > > To: Jim Idle; antlr-interest at antlr.org
> > > Subject: Re: [antlr-interest] Which version do I need for a CSharp
> > > target and VS 2008
> > >
> > > > Not sure if the Csharp3 target is ready for production yet - I
> wanted
> > > to
> > > > ask this myself as I would like to switch to it if it is ;-)
> > > >
> > > > But I use Csharp2 as the target, and the runtime is on the
> download
> > > pages.
> > > >
> > > > Jim
> > >
> > > First off, CSharp, CSharp2 and CSharp3 are all different targets,
> > > although CSharp and CSharp2 share a lot implementationwise. That
> being
> > > said, don't use CSharp, as it will be removed for the 3.2 update.
> > > CSharp2 will have its public interface changed (basically simple
> > > renames) to align it to one of CSharp3. So if you want save 5
> minutes
> > > you could start out with CSharp3 - BUT I don't know about bugs
> lurking
> > > in that implementation.
> > >
> > > CSharp3 is being used in ST 3.2, in a C# port of ANLTR and the
> > > maintainer's internal projects, so I'd take it as a big clue that
> it
> > > does work sufficiently in those cases. Still CSharp3 lacks the kind
> of
> > > exposure CSharp2 has (which is used in e.g. NHibernate).
> Considering
> > > that the longterm plan is to obsolete CSharp2 in favor of CSharp3
> you
> > > might want to try it out now.
> > >
> > > Johannes
> > > >
> > > > > -----Original Message-----
> > > > > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > > > > bounces at antlr.org] On Behalf Of Robert van der Hulst
> > > > > Sent: Friday, October 16, 2009 9:41 PM
> > > > > To: antlr-interest at antlr.org
> > > > > Subject: [antlr-interest] Which version do I need for a CSharp
> > > target
> > > > > and VS 2008
> > > > >
> > > > > I am using Antlr 2.7.6 (CPP target) at this moment for our
> Language
> > > > > project.
> > > > >
> > > > > I  need  to  do make some serious changes, so I am considering
> to
> > > move
> > > > > the project to Antlr 3 and a CSharp
> > > > >
> > > > > Which version do people recommend that I should use.
> > > > >
> > > > > I looked at the Antlr website and found two options:
> > > > >
> > > > > - CSharp
> > > > > - CSharp3
> > > > >
> > > > > but  I  am  not  sure  if they are both available for the
> latest
> > > Antlr
> > > > > build.
> > > > >
> > > > > Which one do you recommend ?
> > > > >
> > > > > I   would   also  like  to have a binary that does not need
> Java
> > > (like
> > > > > there is for Antlr 2). Does that exist ?
> > > > >
> > > > > Finally:  Who has experience using Antlr in a VS 2008
> environment
> > > (and
> > > > > setting up the necessary MsBuild steps to automate the build
> > > process)?
> > > > >
> > > > > --
> > > > > Robert van der Hulst
> > > > >
> > > > >
> > > > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > > > Unsubscribe: http://www.antlr.org/mailman/options/antlr-
> > > interest/your-
> > > > > email-address
> > > >
> > > >
> > > >
> > > >
> > > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > > Unsubscribe:
> > > > http://www.antlr.org/mailman/options/antlr-interest/your-email-
> > > address
> > >
> > > --
> > > GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
> > > Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01
> >
> >
> 
> --
> GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
> Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01




From jimi at temporal-wave.com  Tue Oct 20 00:44:51 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 13:14:51 +0530
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <56eb2660910181145r3a0ba2afmcda6654cadffaead@mail.gmail.com>
Message-ID: <2bad2e33669bd14fabe33cabc02b290b@temporal-wave.com>

I don?t think that there any bugs here. The gated predicates work fine for me (not that that means there are therefore no bugs ;-), but that it is more likely there is a misuse going on somewhere in the grammar).

 

If you think that there is a bug then you should pin it down to a small piece of grammar so that it can be investigated. What usually happens is that the grammar is so ambiguous that the predicates don?t cover all the possibilities and your gate fails? and then what? You might need to put your gate before the reference to the rule rather than within the rule.

 

So, can you provide a small example of gated predicates not doing what you think that they should?

 

Jim

 

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Monday, October 19, 2009 12:15 AM
To: David-Sarah Hopwood
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Semantic predicates

 

Yes, I alluded to that in another thread, "How to make a syntactic predicate exit a rule completely". I am a beginner in this area, but I think that what you said is true of syntactic predicates as well. I think it would make ANTLR more powerful, if this feature existed (of not matching a rule if all or the only predicate(s) fail in it), but as Jim pointed out, there could be problems such as bad development practices. If you do use predicates, it would seem more intuitive to work that way.

2009/10/17 David-Sarah Hopwood david-sarah at jacaranda.org


 

I think we have to interpret this as an ANTLR bug, not the grammar writer
being confused. Conceptually, a gated semantic predicate with a single
alternative has a clear meaning: if the predicate fails then it should be
equivalent to a rule that never matches. It would be very strange for it
to mean anything else.

--
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com <http://davidsarah.livejournal.com/> 



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/e5d34fe2/attachment.html 

From jimi at temporal-wave.com  Tue Oct 20 00:51:25 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 13:21:25 +0530
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports
	of ANTLR and StringTemplate
In-Reply-To: <DD5A5D428FE040429CCDF377FAA892840152DDDD@martini.ironwillgames.com>
Message-ID: <cc529a5754e5204bafd87d397c57b7ba@temporal-wave.com>

Top posting for Sam's benefit ;-)

 

Not being able to use the Csharp3 target from the standard version of the tool is going to be a turn off for many I think L What is it that your port of the tool has that the standard version does not. I know you have posted some of that, but perhaps we can summarize this and see if such things can be absorbed into the standard Java tool? Nobody minds you having your own version of anything because it is open source, but most will want ot use the 'offical' java version of the tool even if they are targeting C#.

 

Thanks for the updates,

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Sam Harwell
Sent: Monday, October 19, 2009 1:05 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports of ANTLR and StringTemplate

 

Hi everyone,

 

Here's a status update that I know many people are asking for. For each portion, I'll talk about the status of the code in Perforce. At the end, I'll talk about the status of the posted binaries.

 

Basic Status

 

StringTemplate and the ANTLR Tool: Up-to-date with the Java version for all targets as of August 4, 2009, which covers all of the changes made earlier in the year and over the summer.

 

CSharp3 Target: working and extensively used in the ANTLR Tool, StringTemplate, and the commercial projects I use ANTLR for. I haven't tested the -profile and -debug modes because I don't use them, however the templates should be "close to working". Currently, the CSharp3 target can only be used when generating grammars from the C# port of the tool.

 

Design Changes

 

1.       Rather than package the target templates as resources in the tool's executable, I've chosen a flat file layout. That way, the templates for a target can be updated without recompiling the tool. The targets themselves are also implemented as individual DLL's.

2.       The CSharp3 target declares rules as private methods by default. Rules can be made public by simply marking them as such in the grammar: "public compile_unit : declaration*;" I have updated the Java target's code generation to support this as well, but it's not checked in.

3.       StringTemplate has code for a high speed dynamically compiled interpreter. By default, the build doesn't enable this mode, but when it's turned on the output appears to work correctly. I need to do another round of tests, but at this point the C# ports of the ANTLR Tool and StringTemplate should be significantly faster than the Java version. We've hit a brick wall preventing further optimization without rewriting ST, but the work on STv4 should give another order of magnitude improvement in template rendering performance.

 

Things Holding Me Up

 

1.       I haven't finalized the way I'm going to do assembly versioning, although I think I've got that worked out now. I'll send a separate mail to the list regarding this.

2.       StringTemplate is only tested in regards to code generation for the ANTLR tool. In particular, its ability to locate templates in resources or on the file system is not documented and may or may not behave as people expect.

3.       I'm still making periodic changes to the API as I finalize things, and breaking changes in production code aren't good. I don't want to suggest replacing the CSharp2 target until the CSharp3 target is more tested by other people.

 

Things I want to do, but not really holding up the builds

 

I really want to package a clean integration of ANTLR+CSharp3 for MSBuild. We need this. This would include at least MSBuild targets file and templates for adding grammars to a project. Unfortunately, there are many issues I still need to resolve for this to be a reality, most of which have answers in shades of gray.

 

Status of the Posted Build

 

The build available for download was uploaded on fairly short notice. Mistakes (by me) included not having the assembly version set correctly and not posting the source code from the build with the binaries. I've been trying to wrap some of these things up before posting another build.

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/96118201/attachment.html 

From jimi at temporal-wave.com  Tue Oct 20 00:55:12 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 13:25:12 +0530
Subject: [antlr-interest] Combining multiple tokens
In-Reply-To: <b86c7fa10910181401t2172c81fp81c028d39908db80@mail.gmail.com>
Message-ID: <24bb54a693d4784382c354e9de3baf30@temporal-wave.com>

All you need do is accumulate the text in a stringbuffer:

 

( s=TOK { sbuf.append($s.text); }) +

 

Then use the string you have accumulated to set the text of an imaginary or even the last TOK (which will be in s).

 

->IMAGINARY[sbuf.toString()]

 

Should work fine.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jeffrey Cameron
Sent: Monday, October 19, 2009 2:32 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Combining multiple tokens

 

I have two parser rules in my grammar where I am trying to wrap the complete, concatenated text of a series of tokens into a single token for a tree grammar.  The rules look like this:

 

#1:

 

cell : (~(VBAR|EOL))* ;

 

in this case I would like to write something like this:

 

cell : (~(VBAR|EOL))* -> TABLECELL[$cell.text] ;

 

but when I put that syntax in I get an exception. 

 

#2:

 

line_to_eol : ( options {greedy=false;} : . )* EOL ;

 

I would like to do something like the same as above but ignore the EOL token, so something like this:

 

line_to_eol : stuff+=( options {greedy=false;} : . )* EOL -> TEXT[$stuff.text] ;

 

Can someone tell me when I am doing wrong in here and how to correct it? I'm a bit stuck here and every other part of my grammar is working as expected.

 

Thanks in advance



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/24c97f3c/attachment.html 

From jimi at temporal-wave.com  Tue Oct 20 00:59:18 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 13:29:18 +0530
Subject: [antlr-interest] [c target] memory leaks during error recovery
In-Reply-To: <429405675.1255900028.26223784.8256@mcgi62.rambler.ru>
Message-ID: <43b4e74754894440b20f0721a1dbbef6@temporal-wave.com>

It is because you are trying to do things while you parse - another reason to build a tree and THEN operate on the tree.

Catch does not need a type in the C target, you can just use:

r:
  Ddddddd
;
catch() { }

(assuming 3.2 of ANTLR).

The other thing you might do is break up your rule list so that exceptions in them do not drop out the whole rule, which is what happens in all targets unless you structure the rules a little. Break things down in to smaller units. The function call overhead (which may not even occur because of inlining) is very small in C.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of ?????? ???????
> Sent: Monday, October 19, 2009 2:37 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] [c target] memory leaks during error recovery
> 
> Good day,
> I have the rule
> 
> myRule[returns Type1 res] :
>  rule1, rule2, rule3, rule4... ruleN { res = f($rule1, $rule2,..., ,
> $ruleN) }
>  ;
> 
> it's all ok.
> BUT if ruleN will fire exception, rule1, rule2.. rule(N-1) subtrees
> will
> be forgotten!!!
> How can I manage such situations?? can you write me right code for such
> rule, that gives answer on my question?
> thanks
> 
> PS: I tried to use "catch" attribute .. but it needs errorCode. It's
> not
> good, because there're may be different errors.
> 
> --
> Best regards,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From stoneyrh at gmail.com  Mon Oct 19 02:32:40 2009
From: stoneyrh at gmail.com (Ronghui Yu)
Date: Mon, 19 Oct 2009 17:32:40 +0800
Subject: [antlr-interest] @after doesn't work for C target
Message-ID: <4ADC3238.5090303@gmail.com>

Hi, All,

I would like to get notification when exiting a rule, but @after action
doesn't work for C target, I wonder if it is the designed behavior. If
yes, is there an alternative approach?

Thank you in advance.

-- 
Ronghui Yu <mailto:stoneyrh at 163.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091019/3bc8222c/attachment.html 

From yurushkin at rambler.ru  Sun Oct 18 14:06:41 2009
From: yurushkin at rambler.ru (yurushkin at rambler.ru)
Date: Mon, 19 Oct 2009 01:06:41 +0400
Subject: [antlr-interest] [c target] memory leaks during error recovery
Message-ID: <20091019154028.D11A4621C8D@mailc.rambler.ru>

good day,
I have the rule

myRule[returns Type1 res] :
	rule1, rule2, rule3, rule4... ruleN { res = f($rule1, $rule2,..., ,
$ruleN) }
	;

it's all ok.
BUT if ruleN will fire exception, rule1, rule2.. rule(N-1) subtrees will
be forgotten!!!
How can I manage such situations?? can you write me right code for such
rule, that gives answer on my question?
thanks

PS: I tried to use "catch" attribute .. but it needs errorCode. It's not
good, because there're may be different errors.

-- 
Best regards,
Michael

From espina.edgar at gmail.com  Mon Oct 19 09:57:07 2009
From: espina.edgar at gmail.com (Edgar Espina)
Date: Mon, 19 Oct 2009 13:57:07 -0300
Subject: [antlr-interest] ANTLR IDE v2.0.0-rc4 released
Message-ID: <92b42db60910190957y3fcc6c4dy8727ba3853219b0b@mail.gmail.com>

ANTLR IDE v2.0.0-rc4 released
http://antlrv3ide.sourceforge.net/

New Features:
 * Add source formatting :D
 * Support ANTLR 3.2
 * Increase max value of the -Xmx option
 * Adding package to output path for custom targets
 * More useful custom targets
 * Default text on dark background (StringTemplate and GUnit editors)

Bugs:
 * Problems with filenames containing whitespace

Thanks,

-- 
edgar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091019/38c88f61/attachment.html 

From kaleb.pederson at gmail.com  Mon Oct 19 11:41:34 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Mon, 19 Oct 2009 11:41:34 -0700
Subject: [antlr-interest] Bug or misunderstanding?: missing attribute
	access on rule scope
In-Reply-To: <1255745291.2920.82.camel@gecko.home.org>
References: <1255745291.2920.82.camel@gecko.home.org>
Message-ID: <f14c01620910191141q3a4780c4hce741f0c1b6f9f6a@mail.gmail.com>

On Fri, Oct 16, 2009 at 7:08 PM, John B. Brodie <jbb at acm.org> wrote:
> On Fri Oct 16 12:21:33 PDT 2009, Kaleb Pederson asked:
>> I'm getting an error that doesn't make any sense, either because I've
>> missed something fundamental or I've stumbled across a bug. I'm doing
>> some type checking within a tree parser. ?I have a plusMinusExpression
>> which can either be a negation or a subtraction expression. ?In order
>> to to check to see which it is, I have `if ($rhs != null)` within my
>> action. ?That line, however, causes the following error:
>>
>> SemanticChecker.g:163:3: missing attribute access on rule scope: rhs
>>
>> The grammar fragment follows:
>>
>> plusMinusExpression returns [Type type]
>> ? ? ? : ? ? ? ^(PLUS lhs=baseExpression rhs=baseExpression) { /*...*/ }
>> ? ? ? ? ? ? ? | ? ? ? ^(MINUS lhs=baseExpression rhs=baseExpression?)
>> ? ? ? ? ? ? ? {
>> ? ? ? ? ? ? ? ? ? ? ? typeChecker.assertIsNumericType($lhs.type);
>> ? ? ? ? ? ? ? ? ? ? ? if ($rhs != null)
>> ? ? ? ? ? ? ? ? ? ? ? {
>> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? typeChecker.assertIsNumericType($rhs.type);
>> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? typeChecker.assertEqualTypes($lhs.type, $rhs.type);
>> ? ? ? ? ? ? ? ? ? ? ? }
>> ? ? ? ? ? ? ? ? ? ? ? $type = $lhs.type;
>> ? ? ? ? ? ? ? }
>> ? ? ? ;
>
> Others in this thread have pointed out that you should use ($rhs.tree != null) in your if statement.
>
> I would like to, respectfully, suggest that you are doing the Wrong Thing(TM) in your action code.
> And it is wrong on two levels - the first mis-use is rather shallow and the second is a rather more
> deeper mis-use.
>
> I mean nothing personal nor pejorative by these comments. I am just trying to point out a couple
> of "better" ways to do the above. And of course "better" is a qualitative assessment unique to each
> reader of this message (e.g. what is "better" to me may not be "better" to you...).

Understood. No offense taken :).

> The first, shallow, mis-use (IMHO) is to not simply let the Tree Walker code decide for you whether
> or not the rhs tree node is present. That is, instead of
>
> ? | ^(MINUS lhs=baseExpression rhs=baseExpression?) { /* figure out what to do */ }
>
> do something like this:
>
> ? | ^(MINUS lhs=baseExpression) { /* handle the 1-arity '-' operator here */ }
> ? | ^(MINUS lhs=baseExpression rhs=baseExpression) { /* handle the 2-arity subtraction here */ }
>
> e.g. the Tree Walker code has to already poke around in your tree in order to determine whether or
> not the rhs is present (as part of its tree pattern matching) --- so let it control the invocation
> of your actions.

Good suggestion.

> The second, i think deeper, mis-use is that you have (apparently) discarded information discovered
> during parsing and AST creation that you could use to guide your subsequent AST processing.
>
> Surely in your Parser the 1-arity '-' appears in a different syntactic context from the 2-arity '-'
> operator ---- so when parsing "a+-b" we know that the '-' must be the 1-arity operator, but when we
> parse "a-b" we know that the '-' must be the 2-arity operator.
>
> So I suggest to you that your Parser should differentiate the MINUS tree --- since, I assert, that
> it already does so as part of the parse --- by creating a different (with imaginary root) node for
> the 1-arity case. So "a+-b" obtains the tree (PLUS a (NEGATE b)) and "a-b" obtains the tree
> (MINUS a b) or something similar in accord with your taste...
>
> And so, with this approach, in all of your post-processing of the AST, the 1-arity and 2-arity
> operations have already been differentiated in the tree itself and therefore can be directly
> determined --- no need to noodle around about whether or not 1 or 2 children are present.

Very true. I know during the parse exactly which one it is, and I
intentionally created the AST the way it is, but inadvertently made it
harder for myself :(.  From now on, I'll  "always remember to keep
information available in the initial parse for later passes."

I was hoping to subvert some of these problems / poor decisions by
asking about best practices for AST building
(http://www.antlr.org/pipermail/antlr-interest/2009-October/036238.html),
but nobody responded at the time.

> and there is also the possibility of having ONLY the 2-arity '-' operator because in Algebra
> the 1-arity '-' is an implicit 2-arity operation involving zero. so the "a+-b" would become
> (PLUS a (MINUS 0 b)) --- but this just tends to break my brain so i do not do that..... ;-)
>
> and, please, can we just not discuss the whole treatment of 2-arity '-' as an addition
> with multiply by -1 ..... my brain tends to just shutdown at that prospect ;-)

I think both of these are worth considering in the context of the
target language / architecture.

Thank you for the suggestions, I appreciate the advise.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From kaleb.pederson at gmail.com  Mon Oct 19 13:03:03 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Mon, 19 Oct 2009 13:03:03 -0700
Subject: [antlr-interest] ANTLR Wiki Down
Message-ID: <f14c01620910191303u487be272i6211086971a4a194@mail.gmail.com>

I'm seeing an error upon attempting to access the Wiki:

**************
You cannot access Confluence at present. Look at the table below to
identify the reasons
 This page will automatically update every 60 seconds.

Time   Level   Type   Description   Exception
  2009-10-19 02:02:37  fatal   cluster  Database is being updated by
an instance which is not part of the current cluster. You should check
network connections between cluster nodes, especially multicast
traffic.

 Your server id is: AXNJ-EP6X-JPOZ-ZMCT.
**************

Hoping to expedite the fix.

Thanks.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From parrt at cs.usfca.edu  Mon Oct 19 14:04:45 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 19 Oct 2009 14:04:45 -0700
Subject: [antlr-interest] ANTLR Wiki Down
In-Reply-To: <f14c01620910191303u487be272i6211086971a4a194@mail.gmail.com>
References: <f14c01620910191303u487be272i6211086971a4a194@mail.gmail.com>
Message-ID: <AF050182-F350-465D-8C91-3E92D2AFDCF2@cs.usfca.edu>

weird. rebooting.
Ter
On Oct 19, 2009, at 1:03 PM, Kaleb Pederson wrote:

> I'm seeing an error upon attempting to access the Wiki:
>
> **************
> You cannot access Confluence at present. Look at the table below to
> identify the reasons
> This page will automatically update every 60 seconds.
>
> Time   Level   Type   Description   Exception
>  2009-10-19 02:02:37  fatal   cluster  Database is being updated by
> an instance which is not part of the current cluster. You should check
> network connections between cluster nodes, especially multicast
> traffic.
>
> Your server id is: AXNJ-EP6X-JPOZ-ZMCT.
> **************
>
> Hoping to expedite the fix.
>
> Thanks.
>
> --
> Kaleb Pederson
>
> Twitter - http://twitter.com/kalebpederson
> Blog - http://kalebpederson.com
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From JALuber at gmx.de  Mon Oct 19 15:04:03 2009
From: JALuber at gmx.de (Johannes Luber)
Date: Tue, 20 Oct 2009 00:04:03 +0200
Subject: [antlr-interest] Which version do I need for a CSharp
	target	and VS 2008
In-Reply-To: <cdfb741351c45343bb5b854084008b5c@temporal-wave.com>
References: <cdfb741351c45343bb5b854084008b5c@temporal-wave.com>
Message-ID: <20091019220403.109980@gmx.net>

> Look at the routine Mismatch() (capital M). It is commented out and all
> that is left seems to be the original recovery/syntax error logic, despite
> the fact that the routines to detect missing and extraneous tokens are within
> the class.

I'm not sure why that is still there. Maybe Ter removed it from the Java target and I haven't followed yet.

> So Csharp2 never reports anything but syntax error, where the
> other runtimes will enter the logic to calculate followsets and so on and
> report accordingly.
> 
> If you follow the logic path from a mismatch in Java vs CSharp2, you will
> see where it diverges. You can do this manually with a small grammar such
> as:
> 
> R : A COMMA B ;
> 
> Generate that Java and CSharp2 code and trace the path that would happen
> if the COMMA was missing ( A B ). 

I've been looking around in BaseRecognizer.cs/java but I've haven't found the place of divergence. Maybe I just missed it? Can you give me the file name and line number where the problem appears?

Johannes
> 
> My feeling is that it is just a minor oversight in what methods are
> implemented, or something wasn't quite finished off at dome point.
> 
> Jim
> 
> > -----Original Message-----
> > From: Johannes Luber [mailto:JALuber at gmx.de]
> > Sent: Monday, October 19, 2009 12:08 AM
> > To: Jim Idle; antlr-interest at antlr.org
> > Subject: Re: [antlr-interest] Which version do I need for a CSharp
> > target and VS 2008
> > 
> > > Johannes,
> > >
> > > Is there some trick to getting the CSharp2 runtime to behave like
> > Java in
> > > error recovery/detection? The MissingToken and extraneous token stuff
> > is
> > > never called because the Mismatch() routine is commented out in the
> > runtime.
> > > So basically all you ever get is an NVA, whereas Java and C will work
> > ou
> > > that a token is missing or extraneous and give better error messages.
> > I can
> > > see that the recovery code is there, but it is never invoked?
> > Pointers?
> > >
> > > Cheers,
> > >
> > > Jim
> > 
> > Do I understand correctly that there is some inconsistency between the
> > runtimes? I've looked into BaseRecognizer.java and I can't find
> > mismatch() there. Where is the missing code based in Java?
> > 
> > Johannes
> > >
> > >
> > > > -----Original Message-----
> > > > From: Johannes Luber [mailto:JALuber at gmx.de]
> > > > Sent: Saturday, October 17, 2009 11:19 PM
> > > > To: Jim Idle; antlr-interest at antlr.org
> > > > Subject: Re: [antlr-interest] Which version do I need for a CSharp
> > > > target and VS 2008
> > > >
> > > > > Not sure if the Csharp3 target is ready for production yet - I
> > wanted
> > > > to
> > > > > ask this myself as I would like to switch to it if it is ;-)
> > > > >
> > > > > But I use Csharp2 as the target, and the runtime is on the
> > download
> > > > pages.
> > > > >
> > > > > Jim
> > > >
> > > > First off, CSharp, CSharp2 and CSharp3 are all different targets,
> > > > although CSharp and CSharp2 share a lot implementationwise. That
> > being
> > > > said, don't use CSharp, as it will be removed for the 3.2 update.
> > > > CSharp2 will have its public interface changed (basically simple
> > > > renames) to align it to one of CSharp3. So if you want save 5
> > minutes
> > > > you could start out with CSharp3 - BUT I don't know about bugs
> > lurking
> > > > in that implementation.
> > > >
> > > > CSharp3 is being used in ST 3.2, in a C# port of ANLTR and the
> > > > maintainer's internal projects, so I'd take it as a big clue that
> > it
> > > > does work sufficiently in those cases. Still CSharp3 lacks the kind
> > of
> > > > exposure CSharp2 has (which is used in e.g. NHibernate).
> > Considering
> > > > that the longterm plan is to obsolete CSharp2 in favor of CSharp3
> > you
> > > > might want to try it out now.
> > > >
> > > > Johannes
> > > > >
> > > > > > -----Original Message-----
> > > > > > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > > > > > bounces at antlr.org] On Behalf Of Robert van der Hulst
> > > > > > Sent: Friday, October 16, 2009 9:41 PM
> > > > > > To: antlr-interest at antlr.org
> > > > > > Subject: [antlr-interest] Which version do I need for a CSharp
> > > > target
> > > > > > and VS 2008
> > > > > >
> > > > > > I am using Antlr 2.7.6 (CPP target) at this moment for our
> > Language
> > > > > > project.
> > > > > >
> > > > > > I  need  to  do make some serious changes, so I am considering
> > to
> > > > move
> > > > > > the project to Antlr 3 and a CSharp
> > > > > >
> > > > > > Which version do people recommend that I should use.
> > > > > >
> > > > > > I looked at the Antlr website and found two options:
> > > > > >
> > > > > > - CSharp
> > > > > > - CSharp3
> > > > > >
> > > > > > but  I  am  not  sure  if they are both available for the
> > latest
> > > > Antlr
> > > > > > build.
> > > > > >
> > > > > > Which one do you recommend ?
> > > > > >
> > > > > > I   would   also  like  to have a binary that does not need
> > Java
> > > > (like
> > > > > > there is for Antlr 2). Does that exist ?
> > > > > >
> > > > > > Finally:  Who has experience using Antlr in a VS 2008
> > environment
> > > > (and
> > > > > > setting up the necessary MsBuild steps to automate the build
> > > > process)?
> > > > > >
> > > > > > --
> > > > > > Robert van der Hulst
> > > > > >
> > > > > >
> > > > > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > > > > Unsubscribe: http://www.antlr.org/mailman/options/antlr-
> > > > interest/your-
> > > > > > email-address
> > > > >
> > > > >
> > > > >
> > > > >
> > > > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > > > Unsubscribe:
> > > > > http://www.antlr.org/mailman/options/antlr-interest/your-email-
> > > > address
> > > >
> > > > --
> > > > GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
> > > > Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01
> > >
> > >
> > 
> > --
> > GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
> > Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01
> 
> 

-- 
GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!
Jetzt freischalten unter http://portal.gmx.net/de/go/maxdome01

From jeffreycameron at gmail.com  Mon Oct 19 15:18:21 2009
From: jeffreycameron at gmail.com (Jeffrey Cameron)
Date: Mon, 19 Oct 2009 18:18:21 -0400
Subject: [antlr-interest] Combining multiple tokens
Message-ID: <b86c7fa10910191518h44f86c0j5a422c9d3477c597@mail.gmail.com>

>
> Thanks for the help to both of you.  I took Jim's recommendation and
> tweaked it a bit.  I used a subrule to accumulate the text I wanted
> and then in the rule that calls the subrule I gather the text for the
> subrule and transmit it with an imaginary token
>

So my code from before now looks like:

line_to_eol
: line_text EOL -> TEXT[$line_text.text]
;
line_text
: ( options {greedy=false;} : . )*
;

There may be some problems with this approach though it seems to be working
well in the tests I have

> ------------------------------
>
> Message: 5
> Date: Sun, 18 Oct 2009 14:24:42 -0700
> From: Graham Wideman <gwlist at grahamwideman.com>
> Subject: Re: [antlr-interest] Combining multiple tokens
> To: antlr-interest at antlr.org
> Message-ID: <4.1.20091018142036.016d4248 at grahamwideman.com>
> Content-Type: text/plain; charset="us-ascii"
>
> I'm not entirely sure I understand the particulars of what you're trying to
> do
> but...
>
> At 10/18/2009 05:01 PM, Jeffrey Cameron wrote:
> >
> > I have two parser rules in my grammar where I am trying to wrap the
> complete,
> > concatenated text of a series of tokens into a single token for a tree
> > grammar.  The rules look like this:
> >
> > #1:
> >
> > cell : (~(VBAR|EOL))* ;
> >
> > in this case I would like to write something like this:
> >
> > cell : (~(VBAR|EOL))* -> TABLECELL[$cell.text] ;
>
>
> I think you probably want syntax that's more like:
>
> -> ^(TABLECELL, $cell)
>
> See:
> http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
>
> If that doesn't get you going, it might be good to post clarifying:
>
> > I am trying to wrap the complete, concatenated text
> > of a series of tokens into a single token for a tree grammar.
>
> ... are you are writing this *in* a tree grammar, or in a combined grammar
> trying to produce a tree?  Also describe what actual errors you are seeing.
>
> -- Graham
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://www.antlr.org/pipermail/antlr-interest/attachments/20091018/2cfbab19/attachment-0001.html
>
>
>
> ------------------------------
>
> Message: 10
> Date: Tue, 20 Oct 2009 13:25:12 +0530
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: Re: [antlr-interest] Combining multiple tokens
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <24bb54a693d4784382c354e9de3baf30 at temporal-wave.com>
> Content-Type: text/plain; charset="us-ascii"
>
> All you need do is accumulate the text in a stringbuffer:
>
>
>
> ( s=TOK { sbuf.append($s.text); }) +
>
>
>
> Then use the string you have accumulated to set the text of an imaginary or
> even the last TOK (which will be in s).
>
>
>
> ->IMAGINARY[sbuf.toString()]
>
>
>
> Should work fine.
>
>
>
> Jim
>
>
>
> From: antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] On Behalf Of Jeffrey Cameron
> Sent: Monday, October 19, 2009 2:32 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Combining multiple tokens
>
>
>
> I have two parser rules in my grammar where I am trying to wrap the
> complete, concatenated text of a series of tokens into a single token for a
> tree grammar.  The rules look like this:
>
>
>
> #1:
>
>
>
> cell : (~(VBAR|EOL))* ;
>
>
>
> in this case I would like to write something like this:
>
>
>
> cell : (~(VBAR|EOL))* -> TABLECELL[$cell.text] ;
>
>
>
> but when I put that syntax in I get an exception.
>
>
>
> #2:
>
>
>
> line_to_eol : ( options {greedy=false;} : . )* EOL ;
>
>
>
> I would like to do something like the same as above but ignore the EOL
> token, so something like this:
>
>
>
> line_to_eol : stuff+=( options {greedy=false;} : . )* EOL ->
> TEXT[$stuff.text] ;
>
>
>
> Can someone tell me when I am doing wrong in here and how to correct it?
> I'm a bit stuck here and every other part of my grammar is working as
> expected.
>
>
>
> Thanks in advance
>
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/24c97f3c/attachment-0001.html
>
> ------------------------------
>
> Message: 11
> Date: Tue, 20 Oct 2009 13:29:18 +0530
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: Re: [antlr-interest] [c target] memory leaks during error
>        recovery
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <43b4e74754894440b20f0721a1dbbef6 at temporal-wave.com>
> Content-Type: text/plain;       charset="iso-8859-1"
>
> It is because you are trying to do things while you parse - another reason
> to build a tree and THEN operate on the tree.
>
> Catch does not need a type in the C target, you can just use:
>
> r:
>  Ddddddd
> ;
> catch() { }
>
> (assuming 3.2 of ANTLR).
>
> The other thing you might do is break up your rule list so that exceptions
> in them do not drop out the whole rule, which is what happens in all targets
> unless you structure the rules a little. Break things down in to smaller
> units. The function call overhead (which may not even occur because of
> inlining) is very small in C.
>
> Jim
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091019/15c5a578/attachment.html 

From david-sarah at jacaranda.org  Mon Oct 19 18:09:55 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 20 Oct 2009 02:09:55 +0100
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <2bad2e33669bd14fabe33cabc02b290b@temporal-wave.com>
References: <2bad2e33669bd14fabe33cabc02b290b@temporal-wave.com>
Message-ID: <4ADD0DE3.1090103@jacaranda.org>

Jim Idle wrote:
> I don?t think that there any bugs here. The gated predicates work fine for me
> (not that that means there are therefore no bugs ;-), but that it is more
> likely there is a misuse going on somewhere in the grammar).

Having investigated further, there is certainly very strange and error-prone
behaviour for examples similar to Robert Wentworth's, whether or not it is
considered to be an ANTLR bug. Consider the following grammar, which is a
simplified excerpt of an ECMAScript 5 grammar (it parses property
assignments in ES5 object literals):

  grammar Test;

  options {
    language = Java;
    backtrack = true;
  }

  @parser::members {
    /** Test whether token is not null and has the given text. */
    protected boolean is(Token token, String string) {
      return token != null && token.getText().equals(string);
    }
  }

  COLON : ':';
  ID    : ('a'..'z')+;
  get   : { is(input.LT(1), "get") }?=> ID;
  set   : { is(input.LT(1), "set") }?=> ID;
  WS    : ' ' { $channel = HIDDEN; };

  top : propertyAssignment EOF;

  propertyAssignment
    : ID COLON { System.out.println("ID COLON"); }
    | get ID   { System.out.println("get ID"); }
    | set ID   { System.out.println("set ID"); }
    ;

(Note that "get" and "set" are intended to be treated as identifiers
in all contexts except for the second and third alternatives of
propertyAssignment. Yes, I know that there are other approaches to
handling such context-dependent identifiers.)

The output of this grammar on various inputs is:

"a:"
ID COLON [as intended]

"get:"
ID COLON [as intended]

"set:"
ID COLON [as intended]

"get a"
line 1:0 no viable alternative at input 'get' [not as intended]

"set a"
set ID [as intended! why does this work when "get a" doesn't?]


Strangely, "get a" does print "get ID" when the 'backtrack' option is
set to false.

Note that manually hoisting the predicates into propertyAssignment
still doesn't work:

  propertyAssignment
    : ID COLON { System.out.println("ID COLON"); }
    | { is(input.LT(1), "get") }?=> ID ID { System.out.println("get ID"); }
    | { is(input.LT(1), "set") }?=> ID ID { System.out.println("set ID"); }
    ;

In any case, we have an apparently working grammar that compiles without
warnings, but fails when backtracking is enabled. This certainly violates
the Principle of Least Astonishment.

As far as I can see, the generated code for propertyAssignment (shown here
for the case when the predicates are manually hoisted) is simply wrong:

  // T:\\jacaranda\\old\\Test.g:25:5: ( ID COLON | {...}? => ID ID | {...}?
=> ID ID )
  int alt1=3;
  int LA1_0 = input.LA(1);

  if ( (LA1_0==ID) ) {
    int LA1_1 = input.LA(2);

    if ( (LA1_1==COLON) ) {
      alt1=1;
    }
    else if ( (LA1_1==ID) && (( is(input.LT(1), "set") ))) {
      int LA1_3 = input.LA(3);

      if ( ((synpred2_Test()&&( is(input.LT(1), "get") ))) ) {
        alt1=2;
      }
      else if ( (( is(input.LT(1), "set") )) ) {
        alt1=3;
      }
      else {
...

Notice that the predicate for "get" is only tested inside the 'if'
statement that has already checked for "set".

Without backtracking, the condition for that 'if' statement is
"(LA1_1==ID) && ((( is(input.LT(1), "get") )||( is(input.LT(1), "set") ))))"
which looks correct to me (even if it is somewhat inefficient to be
evaluating the predicates multiple times, rather than assigning them
to temporaries).

I.e. the bug *appears* to be that, when backtracking is enabled for a
rule and there is more than one gated semantic predicate after hoisting,
not all of the predicates are taken into account when generating some of
the conditions for predicting the alternative.

Note that use of syntactic predicates implicitly enables non-global
backtracking, so it is plausible that similar problems could also occur
when there is more than one syntactic predicate after hoisting, even if
the grammar does not use the global 'backtrack = true' option. I didn't
investigate that case, though.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From sharwell at pixelminegames.com  Mon Oct 19 19:16:11 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Mon, 19 Oct 2009 21:16:11 -0500
Subject: [antlr-interest] Status of the CSharp3 target and my C# portsof
	ANTLR and StringTemplate
References: <cc529a5754e5204bafd87d397c57b7ba@temporal-wave.com>
Message-ID: <DD5A5D428FE040429CCDF377FAA892840152DDE2@martini.ironwillgames.com>

I think the only thing missing is the Java class required for the Java
version to know the CSharp3 target exists.

 

Sam

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Tuesday, October 20, 2009 2:51 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: Re: [antlr-interest] Status of the CSharp3 target and my C#
portsof ANTLR and StringTemplate

 

Top posting for Sam's benefit ;-)

 

Not being able to use the Csharp3 target from the standard version of
the tool is going to be a turn off for many I think L What is it that
your port of the tool has that the standard version does not. I know you
have posted some of that, but perhaps we can summarize this and see if
such things can be absorbed into the standard Java tool? Nobody minds
you having your own version of anything because it is open source, but
most will want ot use the 'offical' java version of the tool even if
they are targeting C#.

 

Thanks for the updates,

 

Jim

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Sam Harwell
Sent: Monday, October 19, 2009 1:05 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports
of ANTLR and StringTemplate

 

Hi everyone,

 

Here's a status update that I know many people are asking for. For each
portion, I'll talk about the status of the code in Perforce. At the end,
I'll talk about the status of the posted binaries.

 

Basic Status

 

StringTemplate and the ANTLR Tool: Up-to-date with the Java version for
all targets as of August 4, 2009, which covers all of the changes made
earlier in the year and over the summer.

 

CSharp3 Target: working and extensively used in the ANTLR Tool,
StringTemplate, and the commercial projects I use ANTLR for. I haven't
tested the -profile and -debug modes because I don't use them, however
the templates should be "close to working". Currently, the CSharp3
target can only be used when generating grammars from the C# port of the
tool.

 

Design Changes

 

1.       Rather than package the target templates as resources in the
tool's executable, I've chosen a flat file layout. That way, the
templates for a target can be updated without recompiling the tool. The
targets themselves are also implemented as individual DLL's.

2.       The CSharp3 target declares rules as private methods by
default. Rules can be made public by simply marking them as such in the
grammar: "public compile_unit : declaration*;" I have updated the Java
target's code generation to support this as well, but it's not checked
in.

3.       StringTemplate has code for a high speed dynamically compiled
interpreter. By default, the build doesn't enable this mode, but when
it's turned on the output appears to work correctly. I need to do
another round of tests, but at this point the C# ports of the ANTLR Tool
and StringTemplate should be significantly faster than the Java version.
We've hit a brick wall preventing further optimization without rewriting
ST, but the work on STv4 should give another order of magnitude
improvement in template rendering performance.

 

Things Holding Me Up

 

1.       I haven't finalized the way I'm going to do assembly
versioning, although I think I've got that worked out now. I'll send a
separate mail to the list regarding this.

2.       StringTemplate is only tested in regards to code generation for
the ANTLR tool. In particular, its ability to locate templates in
resources or on the file system is not documented and may or may not
behave as people expect.

3.       I'm still making periodic changes to the API as I finalize
things, and breaking changes in production code aren't good. I don't
want to suggest replacing the CSharp2 target until the CSharp3 target is
more tested by other people.

 

Things I want to do, but not really holding up the builds

 

I really want to package a clean integration of ANTLR+CSharp3 for
MSBuild. We need this. This would include at least MSBuild targets file
and templates for adding grammars to a project. Unfortunately, there are
many issues I still need to resolve for this to be a reality, most of
which have answers in shades of gray.

 

Status of the Posted Build

 

The build available for download was uploaded on fairly short notice.
Mistakes (by me) included not having the assembly version set correctly
and not posting the source code from the build with the binaries. I've
been trying to wrap some of these things up before posting another
build.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091019/22e5c2e4/attachment.html 

From marcelo.nichele at gmail.com  Mon Oct 19 21:59:00 2009
From: marcelo.nichele at gmail.com (Marcelo Nichele)
Date: Tue, 20 Oct 2009 02:59:00 -0200
Subject: [antlr-interest] Bytes Limit
Message-ID: <848594440910192159j666de8a1tb623966daa502fd6@mail.gmail.com>

Hi,

I'm getting started in ANTLR and my grammar generated the
specialStateTransition method too big.

The error message is *The code of method specialStateTransition(int,
IntStream) is exceeding the 65535 bytes limit.*

The method assignature is:
*public int specialStateTransition(int s, IntStream _input) throws
NoViableAltException*

I'm using Eclipse IDE for execute code.

Thanks for some help,

Marcelo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/18e4d8a3/attachment.html 

From jimi at temporal-wave.com  Mon Oct 19 21:34:13 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 10:04:13 +0530
Subject: [antlr-interest] @after doesn't work for C target
In-Reply-To: <4ADC3238.5090303@gmail.com>
Message-ID: <e63e2d9324950f45995d0572fbf3f5be@temporal-wave.com>

@after only works with ANTLR 3.2. You can also use exception() with the C target on 3.2

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Ronghui Yu
Sent: Monday, October 19, 2009 3:03 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] @after doesn't work for C target

 

Hi, All,

I would like to get notification when exiting a rule, but @after action doesn't work for C target, I wonder if it is the designed behavior. If yes, is there an alternative approach?

Thank you in advance.

-- 
Ronghui Yu <mailto:stoneyrh at 163.com>  



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/2714bc5a/attachment.html 

From jimi at temporal-wave.com  Mon Oct 19 22:08:05 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 10:38:05 +0530
Subject: [antlr-interest] Status of the CSharp3 target and my C# portsof
	ANTLR and StringTemplate
In-Reply-To: <DD5A5D428FE040429CCDF377FAA892840152DDE2@martini.ironwillgames.com>
Message-ID: <148a82de0f599d48a588d6de36c9b231@temporal-wave.com>

OK - well we can add that easily enough J Why don't we try it?

 

Jim

 

From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: Tuesday, October 20, 2009 7:46 AM
To: Jim Idle; antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: RE: [antlr-interest] Status of the CSharp3 target and my C# portsof ANTLR and StringTemplate

 

I think the only thing missing is the Java class required for the Java version to know the CSharp3 target exists.

 

Sam

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Tuesday, October 20, 2009 2:51 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: Re: [antlr-interest] Status of the CSharp3 target and my C# portsof ANTLR and StringTemplate

 

Top posting for Sam's benefit ;-)

 

Not being able to use the Csharp3 target from the standard version of the tool is going to be a turn off for many I think L What is it that your port of the tool has that the standard version does not. I know you have posted some of that, but perhaps we can summarize this and see if such things can be absorbed into the standard Java tool? Nobody minds you having your own version of anything because it is open source, but most will want ot use the 'offical' java version of the tool even if they are targeting C#.

 

Thanks for the updates,

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Sam Harwell
Sent: Monday, October 19, 2009 1:05 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports of ANTLR and StringTemplate

 

Hi everyone,

 

Here's a status update that I know many people are asking for. For each portion, I'll talk about the status of the code in Perforce. At the end, I'll talk about the status of the posted binaries.

 

Basic Status

 

StringTemplate and the ANTLR Tool: Up-to-date with the Java version for all targets as of August 4, 2009, which covers all of the changes made earlier in the year and over the summer.

 

CSharp3 Target: working and extensively used in the ANTLR Tool, StringTemplate, and the commercial projects I use ANTLR for. I haven't tested the -profile and -debug modes because I don't use them, however the templates should be "close to working". Currently, the CSharp3 target can only be used when generating grammars from the C# port of the tool.

 

Design Changes

 

1.       Rather than package the target templates as resources in the tool's executable, I've chosen a flat file layout. That way, the templates for a target can be updated without recompiling the tool. The targets themselves are also implemented as individual DLL's.

2.       The CSharp3 target declares rules as private methods by default. Rules can be made public by simply marking them as such in the grammar: "public compile_unit : declaration*;" I have updated the Java target's code generation to support this as well, but it's not checked in.

3.       StringTemplate has code for a high speed dynamically compiled interpreter. By default, the build doesn't enable this mode, but when it's turned on the output appears to work correctly. I need to do another round of tests, but at this point the C# ports of the ANTLR Tool and StringTemplate should be significantly faster than the Java version. We've hit a brick wall preventing further optimization without rewriting ST, but the work on STv4 should give another order of magnitude improvement in template rendering performance.

 

Things Holding Me Up

 

1.       I haven't finalized the way I'm going to do assembly versioning, although I think I've got that worked out now. I'll send a separate mail to the list regarding this.

2.       StringTemplate is only tested in regards to code generation for the ANTLR tool. In particular, its ability to locate templates in resources or on the file system is not documented and may or may not behave as people expect.

3.       I'm still making periodic changes to the API as I finalize things, and breaking changes in production code aren't good. I don't want to suggest replacing the CSharp2 target until the CSharp3 target is more tested by other people.

 

Things I want to do, but not really holding up the builds

 

I really want to package a clean integration of ANTLR+CSharp3 for MSBuild. We need this. This would include at least MSBuild targets file and templates for adding grammars to a project. Unfortunately, there are many issues I still need to resolve for this to be a reality, most of which have answers in shades of gray.

 

Status of the Posted Build

 

The build available for download was uploaded on fairly short notice. Mistakes (by me) included not having the assembly version set correctly and not posting the source code from the build with the binaries. I've been trying to wrap some of these things up before posting another build.

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/6d831b37/attachment.html 

From jimi at temporal-wave.com  Mon Oct 19 22:07:13 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 10:37:13 +0530
Subject: [antlr-interest] Semantic predicates
In-Reply-To: <4ADD0DE3.1090103@jacaranda.org>
Message-ID: <08d3c5c05cee09429b30ce70aef80f00@temporal-wave.com>

You have turned on backtracking mode and used gated predicates. I am not sure that this is completely Kosher to be honest. Perhaps it is and there is a bug with combining backtrack and gates. However, backtrack is essentially trying to negate the requirement for such predicates.

With backtracking on, you don?t get warnings and so on, by definition they are turned off. Hence in backtracking mode it is very easy to have a useless grammar that does not give any warnings when you build it. Incidentally, this never astonishes me, so the principle of least astonishment depends on your perspective ;-) Basically backtrack mode requires you to know MORE about your grammar rather than the less that people think it does. The apparent paradox is precisely because ANTLR turns off all the warnings, assumes you know what you are doing and trys each potentially valid alt in turn. 

As to why in this case backtrack causes a failure to do what you expect, I will have to leave to when I return to the US next week unless anyone else wants to look. I suspect though that the predicates are interfering in some way with ANTLR trying to predict whether it needs predicates for the alts and whether they are valid alts for ID. If you look at the generated code, does it look like you would expect it to look?

When you turn off backtrack and it works (not unexpected by me to be honest), what is the difference in the generated code?

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of David-Sarah Hopwood
> Sent: Tuesday, October 20, 2009 6:40 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Semantic predicates
> 
> Jim Idle wrote:
> > I don?t think that there any bugs here. The gated predicates work
> fine for me
> > (not that that means there are therefore no bugs ;-), but that it is
> more
> > likely there is a misuse going on somewhere in the grammar).
> 
> Having investigated further, there is certainly very strange and error-
> prone
> behaviour for examples similar to Robert Wentworth's, whether or not it
> is
> considered to be an ANTLR bug. Consider the following grammar, which is
> a
> simplified excerpt of an ECMAScript 5 grammar (it parses property
> assignments in ES5 object literals):
> 
>   grammar Test;
> 
>   options {
>     language = Java;
>     backtrack = true;
>   }
> 
>   @parser::members {
>     /** Test whether token is not null and has the given text. */
>     protected boolean is(Token token, String string) {
>       return token != null && token.getText().equals(string);
>     }
>   }
> 
>   COLON : ':';
>   ID    : ('a'..'z')+;
>   get   : { is(input.LT(1), "get") }?=> ID;
>   set   : { is(input.LT(1), "set") }?=> ID;
>   WS    : ' ' { $channel = HIDDEN; };
> 
>   top : propertyAssignment EOF;
> 
>   propertyAssignment
>     : ID COLON { System.out.println("ID COLON"); }
>     | get ID   { System.out.println("get ID"); }
>     | set ID   { System.out.println("set ID"); }
>     ;
> 
> (Note that "get" and "set" are intended to be treated as identifiers
> in all contexts except for the second and third alternatives of
> propertyAssignment. Yes, I know that there are other approaches to
> handling such context-dependent identifiers.)
> 
> The output of this grammar on various inputs is:
> 
> "a:"
> ID COLON [as intended]
> 
> "get:"
> ID COLON [as intended]
> 
> "set:"
> ID COLON [as intended]
> 
> "get a"
> line 1:0 no viable alternative at input 'get' [not as intended]
> 
> "set a"
> set ID [as intended! why does this work when "get a" doesn't?]
> 
> 
> Strangely, "get a" does print "get ID" when the 'backtrack' option is
> set to false.
> 
> Note that manually hoisting the predicates into propertyAssignment
> still doesn't work:
> 
>   propertyAssignment
>     : ID COLON { System.out.println("ID COLON"); }
>     | { is(input.LT(1), "get") }?=> ID ID { System.out.println("get
> ID"); }
>     | { is(input.LT(1), "set") }?=> ID ID { System.out.println("set
> ID"); }
>     ;
> 
> In any case, we have an apparently working grammar that compiles
> without
> warnings, but fails when backtracking is enabled. This certainly
> violates
> the Principle of Least Astonishment.
> 
> As far as I can see, the generated code for propertyAssignment (shown
> here
> for the case when the predicates are manually hoisted) is simply wrong:
> 
>   // T:\\jacaranda\\old\\Test.g:25:5: ( ID COLON | {...}? => ID ID |
> {...}?
> => ID ID )
>   int alt1=3;
>   int LA1_0 = input.LA(1);
> 
>   if ( (LA1_0==ID) ) {
>     int LA1_1 = input.LA(2);
> 
>     if ( (LA1_1==COLON) ) {
>       alt1=1;
>     }
>     else if ( (LA1_1==ID) && (( is(input.LT(1), "set") ))) {
>       int LA1_3 = input.LA(3);
> 
>       if ( ((synpred2_Test()&&( is(input.LT(1), "get") ))) ) {
>         alt1=2;
>       }
>       else if ( (( is(input.LT(1), "set") )) ) {
>         alt1=3;
>       }
>       else {
> ...
> 
> Notice that the predicate for "get" is only tested inside the 'if'
> statement that has already checked for "set".
> 
> Without backtracking, the condition for that 'if' statement is
> "(LA1_1==ID) && ((( is(input.LT(1), "get") )||( is(input.LT(1), "set")
> ))))"
> which looks correct to me (even if it is somewhat inefficient to be
> evaluating the predicates multiple times, rather than assigning them
> to temporaries).
> 
> I.e. the bug *appears* to be that, when backtracking is enabled for a
> rule and there is more than one gated semantic predicate after
> hoisting,
> not all of the predicates are taken into account when generating some
> of
> the conditions for predicting the alternative.
> 
> Note that use of syntactic predicates implicitly enables non-global
> backtracking, so it is plausible that similar problems could also occur
> when there is more than one syntactic predicate after hoisting, even if
> the grammar does not use the global 'backtrack = true' option. I didn't
> investigate that case, though.
> 
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Mon Oct 19 21:38:50 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 10:08:50 +0530
Subject: [antlr-interest] [c target] memory leaks during error recovery
In-Reply-To: <20091019154028.D11A4621C8D@mailc.rambler.ru>
Message-ID: <b1e50522b5285340b0e00c1b4f0a2db6@temporal-wave.com>

See pervious answer to this question...

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of yurushkin at rambler.ru
> Sent: Monday, October 19, 2009 2:37 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] [c target] memory leaks during error recovery
> 
> good day,
> I have the rule
> 
> myRule[returns Type1 res] :
> 	rule1, rule2, rule3, rule4... ruleN { res = f($rule1, $rule2,...,
> ,
> $ruleN) }
> 	;
> 
> it's all ok.
> BUT if ruleN will fire exception, rule1, rule2.. rule(N-1) subtrees
> will
> be forgotten!!!
> How can I manage such situations?? can you write me right code for such
> rule, that gives answer on my question?
> thanks
> 
> PS: I tried to use "catch" attribute .. but it needs errorCode. It's
> not
> good, because there're may be different errors.
> 
> --
> Best regards,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From phungngochieu at gmail.com  Mon Oct 19 22:40:22 2009
From: phungngochieu at gmail.com (Hieu Phung)
Date: Tue, 20 Oct 2009 13:40:22 +0800
Subject: [antlr-interest] [Antlr + ST] Huge output string -
	OutOfMemoryError
In-Reply-To: <d6e63684c91bda43a9dd01ec27d445f5@temporal-wave.com>
References: <2d17b250910160333r724d552naf49a1966efc0fcc@mail.gmail.com>
	<d6e63684c91bda43a9dd01ec27d445f5@temporal-wave.com>
Message-ID: <2d17b250910192240p4122c5fekfb0e6bd75b4d4a6f@mail.gmail.com>

Hi Jim,

Thank you for your suggestion. Actually the result I got was with JVM
setting -Xms1024m -Xmx1024m. And it's the maximum memory size I can set for
my application server. The gc setting was also configured...

Regards,
Helen

On Sun, Oct 18, 2009 at 12:05 PM, Jim Idle <jimi at temporal-wave.com> wrote:

>  Run Java with   - Xmx1500M
>
>
>
> Or some other option that increases available memory size. However this
> could point to something that can be better organized in terms of recursion
> or whatever.
>
>
>
> You may also consider running Java with a better garbage collector such as:
>
>
>
> -Xincgc
>
>
>
> JIm
>
>
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Hieu Phung
> *Sent:* Friday, October 16, 2009 4:03 PM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] [Antlr + ST] Huge output string -
> OutOfMemoryError
>
>
>
> Hi all,
>
> I am writing a program using Antlr and StringTemplate to translate an input
> file to an XML file. Input is small but output is huge: 720KB input file
> will generate about 100MB output file. When my input reached 7608KB, I got
> OOM error
>
> time taken in second: 18 - file size in KB: 4804
> time taken in second: 20 - file size in KB: 5205
> time taken in second: 20 - file size in KB: 5605
> time taken in second: 21 - file size in KB: 6006
> time taken in second: 23 - file size in KB: 6406
> time taken in second: 25 - file size in KB: 6806
> time taken in second: 31 - file size in KB: 7207
>
> at size 7608KB:
> Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
>         at java.util.Arrays.copyOf(Arrays.java:2882)
>         at
> java.lang.AbstractStringBuilder.expandCapacity(AbstractStringBuilder.java:100)
>         at
> java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:572)
>         at java.lang.StringBuffer.append(StringBuffer.java:320)
>         at java.io.StringWriter.write(StringWriter.java:60)
>         at
> org.antlr.stringtemplate.AutoIndentWriter.write(AutoIndentWriter.java:172)
>         at
> org.antlr.stringtemplate.language.ASTExpr.writePOJO(ASTExpr.java:702)
>         at
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:683)
>         at
> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
>         at
> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
>         at
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
>         at
> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
>         at
> org.antlr.stringtemplate.language.ASTExpr.writeTemplate(ASTExpr.java:750)
>         at
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:680)
>         at
> org.antlr.stringtemplate.language.ASTExpr.writeIterableValue(ASTExpr.java:792)
>         at
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:682)
>         at
> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
>         at
> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
>         at
> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
>         at
> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
>         at
> org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1670)
>         at
> org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1661)
>         at FFMParser.file(FFMParser.java:127)
>         at CSVTest.main(CSVTest.java:33)
>
> Is there any suggestion so that program can generate 1GB file?
>
> 1)       Having multiple templates, each template generates small string,
> then write the small strings to file.
> My input has format: ((Part1) (Part2)+ (Part3)). For each part2, there is
> an xml element in the output. I can have 3 templates here. In Antlr
> action, I will write each part to file when parsing is done for the part.
>
> 2)       Any template engine that could write to file directly, instead of
> returning a string...? (This might not be proper to discussed here :D)
>
> I hope problem is stated clearly. Please let me know if you need more
> information. Any suggestion is much appreciated. Thank you.
>
> Regards,
>
> Helen
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/1ff32a3f/attachment.html 

From jimi at temporal-wave.com  Mon Oct 19 23:13:33 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 20 Oct 2009 11:43:33 +0530
Subject: [antlr-interest] [Antlr + ST] Huge output string -
	OutOfMemoryError
In-Reply-To: <2d17b250910192240p4122c5fekfb0e6bd75b4d4a6f@mail.gmail.com>
Message-ID: <3e25278f390e6249a83a811259aad5eb@temporal-wave.com>

Then you either need to avoid the toString() and use a writer, or see if there is something wrong with your template that is causing infinite recursion etc.

 

Jim

 

From: Hieu Phung [mailto:phungngochieu at gmail.com] 
Sent: Tuesday, October 20, 2009 11:10 AM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] [Antlr + ST] Huge output string - OutOfMemoryError

 

Hi Jim,

Thank you for your suggestion. Actually the result I got was with JVM setting -Xms1024m -Xmx1024m. And it's the maximum memory size I can set for my application server. The gc setting was also configured... 

Regards,
Helen 

On Sun, Oct 18, 2009 at 12:05 PM, Jim Idle <jimi at temporal-wave.com> wrote:

Run Java with   - Xmx1500M

 

Or some other option that increases available memory size. However this could point to something that can be better organized in terms of recursion or whatever.

 

You may also consider running Java with a better garbage collector such as:

 

-Xincgc

 

JIm

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Hieu Phung
Sent: Friday, October 16, 2009 4:03 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] [Antlr + ST] Huge output string - OutOfMemoryError

 

Hi all,

I am writing a program using Antlr and StringTemplate to translate an input file to an XML file. Input is small but output is huge: 720KB input file will generate about 100MB output file. When my input reached 7608KB, I got OOM error

time taken in second: 18 - file size in KB: 4804
time taken in second: 20 - file size in KB: 5205
time taken in second: 20 - file size in KB: 5605
time taken in second: 21 - file size in KB: 6006
time taken in second: 23 - file size in KB: 6406
time taken in second: 25 - file size in KB: 6806
time taken in second: 31 - file size in KB: 7207

at size 7608KB:
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
        at java.util.Arrays.copyOf(Arrays.java:2882)
        at java.lang.AbstractStringBuilder.expandCapacity(AbstractStringBuilder.java:100)
        at java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:572)
        at java.lang.StringBuffer.append(StringBuffer.java:320)
        at java.io.StringWriter.write(StringWriter.java:60)
        at org.antlr.stringtemplate.AutoIndentWriter.write(AutoIndentWriter.java:172)
        at org.antlr.stringtemplate.language.ASTExpr.writePOJO(ASTExpr.java:702)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:683)
        at org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
        at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
        at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
        at org.antlr.stringtemplate.language.ASTExpr.writeTemplate(ASTExpr.java:750)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:680)
        at org.antlr.stringtemplate.language.ASTExpr.writeIterableValue(ASTExpr.java:792)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:682)
        at org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:660)
        at org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator.java:86)
        at org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:149)
        at org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:705)
        at org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1670)
        at org.antlr.stringtemplate.StringTemplate.toString(StringTemplate.java:1661)
        at FFMParser.file(FFMParser.java:127)
        at CSVTest.main(CSVTest.java:33)
       
Is there any suggestion so that program can generate 1GB file?

1)       Having multiple templates, each template generates small string, then write the small strings to file.
My input has format: ((Part1) (Part2)+ (Part3)). For each part2, there is an xml element in the output. I can have 3 templates here. In Antlr action, I will write each part to file when parsing is done for the part.

2)       Any template engine that could write to file directly, instead of returning a string...? (This might not be proper to discussed here :D)

I hope problem is stated clearly. Please let me know if you need more information. Any suggestion is much appreciated. Thank you.

Regards,

Helen

 

 

 

 

 

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/d3e6f336/attachment.html 

From horst.dehmer at inode.at  Mon Oct 19 23:42:32 2009
From: horst.dehmer at inode.at (Horst Dehmer)
Date: Tue, 20 Oct 2009 08:42:32 +0200
Subject: [antlr-interest] Bytes Limit
In-Reply-To: <848594440910192159j666de8a1tb623966daa502fd6@mail.gmail.com>
Message-ID: <C7032878.927%horst.dehmer@inode.at>

Hello Marcelo,

i?m afraid you hit a hard limit with java binary class files. how is your
grammar looking, is it unusually big?
have also a look at
http://groups.google.com/group/comp.lang.java.machine/browse_thread/thread/b
0cf268515f1ef55

good luck,
horst


On 20.10.09 06:59, "Marcelo Nichele" <marcelo.nichele at gmail.com> wrote:

> The code of method specialStateTransition(int, IntStream) is exceeding the
> 65535 bytes limit

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/af3a7210/attachment.html 

From speiestaaim at gmail.com  Tue Oct 20 06:36:09 2009
From: speiestaaim at gmail.com (Parambir Singh)
Date: Tue, 20 Oct 2009 19:06:09 +0530
Subject: [antlr-interest] Using multiple grammars with a single parser
Message-ID: <ddac439a0910200636w1d1474a3g7b55480e48737a5f@mail.gmail.com>

Hi
I am working on a project where I want to parse input in different locales
(e.g. english, french & german dates). I don't want to create multiple
parsers, since the semantics of the grammar don't change between locales. So
probably I'll need multiple lexers and a single parser. Moreover, I want to
specify a locale to the parser and the input should be matched against only
that particular locale (e.g. german dates should be invalid in english
locale).

What would be the best approach to construct such a parser using ANTLR. I
don't have much experience with ANTLR but I read about grammar inheritance
and think it could be useful here.

Thanks
Param
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/cc215a35/attachment.html 

From kirby.bohling at gmail.com  Tue Oct 20 07:31:29 2009
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Tue, 20 Oct 2009 09:31:29 -0500
Subject: [antlr-interest] Using multiple grammars with a single parser
In-Reply-To: <ddac439a0910200636w1d1474a3g7b55480e48737a5f@mail.gmail.com>
References: <ddac439a0910200636w1d1474a3g7b55480e48737a5f@mail.gmail.com>
Message-ID: <3cac8fdf0910200731x60a949at6b009bd6316b2a2f@mail.gmail.com>

On Tue, Oct 20, 2009 at 8:36 AM, Parambir Singh <speiestaaim at gmail.com> wrote:
> Hi
> I am working on a project where I want to parse input in different locales
> (e.g. english, french & german dates). I don't want to create multiple
> parsers, since the semantics of the grammar don't change between locales. So
> probably I'll need multiple lexers and a single parser. Moreover, I want to
> specify a locale to the parser and the input should be matched against only
> that particular locale (e.g. german dates should be invalid in english
> locale).
> What would be the best approach to construct such a parser using ANTLR. I
> don't have much experience with ANTLR but I read about grammar inheritance
> and think it could be useful here.
> Thanks
> Param

This sounds like exactly the case for "gated predicates" given inside
of the "ANTLR: The Definitive Guide".  Essentially if you had the
lexer/parser rules that are gated by an "global" variable (either a
boolean, or an enumeration).

foo : ( {isEnglishAllowed()}?=> englishFoo
       |  {isGermanAllowed()}?=> germanFoo
       | defaultFoo
       );

If you read the beginning on Chapter 12, they discuss enabling and
disabling various language extensions (like parsing ANSI C vs.
including the gcc extensions based upon flags).  The reason to use
"globals" is that those predicates will be hoisted from the parser
into the DFA.  So if you try and using do something like:

foo[LangEnum lang]: ( {lang==ENGLISH}? => englishFoo| ... );

It won't work, because "lang" is not a global.  I really wish there
were a way to pass an actual constant (I've got a number of
lexer/parser rules that I can express in terms of a half dozen
constants, but I can't find a better when then generating the rules).

It appears you can use scopes to affect that sort of thing, but I
don't yet understand how to use those effectively.

Thanks,
    Kirby


>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From sharwell at pixelminegames.com  Tue Oct 20 09:55:58 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 20 Oct 2009 11:55:58 -0500
Subject: [antlr-interest] Status of the CSharp3 target and my C# portsof
	ANTLR and StringTemplate
References: <148a82de0f599d48a588d6de36c9b231@temporal-wave.com>
Message-ID: <DD5A5D428FE040429CCDF377FAA892840152DDE3@martini.ironwillgames.com>

The code should be nearly the same as that of the CSharp2 target. Here
is the C# port of the CSharp2 target and CSharp3 target so you can see
how the CSharp3 one differs. Clearly it should be easy to make it work.

 

public class CSharp2Target : Target

{

    public override string EncodeIntAsCharEscape(int v)

    {

        return "\\x" + v.ToString("X");

    }

}

 

public class CSharp3Target : Target

{

    public override string EncodeIntAsCharEscape(int v)

    {

        return "\\x" + v.ToString("X");

    }

 

    public override string GetTarget64BitStringFromValue(ulong word)

    {

        return "0x" + word.ToString("X");

    }

}

 

Something to note: I'm not sure the Java version of the tool exposes the
property required to support marking rules as public/protected/private.
We'll have to check that out too, but it should be straightforward.

 

Sam

 

From: Jim Idle [mailto:jimi at temporal-wave.com] 
Sent: Tuesday, October 20, 2009 12:08 AM
To: Sam Harwell; antlr-interest at antlr.org;
stringtemplate-interest at antlr.org
Subject: RE: [antlr-interest] Status of the CSharp3 target and my C#
portsof ANTLR and StringTemplate

 

OK - well we can add that easily enough J Why don't we try it?

 

Jim

 

From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: Tuesday, October 20, 2009 7:46 AM
To: Jim Idle; antlr-interest at antlr.org;
stringtemplate-interest at antlr.org
Subject: RE: [antlr-interest] Status of the CSharp3 target and my C#
portsof ANTLR and StringTemplate

 

I think the only thing missing is the Java class required for the Java
version to know the CSharp3 target exists.

 

Sam

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Tuesday, October 20, 2009 2:51 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: Re: [antlr-interest] Status of the CSharp3 target and my C#
portsof ANTLR and StringTemplate

 

Top posting for Sam's benefit ;-)

 

Not being able to use the Csharp3 target from the standard version of
the tool is going to be a turn off for many I think L What is it that
your port of the tool has that the standard version does not. I know you
have posted some of that, but perhaps we can summarize this and see if
such things can be absorbed into the standard Java tool? Nobody minds
you having your own version of anything because it is open source, but
most will want ot use the 'offical' java version of the tool even if
they are targeting C#.

 

Thanks for the updates,

 

Jim

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Sam Harwell
Sent: Monday, October 19, 2009 1:05 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports
of ANTLR and StringTemplate

 

Hi everyone,

 

Here's a status update that I know many people are asking for. For each
portion, I'll talk about the status of the code in Perforce. At the end,
I'll talk about the status of the posted binaries.

 

Basic Status

 

StringTemplate and the ANTLR Tool: Up-to-date with the Java version for
all targets as of August 4, 2009, which covers all of the changes made
earlier in the year and over the summer.

 

CSharp3 Target: working and extensively used in the ANTLR Tool,
StringTemplate, and the commercial projects I use ANTLR for. I haven't
tested the -profile and -debug modes because I don't use them, however
the templates should be "close to working". Currently, the CSharp3
target can only be used when generating grammars from the C# port of the
tool.

 

Design Changes

 

1.       Rather than package the target templates as resources in the
tool's executable, I've chosen a flat file layout. That way, the
templates for a target can be updated without recompiling the tool. The
targets themselves are also implemented as individual DLL's.

2.       The CSharp3 target declares rules as private methods by
default. Rules can be made public by simply marking them as such in the
grammar: "public compile_unit : declaration*;" I have updated the Java
target's code generation to support this as well, but it's not checked
in.

3.       StringTemplate has code for a high speed dynamically compiled
interpreter. By default, the build doesn't enable this mode, but when
it's turned on the output appears to work correctly. I need to do
another round of tests, but at this point the C# ports of the ANTLR Tool
and StringTemplate should be significantly faster than the Java version.
We've hit a brick wall preventing further optimization without rewriting
ST, but the work on STv4 should give another order of magnitude
improvement in template rendering performance.

 

Things Holding Me Up

 

1.       I haven't finalized the way I'm going to do assembly
versioning, although I think I've got that worked out now. I'll send a
separate mail to the list regarding this.

2.       StringTemplate is only tested in regards to code generation for
the ANTLR tool. In particular, its ability to locate templates in
resources or on the file system is not documented and may or may not
behave as people expect.

3.       I'm still making periodic changes to the API as I finalize
things, and breaking changes in production code aren't good. I don't
want to suggest replacing the CSharp2 target until the CSharp3 target is
more tested by other people.

 

Things I want to do, but not really holding up the builds

 

I really want to package a clean integration of ANTLR+CSharp3 for
MSBuild. We need this. This would include at least MSBuild targets file
and templates for adding grammars to a project. Unfortunately, there are
many issues I still need to resolve for this to be a reality, most of
which have answers in shades of gray.

 

Status of the Posted Build

 

The build available for download was uploaded on fairly short notice.
Mistakes (by me) included not having the assembly version set correctly
and not posting the source code from the build with the binaries. I've
been trying to wrap some of these things up before posting another
build.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/734239ec/attachment.html 

From news at heliks.nl  Tue Oct 20 13:27:43 2009
From: news at heliks.nl (Robert van der Hulst)
Date: Tue, 20 Oct 2009 22:27:43 +0200
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports
	of ANTLR and StringTemplate
In-Reply-To: <DD5A5D428FE040429CCDF377FAA892840152DDDD@martini.ironwillgames.com>
References: <DD5A5D428FE040429CCDF377FAA892840152DDDD@martini.ironwillgames.com>
Message-ID: <8410451559.20091020222743@heliks.nl>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/65d74ab9/attachment.html 

From david-sarah at jacaranda.org  Tue Oct 20 16:24:04 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Wed, 21 Oct 2009 00:24:04 +0100
Subject: [antlr-interest] Bytes Limit
In-Reply-To: <848594440910192159j666de8a1tb623966daa502fd6@mail.gmail.com>
References: <848594440910192159j666de8a1tb623966daa502fd6@mail.gmail.com>
Message-ID: <4ADE4694.5010302@jacaranda.org>

Marcelo Nichele wrote:
> Hi,
> 
> I'm getting started in ANTLR and my grammar generated the
> specialStateTransition method too big.
> 
> The error message is *The code of method specialStateTransition(int,
> IntStream) is exceeding the 65535 bytes limit.*
> 
> The method assignature is:
> *public int specialStateTransition(int s, IntStream _input) throws
> NoViableAltException*

Workaround:

Look at the code for that method in the generated parser source
(note that there may be multiple DFA inner classes each with a
specialStateTransition method; the full error message should say which
one, or just look at the largest such methods).
Probably the code for specialStateTransition will include code copied
from predicates in your grammar, duplicated many times. Try to simplify
the code that is being duplicated.

For example, you could declare a boolean variable in the parser class
using @parser::members, set it to the predicate condition in an @init
block of the relevant rule(s), and reference that variable in place of
the original condition. (Be careful that you aren't changing the behaviour
of the rule by moving the predicate evaluation to the @init block.)


Suggested longer-term improvement:

The size of the generated specialStateTransition methods would be
considerably reduced if ANTLR were to automatically create temporary
variables for predicate conditions, rather than duplicating their code.
Since the DFA object is an instance of an inner class of the parser,
the workaround above requires the Java compiler to generate references
to outer class variables, which is more code than would be needed if
ANTLR were to create such temporaries as local variables of
specialStateTransition. Since there is no guarantee as to how often
predicates are evaluated, that change would not affect correctness.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Wed Oct 21 00:57:29 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 21 Oct 2009 13:27:29 +0530
Subject: [antlr-interest] Bytes Limit
In-Reply-To: <C7032878.927%horst.dehmer@inode.at>
Message-ID: <b6a29c89442d004088022678aea26396@temporal-wave.com>

This is also quite often caused by a poorly specified grammar (especially lexers) causing lots lookahead and states etc. A good way to determine this is to find the DFA in question in the generated source code and see what decisions/rules it is handling. This should help you pin down where things are getting so big and then you can look at the why.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Horst Dehmer
Sent: Tuesday, October 20, 2009 12:13 PM
To: Marcelo Nichele; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Bytes Limit

 

Hello Marcelo,

i'm afraid you hit a hard limit with java binary class files. how is your grammar looking, is it unusually big?
have also a look at
http://groups.google.com/group/comp.lang.java.machine/browse_thread/thread/b0cf268515f1ef55

good luck,
horst


On 20.10.09 06:59, "Marcelo Nichele" <marcelo.nichele at gmail.com> wrote:

The code of method specialStateTransition(int, IntStream) is exceeding the 65535 bytes limit



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/733c4727/attachment.html 

From jimi at temporal-wave.com  Wed Oct 21 01:17:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 21 Oct 2009 13:47:59 +0530
Subject: [antlr-interest] Status of the CSharp3 target and my C# portsof
	ANTLR and StringTemplate
In-Reply-To: <DD5A5D428FE040429CCDF377FAA892840152DDE3@martini.ironwillgames.com>
Message-ID: <e46f9f31c2cbe74683984d2670bed31e@temporal-wave.com>

I think we can expose the public/private stuff easily. I will talk to Ter in case there is some reason it is not right now, but I don't think so as the ability to do this is part of the current v2 grammar and I just coded it in my v3 grammar. We should probably move this to ANTLR dev list.

 

Jim

 

From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: Tuesday, October 20, 2009 10:26 PM
To: Jim Idle; antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: RE: [antlr-interest] Status of the CSharp3 target and my C# portsof ANTLR and StringTemplate

 

The code should be nearly the same as that of the CSharp2 target. Here is the C# port of the CSharp2 target and CSharp3 target so you can see how the CSharp3 one differs. Clearly it should be easy to make it work.

 

public class CSharp2Target : Target

{

    public override string EncodeIntAsCharEscape(int v)

    {

        return "\\x" + v.ToString("X");

    }

}

 

public class CSharp3Target : Target

{

    public override string EncodeIntAsCharEscape(int v)

    {

        return "\\x" + v.ToString("X");

    }

 

    public override string GetTarget64BitStringFromValue(ulong word)

    {

        return "0x" + word.ToString("X");

    }

}

 

Something to note: I'm not sure the Java version of the tool exposes the property required to support marking rules as public/protected/private. We'll have to check that out too, but it should be straightforward.

 

Sam

 

From: Jim Idle [mailto:jimi at temporal-wave.com] 
Sent: Tuesday, October 20, 2009 12:08 AM
To: Sam Harwell; antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: RE: [antlr-interest] Status of the CSharp3 target and my C# portsof ANTLR and StringTemplate

 

OK - well we can add that easily enough J Why don't we try it?

 

Jim

 

From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: Tuesday, October 20, 2009 7:46 AM
To: Jim Idle; antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: RE: [antlr-interest] Status of the CSharp3 target and my C# portsof ANTLR and StringTemplate

 

I think the only thing missing is the Java class required for the Java version to know the CSharp3 target exists.

 

Sam

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Tuesday, October 20, 2009 2:51 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: Re: [antlr-interest] Status of the CSharp3 target and my C# portsof ANTLR and StringTemplate

 

Top posting for Sam's benefit ;-)

 

Not being able to use the Csharp3 target from the standard version of the tool is going to be a turn off for many I think L What is it that your port of the tool has that the standard version does not. I know you have posted some of that, but perhaps we can summarize this and see if such things can be absorbed into the standard Java tool? Nobody minds you having your own version of anything because it is open source, but most will want ot use the 'offical' java version of the tool even if they are targeting C#.

 

Thanks for the updates,

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Sam Harwell
Sent: Monday, October 19, 2009 1:05 AM
To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
Subject: [antlr-interest] Status of the CSharp3 target and my C# ports of ANTLR and StringTemplate

 

Hi everyone,

 

Here's a status update that I know many people are asking for. For each portion, I'll talk about the status of the code in Perforce. At the end, I'll talk about the status of the posted binaries.

 

Basic Status

 

StringTemplate and the ANTLR Tool: Up-to-date with the Java version for all targets as of August 4, 2009, which covers all of the changes made earlier in the year and over the summer.

 

CSharp3 Target: working and extensively used in the ANTLR Tool, StringTemplate, and the commercial projects I use ANTLR for. I haven't tested the -profile and -debug modes because I don't use them, however the templates should be "close to working". Currently, the CSharp3 target can only be used when generating grammars from the C# port of the tool.

 

Design Changes

 

1.       Rather than package the target templates as resources in the tool's executable, I've chosen a flat file layout. That way, the templates for a target can be updated without recompiling the tool. The targets themselves are also implemented as individual DLL's.

2.       The CSharp3 target declares rules as private methods by default. Rules can be made public by simply marking them as such in the grammar: "public compile_unit : declaration*;" I have updated the Java target's code generation to support this as well, but it's not checked in.

3.       StringTemplate has code for a high speed dynamically compiled interpreter. By default, the build doesn't enable this mode, but when it's turned on the output appears to work correctly. I need to do another round of tests, but at this point the C# ports of the ANTLR Tool and StringTemplate should be significantly faster than the Java version. We've hit a brick wall preventing further optimization without rewriting ST, but the work on STv4 should give another order of magnitude improvement in template rendering performance.

 

Things Holding Me Up

 

1.       I haven't finalized the way I'm going to do assembly versioning, although I think I've got that worked out now. I'll send a separate mail to the list regarding this.

2.       StringTemplate is only tested in regards to code generation for the ANTLR tool. In particular, its ability to locate templates in resources or on the file system is not documented and may or may not behave as people expect.

3.       I'm still making periodic changes to the API as I finalize things, and breaking changes in production code aren't good. I don't want to suggest replacing the CSharp2 target until the CSharp3 target is more tested by other people.

 

Things I want to do, but not really holding up the builds

 

I really want to package a clean integration of ANTLR+CSharp3 for MSBuild. We need this. This would include at least MSBuild targets file and templates for adding grammars to a project. Unfortunately, there are many issues I still need to resolve for this to be a reality, most of which have answers in shades of gray.

 

Status of the Posted Build

 

The build available for download was uploaded on fairly short notice. Mistakes (by me) included not having the assembly version set correctly and not posting the source code from the build with the binaries. I've been trying to wrap some of these things up before posting another build.

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/45738851/attachment.html 

From jimi at temporal-wave.com  Wed Oct 21 01:14:25 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 21 Oct 2009 13:44:25 +0530
Subject: [antlr-interest] Using multiple grammars with a single parser
In-Reply-To: <ddac439a0910200636w1d1474a3g7b55480e48737a5f@mail.gmail.com>
Message-ID: <b51176887aa850468cec0244e1a67da0@temporal-wave.com>

This has been covered in previous discussions (use the search), but basically you create tokens that look for dates using code that is sensitive to the locale, which leaves you with a single lexer with a code based match rather than pattern based match. 

 

DATE : '#' // Assuming that you delimit the dates somehow

              {

                  setText(myDateFunctionThatReturnsString());

              }

             '#'

          ;

 

There are other approaches than returning the string but you should get the picture?

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Parambir Singh
Sent: Tuesday, October 20, 2009 7:06 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Using multiple grammars with a single parser

 

Hi

 

I am working on a project where I want to parse input in different locales (e.g. english, french & german dates). I don't want to create multiple parsers, since the semantics of the grammar don't change between locales. So probably I'll need multiple lexers and a single parser. Moreover, I want to specify a locale to the parser and the input should be matched against only that particular locale (e.g. german dates should be invalid in english locale). 

 

What would be the best approach to construct such a parser using ANTLR. I don't have much experience with ANTLR but I read about grammar inheritance and think it could be useful here.

 

Thanks

Param




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/f2d7d8df/attachment.html 

From phungngochieu at gmail.com  Wed Oct 21 03:23:47 2009
From: phungngochieu at gmail.com (Hieu Phung)
Date: Wed, 21 Oct 2009 18:23:47 +0800
Subject: [antlr-interest] [Antlr3 grammar] how to specify alpha token,
	numeric token and mix of 	both
Message-ID: <2d17b250910210323q1703906dnd5b4339e472f6adf@mail.gmail.com>

Hi all,

My grammar has 3 kinds of tokens:
1) number: contain numeric character
2) alpha: contain alphabetic character;
3) mix: contain number and alpha and hyphen, full stop or space

For example:
1/VEC305/03MAR/PTY
=> in the above input data, 03MAR should be interpreted as a number of
length 2 followed by alpha of length 3. But VEC305 is a mix of length 6.

If I define grammar like below:

NUMBER    : ('0'..'9')+ ;
ALPHA    : ('a'..'z'|'A'..'Z')+;
MIX    : (NUMBER | ALPHA | OTHER)+;
fragment OTHER    : (' ' | '-' | '.')+;
SLANT    :    '/';

Antlr will return me VEC305 and 03MAR as two MIX tokens. Is there any way to
define tokens such that Antlr will return me number, slant, mix, slant,
number, alpha, slant, alpha for the input "1/VEC305/03MAR/PTY" ?

Thank you very much for your suggestions.

Regards,
Helen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/c2aac0a2/attachment.html 

From kaleb.pederson at gmail.com  Wed Oct 21 08:36:07 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Wed, 21 Oct 2009 08:36:07 -0700
Subject: [antlr-interest] [Antlr3 grammar] how to specify alpha token,
	numeric token and mix of 	both
In-Reply-To: <2d17b250910210323q1703906dnd5b4339e472f6adf@mail.gmail.com>
References: <2d17b250910210323q1703906dnd5b4339e472f6adf@mail.gmail.com>
Message-ID: <200910210836.07105.kaleb.pederson@gmail.com>

On Wednesday 21 October 2009 03:23:47 am Hieu Phung wrote:
> My grammar has 3 kinds of tokens:
> 1) number: contain numeric character
> 2) alpha: contain alphabetic character;
> 3) mix: contain number and alpha and hyphen, full stop or space
> 
> For example:
> 1/VEC305/03MAR/PTY
> => in the above input data, 03MAR should be interpreted as a number of
> length 2 followed by alpha of length 3. But VEC305 is a mix of length 6.

Hieu,

How do you know that VEC305 is a mix of length six?  It sure looks like an alpha followed by a number to me... so what makes it special or different than 03MAR?

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From david-sarah at jacaranda.org  Wed Oct 21 19:20:47 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 22 Oct 2009 03:20:47 +0100
Subject: [antlr-interest] [Antlr3 grammar] how to specify alpha token,
 numeric token and mix of both
In-Reply-To: <2d17b250910210323q1703906dnd5b4339e472f6adf@mail.gmail.com>
References: <2d17b250910210323q1703906dnd5b4339e472f6adf@mail.gmail.com>
Message-ID: <4ADFC17F.1050000@jacaranda.org>

Hieu Phung wrote:
> Hi all,
> 
> My grammar has 3 kinds of tokens:
> 1) number: contain numeric character
> 2) alpha: contain alphabetic character;
> 3) mix: contain number and alpha and hyphen, full stop or space
> 
> For example:
> 1/VEC305/03MAR/PTY
> => in the above input data, 03MAR should be interpreted as a number of
> length 2 followed by alpha of length 3. But VEC305 is a mix of length 6.
> 
> If I define grammar like below:
> 
> NUMBER    : ('0'..'9')+ ;
> ALPHA    : ('a'..'z'|'A'..'Z')+;
> MIX    : (NUMBER | ALPHA | OTHER)+;
> fragment OTHER    : (' ' | '-' | '.')+;
> SLANT    :    '/';
> 
> Antlr will return me VEC305 and 03MAR as two MIX tokens. Is there any way to
> define tokens such that Antlr will return me number, slant, mix, slant,
> number, alpha, slant, alpha for the input "1/VEC305/03MAR/PTY" ?

Since you don't want "03MAR" to be interpreted as a MIX, presumably you
mean that a MIX cannot start with a NUMBER. In that case, try:

  fragment DIGIT  : '0'..'9' ;
  fragment LETTER : 'a'..'z' | 'A'..'Z' ;
  fragment SYMBOL : ' ' | '-' | '.' ;

  NUMBER : DIGIT+ ;
  ALPHA  : LETTER+ ;
  MIX    : LETTER+ (DIGIT | SYMBOL) (DIGIT | LETTER | SYMBOL)*
         | SYMBOL (DIGIT | LETTER | SYMBOL)*
         ;
  SLANT  : '/';

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From bob at wentworth.bz  Wed Oct 21 19:32:10 2009
From: bob at wentworth.bz (Robert Wentworth)
Date: Wed, 21 Oct 2009 22:32:10 -0400
Subject: [antlr-interest] How to overcome Lexer generation OutOfMemoryError?
Message-ID: <181026F8-4037-4477-9865-8FA7B0B2B89E@wentworth.bz>

Trying to generate code for the grammar below generates an  
OutOfMemoryError related to trying to analyze a DFA for the Lexer.

Can anyone suggest how I can successfully generate an ANTLR Lexer for  
this grammar (or an equivalent grammar)?

Notes:

(1) For STRINGFIELD and NUMBERFIELD, I've tried both listing out all  
words I want to match explicitly (as in the commented text), and  
constructing a rule that amounts to a decision tree to match the same  
fields (the non-commented version). Both approaches lead to the same  
problem.

(2) Note that the problem apparently arises because of an interaction  
with the presence of the WORD rule.  If I have just STRINGFIELD and  
NUMBERFIELD, or just WORD, then ANTLR easily generates code.

(3) The grammar I really want to generate has several more Lexer rules  
of comparable complexity.

Thoughts?

Thank you,
Bob Wentworth


/////////////////////////////////////////////////////////////////////

grammar LISQueryLex;

options {
	backtrack = true;
	memoize = true;
	output = template;
}

@parser::header { package dummy; }
@lexer::header { package dummy; }



WHITESPACE	:	(' ' | '\t' | '\r' | '\n')+ {$channel = HIDDEN;} ;

/*
STRINGFIELD	:	  'datatext' | 'all'
			| 'text' | 'txt'
			| 'billtext' | 'btxt'
			| 'reporttext' | 'rtxt'
			| 'legislationtp' | 'ltp'
			| 'titlesummarysubjecttext' | 'wordphrase' | 'tisstxt' | 'wp' |  
'default'
			| 'titlesummarysubject' | 'tisummsubj' | 'tiss'
			| 'titlesummary' | 'tisumm'
			| 'title' | 'ti'
			| 'latesttitle' | 'lti'
			| 'member' | 'memb'
			| 'sponsorcosponsor' | 'spco'
			| 'sponsor' | 'spon'
			| 'cosponsor' | 'cosp'
			| 'originalcosponsor' | 'ocosp'
			| 'withdrawncosponosor' | 'wcosp'
			| 'committee' | 'comm'
			| 'committeeactivitytype' | 'commactvtp'
			| 'status' | 'action' | 'actn'
			| 'lateststatus' | 'latestaction' | 'lactn'
			| 'majoraction' | 'mactn'
			| 'latestmajoraction' | 'lmactn'
			| 'subject' | 'subj' | 'sterm'
			| 'topterm' | 'tterm'
			| 'primaryterm' | 'pterm'
			| 'summary' | 'summ'
			| 'latestsummary' | 'lsumm'
			| 'note'
			| 'lawdate' | 'lawdt'
			| 'reporttype' | 'rtp'
			| 'version' | 'ver'
			| 'relationship' | 'related' | 'rel'
			| 'calendartype' | 'caltp'
			| 's_foo' | 's_bar' ;
*/
STRINGFIELD :  
('a 
'('ct 
'('ion 
'| 
'n 
')| 
'll 
')| 
'b 
'('illtext 
'| 
'txt 
')| 
'c 
'('al 
'('endartype 
'| 
'tp 
')| 
'o 
'('mm 
'('actvtp 
'| 
'ittee 
'('activitytype 
'| 
)| 
)| 
'sp 
'('onsor 
'| 
)))| 
'd 
'('atatext 
'| 
'efault 
')| 
'l 
'('a 
'('ctn 
'| 
'test 
'('action 
'| 
'majoraction 
'| 
's 
'('tatus 
'| 
'ummary 
')| 
'title 
')| 
'wd 
'('ate 
'| 
't 
'))| 
'egislationtp 
'| 
'mactn 
'| 
'summ 
'| 
't 
'('i 
'| 
'p 
'))| 
'm 
'('a 
'('ctn 
'| 
'joraction 
')| 
'emb 
'('er 
'| 
))| 
'note 
'| 
'o 
'('cosp 
'| 
'riginalcosponsor 
')| 
'p 
'('rimaryterm 
'| 
'term 
')| 
'r 
'('e 
'('l 
'('at 
'('ed 
'| 
'ionship 
')| 
)| 
'portt 
'('ext 
'| 
'ype 
'))| 
't 
'('p 
'| 
'xt 
'))| 
's 
'('p 
'('co 
'| 
'on 
'('sor 
'('cosponsor 
'| 
)| 
))| 
't 
'('atus 
'| 
'erm 
')| 
'u 
'('bj 
'('ect 
'| 
)| 
'mm 
'('ary 
'| 
))| 
'_ 
'('bar 
'| 
'foo 
'))| 
't 
'('ext 
'| 
'i 
'('s 
'('s 
'('txt 
'| 
)| 
'umm 
'('subj 
'| 
))| 
'tle 
'('summary 
'('subject 
'('text 
'| 
)| 
)| 
)| 
)| 
'opterm 
'| 
'term 
'| 
'xt')|'ver'('sion'|)|'w'('cosp'|'ithdrawncosponosor'|'ordphrase'|'p'));

/*
NUMBERFIELD	:	  'congress' | 'cong' | 'cno'
			| 'legislationnumber' | 'lno'
			| 'legislationinteger' | 'lin'
			| 'legislationpart' | 'lpt'
			| 'titletypecode' | 'titpcd'
			| 'membercode' | 'membcd'
			| 'district' | 'dist'
			| 'sponsorcosponsorcode' | 'spcocd'
			| 'sponsorcosponsordistrict' | 'spcodist'
			| 'sponsorcode' | 'sponcd'
			| 'sponsordistrict' | 'spondist'
			| 'sponsortypecode' | 'spontpcd'
			| 'cosponsorcode' | 'cospcd'
			| 'cosponsordistrict' | 'cospdist'
			| 'cosponsorcount' | 'cospct'
			| 'originalcosponosorcode' | 'ocospcd'
			| 'originalcosponsordistrict' | 'ocospdist'
			| 'originalcosponsorcount' | 'ocospct'
			| 'withdrawncosponosorcode' | 'wcospcd'
			| 'withdrawncosponsordistrict' | 'wcospdist'
			| 'withdrawncosponosorcount' | 'wcospct'
			| 'committeeactivitytypecode' | 'commactvtpcd'
			| 'housecommitteecount' | 'hcommct'
			| 'senatecommitteecount' | 'scommct'
			| 'statussessiontypecode' | 'actionsessiontypecode' | 'actnsntpcd'
			| 'majoractioncode' | 'mactncd'
			| 'latestmajoractioncode' | 'lmactncd'
			| 'summarytypecode' | 'summtpcd'
			| 'relationshipcode' | 'relatedcode' | 'relcd'
			| 'crpageinteger' | 'crpin'
			| 'voteinteger' | 'votein'
			| 'calendarintegers' | 'calin'
			| 'amendmentstointegers' | 'amdtstoin'
			| 'searchcode' | 'srchcd'
			| 'n_foo' | 'n_bar' ;
*/
NUMBERFIELD :  
('a 
'('ct 
'('ionsessiontypecode 
'| 
'nsntpcd 
')| 
'm 
'('dtstoin 
'| 
'endmentstointegers 
'))| 
'c 
'('al 
'('endarintegers 
'| 
'in 
')| 
'no 
'| 
'o 
'('mm 
'('actvtpcd 
'| 
'itteeactivitytypecode 
')| 
'ng 
'('ress 
'| 
)| 
'sp 
'('c 
'('d 
'| 
't 
')| 
'dist 
'| 
'onsor 
'('co 
'('de 
'| 
'unt 
')| 
'district 
')))| 
'rp 
'('ageinteger 
'| 
'in 
'))| 
'dist 
'('rict 
'| 
)| 
'h 
'('commct 
'| 
'ousecommitteecount 
')| 
'l 
'('atestmajoractioncode 
'| 
'egislation 
'('integer 
'| 
'number 
'| 
'part 
')| 
'in 
'| 
'mactncd 
'| 
'no 
'| 
'pt 
')| 
'm 
'('a 
'('ctncd 
'| 
'joractioncode 
')| 
'emb 
'('cd 
'| 
'ercode 
'))| 
'n_ 
'('bar 
'| 
'foo 
')| 
'o 
'('cosp 
'('c 
'('d 
'| 
't 
')| 
'dist 
')| 
'riginalcospon 
'('osorcode 
'| 
'sor 
'('count 
'| 
'district 
')))| 
'rel 
'('at 
'('edcode 
'| 
'ionshipcode 
')| 
'cd 
')| 
's 
'('commct 
'| 
'e 
'('archcode 
'| 
'natecommitteecount 
')| 
'p 
'('co 
'('cd 
'| 
'dist 
')| 
'on 
'('cd 
'| 
'dist 
'| 
'sor 
'('co 
'('de 
'| 
'sponsor 
'('code 
'| 
'district 
'))| 
'district 
'| 
'typecode 
')| 
'tpcd 
'))| 
'rchcd 
'| 
'tatussessiontypecode 
'| 
'umm 
'('arytypecode 
'| 
'tpcd 
'))| 
'tit 
'('letypecode 
'| 
'pcd 
')| 
'votein 
'('teger 
'| 
)| 
'w 
'('cosp 
'('c 
'('d 
'|'t')|'dist')|'ithdrawncospon'('osorco'('de'|'unt')|'sordistrict')));


WORD		:	(~(' '|'\t'|'\r'|'\n'|'('|')'|','|'='|'!'|'<'|'>'|'"'|'-'|'/')) 
+  ;

tmp	:	STRINGFIELD;

From Gordon.Tyler at quest.com  Thu Oct 22 06:32:21 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Thu, 22 Oct 2009 06:32:21 -0700
Subject: [antlr-interest] How to overcome Lexer generation
 OutOfMemoryError?
In-Reply-To: <181026F8-4037-4477-9865-8FA7B0B2B89E@wentworth.bz>
References: <181026F8-4037-4477-9865-8FA7B0B2B89E@wentworth.bz>
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01C506F0B9@alvxmbw04.prod.quest.corp>

This may be a silly question, but have you tried increasing the -Xmx for the JVM?

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Robert Wentworth
Sent: October 21, 2009 10:32 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to overcome Lexer generation OutOfMemoryError?

Trying to generate code for the grammar below generates an  
OutOfMemoryError related to trying to analyze a DFA for the Lexer.

Can anyone suggest how I can successfully generate an ANTLR Lexer for  
this grammar (or an equivalent grammar)?

Notes:

(1) For STRINGFIELD and NUMBERFIELD, I've tried both listing out all  
words I want to match explicitly (as in the commented text), and  
constructing a rule that amounts to a decision tree to match the same  
fields (the non-commented version). Both approaches lead to the same  
problem.

(2) Note that the problem apparently arises because of an interaction  
with the presence of the WORD rule.  If I have just STRINGFIELD and  
NUMBERFIELD, or just WORD, then ANTLR easily generates code.

(3) The grammar I really want to generate has several more Lexer rules  
of comparable complexity.

Thoughts?

Thank you,
Bob Wentworth


/////////////////////////////////////////////////////////////////////

grammar LISQueryLex;

options {
	backtrack = true;
	memoize = true;
	output = template;
}

@parser::header { package dummy; }
@lexer::header { package dummy; }



WHITESPACE	:	(' ' | '\t' | '\r' | '\n')+ {$channel = HIDDEN;} ;

/*
STRINGFIELD	:	  'datatext' | 'all'
			| 'text' | 'txt'
			| 'billtext' | 'btxt'
			| 'reporttext' | 'rtxt'
			| 'legislationtp' | 'ltp'
			| 'titlesummarysubjecttext' | 'wordphrase' | 'tisstxt' | 'wp' |  
'default'
			| 'titlesummarysubject' | 'tisummsubj' | 'tiss'
			| 'titlesummary' | 'tisumm'
			| 'title' | 'ti'
			| 'latesttitle' | 'lti'
			| 'member' | 'memb'
			| 'sponsorcosponsor' | 'spco'
			| 'sponsor' | 'spon'
			| 'cosponsor' | 'cosp'
			| 'originalcosponsor' | 'ocosp'
			| 'withdrawncosponosor' | 'wcosp'
			| 'committee' | 'comm'
			| 'committeeactivitytype' | 'commactvtp'
			| 'status' | 'action' | 'actn'
			| 'lateststatus' | 'latestaction' | 'lactn'
			| 'majoraction' | 'mactn'
			| 'latestmajoraction' | 'lmactn'
			| 'subject' | 'subj' | 'sterm'
			| 'topterm' | 'tterm'
			| 'primaryterm' | 'pterm'
			| 'summary' | 'summ'
			| 'latestsummary' | 'lsumm'
			| 'note'
			| 'lawdate' | 'lawdt'
			| 'reporttype' | 'rtp'
			| 'version' | 'ver'
			| 'relationship' | 'related' | 'rel'
			| 'calendartype' | 'caltp'
			| 's_foo' | 's_bar' ;
*/
STRINGFIELD :  
('a 
'('ct 
'('ion 
'| 
'n 
')| 
'll 
')| 
'b 
'('illtext 
'| 
'txt 
')| 
'c 
'('al 
'('endartype 
'| 
'tp 
')| 
'o 
'('mm 
'('actvtp 
'| 
'ittee 
'('activitytype 
'| 
)| 
)| 
'sp 
'('onsor 
'| 
)))| 
'd 
'('atatext 
'| 
'efault 
')| 
'l 
'('a 
'('ctn 
'| 
'test 
'('action 
'| 
'majoraction 
'| 
's 
'('tatus 
'| 
'ummary 
')| 
'title 
')| 
'wd 
'('ate 
'| 
't 
'))| 
'egislationtp 
'| 
'mactn 
'| 
'summ 
'| 
't 
'('i 
'| 
'p 
'))| 
'm 
'('a 
'('ctn 
'| 
'joraction 
')| 
'emb 
'('er 
'| 
))| 
'note 
'| 
'o 
'('cosp 
'| 
'riginalcosponsor 
')| 
'p 
'('rimaryterm 
'| 
'term 
')| 
'r 
'('e 
'('l 
'('at 
'('ed 
'| 
'ionship 
')| 
)| 
'portt 
'('ext 
'| 
'ype 
'))| 
't 
'('p 
'| 
'xt 
'))| 
's 
'('p 
'('co 
'| 
'on 
'('sor 
'('cosponsor 
'| 
)| 
))| 
't 
'('atus 
'| 
'erm 
')| 
'u 
'('bj 
'('ect 
'| 
)| 
'mm 
'('ary 
'| 
))| 
'_ 
'('bar 
'| 
'foo 
'))| 
't 
'('ext 
'| 
'i 
'('s 
'('s 
'('txt 
'| 
)| 
'umm 
'('subj 
'| 
))| 
'tle 
'('summary 
'('subject 
'('text 
'| 
)| 
)| 
)| 
)| 
'opterm 
'| 
'term 
'| 
'xt')|'ver'('sion'|)|'w'('cosp'|'ithdrawncosponosor'|'ordphrase'|'p'));

/*
NUMBERFIELD	:	  'congress' | 'cong' | 'cno'
			| 'legislationnumber' | 'lno'
			| 'legislationinteger' | 'lin'
			| 'legislationpart' | 'lpt'
			| 'titletypecode' | 'titpcd'
			| 'membercode' | 'membcd'
			| 'district' | 'dist'
			| 'sponsorcosponsorcode' | 'spcocd'
			| 'sponsorcosponsordistrict' | 'spcodist'
			| 'sponsorcode' | 'sponcd'
			| 'sponsordistrict' | 'spondist'
			| 'sponsortypecode' | 'spontpcd'
			| 'cosponsorcode' | 'cospcd'
			| 'cosponsordistrict' | 'cospdist'
			| 'cosponsorcount' | 'cospct'
			| 'originalcosponosorcode' | 'ocospcd'
			| 'originalcosponsordistrict' | 'ocospdist'
			| 'originalcosponsorcount' | 'ocospct'
			| 'withdrawncosponosorcode' | 'wcospcd'
			| 'withdrawncosponsordistrict' | 'wcospdist'
			| 'withdrawncosponosorcount' | 'wcospct'
			| 'committeeactivitytypecode' | 'commactvtpcd'
			| 'housecommitteecount' | 'hcommct'
			| 'senatecommitteecount' | 'scommct'
			| 'statussessiontypecode' | 'actionsessiontypecode' | 'actnsntpcd'
			| 'majoractioncode' | 'mactncd'
			| 'latestmajoractioncode' | 'lmactncd'
			| 'summarytypecode' | 'summtpcd'
			| 'relationshipcode' | 'relatedcode' | 'relcd'
			| 'crpageinteger' | 'crpin'
			| 'voteinteger' | 'votein'
			| 'calendarintegers' | 'calin'
			| 'amendmentstointegers' | 'amdtstoin'
			| 'searchcode' | 'srchcd'
			| 'n_foo' | 'n_bar' ;
*/
NUMBERFIELD :  
('a 
'('ct 
'('ionsessiontypecode 
'| 
'nsntpcd 
')| 
'm 
'('dtstoin 
'| 
'endmentstointegers 
'))| 
'c 
'('al 
'('endarintegers 
'| 
'in 
')| 
'no 
'| 
'o 
'('mm 
'('actvtpcd 
'| 
'itteeactivitytypecode 
')| 
'ng 
'('ress 
'| 
)| 
'sp 
'('c 
'('d 
'| 
't 
')| 
'dist 
'| 
'onsor 
'('co 
'('de 
'| 
'unt 
')| 
'district 
')))| 
'rp 
'('ageinteger 
'| 
'in 
'))| 
'dist 
'('rict 
'| 
)| 
'h 
'('commct 
'| 
'ousecommitteecount 
')| 
'l 
'('atestmajoractioncode 
'| 
'egislation 
'('integer 
'| 
'number 
'| 
'part 
')| 
'in 
'| 
'mactncd 
'| 
'no 
'| 
'pt 
')| 
'm 
'('a 
'('ctncd 
'| 
'joractioncode 
')| 
'emb 
'('cd 
'| 
'ercode 
'))| 
'n_ 
'('bar 
'| 
'foo 
')| 
'o 
'('cosp 
'('c 
'('d 
'| 
't 
')| 
'dist 
')| 
'riginalcospon 
'('osorcode 
'| 
'sor 
'('count 
'| 
'district 
')))| 
'rel 
'('at 
'('edcode 
'| 
'ionshipcode 
')| 
'cd 
')| 
's 
'('commct 
'| 
'e 
'('archcode 
'| 
'natecommitteecount 
')| 
'p 
'('co 
'('cd 
'| 
'dist 
')| 
'on 
'('cd 
'| 
'dist 
'| 
'sor 
'('co 
'('de 
'| 
'sponsor 
'('code 
'| 
'district 
'))| 
'district 
'| 
'typecode 
')| 
'tpcd 
'))| 
'rchcd 
'| 
'tatussessiontypecode 
'| 
'umm 
'('arytypecode 
'| 
'tpcd 
'))| 
'tit 
'('letypecode 
'| 
'pcd 
')| 
'votein 
'('teger 
'| 
)| 
'w 
'('cosp 
'('c 
'('d 
'|'t')|'dist')|'ithdrawncospon'('osorco'('de'|'unt')|'sordistrict')));


WORD		:	(~(' '|'\t'|'\r'|'\n'|'('|')'|','|'='|'!'|'<'|'>'|'"'|'-'|'/')) 
+  ;

tmp	:	STRINGFIELD;

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jklumpp at harmonia.com  Thu Oct 22 12:16:55 2009
From: jklumpp at harmonia.com (Jared Klumpp)
Date: Thu, 22 Oct 2009 12:16:55 -0700
Subject: [antlr-interest] Best way to construct informative AST nodes?
Message-ID: <B00C7A477A17884DBB97DEC08EE0DF9E0162CB29@EXVBE010-2.exch010.intermedia.net>

My goal is to create the AST in a way that I can quickly access information about *important* child nodes - for example if I had:

proc : PROCEDURE ident formalPartOpt body -> ^(PROCEDURE_DECL ident formalPartOpt body);

I would like this to create an AST node that would have the identifier and parameters easily accessible, with something like ASTProc.getIdent() or ASTProc.getParams();

I've found three ways of doing this, all seem like they blend the code and grammar too much:

1. Creating heterogeneous tree nodes like on this page: http://www.antlr.org/wiki/display/ANTLR3/Tree+construction - and passing the identifier and formalPartOpt trees as parameters

2. Using custom AST nodes, and whenever a child is added to a custom ASTProc node, testing if it is of a type I care about - i.e., if child.getType() == Lexer.IDENT, store that as the name of the procedure.

3. Wait until the information is requested from the node and traverse the tree to find the name or parameters.

Are there other ways of doing this that are more efficient/decouple the AST creation from the grammar a little better?

Thanks in advance,
Jared
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091022/24e94d99/attachment.html 

From yurushkin at rambler.ru  Thu Oct 22 14:51:29 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Fri, 23 Oct 2009 01:51:29 +0400
Subject: [antlr-interest] c target  - bug
Message-ID: <op.u171n3n6t3jqlu@win-mupvrp0jyrf>


line 2086
ErrorType: last closing scope is redundant.
> while ( (stream_term != NULL && stream_term->hasNext(stream_term))  
> ||stream_SIGN != NULL && stream_SIGN->hasNext(stream_SIGN))  )


====================
LEXER:


lexer grammar MathLexer;

options {
     language = C;
}


APOSTROPHE: '\''; // for derivative
ASSIGN: '=';
CARET: '^'; // for exponentiation
FUNCTIONS: 'functions'; // for list command
HELP: '?' | 'help';
LEFT_PAREN: '(';
LIST: 'list';
PRINT: 'print';
RIGHT_PAREN: ')';
SIGN: '+' | '-';
VARIABLES: 'variables'; // for list command

NUMBER: INTEGER | FLOAT;
fragment FLOAT: INTEGER '.' '0'..'9'+;
fragment INTEGER: '0' | SIGN? '1'..'9' '0'..'9'*;
NAME: LETTER (LETTER | DIGIT | '_')*;
STRING_LITERAL: '"' NONCONTROL_CHAR* '"';

fragment NONCONTROL_CHAR: LETTER | DIGIT | SYMBOL | SPACE;
fragment LETTER: LOWER | UPPER;
fragment LOWER: 'a'..'z';
fragment UPPER: 'A'..'Z';
fragment DIGIT: '0'..'9';
fragment SPACE: ' ' | '\t';

// Note that SYMBOL does not include the double-quote character.
fragment SYMBOL: '!' | '#'..'/' | ':'..'@' | '['..'`' | '{'..'~';

// Windows uses \r\n. UNIX and Mac OS X use \n.
// To use newlines as a terminator,
// they can't be written to the hidden channel!
NEWLINE: ('\r'? '\n')+;
WHITESPACE: SPACE+ { $channel = HIDDEN; };


========================================

PARSER:

parser grammar MathParser;

options {
     // We're going to output an AST.
     output = AST;
     language = C;

     // We're going to use the tokens defined in our MathLexer grammar.
     tokenVocab = MathLexer;
}

// These are imaginary tokens that will serve as parent nodes
// for grouping other tokens in our AST.
tokens {
     COMBINE;
     DEFINE;
     DERIVATIVE;
     FUNCTION;
     POLYNOMIAL;
     TERM;
}

@parser::includes
{
     #include <string>
     using std::string;

     #define getTokenText(token) string((char*)token->getText(token)->chars)
}



// This is the "start rule".
// EOF is a predefined token that represents the end of input.
// The "start rule" should end with this.
// Note the use of the ! AST operator
// to avoid adding the EOF token to the AST.
script: statement* EOF!;

statement: assign | define | interactiveStatement | combine | print;

// These kinds of statements only need to be supported
// when reading input from the keyboard.
interactiveStatement: help | list;

// Examples of input that match this rule include
// "a = 19", "a = b", "a = f(2)" and "a = f(b)".
assign: NAME ASSIGN value terminator -> ^(ASSIGN NAME value);

value: NUMBER | NAME | functionEval;

// A parenthesized group in a rule alternative is called a "subrule".
// Examples of input that match this rule include "f(2)" and "f(b)".
functionEval
     : fn=NAME LEFT_PAREN (v=NUMBER | v=NAME) RIGHT_PAREN -> ^(FUNCTION $fn
$v);

// EOF cannot be used in lexer rules, so we made this a parser rule.
// EOF is needed here for interactive mode where each line entered ends in
EOF
// and for file mode where the last line ends in EOF.
terminator: NEWLINE | EOF;

// Examples of input that match this rule include
// "f(x) = 3x^2 - 4" and "g(x) = y^2 - 2y + 1".
// Note that two parameters are passed to the polynomial rule.
define
     : fn=NAME LEFT_PAREN fv=NAME RIGHT_PAREN ASSIGN
       polynomial[getTokenText($fn), getTokenText($fv)] terminator
       -> ^(DEFINE $fn $fv polynomial);

// Examples of input that match this rule include
// "3x2 - 4" and "y^2 - 2y + 1".
// fnt = function name text; fvt = function variable text
// Note that two parameters are passed in each invocation of the term rule.
polynomial[string fnt, string fvt]
     : term[$fnt, $fvt] (SIGN term[$fnt, $fvt])*
       -> ^(POLYNOMIAL term (SIGN term)*);

// Examples of input that match this rule include
// "4", "4x", "x^2" and "4x^2".
// fnt = function name text; fvt = function variable text
term[string fnt, string fvt]
     // tv = term variable
     : c=coefficient? (tv=NAME e=exponent?)?
       // What follows is a validating semantic predicate.
       // If it evaluates to false, a FailedPredicateException will be
thrown.
       // It is testing whether the term variable matches the function
variable.
       { tv == 0 ? true : getTokenText($tv) == $fvt }?
       -> ^(TERM $c? $tv? $e?)
     ;
     // This catches bad function definitions such as
     // f(x) = 2y
     catch [3] {
       throw 0;
     }

coefficient: NUMBER;

// An example of input that matches this rule is "^2".
exponent: CARET NUMBER -> NUMBER;

// Inputs that match this rule are "?" and "help".
help: HELP terminator -> HELP;

// Inputs that match this rule include
// "list functions" and "list variables".
list
     : LIST listOption terminator -> ^(LIST listOption);

// Inputs that match this rule are "functions" and "variables".
listOption: FUNCTIONS | VARIABLES;

// Examples of input that match this rule include
// "h = f + g" and "h = f - g".
combine
     : fn1=NAME ASSIGN fn2=NAME op=SIGN fn3=NAME terminator
       -> ^(COMBINE $fn1 $op $fn2 $fn3);

// An example of input that matches this rule is
// print "f(" a ") = " f(a)
print
     : PRINT printTarget* terminator -> ^(PRINT printTarget*);

// Examples of input that match this rule include
// 19, 3.14, "my text", a, f(), f(2), f(a) and f'().
printTarget
     : NUMBER -> NUMBER
     | sl=STRING_LITERAL -> $sl
     | NAME -> NAME
     // This is a function reference to print a string representation.
     | NAME LEFT_PAREN RIGHT_PAREN -> ^(FUNCTION NAME)
     | functionEval
     | derivative
     ;

// An example of input that matches this rule is "f'()".
derivative
     : NAME APOSTROPHE LEFT_PAREN RIGHT_PAREN -> ^(DERIVATIVE NAME);


              	        	}

-- 
Best regards,
Michael

From boughtonp at gmail.com  Thu Oct 22 14:53:22 2009
From: boughtonp at gmail.com (Peter Boughton)
Date: Thu, 22 Oct 2009 22:53:22 +0100
Subject: [antlr-interest] "No Past Experience Required"
In-Reply-To: <C6FED743.8DC%horst.dehmer@inode.at>
References: <5d97c170910161428w8022bd2sd9ea6117525e6320@mail.gmail.com>
	<C6FED743.8DC%horst.dehmer@inode.at>
Message-ID: <5d97c170910221453v7cc0b4aao54ee653fced1354d@mail.gmail.com>

Horst and Kyle, I just wanted to send a quick thank you for your replies.

I've been tied up with things and haven't managed to get a solid block
of time to look at all this, but  with luck I'll get some time to
digest all this soon and hopefully make some actual progress with it
all.

Thanks. :)

From yurushkin at rambler.ru  Thu Oct 22 15:08:02 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Fri, 23 Oct 2009 02:08:02 +0400
Subject: [antlr-interest] [C target] how to skip empty lines
Message-ID: <op.u172fot1t3jqlu@win-mupvrp0jyrf>

Good evening.
thanks for your support!

Could u give me one tip.
I user C target and want to parse such input

"a = 3.14
f(x) = 3x^2 - 4x + 2

print "The value of f for " a " is " f(a)
print "The derivative of " f() " is " f'()


list variables
list functions

g(y) = 2y^3 + 6y - 5
h = f + g
print h()"

I use this tutorial
http://jnb.ociweb.com/jnb/jnbJun2008.html

but parser fails.. when finds empty lines. It's correct, but how can i fix  
it? It's common problem for all languages. Programmer can input some empty  
lines between constructions to improve code readability...


-- 
Best regards,
Michael

From yurushkin at rambler.ru  Thu Oct 22 15:52:39 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Fri, 23 Oct 2009 02:52:39 +0400
Subject: [antlr-interest] [C target] INPUT -> TOKENS->AST ->MyAST problems
Message-ID: <op.u174h1b1t3jqlu@win-mupvrp0jyrf>

I know, you don't like be already))
Excuse me for my annoyance, but currently it's very important for me to  
understand some antlr features.

I have my own AST (on C++)... I use C target, because there are no another  
ways.

At first I didn't use AST building... but it was difficult to support  
different problems...

Currently I think to do the following: create AST and convert this AST to  
my own...


But I have a problem with TREE PARSER GRAMMAR.

!!!FIRST SITUATION!!!

rule [returns MySuperNode res]
:
  ^ a=ruleA, b=ruleB, c=ruleC,... z=ruleZ TOKEN1
    { res = f(a.res, b.res, c.res, ..., z.res); };

a, b, c, ..., z - subtries OF MY TREE, pointers.
If at the end of rule the exaption is occured (at the matching of the  
token), rule will report an error and return.
AND ALL POINTERS WILL BE FORGOTTEN. Is there standard method for C target,  
to survive from memory leaks??
Use auto_ptr's?

!!!SECOND SITUATION!!!


rule [returns MySuperNode res]
:
  ^ a=ruleA, b=ruleB, c=ruleC,... z=ruleZ  // without TOKEN1
    { res = f(a.res, b.res, c.res, ..., z.res); };

If at the end of rule the exaption is occured (at the matching of the  
ruleC), BUT HASEXCEPTION() will be equal FALSE!!! because error was  
processed in rileZ... And
  "{ res = f(a.res, b.res, c.res, ..., z.res); };" will be processed with  
z.res=GARBAGE.

SOO... HOW CAN I DISCARD ACTION PROCESSING IF ERROR WAS FIRED IN CHILD  
SUBTREE??


thank u =)



-- 
Best regards,
Michael

From cummings at kjchome.homeip.net  Thu Oct 22 17:15:18 2009
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Thu, 22 Oct 2009 20:15:18 -0400
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
Message-ID: <4AE0F596.9040104@kjchome.homeip.net>

On 10/22/2009 06:08 PM, ??????? ?????? wrote:
> Good evening.
> thanks for your support!
> 
> Could u give me one tip.
> I user C target and want to parse such input
> 
> "a = 3.14
> f(x) = 3x^2 - 4x + 2
> 
> print "The value of f for " a " is " f(a)
> print "The derivative of " f() " is " f'()
> 
> 
> list variables
> list functions
> 
> g(y) = 2y^3 + 6y - 5
> h = f + g
> print h()"
> 
> I use this tutorial
> http://jnb.ociweb.com/jnb/jnbJun2008.html
> 
> but parser fails.. when finds empty lines. It's correct, but how can i fix  
> it? It's common problem for all languages. Programmer can input some empty  
> lines between constructions to improve code readability...

Have your "whitespace" be "skipped" by your lexer?  That's what I do in
almost every compiler I've written.  Your lexer tokenizes, and tokens
can be seperated by whitespace, so, so long as you don't have lexer
rules where whitespace is significant, you should be OK.

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From phungngochieu at gmail.com  Thu Oct 22 20:45:38 2009
From: phungngochieu at gmail.com (Hieu Phung)
Date: Fri, 23 Oct 2009 11:45:38 +0800
Subject: [antlr-interest] [Antlr3 grammar] how to specify alpha token,
	numeric token and mix of both
Message-ID: <2d17b250910222045l24cc4ffg5de424cc1914d1ad@mail.gmail.com>

Hi David,

Thank you for your suggestion. However, a MIX can start with number, '_' and
'.'  :((

Actually I am trying to write a CIMP message format in Antlr. Reference:
http://www.parse2.com/example-cargoimp-FFA4.shtml

Alpha   = %x41-5A;
Numeric = %x30-39;
Decimal = %x30-39 / ".";
Mixed   = Alpha / Numeric;
Text    = %x41-5A / %x30-39 / "." / "-" / " ";   <--- this is my MIX token

This format can be written in ABNF easily... but in Antlr, once I introduce
the MIX token, everything which is mixed of numeric and alpha is returned as
a MIX. Currently I have to use Java code in action to split the MIX string.
I wonder if there's a better way to define tokens because my grammar now is
full of Java code :(! For example:

manifestHeader
    :((n=NUMBER) SLANT (r1=field) SLANT (r2=field) SLANT (r3=ALPHA) (SLANT
(r4=field)?)? )
    {
    ffm.setAttribute("MessageSequenceNumber", $n.text);
    ffm.setAttribute("CarrierCode", $r1.value.substring(0,2));
    ffm.setAttribute("FlightNumber", $r1.value.substring(2));
    ffm.setAttribute("Day", $r2.value.substring(0,2));
    ffm.setAttribute("Month", $r2.value.substring(2));
    ffm.setAttribute("AirportCode", $r3.text);
    if ($r4.value != null) ffm.setAttribute("AircraftIdentification",
$r4.text);
    }
    ;

Regards,
Helen


> Message: 1
> Date: Thu, 22 Oct 2009 03:20:47 +0100
> From: David-Sarah Hopwood <david-sarah at jacaranda.org>
> Subject: Re: [antlr-interest] [Antlr3 grammar] how to specify alpha
>        token, numeric token and mix of both
> To: antlr-interest at antlr.org
> Message-ID: <4ADFC17F.1050000 at jacaranda.org>
> Content-Type: text/plain; charset=UTF-8
>
> Hieu Phung wrote:
> > Hi all,
> >
> > My grammar has 3 kinds of tokens:
> > 1) number: contain numeric character
> > 2) alpha: contain alphabetic character;
> > 3) mix: contain number and alpha and hyphen, full stop or space
> >
> > For example:
> > 1/VEC305/03MAR/PTY
> > => in the above input data, 03MAR should be interpreted as a number of
> > length 2 followed by alpha of length 3. But VEC305 is a mix of length 6.
> >
> > If I define grammar like below:
> >
> > NUMBER    : ('0'..'9')+ ;
> > ALPHA    : ('a'..'z'|'A'..'Z')+;
> > MIX    : (NUMBER | ALPHA | OTHER)+;
> > fragment OTHER    : (' ' | '-' | '.')+;
> > SLANT    :    '/';
> >
> > Antlr will return me VEC305 and 03MAR as two MIX tokens. Is there any way
> to
> > define tokens such that Antlr will return me number, slant, mix, slant,
> > number, alpha, slant, alpha for the input "1/VEC305/03MAR/PTY" ?
>
> Since you don't want "03MAR" to be interpreted as a MIX, presumably you
> mean that a MIX cannot start with a NUMBER. In that case, try:
>
>  fragment DIGIT  : '0'..'9' ;
>  fragment LETTER : 'a'..'z' | 'A'..'Z' ;
>  fragment SYMBOL : ' ' | '-' | '.' ;
>
>  NUMBER : DIGIT+ ;
>  ALPHA  : LETTER+ ;
>  MIX    : LETTER+ (DIGIT | SYMBOL) (DIGIT | LETTER | SYMBOL)*
>         | SYMBOL (DIGIT | LETTER | SYMBOL)*
>         ;
>  SLANT  : '/';
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/46dec364/attachment.html 

From jcottam at umail.iu.edu  Thu Oct 22 20:47:27 2009
From: jcottam at umail.iu.edu (Joseph Cottam)
Date: Thu, 22 Oct 2009 23:47:27 -0400
Subject: [antlr-interest] Contextual Tree Matching
Message-ID: <a01429f40910222047yba4a4b3u24f8ad6762003ca0@mail.gmail.com>

I'm working with the tree pattern matching and think it is excellent
(especially re-writing).
I have repeatedly come across the need to match trees that are descents of
other sub-trees, but have not found an elegant way to do so.

For example...
Given the tree:
  ^(GROUP
        ^(UPDATE ^(SET RULE)  ^(SET RULE))
        ^(UPDATE ^(SET RULE RULE ^(SET RULE RULE))  ^(SET RULE))
        ^(QUERY ^(SET RULE) ^(SET RULE RULE)))

I would like to match all RULE entries that are under an UPDATE but not a
QUERY.

I have come up with two solutions but I'm not happy with either and I'm
wondering if anybody else has a suggestion.

Solution #1:  Specify the nesting path...
topdown: ^(UPDATE matchSet);
matchSet: ^(SET (matchRule | matchSet));
matchRule: RULE {...}

This requires enumerating all of the paths that a value COULD be at, so
things get really ugly if a SET can contain many types of items that can
also contain RULE entries.


Solution #2:  Flag and filter
@members{boolean inUpdate = false;}

topdown
  : ^(UPDATE .*) {inUpdate = true;}
  | {inUpdate}?=> RULE -> ^(RULE NEW STUFF);

bottomup: ^(UPDATE .*) {inUPdate = false;}

The use of state makes a serialization point to flag when I am in a in my
otherwise nicely concurrent application, since there is now a global
variable of the parser called inUpdate.


This need is similar to recursive path operations in Apache Ant with **
specifier (at some depth below).
Is there a similar syntax for ANTLR contextual sub-tree matching?

Many thanks,
-Joseph A. Cottam
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091022/d1704523/attachment.html 

From marcelo.nichele at gmail.com  Thu Oct 22 21:39:25 2009
From: marcelo.nichele at gmail.com (Marcelo Nichele)
Date: Fri, 23 Oct 2009 02:39:25 -0200
Subject: [antlr-interest] Bytes Limit (Marcelo Nichele)
Message-ID: <848594440910222139v280d0373v895b72b0fc6f0cb@mail.gmail.com>

Hi,

I'm using some lexer rules such like 'aaaa', 'bbb', ... Then, the code
generated become too big. So, I reduced some lexer rules and I moved them to
grammar rules.

Ex:
TAG_START_OPEN 'link' attrUriId='uri' ATTR_EQ attrValueUri=ATTR_VALUE
((attrRoleId='role' ATTR_EQ attrValueRole=ATTR_VALUE) | (attrStartId='start'
ATTR_EQ attrValueStart=ATTR_VALUE)|(attrEndId='end' ATTR_EQ
attrValueEnd=ATTR_VALUE))* TAG_EMPTY_CLOSE

Does anyone have any tips?

Thanks for help,

Marcelo


On Wed, Oct 21, 2009 at 5:00 PM, <antlr-interest-request at antlr.org> wrote:

> Send antlr-interest mailing list submissions to
>        antlr-interest at antlr.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>        http://www.antlr.org/mailman/listinfo/antlr-interest
> or, via email, send a message with subject or body 'help' to
>        antlr-interest-request at antlr.org
>
> You can reach the person managing the list at
>        antlr-interest-owner at antlr.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of antlr-interest digest..."
>
>
> Today's Topics:
>
>   1. Re: Status of the CSharp3 target and my C# ports  of ANTLR and
>      StringTemplate (Robert van der Hulst)
>   2. Re: Bytes Limit (David-Sarah Hopwood)
>   3. Re: Bytes Limit (Jim Idle)
>   4. Re: Status of the CSharp3 target and my C# portsof        ANTLR and
>      StringTemplate (Jim Idle)
>   5. Re: Using multiple grammars with a single parser (Jim Idle)
>   6. [Antlr3 grammar] how to specify alpha token,      numeric token
>      and mix of        both (Hieu Phung)
>   7. Re: [Antlr3 grammar] how to specify alpha token,  numeric
>      token and mix of  both (Kaleb Pederson)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Tue, 20 Oct 2009 22:27:43 +0200
> From: Robert van der Hulst <news at heliks.nl>
> Subject: Re: [antlr-interest] Status of the CSharp3 target and my C#
>        ports   of ANTLR and StringTemplate
> To: antlr-interest at antlr.org
> Message-ID: <8410451559.20091020222743 at heliks.nl>
> Content-Type: text/plain; charset="us-ascii"
>
> An HTML attachment was scrubbed...
> URL:
> http://www.antlr.org/pipermail/antlr-interest/attachments/20091020/65d74ab9/attachment-0001.html
>
> ------------------------------
>
> Message: 2
> Date: Wed, 21 Oct 2009 00:24:04 +0100
> From: David-Sarah Hopwood <david-sarah at jacaranda.org>
> Subject: Re: [antlr-interest] Bytes Limit
> To: antlr-interest at antlr.org
> Message-ID: <4ADE4694.5010302 at jacaranda.org>
> Content-Type: text/plain; charset=UTF-8
>
> Marcelo Nichele wrote:
> > Hi,
> >
> > I'm getting started in ANTLR and my grammar generated the
> > specialStateTransition method too big.
> >
> > The error message is *The code of method specialStateTransition(int,
> > IntStream) is exceeding the 65535 bytes limit.*
> >
> > The method assignature is:
> > *public int specialStateTransition(int s, IntStream _input) throws
> > NoViableAltException*
>
> Workaround:
>
> Look at the code for that method in the generated parser source
> (note that there may be multiple DFA inner classes each with a
> specialStateTransition method; the full error message should say which
> one, or just look at the largest such methods).
> Probably the code for specialStateTransition will include code copied
> from predicates in your grammar, duplicated many times. Try to simplify
> the code that is being duplicated.
>
> For example, you could declare a boolean variable in the parser class
> using @parser::members, set it to the predicate condition in an @init
> block of the relevant rule(s), and reference that variable in place of
> the original condition. (Be careful that you aren't changing the behaviour
> of the rule by moving the predicate evaluation to the @init block.)
>
>
> Suggested longer-term improvement:
>
> The size of the generated specialStateTransition methods would be
> considerably reduced if ANTLR were to automatically create temporary
> variables for predicate conditions, rather than duplicating their code.
> Since the DFA object is an instance of an inner class of the parser,
> the workaround above requires the Java compiler to generate references
> to outer class variables, which is more code than would be needed if
> ANTLR were to create such temporaries as local variables of
> specialStateTransition. Since there is no guarantee as to how often
> predicates are evaluated, that change would not affect correctness.
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
>
> ------------------------------
>
> Message: 3
> Date: Wed, 21 Oct 2009 13:27:29 +0530
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: Re: [antlr-interest] Bytes Limit
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <b6a29c89442d004088022678aea26396 at temporal-wave.com>
> Content-Type: text/plain; charset="us-ascii"
>
> This is also quite often caused by a poorly specified grammar (especially
> lexers) causing lots lookahead and states etc. A good way to determine this
> is to find the DFA in question in the generated source code and see what
> decisions/rules it is handling. This should help you pin down where things
> are getting so big and then you can look at the why.
>
>
>
> Jim
>
>
>
> From: antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] On Behalf Of Horst Dehmer
> Sent: Tuesday, October 20, 2009 12:13 PM
> To: Marcelo Nichele; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Bytes Limit
>
>
>
> Hello Marcelo,
>
> i'm afraid you hit a hard limit with java binary class files. how is your
> grammar looking, is it unusually big?
> have also a look at
>
> http://groups.google.com/group/comp.lang.java.machine/browse_thread/thread/b0cf268515f1ef55
>
> good luck,
> horst
>
>
> On 20.10.09 06:59, "Marcelo Nichele" <marcelo.nichele at gmail.com> wrote:
>
> The code of method specialStateTransition(int, IntStream) is exceeding the
> 65535 bytes limit
>
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/733c4727/attachment-0001.html
>
> ------------------------------
>
> Message: 4
> Date: Wed, 21 Oct 2009 13:47:59 +0530
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: Re: [antlr-interest] Status of the CSharp3 target and my C#
>        portsof ANTLR and StringTemplate
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <e46f9f31c2cbe74683984d2670bed31e at temporal-wave.com>
> Content-Type: text/plain; charset="us-ascii"
>
> I think we can expose the public/private stuff easily. I will talk to Ter
> in case there is some reason it is not right now, but I don't think so as
> the ability to do this is part of the current v2 grammar and I just coded it
> in my v3 grammar. We should probably move this to ANTLR dev list.
>
>
>
> Jim
>
>
>
> From: Sam Harwell [mailto:sharwell at pixelminegames.com]
> Sent: Tuesday, October 20, 2009 10:26 PM
> To: Jim Idle; antlr-interest at antlr.org; stringtemplate-interest at antlr.org
> Subject: RE: [antlr-interest] Status of the CSharp3 target and my C#
> portsof ANTLR and StringTemplate
>
>
>
> The code should be nearly the same as that of the CSharp2 target. Here is
> the C# port of the CSharp2 target and CSharp3 target so you can see how the
> CSharp3 one differs. Clearly it should be easy to make it work.
>
>
>
> public class CSharp2Target : Target
>
> {
>
>    public override string EncodeIntAsCharEscape(int v)
>
>    {
>
>        return "\\x" + v.ToString("X");
>
>    }
>
> }
>
>
>
> public class CSharp3Target : Target
>
> {
>
>    public override string EncodeIntAsCharEscape(int v)
>
>    {
>
>        return "\\x" + v.ToString("X");
>
>    }
>
>
>
>    public override string GetTarget64BitStringFromValue(ulong word)
>
>    {
>
>        return "0x" + word.ToString("X");
>
>    }
>
> }
>
>
>
> Something to note: I'm not sure the Java version of the tool exposes the
> property required to support marking rules as public/protected/private.
> We'll have to check that out too, but it should be straightforward.
>
>
>
> Sam
>
>
>
> From: Jim Idle [mailto:jimi at temporal-wave.com]
> Sent: Tuesday, October 20, 2009 12:08 AM
> To: Sam Harwell; antlr-interest at antlr.org;
> stringtemplate-interest at antlr.org
> Subject: RE: [antlr-interest] Status of the CSharp3 target and my C#
> portsof ANTLR and StringTemplate
>
>
>
> OK - well we can add that easily enough J Why don't we try it?
>
>
>
> Jim
>
>
>
> From: Sam Harwell [mailto:sharwell at pixelminegames.com]
> Sent: Tuesday, October 20, 2009 7:46 AM
> To: Jim Idle; antlr-interest at antlr.org; stringtemplate-interest at antlr.org
> Subject: RE: [antlr-interest] Status of the CSharp3 target and my C#
> portsof ANTLR and StringTemplate
>
>
>
> I think the only thing missing is the Java class required for the Java
> version to know the CSharp3 target exists.
>
>
>
> Sam
>
>
>
> From: antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
> Sent: Tuesday, October 20, 2009 2:51 AM
> To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
> Subject: Re: [antlr-interest] Status of the CSharp3 target and my C#
> portsof ANTLR and StringTemplate
>
>
>
> Top posting for Sam's benefit ;-)
>
>
>
> Not being able to use the Csharp3 target from the standard version of the
> tool is going to be a turn off for many I think L What is it that your port
> of the tool has that the standard version does not. I know you have posted
> some of that, but perhaps we can summarize this and see if such things can
> be absorbed into the standard Java tool? Nobody minds you having your own
> version of anything because it is open source, but most will want ot use the
> 'offical' java version of the tool even if they are targeting C#.
>
>
>
> Thanks for the updates,
>
>
>
> Jim
>
>
>
> From: antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] On Behalf Of Sam Harwell
> Sent: Monday, October 19, 2009 1:05 AM
> To: antlr-interest at antlr.org; stringtemplate-interest at antlr.org
> Subject: [antlr-interest] Status of the CSharp3 target and my C# ports of
> ANTLR and StringTemplate
>
>
>
> Hi everyone,
>
>
>
> Here's a status update that I know many people are asking for. For each
> portion, I'll talk about the status of the code in Perforce. At the end,
> I'll talk about the status of the posted binaries.
>
>
>
> Basic Status
>
>
>
> StringTemplate and the ANTLR Tool: Up-to-date with the Java version for all
> targets as of August 4, 2009, which covers all of the changes made earlier
> in the year and over the summer.
>
>
>
> CSharp3 Target: working and extensively used in the ANTLR Tool,
> StringTemplate, and the commercial projects I use ANTLR for. I haven't
> tested the -profile and -debug modes because I don't use them, however the
> templates should be "close to working". Currently, the CSharp3 target can
> only be used when generating grammars from the C# port of the tool.
>
>
>
> Design Changes
>
>
>
> 1.       Rather than package the target templates as resources in the
> tool's executable, I've chosen a flat file layout. That way, the templates
> for a target can be updated without recompiling the tool. The targets
> themselves are also implemented as individual DLL's.
>
> 2.       The CSharp3 target declares rules as private methods by default.
> Rules can be made public by simply marking them as such in the grammar:
> "public compile_unit : declaration*;" I have updated the Java target's code
> generation to support this as well, but it's not checked in.
>
> 3.       StringTemplate has code for a high speed dynamically compiled
> interpreter. By default, the build doesn't enable this mode, but when it's
> turned on the output appears to work correctly. I need to do another round
> of tests, but at this point the C# ports of the ANTLR Tool and
> StringTemplate should be significantly faster than the Java version. We've
> hit a brick wall preventing further optimization without rewriting ST, but
> the work on STv4 should give another order of magnitude improvement in
> template rendering performance.
>
>
>
> Things Holding Me Up
>
>
>
> 1.       I haven't finalized the way I'm going to do assembly versioning,
> although I think I've got that worked out now. I'll send a separate mail to
> the list regarding this.
>
> 2.       StringTemplate is only tested in regards to code generation for
> the ANTLR tool. In particular, its ability to locate templates in resources
> or on the file system is not documented and may or may not behave as people
> expect.
>
> 3.       I'm still making periodic changes to the API as I finalize things,
> and breaking changes in production code aren't good. I don't want to suggest
> replacing the CSharp2 target until the CSharp3 target is more tested by
> other people.
>
>
>
> Things I want to do, but not really holding up the builds
>
>
>
> I really want to package a clean integration of ANTLR+CSharp3 for MSBuild.
> We need this. This would include at least MSBuild targets file and templates
> for adding grammars to a project. Unfortunately, there are many issues I
> still need to resolve for this to be a reality, most of which have answers
> in shades of gray.
>
>
>
> Status of the Posted Build
>
>
>
> The build available for download was uploaded on fairly short notice.
> Mistakes (by me) included not having the assembly version set correctly and
> not posting the source code from the build with the binaries. I've been
> trying to wrap some of these things up before posting another build.
>
>
>
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/45738851/attachment-0001.html
>
> ------------------------------
>
> Message: 5
> Date: Wed, 21 Oct 2009 13:44:25 +0530
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: Re: [antlr-interest] Using multiple grammars with a single
>        parser
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <b51176887aa850468cec0244e1a67da0 at temporal-wave.com>
> Content-Type: text/plain; charset="us-ascii"
>
> This has been covered in previous discussions (use the search), but
> basically you create tokens that look for dates using code that is sensitive
> to the locale, which leaves you with a single lexer with a code based match
> rather than pattern based match.
>
>
>
> DATE : '#' // Assuming that you delimit the dates somehow
>
>              {
>
>                  setText(myDateFunctionThatReturnsString());
>
>              }
>
>             '#'
>
>          ;
>
>
>
> There are other approaches than returning the string but you should get the
> picture?
>
>
>
> Jim
>
>
>
> From: antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] On Behalf Of Parambir Singh
> Sent: Tuesday, October 20, 2009 7:06 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Using multiple grammars with a single parser
>
>
>
> Hi
>
>
>
> I am working on a project where I want to parse input in different locales
> (e.g. english, french & german dates). I don't want to create multiple
> parsers, since the semantics of the grammar don't change between locales. So
> probably I'll need multiple lexers and a single parser. Moreover, I want to
> specify a locale to the parser and the input should be matched against only
> that particular locale (e.g. german dates should be invalid in english
> locale).
>
>
>
> What would be the best approach to construct such a parser using ANTLR. I
> don't have much experience with ANTLR but I read about grammar inheritance
> and think it could be useful here.
>
>
>
> Thanks
>
> Param
>
>
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/f2d7d8df/attachment-0001.html
>
> ------------------------------
>
> Message: 6
> Date: Wed, 21 Oct 2009 18:23:47 +0800
> From: Hieu Phung <phungngochieu at gmail.com>
> Subject: [antlr-interest] [Antlr3 grammar] how to specify alpha token,
>        numeric token and mix of        both
> To: antlr-interest at antlr.org
> Message-ID:
>        <2d17b250910210323q1703906dnd5b4339e472f6adf at mail.gmail.com>
> Content-Type: text/plain; charset="iso-8859-1"
>
> Hi all,
>
> My grammar has 3 kinds of tokens:
> 1) number: contain numeric character
> 2) alpha: contain alphabetic character;
> 3) mix: contain number and alpha and hyphen, full stop or space
>
> For example:
> 1/VEC305/03MAR/PTY
> => in the above input data, 03MAR should be interpreted as a number of
> length 2 followed by alpha of length 3. But VEC305 is a mix of length 6.
>
> If I define grammar like below:
>
> NUMBER    : ('0'..'9')+ ;
> ALPHA    : ('a'..'z'|'A'..'Z')+;
> MIX    : (NUMBER | ALPHA | OTHER)+;
> fragment OTHER    : (' ' | '-' | '.')+;
> SLANT    :    '/';
>
> Antlr will return me VEC305 and 03MAR as two MIX tokens. Is there any way
> to
> define tokens such that Antlr will return me number, slant, mix, slant,
> number, alpha, slant, alpha for the input "1/VEC305/03MAR/PTY" ?
>
> Thank you very much for your suggestions.
>
> Regards,
> Helen
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://www.antlr.org/pipermail/antlr-interest/attachments/20091021/c2aac0a2/attachment-0001.html
>
> ------------------------------
>
> Message: 7
> Date: Wed, 21 Oct 2009 08:36:07 -0700
> From: Kaleb Pederson <kaleb.pederson at gmail.com>
> Subject: Re: [antlr-interest] [Antlr3 grammar] how to specify alpha
>        token,  numeric token and mix of        both
> To: antlr-interest at antlr.org
> Message-ID: <200910210836.07105.kaleb.pederson at gmail.com>
> Content-Type: Text/Plain;  charset="us-ascii"
>
> On Wednesday 21 October 2009 03:23:47 am Hieu Phung wrote:
> > My grammar has 3 kinds of tokens:
> > 1) number: contain numeric character
> > 2) alpha: contain alphabetic character;
> > 3) mix: contain number and alpha and hyphen, full stop or space
> >
> > For example:
> > 1/VEC305/03MAR/PTY
> > => in the above input data, 03MAR should be interpreted as a number of
> > length 2 followed by alpha of length 3. But VEC305 is a mix of length 6.
>
> Hieu,
>
> How do you know that VEC305 is a mix of length six?  It sure looks like an
> alpha followed by a number to me... so what makes it special or different
> than 03MAR?
>
> --
> Kaleb Pederson
>
> Twitter - http://twitter.com/kalebpederson
> Blog - http://kalebpederson.com
>
>
> ------------------------------
>
> _______________________________________________
> antlr-interest mailing list
> antlr-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/antlr-interest
>
> End of antlr-interest Digest, Vol 59, Issue 22
> **********************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/7b304317/attachment.html 

From david-sarah at jacaranda.org  Thu Oct 22 22:08:20 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 23 Oct 2009 06:08:20 +0100
Subject: [antlr-interest] [Antlr3 grammar] how to specify alpha token,
 numeric token and mix of both
In-Reply-To: <2d17b250910222045l24cc4ffg5de424cc1914d1ad@mail.gmail.com>
References: <2d17b250910222045l24cc4ffg5de424cc1914d1ad@mail.gmail.com>
Message-ID: <4AE13A44.9080503@jacaranda.org>

Hieu Phung wrote:
> Hi David,
> 
> Thank you for your suggestion. However, a MIX can start with number, '_' and
> '.'  :((
> 
> Actually I am trying to write a CIMP message format in Antlr. Reference:
> http://www.parse2.com/example-cargoimp-FFA4.shtml
> 
> Alpha   = %x41-5A;
> Numeric = %x30-39;
> Decimal = %x30-39 / ".";
> Mixed   = Alpha / Numeric;
> Text    = %x41-5A / %x30-39 / "." / "-" / " ";   <--- this is my MIX token
> 
> This format can be written in ABNF easily... but in Antlr, once I introduce
> the MIX token, everything which is mixed of numeric and alpha is returned as
> a MIX. Currently I have to use Java code in action to split the MIX string.

For that format, I can't immediately see any simpler way of doing it.
Sometimes formats are just ugly and irregular, and those tend to require
a lot of action code.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From marcelo.nichele at gmail.com  Thu Oct 22 22:09:49 2009
From: marcelo.nichele at gmail.com (Marcelo Nichele)
Date: Fri, 23 Oct 2009 03:09:49 -0200
Subject: [antlr-interest] Bytes Limit
Message-ID: <848594440910222209i50645a40l228fafaf3ea97644@mail.gmail.com>

Hi,

I managed to reduce the size of the code a little. But, in the future
whether I want to create more rules, I'll have problems again.

Thanks for help,

Marcelo



On Fri, Oct 23, 2009 at 2:39 AM, Marcelo Nichele
<marcelo.nichele at gmail.com>wrote:

> Hi,
>
> I'm using some lexer rules such like 'aaaa', 'bbb', ... Then, the code
> generated become too big. So, I reduced some lexer rules and I moved them to
> grammar rules.
>
> Ex:
> TAG_START_OPEN 'link' attrUriId='uri' ATTR_EQ attrValueUri=ATTR_VALUE
> ((attrRoleId='role' ATTR_EQ attrValueRole=ATTR_VALUE) | (attrStartId='start'
> ATTR_EQ attrValueStart=ATTR_VALUE)|(attrEndId='end' ATTR_EQ
> attrValueEnd=ATTR_VALUE))* TAG_EMPTY_CLOSE
>
> Does anyone have any tips?
>
> Thanks for help,
>
> Marcelo
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/39eaf85d/attachment.html 

From david-sarah at jacaranda.org  Thu Oct 22 22:16:25 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 23 Oct 2009 06:16:25 +0100
Subject: [antlr-interest] Contextual Tree Matching
In-Reply-To: <a01429f40910222047yba4a4b3u24f8ad6762003ca0@mail.gmail.com>
References: <a01429f40910222047yba4a4b3u24f8ad6762003ca0@mail.gmail.com>
Message-ID: <4AE13C29.6010108@jacaranda.org>

Joseph Cottam wrote:
> Solution #2:  Flag and filter
> @members{boolean inUpdate = false;}
> 
> topdown
>   : ^(UPDATE .*) {inUpdate = true;}
>   | {inUpdate}?=> RULE -> ^(RULE NEW STUFF);
> 
> bottomup: ^(UPDATE .*) {inUPdate = false;}
> 
> The use of state makes a serialization point to flag when I am in a in my
> otherwise nicely concurrent application, since there is now a global
> variable of the parser called inUpdate.

Well, you won't be able to use an ANTLR lexer/parser object concurrently in
more than one thread, since they are heavily stateful in any case. The
problem with the pattern above is that it isn't reentrant, if an UPDATE can
contain a QUERY or vice versa. I don't know whether that is the case for
your language; if it is, then look at using dynamically scoped attributes.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From yurushkin at rambler.ru  Thu Oct 22 22:17:01 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Fri, 23 Oct 2009 09:17:01 +0400
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <4AE0F596.9040104@kjchome.homeip.net>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
	<4AE0F596.9040104@kjchome.homeip.net>
Message-ID: <op.u18man2pt3jqlu@win-mupvrp0jyrf>

  ?????(?) ? ????? ?????? Fri, 23 Oct 2009 08:46:24 +0400:

> Kevin J. Cummings <cummings at kjchome.homeip.net> ?????(?) ? ????? ??????  
> Fri, 23 Oct 2009 04:15:18 +0400:
>
>> On 10/22/2009 06:08 PM, ??????? ?????? wrote:
>>> Good evening.
>>> thanks for your support!
>>>
>>> Could u give me one tip.
>>> I user C target and want to parse such input
>>>
>>> "a = 3.14
>>> f(x) = 3x^2 - 4x + 2
>>>
>>> print "The value of f for " a " is " f(a)
>>> print "The derivative of " f() " is " f'()
>>>
>>>
>>> list variables
>>> list functions
>>>
>>> g(y) = 2y^3 + 6y - 5
>>> h = f + g
>>> print h()"
>>>
>>> I use this tutorial
>>> http://jnb.ociweb.com/jnb/jnbJun2008.html
>>>
>>> but parser fails.. when finds empty lines. It's correct, but how can i  
>>> fix
>>> it? It's common problem for all languages. Programmer can input some  
>>> empty
>>> lines between constructions to improve code readability...
>>
>> Have your "whitespace" be "skipped" by your lexer?  That's what I do in
>> almost every compiler I've written.  Your lexer tokenizes, and tokens
>> can be seperated by whitespace, so, so long as you don't have lexer
>> rules where whitespace is significant, you should be OK.

mmm.. I understand this. Thank u. But I a little another problem FOR  
RORTRAN GRAMMAR

first example: stmnt <\n> stmnt <\n> stmnt <;> <\n> // i mean <\n> is  
enough to seperate statements.
<\n> token shouldn't be skiped -it's used by end_of_statement rule.

But it's possible to write
stmnt <\n> <\n> <\n> <stmnt> <\n>
in this case 2nd and 3rd <\n> tokens do not figure in any rules.. they  
must be skiped.

So hmm... it's a problem for lexer. what whould u advice to do with  
grammars?
I know one method but it needs to write code to "override nextToken  
method" - but i think it's not good decision.

Thank u very much!

-- 
Best regards,
Michael

From david-sarah at jacaranda.org  Thu Oct 22 22:20:32 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 23 Oct 2009 06:20:32 +0100
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <op.u18man2pt3jqlu@win-mupvrp0jyrf>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>	<4AE0F596.9040104@kjchome.homeip.net>
	<op.u18man2pt3jqlu@win-mupvrp0jyrf>
Message-ID: <4AE13D20.3050002@jacaranda.org>

??????? ?????? wrote:
> first example: stmnt <\n> stmnt <\n> stmnt <;> <\n> // i mean <\n> is  
> enough to seperate statements.

For most languages that do that, it's sufficient to add an empty statement
rule in the parser.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From gerald at certiv.net  Thu Oct 22 22:23:05 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Thu, 22 Oct 2009 22:23:05 -0700
Subject: [antlr-interest] Contextual Tree Matching
In-Reply-To: <a01429f40910222047yba4a4b3u24f8ad6762003ca0@mail.gmail.com
 >
References: <a01429f40910222047yba4a4b3u24f8ad6762003ca0@mail.gmail.com>
Message-ID: <200910230523.n9N5N5x9013402@zinc.newtechlaw.com>

At 08:47 PM 10/22/2009, Joseph Cottam wrote:
>I'm working with the tree pattern matching and think it is excellent 
>(especially re-writing).
>I have repeatedly come across the need to match trees that are 
>descents of other sub-trees, but have not found an elegant way to do so.
>
>For example...
>Given the tree:
>   ^(GROUP
>         ^(UPDATE ^(SET RULE)  ^(SET RULE))
>         ^(UPDATE ^(SET RULE RULE ^(SET RULE RULE))  ^(SET RULE))
>         ^(QUERY ^(SET RULE) ^(SET RULE RULE)))
>
>I would like to match all RULE entries that are under an UPDATE but 
>not a QUERY.

So, the rule would be:

matchRule: { hasAncestor(UPDATE) && !hasAncestor(QUERY) }? RULE ;

Or, if queries and update don't nest:

matchRule: { hasAncestor(UPDATE) }? RULE ;


The semantic predicate convenience methods are implemented in the 
members block or in a superclass:

@members{
/**
  * Determines whether the ancestor Tree node exists.
  *
  * @param the ancestor token <code>type</code> to search for
  * @return <code>true</code> if the token is an ancestor, 
<code>false</code> otherwise
  */
public boolean hasAncestor(int ttype) {
return getAncestor(ttype) != null;
}

/** Walk upwards and get first ancestor with this token type. */
public Tree getAncestor(int ttype) {
Tree t = (Tree) input.LT(1);
t = t.getParent();
while (t != null) {
if (t.getType() == ttype) return t;
t = t.getParent();
}
return null;
}

/**
  * Determines whether the parent Tree node exists.
  *
  * @param the parent token <code>type</code> to check
  * @return <code>true</code> if the token is the parent, 
<code>false</code> otherwise
  */
public boolean hasParent(int ttype) {
Tree t = (Tree) input.LT(1);
return (t != null && t.getParent().getType() == ttype);
}
}



>This need is similar to recursive path operations in Apache Ant with 
>** specifier (at some depth below).
>Is there a similar syntax for ANTLR contextual sub-tree matching?

There has been discussion of more "complicated" convenience methods, 
but so far hasAncestor and hasParent have proven sufficient (BTW, 
these methods are planned to be implemented in TreeParser in the next 
version of Antlr).  If you have a use case where they are not 
sufficient or appropriate, please post to discuss.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091022/65cdbb80/attachment.html 

From yurushkin at rambler.ru  Thu Oct 22 22:31:53 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Fri, 23 Oct 2009 09:31:53 +0400
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <4AE13D20.3050002@jacaranda.org>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
	<4AE0F596.9040104@kjchome.homeip.net>
	<op.u18man2pt3jqlu@win-mupvrp0jyrf>
	<4AE13D20.3050002@jacaranda.org>
Message-ID: <op.u18mzfj5t3jqlu@win-mupvrp0jyrf>

David-Sarah Hopwood <david-sarah at jacaranda.org> ?????(?) ? ????? ??????  
Fri, 23 Oct 2009 09:20:32 +0400:

> ??????? ?????? wrote:
>> first example: stmnt <\n> stmnt <\n> stmnt <;> <\n> // i mean <\n> is
>> enough to seperate statements.
>
> For most languages that do that, it's sufficient to add an empty  
> statement
> rule in the parser.

mm.. empty lines can be in every place of grammar: between statements,  
procedures, declarations etc where empty_statement rule isn't exist.
I think it's important to skip redudant <\n> on lexer level... but i don't  
know how to do that clearly (without overriding nextToken for example).

-- 
Best regards,
Michael

From david-sarah at jacaranda.org  Thu Oct 22 22:35:08 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 23 Oct 2009 06:35:08 +0100
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <op.u18mzfj5t3jqlu@win-mupvrp0jyrf>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
	<4AE0F596.9040104@kjchome.homeip.net>
	<op.u18man2pt3jqlu@win-mupvrp0jyrf>
	<4AE13D20.3050002@jacaranda.org>
	<op.u18mzfj5t3jqlu@win-mupvrp0jyrf>
Message-ID: <4AE1408C.2010102@jacaranda.org>

??????? ?????? wrote:
> David-Sarah Hopwood <david-sarah at jacaranda.org> ?????(?) ? ????? ??????
> Fri, 23 Oct 2009 09:20:32 +0400:
> 
>> ??????? ?????? wrote:
>>> first example: stmnt <\n> stmnt <\n> stmnt <;> <\n> // i mean <\n> is
>>> enough to seperate statements.
>>
>> For most languages that do that, it's sufficient to add an empty
>> statement rule in the parser.
> 
> mm.. empty lines can be in every place of grammar: between statements,
> procedures, declarations etc where empty_statement rule isn't exist.
> I think it's important to skip redudant <\n> on lexer level... but i
> don't know how to do that clearly (without overriding nextToken for
> example).

Can that not be done by using '\n'+ where you had '\n' before?

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Fri Oct 23 00:19:03 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 23 Oct 2009 12:49:03 +0530
Subject: [antlr-interest] c target  - bug
In-Reply-To: <op.u171n3n6t3jqlu@win-mupvrp0jyrf>
Message-ID: <75879c289cfbf542b7e9224bbf573805@temporal-wave.com>

Is this ANTLR 3.2?

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of ??????? ??????
> Sent: Friday, October 23, 2009 3:21 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] c target - bug
> 
> 
> line 2086
> ErrorType: last closing scope is redundant.
> > while ( (stream_term != NULL && stream_term->hasNext(stream_term))
> > ||stream_SIGN != NULL && stream_SIGN->hasNext(stream_SIGN))  )
> 
> 
> ====================
> LEXER:
> 
> 
> lexer grammar MathLexer;
> 
> options {
>      language = C;
> }
> 
> 
> APOSTROPHE: '\''; // for derivative
> ASSIGN: '=';
> CARET: '^'; // for exponentiation
> FUNCTIONS: 'functions'; // for list command
> HELP: '?' | 'help';
> LEFT_PAREN: '(';
> LIST: 'list';
> PRINT: 'print';
> RIGHT_PAREN: ')';
> SIGN: '+' | '-';
> VARIABLES: 'variables'; // for list command
> 
> NUMBER: INTEGER | FLOAT;
> fragment FLOAT: INTEGER '.' '0'..'9'+;
> fragment INTEGER: '0' | SIGN? '1'..'9' '0'..'9'*;
> NAME: LETTER (LETTER | DIGIT | '_')*;
> STRING_LITERAL: '"' NONCONTROL_CHAR* '"';
> 
> fragment NONCONTROL_CHAR: LETTER | DIGIT | SYMBOL | SPACE;
> fragment LETTER: LOWER | UPPER;
> fragment LOWER: 'a'..'z';
> fragment UPPER: 'A'..'Z';
> fragment DIGIT: '0'..'9';
> fragment SPACE: ' ' | '\t';
> 
> // Note that SYMBOL does not include the double-quote character.
> fragment SYMBOL: '!' | '#'..'/' | ':'..'@' | '['..'`' | '{'..'~';
> 
> // Windows uses \r\n. UNIX and Mac OS X use \n.
> // To use newlines as a terminator,
> // they can't be written to the hidden channel!
> NEWLINE: ('\r'? '\n')+;
> WHITESPACE: SPACE+ { $channel = HIDDEN; };
> 
> 
> ========================================
> 
> PARSER:
> 
> parser grammar MathParser;
> 
> options {
>      // We're going to output an AST.
>      output = AST;
>      language = C;
> 
>      // We're going to use the tokens defined in our MathLexer grammar.
>      tokenVocab = MathLexer;
> }
> 
> // These are imaginary tokens that will serve as parent nodes
> // for grouping other tokens in our AST.
> tokens {
>      COMBINE;
>      DEFINE;
>      DERIVATIVE;
>      FUNCTION;
>      POLYNOMIAL;
>      TERM;
> }
> 
> @parser::includes
> {
>      #include <string>
>      using std::string;
> 
>      #define getTokenText(token) string((char*)token->getText(token)-
> >chars)
> }
> 
> 
> 
> // This is the "start rule".
> // EOF is a predefined token that represents the end of input.
> // The "start rule" should end with this.
> // Note the use of the ! AST operator
> // to avoid adding the EOF token to the AST.
> script: statement* EOF!;
> 
> statement: assign | define | interactiveStatement | combine | print;
> 
> // These kinds of statements only need to be supported
> // when reading input from the keyboard.
> interactiveStatement: help | list;
> 
> // Examples of input that match this rule include
> // "a = 19", "a = b", "a = f(2)" and "a = f(b)".
> assign: NAME ASSIGN value terminator -> ^(ASSIGN NAME value);
> 
> value: NUMBER | NAME | functionEval;
> 
> // A parenthesized group in a rule alternative is called a "subrule".
> // Examples of input that match this rule include "f(2)" and "f(b)".
> functionEval
>      : fn=NAME LEFT_PAREN (v=NUMBER | v=NAME) RIGHT_PAREN -> ^(FUNCTION
> $fn
> $v);
> 
> // EOF cannot be used in lexer rules, so we made this a parser rule.
> // EOF is needed here for interactive mode where each line entered ends
> in
> EOF
> // and for file mode where the last line ends in EOF.
> terminator: NEWLINE | EOF;
> 
> // Examples of input that match this rule include
> // "f(x) = 3x^2 - 4" and "g(x) = y^2 - 2y + 1".
> // Note that two parameters are passed to the polynomial rule.
> define
>      : fn=NAME LEFT_PAREN fv=NAME RIGHT_PAREN ASSIGN
>        polynomial[getTokenText($fn), getTokenText($fv)] terminator
>        -> ^(DEFINE $fn $fv polynomial);
> 
> // Examples of input that match this rule include
> // "3x2 - 4" and "y^2 - 2y + 1".
> // fnt = function name text; fvt = function variable text
> // Note that two parameters are passed in each invocation of the term
> rule.
> polynomial[string fnt, string fvt]
>      : term[$fnt, $fvt] (SIGN term[$fnt, $fvt])*
>        -> ^(POLYNOMIAL term (SIGN term)*);
> 
> // Examples of input that match this rule include
> // "4", "4x", "x^2" and "4x^2".
> // fnt = function name text; fvt = function variable text
> term[string fnt, string fvt]
>      // tv = term variable
>      : c=coefficient? (tv=NAME e=exponent?)?
>        // What follows is a validating semantic predicate.
>        // If it evaluates to false, a FailedPredicateException will be
> thrown.
>        // It is testing whether the term variable matches the function
> variable.
>        { tv == 0 ? true : getTokenText($tv) == $fvt }?
>        -> ^(TERM $c? $tv? $e?)
>      ;
>      // This catches bad function definitions such as
>      // f(x) = 2y
>      catch [3] {
>        throw 0;
>      }
> 
> coefficient: NUMBER;
> 
> // An example of input that matches this rule is "^2".
> exponent: CARET NUMBER -> NUMBER;
> 
> // Inputs that match this rule are "?" and "help".
> help: HELP terminator -> HELP;
> 
> // Inputs that match this rule include
> // "list functions" and "list variables".
> list
>      : LIST listOption terminator -> ^(LIST listOption);
> 
> // Inputs that match this rule are "functions" and "variables".
> listOption: FUNCTIONS | VARIABLES;
> 
> // Examples of input that match this rule include
> // "h = f + g" and "h = f - g".
> combine
>      : fn1=NAME ASSIGN fn2=NAME op=SIGN fn3=NAME terminator
>        -> ^(COMBINE $fn1 $op $fn2 $fn3);
> 
> // An example of input that matches this rule is
> // print "f(" a ") = " f(a)
> print
>      : PRINT printTarget* terminator -> ^(PRINT printTarget*);
> 
> // Examples of input that match this rule include
> // 19, 3.14, "my text", a, f(), f(2), f(a) and f'().
> printTarget
>      : NUMBER -> NUMBER
>      | sl=STRING_LITERAL -> $sl
>      | NAME -> NAME
>      // This is a function reference to print a string representation.
>      | NAME LEFT_PAREN RIGHT_PAREN -> ^(FUNCTION NAME)
>      | functionEval
>      | derivative
>      ;
> 
> // An example of input that matches this rule is "f'()".
> derivative
>      : NAME APOSTROPHE LEFT_PAREN RIGHT_PAREN -> ^(DERIVATIVE NAME);
> 
> 
>               	        	}
> 
> --
> Best regards,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From yurushkin at rambler.ru  Fri Oct 23 02:28:13 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Fri, 23 Oct 2009 13:28:13 +0400
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <4AE1408C.2010102@jacaranda.org>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
	<4AE0F596.9040104@kjchome.homeip.net>
	<op.u18man2pt3jqlu@win-mupvrp0jyrf>
	<4AE13D20.3050002@jacaranda.org> <op.u18mzfj5t3jqlu@win-mupvrp0jyrf>
	<4AE1408C.2010102@jacaranda.org>
Message-ID: <op.u18xxbzzt3jqlu@win-mupvrp0jyrf>

David-Sarah Hopwood <david-sarah at jacaranda.org> ?????(?) ? ????? ??????  
Fri, 23 Oct 2009 09:35:08 +0400:

> ??????? ?????? wrote:
>> David-Sarah Hopwood <david-sarah at jacaranda.org> ?????(?) ? ????? ??????
>> Fri, 23 Oct 2009 09:20:32 +0400:
>>
>>> ??????? ?????? wrote:
>>>> first example: stmnt <\n> stmnt <\n> stmnt <;> <\n> // i mean <\n> is
>>>> enough to seperate statements.
>>>
>>> For most languages that do that, it's sufficient to add an empty
>>> statement rule in the parser.
>>
>> mm.. empty lines can be in every place of grammar: between statements,
>> procedures, declarations etc where empty_statement rule isn't exist.
>> I think it's important to skip redudant <\n> on lexer level... but i
>> don't know how to do that clearly (without overriding nextToken for
>> example).
>
> Can that not be done by using '\n'+ where you had '\n' before?
>


yes=) it was relly simple(
excuse me and thanks!

-- 
Best regards,
Michael

From antlr at mirality.co.nz  Fri Oct 23 02:39:13 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 23 Oct 2009 22:39:13 +1300
Subject: [antlr-interest] [Antlr3 grammar] how to specify alpha  token,
 numeric token and mix of both
In-Reply-To: <2d17b250910222045l24cc4ffg5de424cc1914d1ad@mail.gmail.com>
References: <2d17b250910222045l24cc4ffg5de424cc1914d1ad@mail.gmail.com>
Message-ID: <20091023093939.CE63A341841F@www.antlr.org>

At 16:45 23/10/2009, Hieu Phung wrote:
>Alpha   = %x41-5A;
>Numeric = %x30-39;
>Decimal = %x30-39 / ".";
>Mixed   = Alpha / Numeric;
>Text    = %x41-5A / %x30-39 / "." / "-" / " ";   <--- this is my 
>MIX token
>
>This format can be written in ABNF easily... but in Antlr, once I 
>introduce the MIX token, everything which is mixed of numeric and 
>alpha is returned as a MIX. Currently I have to use Java code in 
>action to split the MIX string. I wonder if there's a better way 
>to define tokens because my grammar now is full of Java code :(!

If you don't want to continue down that path, then I think the 
only other options are:

1. eliminate the MIX token and live with multiple sub-tokens 
generated in contexts where mixed values are expected; at the 
parser level examine sequences of other tokens and determine which 
ones are really part of one value.

2. eliminate all other tokens and just produce MIXes (ie. the 
lexer is purely consolidating whitespace vs. non-whitespace vs. 
SLANTs), then in the parser figure out which MIXes consist 
entirely of numbers or letters and accordingly whether they're 
valid in the position you find them.

Also note that if you're generating a tree for later use by a tree 
parser, you can have the parser convert the tokens once it figures 
out what type they should really be from their context.


From naveen.chwl at googlemail.com  Fri Oct 23 06:10:19 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Fri, 23 Oct 2009 14:10:19 +0100
Subject: [antlr-interest] Can somebody give me the very simplest example of
	grammar to AST to StringTemplate output
Message-ID: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>

I'd like to use all the features of ANTLR all the way up to StringTemplate
etc. for e.g. a translation, can someone give me the very simplest example
they possibly can, for a beginner, of a grammar, to an AST (very, very
simple) to using StringTemplate and then a translated output (with maybe a
"Tree grammar" somewhere in between?)?

The reason why I want a bare-bones example is so that I can apply it to what
I do, and the book seems to have 3-4 chapters for the whole workflow, and I
can't seem to find the basic elements I need for a simple working example
for all the features.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/60845834/attachment.html 

From parrt at cs.usfca.edu  Fri Oct 23 08:52:31 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 23 Oct 2009 08:52:31 -0700
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>
References: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>
Message-ID: <D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>

have you looked at the (free) code for both books?
Ter
On Oct 23, 2009, at 6:10 AM, Naveen Chawla wrote:

> I'd like to use all the features of ANTLR all the way up to  
> StringTemplate etc. for e.g. a translation, can someone give me the  
> very simplest example they possibly can, for a beginner, of a  
> grammar, to an AST (very, very simple) to using StringTemplate and  
> then a translated output (with maybe a "Tree grammar" somewhere in  
> between?)?
>
> The reason why I want a bare-bones example is so that I can apply it  
> to what I do, and the book seems to have 3-4 chapters for the whole  
> workflow, and I can't seem to find the basic elements I need for a  
> simple working example for all the features.
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From sharwell at pixelminegames.com  Fri Oct 23 09:08:55 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Fri, 23 Oct 2009 11:08:55 -0500
Subject: [antlr-interest] MSBuild integration for the CSharp targets
Message-ID: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>

Hi everyone,

 

I finally implemented true MSBuild integration for ANTLR grammars in C#
projects. In addition to the tool (AntlrTool.exe), you'll need the
targets file (Antlr3.targets) and build task library
(AntlrBuildTask.dll). The latest builds can be found in the
bin\Bootstrap directory with the C# port of the tool. The integration
should work with any of the C# targets as long as the project is being
built in Visual Studio 2008 or later. Here is a list of basic features:

 

*         Proper handling of inter-grammar dependencies.

*         Uses timestamps for incremental builds. When regenerating code
from the grammars is required, it uses the fast C# port. 19 grammars are
generated for the C# port of the ANTLR tool itself, and a full rebuild
including the grammars takes 8 seconds.

*         Generated outputs strictly constrained to the intermediate
build path (normally obj\Debug and obj\Release).

*         Build, Clean, Rebuild all work as expected.

*         Much easier to add new grammars to a project. For an immediate
example, open Antlr3.csproj (the C# port) as an XML file. Later I'll be
writing up a new set of directions for including grammars in your
projects.

 

I'll be re-packaging everything as a regular download in the near
future.

 

Thank you,

Sam Harwell

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/49cafc07/attachment.html 

From yurushkin at rambler.ru  Fri Oct 23 09:53:32 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Fri, 23 Oct 2009 20:53:32 +0400
Subject: [antlr-interest] Antlrworks: grouping of rules bug
Message-ID: <op.u19ijigxt3jqlu@win-mupvrp0jyrf>

Good evening.
I use antlrworks 1.3, c target, parser (output=AST) grammar.
I can't group my rules by sections (in the left panel). I mean that  
tree-structure of sections isn't built in this panel. It's difficult to  
navigate...

-- 
Best regards,
Michael

From david-sarah at jacaranda.org  Fri Oct 23 10:15:09 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 23 Oct 2009 18:15:09 +0100
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <op.u18xxbzzt3jqlu@win-mupvrp0jyrf>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
	<4AE0F596.9040104@kjchome.homeip.net>
	<op.u18man2pt3jqlu@win-mupvrp0jyrf>
	<4AE13D20.3050002@jacaranda.org>
	<op.u18mzfj5t3jqlu@win-mupvrp0jyrf>
	<4AE1408C.2010102@jacaranda.org>
	<op.u18xxbzzt3jqlu@win-mupvrp0jyrf>
Message-ID: <4AE1E49D.9050206@jacaranda.org>

??????? ?????? wrote:
> David-Sarah Hopwood <david-sarah at jacaranda.org> ?????(?) ? ????? ??????:
>> ??????? ?????? wrote:
>>> mm.. empty lines can be in every place of grammar: between statements,
>>> procedures, declarations etc where empty_statement rule isn't exist.
>>> I think it's important to skip redudant <\n> on lexer level... but i
>>> don't know how to do that clearly (without overriding nextToken for
>>> example).
>>
>> Can that not be done by using '\n'+ where you had '\n' before?
> 
> yes=) it was relly simple(
> excuse me and thanks!

Bear in mind that this won't allow a blank line at the start of the
input, though. If that should be allowed, then you may still need a
blank procedure rule (assuming procedures can occur at top-level).

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Fri Oct 23 10:24:32 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 23 Oct 2009 18:24:32 +0100
Subject: [antlr-interest] Antlrworks: grouping of rules bug
In-Reply-To: <op.u19ijigxt3jqlu@win-mupvrp0jyrf>
References: <op.u19ijigxt3jqlu@win-mupvrp0jyrf>
Message-ID: <4AE1E6D0.9000106@jacaranda.org>

??????? ?????? wrote:
> Good evening.
> I use antlrworks 1.3, c target, parser (output=AST) grammar.
> I can't group my rules by sections (in the left panel). I mean that  
> tree-structure of sections isn't built in this panel. It's difficult to  
> navigate...

Yes, this appears to be a bug that was introduced in ANTLRWorks 1.3.
In ANTLRWorks 1.2.3 it worked fine. See
<http://www.antlr.org/pipermail/antlr-interest/2009-September/036117.html>.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From news at heliks.nl  Fri Oct 23 10:34:14 2009
From: news at heliks.nl (Robert van der Hulst)
Date: Fri, 23 Oct 2009 19:34:14 +0200
Subject: [antlr-interest] MSBuild integration for the CSharp targets
In-Reply-To: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>
References: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>
Message-ID: <513981400.20091023193414@heliks.nl>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/6a44ea1b/attachment.html 

From kferrio at gmail.com  Fri Oct 23 13:01:26 2009
From: kferrio at gmail.com (kferrio at gmail.com)
Date: Fri, 23 Oct 2009 20:01:26 +0000
Subject: [antlr-interest] MSBuild integration for the CSharp targets
In-Reply-To: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>
References: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>
Message-ID: <2104223039-1256327882-cardhu_decombobulator_blackberry.rim.net-652254989-@bda430.bisx.prod.on.blackberry>

Wow and cool!  I hope to be able to take a look after I finish this weekend's "HoneyDew" list.

Kyle

Sent from my Verizon Wireless BlackBerry

-----Original Message-----
From: "Sam Harwell" <sharwell at pixelminegames.com>
Date: Fri, 23 Oct 2009 11:08:55 
To: <antlr-interest at antlr.org>; <antlr-dev at antlr.org>
Subject: [antlr-interest] MSBuild integration for the CSharp targets


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address



From troy.daniels at baesystems.com  Fri Oct 23 13:36:18 2009
From: troy.daniels at baesystems.com (Daniels, Troy (US SSA))
Date: Fri, 23 Oct 2009 16:36:18 -0400
Subject: [antlr-interest] [C target] how to skip empty lines
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf><4AE0F596.9040104@kjchome.homeip.net><op.u18man2pt3jqlu@win-mupvrp0jyrf><4AE13D20.3050002@jacaranda.org><op.u18mzfj5t3jqlu@win-mupvrp0jyrf><4AE1408C.2010102@jacaranda.org><op.u18xxbzzt3jqlu@win-mupvrp0jyrf>
	<4AE1E49D.9050206@jacaranda.org>
Message-ID: <40CBD611A793EA438464B91E749DD8B006ECF56E@blums0017.alphatech.com>

 

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org 
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of 
> David-Sarah Hopwood
> 
> Bear in mind that this won't allow a blank line at the start 
> of the input, though. If that should be allowed, then you may 
> still need a blank procedure rule (assuming procedures can 
> occur at top-level).
> 

Also, you may need to handle things like \n space \n tab \n, which will
fail with just \n+.

Troy


From drichird at hotmail.com  Fri Oct 23 18:08:01 2009
From: drichird at hotmail.com (Rich Parker)
Date: Fri, 23 Oct 2009 18:08:01 -0700
Subject: [antlr-interest] Running ANTLR generated code from Eclipse?
Message-ID: <SNT104-W51E2C43FC8B959C7325E2FC4BC0@phx.gbl>


Has anyone tried to run the ANTLR generated code (__Test__, ExprLexer, ExprParser) for a grammar from 
the Eclipse IDE?

In Eclipse I try to create a Java project from the ANTLR output folder but 
when I run it I get:

Exception in thread "main" java.lang.Error: 
Unresolved compilation problems: 
ANTLRFileStream cannot be resolved to a 
type
CommonTokenStream cannot be resolved to a type
CommonTokenStream 
cannot be resolved to a type
The method prog() from the type RichExprParser 
refers to the missing type RecognitionException
RecognitionException cannot 
be resolved to a type

at __Test__.main(__Test__.java:11)

Did I 
install the ANTLR plugin completely, or do I need to specify additional ANTLR 
libraries somehow?
In my installed software tab for Eclipse I 
see:

org.antlr.ui 4.1.1 org.antlr.ui.feature.group
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/7456bd89/attachment.html 

From lgcraymer at yahoo.com  Fri Oct 23 19:18:21 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Fri, 23 Oct 2009 19:18:21 -0700 (PDT)
Subject: [antlr-interest] Running ANTLR generated code from Eclipse?
In-Reply-To: <SNT104-W51E2C43FC8B959C7325E2FC4BC0@phx.gbl>
References: <SNT104-W51E2C43FC8B959C7325E2FC4BC0@phx.gbl>
Message-ID: <117161.72390.qm@web55903.mail.re3.yahoo.com>

You might want to read the eclipse documentation.  Anyway, from the package explorer, right click on your project and select "Properties" at the bottom of the menu.  Now select "Java Build Path" and add the antlr runtime as an external jar (under the libraries tab).

--Loring


>
>From: Rich Parker <drichird at hotmail.com>
>To: antlr-interest at antlr.org
>Sent: Fri, October 23, 2009 6:08:01 PM
>Subject: [antlr-interest] Running ANTLR generated code from Eclipse?
>
> >
>Has anyone tried to run the ANTLR generated code (__Test__, ExprLexer, ExprParser) for a grammar from 
>the Eclipse IDE?
>
>In Eclipse I try to create a Java project from the ANTLR output folder but 
>when I run it I get:
>
>Exception in thread "main" java.lang.Error: 
>Unresolved compilation problems: 
>ANTLRFileStream cannot be resolved to a 
>type
>CommonTokenStream cannot be resolved to a type
>CommonTokenStream 
>cannot be resolved to a type
>The method prog() from the type RichExprParser 
>refers to the missing type RecognitionException
>RecognitionException cannot 
>be resolved to a type
>
>at __Test__.main(__Test__.java:11)
>
>Did I 
>install the ANTLR plugin completely, or do I need to specify additional ANTLR 
>libraries somehow?
>In my installed software tab for Eclipse I 
>see:
>
>org.antlr.ui 4.1.1 org.antlr.ui.feature.group
>


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091023/4990985b/attachment.html 

From naveen.chwl at googlemail.com  Fri Oct 23 20:40:59 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Sat, 24 Oct 2009 04:40:59 +0100
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>
References: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>
	<D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>
Message-ID: <56eb2660910232040l69b84ba3yd591c02a47a47c98@mail.gmail.com>

No, where?
Many thanks, N
2009/10/23 Terence Parr <parrt at cs.usfca.edu>

> have you looked at the (free) code for both books?
> Ter
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/8b4a8afb/attachment.html 

From wclodius at los-alamos.net  Fri Oct 23 21:14:08 2009
From: wclodius at los-alamos.net (William B. Clodius)
Date: Fri, 23 Oct 2009 22:14:08 -0600
Subject: [antlr-interest] [C target] how to skip empty lines
In-Reply-To: <op.u18mzfj5t3jqlu@win-mupvrp0jyrf>
References: <op.u172fot1t3jqlu@win-mupvrp0jyrf>
	<4AE0F596.9040104@kjchome.homeip.net>
	<op.u18man2pt3jqlu@win-mupvrp0jyrf>
	<4AE13D20.3050002@jacaranda.org>
	<op.u18mzfj5t3jqlu@win-mupvrp0jyrf>
Message-ID: <8B676A53-58AF-440F-AED1-DA79219E0ADB@los-alamos.net>


On Oct 22, 2009, at 11:31 PM, ??????? ?????? wrote:

> David-Sarah Hopwood <david-sarah at jacaranda.org> ?????(?) ?  
> ????? ??????  Fri, 23 Oct 2009 09:20:32 +0400:
>> ??????? ?????? wrote:>> first example: stmnt <\n> stmnt  
>> <\n> stmnt <;> <\n> // i mean <\n> is>> enough to seperate  
>> statements.
>> >> For most languages that do that, it's sufficient to add an  
>> empty  > statement> rule in the parser.
> mm.. empty lines can be in every place of grammar: between  
> statements,  procedures, declarations etc where empty_statement rule  
> isn't exist.I think it's important to skip redudant <\n> on lexer  
> level... but i don't  know how to do that clearly (without  
> overriding nextToken for example).
> -- Best regards,Michael
> List: http://www.antlr.org/mailman/listinfo/antlr- 
> interestUnsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
FWIW Fortran handles this by defining empty lines to be comments so  
they are normally discarded with other comments or whitespace.

From indhu.b at s7software.com  Fri Oct 23 22:50:13 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Sat, 24 Oct 2009 11:20:13 +0530
Subject: [antlr-interest] Can somebody give me the very simplest
	example	of grammar to AST to StringTemplate output
In-Reply-To: <56eb2660910232040l69b84ba3yd591c02a47a47c98@mail.gmail.com>
References: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>	<D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>
	<56eb2660910232040l69b84ba3yd591c02a47a47c98@mail.gmail.com>
Message-ID: <001201ca546d$dc43a6b0$94caf410$@b@s7software.com>

Section 9.6 of ANTLR definitive reference (Building a Java Bytecode
Generator Using a Tree Grammar and Templates) does this. 

 

The free code samples are available at
http://media.pragprog.com/titles/tpantlr/code/tpantlr-code.tgz

 

Samples for this specific section is available at 'Code/templates/generator'
inside the archive.

 

The book has a very good explanation too.

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Saturday, October 24, 2009 9:11 AM
To: Terence Parr
Cc: ANTLR Interest Mailing List
Subject: Re: [antlr-interest] Can somebody give me the very simplest example
of grammar to AST to StringTemplate output

 

No, where?
Many thanks, N

2009/10/23 Terence Parr <parrt at cs.usfca.edu>

have you looked at the (free) code for both books?
Ter

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/6bd3d0db/attachment.html 

From marcelo.nichele at gmail.com  Sat Oct 24 01:04:25 2009
From: marcelo.nichele at gmail.com (Marcelo Nichele)
Date: Sat, 24 Oct 2009 06:04:25 -0200
Subject: [antlr-interest] How to overcome Lexer generation
	OutOfMemoryError?
Message-ID: <848594440910240104s31cd34e8n6383bb2207da6ca3@mail.gmail.com>

Hi,

Try this: java -Xmx1024m

Cheers,

Marcelo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/f3ebd06a/attachment.html 

From horst.dehmer at inode.at  Sat Oct 24 06:07:38 2009
From: horst.dehmer at inode.at (Horst Dehmer)
Date: Sat, 24 Oct 2009 15:07:38 +0200
Subject: [antlr-interest] finish/stop parsing without closing reader
Message-ID: <C708C8BA.97A%horst.dehmer@inode.at>

Hello!

For one special parser rule in my grammar I have to stop parsing and read
the rest of the input from the reader as (compressed) binary data. Is there
any way to instruct the parser to stop reading further tokens when the top
most rule was successfully recognized?

Any help is highly appreciated!

- Horst

More details:  The rule recognizes header information for the then following
binary data:

d_data returns [D_DATA pdu]
@init {
  pdu = null;
}
  : 'D4|' oigId = oig_id '|' syncpointId = syncpoint_id '|'
uncompressedLength = length '|'
    {
      SyncpointDescriptor syncpoint = ...
      pdu = new D_DATA(syncpoint);
    }
  ;

The size of the binary data following the last ?|? can become quite big and
I have to store them as a file to disk.
After the header is recognized the parser returns but the input reader is
closed. Without using EOF in the rule, it seems the additional bytes are
consumed from ANTLRReaderStream:

CharStream charStream = new ANTLRReaderStream(reader);
PduLexer lexer = new PduLexer(charStream);
TokenStream tokenStream = new CommonTokenStream(lexer);
PduParser parser = new PduParser(tokenStream);
...

With a trailing EOF in the rule the parser naturally complains about the
additional information: line 1:36 extraneous input '<binary data>' expecting
EOF
The test case shows proper recognition of the T2/D4 along with syncpoint
token, but reading ?<binary data>? fails due to a closed reader/stream.

@Test
public void parse_whole() throws RecognitionException, IOException {
    final BigDecimal OIG = new BigDecimal("10903008203000000001");
    final String SYNCPOINT = "82737";
    final long LENGTH = 40;
    final String FORMAT = "T2|D4|%20.0f|%s|%d|<binary data>";
    final String MESSAGE = String.format(FORMAT, OIG, SYNCPOINT, LENGTH);

    StringReader reader = new StringReader(MESSAGE);
    T_PDU t_pdu = parserDriver.parse(reader); // OK.
    D_PDU d_pdu = ((T_DATA) t_pdu).getPdu(); // OK.
    D_DATA d_data = (D_DATA) d_pdu; // OK.
    SyncpointDescriptor token = d_data.getToken();
    
    assertEquals(OIG, token.oigId); // OK.
    assertEquals(SYNCPOINT, token.syncpointId); // OK.
    assertEquals(LENGTH, token.uncompressedLength); // OK.

    try {
        // reader should be positioned at the rest of the message, i.e.
?<binary data>?.
        char[] buffer = new char["<binary data>".length()];
        reader.read(buffer);
    }
    catch (IOException exception) {
        // NOT OK:
        // java.io.IOException: Stream closed
    }
}


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/10e85b79/attachment.html 

From boughtonp at gmail.com  Sat Oct 24 09:40:54 2009
From: boughtonp at gmail.com (Peter Boughton)
Date: Sat, 24 Oct 2009 17:40:54 +0100
Subject: [antlr-interest] Nested multi-line comments
Message-ID: <5d97c170910240940r4f9ce1f4g24db101b064c369c@mail.gmail.com>

How do I support nested comments with ANTLR?

The standard example wont work with greedy/non-greedy, matching either
too much or not enough.

Here is a basic sample:
	<!---
		a comment
		<!--- nested comment --->
		still comment
	--->
	this is not commented
	<!--- more commenting --->

I want to tokenise comments, rather than ignore them, since the text
inside might be significant later on.

How the comments are tokenised doesn't matter - so I don't mind if
that first comment is split into 1/2/3 tokens.


However, Given that comments can be nested to an arbitrary level, I'm
having trouble working out how to define the rule without recursing
into itself.

(For practical purposes, I could probably set a maximum of maybe
ten-twenty levels deep, but I'd prefer not to create potential edge
cases like that.)


Here's my current attempt...

	COMMENT:
		SUB_CommentStart
		( SUB_NoComment | COMMENT )*
		SUB_CommentEnd
	;
	
	fragment SUB_CommentStart : '<!---' ;
	fragment SUB_CommentEnd   : '--->' ;
	fragment SUB_NoComment    : ~(SUB_CommentStart|SUB_CommentEnd)+;


Which of course fails due to including itself - so what's the best way
to fix that?

From claude.moulin at hds.utc.fr  Sat Oct 24 11:09:17 2009
From: claude.moulin at hds.utc.fr (Claude Moulin)
Date: Sat, 24 Oct 2009 20:09:17 +0200
Subject: [antlr-interest] repeating the parsing of a subtree
Message-ID: <3402BD9F2C1434438EF1F319BE558FBB01258E7B@xena.ad.utc>

I never had a good solution to the problem that I resolved before using
(or rendering public) the getNodeIndex method of the
CommonTreeNodeStream

class.

I have the following tree:

^(REPEAT a = atom list = .)

Where list can be parsed with a specific rule: list_instructions. 

atom returns an integer giving the number of times (maybe 0) the list of
instructions has to be executed.

The semantics of the instruction is then clear.

In the previous version of antlr I used the following interpreting Java
code:

{

 for (int i = 0; i < $a.r ; i++) {

   push(list);

   list_instructions();

   pop();

}

Where push and pop method are added to the tree parser:

private void push(CommonTree tree) {

 int n = ((CommonTreeNodeStream)input).getNodeIndex(tree);

 if (n >= 0)

   ((CommonTreeNodeStream)input).push(n);

}

private void pop() {

     ((CommonTreeNodeStream)input).pop();

  }

In version 3.2 CommonTreeNodeStream has been updated and I no longer
understand how to parse a subtree of the AST when it is needed and
possibly several times. The problem was to find the index of a Tree root
in the AST representation.

 

Can someone give the solution?

Thank you

Claude 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/01eb95ff/attachment.html 

From yurushkin at rambler.ru  Sat Oct 24 14:16:39 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 25 Oct 2009 01:16:39 +0400
Subject: [antlr-interest] [C target] can't debug parser
Message-ID: <op.u2bpd1bkt3jqlu@win-mupvrp0jyrf>

Good day...
I have parser that creates AST, I compile it with -debug option.
but debugger doesn't work - it stops one time and after pushing "continue"  
button doesn't stop...
AST isn't drown in AntlrWorks.

What can I do in such sitiation?

-- 
Best regards,
Michael

From kferrio at gmail.com  Sat Oct 24 14:21:10 2009
From: kferrio at gmail.com (Kyle Ferrio)
Date: Sat, 24 Oct 2009 14:21:10 -0700
Subject: [antlr-interest] MSBuild integration for the CSharp targets
In-Reply-To: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>
References: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>
Message-ID: <4608cec10910241421t3b252685u7edec2df04e223f9@mail.gmail.com>

On Fri, Oct 23, 2009 at 9:08 AM, Sam Harwell <sharwell at pixelminegames.com>wrote:

>  Hi everyone,
>
>
>
> I finally implemented true MSBuild integration for ANTLR grammars in C#
> projects. In addition to the tool (AntlrTool.exe), you?ll need the targets
> file (Antlr3.targets) and build task library (AntlrBuildTask.dll). The
> latest builds can be found in the bin\Bootstrap directory with the C# port
> of the tool. The integration should work with any of the C# targets as long
> as the project is being built in Visual Studio 2008 or later. Here is a list
> of basic features:
>
>
>
> ?         Proper handling of inter-grammar dependencies.
>
> ?         Uses timestamps for incremental builds. When regenerating code
> from the grammars is required, it uses the fast C# port. 19 grammars are
> generated for the C# port of the ANTLR tool itself, and a full rebuild
> including the grammars takes 8 seconds.
>
> ?         Generated outputs strictly constrained to the intermediate build
> path (normally obj\Debug and obj\Release).
>
> ?         Build, Clean, Rebuild all work as expected.
>
> ?         Much easier to add new grammars to a project. For an immediate
> example, open Antlr3.csproj (the C# port) as an XML file. Later I?ll be
> writing up a new set of directions for including grammars in your projects.
>
>
>
> I?ll be re-packaging everything as a regular download in the near future.
>
>
>
> Thank you,
>
> Sam Harwell
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
Hi.  I would like to gather the parts and begin to get my brain wrapped
about the C#3 target.  Where should I be looking?  I looked around on the
fisheye and found the sources for the runtime (which build fast and clean)
but I do not see the bin/BootStrap directory.  I am missing other stuff,
too, but I figure when I know here to look for this, I'll know here to look
for everythign else.

Thanks,
Kyle
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/ba2c3925/attachment.html 

From sharwell at pixelminegames.com  Sat Oct 24 14:35:51 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Sat, 24 Oct 2009 16:35:51 -0500
Subject: [antlr-interest] MSBuild integration for the CSharp targets
References: <DD5A5D428FE040429CCDF377FAA892840152DDF4@martini.ironwillgames.com>
	<4608cec10910241421t3b252685u7edec2df04e223f9@mail.gmail.com>
Message-ID: <DD5A5D428FE040429CCDF377FAA892840152DDF8@martini.ironwillgames.com>

Hi Kyle,

 

You can find them (the C# ports of StringTemplate and the Antlr Tool,
along with the bootstrap binaries) under this folder:

http://fisheye2.atlassian.com/browse/antlrcs/

 

Sam

 

From: Kyle Ferrio [mailto:kferrio at gmail.com] 
Sent: Saturday, October 24, 2009 4:21 PM
To: Sam Harwell; antlr-interest at antlr.org
Subject: Re: [antlr-interest] MSBuild integration for the CSharp targets

 

Hi.  I would like to gather the parts and begin to get my brain wrapped
about the C#3 target.  Where should I be looking?  I looked around on
the fisheye and found the sources for the runtime (which build fast and
clean) but I do not see the bin/BootStrap directory.  I am missing other
stuff, too, but I figure when I know here to look for this, I'll know
here to look for everythign else.

Thanks,
Kyle

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/4253084e/attachment.html 

From jbb at acm.org  Sat Oct 24 16:31:19 2009
From: jbb at acm.org (John B. Brodie)
Date: Sat, 24 Oct 2009 19:31:19 -0400
Subject: [antlr-interest] Nested multi-line comments
In-Reply-To: <5d97c170910240940r4f9ce1f4g24db101b064c369c@mail.gmail.com>
References: <5d97c170910240940r4f9ce1f4g24db101b064c369c@mail.gmail.com>
Message-ID: <1256427079.28232.3.camel@gecko.home.org>

Greetings!
On Sat, 2009-10-24 at 17:40 +0100, Peter Boughton wrote:
> How do I support nested comments with ANTLR?
> 

This is what I use:

// multiple-line comments
ML_COMMENT : NESTED_COMMENTARY { $channel=HIDDEN; } ;

fragment NESTED_COMMENTARY :
      '/*'
      ( options {greedy=false;} : . )*
      ( NESTED_COMMENTARY ( options {greedy=false;} : . )* )*
      '*/'
   ;

(note that this works using ANTLR 3.1.3 from Mar 2009, kinda old but I
think should still work with current ANTLR versions)

Perhaps you can adapt it to your language....
Hope this helps
   -jbb



From boughtonp at gmail.com  Sat Oct 24 16:48:25 2009
From: boughtonp at gmail.com (Peter Boughton)
Date: Sun, 25 Oct 2009 00:48:25 +0100
Subject: [antlr-interest] What causes org.antlr.runtime.EarlyExitException ?
Message-ID: <5d97c170910241648p561ff2d4xbf4b22d0b6ae3c@mail.gmail.com>

Hi,

I'm keep getting errors listed as "Recognition exception
org.antlr.runtime.EarlyExitException"

So what does this actually mean?
Obviously something has gone wrong, but how do I track down what it is?

Thanks,

Peter

From boughtonp at gmail.com  Sat Oct 24 17:03:07 2009
From: boughtonp at gmail.com (Peter Boughton)
Date: Sun, 25 Oct 2009 01:03:07 +0100
Subject: [antlr-interest] Nested multi-line comments
In-Reply-To: <1256427079.28232.3.camel@gecko.home.org>
References: <5d97c170910240940r4f9ce1f4g24db101b064c369c@mail.gmail.com>
	<1256427079.28232.3.camel@gecko.home.org>
Message-ID: <5d97c170910241703i2085948xb5f50b4c6c74ea43@mail.gmail.com>

Thanks John, but this doesn't appear to be working.
(I'm using antlr 3.2 with antlrworks 1.3)

I tried it both as provided and with changing the comment start/end
characters, and both of these give the same error in the generated
Java code:

	C:\tmp\antlr\__Test__.java:14: cannot find symbol
	symbol  : method ML_COMMENT()
	location: class cfml_comment_testParser
	            g.ML_COMMENT();
	             ^
	1 error

I'm testing this with a very basic set of rules at the moment:

	grammar cfml_comment_test;
	
	ML_COMMENT : NESTED_COMMENTARY { $channel=HIDDEN; } ;
	
	fragment NESTED_COMMENTARY :
	     '<!---'
	     ( options {greedy=false;} : . )*
	     ( NESTED_COMMENTARY ( options {greedy=false;} : . )* )*
	     '--->'
	  ;
	
	WS : ( ' ' | '\t' | '\n' | '\r' ) {$channel=HIDDEN;} ;
	
	TEXT: ~'<' ;
	
	code: ( ML_COMMENT | WS | TEXT )+;


Any ideas?

From marcelo.nichele at gmail.com  Sat Oct 24 17:21:48 2009
From: marcelo.nichele at gmail.com (Marcelo Nichele)
Date: Sat, 24 Oct 2009 22:21:48 -0200
Subject: [antlr-interest] What causes
	org.antlr.runtime.EarlyExitException ?
In-Reply-To: <5d97c170910241648p561ff2d4xbf4b22d0b6ae3c@mail.gmail.com>
References: <5d97c170910241648p561ff2d4xbf4b22d0b6ae3c@mail.gmail.com>
Message-ID: <848594440910241721h4aace01bx610251de84a7ddf@mail.gmail.com>

Hi Peter,

One way of track error is through @rulecatch clause. So, every exception in
your grammar will be caught there.
Ex:

@rulecatch {
catch (RecognitionException e) {
    reportError(e);
    throw e;
}
}


On Sat, Oct 24, 2009 at 9:48 PM, Peter Boughton <boughtonp at gmail.com> wrote:

> Hi,
>
> I'm keep getting errors listed as "Recognition exception
> org.antlr.runtime.EarlyExitException"
>
> So what does this actually mean?
> Obviously something has gone wrong, but how do I track down what it is?
>
> Thanks,
>
> Peter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091024/aca4b8ba/attachment.html 

From horst.dehmer at inode.at  Sat Oct 24 17:48:15 2009
From: horst.dehmer at inode.at (Horst Dehmer)
Date: Sun, 25 Oct 2009 02:48:15 +0200
Subject: [antlr-interest] finish/stop parsing without closing reader
In-Reply-To: <C708C8BA.97A%horst.dehmer@inode.at>
Message-ID: <C7096CEF.98A%horst.dehmer@inode.at>

Well, investing further my ?problem? I come to understand that passing on
the input stream from the lexer/parser to another component for storing
binary data occurring after a certain rule was matched is not such a good
idea. Mainly because the lexer loads a big chunk from the stream to an
internal buffer for further processing.

What I am now looking into is something like that:

d_data
  : oigId syncpointId uncompressedLength (BINARY { store/append
$BINARY.text.getBytes() to file; })+
  ;

// zlib deflated data containing 0x00 and 0xff :-(
BINARY
  : (?\u0000?..?\u00ff?) [match at least 1 time, at most n * 1024 times]
  ;

But how could that ever work? I mean at least 0x00 and 0xff have special
meanings. Which characters exactly would be matched by (.)+ for that matter?
Probably not EOF.

Maybe another approach would be to have some global state shared by the
parser and lexer with which the lexer could be switched to write the
remaining bytes to a file (directly from the input stream). But as far as I
understand things (and that?s not very much) the lexer would not be called
another time after the parser is done recognizing. Problem is, I can?t
determine the time to switch to byte processing in the lexer.

Honestly I?m kinda stuck... Any ideas?

- Horst


On 24.10.09 15:07, "Horst Dehmer" <horst.dehmer at inode.at> wrote:

> Hello!
> 
> For one special parser rule in my grammar I have to stop parsing and read the
> rest of the input from the reader as (compressed) binary data. Is there any
> way to instruct the parser to stop reading further tokens when the top most
> rule was successfully recognized?
> 
> Any help is highly appreciated!
> 
> - Horst
> 
> More details:  The rule recognizes header information for the then following
> binary data:
> 
> d_data returns [D_DATA pdu]
> @init {
>   pdu = null;
> }
>   : 'D4|' oigId = oig_id '|' syncpointId = syncpoint_id '|' uncompressedLength
> = length '|'
>     {
>       SyncpointDescriptor syncpoint = ...
>       pdu = new D_DATA(syncpoint);
>     }
>   ;
> 
> The size of the binary data following the last ?|? can become quite big and I
> have to store them as a file to disk.
> After the header is recognized the parser returns but the input reader is
> closed. Without using EOF in the rule, it seems the additional bytes are
> consumed from ANTLRReaderStream:
> 
> CharStream charStream = new ANTLRReaderStream(reader);
> PduLexer lexer = new PduLexer(charStream);
> TokenStream tokenStream = new CommonTokenStream(lexer);
> PduParser parser = new PduParser(tokenStream);
> ...
> 
> With a trailing EOF in the rule the parser naturally complains about the
> additional information: line 1:36 extraneous input '<binary data>' expecting
> EOF
> The test case shows proper recognition of the T2/D4 along with syncpoint
> token, but reading ?<binary data>? fails due to a closed reader/stream.
> 
> @Test
> public void parse_whole() throws RecognitionException, IOException {
>     final BigDecimal OIG = new BigDecimal("10903008203000000001");
>     final String SYNCPOINT = "82737";
>     final long LENGTH = 40;
>     final String FORMAT = "T2|D4|%20.0f|%s|%d|<binary data>";
>     final String MESSAGE = String.format(FORMAT, OIG, SYNCPOINT, LENGTH);
> 
>     StringReader reader = new StringReader(MESSAGE);
>     T_PDU t_pdu = parserDriver.parse(reader); // OK.
>     D_PDU d_pdu = ((T_DATA) t_pdu).getPdu(); // OK.
>     D_DATA d_data = (D_DATA) d_pdu; // OK.
>     SyncpointDescriptor token = d_data.getToken();
>     
>     assertEquals(OIG, token.oigId); // OK.
>     assertEquals(SYNCPOINT, token.syncpointId); // OK.
>     assertEquals(LENGTH, token.uncompressedLength); // OK.
> 
>     try {
>         // reader should be positioned at the rest of the message, i.e.
> ?<binary data>?.
>         char[] buffer = new char["<binary data>".length()];
>         reader.read(buffer);
>     }
>     catch (IOException exception) {
>         // NOT OK:
>         // java.io.IOException: Stream closed
>     }
> }
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091025/37d81ff5/attachment.html 

From gwlist at grahamwideman.com  Sat Oct 24 18:03:26 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Sat, 24 Oct 2009 18:03:26 -0700
Subject: [antlr-interest] Nested multi-line comments
In-Reply-To: <5d97c170910241703i2085948xb5f50b4c6c74ea43@mail.gmail.com>
References: <1256427079.28232.3.camel@gecko.home.org>
	<5d97c170910240940r4f9ce1f4g24db101b064c369c@mail.gmail.com>
	<1256427079.28232.3.camel@gecko.home.org>
Message-ID: <4.1.20091024180119.019c0dd8@grahamwideman.com>

Peter:

I surmise from this that your main test routine is trying to call g.ML_COMMENT, when it should be calling the top level (starting) lexer rule method:

   g.code();

-- Graham

At 10/25/2009 01:03 AM, Peter Boughton wrote:
>Thanks John, but this doesn't appear to be working.
>(I'm using antlr 3.2 with antlrworks 1.3)
>
>I tried it both as provided and with changing the comment start/end
>characters, and both of these give the same error in the generated
>Java code:
>
>	C:\tmp\antlr\__Test__.java:14: cannot find symbol
>	symbol  : method ML_COMMENT()
>	location: class cfml_comment_testParser
>	            g.ML_COMMENT();
>	             ^
>	1 error
>
>I'm testing this with a very basic set of rules at the moment:
>
>	grammar cfml_comment_test;
>	
>	ML_COMMENT : NESTED_COMMENTARY { $channel=HIDDEN; } ;
>	
>	fragment NESTED_COMMENTARY :
>	     '<!---'
>	     ( options {greedy=false;} : . )*
>	     ( NESTED_COMMENTARY ( options {greedy=false;} : . )* )*
>	     '--->'
>	  ;
>	
>	WS : ( ' ' | '\t' | '\n' | '\r' ) {$channel=HIDDEN;} ;
>	
>	TEXT: ~'<' ;
>	
>	code: ( ML_COMMENT | WS | TEXT )+;



From tommy.chheng at gmail.com  Sun Oct 25 00:46:40 2009
From: tommy.chheng at gmail.com (Tommy Chheng)
Date: Sun, 25 Oct 2009 00:46:40 -0700
Subject: [antlr-interest] ANTLR AST vs Tree Grammar
Message-ID: <8bbfc6fc0910250046w3aa0e614q50a9047375a9c78@mail.gmail.com>

I'm using ANTLR to construct a small general purpose compiler. I've used
JFlex/CUP in the past but ANTLR looks like it can help generate better code
in a more streamline process. I'm reading the Language Implementation
Patterns book which has a few ANTLR examples (
http://pragprog.com/titles/tpdsl/source_code)

I'm a little confused about difference between the Tree Grammar and AST
output option in ANTLR.

In walking/tree-grammar folder of (
http://pragprog.com/titles/tpdsl/source_code),  there's a lexer/parser
grammar (like VecMath.g) with a header:
options {output=AST;} // we want to create ASTs

This will just produce the parser code(VecMathLexer/VecMathParser), but not
the actual AST?
In the folder, i see a bunch of "VarNode, IntNode..". Were these AST classes
just manually created?

Then if I want to actually produce an AST tree walk output. I would have to
create something like Printer.g:
tree grammar Printer; // this grammar is a tree grammar called Printer
tokenVocab=VecMath;      // use token vocabulary from VecMath.g
ASTLabelType=CommonTree; // use homogeneous CommonTree for $ID, etc.

In Printer.g, it looks like a DIFFERENT set of parsing rules? Isn't it
problematic to have 2 sets of grammar parsing rules?
Printer.g:
expr:   ^('+' expr {print("+");} expr)
    |   ^('*' expr {print("*");} expr)
vs
VecMath.g:
expr:    multExpr ('+'^ multExpr)* ;     // '+' is root node
multExpr
    :   primary (('*'^|'.'^) primary)*  // '*', '.' are roots
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091025/6d23b4b0/attachment.html 

From yurushkin at rambler.ru  Sun Oct 25 03:02:34 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 25 Oct 2009 13:02:34 +0300
Subject: [antlr-interest] [C target] -trace option bug
Message-ID: <op.u2coukq7t3jqlu@win-mupvrp0jyrf>


generates:
ANTLR3_PRINTF("exit execution_part %d failed=%s backtracking=%s\n", LT(1),  
failed, BACKTRACKING);

failed  - isn't declared... please, fix this bug

-- 
Best regards,
Michael

From jimi at temporal-wave.com  Sun Oct 25 03:16:42 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 25 Oct 2009 06:16:42 -0400
Subject: [antlr-interest] [C target] can't debug parser
In-Reply-To: <op.u2bpd1bkt3jqlu@win-mupvrp0jyrf>
Message-ID: <57029bbaee5f014aaa5f25718edb0ee7@temporal-wave.com>

It is possibly out of sync with the debugging protocol. The 3.2.1 release is intended to be a 'target sync up' release to catch up with everything that was put in 3.2 for the release. I will make sure that debugging in C is working in that release. However, I have always found it at least as useful to debug the generated C code directly.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of ??????? ??????
> Sent: Saturday, October 24, 2009 5:17 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] [C target] can't debug parser
> 
> Good day...
> I have parser that creates AST, I compile it with -debug option.
> but debugger doesn't work - it stops one time and after pushing
> "continue"
> button doesn't stop...
> AST isn't drown in AntlrWorks.
> 
> What can I do in such sitiation?
> 
> --
> Best regards,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Sun Oct 25 03:19:35 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 25 Oct 2009 06:19:35 -0400
Subject: [antlr-interest] What causes
	org.antlr.runtime.EarlyExitException ?
In-Reply-To: <5d97c170910241648p561ff2d4xbf4b22d0b6ae3c@mail.gmail.com>
Message-ID: <bb414e71f55acf45adeb20f2090f0371@temporal-wave.com>

Easiest way to see this is to look at the generated code - it will make more sense to you. But it means you have something like ( X Y Z)+ and have failed to match any sequence of it. Look at where the exception is thrown and it will show you where in your grammar this is happening. You can then decide if your grammar or your input is incorrect. When you implement proper error handling you will change 'early exit' to something more meaningful in the context of your DSL.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Peter Boughton
> Sent: Saturday, October 24, 2009 7:48 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] What causes
> org.antlr.runtime.EarlyExitException ?
> 
> Hi,
> 
> I'm keep getting errors listed as "Recognition exception
> org.antlr.runtime.EarlyExitException"
> 
> So what does this actually mean?
> Obviously something has gone wrong, but how do I track down what it is?
> 
> Thanks,
> 
> Peter
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From simone.tripodi at gmail.com  Sun Oct 25 03:51:08 2009
From: simone.tripodi at gmail.com (Simone Tripodi)
Date: Sun, 25 Oct 2009 11:51:08 +0100
Subject: [antlr-interest] How to implement a pull parser?
Message-ID: <4173dc210910250351i50192ff9mc25f5770614d9a22@mail.gmail.com>

Hi everybody,
I'd like to implement a pull-like parser using ANTLR but I don't have
any idea where starting from!
The scenario is, for example, a simple CSV parser I can drive invoking
a "give me the next line" method...
Any hint/idea? Every help will be more than appreciated :)
Thanks in advance, best regards!!!

Simone

-- 
http://www.google.com/profiles/simone.tripodi

From marcelo.nichele at gmail.com  Sun Oct 25 04:51:45 2009
From: marcelo.nichele at gmail.com (Marcelo Nichele)
Date: Sun, 25 Oct 2009 09:51:45 -0200
Subject: [antlr-interest] What causes
	org.antlr.runtime.EarlyExitException ?
In-Reply-To: <bb414e71f55acf45adeb20f2090f0371@temporal-wave.com>
References: <5d97c170910241648p561ff2d4xbf4b22d0b6ae3c@mail.gmail.com>
	<bb414e71f55acf45adeb20f2090f0371@temporal-wave.com>
Message-ID: <848594440910250451y68c89e63kc277029d1f8f6cd7@mail.gmail.com>

Another way is debugging in ANTLRWorks, because you manage to view
step-by-step the decisions through the graphs becomming more easy our life.

I hope help you.

Cheers,

Marcelo


On Sun, Oct 25, 2009 at 8:19 AM, Jim Idle <jimi at temporal-wave.com> wrote:

> Easiest way to see this is to look at the generated code - it will make
> more sense to you. But it means you have something like ( X Y Z)+ and have
> failed to match any sequence of it. Look at where the exception is thrown
> and it will show you where in your grammar this is happening. You can then
> decide if your grammar or your input is incorrect. When you implement proper
> error handling you will change 'early exit' to something more meaningful in
> the context of your DSL.
>
> Jim
>
> > -----Original Message-----
> > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > bounces at antlr.org] On Behalf Of Peter Boughton
> > Sent: Saturday, October 24, 2009 7:48 PM
> > To: antlr-interest at antlr.org
> > Subject: [antlr-interest] What causes
> > org.antlr.runtime.EarlyExitException ?
> >
> > Hi,
> >
> > I'm keep getting errors listed as "Recognition exception
> > org.antlr.runtime.EarlyExitException"
> >
> > So what does this actually mean?
> > Obviously something has gone wrong, but how do I track down what it is?
> >
> > Thanks,
> >
> > Peter
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> > email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091025/ac1f6a71/attachment.html 

From jbb at acm.org  Sun Oct 25 07:23:59 2009
From: jbb at acm.org (John B. Brodie)
Date: Sun, 25 Oct 2009 10:23:59 -0400
Subject: [antlr-interest] Nested multi-line comments
In-Reply-To: <5d97c170910241703i2085948xb5f50b4c6c74ea43@mail.gmail.com>
References: <5d97c170910240940r4f9ce1f4g24db101b064c369c@mail.gmail.com>
	<1256427079.28232.3.camel@gecko.home.org>
	<5d97c170910241703i2085948xb5f50b4c6c74ea43@mail.gmail.com>
Message-ID: <1256480639.31403.8.camel@gecko.home.org>

On Sun, 2009-10-25 at 01:03 +0100, Peter Boughton wrote:
> Thanks John, but this doesn't appear to be working.
> (I'm using antlr 3.2 with antlrworks 1.3)
> 
> I tried it both as provided and with changing the comment start/end
> characters, and both of these give the same error in the generated
> Java code:
> 
> 	C:\tmp\antlr\__Test__.java:14: cannot find symbol
> 	symbol  : method ML_COMMENT()
> 	location: class cfml_comment_testParser
> 	            g.ML_COMMENT();
> 	             ^
> 	1 error
> 
> I'm testing this with a very basic set of rules at the moment:
> 
> 	grammar cfml_comment_test;
> 	
> 	ML_COMMENT : NESTED_COMMENTARY { $channel=HIDDEN; } ;
> 	
> 	fragment NESTED_COMMENTARY :
> 	     '<!---'
> 	     ( options {greedy=false;} : . )*
> 	     ( NESTED_COMMENTARY ( options {greedy=false;} : . )* )*
> 	     '--->'
> 	  ;
> 	
> 	WS : ( ' ' | '\t' | '\n' | '\r' ) {$channel=HIDDEN;} ;
> 	
> 	TEXT: ~'<' ;
> 	
> 	code: ( ML_COMMENT | WS | TEXT )+;
> 
> 
> Any ideas?

just upgraded to ANTLR 3.2 as contained in the ANTLRWorks 1.3 jar file.

and now, for me, the above grammar compiles without any error.

perhaps, as someone else suggested, you have a problem with your test
rig? I notice that the identifier `g` appears *nowhere* in your posted
grammar, yet the compiler error message references `g`.....


as an aside, your Parser rule `code` is trying to recognize both
ML_COMMENT and WS which are HIDDEN Tokens -- the Lexer will never
deliver those Tokens to the Parser (that is, after all, the whole
purpose of the HIDDEN channel).






From alex at lexoft.eu  Sun Oct 25 14:14:44 2009
From: alex at lexoft.eu (Alexandru Nedelcu)
Date: Sun, 25 Oct 2009 23:14:44 +0200
Subject: [antlr-interest] IntelliJ plugin doesn't work with the community
	edition
Message-ID: <1256505284.9268.5.camel@gathern.lan>

Hi, I'm an Antlr rookie.

I installed the IntelliJ Community Edition, hoping to get a good IDE for
my Antlr projects ...
http://www.jetbrains.com/idea/nextversion/free_java_ide.html

The Antlr plugin fails to launch ... apparently it throws a
NumberFormatException on parsing the IntelliJ IDEA's version number ...
#IC-90.96

Is this a bug, or is the IDE's fault (I think it's a preview version) ?

Thanks,


From alex at lexoft.eu  Mon Oct 26 04:24:31 2009
From: alex at lexoft.eu (Alexandru Nedelcu)
Date: Mon, 26 Oct 2009 13:24:31 +0200
Subject: [antlr-interest] IntelliJ plugin doesn't work with the community
	edition
Message-ID: <1256556271.7665.5.camel@gathern.lan>

Hi, I'm an Antlr rookie.

I installed the IntelliJ Community Edition, hoping to get a good IDE for
my Antlr projects ...
http://www.jetbrains.com/idea/nextversion/free_java_ide.html

The Antlr plugin fails to launch ... apparently it throws a
NumberFormatException on parsing the IntelliJ IDEA's version number ...
#IC-90.96

Is this a bug, or is the IDE's fault (I think it's a preview version) ?

Thanks,


From nvivo.misc at gmail.com  Mon Oct 26 04:50:05 2009
From: nvivo.misc at gmail.com (Natan Vivo)
Date: Mon, 26 Oct 2009 09:50:05 -0200
Subject: [antlr-interest] ANTLR AST vs Tree Grammar
In-Reply-To: <8bbfc6fc0910250046w3aa0e614q50a9047375a9c78@mail.gmail.com>
References: <8bbfc6fc0910250046w3aa0e614q50a9047375a9c78@mail.gmail.com>
Message-ID: <d78326310910260450o4f4d69e0n6eb0345e87fb3aec@mail.gmail.com>

Hi Tommy,

Tree Grammars and ASTs are not competing in the same space. AST is just the
tree of nodes that represent your input. Tree Grammar is a grammar made
specifically to parse those  ASTs.

You usually use them to walk through an AST you already built, and do things
with it. Think about the multiple passes a compiler needs to go through to
generate the final binary. In the first pass, you use the parser and lexer
to understand the basic syntax and generate the AST, next you may need to
simplify some code, remove unnecessary instructions, set the type
information for variables, change the structure, or even output code in
another language.

Basically you may build as many tree grammars you need to do those passes,
and pipe them to produce the desired output.

The tree grammar looks like a parser grammar, but it actually uses node
types instead of tokens to identify the patterns, so they are not exactly
different grammars to parse the same thing.

Hope it helps.


On Sun, Oct 25, 2009 at 5:46 AM, Tommy Chheng <tommy.chheng at gmail.com>wrote:

> I'm using ANTLR to construct a small general purpose compiler. I've used
> JFlex/CUP in the past but ANTLR looks like it can help generate better code
> in a more streamline process. I'm reading the Language Implementation
> Patterns book which has a few ANTLR examples (
> http://pragprog.com/titles/tpdsl/source_code)
>
> I'm a little confused about difference between the Tree Grammar and AST
> output option in ANTLR.
>
> In walking/tree-grammar folder of (
> http://pragprog.com/titles/tpdsl/source_code),  there's a lexer/parser
> grammar (like VecMath.g) with a header:
> options {output=AST;} // we want to create ASTs
>
> This will just produce the parser code(VecMathLexer/VecMathParser), but not
> the actual AST?
> In the folder, i see a bunch of "VarNode, IntNode..". Were these AST
> classes just manually created?
>
> Then if I want to actually produce an AST tree walk output. I would have to
> create something like Printer.g:
> tree grammar Printer; // this grammar is a tree grammar called Printer
> tokenVocab=VecMath;      // use token vocabulary from VecMath.g
> ASTLabelType=CommonTree; // use homogeneous CommonTree for $ID, etc.
>
> In Printer.g, it looks like a DIFFERENT set of parsing rules? Isn't it
> problematic to have 2 sets of grammar parsing rules?
> Printer.g:
> expr:   ^('+' expr {print("+");} expr)
>     |   ^('*' expr {print("*");} expr)
> vs
> VecMath.g:
> expr:    multExpr ('+'^ multExpr)* ;     // '+' is root node
> multExpr
>     :   primary (('*'^|'.'^) primary)*  // '*', '.' are roots
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091026/81cc0158/attachment.html 

From guillaume.helle at capgemini.com  Mon Oct 26 08:16:36 2009
From: guillaume.helle at capgemini.com (Helle, Guillaume)
Date: Mon, 26 Oct 2009 16:16:36 +0100
Subject: [antlr-interest] Antlr and language editor with Eclipse RCP
In-Reply-To: <117161.72390.qm@web55903.mail.re3.yahoo.com>
References: <SNT104-W51E2C43FC8B959C7325E2FC4BC0@phx.gbl>
	<117161.72390.qm@web55903.mail.re3.yahoo.com>
Message-ID: <6AAB2C2CD963E44F8CD291807C17EDDA1E92844C78@CORPMAIL07.corp.capgemini.com>

Hello,

I am building a test language with antlr.
Now I want to develop a code editor for this language with Eclipse RCP (as an Eclipse Plugin) with code completion, colour for keywords,...
Have you do that from grammar or from java generated code?
Have you a simple example of language editor build with Eclipse Plugin?

Thx for your help!

Best regards,

Guillaume Helle

</PRE><p style="font-family:arial;color:grey" style="font-size:13px">This message contains information that may be privileged or confidential and is the property of the Capgemini Group. It is intended only for the person to whom it is addressed. If you are not the intended recipient, you are not authorized to read, print, retain, copy, disseminate, distribute, or use this message or any part thereof. If you receive this message in error, please notify the sender immediately and delete all copies of this message.</p><PRE>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091026/9a25e588/attachment.html 

From naveen.chwl at googlemail.com  Mon Oct 26 11:33:49 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 26 Oct 2009 18:33:49 +0000
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <-6965020265928568256@unknownmsgid>
References: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>
	<D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>
	<56eb2660910232040l69b84ba3yd591c02a47a47c98@mail.gmail.com>
	<-6965020265928568256@unknownmsgid>
Message-ID: <56eb2660910261133m1e26807cm4a233a0348282b95@mail.gmail.com>

I can't open the "tpantlr-code" file in that archive, for some reason. Can
somebody give me, for example "a: 'hello'; ", just that single symbol
grammar, then making an AST from it, then a Tree grammar, and using
StringTemplate to output "hi" from it. I can't find such a simple example
anywhere. i.e. "hi" -> "hello". Surely someone who has used the
features many times would take just a few seconds even from memory.

2009/10/24 Indhu Bharathi <indhu.b at s7software.com>

>  Section 9.6 of ANTLR definitive reference (Building a Java Bytecode
> Generator Using a Tree Grammar and Templates) does this.
>
>
>
> The free code samples are available at
> http://media.pragprog.com/titles/tpantlr/code/tpantlr-code.tgz
>
>
>
> Samples for this specific section is available at
> ?Code/templates/generator? inside the archive.
>
>
>
> The book has a very good explanation too.
>
>
>
> Cheers, Indhu
>
>
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
> *Sent:* Saturday, October 24, 2009 9:11 AM
> *To:* Terence Parr
> *Cc:* ANTLR Interest Mailing List
> *Subject:* Re: [antlr-interest] Can somebody give me the very simplest
> example of grammar to AST to StringTemplate output
>
>
>
> No, where?
> Many thanks, N
>
> 2009/10/23 Terence Parr <parrt at cs.usfca.edu>
>
> have you looked at the (free) code for both books?
> Ter
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091026/b5f04ffe/attachment.html 

From naveen.chwl at googlemail.com  Mon Oct 26 11:37:59 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 26 Oct 2009 18:37:59 +0000
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <56eb2660910261133m1e26807cm4a233a0348282b95@mail.gmail.com>
References: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>
	<D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>
	<56eb2660910232040l69b84ba3yd591c02a47a47c98@mail.gmail.com>
	<-6965020265928568256@unknownmsgid>
	<56eb2660910261133m1e26807cm4a233a0348282b95@mail.gmail.com>
Message-ID: <56eb2660910261137kb16b88eic4c9541f10282bd6@mail.gmail.com>

Sorry if I sound rushed, I'm doing so many other things as well.

Regards, N

2009/10/26 Naveen Chawla <naveen.chwl at googlemail.com>

> I can't open the "tpantlr-code" file in that archive, for some reason. Can
> somebody give me, for example "a: 'hello'; ", just that single symbol
> grammar, then making an AST from it, then a Tree grammar, and using
> StringTemplate to output "hi" from it. I can't find such a simple example
> anywhere. i.e. "hi" -> "hello". Surely someone who has used the
> features many times would take just a few seconds even from memory.
>
> 2009/10/24 Indhu Bharathi <indhu.b at s7software.com>
>
>   Section 9.6 of ANTLR definitive reference (Building a Java Bytecode
>> Generator Using a Tree Grammar and Templates) does this.
>>
>>
>>
>> The free code samples are available at
>> http://media.pragprog.com/titles/tpantlr/code/tpantlr-code.tgz
>>
>>
>>
>> Samples for this specific section is available at
>> ?Code/templates/generator? inside the archive.
>>
>>
>>
>> The book has a very good explanation too.
>>
>>
>>
>> Cheers, Indhu
>>
>>
>>
>>
>>
>> *From:* antlr-interest-bounces at antlr.org [mailto:
>> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
>> *Sent:* Saturday, October 24, 2009 9:11 AM
>> *To:* Terence Parr
>> *Cc:* ANTLR Interest Mailing List
>> *Subject:* Re: [antlr-interest] Can somebody give me the very simplest
>> example of grammar to AST to StringTemplate output
>>
>>
>>
>> No, where?
>> Many thanks, N
>>
>> 2009/10/23 Terence Parr <parrt at cs.usfca.edu>
>>
>> have you looked at the (free) code for both books?
>> Ter
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091026/a23a7616/attachment.html 

From naveen.chwl at googlemail.com  Mon Oct 26 11:50:07 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Mon, 26 Oct 2009 18:50:07 +0000
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <56eb2660910261137kb16b88eic4c9541f10282bd6@mail.gmail.com>
References: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>
	<D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>
	<56eb2660910232040l69b84ba3yd591c02a47a47c98@mail.gmail.com>
	<-6965020265928568256@unknownmsgid>
	<56eb2660910261133m1e26807cm4a233a0348282b95@mail.gmail.com>
	<56eb2660910261137kb16b88eic4c9541f10282bd6@mail.gmail.com>
Message-ID: <56eb2660910261150y5f59305bwdf7f1475e1234012@mail.gmail.com>

I sounded rude! You are all legends, I just didn't want to delve into the
C/Java bytecode yet, just in order to learn the basic syntax. It's the basic
syntax is all I need right now, hence my request for an example translator
of "hi" -> "hello", and I can't find it "bunched together" as such.

Many thanks,
N

2009/10/26 Naveen Chawla <naveen.chwl at googlemail.com>

> Sorry if I sound rushed, I'm doing so many other things as well.
>
> Regards, N
>
> 2009/10/26 Naveen Chawla <naveen.chwl at googlemail.com>
>
> I can't open the "tpantlr-code" file in that archive, for some reason. Can
>> somebody give me, for example "a: 'hello'; ", just that single symbol
>> grammar, then making an AST from it, then a Tree grammar, and using
>> StringTemplate to output "hi" from it. I can't find such a simple example
>> anywhere. i.e. "hi" -> "hello". Surely someone who has used the
>> features many times would take just a few seconds even from memory.
>>
>> 2009/10/24 Indhu Bharathi <indhu.b at s7software.com>
>>
>>   Section 9.6 of ANTLR definitive reference (Building a Java Bytecode
>>> Generator Using a Tree Grammar and Templates) does this.
>>>
>>>
>>>
>>> The free code samples are available at
>>> http://media.pragprog.com/titles/tpantlr/code/tpantlr-code.tgz
>>>
>>>
>>>
>>> Samples for this specific section is available at
>>> ?Code/templates/generator? inside the archive.
>>>
>>>
>>>
>>> The book has a very good explanation too.
>>>
>>>
>>>
>>> Cheers, Indhu
>>>
>>>
>>>
>>>
>>>
>>> *From:* antlr-interest-bounces at antlr.org [mailto:
>>> antlr-interest-bounces at antlr.org] *On Behalf Of *Naveen Chawla
>>> *Sent:* Saturday, October 24, 2009 9:11 AM
>>> *To:* Terence Parr
>>> *Cc:* ANTLR Interest Mailing List
>>> *Subject:* Re: [antlr-interest] Can somebody give me the very simplest
>>> example of grammar to AST to StringTemplate output
>>>
>>>
>>>
>>> No, where?
>>> Many thanks, N
>>>
>>> 2009/10/23 Terence Parr <parrt at cs.usfca.edu>
>>>
>>> have you looked at the (free) code for both books?
>>> Ter
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091026/faeff816/attachment.html 

From jimi at temporal-wave.com  Mon Oct 26 12:30:32 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 26 Oct 2009 12:30:32 -0700
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <56eb2660910261150y5f59305bwdf7f1475e1234012@mail.gmail.com>
Message-ID: <63944fdc632eef48bdebf8cd32436afb@temporal-wave.com>

Here are some snippets from a tree parser using option output=template:

 

Straight creation from a rewrite and list:

 

statements

 

    :   s+=statement_comment*

        -> statements(stats={$s})

 ;

 

Just passing a result up the rule chain (don't have rules return an empty $st):

 

ruleDefinition

 : ^(RULE

      statements

   )

   {

     $st = $statements.st;

   }

;

 

>From a rule reference:

 

 

statement_comment

   : ^(STATEMENT statement

        (

           STAT_COMMENT

                    ->line(stat={$statement.st}, comment={$STAT_COMMENT.text})

...

 

 

In an action:

 

| COMMENT                 

  {

    // Get rid of leading spaces and the ' character, generate the comment line

    //

    $st = %lineComment(comment={$COMMENT.text.trim().substring(1)});

  }

 

 

Calling some Java code that returns a StringTemplate using return elements from a rule reference:

 

...

{

   // Ask the code generator to deal with the assignment

   //

   $st = codeGen.assign($v.st, $v.symbol, $expression.st, $expression.symbol, $expression.type);

}

...

 

 

Creating a template that is named from the value of a terminal and setting attributes of the StringTemplate in actions:

 

callStatement

@init {

    Function f;

}

     :    ^(CALL

            id=IDENTIFIER

            {

                $st = %({$id.text})();

                f = (Function)localSymbols.lookup($id.text);

                %{$st}.instr=f.getInstruction();

 }

...

 

 

Setting the template before invoking the tree walker (or parser):

 

    /**

     * The String Template group loader object, which knows where and how

     * to instantiate templates for us.

     */

    protected StringTemplateGroupLoader loader;

 

    /**

     * The string template that is used for code generation of the main file

     */

    protected StringTemplate theFile;

 

    loader = new CommonGroupLoader(templateDirs.toString(), null);

    StringTemplateGroup.registerGroupLoader(loader);

    StringTemplateGroup.registerDefaultLexer(AngleBracketTemplateLexer.class);

    templates = StringTemplateGroup.loadGroup("rtfm");

 

... // create parser/AST walker etc  ...

 

    codeGen.setTemplateLib(templates);

 

 

By the way - all these things are right there in TDAR - you need only read about 5 or 6 pages. I think it took me longer to format this than it would to read that section of the book.

 

For your grammar:

 

grammar rtfm;

options { output=AST; }

tokens { RTFM; }

a: h=HELLO ->^(RTFM $h);

HELLO : 'hello' ;

 

AST:

 

tree grammar rtfmtree;

options { output=template; tokenVocab=rtfm;  }

a: ^(RTFM HELLO) -> rtfm(hello={$HELLO.text})

 

Template:

 

group rtfm;

rtfm(hello) ::=

<< 

<hello>, please take the time to RTFM instead of asking for people to do it for you.

>> 

 

 

Just finish work a little early tonight, skip the bar, don't turn on the TV or the computer and read TDAR. You'll be done by 10:30PM and the next day you will be able to do the work.

 

Jim (off to the bar because I did all the reading already ;-) )

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Monday, October 26, 2009 11:50 AM
To: Indhu Bharathi
Cc: ANTLR Interest Mailing List; Terence Parr
Subject: Re: [antlr-interest] Can somebody give me the very simplest example of grammar to AST to StringTemplate output

 

I sounded rude! You are all legends, I just didn't want to delve into the C/Java bytecode yet, just in order to learn the basic syntax. It's the basic syntax is all I need right now, hence my request for an example translator of "hi" -> "hello", and I can't find it "bunched together" as such.

 

Many thanks,

N

2009/10/26 Naveen Chawla <naveen.chwl at googlemail.com>

Sorry if I sound rushed, I'm doing so many other things as well.

 

Regards, N

2009/10/26 Naveen Chawla <naveen.chwl at googlemail.com> 

 

I can't open the "tpantlr-code" file in that archive, for some reason. Can somebody give me, for example "a: 'hello'; ", just that single symbol grammar, then making an AST from it, then a Tree grammar, and using StringTemplate to output "hi" from it. I can't find such a simple example anywhere. i.e. "hi" -> "hello". Surely someone who has used the features many times would take just a few seconds even from memory.

2009/10/24 Indhu Bharathi <indhu.b at s7software.com> 

 

Section 9.6 of ANTLR definitive reference (Building a Java Bytecode Generator Using a Tree Grammar and Templates) does this. 

 

The free code samples are available at http://media.pragprog.com/titles/tpantlr/code/tpantlr-code.tgz

 

Samples for this specific section is available at 'Code/templates/generator' inside the archive.

 

The book has a very good explanation too.

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Saturday, October 24, 2009 9:11 AM
To: Terence Parr
Cc: ANTLR Interest Mailing List
Subject: Re: [antlr-interest] Can somebody give me the very simplest example of grammar to AST to StringTemplate output

 

No, where?
Many thanks, N

2009/10/23 Terence Parr <parrt at cs.usfca.edu>

have you looked at the (free) code for both books?
Ter

 

 

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091026/925bae64/attachment.html 

From steerr at bellsouth.net  Mon Oct 26 14:43:49 2009
From: steerr at bellsouth.net (Bill Steer)
Date: Mon, 26 Oct 2009 17:43:49 -0400
Subject: [antlr-interest] Setup question
Message-ID: <4AE61815.9090505@bellsouth.net>

We're setting up a new machine (I have my development machine running 
Antlrworks-1.2.3) and can't find the Antlr3.Runtime.dll file in the 
Antlrworks-1.3 download.  Can somebody please point me to where it is 
now?  We need it for referencing from a Visual Studio project.

Thanks.

Bill


From jimi at temporal-wave.com  Mon Oct 26 15:02:49 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 26 Oct 2009 15:02:49 -0700
Subject: [antlr-interest] Setup question
In-Reply-To: <4AE61815.9090505@bellsouth.net>
Message-ID: <ddaaf8ef4c6d0e4fbd30eda50daa9cd9@temporal-wave.com>

Have you tried looking on the Downloads page for ANTLR and downloading the .Net runtime?

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Bill Steer
> Sent: Monday, October 26, 2009 2:44 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Setup question
> 
> We're setting up a new machine (I have my development machine running
> Antlrworks-1.2.3) and can't find the Antlr3.Runtime.dll file in the
> Antlrworks-1.3 download.  Can somebody please point me to where it is
> now?  We need it for referencing from a Visual Studio project.
> 
> Thanks.
> 
> Bill
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From kaleb.pederson at gmail.com  Mon Oct 26 15:55:04 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Mon, 26 Oct 2009 15:55:04 -0700
Subject: [antlr-interest] How to access member of CommonTree subclass
Message-ID: <200910261555.04326.kaleb.pederson@gmail.com>

I'm working with a tree parser that is creating ASTs of a custom type. This CommonTree subclass contains a member named elementType that identifies the type represented by the tree.  How do I set the elementType dynamically within an action?

I tried in the following way:

id:
  ^(AST_ID tok+=ID+)
  {
    $tree.setElementType( typeResolver.resolve(StringUtils.join($tok, ".")) );
  }
  ;

This, however, doesn't work since the tree has not yet been set:


                //...     
                ((ElementTypeTree)retval.tree).setElementType( typeResolver.resolve(StringUtils.join(list_tok, ".")) );
            }
            retval.tree = (ElementTypeTree)adaptor.rulePostProcessing(root_0);

In this context, I need semantic information in order to resolve the type, so I can't statically tell ANTLR to create a different tree type (as I do in other contexts).

Thanks for the suggestions.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From jimi at temporal-wave.com  Mon Oct 26 16:18:21 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 26 Oct 2009 16:18:21 -0700
Subject: [antlr-interest] How to access member of CommonTree subclass
In-Reply-To: <200910261555.04326.kaleb.pederson@gmail.com>
Message-ID: <6f32819fc3460c428ef14cadd1ae4305@temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Kaleb Pederson
> Sent: Monday, October 26, 2009 3:55 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] How to access member of CommonTree subclass
> 
> I'm working with a tree parser that is creating ASTs of a custom type.
> This CommonTree subclass contains a member named elementType that
> identifies the type represented by the tree.  How do I set the
> elementType dynamically within an action?
> 
> I tried in the following way:
> 
> id:
>   ^(AST_ID tok+=ID+)
>   {
>     $tree.setElementType( typeResolver.resolve(StringUtils.join($tok,
> ".")) );
>   }
>   ;
> 
> This, however, doesn't work since the tree has not yet been set:

I presume that this is a tree walker that is producing another AST as output?

Anyway, why not return the value of typeResolver from the id rule, then set the resulting tree value?

id : resolveID { $resovleID.tree.setElementType($resolveID.type); } ;

resolveId
returns [ xxx type]
: ^AST_ID tok+=ID+) { $type = typeResolver.resolve(StringUtils.join($tok,".")) );
;

Jim





From kaleb.pederson at gmail.com  Mon Oct 26 16:34:51 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Mon, 26 Oct 2009 16:34:51 -0700
Subject: [antlr-interest] How to access member of CommonTree subclass
In-Reply-To: <6f32819fc3460c428ef14cadd1ae4305@temporal-wave.com>
References: <6f32819fc3460c428ef14cadd1ae4305@temporal-wave.com>
Message-ID: <200910261634.51614.kaleb.pederson@gmail.com>

On Monday 26 October 2009 04:18:21 pm Jim Idle wrote:
...
> > I'm working with a tree parser that is creating ASTs of a custom type.
> > This CommonTree subclass contains a member named elementType that
> > identifies the type represented by the tree.  How do I set the
> > elementType dynamically within an action?
> > 
> > I tried in the following way:
> > 
> > id:
> >   ^(AST_ID tok+=ID+)
> >   {
> >     $tree.setElementType( typeResolver.resolve(StringUtils.join($tok,
> > ".")) );
> >   }
> >   ;
> > 
> > This, however, doesn't work since the tree has not yet been set:
> 
> I presume that this is a tree walker that is producing another AST as output?

Correct.

> Anyway, why not return the value of typeResolver from the id rule, then set the resulting tree value?

That thought crossed my mind, but it seemed like it should be unnecessary. I gather then that it's not possible to set it directly?

>id : resolveID { $resovleID.tree.setElementType($resolveID.type); } ;
>
>resolveId
>returns [ xxx type]
>
>: ^AST_ID tok+=ID+) { $type =
>: typeResolver.resolve(StringUtils.join($tok,".")) );
>}
>;

Thanks for the suggestions.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From raymond.jacob at navy.mil  Mon Oct 26 20:26:21 2009
From: raymond.jacob at navy.mil (Jacob, Raymond CIV SPAWARSYSCEN-ATLANTIC,
	58420)
Date: Mon, 26 Oct 2009 23:26:21 -0400
Subject: [antlr-interest] dumbie question: Are there any examples of
	building antlr programs using different IDEs?
Message-ID: <BCB4B9CAC754C44383B7DB95724ED619DF2258@naeachrlez03v.nadsusea.nads.navy.mil>

I have a dumbie question regarding where can I find examples of how
to build an antlr program using different IDEs?


Background: I am not a java programmer.
I have read part of the antlr book by Terrence Parr.
I think I have gotten as far as the Chapter that use STL to build
programs. I can not
remember the exact chapter because I don't have the book
in front of me.
I did not say I understood everything in the book.
I think I understand a few of the examples.

An intern with more brain cells than I have left was developing
a program using netbeans. So I thought I would give netbeans a
try. That was about 5 months ago and I still have not figured
out how to use netbeans to build a grammar with like the examples
in the book. For instance, I can not figure out how to get the
IDE to use a separate file for a lexer-the file with the tokens instead
putting
all the tokens and the grammar in one file. As far as I can tell
in order to build a grammar in netbeans I need to know ant
and modify the build.xml to add the plug-in for antlr in netbeans.

I realize now that I would have been further along if I had
just used the command line instead of an IDE. But what has
not been done is done. 

Question: Are there any IDEs that make it easy or natural to
build programs using the code in the Antlr reference
book? i.e. I want to focus on the code in the book and not the IDE.

If there are not any IDEs for the IDE challenged, 
are there any examples of building antlr programs using different IDEs?

I apologize in advance for my ignorance.
When I searched the list my Google-fu was weak and I could not find
anything relevant.

Thank you again
rjjr




From tommy.chheng at gmail.com  Mon Oct 26 20:51:05 2009
From: tommy.chheng at gmail.com (Tommy Chheng)
Date: Mon, 26 Oct 2009 20:51:05 -0700
Subject: [antlr-interest] dumbie question: Are there any examples of
 building antlr programs using different IDEs?
In-Reply-To: <BCB4B9CAC754C44383B7DB95724ED619DF2258@naeachrlez03v.nadsusea.nads.navy.mil>
References: <BCB4B9CAC754C44383B7DB95724ED619DF2258@naeachrlez03v.nadsusea.nads.navy.mil>
Message-ID: <4AE66E29.9060805@gmail.com>

Take a look at antlr.org and download antlrworks

Antlrworks can generate the the java files form the grammar files.

tommy

On 10/26/09 8:26 PM, Jacob, Raymond CIV SPAWARSYSCEN-ATLANTIC, 58420 wrote:
> I have a dumbie question regarding where can I find examples of how
> to build an antlr program using different IDEs?
>
>
> Background: I am not a java programmer.
> I have read part of the antlr book by Terrence Parr.
> I think I have gotten as far as the Chapter that use STL to build
> programs. I can not
> remember the exact chapter because I don't have the book
> in front of me.
> I did not say I understood everything in the book.
> I think I understand a few of the examples.
>
> An intern with more brain cells than I have left was developing
> a program using netbeans. So I thought I would give netbeans a
> try. That was about 5 months ago and I still have not figured
> out how to use netbeans to build a grammar with like the examples
> in the book. For instance, I can not figure out how to get the
> IDE to use a separate file for a lexer-the file with the tokens instead
> putting
> all the tokens and the grammar in one file. As far as I can tell
> in order to build a grammar in netbeans I need to know ant
> and modify the build.xml to add the plug-in for antlr in netbeans.
>
> I realize now that I would have been further along if I had
> just used the command line instead of an IDE. But what has
> not been done is done.
>
> Question: Are there any IDEs that make it easy or natural to
> build programs using the code in the Antlr reference
> book? i.e. I want to focus on the code in the book and not the IDE.
>
> If there are not any IDEs for the IDE challenged,
> are there any examples of building antlr programs using different IDEs?
>
> I apologize in advance for my ignorance.
> When I searched the list my Google-fu was weak and I could not find
> anything relevant.
>
> Thank you again
> rjjr
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>    

From jimi at temporal-wave.com  Mon Oct 26 21:32:13 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 26 Oct 2009 21:32:13 -0700
Subject: [antlr-interest] How to access member of CommonTree subclass
In-Reply-To: <200910261634.51614.kaleb.pederson@gmail.com>
Message-ID: <9818ed8cdc39c742952c40f14f178758@temporal-wave.com>

You can probably do:

id : ( ^(AST_ID tok+=ID+) -> ^(AST_ID whatever) { action  } ;

Or get your method to return the node object and use it to rewrite the tree.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Kaleb Pederson
> Sent: Monday, October 26, 2009 4:35 PM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] How to access member of CommonTree
> subclass
> 
> On Monday 26 October 2009 04:18:21 pm Jim Idle wrote:
> ...
> > > I'm working with a tree parser that is creating ASTs of a custom
> type.
> > > This CommonTree subclass contains a member named elementType that
> > > identifies the type represented by the tree.  How do I set the
> > > elementType dynamically within an action?
> > >
> > > I tried in the following way:
> > >
> > > id:
> > >   ^(AST_ID tok+=ID+)
> > >   {
> > >     $tree.setElementType(
> typeResolver.resolve(StringUtils.join($tok,
> > > ".")) );
> > >   }
> > >   ;
> > >
> > > This, however, doesn't work since the tree has not yet been set:
> >
> > I presume that this is a tree walker that is producing another AST as
> output?
> 
> Correct.
> 
> > Anyway, why not return the value of typeResolver from the id rule,
> then set the resulting tree value?
> 
> That thought crossed my mind, but it seemed like it should be
> unnecessary. I gather then that it's not possible to set it directly?
> 
> >id : resolveID { $resovleID.tree.setElementType($resolveID.type); } ;
> >
> >resolveId
> >returns [ xxx type]
> >
> >: ^AST_ID tok+=ID+) { $type =
> >: typeResolver.resolve(StringUtils.join($tok,".")) );
> >}
> >;
> 
> Thanks for the suggestions.
> 
> --
> Kaleb Pederson
> 
> Twitter - http://twitter.com/kalebpederson
> Blog - http://kalebpederson.com
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From harrrrpo at gmail.com  Mon Oct 26 22:42:14 2009
From: harrrrpo at gmail.com (Mohamed Yousef)
Date: Tue, 27 Oct 2009 07:42:14 +0200
Subject: [antlr-interest] [C Target] Bug in AST walking ,
	implementing control flow
Message-ID: <538050a90910262242y7750f9fdj7329a799debbb9ff@mail.gmail.com>

Hi,
on trying to implement control flow , in an AST walker grammar
following this example :
http://www.antlr.org/wiki/display/CS652/Tree-based+interpreters

ifstat
    :   ^('if' c=expr s=. e=.?) // ^('if' expr stat stat?)


in the C target the problem is that in the generated code , variables e,s
are not defined! (yet they are assigned values )
and the compiler complains about that , when i do define them by hand (under
the definition of variable c  )
the code compiles fine
so is this really a bug or i'm misusing ? any applicable workarounds ?
----
i have another question regarding control flow in c target
to get the index of say c in above example i write
c.tree->getToken(c)->index ,, right ? i can then SEEK to thins index , and i
can save
it in a symbol table , and it will be valid across different tree walks
(walk filling symbol table and
the walk that really interprets code )  ,, right ?

Thanks,
Mohamed Yousef
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091027/305648c7/attachment.html 

From gwlist at grahamwideman.com  Tue Oct 27 01:54:40 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Tue, 27 Oct 2009 01:54:40 -0700
Subject: [antlr-interest] dumbie question: Are there any examples
 ofbuilding antlr programs using different IDEs?
In-Reply-To: <BCB4B9CAC754C44383B7DB95724ED619DF2258@naeachrlez03v.nadsu
	sea.nads.navy.mil>
Message-ID: <4.1.20091027015314.01b99c78@grahamwideman.com>

Raymond,

The matter of using Antlr to generate java files for parser or lexer can be separated from the matter of using your IDE.  You can run antlr from the command line, using whatever kind of grammar file (lexer, combined, parser, tree) and tell it to send the output (java) files to the directory of your choice. That can be a directory that's within a project as set up by your IDE, and thus can be referenced (called) by other files in your project. (You may need to prod the IDE to refresh its knowledge of the files when you change them like this.)

With that arrangement, you don't have to learn how to get the IDE's build system to run external programs, though usually that's not too involved and not particularly special for antlr. Of course, not having the IDE automatically run antlr means you have to do that step manually when you change the grammar, but at least it gets you started. Also you then know what's supposed to happen, so that when you do automate it you'll know that it is or isn't working properly.

>From another angle, your choice of IDE should be driven by other considerations within your project or larger development process, not by whether there's an incremental learning effort for automating antlr: even if that effort is too much at present, you can put that off by running antlr manually.

-- Graham


At 10/26/2009 11:26 PM, Jacob, Raymond CIV SPAWARSYSCEN-ATLANTIC, wrote:
>I have a dumbie question regarding where can I find examples of how
>to build an antlr program using different IDEs?
>
>
>Background: I am not a java programmer.
>I have read part of the antlr book by Terrence Parr.
>I think I have gotten as far as the Chapter that use STL to build
>programs. I can not
>remember the exact chapter because I don't have the book
>in front of me.
>I did not say I understood everything in the book.
>I think I understand a few of the examples.
>
>An intern with more brain cells than I have left was developing
>a program using netbeans. So I thought I would give netbeans a
>try. That was about 5 months ago and I still have not figured
>out how to use netbeans to build a grammar with like the examples
>in the book. For instance, I can not figure out how to get the
>IDE to use a separate file for a lexer-the file with the tokens instead
>putting
>all the tokens and the grammar in one file. As far as I can tell
>in order to build a grammar in netbeans I need to know ant
>and modify the build.xml to add the plug-in for antlr in netbeans.
>
>I realize now that I would have been further along if I had
>just used the command line instead of an IDE. But what has
>not been done is done. 
>
>Question: Are there any IDEs that make it easy or natural to
>build programs using the code in the Antlr reference
>book? i.e. I want to focus on the code in the book and not the IDE.
>
>If there are not any IDEs for the IDE challenged, 
>are there any examples of building antlr programs using different IDEs?
>
>I apologize in advance for my ignorance.
>When I searched the list my Google-fu was weak and I could not find
>anything relevant.
>
>Thank you again
>rjjr
>
>
>
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From naveen.chwl at googlemail.com  Tue Oct 27 05:59:31 2009
From: naveen.chwl at googlemail.com (Naveen Chawla)
Date: Tue, 27 Oct 2009 12:59:31 +0000
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <56eb2660910261150y5f59305bwdf7f1475e1234012@mail.gmail.com>
References: <56eb2660910230610i253ecf5ej6c799131732ca8b6@mail.gmail.com>
	<D54F39F4-23A7-4905-8BB6-8204F13F7C64@cs.usfca.edu>
	<56eb2660910232040l69b84ba3yd591c02a47a47c98@mail.gmail.com>
	<-6965020265928568256@unknownmsgid>
	<56eb2660910261133m1e26807cm4a233a0348282b95@mail.gmail.com>
	<56eb2660910261137kb16b88eic4c9541f10282bd6@mail.gmail.com>
	<56eb2660910261150y5f59305bwdf7f1475e1234012@mail.gmail.com>
Message-ID: <56eb2660910270559p2f75ff37lc3f5ea29413ba602@mail.gmail.com>

 Dear Jim, I like your sense of humour! You'll probably be annoyed that I
already took the time read the book before I checked my email for your
message because I didn't think anyone would reply. I wasn't asking anybody
to read the manual, just if someone knew it off-hand. It would have saved me
time 3 days ago but I guess my reading the book is now knowledge for the
"bank". Still I think and hope somebody new to language translation will be
helped by your simple example. Truly grateful, N
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091027/7c003d96/attachment.html 

From jimi at temporal-wave.com  Tue Oct 27 06:08:54 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 27 Oct 2009 06:08:54 -0700
Subject: [antlr-interest] [C Target] Bug in AST walking ,
	implementing control flow
In-Reply-To: <538050a90910262242y7750f9fdj7329a799debbb9ff@mail.gmail.com>
Message-ID: <456077d48fe01747bdf11578163ce031@temporal-wave.com>

It probably is a bug I am afraid. 3.2.1 will be a 'catch up' release to ensure that everything works in C. You can make calls to LT() directly and so on though.

 

For index and related properties you should use the method calls rather than the fields directly, but if you know you will never override the structure types then you only have to worry if I change the names of the fields. This is not likely, but I don't guarantee not to do it. 

 

Nodes are valid between tree walks and rewrites so long as you do not free the node streams until you are completely done. You can dup a node outside the factory and then it will persist, but you need to free the memory.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mohamed Yousef
Sent: Monday, October 26, 2009 10:42 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] [C Target] Bug in AST walking , implementing control flow

 

Hi,
on trying to implement control flow , in an AST walker grammar 
following this example : http://www.antlr.org/wiki/display/CS652/Tree-based+interpreters

ifstat


    :   ^('if' c=expr s=. e=.?) // ^('if' expr stat stat?)


in the C target the problem is that in the generated code , variables e,s are not defined! (yet they are assigned values )
and the compiler complains about that , when i do define them by hand (under the definition of variable c  )
the code compiles fine
so is this really a bug or i'm misusing ? any applicable workarounds ?
----
i have another question regarding control flow in c target
to get the index of say c in above example i write
c.tree->getToken(c)->index ,, right ? i can then SEEK to thins index , and i can save 
it in a symbol table , and it will be valid across different tree walks (walk filling symbol table and
the walk that really interprets code )  ,, right ?

Thanks,
Mohamed Yousef



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091027/f6a1e575/attachment.html 

From jimi at temporal-wave.com  Tue Oct 27 06:35:24 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 27 Oct 2009 06:35:24 -0700
Subject: [antlr-interest] dumbie question: Are there any examples
	ofbuilding antlr programs using different IDEs?
In-Reply-To: <4.1.20091027015314.01b99c78@grahamwideman.com>
Message-ID: <107db8507701ab4991f8f81b3a750515@temporal-wave.com>

The easiest way with Netbeans is to use a Maven build, which Netbeans has very good built in support for. That way you just configure where the .g files are and leave the rest to Maven, which will work both from the command line and from the IDE (not just Netbeans IDE either).

It takes a bit of learning, but to be honest, for a simple project, you can just copy an existing config. I (or someone) should really make a Maven project archetype (any volunteers?). But if you create a Maven project in Netbeans (in 6.7 this is File->New Project->Maven, then open the build.xml file, you can copy from this below (you will find lots of this is generic and the same as the build.xml that netbeans/maven creates for you. You just want the dependencies and the plugins.

Then read: www.antlr.org/antlr3-maven-plugin

There are lots of "5 minute intros to Maven" on the web.

The reason it is worth learning Maven is that aside from learning how to auto build .g files in to your Java stuff, it is a generic build tool and lots of projects use it, so it is not ANTLR or IDE specific.

Jim


<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.temporalwave</groupId>
    <artifactId>tsql2005</artifactId>
    <packaging>jar</packaging>
    <version>1.0</version>
    <name>Temporal Wave T-SQL 2005 Grammar</name>
    <url>http://www.temporal-wave.com/tsql</url>

    <dependencies>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.5</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.antlr</groupId>
            <artifactId>antlr-runtime</artifactId>
            <version>3.2</version>
            <scope>compile</scope>
        </dependency>
    </dependencies>

    <build>

        <defaultGoal>install</defaultGoal>

        <plugins>

            <plugin>
                <groupId>org.antlr</groupId>
                <artifactId>antlr3-maven-plugin</artifactId>
                <version>3.2</version>
                <configuration>
                    <conversionTimeout>10000</conversionTimeout>
                </configuration>
                <executions>
                    <execution>
                        <goals>
                            <goal>antlr</goal>
                        </goals>
                    </execution>
                </executions>

            </plugin>

            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.0.2</version>
                <configuration>
                    <source>1.5</source>
                    <target>1.5</target>
                </configuration>
            </plugin>
            
            <plugin>

                <!--

                    Build an uber-jar that is packaged with all the other dependencies,
                    such as the antlr-runtime and stringtemplate etc. This will be useful
                    for developers, who then do not need to download anything else or
                    remember that they need antlr.jar in their CLASSPATH and so
                    on.

                  -->

                <artifactId>maven-assembly-plugin</artifactId>

                <configuration>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                    <!--

                        Specify that we want the resulting jar to be executable
                        via java -jar, which we do by modifying the manifest
                        of course.
                      -->
                    <archive>

                        <manifest>
                            <mainClass>test.Main</mainClass>
                        </manifest>
                    </archive>

                </configuration>

                <!--

                    We don't want to have to specifically ask for the uber jar, so we attach the
                    running of this plugin to the execution of the package life-cycle
                    phase.
                  -->
                <executions>
                    <execution>
                        <id>make-assembly</id>
                        <phase>package</phase>
                        <goals>
                            <goal>attached</goal>
                        </goals>
                    </execution>
                </executions>

            </plugin>



        </plugins>

    </build>
</project>





> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Graham Wideman
> Sent: Tuesday, October 27, 2009 1:55 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] dumbie question: Are there any examples
> ofbuilding antlr programs using different IDEs?
> 
> Raymond,
> 
> The matter of using Antlr to generate java files for parser or lexer
> can be separated from the matter of using your IDE.  You can run antlr
> from the command line, using whatever kind of grammar file (lexer,
> combined, parser, tree) and tell it to send the output (java) files to
> the directory of your choice. That can be a directory that's within a
> project as set up by your IDE, and thus can be referenced (called) by
> other files in your project. (You may need to prod the IDE to refresh
> its knowledge of the files when you change them like this.)
> 
> With that arrangement, you don't have to learn how to get the IDE's
> build system to run external programs, though usually that's not too
> involved and not particularly special for antlr. Of course, not having
> the IDE automatically run antlr means you have to do that step manually
> when you change the grammar, but at least it gets you started. Also you
> then know what's supposed to happen, so that when you do automate it
> you'll know that it is or isn't working properly.
> 
> >From another angle, your choice of IDE should be driven by other
> considerations within your project or larger development process, not
> by whether there's an incremental learning effort for automating antlr:
> even if that effort is too much at present, you can put that off by
> running antlr manually.
> 
> -- Graham
> 
> 
> At 10/26/2009 11:26 PM, Jacob, Raymond CIV SPAWARSYSCEN-ATLANTIC,
> wrote:
> >I have a dumbie question regarding where can I find examples of how
> >to build an antlr program using different IDEs?
> >
> >
> >Background: I am not a java programmer.
> >I have read part of the antlr book by Terrence Parr.
> >I think I have gotten as far as the Chapter that use STL to build
> >programs. I can not
> >remember the exact chapter because I don't have the book
> >in front of me.
> >I did not say I understood everything in the book.
> >I think I understand a few of the examples.
> >
> >An intern with more brain cells than I have left was developing
> >a program using netbeans. So I thought I would give netbeans a
> >try. That was about 5 months ago and I still have not figured
> >out how to use netbeans to build a grammar with like the examples
> >in the book. For instance, I can not figure out how to get the
> >IDE to use a separate file for a lexer-the file with the tokens
> instead
> >putting
> >all the tokens and the grammar in one file. As far as I can tell
> >in order to build a grammar in netbeans I need to know ant
> >and modify the build.xml to add the plug-in for antlr in netbeans.
> >
> >I realize now that I would have been further along if I had
> >just used the command line instead of an IDE. But what has
> >not been done is done.
> >
> >Question: Are there any IDEs that make it easy or natural to
> >build programs using the code in the Antlr reference
> >book? i.e. I want to focus on the code in the book and not the IDE.
> >
> >If there are not any IDEs for the IDE challenged,
> >are there any examples of building antlr programs using different
> IDEs?
> >
> >I apologize in advance for my ignorance.
> >When I searched the list my Google-fu was weak and I could not find
> >anything relevant.
> >
> >Thank you again
> >rjjr
> >
> >
> >
> >
> >List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >Unsubscribe:
> >http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Tue Oct 27 08:06:30 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 27 Oct 2009 08:06:30 -0700
Subject: [antlr-interest] Can somebody give me the very simplest example
	of grammar to AST to StringTemplate output
In-Reply-To: <56eb2660910270559p2f75ff37lc3f5ea29413ba602@mail.gmail.com>
Message-ID: <ff5429180e992a44b645f8cc50271cb4@temporal-wave.com>

No problem - I find it difficult to get too worked up about it. Now, that example would be great if people would take the time to search past posts before they posed a question here ;-)

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Naveen Chawla
Sent: Tuesday, October 27, 2009 6:00 AM
To: ANTLR Interest Mailing List
Subject: Re: [antlr-interest] Can somebody give me the very simplest example of grammar to AST to StringTemplate output

 

Dear Jim, I like your sense of humour! You'll probably be annoyed that I already took the time read the book before I checked my email for your message because I didn't think anyone would reply. I wasn't asking anybody to read the manual, just if someone knew it off-hand. It would have saved me time 3 days ago but I guess my reading the book is now knowledge for the "bank". Still I think and hope somebody new to language translation will be helped by your simple example. Truly grateful, N



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091027/60cecdb5/attachment.html 

From harrrrpo at gmail.com  Tue Oct 27 08:12:52 2009
From: harrrrpo at gmail.com (Mohamed Yousef)
Date: Tue, 27 Oct 2009 17:12:52 +0200
Subject: [antlr-interest] [C Target] Bug in AST walking ,
	implementing 	control flow
In-Reply-To: <456077d48fe01747bdf11578163ce031@temporal-wave.com>
References: <538050a90910262242y7750f9fdj7329a799debbb9ff@mail.gmail.com>
	<456077d48fe01747bdf11578163ce031@temporal-wave.com>
Message-ID: <538050a90910270812k36ae465cta22ceeface237ae6@mail.gmail.com>

This was firstly sent to jim only by accident ,, sorry

>  It probably is a bug I am afraid. 3.2.1 will be a ?catch up? release to
> ensure that everything works in C. You can make calls to LT() directly and
> so on though.
>
so i could for now - till 3.2.1 - use something like

ifstat
    :   ^('if' c=expr s=. e=.)
{

pANTLR3_BASE_TREE  s=(pANTLR3_BASE_TREE)LT(1);
pANTLR3_BASE_TREE  e=(pANTLR3_BASE_TREE)LT(1);
//do whatever with return values or custom nodes in e&s
}
will this work even if s had children (e will be next 'stat' not just a
certain child of s ) ?

>  For index and related properties you should use the method calls rather
> than the fields directly, but if you know you will never override the
> structure types then you only have to worry if I change the names of the
> fields. This is not likely, but I don?t guarantee not to do it.
>
what method do you mean ? , i couldn't find any methods in pANTLR3_BASE_TREE
that returns the index of the tree root

> Nodes are valid between tree walks and rewrites so long as you do not free
> the node streams until you are completely done. You can dup a node outside
> the factory and then it will persist, but you need to free the memory.
>

the syntax i use for carrying out 3 consecutive walks is something like

// filtered initial walk , on certain portions of tree
treePsr1    = yatgWalkerNew(nodes);
treePsr1->program(treePsr1);

// walk 2 based on indices from 1
treePsr2    = yatgWalkerNew(nodes);
treePsr2->program(treePsr2);

// walk 3 by the same walker of 2 , utilizing indices from it walk 2 & 1
treePsr2    = yatgWalkerNew(nodes);
treePsr2->program(treePsr2);

so ,  indices across these walks should be valid ?


Thanks,
Mohamed Yousef
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091027/a90d3fe7/attachment.html 

From jimi at temporal-wave.com  Tue Oct 27 08:18:40 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 27 Oct 2009 08:18:40 -0700
Subject: [antlr-interest] [C Target] Bug in AST walking ,
	implementing  control flow
In-Reply-To: <538050a90910270718k377ed256xb61b8fa23006a4d3@mail.gmail.com>
Message-ID: <fb9426b8821f8c4a9b618050e17f828b@temporal-wave.com>

 

 

From: Mohamed Yousef [mailto:harrrrpo at gmail.com] 
Sent: Tuesday, October 27, 2009 7:19 AM
To: Jim Idle
Subject: Re: [antlr-interest] [C Target] Bug in AST walking , implementing control flow

 

 

2009/10/27 Jim Idle <jimi at temporal-wave.com>

It probably is a bug I am afraid. 3.2.1 will be a 'catch up' release to ensure that everything works in C. You can make calls to LT() directly and so on though.

so i could for now - till 3.2.1 - use something like

ifstat


    :   ^('if' c=expr s=. e=.)


{

pANTLR3_BASE_TREE  s=(pANTLR3_BASE_TREE)LT(1);
pANTLR3_BASE_TREE  e=(pANTLR3_BASE_TREE)LT(1);

 

You would not have the s=. and e=., just code to consume what you need.


//do whatever with return values or custom nodes in e&s
}
will this work even if s had children (e will be next 'stat' not just a certain child of s ) ?

For index and related properties you should use the method calls rather than the fields directly, but if you know you will never override the structure types then you only have to worry if I change the names of the fields. This is not likely, but I don't guarantee not to do it.

what method do you mean ? , i couldn't find any methods in pANTLR3_BASE_TREE that returns the index of the tree root

 

You probably need:

pANTLR3_COMMON_TREE s = =(pANTLR3_COMMON_TREE)(((pANTLR3_BASE_TREE)LT(1))->super);

 

 

Nodes are valid between tree walks and rewrites so long as you do not free the node streams until you are completely done. You can dup a node outside the factory and then it will persist, but you need to free the memory.


the syntax i use for carrying out 3 consecutive walks is something like  

// filtered initial walk , on certain portions of tree
treePsr1    = yatgWalkerNew(nodes);
treePsr1->program(treePsr1);

// walk 2 based on indices from 1
treePsr2    = yatgWalkerNew(nodes);
treePsr2->program(treePsr2);

// walk 3 by the same walker of 2 , utilizing indices from it walk 2 & 1
treePsr2    = yatgWalkerNew(nodes);
treePsr2->program(treePsr2);

so ,  indices across these walks should be valid ?

 

 

Yes, but I suggest that you don't use the nodes etc, create your own 'class'/structure and populate it from the information in the node. You will probably need to reset the node stream etc too.

 

Jim



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091027/593458c3/attachment.html 

From kaleb.pederson at gmail.com  Tue Oct 27 15:46:18 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Tue, 27 Oct 2009 15:46:18 -0700
Subject: [antlr-interest] Exception with gunit and custom tree adaptors
Message-ID: <200910271546.18471.kaleb.pederson@gmail.com>

I'm getting a strange exception when working attempting to use custom AST nodes with gunit.  Per the instructions, I added the following to my gunit file:

options { TreeAdaptor = ElementTypeTreeAdaptor; }

However, I now get an odd exception:

java.lang.ClassNotFoundException: llvm.CC
        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
        at org.antlr.gunit.gUnitExecutor.classForName(gUnitExecutor.java:98)
        at org.antlr.gunit.gUnitExecutor.runParser(gUnitExecutor.java:326)
        at org.antlr.gunit.gUnitExecutor.runCorrectParser(gUnitExecutor.java:159)
        at org.antlr.gunit.gUnitExecutor.executeTests(gUnitExecutor.java:175)
        at org.antlr.gunit.gUnitExecutor.execTest(gUnitExecutor.java:123)
        at org.antlr.mojo.antlr3.GUnitExecuteMojo.performExecution(GUnitExecuteMojo.java:305)
        at org.antlr.mojo.antlr3.GUnitExecuteMojo.execute(GUnitExecuteMojo.java:136)
...

My first thought is that I messed up the class name, but that's not the case because I verified the name and it fails in exactly the same way with a fully qualified class name.  Additionally, I tried ANTLR's CommonTreeAdaptor and I still receive the same error.  I'm using Sun's Java-6.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From fady at legsem.com  Wed Oct 28 05:43:37 2009
From: fady at legsem.com (Fady Moussallam)
Date: Wed, 28 Oct 2009 13:43:37 +0100
Subject: [antlr-interest] Sources for 3.2 under Maven repo
Message-ID: <004a01ca57cc$46144980$d23cdc80$@com>

Hello,

 

Is there a way version 3.2 sources can be made available from a Maven repo?

 

Version 3.1.3 was complete with sources (
<http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.1.3
/>
http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.1.3/
),  but 3.2 is not (
<http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.2/>
http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.2/).

 

Not a big issue but that would work nicely with the Eclipse/Maven plugin.

 

Thanks

 

Fady

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091028/db3076d6/attachment.html 

From digi at google.com  Wed Oct 28 06:23:29 2009
From: digi at google.com (Chris DiGiano)
Date: Wed, 28 Oct 2009 07:23:29 -0600
Subject: [antlr-interest] Exception with gunit and custom tree adaptors
In-Reply-To: <200910271546.18471.kaleb.pederson@gmail.com>
References: <200910271546.18471.kaleb.pederson@gmail.com>
Message-ID: <b9dc5a050910280623h65e8f8e9j2b0cf3f688a479cf@mail.gmail.com>

TreeAdaptor class names currently need to be fully qualified.

Chris

On Tue, Oct 27, 2009 at 4:46 PM, Kaleb Pederson
<kaleb.pederson at gmail.com> wrote:
> I'm getting a strange exception when working attempting to use custom AST nodes with gunit. ?Per the instructions, I added the following to my gunit file:
>
> options { TreeAdaptor = ElementTypeTreeAdaptor; }
>
> However, I now get an odd exception:
>
> java.lang.ClassNotFoundException: llvm.CC
> ? ? ? ?at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
> ? ? ? ?at java.security.AccessController.doPrivileged(Native Method)
> ? ? ? ?at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
> ? ? ? ?at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
> ? ? ? ?at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
> ? ? ? ?at org.antlr.gunit.gUnitExecutor.classForName(gUnitExecutor.java:98)
> ? ? ? ?at org.antlr.gunit.gUnitExecutor.runParser(gUnitExecutor.java:326)
> ? ? ? ?at org.antlr.gunit.gUnitExecutor.runCorrectParser(gUnitExecutor.java:159)
> ? ? ? ?at org.antlr.gunit.gUnitExecutor.executeTests(gUnitExecutor.java:175)
> ? ? ? ?at org.antlr.gunit.gUnitExecutor.execTest(gUnitExecutor.java:123)
> ? ? ? ?at org.antlr.mojo.antlr3.GUnitExecuteMojo.performExecution(GUnitExecuteMojo.java:305)
> ? ? ? ?at org.antlr.mojo.antlr3.GUnitExecuteMojo.execute(GUnitExecuteMojo.java:136)
> ...
>
> My first thought is that I messed up the class name, but that's not the case because I verified the name and it fails in exactly the same way with a fully qualified class name. ?Additionally, I tried ANTLR's CommonTreeAdaptor and I still receive the same error. ?I'm using Sun's Java-6.
>
> --
> Kaleb Pederson
>
> Twitter - http://twitter.com/kalebpederson
> Blog - http://kalebpederson.com
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From kaleb.pederson at gmail.com  Wed Oct 28 07:10:00 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Wed, 28 Oct 2009 07:10:00 -0700
Subject: [antlr-interest] Exception with gunit and custom tree adaptors
In-Reply-To: <b9dc5a050910280623h65e8f8e9j2b0cf3f688a479cf@mail.gmail.com>
References: <200910271546.18471.kaleb.pederson@gmail.com>
	<b9dc5a050910280623h65e8f8e9j2b0cf3f688a479cf@mail.gmail.com>
Message-ID: <200910280710.00316.kaleb.pederson@gmail.com>

On Wednesday 28 October 2009 06:23:29 am Chris DiGiano wrote:
> TreeAdaptor class names currently need to be fully qualified.

Thanks for the information.  As I mentioned yesterday, I have tried with the fully qualified class name and I receive the same error.  For instance, this morning I tried with the following:

options{TreeAdaptor = org.antlr.runtime.tree.CommonTreeAdaptor;}

I still receive the exact same exception.  I'm curious if it's a JIT problem and will investigate more soon, although I'm hoping somebody will be able to save me some of that time.

Thanks.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

 
> Chris
> 
> On Tue, Oct 27, 2009 at 4:46 PM, Kaleb Pederson
> <kaleb.pederson at gmail.com> wrote:
> > I'm getting a strange exception when working attempting to use custom AST nodes with gunit.  Per the instructions, I added the following to my gunit file:
> >
> > options { TreeAdaptor = ElementTypeTreeAdaptor; }
> >
> > However, I now get an odd exception:
> >
> > java.lang.ClassNotFoundException: llvm.CC
> >        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
> >        at java.security.AccessController.doPrivileged(Native Method)
> >        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
> >        at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
> >        at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
> >        at org.antlr.gunit.gUnitExecutor.classForName(gUnitExecutor.java:98)
> >        at org.antlr.gunit.gUnitExecutor.runParser(gUnitExecutor.java:326)
> >        at org.antlr.gunit.gUnitExecutor.runCorrectParser(gUnitExecutor.java:159)
> >        at org.antlr.gunit.gUnitExecutor.executeTests(gUnitExecutor.java:175)
> >        at org.antlr.gunit.gUnitExecutor.execTest(gUnitExecutor.java:123)
> >        at org.antlr.mojo.antlr3.GUnitExecuteMojo.performExecution(GUnitExecuteMojo.java:305)
> >        at org.antlr.mojo.antlr3.GUnitExecuteMojo.execute(GUnitExecuteMojo.java:136)
> > ...
> >
> > My first thought is that I messed up the class name, but that's not the case because I verified the name and it fails in exactly the same way with a fully qualified class name.  Additionally, I tried ANTLR's CommonTreeAdaptor and I still receive the same error.  I'm using Sun's Java-6.
> >
> > --
> > Kaleb Pederson


From jimi at temporal-wave.com  Wed Oct 28 07:50:50 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 28 Oct 2009 07:50:50 -0700
Subject: [antlr-interest] Sources for 3.2 under Maven repo
In-Reply-To: <004a01ca57cc$46144980$d23cdc80$@com>
Message-ID: <3e5532967b7cca479395c91b871222c7@temporal-wave.com>

Should have been there so I will check why they are not - I probably missed a step in the release...

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Fady Moussallam
Sent: Wednesday, October 28, 2009 5:44 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Sources for 3.2 under Maven repo

 

Hello,

 

Is there a way version 3.2 sources can be made available from a Maven repo?

 

Version 3.1.3 was complete with sources (  <http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.1.3/> http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.1.3/),  but 3.2 is not ( <http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.2/> http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.2/).

 

Not a big issue but that would work nicely with the Eclipse/Maven plugin.

 

Thanks

 

Fady

 

 

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091028/7c3cc39f/attachment.html 

From digi at google.com  Wed Oct 28 08:07:54 2009
From: digi at google.com (Chris DiGiano)
Date: Wed, 28 Oct 2009 09:07:54 -0600
Subject: [antlr-interest] Exception with gunit and custom tree adaptors
In-Reply-To: <200910280710.00316.kaleb.pederson@gmail.com>
References: <200910271546.18471.kaleb.pederson@gmail.com>
	<b9dc5a050910280623h65e8f8e9j2b0cf3f688a479cf@mail.gmail.com> 
	<200910280710.00316.kaleb.pederson@gmail.com>
Message-ID: <b9dc5a050910280807y7e0a0020u7564a0c4698c83b1@mail.gmail.com>

Sorry for not reading your initial post more carefully. A fully
qualified classname is working for me under ANTLR 3.2, but I did have
to upgrade to the latest gunit.jar, which I received directly from
Leon Su, the developer. I think he updated the 1.0.6b.jar here
http://www.antlr.org/wiki/pages/viewpageattachments.action?pageId=3244061&metadataLink=true
but if this doesn't work for you, you might want to contact Leon directly.

I'm assuming that you double-checked that your class is actually on
the classpath!

Chris

On Wed, Oct 28, 2009 at 8:10 AM, Kaleb Pederson
<kaleb.pederson at gmail.com> wrote:
> On Wednesday 28 October 2009 06:23:29 am Chris DiGiano wrote:
>> TreeAdaptor class names currently need to be fully qualified.
>
> Thanks for the information. ?As I mentioned yesterday, I have tried with the fully qualified class name and I receive the same error. ?For instance, this morning I tried with the following:
>
> options{TreeAdaptor = org.antlr.runtime.tree.CommonTreeAdaptor;}
>
> I still receive the exact same exception. ?I'm curious if it's a JIT problem and will investigate more soon, although I'm hoping somebody will be able to save me some of that time.
>
> Thanks.
>
> --
> Kaleb Pederson
>
> Twitter - http://twitter.com/kalebpederson
> Blog - http://kalebpederson.com
>
>
>> Chris
>>
>> On Tue, Oct 27, 2009 at 4:46 PM, Kaleb Pederson
>> <kaleb.pederson at gmail.com> wrote:
>> > I'm getting a strange exception when working attempting to use custom AST nodes with gunit. ?Per the instructions, I added the following to my gunit file:
>> >
>> > options { TreeAdaptor = ElementTypeTreeAdaptor; }
>> >
>> > However, I now get an odd exception:
>> >
>> > java.lang.ClassNotFoundException: llvm.CC
>> > ? ? ? ?at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
>> > ? ? ? ?at java.security.AccessController.doPrivileged(Native Method)
>> > ? ? ? ?at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
>> > ? ? ? ?at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
>> > ? ? ? ?at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
>> > ? ? ? ?at org.antlr.gunit.gUnitExecutor.classForName(gUnitExecutor.java:98)
>> > ? ? ? ?at org.antlr.gunit.gUnitExecutor.runParser(gUnitExecutor.java:326)
>> > ? ? ? ?at org.antlr.gunit.gUnitExecutor.runCorrectParser(gUnitExecutor.java:159)
>> > ? ? ? ?at org.antlr.gunit.gUnitExecutor.executeTests(gUnitExecutor.java:175)
>> > ? ? ? ?at org.antlr.gunit.gUnitExecutor.execTest(gUnitExecutor.java:123)
>> > ? ? ? ?at org.antlr.mojo.antlr3.GUnitExecuteMojo.performExecution(GUnitExecuteMojo.java:305)
>> > ? ? ? ?at org.antlr.mojo.antlr3.GUnitExecuteMojo.execute(GUnitExecuteMojo.java:136)
>> > ...
>> >
>> > My first thought is that I messed up the class name, but that's not the case because I verified the name and it fails in exactly the same way with a fully qualified class name. ?Additionally, I tried ANTLR's CommonTreeAdaptor and I still receive the same error. ?I'm using Sun's Java-6.
>> >
>> > --
>> > Kaleb Pederson
>
>

From bjavor at gmail.com  Wed Oct 28 08:56:34 2009
From: bjavor at gmail.com (Balazs Javor)
Date: Wed, 28 Oct 2009 16:56:34 +0100
Subject: [antlr-interest] Improving mismatched token recovery on first token
	of sub-rule
Message-ID: <71344f110910280856l1afb0cefj76a98f567c0f7188@mail.gmail.com>

This is my first adventure with ANTLR and I'm currently trying to wrap
my head around how to improve error recovery for various cases so that
the affected "unparsed error area" is as small as possible. (I'm
trying to develop a parser for an IDE where the text goes though all
sorts of stages of invalidness...)

I've run into the following problem:

Here's a simplified example document:

<document>
 <list>
   <item>value</item>
   tem>value</item>
   <item>value</item>
 </list>
<document>

As you can see there is an error on the the second "item" line.

Relevant rules from the grammar file may look like this (slightly
simplified):

DOCUMENT_START : '<document>';
DOCUMENT_END : '</document>';
LIST_START : '<list>';
LIST_END : '</list>';
ITEM_START : '<item>';
ITEM_END : '</item>';
VALUE: [a-z]*;

document: DOCUMENT_START list DOCUMENT_END;
list: LIST_START item+ LIST_END;
item: ITEM_START VALUE ITEM_END;

Now here's my problem:

Due to the error on the second ITEM_START token the lexer will simply omit
it.
The parser will then throw a MismatchedTokenException in list() and
recover after LIST_END.
Note that since we did not enter yet the sub-rule for item() the
recovery will replace the entire LIST part of the resulting AST with
an error node. This is because the exception is thrown in list(),
which causes it to exit the loop that is responsible for looking for
additional ITEMs.

What I would like to happen though, is for it to "skip" just that one
ITEM line and continue parsing the rest of the ITEMs producing an AST
that results in a LIST node with two (instead of three) ITEM nodes...
Unfortunately even if I specify a custom exception handler for the
"list" rule to consume tokens until after the next ITEM_END only, it
will still not be able to resume the original loop from the list()
handler...

Sorry, if I don't express myself clear enough...

Are there any solutions for this type of situation? Or am I missing
something very basic here?

Many thanks for any suggestions in advance!

Balazs
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091028/af772f03/attachment.html 

From jimi at temporal-wave.com  Wed Oct 28 09:15:13 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 28 Oct 2009 09:15:13 -0700
Subject: [antlr-interest] Sources for 3.2 under Maven repo
In-Reply-To: <004a01ca57cc$46144980$d23cdc80$@com>
Message-ID: <fb88c5a1c658424cbdb45808a1e3cd55@temporal-wave.com>

Sources are now deployed - will take up to 4 hours for Maven central to pick these up though.

 

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Fady Moussallam
Sent: Wednesday, October 28, 2009 5:44 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Sources for 3.2 under Maven repo

 

Hello,

 

Is there a way version 3.2 sources can be made available from a Maven repo?

 

Version 3.1.3 was complete with sources (  <http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.1.3/> http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.1.3/),  but 3.2 is not ( <http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.2/> http://mirrors.ibiblio.org/pub/mirrors/maven2/org/antlr/antlr-runtime/3.2/).

 

Not a big issue but that would work nicely with the Eclipse/Maven plugin.

 

Thanks

 

Fady

 

 

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091028/c2d6eacf/attachment.html 

From jimi at temporal-wave.com  Wed Oct 28 15:14:47 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 28 Oct 2009 15:14:47 -0700
Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
Message-ID: <5dfd1162dd1dab439d22669770684c58@temporal-wave.com>

Hi,

 

Prompted by a request earlier this week for a sample of how to use Antlr grammars within IDEs and builds, I thought I would create a Maven Archetype that can create a sample Antlr project seemingly out of thin air. If you are willing to use Maven, or already do so, then this saves you a lot of work trying to configure the project from scratch.

 

There is now a Wiki page on getting started with Maven builds at:

 

http://www.antlr.org/wiki/display/ANTLR3/Building+ANTLR+Projects+with+Maven

 

and this shows you how to create a template Maven project  that you can then open with Netbeans, Eclipse or any other IDE that supports maven projects. The template project is a real lexer, parser (with imports) and tree parser, with a driver program that scans directories for files it can parse. It will also produce a dot specification for the AST it produces and turn that spec into a .png file assuming you have loaded the Graphviz application. Basically it is designed to answer a lot of the FAQ type stuff that happens with the Maven plugin and ANTLR/Java in general.

 

Please note that the Archetype was only deployed to the repository about an hour ago and so it may not be available in Maven central repo just yet. If you try the instructions on the Wiki page and receive "Artifact antlr3-maven-archetype does not exist", then just try again a bit later. It can take up to 4 hours for Maven central to sync up with the Antlr repository.

 

If experienced Maven users would be kind enough to test this and provide feedback, I would be grateful. Source is deployed with the artifact if you want to play with it.

 

Cheers,

 

Jim



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091028/d52a48e5/attachment.html 

From kaleb.pederson at gmail.com  Wed Oct 28 17:08:23 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Wed, 28 Oct 2009 17:08:23 -0700
Subject: [antlr-interest] Exception with gunit and custom tree adaptors
In-Reply-To: <b9dc5a050910280807y7e0a0020u7564a0c4698c83b1@mail.gmail.com>
References: <200910271546.18471.kaleb.pederson@gmail.com>
	<b9dc5a050910280623h65e8f8e9j2b0cf3f688a479cf@mail.gmail.com>
	<200910280710.00316.kaleb.pederson@gmail.com>
	<b9dc5a050910280807y7e0a0020u7564a0c4698c83b1@mail.gmail.com>
Message-ID: <f14c01620910281708p3d4e4b99m26b5551cc5c2371d@mail.gmail.com>

On Wed, Oct 28, 2009 at 8:07 AM, Chris DiGiano <digi at google.com> wrote:
> Sorry for not reading your initial post more carefully. A fully
> qualified classname is working for me under ANTLR 3.2, but I did have
> to upgrade to the latest gunit.jar, which I received directly from
> Leon Su, the developer. I think he updated the 1.0.6b.jar here
> http://www.antlr.org/wiki/pages/viewpageattachments.action?pageId=3244061&metadataLink=true
> but if this doesn't work for you, you might want to contact Leon directly.

Thanks for the suggestion.

I'm also using ANTLR 3.2 but I'm not sure what version of gunit I'm
running.  I have maven configured to use the 'maven-gunit-plugin'
version 3.2, which then grabs
http://repo1.maven.org/maven2/org/antlr/gunit/3.2/gunit-3.2.jar

I looked through the gunit jar, but didn't see anything providing a
version number that I could correlate to what you listed above.  The
md5sum's don't match, so it's not the same, but that's about all I
know for sure.

...

Ok. I had to dig into this deeper, and you're exactly right!  I just
diff'd the gunit source included with ANTLR 3.2 (which is what I would
expect to be contained in the gunit-3.2) and the source for the beta
that you referenced above.

What I found was that prior to the beta, gUnitExecutor explicitly
referenced 'classForName("llvm.CC")' immediately before attempting to
load the actual tree adaptor.  There's a number of other fixes related
to custom tree adaptors, including making the generated JUnit code
contain the necessary imports and passing the tree adaptor to the
CommonTreeNodeStream.

I'm sure upgrading to the latest gunit will fix the problem.  Thanks
for pointing me in the right direction Chris.

--
Kaleb Pederson

Twitter - http://twitter.com/kalebpederson
Blog - http://kalebpederson.com

From sivaits4u at gmail.com  Wed Oct 28 20:35:51 2009
From: sivaits4u at gmail.com (Siva B)
Date: Thu, 29 Oct 2009 09:05:51 +0530
Subject: [antlr-interest] need help command(query) language
Message-ID: <581ce2790910282035y4d5e694aya0d65aca44c5812b@mail.gmail.com>

hi all,
i *need* to write a language interpreter which should always start with a
command
like
USE x_database;
without executing the above i can't write SELECT  command

similar way i *need* to execute the command language.

if i run USE command i can remember(store ) the database name and i
can run other commands(SELECT,INSERT UPDATE) well but if don't run the
USE command and if i try to run other commands  that should give some
warning.
How can i do it.
any *help*...

I want to print simply like 'database is not selected'

plz *help* me...
Thanks,
Kiso
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091029/b7c2199c/attachment.html 

From hugo.pcd at gmail.com  Thu Oct 29 02:58:22 2009
From: hugo.pcd at gmail.com (Hugo Picado)
Date: Thu, 29 Oct 2009 09:58:22 +0000
Subject: [antlr-interest] [SOLVED] ANTLR3 C runtime in HP-UX
In-Reply-To: <746d22b54d17f44281e57deb1e18ccd9@temporal-wave.com>
References: <3c2632090910120238r71904eadpe800019e56d39a41@mail.gmail.com>
	<746d22b54d17f44281e57deb1e18ccd9@temporal-wave.com>
Message-ID: <3c2632090910290258x301b3326j64e56205fdce240e@mail.gmail.com>

Hi,

Sorry for the delay in the response.
The version is B.11.11.

Hugo.

On Fri, Oct 16, 2009 at 9:52 AM, Jim Idle <jimi at temporal-wave.com> wrote:

>  What version of HPUX is this? I have it fixed for the versions I have
> come across I think. HPUX is such a bag of nails; it is always the odd man
> out.
>
>
>
> Jim
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Hugo Picado
> *Sent:* Monday, October 12, 2009 3:09 PM
> *To:* antlr-interest at antlr.org ANTLR
> *Subject:* [antlr-interest] [SOLVED] ANTLR3 C runtime in HP-UX
>
>
>
> Hi,
>
>
>
> When compiling libantlr3c-3.2 in HP-UX it gives the following error:
>
>
>
> Error 172: "src/antlr3debughandlers.c", line 302 # Undeclared variable
> 'TCP_NODELAY'.
>                     setsockopt(delboy->socket, SOL_SOCKET, TCP_NODELAY,
> (const void *)&optVal, sizeof(optVal));
>
>
>
>
>
> To solve this problem it is enough to have the following include in the
> file src/antlr3debughandlers.c:
>
>
>
> #include  <netinet/tcp.h>
>
>
>
>
>
> Terence, please consider this in a next release.
>
>
>
> Best regards,
>
> Hugo.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091029/dafd41f0/attachment.html 

From martijn.reuvers at gmail.com  Thu Oct 29 08:01:43 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Thu, 29 Oct 2009 16:01:43 +0100
Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
In-Reply-To: <5dfd1162dd1dab439d22669770684c58@temporal-wave.com>
References: <5dfd1162dd1dab439d22669770684c58@temporal-wave.com>
Message-ID: <c376e6ec0910290801n6b38d99eh66c9923df8a53930@mail.gmail.com>

Sounds good!! I am gonna give it a try over the weekend and let you
know how it works. :)

On Wed, Oct 28, 2009 at 11:14 PM, Jim Idle <jimi at temporal-wave.com> wrote:
> Hi,
>
>
>
> Prompted by a request earlier this week for a sample of how to use Antlr
> grammars within IDEs and builds, I thought I would create a Maven Archetype
> that can create a sample Antlr project seemingly out of thin air. If you are
> willing to use Maven, or already do so, then this saves you a lot of work
> trying to configure the project from scratch.
>
>
>
> There is now a Wiki page on getting started with Maven builds at:
>
>
>
> http://www.antlr.org/wiki/display/ANTLR3/Building+ANTLR+Projects+with+Maven
>
>
>
> and this shows you how to create a template Maven project ?that you can then
> open with Netbeans, Eclipse or any other IDE that supports maven projects.
> The template project is a real lexer, parser (with imports) and tree parser,
> with a driver program that scans directories for files it can parse. It will
> also produce a dot specification for the AST it produces and turn that spec
> into a .png file assuming you have loaded the Graphviz application.
> Basically it is designed to answer a lot of the FAQ type stuff that happens
> with the Maven plugin and ANTLR/Java in general.
>
>
>
> Please note that the Archetype was only deployed to the repository about an
> hour ago and so it may not be available in Maven central repo just yet. If
> you try the instructions on the Wiki page and receive ?Artifact
> antlr3-maven-archetype does not exist?, then just try again a bit later. It
> can take up to 4 hours for Maven central to sync up with the Antlr
> repository.
>
>
>
> If experienced Maven users would be kind enough to test this and provide
> feedback, I would be grateful. Source is deployed with the artifact if you
> want to play with it.
>
>
>
> Cheers,
>
>
>
> Jim
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From martijn.reuvers at gmail.com  Thu Oct 29 09:08:49 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Thu, 29 Oct 2009 17:08:49 +0100
Subject: [antlr-interest] need help command(query) language
In-Reply-To: <581ce2790910282035y4d5e694aya0d65aca44c5812b@mail.gmail.com>
References: <581ce2790910282035y4d5e694aya0d65aca44c5812b@mail.gmail.com>
Message-ID: <c376e6ec0910290908x2e420714n99f4a3ca9d5a82b4@mail.gmail.com>

Hi Kiso,

I would advise you to read the documentation on the site or buy one of
the available books:

http://pragprog.com/titles/tpantlr/the-definitive-antlr-reference
(specific for antlr)
http://pragprog.com/titles/tpdsl/language-implementation-patterns (for
language design & antlr)

A quick & dirty simple example:

grammar dbsample;

@members {
	String dbName;
}

start
	:	USE NAME other
		{
			dbName = $NAME.text;
		}
	;

other
	:	'...'  // Obviously needs to be something useful as statements etc.
		{
			System.out.println("You are using database=" + dbName);
		}
	;

USE
	:	'use'
	;
	
NAME
	:	('a'..'z' | 'A'..'Z')+
	;

WS:	('\t' | ' ' | '\r' | '\n'| '\u000C')+ { skip(); };


You clearly need to fill in the 'other' rule with something useful. By
using a grammar you already force the usage of 'Use databasename'
first. As input you could use: use mydb ...

Martijn


On Thu, Oct 29, 2009 at 4:35 AM, Siva B <sivaits4u at gmail.com> wrote:
> hi all,
> i need to write a language interpreter which should always start with a
> command
> like
> USE x_database;
> without executing the above i can't write SELECT ?command
>
> similar way i need to execute the command language.
>
> if i run USE command i can remember(store ) the database name and i
> can run other commands(SELECT,INSERT UPDATE) well but if don't run the
> USE command and if i try to run other commands ?that should give some
> warning.
> How can i do it.
> any help...
>
> I want to print simply like 'database is not selected'
>
> plz help me...
>
> Thanks,
> Kiso
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From jklumpp at harmonia.com  Thu Oct 29 12:44:21 2009
From: jklumpp at harmonia.com (Jared Klumpp)
Date: Thu, 29 Oct 2009 12:44:21 -0700
Subject: [antlr-interest] How to create many AST trees from one rule
References: <mailman.1.1256842801.26479.antlr-interest@antlr.org>
Message-ID: <B00C7A477A17884DBB97DEC08EE0DF9E0162CB2D@EXVBE010-2.exch010.intermedia.net>

I'm trying to create a new DECL for each identifier - if this were C, int a, b; would become (DECL A (TYPE INT)) (DECL B (TYPE INT)).

My rules (untested):
decl: type IDENTS SEMI
-> ^(DECL idents ^(TYPE $type));

idents: IDENT (COMMA IDENT)*
-> IDENT+;

My problem is this creates (DECL A B (TYPE INT)), how can I split this into multiple trees when idents collects the identifiers into one tree?

Thanks,
Jared
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091029/d51d7126/attachment.html 

From parrt at cs.usfca.edu  Thu Oct 29 18:29:11 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 29 Oct 2009 18:29:11 -0700
Subject: [antlr-interest] off to korea/tokyo for a week
Message-ID: <6DF6A21D-DEF5-4540-BBE6-02E467ED6F01@cs.usfca.edu>

Hi, I'm off to recruit grad CS students for Univ. of San Francisco  
from tomorrow until Nov 6th.  I'll be even slower than usual with my  
email responses ;)
Ter

From fady at legsem.com  Fri Oct 30 04:59:21 2009
From: fady at legsem.com (Fady Moussallam)
Date: Fri, 30 Oct 2009 12:59:21 +0100
Subject: [antlr-interest] skip not honored when filter=true
Message-ID: <001801ca5958$6c226cf0$446746d0$@com>

Hello,

I am using ANTLR 3.2.

With a lexer grammar such as this one:

        lexer grammar Z;
        options {
            filter=true;
        }
        IS_KEYWORD                : 'IS' {skip();};

The skip() is ignored and the token gets inserted in the token stream.

If I change to filter=false, skip is honored.

The problem might come from the nextToken() method which seems to be
overriden in the generated lexer code when filter=true.

The nextToken() method in org.antlr.runtime.Lexer has code like this:

        try {
            mTokens();
            if ( state.token==null ) {
                emit();
            }
            else if ( state.token==Token.SKIP_TOKEN ) {
                continue;
            }
            return state.token;
        }

While the generated equivalent code (in Z.java) looks like this:

        try {
            int m = input.mark();
            state.backtracking=1; 
            state.failed=false;
            mTokens();
            state.backtracking=0;
            
            if ( state.failed ) {
                input.rewind(m);
                input.consume(); 
            }
            else {
                emit();
                return state.token;
            }
        }
So whatever the state.token value, the token is emitted.

Or I messed up and there some other explanation?

Thanks for your help.

Fady


From jimi at temporal-wave.com  Fri Oct 30 06:54:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 30 Oct 2009 06:54:59 -0700
Subject: [antlr-interest] How to create many AST trees from one rule
In-Reply-To: <B00C7A477A17884DBB97DEC08EE0DF9E0162CB2D@EXVBE010-2.exch010.intermedia.net>
Message-ID: <5edc49209210094f87bbec1633bd3817@temporal-wave.com>

Fold it up into the top rule like this:

 

decl : t=type

        i+=ID

        (

          COMMA i+=ID

          

                

        )*  SEMI

        

          ->  ^(DECL $i $t)+

     ;

 

However, do you have some particular reason to make the tree look like that? It is just as easy to deal with: ^(DECL type ^(VARS A B C)) in a walker.

 

Jim

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jared Klumpp
Sent: Thursday, October 29, 2009 12:44 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to create many AST trees from one rule

 

I'm trying to create a new DECL for each identifier - if this were C, int a, b; would become (DECL A (TYPE INT)) (DECL B (TYPE INT)).

My rules (untested):
decl: type IDENTS SEMI
-> ^(DECL idents ^(TYPE $type));

idents: IDENT (COMMA IDENT)*
-> IDENT+;

My problem is this creates (DECL A B (TYPE INT)), how can I split this into multiple trees when idents collects the identifiers into one tree?

Thanks,
Jared 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/fe24be1f/attachment.html 

From KLPauba at west.com  Fri Oct 30 07:52:09 2009
From: KLPauba at west.com (Pauba, Kevin L)
Date: Fri, 30 Oct 2009 09:52:09 -0500
Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
In-Reply-To: <mailman.1.1256842801.26479.antlr-interest@antlr.org>
References: <mailman.1.1256842801.26479.antlr-interest@antlr.org>
Message-ID: <226316B3E1F749498E28ACA66321D5BA4AD92754@oma00cexmbx03.corp.westworlds.com>

Jim,

I put off my excitement until this morning to try out your archetype (and Maven, for that matter since this is the first time I'm using it).  I appreciate your sharing your work with the rest of us.

Unfortunately, I still can't get it to work.  The differences I see from the output you provided (on the ANTLR Wiki) and mine are that yours shows:

[INFO] Archetype [org.antlr:antlr3-maven-archetype:3.2] found in catalog local

but my output shows:

[WARNING] Specified archetype not found.
Downloading: http://repo1.maven.org/maven2/org/antlr/antlr3-maven-archetype/1.0/antlr3-maven-archetype-1.0.jar
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] The desired archetype does not exist (org.antlr:antlr3-maven-archetype:1.0)

Since I'm a Maven neophyte, can you offer a suggestion on how to remedy this?

Thanks!

-----Original Message-----


Message: 1
Date: Wed, 28 Oct 2009 15:14:47 -0700
From: "Jim Idle" <jimi at temporal-wave.com>
Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
Message-ID: <5dfd1162dd1dab439d22669770684c58 at temporal-wave.com>

[snip]

From jimi at temporal-wave.com  Fri Oct 30 07:58:27 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 30 Oct 2009 07:58:27 -0700
Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
In-Reply-To: <226316B3E1F749498E28ACA66321D5BA4AD92754@oma00cexmbx03.corp.westworlds.com>
Message-ID: <a5cac757bc768b459c68e5c8f9663f1c@temporal-wave.com>

Try adding:

-DarchetypeVersion=3.2

I saw somewhere that there was some bug that made this necessary. However, it may be that Maven Central has not synced the archetype I suppose. To be honest the documentation and code for this archetype plugin are pretty weak :(

Jim 

> -----Original Message-----
> From: Pauba, Kevin L [mailto:KLPauba at west.com]
> Sent: Friday, October 30, 2009 7:52 AM
> To: antlr-interest at antlr.org
> Cc: jimi at temporal-wave.com
> Subject: RE: [antlr-interest] Getting started with ANTLR 3, IDEs and
> Maven
> 
> Jim,
> 
> I put off my excitement until this morning to try out your archetype
> (and Maven, for that matter since this is the first time I'm using it).
> I appreciate your sharing your work with the rest of us.
> 
> Unfortunately, I still can't get it to work.  The differences I see
> from the output you provided (on the ANTLR Wiki) and mine are that
> yours shows:
> 
> [INFO] Archetype [org.antlr:antlr3-maven-archetype:3.2] found in
> catalog local
> 
> but my output shows:
> 
> [WARNING] Specified archetype not found.
> Downloading: http://repo1.maven.org/maven2/org/antlr/antlr3-maven-
> archetype/1.0/antlr3-maven-archetype-1.0.jar
> [INFO] ----------------------------------------------------------------
> --------
> [ERROR] BUILD FAILURE
> [INFO] ----------------------------------------------------------------
> --------
> [INFO] The desired archetype does not exist (org.antlr:antlr3-maven-
> archetype:1.0)
> 
> Since I'm a Maven neophyte, can you offer a suggestion on how to remedy
> this?
> 
> Thanks!
> 
> -----Original Message-----
> 
> 
> Message: 1
> Date: Wed, 28 Oct 2009 15:14:47 -0700
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <5dfd1162dd1dab439d22669770684c58 at temporal-wave.com>
> 
> [snip]




From jimi at temporal-wave.com  Fri Oct 30 07:59:29 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 30 Oct 2009 07:59:29 -0700
Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
In-Reply-To: <226316B3E1F749498E28ACA66321D5BA4AD92754@oma00cexmbx03.corp.westworlds.com>
Message-ID: <3aecd21cf5fa3d489600f1edbffebc94@temporal-wave.com>

Seems Maven central has not synced with the ANTLR repo for some time - that's why you are not seeing it work.

Jim

> -----Original Message-----
> From: Pauba, Kevin L [mailto:KLPauba at west.com]
> Sent: Friday, October 30, 2009 7:52 AM
> To: antlr-interest at antlr.org
> Cc: jimi at temporal-wave.com
> Subject: RE: [antlr-interest] Getting started with ANTLR 3, IDEs and
> Maven
> 
> Jim,
> 
> I put off my excitement until this morning to try out your archetype
> (and Maven, for that matter since this is the first time I'm using it).
> I appreciate your sharing your work with the rest of us.
> 
> Unfortunately, I still can't get it to work.  The differences I see
> from the output you provided (on the ANTLR Wiki) and mine are that
> yours shows:
> 
> [INFO] Archetype [org.antlr:antlr3-maven-archetype:3.2] found in
> catalog local
> 
> but my output shows:
> 
> [WARNING] Specified archetype not found.
> Downloading: http://repo1.maven.org/maven2/org/antlr/antlr3-maven-
> archetype/1.0/antlr3-maven-archetype-1.0.jar
> [INFO] ----------------------------------------------------------------
> --------
> [ERROR] BUILD FAILURE
> [INFO] ----------------------------------------------------------------
> --------
> [INFO] The desired archetype does not exist (org.antlr:antlr3-maven-
> archetype:1.0)
> 
> Since I'm a Maven neophyte, can you offer a suggestion on how to remedy
> this?
> 
> Thanks!
> 
> -----Original Message-----
> 
> 
> Message: 1
> Date: Wed, 28 Oct 2009 15:14:47 -0700
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <5dfd1162dd1dab439d22669770684c58 at temporal-wave.com>
> 
> [snip]




From KLPauba at west.com  Fri Oct 30 08:01:26 2009
From: KLPauba at west.com (Pauba, Kevin L)
Date: Fri, 30 Oct 2009 10:01:26 -0500
Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
In-Reply-To: <a5cac757bc768b459c68e5c8f9663f1c@temporal-wave.com>
References: <226316B3E1F749498E28ACA66321D5BA4AD92754@oma00cexmbx03.corp.westworlds.com>
	<a5cac757bc768b459c68e5c8f9663f1c@temporal-wave.com>
Message-ID: <226316B3E1F749498E28ACA66321D5BA4AD92764@oma00cexmbx03.corp.westworlds.com>

Thanks, Jim.  That worked perfectly.

-----Original Message-----
From: Jim Idle [mailto:jimi at temporal-wave.com] 
Sent: Friday, October 30, 2009 9:58 AM
To: Pauba, Kevin L; antlr-interest at antlr.org
Subject: RE: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven

Try adding:

-DarchetypeVersion=3.2

I saw somewhere that there was some bug that made this necessary. However, it may be that Maven Central has not synced the archetype I suppose. To be honest the documentation and code for this archetype plugin are pretty weak :(

Jim 

> -----Original Message-----
> From: Pauba, Kevin L [mailto:KLPauba at west.com]
> Sent: Friday, October 30, 2009 7:52 AM
> To: antlr-interest at antlr.org
> Cc: jimi at temporal-wave.com
> Subject: RE: [antlr-interest] Getting started with ANTLR 3, IDEs and
> Maven
> 
> Jim,
> 
> I put off my excitement until this morning to try out your archetype
> (and Maven, for that matter since this is the first time I'm using it).
> I appreciate your sharing your work with the rest of us.
> 
> Unfortunately, I still can't get it to work.  The differences I see
> from the output you provided (on the ANTLR Wiki) and mine are that
> yours shows:
> 
> [INFO] Archetype [org.antlr:antlr3-maven-archetype:3.2] found in
> catalog local
> 
> but my output shows:
> 
> [WARNING] Specified archetype not found.
> Downloading: http://repo1.maven.org/maven2/org/antlr/antlr3-maven-
> archetype/1.0/antlr3-maven-archetype-1.0.jar
> [INFO] ----------------------------------------------------------------
> --------
> [ERROR] BUILD FAILURE
> [INFO] ----------------------------------------------------------------
> --------
> [INFO] The desired archetype does not exist (org.antlr:antlr3-maven-
> archetype:1.0)
> 
> Since I'm a Maven neophyte, can you offer a suggestion on how to remedy
> this?
> 
> Thanks!
> 
> -----Original Message-----
> 
> 
> Message: 1
> Date: Wed, 28 Oct 2009 15:14:47 -0700
> From: "Jim Idle" <jimi at temporal-wave.com>
> Subject: [antlr-interest] Getting started with ANTLR 3, IDEs and Maven
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Message-ID: <5dfd1162dd1dab439d22669770684c58 at temporal-wave.com>
> 
> [snip]




From fady at legsem.com  Fri Oct 30 09:13:57 2009
From: fady at legsem.com (Fady Moussallam)
Date: Fri, 30 Oct 2009 17:13:57 +0100
Subject: [antlr-interest] Reducing tokens DFA size by splitting lexer
Message-ID: <002b01ca597b$fd5472e0$f7fd58a0$@com>

Hello listers,

 

I found a solution to work around an issue with my lexer where the tokens
DFA was becoming too large.

 

I would appreciate the list advice on this technique before I go too far in
the wrong direction.  

 

After reading several posts on the list, I realized 80% of the DFA volume
was generated by mixing, in the same lexer grammar, rules such as:

 

        EXTERNAL_KEYWORD : 'EXTERNAL';

        GLOBAL_KEYWORD   : 'GLOBAL';

        ...

        DATA_NAME        : LETTER (LETTER|'0'..'9'|'-')*;

        fragment LETTER  : 'A'..'Z'| 'a'..'z';

 

I have about 60 such xxx_KEYWORD. 

 

Of course, the situation is one described in several places where DATA_NAME
is ambiguous (any of the xxx_KEYWORD is a valid DATA_NAME) and ANTLR needs
to build a complex DFA.

 

I am not in the situation where keywords are valid identifiers though. I am
dealing with COBOL where keywords are reserved words that can't be used as
DATA_NAME.

 

My lexer works fine but it has become quite difficult to debug and I am fast
approaching some java limits.

 

So what I did is this:

 

1. Split the lexer into a primary lexer and a secondary

2. Move all keywords to the secondary lexer

3. Add an option like tokenVocab=secondary lexer; to the primary lexer

4. From this point on, the primary lexer only recognizes DATA_NAME. So add
an action in DATA_NAME like so:

 

        DATA_NAME

            : LETTER (LETTER|'0'..'9'|'-')*

            {

                $type = matchKeywords(getText(), $type);

            }

            ;

 

And this is the matchKeywords member method:

 

        /**

         * Asks secondary lexer to check if text is a keyword. If there is a
match,

         * makes sure the entire text was matched (as opposed to a
substring).

         * If the text matches a keyword that needs to be skipped, skip.

         * @param text the text to match with keywords

         * @param originalType the initial token type

         * @return the keyword type if a match is found otherwise the
original type

         * @throws RecognitionException if failed to call secondary lexer

         */

        public int matchKeywords(

                final String text,

                final int originalType) throws RecognitionException {

            try {

                int type = originalType;

                keywordLexer.setCharStream( new ANTLRNoCaseReaderStream(

                    new StringReader(getText())));

                CommonTokenStream kTokens = new
CommonTokenStream(keywordLexer);

                List < ? > kTokenl = kTokens.getTokens();

                if (kTokenl.size() > 0) {

                    CommonToken kToken = (CommonToken) kTokenl.get(0);

                    if (kToken.getText().length() == getText().length()) {

                        if (kToken.getType() == Token.SKIP_TOKEN.getType())
{

                            skip();

                        } else {

                            type = kToken.getType();

                        }

                    }

                }

                return type;

    

            } catch (IOException e) {

                throw new RecognitionException(input);

            }

        }

 

And that seems to work. The primary lexer DFA size + secondary lexer DFA
size is 20% of what it was when I had everything in a single lexer grammar.

 

For the moment the only serious drawback is that I can't get ANTLRWorks to
work with a combination of a parser grammar and 2 lexers.

 

It seems to me that this idea of lexers delegating to others, more
specialized lexers, is similar to AST enrichment where a chain of tree
walkers can refine an AST.

 

Please let me know your thoughts.

 

Thanks

 

Fady

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/eb0aeb6c/attachment.html 

From frank.du at riskmetrics.com  Fri Oct 30 09:23:11 2009
From: frank.du at riskmetrics.com (Frank Du)
Date: Fri, 30 Oct 2009 12:23:11 -0400
Subject: [antlr-interest] Please help with a grammar issue
Message-ID: <ACF14F1689EFEF438B46DADFB73B46E93F73E930@mail-ab01.rmg-ny.com>

Dear All,

I have a grammar issue and need your help. Let?s say I have tree rules: a, b, c

Rule a occurs multiple times, rule b occurs one time or none, and rule c occurs one time.

My question is: How to write the grammar, so the rule ordering is arbitrary?

Thank you so much! Have a nice day!

Best Regards,
Frank

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/953b56f4/attachment.html 

From brockallan at gmail.com  Fri Oct 30 09:34:23 2009
From: brockallan at gmail.com (Allan Brock)
Date: Fri, 30 Oct 2009 12:34:23 -0400
Subject: [antlr-interest] Using an AST Type with a TreeParser
Message-ID: <898370580910300934k79f84c85r3ab10f88494ab27f@mail.gmail.com>

I'm replacing the AST type with MyAST (based on the treewalk example in
antlr2.7.6) in order to get line numbers. I've gotten everything to work,
but have run into a couple problems that I used to a casts to overcome.  I'm
wondering if there is a simpler answer.

In my application, the Parser produces an AST using  type MyAST.  This is
walked by a TreeParser (MyTreeParser)  that also produces an AST using type
MyAST.  Everything seems fine with the parser.

But in MyTreeParser is had to add:

public:
  virtual void program(ANTLR_USE_NAMESPACE(
antlr)RefAST _t)
  {
    program((RefMyAST)_t);
  }

Note the cast from RefAST to RefMyAST.  If I don't do this, I get a
compilation error.
        void antlr::TreeParser::program(antlr::RefAST)' : is abstract

Is what I did to get around this reasonable?  Or is there a better way.

After this, I also hit another problem requiring me to add the following to
MyAST.hpp:

   virtual void initialize( ANTLR_USE_NAMESPACE(antlr)RefAST ast )
   {
      initialize((RefMyAST) ast);
   }

Note the cast.  Anyone have similar problems?

Allan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/35eef934/attachment.html 

From indhu.b at s7software.com  Fri Oct 30 09:36:06 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 30 Oct 2009 22:06:06 +0530
Subject: [antlr-interest] Please help with a grammar issue
In-Reply-To: <ACF14F1689EFEF438B46DADFB73B46E93F73E930@mail-ab01.rmg-ny.com>
References: <ACF14F1689EFEF438B46DADFB73B46E93F73E930@mail-ab01.rmg-ny.com>
Message-ID: <001a01ca597f$14bc8be0$3e35a3a0$@b@s7software.com>

Maybe you can use validating semantic predicate

 

r              

@init {

                int cntA=0, cntB=0, cntC=0;

}

                :               ( a {cntA++;} | b {cntB++;} | c {cntC++;} )+ {cntA>1 && cntB<=1 && cntC==1}?

                ;

 

Cheers, Indhu

S7 Software

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Frank Du
Sent: Friday, October 30, 2009 9:53 PM
To: 'antlr-interest at antlr.org'
Subject: [antlr-interest] Please help with a grammar issue

 

Dear All,

 

I have a grammar issue and need your help. Let?s say I have tree rules: a, b, c

 

Rule a occurs multiple times, rule b occurs one time or none, and rule c occurs one time.

 

My question is: How to write the grammar, so the rule ordering is arbitrary? 

 

Thank you so much! Have a nice day!

 

Best Regards,

Frank

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/c8267bea/attachment.html 

From frank.du at riskmetrics.com  Fri Oct 30 10:08:00 2009
From: frank.du at riskmetrics.com (Frank Du)
Date: Fri, 30 Oct 2009 13:08:00 -0400
Subject: [antlr-interest] Please help with a grammar issue
In-Reply-To: <001a01ca597f$14bc8be0$3e35a3a0$@b@s7software.com>
References: <ACF14F1689EFEF438B46DADFB73B46E93F73E930@mail-ab01.rmg-ny.com>,
	<001a01ca597f$14bc8be0$3e35a3a0$@b@s7software.com>
Message-ID: <ACF14F1689EFEF438B46DADFB73B46E93F3B2227@mail-ab01.rmg-ny.com>

Hi Indhu,

Thank you so much! It works pretty well on correct input file. 

However, if I have 2 rules of b, the parser will stop at the second. It doesn't emit errors as expected. Then it hinders from validation. Any idea about that?

Cheers,
Frank

________________________________________
From: Indhu Bharathi [indhu.b at s7software.com]
Sent: Friday, October 30, 2009 12:36 PM
To: Frank Du; antlr-interest at antlr.org
Subject: RE: [antlr-interest] Please help with a grammar issue

Maybe you can use validating semantic predicate

r
@init {
                int cntA=0, cntB=0, cntC=0;
}
                :               ( a {cntA++;} | b {cntB++;} | c {cntC++;} )+ {cntA>1 && cntB<=1 && cntC==1}?
                ;

Cheers, Indhu
S7 Software


From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Frank Du
Sent: Friday, October 30, 2009 9:53 PM
To: 'antlr-interest at antlr.org'
Subject: [antlr-interest] Please help with a grammar issue

Dear All,

I have a grammar issue and need your help. Let?s say I have tree rules: a, b, c

Rule a occurs multiple times, rule b occurs one time or none, and rule c occurs one time.

My question is: How to write the grammar, so the rule ordering is arbitrary?

Thank you so much! Have a nice day!

Best Regards,
Frank


From indhu.b at s7software.com  Fri Oct 30 10:27:35 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 30 Oct 2009 22:57:35 +0530
Subject: [antlr-interest] Please help with a grammar issue
In-Reply-To: <ACF14F1689EFEF438B46DADFB73B46E93F3B2227@mail-ab01.rmg-ny.com>
References: <ACF14F1689EFEF438B46DADFB73B46E93F73E930@mail-ab01.rmg-ny.com>,
	<001a01ca597f$14bc8be0$3e35a3a0$@b@s7software.com>
	<ACF14F1689EFEF438B46DADFB73B46E93F3B2227@mail-ab01.rmg-ny.com>
Message-ID: <002b01ca5986$45751070$d05f3150$@b@s7software.com>

When I give 2 'b', I get parser error.

Here is the complete grammar I used:

grammar Test;

r
@init {
                int cntA=0, cntB=0, cntC=0; 
}
                :               ( a {cntA++;} | b {cntB++;} | c {cntC++;} )+
{cntA>1 && cntB<=1 && cntC==1}?
                ;

a	:	'A'
	;
	
b	:	'B'
	;
	
c	:	'C'
	;

And my test input was: "ABBC". Parser will throw failed predicate exception
on this input.

Can you give a compilable small grammar where it doesn't work and also the
input you tried?


Cheers, Indhu
S7 Software


-----Original Message-----
From: Frank Du [mailto:frank.du at riskmetrics.com] 
Sent: Friday, October 30, 2009 10:38 PM
To: Indhu Bharathi; antlr-interest at antlr.org
Subject: RE: [antlr-interest] Please help with a grammar issue

Hi Indhu,

Thank you so much! It works pretty well on correct input file. 

However, if I have 2 rules of b, the parser will stop at the second. It
doesn't emit errors as expected. Then it hinders from validation. Any idea
about that?

Cheers,
Frank

________________________________________
From: Indhu Bharathi [indhu.b at s7software.com]
Sent: Friday, October 30, 2009 12:36 PM
To: Frank Du; antlr-interest at antlr.org
Subject: RE: [antlr-interest] Please help with a grammar issue

Maybe you can use validating semantic predicate

r
@init {
                int cntA=0, cntB=0, cntC=0;
}
                :               ( a {cntA++;} | b {cntB++;} | c {cntC++;} )+
{cntA>1 && cntB<=1 && cntC==1}?
                ;

Cheers, Indhu
S7 Software


From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Frank Du
Sent: Friday, October 30, 2009 9:53 PM
To: 'antlr-interest at antlr.org'
Subject: [antlr-interest] Please help with a grammar issue

Dear All,

I have a grammar issue and need your help. Let's say I have tree rules: a,
b, c

Rule a occurs multiple times, rule b occurs one time or none, and rule c
occurs one time.

My question is: How to write the grammar, so the rule ordering is arbitrary?

Thank you so much! Have a nice day!

Best Regards,
Frank


From indhu.b at s7software.com  Fri Oct 30 10:46:20 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 30 Oct 2009 23:16:20 +0530
Subject: [antlr-interest] How to create many AST trees from one rule
In-Reply-To: <B00C7A477A17884DBB97DEC08EE0DF9E0162CB2D@EXVBE010-2.exch010.intermedia.net>
References: <mailman.1.1256842801.26479.antlr-interest@antlr.org>
	<B00C7A477A17884DBB97DEC08EE0DF9E0162CB2D@EXVBE010-2.exch010.intermedia.net>
Message-ID: <002c01ca5988$e43bf780$acb3e680$@b@s7software.com>

Use scope variables to remember what you saw in a rule and emit it in
another rule further down in the chain. This will create the tree you want.
But I feel 'TYPE' node is not needed. It is good to build your AST as terse
as possible.

 

grammar Test;

options {

                output=AST;

}

 

tokens {

                DECL;

                TYPE;

}

 

decl

scope {

                Token typeTkn;

}

                :               type {$decl::typeTkn=$type.start;} varList
-> varList

                ;

                

type:     INT

                ;

                

varList

                :               var (COMMA var)* -> var+

                ;

                

var          :               ID -> ^(DECL ID ^(TYPE {$decl::typeTkn}))

                ;

                

INT         :               'int'

                ;

 

ID            :               'a'..'z'+

                ;

                

COMMA

                :               ','

                ;

 

WS         :               (' ' | '\t' | '\n')+ {$channel=HIDDEN;}

                ;

                

 

Cheers, Indhu

S7 Software

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jared Klumpp
Sent: Friday, October 30, 2009 1:14 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to create many AST trees from one rule

 

I'm trying to create a new DECL for each identifier - if this were C, int a,
b; would become (DECL A (TYPE INT)) (DECL B (TYPE INT)).

My rules (untested):
decl: type IDENTS SEMI
-> ^(DECL idents ^(TYPE $type));

idents: IDENT (COMMA IDENT)*
-> IDENT+;

My problem is this creates (DECL A B (TYPE INT)), how can I split this into
multiple trees when idents collects the identifiers into one tree?

Thanks,
Jared 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/af75fbb8/attachment.html 

From jimi at temporal-wave.com  Fri Oct 30 11:25:44 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 30 Oct 2009 11:25:44 -0700
Subject: [antlr-interest] Please help with a grammar issue
In-Reply-To: <ACF14F1689EFEF438B46DADFB73B46E93F73E930@mail-ab01.rmg-ny.com>
Message-ID: <ea663137a3077c44b55fdb5dfd80228b@temporal-wave.com>

You don?t want to try and express this in the grammar at all, nor have predicates etc as you will not get good error messages or recovery. 

 

All you need do in fact is code the grammar to accept any number of each option, keep track of how many you find and issue good semantic errors such as ?a b block cannot be repeated ?? and so on. Something like this:

 

stuff 

scope

{

 int aCount = 0;

 int bCount = 0;

 int cCount = 0;

}

: abc*

  {

    If (cCount == 0) { /* message about having to have a c block */ }

  }

;

 

abc

: a {$stuff::aCount++; }

| b { $styff:bVount++; if ($stuff::bCount > 1) { /* message about b blocks being repeated */ } }

| c {$stuff::cCount++; }

;

 

Generally people try to encode to much of the structure in to the grammar and it is the opposite way around that gives you better error messages and analysis.

 

Jim

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Frank Du
Sent: Friday, October 30, 2009 9:23 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Please help with a grammar issue

 

Dear All,

 

I have a grammar issue and need your help. Let?s say I have tree rules: a, b, c

 

Rule a occurs multiple times, rule b occurs one time or none, and rule c occurs one time.

 

My question is: How to write the grammar, so the rule ordering is arbitrary? 

 

Thank you so much! Have a nice day!

 

Best Regards,

Frank

 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/78335eff/attachment.html 

From jklumpp at harmonia.com  Fri Oct 30 14:08:09 2009
From: jklumpp at harmonia.com (Jared Klumpp)
Date: Fri, 30 Oct 2009 14:08:09 -0700
Subject: [antlr-interest] How to create many AST trees from one rule
Message-ID: <B00C7A477A17884DBB97DEC08EE0DF9E0162CB2F@EXVBE010-2.exch010.intermedia.net>

--   However, do you have some particular reason to make the tree look like that? It is just as easy to deal with: ^(DECL type ^(VARS A B C)) in a walker.


The method we're using for creating nodes only allows one node to be created at a time and I want the ability to do something like getRecordType("foo").getDefs() and have this return 3 definitions (in your A, B, C example).




Indhu - that method works well in this situation, but do you know how I could make it work when identifiers are on the left? For example if decl were this rule:

decl

scope {

                Token typeTkn;

}

                :               varList type {$decl::typeTkn=$type.start;}
-> varList

                ;

Thanks for the help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20091030/1fbbd9b5/attachment.html 

From alex.marin at amiq.ro  Fri Oct 30 14:16:55 2009
From: alex.marin at amiq.ro (Alex Marin)
Date: Fri, 30 Oct 2009 23:16:55 +0200
Subject: [antlr-interest] Big grammar => static initializer/method size is
 exceeding the 65535 bytes limit
Message-ID: <1256937416.19646.89.camel@hermes>

Hello,

While trying to migrate a parser grammar file from ANTLR v2 to ANTLR v3
I came across the following errors in the generated Parser.java:

   1. The code for the static initializer is exceeding the 65535 bytes
limit

and:

   2. The code of method specialStateTransition(int, IntStream) is
exceeding the 65535 bytes limit.

One solution to work around problem #1 seems to be spreading the static
initializations from the Parser.java file across more compilation units,
but it is definitely cumbersome and not scalable.

Regarding problem #2, I came across several mail threads, but none
provided a clear & scalable solution.

I have to mention that the grammar worked well in ANTLR v2 (the
generated parser was ~40 000 lines of code as opposed to the one
generated with ANTLR v3 which counts ~300 000 loc). I also have to point
out that the grammar is very large ( ~600 rule definitions and ~5000
loc).

My questions are:

Are there any known solutions/workarounds for these problems?
Is there a known approach for fixing such issues related to big
grammars? (N.B. Generation takes a few minutes and even opening the
generated parser with a basic text editor is quite sluggish)

Thank you,
    Alex Marin


From yurushkin at rambler.ru  Sat Oct 31 16:12:10 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 01 Nov 2009 02:12:10 +0300
Subject: [antlr-interest] [C target] constructex bug
Message-ID: <op.u2otekkqt3jqlu@win-mupvrp0jyrf>

if "k" options isn't set parset doesn't construct and initialize exceptions

for example, if k=somevalue, than the following code is generated:
                 CONSTRUCTEX();
                 EXCEPTION->type         = ANTLR3_NO_VIABLE_ALT_EXCEPTION;
                 EXCEPTION->message      = (void *)"";
                 EXCEPTION->decisionNum  = 6;
                 EXCEPTION->state        = 0;

but it's not generated when k=*


-- 
Best regards,
Michael

From jimi at temporal-wave.com  Sat Oct 31 17:29:23 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 31 Oct 2009 17:29:23 -0700
Subject: [antlr-interest] [C target] constructex bug
In-Reply-To: <op.u2otekkqt3jqlu@win-mupvrp0jyrf>
Message-ID: <7c6a7f0aa2dd4e41b7a433fefbb79c34@temporal-wave.com>

That isn't generally true, so I would need an example to investigate this :-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of ??????? ??????
> Sent: Saturday, October 31, 2009 4:12 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] [C target] constructex bug
> 
> if "k" options isn't set parset doesn't construct and initialize
> exceptions
> 
> for example, if k=somevalue, than the following code is generated:
>                  CONSTRUCTEX();
>                  EXCEPTION->type         =
> ANTLR3_NO_VIABLE_ALT_EXCEPTION;
>                  EXCEPTION->message      = (void *)"";
>                  EXCEPTION->decisionNum  = 6;
>                  EXCEPTION->state        = 0;
> 
> but it's not generated when k=*
> 
> 
> --
> Best regards,
> Michael
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




