<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] faster expression parsing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20faster%20expression%20parsing&In-Reply-To=%3C254336A1-444A-415F-A4C5-3D43405E9B6A%40cs.usfca.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027284.html">
   <LINK REL="Next"  HREF="027304.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] faster expression parsing</H1>
    <B>Terence Parr</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20faster%20expression%20parsing&In-Reply-To=%3C254336A1-444A-415F-A4C5-3D43405E9B6A%40cs.usfca.edu%3E"
       TITLE="[antlr-interest] faster expression parsing">parrt at cs.usfca.edu
       </A><BR>
    <I>Tue Mar 18 18:57:59 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027284.html">[antlr-interest] faster expression parsing
</A></li>
        <LI>Next message: <A HREF="027304.html">[antlr-interest] faster expression parsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27299">[ date ]</a>
              <a href="thread.html#27299">[ thread ]</a>
              <a href="subject.html#27299">[ subject ]</a>
              <a href="author.html#27299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On Mar 17, 2008, at 10:10 PM, Austin Hastings wrote:

&gt;<i> Terence Parr wrote:
</I>&gt;&gt;<i> So, I should have been working on something else but got to  
</I>&gt;&gt;<i> thinking about how annoying it is specifying expressions in  
</I>&gt;&gt;<i> recursive descent parsers.  You have to have a new rule for each  
</I>&gt;&gt;<i> precedence level.  This is also very slow. Just to match 34 it has  
</I>&gt;&gt;<i> to descend about 15 method calls.
</I>&gt;<i>
</I>&gt;<i> I totally agree. (See thread at: <A HREF="http://www.antlr.org/">http://www.antlr.org/</A> 
</I>&gt;<i> pipermail/antlr-interest/2007-December/025112.html)
</I>
Yep, i remember. also some macro requests.

&gt;&gt;<i> I built a prototype single-rule (plus primary and suffix) operator  
</I>&gt;&gt;<i> matching thingie today.  I should be able to generate this from  
</I>&gt;&gt;<i> some metameta syntax in antlr.  Try it out...it's amazing (v3.1  
</I>&gt;&gt;<i> required due to tree bulding bug fix).
</I>&gt;<i>
</I>&gt;<i> Closer. I want the syntax built in to Antlr. Make expression sub- 
</I>&gt;<i> grammars some kind of callable thing.
</I>&gt;<i>
</I>&gt;<i> string_expr:
</I>&gt;<i>    @expression_subgrammar { operators = '+', '.', 'x', 'trim'(),  
</I>&gt;<i> 'ltrim'(), 'rtrim'()  ; }
</I>&gt;<i>    ;
</I>
Yep, my plan is to make it easy to specify.  I must admit though that  
I can't hide primary and suffix operator rules so I'd only be hiding  
this rule:

/** This could be autogenerated if you give me primary and suffix and  
precedence levels */
e[int p]
      :   (primary-&gt;primary)
          (   {prec[input.LA(1)]&gt;=p}?=&gt;     bop r=e[nextp(p)] -&gt; ^ 
(bop $e $r)
          |   {postprec[input.LA(1)]&gt;=p}?=&gt; suffix[$e.tree]   -&gt;  
{$suffix.tree}
          )*
      ;

We'd just need to say something like you request.  I also thought  
that just using an option would be ok...or, use the left-recursive rule.

e	:	e '*' e
	|	e '-' e
	|	e '+' e
	|	'-' e
	|	e '.' ID
	|	e '[' e ']'
	|	e '(' e (',' e)* ')'
	|	INT
	|	ID
	;

That's nice 'cause it's explicit like a yacc grammar would be.  I'd  
recognize this pattern and build what i sent before.  Only issue is  
precedence.  Order would work sort of but probably not  
perfectly...for example a+b.x should not match as (a+b).x.

Ter
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027284.html">[antlr-interest] faster expression parsing
</A></li>
	<LI>Next message: <A HREF="027304.html">[antlr-interest] faster expression parsing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27299">[ date ]</a>
              <a href="thread.html#27299">[ thread ]</a>
              <a href="subject.html#27299">[ subject ]</a>
              <a href="author.html#27299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
