<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Tree pattern matching and delegate grammars	(imported grammars) incompatible?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Tree%20pattern%20matching%20and%20delegate%20grammars%0A%09%28imported%20grammars%29%20incompatible%3F&In-Reply-To=%3CCAM1TniBM%3DZF3rF5%2BEuGuUMNYbxPFgi%3DT%3DNyd0zAbNsKUUVvxeA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043927.html">
   <LINK REL="Next"  HREF="043941.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Tree pattern matching and delegate grammars	(imported grammars) incompatible?</H1>
    <B>S&#248;ren Boisen</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Tree%20pattern%20matching%20and%20delegate%20grammars%0A%09%28imported%20grammars%29%20incompatible%3F&In-Reply-To=%3CCAM1TniBM%3DZF3rF5%2BEuGuUMNYbxPFgi%3DT%3DNyd0zAbNsKUUVvxeA%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Tree pattern matching and delegate grammars	(imported grammars) incompatible?">sboisen at mail.dk
       </A><BR>
    <I>Tue Jan 24 06:49:50 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="043927.html">[antlr-interest] Semantic predicates in v4 lexer rules
</A></li>
        <LI>Next message: <A HREF="043941.html">[antlr-interest] Call antlr from console
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43937">[ date ]</a>
              <a href="thread.html#43937">[ thread ]</a>
              <a href="subject.html#43937">[ subject ]</a>
              <a href="author.html#43937">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there,
I'm trying to build a tree pattern matcher that rewrites my AST. Right
now, I'm trying to define a shared grammar for some common rules and
use it in my tree pattern matchers by importing it.
My problem is that the input TreeNodeStream doesn't seem to be shared
between the root grammar and the delegate. I've been looking hard at
the code involved, and it seems to me that this excerpt from
TreeRewriter is the culprit:

&#160;&#160;&#160; public Object applyOnce(Object t, fptr whichRule) {
&#160;&#160;&#160;&#160;&#160;&#160;&#160; if ( t==null ) return null;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; try {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // share TreeParser object but not parsing-related state
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; state = new RecognizerSharedState();
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; input = new CommonTreeNodeStream(originalAdaptor, t);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; ...
&#160;&#160;&#160; }

So my question becomes: is tree pattern matching (and rewriting)
simply incompatible with grammar inheritance/delegation? Is there a
workaround?
It would be nice if such limitations were documented on the wiki, I
couldn't find any info on it at all.

Best regards
S&#248;ren
</PRE>























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043927.html">[antlr-interest] Semantic predicates in v4 lexer rules
</A></li>
	<LI>Next message: <A HREF="043941.html">[antlr-interest] Call antlr from console
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43937">[ date ]</a>
              <a href="thread.html#43937">[ thread ]</a>
              <a href="subject.html#43937">[ subject ]</a>
              <a href="author.html#43937">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
