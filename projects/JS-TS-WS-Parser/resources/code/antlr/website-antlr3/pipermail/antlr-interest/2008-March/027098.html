<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Retaining comments
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Retaining%20comments&In-Reply-To=%3C96AD91D781CCD511A66000B0D0D15C49043DAE31%40EXSVR1%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027192.html">
   <LINK REL="Next"  HREF="027117.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Retaining comments</H1>
    <B>Stuart Watt</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Retaining%20comments&In-Reply-To=%3C96AD91D781CCD511A66000B0D0D15C49043DAE31%40EXSVR1%3E"
       TITLE="[antlr-interest] Retaining comments">SWatt at infobal.com
       </A><BR>
    <I>Tue Mar 11 12:45:47 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027192.html">[antlr-interest] dynamic token stream
</A></li>
        <LI>Next message: <A HREF="027117.html">[antlr-interest] A postmortem of my use of antler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27098">[ date ]</a>
              <a href="thread.html#27098">[ thread ]</a>
              <a href="subject.html#27098">[ subject ]</a>
              <a href="author.html#27098">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I'm going to have to do this as well. However, my dream would be....
 
Can we use/generate an XML AST, with the text nodes corresponding exactly to
the input source received at the lexer, and the elements corresponding to
the AST tags. I know there are all sorts of complexities with this, but it
enables several outcomes:
 
1. Using fast and general tree processing via XML and DOM, maybe even using
XPath and XQuery
2. Easy filtering via the above
3. Clear mapping between AST and text, which is not currently easy
 
Although I have not completely looked into this yet (and I will) it seems
most of this could be done fine using an additional AST writer. I wrote one
which does the XML, but does not preserve the input text. In the end, I had
to do this, as the current AST notation (which I wanted to read for
processing) was unable to distinguish, say, between an imaginary token
&quot;FUNCTION&quot; and a language identifier written as uppercase &quot;FUNCTION&quot;, unless
I tagged absolutely every single thing in the grammar, which was tedious.
There are all sorts of other nasty cases (e.g., does whitespace fall inside
or outside of particular elements). And in particular, this would require
some mapping between imaginary tokens and text positions which is not always
possible. 
 
I'm developing a system which will annotate code, both generating
human-readable output and a component index. The one pushes you to a text
output, the other to an AST - I've ended up needing both, largely because of
similar issues. It seems it may be fairly simple to develop this kind of
tree writer for cases like these. 
 
Any thoughts on this? Am I crazy/doing it all wrong?
 
--S

-----Original Message-----
From: Terence Parr [mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">parrt at cs.usfca.edu</A>]
Sent: Tuesday, March 11, 2008 12:43 PM
To: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bmeike at speakeasy.net</A>
Cc: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
Subject: Re: [antlr-interest] Retaining comments


send comments to parser on different channel.  then lookin token buffer for
them between &quot;real&quot; tokens. 
Ter

On Feb 27, 2008, at 1:19 PM, &lt; <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bmeike at speakeasy.net</A>
&lt;mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bmeike at speakeasy.net</A>&gt; &gt; &lt; <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bmeike at speakeasy.net</A>
&lt;mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bmeike at speakeasy.net</A>&gt; &gt; wrote:






On Wed Feb 27 12:29 , Gavin Lambert sent:


&gt;<i> This will keep the comment tokens in the token stream at the 
</I>&gt;<i> appropriate points. To transfer them you'll have to add some code 
</I>&gt;<i> that looks for comment tokens nearby recognised parser constructs 
</I>&gt;<i> so you can emit them at the right place in the output.
</I>
Sound great.  What do you mean by &quot;looks for comment tokens&quot;.  As far as I
can tell, the parser only sees the DEFAULT channel.  Where do I look, to
find nearby tokens?

Thanks!
  Blake Meike





-- 
This message was scanned by ESVA and is believed to be clean. 
Click
&lt;<A HREF="http://antispam.infobal.com/cgi-bin/learn-msg.cgi?id=3F8A7299B6.2E2B3">http://antispam.infobal.com/cgi-bin/learn-msg.cgi?id=3F8A7299B6.2E2B3</A>&gt; here
to report this message as spam. 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20080311/1f650eca/attachment-0001.html">http://www.antlr.org/pipermail/antlr-interest/attachments/20080311/1f650eca/attachment-0001.html</A> 
</PRE>








































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027192.html">[antlr-interest] dynamic token stream
</A></li>
	<LI>Next message: <A HREF="027117.html">[antlr-interest] A postmortem of my use of antler
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27098">[ date ]</a>
              <a href="thread.html#27098">[ thread ]</a>
              <a href="subject.html#27098">[ subject ]</a>
              <a href="author.html#27098">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
