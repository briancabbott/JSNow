<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Unicode Category Question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Unicode%20Category%20Question&In-Reply-To=%3C47E800BD.4060803%40gmx.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="027364.html">
   <LINK REL="Next"  HREF="027365.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Unicode Category Question</H1>
    <B>Johannes Luber</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Unicode%20Category%20Question&In-Reply-To=%3C47E800BD.4060803%40gmx.de%3E"
       TITLE="[antlr-interest] Unicode Category Question">jaluber at gmx.de
       </A><BR>
    <I>Mon Mar 24 12:27:57 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="027364.html">[antlr-interest] Unicode Category Question
</A></li>
        <LI>Next message: <A HREF="027365.html">[antlr-interest] ANTLR Ruby target
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27387">[ date ]</a>
              <a href="thread.html#27387">[ thread ]</a>
              <a href="subject.html#27387">[ subject ]</a>
              <a href="author.html#27387">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Darryl A. J. Staflund schrieb:
&gt;<i> Hi everyone,
</I>&gt;<i> 
</I>&gt;<i> I am a new ANTLR user and have started to write an EMCA-compliant lexer 
</I>&gt;<i> for C# using ANTLR 3.0.1.  I know that other C# lexers exist on the site 
</I>&gt;<i> but I want to try writing one for myself to get a feel for ANTLR and to 
</I>&gt;<i> learn how to use it to deal with pre-processing directives, etc.  Since 
</I>&gt;<i> I hope to compile the lexer using C# instead of Java, I have set my 
</I>&gt;<i> target language as 'CSharp' in the options of my grammar file.  I then 
</I>&gt;<i> generate the source code using the Java-based 'org.antlr.Tool' class.  I 
</I>&gt;<i> am using the Sun Java SDK 1.6.0_05.
</I>&gt;<i> 
</I>&gt;<i> I have run into two difficulties with this current approach:
</I>&gt;<i> 
</I>&gt;<i> 1.   The ECMA 334 specification defines a C# 2.x Unicode escape sequence 
</I>&gt;<i> as follows:
</I>&gt;<i> 
</I>&gt;<i>        unicode-escape-sequence::
</I>&gt;<i>            \u hex-digit hex-digit hex-digit hex-digit
</I>&gt;<i>            \U hex-digit hex-digit hex-digit hex-digit hex-digit 
</I>&gt;<i> hex-digit hex-digit hex-digit
</I>&gt;<i> 
</I>&gt;<i> Although the current (?) Java specification handles the first option 
</I>&gt;<i> just fine, it handles the second option a bit differently as stated in 
</I>&gt;<i> <A HREF="http://java.sun.com/docs/books/jls/third_edition/html/lexical.html#3.1:">http://java.sun.com/docs/books/jls/third_edition/html/lexical.html#3.1:</A>
</I>&gt;<i> 
</I>&gt;<i>    &quot;The Unicode standard was originally designed as a fixed-width 16-bit 
</I>&gt;<i> character encoding. It
</I>&gt;<i>    has since been changed to allow for characters whose representation 
</I>&gt;<i> requires more than 16 bits.
</I>&gt;<i>    The range of legal code points is now U+0000 to U+10FFFF, using the 
</I>&gt;<i> hexadecimal U+n notation.
</I>&gt;<i>    Characters whose code points are greater than U+FFFF are called 
</I>&gt;<i> supplementary characters. To
</I>&gt;<i>    represent the complete range of characters using only 16-bit units, 
</I>&gt;<i> the Unicode standard defines an
</I>&gt;<i>    encoding called UTF-16. In this encoding, supplementary characters 
</I>&gt;<i> are represented as pairs of
</I>&gt;<i>    16-bit code units, the first from the high-surrogates range, (U+D800 
</I>&gt;<i> to U+DBFF), the second from
</I>&gt;<i>    the low-surrogates range (U+DC00 to U+DFFF). For characters in the 
</I>&gt;<i> range U+0000 to U+FFFF,
</I>&gt;<i>    the values of code points and UTF-16 code units are the same.&quot;
</I>&gt;<i> 
</I>&gt;<i> Since Java represents supplementary characters as pairs of 16-byte code 
</I>&gt;<i> units instead of as single '\Uxxxxxxxx' string sequences, I don't know 
</I>&gt;<i> how to parse these latter values in my ANTLR grammar.  Does ANTLR's 
</I>&gt;<i> Java-based lexer handle Unicode supplementary characters passed to it in 
</I>&gt;<i> the '\Uxxxxxxxx' format?  How should I handle something like this?
</I>
I refer for these questions to my dissertation, which I will will send 
to you (and anyone else) off-list.

&gt;<i> 2.  The ECMA 334 specifications defines identifiers in terms of Unicode 
</I>&gt;<i> character categories as follows:
</I>&gt;<i> 
</I>&gt;<i>    letter-character::
</I>&gt;<i>    A Unicode character of classes Lu, Ll, Lt, Lm, Lo, or Nl
</I>&gt;<i>    A unicode-escape-sequence representing a character of classes Lu, Ll, 
</I>&gt;<i> Lt, Lm, Lo, or Nl
</I>&gt;<i> 
</I>&gt;<i>    combining-character::
</I>&gt;<i>    A Unicode character of classes Mn or Mc
</I>&gt;<i>    A unicode-escape-sequence representing a character of classes Mn or Mc
</I>&gt;<i> 
</I>&gt;<i>    decimal-digit-character::
</I>&gt;<i>    A Unicode character of the class Nd
</I>&gt;<i>    A unicode-escape-sequence representing a character of the class Nd
</I>&gt;<i> 
</I>&gt;<i>    connecting-character::
</I>&gt;<i>    A Unicode character of the class Pc
</I>&gt;<i>    A unicode-escape-sequence representing a character of the class Pc
</I>&gt;<i> 
</I>&gt;<i>    formatting-character::
</I>&gt;<i>    A Unicode character of the class Cf
</I>&gt;<i>    A unicode-escape-sequence representing a character of the class Cf
</I>&gt;<i> 
</I>&gt;<i> I have read various posts in the ANTLR newsgroups on how to recognize 
</I>&gt;<i> these categories and see that a number of strategies have been discussed:
</I>&gt;<i> 
</I>&gt;<i> - Define the categories in terms of Unicode escape sequences, eg.  
</I>&gt;<i> &quot;WHITESPACE:  ('\u0020' | ('\u2000'.'\u0200A') | ...etc...);&quot;.
</I>&gt;<i> - Define the categories in terms of semantic predicates, eg.  
</I>&gt;<i> &quot;WHITESPACE:  { IsUnicodeCategoryZs (LA (1)) }? ;&quot;.
</I>&gt;<i> 
</I>&gt;<i> The difficulty with the first approach in regard to the C# specification 
</I>&gt;<i> is that some Unicode character categories (ex:  Nd) contain 
</I>&gt;<i> supplementary characters.  This means that in order to represent them in 
</I>&gt;<i> a Java-friendly manner, I need to convert them into pairs of Unicode 
</I>&gt;<i> characters.  Ugghh!  I don't mind the second option, although it sounds 
</I>&gt;<i> as though it will run slower.
</I>&gt;<i> 
</I>&gt;<i> Since the newer regular expression engines used by Perl, Java, C#, etc. 
</I>&gt;<i> have been built to match on Unicode, could ANTLR's EBNF be extended to 
</I>&gt;<i> match on the following:
</I>&gt;<i> 
</I>&gt;<i> - Unicode Character Properties (i.e.:  \p{Lu}, \p{Mn}, etc...)
</I>&gt;<i> - Unicode Scripts (i.e.  \p{Common}, \p{Arabic}, etc...)
</I>&gt;<i> - Unicode Blocks (i.e. \p{Currency_Symbol}, \p{InBasic_Latin}, ...)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> If this were done, we could use them in the ANTLR parser as so:
</I>&gt;<i> 
</I>&gt;<i>    letter-character:
</I>&gt;<i>        :    \p{Lu}
</I>&gt;<i>        |    \p{Ll}
</I>&gt;<i>        |    \p{Lt}
</I>&gt;<i>        |    \p{Lm}
</I>&gt;<i>        |    \p{Lo}
</I>&gt;<i>        |    \p{Nl}
</I>&gt;<i>      
</I>&gt;<i> etc...
</I>&gt;<i> 
</I>&gt;<i> We could also use them to do the following:
</I>&gt;<i> 
</I>&gt;<i> - Define characters in terms of negations (ex:  &quot;TOKEN:  \p{^Lu} | 
</I>&gt;<i> \p{^Letter};)
</I>&gt;<i> - Match letters including diacritics (ex:  LETTER_AND_DIACRITIC:  \p{L} 
</I>&gt;<i> \p{M}*)
</I>
An interesting enhancement, but unnecessary for the problem, as 
described in my dissertation.

Johannes
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="027364.html">[antlr-interest] Unicode Category Question
</A></li>
	<LI>Next message: <A HREF="027365.html">[antlr-interest] ANTLR Ruby target
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#27387">[ date ]</a>
              <a href="thread.html#27387">[ thread ]</a>
              <a href="subject.html#27387">[ subject ]</a>
              <a href="author.html#27387">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
