From Anand.Vidyasagar at sungard.com  Mon Sep  1 02:14:52 2008
From: Anand.Vidyasagar at sungard.com (Anand.Vidyasagar at sungard.com)
Date: Mon, 1 Sep 2008 05:14:52 -0400
Subject: [antlr-interest] Lexer Help,
	line-comment begins with a character that is also an operator
In-Reply-To: <209D6379477C4E44AC9671354DBD2477021F5297@VOO-EXCHANGE01.internal.sungard.corp>
References: <209D6379477C4E44AC9671354DBD2477021F5297@VOO-EXCHANGE01.internal.sungard.corp>
Message-ID: <209D6379477C4E44AC9671354DBD2477021F529B@VOO-EXCHANGE01.internal.sungard.corp>

In our small language we have a notion that if a line begins with a '*'
character on Column 0 we treat it is a line comment.

However the '*' happens to be the multiplication operator in the
language at the same time.

 

Here is my Grammar so far,

 

script

      :

            (expression SEMICOLON)+ 

      ;

 

expression

      :

            lvalue operator (lvalue | expression)

            {

                  System.out.println("Expression : "+ $expression.text);

            }  

      ;

 

lvalue

      :

            FLOAT | NUMERIC

      ;

 

FLOAT

      :

             DIGIT+ ('.' DIGIT+)

      ;

NUMERIC

       :       

       |       DIGIT+

       ;

 

fragment

DIGIT

      : '0'..'9'

      ;

 

operator

options { k=2;}

      :

                  '*'

            |     '/'

            |     '+'

            |     '-'

            |     '**'

            |     '<<'

            |     '>>'                                

      ;

 

WS  :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}

    ;

 

LINE_COMMENT

    : '*' ~('\n'|'\r')* '\r'? ('\n') 

    { 

      if(getCharPositionInLine() == 0){

            System.out.println("Found Line Comment :" + getLine());

            $channel=HIDDEN;              

        }               

    }

    ;

 

Now for an Input as below I get an error because the lexer treats '*' as
a comment, what do I have to do to make sure the '*' is recognized as a
comment if it starts on Column 0 and as an operator elsewhere

 

*THIS IS A LINE COMMENT

1+2+3;

 

*ANOTHER LINE COMMENT, The Following gives me an Exception

1+4*3;

 

 

 

And here is the output when I run the parser

Found Line Comment :2

Found Line Comment :5

Found Line Comment :6

Expression : 2+3

Expression : 1+2+3

line 5:2 no viable alternative at input '4'

BR.recoverFromMismatchedToken

 

Regards,

Anand Vidyasagar

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080901/cdbc7ab7/attachment.html 

From janvanmansum at gmail.com  Mon Sep  1 02:38:49 2008
From: janvanmansum at gmail.com (Jan van Mansum)
Date: Mon, 1 Sep 2008 11:38:49 +0200
Subject: [antlr-interest] How do I generate an AST node with a given text?
Message-ID: <ddda310e0809010238k60143a7bj9e602d654df1bb92@mail.gmail.com>

Hello group:

I am writing an SQL parser and I am trying to get an AST like the
example below

SQL:

CREATE TABLE myTable (col01 VARCHAR(10), col02 INT);

INSERT INTO myTable (col01, col02)
VALUES ("Some string", 12)
       ("Some other string", 13);

Expected AST:

(TABLEDEF myTable
  (COLUMN col01
     (TYPE varchar 10))
  (COLUMN col02
     (TYPE int)))

(TABLEDATA myTable
  (ROW (col01 "Some string")
       (col02 12))
  (ROW (col01 "Some other string")
       (col02 13)))

Actual AST:

(TABLEDEF myTable
  (COLUMN col01
     (TYPE varchar 10))
  (COLUMN col02
     (TYPE int)))

(TABLEDATA myTable
  (ROW)
  (ROW (col01 ("Some string" "Some other string"))
       (col02 (12 13)))

I collect the column names in a scoped ArrayList<String> when parsing
the first line of the INSERT statement. When I get to the rule that
generates the column values I want to generate a node that contains the
column name and attach the value under it. Like this:

row_value_constructor_element
	:	value_expression
-> ^({$row_value_constructor::columnNames.get($row_value_constructor_list::i++)}
value_expression)
	;	

The problem seems to be that the nodes col01 and col02 are constructed only
once and that each time the parser gets to above line it attaches the new
value under the existing node.

How can I make sure that a new node is inserted?

Thanks for any help,

regards,


-- 
Jan van Mansum

From janvanmansum at gmail.com  Mon Sep  1 08:05:56 2008
From: janvanmansum at gmail.com (Jan van Mansum)
Date: Mon, 1 Sep 2008 17:05:56 +0200
Subject: [antlr-interest] How do I generate an AST node with a given
	text?
In-Reply-To: <ddda310e0809010238k60143a7bj9e602d654df1bb92@mail.gmail.com>
References: <ddda310e0809010238k60143a7bj9e602d654df1bb92@mail.gmail.com>
Message-ID: <ddda310e0809010805t237e71ffu6cca0e2a7972c1ef@mail.gmail.com>

Fixed the problem with

row_value_constructor_element
	:	value_expression
		-> ^({new CommonToken(COLNAME

$insert_statement::columnNames.get($row_value_constructor_list::i++))
                          }  value_expression)

Also, I had put CommonTree objects in columnNames by mistake. I have
now made sure that columnNames
contains Strings. This works, only ANTLRWorks doesn't show the token
labels in its diagram. However, if I print
the result with Tree.toStringTree() they do show up.


2008/9/1 Jan van Mansum <janvanmansum at gmail.com>
>
> Hello group:
>
> I am writing an SQL parser and I am trying to get an AST like the
> example below
>
> SQL:
>
> CREATE TABLE myTable (col01 VARCHAR(10), col02 INT);
>
> INSERT INTO myTable (col01, col02)
> VALUES ("Some string", 12)
>       ("Some other string", 13);
>
> Expected AST:
>
> (TABLEDEF myTable
>  (COLUMN col01
>     (TYPE varchar 10))
>  (COLUMN col02
>     (TYPE int)))
>
> (TABLEDATA myTable
>  (ROW (col01 "Some string")
>       (col02 12))
>  (ROW (col01 "Some other string")
>       (col02 13)))
>
> Actual AST:
>
> (TABLEDEF myTable
>  (COLUMN col01
>     (TYPE varchar 10))
>  (COLUMN col02
>     (TYPE int)))
>
> (TABLEDATA myTable
>  (ROW)
>  (ROW (col01 ("Some string" "Some other string"))
>       (col02 (12 13)))
>
> I collect the column names in a scoped ArrayList<String> when parsing
> the first line of the INSERT statement. When I get to the rule that
> generates the column values I want to generate a node that contains the
> column name and attach the value under it. Like this:
>
> row_value_constructor_element
>        :       value_expression
> -> ^({$row_value_constructor::columnNames.get($row_value_constructor_list::i++)}
> value_expression)
>        ;
>
> The problem seems to be that the nodes col01 and col02 are constructed only
> once and that each time the parser gets to above line it attaches the new
> value under the existing node.
>
> How can I make sure that a new node is inserted?
>
> Thanks for any help,
>
> regards,
>
>
> --
> Jan van Mansum



--
Jan van Mansum

From jean-claude.durand at imag.fr  Mon Sep  1 08:55:06 2008
From: jean-claude.durand at imag.fr (Jean-Claude Durand)
Date: Mon, 1 Sep 2008 17:55:06 +0200
Subject: [antlr-interest] Composed grammars: small bug with generated files
	and pbs with errors reporting
Message-ID: <B432E377-B375-45B8-97E5-5B2EDC90EFA3@imag.fr>

I use antlr v3.1 with the C language target to compose grammars. I  
send you an archive to show
you the problem:
- first, in the different generated .h files, the variable 'tree' has  
no type in the typedef definition of the
"return" when building ASTs (you should have the type  
'pANTLR3_BASE_TREE'):

typedef struct Composed_Float_reel_return_struct
{
     /** Generic return elements for ANTLR3 rules that are not in  
tree parsers or returning trees
      */
     pANTLR3_COMMON_TOKEN    start;
     pANTLR3_COMMON_TOKEN    stop;
     	tree;

}
     Composed_Float_reel_return;


- second, error reporting does not work very well even with very  
simple grammars as in my example
below. Sometimes it is ok, sometimes not (the same message for 2  
different errors or no message at all):

I compose the 2 grammars:

parser grammar Int;
options
{
	language=C;
	output=AST;
}
ent:	
	INT Id SEMICOL
					-> ^(INT Id)	
	;

and:

parser grammar Float;
options
{
	language=C;	
	output=AST;
}
reel	:	
	FLOAT Id SEMICOL
					-> ^(FLOAT Id)	
	;

in the composed grammar:

parser grammar Composed;
options
{
	language=C;
	tokenVocab=Lex;
	output=AST;
}
import Int, Float;
decls
	:
	e=ent
	r=reel
				-> ^(DECL $e $r)
	;

- example 1: ok

int a ;
float x ;

the result is:
  main:
  main: (DECL (int a) (float x))
  main.

- example 2: ok

int a b;
float x;

the result is:

  main:
err1.ok(1)  : error 9 : Extraneous token, at offset 5
     near [Index: 2 (Start: 5243798-Stop: 5243798) ='b', type<8>  
Line: 1 LinePos:5]
      : Extraneous input - expected SEMICOL ...
  main: (DECL (int a) (float x))
  main.

- example 3: ok

int a ;
float x y;

...

- example 4: NOT ok, I get the same message twice for the first error  
but nothing on the second.

int a b;
float x y;

the result is:

  main:
err.notOk(1)  : error 9 : Extraneous token, at offset 5
     near [Index: 2 (Start: 5243798-Stop: 5243798) ='b', type<8>  
Line: 1 LinePos:5]
      : Extraneous input - expected SEMICOL ...
err.notOk(1)  : error 9 : Extraneous token, at offset 5
     near [Index: 2 (Start: 5243798-Stop: 5243798) ='b', type<8>  
Line: 1 LinePos:5]
      : Extraneous input - expected SEMICOL ...
  main: ast: 249856
  main: (DECL (int a) (float x))
  main.

I use the lexer:

lexer grammar Lex;
options
{
	language=C;
}
tokens
{
	DECL;
}
INT: 'int';
FLOAT: 'float';
SEMICOL: ';';
Id:	'a'..'z'+	;
Blancs: ( ' ' | '\t' | '\n' )+ { $channel=HIDDEN; }	;

With more complicated grammars, I got no error reporting at all.

?


Have a nice day,
Jean-Claude Durand

LIG, ?quipe GETALP
385, rue de la Biblioth?que
BP 53
38041 Grenoble cedex 9
France

Jean-Claude.Durand at imag.fr
t?l: +33 (0)4 76 51 43 81
fax: +33 (0)4 76 51 44 05



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080901/6e756682/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ComposedGrammars_1.tar.gz
Type: application/x-gzip
Size: 4987 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080901/6e756682/attachment.gz 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080901/6e756682/attachment-0001.html 

From jimi at temporal-wave.com  Mon Sep  1 10:15:46 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 01 Sep 2008 10:15:46 -0700
Subject: [antlr-interest] Composed grammars: small bug with
	generated	files and pbs with errors reporting
In-Reply-To: <B432E377-B375-45B8-97E5-5B2EDC90EFA3@imag.fr>
References: <B432E377-B375-45B8-97E5-5B2EDC90EFA3@imag.fr>
Message-ID: <1220289346.3111.103.camel@jimi>

On Mon, 2008-09-01 at 17:55 +0200, Jean-Claude Durand wrote:

> I use antlr v3.1 with the C language target to compose grammars. I
> send you an archive to show
> 
> you the problem:
> - first, in the different generated .h files, the variable 'tree' has
> no type in the typedef definition of the 
> "return" when building ASTs (you should have the type
> 'pANTLR3_BASE_TREE'):

As has been postedquite a number of times now ;-), you need to have:

options
{
ASTLabelType=pANTLR3_BASE_TREE;
}

In your grammar.


> 
> - second, error reporting does not work very well even with very
> simple grammars as in my example
> below. Sometimes it is ok, sometimes not (the same message for 2
> different errors or no message at all):
> 
> 
> I compose the 2 grammars:
> 
> 
> parser grammar Int;
> options
> {
> language=C;
> output=AST;
> }
> ent: 
> INT Id SEMICOL
> -> ^(INT Id) 
> ;
> 
> 
> and:
> 
> 
> parser grammar Float;
> options
> {
> language=C; 
> output=AST;
> }
> reel : 
> FLOAT Id SEMICOL
> -> ^(FLOAT Id) 
> ;
> 
> 
> in the composed grammar:
> 
> 
> parser grammar Composed;
> options
> {
> language=C;
> tokenVocab=Lex;
> output=AST;
> }
> import Int, Float;
> decls
> :
> e=ent
> r=reel
> -> ^(DECL $e $r)
> ;
> 


> 
> 
> - example 4: NOT ok, I get the same message twice for the first error
> but nothing on the second.
> 
> 
> int a b;
> float x y;
> 
> 
> the result is:
> 
> 
>  main:
> err.notOk(1)  : error 9 : Extraneous token, at offset 5
>     near [Index: 2 (Start: 5243798-Stop: 5243798) ='b', type<8> Line:
> 1 LinePos:5]
>      : Extraneous input - expected SEMICOL ...
> err.notOk(1)  : error 9 : Extraneous token, at offset 5
>     near [Index: 2 (Start: 5243798-Stop: 5243798) ='b', type<8> Line:
> 1 LinePos:5]
>      : Extraneous input - expected SEMICOL ...
>  main: ast: 249856
>  main: (DECL (int a) (float x))
>  main.


I'll look into it, maybe it is something to do with not resetting the
error flag perhaps.


JIm
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080901/c4c4ef92/attachment.html 

From sharwell at pixelminegames.com  Mon Sep  1 10:43:34 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Mon, 1 Sep 2008 12:43:34 -0500
Subject: [antlr-interest] Faster expression parsing
In-Reply-To: <5BEA2878-0527-4E34-BE5C-014F20D87476@cs.usfca.edu>
References: <86403CA0939415448BCCB83855EFE09A64E233@Bloodymary.ironwillgames.com>
	<21270276-FDAA-4A6C-8758-3CC39B64CAB5@cs.usfca.edu>
	<86403CA0939415448BCCB83855EFE09A64E24C@Bloodymary.ironwillgames.com>
	<5BEA2878-0527-4E34-BE5C-014F20D87476@cs.usfca.edu>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E27B@Bloodymary.ironwillgames.com>

I put it under the examples section of the ANTLR3 wiki.

http://antlr.org/wiki/display/ANTLR3/Operator+precedence+parser

Sam

-----Original Message-----
From: Terence Parr [mailto:parrt at cs.usfca.edu] 
Sent: Thursday, August 28, 2008 3:27 PM
To: Sam Harwell
Cc: antlr-interest
Subject: Re: [antlr-interest] Faster expression parsing

<snip>

You should make a faq entry :)

<snip>

Ter

From lgcraymer at yahoo.com  Mon Sep  1 11:02:50 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 1 Sep 2008 11:02:50 -0700 (PDT)
Subject: [antlr-interest] Lexer Help,
	line-comment begins with a character that is also an operator
Message-ID: <868973.26833.qm@web55908.mail.re3.yahoo.com>

"starts on column zero" means "is preceded by '\n'":  you want to recognize '\n' '*' as the start of a line comment, not just '*'.

--Loring


r 1, 2008 2:14:52 AM
Subject: [antlr-interest] Lexer Help, line-comment begins with a character that is also an operator

 
In our small language we have a notion that if a line begins
with a ?*? character on Column 0 we treat it is a line comment.
However the ?*? happens to be the multiplication
operator in the language at the same time.
 
Here is my Grammar so far,
 
script
     
:
           
(expression SEMICOLON)+ 
     
;
 
expression
     
:
           
lvalue operator (lvalue | expression)
           
{
                 
System.out.println("Expression : "+ $expression.text);
           
}  
     
;
 
lvalue
     
:
           
FLOAT | NUMERIC
     
;
 
FLOAT
     
:
           
 DIGIT+ ('.' DIGIT+)
     
;
NUMERIC
      
:       
      
|       DIGIT+
      
;
 
fragment
DIGIT
     
: '0'..'9'
     
;
 
operator
options { k=2;}
     
:
                 
'*'
           
|     '/'
           
|     '+'
           
|     '-'
           
|     '**'
           
|     '<<'
           
|    
'>>'                                
     
;
 
WS  :  (' '|'\r'|'\t'|'\u000C'|'\n')
{$channel=HIDDEN;}
    ;
 
LINE_COMMENT
    : '*'
~('\n'|'\r')* '\r'? ('\n') 
    { 
     
if(getCharPositionInLine() == 0){
   
        System.out.println("Found Line
Comment :" + getLine());
       
    $channel=HIDDEN;       
      
       
}          
    
    }
    ;
 
Now for an Input as below I get an error because the lexer
treats ?*? as a comment, what do I have to do to make sure the
?*? is recognized as a comment if it starts on Column 0 and as an
operator elsewhere
 
*THIS IS A LINE COMMENT
1+2+3;
 
*ANOTHER LINE COMMENT, The
Following gives me an Exception
1+4*3;
 
 
 
And here is the output when I run the parser
Found Line Comment :2
Found Line Comment :5
Found Line Comment :6
Expression : 2+3
Expression : 1+2+3
line 5:2 no viable alternative at input '4'
BR.recoverFromMismatchedToken
 
Regards,

Anand Vidyasagar


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080901/bc1b1c45/attachment.html 

From antlr at mirality.co.nz  Mon Sep  1 13:01:42 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 02 Sep 2008 08:01:42 +1200
Subject: [antlr-interest] Lexer Help,
 line-comment begins with a  character that is also an operator
In-Reply-To: <209D6379477C4E44AC9671354DBD2477021F529B@VOO-EXCHANGE01.in
	ternal.sungard.corp>
References: <209D6379477C4E44AC9671354DBD2477021F5297@VOO-EXCHANGE01.internal.sungard.corp>
	<209D6379477C4E44AC9671354DBD2477021F529B@VOO-EXCHANGE01.internal.sungard.corp>
Message-ID: <20080901200149.A8DEB2F431D@www.antlr.org>

At 21:14 1/09/2008, Anand.Vidyasagar at sungard.com wrote:
>In our small language we have a notion that if a line begins with 
>a '*' character on Column 0 we treat it is a line comment.
>However the '*' happens to be the multiplication operator in the 
>language at the same time.
[...]
>LINE_COMMENT
>     : '*' ~('\n'|'\r')* '\r'? ('\n')
>     {
>       if(getCharPositionInLine() == 0){
>             System.out.println("Found Line Comment :" + 
> getLine());
>             $channel=HIDDEN;
>         }
>     }
>     ;

This will match the '*' as a LINE_COMMENT always, but only hide it 
part of the time.  You need to change your recognition around, and 
also provide named tokens for the other variations on the asterisk 
(instead of using parser literals):

fragment STAR: '*';
fragment DBLSTAR: '**';

LINE_COMMENT
   : '*'
     ( { getCharPositionInLine() == 0 }? ~('\n'|'\r')* '\r'? '\n' 
{ $channel=HIDDEN; }
     | '*' { $type = DBLSTAR; }
     | { $type = STAR; }
     )
   ;


From jimi at temporal-wave.com  Mon Sep  1 15:00:25 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 01 Sep 2008 15:00:25 -0700
Subject: [antlr-interest] issue with 3.1 C-target
In-Reply-To: <003601c90afb$3b5f2510$b21d6f30$@com>
References: <003601c90afb$3b5f2510$b21d6f30$@com>
Message-ID: <1220306425.3111.122.camel@jimi>

On Sun, 2008-08-31 at 01:50 +0200, Corno Schraverus wrote:

> Hi All,
> 
> I've just migrated to the latest version of ANTLR (3.1) and I am using the C
> -target.
> The transition was smooth except for 1 minor issue;
> I create tokens with custom code and if I set the text (setText) to an empty
> string, something goes wrong. I get garbage back when I use getText.
> I've looked around a bit and commenting out line 450 of antlr3string.c seems
> to fix the issue;
> 	if	(size <= 0)
> 	{
> 		//return	string;
> 	}
> I don't know if that would break anything else.
> 

It was just that zero length strings were not being terminated with a
'\0'. This is now fixed in the source code - you can get the latest from
Fisheye.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080901/3fd191a2/attachment.html 

From jaluber at gmx.de  Mon Sep  1 15:25:56 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 02 Sep 2008 00:25:56 +0200
Subject: [antlr-interest] C#: Unhandled NoViableAltexception from lexer
In-Reply-To: <000001c90be2$bcb06100$36112300$@com>
References: <000001c90be2$bcb06100$36112300$@com>
Message-ID: <48BC6BF4.8020502@gmx.de>

Shawn Poulson schrieb:
> Hello all,
> 
> I?m struggling with what appears to be an unexpected behavior in my C#
> code.  When I attempt to parse a string with my grammar, it works as
> long as the input is valid to my parser rules.  When the parser bawks at
> the input I get an exception derived from RecognitionException and my
> code can handle invalid input.  When the lexer bawks, I usually get a
> NoViableAltException thrown that I?m also able to handle.
> 
> Except, in a specific case my code is unable to handle a
> NoViableAltException within a try/catch block.  For example, my grammar
> does not utilize semicolons anywhere.  So, if I feed it an input with a
> semi anywhere in the input, the lexer will choke and throw a
> NoViableAltException, as expected.  For some reason, even if my code
> surrounds the ANTLR parser call with a try/catch(Exception) block, the
> program execution halts with an unhandled exception.
> 
> I experienced this with ANTLR 3.0.1, in which case the exception was
> thrown from the lexer?s mTokens() method.  I noticed ANTLR 3.1 was
> released recently, so I gave that a try and used the new CSharp2
> target.  I get the same exact symptom, with the exception being thrown
> from Antlr3.Runtime.DFA.Predict().  In both revisions, I?ve browsed the
> code using .NET Reflector and I don?t see any funny business going on. 
> I don?t see any reason why a try/catch block cannot trap this exception!
> 
> I?m using VS 2008.  I?ve attempted with .NET 2.0 and .NET 3.5 framework
> targets and got the same results.  If necessary, I can send a project
> that replicates this issue.

I'd like to have the files to test this behaviour myself.
> 
> Has anyone experienced this before?  Thanks.

Someone did experience it before, but I don't know if the issue was
solved. Can you try instead

catch (Exception)

only

catch

? That should get any possibly exception. Or it could be a bug in the
.NET runtime. testing on Mono may shed light on this iisue.

Johannes
> 
>  
> 
> Shawn Poulson
> 
> spoulson at explodingcoder.com
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From Anand.Vidyasagar at sungard.com  Mon Sep  1 23:24:57 2008
From: Anand.Vidyasagar at sungard.com (Anand.Vidyasagar at sungard.com)
Date: Tue, 2 Sep 2008 02:24:57 -0400
Subject: [antlr-interest] Lexer Help,
	line-comment begins with a  character that is also an operator
In-Reply-To: <20080901200149.A8DEB2F431D@www.antlr.org>
References: <209D6379477C4E44AC9671354DBD2477021F5297@VOO-EXCHANGE01.internal.sungard.corp><209D6379477C4E44AC9671354DBD2477021F529B@VOO-EXCHANGE01.internal.sungard.corp>
	<20080901200149.A8DEB2F431D@www.antlr.org>
Message-ID: <209D6379477C4E44AC9671354DBD2477021F53B3@VOO-EXCHANGE01.internal.sungard.corp>

Thanks for the help!!

I tried this new definition of LINE_COMMENT, I also changed the
"operator" grammar definition to 
operator
options { k=2;}
      :
              STAR
        |     '/'
        |     '+'
        |     '-'
        |     DBLSTAR
        |     '<<'
        |     '>>'
      ;

And now I get a different kind of exception. 

line 1:1 rule LINE_COMMENT failed predicate: { getCharPositionInLine()
== 0 }?
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space

Regards,

Anand Vidyasagar

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Gavin Lambert
Sent: Tuesday, September 02, 2008 1:32 AM
To: Vidyasagar, Anand; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Lexer Help, line-comment begins with a
character that is also an operator

At 21:14 1/09/2008, Anand.Vidyasagar at sungard.com wrote:
>In our small language we have a notion that if a line begins with 
>a '*' character on Column 0 we treat it is a line comment.
>However the '*' happens to be the multiplication operator in the 
>language at the same time.
[...]
>LINE_COMMENT
>     : '*' ~('\n'|'\r')* '\r'? ('\n')
>     {
>       if(getCharPositionInLine() == 0){
>             System.out.println("Found Line Comment :" + 
> getLine());
>             $channel=HIDDEN;
>         }
>     }
>     ;

This will match the '*' as a LINE_COMMENT always, but only hide it 
part of the time.  You need to change your recognition around, and 
also provide named tokens for the other variations on the asterisk 
(instead of using parser literals):

fragment STAR: '*';
fragment DBLSTAR: '**';

LINE_COMMENT
   : '*'
     ( { getCharPositionInLine() == 0 }? ~('\n'|'\r')* '\r'? '\n' 
{ $channel=HIDDEN; }
     | '*' { $type = DBLSTAR; }
     | { $type = STAR; }
     )
   ;


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess




From fw at deneb.enyo.de  Tue Sep  2 03:54:30 2008
From: fw at deneb.enyo.de (Florian Weimer)
Date: Tue, 02 Sep 2008 12:54:30 +0200
Subject: [antlr-interest] Reporting errors from rules
Message-ID: <87abequ8bd.fsf@mid.deneb.enyo.de>

I'd like to report errors from rules because I want to reuse existing,
non-ANTLR parsers and make the lexer rules a bit more lenient than
what's actually in the language.  For instance, in

IPV4_ADDRESS : ('0' .. '9' | '.')+;

address returns [IPv4Address address]
    : IPV4_ADDRESS
        {
            try {
                $address = new IPv4Address($IPV4_ADDRESS.text);
            } catch (IllegalArgumentException e) {
                ???
            }
        };

I want to report an error at the location of the IPV4_ADDRESS token if
the token is not actually an IPv4 address.

Do I have to throw a special exception to achieve this?

From antlr-interest at schraverus.com  Tue Sep  2 06:45:29 2008
From: antlr-interest at schraverus.com (Corno Schraverus)
Date: Tue, 2 Sep 2008 15:45:29 +0200
Subject: [antlr-interest] 3.1 C - target and error recovery
Message-ID: <007901c90d02$2a5f3cb0$7f1db610$@com>

Hi all,

I'm having problems with the error recovery in the C target. When a syntax
error is found, an error message is printed to the console, the rule is
exited and then later on the compiler crashes during the evaluation of
another rule.
I have no clue on how to debug this. Can anyone give me some pointers on how
I could find the cause?

The tokens are custom made, maybe that could be the cause but I can't see
how the parser could work fine if there are no syntax errors, and even if
there are, it is still able to print the error info but crash later on.

greetings,

Corno




From jimi at temporal-wave.com  Tue Sep  2 07:35:22 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 02 Sep 2008 07:35:22 -0700
Subject: [antlr-interest] Lexer Help,
	line-comment begins with a 	character that is also an operator
In-Reply-To: <209D6379477C4E44AC9671354DBD2477021F53B3@VOO-EXCHANGE01.internal.sungard.corp>
References: <209D6379477C4E44AC9671354DBD2477021F5297@VOO-EXCHANGE01.internal.sungard.corp>
	<209D6379477C4E44AC9671354DBD2477021F529B@VOO-EXCHANGE01.internal.sungard.corp>
	<20080901200149.A8DEB2F431D@www.antlr.org>
	<209D6379477C4E44AC9671354DBD2477021F53B3@VOO-EXCHANGE01.internal.sungard.corp>
Message-ID: <1220366122.7778.1.camel@jimi>

On Tue, 2008-09-02 at 02:24 -0400, Anand.Vidyasagar at sungard.com wrote:

> Thanks for the help!!
> 
> I tried this new definition of LINE_COMMENT, I also changed the
> "operator" grammar definition to 
> operator
> options { k=2;}
>       :
>               STAR
>         |     '/'
>         |     '+'
>         |     '-'
>         |     DBLSTAR
>         |     '<<'
>         |     '>>'
>       ;
> 
> And now I get a different kind of exception. 
> 
> line 1:1 rule LINE_COMMENT failed predicate: { getCharPositionInLine()
> == 0 }?


You probably want a gated predicate here, not a simple semantic
predicate.

{ getCharPositionInLine() == 0 }?=> X Y Z....

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080902/318e4fe4/attachment.html 

From antlrinterest at gmail.com  Tue Sep  2 07:41:01 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Tue, 2 Sep 2008 16:41:01 +0200
Subject: [antlr-interest] Specifying only part of the grammatical structure
	of an input file
Message-ID: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>

Hi,

I want to parse a part of an HTML file in order to extract
information. Take a look at my input file for example:

<html>
<head>...</head>
<body>
<all><sorts><of><crazy><tags><and><pcdata>

	<tr>
		<td>Terence Parr</td>
		<td>Knows ANTLR really well!</td>
	</tr>
	<tr>
		<td>Bill Mayfield</td>
		<td>Doesn't know ANTLR!</td>
	</tr>


<all><sorts><of><crazy><tags><and><pcdata>
</body>
</html>


So I'm only interested in recognizing the individual <tr></tr> rows in
order to extract the <td> labels. I've writting something that is
loosly based on
this article -> http://www.antlr.org/wiki/display/ANTLR3/Parsing+XML


Can you tell me how I can make my parser ignore all the crazy tags and
pcdata before the pattern I would like to recognize? This is my
grammar and it's giving me this error: (201) The following
alternatives can never be matched: 1



grammar XMLParser;

@lexer::members {
    Boolean tagMode = false;
}



document	: 	.* pattern .* ;

pattern		:	(otr PCDATA?
					otd PCDATA?
						person=PCDATA
					ctd PCDATA?
					
					otd PCDATA?
						comment=PCDATA
					ctd PCDATA?
				ctr PCDATA?)* ;
		
	
/* BEGIN: specific tags */
otr			:	TAG_START_OPEN TR (attribute)* TAG_CLOSE;
ctr			:	TAG_END_OPEN TR (attribute)* TAG_CLOSE;
otd			:	TAG_START_OPEN TD (attribute)* TAG_CLOSE;
ctd			:	TAG_END_OPEN TD (attribute)* TAG_CLOSE;
einput		:	TAG_START_OPEN INPUT (attribute)* TAG_CLOSE;
oa			:	TAG_START_OPEN A (attribute)* TAG_CLOSE;
ca			:	TAG_END_OPEN A (attribute)* TAG_CLOSE;
/* END: specific tags */

startTag	:	TAG_START_OPEN GENERIC_ID (attribute)* TAG_CLOSE ;
endTag		:	TAG_END_OPEN GENERIC_ID TAG_CLOSE ;
emptyElement:	TAG_START_OPEN GENERIC_ID  (attribute)* TAG_EMPTY_CLOSE ;
attribute	:	GENERIC_ID ATTR_EQ ATTR_VALUE ;



/*
  LEXER RULES
*/

TAG_START_OPEN 	:	'<' { tagMode = true; } ;
	
TAG_END_OPEN	:	'</' { tagMode = true; } ;
	
TAG_CLOSE		:	{ tagMode }? => '>' { tagMode = false; } ;
	
TAG_EMPTY_CLOSE	:	{ tagMode }?	=> '/>' { tagMode = false; } ;

ATTR_EQ			:	{ tagMode }? => '=' ;

ATTR_VALUE		:	{ tagMode }? =>	( '"' (~'"')* '"' | '\'' (~'\'')* '\'' ) ;

PCDATA			:	{ !tagMode }? => (~'<')+ ;
	
/* BEGIN: specific tags */
TR				:	{ tagMode }? => 'tr';
TD 				:	{ tagMode }? => 'td';
INPUT			:	{ tagMode }? => 'input';
A				:	{ tagMode }? => 'a';
/* END: Specific tags */

GENERIC_ID    	: 	{ tagMode }? => ( LETTER | '_' | ':') (NAMECHAR)* ;

fragment NAMECHAR:	 LETTER | DIGIT | '.' | '-' | '_' | ':' ;

fragment DIGIT	:    	'0'..'9' ;

fragment LETTER	:	'a'..'z' | 'A'..'Z' ;

WS				:	{ tagMode }? => (' '|'\r'|'\t'|'\u000C'|'\n') { $channel=99;}	;

From jimi at temporal-wave.com  Tue Sep  2 07:49:51 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 02 Sep 2008 07:49:51 -0700
Subject: [antlr-interest] 3.1 C - target and error recovery
In-Reply-To: <007901c90d02$2a5f3cb0$7f1db610$@com>
References: <007901c90d02$2a5f3cb0$7f1db610$@com>
Message-ID: <1220366991.7778.8.camel@jimi>

On Tue, 2008-09-02 at 15:45 +0200, Corno Schraverus wrote:

> Hi all,
> 
> I'm having problems with the error recovery in the C target. When a syntax
> error is found, an error message is printed to the console, the rule is
> exited and then later on the compiler crashes during the evaluation of
> another rule.
> I have no clue on how to debug this. Can anyone give me some pointers on how
> I could find the cause?


Compile your programs, and the C runtime with debug information built
in. IF you look at the ./configure --help output, you will see that it
allows you to include debug information in the code (don't confuse it
with enabling/disabling the ANTLR debugger).

Then run your parser with the valgrind program. 

Also, make sure you get the update I provided yesterday to stop tokens
whose text is an empty "" having no terminator. That might be your
issue.

Jim

> 
> The tokens are custom made, maybe that could be the cause but I can't see
> how the parser could work fine if there are no syntax errors, and even if
> there are, it is still able to print the error info but crash later on.
> 
> greetings,
> 
> Corno
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080902/ff10ee90/attachment.html 

From g.vandeglind at beinformed.nl  Tue Sep  2 07:50:01 2008
From: g.vandeglind at beinformed.nl (Gerard van de Glind)
Date: Tue, 2 Sep 2008 16:50:01 +0200
Subject: [antlr-interest] Specifying only part of the grammatical
 structure	of an input file
In-Reply-To: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>
References: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>
Message-ID: <07DC8905ABA90249A64135D427E2F70F033A8E7502@apbiex01.beinformed.nl>

Hi Bill and all,

I guess you could try the following as the last lexer rule in your grammar:
        IGNORE         : .      {$channel=HIDDEN;};

Regards,

G.J. van de Glind
Software Engineer
Be Informed



Hi,

I want to parse a part of an HTML file in order to extract
information. Take a look at my input file for example:

<html>
<head>...</head>
<body>
<all><sorts><of><crazy><tags><and><pcdata>

        <tr>
                <td>Terence Parr</td>
                <td>Knows ANTLR really well!</td>
        </tr>
        <tr>
                <td>Bill Mayfield</td>
                <td>Doesn't know ANTLR!</td>
        </tr>


<all><sorts><of><crazy><tags><and><pcdata>
</body>
</html>


So I'm only interested in recognizing the individual <tr></tr> rows in
order to extract the <td> labels. I've writting something that is
loosly based on
this article -> http://www.antlr.org/wiki/display/ANTLR3/Parsing+XML


Can you tell me how I can make my parser ignore all the crazy tags and
pcdata before the pattern I would like to recognize? This is my
grammar and it's giving me this error: (201) The following
alternatives can never be matched: 1



grammar XMLParser;

@lexer::members {
    Boolean tagMode = false;
}



document        :       .* pattern .* ;

pattern         :       (otr PCDATA?
                                        otd PCDATA?
                                                person=PCDATA
                                        ctd PCDATA?

                                        otd PCDATA?
                                                comment=PCDATA
                                        ctd PCDATA?
                                ctr PCDATA?)* ;


/* BEGIN: specific tags */
otr                     :       TAG_START_OPEN TR (attribute)* TAG_CLOSE;
ctr                     :       TAG_END_OPEN TR (attribute)* TAG_CLOSE;
otd                     :       TAG_START_OPEN TD (attribute)* TAG_CLOSE;
ctd                     :       TAG_END_OPEN TD (attribute)* TAG_CLOSE;
einput          :       TAG_START_OPEN INPUT (attribute)* TAG_CLOSE;
oa                      :       TAG_START_OPEN A (attribute)* TAG_CLOSE;
ca                      :       TAG_END_OPEN A (attribute)* TAG_CLOSE;
/* END: specific tags */

startTag        :       TAG_START_OPEN GENERIC_ID (attribute)* TAG_CLOSE ;
endTag          :       TAG_END_OPEN GENERIC_ID TAG_CLOSE ;
emptyElement:   TAG_START_OPEN GENERIC_ID  (attribute)* TAG_EMPTY_CLOSE ;
attribute       :       GENERIC_ID ATTR_EQ ATTR_VALUE ;



/*
  LEXER RULES
*/

TAG_START_OPEN  :       '<' { tagMode = true; } ;

TAG_END_OPEN    :       '</' { tagMode = true; } ;

TAG_CLOSE               :       { tagMode }? => '>' { tagMode = false; } ;

TAG_EMPTY_CLOSE :       { tagMode }?    => '/>' { tagMode = false; } ;

ATTR_EQ                 :       { tagMode }? => '=' ;

ATTR_VALUE              :       { tagMode }? => ( '"' (~'"')* '"' | '\'' (~'\'')* '\'' ) ;

PCDATA                  :       { !tagMode }? => (~'<')+ ;

/* BEGIN: specific tags */
TR                              :       { tagMode }? => 'tr';
TD                              :       { tagMode }? => 'td';
INPUT                   :       { tagMode }? => 'input';
A                               :       { tagMode }? => 'a';
/* END: Specific tags */

GENERIC_ID      :       { tagMode }? => ( LETTER | '_' | ':') (NAMECHAR)* ;

fragment NAMECHAR:       LETTER | DIGIT | '.' | '-' | '_' | ':' ;

fragment DIGIT  :       '0'..'9' ;

fragment LETTER :       'a'..'z' | 'A'..'Z' ;

WS                              :       { tagMode }? => (' '|'\r'|'\t'|'\u000C'|'\n') { $channel=99;}   ;

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From antlrinterest at gmail.com  Tue Sep  2 07:51:19 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Tue, 2 Sep 2008 16:51:19 +0200
Subject: [antlr-interest] Specifying only part of the grammatical
	structure of an input file
In-Reply-To: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>
References: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>
Message-ID: <344d61080809020751s447f989ue4ad541e8f74e675@mail.gmail.com>

PS: If I change rule document I get no grammar errors but the tokens
after my pattern are not expected and I get an exception...

document        :       .* pattern .* ;

changed into

document        :       .* pattern ;


Kind regards,
Bill




On Tue, Sep 2, 2008 at 4:41 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
> Hi,
>
> I want to parse a part of an HTML file in order to extract
> information. Take a look at my input file for example:
>
> <html>
> <head>...</head>
> <body>
> <all><sorts><of><crazy><tags><and><pcdata>
>
>        <tr>
>                <td>Terence Parr</td>
>                <td>Knows ANTLR really well!</td>
>        </tr>
>        <tr>
>                <td>Bill Mayfield</td>
>                <td>Doesn't know ANTLR!</td>
>        </tr>
>
>
> <all><sorts><of><crazy><tags><and><pcdata>
> </body>
> </html>
>
>
> So I'm only interested in recognizing the individual <tr></tr> rows in
> order to extract the <td> labels. I've writting something that is
> loosly based on
> this article -> http://www.antlr.org/wiki/display/ANTLR3/Parsing+XML
>
>
> Can you tell me how I can make my parser ignore all the crazy tags and
> pcdata before the pattern I would like to recognize? This is my
> grammar and it's giving me this error: (201) The following
> alternatives can never be matched: 1
>
>
>
> grammar XMLParser;
>
> @lexer::members {
>    Boolean tagMode = false;
> }
>
>
>
> document        :       .* pattern .* ;
>
> pattern         :       (otr PCDATA?
>                                        otd PCDATA?
>                                                person=PCDATA
>                                        ctd PCDATA?
>
>                                        otd PCDATA?
>                                                comment=PCDATA
>                                        ctd PCDATA?
>                                ctr PCDATA?)* ;
>
>
> /* BEGIN: specific tags */
> otr                     :       TAG_START_OPEN TR (attribute)* TAG_CLOSE;
> ctr                     :       TAG_END_OPEN TR (attribute)* TAG_CLOSE;
> otd                     :       TAG_START_OPEN TD (attribute)* TAG_CLOSE;
> ctd                     :       TAG_END_OPEN TD (attribute)* TAG_CLOSE;
> einput          :       TAG_START_OPEN INPUT (attribute)* TAG_CLOSE;
> oa                      :       TAG_START_OPEN A (attribute)* TAG_CLOSE;
> ca                      :       TAG_END_OPEN A (attribute)* TAG_CLOSE;
> /* END: specific tags */
>
> startTag        :       TAG_START_OPEN GENERIC_ID (attribute)* TAG_CLOSE ;
> endTag          :       TAG_END_OPEN GENERIC_ID TAG_CLOSE ;
> emptyElement:   TAG_START_OPEN GENERIC_ID  (attribute)* TAG_EMPTY_CLOSE ;
> attribute       :       GENERIC_ID ATTR_EQ ATTR_VALUE ;
>
>
>
> /*
>  LEXER RULES
> */
>
> TAG_START_OPEN  :       '<' { tagMode = true; } ;
>
> TAG_END_OPEN    :       '</' { tagMode = true; } ;
>
> TAG_CLOSE               :       { tagMode }? => '>' { tagMode = false; } ;
>
> TAG_EMPTY_CLOSE :       { tagMode }?    => '/>' { tagMode = false; } ;
>
> ATTR_EQ                 :       { tagMode }? => '=' ;
>
> ATTR_VALUE              :       { tagMode }? => ( '"' (~'"')* '"' | '\'' (~'\'')* '\'' ) ;
>
> PCDATA                  :       { !tagMode }? => (~'<')+ ;
>
> /* BEGIN: specific tags */
> TR                              :       { tagMode }? => 'tr';
> TD                              :       { tagMode }? => 'td';
> INPUT                   :       { tagMode }? => 'input';
> A                               :       { tagMode }? => 'a';
> /* END: Specific tags */
>
> GENERIC_ID      :       { tagMode }? => ( LETTER | '_' | ':') (NAMECHAR)* ;
>
> fragment NAMECHAR:       LETTER | DIGIT | '.' | '-' | '_' | ':' ;
>
> fragment DIGIT  :       '0'..'9' ;
>
> fragment LETTER :       'a'..'z' | 'A'..'Z' ;
>
> WS                              :       { tagMode }? => (' '|'\r'|'\t'|'\u000C'|'\n') { $channel=99;}   ;
>

From g.vandeglind at beinformed.nl  Tue Sep  2 07:54:30 2008
From: g.vandeglind at beinformed.nl (Gerard van de Glind)
Date: Tue, 2 Sep 2008 16:54:30 +0200
Subject: [antlr-interest] Specifying only part of the
	grammatical	structure of an input file
In-Reply-To: <344d61080809020751s447f989ue4ad541e8f74e675@mail.gmail.com>
References: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>
	<344d61080809020751s447f989ue4ad541e8f74e675@mail.gmail.com>
Message-ID: <07DC8905ABA90249A64135D427E2F70F033A8E7506@apbiex01.beinformed.nl>

Oh yeah,

Change rule document into :
document        :       pattern ;

Try to separate your lexer and grammar rules.
(So, don't do things like .* in a grammar rule.)

Cheers, Gerard

G.J. van de Glind
Software Engineer
Be Informed





PS: If I change rule document I get no grammar errors but the tokens
after my pattern are not expected and I get an exception...

document        :       .* pattern .* ;

changed into

document        :       .* pattern ;


Kind regards,
Bill




On Tue, Sep 2, 2008 at 4:41 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
> Hi,
>
> I want to parse a part of an HTML file in order to extract
> information. Take a look at my input file for example:
>
> <html>
> <head>...</head>
> <body>
> <all><sorts><of><crazy><tags><and><pcdata>
>
>        <tr>
>                <td>Terence Parr</td>
>                <td>Knows ANTLR really well!</td>
>        </tr>
>        <tr>
>                <td>Bill Mayfield</td>
>                <td>Doesn't know ANTLR!</td>
>        </tr>
>
>
> <all><sorts><of><crazy><tags><and><pcdata>
> </body>
> </html>
>
>
> So I'm only interested in recognizing the individual <tr></tr> rows in
> order to extract the <td> labels. I've writting something that is
> loosly based on
> this article -> http://www.antlr.org/wiki/display/ANTLR3/Parsing+XML
>
>
> Can you tell me how I can make my parser ignore all the crazy tags and
> pcdata before the pattern I would like to recognize? This is my
> grammar and it's giving me this error: (201) The following
> alternatives can never be matched: 1
>
>
>
> grammar XMLParser;
>
> @lexer::members {
>    Boolean tagMode = false;
> }
>
>
>
> document        :       .* pattern .* ;
>
> pattern         :       (otr PCDATA?
>                                        otd PCDATA?
>                                                person=PCDATA
>                                        ctd PCDATA?
>
>                                        otd PCDATA?
>                                                comment=PCDATA
>                                        ctd PCDATA?
>                                ctr PCDATA?)* ;
>
>
> /* BEGIN: specific tags */
> otr                     :       TAG_START_OPEN TR (attribute)* TAG_CLOSE;
> ctr                     :       TAG_END_OPEN TR (attribute)* TAG_CLOSE;
> otd                     :       TAG_START_OPEN TD (attribute)* TAG_CLOSE;
> ctd                     :       TAG_END_OPEN TD (attribute)* TAG_CLOSE;
> einput          :       TAG_START_OPEN INPUT (attribute)* TAG_CLOSE;
> oa                      :       TAG_START_OPEN A (attribute)* TAG_CLOSE;
> ca                      :       TAG_END_OPEN A (attribute)* TAG_CLOSE;
> /* END: specific tags */
>
> startTag        :       TAG_START_OPEN GENERIC_ID (attribute)* TAG_CLOSE ;
> endTag          :       TAG_END_OPEN GENERIC_ID TAG_CLOSE ;
> emptyElement:   TAG_START_OPEN GENERIC_ID  (attribute)* TAG_EMPTY_CLOSE ;
> attribute       :       GENERIC_ID ATTR_EQ ATTR_VALUE ;
>
>
>
> /*
>  LEXER RULES
> */
>
> TAG_START_OPEN  :       '<' { tagMode = true; } ;
>
> TAG_END_OPEN    :       '</' { tagMode = true; } ;
>
> TAG_CLOSE               :       { tagMode }? => '>' { tagMode = false; } ;
>
> TAG_EMPTY_CLOSE :       { tagMode }?    => '/>' { tagMode = false; } ;
>
> ATTR_EQ                 :       { tagMode }? => '=' ;
>
> ATTR_VALUE              :       { tagMode }? => ( '"' (~'"')* '"' | '\'' (~'\'')* '\'' ) ;
>
> PCDATA                  :       { !tagMode }? => (~'<')+ ;
>
> /* BEGIN: specific tags */
> TR                              :       { tagMode }? => 'tr';
> TD                              :       { tagMode }? => 'td';
> INPUT                   :       { tagMode }? => 'input';
> A                               :       { tagMode }? => 'a';
> /* END: Specific tags */
>
> GENERIC_ID      :       { tagMode }? => ( LETTER | '_' | ':') (NAMECHAR)* ;
>
> fragment NAMECHAR:       LETTER | DIGIT | '.' | '-' | '_' | ':' ;
>
> fragment DIGIT  :       '0'..'9' ;
>
> fragment LETTER :       'a'..'z' | 'A'..'Z' ;
>
> WS                              :       { tagMode }? => (' '|'\r'|'\t'|'\u000C'|'\n') { $channel=99;}   ;
>

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From antlrinterest at gmail.com  Tue Sep  2 08:03:30 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Tue, 2 Sep 2008 17:03:30 +0200
Subject: [antlr-interest] Specifying only part of the grammatical
	structure of an input file
In-Reply-To: <07DC8905ABA90249A64135D427E2F70F033A8E7506@apbiex01.beinformed.nl>
References: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>
	<344d61080809020751s447f989ue4ad541e8f74e675@mail.gmail.com>
	<07DC8905ABA90249A64135D427E2F70F033A8E7506@apbiex01.beinformed.nl>
Message-ID: <344d61080809020803k26295742h682e710b813f65e1@mail.gmail.com>

Hi G.J.,

Thanks for your feedback. I get an UnwantedTokenException and then
some MismatchedTokenExceptins on the 'garbage' that comes before my
pattern if I do what you are saying. The 'garbage' that comes after my
pattern seems to be ignored...

I don't understand how this is a lexical thing though... What I want
to be able to say is:

garbage_tokens     pattern     garbage_tokens

where pattern is a certain well-defined structure in the html. I want
to be able to ignore everything before and after the pattern. Maybe
I'm waisting my time trying to do this with ANTLR?

Thanks for helping though!


Regards,
Bill


On Tue, Sep 2, 2008 at 4:54 PM, Gerard van de Glind
<g.vandeglind at beinformed.nl> wrote:
> Oh yeah,
>
> Change rule document into :
> document        :       pattern ;
>
> Try to separate your lexer and grammar rules.
> (So, don't do things like .* in a grammar rule.)
>
> Cheers, Gerard
>
> G.J. van de Glind
> Software Engineer
> Be Informed
>
>
>
>
>
> PS: If I change rule document I get no grammar errors but the tokens
> after my pattern are not expected and I get an exception...
>
> document        :       .* pattern .* ;
>
> changed into
>
> document        :       .* pattern ;
>
>
> Kind regards,
> Bill
>
>
>
>
> On Tue, Sep 2, 2008 at 4:41 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
>> Hi,
>>
>> I want to parse a part of an HTML file in order to extract
>> information. Take a look at my input file for example:
>>
>> <html>
>> <head>...</head>
>> <body>
>> <all><sorts><of><crazy><tags><and><pcdata>
>>
>>        <tr>
>>                <td>Terence Parr</td>
>>                <td>Knows ANTLR really well!</td>
>>        </tr>
>>        <tr>
>>                <td>Bill Mayfield</td>
>>                <td>Doesn't know ANTLR!</td>
>>        </tr>
>>
>>
>> <all><sorts><of><crazy><tags><and><pcdata>
>> </body>
>> </html>
>>
>>
>> So I'm only interested in recognizing the individual <tr></tr> rows in
>> order to extract the <td> labels. I've writting something that is
>> loosly based on
>> this article -> http://www.antlr.org/wiki/display/ANTLR3/Parsing+XML
>>
>>
>> Can you tell me how I can make my parser ignore all the crazy tags and
>> pcdata before the pattern I would like to recognize? This is my
>> grammar and it's giving me this error: (201) The following
>> alternatives can never be matched: 1
>>
>>
>>
>> grammar XMLParser;
>>
>> @lexer::members {
>>    Boolean tagMode = false;
>> }
>>
>>
>>
>> document        :       .* pattern .* ;
>>
>> pattern         :       (otr PCDATA?
>>                                        otd PCDATA?
>>                                                person=PCDATA
>>                                        ctd PCDATA?
>>
>>                                        otd PCDATA?
>>                                                comment=PCDATA
>>                                        ctd PCDATA?
>>                                ctr PCDATA?)* ;
>>
>>
>> /* BEGIN: specific tags */
>> otr                     :       TAG_START_OPEN TR (attribute)* TAG_CLOSE;
>> ctr                     :       TAG_END_OPEN TR (attribute)* TAG_CLOSE;
>> otd                     :       TAG_START_OPEN TD (attribute)* TAG_CLOSE;
>> ctd                     :       TAG_END_OPEN TD (attribute)* TAG_CLOSE;
>> einput          :       TAG_START_OPEN INPUT (attribute)* TAG_CLOSE;
>> oa                      :       TAG_START_OPEN A (attribute)* TAG_CLOSE;
>> ca                      :       TAG_END_OPEN A (attribute)* TAG_CLOSE;
>> /* END: specific tags */
>>
>> startTag        :       TAG_START_OPEN GENERIC_ID (attribute)* TAG_CLOSE ;
>> endTag          :       TAG_END_OPEN GENERIC_ID TAG_CLOSE ;
>> emptyElement:   TAG_START_OPEN GENERIC_ID  (attribute)* TAG_EMPTY_CLOSE ;
>> attribute       :       GENERIC_ID ATTR_EQ ATTR_VALUE ;
>>
>>
>>
>> /*
>>  LEXER RULES
>> */
>>
>> TAG_START_OPEN  :       '<' { tagMode = true; } ;
>>
>> TAG_END_OPEN    :       '</' { tagMode = true; } ;
>>
>> TAG_CLOSE               :       { tagMode }? => '>' { tagMode = false; } ;
>>
>> TAG_EMPTY_CLOSE :       { tagMode }?    => '/>' { tagMode = false; } ;
>>
>> ATTR_EQ                 :       { tagMode }? => '=' ;
>>
>> ATTR_VALUE              :       { tagMode }? => ( '"' (~'"')* '"' | '\'' (~'\'')* '\'' ) ;
>>
>> PCDATA                  :       { !tagMode }? => (~'<')+ ;
>>
>> /* BEGIN: specific tags */
>> TR                              :       { tagMode }? => 'tr';
>> TD                              :       { tagMode }? => 'td';
>> INPUT                   :       { tagMode }? => 'input';
>> A                               :       { tagMode }? => 'a';
>> /* END: Specific tags */
>>
>> GENERIC_ID      :       { tagMode }? => ( LETTER | '_' | ':') (NAMECHAR)* ;
>>
>> fragment NAMECHAR:       LETTER | DIGIT | '.' | '-' | '_' | ':' ;
>>
>> fragment DIGIT  :       '0'..'9' ;
>>
>> fragment LETTER :       'a'..'z' | 'A'..'Z' ;
>>
>> WS                              :       { tagMode }? => (' '|'\r'|'\t'|'\u000C'|'\n') { $channel=99;}   ;
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From jaluber at gmx.de  Tue Sep  2 08:14:11 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 02 Sep 2008 17:14:11 +0200
Subject: [antlr-interest] Specifying only part of the
 grammatical	structure of an input file
In-Reply-To: <344d61080809020803k26295742h682e710b813f65e1@mail.gmail.com>
References: <344d61080809020741k3447ceacg114933080dbcf948@mail.gmail.com>	<344d61080809020751s447f989ue4ad541e8f74e675@mail.gmail.com>	<07DC8905ABA90249A64135D427E2F70F033A8E7506@apbiex01.beinformed.nl>
	<344d61080809020803k26295742h682e710b813f65e1@mail.gmail.com>
Message-ID: <48BD5843.4040102@gmx.de>

Bill Mayfield schrieb:
> Hi G.J.,
> 
> Thanks for your feedback. I get an UnwantedTokenException and then
> some MismatchedTokenExceptins on the 'garbage' that comes before my
> pattern if I do what you are saying. The 'garbage' that comes after my
> pattern seems to be ignored...
> 
> I don't understand how this is a lexical thing though... What I want
> to be able to say is:
> 
> garbage_tokens     pattern     garbage_tokens
> 
> where pattern is a certain well-defined structure in the html. I want
> to be able to ignore everything before and after the pattern. Maybe
> I'm waisting my time trying to do this with ANTLR?

You can use a separate lexer in the "filter=true;"-mode (combined
grammars won't work). It ignores anything for which it can't find token
definitions. You can skip at least the tags you are not interested in.

Johannes
> 
> Thanks for helping though!
> 
> 
> Regards,
> Bill
> 
> 
> On Tue, Sep 2, 2008 at 4:54 PM, Gerard van de Glind
> <g.vandeglind at beinformed.nl> wrote:
>> Oh yeah,
>>
>> Change rule document into :
>> document        :       pattern ;
>>
>> Try to separate your lexer and grammar rules.
>> (So, don't do things like .* in a grammar rule.)
>>
>> Cheers, Gerard
>>
>> G.J. van de Glind
>> Software Engineer
>> Be Informed
>>
>>
>>
>>
>>
>> PS: If I change rule document I get no grammar errors but the tokens
>> after my pattern are not expected and I get an exception...
>>
>> document        :       .* pattern .* ;
>>
>> changed into
>>
>> document        :       .* pattern ;
>>
>>
>> Kind regards,
>> Bill
>>
>>
>>
>>
>> On Tue, Sep 2, 2008 at 4:41 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
>>> Hi,
>>>
>>> I want to parse a part of an HTML file in order to extract
>>> information. Take a look at my input file for example:
>>>
>>> <html>
>>> <head>...</head>
>>> <body>
>>> <all><sorts><of><crazy><tags><and><pcdata>
>>>
>>>        <tr>
>>>                <td>Terence Parr</td>
>>>                <td>Knows ANTLR really well!</td>
>>>        </tr>
>>>        <tr>
>>>                <td>Bill Mayfield</td>
>>>                <td>Doesn't know ANTLR!</td>
>>>        </tr>
>>>
>>>
>>> <all><sorts><of><crazy><tags><and><pcdata>
>>> </body>
>>> </html>
>>>
>>>
>>> So I'm only interested in recognizing the individual <tr></tr> rows in
>>> order to extract the <td> labels. I've writting something that is
>>> loosly based on
>>> this article -> http://www.antlr.org/wiki/display/ANTLR3/Parsing+XML
>>>
>>>
>>> Can you tell me how I can make my parser ignore all the crazy tags and
>>> pcdata before the pattern I would like to recognize? This is my
>>> grammar and it's giving me this error: (201) The following
>>> alternatives can never be matched: 1
>>>
>>>
>>>
>>> grammar XMLParser;
>>>
>>> @lexer::members {
>>>    Boolean tagMode = false;
>>> }
>>>
>>>
>>>
>>> document        :       .* pattern .* ;
>>>
>>> pattern         :       (otr PCDATA?
>>>                                        otd PCDATA?
>>>                                                person=PCDATA
>>>                                        ctd PCDATA?
>>>
>>>                                        otd PCDATA?
>>>                                                comment=PCDATA
>>>                                        ctd PCDATA?
>>>                                ctr PCDATA?)* ;
>>>
>>>
>>> /* BEGIN: specific tags */
>>> otr                     :       TAG_START_OPEN TR (attribute)* TAG_CLOSE;
>>> ctr                     :       TAG_END_OPEN TR (attribute)* TAG_CLOSE;
>>> otd                     :       TAG_START_OPEN TD (attribute)* TAG_CLOSE;
>>> ctd                     :       TAG_END_OPEN TD (attribute)* TAG_CLOSE;
>>> einput          :       TAG_START_OPEN INPUT (attribute)* TAG_CLOSE;
>>> oa                      :       TAG_START_OPEN A (attribute)* TAG_CLOSE;
>>> ca                      :       TAG_END_OPEN A (attribute)* TAG_CLOSE;
>>> /* END: specific tags */
>>>
>>> startTag        :       TAG_START_OPEN GENERIC_ID (attribute)* TAG_CLOSE ;
>>> endTag          :       TAG_END_OPEN GENERIC_ID TAG_CLOSE ;
>>> emptyElement:   TAG_START_OPEN GENERIC_ID  (attribute)* TAG_EMPTY_CLOSE ;
>>> attribute       :       GENERIC_ID ATTR_EQ ATTR_VALUE ;
>>>
>>>
>>>
>>> /*
>>>  LEXER RULES
>>> */
>>>
>>> TAG_START_OPEN  :       '<' { tagMode = true; } ;
>>>
>>> TAG_END_OPEN    :       '</' { tagMode = true; } ;
>>>
>>> TAG_CLOSE               :       { tagMode }? => '>' { tagMode = false; } ;
>>>
>>> TAG_EMPTY_CLOSE :       { tagMode }?    => '/>' { tagMode = false; } ;
>>>
>>> ATTR_EQ                 :       { tagMode }? => '=' ;
>>>
>>> ATTR_VALUE              :       { tagMode }? => ( '"' (~'"')* '"' | '\'' (~'\'')* '\'' ) ;
>>>
>>> PCDATA                  :       { !tagMode }? => (~'<')+ ;
>>>
>>> /* BEGIN: specific tags */
>>> TR                              :       { tagMode }? => 'tr';
>>> TD                              :       { tagMode }? => 'td';
>>> INPUT                   :       { tagMode }? => 'input';
>>> A                               :       { tagMode }? => 'a';
>>> /* END: Specific tags */
>>>
>>> GENERIC_ID      :       { tagMode }? => ( LETTER | '_' | ':') (NAMECHAR)* ;
>>>
>>> fragment NAMECHAR:       LETTER | DIGIT | '.' | '-' | '_' | ':' ;
>>>
>>> fragment DIGIT  :       '0'..'9' ;
>>>
>>> fragment LETTER :       'a'..'z' | 'A'..'Z' ;
>>>
>>> WS                              :       { tagMode }? => (' '|'\r'|'\t'|'\u000C'|'\n') { $channel=99;}   ;
>>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From r.a.niemeijer at tue.nl  Tue Sep  2 08:12:37 2008
From: r.a.niemeijer at tue.nl (Niemeijer, R.A.)
Date: Tue, 2 Sep 2008 17:12:37 +0200
Subject: [antlr-interest] Re : Re : How to get a list of all
	validoptions for the next token?
In-Reply-To: <ebc876d70808260631u5999426dx79bd289d1ffda1c0@mail.gmail.com>
References: <459492.52880.qm@web26504.mail.ukl.yahoo.com>
	<A8F615EE446C9B4D837FB67447C0D99702582BB9@EXCHANGE3.campus.tue.nl>
	<FF993752CB890B4EB591BE5450C37BF1013DB98E@navamane001.ad.internal.corp>
	<A8F615EE446C9B4D837FB67447C0D997025D07A2@EXCHANGE3.campus.tue.nl>
	<ebc876d70808260631u5999426dx79bd289d1ffda1c0@mail.gmail.com>
Message-ID: <A8F615EE446C9B4D837FB67447C0D997026648F4@EXCHANGE3.campus.tue.nl>

Hello,

I've given editing the templates a go and it is indeed not as hard as I imagined. However, I have some difficulty getting the data I need.

The only exceptions I've found so far that need to be changed are NoViableAltExceptions, since MismatchedTokenExceptions already have an Expecting variable. NoViableAltExceptions are generated in two places in the codegen template: dfaState and dfaStateSwitch.

As for the one in dfaStateSwitch:
By replacing <description> (which always seems to be empty) with

(from field in GetType().GetFields()
 where field.Name.StartsWith("FOLLOW_" + input.LA(1))
 from bit in ((BitSet)field.GetValue(this)).ToArray()
 select tokenNames[bit].Trim('\'')).Aggregate((t1, t2) => t1 + " " + t2)

I can get a space-separated list of tokens. It is by no means a perfect solution though. Some issues:
- This gets all the tokens that could ever follow the last token, not just the ones in the current rule. Depending on the grammar this may or may not be a problem.
- It only works on non-named tokens (input.LA(1) returns an int). This should be fairly trivial to fix though.
- Throws an error if it can't find any FOLLOW_ variables. Also easily fixed.
- It works in the one test case I tried it with. I'm not guaranteeing it works in others.

This doesn't work in dfaState though, since there input.LA(1) is always -1. What I need (and it would work for dfaStateSwitch as well) is the list of the numbers in the case statements preceding the default/else statement containing the NoViableAltException. The only way to sort of get at this info I've found is the edges parameter that is passed to the two functions, but it contains the entire generated source code for those parts. Using it directly or in quotes results in tons of compile errors.

So my question: is there a way to process the edges variable (say, replacing all the non-numeric characters with spaces) before spitting it out into the generated code or, preferably, is there a way to get the list of numbers used for creating the case statements directly?

Thanks again.

-----Original Message-----
From: Thomas Brandon [mailto:tbrandonau at gmail.com] 
Sent: dinsdag 26 augustus 2008 15:32
To: Niemeijer, R.A.
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Re : Re : How to get a list of all validoptions for the next token?

It isn't especially hard to alter the codegen templates, assuming, I
think correctly in this case, you just need trivial alterations to the
templates and don't need to add extra template parameters which
requires altering the analysis parts of ANTLR which are more
complicated. Though you will need a basic understanding of
stringtemplate syntax, check the wiki.
You could just alter the existing
src/org/antlr/codegen/templates/Java.stg but I think it's better to
create your own target to keep your changes seperate. This requires a
bit of setup but isn't that hard and I think is worthwhile in terms of
easier maintenance and leaving the existing Java target untouched for
testing.
Here I'll create a new target called MyJava. To do this, in the
extracted ANTLR distribution:
1) In the src/org/antlr/codegen folder create a MyJavaTarget,java file
that extends from JavaTarget. You shouldn't need to change this you
just need a copy of the JavaTarget file named after your target, by
extending we avoid duplicating the existing version.
2) Go to the src/org/antlr/codegen/templates folder. Here you will
find the templates for each target, the java target templates live in
the Java subfolder. Create a copy of this folder named after your
target, MyJava here (unfortunately due to the way ANTLR is setup I
don't think you can reference the existing copies so you need to
create a new copy of the files).
3) In the src/org/antlr/codegen/templates/MyJava folder, create a new
file called MyJava.stg with the contents:
group MyJava: Java;
@dfaState.noViableAltException() ::= <<
// My code
>>
4) Modify your grammar to include the option "language=MyJava;" and
regenerate your grammar.

Now, if you look at the generated code where the NoViableAltException
is thrown you should see the "//My code" comment in between the
construction of the exception and throwing it. You can then replace
the comment with any code you need. Due to the noViableAltException
region you can probably get away with not altering the existing
dfaState template without getting too messy, e.g. to use a custom
exception type you could just subclass NoViableAltException and then
replace the existing instance in nvae with an instance of your
exception which will then be thrown, a little messy but probably
better than having to duplicate the existing template to alter it.
Some changes may require you to duplicate and alter the existing
templates if there isn't a region you can override (or, due to a ST
limitation, if there is a region with existing contents you want to
add to you can't reference the contents defined in the parent template
and so must duplicate it).
When doing this I actually create 2 new templates, one that extends
the existing Java template and copies existing contents and adds
regions for the bits I need to change and another that then adds the
new stuff I need into those regions, thus separating the changes from
the simple duplication and making it easier to copy across the changes
from new ANTLR versions. If the added regions are generically useful
there is also the chance that Ter will accept them for addition to the
ANTLR codebase.
For example, say you wanted to alter the actual creation of the
exception instead, I would create JavaMods.stg with:
group JavaMods: Java;

dfaState(k,edges,eotPredictsAlt,description,stateNumber,semPredState) ::= <<
int LA<decisionNumber>_<stateNumber> = input.LA(<k>);<\n>
<edges; separator="\nelse ">
else {
<if(eotPredictsAlt)>
    alt<decisionNumber>=<eotPredictsAlt>;
<else>
    <ruleBacktrackFailure()>
    <@throwNoViableAltException> // <---- ADDED
    NoViableAltException nvae =
        new NoViableAltException("<description>", <decisionNumber>,
<stateNumber>, input);<\n>
    <@noViableAltException()>
    throw nvae;<\n>
    <@end> // <----- ADDED
<endif>
}
>>
where the comments indicate what was added to the dfaState template I
copied from Java.stg.
Then in MyJava.stg you put something like:
group MyJava: JavaMods;
@dfaState.throwNoViableAltException() ::= <<
MyNoViableAltException nvae = ...;
throw nvae;
>>

That's all of the top of my head, so the syntax may be off. As I said
you'll need to familiarise yourself with string template syntax a bit,
but beyond that and figuring out the changes to make to the ANTLR code
it's all pretty straightforward I think.

Tom.
On Fri, Aug 22, 2008 at 8:50 PM, Niemeijer, R.A. <r.a.niemeijer at tue.nl> wrote:
> I'm afraid that unless somebody else offers to help me I'm a bit stuck at the moment. As Kay R?pke said: "right now i don't see any way of getting at the necessary information, without altering the codegen templates.". By now I've more or less learned how to work with Antlr, but I'm afraid hacking the way Antlr itself works is still a bit beyond me. So if anyone wishes to implement this I'd be very grateful, but otherwise I fear I will have to abandon the idea.
>

From tbrandonau at gmail.com  Tue Sep  2 09:48:28 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Wed, 3 Sep 2008 02:48:28 +1000
Subject: [antlr-interest] Re : Re : How to get a list of all
	validoptions for the next token?
In-Reply-To: <A8F615EE446C9B4D837FB67447C0D997026648F4@EXCHANGE3.campus.tue.nl>
References: <459492.52880.qm@web26504.mail.ukl.yahoo.com>
	<A8F615EE446C9B4D837FB67447C0D99702582BB9@EXCHANGE3.campus.tue.nl>
	<FF993752CB890B4EB591BE5450C37BF1013DB98E@navamane001.ad.internal.corp>
	<A8F615EE446C9B4D837FB67447C0D997025D07A2@EXCHANGE3.campus.tue.nl>
	<ebc876d70808260631u5999426dx79bd289d1ffda1c0@mail.gmail.com>
	<A8F615EE446C9B4D837FB67447C0D997026648F4@EXCHANGE3.campus.tue.nl>
Message-ID: <ebc876d70809020948g384f426ev3bc52815b1b41c76@mail.gmail.com>

Can't you reuse the ANTLR routines for this, e.g.
BaseRecognizer.computeContextSensitiveRuleFOLLOW and
BaseRecognizer.computeErrorRecoverySet. Otherwise I think you want to
be operating on the follow set stack maintained by ANTLR
(RecognizerSharedState.following) rather than the static follow set
variables.
Otherwise a few comments based on a quick reading are below.
On Wed, Sep 3, 2008 at 1:12 AM, Niemeijer, R.A. <r.a.niemeijer at tue.nl> wrote:
> Hello,
>
> I've given editing the templates a go and it is indeed not as hard as I imagined. However, I have some difficulty getting the data I need.
>
> The only exceptions I've found so far that need to be changed are NoViableAltExceptions, since MismatchedTokenExceptions already have an Expecting variable. NoViableAltExceptions are generated in two places in the codegen template: dfaState and dfaStateSwitch.
>
> As for the one in dfaStateSwitch:
> By replacing <description> (which always seems to be empty) with
>
> (from field in GetType().GetFields()
>  where field.Name.StartsWith("FOLLOW_" + input.LA(1))
>  from bit in ((BitSet)field.GetValue(this)).ToArray()
>  select tokenNames[bit].Trim('\'')).Aggregate((t1, t2) => t1 + " " + t2)
>
> I can get a space-separated list of tokens. It is by no means a perfect solution though. Some issues:
> - This gets all the tokens that could ever follow the last token, not just the ones in the current rule. Depending on the grammar this may or may not be a problem.
The follow set names contain the rule they apply to, you can filter on that.
> - It only works on non-named tokens (input.LA(1) returns an int). This should be fairly trivial to fix though.
You need to use the token name, not the token type as returned by LA.
Use the tokenNames array from the parser (or reflection if you don't
have access to the parser).
> - Throws an error if it can't find any FOLLOW_ variables. Also easily fixed.
> - It works in the one test case I tried it with. I'm not guaranteeing it works in others.
>
> This doesn't work in dfaState though, since there input.LA(1) is always -1.
LA returning -1 indicates the next token is EOF. Assuming you weren't
at the end of the stream I can't see why this would occur. Also, it
should be LA(<k>) not LA(1). And you should have access to the cached
value via LA<decisionNumber>_<stateNumber>.
>What I need (and it would work for dfaStateSwitch as well) is the list of the numbers in the case statements preceding the default/else statement containing the NoViableAltException. The only way to sort of get at this info I've found is the edges parameter that is passed to the two functions, but it contains the entire generated source code for those parts. Using it directly or in quotes results in tons of compile errors.
>
> So my question: is there a way to process the edges variable (say, replacing all the non-numeric characters with spaces) before spitting it out into the generated code or, preferably, is there a way to get the list of numbers used for creating the case statements directly?
>
> Thanks again.
>

Tom.

From parrt at cs.usfca.edu  Tue Sep  2 11:00:13 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 2 Sep 2008 11:00:13 -0700
Subject: [antlr-interest] Reporting errors from rules
In-Reply-To: <87abequ8bd.fsf@mid.deneb.enyo.de>
References: <87abequ8bd.fsf@mid.deneb.enyo.de>
Message-ID: <C2976D16-11C5-4E68-A549-B5EFD1EE8B44@cs.usfca.edu>


On Sep 2, 2008, at 3:54 AM, Florian Weimer wrote:

> I'd like to report errors from rules because I want to reuse existing,
> non-ANTLR parsers and make the lexer rules a bit more lenient than
> what's actually in the language.  For instance, in
>
> IPV4_ADDRESS : ('0' .. '9' | '.')+;
>
> address returns [IPv4Address address]
>    : IPV4_ADDRESS
>        {
>            try {
>                $address = new IPv4Address($IPV4_ADDRESS.text);
>            } catch (IllegalArgumentException e) {
>                ???
>            }
>        };
>
> I want to report an error at the location of the IPV4_ADDRESS token if
> the token is not actually an IPv4 address.

The problem is that ANTLR Is controlling what tokens are attempted. If  
the input is not consistent with IPV4_ADDRESS, ANTLR will never call  
that rule. Hence you cannot cause an error is there.

Ter

From fw at deneb.enyo.de  Tue Sep  2 11:06:12 2008
From: fw at deneb.enyo.de (Florian Weimer)
Date: Tue, 02 Sep 2008 20:06:12 +0200
Subject: [antlr-interest] Reporting errors from rules
In-Reply-To: <C2976D16-11C5-4E68-A549-B5EFD1EE8B44@cs.usfca.edu> (Terence
	Parr's message of "Tue, 2 Sep 2008 11:00:13 -0700")
References: <87abequ8bd.fsf@mid.deneb.enyo.de>
	<C2976D16-11C5-4E68-A549-B5EFD1EE8B44@cs.usfca.edu>
Message-ID: <87wshujucr.fsf@mid.deneb.enyo.de>

* Terence Parr:

> On Sep 2, 2008, at 3:54 AM, Florian Weimer wrote:
>
>> I'd like to report errors from rules because I want to reuse existing,
>> non-ANTLR parsers and make the lexer rules a bit more lenient than
>> what's actually in the language.  For instance, in
>>
>> IPV4_ADDRESS : ('0' .. '9' | '.')+;
>>
>> address returns [IPv4Address address]
>>    : IPV4_ADDRESS
>>        {
>>            try {
>>                $address = new IPv4Address($IPV4_ADDRESS.text);
>>            } catch (IllegalArgumentException e) {
>>                ???
>>            }
>>        };
>>
>> I want to report an error at the location of the IPV4_ADDRESS token if
>> the token is not actually an IPv4 address.
>
> The problem is that ANTLR Is controlling what tokens are attempted. If
> the input is not consistent with IPV4_ADDRESS, ANTLR will never call
> that rule. Hence you cannot cause an error is there.

Sorry, I don't follow.  IPV4_ADDRESS matches "1....2", but the
IPv4Address constructor throws an exception for that.  I want to turn it
into something which is reported through the regular framework.

From gune.harshada at gmail.com  Tue Sep  2 11:16:49 2008
From: gune.harshada at gmail.com (harshada gune)
Date: Tue, 2 Sep 2008 23:46:49 +0530
Subject: [antlr-interest] how to exit when first error is encountered?
In-Reply-To: <1219936091.15169.433.camel@jimi>
References: <996c7a8a0808280048y6ae9576bvf3b7cb6d2c73ef1f@mail.gmail.com>
	<1219936091.15169.433.camel@jimi>
Message-ID: <996c7a8a0809021116h11cc14d0j8c11e18c45e189@mail.gmail.com>

Sorry, but I could not get the exact answer. I tried some techniques that
are mentioned, but still unable to exit on the first error. Can someone
specify the exact solution?

Thanks and regards,
Harshada.

On Thu, Aug 28, 2008 at 8:38 PM, Jim Idle <jimi at temporal-wave.com> wrote:

>  On Thu, 2008-08-28 at 13:18 +0530, harshada gune wrote:
>
> When I tried some erroneous input for some grammar that I have written, it
> is generating some error.(That is fine!!). But is there any way such that
> parser should exit (with error flashed)as soon as it sees the first error
> instead of evaluating next grammar rules?
>
>
> http://markmail.org/search/list:antlr?q=exit+first+error
>
>
>  List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080902/bb248360/attachment.html 

From tbrandonau at gmail.com  Tue Sep  2 11:35:32 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Wed, 3 Sep 2008 04:35:32 +1000
Subject: [antlr-interest] Reporting errors from rules
In-Reply-To: <87abequ8bd.fsf@mid.deneb.enyo.de>
References: <87abequ8bd.fsf@mid.deneb.enyo.de>
Message-ID: <ebc876d70809021135x4879befes2ae0f2ab598f44b5@mail.gmail.com>

On Tue, Sep 2, 2008 at 8:54 PM, Florian Weimer <fw at deneb.enyo.de> wrote:
> I'd like to report errors from rules because I want to reuse existing,
> non-ANTLR parsers and make the lexer rules a bit more lenient than
> what's actually in the language.  For instance, in
>
> IPV4_ADDRESS : ('0' .. '9' | '.')+;
>
> address returns [IPv4Address address]
>    : IPV4_ADDRESS
>        {
>            try {
>                $address = new IPv4Address($IPV4_ADDRESS.text);
>            } catch (IllegalArgumentException e) {
>                ???
>            }
>        };
>
> I want to report an error at the location of the IPV4_ADDRESS token if
> the token is not actually an IPv4 address.
>
> Do I have to throw a special exception to achieve this?
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
You can throw a subclass of RecognitionException. Then ANTLR's error
reporting should return it's text or you can override
BaseRecognizer.getErrorMessage to provide text. However you will
likely quickly find ANTLRs error reporting mechanisms to be inadequate
to a final application and add your own that you send ANTLR errors to.
So, it may be best to just send your error straight to your own error
handling facilities and save sending it through ANTLRs error reporting
mechanisms only to send it onto your own.

Tom.

From fw at deneb.enyo.de  Tue Sep  2 11:41:42 2008
From: fw at deneb.enyo.de (Florian Weimer)
Date: Tue, 02 Sep 2008 20:41:42 +0200
Subject: [antlr-interest] Reporting errors from rules
In-Reply-To: <ebc876d70809021135x4879befes2ae0f2ab598f44b5@mail.gmail.com>
	(Thomas Brandon's message of "Wed, 3 Sep 2008 04:35:32 +1000")
References: <87abequ8bd.fsf@mid.deneb.enyo.de>
	<ebc876d70809021135x4879befes2ae0f2ab598f44b5@mail.gmail.com>
Message-ID: <87vdxegzkp.fsf@mid.deneb.enyo.de>

* Thomas Brandon:

> So, it may be best to just send your error straight to your own error
> handling facilities and save sending it through ANTLRs error reporting
> mechanisms only to send it onto your own.

Ah, I see.  Thanks for this suggestion.

From ewbank at gmail.com  Tue Sep  2 13:47:27 2008
From: ewbank at gmail.com (Bryan Ewbank)
Date: Tue, 2 Sep 2008 16:47:27 -0400
Subject: [antlr-interest] Upgrading ANTLR (v2 -> v3)
Message-ID: <dd3a065f0809021347o48f37c27r697dd924441caca7@mail.gmail.com>

Hi Folks,

I've been dormant on this list for a while due to "the rest of the project"
after developing the language components w/ ANTLR v2.7x, and I see that
things have changed a wee bit :-)

Is there any way to swag an estimate for v2 --> v3 conversion of an existing
ANTLR pipeline targetting C++ code?  I could just say "two months", but that
is usually wrong.

Any information/guidance/etc would help.

Thanks,
--Bryan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080902/956b19fe/attachment.html 

From antlr at mirality.co.nz  Tue Sep  2 14:02:00 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 03 Sep 2008 09:02:00 +1200
Subject: [antlr-interest] Upgrading ANTLR (v2 -> v3)
In-Reply-To: <dd3a065f0809021347o48f37c27r697dd924441caca7@mail.gmail.co
 m>
References: <dd3a065f0809021347o48f37c27r697dd924441caca7@mail.gmail.com>
Message-ID: <20080902210215.D47AB11ED43@www.antlr.org>

At 08:47 3/09/2008, Bryan Ewbank wrote:
>Is there any way to swag an estimate for v2 --> v3 conversion of 
>an existing ANTLR pipeline targetting C++ code?  I could just say 
>"two months", but that is usually wrong.

Depends how complicated it is :)

There's a conversion program that will do *most* of the v2->v3 
work, but it doesn't do everything.  So it still helps if you've 
had experience putting together a v3 grammar from scratch, or at 
the very least have read the Book, and so are familiar with the v3 
syntax and design.

Your target language code may also need to be changed.  There is 
no C++ runtime in v3, although you can use the C runtime -- 
naturally, there are some significant differences.  The driver 
code at the very least will need to be significantly altered; it's 
likely you'll need to make some changes to code within the 
grammars as well.

You also really ought to write a metric ton of unit tests for your 
current v2 grammar (assuming you don't already have them).  That 
will help you in determining when you've got the v3 grammar up to 
snuff.


From antlr at jazillian.com  Tue Sep  2 14:05:02 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Tue, 02 Sep 2008 17:05:02 -0400
Subject: [antlr-interest] Parsing Trees & Tree Grammars
In-Reply-To: <130754.78525.qm@web50102.mail.re2.yahoo.com>
References: <130754.78525.qm@web50102.mail.re2.yahoo.com>
Message-ID: <48BDAA7E.6060207@jazillian.com>

Carter Cheng wrote:
> Hi,
> 
> I have been hoping to better understand the theoretical basis for parsing trees and doing tree transformations like what is done with Tree Grammars and Tree Walkers in ANTLRv3. Does anyone have any suggested reading which could be used to better understand the method choices and what is employed in this area?

The term to google is "term rewriting" - you'll find lots of tools and even more theoretical
technical papers on the subject. Here are a couple such tools:

http://www.txl.ca/
http://treedl.sourceforge.net/about.html

...and my entirely non-theoretical two cents on the subject:
http://jazillian.com/articles/treewalkers.html


From greg at smolyn.org  Tue Sep  2 14:51:19 2008
From: greg at smolyn.org (Greg Smolyn)
Date: Tue, 2 Sep 2008 14:51:19 -0700
Subject: [antlr-interest] Stack Overflow for Tree grammar CSharp target
Message-ID: <191731DD-6573-4819-A074-29E4DA51D0DA@smolyn.org>

Hi,

I've got a rather large rule in a tree grammar (using the CSharp2  
target, ANTLR 3.1), that when faced with a large input tree tends to  
blow up with a StackOverflowException.
This happens only with some pretty crazy (but unfortunately required)  
input that forces a very deep recursion.

The rule looks like

expr
   : ^( ASSIGN expr expr )
   | ^(MULT expr expr)
   | ^(AND expr expr)
   | ^(TYPEOF expr)
  ... <snipped about 50 others>...
   ;


This generates an expr() method with quite a few local variables, and  
which can only handle about ~200 recursions  (ie. given a tree like  
"(* (* (* (* (* (* .... (* 2 3) ... 4) 5) 6) 7) 8) 9)").
There seem to be about 3 local variable references for every case,  
which means the thing is putting at least 150 pointers onto the stack  
at every recursive step.
For example:
CommonTree ASSIGN76 = null;
CommonTree MULT79 = null;
...
expr_return expr77 = default(expr_return);
expr_return expr78 = default(expr_return);
...
CommonTree ASSIGN76_tree=null;
CommonTree MULT79_tree=null;

Would this be a bug or future optimization?  Am I going to have to go  
down the path of changing my parser to emit some imaginary AST nodes  
that can group these into smaller categories (ie. additiveExprs,  
etc).  I'd rather not do the latter as it would mean changing a whole  
pile of other tree grammars using the generated ASTs.

Interestingly I see that really none of those variables are actually  
used outside of their respective case statements.  Could not these  
variables be moved there, reducing the load for recursive calls?

Would mucking around in the StringTemplates for the csharp2 target be  
something worth trying?  Or is this something even higher up in the  
antlr AST generation?

Thanks for any insights!

-greg

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080902/9e226a81/attachment.html 

From jaluber at gmx.de  Tue Sep  2 14:58:27 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 02 Sep 2008 23:58:27 +0200
Subject: [antlr-interest] Stack Overflow for Tree grammar CSharp target
In-Reply-To: <191731DD-6573-4819-A074-29E4DA51D0DA@smolyn.org>
References: <191731DD-6573-4819-A074-29E4DA51D0DA@smolyn.org>
Message-ID: <48BDB703.50106@gmx.de>

Greg Smolyn schrieb:
> Hi,
> 
> I've got a rather large rule in a tree grammar (using the CSharp2
> target, ANTLR 3.1), that when faced with a large input tree tends to
> blow up with a StackOverflowException.
> This happens only with some pretty crazy (but unfortunately required)
> input that forces a very deep recursion.
> 
> The rule looks like 
> 
> expr 
>   : ^( ASSIGN expr expr )
>   | ^(MULT expr expr)
>   | ^(AND expr expr)
>   | ^(TYPEOF expr)
>  ... <snipped about 50 others>...
>   ; 
> 
> 
> This generates an expr() method with quite a few local variables, and
> which can only handle about ~200 recursions  (ie. given a tree like "(*
> (* (* (* (* (* .... (* 2 3) ... 4) 5) 6) 7) 8) 9)").
> There seem to be about 3 local variable references for every case, which
> means the thing is putting at least 150 pointers onto the stack at every
> recursive step.  
> For example:
> <http://www.julielist.com/x.xxx?p=54.000.I32p2.1018147.107-102&url=http://www.4realcash.com/affiliates/gallhit/1130677/163/7/2/0>CommonTree
> ASSIGN76 = null;
> CommonTree MULT79 = null;
> ...
> expr_return expr77 = default(expr_return);
> expr_return expr78 = default(expr_return);
> ...
> CommonTree ASSIGN76_tree=null;
> CommonTree MULT79_tree=null;
> 
> Would this be a bug or future optimization?  Am I going to have to go
> down the path of changing my parser to emit some imaginary AST nodes
> that can group these into smaller categories (ie. additiveExprs, etc).
>  I'd rather not do the latter as it would mean changing a whole pile of
> other tree grammars using the generated ASTs. 
> 
> Interestingly I see that really none of those variables are actually
> used outside of their respective case statements.  Could not these
> variables be moved there, reducing the load for recursive calls?
> 
> Would mucking around in the StringTemplates for the csharp2 target be
> something worth trying?  Or is this something even higher up in the
> antlr AST generation?
> 
> Thanks for any insights!
> 
> -greg

Maybe <http://antlr.org/wiki/display/ANTLR3/Operator+precedence+parser>
works here?

Johannes
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From sharwell at pixelminegames.com  Tue Sep  2 15:59:01 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 2 Sep 2008 17:59:01 -0500
Subject: [antlr-interest] Stack Overflow for Tree grammar CSharp target
In-Reply-To: <48BDB703.50106@gmx.de>
References: <191731DD-6573-4819-A074-29E4DA51D0DA@smolyn.org>
	<48BDB703.50106@gmx.de>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E2BE@Bloodymary.ironwillgames.com>

Yikes, you just found a way to crash our product. I must say though, the
input required to do so was absurd! It took some 20 full lines of
3*3*3*3*3*...! LOL

My operator precedence parser is also vulnerable to this, but the tree
grammar will fail much earlier. By replacing the tail recursion in the
precedence tree builder with a hybrid stack/recurse routine, it could
handle very large input expressions. The main problem remains in the
tree grammar. I'll be working on this, but no real answer yet. For now,
I'm modified my expression rule to throw an OperationCanceledException
if the expression stack gets too deep. I catch that exception at a top
level, issue an error/warning, and toss the parse results. The
definition of _expressionDepth is in my separate partial class file.

expression
@init
{
	_expressionDepth++;
	if ( _expressionDepth > 50 )
		throw new OperationCanceledException( "Expression nested
too deeply." );
}
	:	assignExpr // <-- this is actually a giant switch now,
like yours is
	;
finally
{
	_expressionDepth--;
}

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Johannes Luber
Sent: Tuesday, September 02, 2008 4:58 PM
To: Greg Smolyn
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Stack Overflow for Tree grammar CSharp
target

Greg Smolyn schrieb:
> Hi,
> 
> I've got a rather large rule in a tree grammar (using the CSharp2
> target, ANTLR 3.1), that when faced with a large input tree tends to
> blow up with a StackOverflowException.
> This happens only with some pretty crazy (but unfortunately required)
> input that forces a very deep recursion.
> 
> The rule looks like 
> 
> expr 
>   : ^( ASSIGN expr expr )
>   | ^(MULT expr expr)
>   | ^(AND expr expr)
>   | ^(TYPEOF expr)
>  ... <snipped about 50 others>...
>   ; 
> 
> 
> This generates an expr() method with quite a few local variables, and
> which can only handle about ~200 recursions  (ie. given a tree like
"(*
> (* (* (* (* (* .... (* 2 3) ... 4) 5) 6) 7) 8) 9)").
> There seem to be about 3 local variable references for every case,
which
> means the thing is putting at least 150 pointers onto the stack at
every
> recursive step.  
> For example:
>
<http://www.julielist.com/x.xxx?p=54.000.I32p2.1018147.107-102&url=http:
//www.4realcash.com/affiliates/gallhit/1130677/163/7/2/0>CommonTree
> ASSIGN76 = null;
> CommonTree MULT79 = null;
> ...
> expr_return expr77 = default(expr_return);
> expr_return expr78 = default(expr_return);
> ...
> CommonTree ASSIGN76_tree=null;
> CommonTree MULT79_tree=null;
> 
> Would this be a bug or future optimization?  Am I going to have to go
> down the path of changing my parser to emit some imaginary AST nodes
> that can group these into smaller categories (ie. additiveExprs, etc).
>  I'd rather not do the latter as it would mean changing a whole pile
of
> other tree grammars using the generated ASTs. 
> 
> Interestingly I see that really none of those variables are actually
> used outside of their respective case statements.  Could not these
> variables be moved there, reducing the load for recursive calls?
> 
> Would mucking around in the StringTemplates for the csharp2 target be
> something worth trying?  Or is this something even higher up in the
> antlr AST generation?
> 
> Thanks for any insights!
> 
> -greg

Maybe <http://antlr.org/wiki/display/ANTLR3/Operator+precedence+parser>
works here?

Johannes
> 
>
------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess
> 


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess


From iank at bearcave.com  Tue Sep  2 19:28:02 2008
From: iank at bearcave.com (Ian Kaplan)
Date: Tue, 2 Sep 2008 19:28:02 -0700
Subject: [antlr-interest] Upgrading ANTLR (v2 -> v3)
In-Reply-To: <dd3a065f0809021347o48f37c27r697dd924441caca7@mail.gmail.com>
References: <dd3a065f0809021347o48f37c27r697dd924441caca7@mail.gmail.com>
Message-ID: <7f8924df0809021928m4d0cf1dbq94ef5c653b7efd5a@mail.gmail.com>

> Is there any way to swag an estimate for v2 --> v3 conversion of an
> existing ANTLR pipeline targetting C++ code?  I could just say "two months",
> but that is usually wrong.
>

  I agree with Gavin Lambert's comment: it depends (there, see I'm entirely
safe in what I say).

  I have been working on a query language for a graph database (that is, a
database that stores large semantic graphs).  This is not, by the way, the
horrid SPARQL, but a language that has been developed at Lawrence
Livermore.  The ANTLR dot-g file is about 1,500 lines of grammar, comments
and Java code.  The Java code builds objects that mirror the query
language.  The language doesn't need an abstract syntax tree, in my view.

  It took me about three weeks to convert the parser from ANTLR 2.7 to ANTLR
3.1.  Most of this involved rewriting almost all of the Java code associated
with the grammar rules.

  As you may have noted, I whined and bitched about the problems I was
having (suffering in silence has never been one of my virtues).  But there
we two advantages I got from moving to ANTLR 3.1.  Perhaps the major
advantage is that this is where ANTLR development has gone.  So if the
software is to move forward, in the long run there isn't much choice.  The
other advantage was the backtracking parser.  It was great to be able to
just define a language and modify it without worrying about how it could be
expressed in an LL(2) grammar.  As it turned out, there was one part of the
language where ANTLR generated a syntactic predicate.  As far as I can tell,
it doesn't do much back tracking in other parts of the language.

  I did find that that ANTLR web site down played the difficulty of moving
from ANTLR 2.7 to 3.1.  This is because it dealt mainly with the changes in
the grammar.  But ANTLR 3.1 forced me to make a lot of changes in the Java
code associated with the rules.  The ANTLR community is pretty heavily
focused on Java.  So things may be even more difficult in the C/C++ realm,
especially since there is only a C runtime.  If possible it might be worth
considering a Java parser and support code.  I realize that this will not
work if the rest of the code base is C++.  But the performance advantage of
C++ is a lot less than it used to be.

  Ian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080902/3e13c73e/attachment.html 

From greg at smolyn.org  Tue Sep  2 21:38:29 2008
From: greg at smolyn.org (Greg Smolyn)
Date: Tue, 2 Sep 2008 21:38:29 -0700
Subject: [antlr-interest] Stack Overflow for Tree grammar CSharp target
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64E2BE@Bloodymary.ironwillgames.com>
References: <191731DD-6573-4819-A074-29E4DA51D0DA@smolyn.org>
	<48BDB703.50106@gmx.de>
	<86403CA0939415448BCCB83855EFE09A64E2BE@Bloodymary.ironwillgames.com>
Message-ID: <E23B4C59-6CBB-483F-A6DA-0AE7A7BDFBE6@smolyn.org>

Hrm, so I'm not sure if the precedence parser will help me that much  
since, indeed, the problem is actually in a tree grammar.

I managed to reduce the recursive load a bit by factoring it out into  
more simple productions, so I know have:

expr
   :  ^( singleArgTypes expr)
   |  ^( doubleArgTypes expr expr)
   | ^( tripeArgTypes expr expr expr)
  ;

singleArgTypes
   : TYPEOF | NOT | ... etc etc ...
   ;

doubleArgTypes
   : ASSIGN | MULT | AND | ... etc etc ...
   ;

this reduced the number of local pointers quite significantly (3 per  
case in expr, plus some extras, so like 12 or 15).  So now instead of  
blowing up at about 190 nestings, it blows up at about 700.  This is  
enough to get me past my current blockage, but I might plug away at it  
a bit more and see if I can improve that.

-greg


On 2-Sep-08, at 3:59 PM, Sam Harwell wrote:

> Yikes, you just found a way to crash our product. I must say though,  
> the
> input required to do so was absurd! It took some 20 full lines of
> 3*3*3*3*3*...! LOL
>
> My operator precedence parser is also vulnerable to this, but the tree
> grammar will fail much earlier. By replacing the tail recursion in the
> precedence tree builder with a hybrid stack/recurse routine, it could
> handle very large input expressions. The main problem remains in the
> tree grammar. I'll be working on this, but no real answer yet. For  
> now,
> I'm modified my expression rule to throw an OperationCanceledException
> if the expression stack gets too deep. I catch that exception at a top
> level, issue an error/warning, and toss the parse results. The
> definition of _expressionDepth is in my separate partial class file.
>
> expression
> @init
> {
> 	_expressionDepth++;
> 	if ( _expressionDepth > 50 )
> 		throw new OperationCanceledException( "Expression nested
> too deeply." );
> }
> 	:	assignExpr // <-- this is actually a giant switch now,
> like yours is
> 	;
> finally
> {
> 	_expressionDepth--;
> }
>
> Sam
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Johannes Luber
> Sent: Tuesday, September 02, 2008 4:58 PM
> To: Greg Smolyn
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Stack Overflow for Tree grammar CSharp
> target
>
> Greg Smolyn schrieb:
>> Hi,
>>
>> I've got a rather large rule in a tree grammar (using the CSharp2
>> target, ANTLR 3.1), that when faced with a large input tree tends to
>> blow up with a StackOverflowException.
>> This happens only with some pretty crazy (but unfortunately required)
>> input that forces a very deep recursion.
>>
>> The rule looks like
>>
>> expr
>>  : ^( ASSIGN expr expr )
>>  | ^(MULT expr expr)
>>  | ^(AND expr expr)
>>  | ^(TYPEOF expr)
>> ... <snipped about 50 others>...
>>  ;
>>
>>
>> This generates an expr() method with quite a few local variables, and
>> which can only handle about ~200 recursions  (ie. given a tree like
> "(*
>> (* (* (* (* (* .... (* 2 3) ... 4) 5) 6) 7) 8) 9)").
>> There seem to be about 3 local variable references for every case,
> which
>> means the thing is putting at least 150 pointers onto the stack at
> every
>> recursive step.
>> For example:
>>
> <http://www.julielist.com/x.xxx?p=54.000.I32p2.1018147.107-102&url=http 
> :
> //www.4realcash.com/affiliates/gallhit/1130677/163/7/2/0>CommonTree
>> ASSIGN76 = null;
>> CommonTree MULT79 = null;
>> ...
>> expr_return expr77 = default(expr_return);
>> expr_return expr78 = default(expr_return);
>> ...
>> CommonTree ASSIGN76_tree=null;
>> CommonTree MULT79_tree=null;
>>
>> Would this be a bug or future optimization?  Am I going to have to go
>> down the path of changing my parser to emit some imaginary AST nodes
>> that can group these into smaller categories (ie. additiveExprs,  
>> etc).
>> I'd rather not do the latter as it would mean changing a whole pile
> of
>> other tree grammars using the generated ASTs.
>>
>> Interestingly I see that really none of those variables are actually
>> used outside of their respective case statements.  Could not these
>> variables be moved there, reducing the load for recursive calls?
>>
>> Would mucking around in the StringTemplates for the csharp2 target be
>> something worth trying?  Or is this something even higher up in the
>> antlr AST generation?
>>
>> Thanks for any insights!
>>
>> -greg
>
> Maybe <http://antlr.org/wiki/display/ANTLR3/Operator+precedence 
> +parser>
> works here?
>
> Johannes
>>
>>
> ------------------------------------------------------------------------
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
> ess
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
> ess
>


From helene.chagnot at gmail.com  Wed Sep  3 01:03:10 2008
From: helene.chagnot at gmail.com (=?ISO-8859-1?Q?H=E9l=E8ne_Chagnot?=)
Date: Wed, 3 Sep 2008 10:03:10 +0200
Subject: [antlr-interest] Antlr and autocompletion
Message-ID: <216df3580809030103p17cbb554ra9d874186586e16e@mail.gmail.com>

Hi,

I read (
http://groups.google.com/group/il-antlr-interest/browse_thread/thread/7c6d05a35046854d)
that autocompletion may be possible with Antlr 3.2. This will be useful for
our current project.

Do you have any idea when this will be released ?

Thanks,
Helene
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/a013d375/attachment.html 

From mail at martin-probst.com  Wed Sep  3 01:04:22 2008
From: mail at martin-probst.com (Martin Probst)
Date: Wed, 3 Sep 2008 10:04:22 +0200
Subject: [antlr-interest] Stack Overflow for Tree grammar CSharp target
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64E2BE@Bloodymary.ironwillgames.com>
References: <191731DD-6573-4819-A074-29E4DA51D0DA@smolyn.org>
	<48BDB703.50106@gmx.de>
	<86403CA0939415448BCCB83855EFE09A64E2BE@Bloodymary.ironwillgames.com>
Message-ID: <9B9D21B8-BA90-4A31-BFC1-3DBA8B51343B@martin-probst.com>

Hi,

> 	if ( _expressionDepth > 50 )
> 		throw new OperationCanceledException( "Expression nested
> too deeply." );


If you're using a VM language (C#?), why don't you simply catch the  
StackOverflowException outside of your parsing code, in the driver?

That way, you only signal an error when it's really needed, and people  
can fix the issue by increasing the stack size.

Regards,
/Martin

From mail at martin-probst.com  Wed Sep  3 01:07:17 2008
From: mail at martin-probst.com (Martin Probst)
Date: Wed, 3 Sep 2008 10:07:17 +0200
Subject: [antlr-interest] Stack Overflow for Tree grammar CSharp target
In-Reply-To: <E23B4C59-6CBB-483F-A6DA-0AE7A7BDFBE6@smolyn.org>
References: <191731DD-6573-4819-A074-29E4DA51D0DA@smolyn.org>
	<48BDB703.50106@gmx.de>
	<86403CA0939415448BCCB83855EFE09A64E2BE@Bloodymary.ironwillgames.com>
	<E23B4C59-6CBB-483F-A6DA-0AE7A7BDFBE6@smolyn.org>
Message-ID: <4181EF7C-CFDE-47FA-A322-9F67AC5AA23F@martin-probst.com>

> I managed to reduce the recursive load a bit by factoring it out into
> more simple productions, so I know have:

At least in Java, you can set the stack size using something like:  
java -Xss1M, so with altering your grammar plus a larger stack size,  
your solution might work.

As C# is a rather complete copy of Java, that should be possible in  
the CLR, too, no? ;-)

Regards,
/Martin

From antlrinterest at gmail.com  Wed Sep  3 02:13:58 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Wed, 3 Sep 2008 11:13:58 +0200
Subject: [antlr-interest] Simple question, Hard answer?
Message-ID: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>

Hi,

Suppose I want to recognize each pattern 'okko' in a random string of
characters. Some examples:

aaaaaoookoooookkooooaaa -> should yield one match of 'okko'
aaaokkookko -> should yield two matches of 'okko'



Here is a grammar that won't work ;o)

grammar test;

start	:	.* pattern .*;

pattern	:	T1 T2 T2 T1;


T1	:	'o';
T2	: 	'k';



No matter what grammar I try. I can't get it to work... how hard can it be?


Thanks for any input you may provide,
Bill

From tbrandonau at gmail.com  Wed Sep  3 02:23:47 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Wed, 3 Sep 2008 19:23:47 +1000
Subject: [antlr-interest] Simple question, Hard answer?
In-Reply-To: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
Message-ID: <ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>

On Wed, Sep 3, 2008 at 7:13 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
> Hi,
>
> Suppose I want to recognize each pattern 'okko' in a random string of
> characters. Some examples:
>
> aaaaaoookoooookkooooaaa -> should yield one match of 'okko'
> aaaokkookko -> should yield two matches of 'okko'
>
>
>
> Here is a grammar that won't work ;o)
>
> grammar test;
>
> start   :       .* pattern .*;
>
> pattern :       T1 T2 T2 T1;
>
>
> T1      :       'o';
> T2      :       'k';
>
Wildcards in parser rules match any token, not any character. As your
lexer only matches 'o'|'k' anything else will cause a lexer error. Try
adding a lexer rule to match any other input after your other lexer
rules, like:
OTHER: .;
Or you may want to look at filtering lexers as they may be better
suited to your task.

Tom.
>
> No matter what grammar I try. I can't get it to work... how hard can it be?
>
>
> Thanks for any input you may provide,
> Bill
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From antlrinterest at gmail.com  Wed Sep  3 02:36:05 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Wed, 3 Sep 2008 11:36:05 +0200
Subject: [antlr-interest] Fwd:  Simple question, Hard answer?
In-Reply-To: <344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
Message-ID: <344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>

Okay... but what if this isn't a lexer problem? Suppose I my input is
only made up of 'o' and 'k'

oooookooookkooo -> 1 match
oookkoooookkoook -> 2 matches

what would my grammar look like?

grammar test;

start   :       chaos* pattern* chaos*;

pattern :       T1 T2 T2 T1;

chaos   :       T1 | T2;

T1      :       'o';
T2      :       'k';


This one compains that it can match multiple alternatives. I don't
understand since I read it like: match any iteration of T1 or T2
tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2
tokens....


Thanks again :o)


Kind regards,
Bill



On Wed, Sep 3, 2008 at 11:23 AM, Thomas Brandon <tbrandonau at gmail.com> wrote:
> On Wed, Sep 3, 2008 at 7:13 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
>> Hi,
>>
>> Suppose I want to recognize each pattern 'okko' in a random string of
>> characters. Some examples:
>>
>> aaaaaoookoooookkooooaaa -> should yield one match of 'okko'
>> aaaokkookko -> should yield two matches of 'okko'
>>
>>
>>
>> Here is a grammar that won't work ;o)
>>
>> grammar test;
>>
>> start   :       .* pattern .*;
>>
>> pattern :       T1 T2 T2 T1;
>>
>>
>> T1      :       'o';
>> T2      :       'k';
>>
> Wildcards in parser rules match any token, not any character. As your
> lexer only matches 'o'|'k' anything else will cause a lexer error. Try
> adding a lexer rule to match any other input after your other lexer
> rules, like:
> OTHER: .;
> Or you may want to look at filtering lexers as they may be better
> suited to your task.
>
> Tom.
>>
>> No matter what grammar I try. I can't get it to work... how hard can it be?
>>
>>
>> Thanks for any input you may provide,
>> Bill
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>

From liehannl at gmail.com  Wed Sep  3 02:56:03 2008
From: liehannl at gmail.com (Liehann Loots)
Date: Wed, 3 Sep 2008 11:56:03 +0200
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
Message-ID: <6c447dbc0809030256l49f588e7h56e260dd76799316@mail.gmail.com>

What happens if you try something like

start: either*
either: pattern | chaos

The rest would be the same as your example.

 - Liehann

On Wed, Sep 3, 2008 at 11:36 AM, Bill Mayfield <antlrinterest at gmail.com> wrote:
> Okay... but what if this isn't a lexer problem? Suppose I my input is
> only made up of 'o' and 'k'
>
> oooookooookkooo -> 1 match
> oookkoooookkoook -> 2 matches
>
> what would my grammar look like?
>
> grammar test;
>
> start   :       chaos* pattern* chaos*;
>
> pattern :       T1 T2 T2 T1;
>
> chaos   :       T1 | T2;
>
> T1      :       'o';
> T2      :       'k';
>
>
> This one compains that it can match multiple alternatives. I don't
> understand since I read it like: match any iteration of T1 or T2
> tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2
> tokens....
>
>
> Thanks again :o)
>
>
> Kind regards,
> Bill
>
>
>
> On Wed, Sep 3, 2008 at 11:23 AM, Thomas Brandon <tbrandonau at gmail.com> wrote:
>> On Wed, Sep 3, 2008 at 7:13 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
>>> Hi,
>>>
>>> Suppose I want to recognize each pattern 'okko' in a random string of
>>> characters. Some examples:
>>>
>>> aaaaaoookoooookkooooaaa -> should yield one match of 'okko'
>>> aaaokkookko -> should yield two matches of 'okko'
>>>
>>>
>>>
>>> Here is a grammar that won't work ;o)
>>>
>>> grammar test;
>>>
>>> start   :       .* pattern .*;
>>>
>>> pattern :       T1 T2 T2 T1;
>>>
>>>
>>> T1      :       'o';
>>> T2      :       'k';
>>>
>> Wildcards in parser rules match any token, not any character. As your
>> lexer only matches 'o'|'k' anything else will cause a lexer error. Try
>> adding a lexer rule to match any other input after your other lexer
>> rules, like:
>> OTHER: .;
>> Or you may want to look at filtering lexers as they may be better
>> suited to your task.
>>
>> Tom.
>>>
>>> No matter what grammar I try. I can't get it to work... how hard can it be?
>>>
>>>
>>> Thanks for any input you may provide,
>>> Bill
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From mattpalms at gmail.com  Wed Sep  3 02:59:53 2008
From: mattpalms at gmail.com (Matt Palmer)
Date: Wed, 3 Sep 2008 10:59:53 +0100
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
Message-ID: <36c8729e0809030259t7745d6cfi637b4e6fd01b345b@mail.gmail.com>

I am not an expert - and I don't have a solution -  but chaos* will match
any sequence of T1 or T2, so it will consume all the tokens.  You'll never
get to match pattern.

Regards,

Matt Palmer.

On Wed, Sep 3, 2008 at 10:36 AM, Bill Mayfield <antlrinterest at gmail.com>wrote:

> Okay... but what if this isn't a lexer problem? Suppose I my input is
> only made up of 'o' and 'k'
>
> oooookooookkooo -> 1 match
> oookkoooookkoook -> 2 matches
>
> what would my grammar look like?
>
> grammar test;
>
> start   :       chaos* pattern* chaos*;
>
> pattern :       T1 T2 T2 T1;
>
> chaos   :       T1 | T2;
>
> T1      :       'o';
> T2      :       'k';
>
>
> This one compains that it can match multiple alternatives. I don't
> understand since I read it like: match any iteration of T1 or T2
> tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2
> tokens....
>
>
> Thanks again :o)
>
>
> Kind regards,
> Bill
>
>
>
> On Wed, Sep 3, 2008 at 11:23 AM, Thomas Brandon <tbrandonau at gmail.com>
> wrote:
> > On Wed, Sep 3, 2008 at 7:13 PM, Bill Mayfield <antlrinterest at gmail.com>
> wrote:
> >> Hi,
> >>
> >> Suppose I want to recognize each pattern 'okko' in a random string of
> >> characters. Some examples:
> >>
> >> aaaaaoookoooookkooooaaa -> should yield one match of 'okko'
> >> aaaokkookko -> should yield two matches of 'okko'
> >>
> >>
> >>
> >> Here is a grammar that won't work ;o)
> >>
> >> grammar test;
> >>
> >> start   :       .* pattern .*;
> >>
> >> pattern :       T1 T2 T2 T1;
> >>
> >>
> >> T1      :       'o';
> >> T2      :       'k';
> >>
> > Wildcards in parser rules match any token, not any character. As your
> > lexer only matches 'o'|'k' anything else will cause a lexer error. Try
> > adding a lexer rule to match any other input after your other lexer
> > rules, like:
> > OTHER: .;
> > Or you may want to look at filtering lexers as they may be better
> > suited to your task.
> >
> > Tom.
> >>
> >> No matter what grammar I try. I can't get it to work... how hard can it
> be?
> >>
> >>
> >> Thanks for any input you may provide,
> >> Bill
> >>
> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >>
> >>
> >
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/f6e9b9b3/attachment.html 

From antlrinterest at gmail.com  Wed Sep  3 03:19:49 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Wed, 3 Sep 2008 12:19:49 +0200
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <36c8729e0809030259t7745d6cfi637b4e6fd01b345b@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
	<36c8729e0809030259t7745d6cfi637b4e6fd01b345b@mail.gmail.com>
Message-ID: <344d61080809030319t777b8b64y8808b0343591e0fe@mail.gmail.com>

So it is impossible to have a ANTLR match only a part of the input and
ignore the rest?

Regards,
Bill


On Wed, Sep 3, 2008 at 11:59 AM, Matt Palmer <mattpalms at gmail.com> wrote:
> I am not an expert - and I don't have a solution -  but chaos* will match
> any sequence of T1 or T2, so it will consume all the tokens.  You'll never
> get to match pattern.
>
> Regards,
>
> Matt Palmer.
>
> On Wed, Sep 3, 2008 at 10:36 AM, Bill Mayfield <antlrinterest at gmail.com>
> wrote:
>>
>> Okay... but what if this isn't a lexer problem? Suppose I my input is
>> only made up of 'o' and 'k'
>>
>> oooookooookkooo -> 1 match
>> oookkoooookkoook -> 2 matches
>>
>> what would my grammar look like?
>>
>> grammar test;
>>
>> start   :       chaos* pattern* chaos*;
>>
>> pattern :       T1 T2 T2 T1;
>>
>> chaos   :       T1 | T2;
>>
>> T1      :       'o';
>> T2      :       'k';
>>
>>
>> This one compains that it can match multiple alternatives. I don't
>> understand since I read it like: match any iteration of T1 or T2
>> tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2
>> tokens....
>>
>>
>> Thanks again :o)
>>
>>
>> Kind regards,
>> Bill
>>
>>
>>
>> On Wed, Sep 3, 2008 at 11:23 AM, Thomas Brandon <tbrandonau at gmail.com>
>> wrote:
>> > On Wed, Sep 3, 2008 at 7:13 PM, Bill Mayfield <antlrinterest at gmail.com>
>> > wrote:
>> >> Hi,
>> >>
>> >> Suppose I want to recognize each pattern 'okko' in a random string of
>> >> characters. Some examples:
>> >>
>> >> aaaaaoookoooookkooooaaa -> should yield one match of 'okko'
>> >> aaaokkookko -> should yield two matches of 'okko'
>> >>
>> >>
>> >>
>> >> Here is a grammar that won't work ;o)
>> >>
>> >> grammar test;
>> >>
>> >> start   :       .* pattern .*;
>> >>
>> >> pattern :       T1 T2 T2 T1;
>> >>
>> >>
>> >> T1      :       'o';
>> >> T2      :       'k';
>> >>
>> > Wildcards in parser rules match any token, not any character. As your
>> > lexer only matches 'o'|'k' anything else will cause a lexer error. Try
>> > adding a lexer rule to match any other input after your other lexer
>> > rules, like:
>> > OTHER: .;
>> > Or you may want to look at filtering lexers as they may be better
>> > suited to your task.
>> >
>> > Tom.
>> >>
>> >> No matter what grammar I try. I can't get it to work... how hard can it
>> >> be?
>> >>
>> >>
>> >> Thanks for any input you may provide,
>> >> Bill
>> >>
>> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> >> Unsubscribe:
>> >> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> >>
>> >>
>> >
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>

From mattpalms at gmail.com  Wed Sep  3 03:27:05 2008
From: mattpalms at gmail.com (Matt Palmer)
Date: Wed, 3 Sep 2008 11:27:05 +0100
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <344d61080809030319t777b8b64y8808b0343591e0fe@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
	<36c8729e0809030259t7745d6cfi637b4e6fd01b345b@mail.gmail.com>
	<344d61080809030319t777b8b64y8808b0343591e0fe@mail.gmail.com>
Message-ID: <36c8729e0809030327s3a16d358y41f6a17d31fce63c@mail.gmail.com>

No, I think you can filter the lexer stream to ignore anything but a pattern
you are interested in.  See the section on filtering at:
http://sds.sourceforge.net/src/antlr/doc/lexer.html

You can also use syntactic predicates, and probably other ways to force
antlr to match or not match sequences of tokens.  Again, I'm no expert, but
I'm pretty sure it's not impossible.

Regards,

MattP.

On Wed, Sep 3, 2008 at 11:19 AM, Bill Mayfield <antlrinterest at gmail.com>wrote:

> So it is impossible to have a ANTLR match only a part of the input and
> ignore the rest?
>
> Regards,
> Bill
>
>
> On Wed, Sep 3, 2008 at 11:59 AM, Matt Palmer <mattpalms at gmail.com> wrote:
> > I am not an expert - and I don't have a solution -  but chaos* will match
> > any sequence of T1 or T2, so it will consume all the tokens.  You'll
> never
> > get to match pattern.
> >
> > Regards,
> >
> > Matt Palmer.
> >
> > On Wed, Sep 3, 2008 at 10:36 AM, Bill Mayfield <antlrinterest at gmail.com>
> > wrote:
> >>
> >> Okay... but what if this isn't a lexer problem? Suppose I my input is
> >> only made up of 'o' and 'k'
> >>
> >> oooookooookkooo -> 1 match
> >> oookkoooookkoook -> 2 matches
> >>
> >> what would my grammar look like?
> >>
> >> grammar test;
> >>
> >> start   :       chaos* pattern* chaos*;
> >>
> >> pattern :       T1 T2 T2 T1;
> >>
> >> chaos   :       T1 | T2;
> >>
> >> T1      :       'o';
> >> T2      :       'k';
> >>
> >>
> >> This one compains that it can match multiple alternatives. I don't
> >> understand since I read it like: match any iteration of T1 or T2
> >> tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2
> >> tokens....
> >>
> >>
> >> Thanks again :o)
> >>
> >>
> >> Kind regards,
> >> Bill
> >>
> >>
> >>
> >> On Wed, Sep 3, 2008 at 11:23 AM, Thomas Brandon <tbrandonau at gmail.com>
> >> wrote:
> >> > On Wed, Sep 3, 2008 at 7:13 PM, Bill Mayfield <
> antlrinterest at gmail.com>
> >> > wrote:
> >> >> Hi,
> >> >>
> >> >> Suppose I want to recognize each pattern 'okko' in a random string of
> >> >> characters. Some examples:
> >> >>
> >> >> aaaaaoookoooookkooooaaa -> should yield one match of 'okko'
> >> >> aaaokkookko -> should yield two matches of 'okko'
> >> >>
> >> >>
> >> >>
> >> >> Here is a grammar that won't work ;o)
> >> >>
> >> >> grammar test;
> >> >>
> >> >> start   :       .* pattern .*;
> >> >>
> >> >> pattern :       T1 T2 T2 T1;
> >> >>
> >> >>
> >> >> T1      :       'o';
> >> >> T2      :       'k';
> >> >>
> >> > Wildcards in parser rules match any token, not any character. As your
> >> > lexer only matches 'o'|'k' anything else will cause a lexer error. Try
> >> > adding a lexer rule to match any other input after your other lexer
> >> > rules, like:
> >> > OTHER: .;
> >> > Or you may want to look at filtering lexers as they may be better
> >> > suited to your task.
> >> >
> >> > Tom.
> >> >>
> >> >> No matter what grammar I try. I can't get it to work... how hard can
> it
> >> >> be?
> >> >>
> >> >>
> >> >> Thanks for any input you may provide,
> >> >> Bill
> >> >>
> >> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >> >> Unsubscribe:
> >> >>
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >> >>
> >> >>
> >> >
> >>
> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >> Unsubscribe:
> >>
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >>
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/8e1caee1/attachment.html 

From Robert.Kausch at ottogroup.com  Wed Sep  3 04:13:38 2008
From: Robert.Kausch at ottogroup.com (Kausch, Robert)
Date: Wed, 3 Sep 2008 13:13:38 +0200
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <344d61080809030319t777b8b64y8808b0343591e0fe@mail.gmail.com>
Message-ID: <5383112D176D2D46B7DF3F287C631C641C5853@ntovmail02.ad.otto.de>

You can ignore tokens by sending them on a different channel. The following grammar ignores everything that is not 'okko' and works for me:

grammar test;

start: (T1)*;

T1:	'okko';
T2:	~(T1) { $channel = HIDDEN; } ;

Regards,
Robert

-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Bill Mayfield
Gesendet: Mittwoch, 3. September 2008 12:20
An: Matt Palmer; antlr-interest at antlr.org
Betreff: Re: [antlr-interest] Fwd: Simple question, Hard answer?


So it is impossible to have a ANTLR match only a part of the input and ignore the rest?

Regards,
Bill


On Wed, Sep 3, 2008 at 11:59 AM, Matt Palmer <mattpalms at gmail.com> wrote:
> I am not an expert - and I don't have a solution -  but chaos* will 
> match any sequence of T1 or T2, so it will consume all the tokens.  
> You'll never get to match pattern.
>
> Regards,
>
> Matt Palmer.
>
> On Wed, Sep 3, 2008 at 10:36 AM, Bill Mayfield 
> <antlrinterest at gmail.com>
> wrote:
>>
>> Okay... but what if this isn't a lexer problem? Suppose I my input is 
>> only made up of 'o' and 'k'
>>
>> oooookooookkooo -> 1 match
>> oookkoooookkoook -> 2 matches
>>
>> what would my grammar look like?
>>
>> grammar test;
>>
>> start   :       chaos* pattern* chaos*;
>>
>> pattern :       T1 T2 T2 T1;
>>
>> chaos   :       T1 | T2;
>>
>> T1      :       'o';
>> T2      :       'k';
>>
>>
>> This one compains that it can match multiple alternatives. I don't 
>> understand since I read it like: match any iteration of T1 or T2 
>> tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2 
>> tokens....
>>
>>
>> Thanks again :o)
>>
>>
>> Kind regards,
>> Bill
>>
>>
>>
>> On Wed, Sep 3, 2008 at 11:23 AM, Thomas Brandon 
>> <tbrandonau at gmail.com>
>> wrote:
>> > On Wed, Sep 3, 2008 at 7:13 PM, Bill Mayfield 
>> > <antlrinterest at gmail.com>
>> > wrote:
>> >> Hi,
>> >>
>> >> Suppose I want to recognize each pattern 'okko' in a random string 
>> >> of characters. Some examples:
>> >>
>> >> aaaaaoookoooookkooooaaa -> should yield one match of 'okko' 
>> >> aaaokkookko -> should yield two matches of 'okko'
>> >>
>> >>
>> >>
>> >> Here is a grammar that won't work ;o)
>> >>
>> >> grammar test;
>> >>
>> >> start   :       .* pattern .*;
>> >>
>> >> pattern :       T1 T2 T2 T1;
>> >>
>> >>
>> >> T1      :       'o';
>> >> T2      :       'k';
>> >>
>> > Wildcards in parser rules match any token, not any character. As 
>> > your lexer only matches 'o'|'k' anything else will cause a lexer 
>> > error. Try adding a lexer rule to match any other input after your 
>> > other lexer rules, like:
>> > OTHER: .;
>> > Or you may want to look at filtering lexers as they may be better 
>> > suited to your task.
>> >
>> > Tom.
>> >>
>> >> No matter what grammar I try. I can't get it to work... how hard 
>> >> can it be?
>> >>
>> >>
>> >> Thanks for any input you may provide,
>> >> Bill
>> >>
>> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> >> Unsubscribe: 
>> >> http://www.antlr.org/mailman/options/antlr-interest/your-emai
>> >> l-address
>> >>
>> >>
>> >
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-a
>> ddress
>>
>
>

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From tbrandonau at gmail.com  Wed Sep  3 05:00:18 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Wed, 3 Sep 2008 22:00:18 +1000
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
Message-ID: <ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com>

On Wed, Sep 3, 2008 at 7:36 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
> Okay... but what if this isn't a lexer problem? Suppose I my input is
> only made up of 'o' and 'k'
>
> oooookooookkooo -> 1 match
> oookkoooookkoook -> 2 matches
>
> what would my grammar look like?
>
> grammar test;
>
> start   :       chaos* pattern* chaos*;
>
> pattern :       T1 T2 T2 T1;
>
> chaos   :       T1 | T2;
>
> T1      :       'o';
> T2      :       'k';
>
>
> This one compains that it can match multiple alternatives.
Posting the actual warning given is generally a good idea.
> I don't understand since I read it like: match any iteration of T1 or T2
> tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2
> tokens....
>
Yes, but assuming you want the T1 T2 T2 T1 to match as a pattern
rather than a sequence of chaos's would lead to problems in other
cases so ANTLR is warning you either could match and thus it will
disable one of the alternates. I think it will automatically choose
pattern rather than chaos in which case you can ignore the warning as
it is doing what you want.

Tom.
>
> Thanks again :o)
>
>
> Kind regards,
> Bill
>

From antlrinterest at gmail.com  Wed Sep  3 05:28:52 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Wed, 3 Sep 2008 14:28:52 +0200
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
	<ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com>
Message-ID: <344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com>

The grammar below (derived from the one suggested by Liehann Loots)
seems to be working. It doesn't do exactly what I originally wanted
(match chaos, followed by pattern, followed by chaos) but it seems to
be working to solve my problem...

grammar test;

start	:	either*;

either	:	pattern | .;

pattern	:	T1 T2 T2 T1;

T1	:	'o';
T2	: 	'k';

----------------------------------------------------------------------------------------------------------------


Thomas: This one doesn't work however


grammar test;

start   :       chaos* pattern* chaos*;

pattern :       T1 T2 T2 T1;

chaos   :       T1 | T2;

T1      :       'o';
T2      :       'k';

It seems to be recognizing only "chaos*" and ignores the "pattern*
chaos*" part. I guess it is logical to keep matching the first loop as
long as possible. But if I change that start rule to:

start   :       chaos+ pattern+ chaos+;

Which states that there should be some chaos, some patterns and again
some chaos, I get an error stating that "The following alternatives
could never be matched: 2" which I don't understand. Or would it stay
in the first chaos+ because the parser keeps believing it sees chaos..


Damn.. it's hard to communicate this by email.


Thanks so far for your input Thomas, Matt, Robert & Liehann! I've
learned something out of this...

Kind regards,
Bill




On Wed, Sep 3, 2008 at 2:00 PM, Thomas Brandon <tbrandonau at gmail.com> wrote:
> On Wed, Sep 3, 2008 at 7:36 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
>> Okay... but what if this isn't a lexer problem? Suppose I my input is
>> only made up of 'o' and 'k'
>>
>> oooookooookkooo -> 1 match
>> oookkoooookkoook -> 2 matches
>>
>> what would my grammar look like?
>>
>> grammar test;
>>
>> start   :       chaos* pattern* chaos*;
>>
>> pattern :       T1 T2 T2 T1;
>>
>> chaos   :       T1 | T2;
>>
>> T1      :       'o';
>> T2      :       'k';
>>
>>
>> This one compains that it can match multiple alternatives.
> Posting the actual warning given is generally a good idea.
>> I don't understand since I read it like: match any iteration of T1 or T2
>> tokens followed by T1 T2 T2 T1 followed by any iteration of T1 or T2
>> tokens....
>>
> Yes, but assuming you want the T1 T2 T2 T1 to match as a pattern
> rather than a sequence of chaos's would lead to problems in other
> cases so ANTLR is warning you either could match and thus it will
> disable one of the alternates. I think it will automatically choose
> pattern rather than chaos in which case you can ignore the warning as
> it is doing what you want.
>
> Tom.
>>
>> Thanks again :o)
>>
>>
>> Kind regards,
>> Bill
>>
>

From tbrandonau at gmail.com  Wed Sep  3 06:08:59 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Wed, 3 Sep 2008 23:08:59 +1000
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
	<ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com>
	<344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com>
Message-ID: <ebc876d70809030608j29b1e6e2n55c7fe8644088533@mail.gmail.com>

On Wed, Sep 3, 2008 at 10:28 PM, Bill Mayfield <antlrinterest at gmail.com> wrote:
>
> Thomas: This one doesn't work however
>
>
> grammar test;
>
> start   :       chaos* pattern* chaos*;
>
> pattern :       T1 T2 T2 T1;
>
> chaos   :       T1 | T2;
>
> T1      :       'o';
> T2      :       'k';
>
> It seems to be recognizing only "chaos*" and ignores the "pattern*
> chaos*" part. I guess it is logical to keep matching the first loop as
> long as possible.
If you check the output of ANTLR you will see:
warning(200): test.g:4:5: Decision can match input such as "T1" using
multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
warning(200): test.g:4:5: Decision can match input such as "T2" using
multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
warning(200): test.g:4:12: Decision can match input such as "T1 T2 T2
T1" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input

The first 2 indicate that given the chaos* decision, either continuing
the chaos* loop (alternative 1) or exiting the loop (alternative 2)
will allow either T1 or T2 to match (T2 matches by skipping the
optional pattern). So ANTLR will disable alternative 2 (exiting the
loop) and will thus keep going until it gets something other than T1
or T2.
The 3rd message is saying that in the pattern loop the sequence T1 T2
T2 T1 can be matched either by continuing the pattern* loop or by
skipping that and going to the chaos*. Here, ANTLR disables the exit
loop alternative and will match a pattern if it can.

> But if I change that start rule to:
>
> start   :       chaos+ pattern+ chaos+;
>
> Which states that there should be some chaos, some patterns and again
> some chaos, I get an error stating that "The following alternatives
> could never be matched: 2" which I don't understand. Or would it stay
> in the first chaos+ because the parser keeps believing it sees chaos..
>
Here ANTLR is talking about the first chaos+ loop and saying that
nothing will let it exit the loop (alternative 2) as the only things
that can legally follow the loop (the T1 to start the required
pattern) is also matched in the loop.

Check out the Syntax Diagram in ANTLRWorks to see what ANTLR is
talking about in ambiguities like these.

You could use predicates to resolve the problem. e.g.
start:	 chaos ((pattern chaos)=>pattern|chaos)* chaos;
will ensure there is a chaos at the start an end, so
"okkooookkoooookkoookko" will match only 2 patterns, the one's at the
start and end not being valid due to no chaos before\after.
Though as I said filtering lexers may be a more appropriate solution
for your real problem.

Tom.
>
> Damn.. it's hard to communicate this by email.
>
>
> Thanks so far for your input Thomas, Matt, Robert & Liehann! I've
> learned something out of this...
>
> Kind regards,
> Bill
>
>
>
>

From r.a.niemeijer at tue.nl  Wed Sep  3 07:13:05 2008
From: r.a.niemeijer at tue.nl (Niemeijer, R.A.)
Date: Wed, 3 Sep 2008 16:13:05 +0200
Subject: [antlr-interest] Re : Re : How to get a list of all
	validoptions for the next token?
In-Reply-To: <ebc876d70809020948g384f426ev3bc52815b1b41c76@mail.gmail.com>
References: <459492.52880.qm@web26504.mail.ukl.yahoo.com>
	<A8F615EE446C9B4D837FB67447C0D99702582BB9@EXCHANGE3.campus.tue.nl>
	<FF993752CB890B4EB591BE5450C37BF1013DB98E@navamane001.ad.internal.corp>
	<A8F615EE446C9B4D837FB67447C0D997025D07A2@EXCHANGE3.campus.tue.nl>
	<ebc876d70808260631u5999426dx79bd289d1ffda1c0@mail.gmail.com>
	<A8F615EE446C9B4D837FB67447C0D997026648F4@EXCHANGE3.campus.tue.nl>
	<ebc876d70809020948g384f426ev3bc52815b1b41c76@mail.gmail.com>
Message-ID: <A8F615EE446C9B4D837FB67447C0D99702664D0B@EXCHANGE3.campus.tue.nl>

Unfortunately that doesn't work. Both computeContextSensitiveRuleFOLLOW
and computeErrorRecoverySet call combineFollows. combineFollows uses
state.following and state.followingStackPointer, which don't contain the
information I need.
Perhaps an example is in order.

One of the possible rules in my system is a definition, which is roughly
comparable to a variable assignment. As a simple example, let's use "h
is its height". The associated text that the parser receives is
":TEXTh:IS:ITS:PROPNheight"

When I parse ":TEXTh" I get a MismatchedTokenException that says it
expects the token ':IS'. No problem there.
When I parse ":TEXTh:IS" I get a NoViableAltException. Let's look at (a
condensed version of) the code just before that:

switch ( input.LA(1) ) 
{
  case 28:
  case 33:
  case 36: { alt3 = 1; } break;
  case 11: { ... } break;
  case 12: { ... } break;
  case 34:
  case 39:
  case 40:
  case 41:
  case 42:
  case 43: { alt3 = 2; } break;
  default:
    NoViableAltException nvaes_d3s0 = new NoViableAltException("", 3, 0,
input);
    throw nvaes_d3s0;
}

Since the input ends, input.LA(1) returns -1, so the switch statement
goes to the default case and throws an error. The numbers in the case
statements (28, 33, 36, etc.) are the tokens that can legally follow the
':IS' token, and hence the ones I would like to put in the description
of the NoViableAltException so I can present these options to the user.
This information cannot be found in the following bitset, as
followingStackPointer is 0 and following[0] is an empty bitset (none of
the other entries in following have anything approaching the correct
sequence either).

Today I managed to produce the following code that seems to give me the
right tokens in several cases:

var methodName0 = new System.Diagnostics.StackFrame().GetMethod().Name;
var followBits0 =
    from field in GetType().GetFields()
    let followWhat = input.LA(1) > -1 ? input.LA(1) : input.LA(-1)
    let followWhatFixed = TokenNames[followWhat].StartsWith("'") ?
followWhat.ToString() : TokenNames[followWhat]
    where field.Name.StartsWith("FOLLOW_" + followWhatFixed + "_")
    select field;
var filtered0 = followBits0.Where(field =>
    field.Name.Contains("in_" + methodName0));
var followTokens0 =
    from field in (filtered0.Any() ? filtered0 : followBits0)
    from bit in ((BitSet)field.GetValue(this)).ToArray()
    select tokenNames[bit].Trim('\'');
    
    NoViableAltException nvaes_d4s0 =
        new NoViableAltException(followTokens0.Aggregate("", (t1, t2) =>
t1 + " " + t2), 4, 0, input);

    throw nvaes_d4s0;

As you can see it's hardly elegant due to all the special cases, but it
sort of works... provided that input has one or more tokens. It works
for definitions, as they can only start with a :TEXT token, so I get a
MismatchedTokenException. Conditions (e.g. its height must be more than
100 mm), however, have multiple valid starting tokens. When trying to
provide intellisense for the first token of a condition input.LA(1)
produces -1 and input.LA(-1) throws a NullReferenceException. It
wouldn't matter much if it didn't, since there's nothing to follow, so
none of the FOLLOW_ bitsets will be usable. Using following here doesn't
work either, as all it contains is the ':OR' token, which can combine
multiple conditions into one.

So that brings me back to my previous question:
Is there a way to process the edges variable (say, replacing all the
non-numeric characters with spaces) before spitting it out into the
generated code or, preferably, is there a way to get the list of numbers
used for creating the preceding case/if statements directly?

Thanks again for all your help.



-----Original Message-----
From: Thomas Brandon [mailto:tbrandonau at gmail.com] 
Sent: dinsdag 2 september 2008 18:48
To: Niemeijer, R.A.
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Re : Re : How to get a list of all
validoptions for the next token?

Can't you reuse the ANTLR routines for this, e.g.
BaseRecognizer.computeContextSensitiveRuleFOLLOW and
BaseRecognizer.computeErrorRecoverySet. Otherwise I think you want to
be operating on the follow set stack maintained by ANTLR
(RecognizerSharedState.following) rather than the static follow set
variables.
Otherwise a few comments based on a quick reading are below.
On Wed, Sep 3, 2008 at 1:12 AM, Niemeijer, R.A. <r.a.niemeijer at tue.nl>
wrote:
> Hello,
>
> I've given editing the templates a go and it is indeed not as hard as
I imagined. However, I have some difficulty getting the data I need.
>
> The only exceptions I've found so far that need to be changed are
NoViableAltExceptions, since MismatchedTokenExceptions already have an
Expecting variable. NoViableAltExceptions are generated in two places in
the codegen template: dfaState and dfaStateSwitch.
>
> As for the one in dfaStateSwitch:
> By replacing <description> (which always seems to be empty) with
>
> (from field in GetType().GetFields()
>  where field.Name.StartsWith("FOLLOW_" + input.LA(1))
>  from bit in ((BitSet)field.GetValue(this)).ToArray()
>  select tokenNames[bit].Trim('\'')).Aggregate((t1, t2) => t1 + " " +
t2)
>
> I can get a space-separated list of tokens. It is by no means a
perfect solution though. Some issues:
> - This gets all the tokens that could ever follow the last token, not
just the ones in the current rule. Depending on the grammar this may or
may not be a problem.
The follow set names contain the rule they apply to, you can filter on
that.
> - It only works on non-named tokens (input.LA(1) returns an int). This
should be fairly trivial to fix though.
You need to use the token name, not the token type as returned by LA.
Use the tokenNames array from the parser (or reflection if you don't
have access to the parser).
> - Throws an error if it can't find any FOLLOW_ variables. Also easily
fixed.
> - It works in the one test case I tried it with. I'm not guaranteeing
it works in others.
>
> This doesn't work in dfaState though, since there input.LA(1) is
always -1.
LA returning -1 indicates the next token is EOF. Assuming you weren't
at the end of the stream I can't see why this would occur. Also, it
should be LA(<k>) not LA(1). And you should have access to the cached
value via LA<decisionNumber>_<stateNumber>.
>What I need (and it would work for dfaStateSwitch as well) is the list
of the numbers in the case statements preceding the default/else
statement containing the NoViableAltException. The only way to sort of
get at this info I've found is the edges parameter that is passed to the
two functions, but it contains the entire generated source code for
those parts. Using it directly or in quotes results in tons of compile
errors.
>
> So my question: is there a way to process the edges variable (say,
replacing all the non-numeric characters with spaces) before spitting it
out into the generated code or, preferably, is there a way to get the
list of numbers used for creating the case statements directly?
>
> Thanks again.
>

Tom.

From ai06087 at Lehre.BA-Stuttgart.De  Wed Sep  3 09:00:53 2008
From: ai06087 at Lehre.BA-Stuttgart.De (Jenny Balfer)
Date: Wed,  3 Sep 2008 18:00:53 +0200
Subject: [antlr-interest] Order of token matching
Message-ID: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>

Hello guys,

I think I have too little understanding of the work of my lexer. I thought
the rules that are specified first are matched first, but in my grammar
this is not the case. 
What I am trying to do is first skipping all comments of my source files,
and then skipping everything between curly braces:

MLCOM	:	'/*'
	;
SLCOM	:	'//'
	;
RCOM	:	'*/'
	;
NL	:	'\r'			{skip();}
	|	'\n'			{skip();}
	;
WS	:	' '			{$channel=HIDDEN;}
	|	'\t'			{skip();}
	;

COMMENT	:	SLCOM (options{greedy=false;}: .)* NL		{skip();}
	|	MLCOM (options{greedy=false;}: .)* RCOM		{skip();}
	;
IMPL	:	'{' (IMPL|'}')* '}'	{skip();}
	;

Rule IMPL matches everything between curly braces, but in between counts
them (by recursively calling itself). 
Now the problem appears if there are braces in comments:

someFunction = function(a,b) {
   // this is one brace too much: {
}

My lexer now sees the opening brace in the comment and searches for the
closing one until the end of file, which results in:
mismatched character '<EOF>' expecting '}'

What I want my lexer to do is first sort out all comments, and second sort
out everything between curly braces. Are there any predicates that could
cause this?

Thanks!


From jimi at temporal-wave.com  Wed Sep  3 09:05:48 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 03 Sep 2008 09:05:48 -0700
Subject: [antlr-interest] Order of token matching
In-Reply-To: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>
References: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>
Message-ID: <1220457948.7778.180.camel@jimi>

On Wed, 2008-09-03 at 18:00 +0200, Jenny Balfer wrote:

> Hello guys,
> 
> I think I have too little understanding of the work of my lexer. I thought
> the rules that are specified first are matched first, but in my grammar
> this is not the case. 
> What I am trying to do is first skipping all comments of my source files,
> and then skipping everything between curly braces:
> 


Make sure that any token that you don't want returned to the parser is a
fragment:

fragment
MLCOM : '/*' ;

etc. Then you should have more luck, your comment lead-ins are matching
the MLCOM and SLCOM rules and then likely throwing recognition errors
for the rest up until the '{'

Jim


> MLCOM	:	'/*'
> 	;
> SLCOM	:	'//'
> 	;
> RCOM	:	'*/'
> 	;
> NL	:	'\r'			{skip();}
> 	|	'\n'			{skip();}
> 	;
> WS	:	' '			{$channel=HIDDEN;}
> 	|	'\t'			{skip();}
> 	;
> 
> COMMENT	:	SLCOM (options{greedy=false;}: .)* NL		{skip();}
> 	|	MLCOM (options{greedy=false;}: .)* RCOM		{skip();}
> 	;
> IMPL	:	'{' (IMPL|'}')* '}'	{skip();}
> 	;
> 
> Rule IMPL matches everything between curly braces, but in between counts
> them (by recursively calling itself). 
> Now the problem appears if there are braces in comments:
> 
> someFunction = function(a,b) {
>    // this is one brace too much: {
> }
> 
> My lexer now sees the opening brace in the comment and searches for the
> closing one until the end of file, which results in:
> mismatched character '<EOF>' expecting '}'
> 
> What I want my lexer to do is first sort out all comments, and second sort
> out everything between curly braces. Are there any predicates that could
> cause this?
> 
> Thanks!
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/d7a5b609/attachment.html 

From ai06087 at Lehre.BA-Stuttgart.De  Wed Sep  3 09:14:55 2008
From: ai06087 at Lehre.BA-Stuttgart.De (Jenny Balfer)
Date: Wed,  3 Sep 2008 18:14:55 +0200
Subject: [antlr-interest] Order of token matching
In-Reply-To: <1220457948.7778.180.camel@jimi>
References: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>
	<1220457948.7778.180.camel@jimi>
Message-ID: <97549526a4daf22459fb398ee30a86b9@lehre.ba-stuttgart.de>

Thanks for that, but unfortunately this does not solve the problem. I
declared MLCOM etc. as fragment, but COMMENT and IMPL must not be fragments
in order to skip them. 

On Wed, 03 Sep 2008 09:05:48 -0700, Jim Idle <jimi at temporal-wave.com>
wrote:
> On Wed, 2008-09-03 at 18:00 +0200, Jenny Balfer wrote:
> 
>> Hello guys,
>>
>> I think I have too little understanding of the work of my lexer. I
> thought
>> the rules that are specified first are matched first, but in my grammar
>> this is not the case.
>> What I am trying to do is first skipping all comments of my source
> files,
>> and then skipping everything between curly braces:
>>
> 
> 
> Make sure that any token that you don't want returned to the parser is a
> fragment:
> 
> fragment
> MLCOM : '/*' ;
> 
> etc. Then you should have more luck, your comment lead-ins are matching
> the MLCOM and SLCOM rules and then likely throwing recognition errors
> for the rest up until the '{'
> 
> Jim
> 
> 
>> MLCOM	:	'/*'
>> 	;
>> SLCOM	:	'//'
>> 	;
>> RCOM	:	'*/'
>> 	;
>> NL	:	'\r'			{skip();}
>> 	|	'\n'			{skip();}
>> 	;
>> WS	:	' '			{$channel=HIDDEN;}
>> 	|	'\t'			{skip();}
>> 	;
>>
>> COMMENT	:	SLCOM (options{greedy=false;}: .)* NL		{skip();}
>> 	|	MLCOM (options{greedy=false;}: .)* RCOM		{skip();}
>> 	;
>> IMPL	:	'{' (IMPL|'}')* '}'	{skip();}
>> 	;
>>
>> Rule IMPL matches everything between curly braces, but in between counts
>> them (by recursively calling itself).
>> Now the problem appears if there are braces in comments:
>>
>> someFunction = function(a,b) {
>>    // this is one brace too much: {
>> }
>>
>> My lexer now sees the opening brace in the comment and searches for the
>> closing one until the end of file, which results in:
>> mismatched character '<EOF>' expecting '}'
>>
>> What I want my lexer to do is first sort out all comments, and second
> sort
>> out everything between curly braces. Are there any predicates that could
>> cause this?
>>
>> Thanks!
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>
http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>


From jimi at temporal-wave.com  Wed Sep  3 09:21:00 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 03 Sep 2008 09:21:00 -0700
Subject: [antlr-interest] Order of token matching
In-Reply-To: <97549526a4daf22459fb398ee30a86b9@lehre.ba-stuttgart.de>
References: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>
	<1220457948.7778.180.camel@jimi>
	<97549526a4daf22459fb398ee30a86b9@lehre.ba-stuttgart.de>
Message-ID: <1220458860.7778.197.camel@jimi>

On Wed, 2008-09-03 at 18:14 +0200, Jenny Balfer wrote:

> Thanks for that, but unfortunately this does not solve the problem. I
> declared MLCOM etc. as fragment, but COMMENT and IMPL must not be fragments
> in order to skip them. 


Have you shown all of your grammar here?

Jim

> 
> On Wed, 03 Sep 2008 09:05:48 -0700, Jim Idle <jimi at temporal-wave.com>
> wrote:
> > On Wed, 2008-09-03 at 18:00 +0200, Jenny Balfer wrote:
> > 
> >> Hello guys,
> >>
> >> I think I have too little understanding of the work of my lexer. I
> > thought
> >> the rules that are specified first are matched first, but in my grammar
> >> this is not the case.
> >> What I am trying to do is first skipping all comments of my source
> > files,
> >> and then skipping everything between curly braces:
> >>
> > 
> > 
> > Make sure that any token that you don't want returned to the parser is a
> > fragment:
> > 
> > fragment
> > MLCOM : '/*' ;
> > 
> > etc. Then you should have more luck, your comment lead-ins are matching
> > the MLCOM and SLCOM rules and then likely throwing recognition errors
> > for the rest up until the '{'
> > 
> > Jim
> > 
> > 
> >> MLCOM	:	'/*'
> >> 	;
> >> SLCOM	:	'//'
> >> 	;
> >> RCOM	:	'*/'
> >> 	;
> >> NL	:	'\r'			{skip();}
> >> 	|	'\n'			{skip();}
> >> 	;
> >> WS	:	' '			{$channel=HIDDEN;}
> >> 	|	'\t'			{skip();}
> >> 	;
> >>
> >> COMMENT	:	SLCOM (options{greedy=false;}: .)* NL		{skip();}
> >> 	|	MLCOM (options{greedy=false;}: .)* RCOM		{skip();}
> >> 	;
> >> IMPL	:	'{' (IMPL|'}')* '}'	{skip();}
> >> 	;
> >>
> >> Rule IMPL matches everything between curly braces, but in between counts
> >> them (by recursively calling itself).
> >> Now the problem appears if there are braces in comments:
> >>
> >> someFunction = function(a,b) {
> >>    // this is one brace too much: {
> >> }
> >>
> >> My lexer now sees the opening brace in the comment and searches for the
> >> closing one until the end of file, which results in:
> >> mismatched character '<EOF>' expecting '}'
> >>
> >> What I want my lexer to do is first sort out all comments, and second
> > sort
> >> out everything between curly braces. Are there any predicates that could
> >> cause this?
> >>
> >> Thanks!
> >>
> >>
> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >> Unsubscribe:
> >
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >>
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/02555f75/attachment.html 

From ai06087 at Lehre.BA-Stuttgart.De  Wed Sep  3 09:34:10 2008
From: ai06087 at Lehre.BA-Stuttgart.De (Jenny Balfer)
Date: Wed,  3 Sep 2008 18:34:10 +0200
Subject: [antlr-interest] Order of token matching
In-Reply-To: <1220458860.7778.197.camel@jimi>
References: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>
	<1220457948.7778.180.camel@jimi>
	<97549526a4daf22459fb398ee30a86b9@lehre.ba-stuttgart.de>
	<1220458860.7778.197.camel@jimi>
Message-ID: <ac4d76b463496386f98608e7d1388e97@lehre.ba-stuttgart.de>

No, it is too long. But I reproduced the error in a short one. 
An example for the occuring error would be the following string:

isWorking = function(param1,param2) {
	some implementation;
	some expressions;
}

function throwsError(param1, param2) {
	// this is a nasty comment {
	something else
}

function isIgnored() {
	// lexer is still searching for a closing brace
}

***********
* GRAMMAR *
***********

program	:	statement*
	;
statement
	:	'(' statement ')'
	|	declaration
	;	
declaration
	:	ID '=' FUNCTION '(' paramList ')'
	|	FUNCTION ID '(' paramList ')' 
	;	
paramList
	:	ID (',' ID)*
	;					

fragment LDOC
	:	'/**'
	;
fragment MLCOM	
	:	'/*'
	;
fragment SLCOM	
	:	'//'
	;
fragment RCOM
	:	'*/'
	;
FUNCTION:	'function'
	;
COMMENT
	:	SLCOM (options{greedy=false;}: .)* NL		{skip();}
	|	MLCOM (options{greedy=false;}: .)* RCOM		{skip();}
	;
IMPL
	:	'{' (IMPL|~'}')* '}'	{skip();}
	;	
NL
	:	'\r'			{skip();}
	|	'\n'			{skip();}
	;
WS
	:	' '			{$channel=HIDDEN;}
	|	'\t'			{skip();}
	;
ID	:	( LETTER | '$' | '_' )	( LETTER | '$' | '_' | DIGIT )*
	;
fragment LETTER
	:	'A'..'Z'
	|	'a'..'z'
	;
fragment DIGIT
	:	'0'..'9'
	;			
DEFAULT	:	.
	;		


On Wed, 03 Sep 2008 09:21:00 -0700, Jim Idle <jimi at temporal-wave.com>
wrote:
> On Wed, 2008-09-03 at 18:14 +0200, Jenny Balfer wrote:
> 
>> Thanks for that, but unfortunately this does not solve the problem. I
>> declared MLCOM etc. as fragment, but COMMENT and IMPL must not be
> fragments
>> in order to skip them.
> 
> 
> Have you shown all of your grammar here?
> 
> Jim
> 
>>
>> On Wed, 03 Sep 2008 09:05:48 -0700, Jim Idle <jimi at temporal-wave.com>
>> wrote:
>> > On Wed, 2008-09-03 at 18:00 +0200, Jenny Balfer wrote:
>> >
>> >> Hello guys,
>> >>
>> >> I think I have too little understanding of the work of my lexer. I
>> > thought
>> >> the rules that are specified first are matched first, but in my
> grammar
>> >> this is not the case.
>> >> What I am trying to do is first skipping all comments of my source
>> > files,
>> >> and then skipping everything between curly braces:
>> >>
>> >
>> >
>> > Make sure that any token that you don't want returned to the parser is
> a
>> > fragment:
>> >
>> > fragment
>> > MLCOM : '/*' ;
>> >
>> > etc. Then you should have more luck, your comment lead-ins are
> matching
>> > the MLCOM and SLCOM rules and then likely throwing recognition errors
>> > for the rest up until the '{'
>> >
>> > Jim
>> >
>> >
>> >> MLCOM	:	'/*'
>> >> 	;
>> >> SLCOM	:	'//'
>> >> 	;
>> >> RCOM	:	'*/'
>> >> 	;
>> >> NL	:	'\r'			{skip();}
>> >> 	|	'\n'			{skip();}
>> >> 	;
>> >> WS	:	' '			{$channel=HIDDEN;}
>> >> 	|	'\t'			{skip();}
>> >> 	;
>> >>
>> >> COMMENT	:	SLCOM (options{greedy=false;}: .)* NL		{skip();}
>> >> 	|	MLCOM (options{greedy=false;}: .)* RCOM		{skip();}
>> >> 	;
>> >> IMPL	:	'{' (IMPL|'}')* '}'	{skip();}
>> >> 	;
>> >>
>> >> Rule IMPL matches everything between curly braces, but in between
> counts
>> >> them (by recursively calling itself).
>> >> Now the problem appears if there are braces in comments:
>> >>
>> >> someFunction = function(a,b) {
>> >>    // this is one brace too much: {
>> >> }
>> >>
>> >> My lexer now sees the opening brace in the comment and searches for
> the
>> >> closing one until the end of file, which results in:
>> >> mismatched character '<EOF>' expecting '}'
>> >>
>> >> What I want my lexer to do is first sort out all comments, and second
>> > sort
>> >> out everything between curly braces. Are there any predicates that
> could
>> >> cause this?
>> >>
>> >> Thanks!
>> >>
>> >>
>> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> >> Unsubscribe:
>> >
>>
>
http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> >>
>>


From jimi at temporal-wave.com  Wed Sep  3 09:46:09 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 03 Sep 2008 09:46:09 -0700
Subject: [antlr-interest] Order of token matching
In-Reply-To: <ac4d76b463496386f98608e7d1388e97@lehre.ba-stuttgart.de>
References: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>
	<1220457948.7778.180.camel@jimi>
	<97549526a4daf22459fb398ee30a86b9@lehre.ba-stuttgart.de>
	<1220458860.7778.197.camel@jimi>
	<ac4d76b463496386f98608e7d1388e97@lehre.ba-stuttgart.de>
Message-ID: <1220460369.7778.211.camel@jimi>

On Wed, 2008-09-03 at 18:34 +0200, Jenny Balfer wrote:

> No, it is too long. But I reproduced the error in a short one. 
> An example for the occuring error would be the following string:


OK - well it would be searching for the } because you didn't tell the
IMPL about comments :-). You need this (as well as the other stuff being
fragments):

IMPL
        :       '{' (
        
        				  (SLCOM|MLCOM)=> COMMENT
        				| ('{')=>         IMPL
        				| ~'}'
        			)* 
        		'}'    {skip();}
        ;   

Also, in your grammar the paramLists in implementation need to be
optional.

Jim

> 
> isWorking = function(param1,param2) {
> 	some implementation;
> 	some expressions;
> }
> 
> function throwsError(param1, param2) {
> 	// this is a nasty comment {
> 	something else
> }
> 
> function isIgnored() {
> 	// lexer is still searching for a closing brace
> }


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/e06ab731/attachment.html 

From ai06087 at Lehre.BA-Stuttgart.De  Wed Sep  3 09:53:50 2008
From: ai06087 at Lehre.BA-Stuttgart.De (Jenny Balfer)
Date: Wed,  3 Sep 2008 18:53:50 +0200
Subject: [antlr-interest] Order of token matching
In-Reply-To: <1220460369.7778.211.camel@jimi>
References: <888408a89beceacfd334991d25da6dc3@lehre.ba-stuttgart.de>
	<1220457948.7778.180.camel@jimi>
	<97549526a4daf22459fb398ee30a86b9@lehre.ba-stuttgart.de>
	<1220458860.7778.197.camel@jimi>
	<ac4d76b463496386f98608e7d1388e97@lehre.ba-stuttgart.de>
	<1220460369.7778.211.camel@jimi>
Message-ID: <89a81ee0d7a155a799e20624903bbe7f@lehre.ba-stuttgart.de>

great, that's working :-D

I tried something like

IMPL : '{' (COMMENT|IMPL|~'}')* '}' ;

before, but without the predicates it was not working either.

Thanks a lot!

On Wed, 03 Sep 2008 09:46:09 -0700, Jim Idle <jimi at temporal-wave.com>
wrote:
> On Wed, 2008-09-03 at 18:34 +0200, Jenny Balfer wrote:
> 
>> No, it is too long. But I reproduced the error in a short one.
>> An example for the occuring error would be the following string:
> 
> 
> OK - well it would be searching for the } because you didn't tell the
> IMPL about comments :-). You need this (as well as the other stuff being
> fragments):
> 
> IMPL
>         :       '{' (
> 
>         				  (SLCOM|MLCOM)=> COMMENT
>         				| ('{')=>         IMPL
>         				| ~'}'
>         			)*
>         		'}'    {skip();}
>         ;
> 
> Also, in your grammar the paramLists in implementation need to be
> optional.
> 
> Jim
> 
>>
>> isWorking = function(param1,param2) {
>> 	some implementation;
>> 	some expressions;
>> }
>>
>> function throwsError(param1, param2) {
>> 	// this is a nasty comment {
>> 	something else
>> }
>>
>> function isIgnored() {
>> 	// lexer is still searching for a closing brace
>> }


From lucasontivero at hotmail.com  Wed Sep  3 10:19:45 2008
From: lucasontivero at hotmail.com (Lucas Ontivero)
Date: Wed, 3 Sep 2008 17:19:45 +0000
Subject: [antlr-interest] NoSuchElementException
In-Reply-To: <344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
	<ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com> 
	<344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com> 
Message-ID: <BAY128-W1408E47EA67F903E8DDD9AB55E0@phx.gbl>

Hi All,

I take the html.g from http://www.antlr.org/grammar/HTML/html.g and after to a little changes, when generate code launch the following exception: NoSuchElementException. This is for all languages. someone had this problem? or I am doing something wrong?
Thank you.


[12:15:37] error(10):  internal error: C:\Documents and Settings\Administrator\My Documents\Visual Studio 2005\Projects\ArticleProcessor\ArticleProcessor\HTML.g : java.util.NoSuchElementException: no such attribute: hasPredicateBlockedByAction in template context [TOKEN_NONDETERMINISM]
org.antlr.stringtemplate.StringTemplate.rawSetAttribute(Unknown Source)
org.antlr.stringtemplate.StringTemplate.setAttribute(Unknown Source)
org.antlr.tool.GrammarNonDeterminismMessage.toString(GrammarNonDeterminismMessage.java:124)
org.antlr.works.utils.ErrorListener.warning(Unknown Source)
org.antlr.tool.ErrorManager.nondeterminism(ErrorManager.java:648)
org.antlr.analysis.DecisionProbe.issueWarnings(DecisionProbe.java:453)
org.antlr.analysis.DFA.<init>(DFA.java:239)
org.antlr.tool.Grammar.createLookaheadDFA(Grammar.java:1225)
org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:970)
org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:920)
org.antlr.codegen.Target.performGrammarAnalysis(Target.java:114)
org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:293)
org.antlr.Tool.generateRecognizer(Tool.java:419)
org.antlr.Tool.process(Tool.java:341)
org.antlr.works.generate.CodeGenerate.generate(Unknown Source)
org.antlr.works.generate.CodeGenerate.run(Unknown Source)
java.lang.Thread.run(Unknown Source)


_________________________________________________________________
Descarg? GRATIS el poder del nuevo Internet Explorer 7.
http://optimized.msn.com/Default.aspx?mkt=es-ar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/13af8123/attachment.html 

From jaluber at gmx.de  Wed Sep  3 11:28:06 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 03 Sep 2008 20:28:06 +0200
Subject: [antlr-interest] NoSuchElementException
In-Reply-To: <BAY128-W1408E47EA67F903E8DDD9AB55E0@phx.gbl>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>	<ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com>
	<344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com>
	<BAY128-W1408E47EA67F903E8DDD9AB55E0@phx.gbl>
Message-ID: <48BED736.7010809@gmx.de>

Lucas Ontivero schrieb:
> Hi All,
> 
> I take the html.g from http://www.antlr.org/grammar/HTML/html.g and
> after to a little changes, when generate code launch the following
> exception: NoSuchElementException. This is for all languages. someone
> had this problem? or I am doing something wrong?
> Thank you.

You are using ANTLR 3.1 for a grammar which requires ANTLR 2.7.7 (or
earlier). As ANTLR 3 uses a new syntax this can't work. Your options are
either to switch back to an earlier version of ANTLR or to convert the
grammar to 3.1. There is a tool which does some of the work, but if you
have no knowledge of both versions it may be easier - when choosing the
second option - to create a 3.1 grammar from scratch. There is a
tutorial on parsing XML and a project to parse XQuery, which may be
helpful in that endeavor.

Johannes

P.S.: Please start a new thread by creating a new email directly.
Changing only the subject line messes up the thread viewing in email
programs.

> 
> [12:15:37] error(10):  internal error: C:\Documents and
> Settings\Administrator\My Documents\Visual Studio
> 2005\Projects\ArticleProcessor\ArticleProcessor\HTML.g :
> java.util.NoSuchElementException: no such attribute:
> hasPredicateBlockedByAction in template context [TOKEN_NONDETERMINISM]
> org.antlr.stringtemplate.StringTemplate.rawSetAttribute(Unknown Source)
> org.antlr.stringtemplate.StringTemplate.setAttribute(Unknown Source)
> org.antlr.tool.GrammarNonDeterminismMessage.toString(GrammarNonDeterminismMessage.java:124)
> org.antlr.works.utils.ErrorListener.warning(Unknown Source)
> org.antlr.tool.ErrorManager.nondeterminism(ErrorManager.java:648)
> org.antlr.analysis.DecisionProbe.issueWarnings(DecisionProbe.java:453)
> org.antlr.analysis.DFA.<init>(DFA.java:239)
> org.antlr.tool.Grammar.createLookaheadDFA(Grammar.java:1225)
> org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:970)
> org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:920)
> org.antlr.codegen.Target.performGrammarAnalysis(Target.java:114)
> org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:293)
> org.antlr.Tool.generateRecognizer(Tool.java:419)
> org.antlr.Tool.process(Tool.java:341)
> org.antlr.works.generate.CodeGenerate.generate(Unknown Source)
> org.antlr.works.generate.CodeGenerate.run(Unknown Source)
> java.lang.Thread.run(Unknown Source)
> 
> 
> ------------------------------------------------------------------------
> Descarg? GRATIS el poder del nuevo Internet Explorer 7. Internet
> Explorer 7 <http://optimized.msn.com/Default.aspx?mkt=es-ar>
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From lucasontivero at hotmail.com  Wed Sep  3 12:38:32 2008
From: lucasontivero at hotmail.com (Lucas Ontivero)
Date: Wed, 3 Sep 2008 19:38:32 +0000
Subject: [antlr-interest] NoSuchElementException
In-Reply-To: <48BED736.7010809@gmx.de>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>
	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>
	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>
	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>
	<ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com>
	<344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com>
	<BAY128-W1408E47EA67F903E8DDD9AB55E0@phx.gbl> <48BED736.7010809@gmx.de>
Message-ID: <BAY128-W48F1B6BADDFB8FE3B518D4B55E0@phx.gbl>

Thank Johannes! V2->V3 Tool work very well, I just changed the "$setType" by hand and ready. Thank you again


> Date: Wed, 3 Sep 2008 20:28:06 +0200
> From: jaluber at gmx.de
> To: lucasontivero at hotmail.com
> CC: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] NoSuchElementException
> 
> Lucas Ontivero schrieb:
> > Hi All,
> > 
> > I take the html.g from http://www.antlr.org/grammar/HTML/html.g and
> > after to a little changes, when generate code launch the following
> > exception: NoSuchElementException. This is for all languages. someone
> > had this problem? or I am doing something wrong?
> > Thank you.
> 
> You are using ANTLR 3.1 for a grammar which requires ANTLR 2.7.7 (or
> earlier). As ANTLR 3 uses a new syntax this can't work. Your options are
> either to switch back to an earlier version of ANTLR or to convert the
> grammar to 3.1. There is a tool which does some of the work, but if you
> have no knowledge of both versions it may be easier - when choosing the
> second option - to create a 3.1 grammar from scratch. There is a
> tutorial on parsing XML and a project to parse XQuery, which may be
> helpful in that endeavor.
> 
> Johannes
> 
> P.S.: Please start a new thread by creating a new email directly.
> Changing only the subject line messes up the thread viewing in email
> programs.
> 
> > 
> > [12:15:37] error(10):  internal error: C:\Documents and
> > Settings\Administrator\My Documents\Visual Studio
> > 2005\Projects\ArticleProcessor\ArticleProcessor\HTML.g :
> > java.util.NoSuchElementException: no such attribute:
> > hasPredicateBlockedByAction in template context [TOKEN_NONDETERMINISM]
> > org.antlr.stringtemplate.StringTemplate.rawSetAttribute(Unknown Source)
> > org.antlr.stringtemplate.StringTemplate.setAttribute(Unknown Source)
> > org.antlr.tool.GrammarNonDeterminismMessage.toString(GrammarNonDeterminismMessage.java:124)
> > org.antlr.works.utils.ErrorListener.warning(Unknown Source)
> > org.antlr.tool.ErrorManager.nondeterminism(ErrorManager.java:648)
> > org.antlr.analysis.DecisionProbe.issueWarnings(DecisionProbe.java:453)
> > org.antlr.analysis.DFA.<init>(DFA.java:239)
> > org.antlr.tool.Grammar.createLookaheadDFA(Grammar.java:1225)
> > org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:970)
> > org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:920)
> > org.antlr.codegen.Target.performGrammarAnalysis(Target.java:114)
> > org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:293)
> > org.antlr.Tool.generateRecognizer(Tool.java:419)
> > org.antlr.Tool.process(Tool.java:341)
> > org.antlr.works.generate.CodeGenerate.generate(Unknown Source)
> > org.antlr.works.generate.CodeGenerate.run(Unknown Source)
> > java.lang.Thread.run(Unknown Source)
> > 
> > 
> > ------------------------------------------------------------------------
> > Descarg? GRATIS el poder del nuevo Internet Explorer 7. Internet
> > Explorer 7 <http://optimized.msn.com/Default.aspx?mkt=es-ar>
> > 
> > 
> > ------------------------------------------------------------------------
> > 
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> > 
> 

_________________________________________________________________
?Aburrido? Ingres? ya y divertite como nunca en MSN Juegos.
http://juegos.ar.msn.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/dba731b7/attachment.html 

From jaluber at gmx.de  Wed Sep  3 12:54:34 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 03 Sep 2008 21:54:34 +0200
Subject: [antlr-interest] NoSuchElementException
In-Reply-To: <BAY128-W48F1B6BADDFB8FE3B518D4B55E0@phx.gbl>
References: <344d61080809030213x2ee86769w402b5a000ab460bf@mail.gmail.com>	<ebc876d70809030223q626ccd69i9b443dbb57285c21@mail.gmail.com>	<344d61080809030232q7e493bc0y9364298f6fc9928d@mail.gmail.com>	<344d61080809030236h430933c4hfb06ec644ce440cd@mail.gmail.com>	<ebc876d70809030500r7aef891fsd48e0355756d810c@mail.gmail.com>
	<344d61080809030528x1cb3d64bl15c9ae2d60edab4c@mail.gmail.com>
	<BAY128-W1408E47EA67F903E8DDD9AB55E0@phx.gbl>
	<48BED736.7010809@gmx.de>
	<BAY128-W48F1B6BADDFB8FE3B518D4B55E0@phx.gbl>
Message-ID: <48BEEB7A.1010600@gmx.de>

Lucas Ontivero schrieb:
> Thank Johannes! V2->V3 Tool work very well, I just changed the
> "$setType" by hand and ready. Thank you again

My pleasure. :) If the grammar lives up to your expectations, it would
be nice if you could post it on the grammar list. No need to have
everyone repeat the work. :)

Johannes
> 
> 
> ------------------------------------------------------------------------
>> Date: Wed, 3 Sep 2008 20:28:06 +0200
>> From: jaluber at gmx.de
>> To: lucasontivero at hotmail.com
>> CC: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] NoSuchElementException
>>
>> Lucas Ontivero schrieb:
>> > Hi All,
>> >
>> > I take the html.g from http://www.antlr.org/grammar/HTML/html.g and
>> > after to a little changes, when generate code launch the following
>> > exception: NoSuchElementException. This is for all languages. someone
>> > had this problem? or I am doing something wrong?
>> > Thank you.
>>
>> You are using ANTLR 3.1 for a grammar which requires ANTLR 2.7.7 (or
>> earlier). As ANTLR 3 uses a new syntax this can't work. Your options are
>> either to switch back to an earlier version of ANTLR or to convert the
>> grammar to 3.1. There is a tool which does some of the work, but if you
>> have no knowledge of both versions it may be easier - when choosing the
>> second option - to create a 3.1 grammar from scratch. There is a
>> tutorial on parsing XML and a project to parse XQuery, which may be
>> helpful in that endeavor.
>>
>> Johannes
>>
>> P.S.: Please start a new thread by creating a new email directly.
>> Changing only the subject line messes up the thread viewing in email
>> programs.
>>
>> >
>> > [12:15:37] error(10): internal error: C:\Documents and
>> > Settings\Administrator\My Documents\Visual Studio
>> > 2005\Projects\ArticleProcessor\ArticleProcessor\HTML.g :
>> > java.util.NoSuchElementException: no such attribute:
>> > hasPredicateBlockedByAction in template context [TOKEN_NONDETERMINISM]
>> > org.antlr.stringtemplate.StringTemplate.rawSetAttribute(Unknown Source)
>> > org.antlr.stringtemplate.StringTemplate.setAttribute(Unknown Source)
>> >
> org.antlr.tool.GrammarNonDeterminismMessage.toString(GrammarNonDeterminismMessage.java:124)
>> > org.antlr.works.utils.ErrorListener.warning(Unknown Source)
>> > org.antlr.tool.ErrorManager.nondeterminism(ErrorManager.java:648)
>> > org.antlr.analysis.DecisionProbe.issueWarnings(DecisionProbe.java:453)
>> > org.antlr.analysis.DFA.<init>(DFA.java:239)
>> > org.antlr.tool.Grammar.createLookaheadDFA(Grammar.java:1225)
>> > org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:970)
>> > org.antlr.tool.Grammar.createLookaheadDFAs(Grammar.java:920)
>> > org.antlr.codegen.Target.performGrammarAnalysis(Target.java:114)
>> > org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:293)
>> > org.antlr.Tool.generateRecognizer(Tool.java:419)
>> > org.antlr.Tool.process(Tool.java:341)
>> > org.antlr.works.generate.CodeGenerate.generate(Unknown Source)
>> > org.antlr.works.generate.CodeGenerate.run(Unknown Source)
>> > java.lang.Thread.run(Unknown Source)
>> >
>> >
>> > ------------------------------------------------------------------------
>> > Descarg? GRATIS el poder del nuevo Internet Explorer 7. Internet
>> > Explorer 7 <http://optimized.msn.com/Default.aspx?mkt=es-ar>
>> >
>> >
>> > ------------------------------------------------------------------------
>> >
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> >
>>
> 
> ------------------------------------------------------------------------
> ?Aburrido? Ingres? ya y divertite como nunca en MSN Juegos. MSN Juegos
> <http://juegos.ar.msn.com/>


From antlr at mirality.co.nz  Wed Sep  3 14:13:49 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 04 Sep 2008 09:13:49 +1200
Subject: [antlr-interest] Fwd: Simple question, Hard answer?
In-Reply-To: <5383112D176D2D46B7DF3F287C631C641C5853@ntovmail02.ad.otto.
 de>
References: <344d61080809030319t777b8b64y8808b0343591e0fe@mail.gmail.com>
	<5383112D176D2D46B7DF3F287C631C641C5853@ntovmail02.ad.otto.de>
Message-ID: <20080903211355.EEE0C11EDCB@www.antlr.org>

At 23:13 3/09/2008, Kausch, Robert wrote:
 >You can ignore tokens by sending them on a different channel. 
The
 >following grammar ignores everything that is not 'okko' and 
works
 >for me:
 >
 >grammar test;
 >
 >start: (T1)*;
 >
 >T1:	'okko';
 >T2:	~(T1) { $channel = HIDDEN; } ;

T1 is a sequence.  ~ is intended to operate on sets (alternatives 
of single characters/tokens).  Odd things happen if you try to use 
~ on a sequence.  (It does actually compile, but it doesn't run 
properly.)

Using "T2: .;" ought to work, though.  Or just making it a 
filtering lexer.


From Fred.Brisard at ca.com  Wed Sep  3 14:31:49 2008
From: Fred.Brisard at ca.com (Brisard, Fred D)
Date: Wed, 3 Sep 2008 17:31:49 -0400
Subject: [antlr-interest] TokenRewriteStream usage
Message-ID: <7D50572C73BC634F92EE211BFF16F4A1067CC89C@USILMS12.ca.com>

I am developing an editor that uses an Antlr-based parser to analyze the
source, display it in various forms, allow the user to make
modifications and then regenerate the source with those modifications.
>From what I read it seems like the TokenRewriteStream is perfect for the
job.  

Right now I have a working parser that operates correctly when using
CommonTokenString.  I'm able to parse the source dump an AST based on
CommonTree that I built during the parsing.  I figured my first step
into rewriting would be to just replace the CommonTokenString object
with a TokenRewriteStream object as the result of the lex.  I also added
a grammar option of rewrite=true.  

When I run the lexer I get a null token stream from
TokenRewriteStream.toString().  

Any ideas?

Fred Brisard


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/0fdf0dc2/attachment.html 

From parrt at cs.usfca.edu  Wed Sep  3 14:53:09 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 3 Sep 2008 14:53:09 -0700
Subject: [antlr-interest] TokenRewriteStream usage
In-Reply-To: <7D50572C73BC634F92EE211BFF16F4A1067CC89C@USILMS12.ca.com>
References: <7D50572C73BC634F92EE211BFF16F4A1067CC89C@USILMS12.ca.com>
Message-ID: <881F8C1B-7C67-4355-823E-BA299627E42C@cs.usfca.edu>


On Sep 3, 2008, at 2:31 PM, Brisard, Fred D wrote:

> I am developing an editor that uses an Antlr-based parser to analyze  
> the source, display it in various forms, allow the user to make  
> modifications and then regenerate the source with those  
> modifications.  From what I read it seems like the  
> TokenRewriteStream is perfect for the job.
>
> Right now I have a working parser that operates correctly when using  
> CommonTokenString.  I?m able to parse the source dump an AST based  
> on CommonTree that I built during the parsing.  I figured my first  
> step into rewriting would be to just replace the CommonTokenString  
> object with a TokenRewriteStream object as the result of the lex.  I  
> also added a grammar option of rewrite=true.
>

that is used for output=template and such.  turn that off for starters  
I think.
>
> When I run the lexer I get a null token stream from  
> TokenRewriteStream.toString().
>

Weird...are you using CommonToken?

Ter

From Fred.Brisard at ca.com  Wed Sep  3 17:40:57 2008
From: Fred.Brisard at ca.com (Brisard, Fred D)
Date: Wed, 3 Sep 2008 20:40:57 -0400
Subject: [antlr-interest] TokenRewriteStream usage
In-Reply-To: <881F8C1B-7C67-4355-823E-BA299627E42C@cs.usfca.edu>
References: <7D50572C73BC634F92EE211BFF16F4A1067CC89C@USILMS12.ca.com>
	<881F8C1B-7C67-4355-823E-BA299627E42C@cs.usfca.edu>
Message-ID: <7D50572C73BC634F92EE211BFF16F4A1067CC946@USILMS12.ca.com>

Hi Terence,

 

Actually I did use rewrite=true and not specified in the grammar.

 

Here is my test code to drive the lexer and parser --

 

    public static void main(String args[]) throws Exception

    {

        FTP_JOBLexer lex = new FTP_JOBLexer(new
ANTLRFileStream("C:\\testfile.txt"));

        CommonTokenStream tokens = new CommonTokenStream(lex);

        int tokensize = tokens.size();

        String tokenstring = tokens.toString();

        System.out.println(tokenstring);

                

        FTP_JOBParser g = new FTP_JOBParser(tokens);

        try {

            FTP_JOBParser.program_return parseret = g.program();

            Object rawTree = parseret.getTree();

            String [] tokenNames = g.getTokenNames();

            CommonTree ct = (CommonTree)rawTree;

            String stringTree = ct.toStringTree();

            CommonTreePrint pt = new CommonTreePrint(g.getTokenNames());

            String stringParserTree = pt.print(ct);

            System.out.println(stringParserTree);

            String parserstring = g.toString();

        } catch (RecognitionException e) {

            e.printStackTrace();

        }

    }

 

The above works OK.  

 

If the only change I make is to replace the CommonTokenStream with
TokenRewriteStream in the highlighted line above, I get nothing out of
the tokens.toString() and a tokens.size() == 0.

 

It seemed like that was the logical thing to do since TokenRewriteStream
extends CommonTokenStream.  

 

I will debug it further if it's supposed to work as I'm assuming.  I
just didn't want to be going down the wrong path.

 

Thanks, Fred

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Terence Parr
Sent: Wednesday, September 03, 2008 5:53 PM
To: Brisard, Fred D
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] TokenRewriteStream usage

 

 

On Sep 3, 2008, at 2:31 PM, Brisard, Fred D wrote:

 

> I am developing an editor that uses an Antlr-based parser to analyze  

> the source, display it in various forms, allow the user to make  

> modifications and then regenerate the source with those  

> modifications.  From what I read it seems like the  

> TokenRewriteStream is perfect for the job.

> 

> Right now I have a working parser that operates correctly when using  

> CommonTokenString.  I'm able to parse the source dump an AST based  

> on CommonTree that I built during the parsing.  I figured my first  

> step into rewriting would be to just replace the CommonTokenString  

> object with a TokenRewriteStream object as the result of the lex.  I  

> also added a grammar option of rewrite=true.

> 

 

that is used for output=template and such.  turn that off for starters  

I think.

> 

> When I run the lexer I get a null token stream from  

> TokenRewriteStream.toString().

> 

 

Weird...are you using CommonToken?

 

Ter

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest

Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/f117ef00/attachment.html 

From parrt at cs.usfca.edu  Wed Sep  3 17:47:44 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 3 Sep 2008 17:47:44 -0700
Subject: [antlr-interest] TokenRewriteStream usage
In-Reply-To: <7D50572C73BC634F92EE211BFF16F4A1067CC946@USILMS12.ca.com>
References: <7D50572C73BC634F92EE211BFF16F4A1067CC89C@USILMS12.ca.com>
	<881F8C1B-7C67-4355-823E-BA299627E42C@cs.usfca.edu>
	<7D50572C73BC634F92EE211BFF16F4A1067CC946@USILMS12.ca.com>
Message-ID: <E360558D-3A5B-4F02-A7E4-7EF309279D64@cs.usfca.edu>

hmm...try printing after parsing.  Or, do at least one  
rewrite...perhaps I have a bug that it prints null for now rewrites.
Ter
On Sep 3, 2008, at 5:40 PM, Brisard, Fred D wrote:

> Hi Terence,
>
> Actually I did use rewrite=true and not specified in the grammar.
>
> Here is my test code to drive the lexer and parser --
>
>     public static void main(String args[]) throws Exception
>     {
>         FTP_JOBLexer lex = new FTP_JOBLexer(new ANTLRFileStream("C:\ 
> \testfile.txt"));
>         CommonTokenStream tokens = new CommonTokenStream(lex);
>         int tokensize = tokens.size();
>         String tokenstring = tokens.toString();
>         System.out.println(tokenstring);
>
>         FTP_JOBParser g = new FTP_JOBParser(tokens);
>         try {
>             FTP_JOBParser.program_return parseret = g.program();
>             Object rawTree = parseret.getTree();
>             String [] tokenNames = g.getTokenNames();
>             CommonTree ct = (CommonTree)rawTree;
>             String stringTree = ct.toStringTree();
>             CommonTreePrint pt = new  
> CommonTreePrint(g.getTokenNames());
>             String stringParserTree = pt.print(ct);
>             System.out.println(stringParserTree);
>             String parserstring = g.toString();
>         } catch (RecognitionException e) {
>             e.printStackTrace();
>         }
>     }
>
> The above works OK.
>
> If the only change I make is to replace the CommonTokenStream with  
> TokenRewriteStream in the highlighted line above, I get nothing out  
> of the tokens.toString() and a tokens.size() == 0.
>
> It seemed like that was the logical thing to do since  
> TokenRewriteStream extends CommonTokenStream.
>
> I will debug it further if it?s supposed to work as I?m assuming.  I  
> just didn?t want to be going down the wrong path.
>
> Thanks, Fred
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org 
> ] On Behalf Of Terence Parr
> Sent: Wednesday, September 03, 2008 5:53 PM
> To: Brisard, Fred D
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] TokenRewriteStream usage
>
>
> On Sep 3, 2008, at 2:31 PM, Brisard, Fred D wrote:
>
> > I am developing an editor that uses an Antlr-based parser to analyze
> > the source, display it in various forms, allow the user to make
> > modifications and then regenerate the source with those
> > modifications.  From what I read it seems like the
> > TokenRewriteStream is perfect for the job.
> >
> > Right now I have a working parser that operates correctly when using
> > CommonTokenString.  I?m able to parse the source dump an AST based
> > on CommonTree that I built during the parsing.  I figured my first
> > step into rewriting would be to just replace the CommonTokenString
> > object with a TokenRewriteStream object as the result of the lex.  I
> > also added a grammar option of rewrite=true.
> >
>
> that is used for output=template and such.  turn that off for starters
> I think.
> >
> > When I run the lexer I get a null token stream from
> > TokenRewriteStream.toString().
> >
>
> Weird...are you using CommonToken?
>
> Ter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/50dd59c8/attachment.html 

From spoulson at explodingcoder.com  Wed Sep  3 20:36:48 2008
From: spoulson at explodingcoder.com (Shawn Poulson)
Date: Wed, 03 Sep 2008 23:36:48 -0400
Subject: [antlr-interest] C#: Unhandled NoViableAltexception from lexer
Message-ID: <002801c90e3f$768c3b40$63a4b1c0$@com>

Hello again,

 

I finally found the solution to this issue.  For the records, I thought I'd
post it up incase anyone else needed to know.

 

This is actually a byproduct of a default profile setting in Visual Studio
2005 and 2008.  There is a feature that allows you to break on exceptions
thrown and handled, regardless if there is a handler to catch the exception
and tell you it was unhandled anyway.  I found some discussion about this at
this page:
http://www.dotnetmonster.com/Uwe/Forum.aspx/vs-net-ide/4729/Disabling-Just-m
y-code-changes-Debug-Exceptions-dialog.

 

This behavior can be disabled two ways:

-          Go to Tools|Options|Debugging|General and uncheck "Enable Just My
Code"

-          Go to Debugger|Exceptions and uncheck "User-handled" in the CLR
row

 

I was also missing the Debugger|Exceptions menu item, which was fixed by
adjusting my profile, which had this option disabled by default.
http://www.williamkent.net/archive/2007/09/12/exception-item-missing-from-my
-vs2005-debug-menu.aspx

 

Once this was sorted out, ANTLR works perfectly when parsing invalid
parser/lexer input.

 

Shawn Poulson

 

 

From: Shawn Poulson [mailto:spoulson at explodingcoder.com] 
Sent: Sunday, August 31, 2008 11:28 PM
To: 'antlr-interest at antlr.org'
Subject: C#: Unhandled NoViableAltexception from lexer

 

Hello all,

 

I'm struggling with what appears to be an unexpected behavior in my C# code.
When I attempt to parse a string with my grammar, it works as long as the
input is valid to my parser rules.  When the parser bawks at the input I get
an exception derived from RecognitionException and my code can handle
invalid input.  When the lexer bawks, I usually get a NoViableAltException
thrown that I'm also able to handle.

 

Except, in a specific case my code is unable to handle a
NoViableAltException within a try/catch block.  For example, my grammar does
not utilize semicolons anywhere.  So, if I feed it an input with a semi
anywhere in the input, the lexer will choke and throw a
NoViableAltException, as expected.  For some reason, even if my code
surrounds the ANTLR parser call with a try/catch(Exception) block, the
program execution halts with an unhandled exception.

 

I experienced this with ANTLR 3.0.1, in which case the exception was thrown
from the lexer's mTokens() method.  I noticed ANTLR 3.1 was released
recently, so I gave that a try and used the new CSharp2 target.  I get the
same exact symptom, with the exception being thrown from
Antlr3.Runtime.DFA.Predict().  In both revisions, I've browsed the code
using .NET Reflector and I don't see any funny business going on.  I don't
see any reason why a try/catch block cannot trap this exception!

 

I'm using VS 2008.  I've attempted with .NET 2.0 and .NET 3.5 framework
targets and got the same results.  If necessary, I can send a project that
replicates this issue.

 

Has anyone experienced this before?  Thanks.

 

Shawn Poulson

spoulson at explodingcoder.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080903/63b9048e/attachment.html 

From fridi70 at gmx.de  Thu Sep  4 04:19:24 2008
From: fridi70 at gmx.de (Fridi)
Date: Thu, 04 Sep 2008 13:19:24 +0200
Subject: [antlr-interest] How to use one tree grammar to generate C# and
	Java?
Message-ID: <48BFC43C.5010503@gmx.de>

Hi all,

i have a build a tree parser with ANTLR and the C# sources are 
generated. At runtime, the generated sources do the evaluation.
Of course by setting the language option I can generate Java as well. 
But in my rules, I have to change all data types, imports / usings and 
included sources.
I could copy the tree grammar and make one for C#, and the other for 
Java, but that means maintaining 2 grammars.
Is there a way - maybe using stringtemplate - to use 1 grammar that 
either emits C# or Java code?

Thanks in advance,
  fridi

From Dennis.Benzinger at gmx.net  Thu Sep  4 05:24:12 2008
From: Dennis.Benzinger at gmx.net (Dennis Benzinger)
Date: Thu, 04 Sep 2008 14:24:12 +0200
Subject: [antlr-interest] site back up
In-Reply-To: <9CB468B7-2126-482C-B91B-FE9576615736@cs.usfca.edu>
References: <1DDA3D5E-DD6E-4CD4-9A14-C62F6032D141@cs.usfca.edu>	<74A59D0E-CC54-4AEF-A2CA-B5B08D3EA6EA@cs.usfca.edu>
	<9CB468B7-2126-482C-B91B-FE9576615736@cs.usfca.edu>
Message-ID: <48BFD36C.2000306@gmx.net>

Hi!

Am 26.08.2008 03:10, Terence Parr schrieb:
> Back up...another case of HomePage.class reference in Java not  
> executing static initializer...i have to use new HomePage() dummy load  
> to get it to exec static {...}  Weird...i pushed .class files compiled  
> with 1.5 and it broke.  3 hours down the drain.  grrrrrrrrrrrrrrrrrr!
> [...]

I googled a bit and found out that the Java Language Specification never
promised that HomePage.class would initialize the class. It just worked
by coincidence in Java 1.4. This change between version 1.4 and version
5 is documented on http://java.sun.com/j2se/1.5.0/compatibility.html in
section "Incompatibilities in Java 2 Platform Standard Edition 5.0
(since 1.4.2)", item 5. This document also contains two workarounds for
the problem.

HTH,
Dennis Benzinger

From Larry.Jones at aspentech.com  Thu Sep  4 05:32:53 2008
From: Larry.Jones at aspentech.com (Jones, Larry)
Date: Thu, 4 Sep 2008 07:32:53 -0500
Subject: [antlr-interest] Translation of Parethesized / Unary Negative
	Expressions
Message-ID: <690A62A322DBE24FAD5208C158E5DF2E013A7053@houmail3.corp.aspentech.com>

I am translating from one languague to another.
 
My grammar is basically working; however, I just discovered an error in
translating a unary negative expression: "- b * 2 - c / 20". My
incorrect translation is "- (b * 2 - c / 20)."
 
The relavant parts of the combined grammar are:

	factor
	    : ...
	    | '(' expr ')' -> ^(PAREN expr)
	    | '+' expr -> expr          // unary '+'
	    | '-' expr -> ^(NEG expr)   // unary '-'
	    ;
	

The relevant parts of the tree grammar are:

	expr
	    : ...
	    | ^(NEG neg_expr=expr) -> negate(expr={$neg_expr.st})
// emits "- (expr)"
	    | ^(PAREN paren_expr=expr) -> paren(expr={$paren_expr.st})
// emits "(expr)"
	    ;
	

In addition, in the combined grammar, I used the "arithmetic expression
pattern" of encoding precedence in an expression, term, factor "tree"
and collapsing that tree into a single expression in the tree grammar.
 
I have two questions that I think are related. First, when tranlating
parenthesized expressions, I had to encode the parentheses (see the
PAREN imaginary token in my combined grammar) in order to emit the
correct parenthesized expression in the translated grammar. I'm
wondering if another technique exists to emit the correct translated
expression.
 
Second, as I mentioned at the beginning of the note, I translate unary
negative expressions incorrectly. Any examples on how to perform these
translations correctly?
 
Thanks.
 
--

Lawrence Allan Jones
Senior Developer / Technical Advisor
Aspen Technology, Inc.
2500 CityWest Blvd. Suite 1500
Houston, Texas 77042
USA
281-504-3324 (work)
281-504-3395 (fax)
larry.jones at aspentech.com
www.aspentech.com <http://www.aspentech.com/> 

 
 	
 

This e-mail and any attachments are intended only for use by the addressee(s) named herein and may contain legally privileged and/or confidential information. If you are not the intended recipient of this e-mail, you are hereby notified any dissemination, distribution or copying of this email, and any attachments thereto, is strictly prohibited. If you receive this email in error please immediately notify the sender and permanently delete the original copy and any copy of any e-mail, and any printout thereof.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080904/416b7641/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 2078 bytes
Desc: email_2_03.gif
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080904/416b7641/attachment.gif 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 200 bytes
Desc: email_2_04.gif
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080904/416b7641/attachment-0001.gif 

From Dennis.Benzinger at gmx.net  Thu Sep  4 05:35:05 2008
From: Dennis.Benzinger at gmx.net (Dennis Benzinger)
Date: Thu, 04 Sep 2008 14:35:05 +0200
Subject: [antlr-interest] [OT] Static initialization in Java
In-Reply-To: <813DE957-1280-4729-9D36-5102F0958319@classdump.org>
References: <1DDA3D5E-DD6E-4CD4-9A14-C62F6032D141@cs.usfca.edu>	<9CB468B7-2126-482C-B91B-FE9576615736@cs.usfca.edu>	<48B44B20.2000703@gmx.net>
	<200808261133.27031.rschulz@sonic.net> <48B45739.9000201@gmx.net>
	<813DE957-1280-4729-9D36-5102F0958319@classdump.org>
Message-ID: <48BFD5F9.9040500@gmx.net>

Am 27.08.2008 13:33, Kay R?pke schrieb:
> [...]
> Further poking around seems to indicate some compiler change between  
> 1.4 and 1.5 with regards to Foo.class. 
> [...]

Yes, the change is documented on
http://java.sun.com/j2se/1.5.0/compatibility.html in section
"Incompatibilities in Java 2 Platform Standard Edition 5.0 (since
1.4.2)", item 5.

> Using .class (which is syntax, not a field) doesn't seem to fit into  
> the section of the spec you referred to, so I'm afraid that's not  
> really helpful to understand this :(
> [...]

Why aren't they helpful? The cited section of the spec lists the reasons
for initialization of a class and referring to a class literal (e.g.
HomePage.class) is not listed. Therefore the Java Language Specification
doesn't promise that a class literal will trigger class initialization.
That's what I wanted to say. This is also documented in the link above.

Bye,
Dennis Benzinger

From r.a.niemeijer at tue.nl  Thu Sep  4 08:05:02 2008
From: r.a.niemeijer at tue.nl (Niemeijer, R.A.)
Date: Thu, 4 Sep 2008 17:05:02 +0200
Subject: [antlr-interest] Confused about type of edges attribute in stg files
Message-ID: <A8F615EE446C9B4D837FB67447C0D997026B9E90@EXCHANGE3.campus.tue.nl>

Hello everyone,

 

In the stg files in the org\antlr\codegen\templates\your_language folder
there are two functions where NoViableAltExceptions are generated:
dfaState and sfaStateSwitch. Both of these have an edges attribute,
which contain the if/switch statements that precede the
NoViableAltException. What I want to do (see also the "How to get a list
of all valid options for the next token?" discussion) is to get a list
of the numbers in those statements.

My approach of including <edges> in @" " (C#'s syntax for a string
literal) and applying a regular expression to it works for simple cases,
but if two of these sections are nested C# chokes on the nested quotes.
So I need to preprocess the edges variable somehow.

>From what I've been able to find it's not possible to use programming
code inside a stringtemplate, so something like
edges.toString().replace(...) is impossible (if it is possible I'd love
to hear how). So that leaves me with using the properties and such that
stringtemplate allows. To do this I need to know what type it is though.


According to the code in ACyclicDFACodeGenerator.java in
org\antlr\codegen its type should be StringTemplate, because of

dfaST.setAttribute("edges", edgeST);

and

StringTemplate edgeST = templates.getInstanceOf(dfaEdgeName);

 

However, if I put for instance <edges.version> in the stg file and try
to compile my grammar file with AntlrWorks I get an error that
STAttributeList doesn't have that property. Ok, apparently edges is an
STAttributeList (though how that follows from a StringTemplate is still
a mystery to me), which inherits from ArrayList, so I can access the
elements in edges with something like <edges:{e|<e>}>. But then what
type are the elements in edge?

 

So can anyone tell me the type of the elements in edges (or how to use a
replace/regex function on attributes in stg files)?

 

Thanks in advance.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080904/114b0961/attachment.html 

From cieslewski at hcs.ufl.edu  Thu Sep  4 09:26:09 2008
From: cieslewski at hcs.ufl.edu (Grzegorz Cieslewski)
Date: Thu, 4 Sep 2008 12:26:09 -0400
Subject: [antlr-interest] Possible problem with lists after upgrade to
	3.1
In-Reply-To: <001801c8fdd9$a4f83680$eee8a380$@com>
References: <7aa837f80808121810pf245397n10a41b7ec8912e9c@mail.gmail.com>
	<7E4A7724-90B1-4AA9-8CA5-FDBE264804D8@cs.usfca.edu>
	<605A2C1A-4251-4DB2-B589-43EC7051F843@cs.usfca.edu>
	<001801c8fdd9$a4f83680$eee8a380$@com>
Message-ID: <7aa837f80809040926k67e38b64y5cc34d5a6234a4de@mail.gmail.com>

Just a follow up on the Brent's comment.
I tried and I get similar errors with = operator as I used with += (I
used 2008-09-03 build)
For example:
(listA=number | listA=id) -> ^(EXPR $listA)

Does not want to compile:
found   : G4Parser.number_return
required: G4Parser.id_return
                  listA=number();

Greg




On Thu, Aug 14, 2008 at 2:47 AM, Foust <javafoust at gmail.com> wrote:
> Ter,
>
> Did you only fix it for the += operator and not =  ?
>
> Using today's build (listed below), there is still a compatibility issue
> using one label for two different rules. Is this a different issue?
>
>        expr : (t=a | t=b) c[$t.attr]?;
>
> The resulting Java code won't compile, since "t" is defined as the last type
> encountered, in this case "b":
>
>        MyGrammar.b_return attr = null;
>
>        later,
>                case 1: ...
>                        attr=a();               // error: Type Mismatch
>                        ...
>                case 2: ...
>                        attr=b();               // compiles
>                        ...
> Brent
>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Terence Parr
>> Sent: Wednesday, August 13, 2008 10:07 AM
>> To: Grzegorz Cieslewski
>> Cc: antlr ANTLR
>> Subject: Re: [antlr-interest] Possible problem with lists after upgrade
>> to 3.1
>>
>> Grab new antlr daily build:
>>
>> antlr-2008-08-13.10.tar.gz
>>
>> Fixed.
>>
>> Ter
>
>



-- 
=====================================================
Grzegorz Cieslewski
Research Assistant
High-performance Computing & Simulation (HCS) Research Laboratory
University of Florida, Dept. of Electrical and Computer Engineering
330 Benton Hall, Gainesville, FL, 32611-6200
Phone: (352) 392-9041
Email: cieslewski at hcs.ufl.edu
Web: www.hcs.ufl.edu
=====================================================

From parrt at cs.usfca.edu  Thu Sep  4 10:54:26 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 4 Sep 2008 10:54:26 -0700
Subject: [antlr-interest] TokenRewriteStream usage
In-Reply-To: <7D50572C73BC634F92EE211BFF16F4A1067CC9FE@USILMS12.ca.com>
References: <7D50572C73BC634F92EE211BFF16F4A1067CC89C@USILMS12.ca.com>	<881F8C1B-7C67-4355-823E-BA299627E42C@cs.usfca.edu>
	<7D50572C73BC634F92EE211BFF16F4A1067CC946@USILMS12.ca.com>
	<48bf6d04.092a400a.62b4.ffffa327@mx.google.com>
	<7D50572C73BC634F92EE211BFF16F4A1067CC9FE@USILMS12.ca.com>
Message-ID: <7BDEEC7B-CD97-4FB8-90A3-A8AD9192DA82@cs.usfca.edu>


On Sep 4, 2008, at 6:11 AM, Brisard, Fred D wrote:

> I?ve been testing under Eclipse using the JARs delivered with the  
> source distributable.  When I dropped the runtime jar and used the  
> classes generated by the Antlr3.1 project I defined in Eclipse the  
> problem with TokenRewriteStream went away.  It?s looking good at the  
> moment.
>
> I plan to test insert, delete, replace today.
>
> Is it possible to insert using a template?  When I insert a new  
> statement I?d like to use a template to describe the basic structure  
> for the statement.
>

Yep...designed to do that.  book describes or see mantra.
Ter


From parrt at cs.usfca.edu  Thu Sep  4 10:54:43 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 4 Sep 2008 10:54:43 -0700
Subject: [antlr-interest] Possible problem with lists after upgrade to
	3.1
In-Reply-To: <7aa837f80809040926k67e38b64y5cc34d5a6234a4de@mail.gmail.com>
References: <7aa837f80808121810pf245397n10a41b7ec8912e9c@mail.gmail.com>
	<7E4A7724-90B1-4AA9-8CA5-FDBE264804D8@cs.usfca.edu>
	<605A2C1A-4251-4DB2-B589-43EC7051F843@cs.usfca.edu>
	<001801c8fdd9$a4f83680$eee8a380$@com>
	<7aa837f80809040926k67e38b64y5cc34d5a6234a4de@mail.gmail.com>
Message-ID: <70EAF02C-EA02-4F5A-A38D-242C134F4907@cs.usfca.edu>

fixed in 3.1.1 already :)Sorry for that
Ter
On Sep 4, 2008, at 9:26 AM, Grzegorz Cieslewski wrote:

> Just a follow up on the Brent's comment.
> I tried and I get similar errors with = operator as I used with += (I
> used 2008-09-03 build)
> For example:
> (listA=number | listA=id) -> ^(EXPR $listA)
>
> Does not want to compile:
> found   : G4Parser.number_return
> required: G4Parser.id_return
>                  listA=number();
>
> Greg
>
>
>
>
> On Thu, Aug 14, 2008 at 2:47 AM, Foust <javafoust at gmail.com> wrote:
>> Ter,
>>
>> Did you only fix it for the += operator and not =  ?
>>
>> Using today's build (listed below), there is still a compatibility  
>> issue
>> using one label for two different rules. Is this a different issue?
>>
>>       expr : (t=a | t=b) c[$t.attr]?;
>>
>> The resulting Java code won't compile, since "t" is defined as the  
>> last type
>> encountered, in this case "b":
>>
>>       MyGrammar.b_return attr = null;
>>
>>       later,
>>               case 1: ...
>>                       attr=a();               // error: Type Mismatch
>>                       ...
>>               case 2: ...
>>                       attr=b();               // compiles
>>                       ...
>> Brent
>>
>>> -----Original Message-----
>>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>>> bounces at antlr.org] On Behalf Of Terence Parr
>>> Sent: Wednesday, August 13, 2008 10:07 AM
>>> To: Grzegorz Cieslewski
>>> Cc: antlr ANTLR
>>> Subject: Re: [antlr-interest] Possible problem with lists after  
>>> upgrade
>>> to 3.1
>>>
>>> Grab new antlr daily build:
>>>
>>> antlr-2008-08-13.10.tar.gz
>>>
>>> Fixed.
>>>
>>> Ter
>>
>>
>
>
>
> -- 
> =====================================================
> Grzegorz Cieslewski
> Research Assistant
> High-performance Computing & Simulation (HCS) Research Laboratory
> University of Florida, Dept. of Electrical and Computer Engineering
> 330 Benton Hall, Gainesville, FL, 32611-6200
> Phone: (352) 392-9041
> Email: cieslewski at hcs.ufl.edu
> Web: www.hcs.ufl.edu
> =====================================================
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From parrt at cs.usfca.edu  Thu Sep  4 10:56:04 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 4 Sep 2008 10:56:04 -0700
Subject: [antlr-interest] How to use one tree grammar to generate C# and
	Java?
In-Reply-To: <48BFC43C.5010503@gmx.de>
References: <48BFC43C.5010503@gmx.de>
Message-ID: <05CD63A8-90C7-4B6F-BA52-2F435D17CC4F@cs.usfca.edu>


On Sep 4, 2008, at 4:19 AM, Fridi wrote:

> Hi all,
>
> i have a build a tree parser with ANTLR and the C# sources are
> generated. At runtime, the generated sources do the evaluation.
> Of course by setting the language option I can generate Java as well.
> But in my rules, I have to change all data types, imports / usings and
> included sources.
> I could copy the tree grammar and make one for C#, and the other for
> Java, but that means maintaining 2 grammars.
> Is there a way - maybe using stringtemplate - to use 1 grammar that
> either emits C# or Java code?

Sure. ANTLR itself Does that...you have a StringTemplateGroup pointer  
that refers to one of two groups.  ANTLR's -> foo(...) notation loads  
template foo from the appropriate group. no fuss no muss.
Ter

From jarrod at vertigrated.com  Thu Sep  4 14:25:21 2008
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Thu, 4 Sep 2008 17:25:21 -0400
Subject: [antlr-interest] Ok I got a working lexer and parser as per the
	tutorial how do I make it actually generate something?
Message-ID: <fa3d0c740809041425g1b277a3dwcaab6942de28f30e@mail.gmail.com>

I have this grammar file.

grammar SimpleCalc;

tokens {
    PLUS = '+';
    MINUS = '-';
    MULT = '*';
    DIV = '/';
    }

@members {
    public static void main(final String[] args) throws Exception {
        SimpleCalcLexer lex = new SimpleCalcLexer(new
ANTLRFileStream(args[0]));
           CommonTokenStream tokens = new CommonTokenStream(lex);

        SimpleCalcParser parser = new SimpleCalcParser(tokens);

        try {
            parser.expr();
        } catch (RecognitionException e)  {
            e.printStackTrace();
        }
    }
}

/* Parser Rules */

expr    :    term ((PLUS | MINUS) term)*;

term     :    factor ((MULT | DIV) factor)*;

factor     :     NUMBER;

/* Lexer Rules */

NUMBER     :     (DIGIT)+;

WHITESPACE
    :    ( '\t' | ' ' | '\r' | '\n' | '\u000C') + { $channel = HIDDEN; } ;

fragment DIGIT
    :     '0'..'9' ;

I have a test harness main() function that parses my input file when I call
parser.expr()

What I am having a hard time finding is information on how to make it
actually ACT on what I have parsed.
I have been searching Google for over 2 hours, reading every link that looks
even remotely informative.

I am using the Java target language.

I eventually want to be able to learn enough to write a parser for my own
language syntax to cross "compile" to another language.

So I really need to understand how to emit something from the parser.

Thanks in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080904/4eeb2dcf/attachment.html 

From ron.hunter-duvar at oracle.com  Thu Sep  4 15:21:30 2008
From: ron.hunter-duvar at oracle.com (Ron Hunter-Duvar)
Date: Thu, 04 Sep 2008 16:21:30 -0600
Subject: [antlr-interest] Possible general solution to problem of keywords
	as identifiers
Message-ID: <48C05F6A.7090503@oracle.com>

Hi,

I've been pondering the problem of languages (such as SQL) where 
keywords are not reserved, and so can be used as identifiers. It seems 
to keep coming up, and the current solutions (such as the two described 
at http://www.antlr.org/wiki/pages/viewpage.action?pageId=1741) are 
ugly, and create maintenance issues (yeah, I know there are ways to work 
around the maintenance problem, but it's still ugly). I think I've come 
up with a general solution, or at least one key piece of one. But maybe 
I'm missing something that would make it unworkable, so I thought I'd 
run it by the experts.

My idea is to override the match(IntStream input, int ttype, BitSet 
follow) method in BaseRecognizer so that it checks for identifiers that 
should be treated keywords, or vice versa (depending on whether the 
lexer would be returning keywords as identifiers or identifiers as 
keywords). It would have to know (through some back channel like a 
constant definition) which token type represented identifiers.

If the lexer were written to always return identifiers, not keywords 
(which makes for a simpler and possibly faster lexer), the keywords 
would have to be separately defined as token types. Then match could be 
modified so that when the input token is an identifier, and the token 
type it is to match against is a keyword, then it would check for string 
equality and treat it as a match if equal. That is, the condition:

    if ( input.LA(1)==ttype ) {

would become something like:

    if ( input.LA(1)==ttype || (input.LA(1)==IDENTIFIER_TTYPE && 
input.LT(1).equals(tokenText(ttype)))) {

where "tokenText(ttype)" is some method for looking up the token text 
corresponding to the integer token type (not sure if there's already a 
way to do this).

Conversely, if the lexer always gave preference to returning keywords, 
then match would be modified to check for keywords that should be 
treated as identifiers, something like this:

    if ( input.LA(1)==ttype || (ttype==IDENTIFIER_TTYPE && 
isKeywordType(input.LA(1)))) {

where "isKeywordType(input.LA(1)" somehow checks (perhaps with a hash 
table) that the input token type is a keyword that could be interpreted 
as an identifier. This approach might suffer from the same maintenance 
issues that the current approaches do.

I'm more confident that the first approach would work correctly. In 
particular, that it could correctly handle situations where an 
identifier or one or more keywords are legal at the same point. 
Basically, it should recognize any legal keywords preferentially (as 
this is generally how such languages must resolve such ambiguities), and 
only treat it as an identifier otherwise. I guess this would require 
that all keywords be checked as alternatives before checking for an 
identifier, which perhaps adds a certain amount of fragility to the 
grammars.

It's too bad the parser doesn't have the first sets available at run 
time, as it does the follow sets - these could be used to check for 
valid keywords at that point, before treating it as an identifier. This 
would eliminate the checking-order constraint, making it even more general.

If this approach is workable, I could even see adding support for it as 
an option to Antlr.

Let me know if you see some fatal flaw in this approach that I haven't seen.

Thanks,
Ron

-- 
Ron Hunter-Duvar | Software Developer V | 403-272-6580
Oracle Service Engineering
Gulf Canada Square 401 - 9th Avenue S.W., Calgary, AB, Canada T2P 3C5

All opinions expressed here are mine, and do not necessarily represent
those of my employer.


From antlr at mirality.co.nz  Fri Sep  5 00:53:15 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 05 Sep 2008 19:53:15 +1200
Subject: [antlr-interest] Ok I got a working lexer and parser as per the
 tutorial how do I make it actually generate something?
In-Reply-To: <fa3d0c740809041425g1b277a3dwcaab6942de28f30e@mail.gmail.co
 m>
References: <fa3d0c740809041425g1b277a3dwcaab6942de28f30e@mail.gmail.com>
Message-ID: <20080905075338.6A22A11ED8A@www.antlr.org>

At 09:25 5/09/2008, Jarrod Roberson wrote:
>What I am having a hard time finding is information on how to 
>make it actually ACT on what I have parsed.

There are several different ways to act in the parser.

The simplest is to simply put actions directly into the parser:

expr : a=term { SetInitialTerm($a.value); }
   ( (o=PLUS | o=MINUS) b=term { PerformOperation($o, $b.value); } 
)*

term returns [int value]: ...;

While simple (in that there are no other files to worry about), 
this can sometimes lead to

Other options are to use "output=template" and then specify 
StringTemplate outputs for each rule, or to use "output=AST" and 
add tree construction operators or rewrites (and optionally write 
a tree walker grammar that in turn uses direct actions or 
StringTemplate to do things).

Examples of all of these approaches are shown in the examples 
archive on the downloads page, and you can find quick references 
to most of the functionality in the Wiki.  For a detailed 
explanation you'll probably want to get the ANTLR book, though.


From antlr at mirality.co.nz  Fri Sep  5 01:01:10 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 05 Sep 2008 20:01:10 +1200
Subject: [antlr-interest] Possible general solution to problem of
 keywords as identifiers
In-Reply-To: <48C05F6A.7090503@oracle.com>
References: <48C05F6A.7090503@oracle.com>
Message-ID: <20080905080116.BA2E02F4314@www.antlr.org>

At 10:21 5/09/2008, Ron Hunter-Duvar wrote:
 >Conversely, if the lexer always gave preference to returning
 >keywords, then match would be modified to check for keywords
 >that should be treated as identifiers, something like this:
 >
 >    if ( input.LA(1)==ttype || (ttype==IDENTIFIER_TTYPE &&
 >isKeywordType(input.LA(1)))) {
 >
 >where "isKeywordType(input.LA(1)" somehow checks (perhaps with a 

 >hash table) that the input token type is a keyword that could be 

 >interpreted as an identifier. This approach might suffer from
 >the same maintenance issues that the current approaches do.

Rather than doing that, you could just as easily write this parser 
rule:

identifier
     :  { isKeywordType(input.LA(1)) }? => .
     |  IDENTIFIER
     ;

Or simply list all the possible keywords:

identifier
     :  IDENTIFIER
     |  KEYWORD1 | KEYWORD2 | KEYWORD3 | KEYWORD4 | ...
     ;

(I normally go for the second option.  It seems cleaner.)

I don't think this is all that much of a maintenance hassle... 
after all, how often do you add keywords to an existing language?

This approach is also fully compatible with backtracking or 
syntactic predicates, so you can easily resolve the more ambiguous 
cases.


From Ronghui.Yu at SierraAtlantic.com  Fri Sep  5 02:25:51 2008
From: Ronghui.Yu at SierraAtlantic.com (Ronghui Yu)
Date: Fri, 5 Sep 2008 17:25:51 +0800
Subject: [antlr-interest] How to remove this kind of warning
Message-ID: <002e01c90f39$64a44710$4307430a@RYUSA>

 no lexer rule corresponding to token: IP_Address

Everytime when I define a token in token section, it always issues this kind of warning.
I hate warnings, is there any way to remove it?
Thanks!

==============================
Regards,
Ronghui Yu
Sierra Atlantic

__________________________________________________________________________________________________________________
DISCLAIMER:"The information contained in this message and the attachments (if any) may be privileged and confidential and protected from disclosure. You are hereby notified that any unauthorized use, dissemination, distribution or copying of this communication, review, retransmission, or taking of any action based upon this information, by persons or entities other than the intended recipient, is strictly prohibited. If you are not the intended recipient or an employee or agent responsible for delivering this message, and have received this communication in error, please notify us immediately by replying to the message and kindly delete the original message, attachments, if any, and all its copies from your computer system. Thank you for your cooperation." 
________________________________________________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/8df4161f/attachment.html 

From jaluber at gmx.de  Fri Sep  5 02:41:01 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 05 Sep 2008 11:41:01 +0200
Subject: [antlr-interest] Ok I got a working lexer and parser as per the
 tutorial how do I make it actually generate something?
In-Reply-To: <20080905075338.6A22A11ED8A@www.antlr.org>
References: <fa3d0c740809041425g1b277a3dwcaab6942de28f30e@mail.gmail.com>
	<20080905075338.6A22A11ED8A@www.antlr.org>
Message-ID: <48C0FEAD.9080302@gmx.de>

Gavin Lambert schrieb:
...
> While simple (in that there are no other files to worry about), 
> this can sometimes lead to

You have forgotten some text. I guess you mean that it can lead to big
grammars which aren't nice to maintain?

Johannes

From jimi at temporal-wave.com  Fri Sep  5 06:59:40 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 05 Sep 2008 06:59:40 -0700
Subject: [antlr-interest] How to remove this kind of warning
In-Reply-To: <002e01c90f39$64a44710$4307430a@RYUSA>
References: <002e01c90f39$64a44710$4307430a@RYUSA>
Message-ID: <1220623180.4791.13.camel@jimi>

On Fri, 2008-09-05 at 17:25 +0800, Ronghui Yu wrote:
>  no lexer rule corresponding to token: IP_Address
>  
> Everytime when I define a token in token section, it always issues
> this kind of warning.
> I hate warnings, is there any way to remove it?


Don't define it in the tokens section, but as a lexer rule and it will
go away.

Jim
> Thanks!
>  
> ==============================
> Regards,
> Ronghui Yu
> Sierra Atlantic
> 
> 
> __________________________________________________________________________________________________________________
> DISCLAIMER:"The information contained in this message and the
> attachments (if any) may be privileged and confidential and protected
> from disclosure. You are hereby notified that any unauthorized use,
> dissemination, distribution or copying of this communication, review,
> retransmission, or taking of any action based upon this information,
> by persons or entities other than the intended recipient, is strictly
> prohibited. If you are not the intended recipient or an employee or
> agent responsible for delivering this message, and have received this
> communication in error, please notify us immediately by replying to
> the message and kindly delete the original message, attachments, if
> any, and all its copies from your computer system. Thank you for your
> cooperation." 
> ________________________________________________________________________________________________________________
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/0302649e/attachment.html 

From Ronghui.Yu at sierraatlantic.com  Fri Sep  5 07:15:48 2008
From: Ronghui.Yu at sierraatlantic.com (Ronghui Yu)
Date: Fri, 5 Sep 2008 22:15:48 +0800
Subject: [antlr-interest] How to remove this kind of warning
References: <002e01c90f39$64a44710$4307430a@RYUSA>
	<1220623180.4791.13.camel@jimi>
Message-ID: <A4F99107A4543747902F5E6B65FBFD19126A67@cngzex.CN.corp.sa>

I would like to have it as a lexer rule, but in my parser, there is a Floating_Point_Constant like
 
Floating_Point_Constant:
   ('0'..'9')+ '.' ('0'..'9')* ('e'|'E')?;

Then when an IP appears in the stream, it is divided into serveral floating point tokens, but not a complete IP token

Then I rewrite this rule to deal with double cases

Floating_Point_Constant:

  ('0'..'9')+ '.' 

  (

       (('0'..'9')+ '.' ('0'..'9')+ '.' ('0'..'9')+) => ('0'..'9')+ '.' ('0'..'9')+ '.' ('0'..'9')+ {$type=IP_Address;}

       |

       ('0'..'9')* ('e'|'E')?;

  )

;

This rule can deal with both cases well, but I need to define a token IP_Address first, then comes the story.

If I define two rules for floating point and ip address respectively, seems one of them doesn't work properly.

 

________________________________

From: Jim Idle [mailto:jimi at temporal-wave.com]
Sent: 2008-9-5 (???) 21:59
To: Ronghui Yu
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] How to remove this kind of warning


On Fri, 2008-09-05 at 17:25 +0800, Ronghui Yu wrote: 

	 no lexer rule corresponding to token: IP_Address 

	Everytime when I define a token in token section, it always issues this kind of warning. 

	I hate warnings, is there any way to remove it?
	


Don't define it in the tokens section, but as a lexer rule and it will go away.

Jim 

	Thanks! 

	==============================
	Regards,
	Ronghui Yu
	Sierra Atlantic 


	__________________________________________________________________________________________________________________
	DISCLAIMER:"The information contained in this message and the attachments (if any) may be privileged and confidential and protected from disclosure. You are hereby notified that any unauthorized use, dissemination, distribution or copying of this communication, review, retransmission, or taking of any action based upon this information, by persons or entities other than the intended recipient, is strictly prohibited. If you are not the intended recipient or an employee or agent responsible for delivering this message, and have received this communication in error, please notify us immediately by replying to the message and kindly delete the original message, attachments, if any, and all its copies from your computer system. Thank you for your cooperation." 
	________________________________________________________________________________________________________________ 
	List: http://www.antlr.org/mailman/listinfo/antlr-interest
	Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
	


__________________________________________________________________________________________________________________
DISCLAIMER:"The information contained in this message and the attachments (if any) may be privileged and confidential and protected from disclosure. You are hereby notified that any unauthorized use, dissemination, distribution or copying of this communication, review, retransmission, or taking of any action based upon this information, by persons or entities other than the intended recipient, is strictly prohibited. If you are not the intended recipient or an employee or agent responsible for delivering this message, and have received this communication in error, please notify us immediately by replying to the message and kindly delete the original message, attachments, if any, and all its copies from your computer system. Thank you for your cooperation." 
________________________________________________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/16e14f13/attachment.html 

From antlr at mirality.co.nz  Fri Sep  5 07:22:47 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 06 Sep 2008 02:22:47 +1200
Subject: [antlr-interest] Ok I got a working lexer and parser as per the
 tutorial how do I make it actually generate something?
In-Reply-To: <48C0FEAD.9080302@gmx.de>
References: <fa3d0c740809041425g1b277a3dwcaab6942de28f30e@mail.gmail.com>
	<20080905075338.6A22A11ED8A@www.antlr.org>
	<48C0FEAD.9080302@gmx.de>
Message-ID: <20080905142257.977ED11ED35@www.antlr.org>

At 21:41 5/09/2008, Johannes Luber wrote:
 >Gavin Lambert schrieb:
 >...
 >> While simple (in that there are no other files to worry 
about),
 >> this can sometimes lead to
 >
 >You have forgotten some text. I guess you mean that it can lead 
to
 >big grammars which aren't nice to maintain?

I think I was going more for "obscurely-worded rules", but I guess 
that's basically the same thing, yeah :)


From antlr at mirality.co.nz  Fri Sep  5 07:26:47 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 06 Sep 2008 02:26:47 +1200
Subject: [antlr-interest] How to remove this kind of warning
In-Reply-To: <A4F99107A4543747902F5E6B65FBFD19126A67@cngzex.CN.corp.sa>
References: <002e01c90f39$64a44710$4307430a@RYUSA>
	<1220623180.4791.13.camel@jimi>
	<A4F99107A4543747902F5E6B65FBFD19126A67@cngzex.CN.corp.sa>
Message-ID: <20080905142700.2A41011EDCB@www.antlr.org>

At 02:15 6/09/2008, Ronghui Yu wrote:
>I would like to have it as a lexer rule, but in my parser, there 
>is a Floating_Point_Constant like
>
>Floating_Point_Constant:
>    ('0'..'9')+ '.' ('0'..'9')* ('e'|'E')?;
[...]
>This rule can deal with both cases well, but I need to define a 
>token IP_Address first, then comes the story.
>If I define two rules for floating point and ip address 
>respectively, seems one of them doesn't work properly.

You need to declare the IP_Address rule as a fragment, so it's not 
a top-level output candidate:

fragment IP_Address: '0';

(The actual contents of this rule don't really matter, except that 
they can't be empty.  It's sometimes helpful from a readability 
perspective to make it look kind of like what it really will be 
matching, but all that'll end up doing is increasing the code 
size, since it'll never actually be called.)


From jimi at temporal-wave.com  Fri Sep  5 08:20:26 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 05 Sep 2008 08:20:26 -0700
Subject: [antlr-interest] How to remove this kind of warning
In-Reply-To: <A4F99107A4543747902F5E6B65FBFD19126A67@cngzex.CN.corp.sa>
References: <002e01c90f39$64a44710$4307430a@RYUSA>
	<1220623180.4791.13.camel@jimi>
	<A4F99107A4543747902F5E6B65FBFD19126A67@cngzex.CN.corp.sa>
Message-ID: <1220628026.4791.15.camel@jimi>

On Fri, 2008-09-05 at 22:15 +0800, Ronghui Yu wrote:
> I would like to have it as a lexer rule, but in my parser, there is a
> Floating_Point_Constant like
>  
> Floating_Point_Constant:
>    ('0'..'9')+ '.' ('0'..'9')* ('e'|'E')?;
> 
> Then when an IP appears in the stream, it is divided into serveral
> floating point tokens, but not a complete IP token
> 
> Then I rewrite this rule to deal with double cases
> 


fragment
IP_Address : ;


> Floating_Point_Constant:
> 
>   ('0'..'9')+ '.' 
> 
>   (
> 
>        (('0'..'9')+ '.' ('0'..'9')+ '.' ('0'..'9')+) => ('0'..'9')+
> '.' ('0'..'9')+ '.' ('0'..'9')+ {$type=IP_Address;}
> 
>        |
> 
>        ('0'..'9')* ('e'|'E')?;
> 
>   )
> 
> ;
> 
> This rule can deal with both cases well, but I need to define a token
> IP_Address first, then comes the story.
> 
> 
> If I define two rules for floating point and ip address respectively,
> seems one of them doesn't work properly.
> 
>  
> 
> 
> ______________________________________________________________________
> From: Jim Idle [mailto:jimi at temporal-wave.com]
> Sent: 2008-9-5 (???) 21:59
> To: Ronghui Yu
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] How to remove this kind of warning
> 
> 
> On Fri, 2008-09-05 at 17:25 +0800, Ronghui Yu wrote: 
> 
> >  no lexer rule corresponding to token: IP_Address 
> > Everytime when I define a token in token section, it always issues
> > this kind of warning. 
> > I hate warnings, is there any way to remove it?
> 
> 
> Don't define it in the tokens section, but as a lexer rule and it will
> go away.
> 
> Jim 
> 
> > Thanks! 
> > ==============================
> > Regards,
> > Ronghui Yu
> > Sierra Atlantic 
> > 
> > __________________________________________________________________________________________________________________
> > DISCLAIMER:"The information contained in this message and the
> > attachments (if any) may be privileged and confidential and
> > protected from disclosure. You are hereby notified that any
> > unauthorized use, dissemination, distribution or copying of this
> > communication, review, retransmission, or taking of any action based
> > upon this information, by persons or entities other than the
> > intended recipient, is strictly prohibited. If you are not the
> > intended recipient or an employee or agent responsible for
> > delivering this message, and have received this communication in
> > error, please notify us immediately by replying to the message and
> > kindly delete the original message, attachments, if any, and all its
> > copies from your computer system. Thank you for your cooperation." 
> > ________________________________________________________________________________________________________________ 
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> > 
> 
> 
> __________________________________________________________________________________________________________________
> DISCLAIMER:"The information contained in this message and the
> attachments (if any) may be privileged and confidential and protected
> from disclosure. You are hereby notified that any unauthorized use,
> dissemination, distribution or copying of this communication, review,
> retransmission, or taking of any action based upon this information,
> by persons or entities other than the intended recipient, is strictly
> prohibited. If you are not the intended recipient or an employee or
> agent responsible for delivering this message, and have received this
> communication in error, please notify us immediately by replying to
> the message and kindly delete the original message, attachments, if
> any, and all its copies from your computer system. Thank you for your
> cooperation." 
> ________________________________________________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/16a5c39d/attachment.html 

From Waverly.Edwards at genesys.com  Fri Sep  5 09:01:18 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Fri, 5 Sep 2008 12:01:18 -0400
Subject: [antlr-interest] How to remove this kind of warning
In-Reply-To: <1220628026.4791.15.camel@jimi>
References: <002e01c90f39$64a44710$4307430a@RYUSA><1220623180.4791.13.camel@jimi><A4F99107A4543747902F5E6B65FBFD19126A67@cngzex.CN.corp.sa>
	<1220628026.4791.15.camel@jimi>
Message-ID: <FF993752CB890B4EB591BE5450C37BF1014623E2@navamane001.ad.internal.corp>

I don't think I understand this.  Shouldn't IP address be defined as 
 
IPFRAG '.' IPFRAG '.' IPFRAG ''.' IPFRAG
 
where IPFRAG is fragment constrained to a maximum 3 digit integer 
You could later check to see if that value is 255 or less.
 
Would you look ahead to see if there were four dotted decimal integers before deciding to treat a number as a floating point or ip address?
Would that be painfully slow to check every time you came across a potential floating point number?
 
 
W.

________________________________

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Friday, September 05, 2008 11:20 AM
To: Ronghui Yu
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] How to remove this kind of warning


On Fri, 2008-09-05 at 22:15 +0800, Ronghui Yu wrote: 

	I would like to have it as a lexer rule, but in my parser, there is a Floating_Point_Constant like 

	Floating_Point_Constant: 

	   ('0'..'9')+ '.' ('0'..'9')* ('e'|'E')?; 

	Then when an IP appears in the stream, it is divided into serveral floating point tokens, but not a complete IP token
	
	Then I rewrite this rule to deal with double cases
	
	


fragment
IP_Address : ;



	Floating_Point_Constant:
	
	  ('0'..'9')+ '.' 
	
	  (
	
	       (('0'..'9')+ '.' ('0'..'9')+ '.' ('0'..'9')+) => ('0'..'9')+ '.' ('0'..'9')+ '.' ('0'..'9')+ {$type=IP_Address;}
	
	       |
	
	       ('0'..'9')* ('e'|'E')?;
	
	  )
	
	;
	
	This rule can deal with both cases well, but I need to define a token IP_Address first, then comes the story.
	
	

	If I define two rules for floating point and ip address respectively, seems one of them doesn't work properly. 


	  


________________________________


	From: Jim Idle [mailto:jimi at temporal-wave.com]
	Sent: 2008-9-5 (???) 21:59
	To: Ronghui Yu
	Cc: antlr-interest at antlr.org
	Subject: Re: [antlr-interest] How to remove this kind of warning
	
	
	

	On Fri, 2008-09-05 at 17:25 +0800, Ronghui Yu wrote: 
	

		 no lexer rule corresponding to token: IP_Address 
		Everytime when I define a token in token section, it always issues this kind of warning. 
		I hate warnings, is there any way to remove it?
		


	Don't define it in the tokens section, but as a lexer rule and it will go away.
	
	Jim 
	

		Thanks! 
		==============================
		Regards,
		Ronghui Yu
		Sierra Atlantic 
		
		__________________________________________________________________________________________________________________
		DISCLAIMER:"The information contained in this message and the attachments (if any) may be privileged and confidential and protected from disclosure. You are hereby notified that any unauthorized use, dissemination, distribution or copying of this communication, review, retransmission, or taking of any action based upon this information, by persons or entities other than the intended recipient, is strictly prohibited. If you are not the intended recipient or an employee or agent responsible for delivering this message, and have received this communication in error, please notify us immediately by replying to the message and kindly delete the original message, attachments, if any, and all its copies from your computer system. Thank you for your cooperation." 
		________________________________________________________________________________________________________________ 
		List: http://www.antlr.org/mailman/listinfo/antlr-interest
		Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
		


	__________________________________________________________________________________________________________________
	DISCLAIMER:"The information contained in this message and the attachments (if any) may be privileged and confidential and protected from disclosure. You are hereby notified that any unauthorized use, dissemination, distribution or copying of this communication, review, retransmission, or taking of any action based upon this information, by persons or entities other than the intended recipient, is strictly prohibited. If you are not the intended recipient or an employee or agent responsible for delivering this message, and have received this communication in error, please notify us immediately by replying to the message and kindly delete the original message, attachments, if any, and all its copies from your computer system. Thank you for your cooperation." 
	________________________________________________________________________________________________________________ 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/8566ddff/attachment.html 

From hallorant at gmail.com  Fri Sep  5 12:44:31 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Fri, 5 Sep 2008 15:44:31 -0400
Subject: [antlr-interest] Antlr Book Chapter 3 troubles
Message-ID: <a36ab4bc0809051244x785a688bj7841dd2608a0a8e4@mail.gmail.com>

I'm having trouble trying to get the tree grammar example in Chapter 3 to
work,  I get a NPE when I try to generate code for  my Eval.g in ANTLRWorks.
 I have changed the output directory to "." in the ANTLRWorks settings.
Here is the file:

tree grammar Eval;

options {
  tokenVocab=Expr;
  ASTLabelType=CommonTree;
}

@header {
import java.util.HashMap;
}
@members {
final HashMap<String,Integer> f_memory = new HashMap<String,Integer>();
}
expr returns [int value]
: ^('+' a=expr b=expr) {$value = a+b;}
| ^('-' a=expr b=expr) {$value = a-b;}
| ^('*' a=expr b=expr) {$value = a*b;}
| ID {
final Integer v = f_memory.get($ID.text);
if (v != null)
  $value = v.intValue();
else
  System.err.println("undefined variable " + $ID.text);
}
| INT {$value = Integer.parseInt($INT.text);}
;
prog : stat+
;
stat
: expr {System.out.println($expr.value);}
| ^('=' ID.expr) {f_memory.put($ID.text, $expr.value);}
;

In the tool (downloaded today):

[15:36:23] Checking Grammar...

The grammar checks oky-doky...but when I try to generate the code

[15:36:28] error(10):  internal error: /Users/tim/Source/antlr-Work/Ch3 Expr
AST/src/Eval.g : java.lang.NullPointerException
org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:1959)
org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:2158)
org.antlr.codegen.CodeGenTreeWalker.element(CodeGenTreeWalker.java:1684)
org.antlr.codegen.CodeGenTreeWalker.tree(CodeGenTreeWalker.java:2252)
org.antlr.codegen.CodeGenTreeWalker.element(CodeGenTreeWalker.java:1609)
org.antlr.codegen.CodeGenTreeWalker.alternative(CodeGenTreeWalker.java:1288)
org.antlr.codegen.CodeGenTreeWalker.block(CodeGenTreeWalker.java:1063)
org.antlr.codegen.CodeGenTreeWalker.rule(CodeGenTreeWalker.java:779)
org.antlr.codegen.CodeGenTreeWalker.rules(CodeGenTreeWalker.java:570)
org.antlr.codegen.CodeGenTreeWalker.grammarSpec(CodeGenTreeWalker.java:512)
org.antlr.codegen.CodeGenTreeWalker.grammar(CodeGenTreeWalker.java:318)
org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:426)
org.antlr.Tool.generateRecognizer(Tool.java:419)
org.antlr.Tool.process(Tool.java:286)
org.antlr.works.generate.CodeGenerate.generate(Unknown Source)
org.antlr.works.generate.CodeGenerate.run(Unknown Source)
java.lang.Thread.run(Thread.java:637)

The Expr.tokens file contains:

WS=7

NEWLINE=4

T__12=12

T__11=11

T__13=13

T__10=10

INT=6

ID=5

T__9=9

T__8=8

'='=8

'('=12

'*'=11

'-'=10

'+'=9

')'=13


Any ideas?


Best regards,

Tim Halloran
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/2dcada3a/attachment.html 

From parrt at cs.usfca.edu  Fri Sep  5 13:17:03 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 5 Sep 2008 13:17:03 -0700
Subject: [antlr-interest] Antlr Book Chapter 3 troubles
In-Reply-To: <a36ab4bc0809051244x785a688bj7841dd2608a0a8e4@mail.gmail.com>
References: <a36ab4bc0809051244x785a688bj7841dd2608a0a8e4@mail.gmail.com>
Message-ID: <0BAEA6CE-ED8B-4B4A-B83D-29F9232F4A2B@cs.usfca.edu>


On Sep 5, 2008, at 12:44 PM, Tim Halloran wrote:
> [15:36:28] error(10):  internal error: /Users/tim/Source/antlr-Work/ 
> Ch3 Expr AST/src/Eval.g : java.lang.NullPointerException
> org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:1959)

I don't see rule atom.

Ter
>

From Waverly.Edwards at genesys.com  Fri Sep  5 13:25:38 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Fri, 5 Sep 2008 16:25:38 -0400
Subject: [antlr-interest] multilingual IDE
Message-ID: <FF993752CB890B4EB591BE5450C37BF10146247C@navamane001.ad.internal.corp>


This may be off topic but when people refer to multilingual IDE and
Unicode, is this ever used within the editor?
I understand menus, buttons or other controls.  Would the source code
ever need to be encoded other than
ASCII?  My question really boils down to is in source code would you
ever see variables, quoted strings or
comments in an encoding other than ASCII? I am ignorant on this subject
but I also cant seem to find any
examples that would lead me in any direction.  Are non-Latin based
language speakers forced to use ASCII
only encoding?


Insights of all kinds very much welcome.


W.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/c4658938/attachment.html 

From jimi at temporal-wave.com  Fri Sep  5 13:26:53 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 05 Sep 2008 13:26:53 -0700
Subject: [antlr-interest] Antlr Book Chapter 3 troubles
In-Reply-To: <0BAEA6CE-ED8B-4B4A-B83D-29F9232F4A2B@cs.usfca.edu>
References: <a36ab4bc0809051244x785a688bj7841dd2608a0a8e4@mail.gmail.com>
	<0BAEA6CE-ED8B-4B4A-B83D-29F9232F4A2B@cs.usfca.edu>
Message-ID: <1220646413.4791.78.camel@jimi>

On Fri, 2008-09-05 at 13:17 -0700, Terence Parr wrote:

> On Sep 5, 2008, at 12:44 PM, Tim Halloran wrote:
> > [15:36:28] error(10):  internal error: /Users/tim/Source/antlr-Work/ 
> > Ch3 Expr AST/src/Eval.g : java.lang.NullPointerException
> > org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:1959)
> 
> I don't see rule atom.


That's the ANTLR stack trace not the grammar trace. This is happening
because something in the input source for the tree grammar is wrong, but
the v3 grammar doesn't catch it and produces a tree that causes NPE.

At the moment, the only way to work out what it is, is to remove your
actions one at a time and try, then remove any parameters or returns and
so on, and suddenly it will compile - then you will know which bit is in
error.

However I can save you a little trouble by pointing out that the problem
is this:

| ^('=' ID.expr)

You have put ID.expr in the grammar spec and it needs to be just ID.

Jim

> 
> Ter
> >
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/b14044cd/attachment.html 

From hallorant at gmail.com  Fri Sep  5 13:40:04 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Fri, 5 Sep 2008 16:40:04 -0400
Subject: [antlr-interest] Antlr Book Chapter 3 troubles
In-Reply-To: <1220646413.4791.78.camel@jimi>
References: <a36ab4bc0809051244x785a688bj7841dd2608a0a8e4@mail.gmail.com>
	<0BAEA6CE-ED8B-4B4A-B83D-29F9232F4A2B@cs.usfca.edu>
	<1220646413.4791.78.camel@jimi>
Message-ID: <a36ab4bc0809051340y2f6ce698ra45c270f32c7c36c@mail.gmail.com>

Thanks Jim,

Yes, I typo-ed the example it was
  | ^('=' ID expr)
not
  | ^('=' ID.expr)
on page 65 of the book.

A bit tricky to diagnose, hopefully this will improve in future releases.
In particular, your heuristic approach could be used inside the tool
implementation to at least report which rule has some sort of problems.

Thanks,
Tim


On Fri, Sep 5, 2008 at 4:26 PM, Jim Idle <jimi at temporal-wave.com> wrote:

>  On Fri, 2008-09-05 at 13:17 -0700, Terence Parr wrote:
>
> On Sep 5, 2008, at 12:44 PM, Tim Halloran wrote:
> > [15:36:28] error(10):  internal error: /Users/tim/Source/antlr-Work/
> > Ch3 Expr AST/src/Eval.g : java.lang.NullPointerException
> > org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:1959)
>
> I don't see rule atom.
>
>
> That's the ANTLR stack trace not the grammar trace. This is happening
> because something in the input source for the tree grammar is wrong, but the
> v3 grammar doesn't catch it and produces a tree that causes NPE.
>
> At the moment, the only way to work out what it is, is to remove your
> actions one at a time and try, then remove any parameters or returns and so
> on, and suddenly it will compile - then you will know which bit is in error.
>
> However I can save you a little trouble by pointing out that the problem is
> this:
>
> | ^('=' ID.expr)
>
> You have put ID.expr in the grammar spec and it needs to be just ID.
>
> Jim
>
> Ter
> >
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/b54bd7ed/attachment.html 

From parrt at cs.usfca.edu  Fri Sep  5 13:50:40 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 5 Sep 2008 13:50:40 -0700
Subject: [antlr-interest] Antlr Book Chapter 3 troubles
In-Reply-To: <a36ab4bc0809051340y2f6ce698ra45c270f32c7c36c@mail.gmail.com>
References: <a36ab4bc0809051244x785a688bj7841dd2608a0a8e4@mail.gmail.com>
	<0BAEA6CE-ED8B-4B4A-B83D-29F9232F4A2B@cs.usfca.edu>
	<1220646413.4791.78.camel@jimi>
	<a36ab4bc0809051340y2f6ce698ra45c270f32c7c36c@mail.gmail.com>
Message-ID: <17559A80-B6A6-4066-8792-11F9E29591B5@cs.usfca.edu>

Oh, crap. that's antlr's atom rule...not yours! Ooops. sorry. adding  
to list.
Ter
On Sep 5, 2008, at 1:40 PM, Tim Halloran wrote:

> Thanks Jim,
>
> Yes, I typo-ed the example it was
>   | ^('=' ID expr)
> not
>   | ^('=' ID.expr)
> on page 65 of the book.
>
> A bit tricky to diagnose, hopefully this will improve in future  
> releases.  In particular, your heuristic approach could be used  
> inside the tool implementation to at least report which rule has  
> some sort of problems.
>
> Thanks,
> Tim
>
>
> On Fri, Sep 5, 2008 at 4:26 PM, Jim Idle <jimi at temporal-wave.com>  
> wrote:
> On Fri, 2008-09-05 at 13:17 -0700, Terence Parr wrote:
>>
>> On Sep 5, 2008, at 12:44 PM, Tim Halloran wrote:
>> > [15:36:28] error(10):  internal error: /Users/tim/Source/antlr- 
>> Work/
>> > Ch3 Expr AST/src/Eval.g : java.lang.NullPointerException
>> > org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java: 
>> 1959)
>>
>> I don't see rule atom.
>
> That's the ANTLR stack trace not the grammar trace. This is  
> happening because something in the input source for the tree grammar  
> is wrong, but the v3 grammar doesn't catch it and produces a tree  
> that causes NPE.
>
> At the moment, the only way to work out what it is, is to remove  
> your actions one at a time and try, then remove any parameters or  
> returns and so on, and suddenly it will compile - then you will know  
> which bit is in error.
>
> However I can save you a little trouble by pointing out that the  
> problem is this:
>
> | ^('=' ID.expr)
>
> You have put ID.expr in the grammar spec and it needs to be just ID.
>
> Jim
>>
>> Ter
>> >
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From jaluber at gmx.de  Fri Sep  5 13:54:11 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 05 Sep 2008 22:54:11 +0200
Subject: [antlr-interest] multilingual IDE
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF10146247C@navamane001.ad.internal.corp>
References: <FF993752CB890B4EB591BE5450C37BF10146247C@navamane001.ad.internal.corp>
Message-ID: <48C19C73.3090805@gmx.de>

Edwards, Waverly schrieb:
> 
> This may be off topic but when people refer to multilingual IDE and
> Unicode, is this ever used within the editor?
> I understand menus, buttons or other controls.  Would the source code
> ever need to be encoded other than
> ASCII?  My question really boils down to is in source code would you
> ever see variables, quoted strings or
> comments in an encoding other than ASCII? I am ignorant on this subject
> but I also cant seem to find any
> examples that would lead me in any direction.  Are non-Latin based
> language speakers forced to use ASCII
> only encoding?

Well, it depends on the programming languages. Newer ones specify their
input as UTF-8 or UTF-16, so people can indeed program in their native
languages (although symbols and keywords won't change - one reason I
program solely in English). Older programming languages specify that
identifiers have to be chosen from [a-zA-Z0-9_], but allow in comments
arbitrary input. This means that either you have to write in English or
to mangle variable names (like "Z?hler" as "Zaehler").

Johannes
> 
> 
> Insights of all kinds very much welcome.
> 
> 
> W.
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From antlr at mirality.co.nz  Fri Sep  5 17:31:43 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 06 Sep 2008 12:31:43 +1200
Subject: [antlr-interest] How to remove this kind of warning
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF1014623E2@navamane001.ad.in
	ternal.corp>
References: <002e01c90f39$64a44710$4307430a@RYUSA>
	<1220623180.4791.13.camel@jimi>
	<A4F99107A4543747902F5E6B65FBFD19126A67@cngzex.CN.corp.sa>
	<1220628026.4791.15.camel@jimi>
	<FF993752CB890B4EB591BE5450C37BF1014623E2@navamane001.ad.internal.corp>
Message-ID: <20080906003153.3613811EDEA@www.antlr.org>

At 04:01 6/09/2008, Edwards, Waverly wrote:
>I don't think I understand this.  Shouldn't IP address be defined 
>as
>
>IPFRAG '.' IPFRAG '.' IPFRAG ''.' IPFRAG
>
>where IPFRAG is fragment constrained to a maximum 3 digit integer 
>
>You could later check to see if that value is 255 or less.

As I said earlier, you can define it that way if it makes you 
happier, but there's no need to.  If the IP_Address rule is a 
fragment (which it needs to be to avoid ambiguity with the 
Floating_Point_Constant rule) then ANTLR will not call it 
itself.  So if you don't refer to it either then it'll never get 
called and the body of the rule is irrelevant.

In the OP's grammar, the IP_Address is being used only for its 
token value (as '$type = IP_Address;'), and this doesn't end up 
calling the rule.


There is another way to write the rules such that the IP_Address 
rule *does* get called -- something along these lines:

fragment DIGIT: '0'..'9';
fragment INT: DIGIT+;
fragment IP_Address: INT '.' INT '.' INT '.' INT;

Floating_Point_Constant
   :  (IP_Address) => IP_Address { $type = IP_Address; }
   |  INT
      (  '.' INT (('e'|'E') INT)?
      |  { $type = INT; }
      )
   ;

The use of a syntactic predicate in the first alt forces ANTLR to 
increase its lookahead to resolve the ambiguity.


From George.Shannon at raphaelanalytics.com  Fri Sep  5 19:45:07 2008
From: George.Shannon at raphaelanalytics.com (George J. Shannon)
Date: Fri, 5 Sep 2008 21:45:07 -0500
Subject: [antlr-interest] Simple parsing question
Message-ID: <A51D46A5E6884ADDAB2850C62E5E049D@raphael01>

I have a parser that gets a MismatchedTokenException error that I would
appreciate assistance on.

Within the text being parsed is a simple rule that looks for '[' IntValue
']' where IntValue is the rule ('0'..'9')+ (i.e., integer value inside
brackets).

This may not be relevant, but I guess I should mention that this rule is
called by other rules, so this sequence is embedded inside other text.

Anyway, I get the MismatchedTokenException whenever I run into a '[0]', but
not when I run into '[00]' or any single digit other than '0'.

So, what's so special about 0 that I'm obviously missing?

Sorry to bother you with an obvious question; I have brain cramp after
staring at this for about an hour.

I'm using antlr 3.2 with ANTLRworks 1.2, but the error occurs with the
3.1/1.1.7 combination as well.

Thanks in advance for the help.

Regards,

George

 

 

 

 

George Shannon

President, Raphael Analytics, Inc.

16 Spur Drive

Fenton, MO 63026

(314) 550-5589 (cell)

 <mailto:George.Shannon at raphaelanalytics.com>
George.Shannon at raphaelanalytics.com

 <http://www.raphaelanalytics.com> www.raphaelanalytics.com

 

The information transmitted is intended only for the person or entity to
which it is addressed and may contain confidential and/or privileged
material.  Any review, retransmission, dissemination or other use of, or
taking of any action in reliance upon, this information by persons or
entities other than the intended recipient is prohibited.   If you received
this in error, please contact the sender and delete the material from any
computer.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080905/72ce2914/attachment.html 

From cvrebert at gmail.com  Fri Sep  5 19:53:32 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Fri, 5 Sep 2008 19:53:32 -0700
Subject: [antlr-interest] Simple parsing question
In-Reply-To: <A51D46A5E6884ADDAB2850C62E5E049D@raphael01>
References: <A51D46A5E6884ADDAB2850C62E5E049D@raphael01>
Message-ID: <47c890dc0809051953h275ece41qf76bb422e21d397d@mail.gmail.com>

Including at least part of the grammar in question would probably be
very useful to anyone trying to help you.

Regards,
Chris

On Fri, Sep 5, 2008 at 7:45 PM, George J. Shannon
<George.Shannon at raphaelanalytics.com> wrote:
> I have a parser that gets a MismatchedTokenException error that I would
> appreciate assistance on.
>
> Within the text being parsed is a simple rule that looks for '[' IntValue
> ']' where IntValue is the rule ('0'..'9')+ (i.e., integer value inside
> brackets).
>
> This may not be relevant, but I guess I should mention that this rule is
> called by other rules, so this sequence is embedded inside other text.
>
> Anyway, I get the MismatchedTokenException whenever I run into a '[0]', but
> not when I run into '[00]' or any single digit other than '0'.
>
> So, what's so special about 0 that I'm obviously missing?
>
> Sorry to bother you with an obvious question; I have brain cramp after
> staring at this for about an hour.
>
> I'm using antlr 3.2 with ANTLRworks 1.2, but the error occurs with the
> 3.1/1.1.7 combination as well.
>
> Thanks in advance for the help.
>
> Regards,
>
> George
>
>
>
>
>
>
>
>
>
> George Shannon
>
> President, Raphael Analytics, Inc.
>
> 16 Spur Drive
>
> Fenton, MO 63026
>
> (314) 550-5589 (cell)
>
> George.Shannon at raphaelanalytics.com
>
> www.raphaelanalytics.com
>
>
>
> The information transmitted is intended only for the person or entity to
> which it is addressed and may contain confidential and/or privileged
> material.  Any review, retransmission, dissemination or other use of, or
> taking of any action in reliance upon, this information by persons or
> entities other than the intended recipient is prohibited.   If you received
> this in error, please contact the sender and delete the material from any
> computer.
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>



-- 
Follow the path of the Iguana...
http://rebertia.com

From George.Shannon at raphaelanalytics.com  Fri Sep  5 19:58:35 2008
From: George.Shannon at raphaelanalytics.com (George J. Shannon)
Date: Fri, 5 Sep 2008 21:58:35 -0500
Subject: [antlr-interest] Simple parsing question
In-Reply-To: <47c890dc0809051953h275ece41qf76bb422e21d397d@mail.gmail.com>
References: <A51D46A5E6884ADDAB2850C62E5E049D@raphael01>
	<47c890dc0809051953h275ece41qf76bb422e21d397d@mail.gmail.com>
Message-ID: <034B3F9FC3A7478B9AFA32E361229709@raphael01>

Attached is a snippet of the grammar in question, where tagCommentNbr is the
integer value enclosed in brackets that I referred to in my email post.
George

tagCommentElement returns [ParserTagCommentElement pTagCommentElement]
@init 	{
	pTagCommentElement = new ParserTagCommentElement(); //db not req'd
	}
	:
	tagCommentNbr (elementName)?
	{
	pTagCommentElement.tagCommentNbr = $tagCommentNbr.text;
	pTagCommentElement.elementName = $elementName.text;
	}
	;

tagCommentNbr
	:
	'[' IntValue  ']'
	;
	
elementName
	:
	'.' alphaN
	;

IntValue 	
	:
	('0'..'9')+
	;
		

-----Original Message-----
From: Chris Rebert [mailto:cvrebert at gmail.com] 
Sent: Friday, September 05, 2008 9:54 PM
To: George J. Shannon
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Simple parsing question

Including at least part of the grammar in question would probably be
very useful to anyone trying to help you.

Regards,
Chris

On Fri, Sep 5, 2008 at 7:45 PM, George J. Shannon
<George.Shannon at raphaelanalytics.com> wrote:
> I have a parser that gets a MismatchedTokenException error that I would
> appreciate assistance on.
>
> Within the text being parsed is a simple rule that looks for '[' IntValue
> ']' where IntValue is the rule ('0'..'9')+ (i.e., integer value inside
> brackets).
>
> This may not be relevant, but I guess I should mention that this rule is
> called by other rules, so this sequence is embedded inside other text.
>
> Anyway, I get the MismatchedTokenException whenever I run into a '[0]',
but
> not when I run into '[00]' or any single digit other than '0'.
>
> So, what's so special about 0 that I'm obviously missing?
>
> Sorry to bother you with an obvious question; I have brain cramp after
> staring at this for about an hour.
>
> I'm using antlr 3.2 with ANTLRworks 1.2, but the error occurs with the
> 3.1/1.1.7 combination as well.
>
> Thanks in advance for the help.
>
> Regards,
>
> George
>
>
>
>
>
>
>
>
>
> George Shannon
>
> President, Raphael Analytics, Inc.
>
> 16 Spur Drive
>
> Fenton, MO 63026
>
> (314) 550-5589 (cell)
>
> George.Shannon at raphaelanalytics.com
>
> www.raphaelanalytics.com
>
>
>
> The information transmitted is intended only for the person or entity to
> which it is addressed and may contain confidential and/or privileged
> material.  Any review, retransmission, dissemination or other use of, or
> taking of any action in reliance upon, this information by persons or
> entities other than the intended recipient is prohibited.   If you
received
> this in error, please contact the sender and delete the material from any
> computer.
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
>
http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>



-- 
Follow the path of the Iguana...
http://rebertia.com


From jbb at acm.org  Fri Sep  5 20:57:09 2008
From: jbb at acm.org (John B. Brodie)
Date: Fri, 5 Sep 2008 23:57:09 -0400
Subject: [antlr-interest] Simple parsing question
In-Reply-To: <034B3F9FC3A7478B9AFA32E361229709@raphael01>
References: <A51D46A5E6884ADDAB2850C62E5E049D@raphael01>
	<47c890dc0809051953h275ece41qf76bb422e21d397d@mail.gmail.com>
	<034B3F9FC3A7478B9AFA32E361229709@raphael01>
Message-ID: <200809052357.09929.jbb@acm.org>

Greetings!

On Friday 05 September 2008 10:58:35 pm George J. Shannon wrote:
> Attached is a snippet of the grammar in question, where tagCommentNbr is
> the integer value enclosed in brackets that I referred to in my email post.
> George
>
> tagCommentElement returns [ParserTagCommentElement pTagCommentElement]
> @init 	{
> 	pTagCommentElement = new ParserTagCommentElement(); //db not req'd
> 	}
>
> 	tagCommentNbr (elementName)?
> 	{
> 	pTagCommentElement.tagCommentNbr = $tagCommentNbr.text;
> 	pTagCommentElement.elementName = $elementName.text;
> 	}
> 	;
>
> tagCommentNbr
>
> 	'[' IntValue  ']'
> 	;
>
> elementName
>
> 	'.' alphaN
> 	;
>
> IntValue
>
> 	('0'..'9')+
> 	;
>

The above snippets from your Grammar are semi-useful. It would be best if you 
post the smallest, simplest, yet *COMPLETE* Grammar that exhibits your 
problem at hand.  That way others may be better able to simply try the 
grammar in order to work out where the problem lies.

However I see a reference to a Parser Rule - alphaN - in your snippet above 
which leads me to speculate that you have utilized a '0' in that rule (or 
perhaps elsewhere). 

If you have used '0' in a Parser Rule then that means that a single 0 is a 
KEYWORD in your language, e.g. a separate Token that will be emitted by your 
Lexer.

Recall that ANTLR Lexers are greedy and will match the longest sequence 
possible. But when a given sequence matches more than one lexer rule, the 
rule that appears first wins.

So a sequence of "00" is greedily identified as an InvValue token. But a 
single "0" might match both the IntValue and the '0' token from a Parser Rule 
(this is speculation on my part based on your above grammar snippet that 
alphaN might refer to a '0' inside). So now I postulate that you have two 
lexer rules that can match the single "0" - the explicit IntValue and the 
implicit '0' parser ref. As it happens the  implicit tokens introduced by 
using quoted strings in the parser (e.g. the postulated '0') are considered 
to be first when breaking such a tie. So your tagCommentNbr when given the 
string "[0]" sees the three tokens '[', <implicit '0'>. and ']' rather 
than '[', IntValue, and ']'.

The mismatched token error message you are getting should be something 
like: "expecting IntValue, got '0'" or something similar.

Try making alphaN (and any other Parser Rule that involves single characters) 
into a Lexer Rule(s).

Hope this helps
   -jbb

From Waverly.Edwards at genesys.com  Sat Sep  6 08:16:23 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Sat, 6 Sep 2008 11:16:23 -0400
Subject: [antlr-interest] multilingual IDE
References: <FF993752CB890B4EB591BE5450C37BF10146247C@navamane001.ad.internal.corp>
	<48C19C73.3090805@gmx.de>
Message-ID: <FF993752CB890B4EB591BE5450C37BF1BB55DC@navamane001.ad.internal.corp>

I had been wondering about this for days and when I researched the subject
I could not find a single instance of someone programming in anything other
than English.  I have in the past seen some instances where someon used
French and Italian but I dont recall if that was just in the comments.
 
One of the things I really thought about were strings.  If you wanted to display
a string in Chinese what would you do if your editor only accepted ascii input?
 
 
Thank you very much for your response,
 
 
W.

________________________________

From: Johannes Luber [mailto:jaluber at gmx.de]
Sent: Fri 9/5/2008 4:54 PM
To: Edwards, Waverly
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] multilingual IDE



Edwards, Waverly schrieb:
>
> This may be off topic but when people refer to multilingual IDE and
> Unicode, is this ever used within the editor?
> I understand menus, buttons or other controls.  Would the source code
> ever need to be encoded other than
> ASCII?  My question really boils down to is in source code would you
> ever see variables, quoted strings or
> comments in an encoding other than ASCII? I am ignorant on this subject
> but I also cant seem to find any
> examples that would lead me in any direction.  Are non-Latin based
> language speakers forced to use ASCII
> only encoding?

Well, it depends on the programming languages. Newer ones specify their
input as UTF-8 or UTF-16, so people can indeed program in their native
languages (although symbols and keywords won't change - one reason I
program solely in English). Older programming languages specify that
identifiers have to be chosen from [a-zA-Z0-9_], but allow in comments
arbitrary input. This means that either you have to write in English or
to mangle variable names (like "Z?hler" as "Zaehler").

Johannes
>
>
> Insights of all kinds very much welcome.
>
>
> W.
>
>
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080906/ee908ae4/attachment.html 

From jaluber at gmx.de  Sat Sep  6 09:07:36 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 06 Sep 2008 18:07:36 +0200
Subject: [antlr-interest] multilingual IDE
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF1BB55DC@navamane001.ad.internal.corp>
References: <FF993752CB890B4EB591BE5450C37BF10146247C@navamane001.ad.internal.corp>
	<48C19C73.3090805@gmx.de>
	<FF993752CB890B4EB591BE5450C37BF1BB55DC@navamane001.ad.internal.corp>
Message-ID: <48C2AAC8.5030605@gmx.de>

Edwards, Waverly schrieb:
> I had been wondering about this for days and when I researched the subject
> I could not find a single instance of someone programming in anything other
> than English.  I have in the past seen some instances where someon used
> French and Italian but I dont recall if that was just in the comments.

I have seen one program, which used English, German and Spanish at once.
No, at least one programmer didn't speak Spanish so he had some problems
with understanding the code. Doing things internationally doesn't mean
that everyone programs with his own mother language. Also I believe you
aren't finding examples because you don't search right. Use
"filetype:ext" with a non-English word used in programs - a simple
translation like user into the German Benutzer got me these atrocities:

<http://martinprivcvs.spueler.net/*checkout*/swt/blatt10/TVS/Termin.java?rev=HEAD&logsort=rev&sortby=rev&only_with_tag=HEAD&content-type=text/plain>
<http://www.java-forum.org/de/viewtopic.php?download=-1&t=65520>

>  
> One of the things I really thought about were strings.  If you wanted to
> display
> a string in Chinese what would you do if your editor only accepted ascii
> input?

I'm pretty sure that there solutions for that, including using another
editor. As I don't use Chinese myself I am not familiar with the
possibilities, so I suggest to ask on a bigger forum which
Chinese/Japanese/etc. frequent. Ruby's creator is Asian, so you could
ask on their mailing list.
>  
>  
> Thank you very much for your response,

Your welcome.

Johannes
>  
>  
> W.
> 
> ------------------------------------------------------------------------
> *From:* Johannes Luber [mailto:jaluber at gmx.de]
> *Sent:* Fri 9/5/2008 4:54 PM
> *To:* Edwards, Waverly
> *Cc:* antlr-interest at antlr.org
> *Subject:* Re: [antlr-interest] multilingual IDE
> 
> Edwards, Waverly schrieb:
>>
>> This may be off topic but when people refer to multilingual IDE and
>> Unicode, is this ever used within the editor?
>> I understand menus, buttons or other controls.  Would the source code
>> ever need to be encoded other than
>> ASCII?  My question really boils down to is in source code would you
>> ever see variables, quoted strings or
>> comments in an encoding other than ASCII? I am ignorant on this subject
>> but I also cant seem to find any
>> examples that would lead me in any direction.  Are non-Latin based
>> language speakers forced to use ASCII
>> only encoding?
> 
> Well, it depends on the programming languages. Newer ones specify their
> input as UTF-8 or UTF-16, so people can indeed program in their native
> languages (although symbols and keywords won't change - one reason I
> program solely in English). Older programming languages specify that
> identifiers have to be chosen from [a-zA-Z0-9_], but allow in comments
> arbitrary input. This means that either you have to write in English or
> to mangle variable names (like "Z?hler" as "Zaehler").
> 
> Johannes
>>
>>
>> Insights of all kinds very much welcome.
>>
>>
>> W.
>>
>>
>> ------------------------------------------------------------------------
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
> 


From anatol.pomozov at gmail.com  Sat Sep  6 15:39:09 2008
From: anatol.pomozov at gmail.com (Anatol Pomozov)
Date: Sat, 6 Sep 2008 15:39:09 -0700
Subject: [antlr-interest] Implementing Java sourcecode formatters. Where to
	start?
Message-ID: <3665a1a00809061539p23846aav19d1849f17960c7c@mail.gmail.com>

Hi,

I work in a big Java team that has heterogeneous software environment. I
prefer to use IDEA for development, some other people Eclipse or Emacs. In
our team we try to keep unified style for the source code. But unfortunately
IDE's that we use have different options for code formatting and quite
difficult to find such style that satisfies all IDE's. So a lot of code
reformatting work I do by hands. And I feel that I do dumb work when I
reorder imports/add blank lines between class member definitions etc... I
want that some tool do it for me.

That is why I wan to implement code formatting tool for Java/Javascript.
Actually I tried to find such opensource tool and only I found is Jalopy
which is not developed anymore (last release in 2005).

I want to use ANTLR. Actually I am ANTLR newbie (although I know general
theoretical part of lexers/parsers) and not sure that it is the best tool
for implementing code transformers.

So what I ask here is advise. Is it ok to use ANTLR for code formatters?
Where to start? Do you have any good example for such kind of tasks? Any
advice would be helpful.

Thanks.

-- 
anatol
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080906/05e768c2/attachment.html 

From George.Shannon at raphaelanalytics.com  Sat Sep  6 15:53:13 2008
From: George.Shannon at raphaelanalytics.com (George J. Shannon)
Date: Sat, 6 Sep 2008 17:53:13 -0500
Subject: [antlr-interest] Simple parsing question
In-Reply-To: <200809052357.09929.jbb@acm.org>
References: <A51D46A5E6884ADDAB2850C62E5E049D@raphael01><47c890dc0809051953h275ece41qf76bb422e21d397d@mail.gmail.com><034B3F9FC3A7478B9AFA32E361229709@raphael01>
	<200809052357.09929.jbb@acm.org>
Message-ID: <6BBC1E407BB74F83ACDC4EC8AA3D2E68@raphael01>

John:
Eureka!  It worked.  Thanks so much for the great help.

George 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of John B. Brodie
Sent: Friday, September 05, 2008 10:57 PM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Simple parsing question

Greetings!

On Friday 05 September 2008 10:58:35 pm George J. Shannon wrote:
> Attached is a snippet of the grammar in question, where tagCommentNbr is
> the integer value enclosed in brackets that I referred to in my email
post.
> George
>
> tagCommentElement returns [ParserTagCommentElement pTagCommentElement]
> @init 	{
> 	pTagCommentElement = new ParserTagCommentElement(); //db not req'd
> 	}
>
> 	tagCommentNbr (elementName)?
> 	{
> 	pTagCommentElement.tagCommentNbr = $tagCommentNbr.text;
> 	pTagCommentElement.elementName = $elementName.text;
> 	}
> 	;
>
> tagCommentNbr
>
> 	'[' IntValue  ']'
> 	;
>
> elementName
>
> 	'.' alphaN
> 	;
>
> IntValue
>
> 	('0'..'9')+
> 	;
>

The above snippets from your Grammar are semi-useful. It would be best if
you 
post the smallest, simplest, yet *COMPLETE* Grammar that exhibits your 
problem at hand.  That way others may be better able to simply try the 
grammar in order to work out where the problem lies.

However I see a reference to a Parser Rule - alphaN - in your snippet above 
which leads me to speculate that you have utilized a '0' in that rule (or 
perhaps elsewhere). 

If you have used '0' in a Parser Rule then that means that a single 0 is a 
KEYWORD in your language, e.g. a separate Token that will be emitted by your

Lexer.

Recall that ANTLR Lexers are greedy and will match the longest sequence 
possible. But when a given sequence matches more than one lexer rule, the 
rule that appears first wins.

So a sequence of "00" is greedily identified as an InvValue token. But a 
single "0" might match both the IntValue and the '0' token from a Parser
Rule 
(this is speculation on my part based on your above grammar snippet that 
alphaN might refer to a '0' inside). So now I postulate that you have two 
lexer rules that can match the single "0" - the explicit IntValue and the 
implicit '0' parser ref. As it happens the  implicit tokens introduced by 
using quoted strings in the parser (e.g. the postulated '0') are considered 
to be first when breaking such a tie. So your tagCommentNbr when given the 
string "[0]" sees the three tokens '[', <implicit '0'>. and ']' rather 
than '[', IntValue, and ']'.

The mismatched token error message you are getting should be something 
like: "expecting IntValue, got '0'" or something similar.

Try making alphaN (and any other Parser Rule that involves single
characters) 
into a Lexer Rule(s).

Hope this helps
   -jbb

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From devel at hunsicker.de  Sun Sep  7 02:05:02 2008
From: devel at hunsicker.de (Marco Hunsicker)
Date: Sun, 07 Sep 2008 11:05:02 +0200
Subject: [antlr-interest] Implementing Java sourcecode formatters. Where
 to	start?
In-Reply-To: <3665a1a00809061539p23846aav19d1849f17960c7c@mail.gmail.com>
References: <3665a1a00809061539p23846aav19d1849f17960c7c@mail.gmail.com>
Message-ID: <48C3993E.1040405@hunsicker.de>

Hello Anatol,

> That is why I wan to implement code formatting tool for Java/Javascript.
> Actually I tried to find such opensource tool and only I found is Jalopy
> which is not developed anymore (last release in 2005).

If you're willing to shell out some money, the commercial Jalopy is 
still around (and under active development, it does only Java at this 
point, but XML/HTML/CSS/JavaScript is in the works) and provides many 
enhancements over the FOSS Jalopy. There is a fully functional trial 
available that you could check out. Please let me know if you need any 
further information. Thanks.

http://www.triemax.com/products/jalopy/

Cheers,

Marco Hunsicker




From spamhole at gmx.at  Sun Sep  7 08:49:43 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Sun, 07 Sep 2008 17:49:43 +0200
Subject: [antlr-interest] Parse tree in the debugger
Message-ID: <48C3F817.3010305@gmx.at>

I have noticed that the parse tree in the debugger looks different since 
v1.2.

In the previous version each tree node had a label with the symbol name 
that it matched.
In v1.2 each tree node is just called "and".

I cannot make any sense of that.. the symbol names were very useful for 
debugging, "and" isn't :-)

Could anyone tell me if this is a bug or what I'm missing?

thanks, Max


From mattpalms at gmail.com  Sun Sep  7 08:54:06 2008
From: mattpalms at gmail.com (Matt Palmer)
Date: Sun, 7 Sep 2008 16:54:06 +0100
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48C3F817.3010305@gmx.at>
References: <48C3F817.3010305@gmx.at>
Message-ID: <36c8729e0809070854n1abd434do3500c0751daabb9f@mail.gmail.com>

Markus,

it's fine for me - tested with several different grammars.  Are you sure
it's not something to do with your grammar?

cheers,

MattP.

On Sun, Sep 7, 2008 at 4:49 PM, Markus Stoeger <spamhole at gmx.at> wrote:

> I have noticed that the parse tree in the debugger looks different since
> v1.2.
>
> In the previous version each tree node had a label with the symbol name
> that it matched.
> In v1.2 each tree node is just called "and".
>
> I cannot make any sense of that.. the symbol names were very useful for
> debugging, "and" isn't :-)
>
> Could anyone tell me if this is a bug or what I'm missing?
>
> thanks, Max
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080907/7f060f2c/attachment.html 

From jaluber at gmx.de  Sun Sep  7 09:05:08 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sun, 07 Sep 2008 18:05:08 +0200
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48C3F817.3010305@gmx.at>
References: <48C3F817.3010305@gmx.at>
Message-ID: <48C3FBB4.1060000@gmx.de>

Markus Stoeger schrieb:
> I have noticed that the parse tree in the debugger looks different since 
> v1.2.
> 
> In the previous version each tree node had a label with the symbol name 
> that it matched.
> In v1.2 each tree node is just called "and".
> 
> I cannot make any sense of that.. the symbol names were very useful for 
> debugging, "and" isn't :-)
> 
> Could anyone tell me if this is a bug or what I'm missing?
> 
> thanks, Max

It would be more useful, if the grammar exhibiting this behaviour was
attached. Otherwise we can only guess the cause.

Johannes

From spamhole at gmx.at  Sun Sep  7 11:24:46 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Sun, 07 Sep 2008 20:24:46 +0200
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48C3F817.3010305@gmx.at>
References: <48C3F817.3010305@gmx.at>
Message-ID: <48C41C6E.2050305@gmx.at>

The "problem" happens with every grammar.

I have attached a screenshot of the debugger's parse tree and the 
corresponding grammar. On the left side the screenshot shows the output 
of antlrworks-1.2 and on the right side it shows the output of 
antlrworks-1.1.7.

Grammar (feed it the input "x+y"):

grammar DebuggerTreeTest;

symbol: x '+' y;
x: 'x';
y: 'y';

Max

-------------- next part --------------
A non-text attachment was scrubbed...
Name: scrshot.png
Type: image/png
Size: 7345 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080907/55d1ec35/attachment.png 

From mattpalms at gmail.com  Sun Sep  7 11:44:02 2008
From: mattpalms at gmail.com (Matt Palmer)
Date: Sun, 7 Sep 2008 19:44:02 +0100
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48C41C6E.2050305@gmx.at>
References: <48C3F817.3010305@gmx.at> <48C41C6E.2050305@gmx.at>
Message-ID: <36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>

Max,

it must be something to do with your installation.  It works fine for me.
I'm using Java 1.6.

Have you tried re-installing, or using another machine?

Regards,

Matt P.

On Sun, Sep 7, 2008 at 7:24 PM, Markus Stoeger <spamhole at gmx.at> wrote:

> The "problem" happens with every grammar.
>
> I have attached a screenshot of the debugger's parse tree and the
> corresponding grammar. On the left side the screenshot shows the output of
> antlrworks-1.2 and on the right side it shows the output of
> antlrworks-1.1.7.
>
> Grammar (feed it the input "x+y"):
>
> grammar DebuggerTreeTest;
>
> symbol: x '+' y;
> x: 'x';
> y: 'y';
>
> Max
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080907/e4606962/attachment.html 

From spamhole at gmx.at  Sun Sep  7 12:52:48 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Sun, 07 Sep 2008 21:52:48 +0200
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>
References: <48C3F817.3010305@gmx.at> <48C41C6E.2050305@gmx.at>
	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>
Message-ID: <48C43110.8060703@gmx.at>

I tried it with Java 1.6.5 and 1.6.7. I also tried different machines - 
at work, at home and in VMWare.. and I'm using the antlrworks-1.2.jar 
(and antlrworks-1.1.7.jar) as downloaded from the website.

Any further help in locating the problem would be very much appreciated. 
If there's anything I could test, let me know.

Max

Matt Palmer schrieb:
> Max,
>
> it must be something to do with your installation.  It works fine for 
> me.  I'm using Java 1.6.
>
> Have you tried re-installing, or using another machine?
>
> Regards,
>
> Matt P.


From stoneyrh at gmail.com  Sun Sep  7 19:52:31 2008
From: stoneyrh at gmail.com (Ronghui Yu)
Date: Mon, 8 Sep 2008 10:52:31 +0800
Subject: [antlr-interest] Implementing Java sourcecode formatters.
Message-ID: <c0b1975b0809071952l610d787du142fd44e1bede12f@mail.gmail.com>

In that case, I recommend Source Navigator, not implement a source code
formatter by yourself

I use Source Navigator for C++ only, but it should be available for Java,

Enjoy it.

-- 
===========================
Regards
Ronghui Yu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/d4037903/attachment.html 

From helene.chagnot at gmail.com  Mon Sep  8 00:08:10 2008
From: helene.chagnot at gmail.com (=?ISO-8859-1?Q?H=E9l=E8ne_Chagnot?=)
Date: Mon, 8 Sep 2008 09:08:10 +0200
Subject: [antlr-interest] Antlr and autocompletion
In-Reply-To: <216df3580809030103p17cbb554ra9d874186586e16e@mail.gmail.com>
References: <216df3580809030103p17cbb554ra9d874186586e16e@mail.gmail.com>
Message-ID: <216df3580809080008t25888f87ob55f6aafd516147a@mail.gmail.com>

Hi,

I read (
http://groups.google.com/group/il-antlr-interest/browse_thread/thread/7c6d05a35046854d)
that autocompletion may be possible with Antlr 3.2. This will be useful for
our current project.

Do you have any idea when this will be released ?

Thanks,
Helene
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/53c54624/attachment.html 

From jaluber at gmx.de  Mon Sep  8 03:38:27 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 08 Sep 2008 12:38:27 +0200
Subject: [antlr-interest] Antlr and autocompletion
In-Reply-To: <216df3580809080008t25888f87ob55f6aafd516147a@mail.gmail.com>
References: <216df3580809030103p17cbb554ra9d874186586e16e@mail.gmail.com>
	<216df3580809080008t25888f87ob55f6aafd516147a@mail.gmail.com>
Message-ID: <48C500A3.6020302@gmx.de>

H?l?ne Chagnot schrieb:
> Hi,
> 
> I read
> (http://groups.google.com/group/il-antlr-interest/browse_thread/thread/7c6d05a35046854d)
> that autocompletion may be possible with Antlr 3.2. This will be useful
> for our current project.
> 
> Do you have any idea when this will be released ?

As 3.1 has been released a few weeks ago and 3.1.1 is in development, I
would guess that it will take at least a half year. But I wouldn't be
surprised if it takes a year (like 3.1). I doubt that you can wait so long.

Johannes
> 
> Thanks,
> Helene
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From lars.vonwedel at bayertechnology.com  Mon Sep  8 06:40:31 2008
From: lars.vonwedel at bayertechnology.com (lars.vonwedel at bayertechnology.com)
Date: Mon, 8 Sep 2008 15:40:31 +0200
Subject: [antlr-interest] Method getText not available in Lexer ?
Message-ID: <OF64404D1D.E2034656-ONC12574BE.0049B711-C12574BE.004B1FA5@bayer.de>

Hello,

I tried to implement the approach for implicitly handling abbreviated 
keywords as described in the Wiki:

http://www.antlr.org/wiki/pages/viewpage.action?pageId=1802308

However, the lexer doesn't seem to have a getText method which makes some 
sense to me. But I can't figure out, how to do it correctly. 

Any hint ? 

Thank you and Best Regards

Lars von Wedel
_________________________________________

Bayer Technology Services GmbH
BTS-PT-PD-ES
Leverkusen, E 41
E-mail: lars.vonwedel at bayertechnology.com
Web: www.bayertechnology.com

Gesch?ftsf?hrer: Achim Noack
Aufsichtsratsvorsitzender: Dr. Wolfgang Plischke
Sitz der Gesellschaft: Leverkusen   |   Eintragung: Amtsgericht K?ln, HRB 
49896
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/44ea4751/attachment.html 

From sunshine at public.kherson.ua  Mon Sep  8 06:50:46 2008
From: sunshine at public.kherson.ua (Ruslan Zasukhin)
Date: Mon, 08 Sep 2008 16:50:46 +0300
Subject: [antlr-interest] Antlr and autocompletion
In-Reply-To: <48C500A3.6020302@gmx.de>
Message-ID: <C4EB0866.A5F61%sunshine@public.kherson.ua>

On 9/8/08 1:38 PM, "Johannes Luber" <jaluber at gmx.de> wrote:

> H?l?ne Chagnot schrieb:
>> Hi,
>> 
>> I read
>> (http://groups.google.com/group/il-antlr-interest/browse_thread/thread/7c6d05
>> a35046854d)
>> that autocompletion may be possible with Antlr 3.2. This will be useful
>> for our current project.
>> 
>> Do you have any idea when this will be released ?
> 
> As 3.1 has been released a few weeks ago and 3.1.1 is in development, I
> would guess that it will take at least a half year. But I wouldn't be
> surprised if it takes a year (like 3.1). I doubt that you can wait so long.

Hmm,

About 1.5-2 years ago Terrence have answer me that ANTLR 3.0 will be able
support auto-completion. So still not here?


-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]



From antlr at jazillian.com  Mon Sep  8 07:00:59 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Mon, 08 Sep 2008 10:00:59 -0400
Subject: [antlr-interest] Implementing Java sourcecode formatters. Where
 to	start?
In-Reply-To: <3665a1a00809061539p23846aav19d1849f17960c7c@mail.gmail.com>
References: <3665a1a00809061539p23846aav19d1849f17960c7c@mail.gmail.com>
Message-ID: <48C5301B.90908@jazillian.com>

Anatol Pomozov wrote:

Start here: http://www.jazillian.com/articles/treewalkers.html

Then choose between using an ANTLR treewalker, starting here:
http://www.jazillian.com/articles/java.tree.g

...or walking the AST "by hand", starting here:
http://www.jazillian.com/antlr/emitter.html

> That is why I wan to implement code formatting tool for Java/Javascript. 

From mikael.petterson at ericsson.com  Mon Sep  8 07:19:17 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Mon, 8 Sep 2008 16:19:17 +0200
Subject: [antlr-interest] (no subject)
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD99173449@esealmw104.eemea.ericsson.se>


I tried antlrworks-1.2.jar
I loaded my *.g file and fired it up.
I did a check grammar but got, in a Dialog:

Check grammar reported some errors:
(133):CleartoolOutput.g:0:0 illegal option output. Consult the console
for more information.

My console in the antlrworks app is empty but in the shell where I
started it I have:

Checking Grammar...

error(10):  internal error:
org.antlr.tool.Message.toString(Message.java:124): Assertion failed!
Message ID 133 created but is not present in errorMsgIDs or
warningMsgIDs.

Which is of no help to a newbie like me :-)

What shall I do?

cheers,

//mike

Mikael Petterson
Software Designer


Ericsson AB, Stockholm, Sweden
Visiting address: Isafjordsgatan 15, Kista
Phone: +46 70 2673044 
E-mail: mikael.petterson at ericsson.com 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/d469e19b/attachment.html 

From mikael.petterson at ericsson.com  Mon Sep  8 07:21:30 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Mon, 8 Sep 2008 16:21:30 +0200
Subject: [antlr-interest] illegal option output when tryiing
	antlrworks-1.2.jar
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344A@esealmw104.eemea.ericsson.se>

Hi,
(Missed the heading in my previous post).
I tried antlrworks-1.2.jar 
I loaded my *.g file and fired it up. 
I did a check grammar but got, in a Dialog: 
Check grammar reported some errors: 
(133):CleartoolOutput.g:0:0 illegal option output. Consult the console
for more information. 
My console in the antlrworks app is empty but in the shell where I
started it I have: 
Checking Grammar... 
error(10): internal error:
org.antlr.tool.Message.toString(Message.java:124): Assertion failed!
Message ID 133 created but is not present in errorMsgIDs or
warningMsgIDs.
Which is of no help to a newbie like me :-) 
What shall I do? 
cheers, 
//mike


Mikael Petterson
Software Designer


Ericsson AB, Stockholm, Sweden
Visiting address: Isafjordsgatan 15, Kista
Phone: +46 70 2673044 
E-mail: mikael.petterson at ericsson.com 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/efb78087/attachment.html 

From mikael.petterson at ericsson.com  Mon Sep  8 07:25:38 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Mon, 8 Sep 2008 16:25:38 +0200
Subject: [antlr-interest] Additional info for 'illegal option output' post
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344B@esealmw104.eemea.ericsson.se>



[16:22:28] warning(149):
/home/eraonel/opensource_projects/net.sourceforge.clearcase/src/commandl
ine/net/sourceforge/clearcase/commandline/parser/CleartoolOutput.g:0:0:
rewrite syntax or operator with no output option; setting output=AST
[16:22:30] warning(149): CleartoolOutput__.g:0:0: rewrite syntax or
operator with no output option; setting output=AST
[16:22:30] error(133): CleartoolOutput__.g:0:0: illegal option output

Mikael Petterson
Software Designer


Ericsson AB, Stockholm, Sweden
Visiting address: Isafjordsgatan 15, Kista
Phone: +46 70 2673044 
E-mail: mikael.petterson at ericsson.com 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/8b478873/attachment.html 

From jimi at temporal-wave.com  Mon Sep  8 08:23:17 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 08 Sep 2008 08:23:17 -0700
Subject: [antlr-interest] Method getText not available in Lexer ?
In-Reply-To: <OF64404D1D.E2034656-ONC12574BE.0049B711-C12574BE.004B1FA5@bayer.de>
References: <OF64404D1D.E2034656-ONC12574BE.0049B711-C12574BE.004B1FA5@bayer.de>
Message-ID: <1220887397.7655.18.camel@jimi.temporal-wave.com>

On Mon, 2008-09-08 at 15:40 +0200, lars.vonwedel at bayertechnology.com
wrote:

> 
> Hello, 
> 
> I tried to implement the approach for implicitly handling abbreviated
> keywords as described in the Wiki: 
> 
> http://www.antlr.org/wiki/pages/viewpage.action?pageId=1802308 
> 
> However, the lexer doesn't seem to have a getText method which makes
> some sense to me. But I can't figure out, how to do it correctly. 
> 
> Any hint ? 


You just use the reference $text the lexer rules are in the process of
building the token, so there is no token to de-reference in the actions.
There is also $pos and so on.

Jim


> 
> Thank you and Best Regards
> 
> Lars von Wedel
> _________________________________________
> 
> Bayer Technology Services GmbH
> BTS-PT-PD-ES
> Leverkusen, E 41
> E-mail: lars.vonwedel at bayertechnology.com
> Web: www.bayertechnology.com
> 
> Gesch?ftsf?hrer: Achim Noack
> Aufsichtsratsvorsitzender: Dr. Wolfgang Plischke
> Sitz der Gesellschaft: Leverkusen   |   Eintragung: Amtsgericht K?ln,
> HRB 49896
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/f2d6f49c/attachment.html 

From jaluber at gmx.de  Mon Sep  8 08:34:37 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 08 Sep 2008 17:34:37 +0200
Subject: [antlr-interest] Additional info for 'illegal option output'
 post
In-Reply-To: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344B@esealmw104.eemea.ericsson.se>
References: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344B@esealmw104.eemea.ericsson.se>
Message-ID: <48C5460D.8050007@gmx.de>

Mikael Petterson schrieb:
> 
> 
> [16:22:28] warning(149):
> /home/eraonel/opensource_projects/net.sourceforge.clearcase/src/commandline/net/sourceforge/clearcase/commandline/parser/CleartoolOutput.g:0:0:
> rewrite syntax or operator with no output option; setting output=AST
> 
> [16:22:30] warning(149): CleartoolOutput__.g:0:0: rewrite syntax or
> operator with no output option; setting output=AST
> [16:22:30] error(133): CleartoolOutput__.g:0:0: illegal option output

I'd say you are missing in the options

output=AST;

Johannes
> 
> *Mikael Petterson
> Software Designer*
> 
> *
> Ericsson AB, Stockholm, Sweden*
> Visiting address: Isafjordsgatan 15, Kista
> Phone: +46 70 2673044
> E-mail:_ __mikael.petterson at ericsson.com___
> <mailto:mikael.petterson at ericsson.com>__
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From egor at sun.com  Mon Sep  8 09:46:09 2008
From: egor at sun.com (Egor Ushakov)
Date: Mon, 08 Sep 2008 20:46:09 +0400
Subject: [antlr-interest] [Fwd: Re: Any more info on the 'Sun-tuned ANTLR
	v2'	website link-share?]
Message-ID: <48C556D1.3040107@sun.com>

I had problems with the email service, resending you this message just 
in case.

Egor

-------- Original Message --------
Subject: 	Re: [antlr-interest] Any more info on the 'Sun-tuned ANTLR v2' 
website link-share?
Date: 	Sat, 09 Aug 2008 17:12:20 +0400
From: 	Egor Ushakov <egor.ushakov at sun.com>
To: 	Don Caton <dcaton at spamarrest.com>
CC: 	antlr-interest at antlr.org
References: 	<19147537.1213179181307.JavaMail.root at m03> 
<00b101c8ec26$3a4b60b0$aee22210$@com> 
<14273483.1219247475570.JavaMail.root at m03> 
<01fb01c90afb$8cc0e290$a642a7b0$@com>



Don,

after hg clone you should have lots of folders, not just .hg,
what version of hg did you use?

Egor

Don Caton wrote:
> Egor:
>
> I did 'hg clone http://hg.netbeans.org/main' but all I end up with under
> main\.hg\store\data\cnd.antlr\src\antlr is a bunch of .i files.
>
> If I go to the url on the Antlr page
> (http://hg.netbeans.org/main/file/tip/cnd.antlr/) and click on src, then
> antlr, I can see all the .java files, which I presume are the contents of
> your tweaked version of Antlr.
>
> I don't understand why the hg clone didn't pull down these files and gave me
> a directory full of .i files instead.  Do I really have to download each
> .java file individually from the web?  I read the docs for 'hg clone' and it
> seems pretty straightforward.  I must be missing something pretty basic
> here, but what?
>
> Thanks.
>
> --
> Don
>
>
>   
>> -----Original Message-----
>> From: Egor.Ushakov at sun.com [mailto:Egor.Ushakov at sun.com] On Behalf Of
>> Egor Ushakov
>> Sent: Wednesday, August 20, 2008 11:52 AM
>> To: Don Caton
>> Cc: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] Any more info on the 'Sun-tuned ANTLR v2'
>> website link-share?
>>
>> Sorry,
>>
>> I have not read this thread for ages :)
>> If that still matters:
>>
>> hg clone http://hg.netbeans.org/main
>>
>> will do "checkout"
>> You can read more here:
>>
>> http://www.netbeans.org/community/sources/hg.html
>> http://www.netbeans.org/community/sources/
>>
>>
>> Regards,
>> Egor
>>
>> Don Caton wrote:
>>     
>>> Egor:
>>>
>>> Any tips on how to get the source?  I downloaded the Mercurial
>>>       
>> client, which I
>>     
>>> presume is necessary to get the files but I don't have a clue where
>>>       
>> to start.
>>     
>>> Thanks.
>>>
>>> --
>>> Don
>>>
>>>
>>>       
>>>> -----Original Message-----
>>>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>>>> bounces at antlr.org] On Behalf Of Egor Ushakov
>>>> Sent: Wednesday, June 11, 2008 6:12 AM
>>>> To: Micheal J
>>>> Cc: antlr-interest at antlr.org
>>>> Subject: [antlr-interest] [Fwd: Re: Any more info on the 'Sun-tuned
>>>>         
>> ANTLR
>>     
>>>> v2' website link-share?]
>>>>
>>>> Michael,
>>>>
>>>> Sun-tuned ANTLR v2 is used in C/C++ Netbeans pack for source
>>>>         
>> parsing:
>>     
>>>> http://www.netbeans.org/features/cpp/index.html
>>>> We implemented several performance fixes in it to improve the
>>>> performance of generated parser and lexer.
>>>> Our tests with C/C++ grammar shown ~x3 performance improvement.
>>>>
>>>> Netbeans is fully opensource and so does Sun-tuned ANTLR and
>>>>         
>> grammars.
>>     
>>>> We just asked Terence to put links on his website. (Thanks!)
>>>>
>>>> Feel free to use it in your projects :)
>>>>
>>>> Egor
>>>> Sun Microsystems
>>>>
>>>> Micheal J wrote:
>>>>
>>>>         
>>>>> Hi All,
>>>>>
>>>>> Just saw this in the sharing section of the ANTLR website. Does
>>>>>           
>> anyone
>>     
>>>> have
>>>>
>>>>         
>>>>> more info about this work by Sun (or is it the Netbeans project)?
>>>>>
>>>>> Micheal
>>>>>
>>>>> -----------------------
>>>>> The best way to contact me is via the list/forum. My time is very
>>>>>
>>>>>           
>>>> limited.
>>>>
>>>>         
>>>>         
>>>
>>>       
>
>
>   




From parrt at cs.usfca.edu  Mon Sep  8 10:48:19 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 8 Sep 2008 10:48:19 -0700
Subject: [antlr-interest] ST 4.0 planning
Message-ID: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>

Dear ST-o-philes and related humans,

I am starting the planning stages for ST 4.0. I begin my sabbatical  
next May, a few months after I finish this current book. I plan on  
writing software like crazy (for 15 months!). This will include  
optimizing ANTLR and hopefully converting ANTLR and ST to be ANTLR v3  
clean; no more ANTLR v2 requirement.

As part of converting ST to v3 grammars, I took a look at updating  
things.  As I looked through all the complicated code that manages  
dynamic scopes, parameters, and nested templates I realized that there  
is a lot of stuff going on in there.  ST groove organically from a  
simple string with holes in it to a sophisticated tree-based  
interpreter. Tree-based Interpreters are much more difficult to build  
then, say, a byte code interpreter. Further, debugging ST stuff is  
quite difficult because all you have are objects and you have to chase  
a lot of pointers through hash tables and so on to figure out what is  
going on.  There is no code to step through related to your templates.

I am contemplating moving to a JSP-like model where I generate Java  
(or C# or Python, ...) instead of doing an interpreter. There are a  
number of advantages:

1. In principle, we could use the rechargeable architecture pattern of  
ANTLR to generate whatever source code we want; C++ and so on. the  
only requirement would be some sort of reflection still because I  
don't want attributes to be typed in ST. That means that you'd need  
RTTI for C++, which it supposedly has now.

2.  I would suspect that the templates would go much faster when  
executing "natively" in Java.

3. You could debug templates by stepping through them just like you do  
ANTLR parsers. Templates would translate to Java methods. Groups would  
translate to objects.  Like JSP, we could automatically compile things  
in the background. This means that they would go slow the first time  
you ran the template. Also, I would have to investigate a custom class  
loader so that I could unload templates.

I'm planning on breaking with absolute backward compatibility to fix a  
number of design flaws that came about because requirements changed  
during the last eight years.

So, it is a bit premature, but I like to have things to think about  
while I'm waiting in line etc...

The idea of generating Java code is growing on me. Note that it would  
only be generating Java or stay an interpreter. I would not do both.  
Those are two totally separate products almost in terms of  
implementation.

Ter

From ramanand_mandayam at yahoo.com  Mon Sep  8 11:02:04 2008
From: ramanand_mandayam at yahoo.com (Ramanand Mandayam)
Date: Mon, 8 Sep 2008 11:02:04 -0700 (PDT)
Subject: [antlr-interest] How to print different messages for different
	failed predicates in rule
Message-ID: <889373.3542.qm@web33505.mail.mud.yahoo.com>

Hi,

I have a rule that users three different semantic predicates for validation. 
But each of these will only raise the FailedPredicateException. 
What is the best way to use semantic predicates while still printing different
error messages based on the actual predicate that failed?

Cheers

Ramanand


      

From aheller at gmx.at  Mon Sep  8 11:26:31 2008
From: aheller at gmx.at (Arnulf Heller)
Date: Mon, 08 Sep 2008 20:26:31 +0200
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
References: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
Message-ID: <20080908182635.TKBW13197.viefep15-int.chello.at@edge03.upc.biz>

Hello,

that sounds great! I strongly prefer static code over dynamic data 
structures and look forward to C++ string templates.

There is another point that makes static code a better choice: 
deployment. Its easier to compile and link the string template code 
as opposed to deploying group files, runtime environment, etc

I understand that from web page design it is quite desireable to 
change string templates on the fly, but we don't need this ability 
(so we don't need on the fly compilation as well)

Arnulf

At 19:48 08.09.2008, Terence Parr wrote:
>Dear ST-o-philes and related humans,
>
>I am starting the planning stages for ST 4.0. I begin my sabbatical
>next May, a few months after I finish this current book. I plan on
>writing software like crazy (for 15 months!). This will include
>optimizing ANTLR and hopefully converting ANTLR and ST to be ANTLR v3
>clean; no more ANTLR v2 requirement.
>
>As part of converting ST to v3 grammars, I took a look at updating
>things.  As I looked through all the complicated code that manages
>dynamic scopes, parameters, and nested templates I realized that there
>is a lot of stuff going on in there.  ST groove organically from a
>simple string with holes in it to a sophisticated tree-based
>interpreter. Tree-based Interpreters are much more difficult to build
>then, say, a byte code interpreter. Further, debugging ST stuff is
>quite difficult because all you have are objects and you have to chase
>a lot of pointers through hash tables and so on to figure out what is
>going on.  There is no code to step through related to your templates.
>
>I am contemplating moving to a JSP-like model where I generate Java
>(or C# or Python, ...) instead of doing an interpreter. There are a
>number of advantages:
>
>1. In principle, we could use the rechargeable architecture pattern of
>ANTLR to generate whatever source code we want; C++ and so on. the
>only requirement would be some sort of reflection still because I
>don't want attributes to be typed in ST. That means that you'd need
>RTTI for C++, which it supposedly has now.
>
>2.  I would suspect that the templates would go much faster when
>executing "natively" in Java.
>
>3. You could debug templates by stepping through them just like you do
>ANTLR parsers. Templates would translate to Java methods. Groups would
>translate to objects.  Like JSP, we could automatically compile things
>in the background. This means that they would go slow the first time
>you ran the template. Also, I would have to investigate a custom class
>loader so that I could unload templates.
>
>I'm planning on breaking with absolute backward compatibility to fix a
>number of design flaws that came about because requirements changed
>during the last eight years.
>
>So, it is a bit premature, but I like to have things to think about
>while I'm waiting in line etc...
>
>The idea of generating Java code is growing on me. Note that it would
>only be generating Java or stay an interpreter. I would not do both.
>Those are two totally separate products almost in terms of
>implementation.
>
>Ter
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From parrt at cs.usfca.edu  Mon Sep  8 11:31:32 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 8 Sep 2008 11:31:32 -0700
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <20080908182635.TKBW13197.viefep15-int.chello.at@edge03.upc.biz>
References: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
	<20080908182635.TKBW13197.viefep15-int.chello.at@edge03.upc.biz>
Message-ID: <62D56D33-3765-48CC-9778-C319C384DCB2@cs.usfca.edu>


On Sep 8, 2008, at 11:26 AM, Arnulf Heller wrote:

> Hello,
>
> that sounds great! I strongly prefer static code over dynamic data
> structures and look forward to C++ string templates.

Roman (on the ST list)Said that the RTTI C++ would not be enough...  
anyway, without types in ST we would need reflection of some kind for C 
++.

> There is another point that makes static code a better choice:
> deployment. Its easier to compile and link the string template code
> as opposed to deploying group files, runtime environment, etc

True.

> I understand that from web page design it is quite desireable to
> change string templates on the fly, but we don't need this ability
> (so we don't need on the fly compilation as well)

Yeah, I don't really need either but the web people do for sure.

Ter

From lgcraymer at yahoo.com  Mon Sep  8 11:45:14 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 8 Sep 2008 11:45:14 -0700 (PDT)
Subject: [antlr-interest] ST 4.0 planning
Message-ID: <853600.48701.qm@web55901.mail.re3.yahoo.com>

Ter--

I think that the reflection requirement is unnecessary and undesireable.  An attribute is usually one of:  1.) a String, 2.) a StringTemplate, or 3.) Boolean, and you could probably avoid Booleans as well with a bit of judicious design (single-valued "true" or "false" strings, for example).  On rare occasion, it may make sense to support an esoteric data type, but that can be handled via wrapper:  the wrapper, after all, only needs to know how to do "toString()", and it is trivial to implement subclass wrappers for each esoteric type.  For that matter, you could support a generic Java wrapper that used reflection, but subclass a base wrapper class in languages that do not support reflection.

--Loring

> From: Terence Parr <parrt at cs.usfca.edu>
> To: stringtemplate-interest <stringtemplate-interest at antlr.org>
> Cc: antlr Interest <antlr-interest at antlr.org>
> Sent: Monday, September 8, 2008 10:48:19 AM
> Subject: [antlr-interest] ST 4.0 planning
> 
> Dear ST-o-philes and related humans,
> 
> I am starting the planning stages for ST 4.0. I begin my sabbatical  
> next May, a few months after I finish this current book. I plan on  
> writing software like crazy (for 15 months!). This will include  
> optimizing ANTLR and hopefully converting ANTLR and ST to be ANTLR v3  
> clean; no more ANTLR v2 requirement.
> 
> As part of converting ST to v3 grammars, I took a look at updating  
> things.  As I looked through all the complicated code that manages  
> dynamic scopes, parameters, and nested templates I realized that there  
> is a lot of stuff going on in there.  ST groove organically from a  
> simple string with holes in it to a sophisticated tree-based  
> interpreter. Tree-based Interpreters are much more difficult to build  
> then, say, a byte code interpreter. Further, debugging ST stuff is  
> quite difficult because all you have are objects and you have to chase  
> a lot of pointers through hash tables and so on to figure out what is  
> going on.  There is no code to step through related to your templates.
> 
> I am contemplating moving to a JSP-like model where I generate Java  
> (or C# or Python, ...) instead of doing an interpreter. There are a  
> number of advantages:
> 
> 1. In principle, we could use the rechargeable architecture pattern of  
> ANTLR to generate whatever source code we want; C++ and so on. the  
> only requirement would be some sort of reflection still because I  
> don't want attributes to be typed in ST. That means that you'd need  
> RTTI for C++, which it supposedly has now.
> 
> 2.  I would suspect that the templates would go much faster when  
> executing "natively" in Java.
> 
> 3. You could debug templates by stepping through them just like you do  
> ANTLR parsers. Templates would translate to Java methods. Groups would  
> translate to objects.  Like JSP, we could automatically compile things  
> in the background. This means that they would go slow the first time  
> you ran the template. Also, I would have to investigate a custom class  
> loader so that I could unload templates.
> 
> I'm planning on breaking with absolute backward compatibility to fix a  
> number of design flaws that came about because requirements changed  
> during the last eight years.
> 
> So, it is a bit premature, but I like to have things to think about  
> while I'm waiting in line etc...
> 
> The idea of generating Java code is growing on me. Note that it would  
> only be generating Java or stay an interpreter. I would not do both.  
> Those are two totally separate products almost in terms of  
> implementation.
> 
> Ter
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From parrt at cs.usfca.edu  Mon Sep  8 11:52:26 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 8 Sep 2008 11:52:26 -0700
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <853600.48701.qm@web55901.mail.re3.yahoo.com>
References: <853600.48701.qm@web55901.mail.re3.yahoo.com>
Message-ID: <CCC6E103-FE2C-4825-8826-EEC3107A7B00@cs.usfca.edu>

Actually,I pass in lots of aggregate objects like User and FAQEntry  
and Grammar. We need field access I'm afraid.

Ter
On Sep 8, 2008, at 11:45 AM, Loring Craymer wrote:

> Ter--
>
> I think that the reflection requirement is unnecessary and  
> undesireable.  An attribute is usually one of:  1.) a String, 2.) a  
> StringTemplate, or 3.) Boolean, and you could probably avoid  
> Booleans as well with a bit of judicious design (single-valued  
> "true" or "false" strings, for example).  On rare occasion, it may  
> make sense to support an esoteric data type, but that can be handled  
> via wrapper:  the wrapper, after all, only needs to know how to do  
> "toString()", and it is trivial to implement subclass wrappers for  
> each esoteric type.  For that matter, you could support a generic  
> Java wrapper that used reflection, but subclass a base wrapper class  
> in languages that do not support reflection.


From titech at metaorb.com  Mon Sep  8 11:58:07 2008
From: titech at metaorb.com (titech at metaorb.com)
Date: Mon, 8 Sep 2008 11:58:07 -0700 (PDT)
Subject: [antlr-interest] Parsing (string_quote ")
Message-ID: <92209.35001.qm@web82304.mail.mud.yahoo.com>


How would you parse this:

(string_quote ")

The file contains both single- and double-quoted strings as well.

Thanks,
--Mike

Mike Allbright
DLP Products
Texas Instruments, Inc.

From lgcraymer at yahoo.com  Mon Sep  8 12:46:51 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 8 Sep 2008 12:46:51 -0700 (PDT)
Subject: [antlr-interest] ST 4.0 planning
Message-ID: <147858.13271.qm@web55902.mail.re3.yahoo.com>

I agree that you take advantage of field access at times, but that can be replaced with table lookups in most cases, and a smart wrapper can be substituted for a table if dynamic evaluation is absolutely necessary.  You don't need reflection; you just take advantage of it in the current Java implementation.

--Loring


----- Original Message ----
> From: Terence Parr <parrt at cs.usfca.edu>
> To: Loring Craymer <lgcraymer at yahoo.com>
> Cc: stringtemplate-interest <stringtemplate-interest at antlr.org>; antlr Interest <antlr-interest at antlr.org>
> Sent: Monday, September 8, 2008 11:52:26 AM
> Subject: Re: [antlr-interest] ST 4.0 planning
> 
> Actually,I pass in lots of aggregate objects like User and FAQEntry  
> and Grammar. We need field access I'm afraid.
> 
> Ter
> On Sep 8, 2008, at 11:45 AM, Loring Craymer wrote:
> 
> > Ter--
> >
> > I think that the reflection requirement is unnecessary and  
> > undesireable.  An attribute is usually one of:  1.) a String, 2.) a  
> > StringTemplate, or 3.) Boolean, and you could probably avoid  
> > Booleans as well with a bit of judicious design (single-valued  
> > "true" or "false" strings, for example).  On rare occasion, it may  
> > make sense to support an esoteric data type, but that can be handled  
> > via wrapper:  the wrapper, after all, only needs to know how to do  
> > "toString()", and it is trivial to implement subclass wrappers for  
> > each esoteric type.  For that matter, you could support a generic  
> > Java wrapper that used reflection, but subclass a base wrapper class  
> > in languages that do not support reflection.



      

From everttigchelaar at gmail.com  Mon Sep  8 13:24:06 2008
From: everttigchelaar at gmail.com (Potje rode kool)
Date: Mon, 8 Sep 2008 22:24:06 +0200
Subject: [antlr-interest] how to create an AST?
Message-ID: <7c35a13b0809081324h4dc4b0a8k245a6ecf8c7d0b10@mail.gmail.com>

Hi,

I am playing now for some time with antlr and I am trying to build an AST
but that seems to be quit hard.

I am try to parse a package declaration like this:

package org.something.more;

Seems that I have to use two .g files.
One that creates CommonTree objects and the other one to build an AST from
that.

Anyone knows how to get the stuff working?

Thanks,
Evert
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/197e8f2b/attachment.html 

From antlr at mirality.co.nz  Mon Sep  8 13:48:32 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 09 Sep 2008 08:48:32 +1200
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <147858.13271.qm@web55902.mail.re3.yahoo.com>
References: <147858.13271.qm@web55902.mail.re3.yahoo.com>
Message-ID: <20080908204843.0682D3D1469@www.antlr.org>

[I would send this to stringtemplate-interest as well, but I'm not 
subscribed so it won't let me.]

At 07:46 9/09/2008, Loring Craymer wrote:
 >I agree that you take advantage of field access at times, but 
that
 >can be replaced with table lookups in most cases, and a smart
 >wrapper can be substituted for a table if dynamic evaluation is
 >absolutely necessary.  You don't need reflection; you just take
 >advantage of it in the current Java implementation.

Indeed.  Almost anything you can do with reflection you can do by 
implementing a common interface -- and the little you can't do 
with that can be done with one of those interface methods being a 
"fetch me this data by name" type method (and companion 
setter).  The only holdout requiring some kind of factory method 
instead, which could simply be implemented via a different common 
interface.

It wouldn't be hard to make a dual-mode system where it'll first 
try using a common interface and failing that fall back on 
reflection (if available).  That way people using Java or C# can 
choose whether they want to implement the interfaces or not (doing 
it would be slightly more work for the user but should improve 
performance significantly, since reflection is fecking slow), and 
C/C++ users would be required to implement the interfaces.

(Admittedly I know almost nothing about how StringTemplate works 
internally, but still...)


From sharwell at pixelminegames.com  Mon Sep  8 15:29:11 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Mon, 8 Sep 2008 17:29:11 -0500
Subject: [antlr-interest] Parsing (string_quote ")
In-Reply-To: <92209.35001.qm@web82304.mail.mud.yahoo.com>
References: <92209.35001.qm@web82304.mail.mud.yahoo.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E31A@Bloodymary.ironwillgames.com>

I have to do something similar - I need the single quote character
available for a couple different things, so I parse a single quoted
string in the parser instead of the lexer using the following rules:

 

name

        :       namevalue

                -> ^({new CommonToken(AST_NAME,$namevalue.text)})

        ;

 

namevalue

        :       '\''

                (       (~'\'') =>

                        (       ('\\') => '\\' .

                        |       .

                        )

                )*

                '\''

        ;

 

Sam

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of
titech at metaorb.com
Sent: Monday, September 08, 2008 1:58 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Parsing (string_quote ")

 

 

How would you parse this:

 

(string_quote ")

 

The file contains both single- and double-quoted strings as well.

 

Thanks,

--Mike

 

Mike Allbright

DLP Products

Texas Instruments, Inc.

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest

Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/c5032a9f/attachment.html 

From parrt at cs.usfca.edu  Mon Sep  8 16:49:40 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 8 Sep 2008 16:49:40 -0700
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <20080908204843.0682D3D1469@www.antlr.org>
References: <147858.13271.qm@web55902.mail.re3.yahoo.com>
	<20080908204843.0682D3D1469@www.antlr.org>
Message-ID: <F62BDBED-2267-4584-9CAC-E4B450091270@cs.usfca.edu>


On Sep 8, 2008, at 1:48 PM, Gavin Lambert wrote:

> [I would send this to stringtemplate-interest as well, but I'm not
> subscribed so it won't let me.]
>
> At 07:46 9/09/2008, Loring Craymer wrote:
>> I agree that you take advantage of field access at times, but
> that
>> can be replaced with table lookups in most cases, and a smart
>> wrapper can be substituted for a table if dynamic evaluation is
>> absolutely necessary.  You don't need reflection; you just take
>> advantage of it in the current Java implementation.
>
> Indeed.  Almost anything you can do with reflection you can do by
> implementing a common interface --

That means that all of your objects will need to be rewritten,  
recompiled, and rebound into the app though right?

> and the little you can't do
> with that can be done with one of those interface methods being a
> "fetch me this data by name" type method (and companion
> setter).  The only holdout requiring some kind of factory method
> instead, which could simply be implemented via a different common
> interface.

Oh, you mean create an adaptor object that implements an intrface  
collected from every reference in a template?  How could you know  
until runtime what those types/methods are?

Hmm...i'm pretty sure nonreflective languages make ST hard to  
implement since it's untyped.  And I mean untyped (like assembly code)  
not dynamically typed like python.  I'd be overjoyed to be wrong  
though ;)

Ter

From Austin_Hastings at Yahoo.com  Mon Sep  8 17:03:03 2008
From: Austin_Hastings at Yahoo.com (Austin Hastings)
Date: Mon, 08 Sep 2008 19:03:03 -0500
Subject: [antlr-interest] Is this a bug of ANTLR3.1?
In-Reply-To: <00a501c908fa$7458c270$4307430a@RYUSA>
References: <00a501c908fa$7458c270$4307430a@RYUSA>
Message-ID: <48C5BD37.9050801@Yahoo.com>

Forgive me for stating the obvious, but if you get such a clear bonus
from this change, why not just force a semicolon before you call your
parser?

=Austin


Ronghui Yu wrote:
> I am using ANTLR3.1 for developing a SQL parser
> One of my main rule looks like this
> sql_statement:
> sql_statement_command (';')?
> But when generating parser codes from grammar file to C source, it
> always take a very long time and consume as much as 5G memory because
> of the optional semicolon
> Then in order to make the development easier, I make the semicolon a
> mandatory by removing the question mark, like this
> sql_statement:
> sql_statement_command ';'
> It does make the building faster and require much less memory.
> But the problem now is, when parsing a statement without the
> semicolon, such as the following
> select * from tt
> ANTLR won't handle this but issue a signal 11
> His is the stack information when this happening, when all test has
> been matched and is going to match the last semicolon
> Program received signal SIGSEGV, Segmentation fault.
> 0xb7370a09 in getMissingSymbol () from
> /home/oracle/install/lib/libantlr3c.so
> (gdb) where
> #0 0xb7370a09 in getMissingSymbol ()
> from /home/oracle/install/lib/libantlr3c.so
> #1 0xb73701d0 in recoverFromMismatchedToken ()
> from /home/oracle/install/lib/libantlr3c.so
> #2 0xb736f7bb in match () from /home/oracle/install/lib/libantlr3c.so
> In my opinion, ANTLR should initialize an exception that can be
> processed by his own way, not issue this signal
> Anyone has any ideas of suggestions on this?
> Thanks a lot
> ==============================
> Regards,
> Ronghui Yu
> Sierra Atlantic
>
> __________________________________________________________________________________________________________________
> DISCLAIMER:"The information contained in this message and the
> attachments (if any) may be privileged and confidential and protected
> from disclosure. You are hereby notified that any unauthorized use,
> dissemination, distribution or copying of this communication, review,
> retransmission, or taking of any action based upon this information,
> by persons or entities other than the intended recipient, is strictly
> prohibited. If you are not the intended recipient or an employee or
> agent responsible for delivering this message, and have received this
> communication in error, please notify us immediately by replying to
> the message and kindly delete the original message, attachments, if
> any, and all its copies from your computer system. Thank you for your
> cooperation."
> ________________________________________________________________________________________________________________
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>   


From Austin_Hastings at Yahoo.com  Mon Sep  8 17:34:44 2008
From: Austin_Hastings at Yahoo.com (Austin Hastings)
Date: Mon, 08 Sep 2008 19:34:44 -0500
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
References: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
Message-ID: <48C5C4A4.4010001@Yahoo.com>

A couple of comments, that are not directly tied to each other.

1. Part of putting code into an open source project is letting everybody 
else read it. Another part is letting other people contribute to it.

Before you spend a year writing code, go to some conferences that have 
nothing to do with parsing.

2. There seem to be two models for using ST currently. First is "let the 
templates run free." Second is "call a template, then call another."

2a. The "templates run free" is I guess the "best way" but getting all 
the data structures set up so that the templates can be happy takes a 
hell of a lot of work. If you could do that, then one template could 
blissfully call another and another, referring to the giant global data 
store.

2b. The "call one, call another" makes more sense from an immediate code 
perspective, especially from a parser: here's all the context I have at 
the moment, go generate a little bit of text and come back. I'll pass 
that string up the chain, and somebody with more or different 
information can insert that string into their context.
 
It makes sense for there to be a sort of happy medium, 2c, which maybe 
should be built on top of some kind of hierarchical base data object 
class. That way callers with fairly limited context could link a 
template, or a location (anchor? namespace? context) inside a template, 
to a concrete data element. But at the same time, the templates could be 
written to interact with each other, instead of just dumbly returning 
text. In that respect, it seems a little bit like the DOM tree model. 
Except that it shouldn't be. It should be more general purpose -- an 
in-memory database, say. (Seriously: as a thought experiment, pretend 
you have a SQL database as the ONLY thing available to the template 
engine. What do templates look like?)

Alternatively, think about what happens if template data access uses 
xpath syntax.

My point is that the stuff *outside* the angle brackets is easy. It's 
the interpolation and invocation and whatnot that costs all the effort. 
At some level, you'll wind up writing a PHP interpreter. What do you 
really want as your requirements?

3. I read a bunch of stuff about how ST was a functional language. And I 
remember thinking, what possible use is this to me? Do I give a rat's 
ass if my text is generated in a functional language? At the time, I was 
trying to implement automatically generated sequence numbers for things 
like test cases and symbols. It was far more difficult than it needed to 
be to inject that single simple feature. I had to support it in my code, 
rather than having it come for free in the templates. And it tended to 
taint my design. There needs to be a way to get stuff done, and if that 
means that a bunch of nerds from the Esoteric Language Institute are 
disappointed, give 'em a Klingon dictionary and send them home.

=Austin



Terence Parr wrote:
> Dear ST-o-philes and related humans,
>
> I am starting the planning stages for ST 4.0. I begin my sabbatical  
> next May, a few months after I finish this current book. I plan on  
> writing software like crazy (for 15 months!). This will include  
> optimizing ANTLR and hopefully converting ANTLR and ST to be ANTLR v3  
> clean; no more ANTLR v2 requirement.
>
> As part of converting ST to v3 grammars, I took a look at updating  
> things.  As I looked through all the complicated code that manages  
> dynamic scopes, parameters, and nested templates I realized that there  
> is a lot of stuff going on in there.  ST groove organically from a  
> simple string with holes in it to a sophisticated tree-based  
> interpreter. Tree-based Interpreters are much more difficult to build  
> then, say, a byte code interpreter. Further, debugging ST stuff is  
> quite difficult because all you have are objects and you have to chase  
> a lot of pointers through hash tables and so on to figure out what is  
> going on.  There is no code to step through related to your templates.
>
> I am contemplating moving to a JSP-like model where I generate Java  
> (or C# or Python, ...) instead of doing an interpreter. There are a  
> number of advantages:
>
> 1. In principle, we could use the rechargeable architecture pattern of  
> ANTLR to generate whatever source code we want; C++ and so on. the  
> only requirement would be some sort of reflection still because I  
> don't want attributes to be typed in ST. That means that you'd need  
> RTTI for C++, which it supposedly has now.
>
> 2.  I would suspect that the templates would go much faster when  
> executing "natively" in Java.
>
> 3. You could debug templates by stepping through them just like you do  
> ANTLR parsers. Templates would translate to Java methods. Groups would  
> translate to objects.  Like JSP, we could automatically compile things  
> in the background. This means that they would go slow the first time  
> you ran the template. Also, I would have to investigate a custom class  
> loader so that I could unload templates.
>
> I'm planning on breaking with absolute backward compatibility to fix a  
> number of design flaws that came about because requirements changed  
> during the last eight years.
>
> So, it is a bit premature, but I like to have things to think about  
> while I'm waiting in line etc...
>
> The idea of generating Java code is growing on me. Note that it would  
> only be generating Java or stay an interpreter. I would not do both.  
> Those are two totally separate products almost in terms of  
> implementation.
>
> Ter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>   


From stoneyrh at gmail.com  Mon Sep  8 18:14:25 2008
From: stoneyrh at gmail.com (Ronghui Yu)
Date: Tue, 9 Sep 2008 09:14:25 +0800
Subject: [antlr-interest] Is this a bug of ANTLR3.1?
Message-ID: <c0b1975b0809081814g60f72020nfc4810237c703860@mail.gmail.com>

Sorry that I change the mail address with my personal mail for eliminating
the disclaimer followed by each message

This is a good idea, I had thought about that before. My current solution
is, before matching the semicolon, look ahead to see if the next token is
semicolon, if not, then go around with it, something like this:

sql_statement_command
{
    if (next token is not semicolon)
    {
        goto noSemiStmt;
    }
}
';'
{
    noSemiStmt:
        do other things
}

Then I don't need to bother the code outside the parser itself.

Thanks


==============================
Regards,
Ronghui Yu
Sierra Atlantic
----- Original Message -----
From: "Austin Hastings" <Austin_Hastings at Yahoo.com>
To: "Ronghui Yu" <Ronghui.Yu at SierraAtlantic.com>
Cc: <antlr-interest at antlr.org>
Sent: Tuesday, September 09, 2008 8:03 AM
Subject: Re: [antlr-interest] Is this a bug of ANTLR3.1?


> Forgive me for stating the obvious, but if you get such a clear bonus
> from this change, why not just force a semicolon before you call your
> parser?
>
> =Austin
>
>
> Ronghui Yu wrote:
>> I am using ANTLR3.1 for developing a SQL parser
>> One of my main rule looks like this
>> sql_statement:
>> sql_statement_command (';')?
>> But when generating parser codes from grammar file to C source, it
>> always take a very long time and consume as much as 5G memory because
>> of the optional semicolon
>> Then in order to make the development easier, I make the semicolon a
>> mandatory by removing the question mark, like this
>> sql_statement:
>> sql_statement_command ';'
>> It does make the building faster and require much less memory.
>> But the problem now is, when parsing a statement without the
>> semicolon, such as the following
>> select * from tt
>> ANTLR won't handle this but issue a signal 11
>> His is the stack information when this happening, when all test has
>> been matched and is going to match the last semicolon
>> Program received signal SIGSEGV, Segmentation fault.
>> 0xb7370a09 in getMissingSymbol () from
>> /home/oracle/install/lib/libantlr3c.so
>> (gdb) where
>> #0 0xb7370a09 in getMissingSymbol ()
>> from /home/oracle/install/lib/libantlr3c.so
>> #1 0xb73701d0 in recoverFromMismatchedToken ()
>> from /home/oracle/install/lib/libantlr3c.so
>> #2 0xb736f7bb in match () from /home/oracle/install/lib/libantlr3c.so
>> In my opinion, ANTLR should initialize an exception that can be
>> processed by his own way, not issue this signal
>> Anyone has any ideas of suggestions on this?
>> Thanks a lot
>> ==============================
>> Regards,
>> Ronghui Yu
>> Sierra Atlantic
>>
>>
>>
________________________________________________________________________________________________________________
>> ------------------------------------------------------------------------
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>>
http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/d7773868/attachment.html 

From jimi at temporal-wave.com  Mon Sep  8 18:50:35 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 08 Sep 2008 18:50:35 -0700
Subject: [antlr-interest] Is this a bug of ANTLR3.1?
In-Reply-To: <c0b1975b0809081814g60f72020nfc4810237c703860@mail.gmail.com>
References: <c0b1975b0809081814g60f72020nfc4810237c703860@mail.gmail.com>
Message-ID: <1220925035.6682.2.camel@jimi.temporal-wave.com>

On Tue, 2008-09-09 at 09:14 +0800, Ronghui Yu wrote:
> Sorry that I change the mail address with my personal mail for
> eliminating the disclaimer followed by each message
>  
> This is a good idea, I had thought about that before.


You just need to restructure your grammar so that it isn't so ambiguous
and therefore the optional SEMI colon won't cause you any problems. SQL
is a difficult language to create a parser for, but you can do it with
no complicated predicates if you take it slowly. 


Jim
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080908/4c7329fa/attachment.html 

From lgcraymer at yahoo.com  Mon Sep  8 19:40:36 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 8 Sep 2008 19:40:36 -0700 (PDT)
Subject: [antlr-interest] ST 4.0 planning
Message-ID: <531757.82073.qm@web55903.mail.re3.yahoo.com>





----- Original Message ----
> From: Terence Parr <parrt at cs.usfca.edu>
> To: antlr Interest <antlr-interest at antlr.org>
> Sent: Monday, September 8, 2008 4:49:40 PM
> Subject: Re: [antlr-interest] ST 4.0 planning
> 
> 
> On Sep 8, 2008, at 1:48 PM, Gavin Lambert wrote:
> 
...
> > and the little you can't do
> > with that can be done with one of those interface methods being a
> > "fetch me this data by name" type method (and companion
> > setter).  The only holdout requiring some kind of factory method
> > instead, which could simply be implemented via a different common
> > interface.
> 
> Oh, you mean create an adaptor object that implements an intrface  
> collected from every reference in a template?  How could you know  
> until runtime what those types/methods are?
> 
> Hmm...i'm pretty sure nonreflective languages make ST hard to  
> implement since it's untyped.  And I mean untyped (like assembly code)  
> not dynamically typed like python.  I'd be overjoyed to be wrong  
> though ;)

Hmm--I don't see this at all.  ST is monotyped--"everything is a (multi-valued with ordered or named values) string"--just as Python follows the OO theme that "everything is an object".  Assembly code is statically typed, with bytes, words, and dwords; sometimes there are also floats and doubles and bits.  There are minor deviations--the use of Booleans, for example, in ST conditionals is the obvious one--but reflection is not a necessity for implementation, just a convenient way of translating (qualified) names to strings.  It is equally reasonable to have a standard wrapper "type" (interface, base adaptor class, etc.) and only pass strings, string templates, or wrapped objects to ST and to dispense with reflection.  The cost to the user is that he has to write the wrappers (not a big cost; even that can be automated from a "type specification"); the gain is that ST becomes easily portable.

--Loring

> 
> Ter
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From lgcraymer at yahoo.com  Mon Sep  8 20:07:46 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 8 Sep 2008 20:07:46 -0700 (PDT)
Subject: [antlr-interest] ST 4.0 planning
Message-ID: <815672.3191.qm@web55907.mail.re3.yahoo.com>

Sorry--I meant to say that assembly language has a non-extensible type set, not that it is statically typed.

--Loring



----- Original Message ----
> From: Loring Craymer <lgcraymer at yahoo.com>
> To: Terence Parr <parrt at cs.usfca.edu>; antlr Interest <antlr-interest at antlr.org>
> Sent: Monday, September 8, 2008 7:40:36 PM
> Subject: Re: [antlr-interest] ST 4.0 planning
> 
> 
> 
> 
> 
> ----- Original Message ----
> > From: Terence Parr 
> > To: antlr Interest 
> > Sent: Monday, September 8, 2008 4:49:40 PM
> > Subject: Re: [antlr-interest] ST 4.0 planning
> > 
> > 
> > On Sep 8, 2008, at 1:48 PM, Gavin Lambert wrote:
> > 
> ...
> > > and the little you can't do
> > > with that can be done with one of those interface methods being a
> > > "fetch me this data by name" type method (and companion
> > > setter).  The only holdout requiring some kind of factory method
> > > instead, which could simply be implemented via a different common
> > > interface.
> > 
> > Oh, you mean create an adaptor object that implements an intrface  
> > collected from every reference in a template?  How could you know  
> > until runtime what those types/methods are?
> > 
> > Hmm...i'm pretty sure nonreflective languages make ST hard to  
> > implement since it's untyped.  And I mean untyped (like assembly code)  
> > not dynamically typed like python.  I'd be overjoyed to be wrong  
> > though ;)
> 
> Hmm--I don't see this at all.  ST is monotyped--"everything is a (multi-valued 
> with ordered or named values) string"--just as Python follows the OO theme that 
> "everything is an object".  Assembly code is statically typed, with bytes, 
> words, and dwords; sometimes there are also floats and doubles and bits.  There 
> are minor deviations--the use of Booleans, for example, in ST conditionals is 
> the obvious one--but reflection is not a necessity for implementation, just a 
> convenient way of translating (qualified) names to strings.  It is equally 
> reasonable to have a standard wrapper "type" (interface, base adaptor class, 
> etc.) and only pass strings, string templates, or wrapped objects to ST and to 
> dispense with reflection.  The cost to the user is that he has to write the 
> wrappers (not a big cost; even that can be automated from a "type 
> specification"); the gain is that ST becomes easily portable.
> 
> --Loring
> 
> > 
> > Ter
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: 
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 
> 
>       
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From hgutsche at storm.ca  Mon Sep  8 20:32:28 2008
From: hgutsche at storm.ca (Hartmuth Gutsche)
Date: Mon, 8 Sep 2008 23:32:28 -0400
Subject: [antlr-interest] @after in lexer rule
Message-ID: <005401c9122c$b3012ef0$6900a8c0@uranus>

I have a lexer grammar (not written by me) that worked fine in ANTLR 3.0,
but shows problems with ANTLR 3.1. I meanwhile boiled it down to
assignments of the type $channel=HIDDEN used in @after actions in the lexer
rules. An example is:


T_EOS
@after {
// if the previous token was a T_EOS, then the one we're
// processing now is whitespace, so throw it away.
// also, if the previous token is null it means we have a
// blank line or a semicolon at the start of the file and
// we need to ignore it.
if(prevToken == null ||
(prevToken != null && prevToken.getType() == T_EOS)) {
$channel=HIDDEN;
}
if(includeLine) {
$channel=HIDDEN;
// Part of include file handling..
includeFile();
includeLine = false;
}
// Make sure we clear the flag saying we're in a format-stmt
inFormat = false;
}
: ';'
| ('\r')? ('\n')
;

What happens now is that for mT_EOS() in the generated lexer the following
statements are generated:
...

state.type = _type;
state.channel = _channel;

// if the previous token was a T_EOS, then the one we're
// processing now is whitespace, so throw it away.
// also, if the previous token is null it means we have a
// blank line or a semicolon at the start of the file and
// we need to ignore it.
if(prevToken == null ||
(prevToken != null && prevToken.getType() == T_EOS)) {
_channel=HIDDEN;
}
if(includeLine) {
_channel=HIDDEN;
// Part of include file handling..
includeFile();
includeLine = false;
}
// Make sure we clear the flag saying we're in a format-stmt
inFormat = false;
}
finally {
}
}
// $ANTLR end "T_EOS"

I.e. the state class doesn't get modified with the values assigned by the
@after action.

Because I use ANTLR only occasionally my question here is if I have to
change the grammar ( I am aware of changes with respect to $channel) or if
that is a bug?


Thanks!

Hartmuth



From okrachin at purdue.edu  Mon Sep  8 21:01:08 2008
From: okrachin at purdue.edu (Olya Krachina)
Date: Tue,  9 Sep 2008 00:01:08 -0400
Subject: [antlr-interest] lexer: matching float vs int
Message-ID: <1220932868.48c5f50493ca4@webmail.purdue.edu>

Hello,
I am new to antlr and i seem to be stuck on this.
i need to have 2 datatypes defined: int and float, currently i have them defined
like this in my .g file:

INT:      ('0'..'9')+; 
FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;

So, this does not work, when it comes across an int i think it tries to match
the longest string, i.e. float but finds space instead of '.' (since its an int)
and bails out. 

ps: i know this is more a regexp question, but if someone could help out, I
would greatly appreciate it.

thanks
 

From cvrebert at gmail.com  Mon Sep  8 21:19:26 2008
From: cvrebert at gmail.com (Chris Rebert)
Date: Mon, 8 Sep 2008 21:19:26 -0700
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <1220932868.48c5f50493ca4@webmail.purdue.edu>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
Message-ID: <855C9335-85B3-4FF8-8984-238B191DF273@gmail.com>

I think you might need to left-factor here.
Have you tried:

FLOAT: INT? '.' INT;

-Chris

Sent from my iPod

On Sep 8, 2008, at 9:01 PM, Olya Krachina <okrachin at purdue.edu> wrote:

> Hello,
> I am new to antlr and i seem to be stuck on this.
> i need to have 2 datatypes defined: int and float, currently i have  
> them defined
> like this in my .g file:
>
> INT:      ('0'..'9')+;
> FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;
>
> So, this does not work, when it comes across an int i think it tries  
> to match
> the longest string, i.e. float but finds space instead of '.' (since  
> its an int)
> and bails out.
>
> ps: i know this is more a regexp question, but if someone could help  
> out, I
> would greatly appreciate it.
>
> thanks
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From Austin_Hastings at Yahoo.com  Mon Sep  8 22:00:47 2008
From: Austin_Hastings at Yahoo.com (Austin Hastings)
Date: Tue, 09 Sep 2008 00:00:47 -0500
Subject: [antlr-interest] [Antlr][Java] Possible bug: Incorrect codegen when
 rewriting w/ code blocks attached.
Message-ID: <48C602FF.3080405@Yahoo.com>

I'm parsing a C-like language in Java, and stumbled across this ANTLR 
source:

decl_prefix
    : '*' tql=type_qualifier_list                              -> ^('*' 
$tql)
          {
              $declarator::type = 
typeFactory.getPointerToType($declarator::type, $tql.list);
          }
    ;

which generated the incorrect Java below. It is trying to use a java 
statement (terminated with ';') as a parameter to addChild. I'm not 
clear why - the code block should probably just be left alone, no?

I have found that relocating the code block to before the rewrite rule 
seems to generate correct output. I didn't notice any kind of diagnostic 
being emitted, though it may have been consumed by Eclipse.

=Austin



    public static class decl_prefix_return extends ParserRuleReturnScope {
        CommonTree tree;
        public Object getTree() { return tree; }
    };

    // $ANTLR start "decl_prefix"
    // D:\\My Documents\\My Eclipse 
Workspace\\hlasm\\src\\main\\antlr\\parrot\\hlasm\\Hlasm.g3:400:1: 
decl_prefix : '*' tql= type_qualifier_list -> ^( '*' $tql) ;
    public final HlasmParser.decl_prefix_return decl_prefix() throws 
RecognitionException {
        HlasmParser.decl_prefix_return retval = new 
HlasmParser.decl_prefix_return();
        retval.start = input.LT(1);

        CommonTree root_0 = null;

        Token char_literal36=null;
        HlasmParser.type_qualifier_list_return tql = null;


        CommonTree char_literal36_tree=null;
        RewriteRuleTokenStream stream_67=new 
RewriteRuleTokenStream(adaptor,"token 67");
        RewriteRuleSubtreeStream stream_type_qualifier_list=new 
RewriteRuleSubtreeStream(adaptor,"rule type_qualifier_list");
        try {
            // D:\\My Documents\\My Eclipse 
Workspace\\hlasm\\src\\main\\antlr\\parrot\\hlasm\\Hlasm.g3:401:2: ( '*' 
tql= type_qualifier_list -> ^( '*' $tql) )
            // D:\\My Documents\\My Eclipse 
Workspace\\hlasm\\src\\main\\antlr\\parrot\\hlasm\\Hlasm.g3:401:4: '*' 
tql= type_qualifier_list
            {
            
char_literal36=(Token)match(input,67,FOLLOW_67_in_decl_prefix992); if 
(state.failed) return retval;
            if ( state.backtracking==0 ) stream_67.add(char_literal36);

            pushFollow(FOLLOW_type_qualifier_list_in_decl_prefix996);
            tql=type_qualifier_list();

            state._fsp--;
            if (state.failed) return retval;
            if ( state.backtracking==0 ) 
stream_type_qualifier_list.add(tql.getTree());


            // AST REWRITE
            // elements: tql, 67
            // token labels:
            // rule labels: retval, tql
            // token list labels:
            // rule list labels:
            if ( state.backtracking==0 ) {
            retval.tree = root_0;
            RewriteRuleSubtreeStream stream_retval=new 
RewriteRuleSubtreeStream(adaptor,"token 
retval",retval!=null?retval.tree:null);
            RewriteRuleSubtreeStream stream_tql=new 
RewriteRuleSubtreeStream(adaptor,"token tql",tql!=null?tql.tree:null);

            root_0 = (CommonTree)adaptor.nil();
            // 401:36: -> ^( '*' $tql)
            {
                // D:\\My Documents\\My Eclipse 
Workspace\\hlasm\\src\\main\\antlr\\parrot\\hlasm\\Hlasm.g3:401:39: ^( 
'*' $tql)
                {
                CommonTree root_1 = (CommonTree)adaptor.nil();
                root_1 = 
(CommonTree)adaptor.becomeRoot(stream_67.nextNode(), root_1);

                adaptor.addChild(root_1, stream_tql.nextTree());

                adaptor.addChild(root_0, root_1);
                }
                adaptor.addChild(root_0,
                              
((declarator_scope)declarator_stack.peek()).type = 
typeFactory.getPointerToType(((declarator_scope)declarator_stack.peek()).type, 
(tql!=null?tql.list:null));
                          );
////// ************************************
///// BAD CODE ABOVE: See ';' at end of line inside 
adaptor.addChild(root_0, ...);
////// ************************************

            }

            retval.tree = root_0;}
            }

            retval.stop = input.LT(-1);

            if ( state.backtracking==0 ) {

            retval.tree = (CommonTree)adaptor.rulePostProcessing(root_0);
            adaptor.setTokenBoundaries(retval.tree, retval.start, 
retval.stop);
            }
        }
        catch (RecognitionException re) {
            reportError(re);
            recover(input,re);
        retval.tree = (CommonTree)adaptor.errorNode(input, retval.start, 
input.LT(-1), re);

        }
        finally {
        }
        return retval;
    }
    // $ANTLR end "decl_prefix"


From mikael.petterson at ericsson.com  Mon Sep  8 23:25:08 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Tue, 9 Sep 2008 08:25:08 +0200
Subject: [antlr-interest] Additional info for 'illegal option output'
	post
In-Reply-To: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344B@esealmw104.eemea.ericsson.se>
References: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344B@esealmw104.eemea.ericsson.se>
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344D@esealmw104.eemea.ericsson.se>

Hi,

I set the following under File --> Preferences --> General ANTLR
options: output=AST

Still the same problem.

Any more ideas?

cheers,

//mike 


> _____________________________________________ 
> From: 	Mikael Petterson  
> Sent:	den 8 september 2008 16:26
> To:	antlr-interest at antlr.org
> Subject:	Additional info for 'illegal option output' post
> 
> 
> 
> [16:22:28] warning(149):
> /home/eraonel/opensource_projects/net.sourceforge.clearcase/src/comman
> dline/net/sourceforge/clearcase/commandline/parser/CleartoolOutput.g:0
> :0: rewrite syntax or operator with no output option; setting
> output=AST
> [16:22:30] warning(149): CleartoolOutput__.g:0:0: rewrite syntax or
> operator with no output option; setting output=AST
> [16:22:30] error(133): CleartoolOutput__.g:0:0: illegal option output
> 
> Mikael Petterson
> Software Designer
> 
> 
> Ericsson AB, Stockholm, Sweden
> Visiting address: Isafjordsgatan 15, Kista
> Phone: +46 70 2673044 
> E-mail: mikael.petterson at ericsson.com 
> 
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/ca104f39/attachment.html 

From jaluber at gmx.de  Tue Sep  9 00:50:20 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 09 Sep 2008 09:50:20 +0200
Subject: [antlr-interest] Additional info for 'illegal option output'
 post
In-Reply-To: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344D@esealmw104.eemea.ericsson.se>
References: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344B@esealmw104.eemea.ericsson.se>
	<8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344D@esealmw104.eemea.ericsson.se>
Message-ID: <48C62ABC.9050901@gmx.de>

Mikael Petterson schrieb:
> Hi,
> 
> I set the following under File --> Preferences --> General ANTLR
> options: output=AST
> 
> Still the same problem.

That's the wrong place. ANTLR grammars have an options block, which must
  be placed after the grammar statement. Likes this:

options {
output=AST;
}

The preference setting is used only for parameters which can be given on
the command line.

Johannes
> 
> Any more ideas?
> 
> cheers,
> 
> //mike
> 
> 
> _____________________________________________
> *From:  * Mikael Petterson 
> *Sent:  * den 8 september 2008 16:26
> *To:    * antlr-interest at antlr.org
> *Subject:       * Additional info for 'illegal option output' post
> 
> 
> 
> [16:22:28] warning(149):
> /home/eraonel/opensource_projects/net.sourceforge.clearcase/src/commandline/net/sourceforge/clearcase/commandline/parser/CleartoolOutput.g:0:0:
> rewrite syntax or operator with no output option; setting output=AST
> 
> [16:22:30] warning(149): CleartoolOutput__.g:0:0: rewrite syntax or
> operator with no output option; setting output=AST
> [16:22:30] error(133): CleartoolOutput__.g:0:0: illegal option output
> 
> *Mikael Petterson
> Software Designer*
> 
> *
> Ericsson AB, Stockholm, Sweden*
> Visiting address: Isafjordsgatan 15, Kista
> Phone: +46 70 2673044
> E-mail:_ __mikael.petterson at ericsson.com___
> <mailto:mikael.petterson at ericsson.com>__
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From Dennis.Benzinger at gmx.net  Tue Sep  9 00:51:15 2008
From: Dennis.Benzinger at gmx.net (Dennis Benzinger)
Date: Tue, 09 Sep 2008 09:51:15 +0200
Subject: [antlr-interest] how to create an AST?
In-Reply-To: <7c35a13b0809081324h4dc4b0a8k245a6ecf8c7d0b10@mail.gmail.com>
References: <7c35a13b0809081324h4dc4b0a8k245a6ecf8c7d0b10@mail.gmail.com>
Message-ID: <48C62AF3.6060204@gmx.net>

Hi!

Am 08.09.2008 22:24, Potje rode kool schrieb:
> Hi,
> 
> I am playing now for some time with antlr and I am trying to build an AST
> but that seems to be quit hard.
> 
> I am try to parse a package declaration like this:
> 
> package org.something.more;
> 
> Seems that I have to use two .g files.
> One that creates CommonTree objects and the other one to build an AST from
> that.
> 
> Anyone knows how to get the stuff working?
> [...]

You don't need two grammars. You can use one grammar like the example
I've attached. The ID rule is not the correct rule for Java but you'll
get the idea.

Have a look at:
http://www.antlr.org/wiki/display/ANTLR3/FAQ+-+Tree+construction


HTH,
Dennis Benzinger

From Dennis.Benzinger at gmx.net  Tue Sep  9 01:06:48 2008
From: Dennis.Benzinger at gmx.net (Dennis Benzinger)
Date: Tue, 09 Sep 2008 10:06:48 +0200
Subject: [antlr-interest] how to create an AST?
In-Reply-To: <48C62AF3.6060204@gmx.net>
References: <7c35a13b0809081324h4dc4b0a8k245a6ecf8c7d0b10@mail.gmail.com>
	<48C62AF3.6060204@gmx.net>
Message-ID: <48C62E98.9050006@gmx.net>

Am 09.09.2008 09:51, Dennis Benzinger schrieb:
> [...]
> You don't need two grammars. You can use one grammar like the example
> I've attached.
> [...]

Seems like I've forgotten to attach the attachment.

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: PackageDeclaration.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/7feb681e/attachment.pl 

From antlr at mirality.co.nz  Tue Sep  9 01:24:54 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 09 Sep 2008 20:24:54 +1200
Subject: [antlr-interest] @after in lexer rule
In-Reply-To: <005401c9122c$b3012ef0$6900a8c0@uranus>
References: <005401c9122c$b3012ef0$6900a8c0@uranus>
Message-ID: <20080909082506.71BCA11ED44@www.antlr.org>

At 15:32 9/09/2008, Hartmuth Gutsche wrote:
 >I.e. the state class doesn't get modified with the values 
assigned
 >by the @after action.
 >
 >Because I use ANTLR only occasionally my question here is if I 
have
 >to change the grammar ( I am aware of changes with respect to
 >$channel) or if that is a bug?

Not sure if it counts as a bug or not, but the @after block is 
designated as cleanup code that gets executed when the rule exits 
(and not just for successful exits), so it does seem like the 
wrong place to do it.

You should probably move it into an unadorned block at the end of 
your rule.  That way it'll only execute if the rule matches.  Just 
be careful about how you've structured your alternates -- if the 
block is at the same level as some | alts then it will only apply 
to the closest alt, not the whole set.


From stoneyrh at gmail.com  Tue Sep  9 02:49:07 2008
From: stoneyrh at gmail.com (Ronghui Yu)
Date: Tue, 9 Sep 2008 17:49:07 +0800
Subject: [antlr-interest] Is this a bug of ANTLR3.1?
Message-ID: <c0b1975b0809090249w2f566ed2g65cd99c615c67dea@mail.gmail.com>

I have figured out why this happen. In our product, the parser object (ctx)
can be reuseable for parsing different statements, but before parsing each
statement, there is a functio called *reinitLexerAndParser* to prepare
whatever need, one of functions called to re-initialize the parser object is
*setTokenStream*.

Before ANTLR3.1, this function doesn't reset the pointer
ctx->pParser->rec->state->tokenNames, so everything went well for my parser,
but in ANTLR3.1, this function set this pointer to NULL, so when parsing
another statement with this parser object again, the parser encounters a
NULL pointer when calling *getMissingSymbol*
I wonder if this is a must to reset this pointer to NULL.

My current solution is to save this pointer before calling this function,
and restore it after.
It works fine, but I still hope there is an offical approval.

Thanks

-- 
===========================
Regards
Ronghui Yu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/af23f3f3/attachment.html 

From antlr-interest at schraverus.com  Tue Sep  9 03:17:14 2008
From: antlr-interest at schraverus.com (Corno Schraverus)
Date: Tue, 9 Sep 2008 12:17:14 +0200
Subject: [antlr-interest] C Target documentation
Message-ID: <002401c91265$3beeea80$b3ccbf80$@com>

Hi all,

I have just found the cause for (at least one of) my problems with the C
Target (3.1); I was creating custom tokens, and wasn't aware that I had to
override the getMissingSymbol function to get it working properly.
I'd like to make sure that I've now properly implemented my custom token
(all I'm doing is setting and getting the 'custom' property. Is this
documented somewhere (couldn't find it), or could anyone give me some
pointers on this?

greetings,

Corno


From mikael.petterson at ericsson.com  Tue Sep  9 06:57:49 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Tue, 9 Sep 2008 15:57:49 +0200
Subject: [antlr-interest] One step further but still error when checking
	grammar
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344E@esealmw104.eemea.ericsson.se>

Hi,

I added as suggested a:
@header{
package net.sourceforge.clearcase.commandline.parser;

import net.sourceforge.clearcase.ClearCase;
import net.sourceforge.clearcase.ClearCaseElementState;
import net.sourceforge.clearcase.ClearCaseElementStateStream;
import net.sourceforge.clearcase.ClearCaseException;
}

options {
output=AST;
}


@lexer::header{
package net.sourceforge.clearcase.commandline.parser;
}


At least this is what I think you suggested.  Correct me if I am wrong,
which I probably is ;-)

Then I try to ceck my grammar again. Still unknown errors, at least for
me as a newbie.

15:53:50] Checking Grammar...
[15:53:50] error(100): CleartoolOutput.g:13:1: syntax error: antlr:
CleartoolOutput.g:13:1: unexpected token: options {
[15:53:50] warning(149): CleartoolOutput.g:0:0: rewrite syntax or
operator with no output option; setting output=AST
[15:53:50] error(150):  grammar file CleartoolOutput.g has no rules
[15:53:50] error(100): CleartoolOutput.g:0:0: syntax error:
assign.types: <AST>:0:0: unexpected end of subtree
[15:53:50] error(100): CleartoolOutput.g:0:0: syntax error: define:
<AST>:0:0: unexpected end of subtree
[15:53:50] java.lang.NullPointerException
	at
org.antlr.tool.DefineGrammarItemsWalker.trimGrammar(DefineGrammarItemsWa
lker.java:93)
	at
org.antlr.tool.DefineGrammarItemsWalker.finish(DefineGrammarItemsWalker.
java:76)
	at
org.antlr.tool.DefineGrammarItemsWalker.grammar(DefineGrammarItemsWalker
.java:205)
	at org.antlr.tool.Grammar.defineGrammarSymbols(Grammar.java:651)
	at
org.antlr.tool.CompositeGrammar.defineGrammarSymbols(CompositeGrammar.ja
va:350)
	at org.antlr.tool.Grammar.setGrammarContent(Grammar.java:564)
	at
org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createNewGrammar(Un
known Source)
	at
org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createParserGrammar
(Unknown Source)
	at
org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createCombinedGramm
ar(Unknown Source)
	at
org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createGrammars(Unkn
own Source)
	at
org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.analyze(Unknown
Source)
	at
org.antlr.works.grammar.engine.GrammarEngineImpl.analyze(Unknown Source)
	at org.antlr.works.grammar.CheckGrammar.run(Unknown Source)
	at java.lang.Thread.run(Thread.java:595)

cheers,

//mike


Mikael Petterson
Software Designer


Ericsson AB, Stockholm, Sweden
Visiting address: Isafjordsgatan 15, Kista
Phone: +46 70 2673044 
E-mail: mikael.petterson at ericsson.com 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/1da4c884/attachment.html 

From jaluber at gmx.de  Tue Sep  9 07:09:04 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 09 Sep 2008 16:09:04 +0200
Subject: [antlr-interest] One step further but still error when checking
 grammar
In-Reply-To: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344E@esealmw104.eemea.ericsson.se>
References: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9917344E@esealmw104.eemea.ericsson.se>
Message-ID: <48C68380.6050905@gmx.de>

Mikael Petterson schrieb:
> Hi,
> 
> I added as suggested a:
> @header{
> package net.sourceforge.clearcase.commandline.parser;
> 
> import net.sourceforge.clearcase.ClearCase;
> import net.sourceforge.clearcase.ClearCaseElementState;
> import net.sourceforge.clearcase.ClearCaseElementStateStream;
> import net.sourceforge.clearcase.ClearCaseException;
> }
> 
> options {
> output=AST;
> }
> 
> 
> @lexer::header{
> package net.sourceforge.clearcase.commandline.parser;
> }
> 
> 
> At least this is what I think you suggested.  Correct me if I am wrong,
> which I probably is ;-)

options has to be placed directly after "grammar X;". Also include
"ASTLabelType=CommonTree;" in options, in case you end casting things
manually.

Johannes
> 
> Then I try to ceck my grammar again. Still unknown errors, at least for
> me as a newbie.
> 
> 15:53:50] Checking Grammar...
> [15:53:50] error(100): CleartoolOutput.g:13:1: syntax error: antlr:
> CleartoolOutput.g:13:1: unexpected token: options {
> [15:53:50] warning(149): CleartoolOutput.g:0:0: rewrite syntax or
> operator with no output option; setting output=AST
> [15:53:50] error(150):  grammar file CleartoolOutput.g has no rules
> [15:53:50] error(100): CleartoolOutput.g:0:0: syntax error:
> assign.types: <AST>:0:0: unexpected end of subtree
> [15:53:50] error(100): CleartoolOutput.g:0:0: syntax error: define:
> <AST>:0:0: unexpected end of subtree
> [15:53:50] java.lang.NullPointerException
>         at
> org.antlr.tool.DefineGrammarItemsWalker.trimGrammar(DefineGrammarItemsWalker.java:93)
> 
>         at
> org.antlr.tool.DefineGrammarItemsWalker.finish(DefineGrammarItemsWalker.java:76)
> 
>         at
> org.antlr.tool.DefineGrammarItemsWalker.grammar(DefineGrammarItemsWalker.java:205)
> 
>         at org.antlr.tool.Grammar.defineGrammarSymbols(Grammar.java:651)
>         at
> org.antlr.tool.CompositeGrammar.defineGrammarSymbols(CompositeGrammar.java:350)
> 
>         at org.antlr.tool.Grammar.setGrammarContent(Grammar.java:564)
>         at
> org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createNewGrammar(Unknown
> Source)
>         at
> org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createParserGrammar(Unknown
> Source)
>         at
> org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createCombinedGrammar(Unknown
> Source)
>         at
> org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.createGrammars(Unknown
> Source)
>         at
> org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.analyze(Unknown
> Source)
>         at
> org.antlr.works.grammar.engine.GrammarEngineImpl.analyze(Unknown Source)
>         at org.antlr.works.grammar.CheckGrammar.run(Unknown Source)
>         at java.lang.Thread.run(Thread.java:595)
> 
> cheers,
> 
> //mike
> 
> 
> *Mikael Petterson
> Software Designer*
> 
> *
> Ericsson AB, Stockholm, Sweden*
> Visiting address: Isafjordsgatan 15, Kista
> Phone: +46 70 2673044
> E-mail:_ __mikael.petterson at ericsson.com___
> <mailto:mikael.petterson at ericsson.com>__
> 
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From jimi at temporal-wave.com  Tue Sep  9 07:23:02 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 09 Sep 2008 07:23:02 -0700
Subject: [antlr-interest] Is this a bug of ANTLR3.1?
In-Reply-To: <c0b1975b0809090249w2f566ed2g65cd99c615c67dea@mail.gmail.com>
References: <c0b1975b0809090249w2f566ed2g65cd99c615c67dea@mail.gmail.com>
Message-ID: <1220970182.3951.24.camel@jimi.temporal-wave.com>

On Tue, 2008-09-09 at 17:49 +0800, Ronghui Yu wrote:
> I have figured out why this happen. In our product, the parser object
> (ctx) can be reuseable for parsing different statements, but before
> parsing each statement, there is a functio called reinitLexerAndParser
> to prepare whatever need, one of functions called to re-initialize the
> parser object is setTokenStream.
>  
> Before ANTLR3.1, this function doesn't reset the pointer
> ctx->pParser->rec->state->tokenNames, so everything went well for my
> parser, but in ANTLR3.1, this function set this pointer to NULL, so
> when parsing another statement with this parser object again, the
> parser encounters a NULL pointer when calling getMissingSymbol
> 
> I wonder if this is a must to reset this pointer to NULL.
>  
> My current solution is to save this pointer before calling this
> function, and restore it after.
> It works fine, but I still hope there is an offical approval


I'll take a look - perhaps the value should not be reset.

Jim

> .
>  
> Thanks
> 
> -- 
> ===========================
> Regards
> Ronghui Yu
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/43746bc9/attachment.html 

From pat at lanl.gov  Tue Sep  9 09:10:04 2008
From: pat at lanl.gov (Patrick McCormick)
Date: Tue, 9 Sep 2008 10:10:04 -0600
Subject: [antlr-interest] Debugging C target with ASTs and ANTLRWorks broken?
Message-ID: <D038F6FE-02D1-43B6-A6A4-8F5736981A2B@lanl.gov>

Hi,

I'm trying to get the latest version of ANTLRWorks 1.2 to remotely  
debug a C target output
(that builds an AST). It looks like this issue was discussed back at  
the beginning of August
but I didn't see a resolution other than the release notes for the C  
runtime notes on 3.0
to 3.1 specifically state debugging is now supported.  In summary,  
here is the internal
exception that results from the -debug flag:

   java.lang.IllegalArgumentException: Can't find template  
parserCtorBody.st; group hierarchy is [C]
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:507)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:484)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:484)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:484)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:462)
    
org 
.antlr 
.stringtemplate 
.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
   ...

I've tried the latest intermediate build antlr-2008-09-08.17 as well  
as the 3.1 release and
both produce identical errors.  Here is the original thread on the  
topic:

   http://www.antlr.org/pipermail/antlr-interest/2008-August/029669.html

Any suggestions?

Thanks,

--Pat


From okrachin at purdue.edu  Tue Sep  9 09:19:30 2008
From: okrachin at purdue.edu (Olya Krachina)
Date: Tue,  9 Sep 2008 12:19:30 -0400
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <855C9335-85B3-4FF8-8984-238B191DF273@gmail.com>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
	<855C9335-85B3-4FF8-8984-238B191DF273@gmail.com>
Message-ID: <1220977170.48c6a212822f5@webmail.purdue.edu>

I still get the same error, even with your suggestion.

Quoting Chris Rebert <cvrebert at gmail.com>:

> I think you might need to left-factor here.
> Have you tried:
> 
> FLOAT: INT? '.' INT;
> 
> -Chris
> 
> Sent from my iPod
> 
> On Sep 8, 2008, at 9:01 PM, Olya Krachina <okrachin at purdue.edu> wrote:
> 
> > Hello,
> > I am new to antlr and i seem to be stuck on this.
> > i need to have 2 datatypes defined: int and float, currently i have  
> > them defined
> > like this in my .g file:
> >
> > INT:      ('0'..'9')+;
> > FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;
> >
> > So, this does not work, when it comes across an int i think it tries  
> > to match
> > the longest string, i.e. float but finds space instead of '.' (since  
> > its an int)
> > and bails out.
> >
> > ps: i know this is more a regexp question, but if someone could help  
> > out, I
> > would greatly appreciate it.
> >
> > thanks
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >
> 



From tbrandonau at gmail.com  Tue Sep  9 09:38:46 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Wed, 10 Sep 2008 02:38:46 +1000
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <1220932868.48c5f50493ca4@webmail.purdue.edu>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
Message-ID: <ebc876d70809090938r4e7513aq77c705554e38e16e@mail.gmail.com>

On Tue, Sep 9, 2008 at 2:01 PM, Olya Krachina <okrachin at purdue.edu> wrote:
> Hello,
> I am new to antlr and i seem to be stuck on this.
> i need to have 2 datatypes defined: int and float, currently i have them defined
> like this in my .g file:
>
> INT:      ('0'..'9')+;
> FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;
>
> So, this does not work, when it comes across an int i think it tries to match
> the longest string, i.e. float but finds space instead of '.' (since its an int)
> and bails out.
>
> ps: i know this is more a regexp question, but if someone could help out, I
> would greatly appreciate it.
>
> thanks
Those two rules work fine for me. I think either other rules are
interfering or you are providing invalid input to the grammar. Try
making a minimal grammar that reproduces the problem and post that
along with the exact input that fails.

Tom.

From okrachin at purdue.edu  Tue Sep  9 10:02:08 2008
From: okrachin at purdue.edu (Olya Krachina)
Date: Tue,  9 Sep 2008 13:02:08 -0400
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <ebc876d70809090938r4e7513aq77c705554e38e16e@mail.gmail.com>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
	<ebc876d70809090938r4e7513aq77c705554e38e16e@mail.gmail.com>
Message-ID: <1220979728.48c6ac1063b7d@webmail.purdue.edu>

Quoting Thomas Brandon <tbrandonau at gmail.com>:

> On Tue, Sep 9, 2008 at 2:01 PM, Olya Krachina <okrachin at purdue.edu> wrote:
> > Hello,
> > I am new to antlr and i seem to be stuck on this.
> > i need to have 2 datatypes defined: int and float, currently i have them
> defined
> > like this in my .g file:
> >
> > INT:      ('0'..'9')+;
> > FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;
> >
> > So, this does not work, when it comes across an int i think it tries to
> match
> > the longest string, i.e. float but finds space instead of '.' (since its an
> int)
> > and bails out.
> >
> > ps: i know this is more a regexp question, but if someone could help out,
> I
> > would greatly appreciate it.
> >
> > thanks
> Those two rules work fine for me. I think either other rules are
> interfering or you are providing invalid input to the grammar. Try
> making a minimal grammar that reproduces the problem and post that
> along with the exact input that fails.
> 
> Tom.
> 

this is the input file:

BEGIN
PROGRAM
END
PROTO 
34
89967
END

this is the rules so far:

ASSIGN                  : ":=" ;
COMMA                   : ',' ;
PLUS			: '+' ;
MINUS			: '-' ;
STAR			: '*' ;
SLASH			: '/' ;
EQUAL			: '=' ;
LESS			: '<' ;
GRT			: '>' ;
LPAREN			: '(' ;
RPAREN			: ')' ;
SEMICOL			: ';' ;


Whitespace
        :       ( ( '\003'..'\010' | '\t' | '\013' | '\f' | '\016'.. '\037' |
'\177'..'\377' | ' ' )
                | "\r\n"                { newline(); }
                | ( '\n' | '\r' )       { newline(); }
                )                       { _ttype = Token.SKIP;  }
        ;

IDENTIFIER
        :        ( 'a'..'z' | 'A'..'Z' )
		                ( 'a'..'z' | 'A'..'Z' | '0'..'9' )*
		;
		
INT:		 ('0'..'9')+ ;
FLOAT:   	(INT)? ('.') (INT);

if only ONE (either INT or FLOAT) is defined in .g, there are no errors, but
with both of them defined i run into problem.
thanks again.
                                                                                 

From jbb at acm.org  Tue Sep  9 10:02:26 2008
From: jbb at acm.org (John B. Brodie)
Date: Tue, 9 Sep 2008 13:02:26 -0400
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <1220977170.48c6a212822f5@webmail.purdue.edu>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
	<855C9335-85B3-4FF8-8984-238B191DF273@gmail.com>
	<1220977170.48c6a212822f5@webmail.purdue.edu>
Message-ID: <200809091302.26121.jbb@acm.org>

Greetings!

On Tuesday 09 September 2008 12:19:30 pm Olya Krachina wrote:
> I still get the same error, even with your suggestion.
>
> Quoting Chris Rebert <cvrebert at gmail.com>:
> > I think you might need to left-factor here.
> > Have you tried:
> >
> > FLOAT: INT? '.' INT;
...snipped...
> > On Sep 8, 2008, at 9:01 PM, Olya Krachina <okrachin at purdue.edu> wrote:
...snipped...
> > > INT:      ('0'..'9')+;
> > > FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;

you might try:

INT : DIGIT_SEQ ( '.' DIGIT_SEQ { $type = FLOAT; } )? ;
FLOAT : '.' DIGIT_SEQ ;
fragment DIGIT_SEQ : ( '0' .. '9' )+ ;


From jimi at temporal-wave.com  Tue Sep  9 10:03:59 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 09 Sep 2008 10:03:59 -0700
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <ebc876d70809090938r4e7513aq77c705554e38e16e@mail.gmail.com>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
	<ebc876d70809090938r4e7513aq77c705554e38e16e@mail.gmail.com>
Message-ID: <1220979839.3951.73.camel@jimi.temporal-wave.com>

On Wed, 2008-09-10 at 02:38 +1000, Thomas Brandon wrote:

> On Tue, Sep 9, 2008 at 2:01 PM, Olya Krachina <okrachin at purdue.edu> wrote:
> > Hello,
> > I am new to antlr and i seem to be stuck on this.
> > i need to have 2 datatypes defined: int and float, currently i have them defined
> > like this in my .g file:
> >
> > INT:      ('0'..'9')+;
> > FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;
> >
> > So, this does not work, when it comes across an int i think it tries to match
> > the longest string, i.e. float but finds space instead of '.' (since its an int)
> > and bails out.


See: 

http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating
+point%2C+dot%2C+range%2C+time+specs


> >
> > ps: i know this is more a regexp question, but if someone could help out, I
> > would greatly appreciate it.
> >
> > thanks
> Those two rules work fine for me. I think either other rules are
> interfering or you are providing invalid input to the grammar. Try
> making a minimal grammar that reproduces the problem and post that
> along with the exact input that fails.
> 
> Tom.
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/1bf09e9e/attachment.html 

From tbrandonau at gmail.com  Tue Sep  9 10:27:47 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Wed, 10 Sep 2008 03:27:47 +1000
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <1220979728.48c6ac1063b7d@webmail.purdue.edu>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
	<ebc876d70809090938r4e7513aq77c705554e38e16e@mail.gmail.com>
	<1220979728.48c6ac1063b7d@webmail.purdue.edu>
Message-ID: <ebc876d70809091027g5c360b4fw918172d3fb02c569@mail.gmail.com>

Ah, you are using ANTLR 2.x. Unless there is a particularly compelling
reason you would be best to move to ANTLR 3.1. They are quite
different so if you stick with 2.x you should make this clear in any
emails and should be careful to restrict yourself to information on
2.x.
It's been awhile but I imagine your problem is insufficient lookahead,
I believe you should have got a message to this effect when running
ANTLR. Try combining the int and float rules as in John Brodie's reply
(though adapting to ANTLR 2.x syntax of course).

Tom.

On Wed, Sep 10, 2008 at 3:02 AM, Olya Krachina <okrachin at purdue.edu> wrote:
> Quoting Thomas Brandon <tbrandonau at gmail.com>:
>
>> On Tue, Sep 9, 2008 at 2:01 PM, Olya Krachina <okrachin at purdue.edu> wrote:
>> > Hello,
>> > I am new to antlr and i seem to be stuck on this.
>> > i need to have 2 datatypes defined: int and float, currently i have them
>> defined
>> > like this in my .g file:
>> >
>> > INT:      ('0'..'9')+;
>> > FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;
>> >
>> > So, this does not work, when it comes across an int i think it tries to
>> match
>> > the longest string, i.e. float but finds space instead of '.' (since its an
>> int)
>> > and bails out.
>> >
>> > ps: i know this is more a regexp question, but if someone could help out,
>> I
>> > would greatly appreciate it.
>> >
>> > thanks
>> Those two rules work fine for me. I think either other rules are
>> interfering or you are providing invalid input to the grammar. Try
>> making a minimal grammar that reproduces the problem and post that
>> along with the exact input that fails.
>>
>> Tom.
>>
>
> this is the input file:
>
> BEGIN
> PROGRAM
> END
> PROTO
> 34
> 89967
> END
>
> this is the rules so far:
>
> ASSIGN                  : ":=" ;
> COMMA                   : ',' ;
> PLUS                    : '+' ;
> MINUS                   : '-' ;
> STAR                    : '*' ;
> SLASH                   : '/' ;
> EQUAL                   : '=' ;
> LESS                    : '<' ;
> GRT                     : '>' ;
> LPAREN                  : '(' ;
> RPAREN                  : ')' ;
> SEMICOL                 : ';' ;
>
>
> Whitespace
>        :       ( ( '\003'..'\010' | '\t' | '\013' | '\f' | '\016'.. '\037' |
> '\177'..'\377' | ' ' )
>                | "\r\n"                { newline(); }
>                | ( '\n' | '\r' )       { newline(); }
>                )                       { _ttype = Token.SKIP;  }
>        ;
>
> IDENTIFIER
>        :        ( 'a'..'z' | 'A'..'Z' )
>                                ( 'a'..'z' | 'A'..'Z' | '0'..'9' )*
>                ;
>
> INT:             ('0'..'9')+ ;
> FLOAT:          (INT)? ('.') (INT);
>
> if only ONE (either INT or FLOAT) is defined in .g, there are no errors, but
> with both of them defined i run into problem.
> thanks again.
>
>

From Waverly.Edwards at genesys.com  Tue Sep  9 10:51:53 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Tue, 9 Sep 2008 13:51:53 -0400
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <1220979839.3951.73.camel@jimi.temporal-wave.com>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu><ebc876d70809090938r4e7513aq77c705554e38e16e@mail.gmail.com>
	<1220979839.3951.73.camel@jimi.temporal-wave.com>
Message-ID: <FF993752CB890B4EB591BE5450C37BF1014626CA@navamane001.ad.internal.corp>

That was a pretty neat example.
 
 
Thank Jim,
 
 
W.

________________________________

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Tuesday, September 09, 2008 1:04 PM
To: Thomas Brandon
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] lexer: matching float vs int


On Wed, 2008-09-10 at 02:38 +1000, Thomas Brandon wrote: 

	On Tue, Sep 9, 2008 at 2:01 PM, Olya Krachina
<okrachin at purdue.edu> wrote:
	> Hello,
	> I am new to antlr and i seem to be stuck on this.
	> i need to have 2 datatypes defined: int and float, currently i
have them defined
	> like this in my .g file:
	>
	> INT:      ('0'..'9')+;
	> FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;
	>
	> So, this does not work, when it comes across an int i think it
tries to match
	> the longest string, i.e. float but finds space instead of '.'
(since its an int)
	> and bails out.


See: 

http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+poin
t%2C+dot%2C+range%2C+time+specs



	>
	> ps: i know this is more a regexp question, but if someone
could help out, I
	> would greatly appreciate it.
	>
	> thanks
	Those two rules work fine for me. I think either other rules are
	interfering or you are providing invalid input to the grammar.
Try
	making a minimal grammar that reproduces the problem and post
that
	along with the exact input that fails.
	
	Tom.
	
	List: http://www.antlr.org/mailman/listinfo/antlr-interest
	Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess
	

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/62a8b06e/attachment.html 

From sharwell at pixelminegames.com  Tue Sep  9 11:10:06 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 9 Sep 2008 13:10:06 -0500
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <1220932868.48c5f50493ca4@webmail.purdue.edu>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E320@Bloodymary.ironwillgames.com>

Here is the numeric lexer section of a C++ grammar. This method is very
different from Jim's method, as it doesn't use any semantic predicates,
and has no dependency on the target language. I'm curious how it
compares performance-wise. Since there are a lot of rules here, I'll
mention the 3 non-fragment rules are:

 

INTEGER_CONSTANT

CHARACTER_CONSTANT

FLOATING_CONSTANT

 

/////////////////////////////////////////////////

/////////////////////////////////////////////////

//

//  LEXER

//

 

// numbers

 

fragment

LETTER

        :       'a'..'z'

        |       'A'..'Z'

        ;

 

fragment

NONDIGIT

        :       '_'

        |       'a'..'z'

        |       'A'..'Z'

        ;

 

fragment

DIGIT

        :       '0'..'9'

        ;

 

INTEGER_CONSTANT

        :       DECIMAL_CONSTANT INTEGER_SUFFIX?

        |       OCTAL_CONSTANT INTEGER_SUFFIX?

        |       HEXADECIMAL_CONSTANT INTEGER_SUFFIX?

        |       '\'' C_CHAR_SEQUENCE '\''

        ;

 

fragment

DECIMAL_CONSTANT

        :       NONZERO_DIGIT DIGIT*

        ;

 

fragment

OCTAL_CONSTANT

        :       '0' OCTAL_DIGIT*

        ;

 

fragment

HEXADECIMAL_CONSTANT

        :       '0x' HEXADECIMAL_DIGIT+

        |       '0X' HEXADECIMAL_DIGIT+

        ;

 

fragment

NONZERO_DIGIT

        :       '1'..'9'

        ;

 

fragment

OCTAL_DIGIT

        :       '0'..'7'

        ;

 

fragment

HEXADECIMAL_DIGIT

        :       '0'..'9'

        |       'a'..'f'

        |       'A'..'F'

        ;

 

fragment

INTEGER_SUFFIX

        :       UNSIGNED_SUFFIX LONG_SUFFIX?

        |       LONG_SUFFIX UNSIGNED_SUFFIX?

        ;

 

fragment

UNSIGNED_SUFFIX

        :       'u' | 'U'

        ;

 

fragment

LONG_SUFFIX

        :       'l' | 'L'

        ;

 

CHARACTER_CONSTANT

        :       'L'? '\'' C_CHAR_SEQUENCE '\''

        ;

 

fragment

C_CHAR_SEQUENCE

        :       C_CHAR+

        ;

 

fragment

C_CHAR

        :       ~('\'' | '\\' | '\r' | '\n')

        |       ESCAPE_SEQUENCE

        ;

 

fragment

ESCAPE_SEQUENCE

        :       SIMPLE_ESCAPE_SEQUENCE

        |       OCTAL_ESCAPE_SEQUENCE

        |       HEXADECIMAL_ESCAPE_SEQUENCE

        ;

 

fragment

SIMPLE_ESCAPE_SEQUENCE

        :       '\\\''

        |       '\\\"'

        |       '\\?'

        |       '\\\\'

        |       '\\a'

        |       '\\b'

        |       '\\f'

        |       '\\n'

        |       '\\r'

        |       '\\t'

        |       '\\v'

        ;

 

fragment

OCTAL_ESCAPE_SEQUENCE

        :       '\\' OCTAL_DIGIT (OCTAL_DIGIT OCTAL_DIGIT?)?

        ;

 

fragment

HEXADECIMAL_ESCAPE_SEQUENCE

        :       '\\x' HEXADECIMAL_DIGIT+

        ;

 

FLOATING_CONSTANT

        :       FRACTIONAL_CONSTANT EXPONENT_PART? FLOATING_SUFFIX?

        |       DIGIT_SEQUENCE EXPONENT_PART FLOATING_SUFFIX?

        ;

 

fragment

FRACTIONAL_CONSTANT

        :       DIGIT_SEQUENCE '.' DIGIT_SEQUENCE?

        |       '.' DIGIT_SEQUENCE

        ;

 

fragment

EXPONENT_PART

        :       'e' SIGN? DIGIT_SEQUENCE

        |       'E' SIGN? DIGIT_SEQUENCE

        ;

 

fragment

SIGN

        :       '+'

        |       '-'

        ;

 

fragment

DIGIT_SEQUENCE

        :       DIGIT+

        ;

 

fragment

FLOATING_SUFFIX

        :       'f'

        |       'l'

        |       'F'

        |       'L'

        ;

 

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Olya Krachina
Sent: Monday, September 08, 2008 11:01 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] lexer: matching float vs int

 

Hello,

I am new to antlr and i seem to be stuck on this.

i need to have 2 datatypes defined: int and float, currently i have them
defined

like this in my .g file:

 

INT:      ('0'..'9')+; 

FLOAT:    ('0'..'9')*('.')('0'..'9')+ ;

 

So, this does not work, when it comes across an int i think it tries to
match

the longest string, i.e. float but finds space instead of '.' (since its
an int)

and bails out. 

 

ps: i know this is more a regexp question, but if someone could help
out, I

would greatly appreciate it.

 

thanks

 

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest

Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/9d45413c/attachment.html 

From jimi at temporal-wave.com  Tue Sep  9 12:15:54 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 09 Sep 2008 12:15:54 -0700
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64E320@Bloodymary.ironwillgames.com>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu>
	<86403CA0939415448BCCB83855EFE09A64E320@Bloodymary.ironwillgames.com>
Message-ID: <1220987754.3951.104.camel@jimi.temporal-wave.com>

On Tue, 2008-09-09 at 13:10 -0500, Sam Harwell wrote:
> Here is the numeric lexer section of a C++ grammar. This method is
> very different from Jim?s method, as it doesn?t use any semantic
> predicates,


See the leading points in the article, being that ANTLR is working out
the lookahead for you, whereas the example is minimal in this regard,
you don't have a range operator '..' here and the only language specific
things are input.LA(), which is just LA() in C. Finally, your code does
not accommodate erroneous input, it will just throw lexer exceptions. If
you are using IDEs or want good error messages from a parser, then you
need to code for that rather than try to intercept exceptions and work
it out afterwards.

But use whatever flaots your boat ;-). The examples was just for all the
new people that find this particular problem very thorny :-)

Jim



>  and has no dependency on the target language. I
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/ba00f350/attachment.html 

From sharwell at pixelminegames.com  Tue Sep  9 12:45:21 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 9 Sep 2008 14:45:21 -0500
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <1220987754.3951.104.camel@jimi.temporal-wave.com>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu><86403CA0939415448BCCB83855EFE09A64E320@Bloodymary.ironwillgames.com>
	<1220987754.3951.104.camel@jimi.temporal-wave.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E322@Bloodymary.ironwillgames.com>

You should cross-list that article under ?generating user-friendly error messages for bad input? or something similar. The wiki has various articles on error handling, but none that I saw that have user-friendly messages as a goal. The comments on yours as-is make it the best I?ve seen on that topic.

 

Sam

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Tuesday, September 09, 2008 2:16 PM
To: antlr-interest
Subject: Re: [antlr-interest] lexer: matching float vs int

 

On Tue, 2008-09-09 at 13:10 -0500, Sam Harwell wrote: 

Here is the numeric lexer section of a C++ grammar. This method is very different from Jim?s method, as it doesn?t use any semantic predicates,


See the leading points in the article, being that ANTLR is working out the lookahead for you, whereas the example is minimal in this regard, you don't have a range operator '..' here and the only language specific things are input.LA(), which is just LA() in C. Finally, your code does not accommodate erroneous input, it will just throw lexer exceptions. If you are using IDEs or want good error messages from a parser, then you need to code for that rather than try to intercept exceptions and work it out afterwards.

But use whatever flaots your boat ;-). The examples was just for all the new people that find this particular problem very thorny :-)

Jim





and has no dependency on the target language. I 

	 
	 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/7d1c35a6/attachment.html 

From okrachin at purdue.edu  Tue Sep  9 13:14:31 2008
From: okrachin at purdue.edu (Olya Krachina)
Date: Tue,  9 Sep 2008 16:14:31 -0400
Subject: [antlr-interest] lexer: matching float vs int
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64E322@Bloodymary.ironwillgames.com>
References: <1220932868.48c5f50493ca4@webmail.purdue.edu><86403CA0939415448BCCB83855EFE09A64E320@Bloodymary.ironwillgames.com>
	<1220987754.3951.104.camel@jimi.temporal-wave.com>
	<86403CA0939415448BCCB83855EFE09A64E322@Bloodymary.ironwillgames.com>
Message-ID: <1220991271.48c6d927d9f0b@webmail.purdue.edu>

Thank you all for the replies. Thomas Brandon  mentioned that i have 2.x instead
of 3.1. I am new to antler and compilers all together so I would not have been
able to notice that. But indeed i have antler 2.x, because of certain
compatibility issues.
I tried out what everyone suggested, googled antlr 2.x tutorials and i got my
lexer to work. The final rules after some trial and error are these:

protected DIGIT:        ('0'..'9') ;
INTLITERAL:		(DIGIT)+ ('.'(DIGIT)+ {$setType(FLOATLITERAL);})?;
FLOATLITERAL:	        ('.')(DIGIT)+;

perhaps there is a redundancy somewhere here (with DIGIT), but it's functional
for all the test cases i could think of. 

Thank you all very much for the help!


Quoting Sam Harwell <sharwell at pixelminegames.com>:

> You should cross-list that article under ???generating user-friendly error
> messages for bad input??? or something similar. The wiki has various articles
> on error handling, but none that I saw that have user-friendly messages as a
> goal. The comments on yours as-is make it the best I???ve seen on that
> topic.
> 
>  
> 
> Sam
> 
>  
> 
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
> Sent: Tuesday, September 09, 2008 2:16 PM
> To: antlr-interest
> Subject: Re: [antlr-interest] lexer: matching float vs int
> 
>  
> 
> On Tue, 2008-09-09 at 13:10 -0500, Sam Harwell wrote: 
> 
> Here is the numeric lexer section of a C++ grammar. This method is very
> different from Jim???s method, as it doesn???t use any semantic predicates,
> 
> 
> See the leading points in the article, being that ANTLR is working out the
> lookahead for you, whereas the example is minimal in this regard, you don't
> have a range operator '..' here and the only language specific things are
> input.LA(), which is just LA() in C. Finally, your code does not accommodate
> erroneous input, it will just throw lexer exceptions. If you are using IDEs
> or want good error messages from a parser, then you need to code for that
> rather than try to intercept exceptions and work it out afterwards.
> 
> But use whatever flaots your boat ;-). The examples was just for all the new
> people that find this particular problem very thorny :-)
> 
> Jim
> 
> 
> 
> 
> 
> and has no dependency on the target language. I 
> 
> 	 
> 	 
> 
> 



From jarrod at vertigrated.com  Tue Sep  9 13:40:01 2008
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Tue, 9 Sep 2008 16:40:01 -0400
Subject: [antlr-interest] Parsing a indention specific language like Python.
Message-ID: <fa3d0c740809091340s331f809bs2cdd6e794359f62e@mail.gmail.com>

I am working on a domain specific language and want to make indention
significant similar to python's syntax.But very very very very simple
compared to python. ( i.e. no line continuation characters )
I have done some research on Google and just find resource talking about how
difficult it is to do.
Is this something that is really possible with ANTLR v3.x?
Or should I just resign myself to using block identifiers?
Any insight is appreciated.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/cbcf6933/attachment.html 

From sharwell at pixelminegames.com  Tue Sep  9 13:50:32 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 9 Sep 2008 15:50:32 -0500
Subject: [antlr-interest] Parsing a indention specific language like
	Python.
In-Reply-To: <fa3d0c740809091340s331f809bs2cdd6e794359f62e@mail.gmail.com>
References: <fa3d0c740809091340s331f809bs2cdd6e794359f62e@mail.gmail.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E324@Bloodymary.ironwillgames.com>

There's a python grammar in the examples on the antlr homepage:

 

http://www.antlr.org/grammar/list

 

Specifically:

http://www.antlr.org/grammar/1200715779785/Python.g

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jarrod Roberson
Sent: Tuesday, September 09, 2008 3:40 PM
To: Antlr Interest
Subject: [antlr-interest] Parsing a indention specific language like
Python.

 

I am working on a domain specific language and want to make indention
significant similar to python's syntax.

But very very very very simple compared to python. ( i.e. no line
continuation characters )

I have done some research on Google and just find resource talking about
how difficult it is to do.

Is this something that is really possible with ANTLR v3.x?

Or should I just resign myself to using block identifiers?

Any insight is appreciated.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/2d3f8577/attachment.html 

From jarrod at vertigrated.com  Tue Sep  9 14:23:31 2008
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Tue, 9 Sep 2008 17:23:31 -0400
Subject: [antlr-interest] Parsing a indention specific language like
	Python.
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64E324@Bloodymary.ironwillgames.com>
References: <fa3d0c740809091340s331f809bs2cdd6e794359f62e@mail.gmail.com>
	<86403CA0939415448BCCB83855EFE09A64E324@Bloodymary.ironwillgames.com>
Message-ID: <fa3d0c740809091423y207a8861k50faa05dd1dc9082@mail.gmail.com>

On Tue, Sep 9, 2008 at 4:50 PM, Sam Harwell <sharwell at pixelminegames.com>wrote:

>  There's a python grammar in the examples on the antlr homepage:
>
>
>
> http://www.antlr.org/grammar/list
>
>
>
> Specifically:
>
> http://www.antlr.org/grammar/1200715779785/Python.g
>

thanks I found that, but I don't understand where they are actually doing
the indent/dedent logic in that grammar file?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/9969b558/attachment.html 

From titech at metaorb.com  Tue Sep  9 14:37:27 2008
From: titech at metaorb.com (titech at metaorb.com)
Date: Tue, 9 Sep 2008 14:37:27 -0700 (PDT)
Subject: [antlr-interest] Unparseable?
Message-ID: <375756.52769.qm@web82306.mail.mud.yahoo.com>

Is this just unparseable?  It is a piece of a DSN file output from Eagle PCB.
The string_quote piece and the single-quoted string seem to be deal-breakers.
I'm not currently attempting to incorporate the character passed in the string_quote
into the parser.  Even when it parses successfully, it seems to be
breaking the strings up into numerous tokens instead of one token per string.

Any advice would be greatly appreciated.

Thanks,
--Mike

==========================================================================

(PCB "C:/Archive/Development/EagleProjects/NewUSBToaster/NewUSBToaster_3.brd"
  (parser
    (string_quote ")
    (space_in_quoted_tokens on)
    (host_cad CadSoft)
    (host_version 'EAGLE Version 4.16r2 Copyright (c) 1988-2006 CadSoft')
  )
  (structure
    (layer "1#Top"  (type signal))
    (layer "16#Bottom"  (type signal))
  )
)

==========================================================================

grammar SQTest_11;

options
{
  output=AST;
  ASTLabelType=CommonTree;
}

header    : OPN!   'PCB'^ string_t dsnparser structure CPN!;

dsnparser : OPN! 'parser'^  string_quote
                space_in_quoted_tokens
                host_cad
                host_version CPN!; 

string_quote :   OPN  'string_quote'        '"'          CPN           -> ^('string_quote' '"')
               | OPN  'string_quote'        '\''         CPN           -> ^('string_quote' '\'')
               | OPN  'string_quote'        OTHER          CPN           -> ^('string_quote' OTHER);

space_in_quoted_tokens : OPN! 'space_in_quoted_tokens'^ bool_t CPN!;

host_cad : OPN! 'host_cad'^ id_t CPN!;
    
host_version : OPN! 'host_version'^ string_t? CPN!;


structure : OPN! 'structure'^ 
            layer*
            CPN!; 

layer           :  OPN! 'layer'^ string_t type CPN!;

type            :  OPN! 'type'^ id_t CPN!;
    
string_t        :  sq_or_dq_string;

id_t            :  ID;

bool_t          :  true_or_false;

//Composite types
true_or_false           :         TRUE | FALSE;

sq_or_dq_string            :         single_quoted_string | double_quoted_string;

//Basic types
single_quoted_string    :         '\'' ( options {greedy=false;} : . )* '\'';

double_quoted_string    :         '"' ( options {greedy=false;} : . )* '"';

FLOAT    :       SIGN? ('0'..'9')+ '.' ('0'..'9')+;

INT    :       SIGN? ('0'..'9')+;

TRUE    :     'on' | 'true' | 'yes' | '1';

FALSE    :    'off' | 'false' | 'no' | '0';

ID    : (LETTER|'_')(LETTER|'_'|DIGIT)*;

fragment LETTER : LOWER | UPPER;
fragment LOWER  : 'a'..'z';
fragment UPPER  : 'A'..'Z';
fragment DIGIT  : '0'..'9';
fragment SPACE  : ' ' | '\t';
fragment SIGN   : '+' | '-';
NEWLINE            : ('\r'? '\n')+ { $channel = HIDDEN; };
WHITESPACE      : SPACE+ { $channel = HIDDEN; };

OPN       : '(';
CPN       : ')';
OTHER    : .;

From jimi at temporal-wave.com  Tue Sep  9 15:15:34 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 09 Sep 2008 15:15:34 -0700
Subject: [antlr-interest] Parsing a indention specific language
	like	Python.
In-Reply-To: <fa3d0c740809091340s331f809bs2cdd6e794359f62e@mail.gmail.com>
References: <fa3d0c740809091340s331f809bs2cdd6e794359f62e@mail.gmail.com>
Message-ID: <1220998534.3951.136.camel@jimi.temporal-wave.com>

On Tue, 2008-09-09 at 16:40 -0400, Jarrod Roberson wrote:
> I am working on a domain specific language and want to make indention
> significant similar to python's syntax.


If it is your language, then the answer is "Don't do that!"

> But very very very very simple compared to python. ( i.e. no line
> continuation characters )
> 
> I have done some research on Google and just find resource talking
> about how difficult it is to do.
> Is this something that is really possible with ANTLR v3.x?


Yes, it is possible, but you need to keep track of indents and outdents
for the lexer - probably best to override the token stream to do that.

> Or should I just resign myself to using block identifiers?


If you mean "Wisely chose formal terminals to identify the statement
block", then yes you should ;-) This is my opinion of course, but the
complexities make programs error prone. When choosing a syntax, don't
think about the language in perfect form, think "How can a parser
identify the maximum possible set of error conditions, give good error
messages, and recover". Any construct where a line of code is
syntactically and semantically valid whether at column 8 or 16, but has
different actual meaning in terms of logical flow, is basically broken.
A parser just has to assume you know what you mean. Combine those kind
of concerns with specifying a language that is easy to formulate for
your target audience and you are good. 

Now if you means something as simple as leading white space of any depth
is significant, otherwise it isn't then:

fragment
LINEIN : ;

WS 
@init
{
   int sPos = getCharIndex();
}
: (' ' | '\t')+ { if (sPos == 0) $type = LINEIN; }
;

line : configSegment* ;

configSegment
    : ID // Segment ID
        (LINEIN configValue?)*
    ;

Might help you get going.

> Any insight is appreciated.


I thought that there was a sample Python grammar for 3.1... yes:

http://www.antlr.org/grammar/1200715779785/Python.g



> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/c32e738e/attachment.html 

From jimi at temporal-wave.com  Tue Sep  9 15:48:25 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 09 Sep 2008 15:48:25 -0700
Subject: [antlr-interest] Unparseable?
In-Reply-To: <375756.52769.qm@web82306.mail.mud.yahoo.com>
References: <375756.52769.qm@web82306.mail.mud.yahoo.com>
Message-ID: <1221000505.3951.163.camel@jimi.temporal-wave.com>

On Tue, 2008-09-09 at 14:37 -0700, titech at metaorb.com wrote:

> Is this just unparseable?  It is a piece of a DSN file output from Eagle PCB.
> The string_quote piece and the single-quoted string seem to be deal-breakers.
> I'm not currently attempting to incorporate the character passed in the string_quote
> into the parser.  Even when it parses successfully, it seems to be
> breaking the strings up into numerous tokens instead of one token per string.


First, remove all the string literals from your parser and make them
lexer rules.

Next, create a STRING_QUOTE token:

STRING_QUOTE : 'string_quote' SPACE+ .
    {
        // String quote is always first non whitespace character after
keyword
       //
      String s = $text;

      setText(s.subString(s.length()-1, s.length());
    }
;
Now your token contains the quote.

Now
string_quote : OPN! STRING_QUOTE^ CPN! ;


That's it.

Jim

> 
> Any advice would be greatly appreciated.
> 
> Thanks,
> --Mike
> 
> ==========================================================================
> 
> (PCB "C:/Archive/Development/EagleProjects/NewUSBToaster/NewUSBToaster_3.brd"
>   (parser
>     (string_quote ")
>     (space_in_quoted_tokens on)
>     (host_cad CadSoft)
>     (host_version 'EAGLE Version 4.16r2 Copyright (c) 1988-2006 CadSoft')
>   )
>   (structure
>     (layer "1#Top"  (type signal))
>     (layer "16#Bottom"  (type signal))
>   )
> )
> 
> ==========================================================================
> 
> grammar SQTest_11;
> 
> options
> {
>   output=AST;
>   ASTLabelType=CommonTree;
> }
> 
> header    : OPN!   'PCB'^ string_t dsnparser structure CPN!;
> 
> dsnparser : OPN! 'parser'^  string_quote
>                 space_in_quoted_tokens
>                 host_cad
>                 host_version CPN!; 
> 
> string_quote :   OPN  'string_quote'        '"'          CPN           -> ^('string_quote' '"')
>                | OPN  'string_quote'        '\''         CPN           -> ^('string_quote' '\'')
>                | OPN  'string_quote'        OTHER          CPN           -> ^('string_quote' OTHER);
> 
> space_in_quoted_tokens : OPN! 'space_in_quoted_tokens'^ bool_t CPN!;
> 
> host_cad : OPN! 'host_cad'^ id_t CPN!;
>     
> host_version : OPN! 'host_version'^ string_t? CPN!;
> 
> 
> structure : OPN! 'structure'^ 
>             layer*
>             CPN!; 
> 
> layer           :  OPN! 'layer'^ string_t type CPN!;
> 
> type            :  OPN! 'type'^ id_t CPN!;
>     
> string_t        :  sq_or_dq_string;
> 
> id_t            :  ID;
> 
> bool_t          :  true_or_false;
> 
> //Composite types
> true_or_false           :         TRUE | FALSE;
> 
> sq_or_dq_string            :         single_quoted_string | double_quoted_string;
> 
> //Basic types
> single_quoted_string    :         '\'' ( options {greedy=false;} : . )* '\'';
> 
> double_quoted_string    :         '"' ( options {greedy=false;} : . )* '"';
> 
> FLOAT    :       SIGN? ('0'..'9')+ '.' ('0'..'9')+;
> 
> INT    :       SIGN? ('0'..'9')+;
> 
> TRUE    :     'on' | 'true' | 'yes' | '1';
> 
> FALSE    :    'off' | 'false' | 'no' | '0';
> 
> ID    : (LETTER|'_')(LETTER|'_'|DIGIT)*;
> 
> fragment LETTER : LOWER | UPPER;
> fragment LOWER  : 'a'..'z';
> fragment UPPER  : 'A'..'Z';
> fragment DIGIT  : '0'..'9';
> fragment SPACE  : ' ' | '\t';
> fragment SIGN   : '+' | '-';
> NEWLINE            : ('\r'? '\n')+ { $channel = HIDDEN; };
> WHITESPACE      : SPACE+ { $channel = HIDDEN; };
> 
> OPN       : '(';
> CPN       : ')';
> OTHER    : .;
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080909/e51f8b9f/attachment.html 

From adreghiciu at gmail.com  Wed Sep 10 00:30:38 2008
From: adreghiciu at gmail.com (Alin Dreghiciu)
Date: Wed, 10 Sep 2008 10:30:38 +0300
Subject: [antlr-interest] ANTLR in Maven Central?
Message-ID: <87eb8aee0809100030i13d912aasb83d3db550fdd5b7@mail.gmail.com>

Hi guys,

Is there any plan to have antlr 3.1 and string template 3.2 available
from maven central repo?
(http://repo1.maven.org/maven2/org/antlr)

Thanx,
-- 
Alin Dreghiciu
http://www.ops4j.org - New Energy for OSS Communities - Open
Participation Software.
http://www.qi4j.org - New Energy for Java - Domain Driven Development.
http://malaysia.jayway.net - New Energy for Projects - Great People
working on Great Projects at Great Places

From mikael.petterson at ericsson.com  Wed Sep 10 07:22:38 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Wed, 10 Sep 2008 16:22:38 +0200
Subject: [antlr-interest] Newbie needs help with grammmar
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD99173451@esealmw104.eemea.ericsson.se>

Hi,

I have the following parser in my grammar file:

error returns [ClearCaseElementState el]
	: {int exceptionCode = 0;}
	  {boolean throwException = false;}
	CLEARTOOL 'Error:' ('Entry' 'named' elem=STRING 'already'
'exists.' {throwException = true; exceptionCode |=
ClearCase.ERROR_ALREADY_ADDED;}
	| 'Element' elem=STRING 'has' 'checkouts.' {throwException =
true; exceptionCode |= ClearCase.ERROR_ALREADY_CHECKED_OUT;}
	| 'Element' elem=STRING 'is' 'already' 'checked' 'out' 'to' VIEW
STRING DOT {el = new ClearCaseElementState($elem.text,
ClearCase.IS_ELEMENT | ClearCase.ERROR_ALREADY_CHECKED_OUT);}
	| 'Can\u0027t' 'modify' 'directory' elem=STRING 'because' 'it'
'is' 'not' 'checked' 'out.' {throwException = true; exceptionCode |=
ClearCase.ERROR_DIR_IS_NOT_CHECKED_OUT;}
	| 'Unable' 'to' 'access' elem=STRING ':' 'No' 'such' 'file' 'or'
'directory.' {throwException = true; exceptionCode |=
ClearCase.ERROR_NOT_ACCESSIBLE;}
	| 'By' 'default' COMMA 'won\u0027t' 'create' 'version' 'with'
'data' 'identical' 'to' 'predecessor.' NEWLINE
	 CLEARTOOL 'Error:' 'Unable' 'to' 'check' 'in' elem=STRING DOT
{throwException = true; exceptionCode |=
ClearCase.ERROR_PREDECESSOR_IS_IDENTICAL;}
	| 'The' 'most' 'recent' 'version' 'on' 'branch' STRING 'is'
'not' 'the' 'predecessor' 'of' 'this' 'version.'NEWLINE	 CLEARTOOL
'Error:' 'Unable' 'to' 'check' 'in' elem=STRING DOT {throwException =
true; exceptionCode |=
ClearCase.ERROR_MOST_RECENT_NOT_PREDECESSOR_OF_THIS_VERSION;}
                | (LITERAL | STRING | DOT)+)
	{if (throwException) throw new ClearCaseException(exceptionCode,
new String[]{$elem.text}, null);}
	;

I have a junit test with the following lines:

public void testRecognitionIndeticalResourceCheckin() {
		StringBuffer cleartoolOutput = new StringBuffer();
		cleartoolOutput
				.append("cleartool: Error: By default,
won't create version with data identical to predecessor.\r\n"+
                                                            "cleartool:
Error: Unable to check in
\"M:\\eraonel_testa\\mbv_admin\\testarea\\productsample\\com\\sample\\pr
oduct\\ProductC.java\".\r\n");

		try {

			Reader reader = new
StringReader(cleartoolOutput.toString());
			CleartoolOutputLexer lexer = new
CleartoolOutputLexer(
					new ANTLRReaderStream(reader));
			CommonTokenStream cts = new
CommonTokenStream(lexer);
			CleartoolOutputParser parser = new
CleartoolOutputParser(cts);
			List elements = parser.main();
			ClearCaseElementState[] elArray =
(ClearCaseElementState[]) elements
					.toArray(new
ClearCaseElementState[elements.size()]);
			fail();
		} catch (ClearCaseException e){
			assertTrue(e.getErrorCode() ==
ClearCase.ERROR_PREDECESSOR_IS_IDENTICAL);
			
		} catch (IOException e) {
			// TODO handle catch block
			e.printStackTrace();
		} catch (RecognitionException e) {
			// TODO handle catch block
			e.printStackTrace();
		}
	}

This is the code that I am using:

protected ClearCaseElementState[] parserOutput(final String[] result)
			throws ClearCaseException {
		final StringBuffer display = new StringBuffer();
		for (int i = 0; i < result.length; i++) {
			if (i != 0) {
				display.append("\n");
			}
			display.append(result[i]);
		}
		LOG.finest("parsing:" + display.toString());
		ClearCaseElementState[] res = null;
		try {
			final Reader reader = new
StringReader(display.toString());
			final CleartoolOutputLexer lexer = new
CleartoolOutputLexer(
					new ANTLRReaderStream(reader));
			final CommonTokenStream cts = new
CommonTokenStream(lexer);
			final CleartoolOutputParser parser = new
CleartoolOutputParser(cts);
			final List elements = parser.main();
			res = (ClearCaseElementState[]) elements
					.toArray(new
ClearCaseElementState[elements.size()]);
		} catch (final IOException e) {
			// TODO handle catch block
			e.printStackTrace();
		} catch (final RecognitionException e) {
			// TODO handle catch block
			e.printStackTrace();
		}
		return res;
	}

This is the output that I get:

line 3:11 no viable alternative at character 'c'
line 10:8 mismatched character ' ' expecting set null
line 11:27 mismatched character '\r' expecting set null
BR.recoverFromMismatchedToken
line 13:28 mismatched input 'check' expecting 'access'

No exception will be thrown!

It seems like my parser is finding:

Unable' 'to' 'access' elem=STRING ':' 'No' 'such' 'file' 'or'
'directory.' {throwException = true; exceptionCode |=
ClearCase.ERROR_NOT_ACCESSIBLE;}

But the input that I have is:

cleartool: Error: Unable to check in
\"M:\\eraonel_testa\\mbv_admin\\testarea\\productsample\\com\\sample\\pr
oduct\\ProductC.java\"

How can I change my grammar?

cheers,

//mike - a newbie on this.



Mikael Petterson
Software Designer


Ericsson AB, Stockholm, Sweden
Visiting address: Isafjordsgatan 15, Kista
Phone: +46 70 2673044 
E-mail: mikael.petterson at ericsson.com 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080910/57b55a4f/attachment.html 

From javafoust at gmail.com  Wed Sep 10 23:27:16 2008
From: javafoust at gmail.com (Foust)
Date: Wed, 10 Sep 2008 23:27:16 -0700
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <48C5C4A4.4010001@Yahoo.com>
References: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
	<48C5C4A4.4010001@Yahoo.com>
Message-ID: <000701c913d7$7144f210$53ced630$@com>

Austin,

Very well said -- all three points, on multiple levels.

I especially like your observation about languages. The design of the
language should not get in the way of getting common stuff done (Prolog, F#,
ERLANG, etc.), without giving even more back for the effort (as do C++,
Java, C#, etc.).

> pretend you have a SQL database as the ONLY thing available 
> to the template engine

I don't know ST well enough to comment on its implementation, but it this is
an intriguing idea. Wouldn't you need expression support, in addition, to
allow the manipulation/combination of that data?

-Brent

> -----Original Message-----
> 
> 1. Part of putting code into an open source project is letting
> everybody
> else read it. Another part is letting other people contribute to it.
> 
> Before you spend a year writing code, go to some conferences that have
> nothing to do with parsing.
> 
> 2. There seem to be two models for using ST currently. First is "let
> the
> templates run free." Second is "call a template, then call another."
> 
> 2a. The "templates run free" is I guess the "best way" but getting all
> the data structures set up so that the templates can be happy takes a
> hell of a lot of work. If you could do that, then one template could
> blissfully call another and another, referring to the giant global data
> store.
> 
> 2b. The "call one, call another" makes more sense from an immediate
> code
> perspective, especially from a parser: here's all the context I have at
> the moment, go generate a little bit of text and come back. I'll pass
> that string up the chain, and somebody with more or different
> information can insert that string into their context.
> 
> It makes sense for there to be a sort of happy medium, 2c, which maybe
> should be built on top of some kind of hierarchical base data object
> class. That way callers with fairly limited context could link a
> template, or a location (anchor? namespace? context) inside a template,
> to a concrete data element. But at the same time, the templates could
> be
> written to interact with each other, instead of just dumbly returning
> text. In that respect, it seems a little bit like the DOM tree model.
> Except that it shouldn't be. It should be more general purpose -- an
> in-memory database, say. (Seriously: as a thought experiment, pretend
> you have a SQL database as the ONLY thing available to the template
> engine. What do templates look like?)
> 
> Alternatively, think about what happens if template data access uses
> xpath syntax.
> 
> My point is that the stuff *outside* the angle brackets is easy. It's
> the interpolation and invocation and whatnot that costs all the effort.
> At some level, you'll wind up writing a PHP interpreter. What do you
> really want as your requirements?
> 
> 3. I read a bunch of stuff about how ST was a functional language. And
> I
> remember thinking, what possible use is this to me? Do I give a rat's
> ass if my text is generated in a functional language? At the time, I
> was
> trying to implement automatically generated sequence numbers for things
> like test cases and symbols. It was far more difficult than it needed
> to
> be to inject that single simple feature. I had to support it in my
> code,
> rather than having it come for free in the templates. And it tended to
> taint my design. There needs to be a way to get stuff done, and if that
> means that a bunch of nerds from the Esoteric Language Institute are
> disappointed, give 'em a Klingon dictionary and send them home.



From Austin_Hastings at Yahoo.com  Wed Sep 10 23:53:39 2008
From: Austin_Hastings at Yahoo.com (Austin Hastings)
Date: Thu, 11 Sep 2008 01:53:39 -0500
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <000701c913d7$7144f210$53ced630$@com>
References: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>	<48C5C4A4.4010001@Yahoo.com>
	<000701c913d7$7144f210$53ced630$@com>
Message-ID: <48C8C073.8090408@Yahoo.com>

Brent,

>> pretend you have a SQL database as the ONLY thing available 
>> to the template engine
>>     
>
> I don't know ST well enough to comment on its implementation, but it this is
> an intriguing idea. Wouldn't you need expression support, in addition, to
> allow the manipulation/combination of that data?
>   


I don't know - that's why it was a thought experiment. The same thing 
could be said for xpath (except that would make ST look a lot like every 
other XSLT processor out there).
 
The point is that if you have a single format for data, then maybe it's 
a little easier to do template work. So the program fires up sqllite, 
and creates tables and populates them, and one part can overwrite the 
stuff done by another part, and that's okay. And when it's all ready, 
the template engine runs and the template gets to make SQL calls.
 
The same thing would be true for Xpath. The program builds a tree, of 
whatever shape, and then the template looks things up.

The point is not "I think you should include SQL in the templates." The 
point is "there should be a common data source." Some kind of blackboard 
model (global data, single instance) makes sense to me considering the 
nature of the problem. But it has to support some kind of internal 
structuring. That's what the experiment is for.

=Austin


From mail at martin-probst.com  Thu Sep 11 01:53:42 2008
From: mail at martin-probst.com (Martin Probst)
Date: Thu, 11 Sep 2008 10:53:42 +0200
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <000701c913d7$7144f210$53ced630$@com>
References: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
	<48C5C4A4.4010001@Yahoo.com> <000701c913d7$7144f210$53ced630$@com>
Message-ID: <E920971E-A7E3-4621-9F34-9425A1FD5AAF@martin-probst.com>

>> Do I give a rat's ass if my text is generated in a functional  
>> language? At the time, I
>> was trying to implement automatically generated sequence numbers  
>> for things
>> like test cases and symbols. It was far more difficult than it  
>> needed to be


> I especially like your observation about languages. The design of the
> language should not get in the way of getting common stuff done  
> (Prolog, F#,
> ERLANG, etc.), without giving even more back for the effort (as do C+ 
> +,
> Java, C#, etc.).

The point of languages like Erlang or Prolog is that they make  
different design tradeoffs than languages like Java or C#, and this  
leads to very compelling features, like the robustness and  
restartability (eh, not a word...) of Erlang micro-processes. Building  
in some "convenience features", like mutable variables, would  
completely taint the language.

About functional languages: programming in a functional style is  
something you need to get used to, and it takes time. However many  
people find that programs written in a pure functional language have  
significantly less bugs, among other advantages. And in particular  
transformation problems are very amenable to such stuff.

Something like a global, mutable counter variable might be a nice  
quick hack to get something done, but it fails on a lot of other  
levels, e.g. modularity, ability to test, potentially thread safety,  
and so on.

I'd really recommend you to give this stuff some more time, it is  
actually useful and a good idea.

Regards,
/Martin

From mikael.petterson at ericsson.com  Thu Sep 11 06:02:48 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Thu, 11 Sep 2008 15:02:48 +0200
Subject: [antlr-interest] In bad need of expert help
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD99173455@esealmw104.eemea.ericsson.se>

Hi,

My input lines to antlr to handle are:

"Jalopy Source Code Formatter 1.9_126\r\n" +
"Site License Owner: Ericsson AB, Kista, Sweden\r\n"+ 
"Copyright (c) 2003-2008 TRIEMAX Software Ltd. All rights reserved.\r\n"
+
"[INFO] Detecting code convention format\r\n" +
"[INFO] Jalopy code convention detected\r\n" +
"[INFO] Activate profile \"wong\"\r\n" +
"[INFO] Importing settings into active profile \"wong\"\r\n"+
"[INFO] Imported 732 keys into active profile \"wong\"\r\n" +
"[INFO]
M:\\eraonel_testa\\mbv_admin\\testarea\\productsample\\com\\sample\\prod
uct\\ProductC.java:0:0:File clean, skipped\r\n"+
"[INFO] 0 files formatted in 0.656 sec\r\n"+
"command exited with value 0\r\n"+
"cleartool: Error: By default, won't create version with data identical
to predecessor.\r\n"+
"cleartool: Error: Unable to check in
\"M:\\eraonel_testa\\mbv_admin\\testarea\\productsample\\com\\sample\\pr
oduct\\ProductC.java\".\r\n"

If I remove the part that is not interpreted:

"cleartool: Error: By default, won't create version with data identical
to predecessor.\r\n"+
"cleartool: Error: Unable to check in
\"M:\\eraonel_testa\\mbv_admin\\testarea\\productsample\\com\\sample\\pr
oduct\\ProductC.java\".\r\n"


My test will run ok.

I will attach my *.g file.

I appreciate all help that I can get.

cheers,

//mike <<CleartoolOutput.g>> 


Mikael Petterson
Software Designer


Ericsson AB, Stockholm, Sweden
Visiting address: Isafjordsgatan 15, Kista
Phone: +46 70 2673044 
E-mail: mikael.petterson at ericsson.com 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080911/0654ef41/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CleartoolOutput.g
Type: application/octet-stream
Size: 6573 bytes
Desc: CleartoolOutput.g
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080911/0654ef41/attachment.obj 

From jimi at temporal-wave.com  Thu Sep 11 07:57:19 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 11 Sep 2008 07:57:19 -0700
Subject: [antlr-interest] In bad need of expert help
In-Reply-To: <8E9F9F4EE1FBD34FBEDD7EC2360AFD99173455@esealmw104.eemea.ericsson.se>
References: <8E9F9F4EE1FBD34FBEDD7EC2360AFD99173455@esealmw104.eemea.ericsson.se>
Message-ID: <1221145039.3912.199.camel@jimi.temporal-wave.com>

On Thu, 2008-09-11 at 15:02 +0200, Mikael Petterson wrote:

> Hi,


Mikael,

I don't think that this is the tool for doing that, even though you
could use a filtering lexer to do it. It would be trivial to write a
small Java program to do it, if there is no operating system toolset,
but you can also just use:

cat outputfile | grep -v "Error:"

Or use awk or sed and so on. Is there some reason that you thought you
would need a parser to do this?

JIm

> 
> My input lines to antlr to handle are:
> 
> "Jalopy Source Code Formatter 1.9_126\r\n" + 
> "Site License Owner: Ericsson AB, Kista, Sweden\r\n"+ 
> "Copyright (c) 2003-2008 TRIEMAX Software Ltd. All rights reserved.\r
> \n" + 
> "[INFO] Detecting code convention format\r\n" + 
> "[INFO] Jalopy code convention detected\r\n" + 
> "[INFO] Activate profile \"wong\"\r\n" + 
> "[INFO] Importing settings into active profile \"wong\"\r\n"+ 
> "[INFO] Imported 732 keys into active profile \"wong\"\r\n" + 
> "[INFO] M:\\eraonel_testa\\mbv_admin\\testarea\\productsample\\com\
> \sample\\product\\ProductC.java:0:0:File clean, skipped\r\n"+
> 
> "[INFO] 0 files formatted in 0.656 sec\r\n"+ 
> "command exited with value 0\r\n"+ 
> "cleartool: Error: By default, won't create version with data
> identical to predecessor.\r\n"+ 
> "cleartool: Error: Unable to check in \"M:\\eraonel_testa\\mbv_admin\
> \testarea\\productsample\\com\\sample\\product\\ProductC.java\".\r\n"
> 
> If I remove the part that is not interpreted:
> 
> "cleartool: Error: By default, won't create version with data
> identical to predecessor.\r\n"+ 
> "cleartool: Error: Unable to check in \"M:\\eraonel_testa\\mbv_admin\
> \testarea\\productsample\\com\\sample\\product\\ProductC.java\".\r\n"
> 
> 
> My test will run ok.
> 
> I will attach my *.g file.
> 
> I appreciate all help that I can get.
> 
> cheers,
> 
> //mike <<CleartoolOutput.g>> 
> 
> 
> Mikael Petterson
> Software Designer
> 
> 
> Ericsson AB, Stockholm, Sweden
> Visiting address: Isafjordsgatan 15, Kista
> Phone: +46 70 2673044
> E-mail: mikael.petterson at ericsson.com
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080911/99a75170/attachment.html 

From egor.abramovich at googlemail.com  Thu Sep 11 09:12:12 2008
From: egor.abramovich at googlemail.com (=?KOI8-R?B?5cfP0iDhwtLBzc/Xyd4=?=)
Date: Thu, 11 Sep 2008 19:12:12 +0300
Subject: [antlr-interest] StringTemplate test case: Capitalizing all words
	in text
Message-ID: <5591b9500809110912t601cb2e9sbeb04154ccaadfc@mail.gmail.com>

Hello,

In my test I am trying to create a grammar that should capitalize all
words in text.
Supposing text contains of english characters, punctuation marks and numbers.
Here is my grammar (with line numbers added):

-------------------------------->8--- start of UpperAll.g

01: grammar UpperAll;
02: options {output=template; rewrite=true;}
03:
04: sent_en  :   ( en+=en_word PUNKT? INT? )+ //->
template(words={$en}) "<words; separator=\" \">"
05:          ;
06:
07: en_word   :   ('A'..'Z' | 'a'..'z' )+ -> template(word={
TestUpperAll.caps($en_word.text) }) "<word>"
08:           ;
09:
10: PUNKT     :   '.' | ',' | '!' | '?' | '(' | ')';
11: INT       :   '0'..'9'+ ;
12: NEWLINE  :   '\r'? '\n' ;
13: WS       :   (' '|'\t'|'\n'|'\r')+ {$channel = HIDDEN;} ;

-------------------------------->8--- end of UpperAll.g

When trying to generate, I am getting an error message:

Check Grammar reported some errors:
error(201):UpperAll.g:4:40: The following alternative can never be matched: 2

Here is console output:

[10:40:53] warning(200): UpperAll.g:4:28: Decision can match input
such as "PUNKT" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
[10:40:53] warning(200): UpperAll.g:4:35: Decision can match input
such as "INT" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
[10:40:53] warning(200): UpperAll.g:4:40: Decision can match input
such as "{EOF, PUNKT..INT}" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
[10:40:53] error(201): UpperAll.g:4:40: The following alternatives can
never be matched: 2

[10:40:53] warning(200): UpperAll.g:7:36: Decision can match input
such as "PUNKT" using multiple alternatives: 1, 2, 3
As a result, alternative(s) 3,2 were disabled for that input
[10:40:53] warning(200): UpperAll.g:7:36: Decision can match input
such as "INT" using multiple alternatives: 1, 2, 3
As a result, alternative(s) 3,2 were disabled for that input
[10:40:53] warning(200): UpperAll.g:7:36: Decision can match input
such as "EOF" using multiple alternatives: 1, 2, 3
As a result, alternative(s) 3,2 were disabled for that input
[10:40:53] error(201): UpperAll.g:7:36: The following alternatives can
never be matched: 2,3


When commenting out template generation in line 7, like below, grammar
is generating code successfully, but generated UpperAllParser.java
contains compilation errors:

07: en_word   :   ('A'..'Z' | 'a'..'z' )+ // -> template(word={
TestUpperAll.caps($en_word.text) }) "<word>"

I guess that problem is somewhere in line 4 of grammar, but I don't
know how to state this in a different way.

Here is a test rig for that grammar:

-------------------------------->8--- start of TestUpperAll.java

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.PrintWriter;

import org.antlr.runtime.ANTLRInputStream;
import org.antlr.runtime.TokenRewriteStream;

public class TestUpperAll {

    public static void main(String[] args) throws Exception {
        int n = 1;
        FileInputStream in = new FileInputStream("test_upper_"+n+".txt");
        ANTLRInputStream input = new ANTLRInputStream(in);
        UpperAllLexer lexer = new UpperAllLexer(input);
        in.close();
        TokenRewriteStream tokens = new TokenRewriteStream(lexer);
        UpperAllParser parser = new UpperAllParser(tokens);
        parser.sent_en();
        saveStr("test_upper_"+n+"_out.txt", tokens.toString()); //
emit rewritten source
        System.out.println("Test "+n+" done");
    }

    /** Capitalize the first letter of string */
    public static String caps(String s) {
        System.out.println("caps: "+s);
        if (s == null || s.length() == 0)
            return s;
        StringBuffer b = new StringBuffer(s);
        b.setCharAt(0, Character.toUpperCase(b.charAt(0)));
        return b.toString();
    }

    /** Save string to file. */
    public static void saveStr(String fname, String text) throws IOException {
        PrintWriter out = new PrintWriter(new FileOutputStream(fname));
        out.print(text);
        out.close();
    }

}

-------------------------------->8--- end of TestUpperAll.java

I am using antlrworks-1.2.

Could you please advise how it should be done properly.

Thank you.

Best regards,
Egor Abramovich

From J.Kraaijeveld at Askesis.nl  Thu Sep 11 09:29:07 2008
From: J.Kraaijeveld at Askesis.nl (Joost Kraaijeveld)
Date: Thu, 11 Sep 2008 18:29:07 +0200
Subject: [antlr-interest] Antlworks and StringTemplate / System.out.println?
Message-ID: <1221150547.30860.92.camel@panoramix.askesis.nl>

Hi,

I am in the process of learning Antlr and translating source. Is it
possible to view the output of StringTemplates and/or rules with
System.out.println in Antlrworks, or should I create my own application
with main to do so? If so, should I use the generated *token,
*Lexer.java and *Parser.java files?

TIA

-- 
Groeten,

Joost Kraaijeveld
Askesis B.V.
Molukkenstraat 14
6524NB Nijmegen
tel: 024-3888063 / 06-51855277
fax: 024-3608416
web: www.askesis.nl


From titech at metaorb.com  Thu Sep 11 09:39:29 2008
From: titech at metaorb.com (titech at metaorb.com)
Date: Thu, 11 Sep 2008 09:39:29 -0700 (PDT)
Subject: [antlr-interest] C++ Support Status?
Message-ID: <789288.63354.qm@web82306.mail.mud.yahoo.com>

OK, let me take a look at the JUnit code and make sure I can grok it.
--Mike
Mike Allbright
DLP Products
Texas Instruments, Inc.
________________________________________
From: Jim Idle [mailto:jimi at temporal-wave.com] 
Sent: Wednesday, September 10, 2008 2:57 PM
To: titech at metaorb.com
Subject: Re: C++ Support Status?
On Wed, 2008-09-10 at 12:47 -0700, titech at metaorb.com wrote: 
Jim,

What?s the status on C++ support?
I have made a bit of a start, but for now, you still have to use the C output compiled as C++. I am currently working flat out for Sun on the JavaFX compiler, then going to a language developers with Ter, visiting Sun in SF and so there is no spare time really for a few weeks.
?
Need any 
volunteers?
I am looking for someone to write the equivalent of the junit tests for the C and C++ targets, that would be a great help. There is a Cunit and CppUnit, but anything in the same vein would be fine.

?
Regards,
--Mike
?
Mike 
Allbright
DLP 
Products
Texas Instruments, 
Inc.


From r_reitzi at cs.uni-kl.de  Thu Sep 11 10:06:21 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Thu, 11 Sep 2008 19:06:21 +0200
Subject: [antlr-interest] Implementing Java sourcecode formatters.	Where
	to start?
In-Reply-To: <3665a1a00809061539p23846aav19d1849f17960c7c@mail.gmail.com>
References: <3665a1a00809061539p23846aav19d1849f17960c7c@mail.gmail.com>
Message-ID: <20080911190621.34732j8oul430v0g@horde.verrech.net>

Hi Anatol!

I do not understand your motivation to standardize sources. If you are  
bold enough to allow different IDEs (company or open source?), you  
should be able to cope with heterogenous source in your repository.  
Everbody can hit his key combination to format sources once he opens  
them. No harm done.

If you insist, use an IDE independent source formatter instead of  
going through the process of learning how to use ANTLR.

OT: What do different IDEs different in code formatting? At least for  
Java, there are styleguides by SUN that should be somewhat mandatory  
in project contexts, I think.

Regards

Raphael

"Anatol Pomozov" <anatol.pomozov at gmail.com> wrote (Sun Sep  7 00:39:09 2008):

> Hi,
>
> I work in a big Java team that has heterogeneous software environment. I
> prefer to use IDEA for development, some other people Eclipse or Emacs. In
> our team we try to keep unified style for the source code. But unfortunately
> IDE's that we use have different options for code formatting and quite
> difficult to find such style that satisfies all IDE's. So a lot of code
> reformatting work I do by hands. And I feel that I do dumb work when I
> reorder imports/add blank lines between class member definitions etc... I
> want that some tool do it for me.
>
> That is why I wan to implement code formatting tool for Java/Javascript.
> Actually I tried to find such opensource tool and only I found is Jalopy
> which is not developed anymore (last release in 2005).
>
> I want to use ANTLR. Actually I am ANTLR newbie (although I know general
> theoretical part of lexers/parsers) and not sure that it is the best tool
> for implementing code transformers.
>
> So what I ask here is advise. Is it ok to use ANTLR for code formatters?
> Where to start? Do you have any good example for such kind of tasks? Any
> advice would be helpful.
>
> Thanks.
>
> --
> anatol
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080911/b9ddb8ff/attachment.bin 

From r_reitzi at cs.uni-kl.de  Thu Sep 11 10:22:05 2008
From: r_reitzi at cs.uni-kl.de (Raphael Reitzig)
Date: Thu, 11 Sep 2008 19:22:05 +0200
Subject: [antlr-interest] ST 4.0 planning
In-Reply-To: <E920971E-A7E3-4621-9F34-9425A1FD5AAF@martin-probst.com>
References: <8B507E38-66A0-4C2B-BE78-923832E8A278@cs.usfca.edu>
	<48C5C4A4.4010001@Yahoo.com> <000701c913d7$7144f210$53ced630$@com>
	<E920971E-A7E3-4621-9F34-9425A1FD5AAF@martin-probst.com>
Message-ID: <20080911192205.1585365uvz87v5c0@horde.verrech.net>

Hi!

Although this is offtopic, I want to comment on this:

Actually, one workgroup at my university has developed a construct  
(called Katja) to introduce immutable values to Java to get all the  
advantages, mainly to be able to work with terms. It's rather cool  
once you get used to it.

I experienced the functional paradigma to be a useful teacher. It  
taught me to code _without_ hacky global stuff. It taught me the power  
and elegance of recursion. It even taught me when to avoid recursion  
at all costs ;)

Regards

Raphael

"Martin Probst" <mail at martin-probst.com> wrote (Thu Sep 11 10:53:42 2008):

>>> Do I give a rat's ass if my text is generated in a functional
>>> language? At the time, I
>>> was trying to implement automatically generated sequence numbers
>>> for things
>>> like test cases and symbols. It was far more difficult than it
>>> needed to be
>
>
>> I especially like your observation about languages. The design of the
>> language should not get in the way of getting common stuff done
>> (Prolog, F#,
>> ERLANG, etc.), without giving even more back for the effort (as do C+
>> +,
>> Java, C#, etc.).
>
> The point of languages like Erlang or Prolog is that they make
> different design tradeoffs than languages like Java or C#, and this
> leads to very compelling features, like the robustness and
> restartability (eh, not a word...) of Erlang micro-processes. Building
> in some "convenience features", like mutable variables, would
> completely taint the language.
>
> About functional languages: programming in a functional style is
> something you need to get used to, and it takes time. However many
> people find that programs written in a pure functional language have
> significantly less bugs, among other advantages. And in particular
> transformation problems are very amenable to such stuff.
>
> Something like a global, mutable counter variable might be a nice
> quick hack to get something done, but it fails on a lot of other
> levels, e.g. modularity, ability to test, potentially thread safety,
> and so on.
>
> I'd really recommend you to give this stuff some more time, it is
> actually useful and a good idea.
>
> Regards,
> /Martin
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:  
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 191 bytes
Desc: PGP Digital Signature
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080911/d8e72c0b/attachment.bin 

From jlist9 at gmail.com  Thu Sep 11 10:56:18 2008
From: jlist9 at gmail.com (jlist)
Date: Thu, 11 Sep 2008 10:56:18 -0700
Subject: [antlr-interest] Need some help with error "Can't find/access AST
	Node"
Message-ID: <608832348.20080911105618@gmail.com>

Hi all,

We have an application that uses Antlr and it worked fine until
we upgraded from Java 1.4 to 1.6. I see this line in stdout log:

  Can't find/access AST Node type<our AST class name>

And this in the traceback:

  java.lang.ClassCastException: antlr.CommonAST cannot be cast to
  <our AST class name>

The Java code hasn't been changed recently. Has anyone seen this before?
Any help/hint is appreciated.

-- 
Best regards,
Jack


From parrt at cs.usfca.edu  Thu Sep 11 11:10:04 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 11 Sep 2008 11:10:04 -0700
Subject: [antlr-interest] StringTemplate test case: Capitalizing all
	words in text
In-Reply-To: <5591b9500809110912t601cb2e9sbeb04154ccaadfc@mail.gmail.com>
References: <5591b9500809110912t601cb2e9sbeb04154ccaadfc@mail.gmail.com>
Message-ID: <E114618D-5C9F-4285-9C70-DE5D2C232A07@cs.usfca.edu>


On Sep 11, 2008, at 9:12 AM, ???? ????????? wrote:

> Hello,
>
> In my test I am trying to create a grammar that should capitalize all
> words in text.
> Supposing text contains of english characters, punctuation marks and  
> numbers.
> Here is my grammar (with line numbers added):
>
> -------------------------------->8--- start of UpperAll.g
>
> 01: grammar UpperAll;
> 02: options {output=template; rewrite=true;}
> 03:
> 04: sent_en  :   ( en+=en_word PUNKT? INT? )+ //->
> template(words={$en}) "<words; separator=\" \">"
> 05:          ;
> 06:
> 07: en_word   :   ('A'..'Z' | 'a'..'z' )+ -> template(word={
> TestUpperAll.caps($en_word.text) }) "<word>"
> 08:           ;
> 09:
> 10: PUNKT     :   '.' | ',' | '!' | '?' | '(' | ')';
> 11: INT       :   '0'..'9'+ ;
> 12: NEWLINE  :   '\r'? '\n' ;
> 13: WS       :   (' '|'\t'|'\n'|'\r')+ {$channel = HIDDEN;} ;
>
> -------------------------------->8--- end of UpperAll.g
>
> When trying to generate, I am getting an error message:
>
> Check Grammar reported some errors:
> error(201):UpperAll.g:4:40: The following alternative can never be  
> matched: 2
>
> Here is console output:
>
> [10:40:53] warning(200): UpperAll.g:4:28: Decision can match input
> such as "PUNKT" using multiple alternatives: 1, 2

This makes no sense since en_word is not optional... oh, right. see  
next sentence.

note that you should not use .. range op in parser rules.  put EN_WORD  
in lexer.

The range of characters is somehow overlapping with parser tokens...   
Use En_word or something.
Ter


From parrt at cs.usfca.edu  Thu Sep 11 11:11:42 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 11 Sep 2008 11:11:42 -0700
Subject: [antlr-interest] ANTLR in Maven Central?
In-Reply-To: <87eb8aee0809100030i13d912aasb83d3db550fdd5b7@mail.gmail.com>
References: <87eb8aee0809100030i13d912aasb83d3db550fdd5b7@mail.gmail.com>
Message-ID: <ED0F90B0-C77B-4E11-9E66-572B371CF063@cs.usfca.edu>

I'd love for someone to upload them...i recall something like me  
needing an open http dir or something here i didn't like.
Ter
On Sep 10, 2008, at 12:30 AM, Alin Dreghiciu wrote:

> Hi guys,
>
> Is there any plan to have antlr 3.1 and string template 3.2 available
> from maven central repo?
> (http://repo1.maven.org/maven2/org/antlr)
>
> Thanx,
> -- 
> Alin Dreghiciu
> http://www.ops4j.org - New Energy for OSS Communities - Open
> Participation Software.
> http://www.qi4j.org - New Energy for Java - Domain Driven Development.
> http://malaysia.jayway.net - New Energy for Projects - Great People
> working on Great Projects at Great Places
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From parrt at cs.usfca.edu  Thu Sep 11 11:10:42 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 11 Sep 2008 11:10:42 -0700
Subject: [antlr-interest] Antlworks and StringTemplate /
	System.out.println?
In-Reply-To: <1221150547.30860.92.camel@panoramix.askesis.nl>
References: <1221150547.30860.92.camel@panoramix.askesis.nl>
Message-ID: <2A47FA05-E7E4-4229-898D-C105544151D8@cs.usfca.edu>

sure. see the output pane in debugger.
Ter
On Sep 11, 2008, at 9:29 AM, Joost Kraaijeveld wrote:

> Hi,
>
> I am in the process of learning Antlr and translating source. Is it
> possible to view the output of StringTemplates and/or rules with
> System.out.println in Antlrworks, or should I create my own  
> application
> with main to do so? If so, should I use the generated *token,
> *Lexer.java and *Parser.java files?
>
> TIA
>
> -- 
> Groeten,
>
> Joost Kraaijeveld
> Askesis B.V.
> Molukkenstraat 14
> 6524NB Nijmegen
> tel: 024-3888063 / 06-51855277
> fax: 024-3608416
> web: www.askesis.nl
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From enjoywm at cs.wm.edu  Thu Sep 11 18:17:41 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Thu, 11 Sep 2008 21:17:41 -0400
Subject: [antlr-interest] a confusing question
Message-ID: <48C9C335.1040206@cs.wm.edu>

Hi,
I am new to antlr. I use Cetus, which use antlr to prase. The .g file 
works well. I did some modifications to .g file and make Cetus, but I 
got some errors. So I copied the right .g to override the wrong one. 
However I still get error.
Hope your help.

Yixun

From enjoywm at cs.wm.edu  Thu Sep 11 18:32:11 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Thu, 11 Sep 2008 21:32:11 -0400
Subject: [antlr-interest] how to generate parser code from .g file?
Message-ID: <48C9C69B.2000104@cs.wm.edu>

Hi,
I want to generate parser code from .g file. How to do it?
Thanks!

From asoka250 at gmail.com  Thu Sep 11 18:34:58 2008
From: asoka250 at gmail.com (ASHOK REDDY)
Date: Thu, 11 Sep 2008 20:34:58 -0500
Subject: [antlr-interest] how to generate parser code from .g file?
In-Reply-To: <48C9C69B.2000104@cs.wm.edu>
References: <48C9C69B.2000104@cs.wm.edu>
Message-ID: <7b0a1e4b0809111834x54b107f8ud29e55662097343b@mail.gmail.com>

R u using Antlrworks?. Load the .g file into AntlrWorks and use the menu
option "Generate Code" to generate lexer and parser code from the .g file.

On Thu, Sep 11, 2008 at 8:32 PM, Yixun Liu <enjoywm at cs.wm.edu> wrote:

> Hi,
> I want to generate parser code from .g file. How to do it?
> Thanks!
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>


-- 
Regards,
Ashok R Varikuti
Graduate Research Assistant
CIS Dept, Kansas State University
785-304-2401
ashokv at ksu.edu
(http://www.cis.ksu.edu/~ashokv)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080911/7b4debe0/attachment.html 

From jbb at acm.org  Thu Sep 11 18:53:16 2008
From: jbb at acm.org (John B. Brodie)
Date: Thu, 11 Sep 2008 21:53:16 -0400
Subject: [antlr-interest] how to generate parser code from .g file?
In-Reply-To: <48C9C69B.2000104@cs.wm.edu>
References: <48C9C69B.2000104@cs.wm.edu>
Message-ID: <200809112153.16548.jbb@acm.org>

On Thursday 11 September 2008 09:32:11 pm Yixun Liu wrote:
> I want to generate parser code from .g file. How to do it?

at your favorite shell (batch) prompt enter:

java org.antlr.Tool your_grammar_filename_goes_here.g

Hope this helps
--
   -jbb


From enjoywm at cs.wm.edu  Thu Sep 11 19:33:07 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Thu, 11 Sep 2008 22:33:07 -0400
Subject: [antlr-interest] how to generate parser code from .g file?
In-Reply-To: <7b0a1e4b0809111834x54b107f8ud29e55662097343b@mail.gmail.com>
References: <48C9C69B.2000104@cs.wm.edu>
	<7b0a1e4b0809111834x54b107f8ud29e55662097343b@mail.gmail.com>
Message-ID: <48C9D4E3.8080402@cs.wm.edu>

Cetus use antlr to parser. I don't know how Cetus make antlr to generate 
the parser code. What I do is make Cetus and then I can get the parser code.
ASHOK REDDY wrote:
> R u using Antlrworks?. Load the .g file into AntlrWorks and use the 
> menu option "Generate Code" to generate lexer and parser code from the 
> .g file.
>
> On Thu, Sep 11, 2008 at 8:32 PM, Yixun Liu <enjoywm at cs.wm.edu 
> <mailto:enjoywm at cs.wm.edu>> wrote:
>
>     Hi,
>     I want to generate parser code from .g file. How to do it?
>     Thanks!
>
>     List: http://www.antlr.org/mailman/listinfo/antlr-interest
>     Unsubscribe:
>     http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
>
> -- 
> Regards,
> Ashok R Varikuti
> Graduate Research Assistant
> CIS Dept, Kansas State University
> 785-304-2401
> ashokv at ksu.edu <mailto:ashokv at ksu.edu>
> (http://www.cis.ksu.edu/~ashokv <http://www.cis.ksu.edu/%7Eashokv>)


From okrachin at purdue.edu  Thu Sep 11 20:48:42 2008
From: okrachin at purdue.edu (Olya Krachina)
Date: Thu, 11 Sep 2008 23:48:42 -0400
Subject: [antlr-interest] set max number of characters in a string literal
Message-ID: <1221191322.48c9e69a89199@webmail.purdue.edu>

Hello, 
I am working on a lexer and i was wondering how i could set a max limit on the
number of characters that make up a string literal, i.e. it is valid when there
are n (let's say n = 20) or less chars. I tried setting lookahead to 20 (options
k = 20) but it did not have any effect. I am using antlr 2.7. 

thanks in advance for any ideas on this,
Olya



From asoka250 at gmail.com  Thu Sep 11 21:29:51 2008
From: asoka250 at gmail.com (ASHOK REDDY)
Date: Thu, 11 Sep 2008 23:29:51 -0500
Subject: [antlr-interest] how to generate parser code from .g file?
In-Reply-To: <48C9D4E3.8080402@cs.wm.edu>
References: <48C9C69B.2000104@cs.wm.edu>
	<7b0a1e4b0809111834x54b107f8ud29e55662097343b@mail.gmail.com>
	<48C9D4E3.8080402@cs.wm.edu>
Message-ID: <7b0a1e4b0809112129g50fa49derf97fdc719c75a9a5@mail.gmail.com>

look into some examples of Antlr. You can get a bunch at www.antlr.org. I
have no idea about Cetus whatsoever.

On Thu, Sep 11, 2008 at 9:33 PM, Yixun Liu <enjoywm at cs.wm.edu> wrote:

> Cetus use antlr to parser. I don't know how Cetus make antlr to generate
> the parser code. What I do is make Cetus and then I can get the parser code.
> ASHOK REDDY wrote:
>
>> R u using Antlrworks?. Load the .g file into AntlrWorks and use the menu
>> option "Generate Code" to generate lexer and parser code from the .g file.
>>
>> On Thu, Sep 11, 2008 at 8:32 PM, Yixun Liu <enjoywm at cs.wm.edu <mailto:
>> enjoywm at cs.wm.edu>> wrote:
>>
>>    Hi,
>>    I want to generate parser code from .g file. How to do it?
>>    Thanks!
>>
>>    List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>    Unsubscribe:
>>
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>>
>>
>> --
>> Regards,
>> Ashok R Varikuti
>> Graduate Research Assistant
>> CIS Dept, Kansas State University
>> 785-304-2401
>> ashokv at ksu.edu <mailto:ashokv at ksu.edu>
>> (http://www.cis.ksu.edu/~ashokv <http://www.cis.ksu.edu/%7Eashokv> <
>> http://www.cis.ksu.edu/%7Eashokv>)
>>
>
>


-- 
Regards,
Ashok R Varikuti
Graduate Research Assistant
CIS Dept, Kansas State University
785-304-2401
ashokv at ksu.edu
(http://www.cis.ksu.edu/~ashokv)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080911/d9eb7ed5/attachment.html 

From fabian20ro at gmail.com  Fri Sep 12 00:39:38 2008
From: fabian20ro at gmail.com (Fabian Baboschi)
Date: Fri, 12 Sep 2008 10:39:38 +0300
Subject: [antlr-interest] Beginner grammar question
Message-ID: <2d7a38db0809120039pdca1f47nf81e028ef3b40b22@mail.gmail.com>

Hi,
I have a question about the following grammar:

grammar test;

list     :    (element)+
    ;

element    :   BAR NAME
    ;

BAR    :     'bar'
    ;

NAME
    :     ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
    ;

WS
    :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
    ;

I tried to use the following input: bar bar
and I get errors because the parser doesn't recognize that the second bar
should be treated as a name.
I tried to change the grammar or options but without success. What am I
missing?

If it matters I'm using antlrworks-1.2 and antlr-3.1.

Thank you,
Fabian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/4ef59227/attachment.html 

From mikael.petterson at ericsson.com  Fri Sep 12 02:09:55 2008
From: mikael.petterson at ericsson.com (Mikael Petterson)
Date: Fri, 12 Sep 2008 11:09:55 +0200
Subject: [antlr-interest] IOException when Debugging Expr.g example
Message-ID: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9901782EBB@esealmw104.eemea.ericsson.se>

I follow the instruction on:

http://www.antlr.org/works/help/tutorial/calculator.html

- Interpreter part works ok!

When I get to the debugging part I get the following problem after I
have input the following text:

I select Debug and get the message ' generating ....' and then I see
this and get the following in the console:

java.io.IOException: CreateProcess: javac -classpath
C:\Users\eraonel\opensource\TestPoject\src\se\petterson\test\antlr\parse
r\classes;C:\Users\eraonel\opensource\net.sourceforge.clearcase\3rdparty
\antlr\antlrworks-1.1.7.jar;antlrwor
terson\test\antlr\parser\classes
C:\Users\eraonel\opensource\TestPoject\src\se\petterson\test\antlr\parse
r\__Test__.java error=2

Any ideas?

Cheers,

//mike
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/4d862604/attachment.html 

From mattpalms at gmail.com  Fri Sep 12 02:37:06 2008
From: mattpalms at gmail.com (Matt Palmer)
Date: Fri, 12 Sep 2008 10:37:06 +0100
Subject: [antlr-interest] Beginner grammar question
In-Reply-To: <2d7a38db0809120039pdca1f47nf81e028ef3b40b22@mail.gmail.com>
References: <2d7a38db0809120039pdca1f47nf81e028ef3b40b22@mail.gmail.com>
Message-ID: <36c8729e0809120237v777c7efy3f7c9299af4e358f@mail.gmail.com>

Hi Fabian,

this is a classic problem - it's specifically mentioned in the ANTLR
reference book.   There's more than one way of solving it, but where you
have keywords that are the same as IDs, you can use predicates to do it.
Basically, make bar a NAME too, but put a predicate before it to see if it's
"bar".  Then the lexer will just recognise NAME tokens, but the parser can
switch to a bar rule if necessary:

grammar test;

list     :    (element)+
    ;

element  :   bar NAME
    ;

bar      :   {input.LT(1).getText().equals("bar")}? NAME
    ;

BAR      :   'bar'
    ;

NAME
    :     ('a'..'z' | 'A'..'Z')
          ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')*
    ;

WS
    :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
    ;

Matt

On Fri, Sep 12, 2008 at 8:39 AM, Fabian Baboschi <fabian20ro at gmail.com>wrote:

> Hi,
> I have a question about the following grammar:
>
> grammar test;
>
> list     :    (element)+
>     ;
>
> element    :   BAR NAME
>     ;
>
> BAR    :     'bar'
>     ;
>
> NAME
>     :     ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
>     ;
>
> WS
>     :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
>     ;
>
> I tried to use the following input: bar bar
> and I get errors because the parser doesn't recognize that the second bar
> should be treated as a name.
> I tried to change the grammar or options but without success. What am I
> missing?
>
> If it matters I'm using antlrworks-1.2 and antlr-3.1.
>
> Thank you,
> Fabian
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/85742e0f/attachment.html 

From mattpalms at gmail.com  Fri Sep 12 02:38:06 2008
From: mattpalms at gmail.com (Matt Palmer)
Date: Fri, 12 Sep 2008 10:38:06 +0100
Subject: [antlr-interest] Beginner grammar question
In-Reply-To: <36c8729e0809120237v777c7efy3f7c9299af4e358f@mail.gmail.com>
References: <2d7a38db0809120039pdca1f47nf81e028ef3b40b22@mail.gmail.com>
	<36c8729e0809120237v777c7efy3f7c9299af4e358f@mail.gmail.com>
Message-ID: <36c8729e0809120238s5401d234o406acda2e2d0d0ec@mail.gmail.com>

Ooops - get rid of the BAR token too, as it's not needed.

grammar test;

list     :    (element)+
    ;

element  :   bar NAME
    ;

bar      :   {input.LT(1).getText().equals("bar")}? NAME
    ;

NAME
    :     ('a'..'z' | 'A'..'Z')
          ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')*
    ;

WS
    :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
    ;


On Fri, Sep 12, 2008 at 10:37 AM, Matt Palmer <mattpalms at gmail.com> wrote:

> Hi Fabian,
>
> this is a classic problem - it's specifically mentioned in the ANTLR
> reference book.   There's more than one way of solving it, but where you
> have keywords that are the same as IDs, you can use predicates to do it.
> Basically, make bar a NAME too, but put a predicate before it to see if it's
> "bar".  Then the lexer will just recognise NAME tokens, but the parser can
> switch to a bar rule if necessary:
>
> grammar test;
>
> list     :    (element)+
>     ;
>
> element  :   bar NAME
>     ;
>
> bar      :   {input.LT(1).getText().equals("bar")}? NAME
>     ;
>
> BAR      :   'bar'
>     ;
>
> NAME
>     :     ('a'..'z' | 'A'..'Z')
>           ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')*
>     ;
>
> WS
>     :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
>     ;
>
> Matt
>
> On Fri, Sep 12, 2008 at 8:39 AM, Fabian Baboschi <fabian20ro at gmail.com>wrote:
>
>> Hi,
>> I have a question about the following grammar:
>>
>> grammar test;
>>
>> list     :    (element)+
>>     ;
>>
>> element    :   BAR NAME
>>     ;
>>
>> BAR    :     'bar'
>>     ;
>>
>> NAME
>>     :     ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
>>     ;
>>
>> WS
>>     :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
>>     ;
>>
>> I tried to use the following input: bar bar
>> and I get errors because the parser doesn't recognize that the second bar
>> should be treated as a name.
>> I tried to change the grammar or options but without success. What am I
>> missing?
>>
>> If it matters I'm using antlrworks-1.2 and antlr-3.1.
>>
>> Thank you,
>> Fabian
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/568dd5de/attachment.html 

From dave.pawson at gmail.com  Fri Sep 12 02:46:25 2008
From: dave.pawson at gmail.com (Dave Pawson)
Date: Fri, 12 Sep 2008 10:46:25 +0100
Subject: [antlr-interest] Lists. Lexer or Parser?
Message-ID: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>

Trying to get my head round antlr. 3.1

Processing a simple text file through to XML, looking at lists.

* kdkdkdkdk
* ldldldldld

Using the Lexer is easy enough to get into a list element markup,
is it possible to use the lexer to wrap all the list elements
in a list tag?

I.e. how to create

<list>
<item>kdkdkdk</item>
<item>ldldldl</item>
</list>


or is that a job for the Parser or AST?

TIA

-- 
Dave Pawson
XSLT XSL-FO FAQ.
Docbook FAQ.
http://www.dpawson.co.uk

From antlr at mirality.co.nz  Fri Sep 12 05:00:31 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 13 Sep 2008 00:00:31 +1200
Subject: [antlr-interest] set max number of characters in a string
 literal
In-Reply-To: <1221191322.48c9e69a89199@webmail.purdue.edu>
References: <1221191322.48c9e69a89199@webmail.purdue.edu>
Message-ID: <20080912120043.A0E4A11EC8C@www.antlr.org>

At 15:48 12/09/2008, Olya Krachina wrote:
 >I am working on a lexer and i was wondering how i could set a 
max
 >limit on the number of characters that make up a string literal, 

 >i.e. it is valid when there are n (let's say n = 20) or less 
chars.
 >I tried setting lookahead to 20 (options k = 20) but it did not
 >have any effect. I am using antlr 2.7.

If you need to parse exactly 20 chars and stop dead (eg. for 
fixed-width data formats), you'll need to spell it out explicitly 
-- eg. repeat CHAR 20 times.  (ANTLR only supports cardinalities 
for zero, one, or many.)

Of course you can be a bit more clever about it, eg. making a rule 
that contains five CHARs and then use that rule four times, etc.


If your input language isn't actually ambiguous, though, and you 
just want to do this for validation purposes, then your best bet 
is to just successfully match however many characters happen to 
appear (even if more than 20), and use a semantic action in the 
parser or tree parser to validate the length after the fact.

Generally speaking the lexer should be built to be as tolerant as 
it possibly can -- wait until parsing time to detect and report 
errors.


From antlr at mirality.co.nz  Fri Sep 12 05:04:40 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 13 Sep 2008 00:04:40 +1200
Subject: [antlr-interest] Beginner grammar question
In-Reply-To: <2d7a38db0809120039pdca1f47nf81e028ef3b40b22@mail.gmail.com
 >
References: <2d7a38db0809120039pdca1f47nf81e028ef3b40b22@mail.gmail.com>
Message-ID: <20080912120449.EB8D611ECE2@www.antlr.org>

At 19:39 12/09/2008, Fabian Baboschi wrote:
>element    :   BAR NAME
>     ;
>
>BAR    :     'bar'
>     ;
>
>NAME
>     :     ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
>     ;
[...]
>I tried to use the following input: bar bar
>and I get errors because the parser doesn't recognize that the 
>second bar should be treated as a name.

The other common solution to this (the first being what Matt just 
suggested) is to leave your BAR rule in place but change element 
like so:

element : BAR name ;
name : NAME | BAR ;


The key point to realise in all of this is that lexing happens 
first, without any parser context.  So given a choice between an 
exact-match keyword and a vague-match identifier rule, the keyword 
will win.


From antlr at mirality.co.nz  Fri Sep 12 05:08:04 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 13 Sep 2008 00:08:04 +1200
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com
 >
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
Message-ID: <20080912120812.8D7A611ECE2@www.antlr.org>

At 21:46 12/09/2008, Dave Pawson wrote:
 >* kdkdkdkdk
 >* ldldldldld
 >
 >Using the Lexer is easy enough to get into a list element 
markup,
 >is it possible to use the lexer to wrap all the list elements
 >in a list tag?
 >
 >I.e. how to create
 >
 ><list>
 ><item>kdkdkdk</item>
 ><item>ldldldl</item>
 ></list>
 >
 >
 >or is that a job for the Parser or AST?

Generating output is usually the responsibility of the parser or 
tree parser, yes.  But if your input language is simple enough 
then there's no particular reason why you *couldn't* do all the 
work in the lexer, if you wanted to.

(Of course, if your input language is simple enough for that to be 
a viable option, there's a good chance that it's simple enough 
that using ANTLR or any other parser generator is just overkill.)


From adreghiciu at gmail.com  Fri Sep 12 05:29:50 2008
From: adreghiciu at gmail.com (Alin Dreghiciu)
Date: Fri, 12 Sep 2008 15:29:50 +0300
Subject: [antlr-interest] ANTLR in Maven Central?
In-Reply-To: <ED0F90B0-C77B-4E11-9E66-572B371CF063@cs.usfca.edu>
References: <87eb8aee0809100030i13d912aasb83d3db550fdd5b7@mail.gmail.com>
	<ED0F90B0-C77B-4E11-9E66-572B371CF063@cs.usfca.edu>
Message-ID: <87eb8aee0809120529q4884d390y1ae8af8df0046662@mail.gmail.com>

Here are some rules about that:
http://maven.apache.org/guides/mini/guide-central-repository-upload.html

Alin

On Thu, Sep 11, 2008 at 9:11 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> I'd love for someone to upload them...i recall something like me needing an
> open http dir or something here i didn't like.
> Ter
> On Sep 10, 2008, at 12:30 AM, Alin Dreghiciu wrote:
>
>> Hi guys,
>>
>> Is there any plan to have antlr 3.1 and string template 3.2 available
>> from maven central repo?
>> (http://repo1.maven.org/maven2/org/antlr)
>>
>> Thanx,
>> --
>> Alin Dreghiciu
>> http://www.ops4j.org - New Energy for OSS Communities - Open
>> Participation Software.
>> http://www.qi4j.org - New Energy for Java - Domain Driven Development.
>> http://malaysia.jayway.net - New Energy for Projects - Great People
>> working on Great Projects at Great Places
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>



-- 
Alin Dreghiciu
http://www.ops4j.org - New Energy for OSS Communities - Open
Participation Software.
http://www.qi4j.org - New Energy for Java - Domain Driven Development.
http://malaysia.jayway.net - New Energy for Projects - Great People
working on Great Projects at Great Places

From dave.pawson at gmail.com  Fri Sep 12 06:58:32 2008
From: dave.pawson at gmail.com (Dave Pawson)
Date: Fri, 12 Sep 2008 14:58:32 +0100
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
Message-ID: <711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>

2008/9/12 Gavin Lambert <antlr at mirality.co.nz>:

>>I.e. how to create
>>
>><list>
>><item>kdkdkdk</item>
>><item>ldldldl</item>
>></list>
>>
>>
>>or is that a job for the Parser or AST?
>
> Generating output is usually the responsibility of the parser or tree
> parser, yes.  But if your input language is simple enough then there's no
> particular reason why you *couldn't* do all the work in the lexer, if you
> wanted to.
>
> (Of course, if your input language is simple enough for that to be a viable
> option, there's a good chance that it's simple enough that using ANTLR or
> any other parser generator is just overkill.)


Oh it is :-) I currently do the job with Python.
But I needed something real to learn on.

Obvious next question, how to do it in the Parser please?

I'm not that far in the Antlr book - seems like I do need a tree
with a non-existant node to hang the list item children from.

regards



-- 
Dave Pawson
XSLT XSL-FO FAQ.
Docbook FAQ.
http://www.dpawson.co.uk

From jimi at temporal-wave.com  Fri Sep 12 06:59:12 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 12 Sep 2008 06:59:12 -0700
Subject: [antlr-interest] IOException when Debugging Expr.g example
In-Reply-To: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9901782EBB@esealmw104.eemea.ericsson.se>
References: <8E9F9F4EE1FBD34FBEDD7EC2360AFD9901782EBB@esealmw104.eemea.ericsson.se>
Message-ID: <1221227952.4006.11.camel@jimi.temporal-wave.com>

On Fri, 2008-09-12 at 11:09 +0200, Mikael Petterson wrote:

> I follow the instruction on:
> 
> http://www.antlr.org/works/help/tutorial/calculator.html
> 
> - Interpreter part works ok!
> 
> When I get to the debugging part I get the following problem after I
> have input the following text:
> 
> I select Debug and get the message ' generating ....' and then I see
> this and get the following in the console:
> 
> java.io.IOException: CreateProcess: javac -classpath C:\Users\eraonel
> \opensource\TestPoject\src\se\petterson\test\antlr\parser\classes;C:
> \Users\eraonel\opensource\net.sourceforge.clearcase\3rdparty\antlr
> \antlrworks-1.1.7.jar;antlrwor
> 
> terson\test\antlr\parser\classes C:\Users\eraonel\opensource
> \TestPoject\src\se\petterson\test\antlr\parser\__Test__.java error=2
> 
> Any ideas?


This usually means you don't have permissions for something or the
directory does not exist. I see that it says TestPoject, maybe that
shoudl be TestProject?

Jim

> 
> Cheers,
> 
> //mike
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/1e285bfc/attachment.html 

From Waverly.Edwards at genesys.com  Fri Sep 12 07:42:57 2008
From: Waverly.Edwards at genesys.com (Edwards, Waverly)
Date: Fri, 12 Sep 2008 10:42:57 -0400
Subject: [antlr-interest] set max number of characters in a string
	literal
In-Reply-To: <20080912120043.A0E4A11EC8C@www.antlr.org>
References: <1221191322.48c9e69a89199@webmail.purdue.edu>
	<20080912120043.A0E4A11EC8C@www.antlr.org>
Message-ID: <FF993752CB890B4EB591BE5450C37BF101462A4C@navamane001.ad.internal.corp>

Untested but should work, assuming you want something that works after
the fact.



W.

SOME_STRING   : YourStringRule
    {
        String wholeStr;
        int strLen, maxStrLen = 20;

        wholeStr = getText().toString();
        strLen = wholeStr.length;
         if ( strLen > maxStrLen ) {
            System.out.println( strLen + " > " + maxStrLen + ".
Truncating...");
            setText(wholeStr.substring(maxStrLen)); // text is now
truncated
         }
    }; 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Gavin Lambert
Sent: Friday, September 12, 2008 8:01 AM
To: Olya Krachina; antlr-interest at antlr.org
Subject: Re: [antlr-interest] set max number of characters in a string
literal

At 15:48 12/09/2008, Olya Krachina wrote:
 >I am working on a lexer and i was wondering how i could set a 
max
 >limit on the number of characters that make up a string literal, 

 >i.e. it is valid when there are n (let's say n = 20) or less 
chars.
 >I tried setting lookahead to 20 (options k = 20) but it did not
 >have any effect. I am using antlr 2.7.

If you need to parse exactly 20 chars and stop dead (eg. for 
fixed-width data formats), you'll need to spell it out explicitly 
-- eg. repeat CHAR 20 times.  (ANTLR only supports cardinalities 
for zero, one, or many.)

Of course you can be a bit more clever about it, eg. making a rule 
that contains five CHARs and then use that rule four times, etc.


If your input language isn't actually ambiguous, though, and you 
just want to do this for validation purposes, then your best bet 
is to just successfully match however many characters happen to 
appear (even if more than 20), and use a semantic action in the 
parser or tree parser to validate the length after the fact.

Generally speaking the lexer should be built to be as tolerant as 
it possibly can -- wait until parsing time to detect and report 
errors.


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
ess


From gune.harshada at gmail.com  Fri Sep 12 09:48:41 2008
From: gune.harshada at gmail.com (harshada gune)
Date: Fri, 12 Sep 2008 22:18:41 +0530
Subject: [antlr-interest] how to exit when first parser error occurs
Message-ID: <996c7a8a0809120948j59485aefh57b1bda006b473bf@mail.gmail.com>

I got this answer for lexer error, but how to exit on parser error?

Thanks and regards,
Harshada.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/43493b84/attachment.html 

From sharwell at pixelminegames.com  Fri Sep 12 10:38:11 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Fri, 12 Sep 2008 12:38:11 -0500
Subject: [antlr-interest] how to exit when first parser error occurs
In-Reply-To: <996c7a8a0809120948j59485aefh57b1bda006b473bf@mail.gmail.com>
References: <996c7a8a0809120948j59485aefh57b1bda006b473bf@mail.gmail.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E351@Bloodymary.ironwillgames.com>

I use a ReportError override to handle "flood" messages generated by
some malformed files:

 

public override void ReportError( RecognitionException e )

{

    errorCount++;

    if ( canCancelOperation && errorCount >= maxErrors )

        throw new OperationCanceledException();

    base.ReportError( e );

}

 

Then I catch the OperationCanceledException in the function that
launches the parser and deal with it appropriately.

 

Sam

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of harshada gune
Sent: Friday, September 12, 2008 11:49 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] how to exit when first parser error occurs

 

I got this answer for lexer error, but how to exit on parser error?

Thanks and regards,
Harshada.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/11a19c16/attachment.html 

From enjoywm at cs.wm.edu  Fri Sep 12 11:16:02 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Fri, 12 Sep 2008 14:16:02 -0400
Subject: [antlr-interest] include file
Message-ID: <48CAB1E2.9090003@cs.wm.edu>

Hi,
In my source code I need to include a header file which cannot pass antlr.
#include <filename.h>
I want to make antlr be silent to this include file. How to do it?

Thanks.

Yixun

From jlist9 at gmail.com  Fri Sep 12 11:18:42 2008
From: jlist9 at gmail.com (jlist)
Date: Fri, 12 Sep 2008 11:18:42 -0700
Subject: [antlr-interest] Need some help with error "Can't find/access AST
	Node"
In-Reply-To: <608832348.20080911105618@gmail.com>
References: <608832348.20080911105618@gmail.com>
Message-ID: <276738831.20080912111842@gmail.com>

I'm still hopelessly stuck and have no clue why this is happening.
I've seen a similar error in my searches, which was related
to antlr jar version mismatch but in our case, we only have
this one version of antlr jar. Is there anything else I
should be checking? Any help is appreciated.

===8<==============Original message text===============
Hi all,

We have an application that uses Antlr and it worked fine until
we upgraded from Java 1.4 to 1.6. I see this line in stdout log:

  Can't find/access AST Node type<our AST class name>

And this in the traceback:

  java.lang.ClassCastException: antlr.CommonAST cannot be cast to
  <our AST class name>

The Java code hasn't been changed recently. Has anyone seen this before?
Any help/hint is appreciated.



From jimi at temporal-wave.com  Fri Sep 12 11:28:00 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 12 Sep 2008 11:28:00 -0700
Subject: [antlr-interest] include file
In-Reply-To: <48CAB1E2.9090003@cs.wm.edu>
References: <48CAB1E2.9090003@cs.wm.edu>
Message-ID: <1221244080.4006.44.camel@jimi.temporal-wave.com>

On Fri, 2008-09-12 at 14:16 -0400, Yixun Liu wrote:

> Hi,
> In my source code I need to include a header file which cannot pass antlr.
> #include <filename.h>
> I want to make antlr be silent to this include file. How to do it?



Follow the example projects and don't try to include that file in the
ANTLR generated code. You have an include file for your project files
that includes the generated  YourProjectParser.h and then your project
specific includes. Other than that, consult the C API documentation
about the @sections

Jim



> 
> Thanks.
> 
> Yixun
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/efb742f5/attachment.html 

From enjoywm at cs.wm.edu  Fri Sep 12 11:34:31 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Fri, 12 Sep 2008 14:34:31 -0400
Subject: [antlr-interest] include file
In-Reply-To: <1221244080.4006.44.camel@jimi.temporal-wave.com>
References: <48CAB1E2.9090003@cs.wm.edu>
	<1221244080.4006.44.camel@jimi.temporal-wave.com>
Message-ID: <48CAB637.6040608@cs.wm.edu>

I am new to antlr. Could you give me an simple example or describe it in 
more details?
Thanks!
Jim Idle wrote:
> On Fri, 2008-09-12 at 14:16 -0400, Yixun Liu wrote:
>> Hi,
>> In my source code I need to include a header file which cannot pass antlr.
>> #include <filename.h>
>> I want to make antlr be silent to this include file. How to do it?
>>     
>
>
> Follow the example projects and don't try to include that file in the 
> ANTLR generated code. You have an include file for your project files 
> that includes the generated  YourProjectParser.h and then your project 
> specific includes. Other than that, consult the C API documentation 
> about the @sections
>
> Jim
>
>
>> Thanks.
>>
>> Yixun
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>     


From jimi at temporal-wave.com  Fri Sep 12 11:46:02 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 12 Sep 2008 11:46:02 -0700
Subject: [antlr-interest] include file
In-Reply-To: <48CAB637.6040608@cs.wm.edu>
References: <48CAB1E2.9090003@cs.wm.edu>
	<1221244080.4006.44.camel@jimi.temporal-wave.com>
	<48CAB637.6040608@cs.wm.edu>
Message-ID: <1221245162.4006.49.camel@jimi.temporal-wave.com>

On Fri, 2008-09-12 at 14:34 -0400, Yixun Liu wrote:

> I am new to antlr. Could you give me an simple example or describe it in 
> more details?

First, read:

http://www.antlr.org/wiki/display/ANTLR3/Five+minute+introduction+to
+ANTLR+3

Then download the C target examples from the ANTLR download page. Then
read:

http://www.antlr.org/api/C/index.html

Jim



> Thanks!
> Jim Idle wrote:
> > On Fri, 2008-09-12 at 14:16 -0400, Yixun Liu wrote:
> >> Hi,
> >> In my source code I need to include a header file which cannot pass antlr.
> >> #include <filename.h>
> >> I want to make antlr be silent to this include file. How to do it?
> >>     
> >
> >
> > Follow the example projects and don't try to include that file in the 
> > ANTLR generated code. You have an include file for your project files 
> > that includes the generated  YourProjectParser.h and then your project 
> > specific includes. Other than that, consult the C API documentation 
> > about the @sections
> >
> > Jim
> >
> >
> >> Thanks.
> >>
> >> Yixun
> >>
> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >>
> >>     
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080912/b03c94ef/attachment.html 

From antlrinterest at gmail.com  Fri Sep 12 11:46:29 2008
From: antlrinterest at gmail.com (Bill Mayfield)
Date: Fri, 12 Sep 2008 20:46:29 +0200
Subject: [antlr-interest] set max number of characters in a string
	literal
In-Reply-To: <1221191322.48c9e69a89199@webmail.purdue.edu>
References: <1221191322.48c9e69a89199@webmail.purdue.edu>
Message-ID: <344d61080809121146s1125e7a9g819e51d23da6d15f@mail.gmail.com>

Maybe not of interest to you, since you're using antlr 2.7. There is a
similar example of your problem in the ANTLR 3.0 book.

You can solve your problem using a validating predicate:

data: ( c+=CHARACTER)+  {$c.size()<=4}? ;


I know there is no concept of the += in antlr 2.x but maybe you can
adapt the example to work with 2.7 also...


Good luck!

Bill



On Fri, Sep 12, 2008 at 5:48 AM, Olya Krachina <okrachin at purdue.edu> wrote:
> Hello,
> I am working on a lexer and i was wondering how i could set a max limit on the
> number of characters that make up a string literal, i.e. it is valid when there
> are n (let's say n = 20) or less chars. I tried setting lookahead to 20 (options
> k = 20) but it did not have any effect. I am using antlr 2.7.
>
> thanks in advance for any ideas on this,
> Olya
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From gerald at certiv.net  Fri Sep 12 12:38:05 2008
From: gerald at certiv.net (Gerald Rosenberg)
Date: Fri, 12 Sep 2008 12:38:05 -0700
Subject: [antlr-interest] Antlr/Eclipse warnings fix
Message-ID: <200809121938.m8CJbuHO017728@zinc.newtechlaw.com>

Not sure if those using Eclipse/Java 5+ have realized that you can add

@SuppressWarnings("all")

as the last line in your

@parser::header and @lexer::header blocks to suppress the Generics 
warnings that abound otherwise harmlessly in the Antlr generated code.


From antlr at mirality.co.nz  Sat Sep 13 02:24:48 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 13 Sep 2008 21:24:48 +1200
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.co
 m>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>
Message-ID: <20080913092456.AE21311EDDA@www.antlr.org>

At 01:58 13/09/2008, Dave Pawson wrote:
 >Obvious next question, how to do it in the Parser please?

Just output whatever you want.  Like so:

list : { Console.writeLine("<list>"); } item* { 
Console.writeLine("</list>"); } ;
item : TEXT { Console.writeLine("<item>", $TEXT.text, "</item>"); 
} ;

 >I'm not that far in the Antlr book - seems like I do need a tree
 >with a non-existant node to hang the list item children from.

Maybe you should read more of the book :)

And you can do it like that if you want to (eg. if you want to 
generate an AST you can manipulate or generate multiple kinds of 
output from), but if your needs are simple then you might as well 
just do the output directly in the parser.


From dave.pawson at gmail.com  Sat Sep 13 03:06:30 2008
From: dave.pawson at gmail.com (Dave Pawson)
Date: Sat, 13 Sep 2008 11:06:30 +0100
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>
	<48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>
Message-ID: <711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>

2008/9/13 Gavin Lambert <antlr at mirality.co.nz>:
> At 01:58 13/09/2008, Dave Pawson wrote:
>>Obvious next question, how to do it in the Parser please?
>
> Just output whatever you want.  Like so:
>
> list : { Console.writeLine("<list>"); } item* {
> Console.writeLine("</list>"); } ;
> item : TEXT { Console.writeLine("<item>", $TEXT.text, "</item>"); } ;

That's the problem? There is no textual content for the lexer to
trigger on for 'list'?
I can define 'item', but not list?

The input is

blah
blah

*list item 1
* list content 2

etc.

>
>>I'm not that far in the Antlr book - seems like I do need a tree
>>with a non-existant node to hang the list item children from.
>
> Maybe you should read more of the book :)

I will, though it is discouraging that its content is 3.0 based.

>
> And you can do it like that if you want to (eg. if you want to generate an
> AST you can manipulate or generate multiple kinds of output from), but if
> your needs are simple then you might as well just do the output directly in
> the parser.


As I said, this is just me learning by example as I go.

regards



-- 
Dave Pawson
XSLT XSL-FO FAQ.
Docbook FAQ.
http://www.dpawson.co.uk

From jaluber at gmx.de  Sat Sep 13 03:34:24 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 13 Sep 2008 12:34:24 +0200
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>	<48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>
	<711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>
Message-ID: <48CB9730.80300@gmx.de>

Dave Pawson schrieb:
> 2008/9/13 Gavin Lambert <antlr at mirality.co.nz>:
>> At 01:58 13/09/2008, Dave Pawson wrote:
>>> Obvious next question, how to do it in the Parser please?
>> Just output whatever you want.  Like so:
>>
>> list : { Console.writeLine("<list>"); } item* {
>> Console.writeLine("</list>"); } ;
>> item : TEXT { Console.writeLine("<item>", $TEXT.text, "</item>"); } ;
> 
> That's the problem? There is no textual content for the lexer to
> trigger on for 'list'?
> I can define 'item', but not list?
> 
> The input is
> 
> blah
> blah
> 
> *list item 1
> * list content 2

There is one. I'd define a grammar like:

grammar Test;

tokens {
LIST='LIST';
STAR=''*';
}

CONTENT: ('a'..'z' | 'A'..'Z')+;
NEWLINE: '\r' | '\n';
WHITESPACE: ('\t' | ' ')+ {$channel = HIDDEN;};

start: line*;

line: content+ NEWLINE+
    | STAR LIST content+ NEWLINE+
    ;
> 
> etc.
> 
>>> I'm not that far in the Antlr book - seems like I do need a tree
>>> with a non-existant node to hang the list item children from.
>> Maybe you should read more of the book :)
> 
> I will, though it is discouraging that its content is 3.0 based.

3.1 has not many differences to 3.0, which are backwards-incompatible.
Look into the release notes for a list.

Johannes
> 
>> And you can do it like that if you want to (eg. if you want to generate an
>> AST you can manipulate or generate multiple kinds of output from), but if
>> your needs are simple then you might as well just do the output directly in
>> the parser.
> 
> 
> As I said, this is just me learning by example as I go.
> 
> regards
> 
> 
> 


From dave.pawson at gmail.com  Sat Sep 13 05:35:16 2008
From: dave.pawson at gmail.com (Dave Pawson)
Date: Sat, 13 Sep 2008 13:35:16 +0100
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <48CB9730.80300@gmx.de>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>
	<48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>
	<711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>
	<48CB9730.80300@gmx.de>
Message-ID: <711a73df0809130535t56759d06gf22133deb6324a9a@mail.gmail.com>

2008/9/13 Johannes Luber <jaluber at gmx.de>:
> Dave Pawson schrieb:

>> The input is
>>
>> blah
>> blah
>>
>> *list item 1
>> * list content 2
>
> There is one. I'd define a grammar like:
>
> grammar Test;
>
> tokens {
> LIST='LIST';
> STAR=''*';
> }
>
> CONTENT: ('a'..'z' | 'A'..'Z')+;
> NEWLINE: '\r' | '\n';
> WHITESPACE: ('\t' | ' ')+ {$channel = HIDDEN;};
>
> start: line*;
>
> line: content+ NEWLINE+
>    | STAR LIST content+ NEWLINE+
>    ;


That requires the string 'LIST' on each list element?
My input is line based plain text.

A list starts from the first occurrence of
*  Any string content to end of line

and ends on the last
* Any string content up to end of line.


I guess I can leave this one till I've read more about navigating trees.

regards


-- 
Dave Pawson
XSLT XSL-FO FAQ.
Docbook FAQ.
http://www.dpawson.co.uk

From jaluber at gmx.de  Sat Sep 13 05:44:18 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sat, 13 Sep 2008 14:44:18 +0200
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <711a73df0809130535t56759d06gf22133deb6324a9a@mail.gmail.com>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>	
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>	
	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>	
	<48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>	
	<711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>	
	<48CB9730.80300@gmx.de>
	<711a73df0809130535t56759d06gf22133deb6324a9a@mail.gmail.com>
Message-ID: <48CBB5A2.6090401@gmx.de>

Dave Pawson schrieb:
> 2008/9/13 Johannes Luber <jaluber at gmx.de>:
>> Dave Pawson schrieb:
> 
>>> The input is
>>>
>>> blah
>>> blah
>>>
>>> *list item 1
>>> * list content 2
>> There is one. I'd define a grammar like:
>>
>> grammar Test;
>>
>> tokens {
>> LIST='LIST';
>> STAR=''*';
>> }
>>
>> CONTENT: ('a'..'z' | 'A'..'Z')+;
>> NEWLINE: '\r' | '\n';
>> WHITESPACE: ('\t' | ' ')+ {$channel = HIDDEN;};
>>
>> start: line*;
>>
>> line: content+ NEWLINE+
>>    | STAR LIST content+ NEWLINE+
>>    ;
> 
> 
> That requires the string 'LIST' on each list element?

'LIST' can be removed, if that bothers you.

> My input is line based plain text.
> 
> A list starts from the first occurrence of
> *  Any string content to end of line
> 
> and ends on the last
> * Any string content up to end of line.

grammar Test;

tokens {
STAR=''*';
}

CONTENT: ~NEWLINE+; // possibly ~(NEWLINE|WHITESPACE)+
NEWLINE: '\r' | '\n';
WHITESPACE: ('\t' | ' ')+ {$channel = HIDDEN;};

start: line*;

line: content+ NEWLINE+
    | STAR content+ NEWLINE+
    ;

You can add actions which determine the beginning and the end of the list.

Johannes
> 
> I guess I can leave this one till I've read more about navigating trees.
> 
> regards
> 
> 


From dave.pawson at gmail.com  Sat Sep 13 06:00:49 2008
From: dave.pawson at gmail.com (Dave Pawson)
Date: Sat, 13 Sep 2008 14:00:49 +0100
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <48CBB5A2.6090401@gmx.de>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>
	<48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>
	<711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>
	<48CB9730.80300@gmx.de>
	<711a73df0809130535t56759d06gf22133deb6324a9a@mail.gmail.com>
	<48CBB5A2.6090401@gmx.de>
Message-ID: <711a73df0809130600ha70448fvf3b979a64ed469b6@mail.gmail.com>

2008/9/13 Johannes Luber <jaluber at gmx.de>:

> grammar Test;
>
> tokens {
> STAR=''*';
> }
>
> CONTENT: ~NEWLINE+; // possibly ~(NEWLINE|WHITESPACE)+
> NEWLINE: '\r' | '\n';
> WHITESPACE: ('\t' | ' ')+ {$channel = HIDDEN;};
>
> start: line*;
>
> line: content+ NEWLINE+
>    | STAR content+ NEWLINE+
>    ;
>
> You can add actions which determine the beginning and the end of the list.

I can't, that's where I startedQ

Tweaking the above to let it compile I get

grammar Test;


tokens {
STAR='*';
}

WHITESPACE: ('\t' | ' ') ;
CONTENT: ~(NEWLINE)+;
NEWLINE: '\r' | '\n';



start: line* ;

line:  (c=CONTENT NEWLINE ) {
            System.out.println("<para>"+ $c.text +"</para>\n" );}|
     STAR c=CONTENT+ NEWLINE+ {
            System.out.println("<list>"+ $c.text );}   ;



Test input
content only
* LIST list content
* LIST list content more


The output is
<para>content only</para>

<para>* LIST list content</para>

<para>* LIST list content more</para>



regards

-- 
Dave Pawson
XSLT XSL-FO FAQ.
Docbook FAQ.
http://www.dpawson.co.uk

From enjoywm at cs.wm.edu  Sat Sep 13 06:51:28 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Sat, 13 Sep 2008 09:51:28 -0400
Subject: [antlr-interest] some questions need to be sure
Message-ID: <48CBC560.6060402@cs.wm.edu>

Hi,
I want to make Antlr support below codes:

#include <stdio.h>
...
#include <cutil.h> //want antlr be silent to this include      
...


int a;
Dim3 d1; //want antlr support this type                           
Dim3 d2(2,4);//want antlr support this or be silent to it.
texture<Complex, 2, cudaReadModeElementType> texKernel; //want antlr be 
silent

_global_ void function()//want antlr be silent to _global_
{
 ...
}


What I want to do is to define a lexer rule  and set the action to be 
skip, but I don't know if this will cause ambiguity.

Best,

Yixun


From antlr at mirality.co.nz  Sat Sep 13 15:03:27 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 14 Sep 2008 10:03:27 +1200
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <711a73df0809130600ha70448fvf3b979a64ed469b6@mail.gmail.com
 >
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>
	<48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>
	<711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>
	<48CB9730.80300@gmx.de>
	<711a73df0809130535t56759d06gf22133deb6324a9a@mail.gmail.com>
	<48CBB5A2.6090401@gmx.de>
	<711a73df0809130600ha70448fvf3b979a64ed469b6@mail.gmail.com>
Message-ID: <20080913220337.5075111ED11@www.antlr.org>

At 01:00 14/09/2008, Dave Pawson wrote:
 >CONTENT: ~(NEWLINE)+;
[...]
 >line:  (c=CONTENT NEWLINE ) {
 >            System.out.println("<para>"+ $c.text +"</para>\n" 
);}|
 >     STAR c=CONTENT+ NEWLINE+ {
 >            System.out.println("<list>"+ $c.text );}   ;
[...]
 >The output is
 ><para>content only</para>
 >
 ><para>* LIST list content</para>
 >
 ><para>* LIST list content more</para>

You'll note that "<list>" doesn't appear in the output -- that's a 
sign that you're never hitting the second alt, which suggests that 
the STAR is getting absorbed by the CONTENT rule.  Try changing 
CONTENT to this:

CONTENT: ~(STAR | NEWLINE) (~NEWLINE)*;


Another option would be to do all the matching in the lexer:

NEWLINE : '\r' | '\n' { $channel = HIDDEN; };
LISTITEM : '*' (~NEWLINE)* { setText(getText().substr(1)); };
TEXT : ~('*' | NEWLINE) (~NEWLINE)*;

line : TEXT { System.out.println("<para>" + $TEXT.text + 
"</para>"); }
      | LISTITEM { System.out.println("<item>" + $LISTITEM.text + 
"</item>"); }
      ;

It wouldn't be hard from there to generate a surrounding "<list>" 
element for groupings of LISTITEMs:

line : TEXT { System.out.println("<para>" + $TEXT.text + 
"</para>"); }
      | list
      ;

list : (LISTITEM) => { System.out.println("<list>"); }
          (LISTITEM { System.out.println("<item>" + $LISTITEM.text 
+ "</item>"); })+
        { System.out.println("</list>"); }
      ;

(You probably don't even need the predicate there, since ANTLR 
shouldn't try to enter the list rule unless there's a LISTITEM 
present anyway.  But it never hurts to be paranoid.)


From okrachin at purdue.edu  Sat Sep 13 15:24:48 2008
From: okrachin at purdue.edu (Olya Krachina)
Date: Sat, 13 Sep 2008 18:24:48 -0400
Subject: [antlr-interest] set max number of characters in a string
	literal
In-Reply-To: <FF993752CB890B4EB591BE5450C37BF101462A4C@navamane001.ad.internal.corp>
References: <1221191322.48c9e69a89199@webmail.purdue.edu>
	<20080912120043.A0E4A11EC8C@www.antlr.org>
	<FF993752CB890B4EB591BE5450C37BF101462A4C@navamane001.ad.internal.corp>
Message-ID: <1221344688.48cc3db0c5270@webmail.purdue.edu>

I thought i could go off of this idea but i have a few issues; currently i have
this:

LONG_STRINGLITERAL
  : 
    ('"') (~('"'|'\n'|'\r'))* ('"')
    {
        String wholeStr;
        int strLen, maxStrLen = 80;
        wholeStr = getText().toString();
        strLen = wholeStr.length();
         if ( strLen > maxStrLen )
         {
          {$setType(STRINGLITERAL))};
         }
    }  
    ;

It looks like this might work, only now i have to declare STRINGLITERAL somehow,
i would have to write ANOTHER RULE for stringliteral, and i don't know what i
could write where the prefix does not match the LONGSTRINGLITERAL rule; 

my second idea is to maybe "unsetType"... is it possible? (I am new to antlr)
 
and third idea was to make LONG_STRINGLITERAL protected and do setType
conditionally, but then again i would have to declare STRINGLITERAL somehow.... 
in many examples online this seems to be possible without extra declarations or
rules, but i can never compile that code with antlr 2.7.

Any ideas?
thanks again.


Quoting "Edwards, Waverly" <Waverly.Edwards at genesys.com>:

> Untested but should work, assuming you want something that works after
> the fact.
> 
> 
> 
> W.
> 
> SOME_STRING   : YourStringRule
>     {
>         String wholeStr;
>         int strLen, maxStrLen = 20;
> 
>         wholeStr = getText().toString();
>         strLen = wholeStr.length();
>          if ( strLen > maxStrLen ) {
>             System.out.println( strLen + " > " + maxStrLen + ".
> Truncating...");
>             setText(wholeStr.substring(maxStrLen)); // text is now
> truncated
>          }
>     }; 
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Gavin Lambert
> Sent: Friday, September 12, 2008 8:01 AM
> To: Olya Krachina; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] set max number of characters in a string
> literal
> 
> At 15:48 12/09/2008, Olya Krachina wrote:
>  >I am working on a lexer and i was wondering how i could set a 
> max
>  >limit on the number of characters that make up a string literal, 
> 
>  >i.e. it is valid when there are n (let's say n = 20) or less 
> chars.
>  >I tried setting lookahead to 20 (options k = 20) but it did not
>  >have any effect. I am using antlr 2.7.
> 
> If you need to parse exactly 20 chars and stop dead (eg. for 
> fixed-width data formats), you'll need to spell it out explicitly 
> -- eg. repeat CHAR 20 times.  (ANTLR only supports cardinalities 
> for zero, one, or many.)
> 
> Of course you can be a bit more clever about it, eg. making a rule 
> that contains five CHARs and then use that rule four times, etc.
> 
> 
> If your input language isn't actually ambiguous, though, and you 
> just want to do this for validation purposes, then your best bet 
> is to just successfully match however many characters happen to 
> appear (even if more than 20), and use a semantic action in the 
> parser or tree parser to validate the length after the fact.
> 
> Generally speaking the lexer should be built to be as tolerant as 
> it possibly can -- wait until parsing time to detect and report 
> errors.
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-addr
> ess
> 
> 



From antlr at mirality.co.nz  Sat Sep 13 15:42:23 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 14 Sep 2008 10:42:23 +1200
Subject: [antlr-interest] set max number of characters in a string
 literal
In-Reply-To: <1221344688.48cc3db0c5270@webmail.purdue.edu>
References: <1221191322.48c9e69a89199@webmail.purdue.edu>
	<20080912120043.A0E4A11EC8C@www.antlr.org>
	<FF993752CB890B4EB591BE5450C37BF101462A4C@navamane001.ad.internal.corp>
	<1221344688.48cc3db0c5270@webmail.purdue.edu>
Message-ID: <20080913224231.B14A911ED5D@www.antlr.org>

At 10:24 14/09/2008, Olya Krachina wrote:
 >LONG_STRINGLITERAL
 >  :
 >    ('"') (~('"'|'\n'|'\r'))* ('"')
 >    {
 >        String wholeStr;
 >        int strLen, maxStrLen = 80;
 >        wholeStr = getText().toString();
 >        strLen = wholeStr.length();
 >         if ( strLen > maxStrLen )
 >         {
 >          {$setType(STRINGLITERAL))};
 >         }
 >    }
 >    ;
 >
 >It looks like this might work, only now i have to declare
 >STRINGLITERAL somehow, i would have to write ANOTHER RULE for
 >stringliteral, and i don't know what i could write where the
 >prefix does not match the LONGSTRINGLITERAL rule;

You can declare it as a protected rule.  That will define it as a 
possible token type without making it a top-level candidate; if 
you don't call it yourself elsewhere in the grammar then its 
precise contents are irrelevant.

But as I said before I wouldn't do it this way.  I'd just make a 
STRINGLITERAL rule that tolerates string literals of any length, 
and then do the length validation in the parser.  It's much easier 
to generate meaningful error messages in the parser than it is in 
the lexer.


From m.utku.k at gmail.com  Sat Sep 13 17:50:30 2008
From: m.utku.k at gmail.com (=?ISO-8859-2?Q?M._Utku_Karata=BA?=)
Date: Sun, 14 Sep 2008 03:50:30 +0300
Subject: [antlr-interest] How-to: Tree grammar when AST rewrite rules
	involve parameters?
Message-ID: <c00811d80809131750y77ad7e0ct1dccc4daf0e91e5e@mail.gmail.com>

Hi all,

After practically inhaling the Definitive Antlr Reference (kudos to
Terence Parr for this great piece) for a few days, I started to build
a little smalltalk variant for practising and here goes my first show
stopper:

I am trying to generate a walker for the following grammar with no
avail. Note that my main aim is that i want to push the "operand" leaf
into the "messageChain" AST rather than having "operand" leaf in the
"expression" AST. Any ideas on how to create a correct tree grammar
appreciated.

Here is an excerpt of the grammars:

// GRAMMAR with AST output:...................
expression
     //  MESSAGE is imaginary token. operand is passed to the messageChain rule
     : operand (messageChain[(CommonTree)$operand.tree])* -> ^(MESSAGE
messageChain*);

messageChain [CommonTree o]
      :  unaryMessageChain binaryMessageChain -> ^({(CommonTree)$o}
unaryMessageChain binaryMessageChain)
      | binaryMessage binaryMessageChain -> ^({(CommonTree)$o}
binaryMessage binaryMessageChain)
      ;

// FAILING TREE GRAMMAR for the tree walker (ANTLR simply rejects and
variations don't helpneither):...................
expression
     //  MESSAGE is imaginary token. operand is passed to the messageChain rule
     : ^(MESSAGE messageChain*);

messageChain [CommonTree o]
      :  ^({(CommonTree)$o} unaryMessageChain binaryMessageChain)
      |  ^({(CommonTree)$o} binaryMessage binaryMessageChain)

TIA,
Utku.

From antlr at mirality.co.nz  Sat Sep 13 19:27:55 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 14 Sep 2008 14:27:55 +1200
Subject: [antlr-interest] How-to: Tree grammar when AST rewrite rules
 involve parameters?
In-Reply-To: <c00811d80809131750y77ad7e0ct1dccc4daf0e91e5e@mail.gmail.co
 m>
References: <c00811d80809131750y77ad7e0ct1dccc4daf0e91e5e@mail.gmail.com>
Message-ID: <20080914022805.1E0D911EE43@www.antlr.org>

At 12:50 14/09/2008, =?ISO-8859-2?Q?M._Utku_Karata=BA?= wrote:
 >// GRAMMAR with AST output:...................
 >expression
 >     //  MESSAGE is imaginary token. operand is passed to the
 >messageChain rule
 >     : operand (messageChain[(CommonTree)$operand.tree])* ->
 >^(MESSAGE
 >messageChain*);
 >
 >messageChain [CommonTree o]
 >      :  unaryMessageChain binaryMessageChain ->
 >^({(CommonTree)$o}
 >unaryMessageChain binaryMessageChain)
 >      | binaryMessage binaryMessageChain -> ^({(CommonTree)$o}
 >binaryMessage binaryMessageChain)
 >      ;
 >
 >// FAILING TREE GRAMMAR for the tree walker (ANTLR simply 
rejects
 >and variations don't helpneither):...................
 >expression
 >     //  MESSAGE is imaginary token. operand is passed to the
 >messageChain rule
 >     : ^(MESSAGE messageChain*);
 >
 >messageChain [CommonTree o]
 >      :  ^({(CommonTree)$o} unaryMessageChain 
binaryMessageChain)
 >      |  ^({(CommonTree)$o} binaryMessage binaryMessageChain)

Well, that's definitely not valid syntax.  It would help if you 
knew what token type that root node is.  Failing that, though, you 
could always just use this:

messageChain
     : ^(. (unaryMessageChain binaryMessageChain | binaryMessage 
binaryMessageChain))
     ;


From m.utku.k at gmail.com  Sun Sep 14 02:11:39 2008
From: m.utku.k at gmail.com (=?ISO-8859-2?Q?M._Utku_Karata=BA?=)
Date: Sun, 14 Sep 2008 12:11:39 +0300
Subject: [antlr-interest] How-to: Tree grammar when AST rewrite rules
	involve parameters?
In-Reply-To: <48cc76b5.1c17400a.501d.ffffd90bSMTPIN_ADDED@mx.google.com>
References: <c00811d80809131750y77ad7e0ct1dccc4daf0e91e5e@mail.gmail.com>
	<48cc76b5.1c17400a.501d.ffffd90bSMTPIN_ADDED@mx.google.com>
Message-ID: <c00811d80809140211y3fe3c9a6ne7d959970438dced@mail.gmail.com>

On Sun, Sep 14, 2008 at 5:27 AM, Gavin Lambert <antlr at mirality.co.nz> wrote:
> At 12:50 14/09/2008, =?ISO-8859-2?Q?M._Utku_Karata=BA?= wrote:
<SNIP>
>>messageChain [CommonTree o]
>>      :  ^({(CommonTree)$o} unaryMessageChain binaryMessageChain)
>>      |  ^({(CommonTree)$o} binaryMessage binaryMessageChain)
>
> Well, that's definitely not valid syntax.  It would help if you knew what
> token type that root node is.  Failing that, though, you could always just
> use this:
>
> messageChain
>    : ^(. (unaryMessageChain binaryMessageChain | binaryMessage
> binaryMessageChain))
>    ;

Thanks Gavin, I wasn't aware of '.' notation in rewrite rules (IIRC
not mentioned in the ANTLR reference).

For a workaround - I went with grammar refactorizations instead of
passing parameters around (which tends to get uglier and uglier in
time if you're constantly improvizing on the grammar :)).

Regards,
M. Utku Karatas.

From antlr at mirality.co.nz  Mon Sep 15 00:55:50 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 15 Sep 2008 19:55:50 +1200
Subject: [antlr-interest] How-to: Tree grammar when AST rewrite rules
 involve parameters?
In-Reply-To: <c00811d80809140211y3fe3c9a6ne7d959970438dced@mail.gmail.co
 m>
References: <c00811d80809131750y77ad7e0ct1dccc4daf0e91e5e@mail.gmail.com>
	<48cc76b5.1c17400a.501d.ffffd90bSMTPIN_ADDED@mx.google.com>
	<c00811d80809140211y3fe3c9a6ne7d959970438dced@mail.gmail.com>
Message-ID: <20080915075603.0A1CD11ED95@www.antlr.org>

At 21:11 14/09/2008, =?ISO-8859-2?Q?M._Utku_Karata=BA?= wrote:
 >Thanks Gavin, I wasn't aware of '.' notation in rewrite rules
 >(IIRC not mentioned in the ANTLR reference).

It is mentioned.  Perhaps what's confusing you is that it's *not* 
a rewrite rule.  Rewrite rules are the things to the right of a -> 
arrow, and "." is not valid over on that side.  But it's perfectly 
valid on the left side of an arrow (or where no arrow exists), as 
that's the recognition part, and it's a recognition operator.

 >For a workaround - I went with grammar refactorizations instead 
of
 >passing parameters around (which tends to get uglier and uglier 
in
 >time if you're constantly improvizing on the grammar :)).

Probably a good idea.


From gune.harshada at gmail.com  Mon Sep 15 09:20:04 2008
From: gune.harshada at gmail.com (harshada gune)
Date: Mon, 15 Sep 2008 21:50:04 +0530
Subject: [antlr-interest] how to print input statement when it is matched
	with grammar rule
Message-ID: <996c7a8a0809150920r44162e9cu53f042ff1e77a530@mail.gmail.com>

Suppose I am having following grammar rule;

stmt : LHS '=' RHS ;
Now when input statement matches this rule, I want to print the input
statement or use it in some another way(Say I want to save it).
How can I do this? In which variable this matched input is stored?

Thanks and regards,
Harshada.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080915/916d12ec/attachment.html 

From antlr at mirality.co.nz  Mon Sep 15 14:13:49 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 16 Sep 2008 09:13:49 +1200
Subject: [antlr-interest] how to print input statement when it is
 matched with grammar rule
In-Reply-To: <996c7a8a0809150920r44162e9cu53f042ff1e77a530@mail.gmail.co
 m>
References: <996c7a8a0809150920r44162e9cu53f042ff1e77a530@mail.gmail.com>
Message-ID: <20080915211403.6D76011ED4E@www.antlr.org>

At 04:20 16/09/2008, harshada gune wrote:
>Suppose I am having following grammar rule;
>
>stmt : LHS '=' RHS ;
>Now when input statement matches this rule, I want to print the 
>input statement or use it in some another way(Say I want to save 
>it).

stmt : LHS '=' RHS { System.out.println("LHS = " + $LHS.text + ", 
RHS = " + $RHS.text); };

OR

stmt : l=LHS '=' r=RHS { System.out.println("LHS = " + $l.text + 
", RHS = " + $r.text); };


From enjoywm at cs.wm.edu  Mon Sep 15 14:32:19 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Mon, 15 Sep 2008 17:32:19 -0400
Subject: [antlr-interest] how to make a token skip
Message-ID: <48CED463.1040100@cs.wm.edu>

Hi,
I want to make antlr skip the token: _global_. How do do it since it 
maybe a special form of another rule.
Thanks.

Yixun

From cdoucette at vaultus.com  Mon Sep 15 18:52:37 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Mon, 15 Sep 2008 21:52:37 -0400
Subject: [antlr-interest] automatically generated syntatic predicates become
 semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
Message-ID: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

Many of my grammar rules have arguments.
Very few of my productions use explicit syntactic predicates or semantic predicates.
Almost all of them seem to generate implicit syntactic/semantic predicates (except the last production of each rule).

Here's the one that is giving me trouble:

dataObjectBodyElement[DataObjectDeclaration dataObj]
            // technically we only allow one trigger definition per file -
            // but let's not limit them in the grammar because that would
            // predefine an order (i.e. trigger always at the beginning or always at the end)
            @init{
                        SubTypeDeclaration stDecl = dataObj;
            }
            :(TRIGGER)=>tr=trigger
                        {
                                    if (tr != null) {
                                                dataObj.getBody().addStatement(tr);
                                    }
                        }
            | commonObjectBodyElement[dataObj]
            |  fieldDeclarations[stDecl]
            ;

In the method dataObjectBodyElement, the generated code looks great, and it gets the argument to pass to that rule from the argument to this rule.

When I look at this rule in ANTLRworks, it says that the production for commonObjectBodyElement corresponds to the semantic predicate {synpred20_vscript}?.

That generated code looks like this:

    // $ANTLR start synpred20_vscript
    public final void synpred20_vscript_fragment() throws RecognitionException {
        // C:\\software\\trunk\\vsw\\source\\com\\vaultus\\studio\\vscript\\parser\\antlr\\vscript.g:501:4: ( commonObjectBodyElement[dataObj] )
        // C:\\software\\trunk\\vsw\\source\\com\\vaultus\\studio\\vscript\\parser\\antlr\\vscript.g:501:4: commonObjectBodyElement[dataObj]
        {
        pushFollow(FOLLOW_commonObjectBodyElement_in_synpred20_vscript1392);
        commonObjectBodyElement(dataObj);

        state._fsp--;
        if (state.failed) return ;

        }
    }
    // $ANTLR end synpred20_vscript

This obviously doesn't compile since it refers to an argument of a parent rule (which is not part of the current context).

Is this an ANTLR bug or a user bug?

In any case, how can I refactor my grammar to avoid this situation (and generate a parser which will compile)?

For the record, here is the rule for commonObjectBodyElement:

commonObjectBodyElement[DataObjectDeclaration dataObj]
            : dom=dataObjectNamedMethod
                        {
                                    if (dom != null) {
                                                dataObj.getBody().addStatement(dom);
                                    }
                        }
            | idx=index
                        {
                                    if (idx != null) {
                                                dataObj.getBody().addStatement(idx);
                                    }
                        }
            ;


Thanks,
Chuck

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080915/dceb6d48/attachment.html 

From cdoucette at vaultus.com  Mon Sep 15 18:55:46 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Mon, 15 Sep 2008 21:55:46 -0400
Subject: [antlr-interest] automatically generated syntatic predicates
 become semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
Message-ID: <A7746824D386F947BBC285F6EC4716B004535FE01D@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

I forgot to mention that this fails to work on both the newest version of ANTLRworks 1.2 plus the previous version (1.1.7?).
I believe ANTLRworks 1.2 is bundled with ANTLR 3.1 - but I am not sure.

Chuck

________________________________
From: Doucette, Charles
Sent: Monday, September 15, 2008 9:53 PM
To: Antlr
Subject: automatically generated syntatic predicates become semantic predicates (fragments) plus arguments generate parser which doesn't compile

Many of my grammar rules have arguments.
Very few of my productions use explicit syntactic predicates or semantic predicates.
Almost all of them seem to generate implicit syntactic/semantic predicates (except the last production of each rule).

Here's the one that is giving me trouble:

dataObjectBodyElement[DataObjectDeclaration dataObj]
            // technically we only allow one trigger definition per file -
            // but let's not limit them in the grammar because that would
            // predefine an order (i.e. trigger always at the beginning or always at the end)
            @init{
                        SubTypeDeclaration stDecl = dataObj;
            }
            :(TRIGGER)=>tr=trigger
                        {
                                    if (tr != null) {
                                                dataObj.getBody().addStatement(tr);
                                    }
                        }
            | commonObjectBodyElement[dataObj]
            |  fieldDeclarations[stDecl]
            ;

In the method dataObjectBodyElement, the generated code looks great, and it gets the argument to pass to that rule from the argument to this rule.

When I look at this rule in ANTLRworks, it says that the production for commonObjectBodyElement corresponds to the semantic predicate {synpred20_vscript}?.

That generated code looks like this:

    // $ANTLR start synpred20_vscript
    public final void synpred20_vscript_fragment() throws RecognitionException {
        // C:\\software\\trunk\\vsw\\source\\com\\vaultus\\studio\\vscript\\parser\\antlr\\vscript.g:501:4: ( commonObjectBodyElement[dataObj] )
        // C:\\software\\trunk\\vsw\\source\\com\\vaultus\\studio\\vscript\\parser\\antlr\\vscript.g:501:4: commonObjectBodyElement[dataObj]
        {
        pushFollow(FOLLOW_commonObjectBodyElement_in_synpred20_vscript1392);
        commonObjectBodyElement(dataObj);

        state._fsp--;
        if (state.failed) return ;

        }
    }
    // $ANTLR end synpred20_vscript

This obviously doesn't compile since it refers to an argument of a parent rule (which is not part of the current context).

Is this an ANTLR bug or a user bug?

In any case, how can I refactor my grammar to avoid this situation (and generate a parser which will compile)?

For the record, here is the rule for commonObjectBodyElement:

commonObjectBodyElement[DataObjectDeclaration dataObj]
            : dom=dataObjectNamedMethod
                        {
                                    if (dom != null) {
                                                dataObj.getBody().addStatement(dom);
                                    }
                        }
            | idx=index
                        {
                                    if (idx != null) {
                                                dataObj.getBody().addStatement(idx);
                                    }
                        }
            ;


Thanks,
Chuck

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080915/b5900fdd/attachment.html 

From parrt at cs.usfca.edu  Mon Sep 15 21:55:30 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 15 Sep 2008 21:55:30 -0700
Subject: [antlr-interest] automatically generated syntatic predicates
	become semantic predicates (fragments) plus arguments
	generate parser which doesn't compile
In-Reply-To: <A7746824D386F947BBC285F6EC4716B004535FE01D@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
References: <A7746824D386F947BBC285F6EC4716B004535FE01D@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
Message-ID: <27928EF4-0202-4CD9-9A8E-29A170C692A2@cs.usfca.edu>

This is a common "why won't my syntactic predicates work" question...i  
think a search will find results.
Ter
On Sep 15, 2008, at 6:55 PM, Doucette, Charles wrote:

> I forgot to mention that this fails to work on both the newest  
> version of ANTLRworks 1.2 plus the previous version (1.1.7?).
> I believe ANTLRworks 1.2 is bundled with ANTLR 3.1 ? but I am not  
> sure.
>
> Chuck
>
> From: Doucette, Charles
> Sent: Monday, September 15, 2008 9:53 PM
> To: Antlr
> Subject: automatically generated syntatic predicates become semantic  
> predicates (fragments) plus arguments generate parser which doesn't  
> compile
>
> Many of my grammar rules have arguments.
> Very few of my productions use explicit syntactic predicates or  
> semantic predicates.
> Almost all of them seem to generate implicit syntactic/semantic  
> predicates (except the last production of each rule).
>
> Here?s the one that is giving me trouble:
>
> dataObjectBodyElement[DataObjectDeclaration dataObj]
>             // technically we only allow one trigger definition per  
> file -
>             // but let's not limit them in the grammar because that  
> would
>             // predefine an order (i.e. trigger always at the  
> beginning or always at the end)
>             @init{
>                         SubTypeDeclaration stDecl = dataObj;
>             }
>             :(TRIGGER)=>tr=trigger
>                         {
>                                     if (tr != null) {
>                                                  
> dataObj.getBody().addStatement(tr);
>                                     }
>                         }
>             | commonObjectBodyElement[dataObj]
>             |  fieldDeclarations[stDecl]
>             ;
>
> In the method dataObjectBodyElement, the generated code looks great,  
> and it gets the argument to pass to that rule from the argument to  
> this rule.
>
> When I look at this rule in ANTLRworks, it says that the production  
> for commonObjectBodyElement corresponds to the semantic predicate  
> {synpred20_vscript}?.
>
> That generated code looks like this:
>
>     // $ANTLR start synpred20_vscript
>     public final void synpred20_vscript_fragment() throws  
> RecognitionException {
>         // C:\\software\\trunk\\vsw\\source\\com\\vaultus\\studio\ 
> \vscript\\parser\\antlr\\vscript.g:501:4:  
> ( commonObjectBodyElement[dataObj] )
>         // C:\\software\\trunk\\vsw\\source\\com\\vaultus\\studio\ 
> \vscript\\parser\\antlr\\vscript.g:501:4:  
> commonObjectBodyElement[dataObj]
>         {
>          
> pushFollow(FOLLOW_commonObjectBodyElement_in_synpred20_vscript1392);
>         commonObjectBodyElement(dataObj);
>
>         state._fsp--;
>         if (state.failed) return ;
>
>         }
>     }
>     // $ANTLR end synpred20_vscript
>
> This obviously doesn?t compile since it refers to an argument of a  
> parent rule (which is not part of the current context).
>
> Is this an ANTLR bug or a user bug?
>
> In any case, how can I refactor my grammar to avoid this situation  
> (and generate a parser which will compile)?
>
> For the record, here is the rule for commonObjectBodyElement:
>
> commonObjectBodyElement[DataObjectDeclaration dataObj]
>             : dom=dataObjectNamedMethod
>                         {
>                                     if (dom != null) {
>                                                  
> dataObj.getBody().addStatement(dom);
>                                     }
>                         }
>             | idx=index
>                         {
>                                     if (idx != null) {
>                                                  
> dataObj.getBody().addStatement(idx);
>                                     }
>                         }
>             ;
>
>
> Thanks,
> Chuck
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080915/daf8d2d5/attachment.html 

From arik_tg at yahoo.com  Tue Sep 16 00:47:41 2008
From: arik_tg at yahoo.com (Arik Ter-Galstyan)
Date: Tue, 16 Sep 2008 00:47:41 -0700 (PDT)
Subject: [antlr-interest] Problems with Verilog grammar file
Message-ID: <424298.24423.qm@web32802.mail.mud.yahoo.com>


Hi Buddies,

Recently I was trying to make a verilog parser via verilog.g grammar downloaded from ANTLR website. However, all my attempts have failed. I have tried to compile the mentioned grammar file with ANTLR 2.7.5, 2.7.6, 2.7.7 and 3.0.1 versions. None of the mentioned ANTLR versions compiled the verilog grammar file successfully. Please let me know if I need to do something before compilation. Any help is highly appreciated.


Thanks in advance,
Arik


      

From jaluber at gmx.de  Tue Sep 16 03:42:27 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 16 Sep 2008 12:42:27 +0200
Subject: [antlr-interest] automatically generated syntatic predicates
 become semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
In-Reply-To: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
References: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
Message-ID: <48CF8D93.60304@gmx.de>

Doucette, Charles schrieb:
> Many of my grammar rules have arguments.
> 
> Very few of my productions use explicit syntactic predicates or semantic
> predicates.
> 
> Almost all of them seem to generate implicit syntactic/semantic
> predicates (except the last production of each rule).

That seems suspicious. Are you sure that no alternative is disabled? Do
you use backtracking for convenience? There is a tutorial which
describes the removal of global backtracking on the wiki.
> 
> Here?s the one that is giving me trouble:
...
> When I look at this rule in ANTLRworks, it says that the production for
> commonObjectBodyElement corresponds to the semantic predicate
> {synpred20_vscript}?.
> 
> That generated code looks like this:
...
> This obviously doesn?t compile since it refers to an argument of a
> parent rule (which is not part of the current context).
> 
> Is this an ANTLR bug or a user bug?
> 
> In any case, how can I refactor my grammar to avoid this situation (and
> generate a parser which will compile)?
> 
It's a user bug. Arguments and predicates don't mix. Use scopes instead
like this.

rule a
scope {
int i;
}
   : (pred)=> y {$a::i = 3;}
   ;

Johannes

From arcadiorubiogarcia at gmail.com  Tue Sep 16 04:15:11 2008
From: arcadiorubiogarcia at gmail.com (=?ISO-8859-1?Q?Arcadio_Rubio_Garc=EDa?=)
Date: Tue, 16 Sep 2008 13:15:11 +0200
Subject: [antlr-interest] Ruby Target
Message-ID: <E244ABAE-D9AE-4706-984A-96AD496B1947@gmail.com>

Hi everyone,

I'm in the process of migrating a YACC grammar to ANTLR and everything  
is going fine so far.

However, since the rest of the project is written in Ruby, I'd like to  
generate the ANTLR code in Ruby, if possible. Currently I'm generating  
Java and using JRuby to circumvent this limitation.

I've read the wiki page related to the Ruby Target (http://www.antlr.org/wiki/display/ANTLR3/Antlr3RubyTarget 
), and the blog of its developer (http://split-s.blogspot.com/2005/12/antlr-for-ruby.html 
). The development seems to have halted in version 3.0b4. This version  
could suit my needs as I'm only using basic Lexer and Parser  
generation. No tree parsers.

Does anyone know where to get this version? It's not listed in the  
Download directory (http://www.antlr.org/download/) and I couldn't  
find it in the development repository.

Thanks in advance.

- Arcadio

From maulattu at yahoo.it  Tue Sep 16 07:00:16 2008
From: maulattu at yahoo.it (maulattu)
Date: Tue, 16 Sep 2008 14:00:16 +0000 (GMT)
Subject: [antlr-interest] [AST grammar] input null pointer exception
Message-ID: <727141.20355.qm@web26002.mail.ukl.yahoo.com>

Hi mates!
I'm using antlr to build a tree grammar used to parse this pseudo-language 
BUS_0 := EBUS_0 | EBUS_1;

in order to have a compiled code like this:
0; 0; 1; 128
that is:
    * 0 -> "or" (operator)
    * 0 -> ebus_0 (1st operand)
    * 1 -> ebus_1 (2nd operand)
    * 128 -> bus_0 (result)

I've an assignment operator (:=), or (|) and "and" (&). In future it will support shift operator.

I used a grammar to build an AST derived from the simpleCalc grammar available on the antlr book as well as on the wiki:
grammar canScript;

options {
  language = Java;
  output = AST;
  ASTLabelType=CommonTree; // type of $stat.tree ref etc...
}

prog:   ( stat {System.out.println($stat.tree.toStringTree());} )+ ;

stat:   busExpr ':=' expr ';'     -> ^(':=' busExpr expr)
    |   NEWLINE                    ->
    ;

expr:   andExpr ('|'^ andExpr)*
    ; 

andExpr
    :   atom ('&'^ atom)*
    ; 

atom:   INT
    |   ebusExpr
    |   '('! expr ')'!
    ;

busExpr
    :    'BUS_0'
    |    'BUS_1'
    |    'BUS_2'
    ;
ebusExpr
    :    'EBUS_0'
    |    'EBUS_1'
    |    'EBUS_2'
    ;

INT :   '0'..'9'+ ;
NEWLINE:'\r'? '\n' ;
WS  :   (' '|'\t'|'\n'|'\r')+ {skip();} ;

This is the walker grammar:
tree grammar canScriptEval;

options {
    language = Java;
    tokenVocab = canScript;
    ASTLabelType = CommonTree;
}

@header {
import java.util.Vector;
}

@members {
Vector<String> vect = new Vector<String>(50,50);
}

prog
    :    stat+
    ;

stat
    :   expr
    |   ^(':=' busExpr expr)
    ;

expr
    :   ^('|' a=expr b=expr)    {
                                    vect.add(new String("OR"));
                                    /*vect.add($a.text);
                                    vect.add($b.text);*/
                                }
    |    ^('&' a=expr b=expr)    {
                                    vect.add(new String("AND"));
                                    /*vect.add($a.text);
                                    vect.add($b.text);*/
                                }
    | ebusExpr
    | INT
    ;

busExpr
    :    'BUS_0'
    |    'BUS_1'
    |    'BUS_2'
    ;
ebusExpr
    :    'EBUS_0'
    |    'EBUS_1'
    |    'EBUS_2'
    ;

It works fine, since that if it receives as input
BUS_0 := (EBUS_0 | EBUS_1) & EBUS_2;
it will correctly build the ast:
(:= BUS_0 (& (| EBUS_0 EBUS_1) EBUS_2))

As you can see from the walker grammar, the commented rows cause a null-pointer exception in the resulting java code
vect.add(new String("OR"));
                                                        vect.add((a!=null?(input.getTokenStream().toString(
                      input.getTreeAdaptor().getTokenStartIndex(a.start),
                      input.getTreeAdaptor().getTokenStopIndex(a.start))):null));

In particular, input.getTokenStream() returns null and I can't understand why (it is in the "expr()" function)

A lot of thanks in advance!

Mau


__________________________________________________
Do You Yahoo!?
Poco spazio e tanto spam? Yahoo! Mail ti protegge dallo spam e ti da tanto spazio gratuito per i tuoi file e i messaggi 
http://mail.yahoo.it 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080916/6e9226b1/attachment.html 

From cdoucette at vaultus.com  Tue Sep 16 07:07:45 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Tue, 16 Sep 2008 10:07:45 -0400
Subject: [antlr-interest] automatically generated syntatic predicates
 become semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
In-Reply-To: <48CF8D93.60304@gmx.de>
References: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
	<48CF8D93.60304@gmx.de>
Message-ID: <A7746824D386F947BBC285F6EC4716B004850EA6E4@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

> That seems suspicious. Are you sure that no alternative is
> disabled? Do you use backtracking for convenience? There is a
> tutorial which describes the removal of global backtracking
> on the wiki.

I don't know what it means for "no alternative to be disabled."

Here are my grammar options:


> >
> > Here's the one that is giving me trouble:
> ...
> > When I look at this rule in ANTLRworks, it says that the production
> > for commonObjectBodyElement corresponds to the semantic predicate
> > {synpred20_vscript}?.
> >
> > That generated code looks like this:
> ...
> > This obviously doesn't compile since it refers to an argument of a
> > parent rule (which is not part of the current context).
> >
> > Is this an ANTLR bug or a user bug?
> >
> > In any case, how can I refactor my grammar to avoid this situation
> > (and generate a parser which will compile)?
> >
> It's a user bug. Arguments and predicates don't mix. Use
> scopes instead like this.
>
> rule a
> scope {
> int i;
> }
>    : (pred)=> y {$a::i = 3;}
>    ;
>
> Johannes
>

From jaluber at gmx.de  Tue Sep 16 07:16:15 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 16 Sep 2008 16:16:15 +0200
Subject: [antlr-interest] automatically generated syntatic predicates
 become semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
In-Reply-To: <A7746824D386F947BBC285F6EC4716B004850EA6E4@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
References: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
	<48CF8D93.60304@gmx.de>
	<A7746824D386F947BBC285F6EC4716B004850EA6E4@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
Message-ID: <48CFBFAF.6080108@gmx.de>

Doucette, Charles schrieb:
>> That seems suspicious. Are you sure that no alternative is
>> disabled? Do you use backtracking for convenience? There is a
>> tutorial which describes the removal of global backtracking
>> on the wiki.
> 
> I don't know what it means for "no alternative to be disabled."

When ANTLR discovers ambiguities it shows warnings that it doesn't know
which path it should prefer and that it disables all paths but the first
one. You have to tell ANTLR manually which path you want by the means
described in the "Global backtracking removal" tutorial.
> 
> Here are my grammar options:

You didn't included them.

Johannes
> 
> 
>>> Here's the one that is giving me trouble:
>> ...
>>> When I look at this rule in ANTLRworks, it says that the production
>>> for commonObjectBodyElement corresponds to the semantic predicate
>>> {synpred20_vscript}?.
>>>
>>> That generated code looks like this:
>> ...
>>> This obviously doesn't compile since it refers to an argument of a
>>> parent rule (which is not part of the current context).
>>>
>>> Is this an ANTLR bug or a user bug?
>>>
>>> In any case, how can I refactor my grammar to avoid this situation
>>> (and generate a parser which will compile)?
>>>
>> It's a user bug. Arguments and predicates don't mix. Use
>> scopes instead like this.
>>
>> rule a
>> scope {
>> int i;
>> }
>>    : (pred)=> y {$a::i = 3;}
>>    ;
>>
>> Johannes
>>
> 


From cdoucette at vaultus.com  Tue Sep 16 07:21:55 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Tue, 16 Sep 2008 10:21:55 -0400
Subject: [antlr-interest] automatically generated syntatic predicates
 become semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
References: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
	<48CF8D93.60304@gmx.de> 
Message-ID: <A7746824D386F947BBC285F6EC4716B004850EA6FF@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

Sorry - that was sent prematurely:

Here are my grammar options.
I don't completely understand what they mean.
I inherited them when I started with a Java grammar.

options {
        k=2;
        backtrack=true;
        memoize=true;
//      output=AST;
}

When I tried to remove them and use the default options - I did get many errors and warnings.
I guess I have to follow your suggested tutorial to remove backtracking?

I didn't explicitly use arguments and predicates. ANTLR automatically generated the predicates for me;
probably based on my grammar options above.

>
> > It's a user bug. Arguments and predicates don't mix. Use scopes
> > instead like this.
> >
> > rule a
> > scope {
> > int i;
> > }
> >    : (pred)=> y {$a::i = 3;}
> >    ;

Thanks,
Chuck

From cdoucette at vaultus.com  Tue Sep 16 07:30:20 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Tue, 16 Sep 2008 10:30:20 -0400
Subject: [antlr-interest] automatically generated syntatic predicates
 become semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
In-Reply-To: <A7746824D386F947BBC285F6EC4716B004850EA6FF@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
References: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
	<48CF8D93.60304@gmx.de>
	<A7746824D386F947BBC285F6EC4716B004850EA6FF@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
Message-ID: <A7746824D386F947BBC285F6EC4716B004850EA70A@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

I've just read the book.
I do understand what backtracking means now (and memoize),
and that it means that it automatically inserts predicates before every rule production that it can't disambiguate.
It just so happens that at least one of them has an argument.

Chuck

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of
> Doucette, Charles
> Sent: Tuesday, September 16, 2008 10:22 AM
> To: Antlr
> Subject: Re: [antlr-interest] automatically generated
> syntatic predicates become semantic predicates (fragments)
> plus arguments generate parser which doesn't compile
>
> Sorry - that was sent prematurely:
>
> Here are my grammar options.
> I don't completely understand what they mean.
> I inherited them when I started with a Java grammar.
>
> options {
>         k=2;
>         backtrack=true;
>         memoize=true;
> //      output=AST;
> }
>
> When I tried to remove them and use the default options - I
> did get many errors and warnings.
> I guess I have to follow your suggested tutorial to remove
> backtracking?
>
> I didn't explicitly use arguments and predicates. ANTLR
> automatically generated the predicates for me; probably based
> on my grammar options above.
>
> >
> > > It's a user bug. Arguments and predicates don't mix. Use scopes
> > > instead like this.
> > >
> > > rule a
> > > scope {
> > > int i;
> > > }
> > >    : (pred)=> y {$a::i = 3;}
> > >    ;
>
> Thanks,
> Chuck
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address
>
>

From jaluber at gmx.de  Tue Sep 16 07:41:34 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 16 Sep 2008 16:41:34 +0200
Subject: [antlr-interest] automatically generated syntatic predicates
 become semantic predicates (fragments) plus arguments generate parser which
 doesn't compile
In-Reply-To: <A7746824D386F947BBC285F6EC4716B004850EA6FF@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
References: <A7746824D386F947BBC285F6EC4716B004535FE01C@vmtbosmail01.VMTBOSTON.VAULTUS.COM>	<48CF8D93.60304@gmx.de>
	<A7746824D386F947BBC285F6EC4716B004850EA6FF@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
Message-ID: <48CFC59E.7070103@gmx.de>

Doucette, Charles schrieb:
> Sorry - that was sent prematurely:
> 
> Here are my grammar options.
> I don't completely understand what they mean.
> I inherited them when I started with a Java grammar.
> 
> options {
>         k=2;

k=2; sets the lookahead to a maxmimum of two tokens.
>         backtrack=true;

backtrack=true; activates backtracking. If you don't know what
backtracking does, Wikipedia has an article about it.

>         memoize=true;

With this option you store temporary results created by backtracking.
Increased memory usage for speeding up the analysis.

> //      output=AST;

With no output-option function don't return only void, unless specified
otherwise via the return keyword.
> }
> 
> When I tried to remove them and use the default options - I did get many errors and warnings.
> I guess I have to follow your suggested tutorial to remove backtracking?

Right. Be aware that it is time consuming to do it right and to get
really rid of all instances. Depending on the source of the Java grammar
you may want to postpone this until you are more familiar with ANTLR.
> 
> I didn't explicitly use arguments and predicates. ANTLR automatically generated the predicates for me;
> probably based on my grammar options above.

Correct.

Johannes
> 
>>> It's a user bug. Arguments and predicates don't mix. Use scopes
>>> instead like this.
>>>
>>> rule a
>>> scope {
>>> int i;
>>> }
>>>    : (pred)=> y {$a::i = 3;}
>>>    ;
> 
> Thanks,
> Chuck
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From arcadiorubiogarcia at gmail.com  Tue Sep 16 09:38:12 2008
From: arcadiorubiogarcia at gmail.com (=?ISO-8859-1?Q?Arcadio_Rubio_Garc=EDa?=)
Date: Tue, 16 Sep 2008 18:38:12 +0200
Subject: [antlr-interest] Token Boundaries
Message-ID: <49393130-F9F1-4703-9E5D-0D7FCF1CD919@gmail.com>

Hi everyone,

what's the way to define tokens so that they take into account word  
boundaries, i.e. "1then" is not accepted as token INT 1 token THEN,  
but rejected.

I know how to do this with a regular expression (using \b, which  
matches word boundaries), but no clue on how to do it succinctly in  
ANTLR.

Thanks in advance.

From weiju.wu at gmail.com  Tue Sep 16 12:08:52 2008
From: weiju.wu at gmail.com (Wei-ju Wu)
Date: Tue, 16 Sep 2008 12:08:52 -0700
Subject: [antlr-interest] Ruby Target
In-Reply-To: <E244ABAE-D9AE-4706-984A-96AD496B1947@gmail.com>
References: <E244ABAE-D9AE-4706-984A-96AD496B1947@gmail.com>
Message-ID: <5bbb42570809161208n7cdfdc49v75ea0fa36eed72c4@mail.gmail.com>

Hi,

the code generator for the Ruby target should be part of the distribution if
you
download the package for version 3.0.1.
You just need to provide 'Ruby' as the target language like this:

options { language = Ruby; }

Wei-ju

On Tue, Sep 16, 2008 at 4:15 AM, Arcadio Rubio Garc?a <
arcadiorubiogarcia at gmail.com> wrote:

> Hi everyone,
>
> I'm in the process of migrating a YACC grammar to ANTLR and everything
> is going fine so far.
>
> However, since the rest of the project is written in Ruby, I'd like to
> generate the ANTLR code in Ruby, if possible. Currently I'm generating
> Java and using JRuby to circumvent this limitation.
>
> I've read the wiki page related to the Ruby Target (
> http://www.antlr.org/wiki/display/ANTLR3/Antlr3RubyTarget
> ), and the blog of its developer (
> http://split-s.blogspot.com/2005/12/antlr-for-ruby.html
> ). The development seems to have halted in version 3.0b4. This version
> could suit my needs as I'm only using basic Lexer and Parser
> generation. No tree parsers.
>
> Does anyone know where to get this version? It's not listed in the
> Download directory (http://www.antlr.org/download/) and I couldn't
> find it in the development repository.
>
> Thanks in advance.
>
> - Arcadio
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080916/a8ec35d2/attachment.html 

From antlr at mirality.co.nz  Tue Sep 16 23:15:40 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 17 Sep 2008 18:15:40 +1200
Subject: [antlr-interest] [AST grammar] input null pointer exception
In-Reply-To: <727141.20355.qm@web26002.mail.ukl.yahoo.com>
References: <727141.20355.qm@web26002.mail.ukl.yahoo.com>
Message-ID: <20080917061556.E85F931296C@www.antlr.org>

At 02:00 17/09/2008, maulattu wrote:
>In particular, input.getTokenStream() returns null and I can't 
>understand why (it is in the "expr()" function)

Did you call setTokenStream in your driver code to pass the token 
stream over to the node stream?  It doesn't inherit it 
automatically...


From fazlur.bluelane at gmail.com  Wed Sep 17 00:22:08 2008
From: fazlur.bluelane at gmail.com (Fazlur Rahaman Naik)
Date: Wed, 17 Sep 2008 12:52:08 +0530
Subject: [antlr-interest] Multiple inheritance problem
Message-ID: <6235239b0809170022o30169c14h67e6b3b00666c228@mail.gmail.com>

Hi All,

    This is Falzur. I am using Antlr 2.7.6 to parse MySQL queries. I am
facing a problem with the multiple inheritance. I wrote a seperate grammar
file for each MySQL statement. and a base file for the comman grammar. In
MySQL we have a begin end block statement, in which any statement can come.
Here the problem raised. The grammar for the begin end block is as follows:

compound_stmt {SaToken t;}: t = begin_end_block
  {
  cout<<"Pushing for element compound_stmt at depth "<<currentDepth<<endl;
  ElemToken elem_token = createElementToken(currentDepth,
ELEMENT_TYPE_compound_stmt, t);
  add_elem_token_to_list(elem_token);
  currentDepth --;
  };

begin_end_block : (begin_label COLON)? begin_clause (statement_list)?
end_clause;

begin_clause returns [SaToken t] : e: "begin" {
  t = createSaToken (e);
};

end_clause: "end" (end_label)?;

statement_list: (stmt)* ;

stmt: (subquery | create_stmt | replace_stmt | update_stmt | alter_stmt |
truncate_stmt | compound_stmt);

begin_label: identifier;
end_label: begin_label;

Where all the,  subquery, create_stmt, replace_stmt, update_stmt,
alter_stmt, truncate_stmt, compound_stmt are in different parser files.

and i choosed the following options:

options {

     importVocab = BaseLexer;

     k = 3;

    defaultErrorHandler = false;

    buildAST = true;

    classHeaderSuffix = UpdateParser, ReplaceParser, TruncateParser,
AlterPaser, SelectParser;

}

When i compile, it raises an error

rule classDef trapped

expecting SEMI, found ','

ane when i compile with the option classHeaderSuffix = UpdateParser; then,
the compilation throws errors saying that the following statements doesn't
have the rule define, which is right.

create_stmt,

replace_stmt,

update_stmt,

alter_stmt,

truncate_stmt

I would like to inherit each grammar file in the current file. So that all
the Tokens should resolve.

Can anybody help me out how to resolve this problem.  Thanks in advance.

-- 
Thanks & Regards,

Fazlur Rahaman Naik
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/99c0e934/attachment.html 

From dave.pawson at gmail.com  Wed Sep 17 01:09:27 2008
From: dave.pawson at gmail.com (Dave Pawson)
Date: Wed, 17 Sep 2008 09:09:27 +0100
Subject: [antlr-interest] Lists. Lexer or Parser?
In-Reply-To: <48cc38b8.1e2a400a.143f.6fecSMTPIN_ADDED@mx.google.com>
References: <711a73df0809120246q112b5cbw49950efbca3ae392@mail.gmail.com>
	<48ca5bad.092a400a.2d4c.6a47SMTPIN_ADDED@mx.google.com>
	<711a73df0809120658p4b9f43bdh95f871d21ef62325@mail.gmail.com>
	<48cb86e9.1b2a400a.0512.481fSMTPIN_ADDED@mx.google.com>
	<711a73df0809130306o229fb43dl9de1f18c21642906@mail.gmail.com>
	<48CB9730.80300@gmx.de>
	<711a73df0809130535t56759d06gf22133deb6324a9a@mail.gmail.com>
	<48CBB5A2.6090401@gmx.de>
	<711a73df0809130600ha70448fvf3b979a64ed469b6@mail.gmail.com>
	<48cc38b8.1e2a400a.143f.6fecSMTPIN_ADDED@mx.google.com>
Message-ID: <711a73df0809170109n1d3ba915uc26b01ec732a5506@mail.gmail.com>

2008/9/13 Gavin Lambert <antlr at mirality.co.nz>:
> At 01:00 14/09/2008, Dave Pawson wrote:
>>CONTENT: ~(NEWLINE)+;
> [...]
>>line:  (c=CONTENT NEWLINE ) {
>>            System.out.println("<para>"+ $c.text +"</para>\n" );}|
>>     STAR c=CONTENT+ NEWLINE+ {
>>            System.out.println("<list>"+ $c.text );}   ;
> [...]
>>The output is
>><para>content only</para>
>>
>><para>* LIST list content</para>
>>
>><para>* LIST list content more</para>
>
> You'll note that "<list>" doesn't appear in the output -- that's a sign that
> you're never hitting the second alt, which suggests that the STAR is getting
> absorbed by the CONTENT rule.  Try changing CONTENT to this:
>
> CONTENT: ~(STAR | NEWLINE) (~NEWLINE)*;

Still not the 'double' markup I'm chasing
<list>
<item>list item content</item>
<item>Second item content</item>

With just the above change I'm finding

<para>content only</para>

<list> LIST list content
<list> LIST list content more


So it is seperating the two ('normal' content and lists, but not
answering my original
requirement)







>
>
> Another option would be to do all the matching in the lexer:
>
> NEWLINE : '\r' | '\n' { $channel = HIDDEN; };
> LISTITEM : '*' (~NEWLINE)* { setText(getText().substr(1)); };
> TEXT : ~('*' | NEWLINE) (~NEWLINE)*;
>
> line : TEXT { System.out.println("<para>" + $TEXT.text + "</para>"); }
>     | LISTITEM { System.out.println("<item>" + $LISTITEM.text + "</item>");
> }
>     ;
>
> It wouldn't be hard from there to generate a surrounding "<list>" element
> for groupings of LISTITEMs:
>
> line : TEXT { System.out.println("<para>" + $TEXT.text + "</para>"); }
>     | list
>     ;
>
> list : (LISTITEM) => { System.out.println("<list>"); }
>         (LISTITEM { System.out.println("<item>" + $LISTITEM.text +
> "</item>"); })+
>       { System.out.println("</list>"); }
>     ;
>
> (You probably don't even need the predicate there, since ANTLR shouldn't try
> to enter the list rule unless there's a LISTITEM present anyway.  But it
> never hurts to be paranoid.)



Using the second definition of line I'm getting

ANTLR Parser Generator  Version 3.1 (August 12, 2008)  1989-2008
warning(200): Test.g:23:81: Decision can match input such as
"LISTITEM" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
Semantic predicates were present but were hidden by actions.


Thanks for the help, I think I need quite a bit more reading!


regards



-- 
Dave Pawson
XSLT XSL-FO FAQ.
Docbook FAQ.
http://www.dpawson.co.uk

From yue.nicholas at gmail.com  Wed Sep 17 04:49:09 2008
From: yue.nicholas at gmail.com (Nicholas Yue)
Date: Wed, 17 Sep 2008 21:49:09 +1000
Subject: [antlr-interest] Parser within a parser?
Message-ID: <48D0EEB5.5000108@gmail.com>

Hi,

    I am new to ANTLR but have written grammar previously for bison/flex 
(a long time ago)

    I am trying to familiarize myself with the terminology in ANTLR.

    I am trying to parse the following content to build an object 
representing the information.

    This is the output from a compiled RenderMan shader

8<------8<------8<------8<------8<------8<------8<------8<------
light "distantlight"
    "intensity" "parameter uniform float"
        Default value: 1
    "lightcolor" "parameter uniform color"
        Default value: "rgb" [1 1 1]
    "from" "parameter uniform point"
        Default value: "shader" [0 0 0]
    "to" "parameter uniform point"
        Default value: "shader" [0 0 1]
    "__nondiffuse" "parameter uniform float"
        Default value: 0
    "__nonspecular" "parameter uniform float"
        Default value: 0
8<------8<------8<------8<------8<------8<------8<------8<------

    I have trying out the following grammar.

    I am able to identify keywords like light and name like "distantlight"

    As you can see, the default value line is different depending on the 
content **inside** the "parameter ...." string.

    Does it mean that I have to write two different grammar? i.e. Parser 
within a parser? If I do, how do I communicate that information back out 
to the outer parser to continue?

8<------8<------8<------8<------8<------8<------8<------8<------
class CSILexer extends Lexer;

options { k=1; filter=true; }

LIGHT : ("light")
    {System.out.println("Found light shader: "+getText());}
  ;

SURFACE : ("surface")
    {System.out.println("Found surface shader: "+getText());}
  ;

QUOTEDALPHANUM : '"' ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'0'..'9')* '"'
    {System.out.println("Found quoted alphanumeric: "+getText());}
  ;


NUMERIC : ('0'..'9')+
    { System.out.println("Found numeric: "+getText()); }
  ;

EXIT    : '.' { System.exit(0); } ;
8<------8<------8<------8<------8<------8<------8<------8<------

Regards


From J.Kraaijeveld at Askesis.nl  Wed Sep 17 06:58:34 2008
From: J.Kraaijeveld at Askesis.nl (Joost Kraaijeveld)
Date: Wed, 17 Sep 2008 15:58:34 +0200
Subject: [antlr-interest] Using Antlr with StringTemplate files
Message-ID: <1221659914.5885.206.camel@panoramix.askesis.nl>

Hi,

I want to use AntrWorks to create a source translator using
StringTemplates. 

Can anyone tell me/ point to a tutorial how I can use AntrlWorks ( and
especially it's debugger) together with a StringTemplate file? 

All the examples I have seen seem to use a handwritten Java file which
contains the application's main, but the AntlrWorks debugger generates
it's own Java file with it's own main, that does not use my stg-file
"automagically". So I assume that if it is possible I must do something,
but I have no idea what.

TIA

-- 
Groeten,

Joost Kraaijeveld
Askesis B.V.
Molukkenstraat 14
6524NB Nijmegen
tel: 024-3888063 / 06-51855277
fax: 024-3608416
web: www.askesis.nl


From maulattu at yahoo.it  Wed Sep 17 07:23:53 2008
From: maulattu at yahoo.it (maulattu)
Date: Wed, 17 Sep 2008 14:23:53 +0000 (GMT)
Subject: [antlr-interest] [AST grammar] input null pointer exception
Message-ID: <501075.11778.qm@web26004.mail.ukl.yahoo.com>

Doh!
Now it's ok and it works fine.
On chapter 3 of the book there isn't that function call as I can see, I found it also on http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
Thank you Gavin



----- Messaggio originale -----
Da: Gavin Lambert <antlr at mirality.co.nz>
A: maulattu <maulattu at yahoo.it>; antlr-interest at antlr.org
Inviato: Mercoled? 17 settembre 2008, 8:15:40
Oggetto: Re: [antlr-interest] [AST grammar] input null pointer exception

At 02:00 17/09/2008, maulattu wrote:
>In particular, input.getTokenStream() returns null and I can't 
>understand why (it is in the "expr()" function)

Did you call setTokenStream in your driver code to pass the token 
stream over to the node stream?  It doesn't inherit it 
automatically...

__________________________________________________
Do You Yahoo!?
Poco spazio e tanto spam? Yahoo! Mail ti protegge dallo spam e ti da tanto spazio gratuito per i tuoi file e i messaggi 
http://mail.yahoo.it 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/782378e2/attachment.html 

From parrt at cs.usfca.edu  Wed Sep 17 09:45:26 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 17 Sep 2008 09:45:26 -0700
Subject: [antlr-interest] Using Antlr with StringTemplate files
In-Reply-To: <1221659914.5885.206.camel@panoramix.askesis.nl>
References: <1221659914.5885.206.camel@panoramix.askesis.nl>
Message-ID: <26ADAD29-7279-4D66-BD7C-E9C9872A8415@cs.usfca.edu>

We are going to work on a mechanism where you can alter the standard  
test rig to add whatever code snippets you need.

Ter
On Sep 17, 2008, at 6:58 AM, Joost Kraaijeveld wrote:

> Hi,
>
> I want to use AntrWorks to create a source translator using
> StringTemplates.
>
> Can anyone tell me/ point to a tutorial how I can use AntrlWorks ( and
> especially it's debugger) together with a StringTemplate file?
>
> All the examples I have seen seem to use a handwritten Java file which
> contains the application's main, but the AntlrWorks debugger generates
> it's own Java file with it's own main, that does not use my stg-file
> "automagically". So I assume that if it is possible I must do  
> something,
> but I have no idea what.
>
> TIA
>
> -- 
> Groeten,
>
> Joost Kraaijeveld
> Askesis B.V.
> Molukkenstraat 14
> 6524NB Nijmegen
> tel: 024-3888063 / 06-51855277
> fax: 024-3608416
> web: www.askesis.nl
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From tbrandonau at gmail.com  Wed Sep 17 10:18:52 2008
From: tbrandonau at gmail.com (Thomas Brandon)
Date: Thu, 18 Sep 2008 03:18:52 +1000
Subject: [antlr-interest] Using Antlr with StringTemplate files
In-Reply-To: <26ADAD29-7279-4D66-BD7C-E9C9872A8415@cs.usfca.edu>
References: <1221659914.5885.206.camel@panoramix.askesis.nl>
	<26ADAD29-7279-4D66-BD7C-E9C9872A8415@cs.usfca.edu>
Message-ID: <ebc876d70809171018w3f0fadcaj42df6edc61d6c4da@mail.gmail.com>

Until then you can use the remote debugging feature of ANTLRWorks.
Generate the code with the -debug command line option (can be set in
ANTLRWorks preferences), then run your application code however you
want, it will pause waiting for the debugger to connect when you
select remote debugging in ANTLRWorks.
On this point, a useful enhancement in ANTLRWorks might be a command
to generate with debug enabled to save having to change this through
the preferences when you are alternately running with and without
remote debugging.

Tom.
On Thu, Sep 18, 2008 at 2:45 AM, Terence Parr <parrt at cs.usfca.edu> wrote:
> We are going to work on a mechanism where you can alter the standard
> test rig to add whatever code snippets you need.
>
> Ter
> On Sep 17, 2008, at 6:58 AM, Joost Kraaijeveld wrote:
>
>> Hi,
>>
>> I want to use AntrWorks to create a source translator using
>> StringTemplates.
>>
>> Can anyone tell me/ point to a tutorial how I can use AntrlWorks ( and
>> especially it's debugger) together with a StringTemplate file?
>>
>> All the examples I have seen seem to use a handwritten Java file which
>> contains the application's main, but the AntlrWorks debugger generates
>> it's own Java file with it's own main, that does not use my stg-file
>> "automagically". So I assume that if it is possible I must do
>> something,
>> but I have no idea what.
>>
>> TIA
>>
>> --
>> Groeten,
>>
>> Joost Kraaijeveld
>> Askesis B.V.
>> Molukkenstraat 14
>> 6524NB Nijmegen
>> tel: 024-3888063 / 06-51855277
>> fax: 024-3608416
>> web: www.askesis.nl
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From hallorant at gmail.com  Wed Sep 17 11:14:33 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Wed, 17 Sep 2008 14:14:33 -0400
Subject: [antlr-interest] How does one suppress 'no viable alternative at
	character' warning messages
Message-ID: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>

My lexer is sending warnings to stderr of the form and I'd like to suppress
these.

line 1:7 no viable alternative at character 'H'
line 1:8 no viable alternative at character 'I'
line 1:9 no viable alternative at character 'D'
line 1:10 no viable alternative at character 'E'

Now, I read chapter 10 of the ANTLR book and my grammar has the following:

@members {
@Override
protected void mismatch(IntStream input, int ttype, BitSet follow)
        throws RecognitionException {
    throw new MismatchedTokenException(ttype, input);
}

@Override
public Object recoverFromMismatchedSet(IntStream input,
        RecognitionException e, BitSet follow) throws RecognitionException {
    throw e;
}
}

@rulecatch {
catch (RecognitionException e) {
    throw e;
}
}

To make it "strict" about not trying to recover.

Thanks!
Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/96a4b751/attachment.html 

From jimi at temporal-wave.com  Wed Sep 17 11:39:36 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 17 Sep 2008 11:39:36 -0700
Subject: [antlr-interest] How does one suppress 'no viable
	alternative	at character' warning messages
In-Reply-To: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
Message-ID: <1221676776.8923.101.camel@jimi.temporal-wave.com>

On Wed, 2008-09-17 at 14:14 -0400, Tim Halloran wrote:
> My lexer is sending warnings to stderr of the form and I'd like to
> suppress these.
> 
> line 1:7 no viable alternative at character 'H'
> line 1:8 no viable alternative at character 'I'
> line 1:9 no viable alternative at character 'D'
> line 1:10 no viable alternative at character 'E'


Rather than do that, create a last rule in the lexer;

ANY : . { System.out.println("Don't support this char" + $text);
skip(); }

Or perhaps you want a filtering lexer?


Jim
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/a77219d7/attachment.html 

From hallorant at gmail.com  Wed Sep 17 12:03:52 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Wed, 17 Sep 2008 15:03:52 -0400
Subject: [antlr-interest] How does one suppress 'no viable alternative
	at character' warning messages
In-Reply-To: <1221676776.8923.101.camel@jimi.temporal-wave.com>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
Message-ID: <a36ab4bc0809171203k7720b841p79d96f733fba566f@mail.gmail.com>

Well, I'm not sure but I don't want extra output.

Riffing off Jim's idea I tried:

ANY
    : . { throw new RecognitionException(); }
    ;

but this doesn't work as the generated code (I'm using :

// $ANTLR 3.1

...

    // $ANTLR start "ANY"
    public final void mANY() throws RecognitionException {
        try {
            int _type = ANY;
            int _channel = DEFAULT_TOKEN_CHANNEL;
            //
C:\\Users\\Tim\\Source\\Work34\\ad-hoc-query-common\\src\\com\\surelogic\\common\\adhoc\\model\\parser\\ColumnAnnotation.g:94:2:
( . )
            //
C:\\Users\\Tim\\Source\\Work34\\ad-hoc-query-common\\src\\com\\surelogic\\common\\adhoc\\model\\parser\\ColumnAnnotation.g:94:4:
.
            {
            matchAny();
             throw new RecognitionException();

            }

            state.type = _type;
            state.channel = _channel;
        }
        finally {
        }
    }

Has an error -- the Java compiler is unhappy because the state.* assignments
are unreachable code (due to the throw).  Now I can work around this by
changing the grammar to:

ANY
    : . { if (true) throw new RecognitionException(); }
    ;

There is another problem with the use of "."  If I change to


ANY
    : c=. { if (true) {
              RecognitionException e =new RecognitionException();
              e.line = ?
              ...
              throw e;
            }
          }
    ;

"c" isn't a token it is an int (as described on page 126 of the book).  This
is bad as there is no way to "fill out" the RecognitionException information
(line, index, pos, etc.)  Is there some way around this problem?  I'm
guessing this is for performance, but lacking a token makes reporting
impossible as far as I can see.

Regards,
Tim

On Wed, Sep 17, 2008 at 2:39 PM, Jim Idle <jimi at temporal-wave.com> wrote:

>  On Wed, 2008-09-17 at 14:14 -0400, Tim Halloran wrote:
>
> My lexer is sending warnings to stderr of the form and I'd like to suppress
> these.
>
> line 1:7 no viable alternative at character 'H'
> line 1:8 no viable alternative at character 'I'
> line 1:9 no viable alternative at character 'D'
> line 1:10 no viable alternative at character 'E'
>
>
> Rather than do that, create a last rule in the lexer;
>
> ANY : . { System.out.println("Don't support this char" + $text); skip(); }
>
> Or perhaps you want a filtering lexer?
>
> Jim
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/37c03bc7/attachment.html 

From parrt at cs.usfca.edu  Wed Sep 17 12:16:15 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 17 Sep 2008 12:16:15 -0700
Subject: [antlr-interest] How does one suppress 'no viable
	alternative	at character' warning messages
In-Reply-To: <1221676776.8923.101.camel@jimi.temporal-wave.com>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
Message-ID: <25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>

Or,Overrides the reporting method to do nothing :)
Ter
On Sep 17, 2008, at 11:39 AM, Jim Idle wrote:

> On Wed, 2008-09-17 at 14:14 -0400, Tim Halloran wrote:
>>
>> My lexer is sending warnings to stderr of the form and I'd like to  
>> suppress these.
>>
>> line 1:7 no viable alternative at character 'H'
>> line 1:8 no viable alternative at character 'I'
>> line 1:9 no viable alternative at character 'D'
>> line 1:10 no viable alternative at character 'E'
>
> Rather than do that, create a last rule in the lexer;
>
> ANY : . { System.out.println("Don't support this char" + $text);  
> skip(); }
>
> Or perhaps you want a filtering lexer?
>
> Jim
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From hallorant at gmail.com  Wed Sep 17 12:23:52 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Wed, 17 Sep 2008 15:23:52 -0400
Subject: [antlr-interest] How does one suppress 'no viable alternative
	at character' warning messages
In-Reply-To: <25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
	<25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>
Message-ID: <a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>

On Wed, Sep 17, 2008 at 3:16 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Or,Overrides the reporting method to do nothing :)
> Ter


I tried this with

@lexer::members {
@Override
public void reportError(RecognitionException e) {
    throw e;
}
}

but this is unhappy because I can't change the method signature to add
"throws RecognitionException."

Doing nothing, as Terrence suggested above, works but still accepts
sentences that are not in my language,  for example if I accept (hide) and I
give the string (***hide) where * is not accepted by my lexer the parser
views them as the same sentence.  This appears to be because the recover by
single symbol deletion is going on and I have not figured out how to turn it
off.  Am I correct?

Regards,
Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/02c94292/attachment.html 

From parrt at cs.usfca.edu  Wed Sep 17 12:27:21 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 17 Sep 2008 12:27:21 -0700
Subject: [antlr-interest] How does one suppress 'no viable alternative
	at character' warning messages
In-Reply-To: <a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
	<25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>
	<a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>
Message-ID: <3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>

Try overriding  nextToken()...hmm...that might be hard.

Just throw an Error, which will not require a change to the signature  
and will blast all way out.
Ter
On Sep 17, 2008, at 12:23 PM, Tim Halloran wrote:

> On Wed, Sep 17, 2008 at 3:16 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> Or,Overrides the reporting method to do nothing :)
> Ter
>
> I tried this with
>
> @lexer::members {
> @Override
> public void reportError(RecognitionException e) {
>     throw e;
> }
> }
>
> but this is unhappy because I can't change the method signature to  
> add "throws RecognitionException."
>
> Doing nothing, as Terrence suggested above, works but still accepts  
> sentences that are not in my language,  for example if I accept  
> (hide) and I give the string (***hide) where * is not accepted by my  
> lexer the parser views them as the same sentence.  This appears to  
> be because the recover by single symbol deletion is going on and I  
> have not figured out how to turn it off.  Am I correct?
>
> Regards,
> Tim
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From spamhole at gmx.at  Wed Sep 17 13:18:06 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Wed, 17 Sep 2008 22:18:06 +0200
Subject: [antlr-interest] How does one suppress 'no viable alternative
 at character' warning messages
In-Reply-To: <3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>	<1221676776.8923.101.camel@jimi.temporal-wave.com>	<25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>	<a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>
	<3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>
Message-ID: <48D165FE.50500@gmx.at>

Terence Parr schrieb:
> Try overriding  nextToken()...hmm...that might be hard.
>   
Would this FAQ solve Tim's problem? 
http://www.antlr.org/wiki/pages/viewpage.action?pageId=5341217

We used that today and it worked. It makes any unmatched character stop 
the whole thing. The method explained in the book's chapter 10.4 about 
exiting the recognizer on the first error only works for the parser, but 
not for the lexer. The lexer still accepts unknown characters and continues.

I think it would be great if error reporting and recovery were 
configurable or at least easier to modify than by overriding methods. 
(Correctly) overriding methods is quite complicated and hard to get 
right imo. Especially when you're new to antlr and don't know the 
internals very well yet it's quite easy to screw it up (I have 
experience with screwing it up ;-).

Max


From hallorant at gmail.com  Wed Sep 17 13:27:20 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Wed, 17 Sep 2008 16:27:20 -0400
Subject: [antlr-interest] How does one suppress 'no viable alternative
	at character' warning messages
In-Reply-To: <3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
	<25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>
	<a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>
	<3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>
Message-ID: <a36ab4bc0809171327m387c6ea8u91e600add6ca2389@mail.gmail.com>

On Wed, Sep 17, 2008 at 3:27 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Just throw an Error, which will not require a change to the signature and
> will blast all way out.
>

This is undesirable because it breaks the client side and loses reporting
information.  My client side looks like:

    public static ColumnAnnotation parse(String annotation) {
        ColumnAnnotation result = null;
        ANTLRStringStream input = new ANTLRStringStream(annotation);
        ColumnAnnotationLexer lexer = new ColumnAnnotationLexer(input);
        CommonTokenStream tokens = new CommonTokenStream(lexer);
        ColumnAnnotationParser parser = new ColumnAnnotationParser(tokens);
        try {
            result = parser.columnAnnotation();
        } catch (RecognitionException e) {
            SLLogger.getLogger().log(Level.WARNING,
                    I18N.err(129, annotation, e.charPositionInLine));
        }
        if (result == null) {
            result = new ColumnAnnotation();
            result.setIsValid(false);
        }
        return result;
    }

Where I try to report a (hopefully) helpful warning.

There is, however, a solution (albeit a bit messy) that does what the client
desires:

@lexer::members {
@Override
public void reportError(RecognitionException e) {
  Thrower.sneakyThrow(e);
}

/**
 * See "Puzzle 43: Exceptionally Unsafe" from Bloch Gafter, <i>Java
Puzzlers</i>. Addison Wesley 2005.
 */
static class Thrower {
    private static Throwable t;
    private Thrower() throws Throwable {
        throw t;
    }
    public static synchronized void sneakyThrow(Throwable t) {
        Thrower.t = t;
        try {
            Thrower.class.newInstance();
        } catch (InstantiationException e) {
            throw new IllegalArgumentException(e);
        } catch (IllegalAccessException e) {
            throw new IllegalArgumentException(e);
        } finally {
            Thrower.t = null; // Avoid memory leak
        }
    }
}
}

A better approach (like an option to turn off lexer error recovery) seems a
good enhancement to a future version of ANTLR.  That said, this approach is
nice because it works in the way most folks client code would expect.

Regards,
Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/89da2a13/attachment.html 

From jimi at temporal-wave.com  Wed Sep 17 13:37:09 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 17 Sep 2008 13:37:09 -0700
Subject: [antlr-interest] How does one suppress 'no viable
	alternative	at character' warning messages
In-Reply-To: <a36ab4bc0809171327m387c6ea8u91e600add6ca2389@mail.gmail.com>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
	<25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>
	<a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>
	<3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>
	<a36ab4bc0809171327m387c6ea8u91e600add6ca2389@mail.gmail.com>
Message-ID: <1221683829.8923.123.camel@jimi.temporal-wave.com>

On Wed, 2008-09-17 at 16:27 -0400, Tim Halloran wrote:
> On Wed, Sep 17, 2008 at 3:27 PM, Terence Parr <parrt at cs.usfca.edu>
> wrote:
> 
>         Just throw an Error, which will not require a change to the
>         signature and will blast all way out.
> 
> 
> This is undesirable because it breaks the client side and loses
> reporting information.  My client side looks like:


Basically though, if your lexer is throwing NVA's, it means it isn't
complete or has bugs. By rights, the lexer should make something out of
anything, even if it is a throw away element:

ANY : . { skip(); }

Or more likely, a more controlled error message:
ANY : . { myErrorLog.error("The character " + $text + " is not
supported."); $channel = HIDDEN; }




> 



> }
> }
> 
> A better approach (like an option to turn off lexer error recovery)
> seems a good enhancement to a future version of ANTLR.  

Given all the things that can happen, the approach now seems best. It is
not difficult to override a method.


> That said, this approach is nice because it works in the way most
> folks client code would expect.


Lexer recovery is just that it eats the character it did not want. There
is not much else you can do. If you turn it off, then what should it do?

Jim


> 
> Regards,
> Tim
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 

> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/7d901555/attachment.html 

From enjoywm at cs.wm.edu  Wed Sep 17 13:38:05 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Wed, 17 Sep 2008 16:38:05 -0400
Subject: [antlr-interest] include file
Message-ID: <48D16AAD.4090309@cs.wm.edu>

Hi,
I add a #include<cutil.h> in my source file but antlr said "No such file 
or directory".

Thanks.

Yixun

From hallorant at gmail.com  Wed Sep 17 13:50:57 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Wed, 17 Sep 2008 16:50:57 -0400
Subject: [antlr-interest] How does one suppress 'no viable alternative
	at character' warning messages
In-Reply-To: <48D165FE.50500@gmx.at>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
	<25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>
	<a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>
	<3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>
	<48D165FE.50500@gmx.at>
Message-ID: <a36ab4bc0809171350j2e29a82ej8a0058380bee28c7@mail.gmail.com>

Max,

Thanks for the reference I update the wiki to include the solution I came up
with.

Regards,
Tim

On Wed, Sep 17, 2008 at 4:18 PM, Markus Stoeger <spamhole at gmx.at> wrote:

> Terence Parr schrieb:
> > Try overriding  nextToken()...hmm...that might be hard.
> >
> Would this FAQ solve Tim's problem?
> http://www.antlr.org/wiki/pages/viewpage.action?pageId=5341217
>
> We used that today and it worked. It makes any unmatched character stop
> the whole thing. The method explained in the book's chapter 10.4 about
> exiting the recognizer on the first error only works for the parser, but
> not for the lexer. The lexer still accepts unknown characters and
> continues.
>
> I think it would be great if error reporting and recovery were
> configurable or at least easier to modify than by overriding methods.
> (Correctly) overriding methods is quite complicated and hard to get
> right imo. Especially when you're new to antlr and don't know the
> internals very well yet it's quite easy to screw it up (I have
> experience with screwing it up ;-).
>
> Max
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/0c6ec9d4/attachment.html 

From hallorant at gmail.com  Wed Sep 17 13:55:59 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Wed, 17 Sep 2008 16:55:59 -0400
Subject: [antlr-interest] How does one suppress 'no viable alternative
	at character' warning messages
In-Reply-To: <1221683829.8923.123.camel@jimi.temporal-wave.com>
References: <a36ab4bc0809171114q143fe384s6861899c8c67e3a1@mail.gmail.com>
	<1221676776.8923.101.camel@jimi.temporal-wave.com>
	<25A64256-31B2-4CD9-B90A-1F3E5A25AAD0@cs.usfca.edu>
	<a36ab4bc0809171223g2e2d9a18l7a3254206564e44f@mail.gmail.com>
	<3E6AE55C-8C98-41B9-98EC-9B9A0CBEB8FB@cs.usfca.edu>
	<a36ab4bc0809171327m387c6ea8u91e600add6ca2389@mail.gmail.com>
	<1221683829.8923.123.camel@jimi.temporal-wave.com>
Message-ID: <a36ab4bc0809171355t37ed1642j270efa7a93bd29bb@mail.gmail.com>

On Wed, Sep 17, 2008 at 4:37 PM, Jim Idle <jimi at temporal-wave.com> wrote:

> Lexer recovery is just that it eats the character it did not want. There is
> not much else you can do. If you turn it off, then what should it do?
>

In the case of ANTLR, as I understand its design, I would want it to throw
the RecognitionException all the way up through the parser to my client
code.  Thus communicating that no, the input sentence provided does not
conform to my language.

I was, with a bit of a Java hack, able to get this to occur.

Regards,
Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/2e8fbe3c/attachment.html 

From kurtotte at gmail.com  Wed Sep 17 15:57:55 2008
From: kurtotte at gmail.com (Kurt Otte)
Date: Wed, 17 Sep 2008 16:57:55 -0600
Subject: [antlr-interest] How do you implement conditional blocks in tree
	grammars?
Message-ID: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>

How can I skip a section of the token stream when using a tree grammar
to implement a conditional block?

I have read the mailing list archives and come across several
references to using seek() to reposition the token stream, but how to
you resync the parser to match?

For example, suppose I have an IF construct in the AST similar to this

^(COND expression ^(IF ^(BLOCK statement+) )

>From the previous threads it seems like you would do something like

^(COND exp=expression
  {if (!$exp.bool) SeekTokenStream($statements.stop); }
  ^(IF ^(BLOCK statement+) )

Essentially, as I understand it this would make it so '^(IF ^(BLOCK
statement+)' would be skipped if the expression evaluated false.
SeekTokenStream() is a function I would need to write to call the
seek() method in the token istream.  Unfortunately, I can't seem to
find a way to get access to the stream from inside an action block.
It seemed from the mail archives there was a $input which would all
this, but that doesn't seem to be currently supported.  The next
problem is I can't access statements until after processing them which
defeats the purpose and 'stop' doesn't seem to be supported either.
Even if all of this did work to move the token stream forward, the
parser would be out of sync so I am a bit confused on what the design
model is for skipping a block.

To synchronize the parser, I thought it might make sense to use a
gated predicate such as

^(COND exp=expression
  ^(IF ^(b=BLOCK
    // conditionally enable the statements, and if they are disabled,
    // advance the token stream to skip the block
    {(!$exp.bool)}?=> statement+
    { if (!$exp.bool) { SkipBlock($b); }})

This is a bit ugly and redundant, but the hope was to turn off
statements and then SkipBlock() would have to do some manual work on
the token stream find the end of the block and then seek() to there;
however, the gated predicate doesn't turn off 'statement+' as I had
hoped.

To avoid heavy lifting in SkipBlock(), I was hoping to have ANTLR help
me with finding the end of the block by using wildcarding.  Something
like this

^(COND exp=expression ^(IF ^(BLOCK anything) )

anything
  : .+
  | ^(anything)
  ;

Then I could use ANTLR to match all of the statements generically, but
it seems '.' will only match a token not a tree since it gets hung up
on UP's and DOWN's and the above attempt to match tokens and trees
won't even compile.

Am I off in the weeds?  It seems like implementing a conditional block
should be a rather common and reasonable thing to do, but I haven't
been able to search out the necessary magic yet.

Does anyone have a good example of how to do this?  What am I missing?

Thanks,

Kurt

From parrt at cs.usfca.edu  Wed Sep 17 16:05:26 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 17 Sep 2008 16:05:26 -0700
Subject: [antlr-interest] How do you implement conditional blocks in
	tree grammars?
In-Reply-To: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>
References: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>
Message-ID: <F80732B2-ECA4-44A8-806F-DBACF15C4808@cs.usfca.edu>


On Sep 17, 2008, at 3:57 PM, Kurt Otte wrote:

> How can I skip a section of the token stream when using a tree grammar
> to implement a conditional block?

^(COND . ^(IF ^(BLOCK .)))

I think.

Ter


From kurtotte at gmail.com  Wed Sep 17 16:13:20 2008
From: kurtotte at gmail.com (Kurt Otte)
Date: Wed, 17 Sep 2008 17:13:20 -0600
Subject: [antlr-interest] How do you implement conditional blocks in
	tree grammars?
In-Reply-To: <F80732B2-ECA4-44A8-806F-DBACF15C4808@cs.usfca.edu>
References: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>
	<F80732B2-ECA4-44A8-806F-DBACF15C4808@cs.usfca.edu>
Message-ID: <27766db30809171613h6d1e493fv561967e7dccbfb92@mail.gmail.com>

This didn't work for me.  The '.' will only match real or imaginary
tokens and not UPs or DOWNs so this works as long as there are no
subtrees.  In my case there are subtrees so I get a recognizer error
on an unexpected DOWN.  I tried '.' and '.+' and both got hung up on
UPs and DOWNs.

Would this be language specific?  I am using the C Runtime, but I
figured this is generic.

Am I missing something?

Thanks,

Kurt


On Wed, Sep 17, 2008 at 5:05 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>
> On Sep 17, 2008, at 3:57 PM, Kurt Otte wrote:
>
>> How can I skip a section of the token stream when using a tree grammar
>> to implement a conditional block?
>
> ^(COND . ^(IF ^(BLOCK .)))
>
> I think.
>
> Ter
>
>

From parrt at cs.usfca.edu  Wed Sep 17 16:18:17 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 17 Sep 2008 16:18:17 -0700
Subject: [antlr-interest] How do you implement conditional blocks in
	tree grammars?
In-Reply-To: <27766db30809171613h6d1e493fv561967e7dccbfb92@mail.gmail.com>
References: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>
	<F80732B2-ECA4-44A8-806F-DBACF15C4808@cs.usfca.edu>
	<27766db30809171613h6d1e493fv561967e7dccbfb92@mail.gmail.com>
Message-ID: <A1A26114-9BEE-45B3-B6AA-BEBDDCE9CAC5@cs.usfca.edu>

Oh,I did that in a tree grammar so it should work for complete  
subtrees. At least, I did that in an interpreter of mine.
T

From kurtotte at gmail.com  Wed Sep 17 16:38:54 2008
From: kurtotte at gmail.com (Kurt Otte)
Date: Wed, 17 Sep 2008 17:38:54 -0600
Subject: [antlr-interest] How do you implement conditional blocks in
	tree grammars?
In-Reply-To: <A1A26114-9BEE-45B3-B6AA-BEBDDCE9CAC5@cs.usfca.edu>
References: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>
	<F80732B2-ECA4-44A8-806F-DBACF15C4808@cs.usfca.edu>
	<27766db30809171613h6d1e493fv561967e7dccbfb92@mail.gmail.com>
	<A1A26114-9BEE-45B3-B6AA-BEBDDCE9CAC5@cs.usfca.edu>
Message-ID: <27766db30809171638x55c2b2d4t980d838443e8ecbc@mail.gmail.com>

So would the expected model be:

^((CONDITIONAL exp=expression
    {($exp.bool)}?=>  ^(IF ^(BLOCK statement+) )
    {(!$exp.bool)}?=>  ^(IF ^(BLOCK .) )
  )

So if the expression is true, the statements are processed as
statements, and if the expression is false they are slurped up through
a wildcard?

Do you recommend using a predicate (like shown above) to do the
switching or what is the best plan?  Is there a code snippet or
example you could point me to?

Thanks so much for your help and quick responses,

Kurt


On Wed, Sep 17, 2008 at 5:18 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Oh,I did that in a tree grammar so it should work for complete
> subtrees. At least, I did that in an interpreter of mine.
> T
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From parrt at cs.usfca.edu  Wed Sep 17 16:44:15 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 17 Sep 2008 16:44:15 -0700
Subject: [antlr-interest] How do you implement conditional blocks in
	tree grammars?
In-Reply-To: <27766db30809171638x55c2b2d4t980d838443e8ecbc@mail.gmail.com>
References: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>
	<F80732B2-ECA4-44A8-806F-DBACF15C4808@cs.usfca.edu>
	<27766db30809171613h6d1e493fv561967e7dccbfb92@mail.gmail.com>
	<A1A26114-9BEE-45B3-B6AA-BEBDDCE9CAC5@cs.usfca.edu>
	<27766db30809171638x55c2b2d4t980d838443e8ecbc@mail.gmail.com>
Message-ID: <DD41A73A-DABB-48F6-9F82-0136C0E63E08@cs.usfca.edu>

Hi Kurt,Here are two simple rules:

ifstat
     :   ^('if' c=expr s=. e=.?) // ^('if' expr stat stat?)
         {interp.ifstat(this, (Boolean)$c.value, $s, $e);}
     ;

whilestat
     :   ^('while' c=. s=.) // ^('while' expr stat)
         {interp.whilestat(this, $c, $s);}
     ;

and here is the ifstat in the interpreter core:

     public void ifstat(Eval evaluator, Boolean condition, SLAST stat,  
SLAST elsestat)
         throws RecognitionException
     {
         nodes.push(nodes.index());
         if ( condition.booleanValue() ) {
             nodes.seek(stat.streamIndex);
             evaluator.stat();
         }
         else if ( elsestat!=null ) {
             nodes.seek(elsestat.streamIndex);
             evaluator.stat();
         }
         nodes.pop(); // start after IF
     }

Slick, no? :)

Ter
On Sep 17, 2008, at 4:38 PM, Kurt Otte wrote:

> So would the expected model be:
>
> ^((CONDITIONAL exp=expression
>    {($exp.bool)}?=>  ^(IF ^(BLOCK statement+) )
>    {(!$exp.bool)}?=>  ^(IF ^(BLOCK .) )
>  )
>
> So if the expression is true, the statements are processed as
> statements, and if the expression is false they are slurped up through
> a wildcard?
>
> Do you recommend using a predicate (like shown above) to do the
> switching or what is the best plan?  Is there a code snippet or
> example you could point me to?
>
> Thanks so much for your help and quick responses,
>
> Kurt
>
>
> On Wed, Sep 17, 2008 at 5:18 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
>> Oh,I did that in a tree grammar so it should work for complete
>> subtrees. At least, I did that in an interpreter of mine.
>> T
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From kurtotte at gmail.com  Wed Sep 17 17:02:29 2008
From: kurtotte at gmail.com (Kurt Otte)
Date: Wed, 17 Sep 2008 18:02:29 -0600
Subject: [antlr-interest] How do you implement conditional blocks in
	tree grammars?
In-Reply-To: <DD41A73A-DABB-48F6-9F82-0136C0E63E08@cs.usfca.edu>
References: <27766db30809171557ue7cc561h267fb011b75b0fdf@mail.gmail.com>
	<F80732B2-ECA4-44A8-806F-DBACF15C4808@cs.usfca.edu>
	<27766db30809171613h6d1e493fv561967e7dccbfb92@mail.gmail.com>
	<A1A26114-9BEE-45B3-B6AA-BEBDDCE9CAC5@cs.usfca.edu>
	<27766db30809171638x55c2b2d4t980d838443e8ecbc@mail.gmail.com>
	<DD41A73A-DABB-48F6-9F82-0136C0E63E08@cs.usfca.edu>
Message-ID: <27766db30809171702o6a13abedxb8ea37410666b9d8@mail.gmail.com>

That is pretty slick.  I wonder if I have run across a bug in the C target.

When I try this.

conditional
  : ^(CONDITIONAL exp=expression ^(IF ^(BLOCK .) ) )
  ;

Feed it this AST

(CONDITIONAL (DECIMAL 0) (IF (BLOCK (foo (NAME bar)))))

I get this error

ERROR: -Imaginary-:0  Unexpected node,syntax error, near DO

Where 'DO' is Down token.

Does this seem to point a bug in C Runtime or am I missing something else?

Thanks,

Kurt


On Wed, Sep 17, 2008 at 5:44 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Hi Kurt,Here are two simple rules:
>
> ifstat
>     :   ^('if' c=expr s=. e=.?) // ^('if' expr stat stat?)
>         {interp.ifstat(this, (Boolean)$c.value, $s, $e);}
>     ;
>
> whilestat
>     :   ^('while' c=. s=.) // ^('while' expr stat)
>         {interp.whilestat(this, $c, $s);}
>     ;
>
> and here is the ifstat in the interpreter core:
>
>     public void ifstat(Eval evaluator, Boolean condition, SLAST stat,
> SLAST elsestat)
>         throws RecognitionException
>     {
>         nodes.push(nodes.index());
>         if ( condition.booleanValue() ) {
>             nodes.seek(stat.streamIndex);
>             evaluator.stat();
>         }
>         else if ( elsestat!=null ) {
>             nodes.seek(elsestat.streamIndex);
>             evaluator.stat();
>         }
>         nodes.pop(); // start after IF
>     }
>
> Slick, no? :)
>
> Ter
> On Sep 17, 2008, at 4:38 PM, Kurt Otte wrote:
>
>> So would the expected model be:
>>
>> ^((CONDITIONAL exp=expression
>>    {($exp.bool)}?=>  ^(IF ^(BLOCK statement+) )
>>    {(!$exp.bool)}?=>  ^(IF ^(BLOCK .) )
>>  )
>>
>> So if the expression is true, the statements are processed as
>> statements, and if the expression is false they are slurped up through
>> a wildcard?
>>
>> Do you recommend using a predicate (like shown above) to do the
>> switching or what is the best plan?  Is there a code snippet or
>> example you could point me to?
>>
>> Thanks so much for your help and quick responses,
>>
>> Kurt
>>
>>
>> On Wed, Sep 17, 2008 at 5:18 PM, Terence Parr <parrt at cs.usfca.edu>
>> wrote:
>>> Oh,I did that in a tree grammar so it should work for complete
>>> subtrees. At least, I did that in an interpreter of mine.
>>> T
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From hjrnunes at student.dei.uc.pt  Wed Sep 17 19:35:28 2008
From: hjrnunes at student.dei.uc.pt (Henrique)
Date: Thu, 18 Sep 2008 03:35:28 +0100
Subject: [antlr-interest] Python target @members problem
In-Reply-To: <ac8968760809171931m21016b65hf1bf2cc2a5453360@mail.gmail.com>
References: <ac8968760809171931m21016b65hf1bf2cc2a5453360@mail.gmail.com>
Message-ID: <ac8968760809171935r32d26052q8b8ea7404179ff19@mail.gmail.com>

Hi everyone!I'm building a parser that should generate python code. The
problem is that the variables that I define in the @members section are not
recognized in the rules themselves.
For instance, I have this:

grammar cfdg_py;

options{
language=Python;
}

...

@members {
names=[]
rule_name = []
}

...

rule
@init{
rule_name=[]
print "NEW RULE"
}
@after{
names.append(rule_name)
print "END RULE: " + str(names)
}
: RULE USER_STRING (USER_RATIONAL)? LEFTBRACKET buncha_replacements?
RIGHTBRACKET {rule_name.append($USER_STRING.text);}
 ;

I get a NameError: global name 'names' is not defined in the first line of
the @after section.
How do I make sure the variables are defined?
I've tried inserting the semicolons as advised in the wiki but it didn't
work. The antlr python documentation is really scarce so I can't figure it
out.
I'm attaching the whole grammar with this. Using ANTLR 3.1 on Windows.
Thanks in advance.

Henrique Nunes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/70362aba/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cfdg_py.g
Type: application/octet-stream
Size: 3143 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/70362aba/attachment.obj 

From matthieu at offthelip.org  Wed Sep 17 21:51:54 2008
From: matthieu at offthelip.org (Matthieu Riou)
Date: Wed, 17 Sep 2008 21:51:54 -0700
Subject: [antlr-interest] The ~ operator in lexer rules
Message-ID: <fbdc6a970809172151j3a2740e9qca40abc05b8c9332@mail.gmail.com>

Hi,

I'm trying to write a grammar where 2.3 would be a float style number but
where the same group of characters in foo.2.3 would be recognized as two
distinct numbers (like foo[2][3]). I changed my number lexer rule to be:

NUM       : ~'.' DIGIT+ ('.' DIGIT+)? ;

However this doesn't seem to work, strangely expressions like [2,3,4] get
rejected with a no viable alternative at input ',3'. Does someone have a
clue why and how I should tweak my rules to do what I want?

Thanks,
Matthieu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/3c5fcc28/attachment.html 

From sterini at gmail.com  Wed Sep 17 22:06:15 2008
From: sterini at gmail.com (Ilya Sterin)
Date: Thu, 18 Sep 2008 01:06:15 -0400
Subject: [antlr-interest] Simple grammar issue?
Message-ID: <67d2b0c70809172206q605c349as3b828b221cbaf5e3@mail.gmail.com>

I'm having an issue with what seems to be very simple grammar...

The CREATECOMMAND is parsing correctly...

Here is what I use for validation...

create jar named "alex.jar"

I get a NoViableAltException for the TYPE definition

The grammar file is below...


//////// alex.g ////////

grammar alex;

tokens {
	BUILD='build';
	FROM='from';
	TO='to';
	CREATE='create';
	NAMED='named';
}

COMMAND		:	BUILDCOMMAND CREATECOMMAND;

BUILDCOMMAND	:	BUILD (SOURCE | DESTINATION)+;
CREATECOMMAND	:	CREATE TYPE (NAME | SOURCE | DESTINATION)+;

SOURCE		:	FROM FILE;
DESTINATION 	:	TO FILE;

TYPE		:	('jar' | 'war');

NAME		:	NAMED FILE;

FILE		:	'"' FILENAME '"';
FILENAME	: 	('a'..'z'|'A'..'Z'|'0'..'9'|'.')+;

From jimi at temporal-wave.com  Wed Sep 17 22:17:29 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 17 Sep 2008 22:17:29 -0700
Subject: [antlr-interest] The ~ operator in lexer rules
In-Reply-To: <fbdc6a970809172151j3a2740e9qca40abc05b8c9332@mail.gmail.com>
References: <fbdc6a970809172151j3a2740e9qca40abc05b8c9332@mail.gmail.com>
Message-ID: <1221715049.8923.214.camel@jimi.temporal-wave.com>

On Wed, 2008-09-17 at 21:51 -0700, Matthieu Riou wrote:
> Hi,
> 
> I'm trying to write a grammar where 2.3 would be a float style number
> but where the same group of characters in foo.2.3 would be recognized
> as two distinct numbers (like foo[2][3]). I changed my number lexer
> rule to be:
> 
> NUM       : ~'.' DIGIT+ ('.' DIGIT+)? ;
> 
> However this doesn't seem to work, strangely expressions like [2,3,4]
> get rejected with a no viable alternative at input ',3'. Does someone
> have a clue why and how I should tweak my rules to do what I want?


You are going to have to keep state in the lexer, somethign like this:

@lexer::members
{
   boolean returnInt = false;
}
ID : ('a'..'z')+

        (
              ('.' ('0'..'9'))=> { returnInt = true; }
            |
        )
;

DOT : '.';
NUM : ('0'..'9')
          (
             {returnInt == true}?=>
                      (
                            ('.' ('0'..'9'))=> { returnInt = true; }
                          | {returnInt = false; }
                      )
          )
;

And so on, but it will get a lot more complicated. If this is your
language, then don't do this, if it is not, then shoot the designer ;-)

Other approaches might be this kind of thing:

ID : ('a'..'z')+ { input.mark(); }

         (  ('.' ('0'..'9'))=> '.' ('0'..'9')+ { elementCount++; } )*
        { input.release(); }
;

DOT : '.' ;
NUM :  {elementCount > 0}?=> ('0'..'9')+ { elementCount--; };
 

Or you could override the emit() method and return more than one token
per lexer rule invocation.

Take a look at wiki FAQ on parsing numerics, and the article on emitting
more than one token from a lexer rule.

Jim


> 
> Thanks,
> Matthieu
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/62406f85/attachment.html 

From jimi at temporal-wave.com  Wed Sep 17 22:20:56 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 17 Sep 2008 22:20:56 -0700
Subject: [antlr-interest] Simple grammar issue?
In-Reply-To: <67d2b0c70809172206q605c349as3b828b221cbaf5e3@mail.gmail.com>
References: <67d2b0c70809172206q605c349as3b828b221cbaf5e3@mail.gmail.com>
Message-ID: <1221715256.8923.218.camel@jimi.temporal-wave.com>

On Thu, 2008-09-18 at 01:06 -0400, Ilya Sterin wrote:

> I'm having an issue with what seems to be very simple grammar...


Please read the "5 minute introduction to ANTLR" on the wike page. This
will explain how to write sch a simple grammar. All your rules are lexer
rules and you are not catering for whitespace, some of your lexer rules
overlap others and so on. These are all basic mistakes that everyone
makes, but a bit of reading on the wiki will get you through it.

Jim

> 
> The CREATECOMMAND is parsing correctly...
> 
> Here is what I use for validation...
> 
> create jar named "alex.jar"
> 
> I get a NoViableAltException for the TYPE definition
> 
> The grammar file is below...
> 
> 
> //////// alex.g ////////
> 
> grammar alex;
> 
> tokens {
> 	BUILD='build';
> 	FROM='from';
> 	TO='to';
> 	CREATE='create';
> 	NAMED='named';
> }
> 
> COMMAND		:	BUILDCOMMAND CREATECOMMAND;
> 
> BUILDCOMMAND	:	BUILD (SOURCE | DESTINATION)+;
> CREATECOMMAND	:	CREATE TYPE (NAME | SOURCE | DESTINATION)+;
> 
> SOURCE		:	FROM FILE;
> DESTINATION 	:	TO FILE;
> 
> TYPE		:	('jar' | 'war');
> 
> NAME		:	NAMED FILE;
> 
> FILE		:	'"' FILENAME '"';
> FILENAME	: 	('a'..'z'|'A'..'Z'|'0'..'9'|'.')+;
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080917/22c7f454/attachment.html 

From J.Kraaijeveld at Askesis.nl  Thu Sep 18 05:49:56 2008
From: J.Kraaijeveld at Askesis.nl (Joost Kraaijeveld)
Date: Thu, 18 Sep 2008 14:49:56 +0200
Subject: [antlr-interest] Specifying Java package for the Lexer?
Message-ID: <1221742196.7335.13.camel@panoramix.askesis.nl>

Hi ,

Is it possible to specify the Java package (e.g. package
name/of/my/package;) for the Lexer, just as in the @header directive for
the Parser ?

TIA

-- 
Groeten,

Joost Kraaijeveld
Askesis B.V.
Molukkenstraat 14
6524NB Nijmegen
tel: 024-3888063 / 06-51855277
fax: 024-3608416
web: www.askesis.nl


From Dennis.Benzinger at gmx.net  Thu Sep 18 05:57:01 2008
From: Dennis.Benzinger at gmx.net (Dennis Benzinger)
Date: Thu, 18 Sep 2008 14:57:01 +0200
Subject: [antlr-interest] Specifying Java package for the Lexer?
In-Reply-To: <1221742196.7335.13.camel@panoramix.askesis.nl>
References: <1221742196.7335.13.camel@panoramix.askesis.nl>
Message-ID: <48D2501D.6030204@gmx.net>

Am 18.09.2008 14:49, Joost Kraaijeveld schrieb:
> Hi ,
> 
> Is it possible to specify the Java package (e.g. package
> name/of/my/package;) for the Lexer, just as in the @header directive for
> the Parser ?
> 
> TIA
> 

Yes,

@lexer::header {package name.of.my.package;}


HTH,
Dennis Benzinger



From ddewaleffe at gmail.com  Thu Sep 18 07:00:41 2008
From: ddewaleffe at gmail.com (Dominique de Waleffe)
Date: Thu, 18 Sep 2008 16:00:41 +0200
Subject: [antlr-interest] Tree grammars and references to attributes of the
	calling rule
Message-ID: <ec0e752e0809180700j5a304ee5ma0837f4352d59c82@mail.gmail.com>

I am exploring the use of tree grammars...

I exepcted to be able to write something like the following:

tree grammar PipelineWalker;

options {
    language = Java;
    tokenVocab=Pipeline;
    ASTLabelType=CommonTree;
}
@header{
//  import Pipeline;
}
pipeline[Pipeline p]:  ^(PIPE header body) ;

header  : ^('pipeline'  name) {
  System.out.println($pipeline::p.getName());
  $pipeline::p.setName($name.text);}
  ;

Where the intent is to get my 'Pipeline' object from the top level and
modifying it while going down the tree.

The problem is that the references I make to $pipeline::p in my header rule
seem to go untranslated into the generated code:


              System.out.println($pipeline::p.getName());

$pipeline::p.setName((name5!=null?(input.getTokenStream().toString(
              input.getTreeAdaptor().getTokenStartIndex(name5.start),

input.getTreeAdaptor().getTokenStopIndex(name5.start))):null));


Whereas if I write

pipeline[Pipeline p]:  ^(PIPE header[p] body) ;

header[Pipeline p]  : ^('pipeline'  name) {
  System.out.println($p.getName());
  $p.setName($name.text);}
  ;

The translation seems to be better....

So is this a misunderstanding ? Or is this a bug ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/01544419/attachment.html 

From jimi at temporal-wave.com  Thu Sep 18 09:03:32 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 18 Sep 2008 09:03:32 -0700
Subject: [antlr-interest] Tree grammars and references to attributes
	of	the calling rule
In-Reply-To: <ec0e752e0809180700j5a304ee5ma0837f4352d59c82@mail.gmail.com>
References: <ec0e752e0809180700j5a304ee5ma0837f4352d59c82@mail.gmail.com>
Message-ID: <1221753812.8923.230.camel@jimi.temporal-wave.com>

On Thu, 2008-09-18 at 16:00 +0200, Dominique de Waleffe wrote:
> I am exploring the use of tree grammars...
> 
> I exepcted to be able to write something like the following:
> 
> tree grammar PipelineWalker;
> 
> options {
>     language = Java;
>     tokenVocab=Pipeline;
>     ASTLabelType=CommonTree;
> }
> @header{
> //  import Pipeline;
> }
> pipeline[Pipeline p]:  ^(PIPE header body) ;
> 
> header  : ^('pipeline'  name) {
>   System.out.println($pipeline::p.getName());
>   $pipeline::p.setName($name.text);}
>   ;
> 
> Where the intent is to get my 'Pipeline' object from the top level and
> modifying it while going down the tree.
> 
> 
> The problem is that the references I make to $pipeline::p in my header rule seem to go untranslated into the generated code:
> 
> 

You need to use a scope to do this;

pipeline [Pipeline pIn]

scope {
 Pipeline p;
}
@init
{
  $pipeline::p = $pIn;
}

Then make sure that everything starts with the pipeline rule.

However, I think a better way is:

@members {

   protected Pipeline p;
   public void setPipeline(Pipeline p) { this.p = p; }
   public Pipeline getPipeline() { return this.p; }
}

Then just use p directly in your actions code. After you create the tree
parser, call setPipeline(myPipeline) on it; then invoke the walker. I
suggest a better name than just 'p' though ;-)

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/b0c63227/attachment.html 

From parrt at cs.usfca.edu  Thu Sep 18 10:24:33 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 18 Sep 2008 10:24:33 -0700
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48C43110.8060703@gmx.at>
References: <48C3F817.3010305@gmx.at> <48C41C6E.2050305@gmx.at>
	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>
	<48C43110.8060703@gmx.at>
Message-ID: <D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>

Hi gang,Did we ever figure out what's going on here?
Ter
On Sep 7, 2008, at 12:52 PM, Markus Stoeger wrote:

> I tried it with Java 1.6.5 and 1.6.7. I also tried different  
> machines -
> at work, at home and in VMWare.. and I'm using the antlrworks-1.2.jar
> (and antlrworks-1.1.7.jar) as downloaded from the website.
>
> Any further help in locating the problem would be very much  
> appreciated.
> If there's anything I could test, let me know.
>
> Max
>
> Matt Palmer schrieb:
>> Max,
>>
>> it must be something to do with your installation.  It works fine for
>> me.  I'm using Java 1.6.
>>
>> Have you tried re-installing, or using another machine?
>>
>> Regards,
>>
>> Matt P.
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From hjrnunes at student.dei.uc.pt  Thu Sep 18 10:38:21 2008
From: hjrnunes at student.dei.uc.pt (Henrique)
Date: Thu, 18 Sep 2008 18:38:21 +0100
Subject: [antlr-interest] Python target @members problem
In-Reply-To: <36c8729e0809180242o1843db09i3f9e178aa7cb872e@mail.gmail.com>
References: <ac8968760809171931m21016b65hf1bf2cc2a5453360@mail.gmail.com>
	<ac8968760809171935r32d26052q8b8ea7404179ff19@mail.gmail.com>
	<36c8729e0809180242o1843db09i3f9e178aa7cb872e@mail.gmail.com>
Message-ID: <ac8968760809181038j29e32584qc6ed7c3c56c0f703@mail.gmail.com>

Hi!Thanks for your reply Matt!
I've replaced my members section:

members {
names=[];
rule_name = [];
}

by your suggestion:

@lexer::members {
names=[];
rule_name = [];
}

Still, I'm having the same problem... The problem is only with "names". It
all seems fine with "rule_name".. I suppose it's because I initialize it in
rule rule:

rule
@init{
rule_name=[]
print "NEW RULE"
}
@after{
names.append(rule_name);
print "END RULE: " + str(names);
}
: RULE USER_STRING (USER_RATIONAL)? LEFTBRACKET buncha_replacements?
RIGHTBRACKET {rule_name.append($USER_STRING.text);}
;

Any thoughts? Or perhaps I'm doing something wrong?
Thanks,

Henrique Nunes


On Thu, Sep 18, 2008 at 10:42 AM, Matt Palmer <mattpalms at gmail.com> wrote:

> Hi Henrique,
>
> you need to specify:
>
> @lexer::members
>
> as members on its own puts them in the parser, not the lexer.
>
> Matt.
>
> On Thu, Sep 18, 2008 at 3:35 AM, Henrique <hjrnunes at student.dei.uc.pt>wrote:
>
>> Hi everyone!I'm building a parser that should generate python code. The
>> problem is that the variables that I define in the @members section are not
>> recognized in the rules themselves.
>> For instance, I have this:
>>
>> grammar cfdg_py;
>>
>> options{
>> language=Python;
>> }
>>
>> ...
>>
>> @members {
>> names=[]
>> rule_name = []
>> }
>>
>> ...
>>
>> rule
>> @init{
>> rule_name=[]
>> print "NEW RULE"
>> }
>> @after{
>> names.append(rule_name)
>> print "END RULE: " + str(names)
>> }
>> : RULE USER_STRING (USER_RATIONAL)? LEFTBRACKET buncha_replacements?
>> RIGHTBRACKET {rule_name.append($USER_STRING.text);}
>>  ;
>>
>> I get a NameError: global name 'names' is not defined in the first line
>> of the @after section.
>> How do I make sure the variables are defined?
>> I've tried inserting the semicolons as advised in the wiki but it didn't
>> work. The antlr python documentation is really scarce so I can't figure it
>> out.
>> I'm attaching the whole grammar with this. Using ANTLR 3.1 on Windows.
>> Thanks in advance.
>>
>> Henrique Nunes
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/9aeec172/attachment.html 

From mattpalms at gmail.com  Thu Sep 18 11:25:41 2008
From: mattpalms at gmail.com (Matt Palmer)
Date: Thu, 18 Sep 2008 19:25:41 +0100
Subject: [antlr-interest] Python target @members problem
In-Reply-To: <ac8968760809181038j29e32584qc6ed7c3c56c0f703@mail.gmail.com>
References: <ac8968760809171931m21016b65hf1bf2cc2a5453360@mail.gmail.com>
	<ac8968760809171935r32d26052q8b8ea7404179ff19@mail.gmail.com>
	<36c8729e0809180242o1843db09i3f9e178aa7cb872e@mail.gmail.com>
	<ac8968760809181038j29e32584qc6ed7c3c56c0f703@mail.gmail.com>
Message-ID: <36c8729e0809181125m47427c5bydef99d91447bf1ea@mail.gmail.com>

Hi Henrique,

I think I got it wrong!  Your rule is actually a parser rule, not a lexer
rule, so my suggestion won't help at all!

Actually, I think it's because you're using the Python language target.
Unlike Java, you have to use "self":

self.names

or Python won't see it as a member of the class.

Matt



On Thu, Sep 18, 2008 at 6:38 PM, Henrique <hjrnunes at student.dei.uc.pt>wrote:

> Hi!Thanks for your reply Matt!
> I've replaced my members section:
>
> members {
> names=[];
> rule_name = [];
> }
>
> by your suggestion:
>
> @lexer::members {
> names=[];
> rule_name = [];
> }
>
> Still, I'm having the same problem... The problem is only with "names". It
> all seems fine with "rule_name".. I suppose it's because I initialize it in
> rule rule:
>
> rule
> @init{
> rule_name=[]
> print "NEW RULE"
> }
> @after{
> names.append(rule_name);
> print "END RULE: " + str(names);
> }
> : RULE USER_STRING (USER_RATIONAL)? LEFTBRACKET buncha_replacements?
> RIGHTBRACKET {rule_name.append($USER_STRING.text);}
>  ;
>
> Any thoughts? Or perhaps I'm doing something wrong?
> Thanks,
>
> Henrique Nunes
>
>
>
> On Thu, Sep 18, 2008 at 10:42 AM, Matt Palmer <mattpalms at gmail.com> wrote:
>
>> Hi Henrique,
>>
>> you need to specify:
>>
>> @lexer::members
>>
>> as members on its own puts them in the parser, not the lexer.
>>
>> Matt.
>>
>> On Thu, Sep 18, 2008 at 3:35 AM, Henrique <hjrnunes at student.dei.uc.pt>wrote:
>>
>>> Hi everyone!I'm building a parser that should generate python code. The
>>> problem is that the variables that I define in the @members section are not
>>> recognized in the rules themselves.
>>> For instance, I have this:
>>>
>>> grammar cfdg_py;
>>>
>>> options{
>>> language=Python;
>>> }
>>>
>>> ...
>>>
>>> @members {
>>> names=[]
>>> rule_name = []
>>> }
>>>
>>> ...
>>>
>>> rule
>>> @init{
>>> rule_name=[]
>>> print "NEW RULE"
>>> }
>>> @after{
>>> names.append(rule_name)
>>> print "END RULE: " + str(names)
>>> }
>>> : RULE USER_STRING (USER_RATIONAL)? LEFTBRACKET buncha_replacements?
>>> RIGHTBRACKET {rule_name.append($USER_STRING.text);}
>>>  ;
>>>
>>> I get a NameError: global name 'names' is not defined in the first line
>>> of the @after section.
>>> How do I make sure the variables are defined?
>>> I've tried inserting the semicolons as advised in the wiki but it didn't
>>> work. The antlr python documentation is really scarce so I can't figure it
>>> out.
>>> I'm attaching the whole grammar with this. Using ANTLR 3.1 on Windows.
>>> Thanks in advance.
>>>
>>> Henrique Nunes
>>>
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/f806e41f/attachment.html 

From jackgzhang2 at yahoo.com  Thu Sep 18 11:47:42 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Thu, 18 Sep 2008 11:47:42 -0700 (PDT)
Subject: [antlr-interest] White space needed in the parsing.
Message-ID: <397800.24153.qm@web63401.mail.re1.yahoo.com>

I got a question regarding the Antlr Lexer. Basically I would like? 
to do a simple logic query parser. For example,

?(1) The input: Hello AND world OR antlr
? ? The AST: (OR (AND Hello world) antlr)

?This part works fine now. But I would like to match a string (including? 
?white spaces)? Here is the example,

?(1) The input: Hello AND how are you OR world
? ? The Current AST: (AND Hello how) are (OR you world)
? ? I want to achieve: (OR (And Hello how are you) world)


?I would like to match "how are you"? into one WORD, "hello" into? 
?another token.? If I use following rules:

?WORD: .+;

?this will match everything including the "AND" into a WORD.

?Did you have such situation before?

?Attached is the lexer and parser grammer file.

?Thx.

?-Jack.

==== 
grammar Query;

//=== Parser Option ===//
options {
? output = AST;
? k=*;
}



//=== Lexer ===//
OR: 'OR';
AND: 'AND';
NOT: 'NOT';
WORD? : ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
LEFT_PAREN: '(';
RIGHT_PAREN: ')';
WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;


//=== Parser ===//
expr: orexpression*;
?
orexpression
??? :?? andexpression (OR orexpression)*
??? ;

andexpression
??? : notexpression (AND andexpression)*
??? ;

notexpression
??? : (NOT)? atom
??? ;

atom
??? : WORD
??? | LEFT_PAREN! expr RIGHT_PAREN!
??? ;

===





      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/6e240ae5/attachment.html 

From grey_earl at web.de  Thu Sep 18 12:03:25 2008
From: grey_earl at web.de (=?iso-8859-15?Q?Markus_Fr=F6b?=)
Date: Thu, 18 Sep 2008 21:03:25 +0200
Subject: [antlr-interest] White space needed in the parsing.
Message-ID: <308221402@web.de>

> -----Urspr?ngliche Nachricht-----
> Von: jack zhang <jackgzhang2 at yahoo.com>
> Gesendet: 18.09.08 20:48:12
> An: antlr-interest at antlr.org
> Betreff: [antlr-interest] White space needed in the parsing.
> 
> 
> I got a question regarding the Antlr Lexer. Basically I would like 
> to do a simple logic query parser. For example,
> 
>  (1) The input: Hello AND world OR antlr
>  The AST: (OR (AND Hello world) antlr)
> 
>  This part works fine now. But I would like to match a string (
> including 
>  white spaces) Here is the example,
> 
>  (1) The input: Hello AND how are you OR world
>  The Current AST: (AND Hello how) are (OR you world)
>  I want to achieve: (OR (And Hello how are you) world)
> 
> 
>  I would like to match "how are you" into one WORD, "hello" into 
>  another token. If I use following rules:
> 
>  WORD: .+;
> 
>  this will match everything including the "AND" into a WORD.

Now you have the lexer rule WORD accepting all characters, but what you want is to gather multiple words together. This is parser stuff.

> 
>  Did you have such situation before?
> 
>  Attached is the lexer and parser grammer file.
> 
>  Thx.
> 
>  -Jack.
> 
> ==== 
> grammar Query;
> 
> //=== Parser Option ===//
> options {
>  output = AST;
>  k=*;
> }
> 
> 
> 
> //=== Lexer ===//
> OR: 'OR';
> AND: 'AND';
> NOT: 'NOT';
> WORD : ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
> LEFT_PAREN: '(';
> RIGHT_PAREN: ')';
> WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;
> 
> 
> //=== Parser ===//
> expr: orexpression*;
> 
> orexpression
>  : andexpression (OR orexpression)*
>  ;
> 
> andexpression
>  : notexpression (AND andexpression)*
>  ;
> 
> notexpression
>  : (NOT)? atom
>  ;
> 
> atom
>  : WORD
>  | LEFT_PAREN! expr RIGHT_PAREN!
>  ;
> 
> ===

Changing the definition of atom to
atom
  : WORD+
  | LEFT_PAREN! expr RIGHT_PAREN!
 ;
allows atom to match multiple words together, which should work for your problem.

Markus
________________________________________________________________________
"50 erste Dates" mit Adam Sandler u. Drew Barrymore kostenlos anschauen!
Exklusiv f?r alle WEB.DE Nutzer. http://www.blockbuster.web.de


From jimi at temporal-wave.com  Thu Sep 18 12:05:58 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 18 Sep 2008 12:05:58 -0700
Subject: [antlr-interest] White space needed in the parsing.
In-Reply-To: <397800.24153.qm@web63401.mail.re1.yahoo.com>
References: <397800.24153.qm@web63401.mail.re1.yahoo.com>
Message-ID: <1221764758.8923.288.camel@jimi.temporal-wave.com>

Use WORD+ in the parser rules, not the lexer. If you want the
whitespace, reconstruct the input string by doing getStartPosition() on
the first WORD and getEndPosition() on the last word and reconstruct
from the input string.

Jim

On Thu, 2008-09-18 at 11:47 -0700, jack zhang wrote:

> I got a question regarding the Antlr Lexer. Basically I would like  
> to do a simple logic query parser. For example,
> 
>  (1) The input: Hello AND world OR antlr
>     The AST: (OR (AND Hello world) antlr)
> 
>  This part works fine now. But I would like to match a string
> (including  
>  white spaces)  Here is the example,
> 
>  (1) The input: Hello AND how are you OR world
>     The Current AST: (AND Hello how) are (OR you world)
>     I want to achieve: (OR (And Hello how are you) world)
> 
> 
>  I would like to match "how are you"  into one WORD, "hello" into  
>  another token.  If I use following rules:
> 
>  WORD: .+;
> 
> 
>  this will match everything including the "AND" into a WORD.
> 
>  Did you have such situation before?
> 
>  Attached is the lexer and parser grammer file.
> 
>  Thx.
> 
>  -Jack.
> 
> ==== 
> grammar Query;
> 
> //=== Parser Option ===//
> options {
>   output = AST;
>   k=*;
> }
> 
> 
> 
> //=== Lexer ===//
> OR: 'OR';
> AND: 'AND';
> NOT: 'NOT';
> WORD  : ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
> LEFT_PAREN: '(';
> RIGHT_PAREN: ')';
> WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;
> 
> 
> //=== Parser ===//
> expr: orexpression*;
>  
> orexpression
>     :   andexpression (OR orexpression)*
>     ;
> 
> andexpression
>     : notexpression (AND andexpression)*
>     ;
> 
> notexpression
>     : (NOT)? atom
>     ;
> 
> atom
>     : WORD
>     | LEFT_PAREN! expr RIGHT_PAREN!
>     ;
> 
> ===
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/924843dd/attachment.html 

From jackgzhang2 at yahoo.com  Thu Sep 18 13:22:01 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Thu, 18 Sep 2008 13:22:01 -0700 (PDT)
Subject: [antlr-interest] White space needed in the parsing.
Message-ID: <818353.55141.qm@web63408.mail.re1.yahoo.com>

Thanks! it works.? Another question is that (Sorry that I am pretty new
to Antlr) in the tree walker, how to walk the WORD+? parser.

Currently I have following tree walker:


tree grammar QueryTree;


options { 
? // We're going to process an AST whose nodes are of type CommonTree.
? ASTLabelType = CommonTree;

? // We're going to use the tokens defined in
? // both our MathLexer and MathParser grammars.
? // The MathParser grammar already includes
? // the tokens defined in the MathLexer grammar.
? //tokenVocab =QueryParser; // because it contains a token spec.
}

// We want to add some fields and methods to the generated class.
@members {
??? private CommandParser commandParser;

??? public void
 setCommandParser(CommandParser dateParser)
??? {
??????? this.commandParser = commandParser;
??? }
}//members
??? 


orexpression returns [String s] :
??? ^(OR a=expr b=expr) {
??????? s =? "(" + a + " or " + b + ")";
??? };
??? 
andexpression returns [String s] :
??? ^(AND a=expr b=expr) {
??????? s =? "(" + a + " and " + b + ")";
??? };??? 
??? 
notexpression returns [String s] :
??? ^(NOT a=expr) {
???????? s = "(not "? + a + ")";
??? };??? 
??? 
expr returns [String s]
??? : ^(NOT a=expr)
 {
??????? s = "(not "? + a + ")";
??? }
??? |
??? ^(AND a=expr b=expr) {
??????? s = "(" + a + " and " + b + ")";
??? }
??? | ^(OR a=expr b=expr) {
??????? s =? "(" + a + " or " + b + ")";
??? }
??? | WORD {
??????? s = dateParser.parse($WORD.text);
??? }
??? ;

??? 



But it only matches the first word and totally ignored the rest. Is there a way to do this:

WORD+ { for (String WORD :WORD+ { // do something to each WORD} }

Thx !


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/15307986/attachment.html 

From grey_earl at web.de  Thu Sep 18 13:42:43 2008
From: grey_earl at web.de (=?iso-8859-15?Q?Markus_Fr=F6b?=)
Date: Thu, 18 Sep 2008 22:42:43 +0200
Subject: [antlr-interest] White space needed in the parsing.
Message-ID: <308411142@web.de>

> -----Urspr?ngliche Nachricht-----
> Von: "jack zhang" <jackgzhang2 at yahoo.com>
> Gesendet: 18.09.08 22:22:29
> An: antlr-interest at antlr.org
> Betreff: [antlr-interest] White space needed in the parsing.

> 
> 
> Thanks! it works. Another question is that (Sorry that I am pretty 
> new to Antlr) in the tree walker, how to walk the WORD+ parser.
> 
> Currently I have following tree walker:
> 
------------------ CUT ----------------------
> 
> expr returns [String s]
>  : ^(NOT a=expr) {
>  s = "(not " + a + ")";
>  }
>  |
>  ^(AND a=expr b=expr) {
>  s = "(" + a + " and " + b + ")";
>  }
>  | ^(OR a=expr b=expr) {
>  s = "(" + a + " or " + b + ")";
>  }
>  | WORD {
>  s = dateParser.parse($WORD.text);
>  }
>  ;
> 
> 
> 
> 
> 
> But it only matches the first word and totally ignored the rest. Is 
> there a way to do this:
> 
> WORD+ { for (String WORD :WORD+ { // do something to each WORD} }
> 
> Thx !

Your expression matches only one word, as you only specified one. I think the following should work (but I cannot guarantee this, as I haven't worked much with tree parsers yet):

expr returns [String s]:
... and, or, not
 | w=word_expr { s = w; }
 ;

word_expr returns [String s]
 : w=WORD e=word_expr { s = w + e; }
 | { s = ""; }
 ;

This is right recursion as word_expr can match either a word and something following, or nothing at all, which then returns the empty string. Since ANTLR is greedy be default, and I think the tree parsers, too, this should catch all words.
________________________________________________________________________
"50 erste Dates" mit Adam Sandler u. Drew Barrymore kostenlos anschauen!
Exklusiv f?r alle WEB.DE Nutzer. http://www.blockbuster.web.de


From jimi at temporal-wave.com  Thu Sep 18 14:18:54 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 18 Sep 2008 14:18:54 -0700
Subject: [antlr-interest] White space needed in the parsing.
In-Reply-To: <308411142@web.de>
References: <308411142@web.de>
Message-ID: <1221772734.8923.318.camel@jimi.temporal-wave.com>

On Thu, 2008-09-18 at 22:42 +0200, Markus Fr?b wrote:

> > -----Urspr?ngliche Nachricht-----
> > Von: "jack zhang" <jackgzhang2 at yahoo.com>
> > Gesendet: 18.09.08 22:22:29
> > An: antlr-interest at antlr.org
> > Betreff: [antlr-interest] White space needed in the parsing.
> 
> > 
> > 
> > Thanks! it works. Another question is that (Sorry that I am pretty 
> > new to Antlr) in the tree walker, how to walk the WORD+ parser.
> > 
> > Currently I have following tree walker:
> > 
> ------------------ CUT ----------------------
> > 
> > expr returns [String s]
> >  : ^(NOT a=expr) {
> >  s = "(not " + a + ")";
> >  }
> >  |
> >  ^(AND a=expr b=expr) {
> >  s = "(" + a + " and " + b + ")";
> >  }
> >  | ^(OR a=expr b=expr) {
> >  s = "(" + a + " or " + b + ")";
> >  }
> >  | WORD {
> >  s = dateParser.parse($WORD.text);
> >  }
> >  ;
> > 
> > 
> > 
> > 
> > 
> > But it only matches the first word and totally ignored the rest. Is 
> > there a way to do this:
> > 
> > WORD+ { for (String WORD :WORD+ { // do something to each WORD} }
> > 
> > Thx !
> 
> Your expression matches only one word, as you only specified one. I think the following should work (but I cannot guarantee this, as I haven't worked much with tree parsers yet):
> 
> expr returns [String s]:
> ... and, or, not
>  | w=word_expr { s = w; }
>  ;
> 
> word_expr returns [String s]
>  : w=WORD e=word_expr { s = w + e; }
>  | { s = ""; }
>  ;


Its simpler than that (though I don't know what the dateParser call is
for:

| ( WORD {  $s = $s + " " + $WORD.text);  })+

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/d69665b6/attachment.html 

From fyaoxy at gmail.com  Thu Sep 18 14:42:24 2008
From: fyaoxy at gmail.com (=?GB2312?B?z/LRxQ==?=)
Date: Fri, 19 Sep 2008 05:42:24 +0800
Subject: [antlr-interest] White space needed in the parsing.
In-Reply-To: <397800.24153.qm@web63401.mail.re1.yahoo.com>
References: <397800.24153.qm@web63401.mail.re1.yahoo.com>
Message-ID: <91dd9a4f0809181442t6eb45b4yd6bfe78c30295604@mail.gmail.com>

Hi,
If you have AST, you would wanna this in parser:
string		:	( (WORD+)=>WORD+ | SingleQSTRING | DoubleQSTRING)->^(STRING[$text]);

hope this make happy.

From jackgzhang2 at yahoo.com  Thu Sep 18 14:57:35 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Thu, 18 Sep 2008 14:57:35 -0700 (PDT)
Subject: [antlr-interest] White space needed in the parsing.
In-Reply-To: <91dd9a4f0809181442t6eb45b4yd6bfe78c30295604@mail.gmail.com>
Message-ID: <121139.50179.qm@web63406.mail.re1.yahoo.com>

Thx.? In this case, what does => and -> means?
I guess -> means it will will be matched in the TreeWalker's rule : (Something like:)


expr returns [String s]
  : ^(STRING[$text]) {s=$test;}

Is that correct ?
Then what does 
(WORD+)=>WORD+ 

means?

Thx !
--- On Thu, 9/18/08, ?? <fyaoxy at gmail.com> wrote:
From: ?? <fyaoxy at gmail.com>
Subject: Re: [antlr-interest] White space needed in the parsing.
To: jackgzhang2 at yahoo.com
Cc: antlr-interest at antlr.org
Date: Thursday, September 18, 2008, 2:42 PM

Hi,
If you have AST, you would wanna this in parser:
string		:	( (WORD+)=>WORD+ | SingleQSTRING |
DoubleQSTRING)->^(STRING[$text]);

hope this make happy.



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/196c6285/attachment.html 

From grey_earl at web.de  Thu Sep 18 15:05:14 2008
From: grey_earl at web.de (=?iso-8859-15?Q?Markus_Fr=F6b?=)
Date: Fri, 19 Sep 2008 00:05:14 +0200
Subject: [antlr-interest] White space needed in the parsing.
Message-ID: <308519168@web.de>

> -----Urspr?ngliche Nachricht-----
> Von: "jack zhang" <jackgzhang2 at yahoo.com>
> Gesendet: 18.09.08 23:58:03
> An: antlr-interest at antlr.org
> Betreff: Re: [antlr-interest] White space needed in the parsing.

> 
> 
> Thx. In this case, what does => and -> means?
> I guess -> means it will will be matched in the TreeWalker's rule : (
> Something like:)
> 

-> means give the following tree as result of the (parser) rule. So it will be matched in the TreeWalker's rule for a simple lexer-parser-treewalker grammar, right.
=> is a syntactic predicate and means: match the following only if you see this in advance, i.e. (abc) => def means match def only if you see abc. This is useful to resolve ambiguities in a grammar at the cost of slowing down the parsing (read the Definitive ANTLR Handbook on this, it's very well explained there).

> 
> expr returns [String s]
>  : ^(STRING[$text]) {s=$test;}
> 
> Is that correct ?
> Then what does 
> (WORD+)=>WORD+ 
> 
> means?

So this means, if the parser sees some words it should match the words. It is absolutly unnecessary for this grammar, imho, since there are no ambiguities.

> 
> Thx !
> --- On  *Thu, 9/18/08, $B8~2m(B *<fyaoxy at gmail.com> wrote:
> From: $B8~2m(B <fyaoxy at gmail.com>
> Subject: Re: [antlr-interest] White space needed in the parsing.
> To: jackgzhang2 at yahoo.com
> Cc: antlr-interest at antlr.org
> Date: Thursday, September 18, 2008, 2:42 PM
> 
> Hi,
> If you have AST, you would wanna this in parser:
> string : ( (WORD+)=>WORD+ | SingleQSTRING |
> DoubleQSTRING)->^(STRING[$text]);
> 
> hope this make happy.
> 

_________________________________________________________________________
In 5 Schritten zur eigenen Homepage. Jetzt Domain sichern und gestalten! 
Nur 3,99 EUR/Monat! http://www.maildomain.web.de/?mc=021114


From jackgzhang2 at yahoo.com  Thu Sep 18 16:38:14 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Thu, 18 Sep 2008 16:38:14 -0700 (PDT)
Subject: [antlr-interest] White space needed in the parsing.
In-Reply-To: <308519168@web.de>
Message-ID: <628189.7989.qm@web63406.mail.re1.yahoo.com>

Thanks for pointing this out. I am reading 12-1.

--- On Thu, 9/18/08, Markus Fr?b <grey_earl at web.de> wrote:
From: Markus Fr?b <grey_earl at web.de>
Subject: Re: [antlr-interest] White space needed in the parsing.
To: antlr-interest at antlr.org
Date: Thursday, September 18, 2008, 3:05 PM

> -----Urspr?ngliche Nachricht-----
> Von: "jack zhang" <jackgzhang2 at yahoo.com>
> Gesendet: 18.09.08 23:58:03
> An: antlr-interest at antlr.org
> Betreff: Re: [antlr-interest] White space needed in the parsing.

> 
> 
> Thx. In this case, what does => and -> means?
> I guess -> means it will will be matched in the TreeWalker's rule :
(
> Something like:)
> 

-> means give the following tree as result of the (parser) rule. So it will
be matched in the TreeWalker's rule for a simple lexer-parser-treewalker
grammar, right.
=> is a syntactic predicate and means: match the following only if you see
this in advance, i.e. (abc) => def means match def only if you see abc. This
is useful to resolve ambiguities in a grammar at the cost of slowing down the
parsing (read the Definitive ANTLR Handbook on this, it's very well
explained there).

> 
> expr returns [String s]
>  : ^(STRING[$text]) {s=$test;}
> 
> Is that correct ?
> Then what does 
> (WORD+)=>WORD+ 
> 
> means?

So this means, if the parser sees some words it should match the words. It is
absolutly unnecessary for this grammar, imho, since there are no ambiguities.

> 
> Thx !
> --- On  *Thu, 9/18/08, $B8~2m(B *<fyaoxy at gmail.com> wrote:
> From: $B8~2m(B <fyaoxy at gmail.com>
> Subject: Re: [antlr-interest] White space needed in the parsing.
> To: jackgzhang2 at yahoo.com
> Cc: antlr-interest at antlr.org
> Date: Thursday, September 18, 2008, 2:42 PM
> 
> Hi,
> If you have AST, you would wanna this in parser:
> string : ( (WORD+)=>WORD+ | SingleQSTRING |
> DoubleQSTRING)->^(STRING[$text]);
> 
> hope this make happy.
> 

_________________________________________________________________________
In 5 Schritten zur eigenen Homepage. Jetzt Domain sichern und gestalten! 
Nur 3,99 EUR/Monat! http://www.maildomain.web.de/?mc=021114


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address




      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/1bc8dd7b/attachment.html 

From jackgzhang2 at yahoo.com  Thu Sep 18 16:46:23 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Thu, 18 Sep 2008 16:46:23 -0700 (PDT)
Subject: [antlr-interest] Alternative(s) 2 were disabled for that input
Message-ID: <278797.12943.qm@web63406.mail.re1.yahoo.com>

Hi,
? I keep getting following errors:

warning(138): Query.g:0:0: grammar Query: no start rule (no rule can obviously be followed by EOF)
warning(200): Query.g:27:40: Decision can match input such as "OR" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
warning(200): Query.g:31:39: Decision can match input such as "AND" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
warning(200): Query.g:39:7: Decision can match input such as "WORD" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input

? I kind of understand why because if the input is "OR" the parser will just freak out. What I want do is a simple boolean query input validator

(1) valid input:
a OR b
c AND d
a OR b AND d

(2) invalid input:
a AND? 
AND b (This is not working)

What's wrong with the grammer? I really cannot figure it out.

Thanks !




      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/6aa7a900/attachment.html 

From jackgzhang2 at yahoo.com  Thu Sep 18 16:47:51 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Thu, 18 Sep 2008 16:47:51 -0700 (PDT)
Subject: [antlr-interest] Alternative(s) 2 were disabled for that input
Message-ID: <542223.58764.qm@web63402.mail.re1.yahoo.com>

Sorry I forget to attach the grammer. Here it is

grammar Query;

//=== Parser Option ===//
options {
? output = AST;
? k=*;
}




//=== Lexer ===//
OR: 'OR';
AND: 'AND';
NOT: 'NOT';
WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
LEFT_PAREN: '(';
RIGHT_PAREN: ')';
WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;



//=== Parser ===//
expr: orexpression*;
orexpression
?
???? :?? andexpression (OR orexpression)*
??? ;

andexpression
??? : notexpression (AND andexpression)*
??? ;

notexpression
??? : (NOT)? atom
??? ;

atom
??? : WORD+
??? | LEFT_PAREN! expr RIGHT_PAREN!
??? ;









--- On Thu, 9/18/08, jack zhang <jackgzhang2 at yahoo.com> wrote:
From: jack zhang <jackgzhang2 at yahoo.com>
Subject: Alternative(s) 2 were disabled for that input
To: antlr-interest at antlr.org
Date: Thursday, September 18, 2008, 4:46 PM

Hi,
? I keep getting following errors:

warning(138): Query.g:0:0: grammar Query: no start rule (no rule can obviously be followed by EOF)
warning(200): Query.g:27:40: Decision can match input such as "OR" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
warning(200): Query.g:31:39: Decision can match input such as "AND" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
warning(200): Query.g:39:7: Decision can match input such as "WORD" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input

? I kind of understand why because if the input is "OR" the parser will just freak out. What I want do is a simple boolean query input validator

(1) valid input:
a OR b
c AND d
a OR b AND
 d

(2) invalid input:
a AND? 
AND b (This is not working)

What's wrong with the grammer? I really cannot figure it out.

Thanks !




      


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080918/580e149d/attachment.html 

From heinrich at silasvalley.com  Fri Sep 19 01:53:44 2008
From: heinrich at silasvalley.com (Heinrich du Toit)
Date: Fri, 19 Sep 2008 10:53:44 +0200
Subject: [antlr-interest] problem with tree rewrite :(
Message-ID: <48D36898.1080201@silasvalley.com>

Hi

I'm trying to write a C parser that generates a tree from the code for 
specializer pre-processing and diagnostics needs.
I'm new to antlr so be patient please.

I've attached my current grammer file.
It's very similar to the example C.g actually.
The main difference is that I can't load in header files and therefore I 
can't be sure which IDENTIFIERS are type names and which aren't.
In general the idea is not to check syntax. Rather just to accept 
everything that can possibly be correct.
And in the end identify the important things.. functions, expressions, 
statements ect.

Inside I have these rules currently:
-------------------------------
// syntactically this is the same as declaration* I think..
// yet somehow it just doesn't budge like that ?!?!
declarator_list
 
    :( typedef_statement |
      ((decl_specifiers init_declarator_list? ';')=>
        decl_specifiers init_declarator_list? ';' )
     )*;
   
    //: (declaration)*;
   
declaration_normal
    :((decl_specifiers init_declarator_list? ';')=>
        decl_specifiers init_declarator_list? ';'
            -> ^(DECLARATION decl_specifiers init_declarator_list 
';'));       

//note: currnt decl_specifiers1 is a fix for the grammar here :(
// in theory we can throw this out maybe somehow..
// typedef is still a problem
declaration
    : typedef_statement
   
    | ((decl_specifiers init_declarator_list? ';')=>
        decl_specifiers
         init_declarator_list? ';' -> ^(DECLARATION decl_specifiers 
init_declarator_list ';'));   
---------------------------

if I change declarator_list to:
 : (typedef_statement | declaration_normal ) *;

which technically only adds the rewrite rule.. things goes horribly wrong.
When it parses and there is a list like this:
int a;
int b;
int c;
only int c ends up in the tree, all the other declarations simply 
dissappear?



Preferably I want to alter my parser so that it can accept C++ type 
expressions..
Where variables can be declared inside the expression.
But I seem to run into hundreds of problems just trying todo that.
Also my expreience is that ANTLRWorks1.2 is very unstable and becomes 
slow after a while if you give it complex stuff.

I'm also not sure about the whole LL* parsing thing?
Aint the parser suppose to look ahead (branch) on multiple rules if 
unsure and then throw out those that are wrong? (That's what bison/yacc 
did anyways)
Then why do I get warnings saying the input 'IDENTIFIER' can be matched 
on 2 rules and therefore the one is thrown out?
Am I suppose to switch on backtracking for this?
Btw. if you take the C.g example and say "output=AST; ASTLabelType= 
pANTLR3_BASE_TREE;" in options the generated C code doesn't compile for 
me :(

thanks
-H













-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Ctree.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080919/0d1aa0a7/attachment.pl 

From anders43 at gmail.com  Fri Sep 19 02:02:02 2008
From: anders43 at gmail.com (ajk .)
Date: Fri, 19 Sep 2008 17:02:02 +0800
Subject: [antlr-interest] handling /// comments
Message-ID: <614b3f5f0809190202m7b13701dr7f4ca216dfe7f3dd@mail.gmail.com>

Hi

I was wondering if somebody has an idea how to solve the following problem.
Lets see if I can describe the issue in a proper way.

We have a translator that translates a scripting language to C#.

We now need to support ///<summary>.. in C#

By adding the /// in the scripting language we were hoping just to move this
over to C#:

example

/// <summary>
/// some function
/// </summary>
myfunction returns int
begin
   bla();
end

->

C#
 /// <summary>
/// some function
/// </summary>
int myfunction()
{
  bla();
}

So far so good, I would associate the comments to the following function
which is a node in the AST, simple to do a parser rule for this.

But in C# (as well as the scripting language) you can write comments
anywhere in the code in whatever form you want e.g.

/// hello

or

///////////////////////////////////////////
//// this freestanding comment
////////////////////////////////////////////

How do you filter away these things? How do I write a parser rule that
allows comments anywhere in the original code but only move the relevant
ones? i.e. the ones associated with certain elements like functions,
variable declarations etc.

TIA
Anders.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080919/9a90c2fe/attachment.html 

From jack19860509 at hotmail.com  Fri Sep 19 02:19:50 2008
From: jack19860509 at hotmail.com (=?gb2312?B?t73T7rO/?=)
Date: Fri, 19 Sep 2008 17:19:50 +0800
Subject: [antlr-interest] Question about Tree grammar
Message-ID: <BAY118-W29CD1143016D45398A8CACC64E0@phx.gbl>


Hi, Everyone.
  I am new to compiler design. I find Antlr is really a great software. I want to know whether it is possible to do all of the semantic analyze phrase( type checking, type inference, array range check..) in the Antlr's Tree Grammar.
_________________________________________________________________
??????????????????????????
http://im.live.cn/Share/18.htm

From grey_earl at web.de  Fri Sep 19 04:49:22 2008
From: grey_earl at web.de (Markus)
Date: Fri, 19 Sep 2008 13:49:22 +0200
Subject: [antlr-interest] Alternative(s) 2 were disabled for that input
In-Reply-To: <542223.58764.qm@web63402.mail.re1.yahoo.com>
References: <542223.58764.qm@web63402.mail.re1.yahoo.com>
Message-ID: <200809191349.23121.grey_earl@web.de>

----------------------- CUT -------------------
>
> //=== Parser ===//
> expr: orexpression*;
> orexpression
> ?
> ???? :?? andexpression (OR orexpression)*
> ??? ;
>
> andexpression
> ??? : notexpression (AND andexpression)*
> ??? ;
>
> notexpression
> ??? : (NOT)? atom
> ??? ;
>
> atom
> ??? : WORD+
> ??? | LEFT_PAREN! expr RIGHT_PAREN!
> ??? ;
>
> --- On Thu, 9/18/08, jack zhang <jackgzhang2 at yahoo.com> wrote:
> From: jack zhang <jackgzhang2 at yahoo.com>
> Subject: Alternative(s) 2 were disabled for that input
> To: antlr-interest at antlr.org
> Date: Thursday, September 18, 2008, 4:46 PM
>
> Hi,
> ? I keep getting following errors:
>
> warning(138): Query.g:0:0: grammar Query: no start rule (no rule can
> obviously be followed by EOF) warning(200): Query.g:27:40: Decision can
> match input such as "OR" using multiple alternatives: 1, 2 As a result,
> alternative(s) 2 were disabled for that input
> warning(200): Query.g:31:39: Decision can match input such as "AND" using
> multiple alternatives: 1, 2 As a result, alternative(s) 2 were disabled for
> that input
> warning(200): Query.g:39:7: Decision can match input such as "WORD" using
> multiple alternatives: 1, 2 As a result, alternative(s) 2 were disabled for
> that input
>
------------------------- CUT --------------------
The parser complains because it can match a OR b OR c in two ways, one by 
using the kleene star * in or_expression twice and so matching two ORs with 
their corresponding expressions reduced to atoms, and the other one by using 
the kleene star * in or_expression once, and matching b OR c with another 
or_expression. You want to change or_expression (and similar and_expression) 
to
or_expression
 : and_expression (OR and_expression)*
 ;
so it always has to match the kleene star * twice and the parser won't 
complain about this anymore. I know the error messages can be sometimes quite 
confusing, and the best way to deal with this is to make a copy of your 
grammar and remove one rule at a time to see which one really causes the 
error. Then at least you know which rule to fix.

Markus


From helene.chagnot at gmail.com  Fri Sep 19 06:15:23 2008
From: helene.chagnot at gmail.com (=?ISO-8859-1?Q?H=E9l=E8ne_Chagnot?=)
Date: Fri, 19 Sep 2008 15:15:23 +0200
Subject: [antlr-interest] How can I define a token from a directory content ?
Message-ID: <216df3580809190615l4ac5f24bn1086c88af333ed1c@mail.gmail.com>

Hi,

I'm currently using Antlr3 to develop a command line tool.
One of this command consists in executing the content of a command file. The
associated rule will look like this:

execFileRule: EXEC FILENAME;

My problem is that possible values for "FILENAME" can not be given in a
static manner (i.e.: FILENAME: "file1.txt" | "file2.txt" | "file3.txt";), as
they depend on the content of a specific directory at the moment the command
is entered.

How can I manage this ?

Thanks,
Helene
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080919/60b08d76/attachment.html 

From rogermc at iinet.net.au  Fri Sep 19 06:46:03 2008
From: rogermc at iinet.net.au (Roger Mc Murtrie)
Date: Fri, 19 Sep 2008 23:46:03 +1000
Subject: [antlr-interest] antlr-2.7.7 configure failure
Message-ID: <FED76067-AD44-417D-8388-C937413038FA@iinet.net.au>

Intel Mac
Mac OSX 10.5.5
I have been trying to build antlr-2.7.7 but configure fails when  
trying to build action files.
I will appreciate any advice on how to solve this problem.
Regards
Roger

 From config.log:
  $ ./configure --disable-examples --disable-csharp

## --------- ##
## Platform. ##
## --------- ##

hostname = Rogers-imac.local
uname -m = i386
uname -r = 9.5.0
uname -s = Darwin
uname -v = Darwin Kernel Version 9.5.0: Wed Sep  3 11:29:43 PDT 2008;  
root:xnu-1228.7.58~1/RELEASE_I386
.
.
.
config.status:840: creating scripts/antlr-config
config.status:975: WARNING:  scripts/antlr-config.in seems to ignore  
the --datarootdir setting
config.status:840: creating scripts/run-antlr
config.status:975: WARNING:  scripts/run-antlr.in seems to ignore the  
--datarootdir setting
config.status:840: creating scripts/antlr.spec
config.status:840: creating antlr/Makefile
config.status:826: error: cannot find input file: antlr/actions/cpp/ 
ActionLexer.java

From grey_earl at web.de  Fri Sep 19 06:49:12 2008
From: grey_earl at web.de (Markus)
Date: Fri, 19 Sep 2008 15:49:12 +0200
Subject: [antlr-interest] How can I define a token from a directory
	content ?
In-Reply-To: <216df3580809190615l4ac5f24bn1086c88af333ed1c@mail.gmail.com>
References: <216df3580809190615l4ac5f24bn1086c88af333ed1c@mail.gmail.com>
Message-ID: <200809191549.13926.grey_earl@web.de>

> Hi,
>
> I'm currently using Antlr3 to develop a command line tool.
> One of this command consists in executing the content of a command file.
> The associated rule will look like this:
>
> execFileRule: EXEC FILENAME;
>
> My problem is that possible values for "FILENAME" can not be given in a
> static manner (i.e.: FILENAME: "file1.txt" | "file2.txt" | "file3.txt";),
> as they depend on the content of a specific directory at the moment the
> command is entered.
>
> How can I manage this ?
>
> Thanks,
> Helene

You can use a generic IDENTIFIER token and then check with either a predicate 
or in a verification (read: tree grammar) pass that the generic IDENTIFIER 
token corresponds to a real filename.

Markus

From arcadiorubiogarcia at gmail.com  Fri Sep 19 07:41:47 2008
From: arcadiorubiogarcia at gmail.com (=?ISO-8859-1?Q?Arcadio_Rubio_Garc=EDa?=)
Date: Fri, 19 Sep 2008 16:41:47 +0200
Subject: [antlr-interest] Context-sensitive Lexer
Message-ID: <CD5953CD-CD0E-4903-A70D-F30EB72690DD@gmail.com>

Hi everyone,

I've recently migrated to ANTLR from Yacc, and I don't find the way to  
do context-sensitive scanning (lexing) with ANTLR.

Can anyone point how to define an identifier token so that it's not  
recognized when it's adjacent to an integer for instance, 1a is not  
recognized as an integer + identifier?

I used to do this with regular expressions, e.g.:

identifier = /\b[a-zA-Z_][a-zA-Z0-9_]*\b/

Thanks in advance.


- A. Rubio



From jaluber at gmx.de  Fri Sep 19 07:47:55 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 19 Sep 2008 16:47:55 +0200
Subject: [antlr-interest] handling /// comments
In-Reply-To: <614b3f5f0809190202m7b13701dr7f4ca216dfe7f3dd@mail.gmail.com>
References: <614b3f5f0809190202m7b13701dr7f4ca216dfe7f3dd@mail.gmail.com>
Message-ID: <48D3BB9B.6030706@gmx.de>

ajk . schrieb:
> Hi
>  
> I was wondering if somebody has an idea how to solve the following
> problem. Lets see if I can describe the issue in a proper way.
>  
> We have a translator that translates a scripting language to C#.
>  
> We now need to support ///<summary>.. in C#
>  
> By adding the /// in the scripting language we were hoping just to move
> this over to C#:
>  
> example
>  
> /// <summary>
> /// some function
> /// </summary>
> myfunction returns int
> begin
>    bla();
> end
>  
> ->
>  
> C#
> /// <summary>
> /// some function
> /// </summary>
> int myfunction()
> {
>   bla();
> }
>  
> So far so good, I would associate the comments to the following function
> which is a node in the AST, simple to do a parser rule for this.
>  
> But in C# (as well as the scripting language) you can write comments
> anywhere in the code in whatever form you want e.g.
>  
> /// hello
>  
> or
>  
> ///////////////////////////////////////////
> //// this freestanding comment
> ////////////////////////////////////////////
>  
> How do you filter away these things? How do I write a parser rule that
> allows comments anywhere in the original code but only move the relevant
> ones? i.e. the ones associated with certain elements like functions,
> variable declarations etc.
>  
> TIA
> Anders.

There are two possible ways to solve this issue. The first is to add
COMMENT nodes everywhere they may appear. But this reduces the
readability a lot. The other way is to put off the COMMENT tokens
off-channel and to scan in front of matched function definitions for a
COMMENT token yourself.

Johannes

From jaluber at gmx.de  Fri Sep 19 07:50:07 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Fri, 19 Sep 2008 16:50:07 +0200
Subject: [antlr-interest] Question about Tree grammar
In-Reply-To: <BAY118-W29CD1143016D45398A8CACC64E0@phx.gbl>
References: <BAY118-W29CD1143016D45398A8CACC64E0@phx.gbl>
Message-ID: <48D3BC1F.7090709@gmx.de>

??? schrieb:
> Hi, Everyone.
>   I am new to compiler design. I find Antlr is really a great software. I want to know whether it is possible to do all of the semantic analyze phrase( type checking, type inference, array range check..) in the Antlr's Tree Grammar.

It is possible. You may want to transform the tree to resolve
ambiguities for a later phase, too.

Johannes
> _________________________________________________________________
> ??????????????????????????
> http://im.live.cn/Share/18.htm
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From pink at odahoda.de  Fri Sep 19 11:57:56 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Fri, 19 Sep 2008 20:57:56 +0200
Subject: [antlr-interest] Python target @members problem
In-Reply-To: <ac8968760809171935r32d26052q8b8ea7404179ff19@mail.gmail.com>
References: <ac8968760809171931m21016b65hf1bf2cc2a5453360@mail.gmail.com>
	<ac8968760809171935r32d26052q8b8ea7404179ff19@mail.gmail.com>
Message-ID: <543531490809191157k78441a49r78ea8bed10ced2f0@mail.gmail.com>

Hi Henrique,

On Thu, Sep 18, 2008 at 4:35 AM, Henrique <hjrnunes at student.dei.uc.pt> wrote:
> I'm building a parser that should generate python code. The problem is that
> the variables that I define in the @members section are not recognized in
> the rules themselves.
> For instance, I have this:
> grammar cfdg_py;
> options{
> language=Python;
> }
> ...
> @members {
> names=[]
> rule_name = []
> }
> ...
> rule
> @init{
> rule_name=[]
> print "NEW RULE"
> }
> @after{
> names.append(rule_name)
> print "END RULE: " + str(names)
> }
> : RULE USER_STRING (USER_RATIONAL)? LEFTBRACKET buncha_replacements?
> RIGHTBRACKET {rule_name.append($USER_STRING.text);}
> ;
> I get a NameError: global name 'names' is not defined in the first line of
> the @after section.
> How do I make sure the variables are defined?
> I've tried inserting the semicolons as advised in the wiki but it didn't
> work. The antlr python documentation is really scarce so I can't figure it
> out.
> I'm attaching the whole grammar with this. Using ANTLR 3.1 on Windows.

Things are a little bit different in Python than for Java. For
instance attributes you have to use @init, e.g.

@init {
self.name = []
self.rule_name = []
}

And when referencing those, you have to use self.name etc.
@members can be used for class attributes and member functions.

-Ben

From jackgzhang2 at yahoo.com  Fri Sep 19 12:32:54 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Fri, 19 Sep 2008 12:32:54 -0700 (PDT)
Subject: [antlr-interest] Alternative(s) 2 were disabled for that input
In-Reply-To: <200809191349.23121.grey_earl@web.de>
Message-ID: <222488.97727.qm@web63407.mail.re1.yahoo.com>

Thanks. Now the warnings are cleared.? The only issue I had is that for the following invalid inputs, it won't report error. Here is the grammar.? 
1) AND
2) OR
3) AND a
4) OR a

----------------------- CUT -------------------
grammar Query;

//=== Parser Option ===//
options {
  output = AST;
  k=*;
}




//=== Lexer ===//

LEFT_PAREN: '(';
NOT: 'NOT';
AND: 'AND';
OR: 'OR';
WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
RIGHT_PAREN: ')';
WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;



//=== Parser ===//
expr: orexpression*;

orexpression
    :   andexpression (OR andexpression)*
    ;

andexpression
    : notexpression (AND notexpression)*
    ;

notexpression
    : (NOT)? atom
    ;

atom
    : WORD+ 
    | LEFT_PAREN! expr RIGHT_PAREN!
    ;


--------------------------------------








Thanks !


--- On Fri, 9/19/08, Markus <grey_earl at web.de> wrote:
From: Markus <grey_earl at web.de>
Subject: Re: [antlr-interest] Alternative(s) 2 were disabled for that input
To: antlr-interest at antlr.org
Date: Friday, September 19, 2008, 4:49 AM

----------------------- CUT -------------------
>
> //=== Parser ===//
> expr: orexpression*;
> orexpression
> ?
> ???? :?? andexpression (OR orexpression)*
> ??? ;
>
> andexpression
> ??? : notexpression (AND andexpression)*
> ??? ;
>
> notexpression
> ??? : (NOT)? atom
> ??? ;
>
> atom
> ??? : WORD+
> ??? | LEFT_PAREN! expr RIGHT_PAREN!
> ??? ;
>
> --- On Thu, 9/18/08, jack zhang <jackgzhang2 at yahoo.com> wrote:
> From: jack zhang <jackgzhang2 at yahoo.com>
> Subject: Alternative(s) 2 were disabled for that input
> To: antlr-interest at antlr.org
> Date: Thursday, September 18, 2008, 4:46 PM
>
> Hi,
> ? I keep getting following errors:
>
> warning(138): Query.g:0:0: grammar Query: no start rule (no rule can
> obviously be followed by EOF) warning(200): Query.g:27:40: Decision can
> match input such as "OR" using multiple alternatives: 1, 2 As a
result,
> alternative(s) 2 were disabled for that input
> warning(200): Query.g:31:39: Decision can match input such as
"AND" using
> multiple alternatives: 1, 2 As a result, alternative(s) 2 were disabled
for
> that input
> warning(200): Query.g:39:7: Decision can match input such as
"WORD" using
> multiple alternatives: 1, 2 As a result, alternative(s) 2 were disabled
for
> that input
>
------------------------- CUT --------------------
The parser complains because it can match a OR b OR c in two ways, one by 
using the kleene star * in or_expression twice and so matching two ORs with 
their corresponding expressions reduced to atoms, and the other one by using 
the kleene star * in or_expression once, and matching b OR c with another 
or_expression. You want to change or_expression (and similar and_expression) 
to
or_expression
 : and_expression (OR and_expression)*
 ;
so it always has to match the kleene star * twice and the parser won't 
complain about this anymore. I know the error messages can be sometimes quite 
confusing, and the best way to deal with this is to make a copy of your 
grammar and remove one rule at a time to see which one really causes the 
error. Then at least you know which rule to fix.

Markus


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address




      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080919/73d5466d/attachment.html 

From fyaoxy at gmail.com  Fri Sep 19 13:31:29 2008
From: fyaoxy at gmail.com (=?GB2312?B?z/LRxQ==?=)
Date: Sat, 20 Sep 2008 04:31:29 +0800
Subject: [antlr-interest] Alternative(s) 2 were disabled for that input
In-Reply-To: <222488.97727.qm@web63407.mail.re1.yahoo.com>
References: <200809191349.23121.grey_earl@web.de>
	<222488.97727.qm@web63407.mail.re1.yahoo.com>
Message-ID: <91dd9a4f0809191331u2559fd4i490217a327fe639@mail.gmail.com>

Hi,
That invalids should be valids, as atom.
antlr do some greedy at k*.
As you are in AST, maybe you want  employ gunit to test AST output.

Regards.

2008/9/20 jack zhang <jackgzhang2 at yahoo.com>:
> Thanks. Now the warnings are cleared.  The only issue I had is that for the
> following invalid inputs, it won't report error. Here is the grammar.
> 1) AND
> 2) OR
> 3) AND a
> 4) OR a
>
> ----------------------- CUT -------------------
> grammar Query;
>
> //=== Parser Option ===//
> options {
>   output = AST;
>   k=*;
> }
>
>
>
>
> //=== Lexer ===//
>
> LEFT_PAREN: '(';
> NOT: 'NOT';
> AND: 'AND';
> OR: 'OR';
> WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
> RIGHT_PAREN: ')';
> WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;
>
>
>
> //=== Parser ===//
> expr: orexpression*;
>
> orexpression
>     :   andexpression (OR andexpression)*
>     ;
>
> andexpression
>     : notexpression (AND notexpression)*
>     ;
>
> notexpression
>     : (NOT)? atom
>
>  ;
>
> atom
>     : WORD+
>     | LEFT_PAREN! expr RIGHT_PAREN!
>     ;
>
>
> --------------------------------------
>
>
>
>
>
>
>
>
> Thanks !
>
>
> --- On Fri, 9/19/08, Markus <grey_earl at web.de> wrote:
>
> From: Markus <grey_earl at web.de>
> Subject: Re: [antlr-interest] Alternative(s) 2 were disabled for that input
> To: antlr-interest at antlr.org
> Date: Friday, September 19, 2008, 4:49 AM
>
> ----------------------- CUT -------------------
>>
>> //=== Parser ===//
>> expr: orexpression*;
>> orexpression
>>
>>      :   andexpression (OR orexpression)*
>>     ;
>>
>> andexpression
>>     : notexpression (AND andexpression)*
>>     ;
>>
>>
>  notexpression
>>     : (NOT)? atom
>>     ;
>>
>> atom
>>     : WORD+
>>     | LEFT_PAREN! expr RIGHT_PAREN!
>>     ;
>>
>> --- On Thu, 9/18/08, jack zhang <jackgzhang2 at yahoo.com> wrote:
>> From: jack zhang <jackgzhang2 at yahoo.com>
>> Subject: Alternative(s) 2 were disabled for that input
>> To: antlr-interest at antlr.org
>> Date: Thursday, September 18, 2008, 4:46 PM
>>
>> Hi,
>>   I keep getting following errors:
>>
>> warning(138): Query.g:0:0: grammar Query: no start rule (no rule can
>> obviously be followed by EOF) warning(200): Query.g:27:40: Decision can
>> match input such as "OR" using multiple alternatives: 1, 2 As a
> result,
>> alternative(s) 2 were disabled for that input
>> warning(200): Query.g:31:39: Decision can match input such
>  as
> "AND" using
>> multiple alternatives: 1, 2 As a result, alternative(s) 2 were disabled
> for
>> that input
>> warning(200): Query.g:39:7: Decision can match input such as
> "WORD" using
>> multiple alternatives: 1, 2 As a result, alternative(s) 2 were disabled
> for
>> that input
>>
> ------------------------- CUT --------------------
> The parser complains because it can match a OR b OR c in two ways, one by
> using the kleene star * in or_expression twice and so matching two ORs with
> their corresponding expressions reduced to atoms, and the other one by using
> the kleene star * in or_expression once, and matching b OR c with another
> or_expression. You want to change or_expression (and similar and_expression)
> to
> or_expression
>  : and_expression (OR and_expression)*
>  ;
> so it always has to match the kleene star * twice and the parser won't
> complain about this anymore. I know the
>  error messages can be sometimes quite
> confusing, and the best way to deal with this is to make a copy of your
> grammar and remove one rule at a time to see which one really causes the
> error. Then at least you know which rule to fix.
>
> Markus
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>



-- 
??
??

From spamhole at gmx.at  Fri Sep 19 13:36:11 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Fri, 19 Sep 2008 22:36:11 +0200
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>
References: <48C3F817.3010305@gmx.at> <48C41C6E.2050305@gmx.at>
	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>
	<48C43110.8060703@gmx.at>
	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>
Message-ID: <48D40D3B.6010608@gmx.at>

Terence Parr schrieb:
> Hi gang,Did we ever figure out what's going on here?
> Ter

.. well I haven't found a solution yet. I'm still struggling with those 
"ands" in all of my grammars.

I've bought a new notebook yesterday and will try it out on that yet new 
system as soon as possible (probably on sunday).

If there's anything I can look for (debug-wise), please let me know. I 
don't know the internals of antlr well enough yet for debugging it myself.

Max


From hjrnunes at student.dei.uc.pt  Fri Sep 19 13:39:16 2008
From: hjrnunes at student.dei.uc.pt (Henrique)
Date: Fri, 19 Sep 2008 21:39:16 +0100
Subject: [antlr-interest] Python target @members problem
In-Reply-To: <ac8968760809191338gac97ae9ud9a28d30cb84eda9@mail.gmail.com>
References: <ac8968760809171931m21016b65hf1bf2cc2a5453360@mail.gmail.com>
	<ac8968760809171935r32d26052q8b8ea7404179ff19@mail.gmail.com>
	<543531490809191157k78441a49r78ea8bed10ced2f0@mail.gmail.com>
	<ac8968760809191338gac97ae9ud9a28d30cb84eda9@mail.gmail.com>
Message-ID: <ac8968760809191339l64023cccjff6036e9ccb3402e@mail.gmail.com>

Hi everyone!Thanks Matt and Ben! I got it now! I've now finished my parser
and I can move on! Thank you!
Cheers!

Henrique Nunes


On Fri, Sep 19, 2008 at 9:38 PM, Henrique <hjrnunes at gmail.com> wrote:

> Hi everyone!Thanks Matt and Ben! I got it now! I've now finished my parser
> and I can move on! Thank you!
> Cheers!
>
> Henrique Nunes
>
>
>
> On Fri, Sep 19, 2008 at 7:57 PM, Benjamin Niemann <pink at odahoda.de> wrote:
>
>> Hi Henrique,
>>
>> On Thu, Sep 18, 2008 at 4:35 AM, Henrique <hjrnunes at student.dei.uc.pt>
>> wrote:
>> > I'm building a parser that should generate python code. The problem is
>> that
>> > the variables that I define in the @members section are not recognized
>> in
>> > the rules themselves.
>> > For instance, I have this:
>> > grammar cfdg_py;
>> > options{
>> > language=Python;
>> > }
>> > ...
>> > @members {
>> > names=[]
>> > rule_name = []
>> > }
>> > ...
>> > rule
>> > @init{
>> > rule_name=[]
>> > print "NEW RULE"
>> > }
>> > @after{
>> > names.append(rule_name)
>> > print "END RULE: " + str(names)
>> > }
>> > : RULE USER_STRING (USER_RATIONAL)? LEFTBRACKET buncha_replacements?
>> > RIGHTBRACKET {rule_name.append($USER_STRING.text);}
>> > ;
>> > I get a NameError: global name 'names' is not defined in the first line
>> of
>> > the @after section.
>> > How do I make sure the variables are defined?
>> > I've tried inserting the semicolons as advised in the wiki but it didn't
>> > work. The antlr python documentation is really scarce so I can't figure
>> it
>> > out.
>> > I'm attaching the whole grammar with this. Using ANTLR 3.1 on Windows.
>>
>> Things are a little bit different in Python than for Java. For
>> instance attributes you have to use @init, e.g.
>>
>> @init {
>> self.name = []
>> self.rule_name = []
>> }
>>
>> And when referencing those, you have to use self.name etc.
>> @members can be used for class attributes and member functions.
>>
>> -Ben
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080919/00fdd806/attachment.html 

From yotommy at gmail.com  Fri Sep 19 14:22:03 2008
From: yotommy at gmail.com (Tom Smith)
Date: Fri, 19 Sep 2008 17:22:03 -0400
Subject: [antlr-interest] disambiguating semantic predicates
Message-ID: <82dc0d190809191422p57dce6basaf388e78aea3167b@mail.gmail.com>

I am trying to use disambiguating semantic predicates, as I have a
case where "a property of a token must dictate how the parser
interprets it" (to quote The Definitive ANTLR Reference, p. 287).  A
snippet of the grammar looks like:

event
    :
    ^(EVENT T1 messageExp (h=hostcode)?)
    |
    ^(EVENT T2 TIMEOUT (h=hostcode)?)
    |
    ^(EVENT T3 varName (h=hostcode)?)
    ;

T1
    :
    { isTypeT1(((Tree) input.LT(1)).getText()) }?
    varName
    ;

T2
    :
    { isTypeT2(((Tree) input.LT(1)).getText()) }?
    varName
    ;

T3
    :
    { isTypeT3(((Tree) input.LT(1)).getText()) }?
    varName
    ;

varName

From yotommy at gmail.com  Fri Sep 19 14:25:14 2008
From: yotommy at gmail.com (Tom Smith)
Date: Fri, 19 Sep 2008 17:25:14 -0400
Subject: [antlr-interest] disambiguating semantic predicates
Message-ID: <82dc0d190809191425s6cb4463h5087bf15dc239a26@mail.gmail.com>

(Apologies for the earlier incomplete message --- an errant Enter key).

I am trying to use disambiguating semantic predicates, as I have a
case where "a property of a token must dictate how the parser
interprets it" (to quote The Definitive ANTLR Reference, p. 287).  A
snippet of the grammar is shown below.

However when I execute the parser, I get FailedPredicateExceptions.
This doesn't make sense to me, because for proper disambiguation,
some predicates must evaluate to false.

Can someone offer a clue?

Thanks,
Tom Smith.

event
   :
   ^(EVENT T1 varName (h=hostcode)?)
   |
   ^(EVENT T2 TIMEOUT (h=hostcode)?)
   |
   ^(EVENT T3 varName (h=hostcode)?)
   ;

T1
   :
   { isTypeT1(((Tree) input.LT(1)).getText()) }?
   varName
   ;

T2
   :
   { isTypeT2(((Tree) input.LT(1)).getText()) }?
   varName
   ;

T3
   :
   { isTypeT3(((Tree) input.LT(1)).getText()) }?
   varName
   ;

varName
   :
   ID
   ;

From yotommy at gmail.com  Fri Sep 19 14:53:18 2008
From: yotommy at gmail.com (Tom Smith)
Date: Fri, 19 Sep 2008 17:53:18 -0400
Subject: [antlr-interest] disambiguating semantic predicates
In-Reply-To: <82dc0d190809191422p57dce6basaf388e78aea3167b@mail.gmail.com>
References: <82dc0d190809191422p57dce6basaf388e78aea3167b@mail.gmail.com>
Message-ID: <82dc0d190809191453g746237abrfa762ffbab408836@mail.gmail.com>

I believe part of my problem is that the grammar as shown is
not syntatically ambiguous, as a result of some fiddling on my
part.  However when the grammar is syntatically ambiguous,
such as the snippet shown below, I get this error when compiling
the grammars:

ANTLR Parser Generator  Version 3.1b2 (May 20, 2008)  1989-2008
warning(200): grammars/SsipWalker.g:483:5: Decision can match input
such as "EVENT DOWN Identifier NAMED_MSG DOWN Identifier ARGLIST DOWN
POSITIONAL_ARGS DOWN '"' {PACKAGE..']', '\'..'=='} '"' UP NAMED_ARGS
DOWN ASSIGN DOWN Identifier '"' {PACKAGE..']', '\'..'=='} '"' UP UP UP
UP HOSTCODE DOWN HOST UP UP" using multiple alternatives: 1, 3
As a result, alternative(s) 3 were disabled for that input
error(201): grammars/SsipWalker.g:483:5: The following alternatives
can never be matched: 3

event
   :
   ^(EVENT T1 messageExp (h=hostcode)?)
   |
   ^(EVENT T2 TIMEOUT (h=hostcode)?)
   |
   ^(EVENT T3 messageExp (h=hostcode)?)
   ;

T1 : { ... }? varName
T2 : varName
T3 : { ... }? varName

From jimi at temporal-wave.com  Fri Sep 19 16:02:16 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 19 Sep 2008 16:02:16 -0700
Subject: [antlr-interest] disambiguating semantic predicates
In-Reply-To: <82dc0d190809191453g746237abrfa762ffbab408836@mail.gmail.com>
References: <82dc0d190809191422p57dce6basaf388e78aea3167b@mail.gmail.com>
	<82dc0d190809191453g746237abrfa762ffbab408836@mail.gmail.com>
Message-ID: <1221865336.8923.401.camel@jimi.temporal-wave.com>

On Fri, 2008-09-19 at 17:53 -0400, Tom Smith wrote:

> I believe part of my problem is that the grammar as shown is
> not syntatically ambiguous, as a result of some fiddling on my
> part.  However when the grammar is syntatically ambiguous,
> such as the snippet shown below, I get this error when compiling
> the grammars:
> 
> ANTLR Parser Generator  Version 3.1b2 (May 20, 2008)  1989-2008
> warning(200): grammars/SsipWalker.g:483:5: Decision can match input
> such as "EVENT DOWN Identifier NAMED_MSG DOWN Identifier ARGLIST DOWN
> POSITIONAL_ARGS DOWN '"' {PACKAGE..']', '\'..'=='} '"' UP NAMED_ARGS
> DOWN ASSIGN DOWN Identifier '"' {PACKAGE..']', '\'..'=='} '"' UP UP UP
> UP HOSTCODE DOWN HOST UP UP" using multiple alternatives: 1, 3
> As a result, alternative(s) 3 were disabled for that input
> error(201): grammars/SsipWalker.g:483:5: The following alternatives
> can never be matched: 3
> 
> event
>    :
>    ^(EVENT T1 messageExp (h=hostcode)?)
>    |
>    ^(EVENT T2 TIMEOUT (h=hostcode)?)
>    |
>    ^(EVENT T3 messageExp (h=hostcode)?)
>    ;


event: ^( EVENT
                       T1 ...
                     | T2 ...
                     | T3 ...
         );


> 
> T1 : { ... }? varName
> T2 : varName
> T3 : { ... }? varName
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080919/cbf554d1/attachment.html 

From rogermc at iinet.net.au  Fri Sep 19 20:47:09 2008
From: rogermc at iinet.net.au (Roger Mc Murtrie)
Date: Sat, 20 Sep 2008 13:47:09 +1000
Subject: [antlr-interest] antlr-2.7.7 configure failure
In-Reply-To: <FED76067-AD44-417D-8388-C937413038FA@iinet.net.au>
References: <FED76067-AD44-417D-8388-C937413038FA@iinet.net.au>
Message-ID: <15405D5F-C24B-4D52-A177-92D10D7454DE@iinet.net.au>

Problem solved.
I messed up something.
Build worked after deleting antlr directory and starting from scratch.
Regards
Roger


On 19/09/2008, at 11:46 PM, Roger Mc Murtrie wrote:

> Intel Mac
> Mac OSX 10.5.5
> I have been trying to build antlr-2.7.7 but configure fails when  
> trying to build action files.
> I will appreciate any advice on how to solve this problem.
> Regards
> Roger
>
> From config.log:
> $ ./configure --disable-examples --disable-csharp
>
> ## --------- ##
> ## Platform. ##
> ## --------- ##
>
> hostname = Rogers-imac.local
> uname -m = i386
> uname -r = 9.5.0
> uname -s = Darwin
> uname -v = Darwin Kernel Version 9.5.0: Wed Sep  3 11:29:43 PDT  
> 2008; root:xnu-1228.7.58~1/RELEASE_I386
> .
> .
> .
> config.status:840: creating scripts/antlr-config
> config.status:975: WARNING:  scripts/antlr-config.in seems to ignore  
> the --datarootdir setting
> config.status:840: creating scripts/run-antlr
> config.status:975: WARNING:  scripts/run-antlr.in seems to ignore  
> the --datarootdir setting
> config.status:840: creating scripts/antlr.spec
> config.status:840: creating antlr/Makefile
> config.status:826: error: cannot find input file: antlr/actions/cpp/ 
> ActionLexer.java

From antlr at mirality.co.nz  Fri Sep 19 23:03:59 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 20 Sep 2008 18:03:59 +1200
Subject: [antlr-interest] Alternative(s) 2 were disabled for that input
In-Reply-To: <222488.97727.qm@web63407.mail.re1.yahoo.com>
References: <200809191349.23121.grey_earl@web.de>
	<222488.97727.qm@web63407.mail.re1.yahoo.com>
Message-ID: <20080920060410.3441111EC5F@www.antlr.org>

At 07:32 20/09/2008, jack zhang wrote:
>Thanks. Now the warnings are cleared.  The only issue I had is 
>that for the following invalid inputs, it won't report error. 
>Here is the grammar.
>1) AND
>2) OR
>3) AND a
>4) OR a
[...]
>expr: orexpression*;

Your top level rule does not require anything at all to be matched 
("*" is zero-or-more, and if the input isn't a valid orexpression 
then it'll simply match nothing at all and succeed).

If you want to require at least one orexpression to be present, 
change the * to a +.  If you want to additionally ensure that the 
entire input is consumed (or produce an error if not), add EOF to 
the end of the rule.  For example:

expr : orexpression+ EOF;



From antlr at mirality.co.nz  Fri Sep 19 23:09:11 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 20 Sep 2008 18:09:11 +1200
Subject: [antlr-interest] disambiguating semantic predicates
In-Reply-To: <1221865336.8923.401.camel@jimi.temporal-wave.com>
References: <82dc0d190809191422p57dce6basaf388e78aea3167b@mail.gmail.com>
	<82dc0d190809191453g746237abrfa762ffbab408836@mail.gmail.com>
	<1221865336.8923.401.camel@jimi.temporal-wave.com>
Message-ID: <20080920060919.CA4B611ECD6@www.antlr.org>

At 11:02 20/09/2008, Jim Idle wrote:
>event: ^( EVENT
>                        T1 ...
>                      | T2 ...
>                      | T3 ...
>          );

I'm pretty sure you'll also need an extra set of parentheses 
there:

event : ^( EVENT
            ( T1 ...
            | T2 ...
            | T3 ...
            )
         );

Or alternatively a subrule:

event : ^( EVENT eventdetails );

eventdetails
     : T1 ...
     | T2 ...
     | T3 ...
     ;


From vitaka at gmail.com  Sat Sep 20 09:06:21 2008
From: vitaka at gmail.com (=?ISO-8859-1?Q?V=EDctor_Manuel_S=E1nchez_Cartagena?=)
Date: Sat, 20 Sep 2008 18:06:21 +0200
Subject: [antlr-interest] ANTLRArbol: A parse tree generator
Message-ID: <e77e34270809200906s3dd280f2q3917387d40faff1@mail.gmail.com>

I've written a software that generates parse trees with information about
attributes and relationship between them. It only works with Java, ANTLR
grammars.
I've just finished a degree in Information Techonology, and it's my
dissertation. It has a GPL license.

Here you can find more information and download it:

http://code.google.com/p/antlrarbol
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080920/f729c007/attachment.html 

From vasanthi.ak at gmail.com  Sat Sep 20 10:31:26 2008
From: vasanthi.ak at gmail.com (vasanthi a)
Date: Sat, 20 Sep 2008 23:01:26 +0530
Subject: [antlr-interest] Pls provide Antlr Grammar for flash Script
Message-ID: <307cfdc90809201031t69cd980frdd1e13dacf568ed6@mail.gmail.com>

Hi

Can anyone provide me grammar for flashscript. I need to write grammar for
flashscript.
Please provide me this.

Thanks and Regards
Vasanthi A
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080920/8cce38b6/attachment.html 

From asoka250 at gmail.com  Sat Sep 20 10:38:36 2008
From: asoka250 at gmail.com (ASHOK REDDY)
Date: Sat, 20 Sep 2008 12:38:36 -0500
Subject: [antlr-interest] Pls provide Antlr Grammar for flash Script
In-Reply-To: <307cfdc90809201031t69cd980frdd1e13dacf568ed6@mail.gmail.com>
References: <307cfdc90809201031t69cd980frdd1e13dacf568ed6@mail.gmail.com>
Message-ID: <7b0a1e4b0809201038i3af379dci14e8a34403cfd40c@mail.gmail.com>

Hi,

You can do a search for the grammar here http://antlr.org/grammar/list. If
it's not listed, u might need to write it on your own. I guess the list can
help you in case of any issues while writing the grammar rather than
requesting the whole grammar from scratch.

On Sat, Sep 20, 2008 at 12:31 PM, vasanthi a <vasanthi.ak at gmail.com> wrote:

> Hi
>
> Can anyone provide me grammar for flashscript. I need to write grammar for
> flashscript.
> Please provide me this.
>
> Thanks and Regards
> Vasanthi A
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>


-- 
Regards,
Ashok R Varikuti
Graduate Research Assistant
CIS Dept, Kansas State University
785-304-2401
ashokv at ksu.edu
(http://www.cis.ksu.edu/~ashokv)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080920/12ba08d6/attachment.html 

From anders43 at gmail.com  Sat Sep 20 21:38:32 2008
From: anders43 at gmail.com (ajk .)
Date: Sun, 21 Sep 2008 12:38:32 +0800
Subject: [antlr-interest] handling /// comments
In-Reply-To: <48D3BB9B.6030706@gmx.de>
References: <614b3f5f0809190202m7b13701dr7f4ca216dfe7f3dd@mail.gmail.com>
	<48D3BB9B.6030706@gmx.de>
Message-ID: <614b3f5f0809202138r76f56e0u26a14ee483adc787@mail.gmail.com>

On Fri, Sep 19, 2008 at 10:47 PM, Johannes Luber <jaluber at gmx.de> wrote:

> ajk . schrieb:
> > Hi
> >
> > I was wondering if somebody has an idea how to solve the following
> > problem. Lets see if I can describe the issue in a proper way.
> >
> > We have a translator that translates a scripting language to C#.
> >
> > We now need to support ///<summary>.. in C#
> >
> > By adding the /// in the scripting language we were hoping just to move
> > this over to C#:
> >
> > example
> >
> > /// <summary>
> > /// some function
> > /// </summary>
> > myfunction returns int
> > begin
> >    bla();
> > end
> >
> > ->
> >
> > C#
> > /// <summary>
> > /// some function
> > /// </summary>
> > int myfunction()
> > {
> >   bla();
> > }
> >
> > So far so good, I would associate the comments to the following function
> > which is a node in the AST, simple to do a parser rule for this.
> >
> > But in C# (as well as the scripting language) you can write comments
> > anywhere in the code in whatever form you want e.g.
> >
> > /// hello
> >
> > or
> >
> > ///////////////////////////////////////////
> > //// this freestanding comment
> > ////////////////////////////////////////////
> >
> > How do you filter away these things? How do I write a parser rule that
> > allows comments anywhere in the original code but only move the relevant
> > ones? i.e. the ones associated with certain elements like functions,
> > variable declarations etc.
> >
> > TIA
> > Anders.
>
> There are two possible ways to solve this issue. The first is to add
> COMMENT nodes everywhere they may appear. But this reduces the
> readability a lot. The other way is to put off the COMMENT tokens
> off-channel and to scan in front of matched function definitions for a
> COMMENT token yourself.
>
> Johannes
>


The latter method sounds better, our language is very large so the less
changes to the grammar the better. In v2 (which I am not familiar with) how
to set tokens to come into the hidden channel? In v3 you just write
$Channel=HIDDEN right?

thanks
Anders.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080921/febc5bbe/attachment.html 

From yatr.main at gmail.com  Sat Sep 20 22:00:43 2008
From: yatr.main at gmail.com (Yet ANOTHER Test Runner)
Date: Sun, 21 Sep 2008 13:00:43 +0800
Subject: [antlr-interest] How can I insert a Token in the token stream?
Message-ID: <3c95ffd20809202200y7fd1d998t87cbd5fa9a67bb00@mail.gmail.com>

Sorry for my poor English :(

Many computer languages like TTCN3, allows near '}' token or at the last
statement inside block statement omit ';' token correctly, like this:

if(xx){

    const integer i:=1;    //error if missing ';'

    const integer i2:=2  //ok! even though missing ';'

}

How can I insert a token ';' in the TokenStream if it is omitted.

e.g.:

if(xx) { } /* Don't insert ';' here */ else{} /* Insert ';' here */

if(yy) {} /* insert a ';' here*/

if(zz) { const integer i1:=5; const integer i2:=6 }

Like this:

if(xx) {} else {};

if(yy) {};

if(zz) { const integer i1:=5; const integer i2:=6; } ;

Thank you!!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080921/97ad2d54/attachment.html 

From spamhole at gmx.at  Sun Sep 21 00:07:07 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Sun, 21 Sep 2008 09:07:07 +0200
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48D40D3B.6010608@gmx.at>
References: <48C3F817.3010305@gmx.at>
	<48C41C6E.2050305@gmx.at>	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>	<48C43110.8060703@gmx.at>	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>
	<48D40D3B.6010608@gmx.at>
Message-ID: <48D5F29B.4080203@gmx.at>

Markus Stoeger schrieb:
> Terence Parr schrieb:
>   
>> Hi gang,Did we ever figure out what's going on here?
>> Ter
>>     
> I've bought a new notebook yesterday and will try it out on that yet new 
> system as soon as possible (probably on sunday).
>   
I've tried it out right now and it works on the new system! I just 
compiled the simple grammar that I have posted before (with the x+y) and 
all symbols are displayed correctly in the debugger's parse tree view now.

But I still don't understand why it doesn't work on the old system, on 
the system at work and on the VMWare system.

One difference between the systems is XP and Vista. I'm running XP 
(multilang) on all systems where it displays those "ands". Java versions 
are identical (1.6.7).

Max


From jaluber at gmx.de  Sun Sep 21 03:56:43 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sun, 21 Sep 2008 12:56:43 +0200
Subject: [antlr-interest] handling /// comments
In-Reply-To: <614b3f5f0809202138r76f56e0u26a14ee483adc787@mail.gmail.com>
References: <614b3f5f0809190202m7b13701dr7f4ca216dfe7f3dd@mail.gmail.com>	
	<48D3BB9B.6030706@gmx.de>
	<614b3f5f0809202138r76f56e0u26a14ee483adc787@mail.gmail.com>
Message-ID: <48D6286B.3010208@gmx.de>

ajk . schrieb:
> 
> 
> On Fri, Sep 19, 2008 at 10:47 PM, Johannes Luber <jaluber at gmx.de
> <mailto:jaluber at gmx.de>> wrote:
> 
>     ajk . schrieb:
>     > Hi
>     >
>     > I was wondering if somebody has an idea how to solve the following
>     > problem. Lets see if I can describe the issue in a proper way.
>     >
>     > We have a translator that translates a scripting language to C#.
>     >
>     > We now need to support ///<summary>.. in C#
>     >
>     > By adding the /// in the scripting language we were hoping just to
>     move
>     > this over to C#:
>     >
>     > example
>     >
>     > /// <summary>
>     > /// some function
>     > /// </summary>
>     > myfunction returns int
>     > begin
>     >    bla();
>     > end
>     >
>     > ->
>     >
>     > C#
>     > /// <summary>
>     > /// some function
>     > /// </summary>
>     > int myfunction()
>     > {
>     >   bla();
>     > }
>     >
>     > So far so good, I would associate the comments to the following
>     function
>     > which is a node in the AST, simple to do a parser rule for this.
>     >
>     > But in C# (as well as the scripting language) you can write comments
>     > anywhere in the code in whatever form you want e.g.
>     >
>     > /// hello
>     >
>     > or
>     >
>     > ///////////////////////////////////////////
>     > //// this freestanding comment
>     > ////////////////////////////////////////////
>     >
>     > How do you filter away these things? How do I write a parser rule that
>     > allows comments anywhere in the original code but only move the
>     relevant
>     > ones? i.e. the ones associated with certain elements like functions,
>     > variable declarations etc.
>     >
>     > TIA
>     > Anders.
> 
>     There are two possible ways to solve this issue. The first is to add
>     COMMENT nodes everywhere they may appear. But this reduces the
>     readability a lot. The other way is to put off the COMMENT tokens
>     off-channel and to scan in front of matched function definitions for a
>     COMMENT token yourself.
> 
>     Johannes
> 
> 
> 
> The latter method sounds better, our language is very large so the less
> changes to the grammar the better. In v2 (which I am not familiar with)
> how to set tokens to come into the hidden channel? In v3 you just write
> $Channel=HIDDEN right?

Are you using v2? I haven't used it myself, too, so I can't help you
there. In v3 one uses "{$channel=HIDDEN;}", but theoretically one can
use other values, which is useful to distinguish between comments and
other whitespace.

Johannes
> 
> thanks
> Anders.


From toddobryan at gmail.com  Sun Sep 21 05:56:32 2008
From: toddobryan at gmail.com (Todd O'Bryan)
Date: Sun, 21 Sep 2008 08:56:32 -0400
Subject: [antlr-interest] Test lexer with gUnit
Message-ID: <904774730809210556p9973130g62a9b3e32b196988@mail.gmail.com>

Is there any way to test lexical rules with gUnit? It seems that the only
rules you can test are parser rules, but I may be missing something.

Todd
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080921/5361954f/attachment.html 

From blake.friedman at gmail.com  Sun Sep 21 07:07:52 2008
From: blake.friedman at gmail.com (Blake Friedman)
Date: Sun, 21 Sep 2008 16:07:52 +0200
Subject: [antlr-interest] Rewrite rules from alternative tokens, how?
Message-ID: <da7b62e90809210707n33b8321cn657c6c0a6006edf0@mail.gmail.com>

Hi,

I've run into problems trying to do something like this:

options {PREFIX;}

prefix : a=('-' | '+') prefix -> ^(PREFIX $a prefix)
          | int
          ;
int : '0'..'9'+

To generate trees such as:

(FACTOR  - (FACTOR - 12))

Which is to say, how do I identify which token was selected and add it
to my rewrite rule?

At the moment I've identified two workarounds:

prefix : '-' prefix -> ^(PREFIX '-' prefix)
          | '+' prefix -> ^(PREFIX '+' prefix)
          | int
          ;

and

prefix : umOK prefix -> ^(PREFIX umok prefix)
          | int
          ;
umOK : ('-'|'+') ;

The first isn't great, and the second is OK (but I'm not wild about
it).  I've been scratching around on the online documentation and
Terence's book, but I'm a little overwhelmed :).

Thanks
-Blake

P.S. Apologies for the cryptic subject, wasn't all that sure how to
describe the problem.

From jaluber at gmx.de  Sun Sep 21 07:25:57 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Sun, 21 Sep 2008 16:25:57 +0200
Subject: [antlr-interest] Rewrite rules from alternative tokens, how?
In-Reply-To: <da7b62e90809210707n33b8321cn657c6c0a6006edf0@mail.gmail.com>
References: <da7b62e90809210707n33b8321cn657c6c0a6006edf0@mail.gmail.com>
Message-ID: <48D65975.4020208@gmx.de>

Blake Friedman schrieb:
> Hi,
> 
> I've run into problems trying to do something like this:
> 
> options {PREFIX;}
> 
> prefix : a=('-' | '+') prefix -> ^(PREFIX $a prefix)
>           | int
>           ;
> int : '0'..'9'+
> 
> To generate trees such as:
> 
> (FACTOR  - (FACTOR - 12))
> 
> Which is to say, how do I identify which token was selected and add it
> to my rewrite rule?
> 
> At the moment I've identified two workarounds:
> 
> prefix : '-' prefix -> ^(PREFIX '-' prefix)
>           | '+' prefix -> ^(PREFIX '+' prefix)
>           | int
>           ;
> 
> and
> 
> prefix : umOK prefix -> ^(PREFIX umok prefix)
>           | int
>           ;
> umOK : ('-'|'+') ;
> 
> The first isn't great, and the second is OK (but I'm not wild about
> it).  I've been scratching around on the online documentation and
> Terence's book, but I'm a little overwhelmed :).

The original version doesn't work because of a bug. You also managed to
determine the alternatives, so I don't know what to add here.

Johannes
> 
> Thanks
> -Blake
> 
> P.S. Apologies for the cryptic subject, wasn't all that sure how to
> describe the problem.
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From leon.antlr at mac.com  Sun Sep 21 10:39:21 2008
From: leon.antlr at mac.com (Leon Su)
Date: Sun, 21 Sep 2008 10:39:21 -0700
Subject: [antlr-interest] Test lexer with gUnit
In-Reply-To: <904774730809210556p9973130g62a9b3e32b196988@mail.gmail.com>
References: <904774730809210556p9973130g62a9b3e32b196988@mail.gmail.com>
Message-ID: <9B9A6D2A-DE12-4CFF-A1C1-FB228C67A43F@mac.com>

Hi Todd,

gUnit currently is not able to test lexical rules individually. So if  
you would like to test some lexical rules only, you may need to add  
some new parser rules which only define corresponding lexical rules  
for testing. For example, there're two lexical rules: ID and INT.
then you may have the parser rules for testing lexical rules as below:
test_id:	ID;
test_int: INT;

Leon

On Sep 21, 2008, at 5:56 AM, Todd O'Bryan wrote:

> Is there any way to test lexical rules with gUnit? It seems that  
> the only rules you can test are parser rules, but I may be missing  
> something.
>
> Todd
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr- 
> interest/your-email-address
>


From pink at odahoda.de  Sun Sep 21 13:04:22 2008
From: pink at odahoda.de (Benjamin Niemann)
Date: Sun, 21 Sep 2008 22:04:22 +0200
Subject: [antlr-interest] PyStringTemplate 3.2b1 released
Message-ID: <543531490809211304x706594bcg8036b10cfb8d02ab@mail.gmail.com>

Hi Ho!

I just finished fixing the most obvious stuff for PyST and will
hopefully be able to declare it final soon.
Most significant change (beyond the changes that I cloned from the
Java version) is that PyST should now work much better with unicode.

Download it directly from the repository (and soon from www.stringtemplate.org):
http://fisheye2.atlassian.com/browse/~raw,r=5277/stringtemplate/python/release/PyStringTemplate-3.2b1/dist/stringtemplate3-3.2b1.tar.gz

Ter is already working on 3.3, so get it before it gets obsolete ;)

-Ben

Ter: can you put the file up on www.stringtemplate.org? Thanks.

From jackgzhang2 at yahoo.com  Sun Sep 21 13:43:35 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Sun, 21 Sep 2008 13:43:35 -0700 (PDT)
Subject: [antlr-interest] Alternative(s) 2 were disabled for that input
Message-ID: <842955.85648.qm@web63408.mail.re1.yahoo.com>

Thanks. That explains it.


--- On Fri, 9/19/08, Gavin Lambert <antlr at mirality.co.nz> wrote:
From: Gavin Lambert <antlr at mirality.co.nz>
Subject: Re: [antlr-interest] Alternative(s) 2 were disabled for that  input
To: jackgzhang2 at yahoo.com, antlr-interest at antlr.org
Date: Friday, September 19, 2008, 11:03 PM

At 07:32 20/09/2008, jack zhang wrote:
>Thanks. Now the warnings are cleared.  The only issue I had is 
>that for the following invalid inputs, it won't report error. 
>Here is the grammar.
>1) AND
>2) OR
>3) AND a
>4) OR a
[...]
>expr: orexpression*;

Your top level rule does not require anything at all to be matched 
("*" is zero-or-more, and if the input isn't a valid orexpression

then it'll simply match nothing at all and succeed).

If you want to require at least one orexpression to be present, 
change the * to a +.  If you want to additionally ensure that the 
entire input is consumed (or produce an error if not), add EOF to 
the end of the rule.  For example:

expr : orexpression+ EOF;





      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080921/4dbbdca3/attachment.html 

From jimi at temporal-wave.com  Sun Sep 21 14:10:12 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 21 Sep 2008 14:10:12 -0700
Subject: [antlr-interest] How can I insert a Token in the token stream?
In-Reply-To: <3c95ffd20809202200y7fd1d998t87cbd5fa9a67bb00@mail.gmail.com>
References: <3c95ffd20809202200y7fd1d998t87cbd5fa9a67bb00@mail.gmail.com>
Message-ID: <1222031412.12946.10.camel@jimi.temporal-wave.com>

On Sun, 2008-09-21 at 13:00 +0800, Yet ANOTHER Test Runner wrote:
> Sorry for my poor English :(
> 
> Many computer languages like TTCN3, allows near '}' token or at the
> last statement inside block statement omit ';' token correctly, like
> this:
> 
> if(xx){
> 
>     const integer i:=1;    //error if missing ';'
> 
>     const integer i2:=2  //ok! even though missing ';'
> 
> }
> 
> How can I insert a token ';' in the TokenStream if it is omitted.


Don't do it that way as you have to override the nextToken() method and
make it produce multiple tokens, as well as the fact that you will hide
the logic away too much.

The JavaFX language allows that too (though I think it is a pointless
idea myself). The best thing is to create an empty rule that decides
whether it should throw an error or not, though this does mean that you
have to construct your grammar such that it is not ambiguous in the
absence of a SEMI token specified as terminator for a statement. That is
easy enough, though you still need the SEMI to disambiguate
statements/expressions.

// -------------------------
// Decides whether a SEMI is required at this point in the parse (and
issues
// an error if it is and is not present)
//
possiblyOptSemi
	: 	
			{
				// Call super class function to decide whether to look for
				// the SEMI or not and whether to log an error if one is 
				// missing.
				//
				checkForSemi();
			}
	;


Then:

 /**
     * Examines the token stream to see if we require a SEMI
     * token to terminate the previous statement, or we do not.
     * 
     * The rules for deciding wheter a SEMI is required here or
     * not are reasonably straight forward:
     * 
     * 1) If the next token is a '}' then we do not required a SEMI
     *    as the last statement of a block does not need to terminate
     *    with a SEMI;
     * 
     * 2) If the next token is EOF then we do not require a SEMI as
     *    the last statement of the script does not require termination;
     * 
     * 3) If the previous token was a '}' then we do not require a SEMI
     *    as brace blocks do not require termination ever.
     * 
     * 4) If the previous token was itself a SEMI then we assume that
     *    the prior statement was terminated correctly.
     * 
     * 5) If the next token is ELSE, then the prior single statement
     *    of a then clause does not require a SEMI.
     *    For instance if (x) a else b;
     * 
     * Note that we always consume a SEMI colon here if there is one
     * as there is never any harm in having too many SEMIs.
     * 
     * @param contextMessage Message context to use when reporting that a required SEMI is missing
     */
    protected void checkForSemi()
    {
         
        Token nextTok       = input.LT(1);
        int   nextTokType  = nextTok.getType();
        
        // If there is a SEMI colon next anyway, then we just eat it
        //
        if  (nextTokType == v4Parser.SEMI) {
            // Just consume it and return then
            //
            input.consume();
            return;
        }
        
        // Ignore if next token is something that relaxes the rules
        //
        if  (      nextTokType == v4Parser.RBRACE 
                || nextTokType == Token.EOF
                || nextTokType == v4Parser.ELSE
                || nextTokType == v4Parser.RBRACE_LBRACE_STRING_LITERAL
                || nextTokType == v4Parser.RBRACE_QUOTE_STRING_LITERAL
            ) {
            
            // The SEMI was optional anyway so just return
            //
            return;
        }
        
        // Now we need to know the previous on channel token
        //
        Token prevToken = input.LT(-1);
        
        if  (      prevToken.getType() == v4Parser.RBRACE
                || prevToken.getType() == v4Parser.SEMI
            )
        {
            // We don't require a SEMI after a '}' or after a prior SEMI
            //
            return;
        }

        // OK, having got here, we must require a SEMI and it is missing
        // so issue the error.
        //
        log.error(semiPos(), MsgSym.MESSAGE_JAVAFX_SEMI_REQUIRED);
                 
    }




> 
> 
> e.g.:
> 
> 
>         if(xx) { } /* Don't insert ';' here */ else{} /* Insert ';'
>         here */
>         
>         if(yy) {} /* insert a ';' here*/
>         
>         if(zz) { const integer i1:=5; const integer i2:=6 }
>         
>         Like this:
>         
>         if(xx) {} else {};
>         
>         if(yy) {};
>         
>         if(zz) { const integer i1:=5; const integer i2:=6; } ;
>         
> 
> 
> Thank you!!!
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080921/85759aba/attachment.html 

From jimi at temporal-wave.com  Sun Sep 21 14:13:17 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 21 Sep 2008 14:13:17 -0700
Subject: [antlr-interest] Rewrite rules from alternative tokens, how?
In-Reply-To: <da7b62e90809210707n33b8321cn657c6c0a6006edf0@mail.gmail.com>
References: <da7b62e90809210707n33b8321cn657c6c0a6006edf0@mail.gmail.com>
Message-ID: <1222031597.12946.13.camel@jimi.temporal-wave.com>

On Sun, 2008-09-21 at 16:07 +0200, Blake Friedman wrote:

> Hi,
> 
> I've run into problems trying to do something like this:
> 
> options {PREFIX;}
> 
> prefix : a=('-' | '+') prefix -> ^(PREFIX $a prefix)


As these are both tokens (I would push literals in to the lexer if I
were you, but):

prefix : (a='-' | a ='+) .....

should work I think.


Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080921/81969cb7/attachment.html 

From rschulz at sonic.net  Sun Sep 21 14:44:13 2008
From: rschulz at sonic.net (Randall R Schulz)
Date: Sun, 21 Sep 2008 14:44:13 -0700
Subject: [antlr-interest] How can I insert a Token in the token stream?
In-Reply-To: <3c95ffd20809202200y7fd1d998t87cbd5fa9a67bb00@mail.gmail.com>
References: <3c95ffd20809202200y7fd1d998t87cbd5fa9a67bb00@mail.gmail.com>
Message-ID: <200809211444.13322.rschulz@sonic.net>

On Saturday 20 September 2008 22:00, Yet ANOTHER Test Runner wrote:
> Sorry for my poor English :(
>
> Many computer languages like TTCN3, allows near '}' token or at the
> last statement inside block statement omit ';' token correctly, like
> this:
>
> if(xx){
>
>     const integer i:=1;    //error if missing ';'
>
>     const integer i2:=2  //ok! even though missing ';'
>
> }
>
> How can I insert a token ';' in the TokenStream if it is omitted.

Why conceptualize it as inserting a semicolon? Why not conceptualize it 
as the semicolon being a _separator_, not a _terminator_ and write the 
syntax rules accordingly?

E.g., compare these:

/* All statements are terminated by a semicolon */
BlockBody: ( Statement ';' ) *

vs.:

/* Statements are separated by a semicolon */
BlockBody: ( Statement ( ';' Statement ) * ) ?


> ...


Randall Schulz

From rschulz at sonic.net  Sun Sep 21 14:48:46 2008
From: rschulz at sonic.net (Randall R Schulz)
Date: Sun, 21 Sep 2008 14:48:46 -0700
Subject: [antlr-interest] How can I insert a Token in the token stream?
In-Reply-To: <200809211444.13322.rschulz@sonic.net>
References: <3c95ffd20809202200y7fd1d998t87cbd5fa9a67bb00@mail.gmail.com>
	<200809211444.13322.rschulz@sonic.net>
Message-ID: <200809211448.46950.rschulz@sonic.net>

On Sunday 21 September 2008 14:44, Randall R Schulz wrote:
> On Saturday 20 September 2008 22:00, Yet ANOTHER Test Runner wrote:
> > ...
> >
> > How can I insert a token ';' in the TokenStream if it is omitted.
>
> Why conceptualize it as inserting a semicolon? Why not conceptualize
> it as the semicolon being a _separator_, not a _terminator_ and write
> the syntax rules accordingly?
>
> E.g., compare these:
>
> /* All statements are terminated by a semicolon */
> BlockBody: ( Statement ';' ) *
>
> vs.:
>
> /* Statements are separated by a semicolon */
> BlockBody: ( Statement ( ';' Statement ) * ) ?

NOTE: I should not have used upper-case letters for these rules, since 
that's for lexer rules. I should be:


/* All statements are terminated by a semicolon */
blockBody: ( statement ';' ) *

vs.:

/* Statements are separated by a semicolon */
blockBody: ( statement ( ';' statement ) * ) ?


Randall Schulz

From o.b.fischer at gmx.de  Sun Sep 21 17:46:47 2008
From: o.b.fischer at gmx.de (Oliver B. Fischer)
Date: Mon, 22 Sep 2008 02:46:47 +0200
Subject: [antlr-interest] RewriteEmptyStreamException after switching to 3.1
Message-ID: <48D6EAF7.2020104@gmx.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear all,

I am currently switching to ANTLR 3.1 since I would like to use the new
AST rewriting feature.

My parser grammar contains the following rule:
options {output    = AST; }
...
myStatementlist
  : statementOrBlock*
  ;

statementOrBlock
  : statement
  | myBlock
  ;

This rule leads to an
org.antlr.runtime.tree.RewriteEmptyStreamException: rule myStatementlist

I think it is because I don't create a tree structure in this rule.

Is this an error in ANTLR I would like to know...

Bye

Oliver

- --
Oliver B. Fischer, Sch?nhauser Allee 64, 10437 Berlin
Tel. +49 30 44793251, Mobil: +49 178 7903538
Mail: o.b.fischer at gmx.de Blog: http://www.sw-blog.net
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkjW6vYACgkQbyc4N0PdoAzfsgCffQbnOwnJm0QKxdVB654/ZM7Z
N6sAnAuGp6tw2+jLgnxy3Yv74ufw8MiX
=4wFG
-----END PGP SIGNATURE-----

From anders43 at gmail.com  Sun Sep 21 18:13:54 2008
From: anders43 at gmail.com (ajk .)
Date: Mon, 22 Sep 2008 09:13:54 +0800
Subject: [antlr-interest] handling /// comments
In-Reply-To: <48D6286B.3010208@gmx.de>
References: <614b3f5f0809190202m7b13701dr7f4ca216dfe7f3dd@mail.gmail.com>
	<48D3BB9B.6030706@gmx.de>
	<614b3f5f0809202138r76f56e0u26a14ee483adc787@mail.gmail.com>
	<48D6286B.3010208@gmx.de>
Message-ID: <614b3f5f0809211813o50fc1f6idcf354e106a61509@mail.gmail.com>

Yes unfortunately it is v2, our parser is quite large and translating it to
v3 with all the ad hoc functionality would be a major undertaking.

BR/Anders.

On Sun, Sep 21, 2008 at 6:56 PM, Johannes Luber <jaluber at gmx.de> wrote:

> ajk . schrieb:
> >
> >
> > On Fri, Sep 19, 2008 at 10:47 PM, Johannes Luber <jaluber at gmx.de
> > <mailto:jaluber at gmx.de>> wrote:
> >
> >     ajk . schrieb:
> >     > Hi
> >     >
> >     > I was wondering if somebody has an idea how to solve the following
> >     > problem. Lets see if I can describe the issue in a proper way.
> >     >
> >     > We have a translator that translates a scripting language to C#.
> >     >
> >     > We now need to support ///<summary>.. in C#
> >     >
> >     > By adding the /// in the scripting language we were hoping just to
> >     move
> >     > this over to C#:
> >     >
> >     > example
> >     >
> >     > /// <summary>
> >     > /// some function
> >     > /// </summary>
> >     > myfunction returns int
> >     > begin
> >     >    bla();
> >     > end
> >     >
> >     > ->
> >     >
> >     > C#
> >     > /// <summary>
> >     > /// some function
> >     > /// </summary>
> >     > int myfunction()
> >     > {
> >     >   bla();
> >     > }
> >     >
> >     > So far so good, I would associate the comments to the following
> >     function
> >     > which is a node in the AST, simple to do a parser rule for this.
> >     >
> >     > But in C# (as well as the scripting language) you can write
> comments
> >     > anywhere in the code in whatever form you want e.g.
> >     >
> >     > /// hello
> >     >
> >     > or
> >     >
> >     > ///////////////////////////////////////////
> >     > //// this freestanding comment
> >     > ////////////////////////////////////////////
> >     >
> >     > How do you filter away these things? How do I write a parser rule
> that
> >     > allows comments anywhere in the original code but only move the
> >     relevant
> >     > ones? i.e. the ones associated with certain elements like
> functions,
> >     > variable declarations etc.
> >     >
> >     > TIA
> >     > Anders.
> >
> >     There are two possible ways to solve this issue. The first is to add
> >     COMMENT nodes everywhere they may appear. But this reduces the
> >     readability a lot. The other way is to put off the COMMENT tokens
> >     off-channel and to scan in front of matched function definitions for
> a
> >     COMMENT token yourself.
> >
> >     Johannes
> >
> >
> >
> > The latter method sounds better, our language is very large so the less
> > changes to the grammar the better. In v2 (which I am not familiar with)
> > how to set tokens to come into the hidden channel? In v3 you just write
> > $Channel=HIDDEN right?
>
> Are you using v2? I haven't used it myself, too, so I can't help you
> there. In v3 one uses "{$channel=HIDDEN;}", but theoretically one can
> use other values, which is useful to distinguish between comments and
> other whitespace.
>
> Johannes
> >
> > thanks
> > Anders.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/00d21f2a/attachment.html 

From jackgzhang2 at yahoo.com  Sun Sep 21 18:54:43 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Sun, 21 Sep 2008 18:54:43 -0700 (PDT)
Subject: [antlr-interest] Tree walker grammer help.
Message-ID: <48721.38013.qm@web63401.mail.re1.yahoo.com>

Hi,
? I want to achieve following: (convert the input logic query to a standard format)
(1) a AND b? ==> (a and b)
(2) a OR b?? ==> (a or b)
(3) a OR b AND c ==> (a or (b and c))

By using the Antworks took I know that the lexer and parser grammar works fine now (It generate the correct AST tree). But the strange thing is that my tree walker grammar doesn't work. It generate following result:

(1) a AND b ==> (a b and)
(2) a OR c ==> (a b or)

Where am I wrong? 
Thx !

-------------------------- Parser ----------------------
grammar Query;

//=== Parser Option ===//
options {
? output = AST;
? k=*;
}




//=== Lexer ===//

LEFT_PAREN: '(';
NOT: 'NOT';
AND: 'AND';
OR: 'OR';
WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
RIGHT_PAREN: ')';
WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;



//=== Parser ===//
expr: orexpression*;

orexpression
??? :?? andexpression (OR^ andexpression)*
??? ;

andexpression
??? : notexpression (AND^ notexpression)*
??? ;

notexpression
??? : (NOT^)? atom
??? ;

atom
??? : WORD
??? | LEFT_PAREN! expr RIGHT_PAREN!
??? ;

------------------ Tree Walker --------------------

tree grammar QueryWalker;


options {
? output = AST;
? ASTLabelType = CommonTree;
}





expr returns [String value=""]
??? : (a=orexpression {? $value +=? " " + $a.value;} )+
??? ;

orexpression returns [String value=""]
??? : ^(AND a=expr b=expr) {
??????? $value = "(" + $a.value + " or " + $b.value + ")";
??? }
??? | ^(OR a=expr b=expr) {
??????? $value = "(" + $a.value + " and " + $b.value+ ")";
??? }
??? | ^(NOT a=expr) {
??????? $value = "(not " + $a.value +")";
??? }
??? | WORD {
??????? $value = $WORD.text;
??? };


Thx !






      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080921/ed0c0bce/attachment.html 

From jackgzhang2 at yahoo.com  Mon Sep 22 00:43:14 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Mon, 22 Sep 2008 00:43:14 -0700 (PDT)
Subject: [antlr-interest] Tree walker grammer help.
Message-ID: <81744.59567.qm@web63404.mail.re1.yahoo.com>

Sorry that I made a mistake in the previous post. So please ignore the previous one.

I want to achieve following: (convert the input logic query to a standard format)
(1) a AND b? ==> (a and b)
(2) a OR b?? ==> (a or b)
(3) a OR b AND c ==> (a or (b and c))
(4) a b c ==> a b c (No change, since there is no logic involved)
(5) a b AND c ==> a (b and c)

By using the Antworks tool I know that the lexer and parser grammar works just fine. 
(It generate the correct AST tree). 
But the strange thing is that my tree walker grammar doesn't work. 

If I use the TreeWalker version 1(see attached code),? test case 4 and 5 are not working.

(4) a b c ==> a
(5) a b AND c ==> a

If I use the TreeWalker version 2(see attached code), test case 1,2,3 and 5 are not working.

(1) a AND b ==> (a b and)
(2) a OR b ==> (a b or)
(3) a OR b AND c ==> ( a or ( b c and ))
(5) a b AND c ==> a


Also TreeWalker version 2 report warning:

-Decision can match input such as "WORD" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input-


I know something is wrong with the matching of multiple WORD, But I just cannot figure out.
The only difference with version 1 and verson 2 is the WORD rule.

Where am I wrong?
Thx !

----------------------Lexer and Parser ---------------------
grammar Query;

//=== Parser Option ===//
options {
? output = AST;
? k=*;
}




//=== Lexer ===//

LEFT_PAREN: '(';
NOT: 'NOT';
AND: 'AND';
OR: 'OR';
WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
RIGHT_PAREN: ')';
WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;



//=== Parser ===//
expr: orexpression*;

orexpression
??? :?? andexpression (OR^ andexpression)*
??? ;

andexpression
??? : notexpression (AND^ notexpression)*
??? ;

notexpression
??? : (NOT^)? atom
??? ;

atom
??? : WORD
??? | LEFT_PAREN! expr RIGHT_PAREN!
??? ;

----------------------Tree Walker Version 1 ---------------------
tree grammar QueryTree;

options { 
? output = AST;
? ASTLabelType = CommonTree;
? tokenVocab=Query;
}



expr returns [String value=""]
??? : ^(AND a=expr b=expr) {
??????? $value = "(" + $a.value + " and " + $b.value + ")";
??? }
??? | ^(OR a=expr b=expr) {
??????? $value = "(" + $a.value + " or " + $b.value+ ")";
??? }
??? | ^(NOT a=expr) {
??????? $value = "(not " + $a.value +")";
??? }
??? |? ( WORD {? $value = $WORD.text;? }) ;
?? ?
?? ?
----------------------Tree Walker Version 2 ---------------------
tree grammar QueryTree;


options { 
? output = AST;
? ASTLabelType = CommonTree;
? tokenVocab=Query;
}



expr returns [String value=""]
??? : ^(AND a=expr b=expr) {
??????? $value = "(" + $a.value + " and " + $b.value + ")";
??? }
??? | ^(OR a=expr b=expr) {
??????? $value = "(" + $a.value + " or " + $b.value+ ")";
??? }
??? | ^(NOT a=expr) {
??????? $value = "(not " + $a.value +")";
??? }
??? |? ( WORD {? $value +=? " " + $WORD.text;? })+? ;
?? ?
?? ?

?? ?




      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/86b9d4cc/attachment.html 

From antlr at mirality.co.nz  Mon Sep 22 02:19:01 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 22 Sep 2008 21:19:01 +1200
Subject: [antlr-interest] Tree walker grammer help.
In-Reply-To: <81744.59567.qm@web63404.mail.re1.yahoo.com>
References: <81744.59567.qm@web63404.mail.re1.yahoo.com>
Message-ID: <20080922091910.9344511ED0B@www.antlr.org>

At 19:43 22/09/2008, jack zhang wrote:
>If I use the TreeWalker version 1(see attached code),  test case 
>4 and 5 are not working.
>
>(4) a b c ==> a
>(5) a b AND c ==> a

That's because the WORD alternative will only match a single WORD 
and then stop, and you're only matching a single expression.

To match input like the above, you need to match multiple 
expressions.  That's as simple as adding this rule to your 
existing version 1 tree parser:

exprs : expr+ EOF;

After doing that, it ought to work perfectly.  (Well, after you 
modify it to produce the output you want.)

Alternatively, leave your grammar as is and call the expr() method 
multiple times.  Each call will get the next complete top-level 
expression from the input tree.

(Although you ought to remove "output=AST" from your tree 
grammars, since you're not actually generating AST output from 
them.)

>If I use the TreeWalker version 2(see attached code), test case 
>1,2,3 and 5 are not working.
[...]
>-Decision can match input such as "WORD" using multiple 
>alternatives: 1, 2
>As a result, alternative(s) 2 were disabled for that input-
[...]
>expr returns [String value=""]
>     : ^(AND a=expr b=expr) {
>         $value = "(" + $a.value + " and " + $b.value + ")";
>     }
>     | ^(OR a=expr b=expr) {
>         $value = "(" + $a.value + " or " + $b.value+ ")";
>     }
>     | ^(NOT a=expr) {
>         $value = "(not " + $a.value +")";
>     }
>     |  ( WORD {  $value +=  " " + $WORD.text;  })+  ;

It's the recursion that's doing you in here.  Follow through 
what's actually happening:

Case #1: input ^(AND a b):
   - enter rule expr
   - enter first alt (AND)
   - re-enter rule expr (for 'a')
   - enter last alt (WORD)
   - match WORD "a": value=" a"
   - match WORD "b": value=" a b"
   - exit rule expr; label a=" a b"
   - re-enter rule expr (for 'b')
   - no input left: fail

The other cases fail in a similar manner, if you follow them 
through.  (Note that this is the "greedy" interpretation of the 
parsing.  The non-greedy interpretation, which would have actually 
worked for this particular input, is the one ANTLR referred to as 
being disabled due to ambiguity.)

Just forget about parser #2 (although it would probably pay to 
look through it and work out why each of the test cases fail, now 
that you've got a hint).  The change mentioned above for parser #1 
should sort out your issue.


From pmuralidharan at gmail.com  Mon Sep 22 04:23:54 2008
From: pmuralidharan at gmail.com (Murali)
Date: Mon, 22 Sep 2008 16:53:54 +0530
Subject: [antlr-interest] How to parse java source code ?
Message-ID: <9caef0170809220423s1ee07c10re4d30ce1e89a22d1@mail.gmail.com>

 I need the parser which can give the import list, fuction list,
variable names and types, etc.,

Is antlr satisfies the same?

Can u send me the usage of antlr to getting import list, function
list, commented lines and variable names and types from giving java
code as input list



-- 
With Lov,
Murali.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/d12c6537/attachment.html 

From jaluber at gmx.de  Mon Sep 22 05:02:32 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 22 Sep 2008 14:02:32 +0200
Subject: [antlr-interest] How to parse java source code ?
In-Reply-To: <9caef0170809220423s1ee07c10re4d30ce1e89a22d1@mail.gmail.com>
References: <9caef0170809220423s1ee07c10re4d30ce1e89a22d1@mail.gmail.com>
Message-ID: <48D78958.4080409@gmx.de>

Murali schrieb:
>  I need the parser which can give the import list, fuction list, variable names and types, etc., 
> 
> Is antlr satisfies the same?

There is an example grammar which parses Java source code.
> 
> Can u send me the usage of antlr to getting import list, function list, commented lines and variable names and types from giving java code as input list

You have to change the grammar in such a way that you store the required
information. After a successful parsing, you merely have to read it out.
I'm not sure from your description if you actually need a full symbol
table or a lesser structure is sufficient. Just write down which
information you need, how you can store it and look where in the grammar
it is located.

Johannes
> 
> 
> 
> -- 
> With Lov,
> Murali.
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From arik_tg at yahoo.com  Mon Sep 22 05:47:12 2008
From: arik_tg at yahoo.com (Arik Ter-Galstyan)
Date: Mon, 22 Sep 2008 05:47:12 -0700 (PDT)
Subject: [antlr-interest] Verilog grammar for ANTLR v3
Message-ID: <73914.929.qm@web32807.mail.mud.yahoo.com>


Does anyone have a ANTLR v3 compliant Verilog grammar ?




      

From yotommy at gmail.com  Mon Sep 22 06:20:12 2008
From: yotommy at gmail.com (Tom Smith)
Date: Mon, 22 Sep 2008 09:20:12 -0400
Subject: [antlr-interest] disambiguating semantic predicates
In-Reply-To: <48d4938f.1e2d400a.0621.08deSMTPIN_ADDED@mx.google.com>
References: <82dc0d190809191422p57dce6basaf388e78aea3167b@mail.gmail.com>
	<82dc0d190809191453g746237abrfa762ffbab408836@mail.gmail.com>
	<1221865336.8923.401.camel@jimi.temporal-wave.com>
	<48d4938f.1e2d400a.0621.08deSMTPIN_ADDED@mx.google.com>
Message-ID: <82dc0d190809220620u354a8018o7de179ef3fdcfe68@mail.gmail.com>

The suggestions from Jim and Gavin worked perfectly.  Thanks!

On Sat, Sep 20, 2008 at 2:09 AM, Gavin Lambert <antlr at mirality.co.nz> wrote:
> At 11:02 20/09/2008, Jim Idle wrote:
>>
>> event: ^( EVENT
>>                       T1 ...
>>                     | T2 ...
>>                     | T3 ...
>>         );
>
> I'm pretty sure you'll also need an extra set of parentheses there:
>
> event : ^( EVENT
>           ( T1 ...
>           | T2 ...
>           | T3 ...
>           )
>        );
>
> Or alternatively a subrule:
>
> event : ^( EVENT eventdetails );
>
> eventdetails
>    : T1 ...
>    | T2 ...
>    | T3 ...
>    ;
>
>

From arik_tg at yahoo.com  Mon Sep 22 06:58:14 2008
From: arik_tg at yahoo.com (Arik Ter-Galstyan)
Date: Mon, 22 Sep 2008 06:58:14 -0700 (PDT)
Subject: [antlr-interest] Getting linker errors while building the ANTLR
	generated sources.
Message-ID: <146036.59594.qm@web32804.mail.mud.yahoo.com>


Getting the following linker errors while building the ANTLR generated Lexer and Parser sources with Visual Studio 2008. Target language is C++.
In other words the antlr.lib conflicts with MS VS 2008 native libraries due to repeated definition of functions in both libraries.

Any ideas ???

>LIBCMT.lib(setlocal.obj) : error LNK2005: __configthreadlocale already defined in MSVCRT.lib(MSVCR90.dll)
1>LIBCMT.lib(tidtable.obj) : error LNK2005: __encode_pointer already defined in MSVCRT.lib(MSVCR90.dll)
1>LIBCMT.lib(tidtable.obj) : error LNK2005: __decode_pointer already defined in MSVCRT.lib(MSVCR90.dll)
1>LIBCMT.lib(tolower.obj) : error LNK2005: _tolower already defined in MSVCRT.lib(MSVCR90.dll)
1>LIBCMT.lib(invarg.obj) : error LNK2005: __invoke_watson already defined in MSVCRT.lib(MSVCR90.dll)
1>LIBCMT.lib(invarg.obj) : error LNK2005: __invalid_parameter_noinfo already defined in MSVCRT.lib(MSVCR90.dll)
1>LIBCMT.lib(lconv.obj) : error LNK2005: _localeconv already defined in MSVCRT.lib(MSVCR90.dll)





      

From grey_earl at web.de  Mon Sep 22 07:09:11 2008
From: grey_earl at web.de (Markus)
Date: Mon, 22 Sep 2008 16:09:11 +0200
Subject: [antlr-interest] Getting linker errors while building the ANTLR
	generated sources.
In-Reply-To: <146036.59594.qm@web32804.mail.mud.yahoo.com>
References: <146036.59594.qm@web32804.mail.mud.yahoo.com>
Message-ID: <200809221609.12937.grey_earl@web.de>

> Getting the following linker errors while building the ANTLR generated
> Lexer and Parser sources with Visual Studio 2008. Target language is C++.
> In other words the antlr.lib conflicts with MS VS 2008 native libraries due
> to repeated definition of functions in both libraries.
>
> Any ideas ???
>
> >LIBCMT.lib(setlocal.obj) : error LNK2005: __configthreadlocale already
> > defined in MSVCRT.lib(MSVCR90.dll)
>
> 1>LIBCMT.lib(tidtable.obj) : error LNK2005: __encode_pointer already
> defined in MSVCRT.lib(MSVCR90.dll) 1>LIBCMT.lib(tidtable.obj) : error
> LNK2005: __decode_pointer already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(tolower.obj) : error LNK2005: _tolower already defined in
> MSVCRT.lib(MSVCR90.dll) 1>LIBCMT.lib(invarg.obj) : error LNK2005:
> __invoke_watson already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(invarg.obj) : error LNK2005: __invalid_parameter_noinfo
> already defined in MSVCRT.lib(MSVCR90.dll) 1>LIBCMT.lib(lconv.obj) : error
> LNK2005: _localeconv already defined in MSVCRT.lib(MSVCR90.dll)

The conflict seems to be between libcmt.lib and msvcrt.lib and not in 
antlr.lib, judging from the error messages you posted.

libcmt.lib is the static multithreaded C runtime, msvcrt.lib is the import 
library for the dynamic multithreaded C runtime in msvcr90.dll. So they are 
serving the same purpose and you cannot link to both of them.

Markus

From jimi at temporal-wave.com  Mon Sep 22 08:38:48 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 22 Sep 2008 08:38:48 -0700
Subject: [antlr-interest] Tree walker grammer help.
In-Reply-To: <81744.59567.qm@web63404.mail.re1.yahoo.com>
References: <81744.59567.qm@web63404.mail.re1.yahoo.com>
Message-ID: <1222097928.4378.9.camel@jimi.temporal-wave.com>

On Mon, 2008-09-22 at 00:43 -0700, jack zhang wrote:

Oh yeah, you will have to put your multiple words under an imaginary so
that WORD WORD WORD AND WORD WORD WORD are not clashing.

use (w+=WORD)   -> ^(WORDLIST $w+)  in your parser and

expr
: .....

| ^(WORDLIST WORD+)


In your tree grammar

JIm

> Sorry that I made a mistake in the previous post. So please ignore the
> previous one.
> 
> I want to achieve following: (convert the input logic query to a
> standard format)
> (1) a AND b  ==> (a and b)
> (2) a OR b   ==> (a or b)
> (3) a OR b AND c ==> (a or (b and c))
> (4) a b c ==> a b c (No change, since there is no logic involved)
> (5) a b AND c ==> a (b and c)
> 
> By using the Antworks tool I know that the lexer and parser grammar
> works just fine. 
> (It generate the correct AST tree). 
> But the strange thing is that my tree walker grammar doesn't work. 
> 
> If I use the TreeWalker version 1(see attached code),  test case 4 and
> 5 are not working.
> 
> (4) a b c ==> a
> (5) a b AND c ==> a
> 
> If I use the TreeWalker version 2(see attached code), test case 1,2,3
> and 5 are not working.
> 
> (1) a AND b ==> (a b and)
> (2) a OR b ==> (a b or)
> (3) a OR b AND c ==> ( a or ( b c and ))
> (5) a b AND c ==> a
> 
> 
> Also TreeWalker version 2 report warning:
> 
> -Decision can match input such as "WORD" using multiple alternatives:
> 1, 2
> As a result, alternative(s) 2 were disabled for that input-
> 
> 
> I know something is wrong with the matching of multiple WORD, But I
> just cannot figure out.
> The only difference with version 1 and verson 2 is the WORD rule.
> 
> Where am I wrong?
> Thx !
> 
> ----------------------Lexer and Parser ---------------------
> grammar Query;
> 
> //=== Parser Option ===//
> options {
>   output = AST;
>   k=*;
> }
> 
> 
> 
> 
> //=== Lexer ===//
> 
> LEFT_PAREN: '(';
> NOT: 'NOT';
> AND: 'AND';
> OR: 'OR';
> WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';
> RIGHT_PAREN: ')';
> WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;
> 
> 
> 
> //=== Parser ===//
> expr: orexpression*;
> 
> orexpression
>     :   andexpression (OR^ andexpression)*
>     ;
> 
> andexpression
>     : notexpression (AND^ notexpression)*
>     ;
> 
> notexpression
>     : (NOT^)? atom
>     ;
> 
> atom
>     : WORD
>     | LEFT_PAREN! expr RIGHT_PAREN!
>     ;
> 
> ----------------------Tree Walker Version 1 ---------------------
> tree grammar QueryTree;
> 
> options { 
>   output = AST;
>   ASTLabelType = CommonTree;
>   tokenVocab=Query;
> }
> 
> 
> 
> expr returns [String value=""]
>     : ^(AND a=expr b=expr) {
>         $value = "(" + $a.value + " and " + $b.value + ")";
>     }
>     | ^(OR a=expr b=expr) {
>         $value = "(" + $a.value + " or " + $b.value+ ")";
>     }
>     | ^(NOT a=expr) {
>         $value = "(not " + $a.value +")";
>     }
>     |  ( WORD {  $value = $WORD.text;  }) ;
>     
>     
> ----------------------Tree Walker Version 2 ---------------------
> tree grammar QueryTree;
> 
> 
> options { 
>   output = AST;
>   ASTLabelType = CommonTree;
>   tokenVocab=Query;
> }
> 
> 
> 
> expr returns [String value=""]
>     : ^(AND a=expr b=expr) {
>         $value = "(" + $a.value + " and " + $b.value + ")";
>     }
>     | ^(OR a=expr b=expr) {
>         $value = "(" + $a.value + " or " + $b.value+ ")";
>     }
>     | ^(NOT a=expr) {
>         $value = "(not " + $a.value +")";
>     }
>     |  ( WORD {  $value +=  " " + $WORD.text;  })+  ;
>     
>     
> 
>     
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/dff124cf/attachment.html 

From pcc482719 at gmail.com  Mon Sep 22 09:25:26 2008
From: pcc482719 at gmail.com (Peter C. Chapin)
Date: Mon, 22 Sep 2008 12:25:26 -0400
Subject: [antlr-interest] Mulit-pass language processing.
Message-ID: <48D7C6F6.2060108@gmail.com>

I have an application where I need to process and rewrite a collection
of source files. I have come to the conclusion that I'll need to use two
passes over the source files. During the first pass I will parse the
files and gather certain bits of information about them. During the
second pass I will parse and rewrite these files taking into account the
information gathered during the first pass. I believe that, in general,
I need to look over all the files before I can reliably rewrite any of them.

I know how to set up ANTLR's rewriting mode. In fact I have a program
that parses my input files using an ANTLR grammar and rewrites them all
using an identity rewriting. Fine so far. Now I'm thinking about how to
gather the necessary preliminary information I need to do the rewriting
I actually want. The problem is that the grammar actions I need are
different in the two cases (gather information vs rewriting). So that
seems to suggest that I'll need two grammars with largely the same
rules, but different actions. I would instantiate parsers from the first
grammar to do the information gathering (one parser for each source
file), and parsers from the second grammar to do the rewriting.

Before embarking on this path, I wanted to ask if there is perhaps a
more "elegant" way.  It seems like my plan would introduce a maintenance
headache given that I'd have two different grammars that are supposed to
accept the same language.

Thanks!

Peter


From jimi at temporal-wave.com  Mon Sep 22 09:55:41 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 22 Sep 2008 09:55:41 -0700
Subject: [antlr-interest] Getting linker errors while building the	ANTLR
	generated sources.
In-Reply-To: <146036.59594.qm@web32804.mail.mud.yahoo.com>
References: <146036.59594.qm@web32804.mail.mud.yahoo.com>
Message-ID: <1222102541.12107.2.camel@jimi.temporal-wave.com>

On Mon, 2008-09-22 at 06:58 -0700, Arik Ter-Galstyan wrote:

> Getting the following linker errors while building the ANTLR generated Lexer and Parser sources with Visual Studio 2008. Target language is C++.
> In other words the antlr.lib conflicts with MS VS 2008 native libraries due to repeated definition of functions in both libraries.
> 
> Any ideas ???
> 
> >LIBCMT.lib(setlocal.obj) : error LNK2005: __configthreadlocale already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(tidtable.obj) : error LNK2005: __encode_pointer already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(tidtable.obj) : error LNK2005: __decode_pointer already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(tolower.obj) : error LNK2005: _tolower already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(invarg.obj) : error LNK2005: __invoke_watson already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(invarg.obj) : error LNK2005: __invalid_parameter_noinfo already defined in MSVCRT.lib(MSVCR90.dll)
> 1>LIBCMT.lib(lconv.obj) : error LNK2005: _localeconv already defined in MSVCRT.lib(MSVCR90.dll)
> 
> 

If you want to use LIBCMT, then rebuild the ANTLR runtime libraries to
link with that. They are using MSVCRT by default (multi-threaded DLL).
Or, just change your project to use MSVCRT if you didn't specifically
mean to to use the static libraries with it.

Jim



> 
> 
> 
>       
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/9018b55a/attachment.html 

From jackgzhang2 at yahoo.com  Mon Sep 22 10:46:19 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Mon, 22 Sep 2008 10:46:19 -0700 (PDT)
Subject: [antlr-interest] Tree walker grammer help.
Message-ID: <621711.37700.qm@web63408.mail.re1.yahoo.com>

Thanks. It works just fine like you suggested.

--- On Mon, 9/22/08, Gavin Lambert <antlr at mirality.co.nz> wrote:
From: Gavin Lambert <antlr at mirality.co.nz>
Subject: Re: [antlr-interest] Tree walker grammer help.
To: jackgzhang2 at yahoo.com, antlr-interest at antlr.org
Date: Monday, September 22, 2008, 2:19 AM

At 19:43 22/09/2008, jack zhang wrote:
>If I use the TreeWalker version 1(see attached code),  test case 
>4 and 5 are not working.
>
>(4) a b c ==> a
>(5) a b AND c ==> a

That's because the WORD alternative will only match a single WORD 
and then stop, and you're only matching a single expression.

To match input like the above, you need to match multiple 
expressions.  That's as simple as adding this rule to your 
existing version 1 tree parser:

exprs : expr+ EOF;

After doing that, it ought to work perfectly.  (Well, after you 
modify it to produce the output you want.)

Alternatively, leave your grammar as is and call the expr() method 
multiple times.  Each call will get the next complete top-level 
expression from the input tree.

(Although you ought to remove "output=AST" from your tree 
grammars, since you're not actually generating AST output from 
them.)

>If I use the TreeWalker version 2(see attached code), test case 
>1,2,3 and 5 are not working.
[...]
>-Decision can match input such as "WORD" using multiple 
>alternatives: 1, 2
>As a result, alternative(s) 2 were disabled for that input-
[...]
>expr returns [String value=""]
>     : ^(AND a=expr b=expr) {
>         $value = "(" + $a.value + " and " + $b.value +
")";
>     }
>     | ^(OR a=expr b=expr) {
>         $value = "(" + $a.value + " or " + $b.value+
")";
>     }
>     | ^(NOT a=expr) {
>         $value = "(not " + $a.value +")";
>     }
>     |  ( WORD {  $value +=  " " + $WORD.text;  })+  ;

It's the recursion that's doing you in here.  Follow through 
what's actually happening:

Case #1: input ^(AND a b):
   - enter rule expr
   - enter first alt (AND)
   - re-enter rule expr (for 'a')
   - enter last alt (WORD)
   - match WORD "a": value=" a"
   - match WORD "b": value=" a b"
   - exit rule expr; label a=" a b"
   - re-enter rule expr (for 'b')
   - no input left: fail

The other cases fail in a similar manner, if you follow them 
through.  (Note that this is the "greedy" interpretation of the 
parsing.  The non-greedy interpretation, which would have actually 
worked for this particular input, is the one ANTLR referred to as 
being disabled due to ambiguity.)

Just forget about parser #2 (although it would probably pay to 
look through it and work out why each of the test cases fail, now 
that you've got a hint).  The change mentioned above for parser #1 
should sort out your issue.




      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/c89feede/attachment.html 

From jackgzhang2 at yahoo.com  Mon Sep 22 10:46:48 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Mon, 22 Sep 2008 10:46:48 -0700 (PDT)
Subject: [antlr-interest] Tree walker grammer help.
In-Reply-To: <1222097928.4378.9.camel@jimi.temporal-wave.com>
Message-ID: <988853.26666.qm@web63402.mail.re1.yahoo.com>

Thanks a lot !. It works.

--- On Mon, 9/22/08, Jim Idle <jimi at temporal-wave.com> wrote:
From: Jim Idle <jimi at temporal-wave.com>
Subject: Re: [antlr-interest] Tree walker grammer help.
To: jackgzhang2 at yahoo.com
Cc: antlr-interest at antlr.org
Date: Monday, September 22, 2008, 8:38 AM




  
  
On Mon, 2008-09-22 at 00:43 -0700, jack zhang wrote:



Oh yeah, you will have to put your multiple words under an imaginary so that WORD WORD WORD AND WORD WORD WORD are not clashing.



use (w+=WORD)?? -> ^(WORDLIST $w+)? in your parser and



expr

: .....



| ^(WORDLIST WORD+)





In your tree grammar



JIm


    


Sorry that I made a mistake in the previous post. So please ignore the previous one.



I want to achieve following: (convert the input logic query to a standard format)

(1) a AND b? ==> (a and b)

(2) a OR b?? ==> (a or b)

(3) a OR b AND c ==> (a or (b and c))

(4) a b c ==> a b c (No change, since there is no logic involved)

(5) a b AND c ==> a (b and c)



By using the Antworks tool I know that the lexer and parser grammar works just fine. 

(It generate the correct AST tree). 

But the strange thing is that my tree walker grammar doesn't work. 



If I use the TreeWalker version 1(see attached code),? test case 4 and 5 are not working.



(4) a b c ==> a

(5) a b AND c ==> a



If I use the TreeWalker version 2(see attached code), test case 1,2,3 and 5 are not working.



(1) a AND b ==> (a b and)

(2) a OR b ==> (a b or)

(3) a OR b AND c ==> ( a or ( b c and ))

(5) a b AND c ==> a





Also TreeWalker version 2 report warning:



-Decision can match input such as "WORD" using multiple alternatives: 1, 2

As a result, alternative(s) 2 were disabled for that input-





I know something is wrong with the matching of multiple WORD, But I just cannot figure out.

The only difference with version 1 and verson 2 is the WORD rule.



Where am I wrong?

Thx !



----------------------Lexer and Parser ---------------------

grammar Query;



//=== Parser Option ===//

options {

? output = AST;

? k=*;

}









//=== Lexer ===//



LEFT_PAREN: '(';

NOT: 'NOT';

AND: 'AND';

OR: 'OR';

WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9')+ | '"'.+'"';

RIGHT_PAREN: ')';

WHITESPACE: (' ' | '\t' | '\r' | '\n') { $channel = HIDDEN; } ;







//=== Parser ===//

expr: orexpression*;



orexpression

??? :?? andexpression (OR^ andexpression)*

??? ;



andexpression

??? : notexpression (AND^ notexpression)*

??? ;



notexpression

??? : (NOT^)? atom

??? ;



atom

??? : WORD

??? | LEFT_PAREN! expr RIGHT_PAREN!

??? ;



----------------------Tree Walker Version 1 ---------------------

tree grammar QueryTree;



options { 

? output = AST;

? ASTLabelType = CommonTree;

? tokenVocab=Query;

}







expr returns [String value=""]

??? : ^(AND a=expr b=expr) {

??????? $value = "(" + $a.value + " and " + $b.value + ")";

??? }

??? | ^(OR a=expr b=expr) {

??????? $value = "(" + $a.value + " or " + $b.value+ ")";

??? }

??? | ^(NOT a=expr) {

??????? $value = "(not " + $a.value +")";

??? }

??? |? ( WORD {? $value = $WORD.text;? }) ;

?? ?

?? ?

----------------------Tree Walker Version 2 ---------------------

tree grammar QueryTree;





options { 

? output = AST;

? ASTLabelType = CommonTree;

? tokenVocab=Query;

}







expr returns [String value=""]

??? : ^(AND a=expr b=expr) {

??????? $value = "(" + $a.value + " and " + $b.value + ")";

??? }

??? | ^(OR a=expr b=expr) {

??????? $value = "(" + $a.value + " or " + $b.value+ ")";

??? }

??? | ^(NOT a=expr) {

??????? $value = "(not " + $a.value +")";

??? }

??? |? ( WORD {? $value +=? " " + $WORD.text;? })+? ;

?? ?

?? ?



?? ?








    

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address



 



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/75a34865/attachment.html 

From yotommy at gmail.com  Mon Sep 22 11:01:09 2008
From: yotommy at gmail.com (Tom Smith)
Date: Mon, 22 Sep 2008 14:01:09 -0400
Subject: [antlr-interest] Mulit-pass language processing.
In-Reply-To: <48D7C6F6.2060108@gmail.com>
References: <48D7C6F6.2060108@gmail.com>
Message-ID: <82dc0d190809221101y46582ba2q56a2b46b9e29f485@mail.gmail.com>

I have a similar situation, and chose an approach like one I saw mentioned
on the mailing list years ago:

http://www.antlr.org/pipermail/antlr-interest/2005-June/012788.html

I have implemented one Behavior per pass, and change the Behavior from
the main program before calling the parser on each pass.

Hope this helps,
Tom.

On Mon, Sep 22, 2008 at 12:25 PM, Peter C. Chapin <pcc482719 at gmail.com> wrote:
> I have an application where I need to process and rewrite a collection
> of source files. I have come to the conclusion that I'll need to use two
> passes over the source files. During the first pass I will parse the
> files and gather certain bits of information about them. During the
> second pass I will parse and rewrite these files taking into account the
> information gathered during the first pass. I believe that, in general,
> I need to look over all the files before I can reliably rewrite any of them.
>
> I know how to set up ANTLR's rewriting mode. In fact I have a program
> that parses my input files using an ANTLR grammar and rewrites them all
> using an identity rewriting. Fine so far. Now I'm thinking about how to
> gather the necessary preliminary information I need to do the rewriting
> I actually want. The problem is that the grammar actions I need are
> different in the two cases (gather information vs rewriting). So that
> seems to suggest that I'll need two grammars with largely the same
> rules, but different actions. I would instantiate parsers from the first
> grammar to do the information gathering (one parser for each source
> file), and parsers from the second grammar to do the rewriting.
>
> Before embarking on this path, I wanted to ask if there is perhaps a
> more "elegant" way.  It seems like my plan would introduce a maintenance
> headache given that I'd have two different grammars that are supposed to
> accept the same language.
>
> Thanks!
>
> Peter
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From arcadiorubiogarcia at gmail.com  Mon Sep 22 11:06:14 2008
From: arcadiorubiogarcia at gmail.com (=?ISO-8859-1?Q?Arcadio_Rubio_Garc=EDa?=)
Date: Mon, 22 Sep 2008 20:06:14 +0200
Subject: [antlr-interest] Context-sensitive Lexer
Message-ID: <96CC06BC-8753-425F-9702-3D36C5351C2E@gmail.com>

Hi everyone,

I've recently migrated to ANTLR from Yacc, and I don't find the way to  
do context-sensitive scanning (lexing) with ANTLR.

Can anyone point how to define an identifier token so that it's not  
recognized when it's adjacent to an integer for instance, 1a is not  
recognized as an integer + identifier?

In Lex+Yacc, I used to do this with regular expressions, e.g.:

identifier = /\b[a-zA-Z_][a-zA-Z0-9_]*\b/

Thanks in advance.

From jackgzhang2 at yahoo.com  Mon Sep 22 11:49:05 2008
From: jackgzhang2 at yahoo.com (jack zhang)
Date: Mon, 22 Sep 2008 11:49:05 -0700 (PDT)
Subject: [antlr-interest] Limit the occurrence of a character in the Lexer
Message-ID: <785791.75651.qm@web63403.mail.re1.yahoo.com>

Hi,
? I want to limit the occurrence of the character * and ? in a string.? Say, the * and ? can appear anywhere and multiple times in a string like:
? (1) a*b
? (2) a**b
? (3) **ab
? (4) ab*
? (5) a?b*
? (6) ?ab

But the string cannot ONLY contains these 2 character. For example, Following are invalid:
? (10) **
? (11) ?*
? (12) ??**
? (13) ??

Currently my WORD grammar is:

WORD: ('a'..'z' | 'A'..'Z' | '.' | ',' | '0'..'9' | '?' | '\u002A')+ ;

Which only covers the valid cases. Is there a way to do this without writing Java code in the Lexer and Parser?

Thx !



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080922/d840aba0/attachment.html 

From jaluber at gmx.de  Mon Sep 22 13:15:28 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 22 Sep 2008 22:15:28 +0200
Subject: [antlr-interest] Context-sensitive Lexer
In-Reply-To: <96CC06BC-8753-425F-9702-3D36C5351C2E@gmail.com>
References: <96CC06BC-8753-425F-9702-3D36C5351C2E@gmail.com>
Message-ID: <48D7FCE0.2020309@gmx.de>

Arcadio Rubio Garc?a schrieb:
> Hi everyone,
> 
> I've recently migrated to ANTLR from Yacc, and I don't find the way to  
> do context-sensitive scanning (lexing) with ANTLR.
> 
> Can anyone point how to define an identifier token so that it's not  
> recognized when it's adjacent to an integer for instance, 1a is not  
> recognized as an integer + identifier?
> 
> In Lex+Yacc, I used to do this with regular expressions, e.g.:
> 
> identifier = /\b[a-zA-Z_][a-zA-Z0-9_]*\b/
> 
> Thanks in advance.

There is no way to so directly in ANTLR, unless you create a new lexer
class which doesn't consume the entire input at once. The usual method
to deal with this is to rewrite tokens in the parser for the second pass.

Johannes
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From enjoywm at cs.wm.edu  Mon Sep 22 17:36:59 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Mon, 22 Sep 2008 20:36:59 -0400
Subject: [antlr-interest] how to know the position
Message-ID: <48D83A2B.7050904@cs.wm.edu>

Hi,
I want to comment out the code beginning with "cuda", but ignore the 
"cuda" appearing in the middle.
For example ,comment out:
cudaType c = new cudaType();
but enable
function(cudaType c);
What I do is like,
CUDAComment
        :
                ("cuda" ( ~('\n') )* 
{setPreprocessingDirective(getText(),Pragma.comment);})
                        {
 
                        _ttype = Token.SKIP;
                        }
        ;

But it will comment the code with "cuda" in the middle. How to know the 
positon of "cuda"?

Best,

Yixun

From arik_tg at yahoo.com  Mon Sep 22 22:48:32 2008
From: arik_tg at yahoo.com (Arik Ter-Galstyan)
Date: Mon, 22 Sep 2008 22:48:32 -0700 (PDT)
Subject: [antlr-interest] Getting linker errors while building the ANTLR
	generated sources.
In-Reply-To: <1222102541.12107.2.camel@jimi.temporal-wave.com>
Message-ID: <559990.99631.qm@web32804.mail.mud.yahoo.com>


Markus and Jim thanks a lot for response. 

Jim,

it's not me trying to link the LIBCMT.lib with antlr.lib but the VS2008 on it's own tries to link them together. I think that the ANTLR generated source files contain some function which refer to both libs. When I'm trying to exclude one of the conflicting libs from linking process then I get an "Unresolved external symbol" type of link error. Also, please tell me how can I change the project to use MSVCRT ?  

Markus,

I had posted only the part of the linker errors in my previous email. There
were another linker errors explicitly pointing the conflict between msvcprt.lib and ANTLR.lib asshown below

msvcprt.lib(MSVCP90.dll) : error LNK2005: "public: int __thiscall std::ios_base::width(void)const " (?width at ios_base@std@@QBEHXZ) already defined in antlr.lib(CharScanner.obj)
1>msvcprt.lib(MSVCP90.dll) : error LNK2005: "public: int __thiscall std::ios_base::flags(void)const " (?flags at ios_base@std@@QBEHXZ) already defined in antlr.lib(CharBuffer.obj)
1>msvcprt.lib(MSVCP90.dll) : error LNK2005: "public: bool __thiscall std::ios_base::good(void)const " (?good at ios_base@std@@QBE_NXZ) already defined in antlr.lib(CharBuffer.obj)

And I would like to repeat one more time that it is not me trying to link LIBCMT.lib and msvcrt.lib together. I have just created a Win32 Console application project and imported the ANTLR generated source code into the project assuming that it should build successfully, however it failed.




--- On Mon, 9/22/08, Jim Idle <jimi at temporal-wave.com> wrote:

> From: Jim Idle <jimi at temporal-wave.com>
> Subject: Re: [antlr-interest] Getting linker errors while building the ANTLR generated sources.
> To: arik_tg at yahoo.com
> Cc: antlr-interest at antlr.org
> Date: Monday, September 22, 2008, 9:55 AM
> On Mon, 2008-09-22 at 06:58 -0700, Arik Ter-Galstyan wrote:
> 
> > Getting the following linker errors while building the
> ANTLR generated Lexer and Parser sources with Visual Studio
> 2008. Target language is C++.
> > In other words the antlr.lib conflicts with MS VS 2008
> native libraries due to repeated definition of functions in
> both libraries.
> > 
> > Any ideas ???
> > 
> > >LIBCMT.lib(setlocal.obj) : error LNK2005:
> __configthreadlocale already defined in
> MSVCRT.lib(MSVCR90.dll)
> > 1>LIBCMT.lib(tidtable.obj) : error LNK2005:
> __encode_pointer already defined in MSVCRT.lib(MSVCR90.dll)
> > 1>LIBCMT.lib(tidtable.obj) : error LNK2005:
> __decode_pointer already defined in MSVCRT.lib(MSVCR90.dll)
> > 1>LIBCMT.lib(tolower.obj) : error LNK2005: _tolower
> already defined in MSVCRT.lib(MSVCR90.dll)
> > 1>LIBCMT.lib(invarg.obj) : error LNK2005:
> __invoke_watson already defined in MSVCRT.lib(MSVCR90.dll)
> > 1>LIBCMT.lib(invarg.obj) : error LNK2005:
> __invalid_parameter_noinfo already defined in
> MSVCRT.lib(MSVCR90.dll)
> > 1>LIBCMT.lib(lconv.obj) : error LNK2005:
> _localeconv already defined in MSVCRT.lib(MSVCR90.dll)
> > 
> > 
> 
> If you want to use LIBCMT, then rebuild the ANTLR runtime
> libraries to
> link with that. They are using MSVCRT by default
> (multi-threaded DLL).
> Or, just change your project to use MSVCRT if you
> didn't specifically
> mean to to use the static libraries with it.
> 
> Jim
> 
> 
> 
> > 
> > 
> > 
> >       
> > 
> > List:
> http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >


      

From antlr at mirality.co.nz  Tue Sep 23 01:10:20 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 23 Sep 2008 20:10:20 +1200
Subject: [antlr-interest] Getting linker errors while building the ANTLR
 generated sources.
In-Reply-To: <559990.99631.qm@web32804.mail.mud.yahoo.com>
References: <1222102541.12107.2.camel@jimi.temporal-wave.com>
	<559990.99631.qm@web32804.mail.mud.yahoo.com>
Message-ID: <20080923081031.2507DCE950@www.antlr.org>

At 17:48 23/09/2008, Arik Ter-Galstyan wrote:
 >it's not me trying to link the LIBCMT.lib with antlr.lib but the 

 >VS2008 on it's own tries to link them together.

It links in one CRT or the other depending on your project 
settings.

 >And I would like to repeat one more time that it is not me 
trying
 >to link LIBCMT.lib and msvcrt.lib together. I have just created 
a
 >Win32 Console application project and imported the ANTLR 
generated
 >source code into the project assuming that it should build
 >successfully, however it failed.

Are you using a precompiled ANTLR runtime library or are you 
building your own?  If you're using a precompiled library, then 
most likely the project settings (or compiler) used to build that 
conflict with the ones you are using for your app.

You'll need to either change your app to match or rebuild the 
library with the same settings as your app.


From enjoywm at cs.wm.edu  Tue Sep 23 06:55:46 2008
From: enjoywm at cs.wm.edu (Yixun Liu)
Date: Tue, 23 Sep 2008 09:55:46 -0400
Subject: [antlr-interest] how to comment out
Message-ID: <48D8F562.8010001@cs.wm.edu>

Hi,
I want to comment out the code beginning with "cuda", but ignore the 
"cuda" appearing in the middle.
For example ,comment out:
cudaType c = new cudaType();       -
but enable
function(cudaType c);
What I do is like,
CUDAComment
       :
               ("cuda" ( ~('\n') )* 
{setPreprocessingDirective(getText(),Pragma.comment);})
                       {

                       _ttype = Token.SKIP;
                       }
       ;

But it will comment the code with "cuda" in the middle. How to know the 
position of "cuda"?

Best,

Yixun

From jimi at temporal-wave.com  Tue Sep 23 08:04:52 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 23 Sep 2008 08:04:52 -0700
Subject: [antlr-interest] Getting linker errors while building the	ANTLR
	generated sources.
In-Reply-To: <559990.99631.qm@web32804.mail.mud.yahoo.com>
References: <559990.99631.qm@web32804.mail.mud.yahoo.com>
Message-ID: <1222182292.12107.78.camel@jimi.temporal-wave.com>

On Mon, 2008-09-22 at 22:48 -0700, Arik Ter-Galstyan wrote:

> Markus and Jim thanks a lot for response. 
> 
> Jim,
> 
> it's not me trying to link the LIBCMT.lib with antlr.lib but the VS2008 on it's own tries to link them together.

The project you are using to compile and link the generated code is
doing it. So, right click on your project and select properties, C/C++,
code generation, Runtime Library, "Multi-threaded {Debug} DLL (/MDd).
Use teh Debug version fo rhte Debug target of your [rpject and the
Release version for the Release target of your project.




>  I think that the ANTLR generated source files contain some function which refer to both libs. 


That's not how it works.

> When I'm trying to exclude one of the conflicting libs from linking process then I get an "Unresolved external symbol" type of link error. 



> Also, please tell me how can I change the project to use MSVCRT ?  

You need to read the documentation for VS2008 projects.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080923/cef5aa0e/attachment.html 

From waqasjaved at gmail.com  Tue Sep 23 08:30:26 2008
From: waqasjaved at gmail.com (waqas javed)
Date: Tue, 23 Sep 2008 15:30:26 +0000 (UTC)
Subject: [antlr-interest] limit the number of characters in a string
Message-ID: <loom.20080923T152715-266@post.gmane.org>


Hi,

   I am writing a parser in antlr. Can you tell me how I can limit the number 
of characters in string. Actually I want to limit the max number of characters 
for an identifier to 32.

   I am using the comman ('a'..'z')+ but this dont put any restriction on the 
max number of characters that can be there in an identifier.

regards,

waqas


From hallorant at gmail.com  Tue Sep 23 09:37:50 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Tue, 23 Sep 2008 12:37:50 -0400
Subject: [antlr-interest] limit the number of characters in a string
In-Reply-To: <loom.20080923T152715-266@post.gmane.org>
References: <loom.20080923T152715-266@post.gmane.org>
Message-ID: <a36ab4bc0809230937u3d8dba42jbb6578a4cd78326f@mail.gmail.com>

Well, since 32 isn't that big you can use brute force.  Below is an example
that gives you identifiers that are no longer than 32 characters need to
start with a letter and then can have letters, numbers, or underscores.

grammar Example;

ID     :    AL
        ALN? ALN? ALN? ALN? ALN?
        ALN? ALN? ALN? ALN? ALN?
        ALN? ALN? ALN? ALN? ALN?
        ALN? ALN? ALN? ALN? ALN?
        ALN? ALN? ALN? ALN? ALN?
        ALN? ALN? ALN? ALN? ALN?
        ALN?
    ;

AL    : 'a'..'z' | 'A'..'Z';
ALN    : AL | '_' | '0'..'9';

Hope this helps,
Tim

On Tue, Sep 23, 2008 at 11:30 AM, waqas javed <waqasjaved at gmail.com> wrote:

>
> Hi,
>
>   I am writing a parser in antlr. Can you tell me how I can limit the
> number
> of characters in string. Actually I want to limit the max number of
> characters
> for an identifier to 32.
>
>   I am using the comman ('a'..'z')+ but this dont put any restriction on
> the
> max number of characters that can be there in an identifier.
>
> regards,
>
> waqas
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080923/2bfea5a9/attachment.html 

From hallorant at gmail.com  Tue Sep 23 10:10:09 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Tue, 23 Sep 2008 13:10:09 -0400
Subject: [antlr-interest] limit the number of characters in a string
In-Reply-To: <e8fd6cf60809230950s26354f61kbb2fa2db0894e76c@mail.gmail.com>
References: <loom.20080923T152715-266@post.gmane.org>
	<a36ab4bc0809230937u3d8dba42jbb6578a4cd78326f@mail.gmail.com>
	<e8fd6cf60809230950s26354f61kbb2fa2db0894e76c@mail.gmail.com>
Message-ID: <a36ab4bc0809231010g615c3a9dq412770cc59714a53@mail.gmail.com>

Well, you could use "+" and then have the semantic analysis of the grammar
check the length of the input strings and output an error (raise
RecognitionException) if the string length is greater than 32.  Something
like this:

grammar Example;

string32
    : ID
    {
        final String id = $ID.text;
        if ((id.length() > 32))
            throw new RecognitionException();
    }
    ;

ID    : ('a'..'z'|'A'..'Z')+
    ;

This should work -- that said the error reporting probably could be improved
:-)  The example above just errors out because RecognitionException doesn't
allow a string message to be set (I'm not sure why).  You could create your
own runtime exception sub-class or throw something like
IllegalArgumentException that would allow you to pass a description (e.g.,
The identifier 'badbecauseitiswaywaywaywaywaywaywaywaywaywaytoolong' is too
long...all identifiers must be 32 characters or less.)

Good luck,
Tim

On Tue, Sep 23, 2008 at 12:50 PM, Waqas Javed <waqasjaved at gmail.com> wrote:

> Thanks, for the reply. Actually if I adopt this technique, antlr take a lot
> of time to make the parser tree. That is why I am looking for any built in
> command that can solve the problem in an efficient way.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080923/ed8fbf0b/attachment.html 

From parrt at cs.usfca.edu  Tue Sep 23 10:36:31 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 23 Sep 2008 10:36:31 -0700
Subject: [antlr-interest] [stringtemplate-interest] PyStringTemplate
	3.2b1 released
In-Reply-To: <543531490809211304x706594bcg8036b10cfb8d02ab@mail.gmail.com>
References: <543531490809211304x706594bcg8036b10cfb8d02ab@mail.gmail.com>
Message-ID: <F1F77EBF-F174-46EA-AD3E-41B27424B6B2@cs.usfca.edu>

Updated:

http://www.stringtemplate.org/download.html

http://www.stringtemplate.org/download/PyStringTemplate-3.2b1.tar.gz

Ter
On Sep 21, 2008, at 1:04 PM, Benjamin Niemann wrote:

> Hi Ho!
>
> I just finished fixing the most obvious stuff for PyST and will
> hopefully be able to declare it final soon.
> Most significant change (beyond the changes that I cloned from the
> Java version) is that PyST should now work much better with unicode.
>
> Download it directly from the repository (and soon from www.stringtemplate.org 
> ):
> http://fisheye2.atlassian.com/browse/~raw,r=5277/stringtemplate/ 
> python/release/PyStringTemplate-3.2b1/dist/ 
> stringtemplate3-3.2b1.tar.gz
>
> Ter is already working on 3.3, so get it before it gets obsolete ;)
>
> -Ben
>
> Ter: can you put the file up on www.stringtemplate.org? Thanks.
> _______________________________________________
> stringtemplate-interest mailing list
> stringtemplate-interest at antlr.org
> http://www.antlr.org/mailman/listinfo/stringtemplate-interest


From spamhole at gmx.at  Tue Sep 23 12:32:31 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Tue, 23 Sep 2008 21:32:31 +0200
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48D5F29B.4080203@gmx.at>
References: <48C3F817.3010305@gmx.at>	<48C41C6E.2050305@gmx.at>	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>	<48C43110.8060703@gmx.at>	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>	<48D40D3B.6010608@gmx.at>
	<48D5F29B.4080203@gmx.at>
Message-ID: <48D9444F.7000207@gmx.at>

I have finally figured out what is causing the problem.

To reproduce: Put the grammar file into a directory with whitespace in 
its name, like "My Directory". And set the output directory to empty (so 
the output will be put into the same directory as the grammar file).

When you launch the debugger on this grammar, it will output silly 
symbol names in the parse tree. The problem goes away when you put the 
grammar into a directory that doesn't contain spaces in its name (like 
"MyDirectory").

Please try this out and let me know if you can reproduce the problem now.

Max

Markus Stoeger schrieb:
> Markus Stoeger schrieb:
>   
>> Terence Parr schrieb:
>>   
>>     
>>> Hi gang,Did we ever figure out what's going on here?
>>> Ter
>>>     
>>>       
>> I've bought a new notebook yesterday and will try it out on that yet new 
>> system as soon as possible (probably on sunday).
>>   
>>     
> I've tried it out right now and it works on the new system! I just 
> compiled the simple grammar that I have posted before (with the x+y) and 
> all symbols are displayed correctly in the debugger's parse tree view now.
>
> But I still don't understand why it doesn't work on the old system, on 
> the system at work and on the VMWare system.
>
> One difference between the systems is XP and Vista. I'm running XP 
> (multilang) on all systems where it displays those "ands". Java versions 
> are identical (1.6.7).
>
> Max
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>   


From parrt at cs.usfca.edu  Tue Sep 23 12:54:32 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 23 Sep 2008 12:54:32 -0700
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <48D9444F.7000207@gmx.at>
References: <48C3F817.3010305@gmx.at>	<48C41C6E.2050305@gmx.at>	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>	<48C43110.8060703@gmx.at>	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>	<48D40D3B.6010608@gmx.at>
	<48D5F29B.4080203@gmx.at> <48D9444F.7000207@gmx.at>
Message-ID: <2FC21407-84D2-4679-92F0-A1870B1A0694@cs.usfca.edu>

Awesome news!Thanks for finding this.

Jean: didn't we fix the whitespace issue in directory names earlier?

Ter
On Sep 23, 2008, at 12:32 PM, Markus Stoeger wrote:

> I have finally figured out what is causing the problem.
>
> To reproduce: Put the grammar file into a directory with whitespace in
> its name, like "My Directory". And set the output directory to empty  
> (so
> the output will be put into the same directory as the grammar file).
>
> When you launch the debugger on this grammar, it will output silly
> symbol names in the parse tree. The problem goes away when you put the
> grammar into a directory that doesn't contain spaces in its name (like
> "MyDirectory").
>
> Please try this out and let me know if you can reproduce the problem  
> now.
>
> Max
>
> Markus Stoeger schrieb:
>> Markus Stoeger schrieb:
>>
>>> Terence Parr schrieb:
>>>
>>>
>>>> Hi gang,Did we ever figure out what's going on here?
>>>> Ter
>>>>
>>>>
>>> I've bought a new notebook yesterday and will try it out on that  
>>> yet new
>>> system as soon as possible (probably on sunday).
>>>
>>>
>> I've tried it out right now and it works on the new system! I just
>> compiled the simple grammar that I have posted before (with the x 
>> +y) and
>> all symbols are displayed correctly in the debugger's parse tree  
>> view now.
>>
>> But I still don't understand why it doesn't work on the old system,  
>> on
>> the system at work and on the VMWare system.
>>
>> One difference between the systems is XP and Vista. I'm running XP
>> (multilang) on all systems where it displays those "ands". Java  
>> versions
>> are identical (1.6.7).
>>
>> Max
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From jack.t.spencer at gmail.com  Tue Sep 23 15:06:17 2008
From: jack.t.spencer at gmail.com (Jack Spencer)
Date: Tue, 23 Sep 2008 18:06:17 -0400
Subject: [antlr-interest] antlr-3.1.jar shows up as antlr-2.7.7?
Message-ID: <9b62d8b20809231506x3659172y1797bfec8adac4f7@mail.gmail.com>

I'm trying to get antlr-3.1 to run on OS X 10.5.4.
I d/l-ed the antlr-3.1.tar.gz file from the main antlr download page, have
the antlr-3.1.jar in my CLASSPATH.
The CLASSPATH only contains that specific jar.  No other antlr versions on
the system.
But when I run java antlr.Tool foo.g the version string is "Version 2.7.7
(20060906)"

Further, since it fails to recognize the "grammar foo.g", it really is
ANTLR2

So - how do I get the 3.1 jar to act, well... as 3.1?
Thanks,
Jack
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080923/6f62fb5a/attachment.html 

From rschulz at sonic.net  Tue Sep 23 15:17:10 2008
From: rschulz at sonic.net (Randall R Schulz)
Date: Tue, 23 Sep 2008 15:17:10 -0700
Subject: [antlr-interest] antlr-3.1.jar shows up as antlr-2.7.7?
In-Reply-To: <9b62d8b20809231506x3659172y1797bfec8adac4f7@mail.gmail.com>
References: <9b62d8b20809231506x3659172y1797bfec8adac4f7@mail.gmail.com>
Message-ID: <200809231517.10981.rschulz@sonic.net>

On Tuesday 23 September 2008 15:06, Jack Spencer wrote:
> I'm trying to get antlr-3.1 to run on OS X 10.5.4.
> I d/l-ed the antlr-3.1.tar.gz file from the main antlr download page,
> have the antlr-3.1.jar in my CLASSPATH.
> The CLASSPATH only contains that specific jar.  No other antlr
> versions on the system.
> But when I run java antlr.Tool foo.g the version string is "Version
> 2.7.7 (20060906)"

Try "org.antlr.Tool" instead of "antlr.Tool".

ANTLR 3 uses ANTLR 2 to parse ".g" file, so they're both in there.


> Further, since it fails to recognize the "grammar foo.g", it really
> is ANTLR2
>
> So - how do I get the 3.1 jar to act, well... as 3.1?
> Thanks,
> Jack


Randall Schulz

From ramanand_mandayam at yahoo.com  Tue Sep 23 15:36:40 2008
From: ramanand_mandayam at yahoo.com (Ramanand Mandayam)
Date: Tue, 23 Sep 2008 15:36:40 -0700 (PDT)
Subject: [antlr-interest] Cpp grammar file does not compile
Message-ID: <8063.17621.qm@web33508.mail.mud.yahoo.com>

I am trying to compile the Cpp.g file provided in the CPP grammar distribution but ANTLR generates invalid token errors on the sequence ^^.
I believe this is a relic from an earlier version of ANTLR. 
Any thoughts?

Cheers

Ramanand


      

From antlr-list at arizona-software.ch  Tue Sep 23 20:19:23 2008
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Tue, 23 Sep 2008 20:19:23 -0700
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <2FC21407-84D2-4679-92F0-A1870B1A0694@cs.usfca.edu>
References: <48C3F817.3010305@gmx.at> <48C41C6E.2050305@gmx.at>
	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>
	<48C43110.8060703@gmx.at>
	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>
	<48D40D3B.6010608@gmx.at> <48D5F29B.4080203@gmx.at>
	<48D9444F.7000207@gmx.at>
	<2FC21407-84D2-4679-92F0-A1870B1A0694@cs.usfca.edu>
Message-ID: <1CB32A0E-5CA7-49E6-B208-DC45183457CB@arizona-software.ch>

I'll check that but yes I fixed something a while back about white  
space.

Jean

On Sep 23, 2008, at 12:54 PM, Terence Parr wrote:

> Awesome news!Thanks for finding this.
>
> Jean: didn't we fix the whitespace issue in directory names earlier?
>
> Ter
> On Sep 23, 2008, at 12:32 PM, Markus Stoeger wrote:
>
>> I have finally figured out what is causing the problem.
>>
>> To reproduce: Put the grammar file into a directory with whitespace  
>> in
>> its name, like "My Directory". And set the output directory to  
>> empty (so
>> the output will be put into the same directory as the grammar file).
>>
>> When you launch the debugger on this grammar, it will output silly
>> symbol names in the parse tree. The problem goes away when you put  
>> the
>> grammar into a directory that doesn't contain spaces in its name  
>> (like
>> "MyDirectory").
>>
>> Please try this out and let me know if you can reproduce the  
>> problem now.
>>
>> Max
>>
>> Markus Stoeger schrieb:
>>> Markus Stoeger schrieb:
>>>
>>>> Terence Parr schrieb:
>>>>
>>>>
>>>>> Hi gang,Did we ever figure out what's going on here?
>>>>> Ter
>>>>>
>>>>>
>>>> I've bought a new notebook yesterday and will try it out on that  
>>>> yet new
>>>> system as soon as possible (probably on sunday).
>>>>
>>>>
>>> I've tried it out right now and it works on the new system! I just
>>> compiled the simple grammar that I have posted before (with the x 
>>> +y) and
>>> all symbols are displayed correctly in the debugger's parse tree  
>>> view now.
>>>
>>> But I still don't understand why it doesn't work on the old  
>>> system, on
>>> the system at work and on the VMWare system.
>>>
>>> One difference between the systems is XP and Vista. I'm running XP
>>> (multilang) on all systems where it displays those "ands". Java  
>>> versions
>>> are identical (1.6.7).
>>>
>>> Max
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>


From antlr-list at arizona-software.ch  Tue Sep 23 21:00:05 2008
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Tue, 23 Sep 2008 21:00:05 -0700
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <2FC21407-84D2-4679-92F0-A1870B1A0694@cs.usfca.edu>
References: <48C3F817.3010305@gmx.at>	<48C41C6E.2050305@gmx.at>	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>	<48C43110.8060703@gmx.at>	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>	<48D40D3B.6010608@gmx.at>
	<48D5F29B.4080203@gmx.at> <48D9444F.7000207@gmx.at>
	<2FC21407-84D2-4679-92F0-A1870B1A0694@cs.usfca.edu>
Message-ID: <ACB78DCB-E05C-48D9-8EC1-01862E04A101@arizona-software.ch>

Actually the problem lies in the debugger protocol. More specifically,  
we are tokenizing the string using white space which is causing the  
problem. Look in RemoteDebugEventSocketListener.

For example, an exit rule event might look like that:

event = {java.lang.String at 3056}"exitRule /Users/bovet/Folder With  
Space/DebuggerTreeTest.g x"

But it will be tokenized into:

elements = {java.lang.String[8]@3057}
[0] = {java.lang.String at 3058}"exitRule"
[1] = {java.lang.String at 2782}"/Users/bovet/Folder"
[2] = {java.lang.String at 2783}"With"
[3] = {java.lang.String at 3061}"Space/DebuggerTreeTest.g"
[4] = {java.lang.String at 3062}"x"

so the "With" becomes the name of the node. We will need to tweak the  
protocol a little bit :-)

Jean

On Sep 23, 2008, at 12:54 PM, Terence Parr wrote:

> Awesome news!Thanks for finding this.
>
> Jean: didn't we fix the whitespace issue in directory names earlier?
>
> Ter
> On Sep 23, 2008, at 12:32 PM, Markus Stoeger wrote:
>
>> I have finally figured out what is causing the problem.
>>
>> To reproduce: Put the grammar file into a directory with whitespace  
>> in
>> its name, like "My Directory". And set the output directory to empty
>> (so
>> the output will be put into the same directory as the grammar file).
>>
>> When you launch the debugger on this grammar, it will output silly
>> symbol names in the parse tree. The problem goes away when you put  
>> the
>> grammar into a directory that doesn't contain spaces in its name  
>> (like
>> "MyDirectory").
>>
>> Please try this out and let me know if you can reproduce the problem
>> now.
>>
>> Max
>>
>> Markus Stoeger schrieb:
>>> Markus Stoeger schrieb:
>>>
>>>> Terence Parr schrieb:
>>>>
>>>>
>>>>> Hi gang,Did we ever figure out what's going on here?
>>>>> Ter
>>>>>
>>>>>
>>>> I've bought a new notebook yesterday and will try it out on that
>>>> yet new
>>>> system as soon as possible (probably on sunday).
>>>>
>>>>
>>> I've tried it out right now and it works on the new system! I just
>>> compiled the simple grammar that I have posted before (with the x
>>> +y) and
>>> all symbols are displayed correctly in the debugger's parse tree
>>> view now.
>>>
>>> But I still don't understand why it doesn't work on the old system,
>>> on
>>> the system at work and on the VMWare system.
>>>
>>> One difference between the systems is XP and Vista. I'm running XP
>>> (multilang) on all systems where it displays those "ands". Java
>>> versions
>>> are identical (1.6.7).
>>>
>>> Max
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From parrt at cs.usfca.edu  Tue Sep 23 21:15:08 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 23 Sep 2008 21:15:08 -0700
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <ACB78DCB-E05C-48D9-8EC1-01862E04A101@arizona-software.ch>
References: <48C3F817.3010305@gmx.at>	<48C41C6E.2050305@gmx.at>	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>	<48C43110.8060703@gmx.at>	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>	<48D40D3B.6010608@gmx.at>
	<48D5F29B.4080203@gmx.at> <48D9444F.7000207@gmx.at>
	<2FC21407-84D2-4679-92F0-A1870B1A0694@cs.usfca.edu>
	<ACB78DCB-E05C-48D9-8EC1-01862E04A101@arizona-software.ch>
Message-ID: <B6DC12BF-3CBC-47BB-AA83-FC2560F8392B@cs.usfca.edu>

Crap. Perhaps we just escape spaces (or remove them as gawd intended) ;)

Ter
On Sep 23, 2008, at 9:00 PM, Jean Bovet wrote:

> Actually the problem lies in the debugger protocol. More  
> specifically, we are tokenizing the string using white space which  
> is causing the problem. Look in RemoteDebugEventSocketListener.
>
> For example, an exit rule event might look like that:
>
> event = {java.lang.String at 3056}"exitRule /Users/bovet/Folder With  
> Space/DebuggerTreeTest.g x"
>
> But it will be tokenized into:
>
> elements = {java.lang.String[8]@3057}
> [0] = {java.lang.String at 3058}"exitRule"
> [1] = {java.lang.String at 2782}"/Users/bovet/Folder"
> [2] = {java.lang.String at 2783}"With"
> [3] = {java.lang.String at 3061}"Space/DebuggerTreeTest.g"
> [4] = {java.lang.String at 3062}"x"
>
> so the "With" becomes the name of the node. We will need to tweak  
> the protocol a little bit :-)
>
> Jean
>
> On Sep 23, 2008, at 12:54 PM, Terence Parr wrote:
>
>> Awesome news!Thanks for finding this.
>>
>> Jean: didn't we fix the whitespace issue in directory names earlier?
>>
>> Ter
>> On Sep 23, 2008, at 12:32 PM, Markus Stoeger wrote:
>>
>>> I have finally figured out what is causing the problem.
>>>
>>> To reproduce: Put the grammar file into a directory with  
>>> whitespace in
>>> its name, like "My Directory". And set the output directory to empty
>>> (so
>>> the output will be put into the same directory as the grammar file).
>>>
>>> When you launch the debugger on this grammar, it will output silly
>>> symbol names in the parse tree. The problem goes away when you put  
>>> the
>>> grammar into a directory that doesn't contain spaces in its name  
>>> (like
>>> "MyDirectory").
>>>
>>> Please try this out and let me know if you can reproduce the problem
>>> now.
>>>
>>> Max
>>>
>>> Markus Stoeger schrieb:
>>>> Markus Stoeger schrieb:
>>>>
>>>>> Terence Parr schrieb:
>>>>>
>>>>>
>>>>>> Hi gang,Did we ever figure out what's going on here?
>>>>>> Ter
>>>>>>
>>>>>>
>>>>> I've bought a new notebook yesterday and will try it out on that
>>>>> yet new
>>>>> system as soon as possible (probably on sunday).
>>>>>
>>>>>
>>>> I've tried it out right now and it works on the new system! I just
>>>> compiled the simple grammar that I have posted before (with the x
>>>> +y) and
>>>> all symbols are displayed correctly in the debugger's parse tree
>>>> view now.
>>>>
>>>> But I still don't understand why it doesn't work on the old system,
>>>> on
>>>> the system at work and on the VMWare system.
>>>>
>>>> One difference between the systems is XP and Vista. I'm running XP
>>>> (multilang) on all systems where it displays those "ands". Java
>>>> versions
>>>> are identical (1.6.7).
>>>>
>>>> Max
>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>
>>>>
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>


From atlan at gmx.li  Wed Sep 24 01:46:36 2008
From: atlan at gmx.li (Marc Bischof)
Date: Wed, 24 Sep 2008 10:46:36 +0200
Subject: [antlr-interest] AntlrWorks 1.2
Message-ID: <200809241046.36302.atlan@gmx.li>

Hej List,

I've a problem when using s.th. like this in a tree walker:

stmt
	:	^(stmt c+=A? c+=B? c+=C?)
	-> 	list(content_st={$c})	//template call
	;

In the new version of AntlrWorks I get some type errors with Java-target.

Now, I have 2 questions:
1) can I handle this without changing the template? I want to keep that 
handling if it is possible.
2) can someone send me the antlrworks-1.2b.jar (I can't find it on the website 
or Google)

Cheers,
    Marc

From arik_tg at yahoo.com  Wed Sep 24 02:48:14 2008
From: arik_tg at yahoo.com (Arik Ter-Galstyan)
Date: Wed, 24 Sep 2008 02:48:14 -0700 (PDT)
Subject: [antlr-interest] Getting linker errors while building the ANTLR
	generated sources.
In-Reply-To: <1222182292.12107.78.camel@jimi.temporal-wave.com>
Message-ID: <423449.71229.qm@web32802.mail.mud.yahoo.com>



Thank you all for support. The problem is solved. Instead of using the native antlr.lib I just compiled the ANTLR sources (native sources not the generated ones) and made a new antlr.lib file using VC++ 2008. Then I used the obtained antlr.lib file to link with my project. This time linker did not report any errors.




--- On Tue, 9/23/08, Jim Idle <jimi at temporal-wave.com> wrote:

> From: Jim Idle <jimi at temporal-wave.com>
> Subject: Re: [antlr-interest] Getting linker errors while building the ANTLR generated sources.
> To: arik_tg at yahoo.com
> Cc: antlr-interest at antlr.org, grey_earl at web.de
> Date: Tuesday, September 23, 2008, 8:04 AM
> On Mon, 2008-09-22 at 22:48 -0700, Arik Ter-Galstyan wrote:
> 
> > Markus and Jim thanks a lot for response. 
> > 
> > Jim,
> > 
> > it's not me trying to link the LIBCMT.lib with
> antlr.lib but the VS2008 on it's own tries to link them
> together.
> 
> The project you are using to compile and link the generated
> code is
> doing it. So, right click on your project and select
> properties, C/C++,
> code generation, Runtime Library, "Multi-threaded
> {Debug} DLL (/MDd).
> Use teh Debug version fo rhte Debug target of your [rpject
> and the
> Release version for the Release target of your project.
> 
> 
> 
> 
> >  I think that the ANTLR generated source files contain
> some function which refer to both libs. 
> 
> 
> That's not how it works.
> 
> > When I'm trying to exclude one of the conflicting
> libs from linking process then I get an "Unresolved
> external symbol" type of link error. 
> 
> 
> 
> > Also, please tell me how can I change the project to
> use MSVCRT ?  
> 
> You need to read the documentation for VS2008 projects.
> 
> Jim


      

From jaluber at gmx.de  Wed Sep 24 03:35:04 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 24 Sep 2008 12:35:04 +0200
Subject: [antlr-interest] AntlrWorks 1.2
In-Reply-To: <200809241046.36302.atlan@gmx.li>
References: <200809241046.36302.atlan@gmx.li>
Message-ID: <48DA17D8.5080003@gmx.de>

Marc Bischof schrieb:
> Hej List,
> 
> I've a problem when using s.th. like this in a tree walker:
> 
> stmt
> 	:	^(stmt c+=A? c+=B? c+=C?)
> 	-> 	list(content_st={$c})	//template call
> 	;
> 
> In the new version of AntlrWorks I get some type errors with Java-target.
> 
> Now, I have 2 questions:
> 1) can I handle this without changing the template? I want to keep that 
> handling if it is possible.
> 2) can someone send me the antlrworks-1.2b.jar (I can't find it on the website 
> or Google)

ANTLRworks is available on <http://www.antlr.org/download.html>.

Johannes
> 
> Cheers,
>     Marc
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From lgcraymer at yahoo.com  Wed Sep 24 07:49:20 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Wed, 24 Sep 2008 07:49:20 -0700 (PDT)
Subject: [antlr-interest] Parse tree in the debugger
Message-ID: <665325.35126.qm@web55905.mail.re3.yahoo.com>

Why hack?  Why not specify a DSL for the debugger/profiler/whatever and make the output conform.  That's a whole lot more maintainable over the long run.

--Loring




----- Original Message ----
> From: Terence Parr <parrt at cs.usfca.edu>
> To: Jean Bovet <antlr-list at arizona-software.ch>
> Cc: antlr mailing list <antlr-interest at antlr.org>
> Sent: Tuesday, September 23, 2008 9:15:08 PM
> Subject: Re: [antlr-interest] Parse tree in the debugger
> 
> Crap. Perhaps we just escape spaces (or remove them as gawd intended) ;)
> 
> Ter
> On Sep 23, 2008, at 9:00 PM, Jean Bovet wrote:
> 
> > Actually the problem lies in the debugger protocol. More  
> > specifically, we are tokenizing the string using white space which  
> > is causing the problem. Look in RemoteDebugEventSocketListener.
> >
> > For example, an exit rule event might look like that:
> >
> > event = {java.lang.String at 3056}"exitRule /Users/bovet/Folder With  
> > Space/DebuggerTreeTest.g x"
> >
> > But it will be tokenized into:
> >
> > elements = {java.lang.String[8]@3057}
> > [0] = {java.lang.String at 3058}"exitRule"
> > [1] = {java.lang.String at 2782}"/Users/bovet/Folder"
> > [2] = {java.lang.String at 2783}"With"
> > [3] = {java.lang.String at 3061}"Space/DebuggerTreeTest.g"
> > [4] = {java.lang.String at 3062}"x"
> >
> > so the "With" becomes the name of the node. We will need to tweak  
> > the protocol a little bit :-)
> >
> > Jean
> >
> > On Sep 23, 2008, at 12:54 PM, Terence Parr wrote:
> >
> >> Awesome news!Thanks for finding this.
> >>
> >> Jean: didn't we fix the whitespace issue in directory names earlier?
> >>
> >> Ter
> >> On Sep 23, 2008, at 12:32 PM, Markus Stoeger wrote:
> >>
> >>> I have finally figured out what is causing the problem.
> >>>
> >>> To reproduce: Put the grammar file into a directory with  
> >>> whitespace in
> >>> its name, like "My Directory". And set the output directory to empty
> >>> (so
> >>> the output will be put into the same directory as the grammar file).
> >>>
> >>> When you launch the debugger on this grammar, it will output silly
> >>> symbol names in the parse tree. The problem goes away when you put  
> >>> the
> >>> grammar into a directory that doesn't contain spaces in its name  
> >>> (like
> >>> "MyDirectory").
> >>>
> >>> Please try this out and let me know if you can reproduce the problem
> >>> now.
> >>>
> >>> Max
> >>>
> >>> Markus Stoeger schrieb:
> >>>> Markus Stoeger schrieb:
> >>>>
> >>>>> Terence Parr schrieb:
> >>>>>
> >>>>>
> >>>>>> Hi gang,Did we ever figure out what's going on here?
> >>>>>> Ter
> >>>>>>
> >>>>>>
> >>>>> I've bought a new notebook yesterday and will try it out on that
> >>>>> yet new
> >>>>> system as soon as possible (probably on sunday).
> >>>>>
> >>>>>
> >>>> I've tried it out right now and it works on the new system! I just
> >>>> compiled the simple grammar that I have posted before (with the x
> >>>> +y) and
> >>>> all symbols are displayed correctly in the debugger's parse tree
> >>>> view now.
> >>>>
> >>>> But I still don't understand why it doesn't work on the old system,
> >>>> on
> >>>> the system at work and on the VMWare system.
> >>>>
> >>>> One difference between the systems is XP and Vista. I'm running XP
> >>>> (multilang) on all systems where it displays those "ands". Java
> >>>> versions
> >>>> are identical (1.6.7).
> >>>>
> >>>> Max
> >>>>
> >>>>
> >>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >>>> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >>>>
> >>>>
> >>>
> >>>
> >>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >>> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >>>
> >>
> >>
> >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >>
> >
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From gerald at certiv.net  Wed Sep 24 08:46:00 2008
From: gerald at certiv.net (Gerald Rosenberg)
Date: Wed, 24 Sep 2008 08:46:00 -0700
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <665325.35126.qm@web55905.mail.re3.yahoo.com>
References: <665325.35126.qm@web55905.mail.re3.yahoo.com>
Message-ID: <200809241546.m8OFkSvG011575@zinc.newtechlaw.com>

DBGp is fairly widely used and appears to be the consensus direction 
-- It originated for PHP debugging, but is language 
agnostic.  Eclipse and I believe NetBeans now use built-in DBGp 
servers to handle all debugging operations.  JRuby apparently has a 
java client implementation.

In any event, the protocol has a well defined spec 
(http://www.xdebug.org/docs-dbgp.php) .

C-source is available from the site.  The license is basically BSD.






At 07:49 AM 9/24/2008, Loring Craymer wrote:
>Why hack?  Why not specify a DSL for the debugger/profiler/whatever 
>and make the output conform.  That's a whole lot more maintainable 
>over the long run.
>
>--Loring
>
>
>
>
>----- Original Message ----
> > From: Terence Parr <parrt at cs.usfca.edu>
> > To: Jean Bovet <antlr-list at arizona-software.ch>
> > Cc: antlr mailing list <antlr-interest at antlr.org>
> > Sent: Tuesday, September 23, 2008 9:15:08 PM
> > Subject: Re: [antlr-interest] Parse tree in the debugger
> >
> > Crap. Perhaps we just escape spaces (or remove them as gawd intended) ;)
> >
> > Ter
> > On Sep 23, 2008, at 9:00 PM, Jean Bovet wrote:
> >
> > > Actually the problem lies in the debugger protocol. More
> > > specifically, we are tokenizing the string using white space which
> > > is causing the problem. Look in RemoteDebugEventSocketListener.
> > >
> > > For example, an exit rule event might look like that:
> > >
> > > event = {java.lang.String at 3056}"exitRule /Users/bovet/Folder With
> > > Space/DebuggerTreeTest.g x"
> > >
> > > But it will be tokenized into:
> > >
> > > elements = {java.lang.String[8]@3057}
> > > [0] = {java.lang.String at 3058}"exitRule"
> > > [1] = {java.lang.String at 2782}"/Users/bovet/Folder"
> > > [2] = {java.lang.String at 2783}"With"
> > > [3] = {java.lang.String at 3061}"Space/DebuggerTreeTest.g"
> > > [4] = {java.lang.String at 3062}"x"
> > >
> > > so the "With" becomes the name of the node. We will need to tweak
> > > the protocol a little bit :-)
> > >
> > > Jean
> > >
> > > On Sep 23, 2008, at 12:54 PM, Terence Parr wrote:
> > >
> > >> Awesome news!Thanks for finding this.
> > >>
> > >> Jean: didn't we fix the whitespace issue in directory names earlier?
> > >>
> > >> Ter
> > >> On Sep 23, 2008, at 12:32 PM, Markus Stoeger wrote:
> > >>
> > >>> I have finally figured out what is causing the problem.
> > >>>
> > >>> To reproduce: Put the grammar file into a directory with
> > >>> whitespace in
> > >>> its name, like "My Directory". And set the output directory to empty
> > >>> (so
> > >>> the output will be put into the same directory as the grammar file).
> > >>>
> > >>> When you launch the debugger on this grammar, it will output silly
> > >>> symbol names in the parse tree. The problem goes away when you put
> > >>> the
> > >>> grammar into a directory that doesn't contain spaces in its name
> > >>> (like
> > >>> "MyDirectory").
> > >>>
> > >>> Please try this out and let me know if you can reproduce the problem
> > >>> now.
> > >>>
> > >>> Max
> > >>>
> > >>> Markus Stoeger schrieb:
> > >>>> Markus Stoeger schrieb:
> > >>>>
> > >>>>> Terence Parr schrieb:
> > >>>>>
> > >>>>>
> > >>>>>> Hi gang,Did we ever figure out what's going on here?
> > >>>>>> Ter
> > >>>>>>
> > >>>>>>
> > >>>>> I've bought a new notebook yesterday and will try it out on that
> > >>>>> yet new
> > >>>>> system as soon as possible (probably on sunday).
> > >>>>>
> > >>>>>
> > >>>> I've tried it out right now and it works on the new system! I just
> > >>>> compiled the simple grammar that I have posted before (with the x
> > >>>> +y) and
> > >>>> all symbols are displayed correctly in the debugger's parse tree
> > >>>> view now.
> > >>>>
> > >>>> But I still don't understand why it doesn't work on the old system,
> > >>>> on
> > >>>> the system at work and on the VMWare system.
> > >>>>
> > >>>> One difference between the systems is XP and Vista. I'm running XP
> > >>>> (multilang) on all systems where it displays those "ands". Java
> > >>>> versions
> > >>>> are identical (1.6.7).
> > >>>>
> > >>>> Max
> > >>>>
> > >>>>
> > >>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > >>>> Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> > >>>>
> > >>>>
> > >>>
> > >>>
> > >>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > >>> Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> > >>>
> > >>
> > >>
> > >> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > >> Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> > >>
> > >
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
>
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From cdoucette at vaultus.com  Wed Sep 24 09:12:19 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Wed, 24 Sep 2008 12:12:19 -0400
Subject: [antlr-interest] can't start lexer after beginning of input
	(CharStream.setLine())
Message-ID: <A7746824D386F947BBC285F6EC4716B004850EB386@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

I am attempting to automate auto-completion.

I thought rather than trying to write my own lexer, I should use the one I already wrote.

I am implementing a completion method which is given the contents of a buffer and the offset within that buffer where the cursor is when you attempt to invoke completion.

I use DefaultLineTracker to determine which line number and the target offset within that line.

I want to determine the list of tokens on that line which preceed the point of completion.

Here is most of the code of my lexify method:

      ANTLRStringStream strStream = new ANTLRStringStream(contents);
      strStream.setLine(line);
      int posInLine = 0;
      strStream.setCharPositionInLine(posInLine);
      Lexer lexer = new vscriptLexer(strStream);
      while (posInLine <= targetPosInLine) {
         Token token = lexer.nextToken();
         tokenList.add(token);
         posInLine = lexer.getCharPositionInLine();
      }
      tokens = tokenList.toArray(tokens);
      return tokens;

When I run it, the first token returned is the first token in the file - rather than the token on the line number that I set the input to.

Is it possible to do what I am trying to do?
If so, am I going about it the correct way?

Thanks,
Chuck

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080924/2ed02b7c/attachment.html 

From cdoucette at vaultus.com  Wed Sep 24 09:29:15 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Wed, 24 Sep 2008 12:29:15 -0400
Subject: [antlr-interest] can't start lexer after beginning of
	input	(CharStream.setLine())
In-Reply-To: <A7746824D386F947BBC285F6EC4716B004850EB386@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
References: <A7746824D386F947BBC285F6EC4716B004850EB386@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
Message-ID: <A7746824D386F947BBC285F6EC4716B004850EB395@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

Apparently, I am supposed to call seek(index) and that will update line and charPositionInLine.

Chuck

________________________________
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Doucette, Charles
Sent: Wednesday, September 24, 2008 12:12 PM
To: Antlr
Subject: [antlr-interest] can't start lexer after beginning of input (CharStream.setLine())

I am attempting to automate auto-completion.

I thought rather than trying to write my own lexer, I should use the one I already wrote.

I am implementing a completion method which is given the contents of a buffer and the offset within that buffer where the cursor is when you attempt to invoke completion.

I use DefaultLineTracker to determine which line number and the target offset within that line.

I want to determine the list of tokens on that line which preceed the point of completion.

Here is most of the code of my lexify method:

      ANTLRStringStream strStream = new ANTLRStringStream(contents);
      strStream.setLine(line);
      int posInLine = 0;
      strStream.setCharPositionInLine(posInLine);
      Lexer lexer = new vscriptLexer(strStream);
      while (posInLine <= targetPosInLine) {
         Token token = lexer.nextToken();
         tokenList.add(token);
         posInLine = lexer.getCharPositionInLine();
      }
      tokens = tokenList.toArray(tokens);
      return tokens;

When I run it, the first token returned is the first token in the file - rather than the token on the line number that I set the input to.

Is it possible to do what I am trying to do?
If so, am I going about it the correct way?

Thanks,
Chuck

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080924/4c40f598/attachment.html 

From antlr at jazillian.com  Wed Sep 24 10:03:36 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Wed, 24 Sep 2008 13:03:36 -0400
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <665325.35126.qm@web55905.mail.re3.yahoo.com>
References: <665325.35126.qm@web55905.mail.re3.yahoo.com>
Message-ID: <48DA72E8.6020405@jazillian.com>

Loring Craymer wrote:
> Why hack?  Why not specify a DSL for the debugger/profiler/whatever and make the output conform.  That's a whole lot more maintainable over the long run.
> 
> --Loring
> 

In other words, make your famous quote more general:

"Why spend <X> <X_UNITS> writing it by hand when you can spend <Y> <Y_UNITS> automating it?"

...where in the original quote you had "5 days" and "5 years", now we have "5 minutes"
and "5 weeks" (5 minutes to just fix the space problem, or 5 weeks to invent a real DSL
for ANTLR-interacting tools).

And please, going forward, don't just write out plain English statements such as "Why spend 5 days...".
Instead, provide them as formal assertions in a formal language that can be added to the
appropriate ontology. This makes them much more useful and maintainable.

What's that? The suggestion is not to "automate" but rather to "create a new DSL?" Great!
Since you've creating this cute saying as a formal statement in a flexible DSL, we can replace
the word "automating" with a more general placeholder, which can have instantiations such
as "automating" or "creating a DSL for", etc. And then it's a simple matter to enhance
the semantic analysis to validate it. Isn't that a lot easier than just writing out
a plain English sentence?

There's really no job so small that a new DSL shouldn't be invented for it.
For example, I've now decided that just signing emails "Andy" is just not maintainable.
What if I change my name? What if people want to know my official name? What if people
want to see my name in their native language? So starting now, I'm going to sign
email in XML. I'll be publish the DTD along with a parser any day now.

<Signature>
  <Name language="English">
    <formalName>
         <first>Andrew</first>
         <middle type="initialOnly">H.</middle>
         <last>Tripp</last>
    </formalName>
    <nickname>Andy</nickname>
  </Name>
</Signature>


</snark>Andy ;)

From lgcraymer at yahoo.com  Wed Sep 24 10:19:03 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Wed, 24 Sep 2008 10:19:03 -0700 (PDT)
Subject: [antlr-interest] Parse tree in the debugger
Message-ID: <723240.65637.qm@web55908.mail.re3.yahoo.com>

Andy--

DSLs can be extraordinarily simple; in this case, the solution could be "spend a couple of days codifying (and writing the language processor in a couple of hours--as I said, simple) the output" or adopting Gerald's suggestion (if it covers the profiling output--which it might).  Right now, the protocol is in an "it just grew" state where it is probably easier to do a quick re-design rather than repeated patching.  Sometimes, you just need to find out what you have done, do it right, and move on.

Besides, if you are only using ANTLR for heavy-duty translators, you are unlikely even to be building those efficiently; constructing small DSLs for automation can markedly decrease development time.  It's all about good design practice.

--Loring



----- Original Message ----
> From: Andy Tripp <antlr at jazillian.com>
> Cc: antlr mailing list <antlr-interest at antlr.org>
> Sent: Wednesday, September 24, 2008 10:03:36 AM
> Subject: Re: [antlr-interest] Parse tree in the debugger
> 
> Loring Craymer wrote:
> > Why hack?  Why not specify a DSL for the debugger/profiler/whatever and make 
> the output conform.  That's a whole lot more maintainable over the long run.
> > 
> > --Loring
> > 
> 
> In other words, make your famous quote more general:
> 
> "Why spend writing it by hand when you can spend 
> automating it?"
> 
> ...where in the original quote you had "5 days" and "5 years", now we have "5 
> minutes"
> and "5 weeks" (5 minutes to just fix the space problem, or 5 weeks to invent a 
> real DSL
> for ANTLR-interacting tools).
> 
> And please, going forward, don't just write out plain English statements such as 
> "Why spend 5 days...".
> Instead, provide them as formal assertions in a formal language that can be 
> added to the
> appropriate ontology. This makes them much more useful and maintainable.
> 
> What's that? The suggestion is not to "automate" but rather to "create a new 
> DSL?" Great!
> Since you've creating this cute saying as a formal statement in a flexible DSL, 
> we can replace
> the word "automating" with a more general placeholder, which can have 
> instantiations such
> as "automating" or "creating a DSL for", etc. And then it's a simple matter to 
> enhance
> the semantic analysis to validate it. Isn't that a lot easier than just writing 
> out
> a plain English sentence?
> 
> There's really no job so small that a new DSL shouldn't be invented for it.
> For example, I've now decided that just signing emails "Andy" is just not 
> maintainable.
> What if I change my name? What if people want to know my official name? What if 
> people
> want to see my name in their native language? So starting now, I'm going to sign
> email in XML. I'll be publish the DTD along with a parser any day now.
> 
> 
>   
>     
>         Andrew
>         H.
>         Tripp
>     
>     Andy
>   
> 
> 
> 
> Andy ;)
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From cdoucette at vaultus.com  Wed Sep 24 10:33:01 2008
From: cdoucette at vaultus.com (Doucette, Charles)
Date: Wed, 24 Sep 2008 13:33:01 -0400
Subject: [antlr-interest] can't start lexer after beginning
	of	input	(CharStream.setLine())
In-Reply-To: <A7746824D386F947BBC285F6EC4716B004850EB395@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
References: <A7746824D386F947BBC285F6EC4716B004850EB386@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
	<A7746824D386F947BBC285F6EC4716B004850EB395@vmtbosmail01.VMTBOSTON.VAULTUS.COM>
Message-ID: <A7746824D386F947BBC285F6EC4716B004850EB3B6@vmtbosmail01.VMTBOSTON.VAULTUS.COM>

What's the purpose of the public methods setLine and setCharPositionInLine if they are automatically set via the index (which is changed via seek)?

Chuck

________________________________
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Doucette, Charles
Sent: Wednesday, September 24, 2008 12:29 PM
To: Antlr
Subject: Re: [antlr-interest] can't start lexer after beginning of input (CharStream.setLine())

Apparently, I am supposed to call seek(index) and that will update line and charPositionInLine.

Chuck

________________________________
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Doucette, Charles
Sent: Wednesday, September 24, 2008 12:12 PM
To: Antlr
Subject: [antlr-interest] can't start lexer after beginning of input (CharStream.setLine())

I am attempting to automate auto-completion.

I thought rather than trying to write my own lexer, I should use the one I already wrote.

I am implementing a completion method which is given the contents of a buffer and the offset within that buffer where the cursor is when you attempt to invoke completion.

I use DefaultLineTracker to determine which line number and the target offset within that line.

I want to determine the list of tokens on that line which preceed the point of completion.

Here is most of the code of my lexify method:

      ANTLRStringStream strStream = new ANTLRStringStream(contents);
      strStream.setLine(line);
      int posInLine = 0;
      strStream.setCharPositionInLine(posInLine);
      Lexer lexer = new vscriptLexer(strStream);
      while (posInLine <= targetPosInLine) {
         Token token = lexer.nextToken();
         tokenList.add(token);
         posInLine = lexer.getCharPositionInLine();
      }
      tokens = tokenList.toArray(tokens);
      return tokens;

When I run it, the first token returned is the first token in the file - rather than the token on the line number that I set the input to.

Is it possible to do what I am trying to do?
If so, am I going about it the correct way?

Thanks,
Chuck

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080924/6445ba33/attachment.html 

From antlr at jazillian.com  Wed Sep 24 10:54:55 2008
From: antlr at jazillian.com (Andy Tripp)
Date: Wed, 24 Sep 2008 13:54:55 -0400
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <723240.65637.qm@web55908.mail.re3.yahoo.com>
References: <723240.65637.qm@web55908.mail.re3.yahoo.com>
Message-ID: <48DA7EEF.6050305@jazillian.com>

Yes, a DSL can be trivial, but not using a DSL can be even more trivial.
If it takes just days to create a DSL, it might take just seconds to just "hack it".

The "protocol" might be something so simple that it could be described in a
sentence or two, or as trivial data structure or two. I have no idea
how simple the ANTLR/Antlrworks interface is, but if it can be described
in email that's shorter than this one, a DSL is overkill, IMO.

And even if it's a non-trivial interface, a DSL might not be the simplest/
most maintainable solution. Just having a couple of methods like:

ANTLRInfo getANTLRInfo(SomeCriteria p);
void sendANTLRInfo(SomethingElse p);

...and using RMI might be the easiest. No DSL, no parsing engine, no
validation. Just passing around simple Java objects.

DSLs have their place, but they're not the best solution in a lot of cases,
like trivial communications within or between Java programs.

Andy

Loring Craymer wrote:
> Andy--
> 
> DSLs can be extraordinarily simple; in this case, the solution could be "spend a couple of days codifying (and writing the language processor in a couple of hours--as I said, simple) the output" or adopting Gerald's suggestion (if it covers the profiling output--which it might).  Right now, the protocol is in an "it just grew" state where it is probably easier to do a quick re-design rather than repeated patching.  Sometimes, you just need to find out what you have done, do it right, and move on.
> 
> Besides, if you are only using ANTLR for heavy-duty translators, you are unlikely even to be building those efficiently; constructing small DSLs for automation can markedly decrease development time.  It's all about good design practice.
> 
> --Loring

From hallorant at gmail.com  Wed Sep 24 11:03:54 2008
From: hallorant at gmail.com (Tim Halloran)
Date: Wed, 24 Sep 2008 14:03:54 -0400
Subject: [antlr-interest] Avoiding ClassCastExceptions in
	org.antlr.runtime.tree.BaseTree (Limitation in ANTLR v 3.1)
Message-ID: <a36ab4bc0809241103v387a9cf3vdac81fedc3f2b906@mail.gmail.com>

I'm using the standard Tree implementations (extending BaseTree) in
combination with a custom implementation of Tree.  The problem is that
BaseTree assumes that it is only being used with subclasses of BaseTree
despite it's implementation really not needing to make this assumption.  I
propose fixing the code to eliminate this problem.

I modified the getChild() and toStringTree() methods in BaseTree.java.  I
changed lines 56 and 297 to cast to Tree, instead of BaseTree.  For example:

    public Tree getChild(int i) {
        if ( children==null || i>=children.size() ) {
            return null;
        }
        return (Tree) children.get(i);  // line 56
    }

There might be some other places to change, but I have only encountered
problems with these.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080924/239ca594/attachment.html 

From lgcraymer at yahoo.com  Wed Sep 24 11:05:17 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Wed, 24 Sep 2008 11:05:17 -0700 (PDT)
Subject: [antlr-interest] Parse tree in the debugger
Message-ID: <149888.46197.qm@web55905.mail.re3.yahoo.com>

Andy--

The protocol is not so simple that it can be specified in a short email (lots of message types), and even the RMI approach you suggest would involve a comprehensive redesign.

--Loring



----- Original Message ----
> From: Andy Tripp <antlr at jazillian.com>
> To: Loring Craymer <lgcraymer at yahoo.com>
> Cc: antlr mailing list <antlr-interest at antlr.org>
> Sent: Wednesday, September 24, 2008 10:54:55 AM
> Subject: Re: [antlr-interest] Parse tree in the debugger
> 
> Yes, a DSL can be trivial, but not using a DSL can be even more trivial.
> If it takes just days to create a DSL, it might take just seconds to just "hack 
> it".
> 
> The "protocol" might be something so simple that it could be described in a
> sentence or two, or as trivial data structure or two. I have no idea
> how simple the ANTLR/Antlrworks interface is, but if it can be described
> in email that's shorter than this one, a DSL is overkill, IMO.
> 
> And even if it's a non-trivial interface, a DSL might not be the simplest/
> most maintainable solution. Just having a couple of methods like:
> 
> ANTLRInfo getANTLRInfo(SomeCriteria p);
> void sendANTLRInfo(SomethingElse p);
> 
> ...and using RMI might be the easiest. No DSL, no parsing engine, no
> validation. Just passing around simple Java objects.
> 
> DSLs have their place, but they're not the best solution in a lot of cases,
> like trivial communications within or between Java programs.
> 
> Andy
> 
> Loring Craymer wrote:
> > Andy--
> > 
> > DSLs can be extraordinarily simple; in this case, the solution could be "spend 
> a couple of days codifying (and writing the language processor in a couple of 
> hours--as I said, simple) the output" or adopting Gerald's suggestion (if it 
> covers the profiling output--which it might).  Right now, the protocol is in an 
> "it just grew" state where it is probably easier to do a quick re-design rather 
> than repeated patching.  Sometimes, you just need to find out what you have 
> done, do it right, and move on.
> > 
> > Besides, if you are only using ANTLR for heavy-duty translators, you are 
> unlikely even to be building those efficiently; constructing small DSLs for 
> automation can markedly decrease development time.  It's all about good design 
> practice.
> > 
> > --Loring



      

From werner.punz at gmail.com  Wed Sep 24 14:12:24 2008
From: werner.punz at gmail.com (Werner Punz)
Date: Wed, 24 Sep 2008 23:12:24 +0200
Subject: [antlr-interest] weird internal false problem
Message-ID: <gbeafp$34m$1@ger.gmane.org>

Hello

First of all I am new to ANTLR and it has been quite a few
years since I did my last parser so a lot of knowledge is lost on my side.
That much for an excuse now to my problem.
I have a weird problem I try to define
a grammar which has two character streams which are both delimited by a 
token.

grammar testtrue;

options{backtrack=true;}

tokens {
	END	=	'TPL*/';
	BEGIN	= 	'/*TPL';
	TTRUE	=	'true';
	TFALSE	=	'false';
}


r	:	stream (BEGIN codestream END stream)*;
codestream :	~BEGIN+;
stream	:	~END+;



ALPHA	:	('A'..'Z'|'a'..'z'|'_'|'-');


NUMBER	:	'0'..'9';



QUOTE	:	'"';
VARIDENT:	'$';
CMDIDENT:	'#';
CURLL	:	'{';
CURLR	:	'}';

BRACEL	:	'(';
BRACER	:	')';

LBRACK  :	 '[';
RBRACK  :	 ']';

POINT	:	'.';
COMMA	:	',';

SMALLER	:	'<';
BIGGER	:	'>';
JAVADELIM
	:	';';	
SLASH	:	'/';
MULT	:	'*';


WS  : (' '|'\r'|'\t'|'\u000C'|'\n');
     	

So far so good but if I feed it with following input

public class xxx {
   public void hello() {
	int myvar "hello world"
dfadf
adf
/*TPL
dddd
TPL*/
DDD

It resolves everything properly as exected but I get following output on 
the console:

line 4:3 mismatched character 'd' expecting 'l'

I tried with several combinations and it seems that in the stream part 
on dfadf it tries to find a false and does not get one.
It seems to apply the token TTFALSE here, instead of just adding the
characters to the stream until the BEGIN token is reached.

What do I have to do to get this right?

Thanks in advance

Werner Punz



From antlr at mirality.co.nz  Wed Sep 24 14:16:59 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 25 Sep 2008 09:16:59 +1200
Subject: [antlr-interest] Parse tree in the debugger
In-Reply-To: <B6DC12BF-3CBC-47BB-AA83-FC2560F8392B@cs.usfca.edu>
References: <48C3F817.3010305@gmx.at> <48C41C6E.2050305@gmx.at>
	<36c8729e0809071144i69bdfe5ch6ae4e13c5681b4d6@mail.gmail.com>
	<48C43110.8060703@gmx.at>
	<D3DB64EE-B38E-4CF1-B7D3-735E63008C54@cs.usfca.edu>
	<48D40D3B.6010608@gmx.at> <48D5F29B.4080203@gmx.at>
	<48D9444F.7000207@gmx.at>
	<2FC21407-84D2-4679-92F0-A1870B1A0694@cs.usfca.edu>
	<ACB78DCB-E05C-48D9-8EC1-01862E04A101@arizona-software.ch>
	<B6DC12BF-3CBC-47BB-AA83-FC2560F8392B@cs.usfca.edu>
Message-ID: <20080924211712.263AC31296B@www.antlr.org>

At 16:15 24/09/2008, Terence Parr wrote:
 >Crap. Perhaps we just escape spaces (or remove them as gawd
 >intended) ;)

Just put the filename in double-quotes.  That's the usual method.


From e.mortoray at ecircle.com  Wed Sep 24 23:00:37 2008
From: e.mortoray at ecircle.com (edA-qa mort-ora-y)
Date: Thu, 25 Sep 2008 08:00:37 +0200
Subject: [antlr-interest] tokens not working in rewrite rules
Message-ID: <48DB2905.1040605@ecircle.com>

Using antlr3 I have the following rule:

searchSortExpr
    :    SORT id ( ',' id )* order=(ASC|DESC) ENDEXPR -> ^(SORT {$order}
id*  );

Where 'id' is basically a string, SORT='sort', ENDEXPR=';', ASC='ASC',
DESC='DESC'.  This can match such productions as:

    sort column ASC;

But in rewriting the {$order} part is simply gone: it is lost from the tree.

What am I doing wrong? Or how do I  use such named tokens correctly in
the rewriting rules?

-- 
edA-qa mort-ora-y
Director Quality Assurance
______________________________________________________
eCircle AG - Inside Digital Marketing
Nymphenburger Str. 86
80636 M?nchen

Tel    +49-89-12009-773
Fax    +49-89-12009-750

E-Mail mailto:e.mort-ora-y at ecircle.com
Web    http://www.ecircle.com

______________________________________________________
Aktuelles
"Inside Digital Marketing" - der Newsletter f?r die
Online-Branche von eCircle. Jeden Monat neu & voll
mit aktuellen Fallstudien und hilfreichen Tipps!
Jetzt kostenlos abonnieren:

http://www.ecircle.com/de/newsletter
______________________________________________________

eCircle AG, HRB 136 334, Handelsregister M?nchen
Vorstand:  Lothar Lanz, Volker Wiewer (Vorsitzende), 
Thomas Wilke, Lars W?ssner, Alexander Meyer
Vorsitzender des Aufsichtsrates: Dr. Mark W?ssner


From david.ferrao at gmail.com  Thu Sep 25 03:03:33 2008
From: david.ferrao at gmail.com (David Ferrao)
Date: Thu, 25 Sep 2008 15:33:33 +0530
Subject: [antlr-interest] "Coarse grained" errors in antlr
Message-ID: <aaae5980809250303l65e41693m71d4db4850d239d1@mail.gmail.com>

Hi and apologies for the newbie question.

I am trying to build an autocomplete mechanism using antlr error messages,
but am facing a problem where the parser seems to bail out one rule earlier
than I  would like.
To illustrate, consider the following grammar snippet.

--------Antlr 3 snippet-------
create  : 'CREATE'  stream;
stream    : 'STREAM' qname 'TYPE' stream_types;
stream_types : map_schema| java_bean|xml_schema;
map_schema    :'MAP_SCHEMA' '{' (value_list)? '}';
java_bean    :'JAVA_BEAN' '(' class_name ')' '{' '}';
xml_schema    :'XML_SCHEMA' '(' string_literal ')' '{' '}';

....contd...

---------end Grammar------

Given the string "CREATE STREAM system:TEST TYPE MAP_SCHEMA" as input, the
parser generates the following NoViableAltException

"36:1: stream_types : ( map_schema | java_bean | xml_schema );"

This is a completely logical error considering that the parser cannot match
either "map_schema" or  "java_bean" or "xml_schema".
However, it is not very helpful for my auto complete scenario which would be
better served by an error message stating that a '{' was expected.
I was wondering if there is any option /technique to coax the parser to
start executing and consequently throw a NoViableAltException in the
"map_schema" rule, considering that the input DOES contain the 'MAP_SCHEMA'
token.

Would deeply appreciate any inputs, I have skimmed through the 'Definitive
ANTLR reference', but still couldnt come up with a solution :(

Thanks
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080925/976c90eb/attachment.html 

From heinrich at silasvalley.com  Thu Sep 25 03:27:17 2008
From: heinrich at silasvalley.com (Heinrich du Toit)
Date: Thu, 25 Sep 2008 12:27:17 +0200
Subject: [antlr-interest] C parser - tree generation - memory problem
Message-ID: <48DB6785.2090509@silasvalley.com>

Hi

MY code kept on giving segfaults..
So I traced it..

in antlr3commontree.c:
function newPool: ( around line 99)

basicly the ANTLR3_CALLOC there to create a new pool fails after a while..
Runs out of memory :(
But If you print out factory->thisPool then it runs very high.. high 
enough to flood a GB or 2..



anyways this causes segfault in newPoolTree.

segfault happens usually on this line:
    tree->baseTree.super    = tree;


Not sure how to fix but I'm suprised the thing runs out of memory :(
I'm guessing it has todo with the way backtrace or memoize is implemented?

Attached is the .g grammer file..
And also the testme.txt file on which this things segfaults itself.

btw. using cygwin


thanks for any help..
-H

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Ctree.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080925/162be43b/attachment.pl 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: testme.txt
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080925/162be43b/attachment.txt 

From heinrich at silasvalley.com  Thu Sep 25 03:37:48 2008
From: heinrich at silasvalley.com (Heinrich du Toit)
Date: Thu, 25 Sep 2008 12:37:48 +0200
Subject: [antlr-interest] C parser - tree generation - memory problem
In-Reply-To: <48DB6785.2090509@silasvalley.com>
References: <48DB6785.2090509@silasvalley.com>
Message-ID: <48DB69FC.6040806@silasvalley.com>

adding the null check in newPooltree seems to stop the segfault.. I 
think. not 100% sure.

Although the thing still nukes my memory almost completely in the process :(




static    pANTLR3_BASE_TREE
newPoolTree        (pANTLR3_ARBORETUM factory)
{
    pANTLR3_COMMON_TREE    tree;

    // See if we need a new tree pool before allocating a new tree
    //
    if    (factory->nextTree >= ANTLR3_FACTORY_POOL_SIZE)
    {
        // We ran out of tokens in the current pool, so we need a new pool
        //
        newPool(factory);
    }

    // Assuming everything went well - we are trying for performance 
here so doing minimal
    // error checking - then we can work out what the pointer is to the 
next commontree.
    //
    tree   = factory->pools[factory->thisPool] + factory->nextTree;
    factory->nextTree++;

    if (!tree){
        return NULL;
    }

    // We have our token pointer now, so we can initialize it to the 
predefined model.
    //
    ANTLR3_MEMMOVE((void *)tree, (const void *)&(factory->unTruc), 
(ANTLR3_UINT32)sizeof(ANTLR3_COMMON_TREE));

    // The super points to the common tree so we must override the one 
used by
    // by the pre-built tree as otherwise we will always poitn to the 
same initial
    // common tree and we might spend 3 hours trying to debug why - this 
would never
    // happen to me of course! :-(
    //



    tree->baseTree.super    = tree;

    // And we are done
    //

    return  &(tree->baseTree);
}


From antlr at mirality.co.nz  Thu Sep 25 04:34:53 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 25 Sep 2008 23:34:53 +1200
Subject: [antlr-interest] weird internal false problem
In-Reply-To: <gbeafp$34m$1@ger.gmane.org>
References: <gbeafp$34m$1@ger.gmane.org>
Message-ID: <20080925113503.0594C11ECAD@www.antlr.org>

At 09:12 25/09/2008, Werner Punz wrote:
 >ALPHA	:	('A'..'Z'|'a'..'z'|'_'|'-');
[...]
 >So far so good but if I feed it with following input
 >
 >public class xxx {
 >   public void hello() {
 >	int myvar "hello world"
 >dfadf
 >adf
 >/*TPL
 >dddd
 >TPL*/
 >DDD
 >
 >It resolves everything properly as exected but I get following
 >output on the console:
 >
 >line 4:3 mismatched character 'd' expecting 'l'

Add a + to the end of the ALPHA rule.


From florent.teichteil at gmail.com  Thu Sep 25 07:11:59 2008
From: florent.teichteil at gmail.com (Florent Teichteil)
Date: Thu, 25 Sep 2008 16:11:59 +0200
Subject: [antlr-interest] C target broken?
Message-ID: <43c48b360809250711k7ce2442dqd7c65f5a525eba80@mail.gmail.com>

Hi,

After 1 month working on an other project, I am trying to recompile an
ANTLR3.1 project. My grammar was generated using ANTLR 3.1b2, but the
corresponding C target is no more available. Then, I install
libantlr3c-3.1 : the C target runtime library is not compatible with
the code generated using ANTLR 3.1b2 !

As a result, I regenerate my grammar with ANTLR 3.1, but the generated
code does not compile because "tree" variables in C structures are not
declared:

// BEGIN OF CODE

typedef struct ppddlParser_ppddlDoc_return_struct
{
    /** Generic return elements for ANTLR3 rules that are not in tree
parsers or returning trees
     */
    pANTLR3_COMMON_TOKEN    start;
    pANTLR3_COMMON_TOKEN    stop;
    	tree;                                                  // ERROR HERE!

}
    ppddlParser_ppddlDoc_return;

// END OF CODE

I tried both ANTLRworks and ANTLR IDE v3 for eclipse, without success...
In other words, it seems the code generator and the C runtime library
provided on ANTLR website are not compatible.
Which version of ANTLR and of the C runtime library should I use?

By the way, based on my own experience, it is often quite difficult to
find the C target runtime library whose version corresponds to the
right version of ANTLR that generated the C code. Would there be a
clearer way to associate the versions of the code generator and of the
runtime libraries?

Best,
Florent

From lgcraymer at yahoo.com  Thu Sep 25 07:37:21 2008
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Thu, 25 Sep 2008 07:37:21 -0700 (PDT)
Subject: [antlr-interest] "Coarse grained" errors in antlr
Message-ID: <968100.23674.qm@web55904.mail.re3.yahoo.com>

This is doable, but it may be more painful than you would like--lots of grammar surgery.  You should not be parsing error messages; you should override reportError() in your parser (much easier and more informative than parsing error messages) and get the token information from the input stream.  Without some form of resynchronization during error recovery, you are also dependent on having a correct grammar except at the point where the user is typing; that seems undesirable, but maybe you have some way around that.

--Loring



----- Original Message ----
From: David Ferrao <david.ferrao at gmail.com>
To: antlr-interest at antlr.org
Sent: Thursday, September 25, 2008 3:03:33 AM
Subject: [antlr-interest] "Coarse grained" errors in antlr


Hi and apologies for the newbie question.

I am trying to build an autocomplete mechanism using antlr error messages, but am facing a problem where the parser seems to bail out one rule earlier than I  would like.
To illustrate, consider the following grammar snippet.

--------Antlr 3 snippet-------
create  : 'CREATE'  stream;
stream    : 'STREAM' qname 'TYPE' stream_types;
stream_types : map_schema| java_bean|xml_schema;
map_schema    :'MAP_SCHEMA' '{' (value_list)? '}';
java_bean    :'JAVA_BEAN' '(' class_name ')' '{' '}';
xml_schema    :'XML_SCHEMA' '(' string_literal ')' '{' '}';

....contd...

---------end Grammar------

Given the string "CREATE STREAM system:TEST TYPE MAP_SCHEMA" as input, the parser generates the following NoViableAltException

"36:1: stream_types : ( map_schema | java_bean | xml_schema );"

This is a completely logical error considering that the parser cannot match either "map_schema" or  "java_bean" or "xml_schema". 
However, it is not very helpful for my auto complete scenario which would be better served by an error message stating that a '{' was expected.
I was wondering if there is any option /technique to coax the parser to start executing and consequently throw a NoViableAltException in the "map_schema" rule, considering that the input DOES contain the 'MAP_SCHEMA' token.

Would deeply appreciate any inputs, I have skimmed through the 'Definitive ANTLR reference', but still couldnt come up with a solution :( 

Thanks
David



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080925/96fbdf48/attachment.html 

From heinrich at silasvalley.com  Thu Sep 25 08:43:57 2008
From: heinrich at silasvalley.com (Heinrich du Toit)
Date: Thu, 25 Sep 2008 17:43:57 +0200
Subject: [antlr-interest] C target broken?
In-Reply-To: <43c48b360809250711k7ce2442dqd7c65f5a525eba80@mail.gmail.com>
References: <43c48b360809250711k7ce2442dqd7c65f5a525eba80@mail.gmail.com>
Message-ID: <48DBB1BD.2000101@silasvalley.com>

I'm also having problems with C target.. but I think you can solve this 
with specifying ASTLabelType.

e.g.
grammar Cee;

options{
 
    backtrack   = true;

    language    = C;
    output    = AST;

    ASTLabelType= pANTLR3_BASE_TREE;   
}

I'm still having other problems with C target :(
atleast it seems to work better than the python target which doesn't 
even generate successfully inside antlrworks :(





Florent Teichteil wrote:
> Hi,
>
> After 1 month working on an other project, I am trying to recompile an
> ANTLR3.1 project. My grammar was generated using ANTLR 3.1b2, but the
> corresponding C target is no more available. Then, I install
> libantlr3c-3.1 : the C target runtime library is not compatible with
> the code generated using ANTLR 3.1b2 !
>
> As a result, I regenerate my grammar with ANTLR 3.1, but the generated
> code does not compile because "tree" variables in C structures are not
> declared:
>
> // BEGIN OF CODE
>
> typedef struct ppddlParser_ppddlDoc_return_struct
> {
>     /** Generic return elements for ANTLR3 rules that are not in tree
> parsers or returning trees
>      */
>     pANTLR3_COMMON_TOKEN    start;
>     pANTLR3_COMMON_TOKEN    stop;
>     	tree;                                                  // ERROR HERE!
>
> }
>     ppddlParser_ppddlDoc_return;
>
> // END OF CODE
>
> I tried both ANTLRworks and ANTLR IDE v3 for eclipse, without success...
> In other words, it seems the code generator and the C runtime library
> provided on ANTLR website are not compatible.
> Which version of ANTLR and of the C runtime library should I use?
>
> By the way, based on my own experience, it is often quite difficult to
> find the C target runtime library whose version corresponds to the
> right version of ANTLR that generated the C code. Would there be a
> clearer way to associate the versions of the code generator and of the
> runtime libraries?
>
> Best,
> Florent
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>   


From florent.teichteil at gmail.com  Thu Sep 25 09:31:08 2008
From: florent.teichteil at gmail.com (Florent Teichteil)
Date: Thu, 25 Sep 2008 18:31:08 +0200
Subject: [antlr-interest] C target broken?
In-Reply-To: <48DBB1BD.2000101@silasvalley.com>
References: <43c48b360809250711k7ce2442dqd7c65f5a525eba80@mail.gmail.com>
	<48DBB1BD.2000101@silasvalley.com>
Message-ID: <1222360268.27746.4.camel@localhost>

Thank you! It perfectly works for me!

Le jeudi 25 septembre 2008 ? 17:43 +0200, Heinrich du Toit a ?crit :
> I'm also having problems with C target.. but I think you can solve this 
> with specifying ASTLabelType.
> 
> e.g.
> grammar Cee;
> 
> options{
>  
>     backtrack   = true;
> 
>     language    = C;
>     output    = AST;
> 
>     ASTLabelType= pANTLR3_BASE_TREE;   
> }
> 
> I'm still having other problems with C target :(
> atleast it seems to work better than the python target which doesn't 
> even generate successfully inside antlrworks :(
> 
> 
> 
> 
> 
> Florent Teichteil wrote:
> > Hi,
> >
> > After 1 month working on an other project, I am trying to recompile an
> > ANTLR3.1 project. My grammar was generated using ANTLR 3.1b2, but the
> > corresponding C target is no more available. Then, I install
> > libantlr3c-3.1 : the C target runtime library is not compatible with
> > the code generated using ANTLR 3.1b2 !
> >
> > As a result, I regenerate my grammar with ANTLR 3.1, but the generated
> > code does not compile because "tree" variables in C structures are not
> > declared:
> >
> > // BEGIN OF CODE
> >
> > typedef struct ppddlParser_ppddlDoc_return_struct
> > {
> >     /** Generic return elements for ANTLR3 rules that are not in tree
> > parsers or returning trees
> >      */
> >     pANTLR3_COMMON_TOKEN    start;
> >     pANTLR3_COMMON_TOKEN    stop;
> >     	tree;                                                  // ERROR HERE!
> >
> > }
> >     ppddlParser_ppddlDoc_return;
> >
> > // END OF CODE
> >
> > I tried both ANTLRworks and ANTLR IDE v3 for eclipse, without success...
> > In other words, it seems the code generator and the C runtime library
> > provided on ANTLR website are not compatible.
> > Which version of ANTLR and of the C runtime library should I use?
> >
> > By the way, based on my own experience, it is often quite difficult to
> > find the C target runtime library whose version corresponds to the
> > right version of ANTLR that generated the C code. Would there be a
> > clearer way to associate the versions of the code generator and of the
> > runtime libraries?
> >
> > Best,
> > Florent
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >
> >   
> 


From werner.punz at gmail.com  Thu Sep 25 10:32:19 2008
From: werner.punz at gmail.com (Werner Punz)
Date: Thu, 25 Sep 2008 19:32:19 +0200
Subject: [antlr-interest] weird internal false problem
In-Reply-To: <20080925113503.0594C11ECAD@www.antlr.org>
References: <gbeafp$34m$1@ger.gmane.org>
	<20080925113503.0594C11ECAD@www.antlr.org>
Message-ID: <gbghv3$fv8$1@ger.gmane.org>

Thanks that did it, wonderful...


Werner


Gavin Lambert schrieb:
> At 09:12 25/09/2008, Werner Punz wrote:
>  >ALPHA	:	('A'..'Z'|'a'..'z'|'_'|'-');
> [...]
>  >So far so good but if I feed it with following input
>  >
>  >public class xxx {
>  >   public void hello() {
>  >	int myvar "hello world"
>  >dfadf
>  >adf
>  >/*TPL
>  >dddd
>  >TPL*/
>  >DDD
>  >
>  >It resolves everything properly as exected but I get following
>  >output on the console:
>  >
>  >line 4:3 mismatched character 'd' expecting 'l'
> 
> Add a + to the end of the ALPHA rule.
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 


From heinrich at silasvalley.com  Thu Sep 25 12:01:32 2008
From: heinrich at silasvalley.com (Heinrich du Toit)
Date: Thu, 25 Sep 2008 21:01:32 +0200
Subject: [antlr-interest] C parser - tree generation - memory problem
In-Reply-To: <1792171576-1222365879-cardhu_decombobulator_blackberry.rim.net-1256321294-@bxe008.bisx.prod.on.blackberry>
References: <48DB6785.2090509@silasvalley.com>
	<1792171576-1222365879-cardhu_decombobulator_blackberry.rim.net-1256321294-@bxe008.bisx.prod.on.blackberry>
Message-ID: <48DBE00C.9000300@silasvalley.com>

Thanks for the information!

Can you please just clarify what you mean with "perforce" ?

Only place I can find that have c API downloads is 
:http://www.antlr.org/download/C/
and only 3.1 is there... obviously.
So where exactly do I download this?

thanks


Jim Idle wrote:
> Plear update to latest 3.1.1 dist as this is fixed. You will need to get this from perforce for a few days.
>
> It was just debugging code duplicating bodes. 
>
> Jim
> Sent via BlackBerry from T-Mobile
>
> -----Original Message-----
> From: Heinrich du Toit <heinrich at silasvalley.com>
>
> Date: Thu, 25 Sep 2008 12:27:17 
> To: <antlr-interest at antlr.org>
> Subject: [antlr-interest] C parser - tree generation - memory problem
>
>
> Hi
>
> MY code kept on giving segfaults..
> So I traced it..
>
> in antlr3commontree.c:
> function newPool: ( around line 99)
>
> basicly the ANTLR3_CALLOC there to create a new pool fails after a while..
> Runs out of memory :(
> But If you print out factory->thisPool then it runs very high.. high 
> enough to flood a GB or 2..
>
>
>
> anyways this causes segfault in newPoolTree.
>
> segfault happens usually on this line:
>     tree->baseTree.super    = tree;
>
>
> Not sure how to fix but I'm suprised the thing runs out of memory :(
> I'm guessing it has todo with the way backtrace or memoize is implemented?
>
> Attached is the .g grammer file..
> And also the testme.txt file on which this things segfaults itself.
>
> btw. using cygwin
>
>
> thanks for any help..
> -H
>
>
>   


From o.b.fischer at gmx.de  Thu Sep 25 17:13:16 2008
From: o.b.fischer at gmx.de (Oliver B. Fischer)
Date: Fri, 26 Sep 2008 02:13:16 +0200
Subject: [antlr-interest] Why was dupTree() removed from BaseTree
Message-ID: <48DC291C.8000308@gmx.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear all,

I am migrating from 3.0.1 to 3.1 and recognized that dupTree() has been
removed from BaseTree.

I used this method in many places in my code. That is the intended
replacement for this methodn?

Bye


Oliver


- --
Oliver B. Fischer, Sch?nhauser Allee 64, 10437 Berlin
Tel. +49 30 44793251, Mobil: +49 178 7903538
Mail: o.b.fischer at gmx.de Blog: http://www.sw-blog.net
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkjcKRwACgkQbyc4N0PdoAzufwCfe9A0bE6o/y+HC5chEdSC83J2
xjEAn38PJIoorkVcaqbWBa40yDwJHlU9
=KV5y
-----END PGP SIGNATURE-----

From parrt at cs.usfca.edu  Thu Sep 25 17:42:39 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 25 Sep 2008 17:42:39 -0700
Subject: [antlr-interest] Why was dupTree() removed from BaseTree
In-Reply-To: <48DC291C.8000308@gmx.de>
References: <48DC291C.8000308@gmx.de>
Message-ID: <B13CF28E-2B6A-4CE4-9E0E-2DECF9ABAE82@cs.usfca.edu>


On Sep 25, 2008, at 5:13 PM, Oliver B. Fischer wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Dear all,
>
> I am migrating from 3.0.1 to 3.1 and recognized that dupTree() has  
> been
> removed from BaseTree.
>
> I used this method in many places in my code. That is the intended
> replacement for this methodn?

Sorry about that...I think we figured it was generic enough; moved to  
BaseTreeAdaptor:

	public Object dupTree(Object tree) {...}

Will that work?

We needed to move to ast rewriting stuff in v3.1

Ter

From sprevrha at gmail.com  Thu Sep 25 23:46:35 2008
From: sprevrha at gmail.com (Sven Prevrhal)
Date: Thu, 25 Sep 2008 23:46:35 -0700
Subject: [antlr-interest] how to parse a fraction
Message-ID: <48dc8559.1498600a.4319.0c49@mx.google.com>

One like 1/2 ? 

INT '/' INT does not work as it requires spaces between the numbers and the
slash.

 

Thanks a lot, extremely green noob Sven

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080925/5091d73c/attachment.html 

From antlr at mirality.co.nz  Fri Sep 26 00:42:52 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 26 Sep 2008 19:42:52 +1200
Subject: [antlr-interest] how to parse a fraction
In-Reply-To: <48dc8559.1498600a.4319.0c49@mx.google.com>
References: <48dc8559.1498600a.4319.0c49@mx.google.com>
Message-ID: <20080926074302.859B211ECE4@www.antlr.org>

At 18:46 26/09/2008, Sven Prevrhal wrote:
>One like 1/2 ?
>INT ?/? INT does not work as it requires spaces 
>between the numbers and the slash


If you've defined your grammar in the standard 
way (and if the above is in a parser rule), it 
won't actually require spaces (but it won't 
object if they're there).

INT : ('0'..'9')+;
SLASH : '/';
WS : (' ' | '\t' | '\r' | '\n')+ { $channel = HIDDEN; };

fraction : INT SLASH INT;

The above should match "1/2", "1   /2", "1/   2", 
and "1     /    2" (among other combinations).

Now, if you explicitly want to *forbid* 
whitespace to appear in there, you'll have to 
match it entirely as a lexer rule:

fragment INT : ('0'..'9')+;
SLASH : '/';
FRACTION
   :  INT
      ( (SLASH) => SLASH INT
      | { $type = INT; }
      )
   ;
WS : (' ' | '\t' | '\r' | '\n')+ { $channel = HIDDEN; };

value : INT | FRACTION;

Of course, if you have a division operator then 
all of the above is probably redundant, since the 
fraction one-half is the result of treating "1/2" 
as a division expression (unless you're doing 
integer division, of course).


From david.ferrao at gmail.com  Fri Sep 26 04:36:05 2008
From: david.ferrao at gmail.com (David Ferrao)
Date: Fri, 26 Sep 2008 17:06:05 +0530
Subject: [antlr-interest] "Coarse grained" errors in antlr
In-Reply-To: <968100.23674.qm@web55904.mail.re3.yahoo.com>
References: <968100.23674.qm@web55904.mail.re3.yahoo.com>
Message-ID: <aaae5980809260436h21c0b2b1u24ab112cb665180d@mail.gmail.com>

I looked at the RecognitionException state in reportError and could not find
much that would help me with expected tokens (that I could use as auto
complete suggestions). "e.token" and "e.getUnExpectedType()" point to the
error token. Only e.grammarDecisionDescription (which requires parsing)
contains expected tokens. parser.getTokenNames() returns all the token names
in the grammer, not just the expected ones.

Just to re-iterate, even RecognitionException.grammarDecisionDescription is
not suitable for my purposes in some cases (as explained in the original
thread).

I started on this approach based on the suggestions at
http://www.antlr.org/pipermail/antlr-interest/2007-April/020291.html.
Are there any better ways to implement this functionality? I admit, I didn't
quite understand the "rule actions" approach mentioned at the link above.

Thanks
David

On Thu, Sep 25, 2008 at 8:07 PM, Loring Craymer <lgcraymer at yahoo.com> wrote:

> This is doable, but it may be more painful than you would like--lots of
> grammar surgery.  You should not be parsing error messages; you should
> override reportError() in your parser (much easier and more informative than
> parsing error messages) and get the token information from the input
> stream.  Without some form of resynchronization during error recovery, you
> are also dependent on having a correct grammar except at the point where the
> user is typing; that seems undesirable, but maybe you have some way around
> that.
>
> --Loring
>
> ----- Original Message ----
> From: David Ferrao <david.ferrao at gmail.com>
> To: antlr-interest at antlr.org
> Sent: Thursday, September 25, 2008 3:03:33 AM
> Subject: [antlr-interest] "Coarse grained" errors in antlr
>
> Hi and apologies for the newbie question.
>
> I am trying to build an autocomplete mechanism using antlr error messages,
> but am facing a problem where the parser seems to bail out one rule earlier
> than I  would like.
> To illustrate, consider the following grammar snippet.
>
> --------Antlr 3 snippet-------
> create  : 'CREATE'  stream;
> stream    : 'STREAM' qname 'TYPE' stream_types;
> stream_types : map_schema| java_bean|xml_schema;
> map_schema    :'MAP_SCHEMA' '{' (value_list)? '}';
> java_bean    :'JAVA_BEAN' '(' class_name ')' '{' '}';
> xml_schema    :'XML_SCHEMA' '(' string_literal ')' '{' '}';
>
> ....contd...
>
> ---------end Grammar------
>
> Given the string "CREATE STREAM system:TEST TYPE MAP_SCHEMA" as input, the
> parser generates the following NoViableAltException
>
> "36:1: stream_types : ( map_schema | java_bean | xml_schema );"
>
> This is a completely logical error considering that the parser cannot match
> either "map_schema" or  "java_bean" or "xml_schema".
> However, it is not very helpful for my auto complete scenario which would
> be better served by an error message stating that a '{' was expected.
> I was wondering if there is any option /technique to coax the parser to
> start executing and consequently throw a NoViableAltException in the
> "map_schema" rule, considering that the input DOES contain the 'MAP_SCHEMA'
> token.
>
> Would deeply appreciate any inputs, I have skimmed through the 'Definitive
> ANTLR reference', but still couldnt come up with a solution :(
>
> Thanks
> David
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080926/b9a969aa/attachment.html 

From sprevrha at gmail.com  Fri Sep 26 11:25:48 2008
From: sprevrha at gmail.com (Sven Prevrhal)
Date: Fri, 26 Sep 2008 11:25:48 -0700
Subject: [antlr-interest] how to parse a fraction
In-Reply-To: <20080926074303.CE433448EE33@noreply.email.ucsf.edu>
References: <48dc8559.1498600a.4319.0c49@mx.google.com>
	<20080926074303.CE433448EE33@noreply.email.ucsf.edu>
Message-ID: <48dd2934.1c078e0a.116c.ffffe38a@mx.google.com>

Thanks Gavin, that worked ! - and I have another question! Here's my .g file
contents:

grammar fractest;

integer	:	INT;
fraction:	INT SLASH INT;
float	:	INT DOT INT;
word	:	~('\r' | '\n' | ' ' | '\t')+ ;

INT	:	'0'..'9'+;
SLASH 	:	'/';
DOT	:	'.';
WS 	:	(' ' | '\t')+ {$channel = HIDDEN;} ;

This above works. However, this below  where I replaced the word parser rule
with a WORD lexer token

integer	:	INT;
fraction:	INT SLASH INT;
float	:	INT DOT INT;

WORD	:	~('\r' | '\n' | ' ' | '\t')+ ;
INT	:	'0'..'9'+;
SLASH 	:	'/';
DOT	:	'.';
WS 	:	(' ' | '\t')+ {$channel = HIDDEN;} ;

does not work for fraction like 2/3 but it does work for 2 / 3 (with
spaces). Is it that when I define a word through the lexer it precedes the
fraction definition and grabs 2/3 as a WORD?

Second question:

If I define 

amount	:	integer
		| fraction
		| float
		;

with the first code block, rule 'amount' works for fractions and floats but
not for integers (no viable alt exception)! What is happening?

Thanks so much, greetings to NZ from SF, CA
Sven, extremely green noob

-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Friday, September 26, 2008 12:43 AM
To: sven.prevrhal at ucsf.edu; antlr-interest at antlr.org
Subject: Re: [antlr-interest] how to parse a fraction

At 18:46 26/09/2008, Sven Prevrhal wrote:
>One like 1/2 ?
>INT '/' INT does not work as it requires spaces 
>between the numbers and the slash.

If you've defined your grammar in the standard 
way (and if the above is in a parser rule), it 
won't actually require spaces (but it won't 
object if they're there).

INT : ('0'..'9')+;
SLASH : '/';
WS : (' ' | '\t' | '\r' | '\n')+ { $channel = HIDDEN; };

fraction : INT SLASH INT;

The above should match "1/2", "1   /2", "1/   2", 
and "1     /    2" (among other combinations).

Now, if you explicitly want to *forbid* 
whitespace to appear in there, you'll have to 
match it entirely as a lexer rule:

fragment INT : ('0'..'9')+;
SLASH : '/';
FRACTION
   :  INT
      ( (SLASH) => SLASH INT
      | { $type = INT; }
      )
   ;
WS : (' ' | '\t' | '\r' | '\n')+ { $channel = HIDDEN; };

value : INT | FRACTION;

Of course, if you have a division operator then 
all of the above is probably redundant, since the 
fraction one-half is the result of treating "1/2" 
as a division expression (unless you're doing 
integer division, of course).



From sprevrha at gmail.com  Fri Sep 26 11:56:22 2008
From: sprevrha at gmail.com (Sven Prevrhal)
Date: Fri, 26 Sep 2008 11:56:22 -0700
Subject: [antlr-interest] how to parse a number and a unit
In-Reply-To: <20080926074303.CE433448EE33@noreply.email.ucsf.edu>
References: <48dc8559.1498600a.4319.0c49@mx.google.com>
	<20080926074303.CE433448EE33@noreply.email.ucsf.edu>
Message-ID: <48dd305c.1c078e0a.116c.ffffea62@mx.google.com>

I want to parse a number and a unit - with the code below 'ingline' can
parse 
5.2sm
But not 
5.2 sm
- why?

If I add a rule
space	:	(' ' | '\t')+;
and modify ingline to
ingline	:	float space? unit;
then both lines, with or without space. However, the 'space' now appears in
the parse tree. Now if I parse a  line with multiple spaces like so
5.2     sm
this works too BUT the 'space' no longer appears in the parse tree (I use
ANTLworks)!!!! I AM A BIG QUESTION MARK. And 
ingline	:	float WS? unit won't work at all.

Please enlighten me  - Sven

---- My GRAMMAR ----

grammar fractest;

ingline	:	float unit;

integer	:	INT;
fraction:	INT SLASH INT;
float	:	INT DOT INT;
word	:	~('\r' | '\n' | ' ' | '\t')+ ;
unit	:	'x ' | 'sm' | 'md' | 'lg' | 'cn' | 'pk' | 'pn' | 'dr' | 'ds'
               | 'ct' | 'bn' | 'sl' | 'ea' | 't ' | 'ts' | 'T ' | 'tb' |
'fl'
               | 'c ' | 'pt' | 'qt' | 'ga' | 'oz' | 'lb' | 'ml' | 'cb' |
'cl'
               | 'dl' | 'l ' | 'mg' | 'cg' | 'dg' | 'g ' | 'kg' | '  ';

INT	:	'0'..'9'+;
SLASH 	:	'/';
DOT	:	'.';
WS 	:	(' ' | '\t')+ {$channel = HIDDEN;} ;



-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Friday, September 26, 2008 12:43 AM
To: sven.prevrhal at ucsf.edu; antlr-interest at antlr.org
Subject: Re: [antlr-interest] how to parse a fraction

At 18:46 26/09/2008, Sven Prevrhal wrote:
>One like 1/2 ?
>INT '/' INT does not work as it requires spaces 
>between the numbers and the slash.

If you've defined your grammar in the standard 
way (and if the above is in a parser rule), it 
won't actually require spaces (but it won't 
object if they're there).

INT : ('0'..'9')+;
SLASH : '/';
WS : (' ' | '\t' | '\r' | '\n')+ { $channel = HIDDEN; };

fraction : INT SLASH INT;

The above should match "1/2", "1   /2", "1/   2", 
and "1     /    2" (among other combinations).

Now, if you explicitly want to *forbid* 
whitespace to appear in there, you'll have to 
match it entirely as a lexer rule:

fragment INT : ('0'..'9')+;
SLASH : '/';
FRACTION
   :  INT
      ( (SLASH) => SLASH INT
      | { $type = INT; }
      )
   ;
WS : (' ' | '\t' | '\r' | '\n')+ { $channel = HIDDEN; };

value : INT | FRACTION;

Of course, if you have a division operator then 
all of the above is probably redundant, since the 
fraction one-half is the result of treating "1/2" 
as a division expression (unless you're doing 
integer division, of course).



From antlr at mirality.co.nz  Fri Sep 26 16:21:45 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 27 Sep 2008 11:21:45 +1200
Subject: [antlr-interest] how to parse a fraction
In-Reply-To: <48dd2934.1c078e0a.116c.ffffe38a@mx.google.com>
References: <48dc8559.1498600a.4319.0c49@mx.google.com>
	<20080926074303.CE433448EE33@noreply.email.ucsf.edu>
	<48dd2934.1c078e0a.116c.ffffe38a@mx.google.com>
Message-ID: <20080926232156.2DE09352296@www.antlr.org>

At 06:25 27/09/2008, Sven Prevrhal wrote:
 >This above works. However, this below  where I replaced the word 

 >parser rule with a WORD lexer token
 >
 >integer	:	INT;
 >fraction:	INT SLASH INT;
 >float	:	INT DOT INT;
 >
 >WORD	:	~('\r' | '\n' | ' ' | '\t')+ ;
 >INT	:	'0'..'9'+;
 >SLASH 	:	'/';
 >DOT	:	'.';
 >WS 	:	(' ' | '\t')+ {$channel = HIDDEN;} ;
 >
 >does not work for fraction like 2/3 but it does work for 2 / 3
 >(with spaces). Is it that when I define a word through the lexer 

 >it precedes the fraction definition and grabs 2/3 as a WORD?

Right.  When multiple lexer rules can possibly match a given 
input, ANTLR will usually choose the one that seems to match more 
of it -- and failing that, will match the first rule listed.

The quick fix would be to include '/' as one of the characters 
that can't appear within a WORD; you should probably also list it 
last, just in case.

 >Second question:
 >
 >If I define
 >
 >amount	:	integer
 >		| fraction
 >		| float
 >		;
 >
 >with the first code block, rule 'amount' works for fractions and 

 >floats but not for integers (no viable alt exception)! What is
 >happening?

You have a common left prefix (the first token of all three alts 
is INT); this sort of thing can sometimes confuse ANTLR -- 
although usually it's better about it when it's present in the 
parser, rather than the lexer.

Try rewriting your rule like this, first of all, to make it test 
the least-consuming alternative last:

amount : fraction
        | float
        | integer
        ;

If that doesn't work, then try adding predicates to force it to 
use explicit lookahead:

amount : (fraction) => fraction
        | (float) => float
        | integer
        ;


From antlr at mirality.co.nz  Fri Sep 26 16:35:46 2008
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 27 Sep 2008 11:35:46 +1200
Subject: [antlr-interest] how to parse a number and a unit
In-Reply-To: <48dd305c.1c078e0a.116c.ffffea62@mx.google.com>
References: <48dc8559.1498600a.4319.0c49@mx.google.com>
	<20080926074303.CE433448EE33@noreply.email.ucsf.edu>
	<48dd305c.1c078e0a.116c.ffffea62@mx.google.com>
Message-ID: <20080926233552.2B77011ED25@www.antlr.org>

At 06:56 27/09/2008, Sven Prevrhal wrote:
 >I want to parse a number and a unit - with the code below 
'ingline'
 >can parse 5.2sm But not 5.2 sm - why?
 >
 >If I add a rule
 >space	:	(' ' | '\t')+;
 >and modify ingline to
 >ingline	:	float space? unit;
 >then both lines, with or without space. However, the 'space' now 

 >appears in the parse tree. Now if I parse a  line with multiple
 >spaces like so
 >5.2     sm
 >this works too BUT the 'space' no longer appears in the parse 
tree
 >(I use ANTLworks)!!!! I AM A BIG QUESTION MARK. And
 >ingline	:	float WS? unit won't work at all.
[...]
 >word	:	~('\r' | '\n' | ' ' | '\t')+ ;
 >unit	:	'x ' | 'sm' | 'md' | 'lg' | 'cn' | 'pk' | 'pn' | 'dr'
 >      | 'ds' | 'ct' | 'bn' | 'sl' | 'ea' | 't ' | 'ts' | 'T '
 >      | 'tb' | 'fl' | 'c ' | 'pt' | 'qt' | 'ga' | 'oz' | 'lb'
 >      | 'ml' | 'cb' | 'cl' | 'dl' | 'l ' | 'mg' | 'cg' | 'dg'
 >      | 'g ' | 'kg' | ' ';
[...]
 >WS 	:	(' ' | '\t')+ {$channel = HIDDEN;} ;

I know that using character literals like this in the parser is 
tempting, but when you're starting out using ANTLR it can lead to 
just such confusing results.  I think it's best to avoid them 
entirely and just write explicit lexer rules.  Not only does this 
lead to less confusion, but you get to name the token types better 
:)

First off, the reason why using "WS" in a parser rule doesn't work 
is that the WS rule emits its token on a hidden channel, so it's 
completely invisible to the parser -- it will simply never see a 
WS, so can't possibly match it.

Next, when you defined the 'space' rule: as this is a parser rule, 
and you're using quoted literals, *each* quoted string becomes a 
token in its own right.  In other words, this:

space : (' ' | '\t')+;

is basically equivalent to this:

T52 : ' ';
T53 : '\t';
space : (T52 | T53)+;

Now, if you combine this with the lexer rule WS, what you end up 
with is a lexer that says "ok, if there's a single space, then 
it's a T52 and the parser can see it.  If there's more than one 
space, it's a WS and the parser can't see any of them."  Hopefully 
it's now obvious why you're getting the behaviour you're 
describing.  (The "word" and "unit" rules will cause similar 
problems.)

The way I usually prefer to approach parsing tasks is to first 
write a complete standalone lexer (and a set of unit tests to 
ensure it's producing the set of tokens I'm expecting).  Only when 
that is done do I write the parser rules that then interpret the 
resulting tokens.

Another potentially useful rule of thumb: for some inputs, 
whitespace truly is significant, and you *shouldn't* hide it.  For 
others, it's not, and you should.  In the latter case, sometimes 
you will have cases (eg. single-line comments) where the 
whitespace needs to be treated as significant in one specific 
area, but not globally; in these cases, you need to handle it all 
in the lexer, since the lexer can still see the whitespace but the 
parser cannot.


From o.b.fischer at gmx.de  Sat Sep 27 11:01:56 2008
From: o.b.fischer at gmx.de (Oliver B. Fischer)
Date: Sat, 27 Sep 2008 20:01:56 +0200
Subject: [antlr-interest] Why was dupTree() removed from BaseTree
In-Reply-To: <B13CF28E-2B6A-4CE4-9E0E-2DECF9ABAE82@cs.usfca.edu>
References: <48DC291C.8000308@gmx.de>
	<B13CF28E-2B6A-4CE4-9E0E-2DECF9ABAE82@cs.usfca.edu>
Message-ID: <48DE7514.8070406@gmx.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Ter,

Yes, this is a solution for me. Not the best one, since I wrote a base
class for me my parser and the method getTreeAdapter() will be defined
in the final parser class, but this is not an real issue.

But might it be, that the error recovering also changed a little bit? I
had to overwrite the recoverFromMismatchedToken() method to force my
parser to fail if it finds an unexpected token.

Bye

Oliver

Terence Parr schrieb:
> 
> On Sep 25, 2008, at 5:13 PM, Oliver B. Fischer wrote:
> 
>> -----BEGIN PGP SIGNED MESSAGE-----
>> Hash: SHA1
>>
>> Dear all,
>>
>> I am migrating from 3.0.1 to 3.1 and recognized that dupTree() has been
>> removed from BaseTree.
>>
>> I used this method in many places in my code. That is the intended
>> replacement for this methodn?
> 
> Sorry about that...I think we figured it was generic enough; moved to
> BaseTreeAdaptor:
> 
>     public Object dupTree(Object tree) {...}
> 
> Will that work?
> 
> We needed to move to ast rewriting stuff in v3.1
> 
> Ter
> 

- --
Oliver B. Fischer, Sch?nhauser Allee 64, 10437 Berlin
Tel. +49 30 44793251, Mobil: +49 178 7903538
Mail: o.b.fischer at gmx.de Blog: http://www.sw-blog.net
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkjedRQACgkQbyc4N0PdoAy20ACeLWEIPCsdrUUKAdixC/yNItZW
nEMAn1GU759FZbvcFQC/mvQrJ1R6rcnT
=QrQs
-----END PGP SIGNATURE-----


From parrt at cs.usfca.edu  Sat Sep 27 11:27:51 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 27 Sep 2008 11:27:51 -0700
Subject: [antlr-interest] Why was dupTree() removed from BaseTree
In-Reply-To: <48DE7514.8070406@gmx.de>
References: <48DC291C.8000308@gmx.de>
	<B13CF28E-2B6A-4CE4-9E0E-2DECF9ABAE82@cs.usfca.edu>
	<48DE7514.8070406@gmx.de>
Message-ID: <2CF6FC4B-7C56-4AED-8858-14A25E293845@cs.usfca.edu>


On Sep 27, 2008, at 11:01 AM, Oliver B. Fischer wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Hello Ter,
>
> Yes, this is a solution for me. Not the best one, since I wrote a base
> class for me my parser and the method getTreeAdapter() will be defined
> in the final parser class, but this is not an real issue.

I think you could just define dupTree to invoke your adapter.

> But might it be, that the error recovering also changed a little  
> bit? I
> had to overwrite the recoverFromMismatchedToken() method to force my
> parser to fail if it finds an unexpected token.

To properly handle insertion of missing tokens, I had to change the  
interface of match and so on. I was hoping that most people were not  
overriding the basic functionality. doh! I can help you update things  
on your side. Just let me know how I can help, such as answering these  
questions :)

Ter

From spamhole at gmx.at  Sun Sep 28 10:31:36 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Sun, 28 Sep 2008 19:31:36 +0200
Subject: [antlr-interest] Remove left recursion function
Message-ID: <48DFBF78.4030400@gmx.at>

Hello,

I tried to use the "Refactor" -> "Remove left recursion" function but 
couldn't get it to work. When generating the parser ANTLR detects the 
left recursion. But when I place the cursor on the offending symbol and 
try to start the "Remove left recursion" function it says "The rule 
doesn't have a left recursion.".

Also ANTLR spits out the following exception in the console whenever it 
detects a left recursion while generating a grammar:

java.lang.ClassCastException: org.antlr.tool.Rule cannot be cast to 
java.lang.String
    at 
org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.markLeftRecursiveRules(Unknown 
Source)
    at 
org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.analyze(Unknown Source)
    at org.antlr.works.grammar.engine.GrammarEngineImpl.analyze(Unknown 
Source)
    at org.antlr.works.grammar.CheckGrammar.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)

I'm not sure if this has anything to do with the "Remove left recursion" 
function not working.

These problems seem to happen with every grammar that has a left recursion.

Max


From parrt at cs.usfca.edu  Sun Sep 28 12:45:31 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 28 Sep 2008 12:45:31 -0700
Subject: [antlr-interest] Remove left recursion function
In-Reply-To: <48DFBF78.4030400@gmx.at>
References: <48DFBF78.4030400@gmx.at>
Message-ID: <BA8C6F8B-B2F9-4518-A0FE-9177D00A6A54@cs.usfca.edu>

Which version of AW?
Ter
On Sep 28, 2008, at 10:31 AM, Markus Stoeger wrote:

> Hello,
>
> I tried to use the "Refactor" -> "Remove left recursion" function but
> couldn't get it to work. When generating the parser ANTLR detects the
> left recursion. But when I place the cursor on the offending symbol  
> and
> try to start the "Remove left recursion" function it says "The rule
> doesn't have a left recursion.".
>
> Also ANTLR spits out the following exception in the console whenever  
> it
> detects a left recursion while generating a grammar:
>
> java.lang.ClassCastException: org.antlr.tool.Rule cannot be cast to
> java.lang.String
>    at
> org 
> .antlr 
> .works 
> .grammar.antlr.ANTLRGrammarEngineImpl.markLeftRecursiveRules(Unknown
> Source)
>    at
> org.antlr.works.grammar.antlr.ANTLRGrammarEngineImpl.analyze(Unknown  
> Source)
>    at org.antlr.works.grammar.engine.GrammarEngineImpl.analyze(Unknown
> Source)
>    at org.antlr.works.grammar.CheckGrammar.run(Unknown Source)
>    at java.lang.Thread.run(Unknown Source)
>
> I'm not sure if this has anything to do with the "Remove left  
> recursion"
> function not working.
>
> These problems seem to happen with every grammar that has a left  
> recursion.
>
> Max
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From o.b.fischer at gmx.de  Sun Sep 28 12:52:33 2008
From: o.b.fischer at gmx.de (Oliver B. Fischer)
Date: Sun, 28 Sep 2008 21:52:33 +0200
Subject: [antlr-interest] Why was dupTree() removed from BaseTree
In-Reply-To: <2CF6FC4B-7C56-4AED-8858-14A25E293845@cs.usfca.edu>
References: <48DC291C.8000308@gmx.de>
	<B13CF28E-2B6A-4CE4-9E0E-2DECF9ABAE82@cs.usfca.edu>
	<48DE7514.8070406@gmx.de>
	<2CF6FC4B-7C56-4AED-8858-14A25E293845@cs.usfca.edu>
Message-ID: <48DFE081.7000307@gmx.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Ter,

thank you. I solved all problems in the mean time.

May you can add this issues to
http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.1+Release+Notes below
"Incompatibility issues"?

Bye

Oliver

Terence Parr schrieb:
> 
> On Sep 27, 2008, at 11:01 AM, Oliver B. Fischer wrote:
> 
>> -----BEGIN PGP SIGNED MESSAGE-----
>> Hash: SHA1
>>
>> Hello Ter,
>>
>> Yes, this is a solution for me. Not the best one, since I wrote a base
>> class for me my parser and the method getTreeAdapter() will be defined
>> in the final parser class, but this is not an real issue.
> 
> I think you could just define dupTree to invoke your adapter.
> 
>> But might it be, that the error recovering also changed a little bit? I
>> had to overwrite the recoverFromMismatchedToken() method to force my
>> parser to fail if it finds an unexpected token.
> 
> To properly handle insertion of missing tokens, I had to change the
> interface of match and so on. I was hoping that most people were not
> overriding the basic functionality. doh! I can help you update things on
> your side. Just let me know how I can help, such as answering these
> questions :)
> 
> Ter
> 

- --
Oliver B. Fischer, Sch?nhauser Allee 64, 10437 Berlin
Tel. +49 30 44793251, Mobil: +49 178 7903538
Mail: o.b.fischer at gmx.de Blog: http://www.sw-blog.net
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iEYEARECAAYFAkjf4IEACgkQbyc4N0PdoAx4IgCfadbQOX6NGAjAbmlXJfVumvOz
7qkAn0tQTBMNG5WaY4MmHJ6BZNS9j4D+
=JL9b
-----END PGP SIGNATURE-----

From spamhole at gmx.at  Sun Sep 28 14:15:33 2008
From: spamhole at gmx.at (Markus Stoeger)
Date: Sun, 28 Sep 2008 23:15:33 +0200
Subject: [antlr-interest] Remove left recursion function
In-Reply-To: <BA8C6F8B-B2F9-4518-A0FE-9177D00A6A54@cs.usfca.edu>
References: <48DFBF78.4030400@gmx.at>
	<BA8C6F8B-B2F9-4518-A0FE-9177D00A6A54@cs.usfca.edu>
Message-ID: <48DFF3F5.8040803@gmx.at>

Terence Parr schrieb:
> Which version of AW?

The latest, v1.2.

Max


From parrt at cs.usfca.edu  Sun Sep 28 16:59:11 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 28 Sep 2008 16:59:11 -0700
Subject: [antlr-interest] Remove left recursion function
In-Reply-To: <48DFF3F5.8040803@gmx.at>
References: <48DFBF78.4030400@gmx.at>
	<BA8C6F8B-B2F9-4518-A0FE-9177D00A6A54@cs.usfca.edu>
	<48DFF3F5.8040803@gmx.at>
Message-ID: <F12187CB-80E4-494E-B535-5885BFBD6C6B@cs.usfca.edu>


On Sep 28, 2008, at 2:15 PM, Markus Stoeger wrote:

> Terence Parr schrieb:
>> Which version of AW?
>
> The latest, v1.2.
>

Can you show the left-recur rule it won't left-factor?  Not all can be  
I think.
Ter


From lars.vonwedel at bayertechnology.com  Sun Sep 28 23:37:22 2008
From: lars.vonwedel at bayertechnology.com (lars.vonwedel at bayertechnology.com)
Date: Mon, 29 Sep 2008 08:37:22 +0200
Subject: [antlr-interest] Using Antlr for Visual Studio Language Services
Message-ID: <OF3EE55484.AD22E4FD-ONC12574D3.0023E7F2-C12574D3.0024611A@bayer.de>

Hello,

has someone made progress in using an Antlr grammar for devloping a 
language service for Visual Studio ? 
There was a thread on the mailing concerning this topic list a while ago 
(2005), but I haven't found more recent information.

http://www.antlr.org/pipermail/antlr-interest/2005-December/014658.html

I have some time available I can spend so any ideas on how to proceed are 
welcome.

Freundliche Gr??e / Best Regards
Lars von Wedel
_________________________________________

Bayer Technology Services GmbH
BTS-PT-PD-ES
Leverkusen, E 41
Phone: +49 214 30 56456
Fax: +49 214 30 62677
E-mail: lars.vonwedel at bayertechnology.com
Web: www.bayertechnology.com

Gesch?ftsf?hrer: Achim Noack
Aufsichtsratsvorsitzender: Dr. Wolfgang Plischke
Sitz der Gesellschaft: Leverkusen   |   Eintragung: Amtsgericht K?ln, HRB 
49896
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080929/b02a1b12/attachment.html 

From david.pearce at mcs.vuw.ac.nz  Mon Sep 29 00:25:55 2008
From: david.pearce at mcs.vuw.ac.nz (David Pearce)
Date: Mon, 29 Sep 2008 20:25:55 +1300
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
 ANTLR3.0.1 does not ?
Message-ID: <48E08303.1030107@mcs.vuw.ac.nz>

Hi all,

I have a grammar which works with ANTLR 3.0.1, but no longer works with 
  ANTLR 3.1.  In particular, it seems to boil down to a strange 
difference between the way the tree rewrite rules work.

Here's the simplest grammar I could construct which illustrates the problem:

> grammar Test;
> 
> options {
>  output=AST;
>  k=2; 
>  backtrack=true; 
>  memoize=true;
> }
> 
> tokens {
>  LIST;
> }
> 
> list : '(' listBody ')' -> ^(LIST listBody)
>      ;
> 
> listBody : list -> list
>          | 
> 	 ;
> 
> WS  :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;}
>     ;

Now, if I use some boiler plate code to create a lexer/parser (see end 
of email), and then fire the following input into it "(())", I get the 
following error:

> org.antlr.runtime.tree.RewriteEmptyStreamException: rule listBody

The reason is that the empty production has no rewrite.  However, in 
ANTLR 3.0.1, this error did not happen.

So, my question is: is this is a bug, or intentional behaviour?  I 
basically want to know before I invest time fixing up my grammar!  And, 
while the above is easy enough to fix, the situations where this arises 
in my real grammar are much more awkward ...

So, any help would be really appreciated!

Cheers,

Dave

-- 
Lecturer in Computer Science,
School of Mathematics, Statistics and Computer Science,
Victoria University of Wellington,
PO Box 600,
Wellington,
New Zealand.

Office: Cotton 231
Telephone: +64 (0)4 463 5833
URL: http://www.mcs.vuw.ac.nz/~djp


>         TestLexer lex = new TestLexer(new ANTLRFileStream(args[0]));
>        	CommonTokenStream tokens = new CommonTokenStream(lex);
> 	
>         TestParser parser = new TestParser(tokens);
> 
> 	// now, attempt to parse the input file
> 	
>         try {
>             parser.list();
> 	    System.out.println("input parsed.");
>         } catch (RuntimeException e)  {
> 	    // if we get here, then there was a problem parsing the
> 	    // input file.
> 	    System.out.println("input NOT parsed.");
> 	    System.out.println(e);
>         }



From sharwell at pixelminegames.com  Mon Sep 29 08:42:22 2008
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Mon, 29 Sep 2008 10:42:22 -0500
Subject: [antlr-interest] Using Antlr for Visual Studio Language Services
In-Reply-To: <OF3EE55484.AD22E4FD-ONC12574D3.0023E7F2-C12574D3.0024611A@bayer.de>
References: <OF3EE55484.AD22E4FD-ONC12574D3.0023E7F2-C12574D3.0024611A@bayer.de>
Message-ID: <86403CA0939415448BCCB83855EFE09A64E47E@Bloodymary.ironwillgames.com>

Our IDE uses ANTLR as the core processor for IntelliSense, plus a custom Lexer base class that allows the lexer to double as the syntax highlighter core. We've created a modular language service framework for ANTLR-based language services, an ANTLR v3 language service for editing the grammars, and tied the grammars directly into the build process. After we get our release ready, I'm planning to spend some time documenting key portions of the process of creating antlr-based language services.

 

http://wiki.pixelminegames.com/index.php?title=Tools:UnrealScript_Studio:Features

 

I call it an IDE instead of a plug-in because even the Microsoft languages are implemented in this fashion, and they are not called plugins. J

 

Sam

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of lars.vonwedel at bayertechnology.com
Sent: Monday, September 29, 2008 1:37 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Using Antlr for Visual Studio Language Services

 


Hello, 

has someone made progress in using an Antlr grammar for devloping a language service for Visual Studio ? 
There was a thread on the mailing concerning this topic list a while ago (2005), but I haven't found more recent information. 

http://www.antlr.org/pipermail/antlr-interest/2005-December/014658.html 

I have some time available I can spend so any ideas on how to proceed are welcome. 

Freundliche Gr??e / Best Regards
Lars von Wedel
_________________________________________

Bayer Technology Services GmbH
BTS-PT-PD-ES
Leverkusen, E 41
Phone: +49 214 30 56456
Fax: +49 214 30 62677
E-mail: lars.vonwedel at bayertechnology.com
Web: www.bayertechnology.com

Gesch?ftsf?hrer: Achim Noack
Aufsichtsratsvorsitzender: Dr. Wolfgang Plischke
Sitz der Gesellschaft: Leverkusen   |   Eintragung: Amtsgericht K?ln, HRB 49896

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080929/3a63a05a/attachment.html 

From parrt at cs.usfca.edu  Mon Sep 29 10:06:11 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 29 Sep 2008 10:06:11 -0700
Subject: [antlr-interest] Why was dupTree() removed from BaseTree
In-Reply-To: <48DFE081.7000307@gmx.de>
References: <48DC291C.8000308@gmx.de>
	<B13CF28E-2B6A-4CE4-9E0E-2DECF9ABAE82@cs.usfca.edu>
	<48DE7514.8070406@gmx.de>
	<2CF6FC4B-7C56-4AED-8858-14A25E293845@cs.usfca.edu>
	<48DFE081.7000307@gmx.de>
Message-ID: <FA7F81DA-0F40-4B0E-B38C-85C7998C31CA@cs.usfca.edu>


On Sep 28, 2008, at 12:52 PM, Oliver B. Fischer wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Hello Ter,
>
> thank you. I solved all problems in the mean time.
>
> May you can add this issues to
> http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.1+Release+Notes below
> "Incompatibility issues"?

Updated. thanks.
Ter

From parrt at cs.usfca.edu  Mon Sep 29 10:07:39 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 29 Sep 2008 10:07:39 -0700
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
	ANTLR3.0.1 does not ?
In-Reply-To: <48E08303.1030107@mcs.vuw.ac.nz>
References: <48E08303.1030107@mcs.vuw.ac.nz>
Message-ID: <1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>


On Sep 29, 2008, at 12:25 AM, David Pearce wrote:
> Now, if I use some boiler plate code to create a lexer/parser (see end
> of email), and then fire the following input into it "(())", I get the
> following error:
>
>> org.antlr.runtime.tree.RewriteEmptyStreamException: rule listBody
>
> The reason is that the empty production has no rewrite.  However, in
> ANTLR 3.0.1, this error did not happen.
>
> So, my question is: is this is a bug, or intentional behaviour?  I

hi!

It is proper behavior; if there is no listBody then list must indicate  
there is an error.

Ter

From jaluber at gmx.de  Mon Sep 29 12:12:54 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Mon, 29 Sep 2008 21:12:54 +0200
Subject: [antlr-interest] Remove left recursion function
In-Reply-To: <F12187CB-80E4-494E-B535-5885BFBD6C6B@cs.usfca.edu>
References: <48DFBF78.4030400@gmx.at>	<BA8C6F8B-B2F9-4518-A0FE-9177D00A6A54@cs.usfca.edu>	<48DFF3F5.8040803@gmx.at>
	<F12187CB-80E4-494E-B535-5885BFBD6C6B@cs.usfca.edu>
Message-ID: <48E128B6.7040106@gmx.de>

Terence Parr schrieb:
> On Sep 28, 2008, at 2:15 PM, Markus Stoeger wrote:
> 
>> Terence Parr schrieb:
>>> Which version of AW?
>> The latest, v1.2.
>>
> 
> Can you show the left-recur rule it won't left-factor?  Not all can be  
> I think.
> Ter

Usually the problematic rules have parentheses like:

rule : (rule TERM1
     |  TERM2) rule2
     ;

The only way to get AW to do that removal is to remove the parentheses
correctly first:

rule : rule TERM1 rule2
     |  TERM2 rule2
     ;

Johannes

> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From David.Pearce at mcs.vuw.ac.nz  Mon Sep 29 12:43:18 2008
From: David.Pearce at mcs.vuw.ac.nz (David Pearce)
Date: Tue, 30 Sep 2008 08:43:18 +1300
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
 ANTLR3.0.1 does not ?
In-Reply-To: <1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>
References: <48E08303.1030107@mcs.vuw.ac.nz>
	<1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>
Message-ID: <48E12FD6.10201@mcs.vuw.ac.nz>

Hi Terence,

>> The reason is that the empty production has no rewrite.  However, in
>> ANTLR 3.0.1, this error did not happen.
>>
>> So, my question is: is this is a bug, or intentional behaviour?  I
> 
> hi!
> 
> It is proper behavior; if there is no listBody then list must indicate 
> there is an error.

Just to be clear here --- you're saying this behaviour exhibited in 
ANTLR 3.0.1 was entirely broken?  It was actually quite a useful 
behaviour.  For example, in the Java 1.5 Grammar you have:

> classDeclaration
> 	:	'class' Identifier (typeParameters)?
>         ('extends' type)? 
>         ('implements' typeList)?
>         classBody
> 	;
> 
> ...
> 
> classBody
> 	:	'{' classBodyDeclaration* '}'
> 	;
> 
> ...
> 
> classBodyDeclaration
> 	:	';'
> 	|	... [other productions]
> 	;

In my ideal AST, the tokens ';', '{' and '}' are not present.  But, to 
use the rewrite rules with this, I have to provide extra tokens like so:

 > classBody
 > 	: '{' classBodyDeclaration* '}' -> (^X classBodyDeclaration*)
 > 	;
 >
 > ...
 >
 > classBodyDeclaration
 > 	:	';' -> (^Y)
 > 	|	... [other productions]
 > 	;

This seems clumsy, since neither the X or Y tokens are actually needed 
in my final AST.  With ANTLR 3.0.1 I just left them as empty 
productions, and it worked really nicely.

One solution I guess is to refactor the grammar, by inlining the 
productions in question.  So instead of the above, after one iteration 
we get:

 > classDeclaration
 > 	:	'class' Identifier (typeParameters)?
 >         ('extends' type)?
 >         ('implements' typeList)?
 >         '{' classBodyDeclaration* '}'
 >         -> ^(CLASS ...)
 > 	;

But, I still need to inline classBodyDeclaration ... and as I do all 
this the neatness of the original grammar is being lost.

Any suggestions?  Did I miss anything?

Cheers,

Dave

> Ter

-- 
Lecturer in Computer Science,
School of Mathematics, Statistics and Computer Science,
Victoria University of Wellington,
PO Box 600,
Wellington,
New Zealand.

Office: Cotton 231
Telephone: +64 (0)4 463 5833
URL: http://www.mcs.vuw.ac.nz/~djp

From parrt at cs.usfca.edu  Mon Sep 29 13:19:02 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 29 Sep 2008 13:19:02 -0700
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
	ANTLR3.0.1 does not ?
In-Reply-To: <48E12FD6.10201@mcs.vuw.ac.nz>
References: <48E08303.1030107@mcs.vuw.ac.nz>
	<1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>
	<48E12FD6.10201@mcs.vuw.ac.nz>
Message-ID: <BC9A229C-E9DF-4920-ABEB-1868886DE33B@cs.usfca.edu>


On Sep 29, 2008, at 12:43 PM, David Pearce wrote:

> Hi Terence,
>
>>> The reason is that the empty production has no rewrite.  However, in
>>> ANTLR 3.0.1, this error did not happen.
>>>
>>> So, my question is: is this is a bug, or intentional behaviour?  I
>>
>> hi!
>>
>> It is proper behavior; if there is no listBody then list must  
>> indicate
>> there is an error.
>
> Just to be clear here --- you're saying this behaviour exhibited in
> ANTLR 3.0.1 was entirely broken?

Yes.  you must use

> list : '(' listBody ')' -> ^(LIST listBody?)

not

> list : '(' listBody ')' -> ^(LIST listBody)

clearly listBody can be optional, right?
>> This seems clumsy, since neither the X or Y tokens are actually  
>> needed

just use ? :)

Ter


From David.Pearce at mcs.vuw.ac.nz  Mon Sep 29 13:44:20 2008
From: David.Pearce at mcs.vuw.ac.nz (David Pearce)
Date: Tue, 30 Sep 2008 09:44:20 +1300
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
 ANTLR3.0.1 does not ?
In-Reply-To: <BC9A229C-E9DF-4920-ABEB-1868886DE33B@cs.usfca.edu>
References: <48E08303.1030107@mcs.vuw.ac.nz>
	<1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>
	<48E12FD6.10201@mcs.vuw.ac.nz>
	<BC9A229C-E9DF-4920-ABEB-1868886DE33B@cs.usfca.edu>
Message-ID: <48E13E24.9000108@mcs.vuw.ac.nz>

Hi Terence,

> Yes.  you must use
> 
>> list : '(' listBody ')' -> ^(LIST listBody?)
> 
> not
> 
>> list : '(' listBody ')' -> ^(LIST listBody)
> 
> clearly listBody can be optional, right?

Yes, in this case it is definitely optional.  But, in the Java grammar 
case it is not:

> classDeclaration
>     :    'class' Identifier (typeParameters)?
>         ('extends' type)?         ('implements' typeList)?
>         classBody
>     ;
> 
> ...
> 
> classBody
>     :    '{' classBodyDeclaration* '}'
>     ;
> 
> ...
> 
> classBodyDeclaration
>     :    ';'
>     |    ... [other productions]
>     ; 

I can't make classBody here optional, like e.g.:

 > classDeclaration
 >     :    'class' Identifier (typeParameters)?
 >         ('extends' type)?         ('implements' typeList)?
 >         classBody?
 >         -> ^(Class ...)
 >     ;

Otherwise, I'm accepting Java files which are not correct.  It seems the 
only option is to refactor giving this:

 > classDeclaration
 >     :    'class' Identifier (typeParameters)?
 >         ('extends' type)?         ('implements' typeList)?
 >         '{' (classBodyDeclaration | ';')* '}'
 >         -> ^(Class ...)
 >     ;
 >
 > ...
 >
 > classBodyDeclaration
 >     :    ... [other productions]
 >     ;

But, this doesn't seem ideal to me?

Cheers,

Dave

>>> This seems clumsy, since neither the X or Y tokens are actually needed
> 
> just use ? :)
> 
> Ter
> 

-- 
Lecturer in Computer Science,
School of Mathematics, Statistics and Computer Science,
Victoria University of Wellington,
PO Box 600,
Wellington,
New Zealand.

Office: Cotton 231
Telephone: +64 (0)4 463 5833
URL: http://www.mcs.vuw.ac.nz/~djp

From parrt at cs.usfca.edu  Mon Sep 29 13:47:37 2008
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 29 Sep 2008 13:47:37 -0700
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
	ANTLR3.0.1 does not ?
In-Reply-To: <48E13E24.9000108@mcs.vuw.ac.nz>
References: <48E08303.1030107@mcs.vuw.ac.nz>
	<1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>
	<48E12FD6.10201@mcs.vuw.ac.nz>
	<BC9A229C-E9DF-4920-ABEB-1868886DE33B@cs.usfca.edu>
	<48E13E24.9000108@mcs.vuw.ac.nz>
Message-ID: <1EAF370B-F5C7-433A-807C-36678EC30BA3@cs.usfca.edu>


On Sep 29, 2008, at 1:44 PM, David Pearce wrote:

> Hi Terence,
>
>> Yes.  you must use
>>> list : '(' listBody ')' -> ^(LIST listBody?)
>> not
>>> list : '(' listBody ')' -> ^(LIST listBody)
>> clearly listBody can be optional, right?
>
> Yes, in this case it is definitely optional.  But, in the Java  
> grammar case it is not:

Notice the ? is in the tree construction not the matching.

>> classDeclaration
>>    :    'class' Identifier (typeParameters)?
>>        ('extends' type)?         ('implements' typeList)?
>>        classBody
>>    ;
>> ...
>> classBody
>>    :    '{' classBodyDeclaration* '}'
>>    ;
>> ...
>> classBodyDeclaration
>>    :    ';'
>>    |    ... [other productions]
>>    ;

I don't understand the issue.  Don't alter the matching, just add ? to  
the ast constr.
Ter

From jimi at temporal-wave.com  Mon Sep 29 13:56:05 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 29 Sep 2008 13:56:05 -0700
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
	ANTLR3.0.1 does not ?
In-Reply-To: <48E13E24.9000108@mcs.vuw.ac.nz>
References: <48E08303.1030107@mcs.vuw.ac.nz>
	<1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>
	<48E12FD6.10201@mcs.vuw.ac.nz>
	<BC9A229C-E9DF-4920-ABEB-1868886DE33B@cs.usfca.edu>
	<48E13E24.9000108@mcs.vuw.ac.nz>
Message-ID: <1222721765.4525.25.camel@jimi.temporal-wave.com>

On Tue, 2008-09-30 at 09:44 +1300, David Pearce wrote:

> Hi Terence,
> 
> > Yes.  you must use
> > 
> >> list : '(' listBody ')' -> ^(LIST listBody?)
> > 
> > not
> > 
> >> list : '(' listBody ')' -> ^(LIST listBody)
> > 
> > clearly listBody can be optional, right?
> 
> Yes, in this case it is definitely optional.  But, in the Java grammar 
> case it is not:


The annotation of the grammar is not required to be the same, and is not
always the same, as the annotation of the rewrite.

Your grammar rule may not be optional, but it may or may not produce a
tree. Hence the rewrite rules needs to be told that the tree produced by
that rule may or may not be there, and you just use ->^(BLAH BLHA rule?)

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080929/0f765879/attachment.html 

From David.Pearce at mcs.vuw.ac.nz  Mon Sep 29 14:00:47 2008
From: David.Pearce at mcs.vuw.ac.nz (David Pearce)
Date: Tue, 30 Sep 2008 10:00:47 +1300
Subject: [antlr-interest] ANTLR 3.1 gives RewriteEmptyStreamException,
 ANTLR3.0.1 does not ?
In-Reply-To: <1EAF370B-F5C7-433A-807C-36678EC30BA3@cs.usfca.edu>
References: <48E08303.1030107@mcs.vuw.ac.nz>
	<1A72E1B7-3A2F-41CA-B020-188545B92EE9@cs.usfca.edu>
	<48E12FD6.10201@mcs.vuw.ac.nz>
	<BC9A229C-E9DF-4920-ABEB-1868886DE33B@cs.usfca.edu>
	<48E13E24.9000108@mcs.vuw.ac.nz>
	<1EAF370B-F5C7-433A-807C-36678EC30BA3@cs.usfca.edu>
Message-ID: <48E141FF.6050601@mcs.vuw.ac.nz>

Hi Terence,

Thanks for the quick response!!!

> Notice the ? is in the tree construction not the matching.

Ok, I hadn't noticed the difference.  Yes, that might be exactly the 
solution to my problem --- thanks!!

Dave

>>> classDeclaration
>>>    :    'class' Identifier (typeParameters)?
>>>        ('extends' type)?         ('implements' typeList)?
>>>        classBody
>>>    ;
>>> ...
>>> classBody
>>>    :    '{' classBodyDeclaration* '}'
>>>    ;
>>> ...
>>> classBodyDeclaration
>>>    :    ';'
>>>    |    ... [other productions]
>>>    ;
> 
> I don't understand the issue.  Don't alter the matching, just add ? to 
> the ast constr.
> Ter

-- 
Lecturer in Computer Science,
School of Mathematics, Statistics and Computer Science,
Victoria University of Wellington,
PO Box 600,
Wellington,
New Zealand.

Office: Cotton 231
Telephone: +64 (0)4 463 5833
URL: http://www.mcs.vuw.ac.nz/~djp

From wiggjd at bcs.org.uk  Tue Sep 30 03:40:18 2008
From: wiggjd at bcs.org.uk (David Wigg)
Date: Tue, 30 Sep 2008 11:40:18 +0100
Subject: [antlr-interest] Problem with Java runtime
Message-ID: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>

To whom it may concern,

I get this warning when compiling the Java runtime.

.\TestRecursion_JavaParser.java:64: warning: [unchecked] unchecked call to
push(E) as a member of the raw type java.util.Stack
        block_stack.push(new block_scope());
I attach the source code and the grammar which produced it.

The "Java" in the name refers to the runtime language in this case.

Am I doing something wrong? If not, I wonder if the warning could possibly
be removed in future?

For our information, I also have a C runtime version. This version does not
seem to work in quite the same way as the Java version in that the block
data appears to be popped before performing any @after processing (instead
of after any @after processing as in the Java runtime) so that any
appropriate block data is no longer available..

Thanks,

David.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/22a11ed8/attachment.html 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: TestRecursion_Java.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/22a11ed8/attachment.pl 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: TestRecursion_JavaParser.java
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/22a11ed8/attachment-0001.pl 

From toni at okidokiteam.com  Tue Sep 30 03:56:05 2008
From: toni at okidokiteam.com (Toni Menzel)
Date: Tue, 30 Sep 2008 12:56:05 +0200
Subject: [antlr-interest] Problem with Java runtime
In-Reply-To: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
References: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
Message-ID: <5c68585c0809300356t14dbe3cal5e23bc34ef2e416b@mail.gmail.com>

Dont't worry, thats a warning that your generated code is using unchecked
type conversion where it could have used generics.
I guess the generated code produces java < 5 compatible code where generics
haven't existed.

Depending on your IDE, you can set the sourcecode level to 1.4 or uncheck a
box in your settings like "warn when using unchecked type conversion" or
alike.

cheers,
Toni

On Tue, Sep 30, 2008 at 12:40 PM, David Wigg <wiggjd at bcs.org.uk> wrote:

> To whom it may concern,
>
> I get this warning when compiling the Java runtime.
>
> .\TestRecursion_JavaParser.java:64: warning: [unchecked] unchecked call to
> push(E) as a member of the raw type java.util.Stack
>         block_stack.push(new block_scope());
> I attach the source code and the grammar which produced it.
>
> The "Java" in the name refers to the runtime language in this case.
>
> Am I doing something wrong? If not, I wonder if the warning could possibly
> be removed in future?
>
> For our information, I also have a C runtime version. This version does not
> seem to work in quite the same way as the Java version in that the block
> data appears to be popped before performing any @after processing (instead
> of after any @after processing as in the Java runtime) so that any
> appropriate block data is no longer available..
>
> Thanks,
>
> David.
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>


-- 
Toni Menzel
Software Developer
Podbielskistr. 262
30655 Hannover
toni at okidokiteam.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/c7d4225a/attachment.html 

From jaluber at gmx.de  Tue Sep 30 03:59:08 2008
From: jaluber at gmx.de (Johannes Luber)
Date: Tue, 30 Sep 2008 12:59:08 +0200
Subject: [antlr-interest] Problem with Java runtime
In-Reply-To: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
References: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
Message-ID: <48E2067C.5010501@gmx.de>

David Wigg schrieb:
> To whom it may concern,
>  
> I get this warning when compiling the Java runtime.
>  
> .\TestRecursion_JavaParser.java:64: warning: [unchecked] unchecked call
> to push(E) as a member of the raw type java.util.Stack
>         block_stack.push(new block_scope());
> I attach the source code and the grammar which produced it.

This merely means that no generics are used in the runtime, as Java 1.4
has to be still supported. It may be annoying, but until there aren't
any users of Java 1.4 left, Ter can't change this.
>  
> The "Java" in the name refers to the runtime language in this case.
>  
> Am I doing something wrong? If not, I wonder if the warning could
> possibly be removed in future?
>  
> For our information, I also have a C runtime version. This version does
> not seem to work in quite the same way as the Java version in that the
> block data appears to be popped before performing any @after processing
> (instead of after any @after processing as in the Java runtime) so
> that any appropriate block data is no longer available..

That might be a bug, which may have been fixed in 3.1.1 (coming out this
week).

Johannes

>  
> Thanks,
>  
> David.
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From kevin_mitchell at agilent.com  Tue Sep 30 04:15:06 2008
From: kevin_mitchell at agilent.com (kevin_mitchell at agilent.com)
Date: Tue, 30 Sep 2008 05:15:06 -0600
Subject: [antlr-interest] Who calls CommonTree.setTokenStartIndex ?
Message-ID: <FF03F77C12C4C145B9995FD8B527DE9202958E46@cos-us-mb01.cos.agilent.com>

I'm using Antlr 3.1 with the Java backend, and generating Antlr-style abstract syntax trees.  When I look at these trees I find that getTokenStartIndex (and StopIndex) are always set to -1.  I was expecting either the parser to emit calls to setTokenStartIndex, or some code in addChild to call this method whenever a new child was added.  But the parser doesn't seem to call this method, and adding a child doesn't seem to update the value either.  So where does the code to set the start index of a compound tree get called?  Is there some post-processing method I should be calling to set this, or some flag to tell the parser to generate such calls?

 

Thanks,

 

Kevin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/addb6961/attachment.html 

From jimi at temporal-wave.com  Tue Sep 30 09:00:57 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 30 Sep 2008 09:00:57 -0700
Subject: [antlr-interest] Problem with Java runtime
In-Reply-To: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
References: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
Message-ID: <1222790457.4369.10.camel@jimi.temporal-wave.com>

On Tue, 2008-09-30 at 11:40 +0100, David Wigg wrote:
> To whom it may concern,

>  
> For our information, I also have a C runtime version. This version
> does not seem to work in quite the same way as the Java version in
> that the block data appears to be popped before performing any @after
> processing (instead of after any @after processing as in the Java
> runtime) so that any appropriate block data is no longer available..


Yes - I keep trying to tell people not to rely on @after in the C target
as the seeming fix to just move it about in the C.stg isn't quite a
simple as it looks because there are many dependencies on what you have
in there (predicates, backtrack, scopes and so on). I do need to
schedule proper time to look at this and see if this is fixable such
that it does everything in the right order in all combinations, but that
time won't be until next week right now.

Please upgrade to 3.1.1 when it comes out later today by the way. In the
main, this update removes dup() code in tree builders that was there for
the beta and should not have been left in 3.1 as it causes huge memory
consumption and so on.


Jim


> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/8252a7d2/attachment.html 

From jimi at temporal-wave.com  Tue Sep 30 09:04:58 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 30 Sep 2008 09:04:58 -0700
Subject: [antlr-interest] Problem with Java runtime
In-Reply-To: <48E2067C.5010501@gmx.de>
References: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
	<48E2067C.5010501@gmx.de>
Message-ID: <1222790698.4369.15.camel@jimi.temporal-wave.com>

On Tue, 2008-09-30 at 12:59 +0200, Johannes Luber wrote:

> David Wigg schrieb:
> > To whom it may concern,
> >  
> > I get this warning when compiling the Java runtime.
> >  
> > .\TestRecursion_JavaParser.java:64: warning: [unchecked] unchecked call
> > to push(E) as a member of the raw type java.util.Stack
> >         block_stack.push(new block_scope());
> > I attach the source code and the grammar which produced it.
> 
> This merely means that no generics are used in the runtime, as Java 1.4
> has to be still supported. It may be annoying, but until there aren't
> any users of Java 1.4 left, Ter can't change this.


I am not convinced that there are any 1.4 javac users left, but anyway,
as type information is elided  and so on, it should be fine to generate
1.5 or even 1.6 code and then have developers target the byte code at
1.4 (using the options on javac).

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/204226fa/attachment.html 

From jimi at temporal-wave.com  Tue Sep 30 09:09:29 2008
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 30 Sep 2008 09:09:29 -0700
Subject: [antlr-interest] Who calls CommonTree.setTokenStartIndex ?
In-Reply-To: <FF03F77C12C4C145B9995FD8B527DE9202958E46@cos-us-mb01.cos.agilent.com>
References: <FF03F77C12C4C145B9995FD8B527DE9202958E46@cos-us-mb01.cos.agilent.com>
Message-ID: <1222790969.4369.20.camel@jimi.temporal-wave.com>

On Tue, 2008-09-30 at 05:15 -0600, kevin_mitchell at agilent.com wrote:
> I?m using Antlr 3.1 with the Java backend, and generating Antlr-style
> abstract syntax trees.  When I look at these trees I find that
> getTokenStartIndex (and StopIndex) are always set to -1.  I was
> expecting either the parser to emit calls to setTokenStartIndex, or
> some code in addChild to call this method whenever a new child was
> added.  But the parser doesn?t seem to call this method, and adding a
> child doesn?t seem to update the value either.  So where does the code
> to set the start index of a compound tree get called?  Is there some
> post-processing method I should be calling to set this, or some flag
> to tell the parser to generate such calls?


It should be set up, but if you embed imaginary tokens in rewrites, then
these can end up being just -1. There are no bugs that I know of
concerned with this and I use it very heavily in a lot of Java parsers.

Are you doing:

->^(IMAGINARY1 rule1 rule2 ^(IMAGINARY2 rule3))


In this case IMAGINARY2 will not have boundaries set (what should they
be really?) and you need to move the AST production in to the sub rule,
where on rule exit the postProcessing at the end of the rule will set
the ending and the entry to the rule will set the start.

Or perhaps you are referencing the trees in some unorthodox way?

Jim


> 
>  
> 
> Thanks,
> 
>  
> 
> Kevin
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/ed2d1504/attachment.html 

From lars.vonwedel at bayertechnology.com  Tue Sep 30 09:09:56 2008
From: lars.vonwedel at bayertechnology.com (lars.vonwedel at bayertechnology.com)
Date: Tue, 30 Sep 2008 18:09:56 +0200
Subject: [antlr-interest] Antwort: RE: Using Antlr for Visual Studio
 Language Services
In-Reply-To: <86403CA0939415448BCCB83855EFE09A64E47E@Bloodymary.ironwillgames.com>
Message-ID: <OF0EB8A408.C93EE46B-ONC12574D4.0058B6AB-C12574D4.0058CCAD@bayer.de>

Hello,

that sounds pretty cool. I am looking forward to your documentation.

Freundliche Gr??e / Best Regards
Lars von Wedel
_________________________________________

Bayer Technology Services GmbH
BTS-PT-PD-ES
Leverkusen, E 41
Phone: +49 214 30 56456
Fax: +49 214 30 62677
E-mail: lars.vonwedel at bayertechnology.com
Web: www.bayertechnology.com

Gesch?ftsf?hrer: Achim Noack
Aufsichtsratsvorsitzender: Dr. Wolfgang Plischke
Sitz der Gesellschaft: Leverkusen   |   Eintragung: Amtsgericht K?ln, HRB 
49896




"Sam Harwell" <sharwell at pixelminegames.com> 
29.09.2008 17:42

An
<lars.vonwedel at bayertechnology.com>, <antlr-interest at antlr.org>
Kopie

Thema
RE: [antlr-interest] Using Antlr for Visual Studio Language Services






Our IDE uses ANTLR as the core processor for IntelliSense, plus a custom 
Lexer base class that allows the lexer to double as the syntax highlighter 
core. We?ve created a modular language service framework for ANTLR-based 
language services, an ANTLR v3 language service for editing the grammars, 
and tied the grammars directly into the build process. After we get our 
release ready, I?m planning to spend some time documenting key portions of 
the process of creating antlr-based language services.
 
http://wiki.pixelminegames.com/index.php?title=Tools:UnrealScript_Studio:Features
 
I call it an IDE instead of a plug-in because even the Microsoft languages 
are implemented in this fashion, and they are not called plugins. J
 
Sam
 
From: antlr-interest-bounces at antlr.org 
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of 
lars.vonwedel at bayertechnology.com
Sent: Monday, September 29, 2008 1:37 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Using Antlr for Visual Studio Language Services
 

Hello, 

has someone made progress in using an Antlr grammar for devloping a 
language service for Visual Studio ? 
There was a thread on the mailing concerning this topic list a while ago 
(2005), but I haven't found more recent information. 

http://www.antlr.org/pipermail/antlr-interest/2005-December/014658.html 


I have some time available I can spend so any ideas on how to proceed are 
welcome. 

Freundliche Gr??e / Best Regards
Lars von Wedel
_________________________________________

Bayer Technology Services GmbH
BTS-PT-PD-ES
Leverkusen, E 41
Phone: +49 214 30 56456
Fax: +49 214 30 62677
E-mail: lars.vonwedel at bayertechnology.com
Web: www.bayertechnology.com

Gesch?ftsf?hrer: Achim Noack
Aufsichtsratsvorsitzender: Dr. Wolfgang Plischke
Sitz der Gesellschaft: Leverkusen   |   Eintragung: Amtsgericht K?ln, HRB 
49896
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20080930/36505e75/attachment.html 

From kevin_mitchell at agilent.com  Tue Sep 30 09:42:22 2008
From: kevin_mitchell at agilent.com (kevin_mitchell at agilent.com)
Date: Tue, 30 Sep 2008 10:42:22 -0600
Subject: [antlr-interest] Who calls CommonTree.setTokenStartIndex ?
Message-ID: <FF03F77C12C4C145B9995FD8B527DE9202959054@cos-us-mb01.cos.agilent.com>

> Are you doing:  ->^(IMAGINARY1 rule1 rule2 ^(IMAGINARY2 rule3))
> In this case IMAGINARY2 will not have boundaries set 

Ah, that's probably the source of the problem.  I'll rework the grammar to eliminate such nested trees. 

Thanks,

Kevin




From wayne at codaris.com  Tue Sep 30 20:54:49 2008
From: wayne at codaris.com (Wayne Venables)
Date: Tue, 30 Sep 2008 20:54:49 -0700
Subject: [antlr-interest] Using ANTLR 3.1 to parse macros (for a Macro
	Assembler)
Message-ID: <6.1.2.0.2.20080930204348.04bfc788@mail.webmotif.com>

Hello Everyone,

I'm working on a macro assembler for an embedded platform (trying to 
improve on the existing DOS-based assembler).  I'm new to ANTLR3 and I've 
been trying to figure out how to handle the assembler macros.  They work 
like C pre-processor handles #define's -- it's just text substitution.  I 
believe I understand how the old C pre-processor example works:

	http://www.antlr.org/share/1090897436819/cpp.g

but that was designed for the older version of ANTLR and I haven't figured 
out how translate that example into ANTLR3.  In ANTLR3, how do I get the 
parser to switch to a new lexer in the middle of the processing and then 
retry the match?  Or is there a different/better way of handling this in 
ANTLR3?   I'm using the CSharp target.  So far I haven't had any luck with 
the book, the online manuals, or google.

Thanks,


From mail at martin-probst.com  Tue Sep 30 23:59:15 2008
From: mail at martin-probst.com (Martin Probst)
Date: Wed, 1 Oct 2008 08:59:15 +0200
Subject: [antlr-interest] Problem with Java runtime
In-Reply-To: <1222790698.4369.15.camel@jimi.temporal-wave.com>
References: <c34954d70809300340w296dbd74j355813c90e13a517@mail.gmail.com>
	<48E2067C.5010501@gmx.de>
	<1222790698.4369.15.camel@jimi.temporal-wave.com>
Message-ID: <D67D0E67-8B00-4723-930F-29F1FE685557@martin-probst.com>

> I am not convinced that there are any 1.4 javac users left, but  
> anyway,
> as type information is elided  and so on, it should be fine to  
> generate
> 1.5 or even 1.6 code and then have developers target the byte code at
> 1.4 (using the options on javac).

That's not going to work. The class file format has changed between  
1.4, 1.5, and 1.6. You cannot simply create a jar and drop that on a  
1.4 user, you'd need to do something like retroweaver etc. I think  
this has been discussed previously on the list, too.

Martin

