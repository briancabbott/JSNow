From markwright at internode.on.net  Thu Jul  1 05:14:45 2010
From: markwright at internode.on.net (Mark Wright)
Date: Thu, 1 Jul 2010 22:14:45 +1000
Subject: [antlr-interest] how do you make Antlr work with a recursively
 changing input stream
In-Reply-To: <721581.41156.qm@web55207.mail.re4.yahoo.com>
References: <721581.41156.qm@web55207.mail.re4.yahoo.com>
Message-ID: <20100701121445.GD28856@internode.on.net>

On Wed, Jun 30, 2010 at 12:40:44PM -0700, Alex McMains wrote:
> Thanks Mark.  I appreciate the response.  However, I'm not sure if I've made
> myself quite clear in what I'm trying to do.  I read the links you gave me,
> and I think I understand at least the basics of using a symbol table.  I
> implemented a rudimentary C compiler in college using flex/bison, but that was
> 12 years ago.  Plenty long enough for me to forget the details.
>  
> However, unless I can either call Antlr recursively (is this possible?), or
> change the stream that Antlr is parsing as I find substitutions, then I don't
> see how a symbol table will help me.  I get the feeling that I'm missing
> something completely obvious.  I'm sure I'm not the only person who has ever
> tried to do what I'm trying to do.
>  
> My problem isn't forward references in this case.  My problem is that the data
> stream is discovered dynamically by following a table of substitutions.  The
> tables are similar to a relational database.
>  
> I have a hand-coded parser using regular expressions that I've written that
> handles all of this, but it's somewhat hard to maintain (even for me the
> person who wrote it).
>  
> I would like Antlr to both tell me whether or not I need to substitute at any
> given node based on a grammar and then recurse over the substituted data and
> finally parse the leaf nodes using the grammar.
>   
> Here's a slightly more complex example than I gave before:
>  
> xml = Parse(Person); /* I pass in the table to start with - that's it.  The
>                         original stream only contains the Person table representation.  The rest is
>                         determined dynamically. */
> 
> /* Here's how the tables might be layed out. */
> 
> Person (table name)
> _Identifier_       {Name}        {Address}
> Person1          15555            15555       
> Person2          14444            14444
>  
> Name (table name)
> _Identifier_      Salutation    FirstName    LastName
> 15555               Mr             Joe         Blow
> 14444               Mrs            Jane        Doe
>  
> Address (table name)
> _Identifier_     Street      City        State      {Neighborhood}
> 15555            Main      Bozeman        MT           Stirling
> 14444           Second    Los Angeles     CA           Brentwood
>  
> Neighborhood (table name)
> _Identifier_           Name                 YearlyDues
> Stirling            Stirling Meadows          400
> Brentwood           Brentwood Estates         4000
>  
> Here's what the XML would look like - remember I only passed in the Person
> table representation as the original stream, the rest was determined
> dynamically as I look at each node and decide whether or not to perform a
> substitution.  Currently these substitutions are designated with the {} around
> the table's column header.
>  
> <Person1>
>   <Name>
>     <Salutation>Mr</Salutation>
>     <FirstName>Joe</FirstName>
>     <LastName>Blow</LastName>
>   </Name>
>   <Address>
>     <Street>Main</Street>
>     <City>Bozeman</City>
>     <State>MT</State>
>     <Neighborhood>
>       <Name>Stirling Meadows</Name>
>       <YearlyDues>400</YearlyDues>
>     </Neighborhood>
>   </Address>
> </Person1>
> <Person2>
>   <Name>
>     <Salutation>Mrs</Salutation>
>     <FirstName>Jane</FirstName>
>     <LastName>Doe</LastName>
>   </Name>
>   <Address>
>     <Street>Second</Street>
>     <City>Los Angeles</City>
>     <State>CA</State>
>     <Neighborhood>
>       <Name>Brentwood Estates</Name>
>       <YearlyDues>4000</YearlyDues>
>     </Neighborhood>
>   </Address>
> </Person2>
>  
> I'm sorry if this is too long.  Maybe there is something obvious I
> am missing here.  If you still think a symbol table is warranted,
> could you please write me some psuedocode that shows how I can get
> Antlr to parse the dynamic data recursively.
>  
> Thanks!
>  
>          -- alex

Hi Alex,

Some approaches to writing compilers/DSLs:

Syntax Directed Translation
===========================

On the cover of old dragon books, Principles of Compiler Design, and
Compilers Princples, Techniques and Tools, by Aho et al, it has
a picture of a knight with a shield, encsribed on the shield it says
"Syntax Directed Translation".  This simple idea is implemented in
ANTLR by writing a compiler or DSL (Domain Specific Language) in
two passes:

pass 1
------

Parses the grammar, outputing an abstract syntax tree.

pass 2
------

It just walks the abstract sytax tree, which is the syntax directed translation.
The abstract syntax tree could be walked with:

- a tree grammar
- visitor pattern

Then presumably it outputs something.  A neat option that ANTLR supports is
to output some string templates.

Which all seems fine if: 

(i)  if it is actually convenient to generate the output by walking over
     the abstract syntax tree that is based on the syntax of the input language.

(ii) you happen to have all the information at hand to generate the output
     when visiting the tree nodes in the tree grammar.

This is a very common approach, so of course there are ways to deal with gathering
missing information:

- add another pass.  An earlier pass could add information to a symbol table.
  Then a later pass can look up information from the symbol table and add this
  this information to the abstract syntax tree.  Or it could write a new
  abstract syntax tree based on the earlier abstract syntax tree and the new
  information.

- using attribute grammars.

- with the ANTLR java client, there is a tree wizard which can do pattern matching
  like in functional programming languages.

- using pattern matching with functional programming languages.

Walking the Symbol Table
========================

If the initial abstract syntax tree from the syntax directed translation approach
does not seem convenient for performing the compiler/DSL output, and/or it
seems like too much work to obtain an annotated abstract syntax tree in the
correct format, then an alternative idea is to generate a symbol table, then
walk the symbol table.

This seems to work OK when the symbol table is not too complex.

That is the problem with it though, when the symbol table is complex,
it seems too difficult to either:

- apply the visitor pattern.  There is a hierarchical visitor pattern which
  may help:

http://c2.com/cgi/wiki?HierarchicalVisitorPattern

- or to write nested loops doing external iteration over the symbol table.

Now I only know a little about your application, you could be
simplying it in order to describe it for all I know.  So it
seems to me that this approach might work for your application if its
not too complex.

I used this approach, and made it work.  I walked the symbol table
and output a new tree grammar, which was nothing like the input
language.  I walked it in the correct order for the code generation,
and output string templates.

However the resulting symbol table walk code and tree grammar generationg
looked too complex.  So I'm working on rewriting it using type theory and
functional programming languages.

Regards, Mark
   
> --- On Tue, 6/29/10, Mark Wright <markwright at internode.on.net> wrote:
> 
> 
> From: Mark Wright <markwright at internode.on.net>
> Subject: Re: [antlr-interest] how do you make Antlr work with a recursively changing input stream
> To: antlr-interest at antlr.org
> Date: Tuesday, June 29, 2010, 5:29 PM
> 
> 
> On Tue, Jun 29, 2010 at 03:18:55PM -0700, Alex McMains wrote:
> > Hi all,
> > 
> > I'm new to Antlr.  I've bought and read portions of the Antlr book,
> > and I've read dozens of postings and tutorials, but I still can't
> > see how to do deal with a recursively changing input stream in
> > Antlr.  Do I somehow use TokenRewriteStream, or am I missing
> > something?  
> 
> Hi Alex,
> 
> Yes, you are missing something, the Antlr book does not say much about
> symbol tables or type systems.
> 
> For simple type systems, it is probably easier to just use the
> approach which is called a "symbol table" in old school books
> on compiler construction.  A really good description of this
> approach is in chapter 7 of the book Language Implementation Patterns
> by Terence Parr.  An introduction to this approach is at:
> 
> http://www.antlr.org/wiki/display/CS652/Symbol+tables
> 
> You obviously need to implement forward references scopes.
> 
> Mainly for the mailing list archive, I would just like to say that I
> find this symbol table approach seems difficult to use for
> complex type systems.  For complex type systems the approach I
> recommend is described in the book "Types and Programming Languages"
> by Benjamin Pierce, the online book "Software Foundations", see the
> course:
> 
> http://www.seas.upenn.edu/~cis500/current/index.html
> 
> and the book "Certified Programming with Dependent Types" by
> Adam Chlipala:
> 
> http://adam.chlipala.net/cpdt/
> 
> Regards, Mark
> 
> > Here's the situation:
> > 
> > I start with an input stream.  As I move through the input I will
> > either encounter something that can be parsed directly, or I will
> > encounter something that tells me to go to a table and substitute an
> > entire row of the table at the node where I currently am.  This can
> > continue to happen recursively since each field from the substituted
> > row can again call for a substitution. 
> >  
> > Here's an example:
> >  
> > Person table:
> >  Identifier     Name   {Address}
> > Person1        Jon       Jon's Address
> >  
> > Address table:
> >  Identifier      HouseNumber  StreetName
> > Jon's Address   3477               Blue Lane
> >  
> > The {} around Address says to name the current node "Address" and
> > substitute the current value for whatever is at "Jon's Address" in
> > the Address table.
> >  
> > Eventually this will become XML that would look like:
> >  
> > <Person>
> >     <Name>Jon</Name>
> >     <Address>
> >          <HouseNumber>3477</HouseNumber>
> >          <StreetName>Blue Lane</StreetName>
> >      </Address>
> > </Person>
> >  
> > Any ideas would be appreciated.
> >  
> > Thanks.
> >  
> >        -- alex
> > 
> > 
> >       
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >   

From jimi at temporal-wave.com  Thu Jul  1 05:49:12 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 01 Jul 2010 05:49:12 -0700
Subject: [antlr-interest] Continue parsing after an error
In-Reply-To: <1FE9A296676737419A8912A6FD22AE1D02875480EA@alvxmbw04.prod.quest.corp>
References: <4C2B503A.1040605@ontology-partners.com>
	<1FE9A296676737419A8912A6FD22AE1D0287547B94@alvxmbw04.prod.quest.corp>
	<4C2B805B.2070706@ontology-partners.com>
	<1FE9A296676737419A8912A6FD22AE1D02875480EA@alvxmbw04.prod.quest.corp>
Message-ID: <web-860572@temporal-wave.com>

On Wed, 30 Jun 2010 10:48:39 -0700
  Gordon Tyler <Gordon.Tyler at quest.com> wrote:
> I'm not very familiar with ANTLR's error recovery mechanisms, but I 
>suspect that the generated code for the 'expressions' rule looks for 
>a character that it recognizes as the start of an 'expression' rule 
>before it calls into the 'expression' rule and when it doesn't find 
>one in the second case, it exits out into the root rule, which then 
>checks if the next token is EOF and fails.

Please read the article on the wiki entitled "Custom error recovery" - 
this will give you all the information you need.

Jim

> 
> But this is just speculation. Hopefully one of the more experienced 
>ANTLRers can give you a better answer.
> 
> -----Original Message-----
>From: antlr-interest-bounces at antlr.org 
>[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Luchesar Cekov
> Sent: June 30, 2010 1:35 PM
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Continue parsing after an error
> 
> Hi Gordon,
> 
> Thanks for the prompt response.
> Adding OTHER as an alternative was what I tried to do in the 
>beginning. 
> Unfortunately my use case is a bit more complex. I have worked out a 
> better example below.
> In this example, the input string  [ax][kx][ax] is wrong (k is not 
> allowed) but the grammar builds the full ast tree, so it recovers 
>from 
> the error - it would generate three expression nodes the second of 
>which 
> contains a ErrorCommonToken inside as per 
>recoverFromMismatchedToken().
> The string [ax]sax][ax] on the other end, generates only the first 
>bit 
> of the tree, till the error.  - it generares only one expression 
>node.
> 
> I do not understand why I get this different behavior - the parser 
> recovers if the error happens in the middle of a rule, but not if 
>the 
> error is at the beginning of a rule.
> 
> Is this a problem in my grammar or it is just the way ANTLR works?
> 
> Thanks,
> Luchesar
> 
> ================
> grammar StartOfARuleFailTest;
> 
> options {    output=AST;    ASTLabelType=CommonTree; }
> 
> tokens { ROOT_TOKEN;ERROR_TOKEN;EXPRESSIONS;EXPRESSION; }
> 
> @members {
>    @Override
>    protected Object recoverFromMismatchedToken(IntStream input, int 
> ttype, BitSet follow)
>            throws RecognitionException {
>        MismatchedTokenException ex = new 
> MismatchedTokenException(ttype, input);
>        input.consume();
>        return createErrorToken(ex, ttype);
>    }
>   
>    public static ErrorCommonToken 
>createErrorToken(RecognitionException 
> ex, int ttype) {
>        ErrorCommonToken errorCommonToken = new 
>ErrorCommonToken(ex.token);
>        errorCommonToken.setType(ttype);
>       
>        return errorCommonToken;
>    }
> }
> 
> root : expressions  EOF -> ^(ROOT_TOKEN expressions) ;
> expressions  : expression* -> ^(EXPRESSIONS expression*) ;
> expression : '[' 'a' 'x' ']' -> ^(EXPRESSION '[' 'a' 'x' ']');
> 
> OTHER   : . ;
> ================
> 
> 
> Gordon Tyler wrote:
>> The grammar you have defined says, roughly:
>>
>> Parse any number of '[' or ']' until you reach EOF.
>>
>> It does not describe what to do if something other than '[' or ']' 
>>are found before EOF is found.
>>
>> You have defined a token, OTHER, to match the other stuff, but your 
>>parse rules do not reference OTHER. Perhaps something like this would 
>>work:
>>
>> root : (expressions | OTHER)* EOF -> ^(ROOT_TOKEN expressions) ;
>>
>>
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org 
>>[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Luchesar Cekov
>> Sent: June 30, 2010 10:10 AM
>> To: antlr-interest at antlr.org
>> Cc: Valerio Malenchino
>> Subject: [antlr-interest] Continue parsing after an error
>>
>> Dear ANTLR enthusiasts,
>>
>> I am struggling with a problem. The parser jumps to the end of file 
>>from 
>> the middle of the document.
>>
>> The setup is as follow:
>>     * I have two alternatives flowed by EOF
>>     * during parse time in the middle of the document next token can 
>>not 
>> match either alternatives start
>>
>> This leads to parsing termination because the parser jumps to the 
>>EndOfFile.
>>
>> A simple grammar the illustrates the problem is
>>
>> ===============
>> tokens {ROOT_TOKEN;}
>> root
>>     : expressions EOF -> ^(ROOT_TOKEN expressions) ;
>> expressions : ('[' | ']')* ;
>> OTHER   : . ;
>> ===============
>>
>> If then I try parsing "[[][]]sdsdf[]][]][" the parsing will stop and 
>>the 
>> first "s" and will try to recover as if the EOF was the next token.
>> When looking at the generated Parser it looks like if there is no 
>>viable 
>> alternative in the top rule in this case "root" the parser will 
>>behave 
>> as if it reached the EOF and will skip the rest of the tokens.
>>
>> The result AST will contain only children up until the first illegal 
>> token "s".
>>
>> I cannot see where my mistake is. It looks like the parser should 
>>not do 
>> that. Can you suggest a workaround for the problem?
>>
>> Thanks in advance,
>> Luchesar
>>   
> 
> -- 
> 
> Luchesar Cekov
> Software Engineer
> +44 (0) 207 239 4949
> *Ontology Systems*
> www.ontology.com <http://www.ontology.com/>
> 
> 	
> 
> award list of icons       
> 
> 
> 
> 
> 
> 
> 
> 
> 
> .
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From luchesar.cekov at ontology-partners.com  Thu Jul  1 09:05:18 2010
From: luchesar.cekov at ontology-partners.com (Luchesar Cekov)
Date: Thu, 01 Jul 2010 17:05:18 +0100
Subject: [antlr-interest] Continue parsing after an error
In-Reply-To: <web-860572@temporal-wave.com>
References: <4C2B503A.1040605@ontology-partners.com>	<1FE9A296676737419A8912A6FD22AE1D0287547B94@alvxmbw04.prod.quest.corp>	<4C2B805B.2070706@ontology-partners.com>	<1FE9A296676737419A8912A6FD22AE1D02875480EA@alvxmbw04.prod.quest.corp>
	<web-860572@temporal-wave.com>
Message-ID: <4C2CBCBE.5030600@ontology-partners.com>

Hi Jim,

You were right!!! Custom Syntax Error Recovery section 
http://www.antlr.org/wiki/display/ANTLR3/Custom+Syntax+Error+Recovery 
contains explanation of how to fix the problem.

After applying it I have manage to get the parser going even after an 
error in a rule.

Many thanks!!! I was beginning to think I won't be able to solve this 
one via standard means.

Best regards,
Luchesar

Jim Idle wrote:
> On Wed, 30 Jun 2010 10:48:39 -0700
>   Gordon Tyler <Gordon.Tyler at quest.com> wrote:
>   
>> I'm not very familiar with ANTLR's error recovery mechanisms, but I 
>> suspect that the generated code for the 'expressions' rule looks for 
>> a character that it recognizes as the start of an 'expression' rule 
>> before it calls into the 'expression' rule and when it doesn't find 
>> one in the second case, it exits out into the root rule, which then 
>> checks if the next token is EOF and fails.
>>     
>
> Please read the article on the wiki entitled "Custom error recovery" - 
> this will give you all the information you need.
>
> Jim
>
>   
>> But this is just speculation. Hopefully one of the more experienced 
>> ANTLRers can give you a better answer.
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org 
>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Luchesar Cekov
>> Sent: June 30, 2010 1:35 PM
>> Cc: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] Continue parsing after an error
>>
>> Hi Gordon,
>>
>> Thanks for the prompt response.
>> Adding OTHER as an alternative was what I tried to do in the 
>> beginning. 
>> Unfortunately my use case is a bit more complex. I have worked out a 
>> better example below.
>> In this example, the input string  [ax][kx][ax] is wrong (k is not 
>> allowed) but the grammar builds the full ast tree, so it recovers 
>>     
> >from 
>   
>> the error - it would generate three expression nodes the second of 
>> which 
>> contains a ErrorCommonToken inside as per 
>> recoverFromMismatchedToken().
>> The string [ax]sax][ax] on the other end, generates only the first 
>> bit 
>> of the tree, till the error.  - it generares only one expression 
>> node.
>>
>> I do not understand why I get this different behavior - the parser 
>> recovers if the error happens in the middle of a rule, but not if 
>> the 
>> error is at the beginning of a rule.
>>
>> Is this a problem in my grammar or it is just the way ANTLR works?
>>
>> Thanks,
>> Luchesar
>>
>> ================
>> grammar StartOfARuleFailTest;
>>
>> options {    output=AST;    ASTLabelType=CommonTree; }
>>
>> tokens { ROOT_TOKEN;ERROR_TOKEN;EXPRESSIONS;EXPRESSION; }
>>
>> @members {
>>    @Override
>>    protected Object recoverFromMismatchedToken(IntStream input, int 
>> ttype, BitSet follow)
>>            throws RecognitionException {
>>        MismatchedTokenException ex = new 
>> MismatchedTokenException(ttype, input);
>>        input.consume();
>>        return createErrorToken(ex, ttype);
>>    }
>>   
>>    public static ErrorCommonToken 
>> createErrorToken(RecognitionException 
>> ex, int ttype) {
>>        ErrorCommonToken errorCommonToken = new 
>> ErrorCommonToken(ex.token);
>>        errorCommonToken.setType(ttype);
>>       
>>        return errorCommonToken;
>>    }
>> }
>>
>> root : expressions  EOF -> ^(ROOT_TOKEN expressions) ;
>> expressions  : expression* -> ^(EXPRESSIONS expression*) ;
>> expression : '[' 'a' 'x' ']' -> ^(EXPRESSION '[' 'a' 'x' ']');
>>
>> OTHER   : . ;
>> ================
>>
>>
>> Gordon Tyler wrote:
>>     
>>> The grammar you have defined says, roughly:
>>>
>>> Parse any number of '[' or ']' until you reach EOF.
>>>
>>> It does not describe what to do if something other than '[' or ']' 
>>> are found before EOF is found.
>>>
>>> You have defined a token, OTHER, to match the other stuff, but your 
>>> parse rules do not reference OTHER. Perhaps something like this would 
>>> work:
>>>
>>> root : (expressions | OTHER)* EOF -> ^(ROOT_TOKEN expressions) ;
>>>
>>>
>>>
>>> -----Original Message-----
>>> From: antlr-interest-bounces at antlr.org 
>>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Luchesar Cekov
>>> Sent: June 30, 2010 10:10 AM
>>> To: antlr-interest at antlr.org
>>> Cc: Valerio Malenchino
>>> Subject: [antlr-interest] Continue parsing after an error
>>>
>>> Dear ANTLR enthusiasts,
>>>
>>> I am struggling with a problem. The parser jumps to the end of file 
>>>       
>> >from 
>>     
>>> the middle of the document.
>>>
>>> The setup is as follow:
>>>     * I have two alternatives flowed by EOF
>>>     * during parse time in the middle of the document next token can 
>>> not 
>>> match either alternatives start
>>>
>>> This leads to parsing termination because the parser jumps to the 
>>> EndOfFile.
>>>
>>> A simple grammar the illustrates the problem is
>>>
>>> ===============
>>> tokens {ROOT_TOKEN;}
>>> root
>>>     : expressions EOF -> ^(ROOT_TOKEN expressions) ;
>>> expressions : ('[' | ']')* ;
>>> OTHER   : . ;
>>> ===============
>>>
>>> If then I try parsing "[[][]]sdsdf[]][]][" the parsing will stop and 
>>> the 
>>> first "s" and will try to recover as if the EOF was the next token.
>>> When looking at the generated Parser it looks like if there is no 
>>> viable 
>>> alternative in the top rule in this case "root" the parser will 
>>> behave 
>>> as if it reached the EOF and will skip the rest of the tokens.
>>>
>>> The result AST will contain only children up until the first illegal 
>>> token "s".
>>>
>>> I cannot see where my mistake is. It looks like the parser should 
>>> not do 
>>> that. Can you suggest a workaround for the problem?
>>>
>>> Thanks in advance,
>>> Luchesar
>>>   
>>>       
>> -- 
>>
>> Luchesar Cekov
>> Software Engineer
>> +44 (0) 207 239 4949
>> *Ontology Systems*
>> www.ontology.com <http://www.ontology.com/>
>>
>> 	
>>
>> award list of icons       
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> .
>>
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>     
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>   

-- 

Luchesar Cekov
Software Engineer
+44 (0) 207 239 4949
*Ontology Systems*
www.ontology.com <http://www.ontology.com/>

	

award list of icons       

 

 

 

 

.

 


From a.moderacja at gmail.com  Thu Jul  1 09:11:21 2010
From: a.moderacja at gmail.com (Borneq)
Date: Thu, 1 Jul 2010 18:11:21 +0200
Subject: [antlr-interest] What about Delphi target ?
Message-ID: <AANLkTinXcbuo3wImpBHTNgcle_1RCcpleFa4LBWWFwlm@mail.gmail.com>

It is already knowing about ? When will it be?

From parrt at cs.usfca.edu  Thu Jul  1 10:23:02 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 1 Jul 2010 10:23:02 -0700
Subject: [antlr-interest] antlr developers needed in NYC
Message-ID: <758CFE7A-779B-474E-B149-6C8105D7E818@cs.usfca.edu>

> I have 2 full-time positions in NYC for someone with ANTLR (Java, Lex and Yacc also is a plus) skill sets. I'm reaching out to this group with the intention that someone might be interested in this opportunity if they're currently in transition or looking to make a move. If interested,  please email me at hdaza at intriguesys.com for further details.

From zeaflal at aai.textron.com  Thu Jul  1 11:03:25 2010
From: zeaflal at aai.textron.com (Zeafla, Larry)
Date: Thu, 1 Jul 2010 14:03:25 -0400
Subject: [antlr-interest] Basic predicate question
Message-ID: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>

I am new to Antlr, which I am trying to use to parse simple existing
messages.  The message structure is exceptionally simple and
straightforward.  Message fields include integer and floating-point
numbers, single letter codes, and field separator characters.  Each
individual message type has a narrowly defined structure, needs no look
ahead, and typically has at most 2 possible tokens for any location in
the message.

 

My problem is that one of the fields is a 2-digit (in ASCII)
representation of a hex number.  This is known purely from context.  It
seems there should be a simple technique (probably a predicate), to
force this behavior.  I just can't seem to find it.

 

Here is a short sample grammar to illustrate:

          grammar sample;
          prog   :   test+ ;
          test    :   'TEST' COMMA INT COMMA FLOAT ( 'A' | 'B' ) 

                              COMMA HEX_DIGIT  HEX_DIGIT    ;

          HEX_DIGIT   :  '0'..'9' | 'A'..'F' | 'a'..'f'  ;
          INT         :  '0'..'9'+ ;
          FLOAT       :  '0'..'9'+ ('.' '0'..'9'*)? ; 
          COMMA       :  ',' ;

The associated test input is:

          TEST,123,5.6A,2D

          TEST,321,4.20A,3B

          TEST,45,5.68B,78            



For this example, the hex digits are the last 2 characters on each line.
For the first test statement, parsing is successful.  For the second, I
get a MismatchedTokenException (0!=0) on the B (the last character).
For the third, I get a MismatchedTokenException(0!=0)  on the 7 (the
next to last character).  I am definitely confused.

 

Thanks,

 

    Larry

 


From kunalsawlani at gmail.com  Thu Jul  1 11:33:19 2010
From: kunalsawlani at gmail.com (Kunal Sawlani)
Date: Thu, 1 Jul 2010 14:33:19 -0400
Subject: [antlr-interest] Basic predicate question
In-Reply-To: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
References: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
Message-ID: <AANLkTilrzOfmkk72gnDytAxkisyGkgayjYk4yx1Euvk0@mail.gmail.com>

Hi Larry,
The reason for the second test not getting parsed is the fact that the
('A'|'B') in the rule

    test    :   'TEST' COMMA INT COMMA FLOAT ( 'A' | 'B' )

                             COMMA HEX_DIGIT  HEX_DIGIT    ;
ends up creating two token definitions, with type 9 and 10 respectively. So,
the B in the test returns a token with type 10, rather than a token of type
HEX_DIGIT.

And for the 3rd test, your INT rule says one or more digits. So the 78 in
the third test is returned as an INT from the Lexer, as ANTLR always matches
characters against the longest possible lexer rule, unless specified
otherwise.

Take a look at the generated target file for token definitions.
Hope this helps.



On Thu, Jul 1, 2010 at 2:03 PM, Zeafla, Larry <zeaflal at aai.textron.com>wrote:

> I am new to Antlr, which I am trying to use to parse simple existing
> messages.  The message structure is exceptionally simple and
> straightforward.  Message fields include integer and floating-point
> numbers, single letter codes, and field separator characters.  Each
> individual message type has a narrowly defined structure, needs no look
> ahead, and typically has at most 2 possible tokens for any location in
> the message.
>
>
>
> My problem is that one of the fields is a 2-digit (in ASCII)
> representation of a hex number.  This is known purely from context.  It
> seems there should be a simple technique (probably a predicate), to
> force this behavior.  I just can't seem to find it.
>
>
>
> Here is a short sample grammar to illustrate:
>
>          grammar sample;
>          prog   :   test+ ;
>          test    :   'TEST' COMMA INT COMMA FLOAT ( 'A' | 'B' )
>
>                              COMMA HEX_DIGIT  HEX_DIGIT    ;
>
>          HEX_DIGIT   :  '0'..'9' | 'A'..'F' | 'a'..'f'  ;
>          INT         :  '0'..'9'+ ;
>          FLOAT       :  '0'..'9'+ ('.' '0'..'9'*)? ;
>          COMMA       :  ',' ;
>
> The associated test input is:
>
>          TEST,123,5.6A,2D
>
>          TEST,321,4.20A,3B
>
>          TEST,45,5.68B,78
>
>
>
> For this example, the hex digits are the last 2 characters on each line.
> For the first test statement, parsing is successful.  For the second, I
> get a MismatchedTokenException (0!=0) on the B (the last character).
> For the third, I get a MismatchedTokenException(0!=0)  on the 7 (the
> next to last character).  I am definitely confused.
>
>
>
> Thanks,
>
>
>
>    Larry
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
Kunal

From Darin.Mikesell at gd-ais.com  Thu Jul  1 11:53:38 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Thu, 1 Jul 2010 13:53:38 -0500
Subject: [antlr-interest] Basic predicate question
In-Reply-To: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
References: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97A2E@EADC01-MABPRD11.ad.gd-ais.com>

Something like this will prevent the ANTLR from getting confused:

grammar sample;

prog 	:	test+ ;

test	:	'TEST' COMMA (INT | HEX_OBJ) COMMA FLOAT_OBJ
		COMMA HEX_OBJ ;

HEX_OBJ	:	HEX_DIGIT HEX_DIGIT ;

HEX_DIGIT
	:	'0'..'9' | 'A'..'F' | 'a'..'f' ;

INT	
	:	'0'..'9'+ ;
	
FLOAT_OBJ	
	:	'0'..'9'+ ('.' '0'..'9'*)? ('A' | 'B');
	
COMMA	:	',' ;




- Darin


-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Zeafla, Larry
Sent: Thursday, July 01, 2010 11:03 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Basic predicate question

I am new to Antlr, which I am trying to use to parse simple existing
messages.  The message structure is exceptionally simple and
straightforward.  Message fields include integer and floating-point
numbers, single letter codes, and field separator characters.  Each
individual message type has a narrowly defined structure, needs no look
ahead, and typically has at most 2 possible tokens for any location in
the message.

 

My problem is that one of the fields is a 2-digit (in ASCII)
representation of a hex number.  This is known purely from context.  It
seems there should be a simple technique (probably a predicate), to
force this behavior.  I just can't seem to find it.

 

Here is a short sample grammar to illustrate:

          grammar sample;
          prog   :   test+ ;
          test    :   'TEST' COMMA INT COMMA FLOAT ( 'A' | 'B' ) 

                              COMMA HEX_DIGIT  HEX_DIGIT    ;

          HEX_DIGIT   :  '0'..'9' | 'A'..'F' | 'a'..'f'  ;
          INT         :  '0'..'9'+ ;
          FLOAT       :  '0'..'9'+ ('.' '0'..'9'*)? ; 
          COMMA       :  ',' ;

The associated test input is:

          TEST,123,5.6A,2D

          TEST,321,4.20A,3B

          TEST,45,5.68B,78            



For this example, the hex digits are the last 2 characters on each line.
For the first test statement, parsing is successful.  For the second, I
get a MismatchedTokenException (0!=0) on the B (the last character).
For the third, I get a MismatchedTokenException(0!=0)  on the 7 (the
next to last character).  I am definitely confused.

 

Thanks,

 

    Larry

 


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jbb at acm.org  Thu Jul  1 13:22:45 2010
From: jbb at acm.org (John B. Brodie)
Date: Thu, 01 Jul 2010 16:22:45 -0400
Subject: [antlr-interest] Basic predicate question
In-Reply-To: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
References: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
Message-ID: <1278015765.6976.12.camel@gecko.home.org>

Greetings!
On Thu, 2010-07-01 at 14:03 -0400, Zeafla, Larry wrote:
> I am new to Antlr, which I am trying to use to parse simple existing
> messages.  The message structure is exceptionally simple and
> straightforward.  Message fields include integer and floating-point
> numbers, single letter codes, and field separator characters.  Each
> individual message type has a narrowly defined structure, needs no look
> ahead, and typically has at most 2 possible tokens for any location in
> the message.
> 
Welcome!

Respectfully, in my opinion, using ANTLR for this task seems to be
overkill. Why not just read each message into a String. Use the split()
method on the comma in order to get the fields. And then analyze the
array returned by split(",")? (or maybe regular expressions?)
 

> My problem is that one of the fields is a 2-digit (in ASCII)
> representation of a hex number.  This is known purely from context.  It
> seems there should be a simple technique (probably a predicate), to
> force this behavior.  I just can't seem to find it.
> 
>  
> 
> Here is a short sample grammar to illustrate:
> 
>           grammar sample;
>           prog   :   test+ ;
>           test    :   'TEST' COMMA INT COMMA FLOAT ( 'A' | 'B' ) 
> 
>                               COMMA HEX_DIGIT  HEX_DIGIT    ;
> 
>           HEX_DIGIT   :  '0'..'9' | 'A'..'F' | 'a'..'f'  ;
>           INT         :  '0'..'9'+ ;
>           FLOAT       :  '0'..'9'+ ('.' '0'..'9'*)? ; 
>           COMMA       :  ',' ;
> 
> The associated test input is:
> 
>           TEST,123,5.6A,2D
> 
>           TEST,321,4.20A,3B
> 
>           TEST,45,5.68B,78            
> 
> 
> 
> For this example, the hex digits are the last 2 characters on each line.
> For the first test statement, parsing is successful.  For the second, I
> get a MismatchedTokenException (0!=0) on the B (the last character).
> For the third, I get a MismatchedTokenException(0!=0)  on the 7 (the
> next to last character).  I am definitely confused.

as pointed out in another message in this thread. you have specified
that 'A' and 'B' are keywords in your language and yet you also want
them to be HEX_DIGITs. the lexer can not work out this ambiguity (i
believe). same problem with '0' .. '9' ---- are they a HEX_DIGIT or are
they a single digit INT?

if you really really want to do this task using ANTLR (see above rant
regarding split() and regex's) I think you will have to do all of the
work in the parser.

usually manipulating individual characters in parser rules quickly leads
to parsing ambiguities. but your problem as stated seems to be simple
enough that it will not be a problem (unless you are gonna add more
stuff).

attached please find an alternative grammar of your sample that
illustrates this approach tested with just your 3 sample inputs.

Hope this helps...
   -jbb

-------------- next part --------------
grammar Sample;

options {
   output = AST;
   ASTLabelType = CommonTree;
}

@members {
   private static final String [] x = new String[] {
      "TEST,123,5.6A,2D",
      "TEST,321,4.20A,3B",
      "TEST,45,5.68B,78"
  };

   public static void main(String [] args) {
      for( int i = 0; i < x.length; ++i ) {
         try {
            System.out.println("about to parse:`"+x[i]+"`");
            SampleLexer lexer = new SampleLexer(new ANTLRStringStream(x[i]));
            CommonTokenStream tokens = new CommonTokenStream(lexer);

            SampleParser parser = new SampleParser(tokens);
            SampleParser.start_return p_result = parser.start();

            CommonTree ast = p_result.tree;
            if( ast == null ) {
               System.out.println("resultant tree: is NULL");
            } else {
               System.out.println("resultant tree: " + ast.toStringTree());
            }
            System.out.println();
         } catch(Exception e) {
            e.printStackTrace();
         }
      }
   }
}

start   :   test+ ;
test    :   T E S T comma integer comma flonum ( A | B ) 
                   comma hex_digit  hex_digit    ;

hex_digit   :  DIGIT | A | B | C | D | E | F ;
integer     :  DIGIT+ ;
flonum      :  DIGIT+ ('.' DIGIT*)? ; 
comma       :  ',' ;

DIGIT : '0'..'9';

A : 'A' | 'a' ;
B : 'B' | 'b' ;
C : 'C' | 'c' ;
D : 'D' | 'd' ;
E : 'E' | 'e' ;
F : 'F' | 'f' ;
G : 'G' | 'g' ;
H : 'H' | 'h' ;
I : 'I' | 'i' ;
J : 'J' | 'j' ;
K : 'K' | 'k' ;
L : 'L' | 'l' ;
M : 'M' | 'm' ;
N : 'N' | 'n' ;
O : 'O' | 'o' ;
P : 'P' | 'p' ;
Q : 'Q' | 'q' ;
R : 'R' | 'r' ;
S : 'S' | 's' ;
T : 'T' | 't' ;
U : 'U' | 'u' ;
V : 'V' | 'v' ;
W : 'W' | 'w' ;
X : 'X' | 'x' ;
Y : 'Y' | 'y' ;
Z : 'Z' | 'z' ;

From Darin.Mikesell at gd-ais.com  Thu Jul  1 13:25:23 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Thu, 1 Jul 2010 15:25:23 -0500
Subject: [antlr-interest] Basic predicate question
In-Reply-To: <74858D4BB13DA34B946363FB76A728CC04031142@txamasnwh021.ent.textron.com>
References: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97A2B@EADC01-MABPRD11.ad.gd-ais.com>
	<74858D4BB13DA34B946363FB76A728CC04031142@txamasnwh021.ent.textron.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97B3B@EADC01-MABPRD11.ad.gd-ais.com>

I believe that's why in most languages that support various literals, each literal usually has its own unique prefix/suffix.

(i.e. in C	0x54 - Hex
		54f - Float
		54 - Decimal
		054 - Octal)


Because if you think about it, there really is no way for the parser to recognize that a decimal value is supposed to be a hex value if that hex value is 54.

You could do something like:

HEX_LITERAL : '0' ('x' | 'X') HexDigit+ ;

Fragment
HexDigit : ('0'..'9'|'a'..'f'|'A'..'F') ;


That's how a Hex is defined in the C grammar.


- Darin



-----Original Message-----
From: Zeafla, Larry [mailto:zeaflal at aai.textron.com] 
Sent: Thursday, July 01, 2010 1:08 PM
To: Mikesell, Darin B.
Subject: RE: Basic predicate question

Thanks.  That looks a like progress.  I am guessing that as I progress
further allowing the first integer to be parsed as either an integer or
a hex value will add some new complications when I need to evaluate the
underlying values.  I guess I will worry about that later.

I also see that my example was a little over simplified.  The letter
following the float is totally unrelated to the float.  And overall
there are a lot of differing letter choices.  I just simplified that
aspect of the example to the point were the independence was lost.

Thanks

     Larry

 

-----Original Message-----
From: Mikesell, Darin B. [mailto:Darin.Mikesell at gd-ais.com] 
Sent: Thursday, July 01, 2010 2:53 PM
To: Zeafla, Larry
Subject: RE: Basic predicate question

Something like this will prevent the ANTLR from getting confused:

grammar sample;

prog 	:	test+ ;

test	:	'TEST' COMMA (INT | HEX_OBJ) COMMA FLOAT_OBJ
		COMMA HEX_OBJ ;

HEX_OBJ	:	HEX_DIGIT HEX_DIGIT ;

HEX_DIGIT
	:	'0'..'9' | 'A'..'F' | 'a'..'f' ;

INT	
	:	'0'..'9'+ ;
	
FLOAT_OBJ	
	:	'0'..'9'+ ('.' '0'..'9'*)? ('A' | 'B');
	
COMMA	:	',' ;




- Darin



-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Zeafla, Larry
Sent: Thursday, July 01, 2010 11:03 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Basic predicate question

I am new to Antlr, which I am trying to use to parse simple existing
messages.  The message structure is exceptionally simple and
straightforward.  Message fields include integer and floating-point
numbers, single letter codes, and field separator characters.  Each
individual message type has a narrowly defined structure, needs no look
ahead, and typically has at most 2 possible tokens for any location in
the message.

 

My problem is that one of the fields is a 2-digit (in ASCII)
representation of a hex number.  This is known purely from context.  It
seems there should be a simple technique (probably a predicate), to
force this behavior.  I just can't seem to find it.

 

Here is a short sample grammar to illustrate:

          grammar sample;
          prog   :   test+ ;
          test    :   'TEST' COMMA INT COMMA FLOAT ( 'A' | 'B' ) 

                              COMMA HEX_DIGIT  HEX_DIGIT    ;

          HEX_DIGIT   :  '0'..'9' | 'A'..'F' | 'a'..'f'  ;
          INT         :  '0'..'9'+ ;
          FLOAT       :  '0'..'9'+ ('.' '0'..'9'*)? ; 
          COMMA       :  ',' ;

The associated test input is:

          TEST,123,5.6A,2D

          TEST,321,4.20A,3B

          TEST,45,5.68B,78            



For this example, the hex digits are the last 2 characters on each line.
For the first test statement, parsing is successful.  For the second, I
get a MismatchedTokenException (0!=0) on the B (the last character).
For the third, I get a MismatchedTokenException(0!=0)  on the 7 (the
next to last character).  I am definitely confused.

 

Thanks,

 

    Larry

 


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From Darin.Mikesell at gd-ais.com  Thu Jul  1 14:41:28 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Thu, 1 Jul 2010 16:41:28 -0500
Subject: [antlr-interest] Bug or Error
In-Reply-To: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D654F8@EADC01-MABPRD11.ad.gd-ais.com>
References: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D654F8@EADC01-MABPRD11.ad.gd-ais.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97BEF@EADC01-MABPRD11.ad.gd-ais.com>

Well I got the Exceptions, with regard to the comments in my grammar, to disappear.


I changed my comment grammar from

LINE_COMMENT
    	: (';' | '!') ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
    	;

to

LINE_COMMENT
    	: (';' | '!') ~('\n'|'\r')* '\r'? '\n' {skip();}
    	;


Exceptions gone.  I guess that'll work for now.



- Darin



-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mikesell, Darin B.
Sent: Wednesday, June 30, 2010 2:31 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Bug or Error

I have an interesting error/bug that just started coming up.

First here's a description of the bug.  If I enter a Line Comment, then the next keyword that is encountered (however many lines below that comment) will seem to have its first letter incorrectly 'read'. If I enter a 2nd or 3rd line of comments after that 1st comment, then the 2nd and 3rd letter of that same keyword will not be 'read'.  When I say 'read', I mean to say that the word will have its 1st-3rd letter grayed out, almost like it was considered still part of the comment(s) from the line above.

The weird part is that everything seems to run fine (i.e. the parse tree builds correctly), other than the Exception below being thrown if enough comments are read as to gray out the entire keyword.  Here's the other kicker, I only get the Exception being thrown if I debug from an input file... if I copy/paste the data from the file into the Text window and debug, the Exception never gets thrown.

The interesting part is that I never received this Exception being thrown before, it just started coming up. I've been testing this grammar for about a week and then just yesterday this Exception starting popping up.  The only thing that I can recall doing that may have caused it was that I clicked on the Refactor, Remove All Left Recursion.

I wish I was using versioning software, so I can just revert, but I don't think that would help anyway because the Exception is still being thrown even when I run the example grammars (the comments in the example grammars are having the same effect).

I'm using ANTLRWorks 1.4  I've tried deleting and reinstalling (including deleting the registry keys) to no avail.
I've tried using Java 1.5 and Java 1.6 and it doesn't matter, the Exception still gets thrown.

Here is a subset of my language, I've broken it down to its smallest possible pieces for the debugging purposes I was performing, and have determined (as stated above) that the Exceptions seem to be caused by the comments section.


grammar myLang;

my_program
        : 'begin'
           statement+
          'end'
        ;

// S t a t e m e n t s
statement
        : print_statement
        ;

print_statement
        : 'print' STRING_LITERAL
        ;

STRING_LITERAL
        :  '"' ( ~('\\'|'"') )* '"'
        ;

WS
        :  (' '|'\t'|'\u000C'|'\r'|'\n') {$channel=HIDDEN;}
        ;

LINE_COMMENT
        : (';' | '!') ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
        ;


Here is the input program that I'm using:
begin
   ; Comment Line 1
   ; Comment Line 2
   ; Comment Line 3
   ; Comment Line 4
   ; Comment Line 5
   ; Comment Line 6
   print "This is a test print statement"
end



Here is the exception that is being thrown:
[14:19:10] javax.swing.text.BadLocationException: Position not represented by view
        at javax.swing.text.CompositeView.modelToView(Unknown Source)
        at javax.swing.text.BoxView.modelToView(Unknown Source)
        at javax.swing.plaf.basic.BasicTextUI$RootView.modelToView(Unknown Source)
        at javax.swing.plaf.basic.BasicTextUI.modelToView(Unknown Source)
        at javax.swing.plaf.basic.BasicTextUI.modelToView(Unknown Source)
        at javax.swing.text.JTextComponent.modelToView(Unknown Source)
        at org.antlr.works.debugger.input.DBInputProcessorToken$1.run(DBInputProcessorToken.java:304)
        at java.awt.event.InvocationEvent.dispatch(Unknown Source)
        at java.awt.EventQueue.dispatchEvent(Unknown Source)
        at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
        at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
        at java.awt.EventDispatchThread.run(Unknown Source)

Any advice would be greatly appreciated.


- Darin


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From vuurwerk.christian at googlemail.com  Thu Jul  1 15:02:47 2010
From: vuurwerk.christian at googlemail.com (Christian (VuuRWerK) Seifert)
Date: Fri, 2 Jul 2010 00:02:47 +0200
Subject: [antlr-interest] Issues with mutually left-recursive rules
Message-ID: <AANLkTilcoDIQkiTPUqRq7WtS_g18cdxFD4szj-ELqEoK@mail.gmail.com>

Hi list,

I've got some troubles with mutually left-recursive rules in my
grammar (which is just an easy conversion of an original EBNF
grammar).

First the error message:
========== >8 ==========
error(210):  The following sets of rules are mutually left-recursive
[pre_unary_expression, expression, array_declaration]
========== 8< ==========

The rules which cause the error:
========== >8 ==========
expression          : pre_unary_expression ( binary_operator expression )?;

pre_unary_expression: '++' primary_variable
                    | '--' primary_variable
                    | unary_expression
                    | expression KW_INSTANCEOF identifier
                    | array_declaration
                    ;

array_declaration   : KW_ARRAY '(' ( ( expression '=>' )? expression (
',' expression )* ( ',' )? )? ')'
                    | expression '..' expression
                    ;
========== 8< ==========

If I remove the pre_unary_expression from the expression rule the
error disappear, But for my intention the rule "expression" comprise a
pre_unary_expression.

I've already read
http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal and
tried it as the author suggest it but I get no idea which rules I
should "inline". And ANTLRWorks means the selected rule has no
left-recursion ...
I've also read a lot of left-recursion and how to remove it but all
what I've tried so far doesn't work :(

I'm very sad about that I can't get it to work and it's my last idea
to try one's luck here at the list.
Hope someone can help me or just can give me a hint where I can find
more infos about to solve my problem.

Best regards
Christian

From Darin.Mikesell at gd-ais.com  Thu Jul  1 15:52:35 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Thu, 1 Jul 2010 17:52:35 -0500
Subject: [antlr-interest] Issues with mutually left-recursive rules
References: <AANLkTilcoDIQkiTPUqRq7WtS_g18cdxFD4szj-ELqEoK@mail.gmail.com> 
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97CA8@EADC01-MABPRD11.ad.gd-ais.com>

So in your grammar it's possible to have an expression of the form:

++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?


- Darin

-----Original Message-----
From: Mikesell, Darin B. 
Sent: Thursday, July 01, 2010 3:51 PM
To: 'vuurwerk.christian at gmail.com'
Subject: RE: [antlr-interest] Issues with mutually left-recursive rules

So in your grammar it's possible to have an expression of the form:

++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?


- Darin


-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Christian (VuuRWerK) Seifert
Sent: Thursday, July 01, 2010 3:03 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Issues with mutually left-recursive rules

Hi list,

I've got some troubles with mutually left-recursive rules in my
grammar (which is just an easy conversion of an original EBNF
grammar).

First the error message:
========== >8 ==========
error(210):  The following sets of rules are mutually left-recursive
[pre_unary_expression, expression, array_declaration]
========== 8< ==========

The rules which cause the error:
========== >8 ==========
expression          : pre_unary_expression ( binary_operator expression )?;

pre_unary_expression: '++' primary_variable
                    | '--' primary_variable
                    | unary_expression
                    | expression KW_INSTANCEOF identifier
                    | array_declaration
                    ;

array_declaration   : KW_ARRAY '(' ( ( expression '=>' )? expression (
',' expression )* ( ',' )? )? ')'
                    | expression '..' expression
                    ;
========== 8< ==========

If I remove the pre_unary_expression from the expression rule the
error disappear, But for my intention the rule "expression" comprise a
pre_unary_expression.

I've already read
http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal and
tried it as the author suggest it but I get no idea which rules I
should "inline". And ANTLRWorks means the selected rule has no
left-recursion ...
I've also read a lot of left-recursion and how to remove it but all
what I've tried so far doesn't work :(

I'm very sad about that I can't get it to work and it's my last idea
to try one's luck here at the list.
Hope someone can help me or just can give me a hint where I can find
more infos about to solve my problem.

Best regards
Christian

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From mattpalms at gmail.com  Fri Jul  2 05:21:19 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Fri, 2 Jul 2010 13:21:19 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
References: <AcrwgLZ8TTFg0vFiRC+W+Z3y1zg2WQ==>
	<D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
Message-ID: <AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com>

I have exactly the same issues, but running on Ubuntu 10.04, so it's not a
windows issue.  Strangely, some grammars the debugger runs, and others it
simply times out.  I haven't figured out what is going on yet.


On 10 May 2010 21:38, Jane Eisenstein <Jane.Eisenstein at medecision.com>wrote:

> I've been using the Snow Leopard version of antlrworks to develop and run a
> simple grammar. At work, I only have Windows XP and am running into problems
> trying to run/debug the grammar with the MS Windows version of antlrworks.
> I'm using sun's jdk1.6.0_17.
>
> Selecting Run/Run... results in this console message: TODO: run and send
> output to this console
> Is this command not supported under MS Windows?
>
> Also, trying to debug results in an alert stating:
> Cannot launch the debugger Tab. Time-out waiting to connect to the remote
> parser.
> Running netstat -aon | find /i "49100" returns no results
>
> Is there something I can do to correct these problems?
>
>
>
>
> --------------------------------------------------------------------------------------
> The information transmitted is intended only for the person or entity to
> which it is addressed and may contain confidential and/or privileged
> material. Any review, retransmission, dissemination or other use of, or
> taking of any action in reliance upon, this information by persons or
> entities other than the intended recipient is prohibited. If you received
> this message in error, please contact the sender and delete the material
> from any computer.
>
> --------------------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jacobson.martin at gmail.com  Fri Jul  2 05:35:40 2010
From: jacobson.martin at gmail.com (Martin Jacobson)
Date: Fri, 2 Jul 2010 13:35:40 +0100
Subject: [antlr-interest] Noob Question
Message-ID: <AANLkTinWheH3wCYtR-1tGiH4z0DGeZ_f5mL0oWqnWcIQ@mail.gmail.com>

I have the following error:

/Users/martin/ANTLR/SVG/PathParser.g:0:0: syntax error: codegen:
<AST>:0:0: unexpected end of subtree

What does this indicate?
Is there a searchable archive I can trawl through?

Any help gratefully received!
Martin

-- 
>From my MacBook Pro

From bkiers at gmail.com  Fri Jul  2 05:50:07 2010
From: bkiers at gmail.com (Bart Kiers)
Date: Fri, 2 Jul 2010 14:50:07 +0200
Subject: [antlr-interest] Noob Question
In-Reply-To: <AANLkTinWheH3wCYtR-1tGiH4z0DGeZ_f5mL0oWqnWcIQ@mail.gmail.com>
References: <AANLkTinWheH3wCYtR-1tGiH4z0DGeZ_f5mL0oWqnWcIQ@mail.gmail.com>
Message-ID: <AANLkTim5DqTY8ISTMrQ_VuPNV11yYTGnTaHzlTney_0H@mail.gmail.com>

Hi Martin,

On Fri, Jul 2, 2010 at 2:35 PM, Martin Jacobson
<jacobson.martin at gmail.com>wrote:

> I have the following error:
>
> /Users/martin/ANTLR/SVG/PathParser.g:0:0: syntax error: codegen:
> <AST>:0:0: unexpected end of subtree
>
> What does this indicate?
>

Not sure. If, after search the below link, you're still stuck, could you
post the grammar?



> Is there a searchable archive I can trawl through?
>

Yes: http://antlr.markmail.org/

Regards,

Bart Kiers.

From jacobson.martin at gmail.com  Fri Jul  2 06:22:12 2010
From: jacobson.martin at gmail.com (Martin Jacobson)
Date: Fri, 2 Jul 2010 14:22:12 +0100
Subject: [antlr-interest] Noob Question
In-Reply-To: <AANLkTim5DqTY8ISTMrQ_VuPNV11yYTGnTaHzlTney_0H@mail.gmail.com>
References: <AANLkTinWheH3wCYtR-1tGiH4z0DGeZ_f5mL0oWqnWcIQ@mail.gmail.com>
	<AANLkTim5DqTY8ISTMrQ_VuPNV11yYTGnTaHzlTney_0H@mail.gmail.com>
Message-ID: <AANLkTikcfXSVf0JH0uHHjk7sUuG649FijGcJhsWgAd3J@mail.gmail.com>

I suspect the error message is too generic to be useful for a noob like me!
I am trying to parse SVG <path> data and create "Geometry" objects
(using the JTS library) - I have a working, but limited parser that I
hand-coded, and a Java-CUP/JFlex version that has serious issues
surrounding Classpaths. I have started to look at ANTLR, and produced
the following in ANTLRWorks...

========================== begin ==============
grammar PathParser;

INT :	'0'..'9'+
    ;

FLOAT
    :   ('0'..'9')+ '.' ('0'..'9')* EXPONENT?
    |   '.' ('0'..'9')+ EXPONENT?
    |   ('0'..'9')+ EXPONENT
    ;

WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        )* {$channel=HIDDEN;}
    ;

fragment
EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;


CmdM 	:	'M' FLOAT ','? FLOAT LineArgs?;
Cmdm 	:	'm' FLOAT ','? FLOAT LineArgs?;

LineArgs
	:	(FLOAT ','? FLOAT)+;

CmdL 	:	'L' LineArgs;
Cmdl 	:	'l' LineArgs;

CmdZ 	:	'Z'|'z';

MoveDrawCmd
	:	CmdM Cmdm* (CmdL|Cmdl)* CmdZ?;

PathParser
	:	MoveDrawCmd+;
========================end=====================

I also don't know whether/how to indicated that whitespace is allowed,
but optional between lexer tokens.

Thanks for any insights!
Martin

On 2 July 2010 13:50, Bart Kiers <bkiers at gmail.com> wrote:
> Hi Martin,
> On Fri, Jul 2, 2010 at 2:35 PM, Martin Jacobson <jacobson.martin at gmail.com>
> wrote:
>>
>> I have the following error:
>>
>> /Users/martin/ANTLR/SVG/PathParser.g:0:0: syntax error: codegen:
>> <AST>:0:0: unexpected end of subtree
>>
>> What does this indicate?
>
> Not sure. If, after search the below link, you're still stuck, could you
> post the grammar?
>
>>
>> Is there a searchable archive I can trawl through?
>
> Yes:?http://antlr.markmail.org/
> Regards,
> Bart Kiers.



-- 
>From my MacBook Pro

From Darin.Mikesell at gd-ais.com  Fri Jul  2 06:45:51 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Fri, 2 Jul 2010 08:45:51 -0500
Subject: [antlr-interest] unable to run or debug grammar in
	antlrworks	1.4 on Windows XP
In-Reply-To: <AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com>
References: <AcrwgLZ8TTFg0vFiRC+W+Z3y1zg2WQ==>
	<D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>

I've gotten this time-out error in the past also.  It usually occurs when I'm using a look-ahead of k=2, if I change the look-ahead to k=1 and then recompile, it will sometimes spit out an error that leads me to a fix.  I can then fix the error, set look-ahead back to k=2, and then I'm able to debug.


- Darin


-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Matt Palmer
Sent: Friday, July 02, 2010 5:21 AM
To: Jane Eisenstein
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] unable to run or debug grammar in antlrworks 1.4 on Windows XP

I have exactly the same issues, but running on Ubuntu 10.04, so it's not a
windows issue.  Strangely, some grammars the debugger runs, and others it
simply times out.  I haven't figured out what is going on yet.


On 10 May 2010 21:38, Jane Eisenstein <Jane.Eisenstein at medecision.com>wrote:

> I've been using the Snow Leopard version of antlrworks to develop and run a
> simple grammar. At work, I only have Windows XP and am running into problems
> trying to run/debug the grammar with the MS Windows version of antlrworks.
> I'm using sun's jdk1.6.0_17.
>
> Selecting Run/Run... results in this console message: TODO: run and send
> output to this console
> Is this command not supported under MS Windows?
>
> Also, trying to debug results in an alert stating:
> Cannot launch the debugger Tab. Time-out waiting to connect to the remote
> parser.
> Running netstat -aon | find /i "49100" returns no results
>
> Is there something I can do to correct these problems?
>
>
>
>
> --------------------------------------------------------------------------------------
> The information transmitted is intended only for the person or entity to
> which it is addressed and may contain confidential and/or privileged
> material. Any review, retransmission, dissemination or other use of, or
> taking of any action in reliance upon, this information by persons or
> entities other than the intended recipient is prohibited. If you received
> this message in error, please contact the sender and delete the material
> from any computer.
>
> --------------------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From Darin.Mikesell at gd-ais.com  Fri Jul  2 06:51:35 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Fri, 2 Jul 2010 08:51:35 -0500
Subject: [antlr-interest] Noob Question
In-Reply-To: <AANLkTikcfXSVf0JH0uHHjk7sUuG649FijGcJhsWgAd3J@mail.gmail.com>
References: <AANLkTinWheH3wCYtR-1tGiH4z0DGeZ_f5mL0oWqnWcIQ@mail.gmail.com>
	<AANLkTim5DqTY8ISTMrQ_VuPNV11yYTGnTaHzlTney_0H@mail.gmail.com>
	<AANLkTikcfXSVf0JH0uHHjk7sUuG649FijGcJhsWgAd3J@mail.gmail.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DCC@EADC01-MABPRD11.ad.gd-ais.com>

All your rules are setup as Lexer rules in your grammar. Just remember, in ANTLR, Parser rules start with a lower case letter; you just need to change the first letter to lowercase in all your Parser rules.


- Darin



-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Jacobson
Sent: Friday, July 02, 2010 6:22 AM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Noob Question

I suspect the error message is too generic to be useful for a noob like me!
I am trying to parse SVG <path> data and create "Geometry" objects
(using the JTS library) - I have a working, but limited parser that I
hand-coded, and a Java-CUP/JFlex version that has serious issues
surrounding Classpaths. I have started to look at ANTLR, and produced
the following in ANTLRWorks...

========================== begin ==============
grammar PathParser;

INT :	'0'..'9'+
    ;

FLOAT
    :   ('0'..'9')+ '.' ('0'..'9')* EXPONENT?
    |   '.' ('0'..'9')+ EXPONENT?
    |   ('0'..'9')+ EXPONENT
    ;

WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        )* {$channel=HIDDEN;}
    ;

fragment
EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;


CmdM 	:	'M' FLOAT ','? FLOAT LineArgs?;
Cmdm 	:	'm' FLOAT ','? FLOAT LineArgs?;

LineArgs
	:	(FLOAT ','? FLOAT)+;

CmdL 	:	'L' LineArgs;
Cmdl 	:	'l' LineArgs;

CmdZ 	:	'Z'|'z';

MoveDrawCmd
	:	CmdM Cmdm* (CmdL|Cmdl)* CmdZ?;

PathParser
	:	MoveDrawCmd+;
========================end=====================

I also don't know whether/how to indicated that whitespace is allowed,
but optional between lexer tokens.

Thanks for any insights!
Martin

On 2 July 2010 13:50, Bart Kiers <bkiers at gmail.com> wrote:
> Hi Martin,
> On Fri, Jul 2, 2010 at 2:35 PM, Martin Jacobson <jacobson.martin at gmail.com>
> wrote:
>>
>> I have the following error:
>>
>> /Users/martin/ANTLR/SVG/PathParser.g:0:0: syntax error: codegen:
>> <AST>:0:0: unexpected end of subtree
>>
>> What does this indicate?
>
> Not sure. If, after search the below link, you're still stuck, could you
> post the grammar?
>
>>
>> Is there a searchable archive I can trawl through?
>
> Yes:?http://antlr.markmail.org/
> Regards,
> Bart Kiers.



-- 
From my MacBook Pro

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jacobson.martin at gmail.com  Fri Jul  2 06:57:19 2010
From: jacobson.martin at gmail.com (Martin Jacobson)
Date: Fri, 2 Jul 2010 14:57:19 +0100
Subject: [antlr-interest] Noob Question
In-Reply-To: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DCC@EADC01-MABPRD11.ad.gd-ais.com>
References: <AANLkTinWheH3wCYtR-1tGiH4z0DGeZ_f5mL0oWqnWcIQ@mail.gmail.com>
	<AANLkTim5DqTY8ISTMrQ_VuPNV11yYTGnTaHzlTney_0H@mail.gmail.com>
	<AANLkTikcfXSVf0JH0uHHjk7sUuG649FijGcJhsWgAd3J@mail.gmail.com>
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DCC@EADC01-MABPRD11.ad.gd-ais.com>
Message-ID: <AANLkTintTqLBMR0Eap2r0pvSozD7M-blTZ92X9mpw4aU@mail.gmail.com>

There you go! I knew it had to be something really dumb!
Thanks, it now generates code!

M

On 2 July 2010 14:51, Mikesell, Darin B. <Darin.Mikesell at gd-ais.com> wrote:
> All your rules are setup as Lexer rules in your grammar. Just remember, in ANTLR, Parser rules start with a lower case letter; you just need to change the first letter to lowercase in all your Parser rules.
>
>
> - Darin
>
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Jacobson
> Sent: Friday, July 02, 2010 6:22 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Noob Question
>
> I suspect the error message is too generic to be useful for a noob like me!
> I am trying to parse SVG <path> data and create "Geometry" objects
> (using the JTS library) - I have a working, but limited parser that I
> hand-coded, and a Java-CUP/JFlex version that has serious issues
> surrounding Classpaths. I have started to look at ANTLR, and produced
> the following in ANTLRWorks...
>
> ========================== begin ==============
> grammar PathParser;
>
> INT : ? '0'..'9'+
> ? ?;
>
> FLOAT
> ? ?: ? ('0'..'9')+ '.' ('0'..'9')* EXPONENT?
> ? ?| ? '.' ('0'..'9')+ EXPONENT?
> ? ?| ? ('0'..'9')+ EXPONENT
> ? ?;
>
> WS ?: ? ( ' '
> ? ? ? ?| '\t'
> ? ? ? ?| '\r'
> ? ? ? ?| '\n'
> ? ? ? ?)* {$channel=HIDDEN;}
> ? ?;
>
> fragment
> EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;
>
>
> CmdM ? ?: ? ? ? 'M' FLOAT ','? FLOAT LineArgs?;
> Cmdm ? ?: ? ? ? 'm' FLOAT ','? FLOAT LineArgs?;
>
> LineArgs
> ? ? ? ?: ? ? ? (FLOAT ','? FLOAT)+;
>
> CmdL ? ?: ? ? ? 'L' LineArgs;
> Cmdl ? ?: ? ? ? 'l' LineArgs;
>
> CmdZ ? ?: ? ? ? 'Z'|'z';
>
> MoveDrawCmd
> ? ? ? ?: ? ? ? CmdM Cmdm* (CmdL|Cmdl)* CmdZ?;
>
> PathParser
> ? ? ? ?: ? ? ? MoveDrawCmd+;
> ========================end=====================
>
> I also don't know whether/how to indicated that whitespace is allowed,
> but optional between lexer tokens.
>
> Thanks for any insights!
> Martin
>
> On 2 July 2010 13:50, Bart Kiers <bkiers at gmail.com> wrote:
>> Hi Martin,
>> On Fri, Jul 2, 2010 at 2:35 PM, Martin Jacobson <jacobson.martin at gmail.com>
>> wrote:
>>>
>>> I have the following error:
>>>
>>> /Users/martin/ANTLR/SVG/PathParser.g:0:0: syntax error: codegen:
>>> <AST>:0:0: unexpected end of subtree
>>>
>>> What does this indicate?
>>
>> Not sure. If, after search the below link, you're still stuck, could you
>> post the grammar?
>>
>>>
>>> Is there a searchable archive I can trawl through?
>>
>> Yes:?http://antlr.markmail.org/
>> Regards,
>> Bart Kiers.
>
>
>
> --
> From my MacBook Pro
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
>From my MacBook Pro

From Darin.Mikesell at gd-ais.com  Fri Jul  2 07:17:55 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Fri, 2 Jul 2010 09:17:55 -0500
Subject: [antlr-interest] Issues with mutually left-recursive rules
In-Reply-To: <AANLkTinJTiaAXdqx4OYVyzMHlK_Rwb9uuPGgdbK0N6-a@mail.gmail.com>
References: <AANLkTilcoDIQkiTPUqRq7WtS_g18cdxFD4szj-ELqEoK@mail.gmail.com>
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97CA8@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTinJTiaAXdqx4OYVyzMHlK_Rwb9uuPGgdbK0N6-a@mail.gmail.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DEC@EADC01-MABPRD11.ad.gd-ais.com>

Have you read the article at the following link:
http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal


> And I can't get the
> meaning that an array_declaration is an pre_unary_expression at the
> moment. I've just work it out depending on that EBNF-grammar ...

An array_declaration is a pre_unary_expression in your grammar because an array_declaration references an expression which references a pre_unary_expression which references an array_declaration which references an expression which references a pre_unary_expression and on and on and on.

The EBNF grammar that you are using is probably valid, but because ANTLR is a recursive descent parser it cannot handle left-recursive grammars, it would cause an infinite loop.


- Darin


-----Original Message-----
From: Christian (VuuRWerK) Seifert [mailto:vuurwerk.christian at googlemail.com] 
Sent: Friday, July 02, 2010 12:33 AM
To: Mikesell, Darin B.
Subject: Re: [antlr-interest] Issues with mutually left-recursive rules

Erm ... it should not :)

Actually the "instanceof"-check should work with a "primary_variable"
only. For the sake of completeness the "primary_variable"-rule:
========== >8 ==========
primary_variable    : '$' identifier ( '[' expression ']' | '->' expression )*;
========== 8< ==========

I've changed the "pre_unary_expression" according to this conclusion:
========== >8 ==========
pre_unary_expression: '++' primary_variable
                    | '--' primary_variable
                    | unary_expression
                    | primary_variable KW_INSTANCEOF identifier
                    | array_declaration
                    ;
========== 8< ==========

But the error still exists :(

If I remove the "array_declaration"-rule from the
"pre_unary_expression"-rule the error disappear. And I can't get the
meaning that an array_declaration is an pre_unary_expression at the
moment. I've just work it out depending on that EBNF-grammar ...

But I hope I found a solution for my plight.


2010/7/2 Mikesell, Darin B. <Darin.Mikesell at gd-ais.com>
>
> So in your grammar it's possible to have an expression of the form:
>
> ++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?
>
>
> - Darin
>
> -----Original Message-----
> From: Mikesell, Darin B.
> Sent: Thursday, July 01, 2010 3:51 PM
> To: 'vuurwerk.christian at gmail.com'
> Subject: RE: [antlr-interest] Issues with mutually left-recursive rules
>
> So in your grammar it's possible to have an expression of the form:
>
> ++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?
>
>
> - Darin
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Christian (VuuRWerK) Seifert
> Sent: Thursday, July 01, 2010 3:03 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Issues with mutually left-recursive rules
>
> Hi list,
>
> I've got some troubles with mutually left-recursive rules in my
> grammar (which is just an easy conversion of an original EBNF
> grammar).
>
> First the error message:
> ========== >8 ==========
> error(210): ?The following sets of rules are mutually left-recursive
> [pre_unary_expression, expression, array_declaration]
> ========== 8< ==========
>
> The rules which cause the error:
> ========== >8 ==========
> expression ? ? ? ? ?: pre_unary_expression ( binary_operator expression )?;
>
> pre_unary_expression: '++' primary_variable
> ? ? ? ? ? ? ? ? ? ?| '--' primary_variable
> ? ? ? ? ? ? ? ? ? ?| unary_expression
> ? ? ? ? ? ? ? ? ? ?| expression KW_INSTANCEOF identifier
> ? ? ? ? ? ? ? ? ? ?| array_declaration
> ? ? ? ? ? ? ? ? ? ?;
>
> array_declaration ? : KW_ARRAY '(' ( ( expression '=>' )? expression (
> ',' expression )* ( ',' )? )? ')'
> ? ? ? ? ? ? ? ? ? ?| expression '..' expression
> ? ? ? ? ? ? ? ? ? ?;
> ========== 8< ==========
>
> If I remove the pre_unary_expression from the expression rule the
> error disappear, But for my intention the rule "expression" comprise a
> pre_unary_expression.
>
> I've already read
> http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal and
> tried it as the author suggest it but I get no idea which rules I
> should "inline". And ANTLRWorks means the selected rule has no
> left-recursion ...
> I've also read a lot of left-recursion and how to remove it but all
> what I've tried so far doesn't work :(
>
> I'm very sad about that I can't get it to work and it's my last idea
> to try one's luck here at the list.
> Hope someone can help me or just can give me a hint where I can find
> more infos about to solve my problem.
>
> Best regards
> Christian
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From Darin.Mikesell at gd-ais.com  Fri Jul  2 10:01:56 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Fri, 2 Jul 2010 12:01:56 -0500
Subject: [antlr-interest] Issues with mutually left-recursive rules
In-Reply-To: <AANLkTilpsf76tE6_POQIuDdhsd-pssxzsb60wCg80EWU@mail.gmail.com>
References: <AANLkTilcoDIQkiTPUqRq7WtS_g18cdxFD4szj-ELqEoK@mail.gmail.com>
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97CA8@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTinJTiaAXdqx4OYVyzMHlK_Rwb9uuPGgdbK0N6-a@mail.gmail.com>
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DEC@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTilpsf76tE6_POQIuDdhsd-pssxzsb60wCg80EWU@mail.gmail.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97F6E@EADC01-MABPRD11.ad.gd-ais.com>

I'm not sure if you're willing to take this leap, but you could always throw out the EBNF your using (which seems to have many instances of left recursion and could be more work than it's worth in trying to eliminate those left recursive calls) and start from scratch by redesigning the EBNF from the ground up.

In order to help you redesign a new EBNF, you could ask yourself, "What grammar does this language most closely resemble?"  If it's C, then use the C grammar that is available online as a template to implementing the EBNF of your language.

I can say from my own experience that using the C grammar as a template has helped me in implementing two general languages.

Just my .02


- Darin




-----Original Message-----
From: Christian (VuuRWerK) Seifert [mailto:vuurwerk.christian at googlemail.com] 
Sent: Friday, July 02, 2010 9:52 AM
To: Mikesell, Darin B.
Subject: Re: [antlr-interest] Issues with mutually left-recursive rules

Yeah, I already read it (I've quote it also in my first message) and
I've tried it as the author described but without success.
It's very very disappointing for me, because I know how and why the
left-recursion happen but I have no clue to solve it :(

The array_declaration should be possible to declare with different
kind of expression. Thus I tried to remove the array_declaration from
the pre_unary_expression-rule and add it to the expression-rule
instead. Now I just get a left-recursion with expression and
array_declaration. I know it is because the array_declaration are
different kind of expression, which can in turn be yet another
array_declaration, which can be in turn ... you got the point :) But
how the hell I can solve the misery? ... :(

- Christian

2010/7/2 Mikesell, Darin B. <Darin.Mikesell at gd-ais.com>:
> Have you read the article at the following link:
> http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal
>
>
>> And I can't get the
>> meaning that an array_declaration is an pre_unary_expression at the
>> moment. I've just work it out depending on that EBNF-grammar ...
>
> An array_declaration is a pre_unary_expression in your grammar because an array_declaration references an expression which references a pre_unary_expression which references an array_declaration which references an expression which references a pre_unary_expression and on and on and on.
>
> The EBNF grammar that you are using is probably valid, but because ANTLR is a recursive descent parser it cannot handle left-recursive grammars, it would cause an infinite loop.
>
>
> - Darin
>
>
> -----Original Message-----
> From: Christian (VuuRWerK) Seifert [mailto:vuurwerk.christian at googlemail.com]
> Sent: Friday, July 02, 2010 12:33 AM
> To: Mikesell, Darin B.
> Subject: Re: [antlr-interest] Issues with mutually left-recursive rules
>
> Erm ... it should not :)
>
> Actually the "instanceof"-check should work with a "primary_variable"
> only. For the sake of completeness the "primary_variable"-rule:
> ========== >8 ==========
> primary_variable ? ?: '$' identifier ( '[' expression ']' | '->' expression )*;
> ========== 8< ==========
>
> I've changed the "pre_unary_expression" according to this conclusion:
> ========== >8 ==========
> pre_unary_expression: '++' primary_variable
> ? ? ? ? ? ? ? ? ? ?| '--' primary_variable
> ? ? ? ? ? ? ? ? ? ?| unary_expression
> ? ? ? ? ? ? ? ? ? ?| primary_variable KW_INSTANCEOF identifier
> ? ? ? ? ? ? ? ? ? ?| array_declaration
> ? ? ? ? ? ? ? ? ? ?;
> ========== 8< ==========
>
> But the error still exists :(
>
> If I remove the "array_declaration"-rule from the
> "pre_unary_expression"-rule the error disappear. And I can't get the
> meaning that an array_declaration is an pre_unary_expression at the
> moment. I've just work it out depending on that EBNF-grammar ...
>
> But I hope I found a solution for my plight.
>
>
> 2010/7/2 Mikesell, Darin B. <Darin.Mikesell at gd-ais.com>
>>
>> So in your grammar it's possible to have an expression of the form:
>>
>> ++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?
>>
>>
>> - Darin
>>
>> -----Original Message-----
>> From: Mikesell, Darin B.
>> Sent: Thursday, July 01, 2010 3:51 PM
>> To: 'vuurwerk.christian at gmail.com'
>> Subject: RE: [antlr-interest] Issues with mutually left-recursive rules
>>
>> So in your grammar it's possible to have an expression of the form:
>>
>> ++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?
>>
>>
>> - Darin
>>
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Christian (VuuRWerK) Seifert
>> Sent: Thursday, July 01, 2010 3:03 PM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] Issues with mutually left-recursive rules
>>
>> Hi list,
>>
>> I've got some troubles with mutually left-recursive rules in my
>> grammar (which is just an easy conversion of an original EBNF
>> grammar).
>>
>> First the error message:
>> ========== >8 ==========
>> error(210): ?The following sets of rules are mutually left-recursive
>> [pre_unary_expression, expression, array_declaration]
>> ========== 8< ==========
>>
>> The rules which cause the error:
>> ========== >8 ==========
>> expression ? ? ? ? ?: pre_unary_expression ( binary_operator expression )?;
>>
>> pre_unary_expression: '++' primary_variable
>> ? ? ? ? ? ? ? ? ? ?| '--' primary_variable
>> ? ? ? ? ? ? ? ? ? ?| unary_expression
>> ? ? ? ? ? ? ? ? ? ?| expression KW_INSTANCEOF identifier
>> ? ? ? ? ? ? ? ? ? ?| array_declaration
>> ? ? ? ? ? ? ? ? ? ?;
>>
>> array_declaration ? : KW_ARRAY '(' ( ( expression '=>' )? expression (
>> ',' expression )* ( ',' )? )? ')'
>> ? ? ? ? ? ? ? ? ? ?| expression '..' expression
>> ? ? ? ? ? ? ? ? ? ?;
>> ========== 8< ==========
>>
>> If I remove the pre_unary_expression from the expression rule the
>> error disappear, But for my intention the rule "expression" comprise a
>> pre_unary_expression.
>>
>> I've already read
>> http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal and
>> tried it as the author suggest it but I get no idea which rules I
>> should "inline". And ANTLRWorks means the selected rule has no
>> left-recursion ...
>> I've also read a lot of left-recursion and how to remove it but all
>> what I've tried so far doesn't work :(
>>
>> I'm very sad about that I can't get it to work and it's my last idea
>> to try one's luck here at the list.
>> Hope someone can help me or just can give me a hint where I can find
>> more infos about to solve my problem.
>>
>> Best regards
>> Christian
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From zeaflal at aai.textron.com  Fri Jul  2 12:09:18 2010
From: zeaflal at aai.textron.com (Zeafla, Larry)
Date: Fri, 2 Jul 2010 15:09:18 -0400
Subject: [antlr-interest] Basic predicate question
In-Reply-To: <1278015765.6976.12.camel@gecko.home.org>
References: <74858D4BB13DA34B946363FB76A728CC04030DEB@txamasnwh021.ent.textron.com>
	<1278015765.6976.12.camel@gecko.home.org>
Message-ID: <74858D4BB13DA34B946363FB76A728CC0407B44B@txamasnwh021.ent.textron.com>

It is true that Antlr is gross overkill for this example.  This example
is just a simplified version of the grammar of a subset of the overall
problem.  The example was selected as a starting point as it appeared to
be a relatively simple grammar to use for learning Antlr.  The overall
problem is much more complex and hopefully a more appropriate use of
Antlr.

          Larry
 

-----Original Message-----
From: John B. Brodie [mailto:jbb at acm.org] 
Sent: Thursday, July 01, 2010 4:23 PM
To: Zeafla, Larry
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Basic predicate question

Greetings!
On Thu, 2010-07-01 at 14:03 -0400, Zeafla, Larry wrote:
> I am new to Antlr, which I am trying to use to parse simple existing
> messages.  The message structure is exceptionally simple and
> straightforward.  Message fields include integer and floating-point
> numbers, single letter codes, and field separator characters.  Each
> individual message type has a narrowly defined structure, needs no
look
> ahead, and typically has at most 2 possible tokens for any location in
> the message.
> 
Welcome!

Respectfully, in my opinion, using ANTLR for this task seems to be
overkill. Why not just read each message into a String. Use the split()
method on the comma in order to get the fields. And then analyze the
array returned by split(",")? (or maybe regular expressions?)
 

> My problem is that one of the fields is a 2-digit (in ASCII)
> representation of a hex number.  This is known purely from context.
It
> seems there should be a simple technique (probably a predicate), to
> force this behavior.  I just can't seem to find it.
> 
>  
> 
> Here is a short sample grammar to illustrate:
> 
>           grammar sample;
>           prog   :   test+ ;
>           test    :   'TEST' COMMA INT COMMA FLOAT ( 'A' | 'B' ) 
> 
>                               COMMA HEX_DIGIT  HEX_DIGIT    ;
> 
>           HEX_DIGIT   :  '0'..'9' | 'A'..'F' | 'a'..'f'  ;
>           INT         :  '0'..'9'+ ;
>           FLOAT       :  '0'..'9'+ ('.' '0'..'9'*)? ; 
>           COMMA       :  ',' ;
> 
> The associated test input is:
> 
>           TEST,123,5.6A,2D
> 
>           TEST,321,4.20A,3B
> 
>           TEST,45,5.68B,78            
> 
> 
> 
> For this example, the hex digits are the last 2 characters on each
line.
> For the first test statement, parsing is successful.  For the second,
I
> get a MismatchedTokenException (0!=0) on the B (the last character).
> For the third, I get a MismatchedTokenException(0!=0)  on the 7 (the
> next to last character).  I am definitely confused.

as pointed out in another message in this thread. you have specified
that 'A' and 'B' are keywords in your language and yet you also want
them to be HEX_DIGITs. the lexer can not work out this ambiguity (i
believe). same problem with '0' .. '9' ---- are they a HEX_DIGIT or are
they a single digit INT?

if you really really want to do this task using ANTLR (see above rant
regarding split() and regex's) I think you will have to do all of the
work in the parser.

usually manipulating individual characters in parser rules quickly leads
to parsing ambiguities. but your problem as stated seems to be simple
enough that it will not be a problem (unless you are gonna add more
stuff).

attached please find an alternative grammar of your sample that
illustrates this approach tested with just your 3 sample inputs.

Hope this helps...
   -jbb


From vuurwerk.christian at googlemail.com  Fri Jul  2 13:02:00 2010
From: vuurwerk.christian at googlemail.com (Christian (VuuRWerK) Seifert)
Date: Fri, 2 Jul 2010 22:02:00 +0200
Subject: [antlr-interest] Fwd:  Issues with mutually left-recursive rules
In-Reply-To: <AANLkTild36zPTpako1nGQnZqGAzQbhY1uesnx5Pf20wk@mail.gmail.com>
References: <AANLkTilcoDIQkiTPUqRq7WtS_g18cdxFD4szj-ELqEoK@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97CA8@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTinJTiaAXdqx4OYVyzMHlK_Rwb9uuPGgdbK0N6-a@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DEC@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTilpsf76tE6_POQIuDdhsd-pssxzsb60wCg80EWU@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97F6E@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTild36zPTpako1nGQnZqGAzQbhY1uesnx5Pf20wk@mail.gmail.com>
Message-ID: <AANLkTik5G2-8pVEYo18VFzUsQFTIz2j44u5SJ9mgIR0s@mail.gmail.com>

---------- Forwarded message ----------
From: Christian (VuuRWerK) Seifert <vuurwerk.christian at googlemail.com>
Date: 2010/7/2
Subject: Re: [antlr-interest] Issues with mutually left-recursive rules
To: "Mikesell, Darin B." <Darin.Mikesell at gd-ais.com>


That's what I'm afraid of ... :/

I guess I will first re-define all the tokens only. Because I need
this grammar for a Netbeans-Plugin to support the ezcomponents
template language (here the EBNF-grammar I'm talking about:
http://ezcomponents.org/docs/api/trunk/Template_EBNF.html). First I
will just highlite some keywords and tokens (operators and so on).
Later I will rework the grammar for the parser to support
syntax-checks. I guess the language match nearly the syntax of PHP
which I could use as a template for the grammar.
Hooray, my weekend is safe ... ^^

Are there any helpful references about the differences of EBNF to
ANTLR-syntax or at least recursive descent parser?

Thx so far!
- Christian

2010/7/2 Mikesell, Darin B. <Darin.Mikesell at gd-ais.com>:
> I'm not sure if you're willing to take this leap, but you could always throw out the EBNF your using (which seems to have many instances of left recursion and could be more work than it's worth in trying to eliminate those left recursive calls) and start from scratch by redesigning the EBNF from the ground up.
>
> In order to help you redesign a new EBNF, you could ask yourself, "What grammar does this language most closely resemble?" ?If it's C, then use the C grammar that is available online as a template to implementing the EBNF of your language.
>
> I can say from my own experience that using the C grammar as a template has helped me in implementing two general languages.
>
> Just my .02
>
>
> - Darin
>
>
>
>
> -----Original Message-----
> From: Christian (VuuRWerK) Seifert [mailto:vuurwerk.christian at googlemail.com]
> Sent: Friday, July 02, 2010 9:52 AM
> To: Mikesell, Darin B.
> Subject: Re: [antlr-interest] Issues with mutually left-recursive rules
>
> Yeah, I already read it (I've quote it also in my first message) and
> I've tried it as the author described but without success.
> It's very very disappointing for me, because I know how and why the
> left-recursion happen but I have no clue to solve it :(
>
> The array_declaration should be possible to declare with different
> kind of expression. Thus I tried to remove the array_declaration from
> the pre_unary_expression-rule and add it to the expression-rule
> instead. Now I just get a left-recursion with expression and
> array_declaration. I know it is because the array_declaration are
> different kind of expression, which can in turn be yet another
> array_declaration, which can be in turn ... you got the point :) But
> how the hell I can solve the misery? ... :(
>
> - Christian
>
> 2010/7/2 Mikesell, Darin B. <Darin.Mikesell at gd-ais.com>:
>> Have you read the article at the following link:
>> http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal
>>
>>
>>> And I can't get the
>>> meaning that an array_declaration is an pre_unary_expression at the
>>> moment. I've just work it out depending on that EBNF-grammar ...
>>
>> An array_declaration is a pre_unary_expression in your grammar because an array_declaration references an expression which references a pre_unary_expression which references an array_declaration which references an expression which references a pre_unary_expression and on and on and on.
>>
>> The EBNF grammar that you are using is probably valid, but because ANTLR is a recursive descent parser it cannot handle left-recursive grammars, it would cause an infinite loop.
>>
>>
>> - Darin
>>
>>
>> -----Original Message-----
>> From: Christian (VuuRWerK) Seifert [mailto:vuurwerk.christian at googlemail.com]
>> Sent: Friday, July 02, 2010 12:33 AM
>> To: Mikesell, Darin B.
>> Subject: Re: [antlr-interest] Issues with mutually left-recursive rules
>>
>> Erm ... it should not :)
>>
>> Actually the "instanceof"-check should work with a "primary_variable"
>> only. For the sake of completeness the "primary_variable"-rule:
>> ========== >8 ==========
>> primary_variable ? ?: '$' identifier ( '[' expression ']' | '->' expression )*;
>> ========== 8< ==========
>>
>> I've changed the "pre_unary_expression" according to this conclusion:
>> ========== >8 ==========
>> pre_unary_expression: '++' primary_variable
>> ? ? ? ? ? ? ? ? ? ?| '--' primary_variable
>> ? ? ? ? ? ? ? ? ? ?| unary_expression
>> ? ? ? ? ? ? ? ? ? ?| primary_variable KW_INSTANCEOF identifier
>> ? ? ? ? ? ? ? ? ? ?| array_declaration
>> ? ? ? ? ? ? ? ? ? ?;
>> ========== 8< ==========
>>
>> But the error still exists :(
>>
>> If I remove the "array_declaration"-rule from the
>> "pre_unary_expression"-rule the error disappear. And I can't get the
>> meaning that an array_declaration is an pre_unary_expression at the
>> moment. I've just work it out depending on that EBNF-grammar ...
>>
>> But I hope I found a solution for my plight.
>>
>>
>> 2010/7/2 Mikesell, Darin B. <Darin.Mikesell at gd-ais.com>
>>>
>>> So in your grammar it's possible to have an expression of the form:
>>>
>>> ++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?
>>>
>>>
>>> - Darin
>>>
>>> -----Original Message-----
>>> From: Mikesell, Darin B.
>>> Sent: Thursday, July 01, 2010 3:51 PM
>>> To: 'vuurwerk.christian at gmail.com'
>>> Subject: RE: [antlr-interest] Issues with mutually left-recursive rules
>>>
>>> So in your grammar it's possible to have an expression of the form:
>>>
>>> ++primary_variable KW_INSTANCEOF identifier KW_INSTANCEOF identifier KW_INTANCEOF identifier KW_INSTANCEOF identifier and on and on?
>>>
>>>
>>> - Darin
>>>
>>>
>>> -----Original Message-----
>>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Christian (VuuRWerK) Seifert
>>> Sent: Thursday, July 01, 2010 3:03 PM
>>> To: antlr-interest at antlr.org
>>> Subject: [antlr-interest] Issues with mutually left-recursive rules
>>>
>>> Hi list,
>>>
>>> I've got some troubles with mutually left-recursive rules in my
>>> grammar (which is just an easy conversion of an original EBNF
>>> grammar).
>>>
>>> First the error message:
>>> ========== >8 ==========
>>> error(210): ?The following sets of rules are mutually left-recursive
>>> [pre_unary_expression, expression, array_declaration]
>>> ========== 8< ==========
>>>
>>> The rules which cause the error:
>>> ========== >8 ==========
>>> expression ? ? ? ? ?: pre_unary_expression ( binary_operator expression )?;
>>>
>>> pre_unary_expression: '++' primary_variable
>>> ? ? ? ? ? ? ? ? ? ?| '--' primary_variable
>>> ? ? ? ? ? ? ? ? ? ?| unary_expression
>>> ? ? ? ? ? ? ? ? ? ?| expression KW_INSTANCEOF identifier
>>> ? ? ? ? ? ? ? ? ? ?| array_declaration
>>> ? ? ? ? ? ? ? ? ? ?;
>>>
>>> array_declaration ? : KW_ARRAY '(' ( ( expression '=>' )? expression (
>>> ',' expression )* ( ',' )? )? ')'
>>> ? ? ? ? ? ? ? ? ? ?| expression '..' expression
>>> ? ? ? ? ? ? ? ? ? ?;
>>> ========== 8< ==========
>>>
>>> If I remove the pre_unary_expression from the expression rule the
>>> error disappear, But for my intention the rule "expression" comprise a
>>> pre_unary_expression.
>>>
>>> I've already read
>>> http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal and
>>> tried it as the author suggest it but I get no idea which rules I
>>> should "inline". And ANTLRWorks means the selected rule has no
>>> left-recursion ...
>>> I've also read a lot of left-recursion and how to remove it but all
>>> what I've tried so far doesn't work :(
>>>
>>> I'm very sad about that I can't get it to work and it's my last idea
>>> to try one's luck here at the list.
>>> Hope someone can help me or just can give me a hint where I can find
>>> more infos about to solve my problem.
>>>
>>> Best regards
>>> Christian
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From acondit at ipns.com  Fri Jul  2 16:59:31 2010
From: acondit at ipns.com (Alan Condit)
Date: Fri, 2 Jul 2010 16:59:31 -0700
Subject: [antlr-interest] Working on ObjC templates
Message-ID: <BF8D1E79-DA6D-41E3-96AF-CACACA6A6990@ipns.com>

I am trying to add name and type to ObjC.stg as attributes of return type. But I keep getting an error saying that java.util.ArrayList has no such attribute: type in template context[headerFile if(PARSER)_subtemplate parserHeaderFile(...) anonymous anonymous
returnScopeInterface if(!ruleDescriptor.isSynPred)_subtemplate
if(ruledescriptor.hasMultipleReturnValues)_subtemplate
if(scope.attributes:{<it.type>;};_subtemplate

So where is it that I need to add type that I haven't done.

I added it here:
ruleDeclarations() ::= <<
<ruleDescriptor.returnScope.attributes:{ a |
<a.type> <a.name>; }>
<if(ruleDescriptor.hasMultipleReturnValues)>
<returnType()> _retval = [[<returnTypeName()> alloc] init];
[_retval setStart:[input LT:1]];<\n>
<else>
<if(ruleDescriptor.hasSingleReturnValue)>
<returnType()> _<ruleDescriptor.singleValueReturnName> = <initValue(typeName=returnType())>;
<endif>
<endif>

Thanks in advance,
Alan
---

Alan Condit
1085 Tierra Ct.
Woodburn, OR 97071

Email -- acondit at ipns.com
Home-Office (503) 982-0906


From stefika at gmail.com  Fri Jul  2 18:37:51 2010
From: stefika at gmail.com (Andreas Stefik)
Date: Fri, 2 Jul 2010 20:37:51 -0500
Subject: [antlr-interest]  Managing more than one node as root exceptions
Message-ID: <AANLkTilF1urFn-s5xHQo4J9cC9tXTtuMEbQoMoJwjoCR@mail.gmail.com>

Hi folks,

I have a relatively simple grammar, which works well under most
conditions, but in one case it has issues. Here is a snippet of the
grammar:

expression :	or 	;
or 	:	and (OR ^ and)* 	;
and 	:	equality (AND ^ equality)* 	;	
equality:	comparison ((EQUALITY ^ | NOTEQUALS ^) comparison)* 	;
comparison:	add ((GREATER ^| GREATER_EQUAL ^| LESS ^| LESS_EQUAL^) add)* 	;
add	:	multiply ((PLUS ^| MINUS^) multiply)* 	;
multiply:	combo_expression ((MULTIPLY ^| DIVIDE ^|MODULO^) combo_expression)* 	;
combo_expression
	:	atom
	|	NOT atom
	|	CAST LEFT_PAREN assignment_declaration COMMA expression RIGHT_PAREN
	;
atom 	: qualified_name
	(
		LEFT_SQR_BRACE expression RIGHT_SQR_BRACE //this condition breaks
	|	(COLON ID)? LEFT_PAREN (expression (COMMA expression)*)?
RIGHT_PAREN //so does this one
	)?
	| (MINUS)? INT
	| BOOLEAN
	| (MINUS)? DECIMAL
	| STRING
	| NULL
	| LIBRARY_CALL LEFT_PAREN expression COMMA expression COMMA
expression RIGHT_PAREN
	| INPUT LEFT_PAREN expression RIGHT_PAREN
	| LEFT_PAREN expression RIGHT_PAREN -> ^(expression) ;

So far as I can tell from testing, this works fine, except in the case
where you have an expression with surrounding parentheses and the item
inside of it is a qualified_name, with either square braces or the
part of the rule after it. In this particular case, the following
exception is thrown:

java.lang.RuntimeException: more than one node as root (TODO: make
exception hierarchy)
	at org.antlr.runtime.tree.BaseTreeAdaptor.becomeRoot(BaseTreeAdaptor.java:150)
        at org.sonify.vm.hop.parser.HopParser.atom(HopParser.java:4954)
//notice it is in the parser, not the tree grammar
	at org.sonify.vm.hop.parser.HopParser.combo_expression(HopParser.java:4403)

To give an example of what would break in the language (not all rules
shown), this would work fine:

boolean array a
a[0] = 10
a[1] = a[0]

and this would throw the above exception

boolean array a
a[0] = 10
a[1] = (a[0])

I've tried everything obvious (to me) that I can think of (e.g.,
pulling out the rules one by one), but am perplexed as to why that
rule throws a double root exception.
I'm pretty sure the problem is relative to this portion of the
grammar, but just in case, here is the full grammar:

https://sourceforge.net/apps/trac/sodbeans/browser/trunk/sodbeans/Compiler/src/org/sonify/vm/hop/parser/Hop.g
and the full tree grammar:
https://sourceforge.net/apps/trac/sodbeans/browser/trunk/sodbeans/Compiler/src/org/sonify/vm/hop/parser/HopSymbolTableWalker.g

When I run the code in the ANTLRWorks interpreter, it generates the
trees just fine. One final clue is that my tree grammar is showing UP
and DOWN tokens, which I know means there is a mismatch somewhere ---
where, however, and how to fix, I'm not quite sure about, and this
error seems to be coming from the parser anyway, so I don't "suspect"
that that is the cause for this immediate problem.

Any help would be greatly appreciated, as the error is driving me a bit crazy,

Stefik

From stefika at gmail.com  Fri Jul  2 19:39:41 2010
From: stefika at gmail.com (Andreas Stefik)
Date: Fri, 2 Jul 2010 21:39:41 -0500
Subject: [antlr-interest] Managing more than one node as root exceptions
In-Reply-To: <AANLkTilF1urFn-s5xHQo4J9cC9tXTtuMEbQoMoJwjoCR@mail.gmail.com>
References: <AANLkTilF1urFn-s5xHQo4J9cC9tXTtuMEbQoMoJwjoCR@mail.gmail.com>
Message-ID: <AANLkTim1AcddfHQAjrE6jZYXy_AF-OwdJoZdxhkJHsYg@mail.gmail.com>

Hi again all,

And of course, in classic ME form, after spending 10 hours making this
problem much more difficult than it really is, I figure out the
solution 10 minutes after forever making my misunderstandings public.
So, the solution is trivial:

atom 	:
	qualified_name -> ^(QUALIFIED_SOLO_EXPRESSION qualified_name)
	|	qualified_name LEFT_SQR_BRACE expression RIGHT_SQR_BRACE ->
			^(ARRAY_EXPRESSION qualified_name LEFT_SQR_BRACE expression RIGHT_SQR_BRACE)
	|	qualified_name (COLON ID)? LEFT_PAREN (expression (COMMA
expression)*)? RIGHT_PAREN ->
			^(FUNCTION_CALL qualified_name (COLON ID)? LEFT_PAREN (expression
(COMMA expression)*)? RIGHT_PAREN)
	| (MINUS)? INT
	| BOOLEAN
	| (MINUS)? DECIMAL
	| STRING
	| NULL
	| LIBRARY_CALL LEFT_PAREN expression COMMA expression COMMA
expression RIGHT_PAREN
	| INPUT LEFT_PAREN expression RIGHT_PAREN
	| LEFT_PAREN expression RIGHT_PAREN -> ^(expression)
	;

I guess I wrote the rule the other way thinking I would avoid left
recursion (a typically sensible practice for LL), but when you write
it that way, you can't write rewrite rules (or I couldn't figure out
how), where there are two alternatives ^( this | that), with imaginary
roots. I'm still not sure I completely grasp why the alternative threw
multiple root exceptions, though. My best "guess" is that
qualified_name rule can have multiple tokens (roots), so it doesn't
necessarily qualify as a single root. However, why that would work
fine normally, but not when nested inside the LEFT_PAREN expression
RIGHT_PAREN rule still isn't obvious to me.

Anyway, sorry to bother everyone, and thanks for the potential help,

Stefik

On Fri, Jul 2, 2010 at 8:37 PM, Andreas Stefik <stefika at gmail.com> wrote:
> Hi folks,
>
> I have a relatively simple grammar, which works well under most
> conditions, but in one case it has issues. Here is a snippet of the
> grammar:
>
> expression : ? ?or ? ? ?;
> or ? ? ?: ? ? ? and (OR ^ and)* ? ? ? ? ;
> and ? ? : ? ? ? equality (AND ^ equality)* ? ? ?;
> equality: ? ? ? comparison ((EQUALITY ^ | NOTEQUALS ^) comparison)* ? ? ;
> comparison: ? ? add ((GREATER ^| GREATER_EQUAL ^| LESS ^| LESS_EQUAL^) add)* ? ?;
> add ? ? : ? ? ? multiply ((PLUS ^| MINUS^) multiply)* ? ;
> multiply: ? ? ? combo_expression ((MULTIPLY ^| DIVIDE ^|MODULO^) combo_expression)* ? ? ;
> combo_expression
> ? ? ? ?: ? ? ? atom
> ? ? ? ?| ? ? ? NOT atom
> ? ? ? ?| ? ? ? CAST LEFT_PAREN assignment_declaration COMMA expression RIGHT_PAREN
> ? ? ? ?;
> atom ? ?: qualified_name
> ? ? ? ?(
> ? ? ? ? ? ? ? ?LEFT_SQR_BRACE expression RIGHT_SQR_BRACE //this condition breaks
> ? ? ? ?| ? ? ? (COLON ID)? LEFT_PAREN (expression (COMMA expression)*)?
> RIGHT_PAREN //so does this one
> ? ? ? ?)?
> ? ? ? ?| (MINUS)? INT
> ? ? ? ?| BOOLEAN
> ? ? ? ?| (MINUS)? DECIMAL
> ? ? ? ?| STRING
> ? ? ? ?| NULL
> ? ? ? ?| LIBRARY_CALL LEFT_PAREN expression COMMA expression COMMA
> expression RIGHT_PAREN
> ? ? ? ?| INPUT LEFT_PAREN expression RIGHT_PAREN
> ? ? ? ?| LEFT_PAREN expression RIGHT_PAREN -> ^(expression) ;
>
> So far as I can tell from testing, this works fine, except in the case
> where you have an expression with surrounding parentheses and the item
> inside of it is a qualified_name, with either square braces or the
> part of the rule after it. In this particular case, the following
> exception is thrown:
>
> java.lang.RuntimeException: more than one node as root (TODO: make
> exception hierarchy)
> ? ? ? ?at org.antlr.runtime.tree.BaseTreeAdaptor.becomeRoot(BaseTreeAdaptor.java:150)
> ? ? ? ?at org.sonify.vm.hop.parser.HopParser.atom(HopParser.java:4954)
> //notice it is in the parser, not the tree grammar
> ? ? ? ?at org.sonify.vm.hop.parser.HopParser.combo_expression(HopParser.java:4403)
>
> To give an example of what would break in the language (not all rules
> shown), this would work fine:
>
> boolean array a
> a[0] = 10
> a[1] = a[0]
>
> and this would throw the above exception
>
> boolean array a
> a[0] = 10
> a[1] = (a[0])
>
> I've tried everything obvious (to me) that I can think of (e.g.,
> pulling out the rules one by one), but am perplexed as to why that
> rule throws a double root exception.
> I'm pretty sure the problem is relative to this portion of the
> grammar, but just in case, here is the full grammar:
>
> https://sourceforge.net/apps/trac/sodbeans/browser/trunk/sodbeans/Compiler/src/org/sonify/vm/hop/parser/Hop.g
> and the full tree grammar:
> https://sourceforge.net/apps/trac/sodbeans/browser/trunk/sodbeans/Compiler/src/org/sonify/vm/hop/parser/HopSymbolTableWalker.g
>
> When I run the code in the ANTLRWorks interpreter, it generates the
> trees just fine. One final clue is that my tree grammar is showing UP
> and DOWN tokens, which I know means there is a mismatch somewhere ---
> where, however, and how to fix, I'm not quite sure about, and this
> error seems to be coming from the parser anyway, so I don't "suspect"
> that that is the cause for this immediate problem.
>
> Any help would be greatly appreciated, as the error is driving me a bit crazy,
>
> Stefik
>

From mattpalms at gmail.com  Sat Jul  3 07:02:46 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Sat, 3 Jul 2010 15:02:46 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>
References: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>
Message-ID: <AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com>

Thanks for the tip, unfortunately it didn't help.  I only had one rule with
k>1, which I commented out, and still got the debugger time-out.

I can see I'm going to have to try to narrow down on the differences between
the grammars which debug and those that don't...

Incidentally, I've had this issue before on earlier versions of antlrworks
and ubuntu too.

Regards,

Matt.

On 2 July 2010 14:45, Mikesell, Darin B. <Darin.Mikesell at gd-ais.com> wrote:

> I've gotten this time-out error in the past also.  It usually occurs when
> I'm using a look-ahead of k=2, if I change the look-ahead to k=1 and then
> recompile, it will sometimes spit out an error that leads me to a fix.  I
> can then fix the error, set look-ahead back to k=2, and then I'm able to
> debug.
>
>
> - Darin
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] On Behalf Of Matt Palmer
> Sent: Friday, July 02, 2010 5:21 AM
> To: Jane Eisenstein
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] unable to run or debug grammar in antlrworks
> 1.4 on Windows XP
>
> I have exactly the same issues, but running on Ubuntu 10.04, so it's not a
> windows issue.  Strangely, some grammars the debugger runs, and others it
> simply times out.  I haven't figured out what is going on yet.
>
>
> On 10 May 2010 21:38, Jane Eisenstein <Jane.Eisenstein at medecision.com
> >wrote:
>
> > I've been using the Snow Leopard version of antlrworks to develop and run
> a
> > simple grammar. At work, I only have Windows XP and am running into
> problems
> > trying to run/debug the grammar with the MS Windows version of
> antlrworks.
> > I'm using sun's jdk1.6.0_17.
> >
> > Selecting Run/Run... results in this console message: TODO: run and send
> > output to this console
> > Is this command not supported under MS Windows?
> >
> > Also, trying to debug results in an alert stating:
> > Cannot launch the debugger Tab. Time-out waiting to connect to the remote
> > parser.
> > Running netstat -aon | find /i "49100" returns no results
> >
> > Is there something I can do to correct these problems?
> >
> >
> >
> >
> >
> --------------------------------------------------------------------------------------
> > The information transmitted is intended only for the person or entity to
> > which it is addressed and may contain confidential and/or privileged
> > material. Any review, retransmission, dissemination or other use of, or
> > taking of any action in reliance upon, this information by persons or
> > entities other than the intended recipient is prohibited. If you received
> > this message in error, please contact the sender and delete the material
> > from any computer.
> >
> >
> --------------------------------------------------------------------------------------
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From noagbodjivictor at gmail.com  Sat Jul  3 10:50:47 2010
From: noagbodjivictor at gmail.com (victor)
Date: Sat, 3 Jul 2010 13:50:47 -0400
Subject: [antlr-interest] confused about AST
Message-ID: <AANLkTimV0Rw4dXJDXCkDZI-tFh5w46F_4JPkjrZGZi85@mail.gmail.com>

hello list,

I am currently reading Language Implementation Patterns and I'm quite
confused by ASTs in chapter 4 and 5. This is what's happening.

Chapter 4 talked about Parse Trees and ASTs. Parse Trees were constructed by
adding tree-construction statements to parsing rules. But ASTs were
constructed manually.

So when I got to chapter 5 and I wanted to implement a visitor for my tree I
got stuck. I'm sorry I can't use the examples; I had to translate every
example to Python, the language I use.

I don't really know how and most importantly when to construct the AST. The
book does not say it precisely. I'm thinking if it's done during parsing,
isn't it really a Parse Tree?

Thanks

-- 
victor

From nvivo.misc at gmail.com  Sat Jul  3 10:53:37 2010
From: nvivo.misc at gmail.com (Natan)
Date: Sat, 03 Jul 2010 14:53:37 -0300
Subject: [antlr-interest] [stringtemplate-interest] Latest C#
	Binaries/Source
In-Reply-To: <AANLkTilFeEgSEyd3m19wi55z9JC2xfyqazzqOuzrcY2z@mail.gmail.com>
References: <AANLkTik34mvs6fER0q0uCHZxQIS7tMtB1o01RuukW8yF@mail.gmail.com>
	<019401cafc21$0749d540$15dd7fc0$@pixelminegames.com>	<AANLkTindtFz2YQR1235NcsxJFjiPdgEU2NYzDdGq55uL@mail.gmail.com>
	<00d601cb12df$4b1fbfd0$e15f3f70$@pixelminegames.com>	<4C2EA592.3070903@gmail.com>
	<AANLkTilFeEgSEyd3m19wi55z9JC2xfyqazzqOuzrcY2z@mail.gmail.com>
Message-ID: <4C2F7921.4080406@gmail.com>

  I was sleeping when I posted this yesterday, now that I'm awake I 
noticed what I did... I was actually talking about ANTLR, not 
StringTemplate, and got the mailing lists confused. =) But I guess the 
question and the version matches for both projects .

Although both projects are open source, it is hard to follow the 
development and help due to lack of access to the trunk sources, we need 
to wait until people with access zip it and post to a mailing list. I 
have never worked with perforce... I know the client is available 
freely, but I don't see any instruction on how to connect to the server. 
The access through the browser repository is hardly adequate to follow 
the development, and the link to CBS is broken for a long time.

I know the developers prefer perforce for some reason (although there 
are services today that provide really good tools, like github or 
assembla), but couldn't we have a git or subversion repository in sync 
to allow the users to follow the development? This would help us with 
the testing and probably make things more dynamic for developers as well.

Thanks,
Natan Vivo

On 3/7/2010 00:20, Dustin A. Lambert wrote:
> I've been using the latest version Sam posted and have found it to be 
> much more stable than the 3.1 version.
>
> I do agree that it needs to be more accessible though.  I did find 
> some bugs under Mono that I never have had time to resolve...
>
> Dustin Lambert
>
> On Fri, Jul 2, 2010 at 10:50 PM, Natan <nvivo.misc at gmail.com 
> <mailto:nvivo.misc at gmail.com>> wrote:
>
>     Sam,
>
>     Since you were talking about that, I was wondering, how is the
>     development of the 3.2 C# port going? Is it still active?
>
>     I think that if you made the snapshots available in the main
>     download page (like the C port has), probably more people would be
>     testing.
>
>     I remember I tried to use it when you posted, but it was too
>     unstable and wouldn't even create compilable code, and since I was
>     working on something I had to put in production, I decided to just
>     go back to the previous version and get the work done...
>
>     I plan to get back to develop some tools with antlr, and would be
>     nice to try it again if a new version is available.
>
>     Thanks.
>


From g.r.vansickle at att.net  Sat Jul  3 11:41:10 2010
From: g.r.vansickle at att.net (Gary R. Van Sickle)
Date: Sat, 3 Jul 2010 13:41:10 -0500
Subject: [antlr-interest] confused about AST
In-Reply-To: <AANLkTimV0Rw4dXJDXCkDZI-tFh5w46F_4JPkjrZGZi85@mail.gmail.com>
References: <AANLkTimV0Rw4dXJDXCkDZI-tFh5w46F_4JPkjrZGZi85@mail.gmail.com>
Message-ID: <C88005B0B3D34A3EB076A8B965E608AF@Mothership>

From: "victor" <noagbodjivictor at gmail.com>
Sent: Saturday, July 03, 2010 12:50 PM
To: <antlr-interest at antlr.org>
Subject: [antlr-interest] confused about AST

[snip]
> I don't really know how and most importantly when to construct the AST. 
> The
> book does not say it precisely. I'm thinking if it's done during parsing,
> isn't it really a Parse Tree?
>

No, the difference between a Parse Tree and an AST isn't the stage at which 
it's generated.  Both would be generated at the same point in the process, 
i.e. during the parse.

If you have Parr's "The Definitive ANTLR reference", see page 59, which 
should clarify the difference between the two types of trees.  In short, a 
Parse Tree is simply the tree of the rules and terminals which were 
navigated during the processing of the input text.  An AST is basically a 
Parse Tree with the intermediate rules removed[1].

E.g., part of a parse tree that's parsing the number "5" in a C parser might 
look like this:

....->relational_expression->shift_expression->additive_expression->multiplicative_expression->cast_expression->unary_expression->postfix_expression->primary_expression->constant->DECIMAL_LITERAL->5

While the AST for the same thing would just be:

->5

Short form again, you can see that you are generally going to want to deal 
with an AST vs. a Parse Tree.

> Thanks
>
> -- 
> victor

-- 
Gary R. Van Sickle
[1] I'll let the language lawyers give you a more correct explanation, but 
that's the basic idea.

 


From acondit at ipns.com  Sat Jul  3 12:52:11 2010
From: acondit at ipns.com (Alan Condit)
Date: Sat, 3 Jul 2010 12:52:11 -0700
Subject: [antlr-interest] StringTemplate attribute problem in Target
	Language generator
Message-ID: <6F3E7129-275F-4AEC-A461-7C487A70D5D4@ipns.com>

Hi,

I am trying to get type and name attributes to work for return values specified in a rule. For example,
if someone specifies the following rule:
kfloat returns [ double value ]
	| KFLOAT
	;

In the target language generator I need to be able to generate:
\@property (assign, getter=get<it.name>, setter=set<it.name>\:) <it.type> <it.name>;
where <it.type> is "double" and <it.name> is "value" (of course without the quotes)

Currently all I have figured out how to get is:
double value;
using:
<ruleDescriptor.returnScope.attribute:{ <it.dec>; }; separator="\n">

I also need to use the same items to generate the getter and setter methods like:
@synthesize value;
- (double)getValue
{
    return( value );
}

- (void)setValue:(double)aVal
{
    value = aVal;
}

So I have been trying something like this:
<scope.attributes:{\@synthesize <it.name>;}; separator="\n">

<scope.attributes.decl:{<"\n">- (<it.type>)get<it.name><"\n">{<"\n">    return( <it.name> );<"\n">}<"\n\n">
- (void)set<it.name>:(<it.type>)aVal<"\n">{<"\n">    <it.name> = aVal;<"\n">}<"\n\n">}; separator="\n">

Or this:
<scope.attributes.decl:{
- (<it.type>)get<it.name>
{
    return( <it.name> );
}

- (void)set<it.name>\:(<it.type>)aVal
{
    <it.name> = aVal;
}

}; separator="\n">

Any help would be greatly appreciated. I am just learning StringTemplate and it may be something simple
biting me in the butt.

Thanks again,
Alan
---

Alan Condit
1085 Tierra Ct.
Woodburn, OR 97071

Email -- acondit at ipns.com
Home-Office (503) 982-0906


From mattpalms at gmail.com  Sat Jul  3 13:58:29 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Sat, 3 Jul 2010 21:58:29 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com>
References: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com>
Message-ID: <AANLkTilOfZnUkp3wUDJ51bvuWsMI6JXbKBR9Bom-QYcI@mail.gmail.com>

Well, this gets wierder, and to my mind seems to point to a bug in
Antlrworks itself.

I verified that I could consistently run the debugger using one simple
grammar, but not another.  On the non-working grammar, I commented out rules
and tokens (starting from the most complex), until, lo-and-behold, after one
rule went the debugger started working.  I then re-enabled all the other
rules one by one, and the grammar kept working.  The lexer rule that wasn't
working was  a literal followed by a fragment, looking like this:

BITMASK :   '&' HEX_BYTE ;

I then re-enabled this rule... and the debugger kept working.  The only
difference at this point between where I started with a non-working debugger
and where I finished with a working debugger is I moved a couple of rules to
the end (comments and whitespace both going to hidden channels) to simplify
commenting them out.

I've faced this problem before, I still have no idea what causes it and how
to fix it.  Maybe this will make sense to someone.

Matt.

On 3 July 2010 15:02, Matt Palmer <mattpalms at gmail.com> wrote:

> Thanks for the tip, unfortunately it didn't help.  I only had one rule with
> k>1, which I commented out, and still got the debugger time-out.
>
> I can see I'm going to have to try to narrow down on the differences
> between the grammars which debug and those that don't...
>
> Incidentally, I've had this issue before on earlier versions of antlrworks
> and ubuntu too.
>
> Regards,
>
> Matt.
>
>
> On 2 July 2010 14:45, Mikesell, Darin B. <Darin.Mikesell at gd-ais.com>wrote:
>
>> I've gotten this time-out error in the past also.  It usually occurs when
>> I'm using a look-ahead of k=2, if I change the look-ahead to k=1 and then
>> recompile, it will sometimes spit out an error that leads me to a fix.  I
>> can then fix the error, set look-ahead back to k=2, and then I'm able to
>> debug.
>>
>>
>> - Darin
>>
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:
>> antlr-interest-bounces at antlr.org] On Behalf Of Matt Palmer
>> Sent: Friday, July 02, 2010 5:21 AM
>> To: Jane Eisenstein
>> Cc: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] unable to run or debug grammar in antlrworks
>> 1.4 on Windows XP
>>
>> I have exactly the same issues, but running on Ubuntu 10.04, so it's not a
>> windows issue.  Strangely, some grammars the debugger runs, and others it
>> simply times out.  I haven't figured out what is going on yet.
>>
>>
>> On 10 May 2010 21:38, Jane Eisenstein <Jane.Eisenstein at medecision.com
>> >wrote:
>>
>> > I've been using the Snow Leopard version of antlrworks to develop and
>> run a
>> > simple grammar. At work, I only have Windows XP and am running into
>> problems
>> > trying to run/debug the grammar with the MS Windows version of
>> antlrworks.
>> > I'm using sun's jdk1.6.0_17.
>> >
>> > Selecting Run/Run... results in this console message: TODO: run and send
>> > output to this console
>> > Is this command not supported under MS Windows?
>> >
>> > Also, trying to debug results in an alert stating:
>> > Cannot launch the debugger Tab. Time-out waiting to connect to the
>> remote
>> > parser.
>> > Running netstat -aon | find /i "49100" returns no results
>> >
>> > Is there something I can do to correct these problems?
>> >
>> >
>> >
>> >
>> >
>> --------------------------------------------------------------------------------------
>> > The information transmitted is intended only for the person or entity to
>> > which it is addressed and may contain confidential and/or privileged
>> > material. Any review, retransmission, dissemination or other use of, or
>> > taking of any action in reliance upon, this information by persons or
>> > entities other than the intended recipient is prohibited. If you
>> received
>> > this message in error, please contact the sender and delete the material
>> > from any computer.
>> >
>> >
>> --------------------------------------------------------------------------------------
>> >
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
>> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> >
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>

From wclodius at los-alamos.net  Sat Jul  3 14:05:40 2010
From: wclodius at los-alamos.net (William Clodius)
Date: Sat, 3 Jul 2010 15:05:40 -0600
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <AANLkTilOfZnUkp3wUDJ51bvuWsMI6JXbKBR9Bom-QYcI@mail.gmail.com>
References: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com>
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com>
	<AANLkTilOfZnUkp3wUDJ51bvuWsMI6JXbKBR9Bom-QYcI@mail.gmail.com>
Message-ID: <12FB6EB7-4D59-4537-8073-810CBD47E3C4@los-alamos.net>


On Jul 3, 2010, at 2:58 PM, Matt Palmer wrote:

> Well, this gets wierder, and to my mind seems to point to a bug in
> Antlrworks itself.
> 
> I verified that I could consistently run the debugger using one simple
> grammar, but not another.  On the non-working grammar, I commented out rules
> and tokens (starting from the most complex), until, lo-and-behold, after one
> rule went the debugger started working.  I then re-enabled all the other
> rules one by one, and the grammar kept working.  The lexer rule that wasn't
> working was  a literal followed by a fragment, looking like this:
> 
> BITMASK :   '&' HEX_BYTE ;
> 
> I then re-enabled this rule... and the debugger kept working.  The only
> difference at this point between where I started with a non-working debugger
> and where I finished with a working debugger is I moved a couple of rules to
> the end (comments and whitespace both going to hidden channels) to simplify
> commenting them out.
> 
> I've faced this problem before, I still have no idea what causes it and how
> to fix it.  Maybe this will make sense to someone.
> 
> Matt.
<snip>

Normally I would expect bitmask to be a syntactic element not a lexical element. If so then change all occurrences of BITMASK to bitmask. Otherwise have youm marked HEX_BYTE as a fragment?

From mattpalms at gmail.com  Sat Jul  3 14:11:29 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Sat, 3 Jul 2010 22:11:29 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <12FB6EB7-4D59-4537-8073-810CBD47E3C4@los-alamos.net>
References: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com> 
	<AANLkTilOfZnUkp3wUDJ51bvuWsMI6JXbKBR9Bom-QYcI@mail.gmail.com> 
	<12FB6EB7-4D59-4537-8073-810CBD47E3C4@los-alamos.net>
Message-ID: <AANLkTimLMkfMFy6pBzFrZrb-QsOibAZK7njAATT14_JG@mail.gmail.com>

Hi William,

well, in terms of grammar design, you're probably right that bitmask should
probably be a rule rather than a lexer token.  HEX_BYTE is a fragment, used
by other lexer tokens too.

However, the real issue for me is that the debugger sometimes works, and
sometimes doesn't,for the same grammar.  My only fix at this point is
commenting things out and back in until it starts mysteriously working!

cheers,

Matt

On 3 July 2010 22:05, William Clodius <wclodius at los-alamos.net> wrote:

>
> On Jul 3, 2010, at 2:58 PM, Matt Palmer wrote:
>
> > Well, this gets wierder, and to my mind seems to point to a bug in
> > Antlrworks itself.
> >
> > I verified that I could consistently run the debugger using one simple
> > grammar, but not another.  On the non-working grammar, I commented out
> rules
> > and tokens (starting from the most complex), until, lo-and-behold, after
> one
> > rule went the debugger started working.  I then re-enabled all the other
> > rules one by one, and the grammar kept working.  The lexer rule that
> wasn't
> > working was  a literal followed by a fragment, looking like this:
> >
> > BITMASK :   '&' HEX_BYTE ;
> >
> > I then re-enabled this rule... and the debugger kept working.  The only
> > difference at this point between where I started with a non-working
> debugger
> > and where I finished with a working debugger is I moved a couple of rules
> to
> > the end (comments and whitespace both going to hidden channels) to
> simplify
> > commenting them out.
> >
> > I've faced this problem before, I still have no idea what causes it and
> how
> > to fix it.  Maybe this will make sense to someone.
> >
> > Matt.
> <snip>
>
> Normally I would expect bitmask to be a syntactic element not a lexical
> element. If so then change all occurrences of BITMASK to bitmask. Otherwise
> have youm marked HEX_BYTE as a fragment?
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From mattpalms at gmail.com  Sat Jul  3 14:14:40 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Sat, 3 Jul 2010 22:14:40 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <AANLkTimLMkfMFy6pBzFrZrb-QsOibAZK7njAATT14_JG@mail.gmail.com>
References: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com> 
	<AANLkTilOfZnUkp3wUDJ51bvuWsMI6JXbKBR9Bom-QYcI@mail.gmail.com> 
	<12FB6EB7-4D59-4537-8073-810CBD47E3C4@los-alamos.net>
	<AANLkTimLMkfMFy6pBzFrZrb-QsOibAZK7njAATT14_JG@mail.gmail.com>
Message-ID: <AANLkTik_Ewd2xgqqFheQv633l4vJOYpPpRgpnot-nltF@mail.gmail.com>

I should add, in case the way I phrased the problem is causing any
confusion: The grammar itself is fine (well - it works - it may not be very
elegant!).  Code can be generated.  I have no warnings or errors.  The
problem is whether the debugger in antlrworks will choose to start up, or
time out.

Matt.

On 3 July 2010 22:11, Matt Palmer <mattpalms at gmail.com> wrote:

> Hi William,
>
> well, in terms of grammar design, you're probably right that bitmask should
> probably be a rule rather than a lexer token.  HEX_BYTE is a fragment, used
> by other lexer tokens too.
>
> However, the real issue for me is that the debugger sometimes works, and
> sometimes doesn't,for the same grammar.  My only fix at this point is
> commenting things out and back in until it starts mysteriously working!
>
> cheers,
>
> Matt
>
>
> On 3 July 2010 22:05, William Clodius <wclodius at los-alamos.net> wrote:
>
>>
>> On Jul 3, 2010, at 2:58 PM, Matt Palmer wrote:
>>
>> > Well, this gets wierder, and to my mind seems to point to a bug in
>> > Antlrworks itself.
>> >
>> > I verified that I could consistently run the debugger using one simple
>> > grammar, but not another.  On the non-working grammar, I commented out
>> rules
>> > and tokens (starting from the most complex), until, lo-and-behold, after
>> one
>> > rule went the debugger started working.  I then re-enabled all the other
>> > rules one by one, and the grammar kept working.  The lexer rule that
>> wasn't
>> > working was  a literal followed by a fragment, looking like this:
>> >
>> > BITMASK :   '&' HEX_BYTE ;
>> >
>> > I then re-enabled this rule... and the debugger kept working.  The only
>> > difference at this point between where I started with a non-working
>> debugger
>> > and where I finished with a working debugger is I moved a couple of
>> rules to
>> > the end (comments and whitespace both going to hidden channels) to
>> simplify
>> > commenting them out.
>> >
>> > I've faced this problem before, I still have no idea what causes it and
>> how
>> > to fix it.  Maybe this will make sense to someone.
>> >
>> > Matt.
>> <snip>
>>
>> Normally I would expect bitmask to be a syntactic element not a lexical
>> element. If so then change all occurrences of BITMASK to bitmask. Otherwise
>> have youm marked HEX_BYTE as a fragment?
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>

From parrt at cs.usfca.edu  Sun Jul  4 13:17:01 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 4 Jul 2010 13:17:01 -0700
Subject: [antlr-interest] StringTemplate attribute problem in Target
	Language generator
In-Reply-To: <6F3E7129-275F-4AEC-A461-7C487A70D5D4@ipns.com>
References: <6F3E7129-275F-4AEC-A461-7C487A70D5D4@ipns.com>
Message-ID: <CADD793A-220F-47CB-88E8-113B06C25C9F@cs.usfca.edu>

what is the invalid output? can't help until we know what's wrong.
Ter
On Jul 3, 2010, at 12:52 PM, Alan Condit wrote:

> Hi,
>
> I am trying to get type and name attributes to work for return  
> values specified in a rule. For example,
> if someone specifies the following rule:
> kfloat returns [ double value ]
> 	| KFLOAT
> 	;
>
> In the target language generator I need to be able to generate:
> \@property (assign, getter=get<it.name>, setter=set<it.name>\:)  
> <it.type> <it.name>;
> where <it.type> is "double" and <it.name> is "value" (of course  
> without the quotes)
>
> Currently all I have figured out how to get is:
> double value;
> using:
> <ruleDescriptor.returnScope.attribute:{ <it.dec>; }; separator="\n">
>
> I also need to use the same items to generate the getter and setter  
> methods like:
> @synthesize value;
> - (double)getValue
> {
>    return( value );
> }
>
> - (void)setValue:(double)aVal
> {
>    value = aVal;
> }
>
> So I have been trying something like this:
> <scope.attributes:{\@synthesize <it.name>;}; separator="\n">
>
> <scope.attributes.decl:{<"\n">-  
> (<it.type>)get<it.name><"\n">{<"\n">     
> return( <it.name> );<"\n">}<"\n\n">
> - (void)set<it.name>:(<it.type>)aVal<"\n">{<"\n">    <it.name> =  
> aVal;<"\n">}<"\n\n">}; separator="\n">
>
> Or this:
> <scope.attributes.decl:{
> - (<it.type>)get<it.name>
> {
>    return( <it.name> );
> }
>
> - (void)set<it.name>\:(<it.type>)aVal
> {
>    <it.name> = aVal;
> }
>
> }; separator="\n">
>
> Any help would be greatly appreciated. I am just learning  
> StringTemplate and it may be something simple
> biting me in the butt.
>
> Thanks again,
> Alan
> ---
>
> Alan Condit
> 1085 Tierra Ct.
> Woodburn, OR 97071
>
> Email -- acondit at ipns.com
> Home-Office (503) 982-0906
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From aph at redhat.com  Mon Jul  5 03:06:16 2010
From: aph at redhat.com (Andrew Haley)
Date: Mon, 05 Jul 2010 11:06:16 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
 1.4 on Windows XP
In-Reply-To: <AANLkTik_Ewd2xgqqFheQv633l4vJOYpPpRgpnot-nltF@mail.gmail.com>
References: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com>
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>	<AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com>
	<AANLkTilOfZnUkp3wUDJ51bvuWsMI6JXbKBR9Bom-QYcI@mail.gmail.com>
	<12FB6EB7-4D59-4537-8073-810CBD47E3C4@los-alamos.net>	<AANLkTimLMkfMFy6pBzFrZrb-QsOibAZK7njAATT14_JG@mail.gmail.com>
	<AANLkTik_Ewd2xgqqFheQv633l4vJOYpPpRgpnot-nltF@mail.gmail.com>
Message-ID: <4C31AE98.7040508@redhat.com>

On 07/03/2010 10:14 PM, Matt Palmer wrote:
> I should add, in case the way I phrased the problem is causing any
> confusion: The grammar itself is fine (well - it works - it may not be very
> elegant!).  Code can be generated.  I have no warnings or errors.  The
> problem is whether the debugger in antlrworks will choose to start up, or
> time out.

I had this problem too.  The only way seemed to be to edit the source code
of ANTLR to fix the timeout.

--- antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java~   2009-09-23 19:36:06.000000000 +0100
+++ antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java    2010-01-21 13:08:32.625782840 +0000
@@ -53,7 +53,7 @@
         */
 
        /** Set to 0 to not terminate early (time in ms) */
-       public static int MAX_TIME_PER_DFA_CREATION = 1*1000;
+       public static int MAX_TIME_PER_DFA_CREATION = 10*1000;
 
        /** How many edges can each DFA state have before a "special" state
         *  is created that uses IF expressions instead of a table?

The core problem was that antlrworks didn't allow this timeout to be
tweaked.

Andrew.

From a.moderacja at gmail.com  Mon Jul  5 05:04:50 2010
From: a.moderacja at gmail.com (Borneq)
Date: Mon, 5 Jul 2010 14:04:50 +0200
Subject: [antlr-interest] How compile my first parser?
Message-ID: <AANLkTinhxZtJQcWHcymF3199d-8TMNlmh-Oye4ZOD6U8@mail.gmail.com>

I compile grammar from book "The Definitive ANTLR Reference" of Parr:
grammar T;
/** Match things like "call foo;" */
r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
ID: 'a'..'z' + ;
WS: (' ' |'\n' |'\r' )+ {$channel=HIDDEN;} ; // ignore whitespace

Grammal compiles OK, program antlrworks-1.4.jar creates TLexer.java
and TParser.java. I create Test.java :

 import org.antlr.runtime.* ;

 public class Test      {
   public static void main(String[] args)   throws Exception{
       //create a CharStream that reads from standard input
	   ANTLRInputStream input = new ANTLRInputStream(System.in);
       //create a lexer that feeds off of input CharStream
       TLexer lexer = new TLexer(input);
       //create a buffer of tokens pulled from the lexer
       CommonTokenStream tokens = new CommonTokenStream(lexer);
       // create a parser that feeds off the tokens buffer
       TParser parser = new TParser(tokens);
       //  begin   parsing   at  rule  r
       parser.r();
  }
}

In Eclipse I import antlr-3.2.jar where is ANTLRInputStream.class, but
Eclipse not found it and underline it.
How compile Test.java with Eclipse?

From noagbodjivictor at gmail.com  Mon Jul  5 06:25:49 2010
From: noagbodjivictor at gmail.com (victor)
Date: Mon, 5 Jul 2010 09:25:49 -0400
Subject: [antlr-interest] AST construction
Message-ID: <AANLkTikyTYGAVBKySlJvwHQKtvIyZtIjLopFEwQCTaLX@mail.gmail.com>

hello list,

i am having trouble constructing my ASTs. i learned how to construct a parse
tree from the book Language Implementation Patterns. in pseudo code, it
looks like this:

func rule:
  node = RuleNode('rule_name')
  if root is null: root = node
  else: current_node.add_child(node)
  save = current_node
  current_node = r  # descend
  # now rule code
  # goes here
  current_node = save # restore

(TokenNodes are created in the match function of the parser) the previous
works fine for constructing a parse tree. but i'm having trouble with an
AST. consider for example the AddNode with the prototype:

AddNode(right_expr, plus, left_expr)

i can't really follow the template above here. the contructor requires
right_expr and the left_expr, which i only get after parsing. i was
wondering how it is usually done in this case.

thanks a lot in advance :)

-- 
victor

From mattpalms at gmail.com  Mon Jul  5 06:35:04 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Mon, 5 Jul 2010 14:35:04 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <4C31AE98.7040508@redhat.com>
References: <D4E264EF9655CF42A7186E4757C7E9292D5721962E@CWPPR-E2K7MBX-1.medecision.com>
	<AANLkTik9rWCT0BEXqkgZvGEVMby2rhNRCiwEpsbrdr_s@mail.gmail.com> 
	<DBCB698FB6D4B643BF64C7B5025E37FBDC36D97DC6@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTikMImVKaekhnaN3u6j-P-e-zmHlQ3Tg0M_Nr0Qy@mail.gmail.com> 
	<AANLkTilOfZnUkp3wUDJ51bvuWsMI6JXbKBR9Bom-QYcI@mail.gmail.com> 
	<12FB6EB7-4D59-4537-8073-810CBD47E3C4@los-alamos.net>
	<AANLkTimLMkfMFy6pBzFrZrb-QsOibAZK7njAATT14_JG@mail.gmail.com> 
	<AANLkTik_Ewd2xgqqFheQv633l4vJOYpPpRgpnot-nltF@mail.gmail.com> 
	<4C31AE98.7040508@redhat.com>
Message-ID: <AANLkTilyYV4xp9FZvHT5u5HlDWwy-niLblFmt02i5SF0@mail.gmail.com>

Very interesting - thanks.  I suppose this could explain why moving some
rules / tokens around fixes the time-out sometimes, as the order it builds
the DFA in will change, and thus how long certain things take to generate.

Matt.

On 5 July 2010 11:06, Andrew Haley <aph at redhat.com> wrote:

> On 07/03/2010 10:14 PM, Matt Palmer wrote:
> > I should add, in case the way I phrased the problem is causing any
> > confusion: The grammar itself is fine (well - it works - it may not be
> very
> > elegant!).  Code can be generated.  I have no warnings or errors.  The
> > problem is whether the debugger in antlrworks will choose to start up, or
> > time out.
>
> I had this problem too.  The only way seemed to be to edit the source code
> of ANTLR to fix the timeout.
>
> --- antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java~   2009-09-23
> 19:36:06.000000000 +0100
> +++ antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java    2010-01-21
> 13:08:32.625782840 +0000
> @@ -53,7 +53,7 @@
>         */
>
>        /** Set to 0 to not terminate early (time in ms) */
> -       public static int MAX_TIME_PER_DFA_CREATION = 1*1000;
> +       public static int MAX_TIME_PER_DFA_CREATION = 10*1000;
>
>        /** How many edges can each DFA state have before a "special" state
>         *  is created that uses IF expressions instead of a table?
>
> The core problem was that antlrworks didn't allow this timeout to be
> tweaked.
>
> Andrew.
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jimi at temporal-wave.com  Mon Jul  5 13:47:20 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 05 Jul 2010 13:47:20 -0700
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <4C31AE98.7040508@redhat.com>
Message-ID: <e0520712fdca43488d3ebf12cbaef4c7@temporal-wave.com>

You just need to add -Xconversiontimeout 10000 in the antlrworks preferences. However if your lexer generation is timing out, then examine it closely and see if you can't left factor things better.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Andrew Haley
> Sent: Monday, July 05, 2010 3:06 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] unable to run or debug grammar in
> antlrworks 1.4 on Windows XP
> 
> On 07/03/2010 10:14 PM, Matt Palmer wrote:
> > I should add, in case the way I phrased the problem is causing any
> > confusion: The grammar itself is fine (well - it works - it may not
> be very
> > elegant!).  Code can be generated.  I have no warnings or errors.
> The
> > problem is whether the debugger in antlrworks will choose to start
> up, or
> > time out.
> 
> I had this problem too.  The only way seemed to be to edit the source
> code
> of ANTLR to fix the timeout.
> 
> --- antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java~   2009-
> 09-23 19:36:06.000000000 +0100
> +++ antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java    2010-
> 01-21 13:08:32.625782840 +0000
> @@ -53,7 +53,7 @@
>          */
> 
>         /** Set to 0 to not terminate early (time in ms) */
> -       public static int MAX_TIME_PER_DFA_CREATION = 1*1000;
> +       public static int MAX_TIME_PER_DFA_CREATION = 10*1000;
> 
>         /** How many edges can each DFA state have before a "special"
> state
>          *  is created that uses IF expressions instead of a table?
> 
> The core problem was that antlrworks didn't allow this timeout to be
> tweaked.
> 
> Andrew.
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From andrewrwr at gmail.com  Mon Jul  5 21:18:50 2010
From: andrewrwr at gmail.com (Andrew Robinson)
Date: Mon, 5 Jul 2010 22:18:50 -0600
Subject: [antlr-interest] Antlr first time user, help requested
Message-ID: <AANLkTim3aOmgrOnmcyWMrLfPL-ihdsiwNAAzCEUd4ZJ9@mail.gmail.com>

Sorry to say that ANTLR is driving me nuts, starting to really hate
the tool, so I'd really appreciate some help on it before I give up on
it.

I am trying to parse a simple bit of text that looks something like this:

PageMetaData:
name: This is a test name
categories: category1, category2,
??category3
notes: These are notes
??that the newlines are important, but not the leading whitespace

So the idea is the script always?starts with "PageMetaData:\n"
The name section should ignore leading whitespace after the color, and
take in any text to the end of the line, including white space
The categories section is a comma separated set of camel-cased words
that can be one one or more lines. Subsequent lines should lead with
one or more spaces
The notes section should allow multiple lines as long as they all
start with leading white space.
This is going to get a bit more complex, but you get the idea.

My grammar file is at the bottom of this email (not sure if this ML
supports attachments). It fails miserably (keep running into
mismatched token exceptions on the testName matching). Here is my
input text:
PageMetaData:
name: This is a test name
categories: category1, category2,
??category3
notes: These are notes
??that the newlines are important, but not the leading whitespace

So after trying many different variations I tried a very simple
grammar to step back to basics (or so I thought). Grammar:
grammar Test;

prog
: 'name:' NONBREAK NEWLINE? EOF!;

NONBREAK
: (~('\n'|'\r'))+ ;

NEWLINE:'\r'? '\n' ;

Input (quotes included to show that there is a new line):
"name: test
"

In the 1.4 ANTLRWorks Intrepreter I get a
MismatchedTokenException(4!=6) with this setup. What the heck this is
pretty basic?

I am also seeing problems with the windows EOL matching but not the
unix matching in ANTLWorks when I add a newline (using that above
newline token), but I am on Ubuntu Linux, not sure what is going on
there.
Would really appreciate some hints here.
Thank you



Grammar file from above:
grammar PageMetaData;

options {
  output = AST;
}

tokens {
	HEADER_TEXT = 'PageMetaData:' ;
	NAME_LABEL = 'name:' ;
	CATEGORIES_LABEL = 'categories:' ;
	TAGS_LABEL = 'tags:' ;
  NOTE_LABEL = 'note:' ;
  AUTOMATED_TESTS_LABEL = 'automated-tests:' ;
  AUTOMATED_TEST_LABEL = 'automated-test:' ;
  COMMENT;
  CAMELCASE;
  FILE;
  COMMA;
  TEXT;
}

COMMENT
  :	'//' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
  ;

NEWLINE	: ('\r' '\n' | '\n' | '\r' );

CAMELCASE
	:	('A'..'Z'|'a'..'z'|'0'..'9')+;

FILE
	:	('A'..'Z'|'a'..'z'|'0'..'9'| '_' | '-' | '.' | '/')+;

COMMA
	:	',' (' '+ | NEWLINE ' '+)?;

TEXT : (~('\r'|'\n')+);

definition
	: (NEWLINE | ' ')* header NEWLINE
  testName NEWLINE
  categories NEWLINE
  (tags NEWLINE)?
  (note NEWLINE)?
  (automatedTests NEWLINE)?
  (automatedTest NEWLINE)?
  EOF! ;
	
header
	: HEADER_TEXT
	;

testName : NAME_LABEL TEXT;

categories
	: CATEGORIES_LABEL CAMELCASE (COMMA CAMELCASE)* ;

tags
	:	'tags:' (' '*)! CAMELCASE (COMMA CAMELCASE)* ;

note
	: 	'note:' (' '*)! TEXT (NEWLINE+ TEXT)* ;

automatedTests
	:	'tests:' (' '*)! FILE (COMMA FILE)* ;

automatedTest
	:	'test:' (' '*)! TEXT ;

From mattpalms at gmail.com  Tue Jul  6 04:31:42 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Tue, 6 Jul 2010 12:31:42 +0100
Subject: [antlr-interest] unable to run or debug grammar in antlrworks
	1.4 on Windows XP
In-Reply-To: <e0520712fdca43488d3ebf12cbaef4c7@temporal-wave.com>
References: <4C31AE98.7040508@redhat.com>
	<e0520712fdca43488d3ebf12cbaef4c7@temporal-wave.com>
Message-ID: <AANLkTimsSf6RsJkKTR1aLB1FhvziJ2ibN_RTF5mxeR9y@mail.gmail.com>

Thanks for the tip.  However, what surprises me with the debugger issue I
have is that all my grammars are actually very simple.  As far as I can see,
there is basically no need for left factoring at all.

When I encounter another grammar for which the debugger times out, I'll have
a play with the timeout preferences you mention, and report back on whether
it helps or not (and maybe post a cut-down version exhibiting the problem).

Matt.


On 5 July 2010 21:47, Jim Idle <jimi at temporal-wave.com> wrote:

> You just need to add -Xconversiontimeout 10000 in the antlrworks
> preferences. However if your lexer generation is timing out, then examine it
> closely and see if you can't left factor things better.
>
> Jim
>
> > -----Original Message-----
> > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > bounces at antlr.org] On Behalf Of Andrew Haley
> > Sent: Monday, July 05, 2010 3:06 AM
> > To: antlr-interest at antlr.org
> > Subject: Re: [antlr-interest] unable to run or debug grammar in
> > antlrworks 1.4 on Windows XP
> >
> > On 07/03/2010 10:14 PM, Matt Palmer wrote:
> > > I should add, in case the way I phrased the problem is causing any
> > > confusion: The grammar itself is fine (well - it works - it may not
> > be very
> > > elegant!).  Code can be generated.  I have no warnings or errors.
> > The
> > > problem is whether the debugger in antlrworks will choose to start
> > up, or
> > > time out.
> >
> > I had this problem too.  The only way seemed to be to edit the source
> > code
> > of ANTLR to fix the timeout.
> >
> > --- antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java~   2009-
> > 09-23 19:36:06.000000000 +0100
> > +++ antlr-3.2/tool/src/main/java/org/antlr/analysis/DFA.java    2010-
> > 01-21 13:08:32.625782840 +0000
> > @@ -53,7 +53,7 @@
> >          */
> >
> >         /** Set to 0 to not terminate early (time in ms) */
> > -       public static int MAX_TIME_PER_DFA_CREATION = 1*1000;
> > +       public static int MAX_TIME_PER_DFA_CREATION = 10*1000;
> >
> >         /** How many edges can each DFA state have before a "special"
> > state
> >          *  is created that uses IF expressions instead of a table?
> >
> > The core problem was that antlrworks didn't allow this timeout to be
> > tweaked.
> >
> > Andrew.
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> > email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jbb at acm.org  Tue Jul  6 06:47:41 2010
From: jbb at acm.org (John B. Brodie)
Date: Tue, 06 Jul 2010 09:47:41 -0400
Subject: [antlr-interest] Antlr first time user, help requested
In-Reply-To: <AANLkTim3aOmgrOnmcyWMrLfPL-ihdsiwNAAzCEUd4ZJ9@mail.gmail.com>
References: <AANLkTim3aOmgrOnmcyWMrLfPL-ihdsiwNAAzCEUd4ZJ9@mail.gmail.com>
Message-ID: <1278424061.3743.21.camel@gecko.home.org>

Greetings!

On Mon, 2010-07-05 at 22:18 -0600, Andrew Robinson wrote:
> Sorry to say that ANTLR is driving me nuts, starting to really hate
> the tool, so I'd really appreciate some help on it before I give up on
> it.

Sorry for your frustration. I hope you hang in there. I think ANTLR is
worth its steep learning curve...

> 
> I am trying to parse a simple bit of text that looks something like this:
> 
> PageMetaData:
> name: This is a test name
> categories: category1, category2,
>   category3
> notes: These are notes
>   that the newlines are important, but not the leading whitespace
> 
> So the idea is the script always starts with "PageMetaData:\n"
> The name section should ignore leading whitespace after the color, and
> take in any text to the end of the line, including white space
> The categories section is a comma separated set of camel-cased words
> that can be one one or more lines. Subsequent lines should lead with
> one or more spaces
> The notes section should allow multiple lines as long as they all
> start with leading white space.
> This is going to get a bit more complex, but you get the idea.
> 
> My grammar file is at the bottom of this email (not sure if this ML
> supports attachments). 

It does seem to support attachmenets.

> It fails miserably (keep running into
> mismatched token exceptions on the testName matching). Here is my
> input text:
> PageMetaData:
> name: This is a test name
> categories: category1, category2,
>   category3
> notes: These are notes
>   that the newlines are important, but not the leading whitespace
> 
> So after trying many different variations I tried a very simple
> grammar to step back to basics (or so I thought). Grammar:
> grammar Test;
> 
> prog
> : 'name:' NONBREAK NEWLINE? EOF!;
> 
> NONBREAK
> : (~('\n'|'\r'))+ ;
> 
> NEWLINE:'\r'? '\n' ;
> 
> Input (quotes included to show that there is a new line):
> "name: test
> "
> 
> In the 1.4 ANTLRWorks Intrepreter I get a
> MismatchedTokenException(4!=6) with this setup. What the heck this is
> pretty basic?
> 

your NONBREAK lexer rule is gobbling up tooooo much.

recall that ANTLR lexers are greedy. lexer rules match the longest
viable input string without any regard to the parsing context.

so your NONBREAK token happily eats up the entire input line, including
the leading "name:" portion, so your parser never sees that token.
(I agree that the ANTLRWorks Interpreter's error message is less than
helpful here... )

> I am also seeing problems with the windows EOL matching but not the
> unix matching in ANTLWorks when I add a newline (using that above
> newline token), but I am on Ubuntu Linux, not sure what is going on
> there.

I do not use ANTLRWorks so can not help much with that. I too use Ubuntu
and I just use the command-line org.antlr.Tool (and of course emacs and
the antlr-mode).

> Would really appreciate some hints here.

Basically I think you should make your TEXT lexer rule below be a parser
rule ---- which requires an additional lexer rule also. so we would have
(all of this is pretty much un-tested...):

text : ~NEWLINE;

OTHER : . ;

be SURE that the OTHER lexer rule is the very LAST rule in the .g file.
change all references to TEXT to be text.

also, usually single line comments are given by:

// single-line comments
SL_COMMENT :
      '//'
      ( options { greedy=false; } : . )*
      ( '\r' | '\r\n' | '\n' ) // EOL untested under MS-Windows
      { $channel=HIDDEN; }
   ;

you might also need to make your COMMA rule a parser rule...

> Thank you
> 

Hope this helps
   -jbb

> 
> 
> Grammar file from above:
> grammar PageMetaData;
> 
> options {
>   output = AST;
> }
> 
> tokens {
> 	HEADER_TEXT = 'PageMetaData:' ;
> 	NAME_LABEL = 'name:' ;
> 	CATEGORIES_LABEL = 'categories:' ;
> 	TAGS_LABEL = 'tags:' ;
>   NOTE_LABEL = 'note:' ;
>   AUTOMATED_TESTS_LABEL = 'automated-tests:' ;
>   AUTOMATED_TEST_LABEL = 'automated-test:' ;
>   COMMENT;
>   CAMELCASE;
>   FILE;
>   COMMA;
>   TEXT;
> }
> 
> COMMENT
>   :	'//' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
>   ;
> 
> NEWLINE	: ('\r' '\n' | '\n' | '\r' );
> 
> CAMELCASE
> 	:	('A'..'Z'|'a'..'z'|'0'..'9')+;
> 
> FILE
> 	:	('A'..'Z'|'a'..'z'|'0'..'9'| '_' | '-' | '.' | '/')+;
> 
> COMMA
> 	:	',' (' '+ | NEWLINE ' '+)?;
> 
> TEXT : (~('\r'|'\n')+);
> 
> definition
> 	: (NEWLINE | ' ')* header NEWLINE
>   testName NEWLINE
>   categories NEWLINE
>   (tags NEWLINE)?
>   (note NEWLINE)?
>   (automatedTests NEWLINE)?
>   (automatedTest NEWLINE)?
>   EOF! ;
> 	
> header
> 	: HEADER_TEXT
> 	;
> 
> testName : NAME_LABEL TEXT;
> 
> categories
> 	: CATEGORIES_LABEL CAMELCASE (COMMA CAMELCASE)* ;
> 
> tags
> 	:	'tags:' (' '*)! CAMELCASE (COMMA CAMELCASE)* ;
> 
> note
> 	: 	'note:' (' '*)! TEXT (NEWLINE+ TEXT)* ;
> 
> automatedTests
> 	:	'tests:' (' '*)! FILE (COMMA FILE)* ;
> 
> automatedTest
> 	:	'test:' (' '*)! TEXT ;
> 



From jbb at acm.org  Tue Jul  6 07:42:48 2010
From: jbb at acm.org (John B. Brodie)
Date: Tue, 06 Jul 2010 10:42:48 -0400
Subject: [antlr-interest] Antlr first time user, help requested
In-Reply-To: <1278424061.3743.21.camel@gecko.home.org>
References: <AANLkTim3aOmgrOnmcyWMrLfPL-ihdsiwNAAzCEUd4ZJ9@mail.gmail.com>
	<1278424061.3743.21.camel@gecko.home.org>
Message-ID: <1278427368.5074.30.camel@gecko.home.org>

On Tue, 2010-07-06 at 09:47 -0400, John B. Brodie wrote:
....snipped....

> change all references to TEXT to be text

sorry, should be: change all references to TEXT to be text+


I thought that maybe i should test what I am recommending so attached
please find a grammar that parses your example input.

-------------- next part --------------
grammar Test;

options {
   output = AST;
   ASTLabelType = CommonTree;
}

@members {
   private static final String [] x = new String[] {
      "PageMetaData:\n"+
      "name: This is a test name\n"+
      "categories: category1, category2,\n"+
      "  category3\n"+
      "note: These are notes\n"+
      "  that the newlines are important, but not the leading whitespace\n"
   };

   public static void main(String [] args) {
      for( int i = 0; i < x.length; ++i ) {
         try {
            System.out.println("about to parse:`"+x[i]+"`");
            TestLexer lexer = new TestLexer(new ANTLRStringStream(x[i]));
            CommonTokenStream tokens = new CommonTokenStream(lexer);

            TestParser parser = new TestParser(tokens);
            TestParser.start_return p_result = parser.start();

            CommonTree ast = p_result.tree;
            if( ast == null ) {
               System.out.println("resultant tree: is NULL");
            } else {
               System.out.println("resultant tree: " + ast.toStringTree());
            }
            System.out.println();
         } catch(Exception e) {
            e.printStackTrace();
         }
      }
   }
}

start : definition ;

definition
   : (NEWLINE! | WS!)* header NEWLINE
      testName NEWLINE
      categories NEWLINE
      (tags NEWLINE)?
      (note NEWLINE)?
      (automatedTests NEWLINE)?
      (automatedTest NEWLINE)?
      EOF! ;

header : HEADER_TEXT ;

testName : NAME_LABEL text+;

categories : CATEGORIES_LABEL WS!? CAMELCASE (comma CAMELCASE)* ;

tags : 'tags:' WS!? CAMELCASE (comma CAMELCASE)* ;

note : 'note:' text+ (NEWLINE+ WS! text+)* ;

automatedTests : 'tests:' WS!? FILE (comma FILE)* ;

automatedTest : 'test:' text+ ;

text : ~NEWLINE;

comma : COMMA (NEWLINE!? WS!)?;

// single-line comments
SL_COMMENT :
      '//'
      ( options { greedy=false; } : . )*
      ( '\r' | '\r\n' | '\n' ) // EOL untested under MS-Windows
      { $channel=HIDDEN; }
   ;

HEADER_TEXT : 'PageMetaData:' ;
NAME_LABEL : 'name:' ;
CATEGORIES_LABEL : 'categories:' ;
TAGS_LABEL : 'tags:' ;
NOTE_LABEL : 'note:' ;
AUTOMATED_TESTS_LABEL : 'automated-tests:' ;
AUTOMATED_TEST_LABEL : 'automated-test:' ;

COMMA : ',' ;

WS : (' ' | '\t')+ ;
NEWLINE : ('\r' '\n' | '\n' | '\r' );

CAMELCASE : ('A'..'Z'|'a'..'z'|'0'..'9')+;

FILE : ('A'..'Z'|'a'..'z'|'0'..'9'| '_' | '-' | '.' | '/')+;

OTHER : . ;

From andrewrwr at gmail.com  Tue Jul  6 12:13:56 2010
From: andrewrwr at gmail.com (Andrew Robinson)
Date: Tue, 6 Jul 2010 13:13:56 -0600
Subject: [antlr-interest] Antlr first time user, help requested
In-Reply-To: <AANLkTim3aOmgrOnmcyWMrLfPL-ihdsiwNAAzCEUd4ZJ9@mail.gmail.com>
References: <AANLkTim3aOmgrOnmcyWMrLfPL-ihdsiwNAAzCEUd4ZJ9@mail.gmail.com>
Message-ID: <AANLkTik0xejiS-XD45DKDRC1fsL-StiEdy-T5QPy2x3y@mail.gmail.com>

Thank you for all the help, I got it parsing the way I want (I
attached the grammar file for anyone interested). Now I am wondering
what the best method is to walk the AST tree. In a groovy script, I
used their visitor pattern (SourceCodeTraversal in combination with
their VisitorAdapter class) to extract the information I wanted.

Basically for this, I want the values of the tags:

PageMetaData:
name: This is a test name
categories: category1, category2,
 category3
notes: These are notes
 that the newlines are important, but not the leading whitespace

So I would like the name,"This is a test name", categories in a way I
can parse them into java enum constants added to a java-collection,
etc.

Is building a visitor a good way to go for this, or perhaps using code
blocks in the parser to capture the text I want, or what other
suggestions might you have on a recommended approach to interact with
the parsed code or AST?

Thanks again.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PageMetaData.g
Type: application/octet-stream
Size: 2271 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20100706/6ee66d6f/attachment.obj 

From David.Maier at ingres.com  Wed Jul  7 09:19:18 2010
From: David.Maier at ingres.com (David Maier)
Date: Wed, 7 Jul 2010 12:19:18 -0400
Subject: [antlr-interest] org.antlr.runtime.tree.RewriteEmptyStreamException
Message-ID: <21C3E073B82EFE4F8A76536D9066FE560427BBF8@USINVMAILB01.ingres.prv>

Hello,


I am getting the following error message as Output of a tree generating grammar which I am currently writing. 

Exception in thread "main" org.antlr.runtime.tree.RewriteEmptyStreamException: rule sp_decls
        at org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:158)
	at org.antlr.runtime.tree.RewriteRuleElementStream.nextTree(RewriteRuleElementStream.java:145)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_block_content(MySQLASTGenParser.java:10730)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_unlabeled_block(MySQLASTGenParser.java:9691)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_proc_stmt(MySQLASTGenParser.java:8577)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_tail(MySQLASTGenParser.java:1691)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.no_definer_tail(MySQLASTGenParser.java:1541)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.view_or_trigger_or_sp_or_event(MySQLASTGenParser.java:1401)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.create(MySQLASTGenParser.java:1260)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.stmt(MySQLASTGenParser.java:1186)
	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.prog(MySQLASTGenParser.java:1117)
	at __Test__.main(__Test__.java:16)

So the last rules are looking as the following:

sp_unlabeled_block:
          
          sp_block_content
          
        ;

sp_block_content:
          BEGIN_SYM
          
          sp_decls
          sp_proc_stmts
          END  -> sp_decls sp_proc_stmts //To ignore the BEGIN and END
        ;

sp_decls:  (sp_decl ';')* -> (sp_decl)*;

sp_decl:
	          DECLARE_SYM sp_decl_idents
	          
	          type
	          (sp_opt_default)? -> ^(TN_DECLARE ^(TN_PARAMS  sp_decl_idents type) ^(TN_TODO sp_opt_default)?)
	        
	          
	        | DECLARE_SYM ident CURSOR_SYM FOR_SYM sp_cursor_stmt ->  ^(TN_DECLARE ^(TN_NAME ident) ^(TN_SELECT sp_cursor_stmt))
	          
	        ;


There is a TN_CODE token type which I want to use as the root node of the subtree which will then have this TN_DECLARE nodes as child nodes. So I only did rewrite the rules 'between' TN_CODE and TN_DECLARE to remove unnecessary information like the ';' or the BEGIN and END keywords.
 
So I guess that the error occurs because my test input does not have a DECLARE section, but this is OK because of the rule 'sp_decls:  (sp_decl ';')* -> (sp_decl)*;
' which says that there could be even no one (*=0 or multiple). So has anybody an answer what is causing the issue and how to solve it?


BTW: Further information about the project is available here: http://community.ingres.com/wiki/Ingres_Migration_Tool_Set_Idiom_MySQL


Regards, David


--
David Maier
Senior Software Engineer

Ingres Germany GmbH
Weimarer Stra?e 1a
D-98693 Ilmenau

PHONE:  +49.3677.6785-59
FAX:    +49.3677.6785-23
MAIL:   david.maier at ingres.com

This transmission is confidential and intended solely for the use of the recipient named above. It may contain confidential, proprietary, or legally privileged information. If you are not the intended recipient, you are hereby notified that any unauthorized review, use, disclosure or distribution is strictly prohibited. If you have received this transmission in error, please contact the sender by reply e-mail and delete the original transmission and all copies from your system.


From aph at redhat.com  Wed Jul  7 09:22:45 2010
From: aph at redhat.com (Andrew Haley)
Date: Wed, 07 Jul 2010 17:22:45 +0100
Subject: [antlr-interest]
	org.antlr.runtime.tree.RewriteEmptyStreamException
In-Reply-To: <21C3E073B82EFE4F8A76536D9066FE560427BBF8@USINVMAILB01.ingres.prv>
References: <21C3E073B82EFE4F8A76536D9066FE560427BBF8@USINVMAILB01.ingres.prv>
Message-ID: <4C34A9D5.9000508@redhat.com>

On 07/07/2010 05:19 PM, David Maier wrote:
> Hello,
> 
> 
> I am getting the following error message as Output of a tree generating grammar which I am currently writing. 
> 
> Exception in thread "main" org.antlr.runtime.tree.RewriteEmptyStreamException: rule sp_decls
>         at org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:158)
> 	at org.antlr.runtime.tree.RewriteRuleElementStream.nextTree(RewriteRuleElementStream.java:145)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_block_content(MySQLASTGenParser.java:10730)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_unlabeled_block(MySQLASTGenParser.java:9691)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_proc_stmt(MySQLASTGenParser.java:8577)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_tail(MySQLASTGenParser.java:1691)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.no_definer_tail(MySQLASTGenParser.java:1541)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.view_or_trigger_or_sp_or_event(MySQLASTGenParser.java:1401)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.create(MySQLASTGenParser.java:1260)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.stmt(MySQLASTGenParser.java:1186)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.prog(MySQLASTGenParser.java:1117)
> 	at __Test__.main(__Test__.java:16)
> 
> So the last rules are looking as the following:
> 
> sp_unlabeled_block:
>           
>           sp_block_content
>           
>         ;
> 
> sp_block_content:
>           BEGIN_SYM
>           
>           sp_decls
>           sp_proc_stmts
>           END  -> sp_decls sp_proc_stmts //To ignore the BEGIN and END
>         ;
> 
> sp_decls:  (sp_decl ';')* -> (sp_decl)*;
> 
> sp_decl:
> 	          DECLARE_SYM sp_decl_idents
> 	          
> 	          type
> 	          (sp_opt_default)? -> ^(TN_DECLARE ^(TN_PARAMS  sp_decl_idents type) ^(TN_TODO sp_opt_default)?)
> 	        
> 	          
> 	        | DECLARE_SYM ident CURSOR_SYM FOR_SYM sp_cursor_stmt ->  ^(TN_DECLARE ^(TN_NAME ident) ^(TN_SELECT sp_cursor_stmt))
> 	          
> 	        ;
> 
> 
> There is a TN_CODE token type which I want to use as the root node of the subtree which will then have this TN_DECLARE nodes as child nodes. So I only did rewrite the rules 'between' TN_CODE and TN_DECLARE to remove unnecessary information like the ';' or the BEGIN and END keywords.
>  
> So I guess that the error occurs because my test input does not have a DECLARE section, but this is OK because of the rule 'sp_decls:  (sp_decl ';')* -> (sp_decl)*;
> ' which says that there could be even no one (*=0 or multiple). So has anybody an answer what is causing the issue and how to solve it?

sp_decls might be void.  Try

sp_block_content:
          BEGIN_SYM
          
          sp_decls
          sp_proc_stmts
          END  -> sp_decls? sp_proc_stmts //To ignore the BEGIN and END
        ;


From David.Maier at ingres.com  Wed Jul  7 09:42:20 2010
From: David.Maier at ingres.com (David Maier)
Date: Wed, 7 Jul 2010 12:42:20 -0400
Subject: [antlr-interest]
	org.antlr.runtime.tree.RewriteEmptyStreamException
References: <21C3E073B82EFE4F8A76536D9066FE560427BBF8@USINVMAILB01.ingres.prv>
	<4C34A9D5.9000508@redhat.com>
Message-ID: <21C3E073B82EFE4F8A76536D9066FE560427BBF9@USINVMAILB01.ingres.prv>

Hi again,


thanks for your quick reply Andrew. But shouldn't the following rule be enough to make ANTRL aware of that it can be void:

sp_decls:  (sp_decl ';')* -> (sp_decl)*;

I mean that the Kleene operator (*) means to also match the empty word, right? So I think the following is true for rules named 'a', 'b' and 'c':


(1) My variant

a : b;
b : c*;


with

c* := /*empty*/ | c+

and if I resolve it then 'a' means:

a: /*empty*/ | c+


(2) Your variant

a: b?;
b: c*;

with

b?:= /*empty*/ | b

b:= /*empty*/ | c+

and so 

a:= /*empty*/ | /*empty*/ | c+ := /*empty*/ | c+


So you can see that both should mean the same. So is it a kind of ANTLR issue that I would have to use the (?) operator here?


Regards, David

--
David Maier
Senior Software Engineer

Ingres Germany GmbH
Weimarer Stra?e 1a
D-98693 Ilmenau

PHONE:  +49.3677.6785-59
FAX:    +49.3677.6785-23
MAIL:   david.maier at ingres.com

This transmission is confidential and intended solely for the use of the recipient named above. It may contain confidential, proprietary, or legally privileged information. If you are not the intended recipient, you are hereby notified that any unauthorized review, use, disclosure or distribution is strictly prohibited. If you have received this transmission in error, please contact the sender by reply e-mail and delete the original transmission and all copies from your system.



-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org im Auftrag von Andrew Haley
Gesendet: Mi 07.07.2010 18:22
An: antlr-interest at antlr.org
Betreff: Re: [antlr-interest]org.antlr.runtime.tree.RewriteEmptyStreamException
 
On 07/07/2010 05:19 PM, David Maier wrote:
> Hello,
> 
> 
> I am getting the following error message as Output of a tree generating grammar which I am currently writing. 
> 
> Exception in thread "main" org.antlr.runtime.tree.RewriteEmptyStreamException: rule sp_decls
>         at org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:158)
> 	at org.antlr.runtime.tree.RewriteRuleElementStream.nextTree(RewriteRuleElementStream.java:145)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_block_content(MySQLASTGenParser.java:10730)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_unlabeled_block(MySQLASTGenParser.java:9691)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_proc_stmt(MySQLASTGenParser.java:8577)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.sp_tail(MySQLASTGenParser.java:1691)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.no_definer_tail(MySQLASTGenParser.java:1541)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.view_or_trigger_or_sp_or_event(MySQLASTGenParser.java:1401)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.create(MySQLASTGenParser.java:1260)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.stmt(MySQLASTGenParser.java:1186)
> 	at com.ingres.antlr.idiom.mysql.MySQLASTGenParser.prog(MySQLASTGenParser.java:1117)
> 	at __Test__.main(__Test__.java:16)
> 
> So the last rules are looking as the following:
> 
> sp_unlabeled_block:
>           
>           sp_block_content
>           
>         ;
> 
> sp_block_content:
>           BEGIN_SYM
>           
>           sp_decls
>           sp_proc_stmts
>           END  -> sp_decls sp_proc_stmts //To ignore the BEGIN and END
>         ;
> 
> sp_decls:  (sp_decl ';')* -> (sp_decl)*;
> 
> sp_decl:
> 	          DECLARE_SYM sp_decl_idents
> 	          
> 	          type
> 	          (sp_opt_default)? -> ^(TN_DECLARE ^(TN_PARAMS  sp_decl_idents type) ^(TN_TODO sp_opt_default)?)
> 	        
> 	          
> 	        | DECLARE_SYM ident CURSOR_SYM FOR_SYM sp_cursor_stmt ->  ^(TN_DECLARE ^(TN_NAME ident) ^(TN_SELECT sp_cursor_stmt))
> 	          
> 	        ;
> 
> 
> There is a TN_CODE token type which I want to use as the root node of the subtree which will then have this TN_DECLARE nodes as child nodes. So I only did rewrite the rules 'between' TN_CODE and TN_DECLARE to remove unnecessary information like the ';' or the BEGIN and END keywords.
>  
> So I guess that the error occurs because my test input does not have a DECLARE section, but this is OK because of the rule 'sp_decls:  (sp_decl ';')* -> (sp_decl)*;
> ' which says that there could be even no one (*=0 or multiple). So has anybody an answer what is causing the issue and how to solve it?

sp_decls might be void.  Try

sp_block_content:
          BEGIN_SYM
          
          sp_decls
          sp_proc_stmts
          END  -> sp_decls? sp_proc_stmts //To ignore the BEGIN and END
        ;


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From aph at redhat.com  Wed Jul  7 09:49:01 2010
From: aph at redhat.com (Andrew Haley)
Date: Wed, 07 Jul 2010 17:49:01 +0100
Subject: [antlr-interest]
	org.antlr.runtime.tree.RewriteEmptyStreamException
In-Reply-To: <21C3E073B82EFE4F8A76536D9066FE560427BBF9@USINVMAILB01.ingres.prv>
References: <21C3E073B82EFE4F8A76536D9066FE560427BBF8@USINVMAILB01.ingres.prv>
	<4C34A9D5.9000508@redhat.com>
	<21C3E073B82EFE4F8A76536D9066FE560427BBF9@USINVMAILB01.ingres.prv>
Message-ID: <4C34AFFD.2080709@redhat.com>

On 07/07/2010 05:42 PM, David Maier wrote:

> thanks for your quick reply Andrew. But shouldn't the following rule be
> enough to make ANTRL aware of that it can be void:
> 
> sp_decls:  (sp_decl ';')* -> (sp_decl)*;

That part is fine.  sp_block_content, however, don't know that sp_decls
might return a void result.

> I mean that the Kleene operator (*) means to also match the empty word,
> right? So I think the following is true for rules named 'a', 'b' and 'c':
> 
> 
> (1) My variant
> 
> a : b;
> b : c*;
> 
> 
> with
> 
> c* := /*empty*/ | c+
> 
> and if I resolve it then 'a' means:
> 
> a: /*empty*/ | c+
> 
> 
> (2) Your variant
> 
> a: b?;
> b: c*;
> 
> with
> 
> b?:= /*empty*/ | b
> 
> b:= /*empty*/ | c+
> 
> and so
> 
> a:= /*empty*/ | /*empty*/ | c+ := /*empty*/ | c+
> 
> 
> So you can see that both should mean the same. So is it a kind of ANTLR
> issue that I would have to use the (?) operator here?

Did you try it?  If so, did it work?

The rewrite rules are not part of the formal grammar as such, and you may
need to do things you don't expect.

As to whether this is an ANTLR bug, I don't know.  I can't find anything
in the spec one way or the other.

Andrew.

From David.Maier at ingres.com  Wed Jul  7 10:17:41 2010
From: David.Maier at ingres.com (David Maier)
Date: Wed, 7 Jul 2010 13:17:41 -0400
Subject: [antlr-interest]
	org.antlr.runtime.tree.RewriteEmptyStreamException
References: <21C3E073B82EFE4F8A76536D9066FE560427BBF8@USINVMAILB01.ingres.prv>
	<4C34A9D5.9000508@redhat.com>
	<21C3E073B82EFE4F8A76536D9066FE560427BBF9@USINVMAILB01.ingres.prv>
	<4C34AFFD.2080709@redhat.com>
Message-ID: <21C3E073B82EFE4F8A76536D9066FE560427BBFB@USINVMAILB01.ingres.prv>

Hi Andrew,

yes it worked by using the (?) operator on one level above. However, it seems that the problem does occur dependent on the input. So there may be other rules in my grammar those are affected. So this is the reason why I would appreciate that it works as expected.

However, thanks for your advise!

Regards, David

--
David Maier
Senior Software Engineer

Ingres Germany GmbH
Weimarer Stra?e 1a
D-98693 Ilmenau

PHONE:  +49.3677.6785-59
FAX:    +49.3677.6785-23
MAIL:   david.maier at ingres.com

This transmission is confidential and intended solely for the use of the recipient named above. It may contain confidential, proprietary, or legally privileged information. If you are not the intended recipient, you are hereby notified that any unauthorized review, use, disclosure or distribution is strictly prohibited. If you have received this transmission in error, please contact the sender by reply e-mail and delete the original transmission and all copies from your system.



-----Urspr?ngliche Nachricht-----
Von: Andrew Haley [mailto:aph at redhat.com]
Gesendet: Mi 07.07.2010 18:49
An: David Maier
Cc: antlr-interest at antlr.org
Betreff: Re: AW: [antlr-interest]org.antlr.runtime.tree.RewriteEmptyStreamException
 
On 07/07/2010 05:42 PM, David Maier wrote:

> thanks for your quick reply Andrew. But shouldn't the following rule be
> enough to make ANTRL aware of that it can be void:
> 
> sp_decls:  (sp_decl ';')* -> (sp_decl)*;

That part is fine.  sp_block_content, however, don't know that sp_decls
might return a void result.

> I mean that the Kleene operator (*) means to also match the empty word,
> right? So I think the following is true for rules named 'a', 'b' and 'c':
> 
> 
> (1) My variant
> 
> a : b;
> b : c*;
> 
> 
> with
> 
> c* := /*empty*/ | c+
> 
> and if I resolve it then 'a' means:
> 
> a: /*empty*/ | c+
> 
> 
> (2) Your variant
> 
> a: b?;
> b: c*;
> 
> with
> 
> b?:= /*empty*/ | b
> 
> b:= /*empty*/ | c+
> 
> and so
> 
> a:= /*empty*/ | /*empty*/ | c+ := /*empty*/ | c+
> 
> 
> So you can see that both should mean the same. So is it a kind of ANTLR
> issue that I would have to use the (?) operator here?

Did you try it?  If so, did it work?

The rewrite rules are not part of the formal grammar as such, and you may
need to do things you don't expect.

As to whether this is an ANTLR bug, I don't know.  I can't find anything
in the spec one way or the other.

Andrew.


From jimi at temporal-wave.com  Wed Jul  7 10:39:12 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Jul 2010 10:39:12 -0700
Subject: [antlr-interest]
	org.antlr.runtime.tree.RewriteEmptyStreamException
In-Reply-To: <21C3E073B82EFE4F8A76536D9066FE560427BBF9@USINVMAILB01.ingres.prv>
Message-ID: <eb56d68d88e18548a68a727ca7467cd0@temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of David Maier
> Sent: Wednesday, July 07, 2010 9:42 AM
> To: Andrew Haley; antlr-interest at antlr.org
> Subject: Re: [antlr-interest]
> org.antlr.runtime.tree.RewriteEmptyStreamException
> 
> Hi again,
> 
> 
> thanks for your quick reply Andrew. But shouldn't the following rule be
> enough to make ANTRL aware of that it can be void:
> 
> sp_decls:  (sp_decl ';')* -> (sp_decl)*;

No, that only concerns the rewrite for that rule. Higher up, if there are going to be empty sets, you need to say so there too, or change:

sp_decls:

so that it does not have the * operator then use sp_decls* in the higher rule.

> 
> I mean that the Kleene operator (*) means to also match the empty word,
> right? So I think the following is true for rules named 'a', 'b' and
> 'c':

What you think it might or should do and what it does are not always the same thing ;-)

Jim





From jimi at temporal-wave.com  Wed Jul  7 10:42:08 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Jul 2010 10:42:08 -0700
Subject: [antlr-interest]
	org.antlr.runtime.tree.RewriteEmptyStreamException
In-Reply-To: <21C3E073B82EFE4F8A76536D9066FE560427BBFB@USINVMAILB01.ingres.prv>
Message-ID: <49b952edc70eac45ae25c95c6dcd9cd6@temporal-wave.com>



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of David Maier
> Sent: Wednesday, July 07, 2010 10:18 AM
> To: Andrew Haley
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest]
> org.antlr.runtime.tree.RewriteEmptyStreamException
> 
> Hi Andrew,
> 
> yes it worked by using the (?) operator on one level above. However, it
> seems that the problem does occur dependent on the input. So there may
> be other rules in my grammar those are affected. So this is the reason
> why I would appreciate that it works as expected.

It works as it should, but your expectations are not correct I am afraid. Generally you are falling over on style:


X : a* b -> ^(NODE a* b) ;

Rather than

x : a b  -> ^(NODE a* b) ;
a: x* ;

Then what you think happens does happen. It also removes extra method calls (generally).

Jim






From peterhull90 at gmail.com  Wed Jul  7 12:57:35 2010
From: peterhull90 at gmail.com (Peter Hull)
Date: Wed, 7 Jul 2010 20:57:35 +0100
Subject: [antlr-interest] keywords and arbitrary text
Message-ID: <AANLkTinlIYuWANCJXBqDy3sZT8mIusLGPBY5FS3bi0NI@mail.gmail.com>

Hi all, here is a quick question from a new user.
I have a simple language I want to parse. Each line is a separate
command and each command looks something like
KEYWORD param param?
e.g.
SetGate 10 4.5
However there's a title command that can take any text up to the end
of line, e.g
Title Configuration 1
or even
Title This is a Title
I had a rule
TEXT: ~('\n'|'\r')+
but this (I think) matched all the keywords too, even if I used tokens {?}
Is there a way to say that the TEXT token is only to be used after
Title? I saw something on island grammars but I couldn't understand it
to be honest.

Pete

From Darin.Mikesell at gd-ais.com  Wed Jul  7 13:14:57 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Wed, 7 Jul 2010 15:14:57 -0500
Subject: [antlr-interest] keywords and arbitrary text
In-Reply-To: <AANLkTinlIYuWANCJXBqDy3sZT8mIusLGPBY5FS3bi0NI@mail.gmail.com>
References: <AANLkTinlIYuWANCJXBqDy3sZT8mIusLGPBY5FS3bi0NI@mail.gmail.com>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDC36DD8076@EADC01-MABPRD11.ad.gd-ais.com>

What if you place all your keyword rules before the TEXT rule?

I can't remember if ordering matters in ANTLR like it does in Xtext.  I'm assuming it does since Xtext uses ANTLR.


- Darin


-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Peter Hull
Sent: Wednesday, July 07, 2010 12:58 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] keywords and arbitrary text

Hi all, here is a quick question from a new user.
I have a simple language I want to parse. Each line is a separate
command and each command looks something like
KEYWORD param param...
e.g.
SetGate 10 4.5
However there's a title command that can take any text up to the end
of line, e.g
Title Configuration 1
or even
Title This is a Title
I had a rule
TEXT: ~('\n'|'\r')+
but this (I think) matched all the keywords too, even if I used tokens {...}
Is there a way to say that the TEXT token is only to be used after
Title? I saw something on island grammars but I couldn't understand it
to be honest.

Pete

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jimi at temporal-wave.com  Wed Jul  7 13:42:35 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 07 Jul 2010 13:42:35 -0700
Subject: [antlr-interest] keywords and arbitrary text
In-Reply-To: <AANLkTinlIYuWANCJXBqDy3sZT8mIusLGPBY5FS3bi0NI@mail.gmail.com>
Message-ID: <760144dfc4c98840843095425e1600b4@temporal-wave.com>

You just need:


TITLE : 'Title' (~('\n'|'\r'))* ;

Then look for TITLE in your parser.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Peter Hull
> Sent: Wednesday, July 07, 2010 12:58 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] keywords and arbitrary text
> 
> Hi all, here is a quick question from a new user.
> I have a simple language I want to parse. Each line is a separate
> command and each command looks something like
> KEYWORD param param...
> e.g.
> SetGate 10 4.5
> However there's a title command that can take any text up to the end
> of line, e.g
> Title Configuration 1
> or even
> Title This is a Title
> I had a rule
> TEXT: ~('\n'|'\r')+
> but this (I think) matched all the keywords too, even if I used tokens
> {...}
> Is there a way to say that the TEXT token is only to be used after
> Title? I saw something on island grammars but I couldn't understand it
> to be honest.
> 
> Pete
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From mattpalms at gmail.com  Wed Jul  7 14:24:02 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Wed, 7 Jul 2010 22:24:02 +0100
Subject: [antlr-interest] Building a regular expression AST
Message-ID: <AANLkTimMMVQv-i-5uRR-JQ00sXVQBzdzxy3TOprBq4Db@mail.gmail.com>

Hi,

I want to build a standard parse-tree for a regular expression, but
I'm having one or two difficulties.? For example, the expression:

    ABC|123

should yield a tree of:

          |
        /   \
 ?  ??.       .
??   / \     / \
?   .??C   .  3
  ?/ \     / \
  A?B   1 2

Alternatives (|) work, but I can't make concatenation of sequential
symbols (.) work at all - they end up as flat lists, rather than
nested:

         |
       /   \
     .       .
     |       |
  ABC  123

A simple grammar that shows the concatenation issue is here:

grammar test;

options { output=AST; }

tokens { CONCAT; }

start	:	regex EOF;

regex	:	chars ( ALT^ chars )* ;

chars	:	CHAR+ -> ^(CONCAT CHAR+) ;

ALT	:	'|' ;

CHAR	:	(~ALT) ;

My real regular expression grammar is somewhat longer, and also
contains groups and quantifiers.  It parses regular expressions very
well - with a somewhat deep parse tree - but I'm having problems
transforming the parse-tree into an AST.  Should I even be trying to
produce an AST?  I can of course simply write code that transforms the
parse tree into the structures I need - but I imagined that the AST
mechanism would be innately capable of this.  Any ideas are welcome,

Regards,

Matt.

From jbb at acm.org  Wed Jul  7 15:17:45 2010
From: jbb at acm.org (John B. Brodie)
Date: Wed, 07 Jul 2010 18:17:45 -0400
Subject: [antlr-interest] Building a regular expression AST
In-Reply-To: <AANLkTimMMVQv-i-5uRR-JQ00sXVQBzdzxy3TOprBq4Db@mail.gmail.com>
References: <AANLkTimMMVQv-i-5uRR-JQ00sXVQBzdzxy3TOprBq4Db@mail.gmail.com>
Message-ID: <1278541065.19629.3.camel@gecko.home.org>

Greetings!
On Wed, 2010-07-07 at 22:24 +0100, Matt Palmer wrote:
...snipped....
> 
> chars	:	CHAR+ -> ^(CONCAT CHAR+) ;
> 
...snipped...

chars : (CHAR->CHAR) ( chars -> ^(CONCAT CHAR chars) )? ;

but the above tree will be right associative. is that a problem for you?

hope this helps
   -jbb



From mattpalms at gmail.com  Wed Jul  7 15:30:42 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Wed, 7 Jul 2010 23:30:42 +0100
Subject: [antlr-interest] Building a regular expression AST
In-Reply-To: <1278541065.19629.3.camel@gecko.home.org>
References: <AANLkTimMMVQv-i-5uRR-JQ00sXVQBzdzxy3TOprBq4Db@mail.gmail.com> 
	<1278541065.19629.3.camel@gecko.home.org>
Message-ID: <AANLkTikGvXgSdaEurZgV5M2N3vzXLl3874eH5PgNav1Z@mail.gmail.com>

Wow.  That's some impressive ASTing ;)  It may take me some time to
pull apart what is going on there.

I don't think being right-associative will matter - but I'm not 100%
sure right now.  I've got to check whether all those comp-sci
algorithms to build NFAs and DFAs for regular expressions will care,
or whether the right-associativity will cause other parsing problems
in the more advanced parts of the regular expression.  But it gets me
to the next level.

thanks,

Matt.

On 7 July 2010 23:17, John B. Brodie <jbb at acm.org> wrote:
> chars : (CHAR->CHAR) ( chars -> ^(CONCAT CHAR chars) )? ;

From peterhull90 at gmail.com  Thu Jul  8 00:31:39 2010
From: peterhull90 at gmail.com (Peter Hull)
Date: Thu, 8 Jul 2010 08:31:39 +0100
Subject: [antlr-interest] Fwd:  keywords and arbitrary text
In-Reply-To: <AANLkTikFyqjQyFXbAeXa5qFeXa2SV83cVxK7cQraZrT_@mail.gmail.com>
References: <AANLkTinlIYuWANCJXBqDy3sZT8mIusLGPBY5FS3bi0NI@mail.gmail.com>
	<760144dfc4c98840843095425e1600b4@temporal-wave.com>
	<AANLkTikFyqjQyFXbAeXa5qFeXa2SV83cVxK7cQraZrT_@mail.gmail.com>
Message-ID: <AANLkTinpQEZ6t2Ir2JbUYz8mASpNrlz4T3FeW26LDAYf@mail.gmail.com>

Jim, Darin,
Thanks, that's helped. I've got another question on how it works,
though. Here is my grammar (just a subset of the actual language I
need to parse)
=== Sys.g ===
grammar Sys;

tokens {ARM='Arm'; SETGATE='SetGate'; MONITOR='Monitor'; TITLE='Title';}

program : lines;
lines ? : line*;
line ? ?: arm|setgate|monitor|Title;
arm ? ? : ? ? ? ARM INT;
setgate : ? ? ? SETGATE INT FLOAT;
monitor : ? ? ? MONITOR INT;
Title ? : ? ? ? TITLE (~('\n'|'\r'))* ;

INT : ? '0'..'9'+
? ?;

FLOAT
? ?: ? ('0'..'9')+ '.' ('0'..'9')* EXPONENT?
? ?| ? '.' ('0'..'9')+ EXPONENT?
? ?| ? ('0'..'9')+ EXPONENT
? ?;

fragment
EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;
---

Here is the test file:
=== test.txt ===
Title Test Example
Arm 29
SetGate 3 1.3
Monitor 1
Monitor 2
---

This seems to work OK. Originally I had 'Title' as 'title' i.e. a
non-terminal, and it gave these results.
line 1:5 no viable alternative at character ' '
line 1:7 mismatched character 'e' expecting 'i'
line 1:8 no viable alternative at character 's'
line 1:9 no viable alternative at character 't'
line 1:10 no viable alternative at character ' '
line 1:11 no viable alternative at character 'E'
line 1:12 no viable alternative at character 'x'
line 1:13 no viable alternative at character 'a'
line 1:14 no viable alternative at character 'm'
line 1:15 no viable alternative at character 'p'
line 1:16 no viable alternative at character 'l'
line 1:17 no viable alternative at character 'e'
line 2:3 no viable alternative at character ' '
line 3:7 no viable alternative at character ' '
line 3:9 no viable alternative at character ' '
line 4:7 no viable alternative at character ' '
line 5:7 no viable alternative at character ' '
I assume it's matched Title then the T of Test (at line 1:6) then it's looking
for 'Title' again (hence expecting 'i' at line 1:7)

Why is that?

Pete





On Wed, Jul 7, 2010 at 9:42 PM, Jim Idle <jimi at temporal-wave.com> wrote:
> You just need:
>
>
> TITLE : 'Title' (~('\n'|'\r'))* ;
>
> Then look for TITLE in your parser.
>
> Jim
>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Peter Hull
>> Sent: Wednesday, July 07, 2010 12:58 PM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] keywords and arbitrary text
>>
>> Hi all, here is a quick question from a new user.
>> I have a simple language I want to parse. Each line is a separate
>> command and each command looks something like
>> KEYWORD param param...
>> e.g.
>> SetGate 10 4.5
>> However there's a title command that can take any text up to the end
>> of line, e.g
>> Title Configuration 1
>> or even
>> Title This is a Title
>> I had a rule
>> TEXT: ~('\n'|'\r')+
>> but this (I think) matched all the keywords too, even if I used tokens
>> {...}
>> Is there a way to say that the TEXT token is only to be used after
>> Title? I saw something on island grammars but I couldn't understand it
>> to be honest.
>>
>> Pete
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From mattpalms at gmail.com  Thu Jul  8 00:32:42 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Thu, 8 Jul 2010 08:32:42 +0100
Subject: [antlr-interest] Building a regular expression AST
In-Reply-To: <AANLkTikGvXgSdaEurZgV5M2N3vzXLl3874eH5PgNav1Z@mail.gmail.com>
References: <AANLkTimMMVQv-i-5uRR-JQ00sXVQBzdzxy3TOprBq4Db@mail.gmail.com> 
	<1278541065.19629.3.camel@gecko.home.org>
	<AANLkTikGvXgSdaEurZgV5M2N3vzXLl3874eH5PgNav1Z@mail.gmail.com>
Message-ID: <AANLkTilimhlhGqaRrz9SDEOPAY4pBixQBuUs9ygKfvPk@mail.gmail.com>

In case anyone is interested, another strategy which does give a
left-associated tree (but is much less elegant and involves some
fiddly coding), is to make the lexer automatically emit virtual CONCAT
tokens between chars in the expression, following the advice on this
page:

http://www.antlr.org/wiki/pages/viewpage.action?pageId=3604497

Given an expression of the form ABC|123, the lexer emits the tokens:
CHAR(A) CONCAT CHAR(B) CONCAT CHAR(C) ALT CHAR(1) CONCAT CHAR(2) CONCAT CHAR(3)

Then using the rule:

chars:  CHAR (CONCAT^ CHAR)*;

will give a left-associative tree for the concatenation of  characters
in the expression, in the same way that the ALT rule does.

Matt.

On 7 July 2010 23:30, Matt Palmer <mattpalms at gmail.com> wrote:
> Wow. ?That's some impressive ASTing ;) ?It may take me some time to
> pull apart what is going on there.
>
> I don't think being right-associative will matter - but I'm not 100%
> sure right now. ?I've got to check whether all those comp-sci
> algorithms to build NFAs and DFAs for regular expressions will care,
> or whether the right-associativity will cause other parsing problems
> in the more advanced parts of the regular expression. ?But it gets me
> to the next level.
>
> thanks,
>
> Matt.
>
> On 7 July 2010 23:17, John B. Brodie <jbb at acm.org> wrote:
>> chars : (CHAR->CHAR) ( chars -> ^(CONCAT CHAR chars) )? ;
>

From zellux at gmail.com  Thu Jul  8 01:38:32 2010
From: zellux at gmail.com (ZelluX)
Date: Thu, 8 Jul 2010 16:38:32 +0800
Subject: [antlr-interest] Interpreting IF statements in ANTLR
Message-ID: <AANLkTiniXqbCnJUA0DFoixC_qvsTEH_LYEimM7A6jUip@mail.gmail.com>

I'm implementing a BASIC-like language, the syntax of if statements is
almost the same to BASIC:

    IF a == b THEN
        PRINT "EQUAL"
    ELSE
        PRINT "UNEQUAL"
    ENDIF

I have write a grammar file to parse and a tree walker to interpreter the
language:

    [Expr.g]
    options {
        language=Python;
        output=AST;
        ASTLabelType=CommonTree;
    }

    tokens {
        BLOCK;
    }

    block
        : stmt* -> ^(BLOCK stmt*)
        ;

    if_stmt
        : 'IF' c=expr 'THEN' t=block ('ELSE' f=block)? 'ENDIF'
            -> ^('IF' $c $t+ ^('ELSE' $f+))
        ;

In the AST walker:

    [Walker.g]
    options {
        language=Python;
        tokenVocab=Expr;
        ASTLabelType=CommonTree;
    }

    block
        : ^(BLOCK stmt*)
        ;

    stmt
        : ...
        | 'IF' expr t=stmt* 'ELSE' f=stmt*
             {}

Now I can correctly generate AST for my language, but I don't know how to
handle branch statement. To be more exactly, if the *expr* in if statement
is true, how can I avoid evaluation of the ELSE statement? Thanks

-- 
Best regards,
Wang Yuanxuan
Parallel Processing Institute, Fudan University

From David.Maier at ingres.com  Thu Jul  8 02:14:24 2010
From: David.Maier at ingres.com (David Maier)
Date: Thu, 8 Jul 2010 05:14:24 -0400
Subject: [antlr-interest]
	org.antlr.runtime.tree.RewriteEmptyStreamException
References: <49b952edc70eac45ae25c95c6dcd9cd6@temporal-wave.com>
Message-ID: <21C3E073B82EFE4F8A76536D9066FE560427BBFC@USINVMAILB01.ingres.prv>

Hello Jim,


I am still not understanding why I am expecting wrong things. As shown in my previous example that (1) and (2) are both equivalent to (3) regarding the top level rule 'a' (please see below for further details about (1), (2) and (3)). So this proofs especially that (1) is equivalent to (2). So why is it wrong to expect that the generated parsers of (1) and (2) are also equivalent? In my case with equivalent parsers I mean that the output AST of parser (1) and (2) is the same for every input. This isn't the case for my grammar because my rule in style of (1) does produce an empty AST (indeed caused by this raised exception ) and a rule in style of (2) produces the following one: http://community.ingres.com/wiki/Image:SimpleSelectMySQLAST.jpg . 

There was also an argument that it is related to the rewriting of rules. This is also mysterious for me because as far as I am understanding the rewriting of a rule simply means to substitute the right side of a rule with the new rewritten rule. So let's assume that the rewriting causes that (1) and (2) are looking as below. So what I guess is that the error occurs because a Subtree (in the AST) created by rule 'b' is expected which is finally empty. This subtree is not expected if I 'tell' ANTLR that it is optional by using the (?) operator. So the issue here is that even the fact that b can end up in the empty word means that it is 'optional' and so ANTLR should be able to handle this. So one way to solve this would be to catch the 'org.antlr.runtime.tree.RewriteEmptyStreamException' and so not to include the subtree which is generated by 'b'.

I indeed could understand if you tell me that my problem is caused by an ANTLR limitation. So then there are the two options. Option one is that it is documented somewhere as a limitation, and I simply did not search deep enough to find it. Option two is that it is not documented and so it is an ANTLR related issue, right?

Here the example rules to which I am refering in the text above:

(1) 
 a : b;
 b : c*;


(2)
 a: b?;
 b: c*;


(3)
 a: /*empty*/ | c+


Regards, David

--
David Maier
Senior Software Engineer

Ingres Germany GmbH
Weimarer Stra?e 1a
D-98693 Ilmenau

PHONE:  +49.3677.6785-59
FAX:    +49.3677.6785-23
MAIL:   david.maier at ingres.com

This transmission is confidential and intended solely for the use of the recipient named above. It may contain confidential, proprietary, or legally privileged information. If you are not the intended recipient, you are hereby notified that any unauthorized review, use, disclosure or distribution is strictly prohibited. If you have received this transmission in error, please contact the sender by reply e-mail and delete the original transmission and all copies from your system.



-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org im Auftrag von Jim Idle
Gesendet: Mi 07.07.2010 19:42
Cc: antlr-interest at antlr.org
Betreff: Re: [antlr-interest]org.antlr.runtime.tree.RewriteEmptyStreamException
 


> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of David Maier
> Sent: Wednesday, July 07, 2010 10:18 AM
> To: Andrew Haley
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest]
> org.antlr.runtime.tree.RewriteEmptyStreamException
> 
> Hi Andrew,
> 
> yes it worked by using the (?) operator on one level above. However, it
> seems that the problem does occur dependent on the input. So there may
> be other rules in my grammar those are affected. So this is the reason
> why I would appreciate that it works as expected.

It works as it should, but your expectations are not correct I am afraid. Generally you are falling over on style:


X : a* b -> ^(NODE a* b) ;

Rather than

x : a b  -> ^(NODE a* b) ;
a: x* ;

Then what you think happens does happen. It also removes extra method calls (generally).

Jim






List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Thu Jul  8 07:25:40 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 08 Jul 2010 07:25:40 -0700
Subject: [antlr-interest] Interpreting IF statements in ANTLR
In-Reply-To: <AANLkTiniXqbCnJUA0DFoixC_qvsTEH_LYEimM7A6jUip@mail.gmail.com>
Message-ID: <f69482f9b3413e41a0d637dc85825a0e@temporal-wave.com>

Please see: antlr.markmail.org 

This questions is answered many times in the list :-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of ZelluX
> Sent: Thursday, July 08, 2010 1:39 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Interpreting IF statements in ANTLR
> 
> I'm implementing a BASIC-like language, the syntax of if statements is
> almost the same to BASIC:
> 
>     IF a == b THEN
>         PRINT "EQUAL"
>     ELSE
>         PRINT "UNEQUAL"
>     ENDIF
> 
> I have write a grammar file to parse and a tree walker to interpreter
> the
> language:
> 
>     [Expr.g]
>     options {
>         language=Python;
>         output=AST;
>         ASTLabelType=CommonTree;
>     }
> 
>     tokens {
>         BLOCK;
>     }
> 
>     block
>         : stmt* -> ^(BLOCK stmt*)
>         ;
> 
>     if_stmt
>         : 'IF' c=expr 'THEN' t=block ('ELSE' f=block)? 'ENDIF'
>             -> ^('IF' $c $t+ ^('ELSE' $f+))
>         ;
> 
> In the AST walker:
> 
>     [Walker.g]
>     options {
>         language=Python;
>         tokenVocab=Expr;
>         ASTLabelType=CommonTree;
>     }
> 
>     block
>         : ^(BLOCK stmt*)
>         ;
> 
>     stmt
>         : ...
>         | 'IF' expr t=stmt* 'ELSE' f=stmt*
>              {}
> 
> Now I can correctly generate AST for my language, but I don't know how
> to
> handle branch statement. To be more exactly, if the *expr* in if
> statement
> is true, how can I avoid evaluation of the ELSE statement? Thanks
> 
> --
> Best regards,
> Wang Yuanxuan
> Parallel Processing Institute, Fudan University
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From Tony.Gray at ca.schneider-electric.com  Thu Jul  8 11:04:44 2010
From: Tony.Gray at ca.schneider-electric.com (Tony.Gray at ca.schneider-electric.com)
Date: Thu, 8 Jul 2010 11:04:44 -0700
Subject: [antlr-interest] C# target header global actions - before ANTLR
	includes or after?
Message-ID: <OFACF2E80D.FD0A054E-ON8825775A.0062BA07-8825775A.00634FB0@US.Schneider-Electric.com>

In the C# target, global actions in the @parser::header{} block go 
_before_ the ANTLR standard header.

In C#, this section is full of 'using' statements that import namespaces 
of interest. 

The problem I'm having is that I want to adorn the class declaration for 
my parser with some [attributes].  To do that, I need to embed some code 
immediately before the class definition, but I can't do that because the 
ANTLR standard headers are between my header block and the class 
declaration.

If I'm reading this right, other language targets put the @header{} global 
action contents immediately before the class definition and after the 
stock ANTLR headers.

Was this choice in the C# target deliberate?  Is there anything I can do 
to emit code immediately above my generated parser definition?

oh, and as always, ANTLR rocks!

Tony Gray  Schneider Electric 

From Tony.Gray at ca.schneider-electric.com  Thu Jul  8 11:08:58 2010
From: Tony.Gray at ca.schneider-electric.com (Tony.Gray at ca.schneider-electric.com)
Date: Thu, 8 Jul 2010 11:08:58 -0700
Subject: [antlr-interest] Can I embed the Antlr version number in my
 generated code using some kind of macro?
Message-ID: <OFE08A694A.7CFD3DBF-ON8825775A.0060130F-8825775A.0063B312@US.Schneider-Electric.com>

The ANTLR generated code has lots of nice identifier comments in it with 
the file, line number and grammar file contents that generated the code. 
Are there anything like preprocessor macros I can use to get direct access 
to that info?

I'm using the C# target and what I'm really after is the ability to add a 
custom code attribute to my generated classes to instruct code analysis 
tools that this is generated code.  It It should be easy to just embed 
that as hard-coded output in the @parser::header { } stuff like so:

        [GeneratedCodeAttribute("ANTLR","3.2")]

but I'd really like to have the generator drop the version number in for 
that string the way it does in the automatically generated comments, like 

// $ANTLR 3.2 Sep 23, 2009 12:02:23 

I spent 20 minutes googling and came up dry - any suggestions?


Tony Gray
Schneider Electric


From sharwell at pixelminegames.com  Thu Jul  8 11:29:29 2010
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 8 Jul 2010 13:29:29 -0500
Subject: [antlr-interest] C# target header global actions - before
	ANTLR	includes or after?
In-Reply-To: <OFACF2E80D.FD0A054E-ON8825775A.0062BA07-8825775A.00634FB0@US.Schneider-Electric.com>
References: <OFACF2E80D.FD0A054E-ON8825775A.0062BA07-8825775A.00634FB0@US.Schneider-Electric.com>
Message-ID: <033901cb1ecb$80a6a3b0$81f3eb10$@pixelminegames.com>

The C# target declares the parser as a partial class. If your parser
MyParser is generated in a file called MyParser.cs, create another file in
your project called MyParserHelper.cs with contents like this:

namespace MyParserNamespace
{
    [YourAttributeHere]
    partial class MyParser { }
}

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of
Tony.Gray at ca.schneider-electric.com
Sent: Thursday, July 08, 2010 1:05 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] C# target header global actions - before ANTLR
includes or after?

In the C# target, global actions in the @parser::header{} block go _before_
the ANTLR standard header.

In C#, this section is full of 'using' statements that import namespaces of
interest. 

The problem I'm having is that I want to adorn the class declaration for my
parser with some [attributes].  To do that, I need to embed some code
immediately before the class definition, but I can't do that because the
ANTLR standard headers are between my header block and the class
declaration.

If I'm reading this right, other language targets put the @header{} global
action contents immediately before the class definition and after the stock
ANTLR headers.

Was this choice in the C# target deliberate?  Is there anything I can do to
emit code immediately above my generated parser definition?

oh, and as always, ANTLR rocks!

Tony Gray  Schneider Electric 

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From a.moderacja at gmail.com  Thu Jul  8 11:46:50 2010
From: a.moderacja at gmail.com (Borneq)
Date: Thu, 8 Jul 2010 20:46:50 +0200
Subject: [antlr-interest] ClassNotFoundException for ANTLRInputStream
Message-ID: <AANLkTinv8FAahfP8CGGN4a8Xc7CmTCMzKsKufKIet5XO@mail.gmail.com>

I compile my first grammar

grammar T;
/** Match things like "call foo;" */
r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
ID: 'a'..'z' + ;
WS: (' ' |'\n' |'\r' )+ {$channel=HIDDEN;} ; // ignore whitespace

and compiler creates files TLexer.java and TParser.java
I wrote Test.java :
======================================================
import org.antlr.runtime.* ;

 public class Test      {
   public static void main(String[] args)   throws Exception{
       //create a CharStream that reads from standard input;	
	   ANTLRInputStream input = new ANTLRInputStream(System.in);
       //create a lexer that feeds off of input CharStream
       TLexer lexer = new TLexer(input);
       //create a buffer of tokens pulled from the lexer
       CommonTokenStream tokens = new CommonTokenStream(lexer);
       // create a parser that feeds off the tokens buffer
       TParser parser = new TParser(tokens);
       //  begin   parsing   at  rule  r
       parser.r();
  }
}
======================================================
When I debug, it appear exception in "ANTLRInputStream input = new
ANTLRInputStream(System.in);"
Exception is ClassNotFoundException org.antlr.runtime.ANTLRInputStream
It compiles but runtime error, what I have bad in project?

From vuurwerk.christian at googlemail.com  Thu Jul  8 12:07:25 2010
From: vuurwerk.christian at googlemail.com (Christian (VuuRWerK) Seifert)
Date: Thu, 8 Jul 2010 21:07:25 +0200
Subject: [antlr-interest] Fwd: ClassNotFoundException for ANTLRInputStream
In-Reply-To: <AANLkTikzC7s_GzSP842ryf_cAUMqy1jSmRymKoc20NLM@mail.gmail.com>
References: <AANLkTinv8FAahfP8CGGN4a8Xc7CmTCMzKsKufKIet5XO@mail.gmail.com> 
	<AANLkTikzC7s_GzSP842ryf_cAUMqy1jSmRymKoc20NLM@mail.gmail.com>
Message-ID: <AANLkTimFKnFzodmUNkM3g19U7D4iqICFCO26o_gLDlbx@mail.gmail.com>

Sorry, I've forgot to send the reply to the list ...


---------- Forwarded message ----------
From: Christian (VuuRWerK) Seifert <vuurwerk.christian at googlemail.com>
Date: 2010/7/8
Subject: Re: [antlr-interest] ClassNotFoundException for ANTLRInputStream
To: Borneq <a.moderacja at gmail.com>


Hi Borneq,

do you have add the path to the antlr-3.2.jar to your class path when
you start the program?
e.g.: java -classpath /path/to/antlr-3.2.jar tld.domain.MainClass
MainClass.class

- Christian

2010/7/8 Borneq <a.moderacja at gmail.com>:
> I compile my first grammar
>
> grammar T;
> /** Match things like "call foo;" */
> r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
> ID: 'a'..'z' + ;
> WS: (' ' |'\n' |'\r' )+ {$channel=HIDDEN;} ; // ignore whitespace
>
> and compiler creates files TLexer.java and TParser.java
> I wrote Test.java :
> ======================================================
> import org.antlr.runtime.* ;
>
> ?public class Test ? ? ?{
> ? public static void main(String[] args) ? throws Exception{
> ? ? ? //create a CharStream that reads from standard input;
> ? ? ? ? ? ANTLRInputStream input = new ANTLRInputStream(System.in);
> ? ? ? //create a lexer that feeds off of input CharStream
> ? ? ? TLexer lexer = new TLexer(input);
> ? ? ? //create a buffer of tokens pulled from the lexer
> ? ? ? CommonTokenStream tokens = new CommonTokenStream(lexer);
> ? ? ? // create a parser that feeds off the tokens buffer
> ? ? ? TParser parser = new TParser(tokens);
> ? ? ? // ?begin ? parsing ? at ?rule ?r
> ? ? ? parser.r();
> ?}
> }
> ======================================================
> When I debug, it appear exception in "ANTLRInputStream input = new
> ANTLRInputStream(System.in);"
> Exception is ClassNotFoundException org.antlr.runtime.ANTLRInputStream
> It compiles but runtime error, what I have bad in project?
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From martijn.reuvers at gmail.com  Fri Jul  9 02:20:09 2010
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Fri, 9 Jul 2010 11:20:09 +0200
Subject: [antlr-interest] Determine / check validity of type
Message-ID: <AANLkTikCJUpJRzmuZ-p1Av8CDBJX98R_d2CnlyMPYpC8@mail.gmail.com>

Hello everyone,

I have a question related to determining the type returned from an
expression on 'compile' time (not runtime!).

For example take the following code:

***************************

function someFunction(int a) return string {
  return "a string!"
}

int finalValue = (100+5)*2 + someFunction("a"+someFunction(1))

// Note the errors, we do not allow adding a text to an int, and the
function invoke contains an expression returning a string (should be
an int), but expression itself is ok.

***************************

Assume the code is parsed and transformed to an AST without error. We
are walking the tree and walk the variable 'finalValue', and see the
value must be of type 'int'. Tree would look something like:

         var_assignment
   /                            \
finalValue(type=int)     expression


Where would you determine the first error? While evaluating the +
(between left-side exp and someFunction()) and log an error there?

The second error I find harder, the invoke of: someFunction(..) .

Looking up the MethodSymbol for it will tell the formal parameter
exptected is an int, but how now to determine that the expression
given is actually returning an int? Would you walk the entire
parameter: expression (in this case) "a"+someFunction(1) ? But as said
before we cannot execute the code.

Anyone having an idea on how to do this in a flexible (and hopefully
not too difficult) way?

Thanks a lot for thinking along!

Martijn

From netjan42 at gmail.com  Fri Jul  9 02:43:21 2010
From: netjan42 at gmail.com (Jan F)
Date: Fri, 9 Jul 2010 11:43:21 +0200
Subject: [antlr-interest] Looking for ANTLR developer in Berlin, Germany
Message-ID: <AANLkTinLhWKaCrgRVtrwBmvNr75CbF_JuQ3ELLE1eYF0@mail.gmail.com>

I am looking for an experienced ANTLR developer (with deep interest in
compilers, dynamic languages, and such, Eclipse Platform knowledge a big
plus) for a new high-energy startup company in Berlin, Germany.
More details here:
http://numberfourag.wordpress.com/we-are-looking-for-software-engineer-compiler/

Mail me directly at jan at numberfour.eu if interested

-Jan

From markwright at internode.on.net  Fri Jul  9 03:38:52 2010
From: markwright at internode.on.net (Mark Wright)
Date: Fri, 9 Jul 2010 20:38:52 +1000
Subject: [antlr-interest] Determine / check validity of type
In-Reply-To: <AANLkTikCJUpJRzmuZ-p1Av8CDBJX98R_d2CnlyMPYpC8@mail.gmail.com>
References: <AANLkTikCJUpJRzmuZ-p1Av8CDBJX98R_d2CnlyMPYpC8@mail.gmail.com>
Message-ID: <20100709103852.GA1484@internode.on.net>

Hi Martin,

The type system in the example you described can be modelled with
the Simply Typed Lambda Calculus, which is described in detail in
the standard text on type systems "Types and Programming Languages"
by Benjamin Pierce.  It assumes knowledge of logic, set theory,
relations and proof by induction.  The text I recommend for the necessary
mathematical background is "The Haskell Road to Logic, Maths and
Programming" by Doets and Eijck.  Although it mentions a programming
language in the title, this is primarilly a maths text.  The occassional
programming language examples help to reinforce understanding of the
maths.

Regards, Mark

From andrew.bradnan at gmail.com  Fri Jul  9 07:08:34 2010
From: andrew.bradnan at gmail.com (Andrew Bradnan)
Date: Fri, 9 Jul 2010 07:08:34 -0700
Subject: [antlr-interest] Can I embed the Antlr version number in my
	generated code using some kind of macro?
In-Reply-To: <OFE08A694A.7CFD3DBF-ON8825775A.0060130F-8825775A.0063B312@US.Schneider-Electric.com>
References: <OFE08A694A.7CFD3DBF-ON8825775A.0060130F-8825775A.0063B312@US.Schneider-Electric.com>
Message-ID: <AANLkTikwAQb0L2eyYUaC6FfAX43I_mFdPZU7ZYcB1YjY@mail.gmail.com>

You would have to modify the string template for the CSharp2 target in the
antlr-3.2.jar file.
It lives at antlr-3.2_jar\org\antlr\codegen\templates\CSharp2\CSharp2.stg
You can update if you have a copy of winzip handy.  Just unzip, update the
stg. file and rezip.
Of course that change will be null and void with the next version of antlr
which will have a new version of the string template.  That is how to update
the generated code however.

Hope that helps.
Andrew

On Thu, Jul 8, 2010 at 11:08 AM, <Tony.Gray at ca.schneider-electric.com>wrote:

> The ANTLR generated code has lots of nice identifier comments in it with
> the file, line number and grammar file contents that generated the code.
> Are there anything like preprocessor macros I can use to get direct access
> to that info?
>
> I'm using the C# target and what I'm really after is the ability to add a
> custom code attribute to my generated classes to instruct code analysis
> tools that this is generated code.  It It should be easy to just embed
> that as hard-coded output in the @parser::header { } stuff like so:
>
>        [GeneratedCodeAttribute("ANTLR","3.2")]
>
> but I'd really like to have the generator drop the version number in for
> that string the way it does in the automatically generated comments, like
>
> // $ANTLR 3.2 Sep 23, 2009 12:02:23
>
> I spent 20 minutes googling and came up dry - any suggestions?
>
>
> Tony Gray
> Schneider Electric
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
/Andrew

From Tony.Gray at ca.schneider-electric.com  Fri Jul  9 09:43:05 2010
From: Tony.Gray at ca.schneider-electric.com (Tony.Gray at ca.schneider-electric.com)
Date: Fri, 9 Jul 2010 09:43:05 -0700
Subject: [antlr-interest] C# target header global actions -
	before	ANTLR	includes or after?
In-Reply-To: <033901cb1ecb$80a6a3b0$81f3eb10$@pixelminegames.com>
References: <OFACF2E80D.FD0A054E-ON8825775A.0062BA07-8825775A.00634FB0@US.Schneider-Electric.com>
	<033901cb1ecb$80a6a3b0$81f3eb10$@pixelminegames.com>
Message-ID: <OF40229A94.9F1D4E75-ON8825775B.005B8843-8825775B.005BD608@US.Schneider-Electric.com>

Thanks Sam - I had tried the the partial class approach, but the first 
time I tried it I missed the fact that my partial with the attribute on it 
wasn't in the same namespace.  I added the 

@parser::namespace {MyNamespace}

global action to my grammar and it worked like a charm. 

Thanks again,
Tony.

--------------------------------------
The C# target declares the parser as a partial class. If your parser
MyParser is generated in a file called MyParser.cs, create another file in
your project called MyParserHelper.cs with contents like this:

namespace MyParserNamespace
{
    [YourAttributeHere]
    partial class MyParser { }
}


From jimi at temporal-wave.com  Fri Jul  9 09:52:32 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 09 Jul 2010 09:52:32 -0700
Subject: [antlr-interest] Determine / check validity of type
In-Reply-To: <AANLkTikCJUpJRzmuZ-p1Av8CDBJX98R_d2CnlyMPYpC8@mail.gmail.com>
Message-ID: <8dc3764b928dad4d84b95750a79d2416@temporal-wave.com>

First of all you need to produce an AST, then a tree walking grammar. In each rule of an expression you return a type such that the expression itself returns a type. An operator then invokes a function with the operation and the types of the arguments, which then issues an error message and returns a type to propagate (which is the result of the operation or an error). Future checks do not issue error messages if any of the operands are the error type (so you do not get myriad errors cascading), but return the error type.

When a function is declared (or built-in declared) the arguments are typed, you make the same check as for operators and the return type of the expression is the return type of the function as declared. 

There is quite a bit of work involved but it is very orthogonal and so not difficult when you see the pattern.

Jim


> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Martijn Reuvers
> Sent: Friday, July 09, 2010 2:20 AM
> To: antlr ANTLR
> Subject: [antlr-interest] Determine / check validity of type
> 
> Hello everyone,
> 
> I have a question related to determining the type returned from an
> expression on 'compile' time (not runtime!).
> 
> For example take the following code:
> 
> ***************************
> 
> function someFunction(int a) return string {
>   return "a string!"
> }
> 
> int finalValue = (100+5)*2 + someFunction("a"+someFunction(1))
> 
> // Note the errors, we do not allow adding a text to an int, and the
> function invoke contains an expression returning a string (should be
> an int), but expression itself is ok.
> 
> ***************************
> 
> Assume the code is parsed and transformed to an AST without error. We
> are walking the tree and walk the variable 'finalValue', and see the
> value must be of type 'int'. Tree would look something like:
> 
>          var_assignment
>    /                            \
> finalValue(type=int)     expression
> 
> 
> Where would you determine the first error? While evaluating the +
> (between left-side exp and someFunction()) and log an error there?
> 
> The second error I find harder, the invoke of: someFunction(..) .
> 
> Looking up the MethodSymbol for it will tell the formal parameter
> exptected is an int, but how now to determine that the expression
> given is actually returning an int? Would you walk the entire
> parameter: expression (in this case) "a"+someFunction(1) ? But as said
> before we cannot execute the code.
> 
> Anyone having an idea on how to do this in a flexible (and hopefully
> not too difficult) way?
> 
> Thanks a lot for thinking along!
> 
> Martijn
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From Tony.Gray at ca.schneider-electric.com  Fri Jul  9 09:54:53 2010
From: Tony.Gray at ca.schneider-electric.com (Tony.Gray at ca.schneider-electric.com)
Date: Fri, 9 Jul 2010 09:54:53 -0700
Subject: [antlr-interest] Can I embed the Antlr version number in
 my	generated code using some kind of macro?
In-Reply-To: <AANLkTikwAQb0L2eyYUaC6FfAX43I_mFdPZU7ZYcB1YjY@mail.gmail.com>
References: <OFE08A694A.7CFD3DBF-ON8825775A.0060130F-8825775A.0063B312@US.Schneider-Electric.com>
	<AANLkTikwAQb0L2eyYUaC6FfAX43I_mFdPZU7ZYcB1YjY@mail.gmail.com>
Message-ID: <OFEBCA88D2.6CBB988F-ON8825775B.005C4E0F-8825775B.005CEA50@US.Schneider-Electric.com>

Thanks Andrew - after I'd posted, I did some poking around that led me 
right to CSharp2.stg.  It's very readable, and I thought about modifying 
it, but as you (and Yoda) pointed out, "Once you start modifying your 
distro, forever will it dominate your upgrades".   If there were an actual 
error I was trying to fix, sure, but this one isn't worth it.

Thanks for your help!

Tony Gray  |   Schneider Electric   



From:
Andrew Bradnan <andrew.bradnan at gmail.com>
To:
Tony.Gray at ca.schneider-electric.com
Cc:
antlr-interest at antlr.org
Date:
07/09/2010 07:09 AM
Subject:
Re: [antlr-interest] Can I embed the Antlr version number in my generated 
code using some kind of macro?
Sent by:
antlr-interest-bounces at antlr.org



You would have to modify the string template for the CSharp2 target in the
antlr-3.2.jar file.
It lives at antlr-3.2_jar\org\antlr\codegen\templates\CSharp2\CSharp2.stg
You can update if you have a copy of winzip handy.  Just unzip, update the
stg. file and rezip.
Of course that change will be null and void with the next version of antlr
which will have a new version of the string template.  That is how to 
update
the generated code however.

Hope that helps.
Andrew

On Thu, Jul 8, 2010 at 11:08 AM, 
<Tony.Gray at ca.schneider-electric.com>wrote:

> The ANTLR generated code has lots of nice identifier comments in it with
> the file, line number and grammar file contents that generated the code.
> Are there anything like preprocessor macros I can use to get direct 
access
> to that info?
>
> I'm using the C# target and what I'm really after is the ability to add 
a
> custom code attribute to my generated classes to instruct code analysis
> tools that this is generated code.  It It should be easy to just embed
> that as hard-coded output in the @parser::header { } stuff like so:
>
>        [GeneratedCodeAttribute("ANTLR","3.2")]
>
> but I'd really like to have the generator drop the version number in for
> that string the way it does in the automatically generated comments, 
like
>
> // $ANTLR 3.2 Sep 23, 2009 12:02:23
>
> I spent 20 minutes googling and came up dry - any suggestions?
>
>
> Tony Gray
> Schneider Electric
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
/Andrew

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: 
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

________________________________________________________________________
This email has been scanned for SPAM content and Viruses by the 
MessageLabs Email Security System.
________________________________________________________________________




From klausmartinschitz at gmail.com  Fri Jul  9 12:10:55 2010
From: klausmartinschitz at gmail.com (Klaus Martinschitz)
Date: Fri, 09 Jul 2010 21:10:55 +0200
Subject: [antlr-interest] ANTLR Basic Question
Message-ID: <4C37743F.6030602@gmail.com>

  Hi ANTLR Gurus,

A beginner's question.
I want to write a compiler for Crystallographic Information File Format 
' (CIF). I don't want to explain the syntax in detail only the problem I 
have to face with.

The data starts with a token

'data_'

followed by arbitrary characters and an EOL, e.g.

data_global
.

There is also a token

'loop_';

Somewehere in my BNF I write something like

DATA
     :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
     ;

LOOP
     :
     (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
     ;

dataBlockHeading
     :    (DATA NONBLANCKCHAR+ EOL)
     ;

dataItem
     :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
     ;

The first two expressions are tokens the second are rules. My problem is 
following. The file starts with

data_global

BUT the *lo* of data_g*lo*bal is parsed from the LOOP token. How can 
this be if the parser is in the dataBlockHeadingrule? The parser must 
know that the characters *lo* belong to NONBLANCKCHAR and not to LOOP,
or?

I have attached the whole syntax at the end of the file

Thanks for help

Regards,
Klaus












grammar CIF1_1;

options{
language=Java;
}

@lexer::header{
package at.netcrystals.cif_1_1.parser;
}

@parser::header{
package at.netcrystals.cif_1_1.parser;
}


DATA
     :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
     ;

LOOP
     :
     (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
     ;

fragment ORDINARYCHAR
     :     '!' | '%' | '&' | '(' | ')' | '*' | '+' | ',' | '-' | '.' | 
'/' | '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' | ':' | 
'<' | '=' | '>' | '?' | '@' | 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G' | 
'H' | 'I' | 'J' | 'K' | 'L' | 'M' | 'N' | 'O' | 'P' | 'Q' | 'R' | 'S' | 
'T' | 'U' | 'V' | 'W' | 'X' | 'Y' | 'Z' | '\\' | '^' | '\`' | 'a' | 'b' 
| 'c' | 'd' | 'e' | 'f' | 'g' | 'h' | 'i' | 'j' | 'k' | 'l' | 'm' | 'n' 
| 'o' | 'p' | 'q' | 'r' | 's' | 't' | 'u' | 'v' | 'w' | 'x' | 'y' | 'z' 
| '{' | '|' | '}' | '~'
     ;


NONBLANCKCHAR
     :    ORDINARYCHAR | '"' | '#' | '$' | '\'' | '_' | ';' | '[' | ']'
     ;



WHITESPACE
     :    '\t'|' '
     ;


/************************************************************************************************
     WhiteSpace and Comments
************************************************************************************************/






EOL
     :'\n'|'\r\n'
     ;






/************************************************************************************************
*
* Root
*
************************************************************************************************/

cif
     :      (dataBlock)   EOF
     ;

dataBlock
     :    (dataBlockHeading dataItems)
     ;

dataBlockHeading
     :    (DATA NONBLANCKCHAR+ EOL)
     ;


dataItems
     :    dataItem* EOL
     ;

dataItem
     :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
     ;

tag
     :    NONBLANCKCHAR+
     ;


value
     :    '.' | '?' | charString
     ;

charString
     :    singleQuotedString
     ;

singleQuotedString
     :    '\'' NONBLANCKCHAR* '\''
     ;

loopHeader
     :    ( (WHITESPACE tag)+)
     ;

loopBody
     :    value (WHITESPACE value)+
     ;





From jhking at airmail.net  Fri Jul  9 12:25:31 2010
From: jhking at airmail.net (Jason H King)
Date: Fri, 9 Jul 2010 12:25:31 -0700
Subject: [antlr-interest] ANTLR Basic Question
Message-ID: <20100709122531.AF9535CC@resin18.mta.everyone.net>

Ah, one a fellow near-clueless user can help with.
You might want to follow the example here:
http://www.antlr.org/wiki/pages/viewpage.action?pageId=1782
and implement a case-insensitive file stream.
That should make your rules more straightforward, then you have rules like
DATA : DATA_ ;
LOOP : LOOP_ ;

--- klausmartinschitz at gmail.com wrote:

From: Klaus Martinschitz <klausmartinschitz at gmail.com>
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR Basic Question
Date: Fri, 09 Jul 2010 21:10:55 +0200

  Hi ANTLR Gurus,

A beginner's question.
I want to write a compiler for Crystallographic Information File Format 
' (CIF). I don't want to explain the syntax in detail only the problem I 
have to face with.

The data starts with a token

'data_'

followed by arbitrary characters and an EOL, e.g.

data_global
.

There is also a token

'loop_';

Somewehere in my BNF I write something like

DATA
     :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
     ;

LOOP
     :
     (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
     ;

dataBlockHeading
     :    (DATA NONBLANCKCHAR+ EOL)
     ;

dataItem
     :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
     ;

The first two expressions are tokens the second are rules. My problem is 
following. The file starts with

data_global

BUT the *lo* of data_g*lo*bal is parsed from the LOOP token. How can 
this be if the parser is in the dataBlockHeadingrule? The parser must 
know that the characters *lo* belong to NONBLANCKCHAR and not to LOOP,
or?

I have attached the whole syntax at the end of the file

Thanks for help

Regards,
Klaus












grammar CIF1_1;

options{
language=Java;
}

@lexer::header{
package at.netcrystals.cif_1_1.parser;
}

@parser::header{
package at.netcrystals.cif_1_1.parser;
}


DATA
     :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
     ;

LOOP
     :
     (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
     ;

fragment ORDINARYCHAR
     :     '!' | '%' | '&' | '(' | ')' | '*' | '+' | ',' | '-' | '.' | 
'/' | '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' | ':' | 
'<' | '=' | '>' | '?' | '@' | 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G' | 
'H' | 'I' | 'J' | 'K' | 'L' | 'M' | 'N' | 'O' | 'P' | 'Q' | 'R' | 'S' | 
'T' | 'U' | 'V' | 'W' | 'X' | 'Y' | 'Z' | '\\' | '^' | '\`' | 'a' | 'b' 
| 'c' | 'd' | 'e' | 'f' | 'g' | 'h' | 'i' | 'j' | 'k' | 'l' | 'm' | 'n' 
| 'o' | 'p' | 'q' | 'r' | 's' | 't' | 'u' | 'v' | 'w' | 'x' | 'y' | 'z' 
| '{' | '|' | '}' | '~'
     ;


NONBLANCKCHAR
     :    ORDINARYCHAR | '"' | '#' | '$' | '\'' | '_' | ';' | '[' | ']'
     ;



WHITESPACE
     :    '\t'|' '
     ;


/************************************************************************************************
     WhiteSpace and Comments
************************************************************************************************/






EOL
     :'\n'|'\r\n'
     ;






/************************************************************************************************
*
* Root
*
************************************************************************************************/

cif
     :      (dataBlock)   EOF
     ;

dataBlock
     :    (dataBlockHeading dataItems)
     ;

dataBlockHeading
     :    (DATA NONBLANCKCHAR+ EOL)
     ;


dataItems
     :    dataItem* EOL
     ;

dataItem
     :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
     ;

tag
     :    NONBLANCKCHAR+
     ;


value
     :    '.' | '?' | charString
     ;

charString
     :    singleQuotedString
     ;

singleQuotedString
     :    '\'' NONBLANCKCHAR* '\''
     ;

loopHeader
     :    ( (WHITESPACE tag)+)
     ;

loopBody
     :    value (WHITESPACE value)+
     ;





List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address



From cummings at kjchome.homeip.net  Fri Jul  9 14:03:58 2010
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Fri, 09 Jul 2010 17:03:58 -0400
Subject: [antlr-interest] ANTLR Basic Question
In-Reply-To: <4C37743F.6030602@gmail.com>
References: <4C37743F.6030602@gmail.com>
Message-ID: <4C378EBE.20306@kjchome.homeip.net>

On 07/09/2010 03:10 PM, Klaus Martinschitz wrote:
>   Hi ANTLR Gurus,
> 
> A beginner's question.
> I want to write a compiler for Crystallographic Information File Format 
> ' (CIF). I don't want to explain the syntax in detail only the problem I 
> have to face with.
> 
> The data starts with a token
> 
> 'data_'
> 
> followed by arbitrary characters and an EOL, e.g.
> 
> data_global

Just curious.  Are there a finite number of such tokens?  Or is
something like data_xyzzy legal?

> .
> 
> There is also a token
> 
> 'loop_';
> 
> Somewehere in my BNF I write something like
> 
> DATA
>      :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
>      ;
> 
> LOOP
>      :
>      (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
>      ;
> 
> dataBlockHeading
>      :    (DATA NONBLANCKCHAR+ EOL)
>      ;
> 
> dataItem
>      :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
>      ;
> 
> The first two expressions are tokens the second are rules. My problem is 
> following. The file starts with
> 
> data_global
> 
> BUT the *lo* of data_g*lo*bal is parsed from the LOOP token. How can 
> this be if the parser is in the dataBlockHeadingrule? The parser must 
> know that the characters *lo* belong to NONBLANCKCHAR and not to LOOP,
> or?

Please don't confuse lexing with parsing.  Lexing is the process of
converting the character stream to tokens.  Parsing is the process of
putting the tokens together.  Lexing happens independently of and out of
the context of the parser.  So, you should make sure that all of our
tokens are defined without regard to your parser rules.

Also, there may be some ordering problems with your lexer, in that rules
defined first might take precedence over rules defined later.  When this
happens to me, I usually use predicates to help my lexer out.
Often this leads to merging certain token rules and overriding the
resulting token types in certain circumstances.

In your case, can you lex the extra characters into your DATA_ token
(especially since there can be nothing following the DATA_ part except
more characters).  This might be problematic if anything can follow your
DATA_ tokens.

Finally, wildcards can cause no end of problems (especially to
beginners).  Use them only as a last resort.  Usually, they can be avoided.

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From rgildea at gmail.com  Fri Jul  9 14:48:44 2010
From: rgildea at gmail.com (Richard Gildea)
Date: Fri, 9 Jul 2010 22:48:44 +0100
Subject: [antlr-interest] ANTLR Basic Question
In-Reply-To: <4C37743F.6030602@gmail.com>
References: <4C37743F.6030602@gmail.com>
Message-ID: <AANLkTikIYMyGlZMdg87QwZzaaJXkxu0SGSVidm1jWjmb@mail.gmail.com>

Hi Klaus,

This is quite a coincidence, as I have recently written a CIF parser for the
cctbx (Computational Crystallograpy Toolbox) using ANTLR.  You can find a C
language version of an ANTLR CIF grammar here:

http://cctbx.svn.sourceforge.net/viewvc/cctbx/trunk/iotbx/cif/cif.g?view=markup

It is somewhat convoluted with building the CIF model during parsing, but
you should be able to strip away that and get a working CIF parser in your
chosen target language (it looks like you are wanting Java).

Thanks,

Richard


On 9 July 2010 20:10, Klaus Martinschitz <klausmartinschitz at gmail.com>wrote:

>  Hi ANTLR Gurus,
>
> A beginner's question.
> I want to write a compiler for Crystallographic Information File Format
> ' (CIF). I don't want to explain the syntax in detail only the problem I
> have to face with.
>
> The data starts with a token
>
> 'data_'
>
> followed by arbitrary characters and an EOL, e.g.
>
> data_global
> .
>
> There is also a token
>
> 'loop_';
>
> Somewehere in my BNF I write something like
>
> DATA
>     :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
>     ;
>
> LOOP
>     :
>     (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
>     ;
>
> dataBlockHeading
>     :    (DATA NONBLANCKCHAR+ EOL)
>     ;
>
> dataItem
>     :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
>     ;
>
> The first two expressions are tokens the second are rules. My problem is
> following. The file starts with
>
> data_global
>
> BUT the *lo* of data_g*lo*bal is parsed from the LOOP token. How can
> this be if the parser is in the dataBlockHeadingrule? The parser must
> know that the characters *lo* belong to NONBLANCKCHAR and not to LOOP,
> or?
>
> I have attached the whole syntax at the end of the file
>
> Thanks for help
>
> Regards,
> Klaus
>
>
>
>
>
>
>
>
>
>
>
>
> grammar CIF1_1;
>
> options{
> language=Java;
> }
>
> @lexer::header{
> package at.netcrystals.cif_1_1.parser;
> }
>
> @parser::header{
> package at.netcrystals.cif_1_1.parser;
> }
>
>
> DATA
>     :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
>     ;
>
> LOOP
>     :
>     (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
>     ;
>
> fragment ORDINARYCHAR
>     :     '!' | '%' | '&' | '(' | ')' | '*' | '+' | ',' | '-' | '.' |
> '/' | '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' | ':' |
> '<' | '=' | '>' | '?' | '@' | 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G' |
> 'H' | 'I' | 'J' | 'K' | 'L' | 'M' | 'N' | 'O' | 'P' | 'Q' | 'R' | 'S' |
> 'T' | 'U' | 'V' | 'W' | 'X' | 'Y' | 'Z' | '\\' | '^' | '\`' | 'a' | 'b'
> | 'c' | 'd' | 'e' | 'f' | 'g' | 'h' | 'i' | 'j' | 'k' | 'l' | 'm' | 'n'
> | 'o' | 'p' | 'q' | 'r' | 's' | 't' | 'u' | 'v' | 'w' | 'x' | 'y' | 'z'
> | '{' | '|' | '}' | '~'
>     ;
>
>
> NONBLANCKCHAR
>     :    ORDINARYCHAR | '"' | '#' | '$' | '\'' | '_' | ';' | '[' | ']'
>     ;
>
>
>
> WHITESPACE
>     :    '\t'|' '
>     ;
>
>
>
> /************************************************************************************************
>     WhiteSpace and Comments
>
> ************************************************************************************************/
>
>
>
>
>
>
> EOL
>     :'\n'|'\r\n'
>     ;
>
>
>
>
>
>
>
> /************************************************************************************************
> *
> * Root
> *
>
> ************************************************************************************************/
>
> cif
>     :      (dataBlock)   EOF
>     ;
>
> dataBlock
>     :    (dataBlockHeading dataItems)
>     ;
>
> dataBlockHeading
>     :    (DATA NONBLANCKCHAR+ EOL)
>     ;
>
>
> dataItems
>     :    dataItem* EOL
>     ;
>
> dataItem
>     :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
>     ;
>
> tag
>     :    NONBLANCKCHAR+
>     ;
>
>
> value
>     :    '.' | '?' | charString
>     ;
>
> charString
>     :    singleQuotedString
>     ;
>
> singleQuotedString
>     :    '\'' NONBLANCKCHAR* '\''
>     ;
>
> loopHeader
>     :    ( (WHITESPACE tag)+)
>     ;
>
> loopBody
>     :    value (WHITESPACE value)+
>     ;
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jimi at temporal-wave.com  Fri Jul  9 15:00:20 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 09 Jul 2010 15:00:20 -0700
Subject: [antlr-interest] ANTLR Basic Question
In-Reply-To: <4C37743F.6030602@gmail.com>
Message-ID: <bce41071819f3c488306f7ba248ae58b@temporal-wave.com>

First add a catch all to your lexer as the last rule:

ANY : . { skip(); /* or error */ } ;

Then change your NONBLOCKING to:

CHARSEQ : ('a'..'z')+ /* or whatever it is */

And put this rule after the keywords.

If that fails then add a predicate.

Jim



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Klaus Martinschitz
> Sent: Friday, July 09, 2010 12:11 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] ANTLR Basic Question
> 
>   Hi ANTLR Gurus,
> 
> A beginner's question.
> I want to write a compiler for Crystallographic Information File Format
> ' (CIF). I don't want to explain the syntax in detail only the problem
> I
> have to face with.
> 
> The data starts with a token
> 
> 'data_'
> 
> followed by arbitrary characters and an EOL, e.g.
> 
> data_global
> .
> 
> There is also a token
> 
> 'loop_';
> 
> Somewehere in my BNF I write something like
> 
> DATA
>      :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
>      ;
> 
> LOOP
>      :
>      (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
>      ;
> 
> dataBlockHeading
>      :    (DATA NONBLANCKCHAR+ EOL)
>      ;
> 
> dataItem
>      :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
>      ;
> 
> The first two expressions are tokens the second are rules. My problem
> is
> following. The file starts with
> 
> data_global
> 
> BUT the *lo* of data_g*lo*bal is parsed from the LOOP token. How can
> this be if the parser is in the dataBlockHeadingrule? The parser must
> know that the characters *lo* belong to NONBLANCKCHAR and not to LOOP,
> or?
> 
> I have attached the whole syntax at the end of the file
> 
> Thanks for help
> 
> Regards,
> Klaus
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> grammar CIF1_1;
> 
> options{
> language=Java;
> }
> 
> @lexer::header{
> package at.netcrystals.cif_1_1.parser;
> }
> 
> @parser::header{
> package at.netcrystals.cif_1_1.parser;
> }
> 
> 
> DATA
>      :(('d'|'D')('a'|'A')('t'|'T')('a'|'A')'_')
>      ;
> 
> LOOP
>      :
>      (('l'|'L')('o'|'O')('o'|'O')('p'|'P')'_')
>      ;
> 
> fragment ORDINARYCHAR
>      :     '!' | '%' | '&' | '(' | ')' | '*' | '+' | ',' | '-' | '.' |
> '/' | '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' | ':' |
> '<' | '=' | '>' | '?' | '@' | 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G' |
> 'H' | 'I' | 'J' | 'K' | 'L' | 'M' | 'N' | 'O' | 'P' | 'Q' | 'R' | 'S' |
> 'T' | 'U' | 'V' | 'W' | 'X' | 'Y' | 'Z' | '\\' | '^' | '\`' | 'a' | 'b'
> | 'c' | 'd' | 'e' | 'f' | 'g' | 'h' | 'i' | 'j' | 'k' | 'l' | 'm' | 'n'
> | 'o' | 'p' | 'q' | 'r' | 's' | 't' | 'u' | 'v' | 'w' | 'x' | 'y' | 'z'
> | '{' | '|' | '}' | '~'
>      ;
> 
> 
> NONBLANCKCHAR
>      :    ORDINARYCHAR | '"' | '#' | '$' | '\'' | '_' | ';' | '[' | ']'
>      ;
> 
> 
> 
> WHITESPACE
>      :    '\t'|' '
>      ;
> 
> 
> /**********************************************************************
> **************************
>      WhiteSpace and Comments
> ***********************************************************************
> *************************/
> 
> 
> 
> 
> 
> 
> EOL
>      :'\n'|'\r\n'
>      ;
> 
> 
> 
> 
> 
> 
> /**********************************************************************
> **************************
> *
> * Root
> *
> ***********************************************************************
> *************************/
> 
> cif
>      :      (dataBlock)   EOF
>      ;
> 
> dataBlock
>      :    (dataBlockHeading dataItems)
>      ;
> 
> dataBlockHeading
>      :    (DATA NONBLANCKCHAR+ EOL)
>      ;
> 
> 
> dataItems
>      :    dataItem* EOL
>      ;
> 
> dataItem
>      :    (tag WHITESPACE value) | (LOOP loopHeader loopBody)
>      ;
> 
> tag
>      :    NONBLANCKCHAR+
>      ;
> 
> 
> value
>      :    '.' | '?' | charString
>      ;
> 
> charString
>      :    singleQuotedString
>      ;
> 
> singleQuotedString
>      :    '\'' NONBLANCKCHAR* '\''
>      ;
> 
> loopHeader
>      :    ( (WHITESPACE tag)+)
>      ;
> 
> loopBody
>      :    value (WHITESPACE value)+
>      ;
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From ramanand_mandayam at yahoo.com  Sat Jul 10 00:41:03 2010
From: ramanand_mandayam at yahoo.com (Ramanand Mandayam)
Date: Sat, 10 Jul 2010 00:41:03 -0700 (PDT)
Subject: [antlr-interest] Syntax errors (masked by -diagnostic option)
Message-ID: <564875.49909.qm@web33501.mail.mud.yahoo.com>

Hi

I am using antlr-3.2.jar obtained from the antlr.org website and am trying to 
process a lexical grammar as follows:
    > java -cp /usr/local/antlr/antlr-3.2.jar antlr.Tool -o . Vlogpp_bug.g

I get the following error: 
    Vlogpp_bug.g:23:2: Syntax error in action: Vlogpp_bug.g:23:2: unexpected 
char: '$'

However when I use the -diagnostic option then I do not see a syntax error but a 
few warnings:
    > java -cp /usr/local/antlr/antlr-3.2.jar antlr.Tool -o . -diagnostic 
Vlogpp_bug.g 


    ANTLR Parser Generator   Version 2.7.7 (20060906)   1989-2005
    Generating vlg_Lexer.txt
    Vlogpp_bug.g:23: warning:lexical nondeterminism upon
    Vlogpp_bug.g:23:     k==1:'*'
    Vlogpp_bug.g:23:     k==2:'/'
    Vlogpp_bug.g:23:     between alt 1 and exit branch of block
    Generating vlg_LexerTokenTypes.txt
    Generating vlg_LexerTokenTypes.txt

Any help would be appreciated.

Cheers

Ramanand Mandayam
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Vlogpp_bug.g
Type: application/octet-stream
Size: 502 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20100710/3d950851/attachment.obj 

From martijn.reuvers at gmail.com  Sat Jul 10 01:32:52 2010
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Sat, 10 Jul 2010 10:32:52 +0200
Subject: [antlr-interest] Determine / check validity of type
In-Reply-To: <8dc3764b928dad4d84b95750a79d2416@temporal-wave.com>
References: <AANLkTikCJUpJRzmuZ-p1Av8CDBJX98R_d2CnlyMPYpC8@mail.gmail.com>
	<8dc3764b928dad4d84b95750a79d2416@temporal-wave.com>
Message-ID: <AANLkTin_1bivibnYfeUt8jgSf1sauJB0kjNmCnVh9TYn@mail.gmail.com>

Thank you both (Mark & Jim), sounds like I have something to do once more. =)

On Fri, Jul 9, 2010 at 6:52 PM, Jim Idle <jimi at temporal-wave.com> wrote:
> First of all you need to produce an AST, then a tree walking grammar. In each rule of an expression you return a type such that the expression itself returns a type. An operator then invokes a function with the operation and the types of the arguments, which then issues an error message and returns a type to propagate (which is the result of the operation or an error). Future checks do not issue error messages if any of the operands are the error type (so you do not get myriad errors cascading), but return the error type.
>
> When a function is declared (or built-in declared) the arguments are typed, you make the same check as for operators and the return type of the expression is the return type of the function as declared.
>
> There is quite a bit of work involved but it is very orthogonal and so not difficult when you see the pattern.
>
> Jim
>
>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Martijn Reuvers
>> Sent: Friday, July 09, 2010 2:20 AM
>> To: antlr ANTLR
>> Subject: [antlr-interest] Determine / check validity of type
>>
>> Hello everyone,
>>
>> I have a question related to determining the type returned from an
>> expression on 'compile' time (not runtime!).
>>
>> For example take the following code:
>>
>> ***************************
>>
>> function someFunction(int a) return string {
>> ? return "a string!"
>> }
>>
>> int finalValue = (100+5)*2 + someFunction("a"+someFunction(1))
>>
>> // Note the errors, we do not allow adding a text to an int, and the
>> function invoke contains an expression returning a string (should be
>> an int), but expression itself is ok.
>>
>> ***************************
>>
>> Assume the code is parsed and transformed to an AST without error. We
>> are walking the tree and walk the variable 'finalValue', and see the
>> value must be of type 'int'. Tree would look something like:
>>
>> ? ? ? ? ?var_assignment
>> ? ?/ ? ? ? ? ? ? ? ? ? ? ? ? ? ?\
>> finalValue(type=int) ? ? expression
>>
>>
>> Where would you determine the first error? While evaluating the +
>> (between left-side exp and someFunction()) and log an error there?
>>
>> The second error I find harder, the invoke of: someFunction(..) .
>>
>> Looking up the MethodSymbol for it will tell the formal parameter
>> exptected is an int, but how now to determine that the expression
>> given is actually returning an int? Would you walk the entire
>> parameter: expression (in this case) "a"+someFunction(1) ? But as said
>> before we cannot execute the code.
>>
>> Anyone having an idea on how to do this in a flexible (and hopefully
>> not too difficult) way?
>>
>> Thanks a lot for thinking along!
>>
>> Martijn
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From a.moderacja at gmail.com  Sun Jul 11 09:58:56 2010
From: a.moderacja at gmail.com (Borneq)
Date: Sun, 11 Jul 2010 18:58:56 +0200
Subject: [antlr-interest] Where can I find package antlr ?
Message-ID: <AANLkTikK7uwlZA-CBtDCpciJKw2ixyMtloQ9wvdx7oUd@mail.gmail.com>

I use sources from antlr-3.2.tar.gz and stringtemplate-3.2.tar.gz
In archive stringtemplate-3.2.tar.gz in file
stringtemplate-3.2\src\org\antlr\stringtemplate\language\ActionEvaluator.java
need to import:
import antlr.TreeParser;
import antlr.Token;
import antlr.collections.AST;
import antlr.RecognitionException;
import antlr.ANTLRException;
import antlr.NoViableAltException;
import antlr.MismatchedTokenException;
import antlr.SemanticException;
import antlr.collections.impl.BitSet;
import antlr.ASTPair;
import antlr.collections.impl.ASTArray;

Nowhere I can find this package

From dinesha74 at yahoo.com  Sun Jul 11 19:22:57 2010
From: dinesha74 at yahoo.com (Dinesha Balasuriya Weragama)
Date: Sun, 11 Jul 2010 19:22:57 -0700 (PDT)
Subject: [antlr-interest] using ANTLR and MySQL in C target
Message-ID: <191127.37544.qm@web33207.mail.mud.yahoo.com>

I am trying to build an ANTLR grammar using the C target.? I want to store some data from the grammar into a MySQL database.? However, when I include both the mysql and antlr C target runtime libraries in my project, I get the following errors.

gcc -IC:\xampp\xampp\mysql\include -IC:\AntlrC\include -O0 -g3 -Wall -c -fmessage-length=0 -osrc\AddParser.o ..\src\AddParser.c
In file included from C:/AntlrC/include/antlr3.h:33,
???????????????? from ..\src\AddParser.h:67,
???????????????? from ..\src\AddParser.c:45:
C:/AntlrC/include/antlr3defs.h:211: warning: ignoring #pragma warning 
In file included from ..\src\AddParser.c:45:
..\src\AddParser.h:99: warning: ignoring #pragma warning 
..\src\AddParser.h:100: warning: ignoring #pragma warning 
..\src\AddParser.h:101: warning: ignoring #pragma warning 
..\src\AddParser.h:102: warning: ignoring #pragma warning 
..\src\AddParser.h:103: warning: ignoring #pragma warning 
..\src\AddParser.h:104: warning: ignoring #pragma warning 
..\src\AddParser.c:205: warning: 'freeScope' defined but not used
..\src\AddParser.c:321: warning: 'getTokenNames' defined but not used
gcc -IC:\xampp\xampp\mysql\include -IC:\AntlrC\include -O0 -g3 -Wall -c -fmessage-length=0 -osrc\Test.o ..\src\Test.c
In file included from C:/xampp/xampp/mysql/include/my_global.h:72,
???????????????? from ..\src\Test.h:14,
???????????????? from ..\src\Test.c:8:
C:/xampp/xampp/mysql/include/config-win.h:203:1: warning: "finite" redefined
C:/xampp/xampp/mysql/include/config-win.h:161:1: warning: this is the location of the previous definition
In file included from ..\src\Test.h:14,
???????????????? from ..\src\Test.c:8:
C:/xampp/xampp/mysql/include/my_global.h:605:1: warning: "my_reinterpret_cast" redefined
In file included from C:/xampp/xampp/mysql/include/my_global.h:72,
???????????????? from ..\src\Test.h:14,
???????????????? from ..\src\Test.c:8:
C:/xampp/xampp/mysql/include/config-win.h:307:1: warning: this is the location of the previous definition
In file included from ..\src\Test.h:14,
???????????????? from ..\src\Test.c:8:
C:/xampp/xampp/mysql/include/my_global.h:1570: warning: static declaration of 'rint' follows non-static declaration
In file included from C:/AntlrC/include/antlr3.h:33,
???????????????? from ..\src\AddLexer.h:71,
???????????????? from ..\src\Test.h:17,
???????????????? from ..\src\Test.c:8:
C:/AntlrC/include/antlr3defs.h:211: warning: ignoring #pragma warning 
In file included from C:/AntlrC/include/antlr3tokenstream.h:44,
???????????????? from C:/AntlrC/include/antlr3baserecognizer.h:42,
???????????????? from C:/AntlrC/include/antlr3cyclicdfa.h:38,
???????????????? from C:/AntlrC/include/antlr3.h:40,
???????????????? from ..\src\AddLexer.h:71,
???????????????? from ..\src\Test.h:17,
???????????????? from ..\src\Test.c:8:
C:/AntlrC/include/antlr3debugeventlistener.h:76: warning: declaration does not declare anything
C:/AntlrC/include/antlr3debugeventlistener.h:76: warning: no semicolon at end of struct or union
C:/AntlrC/include/antlr3debugeventlistener.h:76: error: syntax error before numeric constant
C:/AntlrC/include/antlr3debugeventlistener.h:165: error: 'rewind' redeclared as different kind of symbol
C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdio.h:420: error: previous declaration of 'rewind' was here
C:/AntlrC/include/antlr3debugeventlistener.h:165: error: 'rewind' redeclared as different kind of symbol
C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdio.h:420: error: previous declaration of 'rewind' was here
C:/AntlrC/include/antlr3debugeventlistener.h:388: error: 'free' redeclared as different kind of symbol
C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdlib.h:366: error: previous declaration of 'free' was here
C:/AntlrC/include/antlr3debugeventlistener.h:388: error: 'free' redeclared as different kind of symbol
C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdlib.h:366: error: previous declaration of 'free' was here
C:/AntlrC/include/antlr3debugeventlistener.h:390: error: syntax error before '}' token
C:/AntlrC/include/antlr3debugeventlistener.h:391: warning: type defaults to `int' in declaration of `ANTLR3_DEBUG_EVENT_LISTENER'
C:/AntlrC/include/antlr3debugeventlistener.h:391: warning: data definition has no type or storage class
In file included from ..\src\Test.h:17,
???????????????? from ..\src\Test.c:8:
..\src\AddLexer.h:103: warning: ignoring #pragma warning 
..\src\AddLexer.h:104: warning: ignoring #pragma warning 
..\src\AddLexer.h:105: warning: ignoring #pragma warning 
..\src\AddLexer.h:106: warning: ignoring #pragma warning 
..\src\AddLexer.h:107: warning: ignoring #pragma warning 
..\src\AddLexer.h:108: warning: ignoring #pragma warning 
In file included from ..\src\Test.h:18,
???????????????? from ..\src\Test.c:8:
..\src\AddParser.h:99: warning: ignoring #pragma warning 
..\src\AddParser.h:100: warning: ignoring #pragma warning 
..\src\AddParser.h:101: warning: ignoring #pragma warning 
..\src\AddParser.h:102: warning: ignoring #pragma warning 
..\src\AddParser.h:103: warning: ignoring #pragma warning 
..\src\AddParser.h:104: warning: ignoring #pragma warning 

I have used the MySQL library and the ANTLR C runtime library separately with the relevant sections of the same program and have no trouble then.? Please let me know if anyone has used these two libraries together and if so, how you can overcome the above redeclaration errors.

Thank you



      

From jeanchristophe.bach at inria.fr  Mon Jul 12 00:57:01 2010
From: jeanchristophe.bach at inria.fr (Jean-Christophe Bach)
Date: Mon, 12 Jul 2010 09:57:01 +0200
Subject: [antlr-interest] Tree construction with island grammar
Message-ID: <20100712075701.GB4259@adel.loria.fr>

Hi list,

I finally succeeded in posting to the list. I paste here mails I wanted to send
last week :

First mail/question :

? Hi all,

I'm trying to use antlr but I have a problem.  I have several grammars which
seem to work well independently. Now, I am trying to make them working together
: I have a host language (let's say Java, but it could be any other language)
which I parse with my HostLanguageParser and when I find specific constructions,
I would like to call the appropriate parser.

I have looked at the island-grammar example and it seems to be what I am looking
for. I tried to implement it, and it is almost ok : the parsers are called, but
I have a problem when I build the tree. I found a temporary solution with a
global variable, but I do not like it. I paste a part of my prototype with the
"solution" :

grammar HostLanguage;

options {
  backtrack=true;
  output=AST;
  ASTLabelType=Tree;
  tokenVocab=HostTokens;
}
...
@parser::member{
  public static Tree intermediateResult; // :\
}
...
<few rules>
...
sublanguageRule : BACKQUOTE -> ^({intermediateResult})

BACKQUOTE : '`('
{
  SubLanguage2Lexer lexer = new SubLanguage2Lexer(input);
  CommonTokenStream tokens = new CommonTokenStream(lexer);
  SubLanguage2Parser parser = new SubLanguage2Parser(tokens);
  SubLanguage2Parser.subLanguage2Construct_return res =
parser.subLanguage2Construct();
  HostLanguageParser.intermediateResult = (Tree)res.getTree();
}
...
(I also wrote other grammar files for my "sub-languages")

It seemed to work with a very simple example but after few tests, I saw that not
only this solution does not satisfy me, but it does not work very well : indeed,
if there are many subLanguage2 constructs, the produced tree is totally wrong.
For instance, with an example containing something like that :
...
`(foo)
`(bar)
...
my tree contains two backquote nodes with "bar" instead of a node with "foo" and
a node with "bar".

My question is : is there any simple method to build a tree with island grammars
? What would you do to obtain a tree like that :

(Program (HostBlock ...) ... (SubLanguage2Block <tree produced by my 2nd parser>) ... )

Thanks in advance,

JC ?

And my second mail :

? Hi,

> My question is : is there any simple method to build a tree with
> island grammars
> ? What would you do to obtain a tree like that :
> (Program (HostBlock ...) ... (SubLanguage2Block <tree produced by my 2nd  parser>) ... )

I have an idea, but I am not sure : I could use a custom token
(http://www.antlr.org/wiki/pages/viewpage.action?pageId=1844) with a custom
field which would be a tree. And then, I could construct my tree like that :
b=BACKQUOTE -> ^(b.myTree)
Do you think that this solution could work/is correct ?

JC ?

I used this solution, and my prototype seem to work well. But is it a good
practice ?  Is there any other better solution ?

Thanks in advance,

JC


From ron.hunter-duvar at oracle.com  Mon Jul 12 08:17:04 2010
From: ron.hunter-duvar at oracle.com (Ron Hunter-Duvar)
Date: Mon, 12 Jul 2010 09:17:04 -0600
Subject: [antlr-interest] Where can I find package antlr ?
In-Reply-To: <AANLkTikK7uwlZA-CBtDCpciJKw2ixyMtloQ9wvdx7oUd@mail.gmail.com>
References: <AANLkTikK7uwlZA-CBtDCpciJKw2ixyMtloQ9wvdx7oUd@mail.gmail.com>
Message-ID: <4C3B31F0.7080503@oracle.com>

The classes in package antlr (as opposed to org.antlr) are from Antlr 
2.7.7, which was used to develop Antlr 3.2 (and perhaps StringTemplate 
too, I'm not sure). You need to have the Antlr 2.7.7 jar to compile 
Antlr 3.2. If you're using Maven and have it set up properly, it should 
get that dependency for you automatically. But there is a bug in the 
Antlr POM that causes problems (I understand from previous emails that 
it's fixed in the latest development version, but not in the latest 
released source package).

Ron


Borneq wrote:
> I use sources from antlr-3.2.tar.gz and stringtemplate-3.2.tar.gz
> In archive stringtemplate-3.2.tar.gz in file
> stringtemplate-3.2\src\org\antlr\stringtemplate\language\ActionEvaluator.java
> need to import:
> import antlr.TreeParser;
> import antlr.Token;
> import antlr.collections.AST;
> import antlr.RecognitionException;
> import antlr.ANTLRException;
> import antlr.NoViableAltException;
> import antlr.MismatchedTokenException;
> import antlr.SemanticException;
> import antlr.collections.impl.BitSet;
> import antlr.ASTPair;
> import antlr.collections.impl.ASTArray;
>
> Nowhere I can find this package
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>   

-- 
Ron Hunter-Duvar | Software Developer V | 403-272-6580
Oracle Service Engineering
Gulf Canada Square 401 - 9th Avenue S.W., Calgary, AB, Canada T2P 3C5

All opinions expressed here are mine, and do not necessarily represent
those of my employer.


From jimi at temporal-wave.com  Mon Jul 12 10:36:05 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 12 Jul 2010 10:36:05 -0700
Subject: [antlr-interest] using ANTLR and MySQL in C target
In-Reply-To: <191127.37544.qm@web33207.mail.mud.yahoo.com>
Message-ID: <fd9c828b473b974d85a7cfec2e59b876@temporal-wave.com>

The MySql headers do a lot of strange things such as #define free - it probably means that you are trying to lump everything together and include all the headers everywhere. Try splitting this out in to a supporting translation unit and just including what you need. For instance, just pass a pointer to the token text and its length and don't including the antlr headers.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Dinesha Balasuriya Weragama
> Sent: Sunday, July 11, 2010 7:23 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] using ANTLR and MySQL in C target
> 
> I am trying to build an ANTLR grammar using the C target.? I want to
> store some data from the grammar into a MySQL database.? However, when
> I include both the mysql and antlr C target runtime libraries in my
> project, I get the following errors.
> 
> gcc -IC:\xampp\xampp\mysql\include -IC:\AntlrC\include -O0 -g3 -Wall -c
> -fmessage-length=0 -osrc\AddParser.o ..\src\AddParser.c
> In file included from C:/AntlrC/include/antlr3.h:33,
> ???????????????? from ..\src\AddParser.h:67,
> ???????????????? from ..\src\AddParser.c:45:
> C:/AntlrC/include/antlr3defs.h:211: warning: ignoring #pragma warning
> In file included from ..\src\AddParser.c:45:
> ..\src\AddParser.h:99: warning: ignoring #pragma warning
> ..\src\AddParser.h:100: warning: ignoring #pragma warning
> ..\src\AddParser.h:101: warning: ignoring #pragma warning
> ..\src\AddParser.h:102: warning: ignoring #pragma warning
> ..\src\AddParser.h:103: warning: ignoring #pragma warning
> ..\src\AddParser.h:104: warning: ignoring #pragma warning
> ..\src\AddParser.c:205: warning: 'freeScope' defined but not used
> ..\src\AddParser.c:321: warning: 'getTokenNames' defined but not used
> gcc -IC:\xampp\xampp\mysql\include -IC:\AntlrC\include -O0 -g3 -Wall -c
> -fmessage-length=0 -osrc\Test.o ..\src\Test.c
> In file included from C:/xampp/xampp/mysql/include/my_global.h:72,
> ???????????????? from ..\src\Test.h:14,
> ???????????????? from ..\src\Test.c:8:
> C:/xampp/xampp/mysql/include/config-win.h:203:1: warning: "finite"
> redefined
> C:/xampp/xampp/mysql/include/config-win.h:161:1: warning: this is the
> location of the previous definition
> In file included from ..\src\Test.h:14,
> ???????????????? from ..\src\Test.c:8:
> C:/xampp/xampp/mysql/include/my_global.h:605:1: warning:
> "my_reinterpret_cast" redefined
> In file included from C:/xampp/xampp/mysql/include/my_global.h:72,
> ???????????????? from ..\src\Test.h:14,
> ???????????????? from ..\src\Test.c:8:
> C:/xampp/xampp/mysql/include/config-win.h:307:1: warning: this is the
> location of the previous definition
> In file included from ..\src\Test.h:14,
> ???????????????? from ..\src\Test.c:8:
> C:/xampp/xampp/mysql/include/my_global.h:1570: warning: static
> declaration of 'rint' follows non-static declaration
> In file included from C:/AntlrC/include/antlr3.h:33,
> ???????????????? from ..\src\AddLexer.h:71,
> ???????????????? from ..\src\Test.h:17,
> ???????????????? from ..\src\Test.c:8:
> C:/AntlrC/include/antlr3defs.h:211: warning: ignoring #pragma warning
> In file included from C:/AntlrC/include/antlr3tokenstream.h:44,
> ???????????????? from C:/AntlrC/include/antlr3baserecognizer.h:42,
> ???????????????? from C:/AntlrC/include/antlr3cyclicdfa.h:38,
> ???????????????? from C:/AntlrC/include/antlr3.h:40,
> ???????????????? from ..\src\AddLexer.h:71,
> ???????????????? from ..\src\Test.h:17,
> ???????????????? from ..\src\Test.c:8:
> C:/AntlrC/include/antlr3debugeventlistener.h:76: warning: declaration
> does not declare anything
> C:/AntlrC/include/antlr3debugeventlistener.h:76: warning: no semicolon
> at end of struct or union
> C:/AntlrC/include/antlr3debugeventlistener.h:76: error: syntax error
> before numeric constant
> C:/AntlrC/include/antlr3debugeventlistener.h:165: error: 'rewind'
> redeclared as different kind of symbol
> C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdio.h:420:
> error: previous declaration of 'rewind' was here
> C:/AntlrC/include/antlr3debugeventlistener.h:165: error: 'rewind'
> redeclared as different kind of symbol
> C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdio.h:420:
> error: previous declaration of 'rewind' was here
> C:/AntlrC/include/antlr3debugeventlistener.h:388: error: 'free'
> redeclared as different kind of symbol
> C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdlib.h:366:
> error: previous declaration of 'free' was here
> C:/AntlrC/include/antlr3debugeventlistener.h:388: error: 'free'
> redeclared as different kind of symbol
> C:/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/stdlib.h:366:
> error: previous declaration of 'free' was here
> C:/AntlrC/include/antlr3debugeventlistener.h:390: error: syntax error
> before '}' token
> C:/AntlrC/include/antlr3debugeventlistener.h:391: warning: type
> defaults to `int' in declaration of `ANTLR3_DEBUG_EVENT_LISTENER'
> C:/AntlrC/include/antlr3debugeventlistener.h:391: warning: data
> definition has no type or storage class
> In file included from ..\src\Test.h:17,
> ???????????????? from ..\src\Test.c:8:
> ..\src\AddLexer.h:103: warning: ignoring #pragma warning
> ..\src\AddLexer.h:104: warning: ignoring #pragma warning
> ..\src\AddLexer.h:105: warning: ignoring #pragma warning
> ..\src\AddLexer.h:106: warning: ignoring #pragma warning
> ..\src\AddLexer.h:107: warning: ignoring #pragma warning
> ..\src\AddLexer.h:108: warning: ignoring #pragma warning
> In file included from ..\src\Test.h:18,
> ???????????????? from ..\src\Test.c:8:
> ..\src\AddParser.h:99: warning: ignoring #pragma warning
> ..\src\AddParser.h:100: warning: ignoring #pragma warning
> ..\src\AddParser.h:101: warning: ignoring #pragma warning
> ..\src\AddParser.h:102: warning: ignoring #pragma warning
> ..\src\AddParser.h:103: warning: ignoring #pragma warning
> ..\src\AddParser.h:104: warning: ignoring #pragma warning
> 
> I have used the MySQL library and the ANTLR C runtime library
> separately with the relevant sections of the same program and have no
> trouble then.? Please let me know if anyone has used these two
> libraries together and if so, how you can overcome the above
> redeclaration errors.
> 
> Thank you
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From a.moderacja at gmail.com  Mon Jul 12 11:30:28 2010
From: a.moderacja at gmail.com (Borneq)
Date: Mon, 12 Jul 2010 20:30:28 +0200
Subject: [antlr-interest] Error for class ANTLRInputStream
Message-ID: <AANLkTikJo_bi6SkCfDk2ykUuTPvWqEP-N6H6rDhTmox5@mail.gmail.com>

import org.antlr.runtime.*;

public class v3me {
	public static void main(String[] args) throws Exception {
		ANTLRFileStream fileStream = new ANTLRFileStream("ANTLR.g");
		ANTLRInputStream input = new ANTLRInputStream(System.in);
        }
}

I debug. can step over ANTLRFileStream but on ANTLRInputStream is
exception ClassNotFoundException.
I don;t know why can find one class and can't find second

From a.moderacja at gmail.com  Mon Jul 12 11:49:21 2010
From: a.moderacja at gmail.com (Borneq)
Date: Mon, 12 Jul 2010 20:49:21 +0200
Subject: [antlr-interest] Error for class ANTLRInputStream
In-Reply-To: <AANLkTikJo_bi6SkCfDk2ykUuTPvWqEP-N6H6rDhTmox5@mail.gmail.com>
References: <AANLkTikJo_bi6SkCfDk2ykUuTPvWqEP-N6H6rDhTmox5@mail.gmail.com>
Message-ID: <AANLkTimMYqonYBjLa9OiEWYmsXGqJ11_PwO5MQzhsnZz@mail.gmail.com>

> ? ? ? ? ? ? ? ?ANTLRInputStream input = new ANTLRInputStream(System.in);
>
> I debug. can step over ANTLRFileStream but on ANTLRInputStream is
> exception ClassNotFoundException.
> I don;t know why can find one class and can't find second
>

I think error is not ClassNotFoundException but read System.in ?

From eavraamsdonk at zonnet.nl  Mon Jul 12 12:26:49 2010
From: eavraamsdonk at zonnet.nl (eavraamsdonk at zonnet.nl)
Date: Mon, 12 Jul 2010 21:26:49 +0200
Subject: [antlr-interest] Future of the Python Code Generation Target
Message-ID: <20100712212649.6eoj5cqs8w8k0okw@webmail.versatel.nl>

Hi,

I was wondering if the Python Code Generation Target will still be 
supported for future Antlr versions.

 From a thread on this mailing list from June 2010, I understand that 
there is no Python Runtime for the latest 3.2 Antlr release.
The Antlr3PythonTarget wiki page has also not been updated for over a 
year (since before the 3.2 release). The Python Code Generation Target 
maintainer, Benjamin Niemann, has also not been posting to this 
mailinglist for over a year.

Does anyone have more information on the future of the Python Code 
Generation Target?

Thanks,
Ewoud van Raamsdonk

From rxin at berkeley.edu  Mon Jul 12 19:11:26 2010
From: rxin at berkeley.edu (Reynold Xin)
Date: Mon, 12 Jul 2010 22:11:26 -0400
Subject: [antlr-interest] Python target for nested braces handling (multiple
	alternatives)
Message-ID: <AANLkTil41i1gXlwNFZlKYYF0C7RIQQAfKj5a3vta_MXz@mail.gmail.com>

I have the following grammar file. When I was running it in Java using ANTLR
works, it compiles without any problem. However, when I was using the Python
target:

# java -cp antlr-3.1.2.jar org.antlr.Tool bibtex.g

It prompts the error:
warning(200): bibtex.g:42:35: Decision can match input such as "'{'" using
multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input


The grammar file is (I've labeled line 42 below). What's happening?


grammar bibtex;

options {
    language=Python;
}


/*------------------------------------------------------------------
 * Parser rules
 *------------------------------------------------------------------*/

bibtex_file
    :    bibtex_object*
    ;

bibtex_object
    :    '@' ID '{' (ID | LITERAL)? assignment_list '}'
    |   '@' ID '(' (ID | LITERAL)? assignment_list ')'
    ;

assignment_list
    :    assignment (',' assignment)*
    ;

assignment
    :    ID '=' value
    ;

value
    :    simple_value ('#' simple_value)*
    ;

simple_value
    :    ID
    |    LITERAL
    |   STRING
    |   value_braced
    ;

// matches {...} while allowing nested braces.
value_braced
    :   '{' ( value_braced | ~'}' )* '}'              *<--------------- this
is line 42*
    ;


/*------------------------------------------------------------------
 * Lexer rules
 *------------------------------------------------------------------*/

ID  :    ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
    ;

LITERAL
    :    ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'-'|'/')+
    ;

COMMENT
    :   '%%' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
    ;

WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        ) {$channel=HIDDEN;}
    ;

STRING
    :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
    ;

CHAR:  '\'' ( ESC_SEQ | ~('\''|'\\') ) '\''
    ;

fragment
HEX_DIGIT : ('0'..'9'|'a'..'f'|'A'..'F') ;

fragment
ESC_SEQ
    :   '\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
    |   UNICODE_ESC
    |   OCTAL_ESC
    ;

fragment
OCTAL_ESC
    :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7')
    ;

fragment
UNICODE_ESC
    :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
    ;

DO_NOT_DELETE_THIS_RULE
    :    '!' | '>' | '<' | '*' | '&' | '.' | ';'
    ;

--
Reynold Xin

From jbb at acm.org  Mon Jul 12 19:32:36 2010
From: jbb at acm.org (John B. Brodie)
Date: Mon, 12 Jul 2010 22:32:36 -0400
Subject: [antlr-interest] Python target for nested braces handling
 (multiple alternatives)
In-Reply-To: <AANLkTil41i1gXlwNFZlKYYF0C7RIQQAfKj5a3vta_MXz@mail.gmail.com>
References: <AANLkTil41i1gXlwNFZlKYYF0C7RIQQAfKj5a3vta_MXz@mail.gmail.com>
Message-ID: <1278988356.18474.5.camel@gecko.home.org>

On Mon, 2010-07-12 at 22:11 -0400, Reynold Xin wrote:
> I have the following grammar file. When I was running it in Java using ANTLR
> works, it compiles without any problem. However, when I was using the Python
> target:
>
> # java -cp antlr-3.1.2.jar org.antlr.Tool bibtex.g
> 
> It prompts the error:
> warning(200): bibtex.g:42:35: Decision can match input such as "'{'" using
> multiple alternatives: 1, 2
> As a result, alternative(s) 2 were disabled for that input

when i comment out your options{} block i get the very same error!

so this is NOT a java vs python issue (i believe), see below

> 
> 
> The grammar file is (I've labeled line 42 below). What's happening?
> 
> 
> grammar bibtex;
> 
> options {
>     language=Python;
> }
> 
> 
> /*------------------------------------------------------------------
>  * Parser rules
>  *------------------------------------------------------------------*/
> 
> bibtex_file
>     :    bibtex_object*
>     ;
> 
> bibtex_object
>     :    '@' ID '{' (ID | LITERAL)? assignment_list '}'
>     |   '@' ID '(' (ID | LITERAL)? assignment_list ')'
>     ;
> 
> assignment_list
>     :    assignment (',' assignment)*
>     ;
> 
> assignment
>     :    ID '=' value
>     ;
> 
> value
>     :    simple_value ('#' simple_value)*
>     ;
> 
> simple_value
>     :    ID
>     |    LITERAL
>     |   STRING
>     |   value_braced
>     ;
> 
> // matches {...} while allowing nested braces.
> value_braced
>     :   '{' ( value_braced | ~'}' )* '}'              *<--------------- this
> is line 42*
>     ;

value_braced starts with a '{' 

and ~'}' also matches a '{'

which alternative are we expected to follow? is ambiguous

> 
> 
> /*------------------------------------------------------------------
>  * Lexer rules
>  *------------------------------------------------------------------*/
> 
> ID  :    ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
>     ;
> 
> LITERAL
>     :    ('a'..'z'|'A'..'Z'|'0'..'9'|'_'|'-'|'/')+
>     ;
> 
> COMMENT
>     :   '%%' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
>     ;
> 
> WS  :   ( ' '
>         | '\t'
>         | '\r'
>         | '\n'
>         ) {$channel=HIDDEN;}
>     ;
> 
> STRING
>     :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
>     ;
> 
> CHAR:  '\'' ( ESC_SEQ | ~('\''|'\\') ) '\''
>     ;
> 
> fragment
> HEX_DIGIT : ('0'..'9'|'a'..'f'|'A'..'F') ;
> 
> fragment
> ESC_SEQ
>     :   '\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
>     |   UNICODE_ESC
>     |   OCTAL_ESC
>     ;
> 
> fragment
> OCTAL_ESC
>     :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
>     |   '\\' ('0'..'7') ('0'..'7')
>     |   '\\' ('0'..'7')
>     ;
> 
> fragment
> UNICODE_ESC
>     :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
>     ;
> 
> DO_NOT_DELETE_THIS_RULE
>     :    '!' | '>' | '<' | '*' | '&' | '.' | ';'
>     ;
> 

Hope this helps...
   -jbb



From adavis at ti.com  Tue Jul 13 06:51:21 2010
From: adavis at ti.com (Davis, Alan)
Date: Tue, 13 Jul 2010 08:51:21 -0500
Subject: [antlr-interest] error reporting problem in C runtime
Message-ID: <F8C55F6A02E92D48BDDFC6048552C6F1516B36FE@dlee03.ent.ti.com>

I'm having a problem with error handling in the C target. In a file with multiple recognition failures on different lines, the second error is being reported with the same line number and proximity token as the first.

I think I have tracked down the problem but it seems incomprehensible that such a blatant problem would still be extant, so I'm wondering if I'm overlooking something. 

The first recognition error causes an exception object to be created and recorded in recognizer->state->exception. However I cannot find anywhere where exceptions are freed. That is, after the first exception, recognizer->state->exception is never NULL; it continues to point to the first exception indefinitely.

The second error is a token mismatch, which results in a call to recoverFromMismatchedToken(), which does:

 // Create an exception if we need one
 if (recognizer->state->exception == NULL)
    antlr3RecognitionExceptionNew(recognizer);

The predicate fails because the first exception is still there... so the constructor is not called... so the fields pinpointing the error are not set... so the second error is reported with the same source filename and line number as the first.

I was able to fix this by overriding reportError(), adding code to call freeEx() and set recognizer->state->error to NULL. But it seems like this would be part of the standard library implementation -- or at least there would be something to take care of this.

My apologies if this a known issue -- I searched the various FAQs/Wikis/groups as best as I could.

Regards, 
Alan Davis
Texas Instruments

 

From jimi at temporal-wave.com  Tue Jul 13 08:26:19 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 13 Jul 2010 08:26:19 -0700
Subject: [antlr-interest] error reporting problem in C runtime
In-Reply-To: <F8C55F6A02E92D48BDDFC6048552C6F1516B36FE@dlee03.ent.ti.com>
Message-ID: <8755782469d60849a153c98f0be06687@temporal-wave.com>

I'll take a look. It is possible that something like that might have been overlooked as I am trying to reuse the memory and not keep freeing and mallocing exceptions.

Jim 

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Davis, Alan
> Sent: Tuesday, July 13, 2010 6:51 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] error reporting problem in C runtime
> 
> I'm having a problem with error handling in the C target. In a file
> with multiple recognition failures on different lines, the second error
> is being reported with the same line number and proximity token as the
> first.
> 
> I think I have tracked down the problem but it seems incomprehensible
> that such a blatant problem would still be extant, so I'm wondering if
> I'm overlooking something.
> 
> The first recognition error causes an exception object to be created
> and recorded in recognizer->state->exception. However I cannot find
> anywhere where exceptions are freed. That is, after the first
> exception, recognizer->state->exception is never NULL; it continues to
> point to the first exception indefinitely.
> 
> The second error is a token mismatch, which results in a call to
> recoverFromMismatchedToken(), which does:
> 
>  // Create an exception if we need one
>  if (recognizer->state->exception == NULL)
>     antlr3RecognitionExceptionNew(recognizer);
> 
> The predicate fails because the first exception is still there... so
> the constructor is not called... so the fields pinpointing the error
> are not set... so the second error is reported with the same source
> filename and line number as the first.
> 
> I was able to fix this by overriding reportError(), adding code to call
> freeEx() and set recognizer->state->error to NULL. But it seems like
> this would be part of the standard library implementation -- or at
> least there would be something to take care of this.
> 
> My apologies if this a known issue -- I searched the various
> FAQs/Wikis/groups as best as I could.
> 
> Regards,
> Alan Davis
> Texas Instruments
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From brian at brie.com  Tue Jul 13 09:43:37 2010
From: brian at brie.com (Brian Lavender)
Date: Tue, 13 Jul 2010 09:43:37 -0700
Subject: [antlr-interest] antlr 3.2 dependencies?
Message-ID: <20100713164337.GA29642@brie.com>

I have the "The Definitive ANTLR Reference" and it says that you need to
add antlr-2.7.7.jar and stringtemplate-3.0.jar to your classpath in
order to run the antlr 2.0 tool (page 10). Is this required for 3.2 or
do I just need to put antlr-3.2.jar in my classpath. It appears that is
all that I need. Could someone please clarify?

brian
-- 
Brian Lavender
http://www.brie.com/brian/

"There are two ways of constructing a software design. One way is to
make it so simple that there are obviously no deficiencies. And the other
way is to make it so complicated that there are no obvious deficiencies."

Professor C. A. R. Hoare
The 1980 Turing award lecture

From jimi at temporal-wave.com  Tue Jul 13 09:48:56 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 13 Jul 2010 09:48:56 -0700
Subject: [antlr-interest] antlr 3.2 dependencies?
In-Reply-To: <20100713164337.GA29642@brie.com>
Message-ID: <282f0b1a9d279b49ba3f726a6a578796@temporal-wave.com>

The 3.2.x tool jar is a self contained executable jar, so you do not need v2 in your CLASSPATH. The runtime jar is just the v3 runtime and you will need the v2 runtime jar and stringtemplate jar. 

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Brian Lavender
> Sent: Tuesday, July 13, 2010 9:44 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] antlr 3.2 dependencies?
> 
> I have the "The Definitive ANTLR Reference" and it says that you need
> to
> add antlr-2.7.7.jar and stringtemplate-3.0.jar to your classpath in
> order to run the antlr 2.0 tool (page 10). Is this required for 3.2 or
> do I just need to put antlr-3.2.jar in my classpath. It appears that is
> all that I need. Could someone please clarify?
> 
> brian
> --
> Brian Lavender
> http://www.brie.com/brian/
> 
> "There are two ways of constructing a software design. One way is to
> make it so simple that there are obviously no deficiencies. And the
> other
> way is to make it so complicated that there are no obvious
> deficiencies."
> 
> Professor C. A. R. Hoare
> The 1980 Turing award lecture
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From brian at brie.com  Tue Jul 13 11:53:46 2010
From: brian at brie.com (Brian Lavender)
Date: Tue, 13 Jul 2010 11:53:46 -0700
Subject: [antlr-interest] VB6 grammar for ANTLR and a runtime?
Message-ID: <20100713185346.GB29642@brie.com>

Is there a VB6 grammar for ANTLR?

visual basic 6 grammar
http://www.antlr.org/pipermail/antlr-interest/2004-April/007666.html

A Dynamic Language Runtime (DLR)
http://blogs.msdn.com/b/hugunin/archive/2007/04/30/a-dynamic-language-runtime-dlr.aspx

DLR - Build Your Own Language (without tears)
http://www.bitwisemag.com/2/DLR-Build-Your-Own-Language

brian
-- 
Brian Lavender
http://www.brie.com/brian/

"There are two ways of constructing a software design. One way is to
make it so simple that there are obviously no deficiencies. And the other
way is to make it so complicated that there are no obvious deficiencies."

Professor C. A. R. Hoare
The 1980 Turing award lecture

From powerofazure at gmail.com  Tue Jul 13 12:09:26 2010
From: powerofazure at gmail.com (Nathan Eloe)
Date: Tue, 13 Jul 2010 14:09:26 -0500
Subject: [antlr-interest] C runtime and aggregation in the parser
Message-ID: <4C3CB9E6.80009@gmail.com>

Hello again,
I'm writing about a very specific problem I'm having with the C runtime.
One of the restrictions of the grammar I'm writing is that strings may
contain some specific characters (such as # or %), but other rules have
these as operators, and as such I can't just make a token to catch all
strings.  The only way around this I've found has been aggregating
allowable strings in the parser.
Example:
ns_str_agg
  : nsp=ns_str_part nsap=ns_str_aggp -> STRING[$nsp.text+$nsap.text]
  | ns_str_part
  | rw=res_word_str nsap=ns_str_aggp -> STRING[$rw.text+$nsap.text];

This worked just fine when I was using the java runtime (so I could use
the debugger and gunit to test my grammar).  When moving to the C
runtime, I get the following error (and lots of them):

bashastParser.c: In function 'ns_str_agg':
bashastParser.c:42343: error: invalid operands to binary + (have
'uint8_t *' and 'pANTLR3_STRING')

I've attached the grammar to this email (I am attempting to recreate the
Bash grammar).  Is there some way around this or some way to correctly
do this kind of aggretation with the C runtime?

Thanks,
Nathan

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: bashast.g
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20100713/18b38ad7/attachment.pl 

From richard.thrippleton at progress.com  Wed Jul 14 04:03:40 2010
From: richard.thrippleton at progress.com (Richard Thrippleton)
Date: Wed, 14 Jul 2010 12:03:40 +0100
Subject: [antlr-interest] C runtime and aggregation in the parser
In-Reply-To: <4C3CB9E6.80009@gmail.com>
References: <4C3CB9E6.80009@gmail.com>
Message-ID: <4C3D998C.3080700@progress.com>

Nathan Eloe wrote:
> Hello again,
> I'm writing about a very specific problem I'm having with the C runtime.
> One of the restrictions of the grammar I'm writing is that strings may
> contain some specific characters (such as # or %), but other rules have
> these as operators, and as such I can't just make a token to catch all
> strings.  The only way around this I've found has been aggregating
> allowable strings in the parser.
> Example:
> ns_str_agg
>   : nsp=ns_str_part nsap=ns_str_aggp -> STRING[$nsp.text+$nsap.text]
>   | ns_str_part
>   | rw=res_word_str nsap=ns_str_aggp -> STRING[$rw.text+$nsap.text];
> 
> This worked just fine when I was using the java runtime (so I could use
> the debugger and gunit to test my grammar).  When moving to the C
> runtime, I get the following error (and lots of them):
> 
> bashastParser.c: In function 'ns_str_agg':
> bashastParser.c:42343: error: invalid operands to binary + (have
> 'uint8_t *' and 'pANTLR3_STRING')
> 
> I've attached the grammar to this email (I am attempting to recreate the
> Bash grammar).  Is there some way around this or some way to correctly
> do this kind of aggretation with the C runtime?
Anything inside "[ ... ]" of a token constructor is native code (Java or C 
in your case), and all that is done to it by ANTLR is to expand the 
$-prefixed expressions.

In Java you were fine because the Java backend of ANTLR expands 
$something.text to be an expression of type String, and Java overloads the 
operator '+' to work as you'd expect.

In C, the $something.text expressions get expanded to be expressions that 
give you a pointer to an ANTLR3_STRING[1], and C has no idea what to do with 
those when applied to the '+' operator. Look at the functions in 
http://www.antlr.org/api/C/struct_a_n_t_l_r3___s_t_r_i_n_g__struct.html if 
you want to manipulate ANTLR3_STRINGs.

My own preferred approach is to be using a C++ compiler and have a function 
that turns an ANTLR3_STRING into a std::string so I can do things like
	STRING[antlrStr($nsp.text) + antlrStr($nsap.text)]

Richard

[1] - I'm not sure why one of them seems to be being expanded into a 
uint8_t* in one case. I'd strongly encourage looking at the generated C.
-- 
\o/


From acondit at ipns.com  Wed Jul 14 06:52:04 2010
From: acondit at ipns.com (Alan Condit)
Date: Wed, 14 Jul 2010 06:52:04 -0700
Subject: [antlr-interest] StringTemplate for copying code from lexer rule to
	output code
Message-ID: <218D49F9-1A25-4B7C-81A0-73F0862AD154@ipns.com>

I have spent almost a week trying to track down a bug in the ObjC-runtime/stg parsing files, only to discover that I have a problem in the lexer. 

Given this lexer rule --

WS  	:   ( ' ' | '\t' ) { [self skip]; } ;

I would expect to find
	[self skip];
somewhere in the mWS routine in the generated lexer code.  It is missing, so obviously I have changed something incorrectly. Can anyone tell me which stringTemplate in Objc.stg should be doing the copying of the code fragment?

Thanks,
Alan
---

Alan Condit
1085 Tierra Ct.
Woodburn, OR 97071

Email -- acondit at ipns.com
Home-Office (503) 982-0906


From powerofazure at gmail.com  Wed Jul 14 07:28:12 2010
From: powerofazure at gmail.com (Nathan Eloe)
Date: Wed, 14 Jul 2010 09:28:12 -0500
Subject: [antlr-interest] C runtime and aggregation in the parser
In-Reply-To: <4C3D998C.3080700@progress.com>
References: <4C3CB9E6.80009@gmail.com> <4C3D998C.3080700@progress.com>
Message-ID: <4C3DC97C.70504@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 7/14/10 6:03 AM, Richard Thrippleton wrote:
> Nathan Eloe wrote:
>> Hello again,
>> I'm writing about a very specific problem I'm having with the C runtime.
>> One of the restrictions of the grammar I'm writing is that strings may
>> contain some specific characters (such as # or %), but other rules have
>> these as operators, and as such I can't just make a token to catch all
>> strings.  The only way around this I've found has been aggregating
>> allowable strings in the parser.
>> Example:
>> ns_str_agg
>>   : nsp=ns_str_part nsap=ns_str_aggp -> STRING[$nsp.text+$nsap.text]
>>   | ns_str_part
>>   | rw=res_word_str nsap=ns_str_aggp -> STRING[$rw.text+$nsap.text];
>>
>> This worked just fine when I was using the java runtime (so I could use
>> the debugger and gunit to test my grammar).  When moving to the C
>> runtime, I get the following error (and lots of them):
>>
>> bashastParser.c: In function 'ns_str_agg':
>> bashastParser.c:42343: error: invalid operands to binary + (have
>> 'uint8_t *' and 'pANTLR3_STRING')
>>
>> I've attached the grammar to this email (I am attempting to recreate the
>> Bash grammar).  Is there some way around this or some way to correctly
>> do this kind of aggretation with the C runtime?
> Anything inside "[ ... ]" of a token constructor is native code (Java or
> C in your case), and all that is done to it by ANTLR is to expand the
> $-prefixed expressions.
> 
> In Java you were fine because the Java backend of ANTLR expands
> $something.text to be an expression of type String, and Java overloads
> the operator '+' to work as you'd expect.
> 
> In C, the $something.text expressions get expanded to be expressions
> that give you a pointer to an ANTLR3_STRING[1], and C has no idea what
> to do with those when applied to the '+' operator. Look at the functions
> in
> http://www.antlr.org/api/C/struct_a_n_t_l_r3___s_t_r_i_n_g__struct.html
> if you want to manipulate ANTLR3_STRINGs.
> 
> My own preferred approach is to be using a C++ compiler and have a
> function that turns an ANTLR3_STRING into a std::string so I can do
> things like
>     STRING[antlrStr($nsp.text) + antlrStr($nsap.text)]
> 
> Richard
> 
> [1] - I'm not sure why one of them seems to be being expanded into a
> uint8_t* in one case. I'd strongly encourage looking at the generated C.


Thank you so much for the reply.  I am using a C++ compiler and so was
actually just thinking of doing just that or overloading the + operator
(I've got a few options in mind).

As for the uint8_t* (which was what was really confusing me, as I knew
about + not knowing what to do with pANTLR3STRING), I didn't see
anything in the code that would cause that, but I'll give it another
look after I debug another problem.

Again, thanks, you've been very helpful.
Nathan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.14 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkw9yXwACgkQFpoRlVgtqKa39wCdGSnZWm9lYg1kEXR7l5HhB2ZG
PukAoIvPgGi8pSdu7Z15q+PWyHkjTJI7
=nXiO
-----END PGP SIGNATURE-----

From jimi at temporal-wave.com  Wed Jul 14 08:40:11 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 08:40:11 -0700
Subject: [antlr-interest] C runtime and aggregation in the parser
In-Reply-To: <4C3D998C.3080700@progress.com>
Message-ID: <cc32c3987fef724da58c84e48d0e2a07@temporal-wave.com>

Don't use the pANTLR3_STRING unless you are not concerned with memory usage. It is better to reference the token, then use the pointers to the input stream that are contained within it directly. Then you can create your std::string or can use it for the direct pointers in C (which is what I do). The $text stuff the yields pANTLR3_STRING makes things nice and easy to use, but as it tracks memory and does not release any until you relese the parser, then it can use lots of memory if you are not careful!

Jim 

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Richard Thrippleton
> Sent: Wednesday, July 14, 2010 4:04 AM
> To: Nathan Eloe
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] C runtime and aggregation in the parser
> 
> Nathan Eloe wrote:
> > Hello again,
> > I'm writing about a very specific problem I'm having with the C
> runtime.
> > One of the restrictions of the grammar I'm writing is that strings
> may
> > contain some specific characters (such as # or %), but other rules
> have
> > these as operators, and as such I can't just make a token to catch
> all
> > strings.  The only way around this I've found has been aggregating
> > allowable strings in the parser.
> > Example:
> > ns_str_agg
> >   : nsp=ns_str_part nsap=ns_str_aggp -> STRING[$nsp.text+$nsap.text]
> >   | ns_str_part
> >   | rw=res_word_str nsap=ns_str_aggp -> STRING[$rw.text+$nsap.text];
> >
> > This worked just fine when I was using the java runtime (so I could
> use
> > the debugger and gunit to test my grammar).  When moving to the C
> > runtime, I get the following error (and lots of them):
> >
> > bashastParser.c: In function 'ns_str_agg':
> > bashastParser.c:42343: error: invalid operands to binary + (have
> > 'uint8_t *' and 'pANTLR3_STRING')
> >
> > I've attached the grammar to this email (I am attempting to recreate
> the
> > Bash grammar).  Is there some way around this or some way to
> correctly
> > do this kind of aggretation with the C runtime?
> Anything inside "[ ... ]" of a token constructor is native code (Java
> or C
> in your case), and all that is done to it by ANTLR is to expand the
> $-prefixed expressions.
> 
> In Java you were fine because the Java backend of ANTLR expands
> $something.text to be an expression of type String, and Java overloads
> the
> operator '+' to work as you'd expect.
> 
> In C, the $something.text expressions get expanded to be expressions
> that
> give you a pointer to an ANTLR3_STRING[1], and C has no idea what to do
> with
> those when applied to the '+' operator. Look at the functions in
> http://www.antlr.org/api/C/struct_a_n_t_l_r3___s_t_r_i_n_g__struct.html
> if
> you want to manipulate ANTLR3_STRINGs.
> 
> My own preferred approach is to be using a C++ compiler and have a
> function
> that turns an ANTLR3_STRING into a std::string so I can do things like
> 	STRING[antlrStr($nsp.text) + antlrStr($nsap.text)]
> 
> Richard
> 
> [1] - I'm not sure why one of them seems to be being expanded into a
> uint8_t* in one case. I'd strongly encourage looking at the generated
> C.
> --
> \o/
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Wed Jul 14 08:42:51 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 08:42:51 -0700
Subject: [antlr-interest] StringTemplate for copying code from lexer
	rule to output code
In-Reply-To: <218D49F9-1A25-4B7C-81A0-73F0862AD154@ipns.com>
Message-ID: <78ff5a2cd32bd7408fd81cd9a3230b9d@temporal-wave.com>

Alan,

Objective C has not been maintained for a long time - are you sure it is good enough for you to use? The reason it is missing from the output could be any number of reasons I am afraid :-( But start from the template that produces the rule itself and descend the hierarchy.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Alan Condit
> Sent: Wednesday, July 14, 2010 6:52 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] StringTemplate for copying code from lexer
> rule to output code
> 
> I have spent almost a week trying to track down a bug in the ObjC-
> runtime/stg parsing files, only to discover that I have a problem in
> the lexer.
> 
> Given this lexer rule --
> 
> WS  	:   ( ' ' | '\t' ) { [self skip]; } ;
> 
> I would expect to find
> 	[self skip];
> somewhere in the mWS routine in the generated lexer code.  It is
> missing, so obviously I have changed something incorrectly. Can anyone
> tell me which stringTemplate in Objc.stg should be doing the copying of
> the code fragment?
> 
> Thanks,
> Alan
> ---
> 
> Alan Condit
> 1085 Tierra Ct.
> Woodburn, OR 97071
> 
> Email -- acondit at ipns.com
> Home-Office (503) 982-0906
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From ciraci at gmail.com  Wed Jul 14 09:28:12 2010
From: ciraci at gmail.com (Selim Ciraci)
Date: Wed, 14 Jul 2010 18:28:12 +0200
Subject: [antlr-interest] Reading rule modifiers from common tree
Message-ID: <AANLkTikGP11b_E7wW8Gxk7gIdWcf4bMdIlAxe2tYL67s@mail.gmail.com>

Hi all,

I'm trying to write a program to parse a grammar file, modify it and write
it back as a grammar file. For this I use the builtin parser:
org.antlr.grammar.v3.ANTLRv3Lexer, org.antlr.grammar.v3.ANTLRv3Parser.
Everything seems to work ok but somehow the modifier of a rule is not
visible from the rule node.
For example: I have the following rule: fragment A:('a'|'A');

When I do a toStringTree() on the rule node I get the following output
(RULE A (BLOCK (ALT (BLOCK (ALT 'a' EOA) (ALT 'A' EOA) EOB) EOA) EOB) EOR)

somehow the fragment is missing and I cannot access the modifier of the
rule. is there something I'm doing wrong here? if so how can I access the
modifier?

With kind regards,
Selim Ciraci

From charles.hymans at gmail.com  Wed Jul 14 10:05:21 2010
From: charles.hymans at gmail.com (Charles Hymans)
Date: Wed, 14 Jul 2010 19:05:21 +0200
Subject: [antlr-interest] backtracking and return value error: attribute is
	not a token, parameter or return value, bug?
In-Reply-To: <AANLkTimvGXVIg-SjGwi4N3k76c3K_dbn6PnT7D3lDF_f@mail.gmail.com>
References: <AANLkTimvGXVIg-SjGwi4N3k76c3K_dbn6PnT7D3lDF_f@mail.gmail.com>
Message-ID: <AANLkTimiHIcjg9cAg0UpRaDTT6AeUw0XhbK5SM8ucL5U@mail.gmail.com>

I am trying to return a value for a rule in a grammar with backtrack set to
true. Strangely, Antrl (version 3.1.2) does not accept me to set the return
value and outputs the following error:
error(114): Bug.g:11:19: attribute is not a token, parameter, or return
value: value

Is this a bug? Am I doing something wrong? Or is it simply a known
limitation?
How am I suppose to proceed to make my grammar work with return values ?
(I want to avoid rewriting my grammar into LL form, since I care more about
the clarity of the grammar than performances + I don't want to invest too
much time in grammar hacking)

Here is the full grammar (in a file named Bug.g):

// this problem seems to be related to backtract = true!!
grammar Bug;

options
{
    language   = CSharp2;
    backtrack  = true;
}

compilation_unit returns [int value]:
  identifier '1'  { $value = 1; }
| identifier '2'  { $value = 2; }
;


identifier:
  'x'
| 'x' '.' identifier
;

From Andersen at highfleet.com  Wed Jul 14 10:45:15 2010
From: Andersen at highfleet.com (Bill Andersen)
Date: Wed, 14 Jul 2010 13:45:15 -0400
Subject: [antlr-interest] Stringtemplate/ANTLR - building up multivalued
	attribute
Message-ID: <66461487-B204-48C7-B95A-62D9147BCEA9@highfleet.com>

Hi Folks

I have a production in a tree grammar with ST output

rule
	: ^(AS_RULE rName=ID rType=ID alternative+)
	;

What I'd like is to pass in all the STs from the 'alternative' matches into a single multi-valued attribute for the ST for this production, like so

rule
	: ^(AS_RULE rName=ID rType=ID alternative+)
	  -> someTemplate(rName={$rName.text}, alts={ ??? })
	;

where alts iis a multi-valued attribute consisting of STs.  I know I can do this

rule
@init { List<StringTemplate> alts = new ... }
	: ^(AS_RULE rName=ID rType=ID ( a=alternative { alts.add($a.st); } )+ )
	  -> someTemplate(rName={$rName.text}, alts={ alts })
	;

but this seems clumsy.  Is there any better way?

Thanks.

	.bill

Bill Andersen 
Highfleet, Inc. (www.highfleet.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204






From javamark at gmail.com  Wed Jul 14 10:48:55 2010
From: javamark at gmail.com (Mark)
Date: Wed, 14 Jul 2010 18:48:55 +0100
Subject: [antlr-interest] HTML Link grammar
Message-ID: <AANLkTinJ_3FcRfJ9w-tH2T_-IvpB2xiF-rSo_NM2f3-e@mail.gmail.com>

Hello,

I am slowly picking up Antlr, and I thought a nice example grammar
would be to process a html page throwing which sends all characters to
the hidden channel apart from any href's.

Ideally the grammar would be written such that it collects the href's
in an array.

I picked this example since I know how to do it in anything but Antlr.

Thoughts anyone?

Regards

Mark

From acondit at ipns.com  Wed Jul 14 10:49:08 2010
From: acondit at ipns.com (Alan Condit)
Date: Wed, 14 Jul 2010 10:49:08 -0700
Subject: [antlr-interest] StringTemplate for copying code from lexer
	rule to output code
Message-ID: <5825F329-F98C-4DCC-B7E0-FC1B75D5CC03@ipns.com>

Jim,

I am in the process of bringing it up to date. I started with the templates that Kay had done and I don't know if Kay deleted a template that is needed or what. So I am trying to find out what template copies the actions in the Java code (since it works) so that I can figure out how to fix the ObjC code.

Alan
---

Alan Condit
1085 Tierra Ct.
Woodburn, OR 97071

Email -- acondit at ipns.com
Home-Office (503) 982-0906


From jimi at temporal-wave.com  Wed Jul 14 10:52:30 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 10:52:30 -0700
Subject: [antlr-interest] Stringtemplate/ANTLR - building up multivalued
	attribute
In-Reply-To: <66461487-B204-48C7-B95A-62D9147BCEA9@highfleet.com>
Message-ID: <e69c7b95bcc85e4781a5abb238ac8f59@temporal-wave.com>

a+=alternative+

alts={$a}

You will get a list passed in to the template argument instead of a single template and can then iterate. This is in the ANTLR book btw.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Bill Andersen
> Sent: Wednesday, July 14, 2010 10:45 AM
> To: antlr-interest
> Subject: [antlr-interest] Stringtemplate/ANTLR - building up
> multivalued attribute
> 
> Hi Folks
> 
> I have a production in a tree grammar with ST output
> 
> rule
> 	: ^(AS_RULE rName=ID rType=ID alternative+)
> 	;
> 
> What I'd like is to pass in all the STs from the 'alternative' matches
> into a single multi-valued attribute for the ST for this production,
> like so
> 
> rule
> 	: ^(AS_RULE rName=ID rType=ID alternative+)
> 	  -> someTemplate(rName={$rName.text}, alts={ ??? })
> 	;
> 
> where alts iis a multi-valued attribute consisting of STs.  I know I
> can do this
> 
> rule
> @init { List<StringTemplate> alts = new ... }
> 	: ^(AS_RULE rName=ID rType=ID ( a=alternative { alts.add($a.st);
> } )+ )
> 	  -> someTemplate(rName={$rName.text}, alts={ alts })
> 	;
> 
> but this seems clumsy.  Is there any better way?
> 
> Thanks.
> 
> 	.bill
> 
> Bill Andersen
> Highfleet, Inc. (www.highfleet.com)
> 3600 O'Donnell Street, Suite 600
> Baltimore, MD 21224
> Office: +1.410.675.1201
> Cell: +1.443.858.6444
> Fax: +1.410.675.1204
> 
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Wed Jul 14 12:21:31 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 12:21:31 -0700
Subject: [antlr-interest] HTML Link grammar
In-Reply-To: <AANLkTinJ_3FcRfJ9w-tH2T_-IvpB2xiF-rSo_NM2f3-e@mail.gmail.com>
Message-ID: <a787cf145443cb4ebb4a7c5937e0760b@temporal-wave.com>

HTML is not a good target for parsing with ANTLR, you have to do it all in the lexer basically. I would pick something simpler to get going. There are quite a few sample grammars you can download and manipulate.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Mark
> Sent: Wednesday, July 14, 2010 10:49 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] HTML Link grammar
> 
> Hello,
> 
> I am slowly picking up Antlr, and I thought a nice example grammar
> would be to process a html page throwing which sends all characters to
> the hidden channel apart from any href's.
> 
> Ideally the grammar would be written such that it collects the href's
> in an array.
> 
> I picked this example since I know how to do it in anything but Antlr.
> 
> Thoughts anyone?
> 
> Regards
> 
> Mark
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Wed Jul 14 12:26:41 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 12:26:41 -0700
Subject: [antlr-interest] StringTemplate for copying code from lexer
	rule to output code
In-Reply-To: <5825F329-F98C-4DCC-B7E0-FC1B75D5CC03@ipns.com>
Message-ID: <292676270beae540b290eaf7bcd954d8@temporal-wave.com>

You will have to look through the lists markmail.org to see how to display all the parameters and so on that are coming in to the templates.

But start by looking at the template 'lexerRule' in my C.stg - that should allow you to descend then templates and find out what is missing.


Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Alan Condit
> Sent: Wednesday, July 14, 2010 10:49 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] StringTemplate for copying code from
> lexer rule to output code
> 
> Jim,
> 
> I am in the process of bringing it up to date. I started with the
> templates that Kay had done and I don't know if Kay deleted a template
> that is needed or what. So I am trying to find out what template copies
> the actions in the Java code (since it works) so that I can figure out
> how to fix the ObjC code.
> 
> Alan
> ---
> 
> Alan Condit
> 1085 Tierra Ct.
> Woodburn, OR 97071
> 
> Email -- acondit at ipns.com
> Home-Office (503) 982-0906
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From parrt at cs.usfca.edu  Wed Jul 14 12:33:06 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 14 Jul 2010 12:33:06 -0700
Subject: [antlr-interest] -Xconversiontimeout
Message-ID: <9A884B1C-6E3B-4A2D-97CA-9E3794C0799A@cs.usfca.edu>

Hi,Does anyone use the following parameter to actually REDUCE the conversion timeout?

  -Xconversiontimeout t   set NFA conversion timeout (ms) for each decision 

I'm thinking about simply getting rid of this timeout failsafe. It was originally necessary before I added a heuristic that prevented us from hitting exponential landmines in the grammar. It's a very crude mechanism and I'd like to remove.

The only situation I've seen where people use the parameter is when they need to INCREASE it. In other words, ANTLR will succeed in creating the prediction DFA, but it needs a little more time than the default.

So, please let me know your thoughts on this, particularly if you need to reduce the time given to DFA construction. The behavior you would see is that reducing the parameter using the same exact parser but antlr finishes faster.

Thanks!
Ter

From jimi at temporal-wave.com  Wed Jul 14 12:36:53 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 12:36:53 -0700
Subject: [antlr-interest] -Xconversiontimeout
In-Reply-To: <9A884B1C-6E3B-4A2D-97CA-9E3794C0799A@cs.usfca.edu>
Message-ID: <99f993841b9fcf40b39fa5a4c44d3bb0@temporal-wave.com>

For what it is worth, I have only ever had to tell people that they need to increase it and have never decreased it myself. I think we just dump it ;-)

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Terence Parr
> Sent: Wednesday, July 14, 2010 12:33 PM
> To: antlr-interest at antlr.org interest
> Subject: [antlr-interest] -Xconversiontimeout
> 
> Hi,Does anyone use the following parameter to actually REDUCE the
> conversion timeout?
> 
>   -Xconversiontimeout t   set NFA conversion timeout (ms) for each
> decision
> 
> I'm thinking about simply getting rid of this timeout failsafe. It was
> originally necessary before I added a heuristic that prevented us from
> hitting exponential landmines in the grammar. It's a very crude
> mechanism and I'd like to remove.
> 
> The only situation I've seen where people use the parameter is when
> they need to INCREASE it. In other words, ANTLR will succeed in
> creating the prediction DFA, but it needs a little more time than the
> default.
> 
> So, please let me know your thoughts on this, particularly if you need
> to reduce the time given to DFA construction. The behavior you would
> see is that reducing the parameter using the same exact parser but
> antlr finishes faster.
> 
> Thanks!
> Ter
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From mattpalms at gmail.com  Wed Jul 14 12:51:21 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Wed, 14 Jul 2010 20:51:21 +0100
Subject: [antlr-interest] Reading rule modifiers from common tree
In-Reply-To: <AANLkTikGP11b_E7wW8Gxk7gIdWcf4bMdIlAxe2tYL67s@mail.gmail.com>
References: <AANLkTikGP11b_E7wW8Gxk7gIdWcf4bMdIlAxe2tYL67s@mail.gmail.com>
Message-ID: <AANLkTikknlUwrVA6r7e47g7O_rWDLI3Ve0IbV_WeP0iu@mail.gmail.com>

Selim,

I may have misunderstood your problem, but fragment rules don't form tokens
in the output.  They are just convenient patterns to re-use in other, actual
tokens.

Regards,

Matt

On 14 July 2010 17:28, Selim Ciraci <ciraci at gmail.com> wrote:

> Hi all,
>
> I'm trying to write a program to parse a grammar file, modify it and write
> it back as a grammar file. For this I use the builtin parser:
> org.antlr.grammar.v3.ANTLRv3Lexer, org.antlr.grammar.v3.ANTLRv3Parser.
> Everything seems to work ok but somehow the modifier of a rule is not
> visible from the rule node.
> For example: I have the following rule: fragment A:('a'|'A');
>
> When I do a toStringTree() on the rule node I get the following output
> (RULE A (BLOCK (ALT (BLOCK (ALT 'a' EOA) (ALT 'A' EOA) EOB) EOA) EOB) EOR)
>
> somehow the fragment is missing and I cannot access the modifier of the
> rule. is there something I'm doing wrong here? if so how can I access the
> modifier?
>
> With kind regards,
> Selim Ciraci
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From ciraci at gmail.com  Wed Jul 14 13:18:59 2010
From: ciraci at gmail.com (Selim Ciraci)
Date: Wed, 14 Jul 2010 22:18:59 +0200
Subject: [antlr-interest] Reading rule modifiers from common tree
In-Reply-To: <AANLkTikknlUwrVA6r7e47g7O_rWDLI3Ve0IbV_WeP0iu@mail.gmail.com>
References: <AANLkTikGP11b_E7wW8Gxk7gIdWcf4bMdIlAxe2tYL67s@mail.gmail.com>
	<AANLkTikknlUwrVA6r7e47g7O_rWDLI3Ve0IbV_WeP0iu@mail.gmail.com>
Message-ID: <AANLkTilaHzA4fpV7jCMi3WCoxNM4i24SDEGscqg2bd1A@mail.gmail.com>

Hi,

Thanks for the reply. I'm trying to use antlr to parse antlr grammar files.
The problem is that when I parse the grammar file, the rule modifiers go
missing.
The previous example I showed you is from Sql.g. I use antlr to parse this
grammar file (I use AntlrV3.2.g). Now the Sql.g contains the following rule:
fragment A:  'a' | 'A';

When I parse the file, somehow the fragment gets lost. Hence, the call to
toStringTree() on the rule node does not show a node with token fragment.
For example the parse tree of the rule A is printed as:
(RULE A (BLOCK (ALT (BLOCK (ALT 'a' EOA) (ALT 'A' EOA) EOB) EOA) EOB) EOR)
no mentioning of the "fragment". So somehow I cannot access the modifier of
the rule from it is parse tree. Is there a way to do that?

Kind regards,
Selim Ciraci

On Wed, Jul 14, 2010 at 9:51 PM, Matt Palmer <mattpalms at gmail.com> wrote:

> Selim,
>
> I may have misunderstood your problem, but fragment rules don't form tokens
> in the output.  They are just convenient patterns to re-use in other, actual
> tokens.
>
> Regards,
>
> Matt
>
> On 14 July 2010 17:28, Selim Ciraci <ciraci at gmail.com> wrote:
>
>> Hi all,
>>
>> I'm trying to write a program to parse a grammar file, modify it and write
>> it back as a grammar file. For this I use the builtin parser:
>> org.antlr.grammar.v3.ANTLRv3Lexer, org.antlr.grammar.v3.ANTLRv3Parser.
>> Everything seems to work ok but somehow the modifier of a rule is not
>> visible from the rule node.
>> For example: I have the following rule: fragment A:('a'|'A');
>>
>> When I do a toStringTree() on the rule node I get the following output
>> (RULE A (BLOCK (ALT (BLOCK (ALT 'a' EOA) (ALT 'A' EOA) EOB) EOA) EOB) EOR)
>>
>> somehow the fragment is missing and I cannot access the modifier of the
>> rule. is there something I'm doing wrong here? if so how can I access the
>> modifier?
>>
>> With kind regards,
>> Selim Ciraci
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>

From darwin401 at gmail.com  Wed Jul 14 17:55:15 2010
From: darwin401 at gmail.com (Drew Shaw)
Date: Wed, 14 Jul 2010 19:55:15 -0500
Subject: [antlr-interest] compiling examples with the C target
Message-ID: <AANLkTine6m3IBnv8Q_3_ubkd2n3CdJ9XY8E0V8G0h4X6@mail.gmail.com>

I am having trouble with the using the C target.  I downloaded the C
examples and ran
java -cp /usr/local/antlr/antlr-3.2.jar
 in the directory of one of the example directories.  This produced the
parser and lexer files as expected. I tried compiling the examples using
gcc *.c -I/usr/local/include -L/usr/local/lib -o arbitrary
I got some errors regarding missing header files.
I fixed this by repalcing the angle brackets in the files with quotes so the
header files could be found in the current directory.  After this I tried to
compile the project once again and got the following.

drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ gcc *.c
-I/usr/local/include
-L/usr/local/lib -o ff
/tmp/ccyVyMvd.o: In function `callJavadoc':
javadocctl.c:(.text+0x3a): undefined reference to
`antlr3CommonTokenStreamSourceNew'
/tmp/cc75UF4Q.o: In function `JavadocLexerNewSSD':
JavadocLexer.c:(.text+0x8d): undefined reference to `antlr3LexerNewStream'
/tmp/ccOb1COu.o: In function `JavadocParserNewSSD':
JavadocParser.c:(.text+0x7a): undefined reference to `antlr3ParserNewStream'
/tmp/ccfeeQI8.o: In function `main':
main.c:(.text+0x39): undefined reference to `antlr3AsciiFileStreamNew'
main.c:(.text+0xd8): undefined reference to
`antlr3CommonTokenStreamSourceNew'
/tmp/cc2S4tNM.o: In function `callSimple':
simplectl.c:(.text+0x3a): undefined reference to
`antlr3CommonTokenStreamSourceNew'
/tmp/ccxtwI9q.o: In function `SimpleLexerNewSSD':
SimpleLexer.c:(.text+0x8d): undefined reference to `antlr3LexerNewStream'
/tmp/ccXvuQL5.o: In function `SimpleParserNewSSD':
SimpleParser.c:(.text+0x7d): undefined reference to `antlr3ParserNewStream'
collect2: ld returned 1 exit status
drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ ls
input                         javadoc.h        main.c         SimpleLexer.h
islandfuncs.h                 JavadocLexer.c   output         SimpleParser.c
island-grammar.vcproj         JavadocLexer.h   simplectl.c    SimpleParser.h
island-grammar.vcproj.vspscc  JavadocParser.c  Simple.g       Simple.tokens
javadocctl.c                  JavadocParser.h  simple.h
Javadoc.g                     Javadoc.tokens   SimpleLexer.c

Dose anyone have any suggestions about things to try to get rid of these
errors?

From jimi at temporal-wave.com  Wed Jul 14 17:59:21 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 17:59:21 -0700
Subject: [antlr-interest] compiling examples with the C target
In-Reply-To: <AANLkTine6m3IBnv8Q_3_ubkd2n3CdJ9XY8E0V8G0h4X6@mail.gmail.com>
Message-ID: <6275f32e334e344599e48c53f79d011d@temporal-wave.com>

Did you read the documentation? Assuming you have installed the C runtime correctly, you need

gcc -I. *.c -lantlr3c

The -I. means look in the current directory for include files. It will already look in /usr/include for the installed antlr includes.

Also, remember http://antlr.markmail.org 

You can and should use java -jar and not -cp with 3.2 too.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Drew Shaw
> Sent: Wednesday, July 14, 2010 5:55 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] compiling examples with the C target
> 
> I am having trouble with the using the C target.  I downloaded the C
> examples and ran
> java -cp /usr/local/antlr/antlr-3.2.jar
>  in the directory of one of the example directories.  This produced the
> parser and lexer files as expected. I tried compiling the examples
> using
> gcc *.c -I/usr/local/include -L/usr/local/lib -o arbitrary
> I got some errors regarding missing header files.
> I fixed this by repalcing the angle brackets in the files with quotes
> so the
> header files could be found in the current directory.  After this I
> tried to
> compile the project once again and got the following.
> 
> drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ gcc *.c
> -I/usr/local/include
> -L/usr/local/lib -o ff
> /tmp/ccyVyMvd.o: In function `callJavadoc':
> javadocctl.c:(.text+0x3a): undefined reference to
> `antlr3CommonTokenStreamSourceNew'
> /tmp/cc75UF4Q.o: In function `JavadocLexerNewSSD':
> JavadocLexer.c:(.text+0x8d): undefined reference to
> `antlr3LexerNewStream'
> /tmp/ccOb1COu.o: In function `JavadocParserNewSSD':
> JavadocParser.c:(.text+0x7a): undefined reference to
> `antlr3ParserNewStream'
> /tmp/ccfeeQI8.o: In function `main':
> main.c:(.text+0x39): undefined reference to `antlr3AsciiFileStreamNew'
> main.c:(.text+0xd8): undefined reference to
> `antlr3CommonTokenStreamSourceNew'
> /tmp/cc2S4tNM.o: In function `callSimple':
> simplectl.c:(.text+0x3a): undefined reference to
> `antlr3CommonTokenStreamSourceNew'
> /tmp/ccxtwI9q.o: In function `SimpleLexerNewSSD':
> SimpleLexer.c:(.text+0x8d): undefined reference to
> `antlr3LexerNewStream'
> /tmp/ccXvuQL5.o: In function `SimpleParserNewSSD':
> SimpleParser.c:(.text+0x7d): undefined reference to
> `antlr3ParserNewStream'
> collect2: ld returned 1 exit status
> drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ ls
> input                         javadoc.h        main.c
> SimpleLexer.h
> islandfuncs.h                 JavadocLexer.c   output
> SimpleParser.c
> island-grammar.vcproj         JavadocLexer.h   simplectl.c
> SimpleParser.h
> island-grammar.vcproj.vspscc  JavadocParser.c  Simple.g
> Simple.tokens
> javadocctl.c                  JavadocParser.h  simple.h
> Javadoc.g                     Javadoc.tokens   SimpleLexer.c
> 
> Dose anyone have any suggestions about things to try to get rid of
> these
> errors?
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From darwin401 at gmail.com  Wed Jul 14 17:59:40 2010
From: darwin401 at gmail.com (Drew Shaw)
Date: Wed, 14 Jul 2010 19:59:40 -0500
Subject: [antlr-interest] C Target problem
Message-ID: <AANLkTikyxsmvxRv-aEOcghNmlBqFT5GZuD4byN4JCfD9@mail.gmail.com>

I am having trouble with the using the C target.  I downloaded the C
examples and ran
java -cp /usr/local/antlr/antlr-3.2.jar
 in the directory of one of the example directories.  This produced the
parser and lexer files as expected. I tried compiling the examples using
gcc *.c -I/usr/local/include -L/usr/local/lib -o arbitrary
I got some errors regarding missing header files.
I fixed this by repalcing the angle brackets in the files with quotes so the
header files could be found in the current directory.  After this I tried to
compile the project once again and got the following.

drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ gcc *.c
-I/usr/local/include
-L/usr/local/lib -o ff
/tmp/ccyVyMvd.o: In function `callJavadoc':
javadocctl.c:(.text+0x3a): undefined reference to
`antlr3CommonTokenStreamSourceNew'
/tmp/cc75UF4Q.o: In function `JavadocLexerNewSSD':
JavadocLexer.c:(.text+0x8d): undefined reference to `antlr3LexerNewStream'
/tmp/ccOb1COu.o: In function `JavadocParserNewSSD':
JavadocParser.c:(.text+0x7a): undefined reference to `antlr3ParserNewStream'
/tmp/ccfeeQI8.o: In function `main':
main.c:(.text+0x39): undefined reference to `antlr3AsciiFileStreamNew'
main.c:(.text+0xd8): undefined reference to
`antlr3CommonTokenStreamSourceNew'
/tmp/cc2S4tNM.o: In function `callSimple':
simplectl.c:(.text+0x3a): undefined reference to
`antlr3CommonTokenStreamSourceNew'
/tmp/ccxtwI9q.o: In function `SimpleLexerNewSSD':
SimpleLexer.c:(.text+0x8d): undefined reference to `antlr3LexerNewStream'
/tmp/ccXvuQL5.o: In function `SimpleParserNewSSD':
SimpleParser.c:(.text+0x7d): undefined reference to `antlr3ParserNewStream'
collect2: ld returned 1 exit status
drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ ls
input                         javadoc.h        main.c         SimpleLexer.h
islandfuncs.h                 JavadocLexer.c   output         SimpleParser.c
island-grammar.vcproj         JavadocLexer.h   simplectl.c    SimpleParser.h
island-grammar.vcproj.vspscc  JavadocParser.c  Simple.g       Simple.tokens
javadocctl.c                  JavadocParser.h  simple.h
Javadoc.g                     Javadoc.tokens   SimpleLexer.c

Dose anyone have any suggestions about what I might do to get rid of these
errors?

From jimi at temporal-wave.com  Wed Jul 14 18:11:05 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 14 Jul 2010 18:11:05 -0700
Subject: [antlr-interest] C Target problem
In-Reply-To: <AANLkTikyxsmvxRv-aEOcghNmlBqFT5GZuD4byN4JCfD9@mail.gmail.com>
Message-ID: <16684c1ae81b3c408edc48b3f69c8182@temporal-wave.com>

Please don't post the same question twice with different subject lines. 

Thanks.

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Drew Shaw
> Sent: Wednesday, July 14, 2010 6:00 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] C Target problem
> 
> I am having trouble with the using the C target.  I downloaded the C
> examples and ran
> java -cp /usr/local/antlr/antlr-3.2.jar
>  in the directory of one of the example directories.  This produced the
> parser and lexer files as expected. I tried compiling the examples
> using
> gcc *.c -I/usr/local/include -L/usr/local/lib -o arbitrary
> I got some errors regarding missing header files.
> I fixed this by repalcing the angle brackets in the files with quotes
> so the
> header files could be found in the current directory.  After this I
> tried to
> compile the project once again and got the following.
> 
> drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ gcc *.c
> -I/usr/local/include
> -L/usr/local/lib -o ff
> /tmp/ccyVyMvd.o: In function `callJavadoc':
> javadocctl.c:(.text+0x3a): undefined reference to
> `antlr3CommonTokenStreamSourceNew'
> /tmp/cc75UF4Q.o: In function `JavadocLexerNewSSD':
> JavadocLexer.c:(.text+0x8d): undefined reference to
> `antlr3LexerNewStream'
> /tmp/ccOb1COu.o: In function `JavadocParserNewSSD':
> JavadocParser.c:(.text+0x7a): undefined reference to
> `antlr3ParserNewStream'
> /tmp/ccfeeQI8.o: In function `main':
> main.c:(.text+0x39): undefined reference to `antlr3AsciiFileStreamNew'
> main.c:(.text+0xd8): undefined reference to
> `antlr3CommonTokenStreamSourceNew'
> /tmp/cc2S4tNM.o: In function `callSimple':
> simplectl.c:(.text+0x3a): undefined reference to
> `antlr3CommonTokenStreamSourceNew'
> /tmp/ccxtwI9q.o: In function `SimpleLexerNewSSD':
> SimpleLexer.c:(.text+0x8d): undefined reference to
> `antlr3LexerNewStream'
> /tmp/ccXvuQL5.o: In function `SimpleParserNewSSD':
> SimpleParser.c:(.text+0x7d): undefined reference to
> `antlr3ParserNewStream'
> collect2: ld returned 1 exit status
> drew at ubuntu:~/Desktop/examples-v3/C/island-grammar$ ls
> input                         javadoc.h        main.c
> SimpleLexer.h
> islandfuncs.h                 JavadocLexer.c   output
> SimpleParser.c
> island-grammar.vcproj         JavadocLexer.h   simplectl.c
> SimpleParser.h
> island-grammar.vcproj.vspscc  JavadocParser.c  Simple.g
> Simple.tokens
> javadocctl.c                  JavadocParser.h  simple.h
> Javadoc.g                     Javadoc.tokens   SimpleLexer.c
> 
> Dose anyone have any suggestions about what I might do to get rid of
> these
> errors?
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From acondit at ipns.com  Wed Jul 14 19:22:40 2010
From: acondit at ipns.com (Alan Condit)
Date: Wed, 14 Jul 2010 19:22:40 -0700
Subject: [antlr-interest] StringTemplate for copying code from lexer
	rule to output code
In-Reply-To: <mailman.0.1279134001.21998.antlr-interest@antlr.org>
References: <mailman.0.1279134001.21998.antlr-interest@antlr.org>
Message-ID: <5AA26204-56C5-4FBB-BED5-FD47060AFBE3@ipns.com>

Well, I fixed that problem, now on to finding the next one.

Alan
---

Alan Condit
1085 Tierra Ct.
Woodburn, OR 97071

Email -- acondit at ipns.com
Home-Office (503) 982-0906

On Jul 14, 2010, at 12:00 PM, antlr-interest-request at antlr.org wrote:

> From: Alan Condit <acondit at ipns.com>
> Date: July 14, 2010 10:49:08 AM PDT
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] StringTemplate for copying code from lexer rule to output code
> 
> 
> Jim,
> 
> I am in the process of bringing it up to date. I started with the templates that Kay had done and I don't know if Kay deleted a template that is needed or what. So I am trying to find out what template copies the actions in the Java code (since it works) so that I can figure out how to fix the ObjC code.
> 
> Alan
> ---
> 
> Alan Condit
> 1085 Tierra Ct.
> Woodburn, OR 97071
> 
> Email -- acondit at ipns.com
> Home-Office (503) 982-0906

> From: "Jim Idle" <jimi at temporal-wave.com>
> Date: July 14, 2010 8:42:51 AM PDT
> To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
> Subject: Re: [antlr-interest] StringTemplate for copying code from lexer rule to output code
> 
> 
> Alan,
> 
> Objective C has not been maintained for a long time - are you sure it is good enough for you to use? The reason it is missing from the output could be any number of reasons I am afraid :-( But start from the template that produces the rule itself and descend the hierarchy.
> 
> Jim
> 
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Alan Condit
>> Sent: Wednesday, July 14, 2010 6:52 AM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] StringTemplate for copying code from lexer
>> rule to output code
>> 
>> I have spent almost a week trying to track down a bug in the ObjC-
>> runtime/stg parsing files, only to discover that I have a problem in
>> the lexer.
>> 
>> Given this lexer rule --
>> 
>> WS  	:   ( ' ' | '\t' ) { [self skip]; } ;
>> 
>> I would expect to find
>> 	[self skip];
>> somewhere in the mWS routine in the generated lexer code.  It is
>> missing, so obviously I have changed something incorrectly. Can anyone
>> tell me which stringTemplate in Objc.stg should be doing the copying of
>> the code fragment?
>> 
>> Thanks,
>> Alan
>> ---
>> 
>> Alan Condit
>> 1085 Tierra Ct.
>> Woodburn, OR 97071
>> 
>> Email -- acondit at ipns.com
>> Home-Office (503) 982-0906
>> 
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address


From a.moderacja at gmail.com  Wed Jul 14 20:52:27 2010
From: a.moderacja at gmail.com (Borneq)
Date: Thu, 15 Jul 2010 05:52:27 +0200
Subject: [antlr-interest] Error in ANTLR v2 to v3 converter
Message-ID: <AANLkTilIJuuOdhjAGta7qgtvSLFgp7tcubSeBFssJnlu@mail.gmail.com>

When I compile source from v2v3-0.2.tar.gz  I get error, no defined
some fields. Wgen I convert grammar, this grammar was nor right
converted. Someone convert ? can send me compiled version of
converter?

From jarrod at vertigrated.com  Thu Jul 15 13:24:48 2010
From: jarrod at vertigrated.com (Jarrod Roberson)
Date: Thu, 15 Jul 2010 16:24:48 -0400
Subject: [antlr-interest] Does anyone know of a grammar for parsing command
	line arguments UNIX style is preferred.
Message-ID: <AANLkTilSXvxhELidwf3wshyVd4Fy4XF9Ns7VvFsLkmgt@mail.gmail.com>

but both *NIX and Windows 2000 style would be great!

-- 
Jarrod Roberson
www.vertigrated.com/blog/

From jimi at temporal-wave.com  Thu Jul 15 13:27:56 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 15 Jul 2010 13:27:56 -0700
Subject: [antlr-interest] Does anyone know of a grammar for parsing
	command line arguments UNIX style is preferred.
In-Reply-To: <AANLkTilSXvxhELidwf3wshyVd4Fy4XF9Ns7VvFsLkmgt@mail.gmail.com>
Message-ID: <094181753db95d4fa4ac26d1b05abc2e@temporal-wave.com>

getopt(1) and getopt(3)

man 1 getopt
man 3 getopt

For which there are implementations of varying quality in Java and other languages.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Jarrod Roberson
> Sent: Thursday, July 15, 2010 1:25 PM
> To: Antlr Interest
> Subject: [antlr-interest] Does anyone know of a grammar for parsing
> command line arguments UNIX style is preferred.
> 
> but both *NIX and Windows 2000 style would be great!
> 
> --
> Jarrod Roberson
> www.vertigrated.com/blog/
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From bill.andersen at mac.com  Thu Jul 15 14:36:33 2010
From: bill.andersen at mac.com (Bill Andersen)
Date: Thu, 15 Jul 2010 17:36:33 -0400
Subject: [antlr-interest] Stringtemplate - iteration of k,v pairs in map
Message-ID: <B69270F1-D96D-4A5F-835A-988DE7C95361@mac.com>

Folks,

I'd like to iterate over pairs in a map MAP with another template.  Something like

<MAP:other(); separator="\n">

other(<k,v>) ::= <<
value of <k> is <v>
>>

I know it's possible I just can't find it in the docs or by example on the web.

Anyone know if?  How?

	.bill


From klausmartinschitz at gmail.com  Sat Jul 17 03:48:36 2010
From: klausmartinschitz at gmail.com (Klaus Martinschitz)
Date: Sat, 17 Jul 2010 12:48:36 +0200
Subject: [antlr-interest] __Test__ Class
Message-ID: <4C418A84.5060403@gmail.com>

  Hi,

does anyone know why the __Test__ class which is produced by ANTLRWorks 
does not have the correct package information for Java language and why 
the wrong Parser Constructor is called?
The port number shouldn't be there. It's no problem to add package 
information and delete port number after recompile but it is not 
necessary I think....

The code generated by ANTLRWorks for the __Test__ class looks liket this.

import java.io.*;
import org.antlr.runtime.*;
import org.antlr.runtime.debug.DebugEventSocketProxy;
import at.netcrystals.cif_1_1.parser.*;

public class __Test__ {

     public static void main(String args[]) throws Exception {
         CIF1_1Lexer lex = new CIF1_1Lexer(new 
ANTLRFileStream("MyInputFile.cif", "UTF8"));
         CommonTokenStream tokens = new CommonTokenStream(lex);

         CIF1_1Parser g = new CIF1_1Parser(tokens, *49100*, null);
         try {
             g.parse();
         } catch (RecognitionException e) {
             e.printStackTrace();
         }
     }
}

Thanks,
Klaus

From paideng at 163.com  Sat Jul 17 07:44:22 2010
From: paideng at 163.com (Pai Deng)
Date: Sat, 17 Jul 2010 22:44:22 +0800
Subject: [antlr-interest] =?windows-1252?q?=93illegal_option_caseSensitive?=
 =?windows-1252?q?=94_in_ANTLR_v3=3F?=
Message-ID: <2512FDE8-884C-471F-8A3D-AD3CF114AAD2@163.com>

Hi, guys,

I'm new to ANTLR, using latest version 3.2.
When I try generate my first parser, there is always errors in console...as following:

error(133): Simple.g:3:1: illegal option caseSensitive
error(133): Simple.g:3:1: illegal option testLiterals

The options fragment in the grammar file is:

options {
	language=ActionScript;
	k=3;
	caseSensitive=false;
	testLiterals=false;
}

Yes the error message is clear enough. I just want to confirm are the options 'caseSensitive' and 'testLiterals' not supported in latest ANTLR? 
I can see the options on ANTLR v2's manual. If they are removed in v3, what should I do to get the same/similar functions? 

Anyone can help?
Many thanks.


Best Regards,
Pai Deng





From anteusz at freemail.hu  Sat Jul 17 08:11:52 2010
From: anteusz at freemail.hu (anteusz at freemail.hu)
Date: Sat, 17 Jul 2010 17:11:52 +0200
Subject: [antlr-interest]
 =?windows-1252?q?=93illegal_option_caseSensitive?=
 =?windows-1252?q?=94_in_ANTLR_v3=3F?=
In-Reply-To: <2512FDE8-884C-471F-8A3D-AD3CF114AAD2@163.com>
References: <2512FDE8-884C-471F-8A3D-AD3CF114AAD2@163.com>
Message-ID: <4C41C838.4010001@freemail.hu>

7/17/2010 4:44 PM keltez?ssel, Pai Deng ?rta:
> Hi, guys,
>
> I'm new to ANTLR, using latest version 3.2.
> When I try generate my first parser, there is always errors in console...as following:
>
> error(133): Simple.g:3:1: illegal option caseSensitive
> error(133): Simple.g:3:1: illegal option testLiterals
>
> The options fragment in the grammar file is:
>
> options {
> 	language=ActionScript;
> 	k=3;
> 	caseSensitive=false;
> 	testLiterals=false;
> }
>
> Yes the error message is clear enough. I just want to confirm are the options 'caseSensitive' and 'testLiterals' not supported in latest ANTLR?
> I can see the options on ANTLR v2's manual. If they are removed in v3, what should I do to get the same/similar functions?
>
> Anyone can help?
> Many thanks.
>
>
> Best Regards,
> Pai Deng
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>    
Yes, there is no such option in Antlr 3 any more.
Depending on your target you have to write some code,
There is a link which explains the solution:

http://www.antlr.org/wiki/pages/viewpage.action?pageId=1782

Marton Papp

From ramanand_mandayam at yahoo.com  Sat Jul 17 10:09:00 2010
From: ramanand_mandayam at yahoo.com (Ramanand Mandayam)
Date: Sat, 17 Jul 2010 10:09:00 -0700 (PDT)
Subject: [antlr-interest] C target, preincludes and postinclude
Message-ID: <763746.28067.qm@web33508.mail.mud.yahoo.com>

I am curious to know why the preincludes is named with a 's' at the end while the postinclude does not have an 's' at the end.? 

I had a typo in my grammar and specified it as @lexer::postincludes but the Antlr tool (with the C target option) did not generate any error messages -- took me a while to figure this one out.

Cheers

Ramanand

From a.moderacja at gmail.com  Sat Jul 17 13:26:08 2010
From: a.moderacja at gmail.com (Borneq)
Date: Sat, 17 Jul 2010 22:26:08 +0200
Subject: [antlr-interest] Fwd: Error in ANTLR v2 to v3 converter
In-Reply-To: <AANLkTilIJuuOdhjAGta7qgtvSLFgp7tcubSeBFssJnlu@mail.gmail.com>
References: <AANLkTilIJuuOdhjAGta7qgtvSLFgp7tcubSeBFssJnlu@mail.gmail.com>
Message-ID: <AANLkTinhkUEjsafen3pmM109NoMXzdJogV2c0ds8JnSn@mail.gmail.com>

> When I compile source from v2v3-0.2.tar.gz  I get error, no defined

has anyone such prblem?

From bkiers at gmail.com  Sat Jul 17 13:35:54 2010
From: bkiers at gmail.com (Bart Kiers)
Date: Sat, 17 Jul 2010 22:35:54 +0200
Subject: [antlr-interest] Fwd: Error in ANTLR v2 to v3 converter
In-Reply-To: <AANLkTinhkUEjsafen3pmM109NoMXzdJogV2c0ds8JnSn@mail.gmail.com>
References: <AANLkTilIJuuOdhjAGta7qgtvSLFgp7tcubSeBFssJnlu@mail.gmail.com>
	<AANLkTinhkUEjsafen3pmM109NoMXzdJogV2c0ds8JnSn@mail.gmail.com>
Message-ID: <AANLkTinFY0fsFs8xkrDClbCrFCfO76zw9gzhzV7e0EE6@mail.gmail.com>

On Sat, Jul 17, 2010 at 10:26 PM, Borneq <a.moderacja at gmail.com> wrote:

> > When I compile source from v2v3-0.2.tar.gz  I get error, no defined
>
> has anyone such prblem?
>
>
A word of advice: I think most of your questions don't get (m)any responses
because your questions are full of spelling errors and the level of details
you put into your questions is often to cry about: it's like going to the
doctor and the only thing you tell the good (wo)man is that you don't feel
too good. Your problem description "I get error, no defined" is far to
little for anyone to give you a hand. Note that there is no need to write
perfect English, but make an effort: things like 'prblem' is just sheer
laziness. Consider installing an English spell-checker in your web browser,
which spots typo's while you write your message (I couldn't live without
one!).

Best of luck.

Regards,

Bart.

From a.moderacja at gmail.com  Sat Jul 17 21:46:46 2010
From: a.moderacja at gmail.com (Borneq)
Date: Sun, 18 Jul 2010 06:46:46 +0200
Subject: [antlr-interest] Fwd: Error in ANTLR v2 to v3 converter
In-Reply-To: <AANLkTinFY0fsFs8xkrDClbCrFCfO76zw9gzhzV7e0EE6@mail.gmail.com>
References: <AANLkTilIJuuOdhjAGta7qgtvSLFgp7tcubSeBFssJnlu@mail.gmail.com>
	<AANLkTinhkUEjsafen3pmM109NoMXzdJogV2c0ds8JnSn@mail.gmail.com>
	<AANLkTinFY0fsFs8xkrDClbCrFCfO76zw9gzhzV7e0EE6@mail.gmail.com>
Message-ID: <AANLkTil63dtpt3cIoEUq8hK3wj3l4qm5OaFwRX92C_wb@mail.gmail.com>

2010/7/17 Bart Kiers <bkiers at gmail.com>:
> little for anyone to give you a hand. Note that there is?no need to write
> perfect English, but make an effort: things like 'prblem' is just sheer
> laziness. Consider installing an English spell-checker in your web browser,

I do not speak English well.
The problem occurs during the compilation of the converter as well
after grammar conversion.
Does anyone use a converter? If everything was in order, if he could
send me a compiled version of the converter?

From a.moderacja at gmail.com  Sat Jul 17 22:29:09 2010
From: a.moderacja at gmail.com (Borneq)
Date: Sun, 18 Jul 2010 07:29:09 +0200
Subject: [antlr-interest]  Error in ANTLR v2 to v3 converter
In-Reply-To: <4C428C24.502@kjchome.homeip.net>
References: <AANLkTilIJuuOdhjAGta7qgtvSLFgp7tcubSeBFssJnlu@mail.gmail.com>
	<AANLkTinhkUEjsafen3pmM109NoMXzdJogV2c0ds8JnSn@mail.gmail.com>
	<AANLkTinFY0fsFs8xkrDClbCrFCfO76zw9gzhzV7e0EE6@mail.gmail.com>
	<AANLkTil63dtpt3cIoEUq8hK3wj3l4qm5OaFwRX92C_wb@mail.gmail.com>
	<4C428C24.502@kjchome.homeip.net>
Message-ID: <AANLkTikBEDx-IMISpsneBQF64W8KoRFT5os1Sb6z9ry1@mail.gmail.com>

> far from it. ?But it is a good starting point.
> You must then complete the conversion by hand (probably by fixing the
> errors that ANTLR then delivers to you).

I can do it, but v2v3-0.2.tar.gz even does not  compile for me . I did
a little fields addings to compile but it is probably bad because the
output grammar is not quite resemble the version 3 but rather the
second.
I am look for for a different version of the converter than my
v2v3-0.2.tar.gz, preferably already compiled.


Andrzej Borucki

From anatol.pomozov at gmail.com  Sun Jul 18 13:03:37 2010
From: anatol.pomozov at gmail.com (Anatol Pomozov)
Date: Sun, 18 Jul 2010 13:03:37 -0700
Subject: [antlr-interest] Repository for ANTLR grammar files?
Message-ID: <AANLkTimV9hyGXdYgnU3WPzoNUZayk-7T-AJxN7lKWK88@mail.gmail.com>

Hi, antlr-dev.

Looking to the Grammars List page http://www.antlr.org/grammar/list I found
that it has 3 different grammars for javascript and 9 files for Java! This
is a quite difficult choice for people who needs a Java version.

I think that the main reason why ANTLR has so many duplicated grammars is
that it's difficult for people to share updates for the files. Instead
people just post a new 'updated grammar'.

My question is how to avoid duplicating grammars for the languages? I think
you could eliminate its number by having public repo for such files. If a
user improves the grammar file they could send a patch. And instead of
multiple grammar files for the same language we will have the-only-true
version of it.

So my suggestion to you, antlr developers. Put all up-to-date grammars to
Perforce repository and add a github mirror. And people could easily get the
latest version and share updates for it. Does it make sense?
<antlr-interest at antlr.org>

From pjura at o2.pl  Sun Jul 18 14:03:19 2010
From: pjura at o2.pl (=?UTF-8?Q?pjura?=)
Date: Sun, 18 Jul 2010 23:03:19 +0200
Subject: [antlr-interest] =?utf-8?q?MismatchedTokenException_in_C=23_targe?=
	=?utf-8?q?t?=
Message-ID: <741a5042.4da43393.4c436c17.a42cd@o2.pl>

Hello everybody, that's my first post on this list.

I've got a problem with C# ANTLR target. I've tried this on every
runtime version from > 3.1. MismatchedTokenException is thrown when
parsing the following input:

'/<link[^>]*rel=(["\'])[ \t]*(?:[^ \t"\']+[ \t]+)*?openid2.provider[
\t]*[^"\']*\\1[^>]*href=(["\'])([^"\']+)\\2[^>]*\/?>/i'

using the rules below:

STRING : STRING1 | STRING2;

fragment STRING1
       :       '"' (~( '\\' | '"') | '\\"' | '\\')* '"' ;

fragment STRING2
       :       '\'' (~( '\\' | '\'') | '\\\'' | '\\')* '\'' ;

The strange thing is in ANTLRWorks everything works fine and debugger
shows no errors. Does anybody got a clue?

Regards,
Piotr

From paideng at 163.com  Sun Jul 18 20:08:13 2010
From: paideng at 163.com (Pai Deng)
Date: Mon, 19 Jul 2010 11:08:13 +0800
Subject: [antlr-interest]
 =?windows-1252?q?=93illegal_option_caseSensitive?=
 =?windows-1252?q?=94_in_ANTLR_v3=3F?=
In-Reply-To: <4C41C838.4010001@freemail.hu>
References: <2512FDE8-884C-471F-8A3D-AD3CF114AAD2@163.com>
	<4C41C838.4010001@freemail.hu>
Message-ID: <E4E7FEC7-DCCE-4BAE-96AB-13AE5A9F5DC9@163.com>

Hi, Marton,
Yes! I use ActionScript in which I can pick the solution for Java/C#.
Thanks for your help!

Best Regards,
Pai Deng



On Jul 17, 2010, at 11:11 PM, anteusz at freemail.hu wrote:

> 7/17/2010 4:44 PM keltez?ssel, Pai Deng ?rta:
>> Hi, guys,
>> 
>> I'm new to ANTLR, using latest version 3.2.
>> When I try generate my first parser, there is always errors in console...as following:
>> 
>> error(133): Simple.g:3:1: illegal option caseSensitive
>> error(133): Simple.g:3:1: illegal option testLiterals
>> 
>> The options fragment in the grammar file is:
>> 
>> options {
>> 	language=ActionScript;
>> 	k=3;
>> 	caseSensitive=false;
>> 	testLiterals=false;
>> }
>> 
>> Yes the error message is clear enough. I just want to confirm are the options 'caseSensitive' and 'testLiterals' not supported in latest ANTLR?
>> I can see the options on ANTLR v2's manual. If they are removed in v3, what should I do to get the same/similar functions?
>> 
>> Anyone can help?
>> Many thanks.
>> 
>> 
>> Best Regards,
>> Pai Deng
>> 
>> 
>> 
>> 
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> 
>> 
>> 
> Yes, there is no such option in Antlr 3 any more.
> Depending on your target you have to write some code,
> There is a link which explains the solution:
> 
> http://www.antlr.org/wiki/pages/viewpage.action?pageId=1782
> 
> Marton Papp
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address



From cid at kynetx.com  Mon Jul 19 08:52:58 2010
From: cid at kynetx.com (Cid Dennis)
Date: Mon, 19 Jul 2010 09:52:58 -0600
Subject: [antlr-interest] Lex Matching Issues
Message-ID: <ABBBDF7C-202D-46FE-9CE3-9883D5456601@kynetx.com>

So I am new to ANTLR and have created a grammar but found a strange issue.  Because of the structure of the language I am parsing there can be tokens that match reserved works as variables but only when they are in a sub rule that does not use the reserved word.

In the example below "ruleset" is seen by the parser in two different ways.  The first is for the 'ruleset' token and the second is as a VAR token.  The problem is when the parser sees the second ruleset it is thinking the token is the "ruleset" token not the "VAR" token so it returns Mismatch token exception.  

How can I make it so that I can do this kind of parsing.   One work around I came up with was to change 'ruleset' in the grammar to be a VAR  but then it is not easy to see what the grammar looks like.  

In the end I do not care what the token is considered(VAR or 'ruleset') as long as the parser does the right thing and can parse the "assignment" if 'ruleset' is used on the left hand side of the assignment.   


Simple Example Input:

ruleset joe {
	rule myrulename is active {
		ruleset = "test";
	}	
}

Simple Grammer:

grammar test;
options {
  output=AST;
}

ID  :	('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'_')*
    ;

COMMENT
    :   '//' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
    |   '/*' ( options {greedy=false;} : . )* '*/' {$channel=HIDDEN;}
    ;

WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        ) {$channel=HIDDEN;}
    ;

STRING
    :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
    ;

fragment
EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;

fragment
HEX_DIGIT : ('0'..'9'|'a'..'f'|'A'..'F') ;

fragment
ESC_SEQ
    :   '\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
    |   UNICODE_ESC
    |   OCTAL_ESC
    ;

fragment
OCTAL_ESC
    :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7')
    ;

fragment
UNICODE_ESC
    :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
    ;
    
    
ruleset :	
	'ruleset' ID '{' rule* '}'
	;
	
rule 	:
	'rule' ID 'is' ('active'|'inactive'|'test') '{' assignment* '}'
	;


assignment :  
	ID '=' STRING ';'
	;

	

Thanks for the help

------------------------------------------
Cid Dennis






From jbb at acm.org  Mon Jul 19 09:19:34 2010
From: jbb at acm.org (John B. Brodie)
Date: Mon, 19 Jul 2010 12:19:34 -0400
Subject: [antlr-interest] Lex Matching Issues
In-Reply-To: <ABBBDF7C-202D-46FE-9CE3-9883D5456601@kynetx.com>
References: <ABBBDF7C-202D-46FE-9CE3-9883D5456601@kynetx.com>
Message-ID: <1279556374.4977.14.camel@gecko.home.org>

Greetings!
On Mon, 2010-07-19 at 09:52 -0600, Cid Dennis wrote:
> So I am new to ANTLR and have created a grammar but found a strange issue.  Because of the structure of the language I am parsing there can be tokens that match reserved works as variables but only when they are in a sub rule that does not use the reserved word.
> 
> In the example below "ruleset" is seen by the parser in two different ways.  The first is for the 'ruleset' token and the second is as a VAR token.  The problem is when the parser sees the second ruleset it is thinking the token is the "ruleset" token not the "VAR" token so it returns Mismatch token exception.  
> 
> How can I make it so that I can do this kind of parsing.   One work around I came up with was to change 'ruleset' in the grammar to be a VAR  but then it is not easy to see what the grammar looks like.  
> 
> In the end I do not care what the token is considered(VAR or 'ruleset') as long as the parser does the right thing and can parse the "assignment" if 'ruleset' is used on the left hand side of the assignment.   
> 
> 
> Simple Example Input:
> 
> ruleset joe {
> 	rule myrulename is active {
> 		ruleset = "test";
> 	}	
> }
> 
> Simple Grammer:
> 
> grammar test;
> options {
>   output=AST;
> }
> 
> ID  :	('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'_')*
>     ;
> 
> COMMENT
>     :   '//' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
>     |   '/*' ( options {greedy=false;} : . )* '*/' {$channel=HIDDEN;}
>     ;
> 
> WS  :   ( ' '
>         | '\t'
>         | '\r'
>         | '\n'
>         ) {$channel=HIDDEN;}
>     ;
> 
> STRING
>     :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
>     ;
> 
> fragment
> EXPONENT : ('e'|'E') ('+'|'-')? ('0'..'9')+ ;
> 
> fragment
> HEX_DIGIT : ('0'..'9'|'a'..'f'|'A'..'F') ;
> 
> fragment
> ESC_SEQ
>     :   '\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
>     |   UNICODE_ESC
>     |   OCTAL_ESC
>     ;
> 
> fragment
> OCTAL_ESC
>     :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
>     |   '\\' ('0'..'7') ('0'..'7')
>     |   '\\' ('0'..'7')
>     ;
> 
> fragment
> UNICODE_ESC
>     :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
>     ;
>     
>     
> ruleset :	
> 	'ruleset' ID '{' rule* '}'
> 	;
> 	
> rule 	:
> 	'rule' ID 'is' ('active'|'inactive'|'test') '{' assignment* '}'
> 	;
> 
> 
> assignment :  
> 	ID '=' STRING ';'
> 	;
> 
> 	
> 

This is a fairly frequently asked question. Please try to search the
mail archives and/or the wiki at antlr.org.

One of the usual solutions, I believe, is to create a parser rule that
accepts your ID along with the keywords that are appropriate. So your
assignment rule would become something like (untested):

assignment : lhs '=' STRING ';' ;
lhs : ID | 'ruleset' /* other keyword alternatives go here */ ;

a down-side to this approach is that one has to be very careful to not
introduce ambiguities. probably by having a different parser rule for
each context - can get large and ugly...

another solution is to not have any keywords in the lexer but use parser
predicates to identify the keywords. I do not usually use predicates, so
I do not remember the specific meta-syntax, but it would be something
like:

ruleset : {$LA(1).text == "ruleset"}?=>ID ;
// and replace all 'ruleset' to refer to the ruleset rule instead


hope this helps...
   -jbb



From adam.myers at utoronto.ca  Mon Jul 19 11:05:06 2010
From: adam.myers at utoronto.ca (myersada)
Date: Mon, 19 Jul 2010 11:05:06 -0700 (PDT)
Subject: [antlr-interest] Identifying character position (start and end) of
	tokens
Message-ID: <1279562706185-5313296.post@n2.nabble.com>


Hello,

I am using antlr/C# to create a scripting language with a step-through
debugger that highlights in yellow the line of code that is about to
execute. I was able to identify the line number based on the 'Line' property
of my Antlr-generated AST node (Antlr.Runtime.Tree.ITree,
Antlr.Runtime.Tree.CommonTree). Now I would like to identify the character
range corresponding to one of these AST nodes, so I can actually highlight
the exact part of the line that is about to execute, which is useful in
certain situations (e.g. a function call expression being used as a
parameter within another function call expression).

The trouble is, I am able to find the start position via the
'CharPositionInLine' property, but I have had no luck finding the end
position (or the length of the token text, which would be just as good).
What is the ideal/intended way of accessing this information from the object
types identified above?
-- 
View this message in context: http://antlr.1301665.n2.nabble.com/Identifying-character-position-start-and-end-of-tokens-tp5313296p5313296.html
Sent from the ANTLR mailing list archive at Nabble.com.

From andersen at highfleet.com  Mon Jul 19 11:29:52 2010
From: andersen at highfleet.com (Bill Andersen)
Date: Mon, 19 Jul 2010 14:29:52 -0400
Subject: [antlr-interest] Custom AST node type - guidance needed
Message-ID: <33922C0E-DB21-48F9-B2FC-379D0A3B80D6@highfleet.com>

Hi folks

Having some trouble making ASTs using a custom node type.  Before I ask any stupid questions, what is the best place to look on how to do this ( I'm using 3.2 )?  I'm finding bits and pieces, some of them contradictory.  For example I find this example

static class V extends CommonTree {
  public int x,y,z;
  public V(int ttype, int x, int y, int z) {
    this.x=x; this.y=y; this.z=z; token=new CommonToken(ttype,"");
  }
at http://www.antlr.org/wiki/display/ANTLR3/Tree+construction

When I try to define a constructor like this I'm forced to put a cast between on CommonToken to Token, which causes a runtime can't cast error.

What I want is really quite simple.  Need to add one extra field to my AST nodes to carry DSL type information.

Any help appreciated.  Thanks.

	.bill

Bill Andersen 
Highfleet, Inc. (www.highfleet.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204






From jbb at acm.org  Mon Jul 19 12:15:02 2010
From: jbb at acm.org (John B. Brodie)
Date: Mon, 19 Jul 2010 15:15:02 -0400
Subject: [antlr-interest] Custom AST node type - guidance needed
In-Reply-To: <33922C0E-DB21-48F9-B2FC-379D0A3B80D6@highfleet.com>
References: <33922C0E-DB21-48F9-B2FC-379D0A3B80D6@highfleet.com>
Message-ID: <1279566902.6160.3.camel@gecko.home.org>

On Mon, 2010-07-19 at 14:29 -0400, Bill Andersen wrote:
> Hi folks

Greetings!

> 
> Having some trouble making ASTs using a custom node type.  Before I ask any stupid questions, what is the best place to look on how to do this ( I'm using 3.2 )?  I'm finding bits and pieces, some of them contradictory.  For example I find this example
> 
> static class V extends CommonTree {
>   public int x,y,z;
>   public V(int ttype, int x, int y, int z) {
>     this.x=x; this.y=y; this.z=z; token=new CommonToken(ttype,"");
>   }
> at http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
> 
> When I try to define a constructor like this I'm forced to put a cast between on CommonToken to Token, which causes a runtime can't cast error.
> 
> What I want is really quite simple.  Need to add one extra field to my AST nodes to carry DSL type information.
> 
> Any help appreciated.  Thanks.

Unable to reproduce.

Attached please find a complete example derived from the grammar on the
above wiki page that uses the class V. maybe I'm using a different
example than yours?

Need more info....
   -jbb

-------------- next part --------------
grammar T;
options {output=AST; ASTLabelType=CommonTree;}
@members {
   static class V extends CommonTree {
      public int x,y,z;
      public V(int ttype, int x, int y, int z) {
         this.x=x; this.y=y; this.z=z; token=new CommonToken(ttype,"");
      }
      public V(int ttype, Token t, int x) { token=t; this.x=x; }
      public String toString() {
         return (token!=null?token.getText():"<null>")+"<V>:"+x+","+y+","+z;
      }
   }

   private static final String [] x = new String[] {
      "abcd"
   };

   public static void main(String [] args) {
      for( int i = 0; i < x.length; ++i ) {
         try {
            System.out.println("about to parse:`"+x[i]+"`");
            TLexer lexer = new TLexer(new ANTLRStringStream(x[i]));
            CommonTokenStream tokens = new CommonTokenStream(lexer);

            TParser parser = new TParser(tokens);
            TParser.a_return p_result = parser.a();

            CommonTree ast = p_result.tree;
            if( ast == null ) {
               System.out.println("resultant tree: is NULL");
            } else {
               System.out.println("resultant tree: " + ast.toStringTree());
            }
            System.out.println();
         } catch(Exception e) {
            e.printStackTrace();
         }
      }
   }
}

a : ID -> ID<V>[42,19,30] ID<V>[$ID,99] ;
ID : 'a'..'z'+ ;
WS : (' '|'\\n') {$channel=HIDDEN;} ;

From andersen at highfleet.com  Mon Jul 19 12:25:26 2010
From: andersen at highfleet.com (Bill Andersen)
Date: Mon, 19 Jul 2010 15:25:26 -0400
Subject: [antlr-interest] Custom AST node type - guidance needed
In-Reply-To: <1279566902.6160.3.camel@gecko.home.org>
References: <33922C0E-DB21-48F9-B2FC-379D0A3B80D6@highfleet.com>
	<1279566902.6160.3.camel@gecko.home.org>
Message-ID: <2985DB20-A92E-4D79-A0DA-5DF6AD89C4AC@highfleet.com>

Thanks John

Below is my class def..  Eclipse tells me the casts to Token below are required.  Running a grammar that executes these constructors tells me I can't cast to Token.

Here's a sample tree building expression where this class is used.

	^(AS_TYPE_LIST<ASNode>[s.getType($ID.text)] ID)

the getType method just looks up a ASType object by name from a table.

import org.antlr.runtime.tree.*;

import antlr.*;

public class ASNode extends CommonTree {
	
	public ASType type = null;
	
	public ASNode() { }
	
	public ASNode(int ttype, ASType type) {
		token = (Token) new CommonToken(ttype,"");
		this.type = type;
	}
	
	public ASNode(int ttype) {
		token = (Token) new CommonToken(ttype,"");
	}
	
	@Override
	public String toString() {
		return (token!=null?token.getText():"")+"<ASNode>;"+type;
	}

	@Override
	public Tree dupNode() {
		ASNode n = new ASNode();
		n.token = token;
		n.type = type;
		return n;
	}
	
}

On Jul 19, 2010, at 15:15 , John B. Brodie wrote:

> On Mon, 2010-07-19 at 14:29 -0400, Bill Andersen wrote:
>> Hi folks
> 
> Greetings!
> 
>> 
>> Having some trouble making ASTs using a custom node type.  Before I ask any stupid questions, what is the best place to look on how to do this ( I'm using 3.2 )?  I'm finding bits and pieces, some of them contradictory.  For example I find this example
>> 
>> static class V extends CommonTree {
>>  public int x,y,z;
>>  public V(int ttype, int x, int y, int z) {
>>    this.x=x; this.y=y; this.z=z; token=new CommonToken(ttype,"");
>>  }
>> at http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
>> 
>> When I try to define a constructor like this I'm forced to put a cast between on CommonToken to Token, which causes a runtime can't cast error.
>> 
>> What I want is really quite simple.  Need to add one extra field to my AST nodes to carry DSL type information.
>> 
>> Any help appreciated.  Thanks.
> 
> Unable to reproduce.
> 
> Attached please find a complete example derived from the grammar on the
> above wiki page that uses the class V. maybe I'm using a different
> example than yours?
> 
> Need more info....
>   -jbb
> 
> <T.g>

Bill Andersen 
Highfleet, Inc. (www.highfleet.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204






From ron.hunter-duvar at oracle.com  Mon Jul 19 12:33:27 2010
From: ron.hunter-duvar at oracle.com (Ron Hunter-Duvar)
Date: Mon, 19 Jul 2010 13:33:27 -0600
Subject: [antlr-interest] Lex Matching Issues
In-Reply-To: <ABBBDF7C-202D-46FE-9CE3-9883D5456601@kynetx.com>
References: <ABBBDF7C-202D-46FE-9CE3-9883D5456601@kynetx.com>
Message-ID: <4C44A887.80602@oracle.com>


Cid Dennis wrote:
> So I am new to ANTLR and have created a grammar but found a strange issue.  Because of the structure of the language I am parsing there can be tokens that match reserved works as variables but only when they are in a sub rule that does not use the reserved word.
>
> ...
Hi Cid,

I had to deal with a similar situation, and neither of the solutions 
suggested in the wiki worked for me 
(http://www.antlr.org/wiki/pages/viewpage.action?pageId=1741), and I 
haven't seen any other solutions described in the email. After a lot of 
experimentation I came up with a hybrid solution.

One approach described is to define identifier like this:

identifier : KEY1 | KEY2 | ... | ID ;

The reason that this doesn't work is that where you have a production 
that says "( KEY1 | identifier ) "Antlr reports a conflict and disables 
the second alternative unless it can resolve the conflict with its 
extended lookahead. So depending on which order you put them either KEY1 
or identifier gets disabled, neither of which gives you a working 
parser. The only way you would be able to make this work would be to 
define a different identifier production for every different situation, 
with the conflicting keywords removed. That might work for a handful of 
different keywords, but doesn't scale.

The other suggested solution is to create productions like this:

keyIF : {input.LT(1).getText().equals("if")}? ID ;
keyCALL : {input.LT(1).getText().equals("call")}? ID ;

This is even worse than the other solution. I don't think there is any 
way to make this work at all. The problem is that the semantic predicate 
doesn't get applied when doing looking ahead in other productions, only 
when actually trying to make the keyXXX productions. So everywhere you 
have "( key1 | identifier )", to Antlr this looks like "( ID | ID )". 
This completely throws the lookahead for a loop. In many cases it will 
actually generate a parser without warnings, but the actual lookahead 
it's doing is just wrong. For example, I had a case something like 
"(keyA keyB LEFT_BRACKET) | (keyC keyD keyE)". To Antler's lookahead 
analysis this said "(ID ID LEFT_BRACKET)|(ID ID ID)", so it generated 
lookahead that basically said "if (LT(3) == LEFT_BRACKET) option1 else 
option2". So it was taking other things like "C D (" and trying to parse 
them as "A B (", then of course throwing run time exceptions on the 
failed semantic predicates.

The hybrid approach I came up with was to define the keywords as 
separate token types and define an identifier rule like in the first 
approach, but then also create keyword productions similar to the second 
approach:

keyIF: {input.LT(1).getText().equals("if")}? IF ;

I know at first glance the semantic predicate seems pointless. But it 
causes Antlr to ignore the conflicts that it would have reported 
otherwise, resulting in a working grammar.

There are just two caveats with this approach. First, it can also 
suppress reporting of real conflicts, causing bugs in your parser. To 
avoid this it's a good idea to first develop and test the grammar 
without the semantic predicates in the keyword rules and without the 
keywords as alternatives in the identifier rule. Once you have the 
grammar working this way with no conflicts, then it's safe to put the 
other rules that handle the non-reserved keywords.

Second, all those semantic predicates can cause the size of the 
generated parser to blow up. It can cause syntactic predicates to have a 
lot of special states and make the DFAs huge. This may only be a problem 
with the Java runtime, where the JVM imposes extreme size limits on 
class size (64KB). With large grammars or complex lookahead situations 
it can result in an uncompilable Java class being generated.

Hope this helps,

Ron

-- 
Ron Hunter-Duvar | Software Developer V | 403-272-6580
Oracle Service Engineering
Gulf Canada Square 401 - 9th Avenue S.W., Calgary, AB, Canada T2P 3C5

All opinions expressed here are mine, and do not necessarily represent
those of my employer.


From jimi at temporal-wave.com  Mon Jul 19 12:38:33 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 19 Jul 2010 12:38:33 -0700
Subject: [antlr-interest] Lex Matching Issues
In-Reply-To: <4C44A887.80602@oracle.com>
Message-ID: <c6e59e27cf6fdb49ad324af8b7908c96@temporal-wave.com>

Use the:


identifier : KEY1 | KEY2 | ... | ID ;


But when you have:

r: KEY1 ...
 | identifier
 ;

You just need a one token predicate and lists the keyword stuff first.

r: (KEY!)=>KEY1 ...
 | identifier
 ;

I have built entire SQL parsers using this approach and SQL is probably the king of ambiguity in the regard.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Ron Hunter-Duvar
> Sent: Monday, July 19, 2010 12:33 PM
> To: Cid Dennis
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Lex Matching Issues
> 
> 
> Cid Dennis wrote:
> > So I am new to ANTLR and have created a grammar but found a strange
> issue.  Because of the structure of the language I am parsing there can
> be tokens that match reserved works as variables but only when they are
> in a sub rule that does not use the reserved word.
> >
> > ...
> Hi Cid,
> 
> I had to deal with a similar situation, and neither of the solutions
> suggested in the wiki worked for me
> (http://www.antlr.org/wiki/pages/viewpage.action?pageId=1741), and I
> haven't seen any other solutions described in the email. After a lot of
> experimentation I came up with a hybrid solution.
> 
> One approach described is to define identifier like this:
> 
> identifier : KEY1 | KEY2 | ... | ID ;
> 
> The reason that this doesn't work is that where you have a production
> that says "( KEY1 | identifier ) "Antlr reports a conflict and disables
> the second alternative unless it can resolve the conflict with its
> extended lookahead. So depending on which order you put them either
> KEY1
> or identifier gets disabled, neither of which gives you a working
> parser. The only way you would be able to make this work would be to
> define a different identifier production for every different situation,
> with the conflicting keywords removed. That might work for a handful of
> different keywords, but doesn't scale.
> 
> The other suggested solution is to create productions like this:
> 
> keyIF : {input.LT(1).getText().equals("if")}? ID ;
> keyCALL : {input.LT(1).getText().equals("call")}? ID ;
> 
> This is even worse than the other solution. I don't think there is any
> way to make this work at all. The problem is that the semantic
> predicate
> doesn't get applied when doing looking ahead in other productions, only
> when actually trying to make the keyXXX productions. So everywhere you
> have "( key1 | identifier )", to Antlr this looks like "( ID | ID )".
> This completely throws the lookahead for a loop. In many cases it will
> actually generate a parser without warnings, but the actual lookahead
> it's doing is just wrong. For example, I had a case something like
> "(keyA keyB LEFT_BRACKET) | (keyC keyD keyE)". To Antler's lookahead
> analysis this said "(ID ID LEFT_BRACKET)|(ID ID ID)", so it generated
> lookahead that basically said "if (LT(3) == LEFT_BRACKET) option1 else
> option2". So it was taking other things like "C D (" and trying to
> parse
> them as "A B (", then of course throwing run time exceptions on the
> failed semantic predicates.
> 
> The hybrid approach I came up with was to define the keywords as
> separate token types and define an identifier rule like in the first
> approach, but then also create keyword productions similar to the
> second
> approach:
> 
> keyIF: {input.LT(1).getText().equals("if")}? IF ;
> 
> I know at first glance the semantic predicate seems pointless. But it
> causes Antlr to ignore the conflicts that it would have reported
> otherwise, resulting in a working grammar.
> 
> There are just two caveats with this approach. First, it can also
> suppress reporting of real conflicts, causing bugs in your parser. To
> avoid this it's a good idea to first develop and test the grammar
> without the semantic predicates in the keyword rules and without the
> keywords as alternatives in the identifier rule. Once you have the
> grammar working this way with no conflicts, then it's safe to put the
> other rules that handle the non-reserved keywords.
> 
> Second, all those semantic predicates can cause the size of the
> generated parser to blow up. It can cause syntactic predicates to have
> a
> lot of special states and make the DFAs huge. This may only be a
> problem
> with the Java runtime, where the JVM imposes extreme size limits on
> class size (64KB). With large grammars or complex lookahead situations
> it can result in an uncompilable Java class being generated.
> 
> Hope this helps,
> 
> Ron
> 
> --
> Ron Hunter-Duvar | Software Developer V | 403-272-6580
> Oracle Service Engineering
> Gulf Canada Square 401 - 9th Avenue S.W., Calgary, AB, Canada T2P 3C5
> 
> All opinions expressed here are mine, and do not necessarily represent
> those of my employer.
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From j at junkwallah.org  Mon Jul 19 12:52:58 2010
From: j at junkwallah.org (Junkman)
Date: Mon, 19 Jul 2010 12:52:58 -0700
Subject: [antlr-interest] Custom AST node type - guidance needed
In-Reply-To: <2985DB20-A92E-4D79-A0DA-5DF6AD89C4AC@highfleet.com>
References: <33922C0E-DB21-48F9-B2FC-379D0A3B80D6@highfleet.com>	<1279566902.6160.3.camel@gecko.home.org>
	<2985DB20-A92E-4D79-A0DA-5DF6AD89C4AC@highfleet.com>
Message-ID: <4C44AD1A.9020807@junkwallah.org>

Hi Bill,

You have

import antlr.*;

instead of

import org.antlr.runtime.*;

Maybe that's the problem?

org.antlr.runtime.CommonToken implements org.antlr.runtime.Token, so
explicit casting seems out of wack.

Jay


Bill Andersen wrote:
> Thanks John
> 
> Below is my class def..  Eclipse tells me the casts to Token below are required.  Running a grammar that executes these constructors tells me I can't cast to Token.
> 
> Here's a sample tree building expression where this class is used.
> 
> 	^(AS_TYPE_LIST<ASNode>[s.getType($ID.text)] ID)
> 
> the getType method just looks up a ASType object by name from a table.
> 
> import org.antlr.runtime.tree.*;
> 
> import antlr.*;
> 
> public class ASNode extends CommonTree {
> 	
> 	public ASType type = null;
> 	
> 	public ASNode() { }
> 	
> 	public ASNode(int ttype, ASType type) {
> 		token = (Token) new CommonToken(ttype,"");
> 		this.type = type;
> 	}
> 	
> 	public ASNode(int ttype) {
> 		token = (Token) new CommonToken(ttype,"");
> 	}
> 	
> 	@Override
> 	public String toString() {
> 		return (token!=null?token.getText():"")+"<ASNode>;"+type;
> 	}
> 
> 	@Override
> 	public Tree dupNode() {
> 		ASNode n = new ASNode();
> 		n.token = token;
> 		n.type = type;
> 		return n;
> 	}
> 	
> }
> 
> On Jul 19, 2010, at 15:15 , John B. Brodie wrote:
> 
>> On Mon, 2010-07-19 at 14:29 -0400, Bill Andersen wrote:
>>> Hi folks
>> Greetings!
>>
>>> Having some trouble making ASTs using a custom node type.  Before I ask any stupid questions, what is the best place to look on how to do this ( I'm using 3.2 )?  I'm finding bits and pieces, some of them contradictory.  For example I find this example
>>>
>>> static class V extends CommonTree {
>>>  public int x,y,z;
>>>  public V(int ttype, int x, int y, int z) {
>>>    this.x=x; this.y=y; this.z=z; token=new CommonToken(ttype,"");
>>>  }
>>> at http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
>>>
>>> When I try to define a constructor like this I'm forced to put a cast between on CommonToken to Token, which causes a runtime can't cast error.
>>>
>>> What I want is really quite simple.  Need to add one extra field to my AST nodes to carry DSL type information.
>>>
>>> Any help appreciated.  Thanks.
>> Unable to reproduce.
>>
>> Attached please find a complete example derived from the grammar on the
>> above wiki page that uses the class V. maybe I'm using a different
>> example than yours?
>>
>> Need more info....
>>   -jbb
>>
>> <T.g>
> 
> Bill Andersen 
> Highfleet, Inc. (www.highfleet.com)
> 3600 O'Donnell Street, Suite 600
> Baltimore, MD 21224
> Office: +1.410.675.1201
> Cell: +1.443.858.6444
> Fax: +1.410.675.1204
> 
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From andersen at highfleet.com  Mon Jul 19 13:02:57 2010
From: andersen at highfleet.com (Bill Andersen)
Date: Mon, 19 Jul 2010 16:02:57 -0400
Subject: [antlr-interest] Custom AST node type - guidance needed
In-Reply-To: <4C44AD1A.9020807@junkwallah.org>
References: <33922C0E-DB21-48F9-B2FC-379D0A3B80D6@highfleet.com>	<1279566902.6160.3.camel@gecko.home.org>
	<2985DB20-A92E-4D79-A0DA-5DF6AD89C4AC@highfleet.com>
	<4C44AD1A.9020807@junkwallah.org>
Message-ID: <6E37D825-BA06-44FE-9390-28E0CE41CD91@highfleet.com>

Thanks Jay

That did it. 

On Jul 19, 2010, at 15:52 , Junkman wrote:

> Hi Bill,
> 
> You have
> 
> import antlr.*;
> 
> instead of
> 
> import org.antlr.runtime.*;
> 
> Maybe that's the problem?
> 
> org.antlr.runtime.CommonToken implements org.antlr.runtime.Token, so
> explicit casting seems out of wack.
> 
> Jay
> 
> 
> Bill Andersen wrote:
>> Thanks John
>> 
>> Below is my class def..  Eclipse tells me the casts to Token below are required.  Running a grammar that executes these constructors tells me I can't cast to Token.
>> 
>> Here's a sample tree building expression where this class is used.
>> 
>> 	^(AS_TYPE_LIST<ASNode>[s.getType($ID.text)] ID)
>> 
>> the getType method just looks up a ASType object by name from a table.
>> 
>> import org.antlr.runtime.tree.*;
>> 
>> import antlr.*;
>> 
>> public class ASNode extends CommonTree {
>> 	
>> 	public ASType type = null;
>> 	
>> 	public ASNode() { }
>> 	
>> 	public ASNode(int ttype, ASType type) {
>> 		token = (Token) new CommonToken(ttype,"");
>> 		this.type = type;
>> 	}
>> 	
>> 	public ASNode(int ttype) {
>> 		token = (Token) new CommonToken(ttype,"");
>> 	}
>> 	
>> 	@Override
>> 	public String toString() {
>> 		return (token!=null?token.getText():"")+"<ASNode>;"+type;
>> 	}
>> 
>> 	@Override
>> 	public Tree dupNode() {
>> 		ASNode n = new ASNode();
>> 		n.token = token;
>> 		n.type = type;
>> 		return n;
>> 	}
>> 	
>> }
>> 
>> On Jul 19, 2010, at 15:15 , John B. Brodie wrote:
>> 
>>> On Mon, 2010-07-19 at 14:29 -0400, Bill Andersen wrote:
>>>> Hi folks
>>> Greetings!
>>> 
>>>> Having some trouble making ASTs using a custom node type.  Before I ask any stupid questions, what is the best place to look on how to do this ( I'm using 3.2 )?  I'm finding bits and pieces, some of them contradictory.  For example I find this example
>>>> 
>>>> static class V extends CommonTree {
>>>> public int x,y,z;
>>>> public V(int ttype, int x, int y, int z) {
>>>>   this.x=x; this.y=y; this.z=z; token=new CommonToken(ttype,"");
>>>> }
>>>> at http://www.antlr.org/wiki/display/ANTLR3/Tree+construction
>>>> 
>>>> When I try to define a constructor like this I'm forced to put a cast between on CommonToken to Token, which causes a runtime can't cast error.
>>>> 
>>>> What I want is really quite simple.  Need to add one extra field to my AST nodes to carry DSL type information.
>>>> 
>>>> Any help appreciated.  Thanks.
>>> Unable to reproduce.
>>> 
>>> Attached please find a complete example derived from the grammar on the
>>> above wiki page that uses the class V. maybe I'm using a different
>>> example than yours?
>>> 
>>> Need more info....
>>>  -jbb
>>> 
>>> <T.g>
>> 
>> Bill Andersen 
>> Highfleet, Inc. (www.highfleet.com)
>> 3600 O'Donnell Street, Suite 600
>> Baltimore, MD 21224
>> Office: +1.410.675.1201
>> Cell: +1.443.858.6444
>> Fax: +1.410.675.1204
>> 
>> 
>> 
>> 
>> 
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> 
> 

Bill Andersen 
Highfleet, Inc. (www.highfleet.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204






From billy.oneal at gmail.com  Mon Jul 19 17:23:29 2010
From: billy.oneal at gmail.com (Billy O'Neal)
Date: Mon, 19 Jul 2010 20:23:29 -0400
Subject: [antlr-interest] Getting the Previously Matched Lexer Token in the
	C Target
Message-ID: <AANLkTinAt2M4nt3w6dhOYy3ZL49Yhqw2u-g4D3joRSCQ@mail.gmail.com>

Hello, Everyone :)

Was referred here from my StackOverflow question:
http://stackoverflow.com/questions/3278338/using-the-antlr-c-target-how-can-i-get-the-previously-matched-token-in-the-lexer

I'm quite new to ANTLR; and my Lexer needs to have a gated rule which
makes it valid if and only if it occurs directly after another rule.
If there's a way to get the previously emitted token type, that would
make that gating easy. Otherwise I have to fail over to a nasty hack
of turning the boolean flag off after every lexer rule.

Is it simple/easy to get that information in a lexer rule predicate?

Billy3
--------------------------------------------------------------
Intern - PreEmptive Solutions, LLC
Malware Response Instructor - BleepingComputer.com
Analyst, Security Team - TechSupportForum.com

From kirby.bohling at gmail.com  Mon Jul 19 17:49:45 2010
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Mon, 19 Jul 2010 19:49:45 -0500
Subject: [antlr-interest] Getting the Previously Matched Lexer Token in
	the C Target
In-Reply-To: <AANLkTinAt2M4nt3w6dhOYy3ZL49Yhqw2u-g4D3joRSCQ@mail.gmail.com>
References: <AANLkTinAt2M4nt3w6dhOYy3ZL49Yhqw2u-g4D3joRSCQ@mail.gmail.com>
Message-ID: <AANLkTikowjuQ9bxK6zl0mKhjnOzOCHepd6n_upGQIGaf@mail.gmail.com>

If you aren't going to lex that token to something else, I'm pretty
sure the right solution is to just lex it as the invalid token.  If
you are going to lex it to something else, then likely you have the
"keyword" vs. "id" problem (use one token for it in the lexer, and
pick which one it really is during parsing).  Which I believe is best
resolved by a gated predicate in the parser.  If it "looks" like legal
code, you'd be better of actually generating the error at the semantic
check phase.  You have a lot more context in order to generate a
useful error message at that point.

Kirby


On Mon, Jul 19, 2010 at 7:23 PM, Billy O'Neal <billy.oneal at gmail.com> wrote:
> Hello, Everyone :)
>
> Was referred here from my StackOverflow question:
> http://stackoverflow.com/questions/3278338/using-the-antlr-c-target-how-can-i-get-the-previously-matched-token-in-the-lexer
>
> I'm quite new to ANTLR; and my Lexer needs to have a gated rule which
> makes it valid if and only if it occurs directly after another rule.
> If there's a way to get the previously emitted token type, that would
> make that gating easy. Otherwise I have to fail over to a nasty hack
> of turning the boolean flag off after every lexer rule.
>
> Is it simple/easy to get that information in a lexer rule predicate?
>
> Billy3
> --------------------------------------------------------------
> Intern - PreEmptive Solutions, LLC
> Malware Response Instructor - BleepingComputer.com
> Analyst, Security Team - TechSupportForum.com
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From billy.oneal at gmail.com  Mon Jul 19 18:00:32 2010
From: billy.oneal at gmail.com (Billy O'Neal)
Date: Mon, 19 Jul 2010 21:00:32 -0400
Subject: [antlr-interest] Getting the Previously Matched Lexer Token in
	the C Target
In-Reply-To: <AANLkTikowjuQ9bxK6zl0mKhjnOzOCHepd6n_upGQIGaf@mail.gmail.com>
References: <AANLkTinAt2M4nt3w6dhOYy3ZL49Yhqw2u-g4D3joRSCQ@mail.gmail.com> 
	<AANLkTikowjuQ9bxK6zl0mKhjnOzOCHepd6n_upGQIGaf@mail.gmail.com>
Message-ID: <AANLkTilxDvWDx5Wqr2XqIGbHqTW5hALybrTgLwSA4v7X@mail.gmail.com>

Hello, Kirby Bohling.

It's similar to Keyword Vs. ID, but not exact. Consider the following inputs:

-arg#hashed#
Result:
ARGUMENT (Text="arg")
ARGEXTRA (Text="hashed")

-arg#hashed# #otherData#
Result:
ARGUMENT (Text="arg")
ARGEXTRA (Text="hashed")
OTHER (Text="#otherdata#")  <-- Note that the hashes need to be
included at this point, but excluded in the ARGEXTRA token type

#otherData#andsomemorethings
Result:
OTHER (Text="#otherData#andsomemorethings")  <-- If I just use a
common token for that, then there needs to be a lot of stitching going
on in the parser, posing a problem.

Finally, this:
-arg #hashed#
needs to be:
ARGUMENT (Text="arg")
OTHER (Text="hashed")

If I use a common token for things there, then the parser can't
correctly discern what to do here -- stitching together here would
actually be invalid because of the space, and because the whitespace
is dropped by the lexer, the parser cannot make that determination.

Does that make more sense?

Billy3
--------------------------------------------------------------
Intern - PreEmptive Solutions, LLC
Malware Response Instructor - BleepingComputer.com
Analyst, Security Team - TechSupportForum.com



On Mon, Jul 19, 2010 at 8:49 PM, Kirby Bohling <kirby.bohling at gmail.com> wrote:
> If you aren't going to lex that token to something else, I'm pretty
> sure the right solution is to just lex it as the invalid token. ?If
> you are going to lex it to something else, then likely you have the
> "keyword" vs. "id" problem (use one token for it in the lexer, and
> pick which one it really is during parsing). ?Which I believe is best
> resolved by a gated predicate in the parser. ?If it "looks" like legal
> code, you'd be better of actually generating the error at the semantic
> check phase. ?You have a lot more context in order to generate a
> useful error message at that point.
>
> Kirby
>
>
> On Mon, Jul 19, 2010 at 7:23 PM, Billy O'Neal <billy.oneal at gmail.com> wrote:
>> Hello, Everyone :)
>>
>> Was referred here from my StackOverflow question:
>> http://stackoverflow.com/questions/3278338/using-the-antlr-c-target-how-can-i-get-the-previously-matched-token-in-the-lexer
>>
>> I'm quite new to ANTLR; and my Lexer needs to have a gated rule which
>> makes it valid if and only if it occurs directly after another rule.
>> If there's a way to get the previously emitted token type, that would
>> make that gating easy. Otherwise I have to fail over to a nasty hack
>> of turning the boolean flag off after every lexer rule.
>>
>> Is it simple/easy to get that information in a lexer rule predicate?
>>
>> Billy3
>> --------------------------------------------------------------
>> Intern - PreEmptive Solutions, LLC
>> Malware Response Instructor - BleepingComputer.com
>> Analyst, Security Team - TechSupportForum.com
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>

From jbb at acm.org  Mon Jul 19 19:39:20 2010
From: jbb at acm.org (John B. Brodie)
Date: Mon, 19 Jul 2010 22:39:20 -0400
Subject: [antlr-interest] Getting the Previously Matched Lexer Token in
 the C Target
In-Reply-To: <AANLkTilxDvWDx5Wqr2XqIGbHqTW5hALybrTgLwSA4v7X@mail.gmail.com>
References: <AANLkTinAt2M4nt3w6dhOYy3ZL49Yhqw2u-g4D3joRSCQ@mail.gmail.com>
	<AANLkTikowjuQ9bxK6zl0mKhjnOzOCHepd6n_upGQIGaf@mail.gmail.com>
	<AANLkTilxDvWDx5Wqr2XqIGbHqTW5hALybrTgLwSA4v7X@mail.gmail.com>
Message-ID: <1279593560.17534.2.camel@gecko.home.org>

Greetings!

On Mon, 2010-07-19 at 21:00 -0400, Billy O'Neal wrote:
> Hello, Kirby Bohling.
> 
> It's similar to Keyword Vs. ID, but not exact. Consider the following inputs:
> 
> -arg#hashed#
> Result:
> ARGUMENT (Text="arg")
> ARGEXTRA (Text="hashed")
> 
> -arg#hashed# #otherData#
> Result:
> ARGUMENT (Text="arg")
> ARGEXTRA (Text="hashed")
> OTHER (Text="#otherdata#")  <-- Note that the hashes need to be
> included at this point, but excluded in the ARGEXTRA token type
> 
> #otherData#andsomemorethings
> Result:
> OTHER (Text="#otherData#andsomemorethings")  <-- If I just use a
> common token for that, then there needs to be a lot of stitching going
> on in the parser, posing a problem.
> 
> Finally, this:
> -arg #hashed#
> needs to be:
> ARGUMENT (Text="arg")
> OTHER (Text="hashed")
> 
> If I use a common token for things there, then the parser can't
> correctly discern what to do here -- stitching together here would
> actually be invalid because of the space, and because the whitespace
> is dropped by the lexer, the parser cannot make that determination.
> 

i had some fun with this. thanks! see attached (yes, i am weird)
   -jbb

-------------- next part --------------
grammar Test;

options {
   output = AST;
   ASTLabelType = CommonTree;
}

tokens { ARGUMENT; ARGEXTRA; OTHER; }

@members {
   private static final String [] x = new String[] {
      "-arg#hashed#",
      "-arg#hashed# #otherData#",
      "#otherData#andsomemorethings",
      "-arg #hashed#"
   };

   public static void main(String [] args) {
      for( int i = 0; i < x.length; ++i ) {
         try {
            System.out.println("about to parse:`"+x[i]+"`");
            TestLexer lexer = new TestLexer(new ANTLRStringStream(x[i]));
            CommonTokenStream tokens = new CommonTokenStream(lexer);

            TestParser parser = new TestParser(tokens);
            TestParser.start_return p_result = parser.start();

            CommonTree ast = p_result.tree;
            if( ast == null ) {
               System.out.println("resultant tree: is NULL");
            } else {
               System.out.println("resultant tree: " + ast.toStringTree());
            }
            System.out.println();
         } catch(Exception e) {
            e.printStackTrace();
         }
      }
   }
}

start : (arg|other) EOF!;

arg : argument
      ( ( ( argextra (WS other)? )? -> argument (argextra other?)? )
      | ( WS HASH ID HASH -> argument OTHER[$ID.text] )
      )
   ;

argument : DASH ID -> ARGUMENT[$ID.text] ;

argextra : HASH ID HASH -> ARGEXTRA[$ID.text] ;

other : o_data -> OTHER[$o_data.text] ;
o_data : ( HASH! | ID! )+ ; // avoid building a tree here, just want $text

DASH : '-' ;
HASH : '#' ;
ID : ('a'..'z'|'A'..'Z')+ ;
WS : ' '+ ;

From dinesha74 at yahoo.com  Mon Jul 19 20:50:16 2010
From: dinesha74 at yahoo.com (Dinesha Balasuriya Weragama)
Date: Mon, 19 Jul 2010 20:50:16 -0700 (PDT)
Subject: [antlr-interest] converting Java code to C for PHP grammar
Message-ID: <177383.42670.qm@web33207.mail.mud.yahoo.com>

I am relatively new to ANTLR and am trying to use the PHP grammar that has been used with the ANTLR PHP target.? This grammar handles the first input token separately as 
a first body string using the following Java Code to override the nextToken() function.

@lexer::members{
??? // Handle the first token, which will always be a BodyString.
??? public Token nextToken(){
??????? //The following code was pulled out from super.nextToken()
??????? if (input.index() == 0) {
??????????? try {
??????????????? state.token = null;
??????????????? state.channel = Token.DEFAULT_CHANNEL;
??????????????? state.tokenStartCharIndex = input.index();
??????????????? state.tokenStartCharPositionInLine = input.getCharPositionInLine();
??????????????? state.tokenStartLine = input.getLine();
??????????????? state.text = null;
??????????????? mFirstBodyString();
??????????????? state.type = BodyString;
??????????????? emit();
??????????????? return state.token;
??????????? } catch (NoViableAltException nva) {
??????????????? reportError(nva);
??????????????? recover(nva); // throw out current char and try again
??????????? } catch (RecognitionException re) {
??????????????? reportError(re);
??????????????? // match() routine has already called recover()
??????????? }?? ?
??????? }
??????? return super.nextToken();
??? }
}

mFirstBodyString is created to identify the first body string as the following fragment in the grammar.

fragment
FirstBodyString
??? : (('<' ~ '?')=> '<' | ~'<' )* '<?' ('php'?)
??? ;

I am attempting to convert this to C but end up with a runtime error with a pointer to memory location 0x0.? My attempted code (ignoring the error handling for now) is 
given below.

@lexer::apifuncs{
? TOKENSOURCE(ctx)->nextToken=myNextToken;
}

@lexer::members{

#include "phpTest.h"
???? pANTLR3_COMMON_TOKEN myNextToken(pANTLR3_TOKEN_SOURCE toksource){
??? ?
??????? pANTLR3_LEXER lexer;
?????? ?
??????? lexer=(pANTLR3_LEXER)(toksource->super);
??????? if(lexer->input->istream->index(lexer->input->istream)==0){
????????????? lexer->rec->state->token=NULL;
????????????? lexer->rec->state->channel=ANTLR3_TOKEN_DEFAULT_CHANNEL;
????????????? lexer->rec->state->tokenStartCharIndex=lexer->input->istream->index(lexer->input->istream);
????????????? lexer->rec->state->tokenStartCharPositionInLine=lexer->input->getCharPositionInLine(lexer->input);
????????????? lexer->rec->state->tokenStartLine=lexer->input->getLine(lexer->input);
????????????? lexer->rec->state->text=NULL;
????????????? mFirstBodyString(lex);
????????????? lexer->rec->state->type=BodyString;
????????????? lexer->emit(lexer);
????????????? return lexer->rec->state->token;
??????? }
??????? return lexer->rec->state->token;
???? }
}

phpTest.h just contains a global declaration of lex which is of type pphpLexer and is the lexer used in the test rig.? Please let me know what I'm doing wrong.




      

From support at questatechnologies.com  Tue Jul 20 05:23:11 2010
From: support at questatechnologies.com (Free HDL)
Date: Tue, 20 Jul 2010 12:23:11 +0000 (UTC)
Subject: [antlr-interest] estimate about creating a parser
References: <1146501850.5732.4.camel@localhost.localdomain>
	<006601c66d6f$f1168460$8a02a8c0@Fafnir>
Message-ID: <loom.20100720T140506-731@post.gmane.org>

Loring Craymer <craymer at ...> writes:

> 
> This is one of those cases where you should be looking to borrow rather than
> build, given the time constraints.  Google "VHDL ANTLR" and you will get a
> number of useful hits, including the VHDL parser posted on antlr.org
> (http://www.antlr.org/grammar/1086696923011/vhdlams/index.html).
> 
> --Loring
> 
> > -----Original Message-----
> > From: antlr-interest-bounces at ... [mailto:antlr-interest-
> > bounces at ...] On Behalf Of Sohail Somani
> > Sent: Monday, May 01, 2006 9:44 AM
> > To: duboimat at ...
> > Cc: antlr-interest at ...
> > Subject: Re: [antlr-interest] estimate about creating a parser
> > 
> > On Mon, 2006-05-01 at 12:14 -0400, duboimat at ... wrote:
> > > We would like to create a VHDL parser (with AST).
> > >
> > > Is it possible to create this parser in one month?
> > 
> > Its possible if you know antlr+VHDL well enough.
> 
> 


Hi,
   You can visit the Free EAD tool site-
http://www.questatechnologies.com
to download free tools/utlities around VHDL/Verilog.
I am listing some of these free utilities here-
  1) Verilog Netlist parser
  2) SoC builder, IP integration tool
  3) VHDL, Verilog testbench generator
  4) Intuitive VHDL/Verilog/Mixed sorting for proper analysis alongwith
     proper working library
  5) Design hierarchy bowser and module dependency browser
  6) VHDL2IPXACT, Verilog2VhdlEntity converter

All these are free utlities and you can get enhancement/customization
free of cost just by sending your requirement details. Prpmpt support
is there .

Thanks.



From bill.andersen at mac.com  Tue Jul 20 09:15:59 2010
From: bill.andersen at mac.com (Bill Andersen)
Date: Tue, 20 Jul 2010 12:15:59 -0400
Subject: [antlr-interest] Heterogeneous AST nodes: In, but not out..
Message-ID: <3A223AE6-0B81-4367-B40F-551272762513@mac.com>

Folks

So I got my problem fixed with *making* custom AST nodes.  I can make them and pass the right parameters to them.  Thanks to Jay for that.

Now, I'm trying to *use* them.

My AST consists of a mixture of ASNode (subclass of CommonTree) and CommonTree nodes.  Here's a production in a tree grammar I'm working on with template output:


options {

  ASTLabelType = CommonTree; 
  tokenVocab = AS;
  output = template;

}

<snip>

rule
	: ^(rNode=AS_RULE rName=ID alts+=alternative+)
	  { System.out.println($rNode); }
	  -> pRule( rName={$rName.text}, rType={????} )	
	;

Question is what to put in place of ???? to get an attribute value out of AS_RULE

Now, AS_RULE in input to this grammar is of type ASNode.  Relevant portions below:

public class ASNode extends CommonTree {
	
	public ASType rType = null;
	
	public ASNode() { }
	
	public ASNode(int ttype, ASType rType) {
		token = new CommonToken(ttype,"");
		this.rType = rType;
	}
	
	public ASNode(int ttype) {
		token = new CommonToken(ttype,"");
	}
	
	public ASType getRType() {
		return rType;
	}

}

If I put anything like $rNode.X, where X is a field or method access to an ASNode instance, I get a Java compile error.  ANTLR thinks $rNode is of type CommonTree.  So I figure I need to tell ANTLR what type to expect, so when I try

rule
	: ^(rNode=AS_RULE<ASNode> rName=ID alts+=alternative+)
	  { System.out.println($rNode); }
	  -> pRule( rName={$rName.text}, rType={$rNode.getRType()} )	
	;

I get the same compile error.  Maybe I can change the options of all my grammars to

	  ASTLabelType = ASNode; 

but that defeats the whole purpose of having hetergeneous nodes, not to mention I'm not sure what other side-effects this will cause.

So, what's the best way to get information out of these hetergeneous node objects?

	.bill




From parrt at cs.usfca.edu  Tue Jul 20 11:35:37 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 20 Jul 2010 11:35:37 -0700
Subject: [antlr-interest] Repository for ANTLR grammar files?
In-Reply-To: <AANLkTimV9hyGXdYgnU3WPzoNUZayk-7T-AJxN7lKWK88@mail.gmail.com>
References: <AANLkTimV9hyGXdYgnU3WPzoNUZayk-7T-AJxN7lKWK88@mail.gmail.com>
Message-ID: <B9C04B5A-E7A6-40EC-98F7-DB246A171626@cs.usfca.edu>

Hi Anatol,

Yeah,All of that is a mess and I keep thinking that what I'd like to do is create grammar repository at antlr.org that the ANTLR development environments could pull from like plug-ins.

Alas, I've so many responsibilities that take precedence, it's hard for me to allocate the time to do that.

Ter
On Jul 18, 2010, at 1:03 PM, Anatol Pomozov wrote:

> Hi, antlr-dev.
> 
> Looking to the Grammars List page http://www.antlr.org/grammar/list I found
> that it has 3 different grammars for javascript and 9 files for Java! This
> is a quite difficult choice for people who needs a Java version.
> 
> I think that the main reason why ANTLR has so many duplicated grammars is
> that it's difficult for people to share updates for the files. Instead
> people just post a new 'updated grammar'.
> 
> My question is how to avoid duplicating grammars for the languages? I think
> you could eliminate its number by having public repo for such files. If a
> user improves the grammar file they could send a patch. And instead of
> multiple grammar files for the same language we will have the-only-true
> version of it.
> 
> So my suggestion to you, antlr developers. Put all up-to-date grammars to
> Perforce repository and add a github mirror. And people could easily get the
> latest version and share updates for it. Does it make sense?
> <antlr-interest at antlr.org>
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From mattpalms at gmail.com  Tue Jul 20 15:10:18 2010
From: mattpalms at gmail.com (Matt Palmer)
Date: Tue, 20 Jul 2010 23:10:18 +0100
Subject: [antlr-interest] Parsing unicode specifications
Message-ID: <AANLkTinSjJ8XTgj3lm-HWiUX5U4R10X7UtuE9N6Yz0S0@mail.gmail.com>

Hi,

I've been trying to use the string grammar which antlrworks provides as a
template, to allow users to specify unicode and escaped characters from an
ASCII-only input.

What I don't get, is that all the escape characters simply end up in the
STRING token as ordinary characters, which is no different to not bothering
with all the escape sequence and unicode specifications at all:

The grammar which antlrworks provides if you tick the string box is this:

grammar testString;

string : STRING ;

STRING
    :  '"' ( ESC_SEQ | ~('\\'|'"') )* '"'
    ;

fragment
HEX_DIGIT : ('0'..'9'|'a'..'f'|'A'..'F') ;

fragment
ESC_SEQ
    :   '\\' ('b'|'t'|'n'|'f'|'r'|'\"'|'\''|'\\')
    |   UNICODE_ESC
    |   OCTAL_ESC
    ;

fragment
OCTAL_ESC
    :   '\\' ('0'..'3') ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7') ('0'..'7')
    |   '\\' ('0'..'7')
    ;

fragment
UNICODE_ESC
    :   '\\' 'u' HEX_DIGIT HEX_DIGIT HEX_DIGIT HEX_DIGIT
    ;


But this grammar seems to produce identical results - a string token simply
containing whatever is between the double quotes:

grammar testString2;

string : STRING ;

STRING
    :  '"' ~('"')* '"'  ;


So my question is, how do I actually do something with those escape and
unicode fragments, to actually assemble a string containing the escaped or
unicode characters, rather than just ending up with a string containing
whatever was between the double quotes?

Regards,

Matt Palmer.

From avalonxy at gmail.com  Wed Jul 21 04:35:49 2010
From: avalonxy at gmail.com (yu xiang)
Date: Wed, 21 Jul 2010 19:35:49 +0800
Subject: [antlr-interest] 'backtrack' not expected ';'
Message-ID: <AANLkTiktXGEEzw85bH5F_-JQkxD3jE512XO0iENFuSdK@mail.gmail.com>

In my grammer I wrote like this

************************
options {
 language=Java;
 k=*;
 backtrack=true;
 memoize=true;
 output=AST;
}
************************

When I generate the code, there is always the error 'backtrack' not expected
';'
I don't kown what's wrong with it.
Can anyone give me some help, thankyou!

From Dagi.Troegner at dlr.de  Wed Jul 21 05:48:21 2010
From: Dagi.Troegner at dlr.de (Dagi.Troegner at dlr.de)
Date: Wed, 21 Jul 2010 14:48:21 +0200
Subject: [antlr-interest] OCL to C++
Message-ID: <66601EEAAA3D164E8BA1F5CB561D459BDB1244@exbe4.intra.dlr.de>

Hi,

 

I am new in parser generation. What I need to do is to write a translation for OCL constraints to C++ target. Has anyone already tried to?

 

Thanks for any response! :-)

 

Joana


From adavis at ti.com  Wed Jul 21 09:21:57 2010
From: adavis at ti.com (Davis, Alan)
Date: Wed, 21 Jul 2010 11:21:57 -0500
Subject: [antlr-interest] disambiguating predicates / wrong decision code
Message-ID: <F8C55F6A02E92D48BDDFC6048552C6F1519B4604@dlee03.ent.ti.com>

I'm trying to use a disambiguating semantic predicate to differentiate expressions involving different-class identifiers. For example "A1+A2" is an "expr" while "V1+V2" is a "vexpr".  The problem is ANTLR seems to incorrectly predict a valid sentence, resulting in a syntax error, even though there is no warning about an ambiguity or anything.

Here is the grammar:

-----------------------------
grammar vexpr;
options { language = C; }

program : stat+ ;

stat  : vid '=' rhs ';'
      ;

rhs : vid             // handles V2
    | vexpr           // handles V2 + V3
    | expr            // handles(?) A1 + A2 
    ;

vexpr : vid '+' vid
      ;

expr: id
    | id '+' id
    ;

// IDs that start with 'V'
vid : { *(LT(1)->getText(LT(1))->chars) == 'V' }? ID 
    ;   

// IDs that don't start with 'V'
id  : { *(LT(1)->getText(LT(1))->chars) != 'V' }? ID 
    ; 

ID  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')* 
    ;

WS  :   (' ' | '\t' | '\r' | '\n')+ { $channel=HIDDEN; } 
    ;  

------------------
(The asymmetry in handling atoms is an artifact of the cutdown; if I move vid from rhs to vexpr this problem goes away).

The parser cannot parse the following input: V1 = A1 + A2 ;

When I look at the generated code for rhs (below), it seems to predict alternative 2 (vexpr) if LA(2) is '+' (8).  But '+' in that position is not sufficient to disambiguate alternative 2 from alternative 3!

This seems like a bug -- or am I missing something.

Here is the decision code (reformatted for brevity):

switch ( LA(1) )
{        
   case ID:
   {         
      if ( (LA(2) == 8) )   // '+'
         alt2=2;      // vexpr

      else if ( (( *(LT(1)->getText(LT(1))->chars) == 'V' )) )
         alt2=1;      // vid 

      else if ( (( *(LT(1)->getText(LT(1))->chars) != 'V' )) )
         alt2=3;      // expr

      else               
      {                  
         CONSTRUCTEX();
         ...      

- Alan Davis
  Texas Instruments

From parrt at cs.usfca.edu  Wed Jul 21 10:30:13 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 21 Jul 2010 10:30:13 -0700
Subject: [antlr-interest] using generics in next version of v3
Message-ID: <A0111A88-CECD-409B-909F-B2A6BB35DE9D@cs.usfca.edu>

Hi,

I'm  finding it hard to avoid using generics when updating the runtime for the upcoming v3.3. In principle, we can generate byte codes are compatible with all previous VMs. Is it okay if I start using generics in the runtime? v4, also in development, uses them for sure.

Ter

From jimi at temporal-wave.com  Wed Jul 21 11:47:57 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 21 Jul 2010 11:47:57 -0700
Subject: [antlr-interest] using generics in next version of v3
In-Reply-To: <A0111A88-CECD-409B-909F-B2A6BB35DE9D@cs.usfca.edu>
Message-ID: <606f96cd0612494caba7c2f177b27bae@temporal-wave.com>

Ter,

So long as we just the -target jsr14 javac option, then I think it is fine as anyone else can also use that option on their own code and the generics have no effect on the runtime byte code.

Jim



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Terence Parr
> Sent: Wednesday, July 21, 2010 10:30 AM
> To: antlr-interest at antlr.org interest
> Subject: [antlr-interest] using generics in next version of v3
> 
> Hi,
> 
> I'm  finding it hard to avoid using generics when updating the runtime
> for the upcoming v3.3. In principle, we can generate byte codes are
> compatible with all previous VMs. Is it okay if I start using generics
> in the runtime? v4, also in development, uses them for sure.
> 
> Ter
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From stefika at gmail.com  Wed Jul 21 12:06:33 2010
From: stefika at gmail.com (Andreas Stefik)
Date: Wed, 21 Jul 2010 14:06:33 -0500
Subject: [antlr-interest] using generics in next version of v3
In-Reply-To: <606f96cd0612494caba7c2f177b27bae@temporal-wave.com>
References: <A0111A88-CECD-409B-909F-B2A6BB35DE9D@cs.usfca.edu>
	<606f96cd0612494caba7c2f177b27bae@temporal-wave.com>
Message-ID: <AANLkTikh-ssSmyrh_lSGcj2UjFgwJUK9G2TyBRTHtOo2@mail.gmail.com>

Ter,

I'm not an antlr expert, but I will say that Oracle no longer even
supports versions of the JDK that do not support generics in their
major code bases anymore. For example, NetBeans 6.9 actually requires
JDK 6.

So, in my view, it's pretty reasonable to use them. I actually prefer
it, as it reduces warnings in the code.

Just my two cents,

Stefik

On Wed, Jul 21, 2010 at 1:47 PM, Jim Idle <jimi at temporal-wave.com> wrote:
> Ter,
>
> So long as we just the -target jsr14 javac option, then I think it is fine as anyone else can also use that option on their own code and the generics have no effect on the runtime byte code.
>
> Jim
>
>
>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Terence Parr
>> Sent: Wednesday, July 21, 2010 10:30 AM
>> To: antlr-interest at antlr.org interest
>> Subject: [antlr-interest] using generics in next version of v3
>>
>> Hi,
>>
>> I'm ?finding it hard to avoid using generics when updating the runtime
>> for the upcoming v3.3. In principle, we can generate byte codes are
>> compatible with all previous VMs. Is it okay if I start using generics
>> in the runtime? v4, also in development, uses them for sure.
>>
>> Ter
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From adavis at ti.com  Wed Jul 21 16:00:39 2010
From: adavis at ti.com (Davis, Alan)
Date: Wed, 21 Jul 2010 18:00:39 -0500
Subject: [antlr-interest] disambiguating predicates / wrong decision code
In-Reply-To: <4C472C38.5090102@oracle.com>
References: <F8C55F6A02E92D48BDDFC6048552C6F1519B4604@dlee03.ent.ti.com>
	<4C472C38.5090102@oracle.com>
Message-ID: <F8C55F6A02E92D48BDDFC6048552C6F1519B4BCD@dlee03.ent.ti.com>

Ron, thanks, I figured it was something along those lines. It's a bit confusing because I know there are some circumstances where predicates get hoisted into parents' decision code. I guess I need to learn not to rely on the absence of a warning. My semantic predicates are not as simple in reality as in the cutdown I posted so I can't use your suggestion -- but it's OK, I think I can work around this by defining the rules more cleverly. 

(Sorry I didn't see the earlier discussion; I'm a new subscriber and finding the relevant discussions is like drinking from a firehose).

-Alan

-----Original Message-----
From: Ron Hunter-Duvar [mailto:ron.hunter-duvar at oracle.com] 
Sent: Wednesday, July 21, 2010 12:20 PM
To: Davis, Alan
Cc: 'antlr-interest at antlr.org'
Subject: Re: [antlr-interest] disambiguating predicates / wrong decision code

This is an example of a problem I mentioned the other day in a 
discussion on dealing with non-reserved keywords. It's more of an 
inherent limitation in Antlr than a bug. Basically the semantic 
predicates in your vid and id rules are only used when actually matching 
those rules. They don't affect the lookahead analysis in the rules that 
use them. As far as lookahead analysis sees it, your rules are:

vexpr : ID '+' ID;
expr : ID | ID '+' ID;

But the existence of the semantic predicates suppresses the ambiguity 
warning. Antlr tries to generate a reasonable lookahead, but it cases 
like this it's usually wrong.

The simplest way to fix your particular case would be to create two 
different token types VID and ID:

VID  :   ('v'|'V') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
ID  :   ('a'..'u'|'w'..'z'|'A'..'U'|'U'..'Z'|'_') 
('a'..'z'|'A'..'Z'|'0'..'9'|'_')*

Then there's no ambiguity.

Ron


Davis, Alan wrote:
> I'm trying to use a disambiguating semantic predicate to differentiate expressions involving different-class identifiers. For example "A1+A2" is an "expr" while "V1+V2" is a "vexpr".  The problem is ANTLR seems to incorrectly predict a valid sentence, resulting in a syntax error, even though there is no warning about an ambiguity or anything.
>
> Here is the grammar:
>
> -----------------------------
> grammar vexpr;
> options { language = C; }
>
> program : stat+ ;
>
> stat  : vid '=' rhs ';'
>       ;
>
> rhs : vid             // handles V2
>     | vexpr           // handles V2 + V3
>     | expr            // handles(?) A1 + A2 
>     ;
>
> vexpr : vid '+' vid
>       ;
>
> expr: id
>     | id '+' id
>     ;
>
> // IDs that start with 'V'
> vid : { *(LT(1)->getText(LT(1))->chars) == 'V' }? ID 
>     ;   
>
> // IDs that don't start with 'V'
> id  : { *(LT(1)->getText(LT(1))->chars) != 'V' }? ID 
>     ; 
>
> ID  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')* 
>     ;
>
> WS  :   (' ' | '\t' | '\r' | '\n')+ { $channel=HIDDEN; } 
>     ;  
>
> ------------------
> (The asymmetry in handling atoms is an artifact of the cutdown; if I move vid from rhs to vexpr this problem goes away).
>
> The parser cannot parse the following input: V1 = A1 + A2 ;
>
> When I look at the generated code for rhs (below), it seems to predict alternative 2 (vexpr) if LA(2) is '+' (8).  But '+' in that position is not sufficient to disambiguate alternative 2 from alternative 3!
>
> This seems like a bug -- or am I missing something.
>
> Here is the decision code (reformatted for brevity):
>
> switch ( LA(1) )
> {        
>    case ID:
>    {         
>       if ( (LA(2) == 8) )   // '+'
>          alt2=2;      // vexpr
>
>       else if ( (( *(LT(1)->getText(LT(1))->chars) == 'V' )) )
>          alt2=1;      // vid 
>
>       else if ( (( *(LT(1)->getText(LT(1))->chars) != 'V' )) )
>          alt2=3;      // expr
>
>       else               
>       {                  
>          CONSTRUCTEX();
>          ...      
>
> - Alan Davis
>   Texas Instruments
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>   

-- 
Ron Hunter-Duvar | Software Developer V | 403-272-6580
Oracle Service Engineering
Gulf Canada Square 401 - 9th Avenue S.W., Calgary, AB, Canada T2P 3C5

All opinions expressed here are mine, and do not necessarily represent
those of my employer.


From Anders.Karlsson at sybase.com  Wed Jul 21 17:20:41 2010
From: Anders.Karlsson at sybase.com (Anders.Karlsson at sybase.com)
Date: Thu, 22 Jul 2010 08:20:41 +0800
Subject: [antlr-interest] using generics in next version of v3
In-Reply-To: <A0111A88-CECD-409B-909F-B2A6BB35DE9D@cs.usfca.edu>
References: <A0111A88-CECD-409B-909F-B2A6BB35DE9D@cs.usfca.edu>
Message-ID: <OF719C56E3.1BFF2DF0-ON48257768.000153F7-48257768.00021070@sybase.com>


Hi,

My only concern is Java ME (BlackBerry et al), Java ME doesn't support
generics so I had
to port the runtime and strip off generics (and some other things like some
containers),
not at a lot of work at the moment but if used more heavily in the future
then maybe
it will be too troublesome to port it to Java ME

Ideally it would be optional :-)

Just my $0.02


Thank you and kind regards,
Anders



Anders Karlsson | Staff SE II | Sybase Inc, Singapore, ( +65 6571 3125 | *
anders.karlsson at sybase.com
-- The competent programmer is fully aware of the strictly limited size of
his own skull; therefore he approaches the programming task in full
humility, and among other things he avoids clever tricks like the plague.
-- E.W. Dijkstra



                                                                           
             Terence Parr                                                  
             <parrt at cs.usfca.e                                             
             du>                                                        To 
             Sent by:                  "antlr-interest at antlr.org interest" 
             <antlr-interest-b         <antlr-interest at antlr.org>          
             ounces at antlr.org>                                          cc 
                                                                           
                                                                   Subject 
             07/22/2010 01:30          [antlr-interest] using generics in  
             AM                        next version of v3                  
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           




Hi,

I'm  finding it hard to avoid using generics when updating the runtime for
the upcoming v3.3. In principle, we can generate byte codes are compatible
with all previous VMs. Is it okay if I start using generics in the runtime?
v4, also in development, uses them for sure.

Ter

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address




From nvivo.misc at gmail.com  Wed Jul 21 18:03:02 2010
From: nvivo.misc at gmail.com (Natan)
Date: Wed, 21 Jul 2010 22:03:02 -0300
Subject: [antlr-interest] using generics in next version of v3
In-Reply-To: <A0111A88-CECD-409B-909F-B2A6BB35DE9D@cs.usfca.edu>
References: <A0111A88-CECD-409B-909F-B2A6BB35DE9D@cs.usfca.edu>
Message-ID: <4C4798C6.2080108@gmail.com>

  I believe its completely reasonable that new versions should use 
features present in current versions of the language. Generics are old 
already, and add good value to the code, so my vote is go ahead.

If someone needs to run antlr in older versions of the runtime, they can 
use 3.2, its not going away...

On 21/7/2010 14:30, Terence Parr wrote:
> Hi,
>
> I'm  finding it hard to avoid using generics when updating the runtime for the upcoming v3.3. In principle, we can generate byte codes are compatible with all previous VMs. Is it okay if I start using generics in the runtime? v4, also in development, uses them for sure.
>
> Ter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From billy.oneal at gmail.com  Wed Jul 21 19:04:36 2010
From: billy.oneal at gmail.com (Billy O'Neal)
Date: Wed, 21 Jul 2010 22:04:36 -0400
Subject: [antlr-interest] How can I emit multiple tokens in a lexer rule,
	using the C target?
Message-ID: <AANLkTilLD5yFtEHAUihyuCks8cxFjFy4RQ1DyYjSoBPu@mail.gmail.com>

There only seems to be documentation on how to do this using targets
with object oriented languages, which merely subclass the `emit`
method and wrap a buffer around it. This becomes a problem for the C
target of course because A. there are no virtual methods, and B. there
is no subclassing, and C. there is no (at least that I can find)
`emit` method.

Is there a way of accomplishing this with the C target?

Billy3
--------------------------------------------------------------
Intern - PreEmptive Solutions, LLC
Malware Response Instructor - BleepingComputer.com
Analyst, Security Team - TechSupportForum.com

From Anders.Karlsson at sybase.com  Wed Jul 21 19:09:46 2010
From: Anders.Karlsson at sybase.com (Anders.Karlsson at sybase.com)
Date: Thu, 22 Jul 2010 10:09:46 +0800
Subject: [antlr-interest] How can I emit multiple tokens in a lexer rule,
 using the C target?
In-Reply-To: <AANLkTilLD5yFtEHAUihyuCks8cxFjFy4RQ1DyYjSoBPu@mail.gmail.com>
References: <AANLkTilLD5yFtEHAUihyuCks8cxFjFy4RQ1DyYjSoBPu@mail.gmail.com>
Message-ID: <OF230A69CF.715AB7EF-ON48257768.000B73E8-48257768.000C0D24@sybase.com>

Yes, as it is designed so that instead of overloading
you basically change the default function pointers
to point to something else (which in a sense
exactly is what overloading does).

E.g. if you want to install your own error handler
for the lexer you set the pointer to point to another func:

...
lxr = MyLexerNew(input)

lxr->pLexer->rec->reportError = MyReportLexError;
...


I would imagine a similar thing can be done with the emitter
(although I haven't tried that)



Thank you and kind regards,
Anders



Anders Karlsson | Staff SE II | Sybase Inc, Singapore | ( +65 6571 3125 | *
andersk at sybase.com
-- The competent programmer is fully aware of the strictly limited size of
his own skull; therefore he approaches the programming task in full
humility, and among other things he avoids clever tricks like the plague.
-- E.W. Dijkstra



                                                                           
             "Billy O'Neal"                                                
             <billy.oneal at gmai                                             
             l.com>                                                     To 
             Sent by:                  antlr-interest at antlr.org            
             <antlr-interest-b                                          cc 
             ounces at antlr.org>                                             
                                                                   Subject 
                                       [antlr-interest] How can I emit     
             07/22/2010 10:04          multiple tokens in a lexer rule,    
             AM                        using the C target?                 
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           




There only seems to be documentation on how to do this using targets
with object oriented languages, which merely subclass the `emit`
method and wrap a buffer around it. This becomes a problem for the C
target of course because A. there are no virtual methods, and B. there
is no subclassing, and C. there is no (at least that I can find)
`emit` method.

Is there a way of accomplishing this with the C target?

Billy3
--------------------------------------------------------------
Intern - PreEmptive Solutions, LLC
Malware Response Instructor - BleepingComputer.com
Analyst, Security Team - TechSupportForum.com

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address




From jimi at temporal-wave.com  Wed Jul 21 20:56:56 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 21 Jul 2010 20:56:56 -0700
Subject: [antlr-interest] How can I emit multiple tokens in a lexer rule,
	using the C target?
In-Reply-To: <AANLkTilLD5yFtEHAUihyuCks8cxFjFy4RQ1DyYjSoBPu@mail.gmail.com>
Message-ID: <87a60388c3412245896d9de63a59b744@temporal-wave.com>

A) Yes there are, you just install your own pointer;
B) Yes there is, you just wrap the existing structure in your own,but ther are user definable fields which make things easier than trying to sub class;
C) Yes there is:

 lexer->emit(lexer);					/* Assemble the token and emit it to the stream */

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Billy O'Neal
> Sent: Wednesday, July 21, 2010 7:05 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] How can I emit multiple tokens in a lexer
> rule, using the C target?
> 
> There only seems to be documentation on how to do this using targets
> with object oriented languages, which merely subclass the `emit`
> method and wrap a buffer around it. This becomes a problem for the C
> target of course because A. there are no virtual methods, and B. there
> is no subclassing, and C. there is no (at least that I can find)
> `emit` method.
> 
> Is there a way of accomplishing this with the C target?
> 
> Billy3
> --------------------------------------------------------------
> Intern - PreEmptive Solutions, LLC
> Malware Response Instructor - BleepingComputer.com
> Analyst, Security Team - TechSupportForum.com
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From bill.andersen at mac.com  Thu Jul 22 12:26:57 2010
From: bill.andersen at mac.com (Bill Andersen)
Date: Thu, 22 Jul 2010 15:26:57 -0400
Subject: [antlr-interest] Custom AST nodes - attempt #2
Message-ID: <444F4418-A165-441B-A97F-FCF9B2FEA50D@mac.com>

Hi Folks,

This is my second attempt at asking this question.  Hopefully it is clear.  If not, please let me know.

I'm interested in using a custom AST node class to carry type information.

I do not want to build a custom TreeAdaptor to determine node type based on token id because only a few AST nodes will have to be of the custom class.

Here's a sample production from the tree generating grammar.

rule
	: ... match something ...
	-> ^(NODE<CustomType>[param] ...)
	;

So far so good.  I know how to do this.  

Let's say CustomType looks like this

class CustomType extends CommonTree {
	public T param;
	public CustomType(int ttype, T param) { ... }
	public T getParam() { ... }
	...
}

Now I have another grammar that consumes ASTs from the first grammar.  I want to do this:

rule
	: ^(NODE ...)
	  { ... do something with this information ... }
	;

So, what syntax do I need in the action to get a T-typed param value from this node?

Any help appreciated 

From parrt at cs.usfca.edu  Thu Jul 22 13:34:49 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 22 Jul 2010 13:34:49 -0700
Subject: [antlr-interest] Custom AST nodes - attempt #2
In-Reply-To: <444F4418-A165-441B-A97F-FCF9B2FEA50D@mac.com>
References: <444F4418-A165-441B-A97F-FCF9B2FEA50D@mac.com>
Message-ID: <BF31AE6D-9CFE-4EF7-8520-3BCE68CF1587@cs.usfca.edu>

Hi Bill. try setting ASTLabelType in tree grammar.
T
On Jul 22, 2010, at 12:26 PM, Bill Andersen wrote:

> Hi Folks,
> 
> This is my second attempt at asking this question.  Hopefully it is clear.  If not, please let me know.
> 
> I'm interested in using a custom AST node class to carry type information.
> 
> I do not want to build a custom TreeAdaptor to determine node type based on token id because only a few AST nodes will have to be of the custom class.
> 
> Here's a sample production from the tree generating grammar.
> 
> rule
> 	: ... match something ...
> 	-> ^(NODE<CustomType>[param] ...)
> 	;
> 
> So far so good.  I know how to do this.  
> 
> Let's say CustomType looks like this
> 
> class CustomType extends CommonTree {
> 	public T param;
> 	public CustomType(int ttype, T param) { ... }
> 	public T getParam() { ... }
> 	...
> }
> 
> Now I have another grammar that consumes ASTs from the first grammar.  I want to do this:
> 
> rule
> 	: ^(NODE ...)
> 	  { ... do something with this information ... }
> 	;
> 
> So, what syntax do I need in the action to get a T-typed param value from this node?
> 
> Any help appreciated 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From bill.andersen at mac.com  Thu Jul 22 17:33:00 2010
From: bill.andersen at mac.com (Bill Andersen)
Date: Thu, 22 Jul 2010 20:33:00 -0400
Subject: [antlr-interest] Custom AST nodes - attempt #2
In-Reply-To: <BF31AE6D-9CFE-4EF7-8520-3BCE68CF1587@cs.usfca.edu>
References: <444F4418-A165-441B-A97F-FCF9B2FEA50D@mac.com>
	<BF31AE6D-9CFE-4EF7-8520-3BCE68CF1587@cs.usfca.edu>
Message-ID: <A28DBB7C-FD9E-4D30-A532-B49A1BC2E982@mac.com>

Hi Ter

I set ASTLabelType = ASNode in options on the tree grammar

Got runtime cast error

Exception in thread "main" java.lang.ClassCastException: org.antlr.runtime.tree.CommonTree cannot be cast to com.hf.lang.eclif.ltt.ASNode

 in generated code:

            // /Users/bill/Documents/Eclipse Workspaces/workspace2/OWExperimental/LTT2/com/hf/lang/eclif/ltt/ASPass1.g:21:4: ^( AS_SPEC ( rule )+ )
            {
            root_0 = (ASNode)adaptor.nil();

I get what's going on in ANTLR - the default adaptor is spitting out CommonTree instances.  This seems to imply that one has to supply a custom adaptor.  Is this true?

WIth no adaptor and with ASTLabelType = CommonTree the tree grammar works just fine - with no actions.

Now, when I try to access a node in an action in a tree grammar as an ASNode, I can only get it to work with an explicit cast in the semantic action

simple_alt
	: AS_TYPE
   	{ System.out.println( ">>> " + ((ASNode) $AS_TYPE).nodeType ); }
	| ^(AS_SUBRULE ID)
	;

Is this the verdict?  Either write an adaptor that does the right thing or live with the casts?

On Jul 22, 2010, at 16:34 , Terence Parr wrote:

> Hi Bill. try setting ASTLabelType in tree grammar.
> T
> On Jul 22, 2010, at 12:26 PM, Bill Andersen wrote:
> 
>> Hi Folks,
>> 
>> This is my second attempt at asking this question.  Hopefully it is clear.  If not, please let me know.
>> 
>> I'm interested in using a custom AST node class to carry type information.
>> 
>> I do not want to build a custom TreeAdaptor to determine node type based on token id because only a few AST nodes will have to be of the custom class.
>> 
>> Here's a sample production from the tree generating grammar.
>> 
>> rule
>> 	: ... match something ...
>> 	-> ^(NODE<CustomType>[param] ...)
>> 	;
>> 
>> So far so good.  I know how to do this.  
>> 
>> Let's say CustomType looks like this
>> 
>> class CustomType extends CommonTree {
>> 	public T param;
>> 	public CustomType(int ttype, T param) { ... }
>> 	public T getParam() { ... }
>> 	...
>> }
>> 
>> Now I have another grammar that consumes ASTs from the first grammar.  I want to do this:
>> 
>> rule
>> 	: ^(NODE ...)
>> 	  { ... do something with this information ... }
>> 	;
>> 
>> So, what syntax do I need in the action to get a T-typed param value from this node?
>> 
>> Any help appreciated 
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From martijn.reuvers at gmail.com  Fri Jul 23 06:13:01 2010
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Fri, 23 Jul 2010 15:13:01 +0200
Subject: [antlr-interest] Custom AST nodes - attempt #2
In-Reply-To: <A28DBB7C-FD9E-4D30-A532-B49A1BC2E982@mac.com>
References: <444F4418-A165-441B-A97F-FCF9B2FEA50D@mac.com>
	<BF31AE6D-9CFE-4EF7-8520-3BCE68CF1587@cs.usfca.edu>
	<A28DBB7C-FD9E-4D30-A532-B49A1BC2E982@mac.com>
Message-ID: <AANLkTi=wjWFpteqN1XXTmtN1pbH7Xh8jO_S34biWk1AA@mail.gmail.com>

Hey Bill,

It seems so, but its not hard. Roughly you should create the adaptor
below this email, where you implement your own ASTNodes. And then set
it on the parser you are using, e.g:

    SimpleParser parser = new SimpleParser(new
CommonTokenStream(createLexer(value)));
    parser.setTreeAdaptor(new CustomTreeAdaptor());
    return parser

Martijn


----------------

public class CustomTreeAdaptor extends CommonTreeAdaptor  {

  @Override
  public Object create(Token payload) {
    return new ModelASTNode(payload);
  }

  @Override
  public Object dupNode(Object t) {
    if(t == null) {
      return null;
    }
    return create(((ModelASTNode)t).token);
  }

  @Override
  public Object errorNode(TokenStream input, Token start, Token stop,
RecognitionException e) {
    return new CustomErrorNode(input, start, stop, e);
  }

}



On Fri, Jul 23, 2010 at 2:33 AM, Bill Andersen <bill.andersen at mac.com> wrote:
> Hi Ter
>
> I set ASTLabelType = ASNode in options on the tree grammar
>
> Got runtime cast error
>
> Exception in thread "main" java.lang.ClassCastException: org.antlr.runtime.tree.CommonTree cannot be cast to com.hf.lang.eclif.ltt.ASNode
>
> ?in generated code:
>
> ? ? ? ? ? ?// /Users/bill/Documents/Eclipse Workspaces/workspace2/OWExperimental/LTT2/com/hf/lang/eclif/ltt/ASPass1.g:21:4: ^( AS_SPEC ( rule )+ )
> ? ? ? ? ? ?{
> ? ? ? ? ? ?root_0 = (ASNode)adaptor.nil();
>
> I get what's going on in ANTLR - the default adaptor is spitting out CommonTree instances. ?This seems to imply that one has to supply a custom adaptor. ?Is this true?
>
> WIth no adaptor and with ASTLabelType = CommonTree the tree grammar works just fine - with no actions.
>
> Now, when I try to access a node in an action in a tree grammar as an ASNode, I can only get it to work with an explicit cast in the semantic action
>
> simple_alt
> ? ? ? ?: AS_TYPE
> ? ? ? ?{ System.out.println( ">>> " + ((ASNode) $AS_TYPE).nodeType ); }
> ? ? ? ?| ^(AS_SUBRULE ID)
> ? ? ? ?;
>
> Is this the verdict? ?Either write an adaptor that does the right thing or live with the casts?
>
> On Jul 22, 2010, at 16:34 , Terence Parr wrote:
>
>> Hi Bill. try setting ASTLabelType in tree grammar.
>> T
>> On Jul 22, 2010, at 12:26 PM, Bill Andersen wrote:
>>
>>> Hi Folks,
>>>
>>> This is my second attempt at asking this question. ?Hopefully it is clear. ?If not, please let me know.
>>>
>>> I'm interested in using a custom AST node class to carry type information.
>>>
>>> I do not want to build a custom TreeAdaptor to determine node type based on token id because only a few AST nodes will have to be of the custom class.
>>>
>>> Here's a sample production from the tree generating grammar.
>>>
>>> rule
>>> ? ? ?: ... match something ...
>>> ? ? ?-> ^(NODE<CustomType>[param] ...)
>>> ? ? ?;
>>>
>>> So far so good. ?I know how to do this.
>>>
>>> Let's say CustomType looks like this
>>>
>>> class CustomType extends CommonTree {
>>> ? ? ?public T param;
>>> ? ? ?public CustomType(int ttype, T param) { ... }
>>> ? ? ?public T getParam() { ... }
>>> ? ? ?...
>>> }
>>>
>>> Now I have another grammar that consumes ASTs from the first grammar. ?I want to do this:
>>>
>>> rule
>>> ? ? ?: ^(NODE ...)
>>> ? ? ? ?{ ... do something with this information ... }
>>> ? ? ?;
>>>
>>> So, what syntax do I need in the action to get a T-typed param value from this node?
>>>
>>> Any help appreciated
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From billy.oneal at gmail.com  Sun Jul 25 09:11:03 2010
From: billy.oneal at gmail.com (Billy O'Neal)
Date: Sun, 25 Jul 2010 12:11:03 -0400
Subject: [antlr-interest] Mimicing Flex's State-Based Rules in ANTLR3?
Message-ID: <AANLkTiki6-gafz0yQQZE+Tr8XmUw4=9KoMoHpY-1SNFp@mail.gmail.com>

Is it possible to mimic Flex's "Start Conditions" in ANTLR's lexer?

I mean these ones: http://flex.sourceforge.net/manual/Start-Conditions.html

Billy3
--------------------------------------------------------------
Intern - PreEmptive Solutions, LLC
Malware Response Instructor - BleepingComputer.com
Analyst, Security Team - TechSupportForum.com

From billy.oneal at gmail.com  Sun Jul 25 20:50:34 2010
From: billy.oneal at gmail.com (Billy O'Neal)
Date: Sun, 25 Jul 2010 23:50:34 -0400
Subject: [antlr-interest] Mimicing Flex's State-Based Rules in ANTLR3?
In-Reply-To: <AANLkTiki6-gafz0yQQZE+Tr8XmUw4=9KoMoHpY-1SNFp@mail.gmail.com>
References: <AANLkTiki6-gafz0yQQZE+Tr8XmUw4=9KoMoHpY-1SNFp@mail.gmail.com>
Message-ID: <AANLkTik7dRQyk-NhKThwJumAAzXuQzj_LZa_FXhZ=Nz7@mail.gmail.com>

Doh! Nevermind -- I faked it using a state variable and a semantic
predicate. (And I saw Mr, Parr plans to add something like that in v4
natively).

Sorry for pelting your inboxes!

Billy3
--------------------------------------------------------------
Intern - PreEmptive Solutions, LLC
Malware Response Instructor - BleepingComputer.com
Analyst, Security Team - TechSupportForum.com



On Sun, Jul 25, 2010 at 12:11 PM, Billy O'Neal <billy.oneal at gmail.com> wrote:
> Is it possible to mimic Flex's "Start Conditions" in ANTLR's lexer?
>
> I mean these ones: http://flex.sourceforge.net/manual/Start-Conditions.html
>
> Billy3
> --------------------------------------------------------------
> Intern - PreEmptive Solutions, LLC
> Malware Response Instructor - BleepingComputer.com
> Analyst, Security Team - TechSupportForum.com
>

From hoot at ptpnow.com  Mon Jul 26 06:08:00 2010
From: hoot at ptpnow.com (Hoot Thompson)
Date: Mon, 26 Jul 2010 09:08:00 -0400
Subject: [antlr-interest] compiling 2.7 on suse 11
Message-ID: <1280149680.28725.8.camel@rightknee.leftknee.com>

Anybody seen/having this problem...

>> /usr/bin/make -C lib/cpp/src all                          
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
make[3]: Entering directory `/root/antlr-2.7.7/lib/cpp/src'
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/ANTLRUtil.cpp
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTFactory.cpp
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTNULLType.cpp
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTRefCount.cpp
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/BaseAST.cpp
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/BitSet.cpp
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharBuffer.cpp
***
compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
/root/antlr-2.7.7/scripts/../lib/cpp/antlr/CharScanner.hpp(565): error:
identifier "strcasecmp" is undefined
  		return (strcasecmp(x.c_str(),y.c_str())<0);
  		        ^

compilation aborted
for /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
(code 2)

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                      >> E R R O R <<
============================================================

icpc -O3 -xT -ip -no-prec-div -static -c  -I .
-I /root/antlr-2.7.7/scripts/../lib/cpp /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp



From athavar at web.de  Mon Jul 26 06:52:57 2010
From: athavar at web.de (S.Eifert)
Date: Mon, 26 Jul 2010 06:52:57 -0700 (PDT)
Subject: [antlr-interest] looking for rewrite rule - (UNION | EXCEPT)^ ALL?
	put in one token
Message-ID: <1280152377488-5338034.post@n2.nabble.com>


Hi everyone,

I'm working on an existing project with a SQL-Grammar. So I have strict
limitations to watch while I have to enhance the functions.
There's one rule which I just cant figure out how to solve. The following is
in the grammar so far.

query_exp
  : query_term ((UNION | EXCEPT)^ ALL?  query_term)*   
  ;

- query_term can reference back on query_exp
- UNION etc. are lexical rules to ignore casesensivity
example:
UNION : U N I O N;
EXCEP : E X C E P T;
The single letters are matched to their upper and lower counterpart.

I now need to change the way a UNION ALL is parsed. If I use the structure
above ALL will be a child of UNION. But I need a single Token named
UNIONALL. The rest of the structure needs to be the same. The treehandling
is in a part I can not touch.

What I tried:

query_exp
  : query_term ((UNION | UNIONALL | EXCEPT | EXCEPTALL)^ query_term)*   
  ;

- This does not work, because the lexical rules for UNION / UNIONALL
conflict each other. At least that seems to be the problem.

I tried to use a rewrite rule. I used an Integer to keep track of which
option (UNION/EXCEPT, maybe ALL) was chosen and put several conditioned
rewrite rules. The problem was the Integer in the Parser was inside an
if-clause and could not be read.

if ( state.backtracking==0 ) {
              int MYINTEGER = 0;
            }

Finally I tinkered with an additional rule where I build a String for the
option taken (EXCEPT ALL, EXCEPT.. etc) and tried to return this. I think I
was on the wrong track there.. it did not work at all.

Probably the solution is very simple and I just cant find. I would be very
thankfull for some input.
I'm using ANTLR 3.1.2

Cheers
Sandro
-- 
View this message in context: http://antlr.1301665.n2.nabble.com/looking-for-rewrite-rule-UNION-EXCEPT-ALL-put-in-one-token-tp5338034p5338034.html
Sent from the ANTLR mailing list archive at Nabble.com.

From ramanand_mandayam at yahoo.com  Mon Jul 26 07:35:24 2010
From: ramanand_mandayam at yahoo.com (Ramanand Mandayam)
Date: Mon, 26 Jul 2010 07:35:24 -0700 (PDT)
Subject: [antlr-interest] ANTLRworks exception messages
Message-ID: <4463.81400.qm@web33505.mail.mud.yahoo.com>

Whenever I launch ANTLRworks and navigate to the Edit->Preferences page I get 
the following exception trace on my shell/console that launched the tool.
I am using ANTLRworks 1.4.jar on UBUNTU Linux. I get the same error regardless 
of whether I use the openjdk or the Sun JDK (both versions at 6).

So far I have not had any serious issues with this message and my development 
effort but it sure would be nice to know what the tool is trying to tell me.
The command line I use to launch the tool is:

    java -jar antlrworks-1.4.jar

I notice that the file under question is a part of the jar and I am therefore 
somewhat puzzled about this message. 

Any help will be appreciated.

Cheers

Ramanand

java.io.FileNotFoundException: 
/data/GoedelTechnologies/parser/antlrworks-1.4.jar/templates/DBParserGlueCode.st 
(Not a directory)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(FileInputStream.java:137)
    at java.io.FileInputStream.<init>(FileInputStream.java:96)
    at org.antlr.works.utils.Utils.stringFromFile(Utils.java:43)
    at 
org.antlr.works.dialog.AWPrefsDialog.prepareTestRigTabValues(AWPrefsDialog.java:345)

    at 
org.antlr.works.dialog.AWPrefsDialog.prepareTestRigTab(AWPrefsDialog.java:336)
    at org.antlr.works.dialog.AWPrefsDialog.<init>(AWPrefsDialog.java:79)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at 
sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)

    at 
sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)

    at java.lang.reflect.Constructor.newInstance(Constructor.java:532)
    at java.lang.Class.newInstance0(Class.java:372)
    at java.lang.Class.newInstance(Class.java:325)
    at 
org.antlr.xjlib.appkit.app.XJApplication.displayPrefs(XJApplication.java:261)
    at 
org.antlr.xjlib.appkit.menu.XJMainMenuBar.handleMenuEvent(XJMainMenuBar.java:479)

    at 
org.antlr.xjlib.appkit.menu.XJMenuItem$MenuActionListener.actionPerformed(XJMenuItem.java:166)

    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2012)
    at 
javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2335)
    at 
javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:404)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.AbstractButton.doClick(AbstractButton.java:374)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(BasicMenuItemUI.java:1688)
    at 
javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(BasicMenuItemUI.java:1732)

    at java.awt.Component.processMouseEvent(Component.java:6108)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3267)
    at java.awt.Component.processEvent(Component.java:5873)
    at java.awt.Container.processEvent(Container.java:2105)
    at java.awt.Component.dispatchEventImpl(Component.java:4469)
    at java.awt.Container.dispatchEventImpl(Container.java:2163)
    at java.awt.Component.dispatchEvent(Component.java:4295)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4461)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4125)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4055)
    at java.awt.Container.dispatchEventImpl(Container.java:2149)
    at java.awt.Window.dispatchEventImpl(Window.java:2478)
    at java.awt.Component.dispatchEvent(Component.java:4295)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:604)
    at 
java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:275)

    at 
java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:200)
    at 
java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:190)

    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:185)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:177)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:138)

From jbb at acm.org  Mon Jul 26 07:35:44 2010
From: jbb at acm.org (John B. Brodie)
Date: Mon, 26 Jul 2010 10:35:44 -0400
Subject: [antlr-interest] looking for rewrite rule - (UNION | EXCEPT)^
 ALL? put in one token
In-Reply-To: <1280152377488-5338034.post@n2.nabble.com>
References: <1280152377488-5338034.post@n2.nabble.com>
Message-ID: <1280154944.18164.24.camel@gecko.home.org>

Greetings!

On Mon, 2010-07-26 at 06:52 -0700, S.Eifert wrote:
> Hi everyone,
> 
> I'm working on an existing project with a SQL-Grammar. So I have strict
> limitations to watch while I have to enhance the functions.
> There's one rule which I just cant figure out how to solve. The following is
> in the grammar so far.
> 
> query_exp
>   : query_term ((UNION | EXCEPT)^ ALL?  query_term)*   
>   ;
> 
> - query_term can reference back on query_exp
> - UNION etc. are lexical rules to ignore casesensivity
> example:
> UNION : U N I O N;
> EXCEP : E X C E P T;
> The single letters are matched to their upper and lower counterpart.
> 
> I now need to change the way a UNION ALL is parsed. If I use the structure
> above ALL will be a child of UNION. But I need a single Token named
> UNIONALL. The rest of the structure needs to be the same. The treehandling
> is in a part I can not touch.
> 
> What I tried:
> 
> query_exp
>   : query_term ((UNION | UNIONALL | EXCEPT | EXCEPTALL)^ query_term)*   
>   ;
> 
> - This does not work, because the lexical rules for UNION / UNIONALL
> conflict each other. At least that seems to be the problem.

having UNIONALL and EXCEPTALL tokens produced by the lexer is (IMHO) the
best way to go (but i have an alternative below, if my lexing suggestion
does not work...)

add a tokens { UNIONALL; EXCEPTALL; } section to your grammar just after
your options {...} section but before any rule.

modify the lexer rules for UNION and EXCEPT to be:

UNION : U N I O N ( WS A L L { $type=UNIONALL; } )? ;
EXCEPT : E X C E P T ( WS A L L { $type=EXCEPTALL; } )? ;
fragment WS :
    ( ' ' | '\t' | '\r' | '\n' )+ ; // token delimiting white-space

and now your modified query_exp rule above should work....

> 
> I tried to use a rewrite rule. I used an Integer to keep track of which
> option (UNION/EXCEPT, maybe ALL) was chosen and put several conditioned
> rewrite rules. The problem was the Integer in the Parser was inside an
> if-clause and could not be read.
> 
> if ( state.backtracking==0 ) {
>               int MYINTEGER = 0;
>             }
> 
> Finally I tinkered with an additional rule where I build a String for the
> option taken (EXCEPT ALL, EXCEPT.. etc) and tried to return this. I think I
> was on the wrong track there.. it did not work at all.

the second alternative (if the above lexing changes do not work out) is
similar to this (sort of). e.g. use a parsing rule to recognize the
union/except operator.

still need the tokens { } section for UNIONALL and EXCEPTALL

no change to the lexer.

add parser rule (very much untested, but should work, i think):

query_operator : UNION | EXCEPT
   | (tok=UNION ALL -> UNIONALL[$tok,"UNIONALL"] )
   | (tok=EXCEPT ALL -> EXCEPTALL[$tok,"EXCEPTALL"] )
   ;

query_exp : query_term ( query_operator^ query_term )* ;

> 
> Probably the solution is very simple and I just cant find. I would be very
> thankfull for some input.
> I'm using ANTLR 3.1.2
> 

hope this helps...
   -jbb



From bill.andersen at mac.com  Mon Jul 26 09:49:22 2010
From: bill.andersen at mac.com (Bill Andersen)
Date: Mon, 26 Jul 2010 12:49:22 -0400
Subject: [antlr-interest] ANTLRWorks - memory settings on OS X
Message-ID: <5198A773-7E96-421A-AD99-54A52898F28A@mac.com>

Hi Folks

Can someone remind me again how to do memory settings for ANTLRWorks on OS X.  Can't seem to find on the web but I know it's common to do this.

Right now I have the default of 64M of heap (which I think is what the number in the lower-right corner means)

Thanks

	.bill


From powerofazure at gmail.com  Mon Jul 26 09:55:24 2010
From: powerofazure at gmail.com (Nathan Eloe)
Date: Mon, 26 Jul 2010 11:55:24 -0500
Subject: [antlr-interest] ANTLRWorks - memory settings on OS X
In-Reply-To: <5198A773-7E96-421A-AD99-54A52898F28A@mac.com>
References: <5198A773-7E96-421A-AD99-54A52898F28A@mac.com>
Message-ID: <4C4DBDFC.3080008@gmail.com>

On 7/26/10 11:49 AM, Bill Andersen wrote:
> Hi Folks
> 
> Can someone remind me again how to do memory settings for ANTLRWorks on OS X.  Can't seem to find on the web but I know it's common to do this.
> 
> Right now I have the default of 64M of heap (which I think is what the number in the lower-right corner means)

I wasn't able to find a convenient way to do it either (probably
something in a plist somewhere, but I'm never sure.

The workaround I've been using is the following:

$ cd /Applications/ANTLRWorks.app/Contents/Resources/Java/
$ java -Xmx1024m -jar antlrworks.jar

I might be able to look into this more today (I have a few ideas about
where to look), but when I needed more memory, I was too busy to find
the "right" way to do it, so thus this quick and dirty fix.

Nathan

From bill.andersen at mac.com  Mon Jul 26 09:59:00 2010
From: bill.andersen at mac.com (Bill Andersen)
Date: Mon, 26 Jul 2010 12:59:00 -0400
Subject: [antlr-interest] ANTLRWorks - memory settings on OS X
In-Reply-To: <4C4DBDFC.3080008@gmail.com>
References: <5198A773-7E96-421A-AD99-54A52898F28A@mac.com>
	<4C4DBDFC.3080008@gmail.com>
Message-ID: <DEB00647-7333-4C90-BA67-86F67203D6E6@mac.com>

Thanks Nate

I was following the same process you were.  I seem to remember doing this about 1.5 yr ago but can't remember how.  It's some kind of plist somewhere.  I tried editing the one in the app bundle but that didn't work.  And the one in ~/Library/Preferences/...  seems not to be the right place.

Meanwhile I'll use your workaround and wait for guidance on what to do for a more robust solution.

Thanks.

	.bill

On Jul 26, 2010, at 12:55 , Nathan Eloe wrote:

> On 7/26/10 11:49 AM, Bill Andersen wrote:
>> Hi Folks
>> 
>> Can someone remind me again how to do memory settings for ANTLRWorks on OS X.  Can't seem to find on the web but I know it's common to do this.
>> 
>> Right now I have the default of 64M of heap (which I think is what the number in the lower-right corner means)
> 
> I wasn't able to find a convenient way to do it either (probably
> something in a plist somewhere, but I'm never sure.
> 
> The workaround I've been using is the following:
> 
> $ cd /Applications/ANTLRWorks.app/Contents/Resources/Java/
> $ java -Xmx1024m -jar antlrworks.jar
> 
> I might be able to look into this more today (I have a few ideas about
> where to look), but when I needed more memory, I was too busy to find
> the "right" way to do it, so thus this quick and dirty fix.
> 
> Nathan
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From powerofazure at gmail.com  Mon Jul 26 10:23:22 2010
From: powerofazure at gmail.com (Nathan Eloe)
Date: Mon, 26 Jul 2010 12:23:22 -0500
Subject: [antlr-interest] ANTLRWorks - memory settings on OS X
In-Reply-To: <5198A773-7E96-421A-AD99-54A52898F28A@mac.com>
References: <5198A773-7E96-421A-AD99-54A52898F28A@mac.com>
Message-ID: <4C4DC48A.9090102@gmail.com>

On 7/26/10 11:49 AM, Bill Andersen wrote:
> Hi Folks
> 
> Can someone remind me again how to do memory settings for ANTLRWorks on OS X.  Can't seem to find on the web but I know it's common to do this.
> 
> Right now I have the default of 64M of heap (which I think is what the number in the lower-right corner means)
> 
> Thanks
> 
> 	.bill
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
I just found it!
in the Info.plist in the Application bundle, add the following lines
right under <string>org.antlr.works.IDE</string>:

<key>VMOptions</key>
<array>
  <string>-Xms512m</string>
  <string>-Xmx1024m</string>
</array>

When I added them in vim, id didn't seem to take very well (of course, I
think I might have specified -Xmx twice, instead of -Xmx and -Xms.

If adding those in vim doesn't take, try editing them with the info
property list editor (automagically opens when you double click on the
plist in the bundle).

Hopefully that works for you too.  This seems like the kind of thing
that would be nice to have as an option somewhere in the IDE, if it's
possible...  Actually I wonder what the implications of running the
debugger and the like from a different java VM from within the IDE would
be, or if that were even possible...

From cid at kynetx.com  Mon Jul 26 11:17:07 2010
From: cid at kynetx.com (Cid Dennis)
Date: Mon, 26 Jul 2010 12:17:07 -0600
Subject: [antlr-interest] ANTLRWorks - memory settings on OS X
In-Reply-To: <4C4DBDFC.3080008@gmail.com>
References: <5198A773-7E96-421A-AD99-54A52898F28A@mac.com>
	<4C4DBDFC.3080008@gmail.com>
Message-ID: <577351E2-377A-42E3-91C5-D47C846B27B8@kynetx.com>

Just right click on the application in the application folder and select show package contents then
Navigate to Contents and open Info.plist 

Then add this inside the Java Key.  (Example Attached)

	VMOptions = -Xms256m -Xmx1024m -XX:MaxPermSize=250m



------------------------------------------
Cid Dennis
ph : 303 915 9381
em: cid at kynetx.com




On Jul 26, 2010, at 10:55 AM, Nathan Eloe wrote:

> On 7/26/10 11:49 AM, Bill Andersen wrote:
>> Hi Folks
>> 
>> Can someone remind me again how to do memory settings for ANTLRWorks on OS X.  Can't seem to find on the web but I know it's common to do this.
>> 
>> Right now I have the default of 64M of heap (which I think is what the number in the lower-right corner means)
> 
> I wasn't able to find a convenient way to do it either (probably
> something in a plist somewhere, but I'm never sure.
> 
> The workaround I've been using is the following:
> 
> $ cd /Applications/ANTLRWorks.app/Contents/Resources/Java/
> $ java -Xmx1024m -jar antlrworks.jar
> 
> I might be able to look into this more today (I have a few ideas about
> where to look), but when I needed more memory, I was too busy to find
> the "right" way to do it, so thus this quick and dirty fix.
> 
> Nathan
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Mon Jul 26 13:19:15 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 26 Jul 2010 13:19:15 -0700
Subject: [antlr-interest] compiling 2.7 on suse 11
In-Reply-To: <1280149680.28725.8.camel@rightknee.leftknee.com>
Message-ID: <122e5ad94a79aa4690683e1edf39415e@temporal-wave.com>

Operating system? Version of the compiler? Your runtime library isn't supplying this function as it stands basically.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Hoot Thompson
> Sent: Monday, July 26, 2010 6:08 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] compiling 2.7 on suse 11
> 
> Anybody seen/having this problem...
> 
> >> /usr/bin/make -C lib/cpp/src all
> >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
> make[3]: Entering directory `/root/antlr-2.7.7/lib/cpp/src'
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ANTLRUtil.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTFactory.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTNULLType.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTRefCount.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/BaseAST.cpp
> ***
> compiling /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/BitSet.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharBuffer.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> /root/antlr-2.7.7/scripts/../lib/cpp/antlr/CharScanner.hpp(565): error:
> identifier "strcasecmp" is undefined
>   		return (strcasecmp(x.c_str(),y.c_str())<0);
>   		        ^
> 
> compilation aborted
> for /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> (code 2)
> 
> xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
>                       >> E R R O R <<
> ============================================================
> 
> icpc -O3 -xT -ip -no-prec-div -static -c  -I .
> -I /root/antlr-2.7.7/scripts/../lib/cpp /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From jimi at temporal-wave.com  Mon Jul 26 13:24:54 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 26 Jul 2010 13:24:54 -0700
Subject: [antlr-interest] looking for rewrite rule - (UNION | EXCEPT)^
	ALL? put in one token
In-Reply-To: <1280152377488-5338034.post@n2.nabble.com>
Message-ID: <48117975e10f374992ce1a1c2e97ac48@temporal-wave.com>

: query_term (unionstuff^ | EXCEPT^ ALL?) query_term);

unionstuff
  : UNION
      (   ALL -> UNIONALL
        |     -> UNION
      )
  ;

Also, your lexer is likely going to be really slow if handle case sensitivity like that. It is better to specify in UPPER case then override LA, as per the wiki article.

Jim


> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of S.Eifert
> Sent: Monday, July 26, 2010 6:53 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] looking for rewrite rule - (UNION | EXCEPT)^
> ALL? put in one token
> 
> 
> Hi everyone,
> 
> I'm working on an existing project with a SQL-Grammar. So I have strict
> limitations to watch while I have to enhance the functions.
> There's one rule which I just cant figure out how to solve. The
> following is
> in the grammar so far.
> 
> query_exp
>   : query_term ((UNION | EXCEPT)^ ALL?  query_term)*
>   ;
> 
> - query_term can reference back on query_exp
> - UNION etc. are lexical rules to ignore casesensivity
> example:
> UNION : U N I O N;
> EXCEP : E X C E P T;
> The single letters are matched to their upper and lower counterpart.
> 
> I now need to change the way a UNION ALL is parsed. If I use the
> structure
> above ALL will be a child of UNION. But I need a single Token named
> UNIONALL. The rest of the structure needs to be the same. The
> treehandling
> is in a part I can not touch.
> 
> What I tried:
> 
> query_exp
>   : query_term ((UNION | UNIONALL | EXCEPT | EXCEPTALL)^ query_term)*
>   ;
> 
> - This does not work, because the lexical rules for UNION / UNIONALL
> conflict each other. At least that seems to be the problem.
> 
> I tried to use a rewrite rule. I used an Integer to keep track of which
> option (UNION/EXCEPT, maybe ALL) was chosen and put several conditioned
> rewrite rules. The problem was the Integer in the Parser was inside an
> if-clause and could not be read.
> 
> if ( state.backtracking==0 ) {
>               int MYINTEGER = 0;
>             }
> 
> Finally I tinkered with an additional rule where I build a String for
> the
> option taken (EXCEPT ALL, EXCEPT.. etc) and tried to return this. I
> think I
> was on the wrong track there.. it did not work at all.
> 
> Probably the solution is very simple and I just cant find. I would be
> very
> thankfull for some input.
> I'm using ANTLR 3.1.2
> 
> Cheers
> Sandro
> --
> View this message in context:
> http://antlr.1301665.n2.nabble.com/looking-for-rewrite-rule-UNION-
> EXCEPT-ALL-put-in-one-token-tp5338034p5338034.html
> Sent from the ANTLR mailing list archive at Nabble.com.
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From brian at brie.com  Mon Jul 26 20:27:41 2010
From: brian at brie.com (Brian Lavender)
Date: Mon, 26 Jul 2010 20:27:41 -0700
Subject: [antlr-interest] Fixed field
Message-ID: <20100727032740.GA20374@brie.com>

What's the best way to get the words out of a fixed field file? Say the title
is in the first 20 columns, and then the author is in the next 20?

Below is a feeble attempt that will get four letters, but I would like to ignore
any whitespace that occurs after the last letter before the end column. 

brian


grammar Foo;

title	:	LTR LTR LTR LTR '\n'{System.out.println($title.text);};

LTR 	:	('a'..'z'|'A'..'Z');

-- 
Brian Lavender
http://www.brie.com/brian/

"There are two ways of constructing a software design. One way is to
make it so simple that there are obviously no deficiencies. And the other
way is to make it so complicated that there are no obvious deficiencies."

Professor C. A. R. Hoare
The 1980 Turing award lecture

From paul at paulbmann.com  Mon Jul 26 22:56:08 2010
From: paul at paulbmann.com (Paul B Mann)
Date: Tue, 27 Jul 2010 00:56:08 -0500
Subject: [antlr-interest] DFAC: very-fast lexer generator for C/C++
Message-ID: <6783AC787B6B4F169494964CEADCF9F7@CompilerWare>

Hi, 

I have released DFAC, a DFA lexer generator for C/C++. 
It is freeware. 

It should work with ANTLR, however, I have not tried it yet to 
see if the generated lexers actually compile and run with ANTLR 
parsers.  Why?  Because I am not an ANTLR user at this time. 
I'm an LALR kind of guy working with Microsoft Visual C++. 

My testing of DFAC against 'flex' and 're2c' has shown that DFAC
creates lexers that are 2.1 times the speed of 'flex' lexers and 1% 
faster than 're2c' lexers.  DFAC lexers are 25% smaller than 're2c'
lexers for the C language and 50% smaller for the DB2 language 
(when having the lexer do keyword recognition). 

That brings up a nice feature of DFAC.  It recognizes keywords 
and identifiers at the same time (faster than having the symbol table 
recognize the keywords).  Also, you don't have to be concerned 
about the order of the rules in the lexical grammar input to DFAC.  
It solves the keyword-identifier ambiguity problem. 

Yes, DFAC reads a real lexical BNF grammar notation which
is actually more powerful than regular expressions (or at least
more readable).  If you have ever tried to define a C-like 
comment with regular expressions, you might appreciate the
way DFAC lets you do it. 

DFAC works very well with Microsoft Visual C++ 2008, 
by providing VS type error messages.  Just click on the error
message and it takes you to the source line causing the error. 

You can download DFAC at CompilerWare for FREE:
http://compilerware.com 

You are welcome to send comments or questions to me at
support at compilerware.com 

I never get tired of talking about this subject, and I've been
doing this since 1978.  I must be nuts, huh? 

Regards, 

Paul B Mann















From hoot at ptpnow.com  Tue Jul 27 04:37:17 2010
From: hoot at ptpnow.com (Hoot Thompson)
Date: Tue, 27 Jul 2010 07:37:17 -0400
Subject: [antlr-interest] compiling 2.7 on suse 11
In-Reply-To: <122e5ad94a79aa4690683e1edf39415e@temporal-wave.com>
References: <1280149680.28725.8.camel@rightknee.leftknee.com>
	<122e5ad94a79aa4690683e1edf39415e@temporal-wave.com>
Message-ID: <0EDEB9C02E484F8F8C125B12309A4EC2@ptpdesk>

Suse 11, 64-bit.  Tried it with both gcc (4.3.2) and Intel (11.1) 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Monday, July 26, 2010 4:19 PM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] compiling 2.7 on suse 11

Operating system? Version of the compiler? Your runtime library isn't
supplying this function as it stands basically.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest- 
> bounces at antlr.org] On Behalf Of Hoot Thompson
> Sent: Monday, July 26, 2010 6:08 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] compiling 2.7 on suse 11
> 
> Anybody seen/having this problem...
> 
> >> /usr/bin/make -C lib/cpp/src all
> >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
> make[3]: Entering directory `/root/antlr-2.7.7/lib/cpp/src'
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ANTLRUtil.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTFactory.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTNULLType.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTRefCount.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/BaseAST.cpp
> ***
> compiling 
> /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/BitSet.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharBuffer.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> /root/antlr-2.7.7/scripts/../lib/cpp/antlr/CharScanner.hpp(565): error:
> identifier "strcasecmp" is undefined
>   		return (strcasecmp(x.c_str(),y.c_str())<0);
>   		        ^
> 
> compilation aborted
> for /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> (code 2)
> 
> xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
>                       >> E R R O R <<
> ============================================================
> 
> icpc -O3 -xT -ip -no-prec-div -static -c  -I .
> -I /root/antlr-2.7.7/scripts/../lib/cpp /root/antlr- 
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address



From Darin.Mikesell at gd-ais.com  Tue Jul 27 07:08:31 2010
From: Darin.Mikesell at gd-ais.com (Mikesell, Darin B.)
Date: Tue, 27 Jul 2010 09:08:31 -0500
Subject: [antlr-interest] compiling 2.7 on suse 11
In-Reply-To: <0EDEB9C02E484F8F8C125B12309A4EC2@ptpdesk>
References: <1280149680.28725.8.camel@rightknee.leftknee.com>
	<122e5ad94a79aa4690683e1edf39415e@temporal-wave.com>
	<0EDEB9C02E484F8F8C125B12309A4EC2@ptpdesk>
Message-ID: <DBCB698FB6D4B643BF64C7B5025E37FBDED96F3150@EADC01-MABPRD11.ad.gd-ais.com>

I would say it seems to be the operating system install... there seem to be some missing libraries, one of which includes the function strcasecmp.  Do you have the ability to add/remove modules, perhaps you just need to add some extended libraries or such.



-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Hoot Thompson
Sent: Tuesday, July 27, 2010 4:37 AM
To: 'Jim Idle'; antlr-interest at antlr.org
Subject: Re: [antlr-interest] compiling 2.7 on suse 11

Suse 11, 64-bit.  Tried it with both gcc (4.3.2) and Intel (11.1) 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Monday, July 26, 2010 4:19 PM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] compiling 2.7 on suse 11

Operating system? Version of the compiler? Your runtime library isn't
supplying this function as it stands basically.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest- 
> bounces at antlr.org] On Behalf Of Hoot Thompson
> Sent: Monday, July 26, 2010 6:08 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] compiling 2.7 on suse 11
> 
> Anybody seen/having this problem...
> 
> >> /usr/bin/make -C lib/cpp/src all
> >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
> make[3]: Entering directory `/root/antlr-2.7.7/lib/cpp/src'
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ANTLRUtil.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTFactory.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTNULLType.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTRefCount.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/BaseAST.cpp
> ***
> compiling 
> /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/BitSet.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharBuffer.cpp
> ***
> compiling /root/antlr-
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> /root/antlr-2.7.7/scripts/../lib/cpp/antlr/CharScanner.hpp(565): error:
> identifier "strcasecmp" is undefined
>   		return (strcasecmp(x.c_str(),y.c_str())<0);
>   		        ^
> 
> compilation aborted
> for /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> (code 2)
> 
> xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
>                       >> E R R O R <<
> ============================================================
> 
> icpc -O3 -xT -ip -no-prec-div -static -c  -I .
> -I /root/antlr-2.7.7/scripts/../lib/cpp /root/antlr- 
> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jacobson.martin at gmail.com  Tue Jul 27 07:24:45 2010
From: jacobson.martin at gmail.com (Martin Jacobson)
Date: Tue, 27 Jul 2010 15:24:45 +0100
Subject: [antlr-interest] compiling 2.7 on suse 11
In-Reply-To: <DBCB698FB6D4B643BF64C7B5025E37FBDED96F3150@EADC01-MABPRD11.ad.gd-ais.com>
References: <1280149680.28725.8.camel@rightknee.leftknee.com>
	<122e5ad94a79aa4690683e1edf39415e@temporal-wave.com>
	<0EDEB9C02E484F8F8C125B12309A4EC2@ptpdesk>
	<DBCB698FB6D4B643BF64C7B5025E37FBDED96F3150@EADC01-MABPRD11.ad.gd-ais.com>
Message-ID: <AANLkTikkaNDLxx_RaRYrrcNL01f6Zg3FfxbLiSyQxZ8+@mail.gmail.com>

It's not the runtime library that's missing - the compiler can't find
the declaration of strcasecmp - this is is in <strings.h> .  Is it
#included ? Or is <strings.h> missing?

Martin

On 27 July 2010 15:08, Mikesell, Darin B. <Darin.Mikesell at gd-ais.com> wrote:
> I would say it seems to be the operating system install... there seem to be some missing libraries, one of which includes the function strcasecmp. ?Do you have the ability to add/remove modules, perhaps you just need to add some extended libraries or such.
>
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Hoot Thompson
> Sent: Tuesday, July 27, 2010 4:37 AM
> To: 'Jim Idle'; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] compiling 2.7 on suse 11
>
> Suse 11, 64-bit. ?Tried it with both gcc (4.3.2) and Intel (11.1)
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
> Sent: Monday, July 26, 2010 4:19 PM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] compiling 2.7 on suse 11
>
> Operating system? Version of the compiler? Your runtime library isn't
> supplying this function as it stands basically.
>
> Jim
>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Hoot Thompson
>> Sent: Monday, July 26, 2010 6:08 AM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] compiling 2.7 on suse 11
>>
>> Anybody seen/having this problem...
>>
>> >> /usr/bin/make -C lib/cpp/src all
>> >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>> make[3]: Entering directory `/root/antlr-2.7.7/lib/cpp/src'
>> ***
>> compiling /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ANTLRUtil.cpp
>> ***
>> compiling /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTFactory.cpp
>> ***
>> compiling /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTNULLType.cpp
>> ***
>> compiling /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTRefCount.cpp
>> ***
>> compiling /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/BaseAST.cpp
>> ***
>> compiling
>> /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/BitSet.cpp
>> ***
>> compiling /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharBuffer.cpp
>> ***
>> compiling /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
>> /root/antlr-2.7.7/scripts/../lib/cpp/antlr/CharScanner.hpp(565): error:
>> identifier "strcasecmp" is undefined
>> ? ? ? ? ? ? ? return (strcasecmp(x.c_str(),y.c_str())<0);
>> ? ? ? ? ? ? ? ? ? ? ? ^
>>
>> compilation aborted
>> for /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
>> (code 2)
>>
>> xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
>> ? ? ? ? ? ? ? ? ? ? ? >> E R R O R <<
>> ============================================================
>>
>> icpc -O3 -xT -ip -no-prec-div -static -c ?-I .
>> -I /root/antlr-2.7.7/scripts/../lib/cpp /root/antlr-
>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
>From my MacBook Pro

From powerofazure at gmail.com  Tue Jul 27 07:31:02 2010
From: powerofazure at gmail.com (Nathan Eloe)
Date: Tue, 27 Jul 2010 09:31:02 -0500
Subject: [antlr-interest] compiling 2.7 on suse 11
In-Reply-To: <AANLkTikkaNDLxx_RaRYrrcNL01f6Zg3FfxbLiSyQxZ8+@mail.gmail.com>
References: <1280149680.28725.8.camel@rightknee.leftknee.com>	<122e5ad94a79aa4690683e1edf39415e@temporal-wave.com>	<0EDEB9C02E484F8F8C125B12309A4EC2@ptpdesk>	<DBCB698FB6D4B643BF64C7B5025E37FBDED96F3150@EADC01-MABPRD11.ad.gd-ais.com>
	<AANLkTikkaNDLxx_RaRYrrcNL01f6Zg3FfxbLiSyQxZ8+@mail.gmail.com>
Message-ID: <4C4EEDA6.2050901@gmail.com>

I don't know if this is helpful, but recently a lot of the stl libraries
were rewritten to not include as many other libraries.  The easiest
example I have is that I used to be able to use std::exit when I
included iostream, but now I have to remember to include cstdlib.  I'm
willing to bet that some library that included cstring (or string.h) now
doesn't. I don't know exactly when 2.7 came out (or even which version
of GCC marked these changes).  What happens when you try to compile it
with an older (say... 3.x.x) version of GCC.

Nathan

On 7/27/10 9:24 AM, Martin Jacobson wrote:
> It's not the runtime library that's missing - the compiler can't find
> the declaration of strcasecmp - this is is in <strings.h> .  Is it
> #included ? Or is <strings.h> missing?
> 
> Martin
> 
> On 27 July 2010 15:08, Mikesell, Darin B. <Darin.Mikesell at gd-ais.com> wrote:
>> I would say it seems to be the operating system install... there seem to be some missing libraries, one of which includes the function strcasecmp.  Do you have the ability to add/remove modules, perhaps you just need to add some extended libraries or such.
>>
>>
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Hoot Thompson
>> Sent: Tuesday, July 27, 2010 4:37 AM
>> To: 'Jim Idle'; antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] compiling 2.7 on suse 11
>>
>> Suse 11, 64-bit.  Tried it with both gcc (4.3.2) and Intel (11.1)
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org
>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
>> Sent: Monday, July 26, 2010 4:19 PM
>> To: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] compiling 2.7 on suse 11
>>
>> Operating system? Version of the compiler? Your runtime library isn't
>> supplying this function as it stands basically.
>>
>> Jim
>>
>>> -----Original Message-----
>>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>>> bounces at antlr.org] On Behalf Of Hoot Thompson
>>> Sent: Monday, July 26, 2010 6:08 AM
>>> To: antlr-interest at antlr.org
>>> Subject: [antlr-interest] compiling 2.7 on suse 11
>>>
>>> Anybody seen/having this problem...
>>>
>>>>> /usr/bin/make -C lib/cpp/src all
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
>>> make[3]: Entering directory `/root/antlr-2.7.7/lib/cpp/src'
>>> ***
>>> compiling /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ANTLRUtil.cpp
>>> ***
>>> compiling /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTFactory.cpp
>>> ***
>>> compiling /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTNULLType.cpp
>>> ***
>>> compiling /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/ASTRefCount.cpp
>>> ***
>>> compiling /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/BaseAST.cpp
>>> ***
>>> compiling
>>> /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/BitSet.cpp
>>> ***
>>> compiling /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharBuffer.cpp
>>> ***
>>> compiling /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
>>> /root/antlr-2.7.7/scripts/../lib/cpp/antlr/CharScanner.hpp(565): error:
>>> identifier "strcasecmp" is undefined
>>>               return (strcasecmp(x.c_str(),y.c_str())<0);
>>>                       ^
>>>
>>> compilation aborted
>>> for /root/antlr-2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
>>> (code 2)
>>>
>>> xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
>>>                       >> E R R O R <<
>>> ============================================================
>>>
>>> icpc -O3 -xT -ip -no-prec-div -static -c  -I .
>>> -I /root/antlr-2.7.7/scripts/../lib/cpp /root/antlr-
>>> 2.7.7/lib/cpp/src/../../../lib/cpp/src/CharScanner.cpp
>>>
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>>> email-address
>>
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
> 
> 
> 


From athavar at web.de  Tue Jul 27 09:39:16 2010
From: athavar at web.de (S.Eifert)
Date: Tue, 27 Jul 2010 09:39:16 -0700 (PDT)
Subject: [antlr-interest] looking for rewrite rule - (UNION | EXCEPT)^
 ALL? put in one token
In-Reply-To: <1280154944.18164.24.camel@gecko.home.org>
References: <1280152377488-5338034.post@n2.nabble.com>
	<1280154944.18164.24.camel@gecko.home.org>
Message-ID: <1280248756039-5342977.post@n2.nabble.com>


Hello, 

thanks for the input, jbb.

What I got now is the following:

tokens{
  UNIONALL;
  EXCEPTALL;
}

query_exp
  : query_term ((UNION | EXCEPT | UNIONALL | EXCEPTALL)^ query_term)*   
  ;

UNION : U N I O N (WS A L L { $type=UNIONALL; } )? ;

WS  : (' ' | '\t' | '\n' | '\r')+ {$channel = HIDDEN;};

This construction almost works. For parsing a sentence with UNION ALL the
result is correct. When I try to use just UNION like "select * from table1
UNION select * from table2;" I get an error "mismatched character 's'
expecting set null". If I understand correctly it has something to do with
the whitespaces behind the UNION. When I change the UNION lexical rule to

UNION : U N I O N WS (A L L { $type=UNIONALL; } )? ;

it kind of works. Using Space as a whitespace seems to work. Using a newline
changes the type of the token to "UNION/n/r". Maybe someone has an idea what
I'm overlooking here. 

As a side node: Yes, if I was the one responsible for the whole grammar I
would have used an extra rule to split unionstuff into UNION and UNIONALL.
But I cannot put this information one child down in the tree. That's how the
stuff was implemented before i came to the project. UNION or UNIONALL has to
be at the exact position in the tree. 

Cheers and thanks for the help so far
Sandro
-- 
View this message in context: http://antlr.1301665.n2.nabble.com/looking-for-rewrite-rule-UNION-EXCEPT-ALL-put-in-one-token-tp5338034p5342977.html
Sent from the ANTLR mailing list archive at Nabble.com.

From jimi at temporal-wave.com  Tue Jul 27 10:44:32 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 27 Jul 2010 10:44:32 -0700
Subject: [antlr-interest] looking for rewrite rule - (UNION | EXCEPT)^
	ALL? put in one token
In-Reply-To: <1280248756039-5342977.post@n2.nabble.com>
Message-ID: <b6af9a430ce5a34c9f58d08961c17a6f@temporal-wave.com>

The example I gave you yesterday will do all that you need to do without you having to play with the lexer. If you switch to that method, you will be done in 5 minutes. My example only used a sub-rule; it does not change the position of the tokens in the tree. 

Though to be honest I am not sure why you need to have UNIONALL - just detect UNTION in the tree walker and if ALL is the first child, then you know it is UNION ALL before you do anything else. That's by far the easier solution.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of S.Eifert
> Sent: Tuesday, July 27, 2010 9:39 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] looking for rewrite rule - (UNION |
> EXCEPT)^ ALL? put in one token
> 
> 
> Hello,
> 
> thanks for the input, jbb.
> 
> What I got now is the following:
> 
> tokens{
>   UNIONALL;
>   EXCEPTALL;
> }
> 
> query_exp
>   : query_term ((UNION | EXCEPT | UNIONALL | EXCEPTALL)^ query_term)*
>   ;
> 
> UNION : U N I O N (WS A L L { $type=UNIONALL; } )? ;
> 
> WS  : (' ' | '\t' | '\n' | '\r')+ {$channel = HIDDEN;};
> 
> This construction almost works. For parsing a sentence with UNION ALL
> the
> result is correct. When I try to use just UNION like "select * from
> table1
> UNION select * from table2;" I get an error "mismatched character 's'
> expecting set null". If I understand correctly it has something to do
> with
> the whitespaces behind the UNION. When I change the UNION lexical rule
> to
> 
> UNION : U N I O N WS (A L L { $type=UNIONALL; } )? ;
> 
> it kind of works. Using Space as a whitespace seems to work. Using a
> newline
> changes the type of the token to "UNION/n/r". Maybe someone has an idea
> what
> I'm overlooking here.
> 
> As a side node: Yes, if I was the one responsible for the whole grammar
> I
> would have used an extra rule to split unionstuff into UNION and
> UNIONALL.
> But I cannot put this information one child down in the tree. That's
> how the
> stuff was implemented before i came to the project. UNION or UNIONALL
> has to
> be at the exact position in the tree.
> 
> Cheers and thanks for the help so far
> Sandro
> --
> View this message in context:
> http://antlr.1301665.n2.nabble.com/looking-for-rewrite-rule-UNION-
> EXCEPT-ALL-put-in-one-token-tp5338034p5342977.html
> Sent from the ANTLR mailing list archive at Nabble.com.
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From Marisa.Strong at ucop.edu  Tue Jul 27 10:48:30 2010
From: Marisa.Strong at ucop.edu (Marisa Strong)
Date: Tue, 27 Jul 2010 10:48:30 -0700
Subject: [antlr-interest] Internal error in the plugin manager (ANTLR 3.2)
Message-ID: <2C5A3EEFD5A6FF44B9B6A6B280A5ADF9063B78CF@EXCHANGEMAIL.AD.UCOP.EDU>

Hello,

 

We are using ANTLR for our project and are running into this error when
executing a clean build using maven.

The sources get generated so we can continue on with the build after
restarting, but we'd like to resolve the error.  We experience quite a
few WARNING messages (some displayed below) but not sure if these are
related to the ERROR.

 

Thanks for any help on this.

 

Marisa

 

 

> mvn --version

Apache Maven 2.2.1 (r801777; 2009-08-06 12:16:01-0700)

Java version: 1.6.0_20

Java home: C:\apps\Java\jdk1.6.0_20\jre

Default locale: en_US, platform encoding: Cp1252

OS name: "windows xp" version: "5.1" arch: "x86" Family: "windows" 

 

org\jhove2\module\format\sgml\SgmlParseMessages.g

warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON
BCKSLASH MESSAGELEVEL..OTHERALPHA COLON SLASH MESSAGELEVEL..OTHERALPHA
COLON DIGIT COLON DIGIT COLON DIGIT DOT DIGIT COLON MESSAGELEVEL COLON
{EOF, NEWLINE..OTHERCHAR}" using multiple alternatives: 1, 2

As a result, alternative(s) 2 were disabled for that input

warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
Decision can match input such as "{COLON..BCKSLASH, DIGIT..OTHERCHAR}"
using multiple alternatives: 1, 2

As a result, alternative(s) 2 were disabled for that input

warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON
BCKSLASH MESSAGELEVEL..OTHERALPHA COLON SLASH MESSAGELEVEL..OTHERALPHA
COLON DIGIT COLON DIGIT COLON DIGIT {EOF, NEWLINE..COLON,
SLASH..OTHERALPHA, SPACE..OTHERCHAR}" using multiple alternatives: 1, 2

As a result, alternative(s) 2 were disabled for that input

warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON {EOF,
NEWLINE..SLASH, MESSAGELEVEL..OTHERCHAR}" using multiple alternatives:
1, 2

As a result, alternative(s) 2 were disabled for that input

[ERROR] 

 

 

The following mojo encountered an error while executing:

Group-Id: org.antlr

Artifact-Id: antlr3-maven-plugin

Version: 3.2

Mojo: antlr

brought in via: POM

 

Error stacktrace:

org.apache.maven.lifecycle.LifecycleExecutionException: Internal error
in the plugin manager executing goal
'org.antlr:antlr3-maven-plugin:3.2:antlr': Mojo execution failed.

      at
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandle
Failures(DefaultLifecycleExecutor.java:505)

      at
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegmentFo
rProject(DefaultLifecycleExecutor.java:265)

      at
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(
DefaultLifecycleExecutor.java:191)

      at
org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifec
ycleExecutor.java:149)

      at
org.apache.maven.DefaultMaven.execute_aroundBody0(DefaultMaven.java:223)

      at
org.apache.maven.DefaultMaven.execute_aroundBody1$advice(DefaultMaven.ja
va:304)

      at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:1)

      at
org.apache.maven.embedder.MavenEmbedder.execute_aroundBody2(MavenEmbedde
r.java:904)

      at
org.apache.maven.embedder.MavenEmbedder.execute_aroundBody3$advice(Maven
Embedder.java:304)

      at
org.apache.maven.embedder.MavenEmbedder.execute(MavenEmbedder.java:1)

      at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:176)

      at org.apache.maven.cli.MavenCli.main(MavenCli.java:63)

      at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

      at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
a:39)

      at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
Impl.java:25)

      at java.lang.reflect.Method.invoke(Method.java:597)

      at
org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launche
r.java:289)

      at
org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:2
29)

      at
org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launc
her.java:408)

      at
org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:351
)

      at org.codehaus.classworlds.Launcher.main(Launcher.java:31)

Caused by: org.apache.maven.plugin.PluginExecutionException: Mojo
execution failed.

      at
org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginMa
nager.java:601)

      at
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandle
Failures(DefaultLifecycleExecutor.java:498)

      ... 20 more

Caused by: org.apache.maven.plugin.MojoExecutionException: ANTLR caught
1 build errors.

      at org.antlr.mojo.antlr3.Antlr3Mojo.execute(Antlr3Mojo.java:397)

      at
org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginMa
nager.java:579)

      ... 21 more

 

 


From jimi at temporal-wave.com  Tue Jul 27 10:52:44 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 27 Jul 2010 10:52:44 -0700
Subject: [antlr-interest] Internal error in the plugin manager (ANTLR
	3.2)
In-Reply-To: <2C5A3EEFD5A6FF44B9B6A6B280A5ADF9063B78CF@EXCHANGEMAIL.AD.UCOP.EDU>
Message-ID: <43c28ad460b09b4281709f80e317d851@temporal-wave.com>

Well, first you need to fix those ambiguities - if you post your grammar then we can probably help. Then, there is either something screwy in your .g file that is causing ANTLR to bomb out, or your pom is not configured quite right in some way. So, again, post your grammar but also post the pom.xml and then we can help.

You should also change the encoding property in your pom.xml to be UTF-8 so you don't get warnings about using platform specific encodings.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Marisa Strong
> Sent: Tuesday, July 27, 2010 10:49 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Internal error in the plugin manager (ANTLR
> 3.2)
> 
> Hello,
> 
> 
> 
> We are using ANTLR for our project and are running into this error when
> executing a clean build using maven.
> 
> The sources get generated so we can continue on with the build after
> restarting, but we'd like to resolve the error.  We experience quite a
> few WARNING messages (some displayed below) but not sure if these are
> related to the ERROR.
> 
> 
> 
> Thanks for any help on this.
> 
> 
> 
> Marisa
> 
> 
> 
> 
> 
> > mvn --version
> 
> Apache Maven 2.2.1 (r801777; 2009-08-06 12:16:01-0700)
> 
> Java version: 1.6.0_20
> 
> Java home: C:\apps\Java\jdk1.6.0_20\jre
> 
> Default locale: en_US, platform encoding: Cp1252
> 
> OS name: "windows xp" version: "5.1" arch: "x86" Family: "windows"
> 
> 
> 
> org\jhove2\module\format\sgml\SgmlParseMessages.g
> 
> warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON
> BCKSLASH MESSAGELEVEL..OTHERALPHA COLON SLASH MESSAGELEVEL..OTHERALPHA
> COLON DIGIT COLON DIGIT COLON DIGIT DOT DIGIT COLON MESSAGELEVEL COLON
> {EOF, NEWLINE..OTHERCHAR}" using multiple alternatives: 1, 2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "{COLON..BCKSLASH, DIGIT..OTHERCHAR}"
> using multiple alternatives: 1, 2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON
> BCKSLASH MESSAGELEVEL..OTHERALPHA COLON SLASH MESSAGELEVEL..OTHERALPHA
> COLON DIGIT COLON DIGIT COLON DIGIT {EOF, NEWLINE..COLON,
> SLASH..OTHERALPHA, SPACE..OTHERCHAR}" using multiple alternatives: 1, 2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> warning(200): org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON {EOF,
> NEWLINE..SLASH, MESSAGELEVEL..OTHERCHAR}" using multiple alternatives:
> 1, 2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> [ERROR]
> 
> 
> 
> 
> 
> The following mojo encountered an error while executing:
> 
> Group-Id: org.antlr
> 
> Artifact-Id: antlr3-maven-plugin
> 
> Version: 3.2
> 
> Mojo: antlr
> 
> brought in via: POM
> 
> 
> 
> Error stacktrace:
> 
> org.apache.maven.lifecycle.LifecycleExecutionException: Internal error
> in the plugin manager executing goal
> 'org.antlr:antlr3-maven-plugin:3.2:antlr': Mojo execution failed.
> 
>       at
> org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandl
> e
> Failures(DefaultLifecycleExecutor.java:505)
> 
>       at
> org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegmentF
> o
> rProject(DefaultLifecycleExecutor.java:265)
> 
>       at
> org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments
> (
> DefaultLifecycleExecutor.java:191)
> 
>       at
> org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLife
> c
> ycleExecutor.java:149)
> 
>       at
> org.apache.maven.DefaultMaven.execute_aroundBody0(DefaultMaven.java:223
> )
> 
>       at
> org.apache.maven.DefaultMaven.execute_aroundBody1$advice(DefaultMaven.j
> a
> va:304)
> 
>       at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:1)
> 
>       at
> org.apache.maven.embedder.MavenEmbedder.execute_aroundBody2(MavenEmbedd
> e
> r.java:904)
> 
>       at
> org.apache.maven.embedder.MavenEmbedder.execute_aroundBody3$advice(Mave
> n
> Embedder.java:304)
> 
>       at
> org.apache.maven.embedder.MavenEmbedder.execute(MavenEmbedder.java:1)
> 
>       at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:176)
> 
>       at org.apache.maven.cli.MavenCli.main(MavenCli.java:63)
> 
>       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> 
>       at
> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.ja
> v
> a:39)
> 
>       at
> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccesso
> r
> Impl.java:25)
> 
>       at java.lang.reflect.Method.invoke(Method.java:597)
> 
>       at
> org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launch
> e
> r.java:289)
> 
>       at
> org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:
> 2
> 29)
> 
>       at
> org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Laun
> c
> her.java:408)
> 
>       at
> org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:35
> 1
> )
> 
>       at org.codehaus.classworlds.Launcher.main(Launcher.java:31)
> 
> Caused by: org.apache.maven.plugin.PluginExecutionException: Mojo
> execution failed.
> 
>       at
> org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginM
> a
> nager.java:601)
> 
>       at
> org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandl
> e
> Failures(DefaultLifecycleExecutor.java:498)
> 
>       ... 20 more
> 
> Caused by: org.apache.maven.plugin.MojoExecutionException: ANTLR caught
> 1 build errors.
> 
>       at org.antlr.mojo.antlr3.Antlr3Mojo.execute(Antlr3Mojo.java:397)
> 
>       at
> org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginM
> a
> nager.java:579)
> 
>       ... 21 more
> 
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




From Marisa.Strong at ucop.edu  Tue Jul 27 12:13:50 2010
From: Marisa.Strong at ucop.edu (Marisa Strong)
Date: Tue, 27 Jul 2010 12:13:50 -0700
Subject: [antlr-interest] Internal error in the plugin manager (ANTLR3.2)
In-Reply-To: <43c28ad460b09b4281709f80e317d851@temporal-wave.com>
References: <2C5A3EEFD5A6FF44B9B6A6B280A5ADF9063B78CF@EXCHANGEMAIL.AD.UCOP.EDU>
	<43c28ad460b09b4281709f80e317d851@temporal-wave.com>
Message-ID: <2C5A3EEFD5A6FF44B9B6A6B280A5ADF9063B7925@EXCHANGEMAIL.AD.UCOP.EDU>

Thanks Jim.  I updated the pom.xml to use the UTF-8 encodings.

Attached are the grammar files as well as the pom.xml file.

~marisa

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
Sent: Tuesday, July 27, 2010 10:53 AM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Internal error in the plugin manager
(ANTLR3.2)

Well, first you need to fix those ambiguities - if you post your grammar
then we can probably help. Then, there is either something screwy in
your .g file that is causing ANTLR to bomb out, or your pom is not
configured quite right in some way. So, again, post your grammar but
also post the pom.xml and then we can help.

You should also change the encoding property in your pom.xml to be UTF-8
so you don't get warnings about using platform specific encodings.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Marisa Strong
> Sent: Tuesday, July 27, 2010 10:49 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Internal error in the plugin manager (ANTLR
> 3.2)
> 
> Hello,
> 
> 
> 
> We are using ANTLR for our project and are running into this error
when
> executing a clean build using maven.
> 
> The sources get generated so we can continue on with the build after
> restarting, but we'd like to resolve the error.  We experience quite a
> few WARNING messages (some displayed below) but not sure if these are
> related to the ERROR.
> 
> 
> 
> Thanks for any help on this.
> 
> 
> 
> Marisa
> 
> 
> 
> 
> 
> > mvn --version
> 
> Apache Maven 2.2.1 (r801777; 2009-08-06 12:16:01-0700)
> 
> Java version: 1.6.0_20
> 
> Java home: C:\apps\Java\jdk1.6.0_20\jre
> 
> Default locale: en_US, platform encoding: Cp1252
> 
> OS name: "windows xp" version: "5.1" arch: "x86" Family: "windows"
> 
> 
> 
> org\jhove2\module\format\sgml\SgmlParseMessages.g
> 
> warning(200):
org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON
> BCKSLASH MESSAGELEVEL..OTHERALPHA COLON SLASH MESSAGELEVEL..OTHERALPHA
> COLON DIGIT COLON DIGIT COLON DIGIT DOT DIGIT COLON MESSAGELEVEL COLON
> {EOF, NEWLINE..OTHERCHAR}" using multiple alternatives: 1, 2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> warning(200):
org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "{COLON..BCKSLASH, DIGIT..OTHERCHAR}"
> using multiple alternatives: 1, 2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> warning(200):
org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON
> BCKSLASH MESSAGELEVEL..OTHERALPHA COLON SLASH MESSAGELEVEL..OTHERALPHA
> COLON DIGIT COLON DIGIT COLON DIGIT {EOF, NEWLINE..COLON,
> SLASH..OTHERALPHA, SPACE..OTHERCHAR}" using multiple alternatives: 1,
2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> warning(200):
org\jhove2\module\format\sgml\SgmlParseMessages.g:143:92:
> Decision can match input such as "MESSAGELEVEL..OTHERALPHA COLON {EOF,
> NEWLINE..SLASH, MESSAGELEVEL..OTHERCHAR}" using multiple alternatives:
> 1, 2
> 
> As a result, alternative(s) 2 were disabled for that input
> 
> [ERROR]
> 
> 
> 
> 
> 
> The following mojo encountered an error while executing:
> 
> Group-Id: org.antlr
> 
> Artifact-Id: antlr3-maven-plugin
> 
> Version: 3.2
> 
> Mojo: antlr
> 
> brought in via: POM
> 
> 
> 
> Error stacktrace:
> 
> org.apache.maven.lifecycle.LifecycleExecutionException: Internal error
> in the plugin manager executing goal
> 'org.antlr:antlr3-maven-plugin:3.2:antlr': Mojo execution failed.
> 
>       at
>
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandl
> e
> Failures(DefaultLifecycleExecutor.java:505)
> 
>       at
>
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegmentF
> o
> rProject(DefaultLifecycleExecutor.java:265)
> 
>       at
>
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments
> (
> DefaultLifecycleExecutor.java:191)
> 
>       at
>
org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLife
> c
> ycleExecutor.java:149)
> 
>       at
>
org.apache.maven.DefaultMaven.execute_aroundBody0(DefaultMaven.java:223
> )
> 
>       at
>
org.apache.maven.DefaultMaven.execute_aroundBody1$advice(DefaultMaven.j
> a
> va:304)
> 
>       at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:1)
> 
>       at
>
org.apache.maven.embedder.MavenEmbedder.execute_aroundBody2(MavenEmbedd
> e
> r.java:904)
> 
>       at
>
org.apache.maven.embedder.MavenEmbedder.execute_aroundBody3$advice(Mave
> n
> Embedder.java:304)
> 
>       at
> org.apache.maven.embedder.MavenEmbedder.execute(MavenEmbedder.java:1)
> 
>       at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:176)
> 
>       at org.apache.maven.cli.MavenCli.main(MavenCli.java:63)
> 
>       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> 
>       at
>
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.ja
> v
> a:39)
> 
>       at
>
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccesso
> r
> Impl.java:25)
> 
>       at java.lang.reflect.Method.invoke(Method.java:597)
> 
>       at
>
org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launch
> e
> r.java:289)
> 
>       at
>
org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:
> 2
> 29)
> 
>       at
>
org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Laun
> c
> her.java:408)
> 
>       at
>
org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:35
> 1
> )
> 
>       at org.codehaus.classworlds.Launcher.main(Launcher.java:31)
> 
> Caused by: org.apache.maven.plugin.PluginExecutionException: Mojo
> execution failed.
> 
>       at
>
org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginM
> a
> nager.java:601)
> 
>       at
>
org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandl
> e
> Failures(DefaultLifecycleExecutor.java:498)
> 
>       ... 20 more
> 
> Caused by: org.apache.maven.plugin.MojoExecutionException: ANTLR
caught
> 1 build errors.
> 
>       at org.antlr.mojo.antlr3.Antlr3Mojo.execute(Antlr3Mojo.java:397)
> 
>       at
>
org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginM
> a
> nager.java:579)
> 
>       ... 21 more
> 
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address




List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SgmlParseMessages.g
Type: application/octet-stream
Size: 5546 bytes
Desc: SgmlParseMessages.g
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20100727/41aa7ea3/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: DoctypeFinder.g
Type: application/octet-stream
Size: 6624 bytes
Desc: DoctypeFinder.g
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20100727/41aa7ea3/attachment-0001.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ESISCommands.g
Type: application/octet-stream
Size: 22367 bytes
Desc: ESISCommands.g
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20100727/41aa7ea3/attachment-0002.obj 

From power_giordo at yahoo.com.ar  Tue Jul 27 16:33:27 2010
From: power_giordo at yahoo.com.ar (Vitucho)
Date: Tue, 27 Jul 2010 16:33:27 -0700 (PDT)
Subject: [antlr-interest] Help With Simple Example
Message-ID: <1280273607157-5344600.post@n2.nabble.com>


Hi there Friends!.
I am new to this, i and have a lot of doubts, but don't worry, i will try to
handle.. histroy probes us that manking learn after more or less try and
errors :).
But... there is a thing that i just don't understand.. i am trying to create
a parser for a linear expression:
Remeber that linear expression only contains linear terms, and a linear term
is just a coefcient multiply by a variable.
So: 2 x + 3 y + 5 z is a linear expression and 2 x is a linear term. So i
want to keep it simple for now. The think is that 2 x1 + 2 x2 + 3 x3 may be
a linear expression in my program too. So the name of the variable, must
always start with a letter but it can be followed by a number, that number
is like the index of the x var.

So with the help of copy paste i wrote this and looking to another examples,
i wrote this:


grammar Simplex;

tokens 
{
	PLUS 	= '+' ;
	MINUS	= '-' ;
	MULT	= '*' ;
	DIV	= '/' ;
}

expr	: term ( ( PLUS | MINUS )  term )* 
	{
		System.out.println ("GREAT");
	};

term	: (NUMBER)(VAR);/*|(NUMBER)(WHITESPACE)(VAR);*/

NUMBER	: DIGIT+;

WORD	: LETTER+;

VAR 	: LETTER(DIGIT)*;

WHITESPACE : ( '\t' | ' ' | '\r' | '\n'| '\u000C' )+ 	{ $channel = HIDDEN; }
;

fragment DIGIT	: '0'..'9' ;

fragment LETTER	: 'a'..'z'|'A'..'Z'|'_';


The _thing_ is in the lexer rule named VAR, cuz a wanted that a var must
start with a letter, then followed by letters and only in at end it can be
zero o more number.
I tried with the example 2x1+ 2 x2 +	3	x3 The last space is actually a tab.
And all goes OK :).


If i want a var to start always with a letter and then it can be followed by
one or more letter or numbers alike.
 VAR	: LETTER((LETTER|DIGIT)*);

But wait, here comes the end of this post:
I have doutbs from before that i was unable to auto explain to me, how the
the parsers skips the spaces and the tabs?.
I Should have to put the grammar rule term, like
term : (NUMBER)(WHITESPACE)(VAR); instaed, but it wasn't necesary,
so?...mmmmmmm.. whats the matter..?.

ANd another doubt is the think of 

tokens 
{
	PLUS 	= '+' ;
	MINUS	= '-' ;
	MULT	= '*' ;
	DIV	= '/' ;
}

it isn't the same putting token there that putting they like lexer rules.
	PLUS 	: '+' ;
        MINUS : '-' ;
	MULT	: '*' ;
	DIV	: '/' ;

This is all, i guess is something simple to answer, and maybe is it out
there in someone blog or tutorial, but i doesn't find it, so sorry if i re
ask something :P.

The grammar is called simplex.g beacuse i wrote a program in java to solve
simplex ecuations, btw if you want te see it just visit  
http://sourceforge.net/projects/complex/
http://sourceforge.net/projects/complex/ .

I guess i will asking something more, cuz later i will plant to parse linear
expression it non canonical way: like: 
example 1) 2 x - 3 y equally to 2 x + (-3) y actually (canonical)
example 2) (2 x - 3 y) * 3 equally to 6 x + (-9) y (canonica)

But i just start with the canonical way, like you see. Trying to replace my
home made parser with one more powerfull that let me do this transformation
(linear expression non canonical to canonical).

Okey, yes, this is it the end jejej.
Thanks you for reading this.
Cya!!.





 
-- 
View this message in context: http://antlr.1301665.n2.nabble.com/Help-With-Simple-Example-tp5344600p5344600.html
Sent from the ANTLR mailing list archive at Nabble.com.

From michael.berger at fokus.fraunhofer.de  Wed Jul 28 05:44:24 2010
From: michael.berger at fokus.fraunhofer.de (Berger, Michael)
Date: Wed, 28 Jul 2010 14:44:24 +0200
Subject: [antlr-interest] ANTLRWorks 1.4 feature: mark and jump to target
	rule delete marked rule
Message-ID: <70524A4436C03E43A293958B505008B602B17297@EXCHSRV.fokus.fraunhofer.de>

Hello Antlr-guys,

 

I have to report a ugly feature with AntlrWorks.

 

I'm working on my grammar and I use the possibility to jump to a
sub-rule with CTRL and select target rule very often.

It is very helpful but:
Sometimes I marked some areas like the sub-rule itself before I used
this feature I've told before.

But in the case I have marked the sub-rule I want to jump with this
feature the marked sub-rule will be deleted and

I jumped to the rule ;) But that is not what I want to do ;)

Why do this feature delete my marked sub-rule? Sometimes I marked the
sub-rule by mistake and some minutes after

the jump I detect something is wrong with my grammar (or later)..

 

I'm very grateful if this feature can be deactivate or fix J

 

Best regards

 

Michael Berger

Fraunhofer FOKUS

Kaiserin-Augusta-Allee 31

10589 Berlin

Tel: +49-30-3463-7176

 


From jeanchristophe.bach at inria.fr  Wed Jul 28 08:05:48 2010
From: jeanchristophe.bach at inria.fr (Jean-Christophe Bach)
Date: Wed, 28 Jul 2010 17:05:48 +0200
Subject: [antlr-interest] Nested parser, island grammar and token ambiguity
Message-ID: <20100728150548.GB4455@adel.loria.fr>

Hello antlr users,

I am trying to use antlr3 for our new parser (last one was a complex and ugly
parser with antlr v2, and it is not very maintenable), but I have few problems.
Maybe you will be able to help me.

I have a "HostParser" and few other "subparsers" called when specific
constructions are detected. Another subparser or the HostParser can be called be
from a subparser. For that, I looked at the official island grammar example, and
it seems to work well with simple cases.

It is something like that :
in Host :
myRule : ... t=KEYWORD0 ... -> ... ;

KEYWORD0 : '%keyword0'
  {
    SubLanguage1Lexer lexer = new SubLanguage1Lexer(input);
    CommonTokenStream tokens = new CommonTokenStream(lexer);
    SubLanguage1Parser parser = new SubLanguage1Parser(tokens);
    SubLanguage1Parser.keyword0_return res = parser.keyword0();
  }
  ;

And there is the same thing in other parsers/lexers if needed.

It seems OK, but in one of my SubLanguages, I use this and I need to have
different behaviours depending on the situation after the same character. And
here, I am stuck. The difference between '-> {' and '{' is ok, but between two
'{' is not easy.
SubLanguage1, ok :

rule1 : ... ARROWLBRACE ... -> ... ;
rule2 : ... LBRACE ... -> ... ;

ARROWLBRACE : '->' '{'
  {
  ...
  HostParser.hostrule1_return res = parser.hostrule1();
  ...
  }
  ;

LBRACE : '{'
  {
  ...
  HostParser.hostrule2_return res = parser.hostrule2();
  ...
  }
  ;

But there are other cases where a simple LBRACE needs a third Java treatment.
How can I do that ?
Is there any way to do something like that ? :

rule1 : ... ARROW LBRACE1 ... -> ... ;
rule2 : ... LBRACE2 ... -> ... ;
rule3 : ... LBRACE3 ... -> ... ;

LBRACE1 : '{' {<Java code #1>} ;
LBRACE2 : '{' {<Java code #2>} ;
LBRACE3 : '{' {<Java code #3>} ;

I hope my explanation was clear enough. If you have any idea, do not hesitate to
make a suggestion :)

Regards,

JC

From jeanchristophe.bach at inria.fr  Wed Jul 28 08:40:23 2010
From: jeanchristophe.bach at inria.fr (Jean-Christophe Bach)
Date: Wed, 28 Jul 2010 17:40:23 +0200
Subject: [antlr-interest] filter option in antlr3
Message-ID: <20100728154023.GD4455@adel.loria.fr>

Hello antlr users,

I am rewriting our parser and I have a question :

I have a HostParser and I call other subparsers when specific constructions are
detected. Then, I build a tree like this :
Program
  BlockList
    Construct1 ...  // sublanguage1 block
    Construct2 ...  // sublanguage2 block
    Construct1 ...
    Construct42 ... // sublanguage1 block
    ...
    HostBlock
    ...

A HostBlock is a block of host code (for instance Java). I do not want neither
to parse nor to modify it, I only want to keep it without any other treatment :
(BlockList
  (...)
  (HostBlock <big string representing a host code block> )
  (...)
)

In our previous antlr2 parser, we used the filter option in a combined grammar :

Lexer part :

options{
 filter=TARGET;
 }
...
protected
TARGET
  :
    ( . )
    {target.append($getText);}
  ;

where target is a StringBuffer.

Parser part :
 private String getCode() {
   String result = lexer.target.toString();
   lexer.clearTarget();
   return result;
 }

Then, we only called getCode() when building a HostBlock node.

Is it still possible with antlr3 ? I have noted a change, the option has to be
filter=true;
Since I am using a combined grammar (one file containing my parser and my
lexer), I am not sure how to use this option. How can I precise that it is a
lexer option ? (in global options, it does not work, because it applies only on
lexer). Do I have to add this option in the lexer rule ? (and how ?) :

fragment
TARGET?: ( . ) {<my Java code>}

I tried to add the filter option in the rule, but I obtain errors, as if the
option did not exist.

Thanks in advance,

JC

From parrt at cs.usfca.edu  Wed Jul 28 10:51:29 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 28 Jul 2010 10:51:29 -0700
Subject: [antlr-interest] Review of "Language Implementation Patterns"
Message-ID: <D94F1F68-7BFA-4C7D-9825-495EA9B4242D@cs.usfca.edu>

http://www.i-programmer.info/bookreviews/20-theory/1097-language-implementation-patterns.html

From anonabout at gmail.com  Wed Jul 28 11:31:42 2010
From: anonabout at gmail.com (Pat Smith)
Date: Wed, 28 Jul 2010 11:31:42 -0700
Subject: [antlr-interest] Consultant wanted
Message-ID: <4A1E4B78-AEF9-4CFE-8BB1-ACE372E05529@gmail.com>

Hi All,

I'm actually looking for a company to build a DSL. It's basically a rather simple validation language for an ERP toolset. The syntax would be something like Javascript. The basic flow I am thinking about is that code would be typed into an editor, parsed and validated for syntax, generated into an AST, then the AST would be serialized out to XML and the XML would be persisted in a toolset. The XML should then be able to regenerated back to source sort of like the pretty print of HTML tidy. The actual text of the source code would never be stored, the source would always been generated from the XML which represents the AST. Should further changes occur to the source, a diff would be performed of the previous and current XML and the difference would be sent to the toolset to update the structure. That pretty much covers for the design side. As for the runtime, I would need a framework which would run through the AST and call the already defined functions which are in the toolset to perform the validations and logic. I don't expect the runtime to be complete, just enough of a framework so that it can easily be extended to fulfill the rest of the requirements. The target language is Java. Please send an email to anonabout at gmail . com if interested.


Thanks
Pat Smith

From alan at blogometer.com  Wed Jul 28 12:09:43 2010
From: alan at blogometer.com (Alan Gutierrez)
Date: Wed, 28 Jul 2010 14:09:43 -0500
Subject: [antlr-interest] Java Grammar
Message-ID: <158E1732-AD9E-42F5-8090-41B323D4EA1C@blogometer.com>

I'd like to use Antlr to create a syntax highlighter. I've taken the  
Java.g grammer offered up at the web site for Java 6 and ran it  
through org.antlr.Tool.

It produced a lot of warning messages. Is this normal? Below is the  
half-screen of warnings.

java -cp /Users/alan/.m2/repository/org/antlr/antlr-runtime/3.2/antlr- 
runtime-3.2.jar:/Users/alan/.m2/repository/antlr/antlr/2.7.7/ 
antlr-2.7.7.jar:/Users/alan/.m2/repository/org/antlr/stringtemplate/ 
3.2.1/stringtemplate-3.2.1.jar:/Users/alan/.m2/repository/org/antlr/ 
antlr/3.2/antlr-3.2.jar org.antlr.Tool Java.g
warning(209): Java.g:1767:1: Multiple token rules can match input such  
as "'-'": SUBSUB, SUB, SUBEQ

As a result, token(s) SUB,SUBEQ were disabled for that input
warning(209): Java.g:1811:1: Multiple token rules can match input such  
as "'c'": CASE, CATCH, CHAR, CLASS, CONST, CONTINUE, IDENTIFIER

As a result, token(s) CATCH,CHAR,CLASS,CONST,CONTINUE,IDENTIFIER were  
disabled for that input
warning(209): Java.g:1791:1: Multiple token rules can match input such  
as "'%'": PERCENT, PERCENTEQ

As a result, token(s) PERCENTEQ were disabled for that input
warning(209): Java.g:1811:1: Multiple token rules can match input such  
as "'t'": THIS, THROW, THROWS, TRANSIENT, TRY, TRUE, IDENTIFIER

As a result, token(s) THROW,THROWS,TRANSIENT,TRY,TRUE,IDENTIFIER were  
disabled for that input
warning(209): Java.g:1799:1: Multiple token rules can match input such  
as "'!'": BANG, BANGEQ

--
Alan Gutierrez - alan at blogometer.com - http://twitter.com/bigeasy

From jimi at temporal-wave.com  Wed Jul 28 12:43:39 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 28 Jul 2010 12:43:39 -0700
Subject: [antlr-interest] Java Grammar
In-Reply-To: <158E1732-AD9E-42F5-8090-41B323D4EA1C@blogometer.com>
References: <158E1732-AD9E-42F5-8090-41B323D4EA1C@blogometer.com>
Message-ID: <004101cb2e8d$2d8294b0$8887be10$@temporal-wave.com>

Use -Xconversiontimeout 10000 and see if that makes a difference.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Alan Gutierrez
> Sent: Wednesday, July 28, 2010 12:10 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Java Grammar
> 
> I'd like to use Antlr to create a syntax highlighter. I've taken the
Java.g
> grammer offered up at the web site for Java 6 and ran it through
> org.antlr.Tool.
> 
> It produced a lot of warning messages. Is this normal? Below is the half-
> screen of warnings.
> 
> java -cp /Users/alan/.m2/repository/org/antlr/antlr-runtime/3.2/antlr-
> runtime-3.2.jar:/Users/alan/.m2/repository/antlr/antlr/2.7.7/
> antlr-2.7.7.jar:/Users/alan/.m2/repository/org/antlr/stringtemplate/
> 3.2.1/stringtemplate-3.2.1.jar:/Users/alan/.m2/repository/org/antlr/
> antlr/3.2/antlr-3.2.jar org.antlr.Tool Java.g
> warning(209): Java.g:1767:1: Multiple token rules can match input such as
"'-
> '": SUBSUB, SUB, SUBEQ
> 
> As a result, token(s) SUB,SUBEQ were disabled for that input
> warning(209): Java.g:1811:1: Multiple token rules can match input such as
> "'c'": CASE, CATCH, CHAR, CLASS, CONST, CONTINUE, IDENTIFIER
> 
> As a result, token(s) CATCH,CHAR,CLASS,CONST,CONTINUE,IDENTIFIER were
> disabled for that input
> warning(209): Java.g:1791:1: Multiple token rules can match input such as
> "'%'": PERCENT, PERCENTEQ
> 
> As a result, token(s) PERCENTEQ were disabled for that input
> warning(209): Java.g:1811:1: Multiple token rules can match input such as
> "'t'": THIS, THROW, THROWS, TRANSIENT, TRY, TRUE, IDENTIFIER
> 
> As a result, token(s) THROW,THROWS,TRANSIENT,TRY,TRUE,IDENTIFIER
> were disabled for that input
> warning(209): Java.g:1799:1: Multiple token rules can match input such as
> "'!'": BANG, BANGEQ
> 
> --
> Alan Gutierrez - alan at blogometer.com - http://twitter.com/bigeasy
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address


From alan at blogometer.com  Wed Jul 28 13:41:14 2010
From: alan at blogometer.com (Alan Gutierrez)
Date: Wed, 28 Jul 2010 15:41:14 -0500
Subject: [antlr-interest] Java Grammar
In-Reply-To: <004101cb2e8d$2d8294b0$8887be10$@temporal-wave.com>
References: <158E1732-AD9E-42F5-8090-41B323D4EA1C@blogometer.com>
	<004101cb2e8d$2d8294b0$8887be10$@temporal-wave.com>
Message-ID: <4C5095EA.7090602@blogometer.com>

This worked.

-Xconversiontimeout 1000000

I'm on a MacBook with 4GB memory, in case anyone encounters the problem 
in the future, give it all the time it needs.

Alan Gutierrez

Jim Idle wrote:
> Use -Xconversiontimeout 10000 and see if that makes a difference.

>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Alan Gutierrez
>> Sent: Wednesday, July 28, 2010 12:10 PM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] Java Grammar
>>
>> I'd like to use Antlr to create a syntax highlighter. I've taken the
> Java.g
>> grammer offered up at the web site for Java 6 and ran it through
>> org.antlr.Tool.
>>
>> It produced a lot of warning messages. Is this normal? Below is the half-
>> screen of warnings.
>>
>> java -cp /Users/alan/.m2/repository/org/antlr/antlr-runtime/3.2/antlr-
>> runtime-3.2.jar:/Users/alan/.m2/repository/antlr/antlr/2.7.7/
>> antlr-2.7.7.jar:/Users/alan/.m2/repository/org/antlr/stringtemplate/
>> 3.2.1/stringtemplate-3.2.1.jar:/Users/alan/.m2/repository/org/antlr/
>> antlr/3.2/antlr-3.2.jar org.antlr.Tool Java.g
>> warning(209): Java.g:1767:1: Multiple token rules can match input such as
> "'-
>> '": SUBSUB, SUB, SUBEQ


-- 
Alan Gutierrez - alan at blogometer.com - http://twitter.com/bigeasy

From cid at kynetx.com  Wed Jul 28 14:04:13 2010
From: cid at kynetx.com (Cid Dennis)
Date: Wed, 28 Jul 2010 15:04:13 -0600
Subject: [antlr-interest] Tokens and ~()
Message-ID: <92D2B3D3-49AA-46CD-8705-C4D54B8DCA06@kynetx.com>

I have a rule that should find all characters between / and /:

regex : 
	'/' (r=~('/'))+ '/' 
	; 

The problem is later in my grammar file  I have something that looks like:


fragment operator
	: o=('.pick'|'.length'|'.as'|'.head'|'.tail'|'.sort'
      	|'.filter'|'.map'|'.uc'|'.lc' |'.split' | '.join' | '.query'
      	| '.has' | '.union' | '.difference' | '.intersection' | '.unique' | '.once'
      	| '.duplicates') '(' (e=expr  (',' e1=expr )*)? ')'	
	;

When I parse a file that has this in it.

 prune = mdata.replace(/(?s)(.*v.directedBy..)(\w+\s+\w+)(<\/a.*)/,"$2");

I get mismatched character 'r' expecting 'f'.    This seems to be because I have '.difference'.   What I do not understand is why this that happening.  I would expect the ~('/') to say give me everything except "/" but it gets stuff on other tokens defined in the grammar.

Can someone shed some light on what I am doing wrong.  This is my first grammar with ANTLR and am confused.


------------------------------------------
Cid Dennis
ph : 303 915 9381
em: cid at kynetx.com





From gokul007 at gmail.com  Thu Jul 29 00:25:54 2010
From: gokul007 at gmail.com (Gokulakannan Somasundaram)
Date: Thu, 29 Jul 2010 15:25:54 +0800
Subject: [antlr-interest] A suggestion for C runtime
Message-ID: <AANLkTik8OqVH8911eDSffo9oZrbkQN=115Y6o3t1n_CH@mail.gmail.com>

Hi,
   A small suggestion for improvement on ANTLR C Runtime would be to, make
sure the const correctness is present in the code. While this is not very
important, it helps a lot while getting integrated into a already
standardized code. I found it difficult especially in the places where it
takes the query for processing. It can be pANTLR3_UINT8 const, instead
of pANTLR3_UINT8.

Thanks,
Gokul.

From qsmgmt at earthlink.net  Thu Jul 29 08:09:47 2010
From: qsmgmt at earthlink.net (Alan Lehotsky)
Date: Thu, 29 Jul 2010 11:09:47 -0400 (GMT-04:00)
Subject: [antlr-interest] Using antlr in an ebcdic environment?
Message-ID: <8697126.1280416187115.JavaMail.root@elwamui-little.atl.sa.earthlink.net>

I was wondering if anyone has used Antlr in an IBM z/OS environment (e.g. with EBCDIC).

Since the Java should all be using unicode, I would presume that the only issue is dealing with conversion of the input data and output data for files read and written, but if I'm missing something critical in that theory I'd appreciate anyone with experience dealing with that particular environment.

Thanks,
Al Lehotsky


From brian at brie.com  Thu Jul 29 18:07:40 2010
From: brian at brie.com (Brian Lavender)
Date: Thu, 29 Jul 2010 18:07:40 -0700
Subject: [antlr-interest] Fixed field
In-Reply-To: <20100727032740.GA20374@brie.com>
References: <20100727032740.GA20374@brie.com>
Message-ID: <20100730010740.GA10019@brie.com>

Well, it looks like my attempt isn't so feeble, but I can't seem to get the input to 
match on the newline. Do I need to do something different? 


grammar Agenda;

agenda	:	bill+;
bill	:	title author '\n' { System.out.println($bill.text); }
;
author	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR { System.out.println($author.text); };
title 	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR { System.out.println($title.text); };	

LTR  :   ('a'..'z'|'A'..'Z' | ' ' | '1'..'9') ;

Input is the following.
Bill to allow eBill Joy  
Bill to preventFrank Dist
  



On Mon, Jul 26, 2010 at 08:27:41PM -0700, Brian Lavender wrote:
> What's the best way to get the words out of a fixed field file? Say the title
> is in the first 20 columns, and then the author is in the next 20?
> 
> Below is a feeble attempt that will get four letters, but I would like to ignore
> any whitespace that occurs after the last letter before the end column. 
> 
> brian
> 
> 
> grammar Foo;
> 
> title	:	LTR LTR LTR LTR '\n'{System.out.println($title.text);};
> 
> LTR 	:	('a'..'z'|'A'..'Z');
> 
> -- 
> Brian Lavender
> http://www.brie.com/brian/
> 
> "There are two ways of constructing a software design. One way is to
> make it so simple that there are obviously no deficiencies. And the other
> way is to make it so complicated that there are no obvious deficiencies."
> 
> Professor C. A. R. Hoare
> The 1980 Turing award lecture
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-- 
Brian Lavender
http://www.brie.com/brian/

"There are two ways of constructing a software design. One way is to
make it so simple that there are obviously no deficiencies. And the other
way is to make it so complicated that there are no obvious deficiencies."

Professor C. A. R. Hoare
The 1980 Turing award lecture

From e.arrows at gmail.com  Thu Jul 29 20:27:13 2010
From: e.arrows at gmail.com (=?ISO-2022-JP?B?GyRCPzxELjFRQkBPOhsoQiAoRS4gRnVrYW1hY2hpKQ==?=)
Date: Fri, 30 Jul 2010 12:27:13 +0900
Subject: [antlr-interest] gUnit doesn't work with rewrite rules
Message-ID: <AANLkTi=fizkm2QDndR0ghphkobr5HL6xkLB-ehqD7ucb@mail.gmail.com>

Hi.
I'm trying to develop a simple translator with ANTLR.
I thought "rewrite option" better for me, but gUnit raised
ClassCastException with it.

The following codes have the problem. I'm using ANTLR v3.2 and Java
1.6.0 on Mac OS 10.6.

Do you have any advice?

Thanks.

== T.g ==
{{{
grammar T;
options {output=template; rewrite=true;}

type: 'int' -> template() "Integer";
}}}

== T.gunit ==
{{{
gunit T;

type:
"int" -> "Integer"
}}}

Then, I executed following shell commands.

$ java org.antlr.Tool T.g
$ javac T{Lexer,Parser}.java
$ java org.antlr.gunit.Interp T.gunit

And, I got the following outputs.

{{{
-----------------------------------------------------------------------
executing testsuite for grammar:T with 1 tests
-----------------------------------------------------------------------
1 failures found:
test1 (type, line4) -
expected: Integer
actual: java.lang.ClassCastException:
org.antlr.runtime.CommonTokenStream cannot be cast to
org.antlr.runtime.TokenRewriteStream


Tests run: 1, Failures: 1
}}}

--
Eitarow Fukamachi

From gokul007 at gmail.com  Fri Jul 30 03:30:04 2010
From: gokul007 at gmail.com (Gokulakannan Somasundaram)
Date: Fri, 30 Jul 2010 18:30:04 +0800
Subject: [antlr-interest] A suggestion for C runtime
In-Reply-To: <AANLkTik8OqVH8911eDSffo9oZrbkQN=115Y6o3t1n_CH@mail.gmail.com>
References: <AANLkTik8OqVH8911eDSffo9oZrbkQN=115Y6o3t1n_CH@mail.gmail.com>
Message-ID: <AANLkTi=V1wvhaBW8astZt2N0Jz2itQUd2QNvqNerkLV9@mail.gmail.com>

Sorry, i made a mistake in explaining the problem here.  I will try to
re-word it
a) pANTLR3_UINT8 is a pointer to unsigned char.
b) But say i get a const char* to be parsed, but when i try
the antlr3NewAsciiStringInPlaceStream, it only accepts pANTLR3_UINT8, so we
have to do a cast here. In c++, this requires a const_cast +
reinterpret_cast.

If we can take care const correctness in probably the next version, then
such unnecessary casts can be avoided.

Thanks,
Gokul.

On Thu, Jul 29, 2010 at 3:25 PM, Gokulakannan Somasundaram <
gokul007 at gmail.com> wrote:

> Hi,
>    A small suggestion for improvement on ANTLR C Runtime would be to, make
> sure the const correctness is present in the code. While this is not very
> important, it helps a lot while getting integrated into a already
> standardized code. I found it difficult especially in the places where it
> takes the query for processing. It can be pANTLR3_UINT8 const, instead
> of pANTLR3_UINT8.
>
> Thanks,
> Gokul.
>

From brian at brie.com  Fri Jul 30 10:03:32 2010
From: brian at brie.com (Brian Lavender)
Date: Fri, 30 Jul 2010 10:03:32 -0700
Subject: [antlr-interest] Fixed field
In-Reply-To: <20100730010740.GA10019@brie.com>
References: <20100727032740.GA20374@brie.com> <20100730010740.GA10019@brie.com>
Message-ID: <20100730170332.GC10019@brie.com>

Hello empty antlr echo chambers. Is there anybody out there?

I figured out that if I create a lexer rule to match the newline, that it will match rather than
putting it in the parser rule. Now, it only seems to parse the first bill that it finds. When I test
it in the antlr works, it parses both entries from input. Any ideas?


grammar Agenda;

agenda	:	bill+;
bill	:	title author NL { System.out.println("All " + $bill.text + "\n"); }
;
title 	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR { System.out.println("Title " + $title.text + "\n"); };
author	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR { System.out.println("Author " + $author.text + "\n"); };
	

LTR  :   ('a'..'z'|'A'..'Z' | ' ' | '1'..'9') ;
NL	:	('\n'|'\r');


import org.antlr.runtime.*;

public class Test {
    public static void main(String[] args) throws Exception {
        ANTLRInputStream input = new ANTLRInputStream(System.in);
        AgendaLexer lexer = new AgendaLexer(input);
        CommonTokenStream tokens = new CommonTokenStream(lexer);
        AgendaParser parser = new AgendaParser(tokens);
        parser.agenda();
    }
}

Sample input


construct bill frank burn
eazememnt bill billy bob





On Thu, Jul 29, 2010 at 06:07:40PM -0700, Brian Lavender wrote:
> Well, it looks like my attempt isn't so feeble, but I can't seem to get the input to 
> match on the newline. Do I need to do something different? 
> 
> 
> grammar Agenda;
> 
> agenda	:	bill+;
> bill	:	title author '\n' { System.out.println($bill.text); }
> ;
> author	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR { System.out.println($author.text); };
> title 	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR { System.out.println($title.text); };	
> 
> LTR  :   ('a'..'z'|'A'..'Z' | ' ' | '1'..'9') ;
> 
> Input is the following.
> Bill to allow eBill Joy  
> Bill to preventFrank Dist
>   
> 
> 
> 
> On Mon, Jul 26, 2010 at 08:27:41PM -0700, Brian Lavender wrote:
> > What's the best way to get the words out of a fixed field file? Say the title
> > is in the first 20 columns, and then the author is in the next 20?
> > 
> > Below is a feeble attempt that will get four letters, but I would like to ignore
> > any whitespace that occurs after the last letter before the end column. 
> > 
> > brian
> > 
> > 
> > grammar Foo;
> > 
> > title	:	LTR LTR LTR LTR '\n'{System.out.println($title.text);};
> > 
> > LTR 	:	('a'..'z'|'A'..'Z');
> > 
> > -- 
> > Brian Lavender
> > http://www.brie.com/brian/
> > 
> > "There are two ways of constructing a software design. One way is to
> > make it so simple that there are obviously no deficiencies. And the other
> > way is to make it so complicated that there are no obvious deficiencies."
> > 
> > Professor C. A. R. Hoare
> > The 1980 Turing award lecture
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> -- 
> Brian Lavender
> http://www.brie.com/brian/
> 
> "There are two ways of constructing a software design. One way is to
> make it so simple that there are obviously no deficiencies. And the other
> way is to make it so complicated that there are no obvious deficiencies."
> 
> Professor C. A. R. Hoare
> The 1980 Turing award lecture
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-- 
Brian Lavender
http://www.brie.com/brian/

"There are two ways of constructing a software design. One way is to
make it so simple that there are obviously no deficiencies. And the other
way is to make it so complicated that there are no obvious deficiencies."

Professor C. A. R. Hoare
The 1980 Turing award lecture

From jimi at temporal-wave.com  Fri Jul 30 10:26:08 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 30 Jul 2010 10:26:08 -0700
Subject: [antlr-interest] Fixed field
In-Reply-To: <20100730170332.GC10019@brie.com>
References: <20100727032740.GA20374@brie.com> <20100730010740.GA10019@brie.com>
	<20100730170332.GC10019@brie.com>
Message-ID: <00c401cb300c$4be39d20$e3aad760$@temporal-wave.com>

I think that you are barking up the wrong tree here. All your rules are
completely ambiguous and if any of the fields do not exactly correspond to
the number of letters, this will all fall over. ANTLR is not really meant
for parsing fixed width fields where each field is just some arbitrary text.
You should just use something like awk to do this, or even a very simple
java class that just reads a buffered input stream line by line and picks
out the fields.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Brian Lavender
> Sent: Friday, July 30, 2010 10:04 AM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Fixed field
> 
> Hello empty antlr echo chambers. Is there anybody out there?
> 
> I figured out that if I create a lexer rule to match the newline, that it
will
> match rather than putting it in the parser rule. Now, it only seems to
parse
> the first bill that it finds. When I test it in the antlr works, it parses
both
> entries from input. Any ideas?
> 
> 
> grammar Agenda;
> 
> agenda	:	bill+;
> bill	:	title author NL { System.out.println("All " + $bill.text +
"\n"); }
> ;
> title 	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR
LTR LTR {
> System.out.println("Title " + $title.text + "\n"); };
> author	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR {
> System.out.println("Author " + $author.text + "\n"); };
> 
> 
> LTR  :   ('a'..'z'|'A'..'Z' | ' ' | '1'..'9') ;
> NL	:	('\n'|'\r');
> 
> 
> import org.antlr.runtime.*;
> 
> public class Test {
>     public static void main(String[] args) throws Exception {
>         ANTLRInputStream input = new ANTLRInputStream(System.in);
>         AgendaLexer lexer = new AgendaLexer(input);
>         CommonTokenStream tokens = new CommonTokenStream(lexer);
>         AgendaParser parser = new AgendaParser(tokens);
>         parser.agenda();
>     }
> }
> 
> Sample input
> 
> 
> construct bill frank burn
> eazememnt bill billy bob
> 
> 
> 
> 
> 
> On Thu, Jul 29, 2010 at 06:07:40PM -0700, Brian Lavender wrote:
> > Well, it looks like my attempt isn't so feeble, but I can't seem to
> > get the input to match on the newline. Do I need to do something
> different?
> >
> >
> > grammar Agenda;
> >
> > agenda	:	bill+;
> > bill	:	title author '\n' { System.out.println($bill.text);
}
> > ;
> > author	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR {
> System.out.println($author.text); };
> > title 	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR
LTR LTR {
> System.out.println($title.text); };
> >
> > LTR  :   ('a'..'z'|'A'..'Z' | ' ' | '1'..'9') ;
> >
> > Input is the following.
> > Bill to allow eBill Joy
> > Bill to preventFrank Dist
> >
> >
> >
> >
> > On Mon, Jul 26, 2010 at 08:27:41PM -0700, Brian Lavender wrote:
> > > What's the best way to get the words out of a fixed field file? Say
> > > the title is in the first 20 columns, and then the author is in the
next 20?
> > >
> > > Below is a feeble attempt that will get four letters, but I would
> > > like to ignore any whitespace that occurs after the last letter before
the
> end column.
> > >
> > > brian
> > >
> > >
> > > grammar Foo;
> > >
> > > title	:	LTR LTR LTR LTR
'\n'{System.out.println($title.text);};
> > >
> > > LTR 	:	('a'..'z'|'A'..'Z');
> > >
> > > --
> > > Brian Lavender
> > > http://www.brie.com/brian/
> > >
> > > "There are two ways of constructing a software design. One way is to
> > > make it so simple that there are obviously no deficiencies. And the
> > > other way is to make it so complicated that there are no obvious
> deficiencies."
> > >
> > > Professor C. A. R. Hoare
> > > The 1980 Turing award lecture
> > >
> > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > Unsubscribe:
> > > http://www.antlr.org/mailman/options/antlr-interest/your-email-addre
> > > ss
> >
> > --
> > Brian Lavender
> > http://www.brie.com/brian/
> >
> > "There are two ways of constructing a software design. One way is to
> > make it so simple that there are obviously no deficiencies. And the
> > other way is to make it so complicated that there are no obvious
> deficiencies."
> >
> > Professor C. A. R. Hoare
> > The 1980 Turing award lecture
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> --
> Brian Lavender
> http://www.brie.com/brian/
> 
> "There are two ways of constructing a software design. One way is to make
it
> so simple that there are obviously no deficiencies. And the other way is
to
> make it so complicated that there are no obvious deficiencies."
> 
> Professor C. A. R. Hoare
> The 1980 Turing award lecture
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address


From j.grout at computer.org  Fri Jul 30 15:14:15 2010
From: j.grout at computer.org (John Grout)
Date: Fri, 30 Jul 2010 15:14:15 -0700
Subject: [antlr-interest] Review of "Language Implementation Patterns"
	(Terence Parr)
In-Reply-To: <mailman.1.1280343601.10230.antlr-interest@antlr.org>
References: <mailman.1.1280343601.10230.antlr-interest@antlr.org>
Message-ID: <6DC27397-3876-43D7-BF80-146567839773@computer.org>

> Date: Wed, 28 Jul 2010 10:51:29 -0700
> From: Terence Parr <parrt at cs.usfca.edu>
> Subject: [antlr-interest] Review of "Language Implementation Patterns"
> ...
> http://www.i-programmer.info/bookreviews/20-theory/1097-language-implementation-patterns.html


To me, the reviewer lost his credibility when all he chose to cite as
an alternative to ANTLR for DSLs was the kind of Microsoft API that
makes its users passive consumers of Microsoft technology.  It's not
solely about an individual API's or tool's restriction to the Windows
environment: it is also the likelihood that the API's or tool's EULA
prohibits its use in competition with Microsoft's other products.

Imagine the absurdity of Ter licensing ANTLR on terms forbidding
its use to create a tool that competed with ANTLR or related software
(e.g., ANTLRWorks).  In the Microsoft world, those sorts of terms
are not an absurdity: they are a reality and, at least for commercial
software development, must be investigated before a particular
API or tool is used.

John R. Grout
j.grout at computer.org

From brian at brie.com  Fri Jul 30 19:01:42 2010
From: brian at brie.com (Brian Lavender)
Date: Fri, 30 Jul 2010 19:01:42 -0700
Subject: [antlr-interest] Review of "Language Implementation Patterns"
In-Reply-To: <D94F1F68-7BFA-4C7D-9825-495EA9B4242D@cs.usfca.edu>
References: <D94F1F68-7BFA-4C7D-9825-495EA9B4242D@cs.usfca.edu>
Message-ID: <20100731020142.GE10019@brie.com>

Well, in todays culture of vulnerabilities, correctness is becoming key and 
grammars are certainly a good way to implement correctness. Even though
Bertrand Meyer will say that verified correctness isn't the end all solution,
I think its relevance can not be underestimated. 

Perhaps the reviewer should go back to the day of Djikstra, Hoare,
and Dahl and watch his job mess up the computer. I didn't work much
with computers in the day of Job Control, but from reading literature,
correctness seemed to be key as I can imagine that a crashed job could
really muck things up.

I think we will have achieved a great accomplishment when coders joke with
one another "Show me your grammar!". Certainly, ANTLR helps bring grammars
to the masses and from attending a part of "Emerging Languages" group at
OSCON, I can see many exiting things coming out of language development and
I hope to get better at it. 

I bought the book too. I have only scanned through it. I will be working
through it. I think that the one thing that I would like is more
cookbook routines, nothing like an example to illustrate.

I am also very excited about SCALA and Erlang. It seems that their pattern
matching and tail end recursion go right along with grammar design.

I'll just end with.

What is 127 + 1?

negative 128 silly!!! Call me crazy, but I saw this problem just today. 
Check this code snippet!

int validChar(char testChar)
{
  if (testChar < 6) {
     return -1;
  } 
  return 1;
}

brian

On Wed, Jul 28, 2010 at 10:51:29AM -0700, Terence Parr wrote:
> http://www.i-programmer.info/bookreviews/20-theory/1097-language-implementation-patterns.html
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-- 
Brian Lavender
http://www.brie.com/brian/

"There are two ways of constructing a software design. One way is to
make it so simple that there are obviously no deficiencies. And the other
way is to make it so complicated that there are no obvious deficiencies."

Professor C. A. R. Hoare
The 1980 Turing award lecture

From brian at brie.com  Fri Jul 30 19:07:12 2010
From: brian at brie.com (Brian Lavender)
Date: Fri, 30 Jul 2010 19:07:12 -0700
Subject: [antlr-interest] Fixed field
In-Reply-To: <00c401cb300c$4be39d20$e3aad760$@temporal-wave.com>
References: <20100727032740.GA20374@brie.com> <20100730010740.GA10019@brie.com>
	<20100730170332.GC10019@brie.com>
	<00c401cb300c$4be39d20$e3aad760$@temporal-wave.com>
Message-ID: <20100731020712.GF10019@brie.com>

Meant to send this to the list, in case there is additional info others
have to add.

Well, my grammar does work on GNU/Linux and gets both "bills". Maybe I
am using an old version of the runtime on Windows? I put a bunch of JARs
in my classpath including a reference to an old ANTLR one for use with
Jasper Reports, but I believe the newest ANTLR jar is first.

I guess this would explain the silence. The guys doing analysis on network
IDS are using formal grammars using binpac which includes a lot of fixed
field data. I haven't looked specifically at how they constructed their
grammars for bro (http://www.bro-ids.org), but using awk or a buffered
reader suffers from numeric constants that fly right past the compiler
(for Java anyway). Currently, the code I have checks to see if the result
that comes back has a modulus of 8 lines, a very weak check. It seems
like I am going in the right direction, still digging though.

Could you please point to where my grammar is ambiguous? 

I guess I am little baffled that if the field does not match the exact
width, then it will all fall over. It's supposed to fall over because
moron dinked with the query on the Mainframe that produced the wrong
fixed field data result and foobared it.

I am trying to instatiate some typing safety. In some areas, rather than
being just characters, they should be 'Y' or 'N' flags. Others, should 
actually reference a value that was previously set.

brian

On Fri, Jul 30, 2010 at 10:26:08AM -0700, Jim Idle wrote:
> I think that you are barking up the wrong tree here. All your rules are
> completely ambiguous and if any of the fields do not exactly correspond to
> the number of letters, this will all fall over. ANTLR is not really meant
> for parsing fixed width fields where each field is just some arbitrary text.
> You should just use something like awk to do this, or even a very simple
> java class that just reads a buffered input stream line by line and picks
> out the fields.
> 
> Jim
> 
> > -----Original Message-----
> > From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> > bounces at antlr.org] On Behalf Of Brian Lavender
> > Sent: Friday, July 30, 2010 10:04 AM
> > To: antlr-interest at antlr.org
> > Subject: Re: [antlr-interest] Fixed field
> > 
> > Hello empty antlr echo chambers. Is there anybody out there?
> > 
> > I figured out that if I create a lexer rule to match the newline, that it
> will
> > match rather than putting it in the parser rule. Now, it only seems to
> parse
> > the first bill that it finds. When I test it in the antlr works, it parses
> both
> > entries from input. Any ideas?
> > 
> > 
> > grammar Agenda;
> > 
> > agenda	:	bill+;
> > bill	:	title author NL { System.out.println("All " + $bill.text +
> "\n"); }
> > ;
> > title 	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR
> LTR LTR {
> > System.out.println("Title " + $title.text + "\n"); };
> > author	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR {
> > System.out.println("Author " + $author.text + "\n"); };
> > 
> > 
> > LTR  :   ('a'..'z'|'A'..'Z' | ' ' | '1'..'9') ;
> > NL	:	('\n'|'\r');
> > 
> > 
> > import org.antlr.runtime.*;
> > 
> > public class Test {
> >     public static void main(String[] args) throws Exception {
> >         ANTLRInputStream input = new ANTLRInputStream(System.in);
> >         AgendaLexer lexer = new AgendaLexer(input);
> >         CommonTokenStream tokens = new CommonTokenStream(lexer);
> >         AgendaParser parser = new AgendaParser(tokens);
> >         parser.agenda();
> >     }
> > }
> > 
> > Sample input
> > 
> > 
> > construct bill frank burn
> > eazememnt bill billy bob
> > 
> > 
> > 
> > 
> > 
> > On Thu, Jul 29, 2010 at 06:07:40PM -0700, Brian Lavender wrote:
> > > Well, it looks like my attempt isn't so feeble, but I can't seem to
> > > get the input to match on the newline. Do I need to do something
> > different?
> > >
> > >
> > > grammar Agenda;
> > >
> > > agenda	:	bill+;
> > > bill	:	title author '\n' { System.out.println($bill.text);
> }
> > > ;
> > > author	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR {
> > System.out.println($author.text); };
> > > title 	:	LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR LTR
> LTR LTR {
> > System.out.println($title.text); };
> > >
> > > LTR  :   ('a'..'z'|'A'..'Z' | ' ' | '1'..'9') ;
> > >
> > > Input is the following.
> > > Bill to allow eBill Joy
> > > Bill to preventFrank Dist
> > >
> > >
> > >
> > >
> > > On Mon, Jul 26, 2010 at 08:27:41PM -0700, Brian Lavender wrote:
> > > > What's the best way to get the words out of a fixed field file? Say
> > > > the title is in the first 20 columns, and then the author is in the
> next 20?
> > > >
> > > > Below is a feeble attempt that will get four letters, but I would
> > > > like to ignore any whitespace that occurs after the last letter before
> the
> > end column.
> > > >
> > > > brian
> > > >
> > > >
> > > > grammar Foo;
> > > >
> > > > title	:	LTR LTR LTR LTR
> '\n'{System.out.println($title.text);};
> > > >
> > > > LTR 	:	('a'..'z'|'A'..'Z');
> > > >
> > > > --
> > > > Brian Lavender
> > > > http://www.brie.com/brian/
> > > >
> > > > "There are two ways of constructing a software design. One way is to
> > > > make it so simple that there are obviously no deficiencies. And the
> > > > other way is to make it so complicated that there are no obvious
> > deficiencies."
> > > >
> > > > Professor C. A. R. Hoare
> > > > The 1980 Turing award lecture
> > > >
> > > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > > Unsubscribe:
> > > > http://www.antlr.org/mailman/options/antlr-interest/your-email-addre
> > > > ss
> > >
> > > --
> > > Brian Lavender
> > > http://www.brie.com/brian/
> > >
> > > "There are two ways of constructing a software design. One way is to
> > > make it so simple that there are obviously no deficiencies. And the
> > > other way is to make it so complicated that there are no obvious
> > deficiencies."
> > >
> > > Professor C. A. R. Hoare
> > > The 1980 Turing award lecture
> > >
> > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > > Unsubscribe:
> > > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> > 
> > --
> > Brian Lavender
> > http://www.brie.com/brian/
> > 
> > "There are two ways of constructing a software design. One way is to make
> it
> > so simple that there are obviously no deficiencies. And the other way is
> to
> > make it so complicated that there are no obvious deficiencies."
> > 
> > Professor C. A. R. Hoare
> > The 1980 Turing award lecture
> > 
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> > email-address
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-- 
Brian Lavender
http://www.brie.com/brian/

"There are two ways of constructing a software design. One way is to
make it so simple that there are obviously no deficiencies. And the other
way is to make it so complicated that there are no obvious deficiencies."

Professor C. A. R. Hoare
The 1980 Turing award lecture

From wclodius at los-alamos.net  Fri Jul 30 19:39:40 2010
From: wclodius at los-alamos.net (William Clodius)
Date: Fri, 30 Jul 2010 20:39:40 -0600
Subject: [antlr-interest] Fixed field
In-Reply-To: <00c401cb300c$4be39d20$e3aad760$@temporal-wave.com>
References: <20100727032740.GA20374@brie.com> <20100730010740.GA10019@brie.com>
	<20100730170332.GC10019@brie.com>
	<00c401cb300c$4be39d20$e3aad760$@temporal-wave.com>
Message-ID: <605EC333-C782-47D8-BE69-B1677ECB945A@los-alamos.net>


On Jul 30, 2010, at 11:26 AM, Jim Idle wrote:

> I think that you are barking up the wrong tree here. All your rules are
> completely ambiguous and if any of the fields do not exactly correspond to
> the number of letters, this will all fall over. ANTLR is not really meant
> for parsing fixed width fields where each field is just some arbitrary text.
> You should just use something like awk to do this, or even a very simple
> java class that just reads a buffered input stream line by line and picks
> out the fields.
> 
> Jim
<snip>

Ambiguity is not a problem here, per se. If the grammar were completely ambiguous I would expect ANTLR to report problems before he has a chance to parse a file. I suspect his specific problem can be fixed by requiring that agenda end with an end of file token. However you are correct that automated lexing tools such as ANTLR are not designed for fixed width fields and the convolutions required to handle such fields are as easily handed by handwritten lexers, which in turn are more amenable to error reporting.

From ruichu at gmail.com  Sat Jul 31 02:02:11 2010
From: ruichu at gmail.com (Chu Rui)
Date: Sat, 31 Jul 2010 17:02:11 +0800
Subject: [antlr-interest] performance improvement in v3.2?
Message-ID: <AANLkTimRVf4wVpw0Hq4UtFxnVTDfWutMDkpFZnhRQKFP@mail.gmail.com>

Hi,
I am using ANTLRWorks 1.2.2 with ANTLR 3.1.1 in my previous work. My target
language is C.
It works well, but the performance is awkful. Moreover, the time consumption
looks non-linear, although there is (almost) no backtrack in my grammer
file.
It costs about 3 seconds for parsing 30k lines of script file, and 12
seconds for 60k lines.

Today I upgrade it to ANTLRWorks 1.4/ANTLR 3.2, and the performance is
improved dramatically. It cost less than 1 second for 60k lines. More than
10X of speed !
I am glad for such a result, but it also takes a little worry to me. How do
you(Jim Idle  or others) improve that between ANTLR 3.1.1 and ANTLR 3.2?
Does it reliable? Or is there any side-effect with that?

Anyway, thank you for your excellent work!

Rui Chu

From zellux at gmail.com  Sat Jul 31 05:01:26 2010
From: zellux at gmail.com (ZelluX)
Date: Sat, 31 Jul 2010 20:01:26 +0800
Subject: [antlr-interest] Recovering line number in Python-Antlr AST
Message-ID: <AANLkTi=Kh7umAYsnj3RtCazTzMSM2xB=A-gsiBHka+t_@mail.gmail.com>

Hi, all

I need to recover line numbers of statements when the AST is being
processed, but have no idea of how to. I googled but only found solutions in
Java, not in Python, like this article
http://tech.puredanger.com/2007/02/01/recovering-line-and-column-numbers-in-your-antlr-ast.
Could you please tell me what should I do in Antlr-Python version?
Many
thanks.

-- 
Best regards,
Wang Yuanxuan
Parallel Processing Institute, Fudan University

From jimi at temporal-wave.com  Sat Jul 31 11:28:37 2010
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 31 Jul 2010 11:28:37 -0700
Subject: [antlr-interest] Fixed field
In-Reply-To: <605EC333-C782-47D8-BE69-B1677ECB945A@los-alamos.net>
References: <20100727032740.GA20374@brie.com> <20100730010740.GA10019@brie.com>
	<20100730170332.GC10019@brie.com>
	<00c401cb300c$4be39d20$e3aad760$@temporal-wave.com>
	<605EC333-C782-47D8-BE69-B1677ECB945A@los-alamos.net>
Message-ID: <016d01cb30de$30de7770$929b6650$@temporal-wave.com>

I did not say that it was analytically ambiguous. My point was that there is
little value, if any in a grammar which basically boils down to

(LTR* NL)* ;

Jim

> -----Original Message-----
> From: William Clodius [mailto:wclodius at los-alamos.net]
> Sent: Friday, July 30, 2010 7:40 PM
> To: Jim Idle
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Fixed field
> 
> 
> On Jul 30, 2010, at 11:26 AM, Jim Idle wrote:
> 
> > I think that you are barking up the wrong tree here. All your rules
> > are completely ambiguous and if any of the fields do not exactly
> > correspond to the number of letters, this will all fall over. ANTLR is
> > not really meant for parsing fixed width fields where each field is just
some
> arbitrary text.
> > You should just use something like awk to do this, or even a very
> > simple java class that just reads a buffered input stream line by line
> > and picks out the fields.
> >
> > Jim
> <snip>
> 
> Ambiguity is not a problem here, per se. If the grammar were completely
> ambiguous I would expect ANTLR to report problems before he has a chance
> to parse a file. I suspect his specific problem can be fixed by requiring
that
> agenda end with an end of file token. However you are correct that
> automated lexing tools such as ANTLR are not designed for fixed width
fields
> and the convolutions required to handle such fields are as easily handed
by
> handwritten lexers, which in turn are more amenable to error reporting.


From acondit at ipns.com  Sat Jul 31 11:49:23 2010
From: acondit at ipns.com (Alan Condit)
Date: Sat, 31 Jul 2010 11:49:23 -0700
Subject: [antlr-interest] RecognizerSharedState
Message-ID: <7C2E1288-0398-4FB6-B421-DEAF7FAE8BE0@ipns.com>

Is there one copy of the RecognizerSharedState structure in memory and it is actually shared by the parser and the lexer, or does each have a separate copy of the structure and it is only shared in the sense that they both use the same structure?

Thanks,
Alan
---

Alan Condit
1085 Tierra Ct.
Woodburn, OR 97071

Email -- acondit at ipns.com
Home-Office (503) 982-0906


From parrt at cs.usfca.edu  Sat Jul 31 16:59:13 2010
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 31 Jul 2010 16:59:13 -0700
Subject: [antlr-interest] RecognizerSharedState
In-Reply-To: <7C2E1288-0398-4FB6-B421-DEAF7FAE8BE0@ipns.com>
References: <7C2E1288-0398-4FB6-B421-DEAF7FAE8BE0@ipns.com>
Message-ID: <17A94C97-5989-46DD-8450-9033CA10C5C4@cs.usfca.edu>

There should be only one shared state between a single instance of a parser. Each new instance will get its own shared state. There is a single shared state among all parsers imported into a root parser.

 lexer and parser share a type definition but at runtime they have different shared state.

T
On Jul 31, 2010, at 11:49 AM, Alan Condit wrote:

> Is there one copy of the RecognizerSharedState structure in memory and it is actually shared by the parser and the lexer, or does each have a separate copy of the structure and it is only shared in the sense that they both use the same structure?
> 
> Thanks,
> Alan
> ---
> 
> Alan Condit
> 1085 Tierra Ct.
> Woodburn, OR 97071
> 
> Email -- acondit at ipns.com
> Home-Office (503) 982-0906
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From sadie at kind.ocn.ne.jp  Sat Jul 31 20:03:54 2010
From: sadie at kind.ocn.ne.jp (sunao furukawa)
Date: Sun, 1 Aug 2010 12:03:54 +0900
Subject: [antlr-interest] About My Verilog HDL grammar
Message-ID: <F5EC861E5D994BC4A6C353DC5012861E@sunaoPC>

Hello!

I write Verilog HDL grammar.
I referred http://www.externsoft.ch/download/verilog.html .
I debugging this grammar.
But,primary does not select suitable alternative.
Antlrworks emit NoViableAltException(0@[null]).

Input Text:

module adder4(in_data1, in_data2, out_data, cy);
    input  [3:0] in_data1, in_data2;
    output [3:0] out_data;
    output       cy;

    wire   [4:0] rslt;

    assign rslt     = in_data1 + in_data2;
    assign cy       = rslt[4];
    assign out_data = rslt[3:0];

endmodule

Red letter is emitted at [4] in rslt[4] and at [3:0] in rslt[3:0}.

Syntax primary,below,

primary :  number
 | identifier
 | identifier'[' expression ']'
 | identifier'[' msb_constant_expression ':' lsb_constant_expression ']'
 | concatenation
 | multiple_concatenation
 | function_call
 | '(' mintypmax_expression ')'
 ;

I want to select "identifier'['expression']'" or "identifier'[' 
msb_constant_expression ':' lsb_constant_expression ']'".
But Antlrworks select "identifier".

I will attach my Verilog HDL grammar file.
Start Symbol (source_text).
I don't know what to do.
Help me please.

Thanks.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: veriloghdl2.g
Type: application/octet-stream
Size: 26645 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20100801/0cd5ac1d/attachment.obj 

