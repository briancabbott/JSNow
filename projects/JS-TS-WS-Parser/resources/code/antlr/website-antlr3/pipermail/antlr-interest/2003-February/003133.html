<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] ATTN: Ric Klaren. Bug in tne AST copy ctor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20ATTN%3A%20Ric%20Klaren.%20Bug%20in%20tne%20AST%20copy%20ctor&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003062.html">
   <LINK REL="Next"  HREF="003137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] ATTN: Ric Klaren. Bug in tne AST copy ctor</H1>
    <B>Alexander Lenski</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20ATTN%3A%20Ric%20Klaren.%20Bug%20in%20tne%20AST%20copy%20ctor&In-Reply-To="
       TITLE="[antlr-interest] ATTN: Ric Klaren. Bug in tne AST copy ctor">alenski at dca.net
       </A><BR>
    <I>Wed Feb 19 10:14:48 PST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="003062.html">[antlr-interest] ATTN: Ric Klaren. Bug in tne AST copy ctor
</A></li>
        <LI>Next message: <A HREF="003137.html">[antlr-interest] Re: ATTN: Ric Klaren. Bug in tne AST copy ctor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3133">[ date ]</a>
              <a href="thread.html#3133">[ thread ]</a>
              <a href="subject.html#3133">[ subject ]</a>
              <a href="author.html#3133">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
Sorry for persistence, I did not get any feedback. What should the clone functions of the AST... classes create? Is it about deep copies or what? In other words, am I correct with the original msg or not?

Thanks a lot,
Alex
  ----- Original Message ----- 
  From: Alexander Lenski 
  To: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at yahoogroups.com</A> 
  Sent: Friday, February 14, 2003 12:34 AM
  Subject: [antlr-interest] ATTN: Ric Klaren. Bug in tne AST copy ctor


  Hi,
  The AST's copy ctor is defined in the 2.7.2 as

      AST(const AST&amp; other) : ref(other.ref-&gt;increment()) {}

  The ref(other.ref-&gt;increment()) sets ref of the copy with the ref's pointer from the other. As a consequence, all clone funcs of the AST... classes and subsequently the dup... funcs of the ASTFactory produce memory leaks, perform corrupted operations instead of expected functionality.

  In the 2.7.1 we had

      AST(const AST&amp; other) : ref( 0 ) {}

  This fixes the problem and works just fine. If I did not miss something, couldn't you fix that please.
  BTW, the antlr.dll (VC7.0) works just fine. I have built my lexers-parsers in the dll form too, no problems at all with running the clients.

  Thanks,
  Alex


  Your use of Yahoo! Groups is subject to the Yahoo! Terms of Service. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20030219/a647bd6b/attachment.html">http://www.antlr.org/pipermail/antlr-interest/attachments/20030219/a647bd6b/attachment.html</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003062.html">[antlr-interest] ATTN: Ric Klaren. Bug in tne AST copy ctor
</A></li>
	<LI>Next message: <A HREF="003137.html">[antlr-interest] Re: ATTN: Ric Klaren. Bug in tne AST copy ctor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3133">[ date ]</a>
              <a href="thread.html#3133">[ thread ]</a>
              <a href="subject.html#3133">[ subject ]</a>
              <a href="author.html#3133">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
