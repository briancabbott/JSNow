<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Code generation problem?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Code%20generation%20problem%3F&In-Reply-To=%3CCAGZ5p6J9UU%2BpckJtVre75HOFDhWXBGsLDVhjXPVZRkQEskp3UQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="043967.html">
   <LINK REL="Next"  HREF="043957.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Code generation problem?</H1>
    <B>Ronald Albury</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Code%20generation%20problem%3F&In-Reply-To=%3CCAGZ5p6J9UU%2BpckJtVre75HOFDhWXBGsLDVhjXPVZRkQEskp3UQ%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Code generation problem?">ronalbury at gmail.com
       </A><BR>
    <I>Wed Jan 25 14:31:26 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="043967.html">[antlr-interest] Compiling 3.4 with maven
</A></li>
        <LI>Next message: <A HREF="043957.html">[antlr-interest] Code generation problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43956">[ date ]</a>
              <a href="thread.html#43956">[ thread ]</a>
              <a href="subject.html#43956">[ subject ]</a>
              <a href="author.html#43956">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please help!

I believe the following section of grammar is valid:

stateSection returns [State result] :
    STATE ztate = stateAttrs
    {
        $result = ztate;
    }
    ( screen = screenSection
    {
        $result.setScreen(screen);
    })?
    ( menu = menuSection
    {
        $result.setMenu(menu);
    })?
   ( periodic = periodicSection
   {
       $result.setPeriodic(periodic);
   })?
   ENDSTATE
   ;

However, there is an issue with the generated code (I have removed some of
the blank lines).  It creates variables for result, ztate, and screen, but
does not correctly generate code for menu and periodic:

  public final State stateSection() throws RecognitionException {
        State result = null;
        State ztate =null;
        Screen screen =null;
        try {
            // C:\\csc\\P\\Pet\\Pet.g:121:37: ( STATE ztate= stateAttrs
(screen= screenSection )? (menu= menuSection )? (periodic= periodicSection
)? ENDSTATE )
            // C:\\csc\\P\\Pet\\Pet.g:122:2: STATE ztate= stateAttrs
(screen= screenSection )? (menu= menuSection )? (periodic= periodicSection
)? ENDSTATE
            {
            match(input,STATE,FOLLOW_STATE_in_stateSection935);
            pushFollow(FOLLOW_stateAttrs_in_stateSection941);
            ztate=stateAttrs();
            state._fsp--;
                 result = ztate;

            // C:\\csc\\P\\Pet\\Pet.g:126:2: (screen= screenSection )?
            int alt2=2;
            int LA2_0 = input.LA(1);
            if ( (LA2_0==SCREEN) ) {
                alt2=1;
            }
            switch (alt2) {
                case 1 :
                    // C:\\csc\\P\\Pet\\Pet.g:126:4: screen= screenSection
                    {
                    pushFollow(FOLLOW_screenSection_in_stateSection953);
                    screen=screenSection();
                    state._fsp--;
                      result.setScreen(screen);
                    }
                    break;
            }

            // C:\\csc\\P\\Pet\\Pet.g:130:2: (menu= menuSection )?
            int alt3=2;
            int LA3_0 = input.LA(1);
            if ( (LA3_0==MENU) ) {
                alt3=1;
            }
            switch (alt3) {
                case 1 :
                    // C:\\csc\\P\\Pet\\Pet.g:130:4: menu= menuSection
                    {
                    pushFollow(FOLLOW_menuSection_in_stateSection968);
                    menuSection();
                    state._fsp--;
                      result.setMenu(menu);

                    }
                    break;
            }
            // C:\\csc\\P\\Pet\\Pet.g:134:2: (periodic= periodicSection )?
            int alt4=2;
            int LA4_0 = input.LA(1);
            if ( (LA4_0==PERIODIC) ) {
                alt4=1;
            }
            switch (alt4) {
                case 1 :
                    // C:\\csc\\P\\Pet\\Pet.g:134:4: periodic=
periodicSection
                    {
                    pushFollow(FOLLOW_periodicSection_in_stateSection983);
                    periodicSection();
                    state._fsp--;
                      result.setPeriodic(periodic);

                    }
                    break;
            }
            match(input,ENDSTATE,FOLLOW_ENDSTATE_in_stateSection992);
            }
        }
        catch (RecognitionException re) {
            reportError(re);
            recover(input,re);
        }
        finally {
         // do for sure before leaving
        }
        return result;
    }
    // $ANTLR end &quot;stateSection&quot;
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="043967.html">[antlr-interest] Compiling 3.4 with maven
</A></li>
	<LI>Next message: <A HREF="043957.html">[antlr-interest] Code generation problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#43956">[ date ]</a>
              <a href="thread.html#43956">[ thread ]</a>
              <a href="subject.html#43956">[ subject ]</a>
              <a href="author.html#43956">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
