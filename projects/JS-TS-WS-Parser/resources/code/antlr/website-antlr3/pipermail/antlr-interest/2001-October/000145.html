<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Re: How to throw an exception from the lexer to the caller rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Re%3A%20How%20to%20throw%20an%20exception%20from%20the%20lexer%20to%20the%20caller%20rule&In-Reply-To=3A1718D4-CB13-11D5-BD27-0030653DE0D6%40jguru.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000143.html">
   <LINK REL="Next"  HREF="000151.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Re: How to throw an exception from the lexer to the caller rule</H1>
    <B>lemoine at multimania.com</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Re%3A%20How%20to%20throw%20an%20exception%20from%20the%20lexer%20to%20the%20caller%20rule&In-Reply-To=3A1718D4-CB13-11D5-BD27-0030653DE0D6%40jguru.com"
       TITLE="[antlr-interest] Re: How to throw an exception from the lexer to the caller rule">lemoine at multimania.com
       </A><BR>
    <I>Mon Oct 29 01:35:56 PST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="000143.html">[antlr-interest] How to throw an exception from the lexer to the caller rule
</A></li>
        <LI>Next message: <A HREF="000151.html">[antlr-interest] Re: How to throw an exception from the lexer to the caller rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#145">[ date ]</a>
              <a href="thread.html#145">[ thread ]</a>
              <a href="subject.html#145">[ subject ]</a>
              <a href="author.html#145">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You're wright.
The exception was not generated by the lexer rule.
It's generated by the parser in the uri grammar rule 
(NoViableAltException). 

Following is the code generated for the uri rule in the P.java file :

switch ( LA(1)) {
case STATS:
case DSINFOS:
case PINFOS:
case HELP:
{
        command();
        break;
}
case STRING_LITERAL:
case PNAME:
case DSN:
case USER:
case PWD:
{
        queries();
        break;
}
default:
{
        throw new NoViableAltException(LT(1), getFilename());
}
}

But that's not what I want to do. I want to handle my own exception 
for the command in the command rule and for queries in the 
queries rule.

The only way I found is to check for two tokens and to replace the 
rule

uri     : command
        | queries

by the rule

uri             :
                 {
                   // it's a query option
                   if(LT(2).getText().equals(&quot;=&quot;)) {
                        queries() ;
                   } else {
                   // it's a command
                        command() ;
                   }
                 }
                ;

command         : s:STATS
                  { _commandName = s.getText() ; }
                | d:DSINFOS
                  { _commandName = d.getText() ; }
                | p:PINFOS
                  { _commandName = p.getText() ; }
                | h:HELP
                  { _commandName = h.getText() ; }
                {
                    _requestIsQuery = false ;

                    System.out.println(&quot;command is &quot;+_commandName) ;
                }
                ;
                exception // for command
                catch [RecognitionException  e] {
                 String token = getToken(e.getMessage()) ;
                 throw new RecognitionException(&quot;Unknown 
command&quot;+&quot; &quot;+token);
                }

queries         : query (SEMI query)*
                ;
                exception // for queries
                catch [RecognitionException  e] {
                 String token = getToken(e.getMessage()) ;
                 throw new RecognitionException(&quot;Unknown 
option&quot;+&quot; &quot;+token);
                }

I don't known if this solution is very clean ... but it works.
If you have a another way, it would be greatly apprecied.

Thanks

Herv&#233;



--- In <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at y...</A>, Terence Parr &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">parrt at j...</A>&gt; wrote:
&gt;<i> 
</I>&gt;<i> On Wednesday, October 17, 2001, at 05:46  AM, <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">lemoine at m...</A> 
</I>&gt;<i> wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt; I had specified the testLiterals option to true for the IDENT 
</I>rule in
&gt;<i> &gt; the Lexer to test each token against the literals table.
</I>&gt;<i> &gt; But when the literal does not match with the lexer IDENT rule, it
</I>&gt;<i> &gt; generates an Exception and exits of the lexer.
</I>&gt;<i> &gt; I want to catch the exception in the caller rule of the parser to
</I>&gt;<i> &gt; specify my own error message.
</I>&gt;<i> 
</I>&gt;<i> It should not be generating an exception if it's not a literal...it 
</I>&gt;<i> should simply return as IDENT.  Are you sure that is what is 
</I>happening?
&gt;<i> 
</I>&gt;<i> Ter
</I>&gt;<i> --
</I>&gt;<i> Chief Scientist &amp; Co-founder, <A HREF="http://www.jguru.com">http://www.jguru.com</A>
</I>&gt;<i> Creator, ANTLR Parser Generator: <A HREF="http://www.antlr.org">http://www.antlr.org</A>
</I>

 

Your use of Yahoo! Groups is subject to <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A> 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000143.html">[antlr-interest] How to throw an exception from the lexer to the caller rule
</A></li>
	<LI>Next message: <A HREF="000151.html">[antlr-interest] Re: How to throw an exception from the lexer to the caller rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#145">[ date ]</a>
              <a href="thread.html#145">[ thread ]</a>
              <a href="subject.html#145">[ subject ]</a>
              <a href="author.html#145">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
