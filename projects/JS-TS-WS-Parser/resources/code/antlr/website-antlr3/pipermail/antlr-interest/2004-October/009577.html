<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] help on warning:nondeterminism upon
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20help%20on%20warning%3Anondeterminism%20upon&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="009580.html">
   <LINK REL="Next"  HREF="009579.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] help on warning:nondeterminism upon</H1>
    <B>s2jafer1</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20help%20on%20warning%3Anondeterminism%20upon&In-Reply-To="
       TITLE="[antlr-interest] help on warning:nondeterminism upon">s2jafer1 at yahoo.com
       </A><BR>
    <I>Tue Oct 12 23:38:03 PDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="009580.html">[antlr-interest] Re: Recognize letters
</A></li>
        <LI>Next message: <A HREF="009579.html">[antlr-interest] help on warning:nondeterminism upon
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9577">[ date ]</a>
              <a href="thread.html#9577">[ thread ]</a>
              <a href="subject.html#9577">[ subject ]</a>
              <a href="author.html#9577">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>



I am getting the &quot; warning:nondeterminism upon &quot;

in the line no 244,it corresponds to 

&quot;createPolicy throws ArchiveSystemApplicationException
	    :
	    CREATE WS POLICY ( WS createPolicyParams)* ( WS 

createPolicyTypes)* NEWLINE  in the source code&quot; during compilation 

of the grammar file.i want to avoid this warning .

if anybody knows the solution let me know as soon as possible.


the source code is :

header{

/**
* File Name : CreatePolicy.g
*/

}
/**
 * A Parser class for validating the create policy command
 */
class CreatePolicyParser extends Parser;
options
    {
        k = 9;
        buildAST = true; // uses CommonAST by default
        defaultErrorHandler = false;
    }
    
    // Define some variables to be used in the parser
    {
    
		/**
     	* A hash map for Create Copy verb
	 	*/
		HashMap cCPHash;
		/**
     	* A array list for Create Copy verb
	 	*/
		ArrayList createCopyList = new ArrayList();
		/**
     	* To track the # of times the create copy verb is entered
	 	*/
		int createCopyCount;    		
		/**
     	* A hash map for migrate verb
	 	*/
		HashMap migrateHash;
		/**
     	* A array list for migrate verb
	 	*/
		ArrayList migrateList = new ArrayList();
		/**
     	* To track the # of times the migrate verb is entered
	 	*/
		int migrateCount;    		
		/**
     	* A hash map for Log verb
	 	*/	
		HashMap logMap;
		 /**
	     * To track the # of times the read access arg is entered
    	 */
		int lgReadAccessCount ;
		 /**
	     * To track the # of times the datastorage arg is entered
    	 */
		int lgintdatastrgCount;
		 /**
	     * To track the # of times the dupdatadetection arg is 
entered
    	 */
		int lgdupDataDetCount ;
		 /**
	     * To track the # of times the data alter arg is entered
    	 */
		int lgDataAlterCount ;
		/**
     	* To track the # of times the migrate verb is entered
	 	*/
		int mgverbCount;
		/**
     	* To track the # of times the createcopy verbid is entered
	 	*/		
		int cCPverbCount;
		/**
     	* To track the # of times the log verbid is entered
	 	*/
		int lgverbCount;    
		/**
     	* To track the # of times the migrate relative duration is 
entered
	 	*/
		int mgRelDur;       
        /**
	     * To track the # of times the policyname arg is entered
    	 */
        int policyNameCount;
         /**
	     * To track the # of times the policy descr arg is entered
    	 */
        int policyDescrCount;
         /**
	     * To track the # of times the policy name length arg is 
entered
    	 */
        int policyNameLength=40;
         /**
	     * To track the # of times the policydescr length arg is 
entered
    	 */
        int policyDescLength=255;
         /**
	     * To track the # of times the log verb is entered
    	 */
        int logSectionCount;        
         /**
	     * To track the # of times the create copyname  arg is 
entered
    	 */
        int cCpCopyNoCount;
        
         /**
	     * To track the # of times the destinationpool arg is 
entered
    	 */
        int ccpDestinationPoolCount;
         /**
	     * To track the # of times the retention arg is entered
    	 */        
         /**
	     * To track the max ln of the arg entered
    	 */
        int maxLength=100;
        /**
	     * To track the # of times the srccpyname arg is entered
    	 */        
        int mgSrcCopyNoCount;
         /**
	     * To track the # of times the destinastion pool arg is 
entered
    	 */
        int mgDestinationPoolCount;
        /**
	     *hash map containing the cmd and its params
    	 */
    	HashMap hmap = null;
    	/**
	     * To track the # of times the  migrate abs starttime arg 
is entered
    	 */
    	int mgAbsStTime ;
    	/**
	     * To track the # of times the migrate rel starttime arg 
is entered
    	 */
		int mgRelStTime ;
		/**
	     * To track the # of times the rel to  arg is entered
    	 */
		int mgRelTo;
        /**
     	 * To track the # of times the starttime is entered
	 	 */
        int cCPStartTimeCount;    
       
        /**
      	 * To track the # of times the absretentime is entered
    	 */
        int cCpAbsRetentionCount;
        /**
     	 * To track the # of times the retentionduration is entered
    	 */
        int cCPRetentionDur;   	
        /**
         * attributes of date
         */  
        int year  = 0;
        int month = 0;
        int day   = 0;
        int hours = 0;
        int min   = 0;
        
    }

   /**
     * The Command entered by the user is checked for its validity. 
     */
    startRule returns[HashMap hmapRet = null] throws 
ArchiveSystemApplicationException
    {
        hmapRet = new HashMap();
        hmap = hmapRet;
    }
    :
    (createPolicy
    )EOF
    ;
    /**
     * The Command syntax for create policy and its corresponding 
actions 
     * 
     * @param    nil
     * @return    nil.
     */
	createPolicy throws ArchiveSystemApplicationException
	    :
	    CREATE WS POLICY ( WS createPolicyParams)* ( WS 
createPolicyTypes)* NEWLINE
	    {
	        hmap.put(&quot;verb&quot;, &quot;Create&quot;);
	        hmap.put(&quot;object&quot;, &quot;Policy&quot;);
	    
	    	if(policyNameCount ==0)
	    	{	    	
	    		throw new MissingParameterException
(&quot;policyname&quot;);
	    	}
    }
    exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterException(&quot;create policy&quot;);
    }
    catch[ Exception e ]
    {
    	e.printStackTrace();
    }
	    ;
    /**
     * The syntax for create policy command arguments and its 
corresponding actions 
     * 
     * @param    nil
     * @return   nil
     */
	createPolicyParams throws ArchiveSystemApplicationException
		
		:setPolicyName
		|setPolicyDescr
		|setError
		;

	setPolicyName throws ArchiveSystemApplicationException
	    {
	    	ArrayList policyNameList = new ArrayList();
	    }
	    :
	    POLICYNAME (WS)? policyname:ALPHANUM
	    {
	        if (policyNameCount == 1)
	        {
	            throw new ParameterRepeatedException
(&quot;policyname&quot;);
	        }
	
	        String policyName = policyname.getText().trim();
	
	        if ((policyName.equals(&quot;=&quot;))||((policyName.equals
(&quot;&quot;))))
	        {
	            throw new MissingParameterValueException
(&quot;policyname&quot;);
	        }	
	        if (!isStringValid(policyName))
	        {
	           throw new InvalidParameterValueException
(&quot;policyname&quot;);
	        }	
	      	if( policyName.length() &gt; policyNameLength)
	      	{	      	
	      		throw new InvalidParameterValueException
(&quot;policyname&quot;);
	      	}
	        hmap.put(&quot;policyname&quot;, policyName);
	        policyNameCount++;
	    }
	
	    exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;policyname&quot;);
	    }
	    ;


	setPolicyDescr throws ArchiveSystemApplicationException
	    :
	    POLICYDESCR (WS)? policydescr:ALPHANUM
	    {	    	
	        if (policyDescrCount == 1)
	        {
	            throw new ParameterRepeatedException
(&quot;policydescr&quot;);
	        }
	
	        String policyDesc= policydescr.getText().trim();
	
	        if ((policyDesc.equals(&quot;=&quot;))||(policyDesc.equals(&quot;&quot;)))
	        {
	            throw new MissingParameterValueException
(&quot;policydescr&quot;);
	        }
	        if (!isStringValid(policyDesc))
	        {
	             throw new InvalidParameterValueException
(&quot;policydescr&quot;);
	        }
	        if((policyDesc.length() ) &gt; policyDescLength)
	        {	     
	           	throw new InvalidParameterValueException
(&quot;policydescr&quot;);
	        }
	
	        hmap.put(&quot;policydescr&quot;, policyDesc);
	        policyDescrCount++;
	    }
	
	    exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;policydescr&quot;);
	    }
	    ;    
    
	createPolicyTypes throws ArchiveSystemApplicationException
		:setCreateCopy
		|setMigrate
		|setLog
		|setError
		;
	
	setCreateCopy throws ArchiveSystemApplicationException
		{			
			cCPHash = new HashMap();
			cCpCopyNoCount =0;
			ccpDestinationPoolCount =0;
			cCPStartTimeCount = 0;
			cCpAbsRetentionCount= 0 ;
			cCPRetentionDur = 0;
		}
		:
		CREATECOPY (WS)? (OPAREN) (WS crPlCcpParams)* (WS)? 
(CPAREN) 
		 {		 	
	    	if(cCpCopyNoCount ==0 )
	    	{	    		
	    		throw new MissingParameterValueException
(&quot;CreateCopy::CreateCopyNo&quot;);	
	    	}
	    	if(ccpDestinationPoolCount == 0)
	    	{	    	
	    		throw new MissingParameterValueException
(&quot;CreateCopy::destinationpool&quot;);	
	    	}
	    	if(cCPStartTimeCount == 0)
	    	{	    	
	    		throw new MissingParameterValueException
(&quot;CreateCopy::starttime&quot;);		    	
	    	}
	    	//either absretention time or retention duration can 
be present 
	    	if((cCpAbsRetentionCount ==1) &amp;&amp;(cCPRetentionDur ==1))
	    	{
	    		throw new EitherOrParameterException
(&quot;AbsoluteretentionTime&quot;,&quot;Retentionduration&quot;);
	    	}
	    	if((cCpAbsRetentionCount ==0) &amp;&amp;(cCPRetentionDur ==0))
	    	{
	    		throw new EitherOrParameterException
(&quot;AbsoluteretentionTime&quot;,&quot;Retentionduration&quot;);
	    	}
	    	createCopyList.add(cCPHash);
	    	hmap.put(&quot;createcopy&quot;,createCopyList);
	    	createCopyCount++;
	    }
		;
	
	crPlCcpParams throws ArchiveSystemApplicationException
		
		: setcCPcopyName
	    | setcCPdestinationPool
	    | setcCPRetentionDuration
	    | setcCPAbsRetentionTime
	    | setcCPstartTime
	    | setError
	    ;
		

		setcCPcopyName  throws 
ArchiveSystemApplicationException
		:
		COPYNAME (WS)? copyNo:ALPHANUM
		{		
			if( cCpCopyNoCount == 1)
			{
				throw new ParameterRepeatedException
(&quot;CreateCopy::copyname&quot;);	
			}
			
			String cpynum = copyNo.getText().trim();
	
			
			if((cpynum.equals(&quot;=&quot;))||(cpynum.equals(&quot;&quot;)))
	   		{
	     		throw new MissingParameterValueException
(&quot;copyName&quot;);
	   		}
			
			if(!(isStringValid(cpynum)))
			{				
				throw new 
InvalidParameterValueException(&quot;copyName&quot;);
			}					
			cCpCopyNoCount++;
			cCPHash.put(&quot;copyname&quot;,cpynum);		
		}
		exception
		    catch [NoViableAltException nvae]
		    {
		        throw new MissingParameterValueException
(&quot;copyName&quot;);
		    }
		
	    ;


setcCPdestinationPool throws ArchiveSystemApplicationException
    :
    DESTINATIONPOOL (WS)? ccpDestPool:ALPHANUM
    {
    	if( ccpDestinationPoolCount == 1)
		{
			throw new ParameterRepeatedException
(&quot;CreateCopy::destination pool&quot;);	
		}
        String destPool= ccpDestPool.getText().trim();

        if ((destPool.equals(&quot;=&quot;))||(destPool.equals(&quot;&quot;)))
        {
            throw new MissingParameterValueException
(&quot;CreateCopy::destination pool&quot;);
        }

       	if (!isStringValid(destPool))
       	{
           throw new InvalidParameterValueException
(&quot;CreateCopy::destination pool&quot;);
        }

		cCPHash.put(&quot;destinationpool&quot;, destPool);
        ccpDestinationPoolCount++;
    }

    exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterValueException
(&quot;CreateCopy::destination pool&quot;);
    }
    ;



setcCPRetentionDuration throws  ArchiveSystemApplicationException
	:
	RETENTIONDURATION (WS)? rttime:ALPHANUM
	{
		if( cCPRetentionDur == 1)
		{
			throw new ParameterRepeatedException
(&quot;CreateCopy::retention duration&quot;);	
		}
		String rtTime = rttime.getText().trim();	
	
		
		if((rtTime.equals(&quot;=&quot;))||(rtTime.equals(&quot;&quot;)))
		{
			throw new MissingParameterValueException
(&quot;CreateCopy::retention duration&quot;);
		}
		
		if(!(isRelativeTimeValid(rtTime)))
		{			
			throw new OptionParameterValueException
(&quot;CreateCopy::retention duration: any number follwed by d/m/y&quot;);
		}
		
		cCPHash.put(&quot;retentionduration&quot;,rtTime );
		cCPRetentionDur++;
		
	}
	exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;CreateCopy::retention duration&quot;);
	      
	    }	
	;



setcCPstartTime throws  ArchiveSystemApplicationException
	:
	STARTTIME (WS)? sttime:ALPHANUM
	{
		if(cCPStartTimeCount == 1)
		{
			throw new ParameterRepeatedException
(&quot;CreateCopy::starttime&quot;);
		}
		
		String strtTime = sttime.getText().trim();	
		
		if((strtTime.equals(&quot;=&quot;))||(strtTime.equals(&quot;&quot;)))
		{
			throw new MissingParameterValueException
(&quot;CreateCopy::starttime&quot;);
		}		
		if (!(strtTime.equals(&quot;0&quot;))	){
			if (!(isRelativeTimeValid(strtTime))){	
			
				throw new 
OptionParameterValueException(&quot;CreateCopy::starttime:  0 or #of days 
or # of months or # of years&quot;); 
			}
		
		}
		cCPHash.put(&quot;starttime&quot;,strtTime);
		cCPStartTimeCount++;
		
	}
exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;CreateCopy::starttime&quot;);
	    }
	
	;

setcCPAbsRetentionTime throws  ArchiveSystemApplicationException
	:
	ABSOLUTERETENTIONTIME (WS)? prttime:ALPHANUM
	{
		if(cCpAbsRetentionCount ==1)
		{
			throw new ParameterRepeatedException
(&quot;CreateCopy::retentiontime&quot;);
		}
		String rtTime = prttime.getText().trim();
			
		if((rtTime.equals(&quot;=&quot;))||(rtTime.equals(&quot;&quot;)))
		{
			throw new MissingParameterValueException
(&quot;CreateCopy::retentiontime&quot;);
		}
		
		if(!(isDateValid(rtTime)))
		{		
			throw new OptionParameterValueException
(&quot;CreateCopy::retentiontime: any number followed by d/m/y&quot;); 
		}
		Calendar calendar = Calendar.getInstance();
		calendar.set(year, month - 1, day, hours, min, 0);
		Date dateFormat = calendar.getTime();
		cCPHash.put(&quot;absoluteretentiontime&quot;,dateFormat);
		cCpAbsRetentionCount++;		
		
	}
exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;CreateCopy::retentiontime&quot;);
	    }
	
	;
	

setMigrate throws ArchiveSystemApplicationException
	{		
		migrateHash = new HashMap();
		mgSrcCopyNoCount = 0;
		mgDestinationPoolCount = 0;
		mgAbsStTime = 0;
		mgRelStTime = 0;
		mgRelTo = 0;
		mgRelDur = 0;
	}
	:
	MIGRATE (WS)? (OPAREN)(WS crPlMigrateParams)* (WS)? (CPAREN) 
		
	 {
    	if(mgSrcCopyNoCount ==0 )
    	{    
    		throw new MissingParameterValueException
(&quot;Migrate::CopyName &quot;);	
    	}
    	if(mgDestinationPoolCount ==0)
    	{    	
    		throw new MissingParameterValueException
(&quot;Migrate::destinationpool&quot;);
    	}    
    	//either absstarttime or relstarttime can be present.but not 
both
    
    	
    	if((mgAbsStTime ==1)&amp;&amp; (mgRelDur ==1))
		{		
    		throw new EitherOrParameterException
(&quot;AbsolutestartTime&quot;,&quot;Relativeduration&quot;);
		}
		if((mgAbsStTime ==0)&amp;&amp; (mgRelDur ==0))
		{			
    		throw new EitherOrParameterException
(&quot;AbsolutestartTime&quot;,&quot;Relativeduration&quot;);
		}
		if ((mgRelDur == 1) &amp;&amp; (mgRelTo==0))
		{
			throw new MissingParameterException
(&quot;relativestarttimeto&quot;);
		}
	
		if((mgAbsStTime ==1)&amp;&amp; (mgRelTo ==1))
		{			
    		throw new EitherOrParameterException
(&quot;AbsolutestartTime&quot;,&quot;Relativeto&quot;);
		}
   	 	migrateList.add(migrateHash);
    	hmap.put(&quot;migrate&quot;,migrateList);
    	migrateCount++;
    	    	  
    }
    exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterException(&quot;Migrate&quot;);
    }
	;

crPlMigrateParams throws  ArchiveSystemApplicationException
	
	: setMgCopyName
    | setMgdestPool
    | setMgAbsstartTime
    | setMgRelDuration
    | setMgRelativeTo
    | setError
    ;

	setMgCopyName  throws ArchiveSystemApplicationException
	:
	COPYNAME (WS)? copyNo:ALPHANUM
	{	
		String cpynum = copyNo.getText().trim();	
		if( mgSrcCopyNoCount == 1)
		{
			throw new ParameterRepeatedException
(&quot;Migrate::CopyName&quot;);	
		}
		if((cpynum.equals(&quot;=&quot;))||(cpynum.equals(&quot;&quot;)))
   		{
     		throw new MissingParameterValueException
(&quot;Migrate::CopyName&quot;);
   		}
		
		if(!(isStringValid(cpynum)))
		{			
			throw new InvalidParameterValueException
(&quot;Migrate::CopyName&quot;);
		}
		migrateHash.put(&quot;copyname&quot;,cpynum);
		mgSrcCopyNoCount++;
	}
	exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;Migrate::CopyName&quot;);
	    }
	
    ;


setMgdestPool throws ArchiveSystemApplicationException
    :
    DESTINATIONPOOL (WS)? mgDestPool:ALPHANUM
    {
        if( mgDestinationPoolCount ==1 )
        {
        	throw new ParameterRepeatedException
(&quot;Migrate::DestinationPool&quot;);	
        }
        String destPool= mgDestPool.getText().trim();

        if ((destPool.equals(&quot;=&quot;))||(destPool.equals(&quot;&quot;)))
        {
            throw new MissingParameterValueException
(&quot;Migrate::destination pool&quot;);
        }

       	if (!isStringValid(destPool))
       	{
           throw new InvalidParameterValueException
(&quot;Migrate::destination pool&quot;);
        }

	    migrateHash.put(&quot;destinationpool&quot;, destPool);
        mgDestinationPoolCount++;
    }

    exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterValueException
(&quot;Migrate::destination pool&quot;);
    }
    ;

setMgAbsstartTime throws ArchiveSystemApplicationException
	:
	ABSOLUTESTARTTIME (WS)? sttime:ALPHANUM
	{	
		if( mgAbsStTime == 1)
		{
			throw new ParameterRepeatedException
(&quot;Migrate::absolutestarttime&quot;);	
		}
		String strtTime = sttime.getText().trim();	
	
		if((strtTime.equals(&quot;=&quot;))||(strtTime.equals(&quot;&quot;)))
		{
			throw new MissingParameterValueException
(&quot;Migrate::starttime&quot;);
		}		
		if(!(isDateValid(strtTime)))
		{			
			throw new InvalidParameterValueException
(&quot;Migrate::starttime&quot;); 
		}
		Calendar calendar = Calendar.getInstance();
		calendar.set(year, month - 1, day, hours, min, 0);
		Date dateFormat = calendar.getTime();
		migrateHash.put(&quot;absolutestarttime&quot;,dateFormat);
		mgAbsStTime++;
	}
exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;Migrate::starttime&quot;);
	    }
	
	;

setMgRelDuration throws ArchiveSystemApplicationException
	:
	RELATIVEDURATION (WS)? sttime:ALPHANUM
	{
		if( mgRelDur == 1)
		{
			throw new ParameterRepeatedException
(&quot;Migrate::Relativeduration&quot;);	
		}		
		String duration = sttime.getText().trim();
		
		if((duration.equals(&quot;=&quot;))||(duration==null))
		{
			throw new MissingParameterValueException
(&quot;Migrate::Relativeduration&quot;);
		}		
		if(!(isRelativeTimeValid(duration)))
		{
			throw new InvalidParameterValueException
(&quot;Migrate::Relativeduration&quot;); 
		}		
		migrateHash.put(&quot;relativestarttime&quot;,duration);	
		mgRelDur++;	
		
	}
exception
	    catch [NoViableAltException nvae]
	    {
	        throw new MissingParameterValueException
(&quot;Migrate::Relativeduration&quot;);
	    }
	
	;

setMgRelativeTo throws  ArchiveSystemApplicationException
    :
	RELATIVESTARTTIMETO (WS)? mgrelto:ALPHANUM
    {
       if( mgRelTo == 1)
		{
			throw new ParameterRepeatedException
(&quot;Migrate::relativeto&quot;);	
		}
	    String relTo= mgrelto.getText().trim();

        if ((relTo.equals(&quot;=&quot;))||(relTo.equals(&quot;&quot;)))
        {
            throw new MissingParameterValueException(&quot;relativeto&quot;);
        }
       	if (!isRelStartTimeValid(relTo))
       	{
           throw new InvalidParameterValueException(&quot;relativeto&quot;);
        }
        
        if(relTo.equalsIgnoreCase(&quot;creation&quot;)) {
         migrateHash.put(&quot;relativestarttimeto&quot;,new Integer(1));
        }
        else if(relTo.equalsIgnoreCase(&quot;modification&quot;)) {
         migrateHash.put(&quot;relativestarttimeto&quot;,new Integer(2));
        }
        else if(relTo.equalsIgnoreCase(&quot;LastAccess&quot;)) {
         migrateHash.put(&quot;relativestarttimeto&quot;,new Integer(3));
        }
         mgRelTo++;
       
    }

    exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterValueException(&quot;relativeto&quot;);
    }
    ;



setLog throws ArchiveSystemApplicationException
	{
		logMap = new HashMap();	
		lgReadAccessCount = 0;
		lgintdatastrgCount = 0;
		lgdupDataDetCount =0;
		lgDataAlterCount = 0;
	}
	:
	LOG (WS)? (OPAREN) (WS crPlyLogParams)* (WS)? (CPAREN) 
	{	
		if(logSectionCount == 1)
		{	
			throw new ParameterRepeatedException(&quot;log&quot;);
		}
		if(lgReadAccessCount ==0 )
    	{    	
    		throw new MissingParameterValueException
(&quot;successfullReadAccess &quot;);	
    	}
    	if(lgintdatastrgCount ==0 )
    	{    	
    		throw new MissingParameterValueException
(&quot;initialDataStorageActions &quot;);	
    	}
    	if(lgdupDataDetCount ==0 )
    	{    	
    		throw new MissingParameterValueException
(&quot;duplicateDataDetectionsActions &quot;);	
    	}
    	if(lgDataAlterCount ==0 )
    	{    	
    		throw new MissingParameterValueException
(&quot;successfullDataAlterations &quot;);	
    	}
		logSectionCount++;
			
		hmap.put(&quot;log&quot;,logMap);
	}
	exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterException(&quot;log&quot;);
    }	
	;
	
	
crPlyLogParams throws ArchiveSystemApplicationException
	: setlgReadAccess
	| setlgInitialDataStorage
    | setlgDuplicateDetection
    | setlgSuccessfulDataAlterations
    | setError   
    ;


setlgReadAccess throws ArchiveSystemApplicationException
	:
	SUCCESSFULLREADACCESS (WS)? a:ALPHANUM
	{
		if( lgReadAccessCount == 1)
		{
			throw new ParameterRepeatedException
(&quot;successfullReadAccess&quot;);	
		}		
		 String readAccess = a.getText().trim();

        if (readAccess.equals(&quot;=&quot;))
        {
            throw new MissingParameterValueException
(&quot;successfullReadAccess&quot;);
        }

        if (!isBoolValid(readAccess))
        {
            throw new InvalidParameterValueException
(&quot;successfullReadAccess&quot;);
        }
		logMap.put(&quot;successfullreadaccess&quot;,readAccess);
		lgReadAccessCount++;
	
	}
 exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterValueException
(&quot;successfullReadAccess&quot;);
    }
	;


setlgInitialDataStorage throws ArchiveSystemApplicationException
	:
	INITIALDATASTORAGEACTIONS (WS)? a:ALPHANUM
	{
		if( lgintdatastrgCount == 1)
		{
			throw new ParameterRepeatedException
(&quot;initialDataStorageActions&quot;);	
		}
		
        String storageName = a.getText().trim();

        if ((storageName.equals(&quot;=&quot;))||(storageName.equals(&quot;&quot;)))
        {
            throw new MissingParameterValueException
(&quot;initialDataStorageActions&quot;);
        }

        if (!isBoolValid(storageName))
        {
            throw new InvalidParameterValueException
(&quot;initialDataStorageActions&quot;);
        }

       logMap.put(&quot;initialdatastorageactions&quot;, storageName);
       lgintdatastrgCount++;
       
	}
 exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterValueException
(&quot;initialDataStorageActions&quot;);
    }
	;


setlgDuplicateDetection throws ArchiveSystemApplicationException
	:
	DUPLICATEDATADETECTIONSACTIONS (WS)? a:ALPHANUM
	{
		if( lgdupDataDetCount == 1)
		{
			throw new ParameterRepeatedException
(&quot;duplicateDataDetectionsActions&quot;);	
		}		
        String dupDetect = a.getText().trim();
		
        if( (dupDetect.equals(&quot;=&quot;))|| (dupDetect.equals(&quot;&quot;)))
        {
            throw new MissingParameterValueException
(&quot;duplicateDataDetectionsActions&quot;);
        }

        if (!isBoolValid(dupDetect))
        {
            throw new InvalidParameterValueException
(&quot;duplicateDataDetectionsActions&quot;);
        }

        logMap.put(&quot;duplicatedetectionactions&quot;, dupDetect);
        lgdupDataDetCount++;
        
	}
 exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterValueException
(&quot;duplicateDataDetectionsActions&quot;);
    }
	;


setlgSuccessfulDataAlterations throws 
ArchiveSystemApplicationException
	:
	SUCCESSFULLDATAALTERATIONS (WS)? a:ALPHANUM
	{
		if( lgDataAlterCount == 1)
		{
			throw new ParameterRepeatedException
(&quot;successfullDataAlterations&quot;);	
		}
		
        String dataAlter = a.getText().trim();

        if ((dataAlter.equals(&quot;=&quot;))||(dataAlter.equals(&quot;&quot;)))
        {
            throw new MissingParameterValueException
(&quot;successfullDataAlterations&quot;);
        }

        if (!isBoolValid(dataAlter))
        {
            throw new InvalidParameterValueException
(&quot;successfullDataAlterations&quot;);
        }

        logMap.put(&quot;successfuldataalterations&quot;, dataAlter);
        lgDataAlterCount++;
       
	}
 exception
    catch [NoViableAltException nvae]
    {
        throw new MissingParameterValueException
(&quot;successfullDataAlterations&quot;);
    }
	;





setError throws ArchiveSystemApplicationException
    :
    a:ALPHANUM
    {
        if (true)
        {        
            throw new UnknownParameterException(a.getText().trim());
        }
    }
    ;


/*------------------------------------------------------------------*/
/* Method that validates the input to a boolean vlaue               */
/*                                                                  */
/* @param inputStr, holds the user input data.                      */
/* @return bRetVal, holds whether the data is valid or not.         */
/*------------------------------------------------------------------*/
isBoolValid[String inputStr] returns [boolean bRetVal = true]
    :
    {    
        String patternMatch = &quot;['y','e','s','n','o']&quot;;

        if (inputStr.equalsIgnoreCase(&quot;yes&quot;)||
(inputStr.equalsIgnoreCase(&quot;no&quot;)))
        {     
            if (inputStr.length() &gt; maxLength)
            {
                bRetVal = false;
            }
        }
        else
        {
            bRetVal = false;
        }
    }
    ;


/*------------------------------------------------------------------*/
/* Method that validates the input to a valid string                */
/*                                                                  */
/* @param inputStr, holds the user input data.                      */
/* @return bRetVal, holds whether the data is valid or not.         */
/*------------------------------------------------------------------*/


isStringValid[String inputStr] returns [boolean bRetVal = true]
    :
    {    
        String patternMatch = &quot;[a-zA-Z\\d#$_-]*&quot;;

        if (inputStr.matches(patternMatch))
        {
            if (inputStr.length() &gt; maxLength)
            {
                bRetVal = false;
            }
        }
        else
        {
            bRetVal = false;
        }
    }
    ;



/*------------------------------------------------------------------*/
/* Method that validates the input to an int                        */
/*                                                                  */
/* @param inputStr, holds the user input data.                      */
/* @return bRetVal, holds whether the data is valid or not.         */
/*------------------------------------------------------------------*/
isIntValid[String inputStr] returns [boolean bRetVal = true]
    :
    {
        String patternMatch = &quot;[\\d]*&quot;;

        if (!inputStr.matches(patternMatch))
        {     
            bRetVal = false;
        }
    }
    ;

/*------------------------------------------------------------------*/
/* Method that validates the date and time for the parameters       */
/* 								
	                                 */
/*                                                                  */
/* @param inputStr, holds the user input data.                      */
/* @return bRetVal, holds whether the data is valid or not.         */
/*------------------------------------------------------------------*/
isDateValid[String inputStr] returns [boolean bRetVal = true]
	:
	{
		String patternMatch = &quot;[\\d:]*&quot;;
		if (!inputStr.matches(patternMatch))
        {        
            bRetVal = false;
        }
        if (bRetVal)
        {
            StringTokenizer startTime = new StringTokenizer
(inputStr, &quot;:&quot;);
    	    if (startTime.countTokens() != 5)
            {
                bRetVal = false;
            }
            else
            {
                year = Integer.parseInt((String) startTime.nextToken
());
                month = Integer.parseInt((String) startTime.nextToken
());
                day = Integer.parseInt((String) startTime.nextToken
());
                hours = Integer.parseInt((String) startTime.nextToken
());
                min = Integer.parseInt((String) startTime.nextToken
());
               
                if ((year &lt; 2003) || (year &gt; 9999) || 
                    (month &lt; 1) || (month &gt; 12) || 
                    (day &lt; 1) || (day &gt; 31)||(hours &lt; 0) || (hours &gt; 
23) || 
                    (min &lt; 0) || (min &gt; 59))                  
                   
                {
                    bRetVal = false;
                }
            }
          }
	
	}
	;

	/*------------------------------------------------------------
------*/
	/* Method that validates the retention time		
					*/
	/* 							
		                                */
	/*                                                            
      */
	/* @param inputStr, holds the user input 
data.                      */
	/* @return bRetVal, holds whether the data is valid or 
not.         */
	/*------------------------------------------------------------
------*/
	isRelativeTimeValid[String inputStr] returns [boolean bRetVal 
= true]
		:
		{
			String patternMatch = &quot;[\\d:]*[d,m,y]&quot;;
			if (!inputStr.matches(patternMatch))
        	{        
        		bRetVal =  false;
        	}
		}
		;

	/*------------------------------------------------------------
------*/
	/* Method that validates the relative start time to	
			    */
	/* 							
		                                */
	/*                                                            
      */
	/* @param inputStr, holds the user input 
data.                      */
	/* @return bRetVal, holds whether the data is valid or 
not.         */
	/*------------------------------------------------------------
------*/
	isRelStartTimeValid[String inputStr] returns [boolean bRetVal 
= true]
		:
		{
			if (!(
			      (inputStr.equalsIgnoreCase(&quot;creation&quot;)) 
||<i>
</I>			      (inputStr.equalsIgnoreCase
(&quot;modification&quot;))||
			      (inputStr.equalsIgnoreCase
(&quot;LastAccess&quot;))
			     )) {        
        		bRetVal =  false;
        	}
		}
		;

/**
 * A Lexer class representing lexer for show policy cmd.
 */
class CreatePolicyLexer extends Lexer;
options
{ 
    k = 20;
    caseSensitiveLiterals = false;
    caseSensitive = false;
    charVocabulary = ' '..'~';
}

// Definitions of verbs
CREATE           : &quot;create&quot;;

// Definitions of objects
POLICY       : &quot;policy&quot;;

//def of params
POLICYNAME	: &quot;policyname&quot;;

POLICYDESCR	: &quot;policydescr&quot;;

CREATECOPY	:&quot;createcopy&quot;;

COPYNAME	:&quot;copyname&quot;;

DESTINATIONPOOL: &quot;destinationpool&quot;;

STARTTIME	:&quot;starttime&quot;;

ABSOLUTESTARTTIME	:&quot;absolutestarttime&quot;;

ABSOLUTERETENTIONTIME:&quot;absoluteretention&quot;('t'('i'('m'('e')?)?)?)?;

MIGRATE	:&quot;migrate&quot;;

RELATIVESTARTTIMETO	:&quot;relativestarttimeto&quot;;

RELATIVEDURATION: &quot;relativedura&quot;('t'('i'('o'('n')?)?)?)?;

LOG	:&quot;log&quot;;

SUCCESSFULLREADACCESS :&quot;successfullreadaccess&quot;;

RETENTIONDURATION : &quot;retentionduration&quot;;

INITIALDATASTORAGEACTIONS :&quot;initialdatastorage&quot;('a'('c'('t'('i'('o'('n
'('s')?)?)?)?)?)?)?;

SUCCESSFULLDATAALTERATIONS:&quot;successfulldata&quot;('a'('l'('t'('e'('r'('a'('
t'('i'('o'('n'('s')?)?)?)?)?)?)?)?)?)?)?;

DUPLICATEDATADETECTIONSACTIONS
	:&quot;duplicatedata&quot;('d'('e'('t'('e'('c'('t'('i'('o'('n'('s'('a'('
c'('t'('i'('o'('n'('s')?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?;

OPAREN:	&quot;(&quot;;

CPAREN	: &quot;)&quot;;

WS         : (' ' | '\t')+;

NEWLINE    : '\n';

protected
ALPHANUM options { testLiterals = false; }
    : ('=') =&gt; '='!  (WS)? (~(' ' | '\t' | '\n'))+
    | (WS)? (~(' ' | '\t' | '\n'))+
    ;
    

the output obtained is :

CreatePolicy.g:244: warning:nondeterminism upon
CreatePolicy.g:244:     k==1:WS
CreatePolicy.g:244:     k==2:ALPHANUM
CreatePolicy.g:244:     k==3:WS,NEWLINE
CreatePolicy.g:244:     k==4:EOF,WS,ALPHANUM,CREATECOPY,MIGRATE,LOG
CreatePolicy.g:244:     k==5:EOF,WS,NEWLINE,ALPHANUM,OPAREN
CreatePolicy.g:244:     
k==6:EOF,WS,NEWLINE,ALPHANUM,CREATECOPY,OPAREN,CPAREN,MI
GRATE,LOG
CreatePolicy.g:244:     
k==7:EOF,WS,NEWLINE,ALPHANUM,CREATECOPY,OPAREN,CPAREN,CO
PYNAME,DESTINATIONPOOL,RETENTIONDURATION,STARTTIME,ABSOLUTERETENTIONTI
ME,MIGRATE
,ABSOLUTESTARTTIME,RELATIVEDURATION,RELATIVESTARTTIMETO,LOG,SUCCESSFUL
LREADACCES
S,INITIALDATASTORAGEACTIONS,DUPLICATEDATADETECTIONSACTIONS,SUCCESSFULL
DATAALTERA
TIONS
CreatePolicy.g:244:     
k==8:EOF,WS,NEWLINE,ALPHANUM,CREATECOPY,OPAREN,CPAREN,CO
PYNAME,DESTINATIONPOOL,RETENTIONDURATION,STARTTIME,ABSOLUTERETENTIONTI
ME,MIGRATE
,ABSOLUTESTARTTIME,RELATIVEDURATION,RELATIVESTARTTIMETO,LOG,SUCCESSFUL
LREADACCES
S,INITIALDATASTORAGEACTIONS,DUPLICATEDATADETECTIONSACTIONS,SUCCESSFULL
DATAALTERA
TIONS
CreatePolicy.g:244:     
k==9:EOF,WS,NEWLINE,ALPHANUM,CREATECOPY,OPAREN,CPAREN,CO
PYNAME,DESTINATIONPOOL,RETENTIONDURATION,STARTTIME,ABSOLUTERETENTIONTI
ME,MIGRATE
,ABSOLUTESTARTTIME,RELATIVEDURATION,RELATIVESTARTTIMETO,LOG,SUCCESSFUL
LREADACCES
S,INITIALDATASTORAGEACTIONS,DUPLICATEDATADETECTIONSACTIONS,SUCCESSFULL
DATAALTERA
TIONS
CreatePolicy.g:244:     between alt 1 and exit branch of block











 
Yahoo! Groups Links

&lt;*&gt; To visit your group on the web, go to:
    <A HREF="http://groups.yahoo.com/group/antlr-interest/">http://groups.yahoo.com/group/antlr-interest/</A>

&lt;*&gt; To unsubscribe from this group, send an email to:
    <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-unsubscribe at yahoogroups.com</A>

&lt;*&gt; Your use of Yahoo! Groups is subject to:
    <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A>
 



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="009580.html">[antlr-interest] Re: Recognize letters
</A></li>
	<LI>Next message: <A HREF="009579.html">[antlr-interest] help on warning:nondeterminism upon
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9577">[ date ]</a>
              <a href="thread.html#9577">[ thread ]</a>
              <a href="subject.html#9577">[ subject ]</a>
              <a href="author.html#9577">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
