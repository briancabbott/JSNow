<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] gUnit StringIndexOutOfBoundsException,	getText() called where 	state.tokenStartCharIndex is -1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20gUnit%20StringIndexOutOfBoundsException%2C%0A%09getText%28%29%20called%20where%20%09state.tokenStartCharIndex%20is%20-1&In-Reply-To=%3CAANLkTimapuKzxL06HFY%3DsrrczDVwjNb%3Dm4qSfseRHG5%2B%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039589.html">
   <LINK REL="Next"  HREF="039432.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] gUnit StringIndexOutOfBoundsException,	getText() called where 	state.tokenStartCharIndex is -1</H1>
    <B>Jasper Floor</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20gUnit%20StringIndexOutOfBoundsException%2C%0A%09getText%28%29%20called%20where%20%09state.tokenStartCharIndex%20is%20-1&In-Reply-To=%3CAANLkTimapuKzxL06HFY%3DsrrczDVwjNb%3Dm4qSfseRHG5%2B%40mail.gmail.com%3E"
       TITLE="[antlr-interest] gUnit StringIndexOutOfBoundsException,	getText() called where 	state.tokenStartCharIndex is -1">jasperfloor at gmail.com
       </A><BR>
    <I>Wed Aug 11 08:59:06 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="039589.html">[antlr-interest] Fuzzy parsing ('filter' option)
</A></li>
        <LI>Next message: <A HREF="039432.html">[antlr-interest] gUnit StringIndexOutOfBoundsException, getText() called where state.tokenStartCharIndex is -1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39406">[ date ]</a>
              <a href="thread.html#39406">[ thread ]</a>
              <a href="subject.html#39406">[ subject ]</a>
              <a href="author.html#39406">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a DSL which is already in production but I am working on an
updated version.

We already have quite a few tests which call the parser but I never
added gUnit tests until this version.

Actually everything was working fine until my latest change where I
started messing with the token stream. I don't think I am doing
anything complicated. Also our other tests work fine so I think the
problem is in gUnit.

Basically I have a rule where I want to remove some elements from the
input string. This is done with setText(unescape(getText())).

The problem occurs in getText(). The state.tokenStartCharIndex is -1
and this is passed to substring which is called in getText(). This
leads to a StringIndexOutOfBoundsException.

I've included the grammar. There is also a Tree Grammar after this but
that isn't relevant. There are probably more problems with the grammar
but at this point I'm only interested in the gUnit errors.
I've changed some names to remove any company specific information but
the grammar itself is unchanged.

mvg,
Jasper


p.s. is it bad etiquette to post the whole grammar and tree grammar to
ask for comments?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: X.g
Type: application/octet-stream
Size: 2087 bytes
Desc: not available
Url : <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20100811/f19de4d8/attachment.obj">http://www.antlr.org/pipermail/antlr-interest/attachments/20100811/f19de4d8/attachment.obj</A> 
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039589.html">[antlr-interest] Fuzzy parsing ('filter' option)
</A></li>
	<LI>Next message: <A HREF="039432.html">[antlr-interest] gUnit StringIndexOutOfBoundsException, getText() called where state.tokenStartCharIndex is -1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39406">[ date ]</a>
              <a href="thread.html#39406">[ thread ]</a>
              <a href="subject.html#39406">[ subject ]</a>
              <a href="author.html#39406">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
