<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] About tree duplication ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20About%20tree%20duplication%20%3F&In-Reply-To=db9360ca0511170148q648486a4u%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="014367.html">
   <LINK REL="Next"  HREF="014341.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] About tree duplication ?</H1>
    <B>Ric Klaren</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20About%20tree%20duplication%20%3F&In-Reply-To=db9360ca0511170148q648486a4u%40mail.gmail.com"
       TITLE="[antlr-interest] About tree duplication ?">ric.klaren at gmail.com
       </A><BR>
    <I>Thu Nov 17 03:09:59 PST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="014367.html">[antlr-interest] About tree duplication ?
</A></li>
        <LI>Next message: <A HREF="014341.html">[antlr-interest] About tree duplication ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14340">[ date ]</a>
              <a href="thread.html#14340">[ thread ]</a>
              <a href="subject.html#14340">[ subject ]</a>
              <a href="author.html#14340">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Mathieu Clabaut wrote:
&gt;<i>   In a tree parser, I can not reference twice the same tree when
</I>&gt;<i> constructing a new tree. I have to call astFactory-&gt;create().
</I>&gt;<i>   Is there a way to only use antlr notation ? Is this a feature or a bug ?
</I>
Keep in mind that the antlr tree objects are references or reference
counted objects. Basically they behave like pointers.

&gt;<i>  For example, the following creation rules
</I>&gt;<i>   	    ##= #([OR_SERVICE,&quot;||&quot;],
</I>&gt;<i> 		     #([TWOWAY,&quot;&lt;&gt;&quot;],#s3,
</I>&gt;<i> 			#([SOURCE,&quot;:&lt;&quot;], #f3),
</I>&gt;<i> 			#([DESTINATION,&quot;:&gt;&quot;],#t3)
</I>&gt;<i> 		     ),
</I>&gt;<i> 		     #([TWOWAY,&quot;&lt;&gt;&quot;],#s3,
</I>&gt;<i> 			#([SOURCE,&quot;:&lt;&quot;], #t3),
</I>&gt;<i> 			#([DESTINATION,&quot;:&gt;&quot;],#f3)
</I>&gt;<i> 		     )
</I>
This is really bad practice since you link a node into the tree at
multiple spots, potentially creating loops in the tree that will hang
the normal tree traversal functions.

Before you stick the nodes in the tree you have to duplicate them using
ASTFactory-&gt;dup() or dupTree() in case it's a subtree you're dealing
with. Another option is to use the clone method of the nodes.

&gt;<i> Whereas the following creation rules:
</I>&gt;<i> 	    ##= #([OR_SERVICE,&quot;||&quot;],
</I>&gt;<i> 		     #([TWOWAY,&quot;&lt;&gt;&quot;],#s3,
</I>&gt;<i> 			#([TWOCOLON,&quot;::&quot;] , #b3),
</I>&gt;<i> 			#([SOURCE,&quot;:&lt;&quot;], #f3),
</I>&gt;<i> 			#([DESTINATION,&quot;:&gt;&quot;],#t3)
</I>&gt;<i> 		     ),
</I>&gt;<i> 		     #([TWOWAY,&quot;&lt;&gt;&quot;],astFactory-&gt;create(#s3),
</I>&gt;<i> 			#([TWOCOLON,&quot;::&quot;] , #b3),
</I>&gt;<i> 			#([SOURCE,&quot;:&lt;&quot;], #t3),
</I>&gt;<i> 			#([DESTINATION,&quot;:&gt;&quot;],#f3)
</I>&gt;<i> 		     )
</I>&gt;<i> Gives the expected results :
</I>&gt;<i> ||
</I>&gt;<i>  &lt;&gt;
</I>&gt;<i>   s3 :&lt;f3 :&gt; t3
</I>&gt;<i>  &lt;&gt;
</I>&gt;<i>   s3 :&lt;t3 :&gt;f3
</I>
This is better but you should dup/clone all the nodes you put in twice.
Safest practice is to clone everything but if you're sure the
s3/b3/f3/t3 are only used once then it suffices to only do it once.

Cheers,

Ric
</PRE>

























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="014367.html">[antlr-interest] About tree duplication ?
</A></li>
	<LI>Next message: <A HREF="014341.html">[antlr-interest] About tree duplication ?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#14340">[ date ]</a>
              <a href="thread.html#14340">[ thread ]</a>
              <a href="subject.html#14340">[ subject ]</a>
              <a href="author.html#14340">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
