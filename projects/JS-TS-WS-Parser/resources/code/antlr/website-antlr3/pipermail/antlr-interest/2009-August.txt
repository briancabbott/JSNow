From Jayesh.Patel at sandstone-tech.com  Sat Aug  1 09:38:52 2009
From: Jayesh.Patel at sandstone-tech.com (Jayesh Patel)
Date: Sun, 2 Aug 2009 02:38:52 +1000
Subject: [antlr-interest] Embedded expressions
Message-ID: <20194347FAADB045A7E9675E9A6879F30AF15A4F79@sstaumail.sandstone.local>

Hello everybody

 I'm very new to ANTLR and so far I have been able to achieve what I want.  Before I go a head with the problem, a little background to what I'm trying to do.  I have a number of text based document files, into which I have inserted expressions into the text to insert dates, names and figures.  I'm using ANTLR to tranform the text  file into a populated text file.  An typical example of the expressions would be:
 
[. insert.date.today/]
 
The lexer and the parser correctly finds and evaluates any expression that is on its own.  My problem is this, I can have expressions embedded within text.  I want to retain the text and to evaluate the expression.  An example of what I'm using is:
 
'Your next appointment date is [. insert.date.nextAppointmentDate/] and you will be seen
by [. insert avaliable.consultant.fullName/].  Please, bring along your [. insert careerDocumentList/]
to help with you career choice.'
 
However, what is happening is that expressions embedded in the text are being ignored and all you get is:
 
'Your next appointment date is   and you will be seen
by  .  Please, bring along your  
to help with you career choice.'
 
I have successfully got everything working the way I want it, and the Lexer and tree diagram clearly indentifies the embedded expressions.  To cater for the text I have used the following rule:
 
everything_else
  :(IDENTIFIER | SYMBOLS) (options {greedy=false;} :.*) ;
 
I believe that the problem is caused by the (options {greedy=false;} :.*).  The wildcard '.*' is accepting all of the text, as text, and ignoring the embedded expressions.
 
The lexer rules I have used are:
 
EXPRESSION_ALPHA: ('a'..'z' | 'A'..'Z' | '.');
 
NUMBER: ('0'..'9');
 
LEFT_PAREN: '[.';
 
RIGHT_PAREN:  '\\]'| ']';
 
WS:  (' ' | '\t' | '\u000C' | '\r' | '\n' )* {$channel = HIDDEN;};
 
IDENTIFIER: (EXPRESSION_ALPHA|NUMBER)+;
 
Many thanks
 
Jay

From s.barnett-cormack at lancaster.ac.uk  Sat Aug  1 13:32:54 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Sat, 01 Aug 2009 21:32:54 +0100
Subject: [antlr-interest] Generated classes - annotations
Message-ID: <4A74A676.40701@lancaster.ac.uk>

Hey all,

similar to previous discussions of doc-comments reaching the generated 
classes, it'd be *really* nice if it were possible to annotate the 
generated classes. Specifically, adding @SuppressWarnings("all") would 
be lovely, as the generated code produces so many warnings (dead code, 
unused local variables, unused imports...).

If there were just something, akin to @header, that appeared between the 
antlr-generated imports and the actual class, that would do the trick - 
for doc-comments (of the class) and for annotations.

Just a thought.

-- 
Sam Barnett-Cormack

From parrt at cs.usfca.edu  Sat Aug  1 14:31:38 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 1 Aug 2009 14:31:38 -0700
Subject: [antlr-interest] Generated classes - annotations
In-Reply-To: <4A74A676.40701@lancaster.ac.uk>
References: <4A74A676.40701@lancaster.ac.uk>
Message-ID: <7F568F9E-F33A-4AA5-B7D9-C47034A5DE2F@cs.usfca.edu>

  Don't tell anybody I told you this, but you can do this:

@annotatemethod { @SuppressWarnings("all") }

and then alter Java.stg so that it references

<actions.annotatemethod>

right before the method definition. Bob's your uncle, and you have  
annotations.

ANTLR's output template mechanism allows you to name any action you  
want and then reference it from the output templates.

Ter

On Aug 1, 2009, at 1:32 PM, Sam Barnett-Cormack wrote:

> Hey all,
>
> similar to previous discussions of doc-comments reaching the generated
> classes, it'd be *really* nice if it were possible to annotate the
> generated classes. Specifically, adding @SuppressWarnings("all") would
> be lovely, as the generated code produces so many warnings (dead code,
> unused local variables, unused imports...).
>
> If there were just something, akin to @header, that appeared between  
> the
> antlr-generated imports and the actual class, that would do the  
> trick -
> for doc-comments (of the class) and for annotations.
>
> Just a thought.
>
> -- 
> Sam Barnett-Cormack
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From Tony.Gray at ca.schneider-electric.com  Sat Aug  1 16:02:14 2009
From: Tony.Gray at ca.schneider-electric.com (Tony.Gray at ca.schneider-electric.com)
Date: Sat, 1 Aug 2009 16:02:14 -0700
Subject: [antlr-interest] AUTO: Tony Gray is out of the office. (returning
	08/08/2009)
Message-ID: <OFD010AEE8.2B4C8F71-ON88257605.007E8C1C-88257605.007E8C1C@US.Schneider-Electric.com>



I am out of the office until 08/08/2009.

For urgent issues, please contact Aaron Sundberg at extension 7543


Note: This is an automated response to your message  "antlr-interest Digest, Vol 57, Issue 1"
sent on 8/1/2009 12:00:01 PM.

This is the only notification you will receive while this person is away.


From s.barnett-cormack at lancaster.ac.uk  Sun Aug  2 03:39:34 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Sun, 02 Aug 2009 11:39:34 +0100
Subject: [antlr-interest] Generated classes - annotations
In-Reply-To: <7F568F9E-F33A-4AA5-B7D9-C47034A5DE2F@cs.usfca.edu>
References: <4A74A676.40701@lancaster.ac.uk>
	<7F568F9E-F33A-4AA5-B7D9-C47034A5DE2F@cs.usfca.edu>
Message-ID: <4A756CE6.6040103@lancaster.ac.uk>

Terence Parr wrote:
>  Don't tell anybody I told you this, but you can do this:
> 
> @annotatemethod { @SuppressWarnings("all") }
> 
> and then alter Java.stg so that it references
> 
> <actions.annotatemethod>
> 
> right before the method definition. Bob's your uncle, and you have 
> annotations.
> 
> ANTLR's output template mechanism allows you to name any action you want 
> and then reference it from the output templates.

So you can literrally do

@foo {blah}

and reference

<actions.foo>

?

Sam

> On Aug 1, 2009, at 1:32 PM, Sam Barnett-Cormack wrote:
> 
>> Hey all,
>>
>> similar to previous discussions of doc-comments reaching the generated
>> classes, it'd be *really* nice if it were possible to annotate the
>> generated classes. Specifically, adding @SuppressWarnings("all") would
>> be lovely, as the generated code produces so many warnings (dead code,
>> unused local variables, unused imports...).
>>
>> If there were just something, akin to @header, that appeared between the
>> antlr-generated imports and the actual class, that would do the trick -
>> for doc-comments (of the class) and for annotations.
>>
>> Just a thought.
>>
>> -- 
>> Sam Barnett-Cormack
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


-- 
Sam Barnett-Cormack

From s.barnett-cormack at lancaster.ac.uk  Sun Aug  2 03:54:12 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Sun, 02 Aug 2009 11:54:12 +0100
Subject: [antlr-interest] Generated classes - annotations
In-Reply-To: <7F568F9E-F33A-4AA5-B7D9-C47034A5DE2F@cs.usfca.edu>
References: <4A74A676.40701@lancaster.ac.uk>
	<7F568F9E-F33A-4AA5-B7D9-C47034A5DE2F@cs.usfca.edu>
Message-ID: <4A757054.9000504@lancaster.ac.uk>

More specifically, I change Java.stg (after copying and renaming, in my 
case) so that the last few lines of outputFile are now

<docComment>
<actions.(actionScope).annotate>
<recognizer>

Then in my combined grammar I assume I can do:

@annotate {/* stuff for parser*/}
@lexer::annotate {/* stuff for lexer */}

I'm almost tempted to remove the existing <docComment> invocation and 
put one in using <actions.(actionScope).doc> or something.

Am I heading in the right direction?

Sam

Terence Parr wrote:
>  Don't tell anybody I told you this, but you can do this:
> 
> @annotatemethod { @SuppressWarnings("all") }
> 
> and then alter Java.stg so that it references
> 
> <actions.annotatemethod>
> 
> right before the method definition. Bob's your uncle, and you have 
> annotations.
> 
> ANTLR's output template mechanism allows you to name any action you want 
> and then reference it from the output templates.
> 
> Ter
> 
> On Aug 1, 2009, at 1:32 PM, Sam Barnett-Cormack wrote:
> 
>> Hey all,
>>
>> similar to previous discussions of doc-comments reaching the generated
>> classes, it'd be *really* nice if it were possible to annotate the
>> generated classes. Specifically, adding @SuppressWarnings("all") would
>> be lovely, as the generated code produces so many warnings (dead code,
>> unused local variables, unused imports...).
>>
>> If there were just something, akin to @header, that appeared between the
>> antlr-generated imports and the actual class, that would do the trick -
>> for doc-comments (of the class) and for annotations.
>>
>> Just a thought.
>>
>> -- 
>> Sam Barnett-Cormack
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


-- 
Sam Barnett-Cormack

From parrt at cs.usfca.edu  Sun Aug  2 10:01:56 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 2 Aug 2009 10:01:56 -0700
Subject: [antlr-interest] Generated classes - annotations
In-Reply-To: <4A757054.9000504@lancaster.ac.uk>
References: <4A74A676.40701@lancaster.ac.uk>
	<7F568F9E-F33A-4AA5-B7D9-C47034A5DE2F@cs.usfca.edu>
	<4A757054.9000504@lancaster.ac.uk>
Message-ID: <766D9E88-9B39-4488-B070-0F83355CA61F@cs.usfca.edu>

I believe you are on the right track :) Please report back
T
On Aug 2, 2009, at 3:54 AM, Sam Barnett-Cormack wrote:

> More specifically, I change Java.stg (after copying and renaming, in  
> my case) so that the last few lines of outputFile are now
>
> <docComment>
> <actions.(actionScope).annotate>
> <recognizer>
>
> Then in my combined grammar I assume I can do:
>
> @annotate {/* stuff for parser*/}
> @lexer::annotate {/* stuff for lexer */}
>
> I'm almost tempted to remove the existing <docComment> invocation  
> and put one in using <actions.(actionScope).doc> or something.
>
> Am I heading in the right direction?
>
> Sam
>
> Terence Parr wrote:
>> Don't tell anybody I told you this, but you can do this:
>> @annotatemethod { @SuppressWarnings("all") }
>> and then alter Java.stg so that it references
>> <actions.annotatemethod>
>> right before the method definition. Bob's your uncle, and you have  
>> annotations.
>> ANTLR's output template mechanism allows you to name any action you  
>> want and then reference it from the output templates.
>> Ter
>> On Aug 1, 2009, at 1:32 PM, Sam Barnett-Cormack wrote:
>>> Hey all,
>>>
>>> similar to previous discussions of doc-comments reaching the  
>>> generated
>>> classes, it'd be *really* nice if it were possible to annotate the
>>> generated classes. Specifically, adding @SuppressWarnings("all")  
>>> would
>>> be lovely, as the generated code produces so many warnings (dead  
>>> code,
>>> unused local variables, unused imports...).
>>>
>>> If there were just something, akin to @header, that appeared  
>>> between the
>>> antlr-generated imports and the actual class, that would do the  
>>> trick -
>>> for doc-comments (of the class) and for annotations.
>>>
>>> Just a thought.
>>>
>>> -- 
>>> Sam Barnett-Cormack
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> -- 
> Sam Barnett-Cormack


From obua at me.com  Sun Aug  2 15:19:38 2009
From: obua at me.com (Steven Obua)
Date: Mon, 03 Aug 2009 00:19:38 +0200
Subject: [antlr-interest] Strange lexing behavior ?
Message-ID: <8C24C4DE-7CC0-41B1-8A00-8D60BD93739E@me.com>

Hi,

I am using Antlr v3 to define the syntax of my own programming  
language and I stumbled across a strange behavior. I was messing  
around with how to best define C-style comments (both single-line and  
multi-line) and arrived at the following (these are the first rule  
definitions in my combined lexer/parser antlr file):

------------------------------------------------------------------------------------------------------
COMMENT1:	'/*' (options {greedy=false;} : .)* '*/' {$channel=HIDDEN;};


fragment
Newline	:	('\u000A' | '\u000D' | '\u0085' | '\u000C' | '\u2028' |  
'\u2029');

COMMENT2:	'//' (~Newline)* Newline* {$channel=HIDDEN;};
---------------------------------------------------------------------------------------------------------

But when parsing a file that starts with three single-line comments it  
will report a lexing error already in the first line (and also in the  
third line) !! I experimented a little, and now I use the following:

-------------------------------------------------------------------------------------------------------
COMMENT1:	'/*' (options {greedy=false;} : .)* '*/' {$channel=HIDDEN;};


fragment
Newline	:	('\u000A' | '\u000D' | '\u0085' | '\u000C' | '\u2028' |  
'\u2029');
	
fragment	
NotNewline
	:	~('\u000A' | '\u000D' | '\u0085' | '\u000C' | '\u2028' | '\u2029');

COMMENT2:	'//' NotNewline* Newline* {$channel=HIDDEN;};
----------------------------------------------------------------------------------------------------------

This works! Note that the only difference is that I replaced  
(~Newline)* with NotNewline* ...

Now I can parse the file without any errors. Is this a bug of ANTLR or  
am I missing some finer points of how Antlr's lexical analysis works ?

Cheers,

Steven Obua




From jeroen.v.schagen at gmail.com  Mon Aug  3 00:03:51 2009
From: jeroen.v.schagen at gmail.com (Jeroen van Schagen)
Date: Mon, 3 Aug 2009 09:03:51 +0200
Subject: [antlr-interest] use of tree matching rules in tree grammar
Message-ID: <cabba3130908030003o3c7298c7h95da3c8fa452962@mail.gmail.com>

Hello,

Currently I'm working on my first tree grammar after reading the definitive
ANTLR reference. Personally I love the concept of tree grammars, but there
are some things that seem a bit unlogical to me. Why do you have to specify
"tree matching rules" after having specified recognition rules and rewrite
rules? Wouldn't it be allot more productive and most definately less
error-prone to extend a parser grammar and only overwrite the rules in which
you want to embed action code? Just imagion having a project with a dozen
tree grammars and somthing changes in the parser grammar, e.g. two nodes are
swapped, you would have to change all tree grammars. Not the mention the
amount of duplicate code you would have to write.

Yours,
Jeroen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090803/e157769d/attachment.html 

From marwan.alephn at gmail.com  Mon Aug  3 00:38:19 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Mon, 3 Aug 2009 09:38:19 +0200
Subject: [antlr-interest] How to extend the CommonTree without getting a
	classcastexcpetion in the generated code?
Message-ID: <6535fcb50908030038u7a393f50u2c4fbe2a009f8fb2@mail.gmail.com>

Hi there;

I did define a customized node, extending a commonTree, defined an
adaptor extending a  CommonTreeAdaptor, for my semantic analysis.
Nevertheless, I'm getting a classCastException, when the parser find
the first sintax error.

The reason is that it can not cast CommonErrorNode to my customized
node, since both extend CommonTree.

I'm interested on reporting all parser errores no just the first one.
What is the better aproach, dealing with this expcetion so it doesn't
stop the execution?

Thx in advance for any help,

Cheers

-- 
Marouane

From tomislav.adamic at gmail.com  Mon Aug  3 00:39:58 2009
From: tomislav.adamic at gmail.com (Adamic Tomislav)
Date: Mon, 3 Aug 2009 09:39:58 +0200
Subject: [antlr-interest] [antlr3c] Need help working with ANTLR3_STRING...
Message-ID: <8129e4430908030039n50a6f35fma582682f3bcb47a8@mail.gmail.com>

Hi

I'm a bit puzzled with ANTLR API for ANTLR3_STRING... I need few
operations on strings and I could do it either by converting
ANTLR3_STRING into std::string (or std::wstring) or do it directly.
Well, I can't figure out either. So, let's say I want to create a copy
of some already existing ANTLR3_STRING. Is this the proper way of
doing it, so it doesn't leak memory:

From marwan.alephn at gmail.com  Mon Aug  3 00:54:08 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Mon, 3 Aug 2009 09:54:08 +0200
Subject: [antlr-interest] use of tree matching rules in tree grammar
In-Reply-To: <cabba3130908030003o3c7298c7h95da3c8fa452962@mail.gmail.com>
References: <cabba3130908030003o3c7298c7h95da3c8fa452962@mail.gmail.com>
Message-ID: <6535fcb50908030054j230db7dbyd3b747244ab99602@mail.gmail.com>

Divide and conquer, one thing is the fucionality of a syntax and
recognization rules and other diferent is the semantic.

Cheers,

Marouane


2009/8/3 Jeroen van Schagen <jeroen.v.schagen at gmail.com>:
> Hello,
>
> Currently I'm working on my first tree grammar after reading the definitive
> ANTLR reference. Personally I love the concept of tree grammars, but there
> are some things that seem a bit unlogical to me. Why do you have to specify
> "tree matching rules" after having specified recognition rules and rewrite
> rules? Wouldn't it be allot more productive and most definately less
> error-prone to extend a parser grammar and only overwrite the rules in which
> you want to embed action code? Just imagion having a project with a dozen
> tree grammars and somthing changes in the parser grammar, e.g. two nodes are
> swapped, you would have to change all tree grammars. Not the mention the
> amount of duplicate code you would have to write.
>
> Yours,
> Jeroen
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>



-- 
Marouane

From tomislav.adamic at gmail.com  Mon Aug  3 00:58:35 2009
From: tomislav.adamic at gmail.com (Adamic Tomislav)
Date: Mon, 3 Aug 2009 09:58:35 +0200
Subject: [antlr-interest] [antlr3c] Need help working with
	ANTLR3_STRING...
In-Reply-To: <8129e4430908030039n50a6f35fma582682f3bcb47a8@mail.gmail.com>
References: <8129e4430908030039n50a6f35fma582682f3bcb47a8@mail.gmail.com>
Message-ID: <8129e4430908030058g1a02f92dwdf808a2e56c48ae4@mail.gmail.com>

Hi

I'm a bit puzzled with ANTLR API for ANTLR3_STRING... I need few
operations on strings and I could do it either by converting
ANTLR3_STRING into std::string (or std::wstring) or do it directly.
Well, I can't figure out either. So, let's say I want to create a copy
of some already existing ANTLR3_STRING. Is this the proper way of
doing it, so it doesn't leak memory:

pANTLR3_STRING_FACTORY sFact = antlr3StringFactoryNew();
pANTLR3_STRING str = sFact->newRaw(sFact);
// ... do some work with str
sFact->close();

The more important thing I'm puzzled about is hoe to make whole string
lowercase... I see that I can iterate over it, but what to do with
each ANTLR3_UCHAR? How do I make it lowercase?

Well, I was thinking of using suplied toUTF8 function, then converting
resulting UTF8 string to some string class that has more complete
implementation and then use this class to lowercase the string and
work with it... This seems like overkill, so is there a better way?

Oh, yes, I haven't mentioned it, I'm using anlr3c from C++ program...

From tomislav.adamic at gmail.com  Mon Aug  3 01:38:25 2009
From: tomislav.adamic at gmail.com (Adamic Tomislav)
Date: Mon, 3 Aug 2009 10:38:25 +0200
Subject: [antlr-interest] [antlr3c] Posible bug i C runtime generated code
	(ANTLR v3.1.3 and libantlr3c 3.1.3)
Message-ID: <8129e4430908030138u6de848k98b7eff5ea8c32af@mail.gmail.com>

Hi

Using two grammars below, ANTLR generates code that is not compilable
with either C or C++ compiler. Specifically, generated file
"ExampleGrammarEval.c" contains expression "MyStruct value = NULL;"
which is not valid C/C++ (because value is not pointer) so the code
doesn't compile. There is a work around which makes
"ExampleGrammarEval.g" bigger and harder to read. Also, this
workaround is not practical to apply for larger struct with more
member variables.

Following are the 2 grammars needed to reproduce the bug, and the
third one that describes workaround.

-------------------------------------cut
here-----------------------------------------
grammar ExampleGrammar;

options {
  output=AST;
  ASTLabelType=pANTLR3_BASE_TREE;
  language=C;
}

tokens {
  PLUS	= '+';
}

prog : expr EOF!;
expr : addition;
addition : atom ( (PLUS)^ atom )*;
atom : NUMBER;
fragment DEC_DIGIT : '0'..'9' ;
NUMBER : DEC_DIGIT+;
WS : (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;};
-------------------------------------cut
here-----------------------------------------

-------------------------------------cut
here-----------------------------------------
tree grammar ExampleGrammarEval;

options {
	tokenVocab=ExampleGrammar;
	ASTLabelType=pANTLR3_BASE_TREE;
	language=C;
}

@includes {
typedef struct {
	double d1, d2;
} MyStruct ;
}

prog returns [MyStruct value]
    : expr { $value = $expr.value; };

expr returns [MyStruct value]
    : addition { $value = $addition.value; };

addition returns [MyStruct value]
    : ^(PLUS a=atom b=atom) {
		$value.d1 = $a.value.d1 + $b.value.d1;
		$value.d2 = $a.value.d2 + $b.value.d2;
    }
	| atom {
    	$value = $atom.value;
    };

atom returns [MyStruct value]
// Here is actually some parsing done to convert string into numerical
// value which is omited for simplicity.
    : NUMBER { value.d1 = value.d2 = 0.0 };
-------------------------------------cut
here-----------------------------------------

-------------------------------------cut
here-----------------------------------------
tree grammar ExampleGrammarEval;

options {
	tokenVocab=ExampleGrammar;
	ASTLabelType=pANTLR3_BASE_TREE;
	language=C;
}

@includes {
typedef struct {
	double d1, d2;
} MyStruct ;
}

prog returns [double d1, double d2]
    : expr { $d1 = $expr.d1; $d2 = $expr.d2; };

expr returns [double d1, double d2]
    : addition { $d1 = $addition.d1; $d2 = $addition.d2; };

addition returns [double d1, double d2]
    : ^(PLUS a=atom b=atom) {
		$d1 = $a.d1 + $b.d1;
		$d2 = $a.d2 + $b.d2;
    }
	| atom {
    	$d1 = $a.d1; $d2 = $b.d2;
    };

atom returns [double d1, double d2]
// Here is actually some parsing done to convert string into numerical
// value which is omited for simplicity.
    : NUMBER { value.d1 = value.d2 = 0.0 };
-------------------------------------cut
here-----------------------------------------

From marwan.alephn at gmail.com  Mon Aug  3 03:46:06 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Mon, 3 Aug 2009 12:46:06 +0200
Subject: [antlr-interest] Extending a CommonTree
Message-ID: <6535fcb50908030346p4039aa50l65f05513d7863096@mail.gmail.com>

Hi there;

I did define a customized node, extending a commonTree, defined an
adaptor extending a  CommonTreeAdaptor, for my semantic analysis.
Nevertheless, I'm getting a classCastException, when the parser find
the first sintax error.

The reason is that it can not cast CommonErrorNode to my customized
node, since both extend CommonTree.

I'm interested on reporting all parser errores no just the first one.
What is the better aproach, dealing with this expcetion so it doesn't
stop the execution?

Thx in advance for any help,

Cheers

--
Marouane


-- 
Marouane

From sadie at kind.ocn.ne.jp  Mon Aug  3 03:55:17 2009
From: sadie at kind.ocn.ne.jp (sunao furukawa)
Date: Mon, 3 Aug 2009 19:55:17 +0900
Subject: [antlr-interest] How to debug grammars on Vista (was: How to
	debug tree grammar??)
In-Reply-To: <4A64BC14.9030409@jacaranda.org>
References: <9D23A17EC9A3439CA9EE77B75281E2A8@sunaoPC>
	<4A64BC14.9030409@jacaranda.org>
Message-ID: <682E5600EAB043FA97ABD71A11E003C2@sunaoPC>

Hello! Everybody.
some days ago,I got a reply from this mailinglist(David-Sarah Hopwood).
ANTLRWorks generated(debug menu->debug) __Test__.java,
debugging(debug menu->debug remote) T1.g is successful.
But,TestE.java doesn't get a port(DEBUGGER_PORT 48000),
so debug remote(debug menu->debug remote) doesn't work.
I use antlrworks-1.2.3 on Windows Vista Home Basic sp1.
Why cannot I debug remote TestE.java ?
Please tell me the reason that I can debug __Test__.java but I cannot debug 
TestE.java !
File, below,
---------------------------------------------------------------------------
<TestE.java>
import java.io.*;
import org.antlr.runtime.RecognizerSharedState;
import org.antlr.runtime.ANTLRInputStream;
import org.antlr.runtime.CommonTokenStream;
import org.antlr.runtime.tree.CommonTree;
import org.antlr.runtime.tree.CommonTreeNodeStream;
import org.antlr.runtime.debug.DebugEventSocketProxy;

public class TestE {
    private static final int DEBUGGER_PORT = 48000;
    public static void main(String[] args) throws Exception {
        ANTLRInputStream input = new ANTLRInputStream(System.in);
        E3Lexer lexer = new E3Lexer(input);
        CommonTokenStream tokens = new CommonTokenStream(lexer);

        E3Parser parser = new E3Parser(tokens,DEBUGGER_PORT,new 
RecognizerSharedState());

        E3Parser.prog_return r = parser.prog();

        CommonTree t = (CommonTree)r.getTree();
        CommonTreeNodeStream nodes = new CommonTreeNodeStream(t);
        T1 walker = new T1(nodes);
        walker.prog();
    }
}
-----------------------------------------------------------------------------
<__Test__.java>
import java.io.*;
import org.antlr.runtime.*;
import org.antlr.runtime.tree.*;
import org.antlr.runtime.debug.DebugEventSocketProxy;


public class __Test__ {
    private static final int DEBUGGER_PORT = 48000;
    public static void main(String args[]) throws Exception {
        E3Lexer lex = new E3Lexer(new 
ANTLRFileStream("C:\\Users\\sunao\\Desktop\\output\\__Test___input.txt"));
        CommonTokenStream tokens = new CommonTokenStream(lex);

        E3Parser parser = new E3Parser(tokens, DEBUGGER_PORT, new 
RecognizerSharedState());

        E3Parser.prog_return r = parser.prog();
        CommonTreeNodeStream nodes = new CommonTreeNodeStream(r.getTree());

        T1 walker = new T1(nodes);
        try {
            walker.prog();
        } catch (RecognitionException e) {
            e.printStackTrace();
        }
    }
------------------------------------------------------------------------------
<E3.g>
grammar E3;

options{
 output = AST;
 ASTLabelType = CommonTree;
}

tokens{
 ASSIGN; ALU_ADD; ALU_SUB; ALU_MUL; ALU_DIV;
}

prog
 : (
   statement
  { if ($statement.tree != null) 
System.out.println($statement.tree.toStringTree());}
   )+

 ;
statement
 : expression NEWLINE!
 | IDENTIFIER '=' expression NEWLINE
  -> ^(ASSIGN IDENTIFIER expression)
 | NEWLINE!
 ;
expression
 : product (aop^ product)*
 ;
aop
 : '+'
  -> ALU_ADD
 | '-'
  -> ALU_SUB
 ;
product
 : factor (pop^ factor)*
 ;
pop
 : '*'
  -> ALU_MUL
 | '/'
  -> ALU_DIV
 ;
factor
 : IDENTIFIER
 | CONSTANT
 | '('! expression ')'!
 ;

IDENTIFIER :   ('a'..'z'|'A'..'Z')+ ;
CONSTANT :   '0'..'9'+ ;
NEWLINE  :   '\r'? '\n' ;
WS  :   (' '|'\t')+ {skip();} ;

---------------------------------------------------------------------
<T1.g>
tree grammar T1;

options{
 tokenVocab=E3;
 ASTLabelType = CommonTree;
 output=AST;
}

@header {
import java.util.HashMap;
}

@members {
HashMap memory = new HashMap();
}

prog : statement+ ;

statement
 : e=expression
  { System.out.println($e.value); }
 | ^(ASSIGN id=IDENTIFIER e=expression)
  { memory.put($id.text, new Integer($e.value)); }
 ;
expression returns [int value]
 : ^(ALU_ADD a=expression b=expression)
  {$value = $a.value + $b.value;}
 | ^(ALU_SUB a=expression b=expression)
  {$value = $a.value - $b.value;}
 | ^(ALU_MUL a=expression b=expression)
  {$value = $a.value * $b.value;}
 | ^(ALU_DIV a=expression b=expression)
  {$value = $a.value / $b.value;}
 | IDENTIFIER
  {
  Integer v = (Integer)memory.get($IDENTIFIER.text);
  if (v != null) $value = v.intValue();
  else System.err.println("undefined variable " + $IDENTIFIER.text);
  }
 | CONSTANT
  { $value = Integer.parseInt($CONSTANT.text); }
 ;
-------------------------------------------------------------------------
----- Original Message ----- 
From: "David-Sarah Hopwood" <david-sarah at jacaranda.org>
To: <antlr-interest at antlr.org>
Sent: Tuesday, July 21, 2009 3:48 AM
Subject: Re: [antlr-interest] How to debug grammars on Vista (was: How to 
debug tree grammar??)


> sunao furukawa wrote:
> [...]
>> 4.I started ANTLRWorks debug remote in localhost port 49153.
>> 5.I executed [java TestE],and standard input [a=1 (CRLF) a+2*3 (CRLF)
>> (Ctrl-C)].
>>
>> But I could not debug T1.g and below, error occur.
>> (ASSIGN a 1)
>> line 0:-1 mismatched input '<EOF>' expecting NEWLINE
>> <mismatched token: [@-1,0:0='<no text>',<-1>,0:-1], resync=a+2*3>
>> java.net.BindException: Address already in use: JVM_Bind
> [...]
>> I use Windows Vista Home Basic sp1.IP adress is private(dhcp).
>
> I found that the default port 49153 could not be used on Vista. You
> need to override it:
>
> - in the ANTLRWorks preferences (File menu | Preferences | Debugger tab),
>   set 'Default local port' to an unused port number. I used 48000.
>
>   If you need to use remote debugging (where the debugged process is
>   launched separately from ANTLRWorks), also add -debug to the ANTLR
>   options in the General tab.
>
> - pass this port number into the E3Parser, e.g.:
>
>> public class TestE {
>      private static final int DEBUGGER_PORT = 48000;
>
>>     public static void main(String[] args) throws Exception {
>>         ANTLRInputStream input = new ANTLRInputStream(System.in);
>>         E3Lexer lexer = new E3Lexer(input);
>>         CommonTokenStream tokens = new CommonTokenStream(lexer);
>
>          E3Parser parser = new E3Parser(tokens, DEBUGGER_PORT,
>                                         new RecognizerSharedState());
>
>>         E3Parser.prog_return r = parser.prog();
>>
>>         CommonTree t = (CommonTree)r.getTree();
>>         CommonTreeNodeStream nodes = new CommonTreeNodeStream(t);
>>         T1 walker = new T1(nodes);
>>         walker.prog();
>>     }
>> }
>
> This is not dependent on the grammar being a tree grammar.
>
> -- 
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 



From antlr at mirality.co.nz  Mon Aug  3 04:18:59 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 03 Aug 2009 23:18:59 +1200
Subject: [antlr-interest] [antlr3c] Posible bug i C runtime generated
 code (ANTLR v3.1.3 and libantlr3c 3.1.3)
In-Reply-To: <8129e4430908030138u6de848k98b7eff5ea8c32af@mail.gmail.com>
References: <8129e4430908030138u6de848k98b7eff5ea8c32af@mail.gmail.com>
Message-ID: <20090803111911.0390E3418419@www.antlr.org>

At 20:38 3/08/2009, Adamic Tomislav wrote:
 >Using two grammars below, ANTLR generates code that is not
 >compilable with either C or C++ compiler. Specifically,
 >generated file "ExampleGrammarEval.c" contains expression
 >"MyStruct value = NULL;" which is not valid C/C++ (because
 >value is not pointer) so the code doesn't compile.
[...]
 >prog returns [MyStruct value]
 >    : expr { $value = $expr.value; };

These constructs are currently not legal in the C 
target.  Parameters and return values must either be primitive 
types or pointers.


From jimi at temporal-wave.com  Mon Aug  3 09:49:26 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 03 Aug 2009 09:49:26 -0700
Subject: [antlr-interest] [antlr3c] Need help working with
	ANTLR3_STRING...
In-Reply-To: <8129e4430908030039n50a6f35fma582682f3bcb47a8@mail.gmail.com>
References: <8129e4430908030039n50a6f35fma582682f3bcb47a8@mail.gmail.com>
Message-ID: <4A771516.9000704@temporal-wave.com>

Adamic Tomislav wrote:
> Hi
>
> I'm a bit puzzled with ANTLR API for ANTLR3_STRING... I need few
> operations on strings and I could do it either by converting
> ANTLR3_STRING into std::string (or std::wstring) or do it directly.
> Well, I can't figure out either. So, let's say I want to create a copy
> of some already existing ANTLR3_STRING. Is this the proper way of
> doing it, so it doesn't leak memory:
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>   
These are just convenience methods for C programmers. If you are happy 
with the C++ libraries available to you, then just use the pointer and 
length fields (actually I think it is start and stop) fields to work 
with the string directly. The ANTLR3_STRING stuff will auto track memory 
usage and so on, but if you perform lots of string references then it 
can be a memory hog because it does not release anything until the 
parser is freed.

Get a token reference:  mytok=TOKEN

Then create a factory method or a function or whatever that takes a 
token pointer and creates your C++ string. Do not use the $text 
references as these will create ANTLR3_STRING that you don't need.

Jim

From jimi at temporal-wave.com  Mon Aug  3 09:51:44 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 03 Aug 2009 09:51:44 -0700
Subject: [antlr-interest] [antlr3c] Posible bug i C runtime generated
 code	(ANTLR v3.1.3 and libantlr3c 3.1.3)
In-Reply-To: <8129e4430908030138u6de848k98b7eff5ea8c32af@mail.gmail.com>
References: <8129e4430908030138u6de848k98b7eff5ea8c32af@mail.gmail.com>
Message-ID: <4A7715A0.6050807@temporal-wave.com>

Adamic Tomislav wrote:
> Hi
>
> Using two grammars below, ANTLR generates code that is not compilable
> with either C or C++ compiler. Specifically, generated file
> "ExampleGrammarEval.c" contains expression "MyStruct value = NULL;"
>   
Please see many prior answers to this one. You must use pointers and not 
structs.

Jim

From tommy.nordgren at comhem.se  Mon Aug  3 11:29:51 2009
From: tommy.nordgren at comhem.se (Tommy Nordgren)
Date: Mon, 3 Aug 2009 20:29:51 +0200
Subject: [antlr-interest] Reload an AST from serialized form.
Message-ID: <B0CCED0C-C389-4815-AE04-E5830A1ACA0B@comhem.se>

I have written the following small antlr grammar, to unserialize an  
AST from the output generated by the toStringTree() method.
I'm sending it to the list, since I think it would be useful for many  
antlr users.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: SymTabLoader.g
Type: application/octet-stream
Size: 436 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090803/252807ed/attachment.obj 
-------------- next part --------------


parser grammar SymTabLoader;
/* Unserializes an AST serialized with toStringTree - uses the input  
lexer symbols used to create the
ast initially. Note: EVEN abstract tokens need to have a lexical  
representation for this to work.*/
options {
	tokenVocab = InputSyntax;
	output = AST;
}

program : module ;

module : '(' firstSymb subTree* ')' -> ^(firstSymb subTree*) ;

firstSymb :
  	~( '(' | ')' )
	;

subTree : firstSymb
	| module
	;

---------------------------------
How many National Democrats does it take to change a light bulb?
108: 8 who smashes the rest of the light bulbs, and 100 to blame a  
zionist world conspiracy for the darkness
--------------------------
Tommy Nordgren
tommy.nordgren at comhem.se




From caishaoting at gmail.com  Mon Aug  3 13:46:48 2009
From: caishaoting at gmail.com (Shaoting Cai)
Date: Mon, 3 Aug 2009 13:46:48 -0700
Subject: [antlr-interest] Question about the antlrv3.g
Message-ID: <9b1ada6d0908031346k37963be1q35b0620a948f4499@mail.gmail.com>

Hello,

In the latest ANTLRv3.g (
http://fisheye2.atlassian.com/browse/antlr/tool/src/main/antlr3/org/antlr/grammar/v3/ANTLRv3.g?r=5943#l185
)
...
184        ruleScopeSpec
185             :       'scope' ACTION -> ^('scope' ACTION)
186             |       'scope' id (',' id)* ';' -> ^('scope' id+)
187             |       'scope' ACTION
188                     'scope' id (',' id)* ';'
189                     -> ^('scope' ACTION id+ )
190             ;
...

It seems to me that the alternatives are duplicated.  Or is there any
purpose that they are here?

Thanks,
Shaoting
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090803/81df39d7/attachment.html 

From marwan.alephn at gmail.com  Mon Aug  3 13:47:14 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Mon, 3 Aug 2009 22:47:14 +0200
Subject: [antlr-interest] How to extend the CommonTree without getting a
	classcastexcpetion in the generated code?
Message-ID: <6535fcb50908031347v2ebff33bsa4e2bc9562930daa@mail.gmail.com>

Hi there;

I did define a customized node, extending a commonTree, defined an
adaptor extending a  CommonTreeAdaptor, for my semantic analysis.
Nevertheless, I'm getting a classCastException, when the parser find
the first sintax error.

The reason is that it can not cast CommonErrorNode to my customized
node, since both extend CommonTree.

I'm interested on reporting all parser errores no just the first one.
What is the better aproach, dealing with this expcetion so it doesn't
stop the execution?

Thx in advance for any help,

Cheers

-- 
Marouane

From parrt at cs.usfca.edu  Mon Aug  3 13:50:42 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 3 Aug 2009 13:50:42 -0700
Subject: [antlr-interest] Question about the antlrv3.g
In-Reply-To: <9b1ada6d0908031346k37963be1q35b0620a948f4499@mail.gmail.com>
References: <9b1ada6d0908031346k37963be1q35b0620a948f4499@mail.gmail.com>
Message-ID: <DEFA2504-687F-47E2-B04A-96E9C13AF6E6@cs.usfca.edu>

hi Shaoting, which alternatives? remember | means alternative not  
newline.
T
On Aug 3, 2009, at 1:46 PM, Shaoting Cai wrote:

> Hello,
>
> In the latest ANTLRv3.g (http://fisheye2.atlassian.com/browse/antlr/tool/src/main/antlr3/org/antlr/grammar/v3/ANTLRv3.g?r=5943#l185 
> )
> ...
> 184        ruleScopeSpec
> 185             :       'scope' ACTION -> ^('scope' ACTION)
> 186             |       'scope' id (',' id)* ';' -> ^('scope' id+)
> 187             |       'scope' ACTION
> 188                     'scope' id (',' id)* ';'
> 189                     -> ^('scope' ACTION id+ )
> 190             ;
> ...
>
> It seems to me that the alternatives are duplicated.  Or is there  
> any purpose that they are here?
>
> Thanks,
> Shaoting
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From caishaoting at gmail.com  Mon Aug  3 13:51:37 2009
From: caishaoting at gmail.com (Shaoting Cai)
Date: Mon, 3 Aug 2009 13:51:37 -0700
Subject: [antlr-interest] Question about the antlrv3.g
In-Reply-To: <DEFA2504-687F-47E2-B04A-96E9C13AF6E6@cs.usfca.edu>
References: <9b1ada6d0908031346k37963be1q35b0620a948f4499@mail.gmail.com>
	<DEFA2504-687F-47E2-B04A-96E9C13AF6E6@cs.usfca.edu>
Message-ID: <9b1ada6d0908031351j7dc71a05h339ba4ab909b3904@mail.gmail.com>

Omg~~~
Being dumb today.

Thanks Terence!

On Mon, Aug 3, 2009 at 1:50 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> hi Shaoting, which alternatives? remember | means alternative not newline.
> T
>
> On Aug 3, 2009, at 1:46 PM, Shaoting Cai wrote:
>
>  Hello,
>>
>> In the latest ANTLRv3.g (
>> http://fisheye2.atlassian.com/browse/antlr/tool/src/main/antlr3/org/antlr/grammar/v3/ANTLRv3.g?r=5943#l185
>> )
>> ...
>> 184        ruleScopeSpec
>> 185             :       'scope' ACTION -> ^('scope' ACTION)
>> 186             |       'scope' id (',' id)* ';' -> ^('scope' id+)
>> 187             |       'scope' ACTION
>> 188                     'scope' id (',' id)* ';'
>> 189                     -> ^('scope' ACTION id+ )
>> 190             ;
>> ...
>>
>> It seems to me that the alternatives are duplicated.  Or is there any
>> purpose that they are here?
>>
>> Thanks,
>> Shaoting
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090803/abfa02b9/attachment.html 

From antlr at mirality.co.nz  Mon Aug  3 13:59:50 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 04 Aug 2009 08:59:50 +1200
Subject: [antlr-interest] Question about the antlrv3.g
In-Reply-To: <9b1ada6d0908031346k37963be1q35b0620a948f4499@mail.gmail.co
 m>
References: <9b1ada6d0908031346k37963be1q35b0620a948f4499@mail.gmail.com>
Message-ID: <20090803210006.6DFC7341844A@www.antlr.org>

At 08:46 4/08/2009, Shaoting Cai wrote:
>Hello,
>
>In the latest ANTLRv3.g 
>(<http://fisheye2.atlassian.com/browse/antlr/tool/src/main/antlr3/org/antlr/grammar/v3/ANTLRv3.g?r=5943#l185>http://fisheye2.atlassian.com/browse/antlr/tool/src/main/antlr3/org/antlr/grammar/v3/ANTLRv3.g?r=5943#l185)
>...
>184     ruleScopeSpec
>185         :    'scope' ACTION -> ^('scope' ACTION)
>186         |    'scope' id (',' id)* ';' -> ^('scope' id+)
>187         |    'scope' ACTION
>188              'scope' id (',' id)* ';'
>189              -> ^('scope' ACTION id+ )
>190         ;
>...
>
>It seems to me that the alternatives are duplicated.  Or is there 
>any purpose that they are here?

They're not duplicated, just poorly indented.  Alt 3 is basically 
Alt 1 + Alt 2, but produces a different AST.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090804/c5c58843/attachment.html 

From marwan.alephn at gmail.com  Mon Aug  3 15:59:37 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Tue, 4 Aug 2009 00:59:37 +0200
Subject: [antlr-interest] How to extend the CommonTree without getting a
	classcastexcpetion in the generated code?
In-Reply-To: <6535fcb50908031347v2ebff33bsa4e2bc9562930daa@mail.gmail.com>
References: <6535fcb50908031347v2ebff33bsa4e2bc9562930daa@mail.gmail.com>
Message-ID: <6535fcb50908031559g201a41b6o5fc1a1091125d223@mail.gmail.com>

I think that altering code generation so catch-clauses get replace
with the action specified is the best aproach in my case:

@rulecatch {
catch (RecognitionException e) {
    ...
    throw e;
}
}

Cheers,


Marouane


2009/8/3 Marwan Ajraoui <marwan.alephn at gmail.com>:
> Hi there;
>
> I did define a customized node, extending a commonTree, defined an
> adaptor extending a ?CommonTreeAdaptor, for my semantic analysis.
> Nevertheless, I'm getting a classCastException, when the parser find
> the first sintax error.
>
> The reason is that it can not cast CommonErrorNode to my customized
> node, since both extend CommonTree.
>
> I'm interested on reporting all parser errores no just the first one.
> What is the better aproach, dealing with this expcetion so it doesn't
> stop the execution?
>
> Thx in advance for any help,
>
> Cheers
>
> --
> Marouane
>



-- 
Marouane

From sharwell at pixelminegames.com  Mon Aug  3 16:28:41 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Mon, 3 Aug 2009 18:28:41 -0500
Subject: [antlr-interest] How to extend the CommonTree without getting
	aclasscastexcpetion in the generated code?
In-Reply-To: <6535fcb50908031347v2ebff33bsa4e2bc9562930daa@mail.gmail.com>
References: <6535fcb50908031347v2ebff33bsa4e2bc9562930daa@mail.gmail.com>
Message-ID: <86403CA0939415448BCCB83855EFE09AA684A7@Bloodymary.ironwillgames.com>

1. Derive a class CustomizedErrorNode from your class CustomizedNode.

2. Derive a class CustomizedTreeAdaptor from CommonTreeAdaptor. In it,
override create(Token) to return a CustomizedNode, and override
errorNode(TokenStream,Token,Token,RecognitionException) to return a
CustomizedErrorNode.

Set your parser to use this tree adaptor instead of the default one.

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Marwan Ajraoui
Sent: Monday, August 03, 2009 3:47 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to extend the CommonTree without getting
aclasscastexcpetion in the generated code?

Hi there;

I did define a customized node, extending a commonTree, defined an
adaptor extending a  CommonTreeAdaptor, for my semantic analysis.
Nevertheless, I'm getting a classCastException, when the parser find
the first sintax error.

The reason is that it can not cast CommonErrorNode to my customized
node, since both extend CommonTree.

I'm interested on reporting all parser errores no just the first one.
What is the better aproach, dealing with this expcetion so it doesn't
stop the execution?

Thx in advance for any help,

Cheers

-- 
Marouane

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From david-sarah at jacaranda.org  Mon Aug  3 17:13:32 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 04 Aug 2009 01:13:32 +0100
Subject: [antlr-interest] Extending a CommonTree
In-Reply-To: <6535fcb50908030346p4039aa50l65f05513d7863096@mail.gmail.com>
References: <6535fcb50908030346p4039aa50l65f05513d7863096@mail.gmail.com>
Message-ID: <4A777D2C.4000109@jacaranda.org>

Marwan Ajraoui wrote:
> Hi there;
> 
> I did define a customized node, extending a commonTree, defined an
> adaptor extending a  CommonTreeAdaptor, for my semantic analysis.
> Nevertheless, I'm getting a classCastException, when the parser find
> the first sintax error.
> 
> The reason is that it can not cast CommonErrorNode to my customized
> node, since both extend CommonTree.
> 
> I'm interested on reporting all parser errores no just the first one.
> What is the better aproach, dealing with this expcetion so it doesn't
> stop the execution?

Override the errorNode method in your custom TreeAdaptor to return an
instance of your node class.

<http://www.antlr.org/api/Java/classorg_1_1antlr_1_1runtime_1_1tree_1_1_base_tree_adaptor.html#6794aa45ca9774822f1be82a3856e8f8>

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Mon Aug  3 17:31:16 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 04 Aug 2009 01:31:16 +0100
Subject: [antlr-interest] How to debug grammars on Vista
In-Reply-To: <682E5600EAB043FA97ABD71A11E003C2@sunaoPC>
References: <9D23A17EC9A3439CA9EE77B75281E2A8@sunaoPC>	<4A64BC14.9030409@jacaranda.org>
	<682E5600EAB043FA97ABD71A11E003C2@sunaoPC>
Message-ID: <4A778154.6090409@jacaranda.org>

sunao furukawa wrote:
> Hello! Everybody.
> some days ago,I got a reply from this mailinglist(David-Sarah Hopwood).
> ANTLRWorks generated(debug menu->debug) __Test__.java,
> debugging(debug menu->debug remote) T1.g is successful.
> But,TestE.java doesn't get a port(DEBUGGER_PORT 48000),
> so debug remote(debug menu->debug remote) doesn't work.
> I use antlrworks-1.2.3 on Windows Vista Home Basic sp1.
> Why cannot I debug remote TestE.java ?
> Please tell me the reason that I can debug __Test__.java but I cannot debug 
> TestE.java !

This is very likely because the 'default local port' set in the ANTLRWorks
preferences (File menu | Preferences | Debugger tab) is not the same as
DEBUGGER_PORT in TestE.java. They must both be the same unused port.

If this theory is correct, the reason why __Test__.java works is that
it automatically passes in the same port that is configured in the ANTLR
preferences at the time the code is generated. Therefore, you should change
DEBUGGER_PORT to the one in the preferences, rather than the other way
around.

If the ports are already the same, then the problem may be that TestE isn't
running (you have to run it manually; sorry if this is stating the obvious),
or for some reason hasn't reached the point in the code where it listens,
which is called from the parser constructor.

If all else fails, download a port monitor (e.g.
<http://www.nirsoft.net/utils/cports.html> -- although that is just the
first one I found using Google, and I cannot vouch for it) and check that
there is an instance of java.exe listening on the 'default local port'
before you select 'Debug Remote...'.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Mon Aug  3 19:17:29 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 04 Aug 2009 03:17:29 +0100
Subject: [antlr-interest] How to debug grammars on Vista
In-Reply-To: <4A778154.6090409@jacaranda.org>
References: <9D23A17EC9A3439CA9EE77B75281E2A8@sunaoPC>	<4A64BC14.9030409@jacaranda.org>
	<682E5600EAB043FA97ABD71A11E003C2@sunaoPC>
	<4A778154.6090409@jacaranda.org>
Message-ID: <4A779A39.80901@jacaranda.org>

David-Sarah Hopwood wrote:
> If all else fails, download a port monitor (e.g.
> <http://www.nirsoft.net/utils/cports.html> -- although that is just the
> first one I found using Google, and I cannot vouch for it)

Actually, TCPView may be better for this:
<http://www.rarst.net/software/app-worthy-to-watch-your-connections-tcpview-vs-currports/>

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From michael.bedward at gmail.com  Mon Aug  3 19:33:54 2009
From: michael.bedward at gmail.com (Michael Bedward)
Date: Tue, 4 Aug 2009 12:33:54 +1000
Subject: [antlr-interest] Reload an AST from serialized form.
In-Reply-To: <B0CCED0C-C389-4815-AE04-E5830A1ACA0B@comhem.se>
References: <B0CCED0C-C389-4815-AE04-E5830A1ACA0B@comhem.se>
Message-ID: <e24c4c270908031933h34d6c7ey5ef6f23c5edbdeed@mail.gmail.com>

Thanks Tommy, this is a very good idea.

Michael

From aravinda777 at gmail.com  Mon Aug  3 21:40:33 2009
From: aravinda777 at gmail.com (Aravinda Dassanayake)
Date: Tue, 4 Aug 2009 10:10:33 +0530
Subject: [antlr-interest] C# 3 grammar needed
Message-ID: <c1960e000908032140x2a560456i6a7c7c19d1c78868@mail.gmail.com>

Hi everybody,

I am looking for a C# 3.0 ANTLR grammar. Is one available out there?

Regards,
Aravinda


-- 
Voice - +94(0)715320257
IM      - aravinda777
Blog   - http://aravindad.blogspot.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090804/8ea1d88f/attachment.html 

From weeliyen at hotmail.com  Tue Aug  4 01:38:30 2009
From: weeliyen at hotmail.com (Wee Li Yen)
Date: Tue, 4 Aug 2009 16:38:30 +0800
Subject: [antlr-interest] C# 3 grammar needed
In-Reply-To: <c1960e000908032140x2a560456i6a7c7c19d1c78868@mail.gmail.com>
References: <c1960e000908032140x2a560456i6a7c7c19d1c78868@mail.gmail.com>
Message-ID: <BAY114-DS6588B92E773134265DFABCF0C0@phx.gbl>

Hi,

I am also looking for C# ANTLR grammar. Being new to ANTLR, I just joined this mailing list last night.

There is sth in the download section (http://www.antlr.org/download.html) "ANTLR v3 sample grammars (C, C#, Java, ActionScript, and Python targets)":
The subfolders are the language they write the grammar in, not the grammar for the language.
And they have included a lot of language grammars but missed out C#. 

Where can I find C# grammar?

Regards,
Yeeen




From: Aravinda Dassanayake 
Sent: Tuesday, August 04, 2009 12:40 PM
To: antlr-interest at antlr.org 
Subject: [antlr-interest] C# 3 grammar needed


Hi everybody,

I am looking for a C# 3.0 ANTLR grammar. Is one available out there?

Regards,
Aravinda


-- 
Voice - +94(0)715320257    
IM      - aravinda777
Blog   - http://aravindad.blogspot.com





--------------------------------------------------------------------------------



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090804/a9f6123b/attachment.html 

From asalh at mindspring.com  Tue Aug  4 01:41:53 2009
From: asalh at mindspring.com (Bryan S Follins)
Date: Tue, 4 Aug 2009 01:41:53 -0700
Subject: [antlr-interest] Hashmaps
In-Reply-To: <6535fcb50908030038u7a393f50u2c4fbe2a009f8fb2@mail.gmail.com>
References: <6535fcb50908030038u7a393f50u2c4fbe2a009f8fb2@mail.gmail.com>
Message-ID: <005801ca14df$6af40540$40dc0fc0$@com>

Would someone mind giving me a quick definition of a hashmap as it relates
to Antlr?

Also, what is an example of a function of a hashmap?  Thanks.


From nvlassopoulos at gmail.com  Tue Aug  4 02:23:12 2009
From: nvlassopoulos at gmail.com (Nick Vlassopoulos)
Date: Tue, 4 Aug 2009 10:23:12 +0100
Subject: [antlr-interest] Hashmaps
In-Reply-To: <005801ca14df$6af40540$40dc0fc0$@com>
References: <6535fcb50908030038u7a393f50u2c4fbe2a009f8fb2@mail.gmail.com>
	<005801ca14df$6af40540$40dc0fc0$@com>
Message-ID: <1419225d0908040223l1c2a475er48ce1163e84e0ed0@mail.gmail.com>

Hi Bryan,

I am assuming that you are reffering to the Java HashMap.

A "Map" is a data structure associating two sets. Think of it as a math
function
(http://en.wikipedia.org/wiki/Map_(mathematics)) where you map an element
from a set A to a set B (such that
each x\in A has only one image for maps - MultiMap allows for multiple
images)

The "Hash" part refers to how the specific implementation of the Java Map
interface handles the
key - value associations (http://en.wikipedia.org/wiki/Hash_function)

Regarding the "how it relates to Antrl" part, well, most probably you are
referring to symbol tables
(http://en.wikipedia.org/wiki/Symbol_table), as I would guess that is one of
the most common uses.
Other than that, there's no antlr specific relation, you can use a map
whenever you need to associate
2 sets.

Hope these helped,

Nikos


On Tue, Aug 4, 2009 at 9:41 AM, Bryan S Follins <asalh at mindspring.com>wrote:

> Would someone mind giving me a quick definition of a hashmap as it relates
> to Antlr?
>
> Also, what is an example of a function of a hashmap?  Thanks.
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090804/2a884a64/attachment.html 

From tbee at tbee.org  Tue Aug  4 05:52:40 2009
From: tbee at tbee.org (Tom)
Date: Tue, 04 Aug 2009 14:52:40 +0200
Subject: [antlr-interest] 'match not' not working
Message-ID: <4A782F18.1080001@tbee.org>

I have a pretty simply grammar to construct; it must find balanced 
tokens in a stream. For example:
    aaa %{ bbb }% ccc

These may be nested:
    aaa %{ aaa %{ bbb }% ccc }% ccc

or not present at all:
    aaa

or consequtive:
    aaa %{ bbb }% ccc %{ bbb }% ccc

So all a need to do is find the tokens with non-tokens in between. This 
is the grammar I expected that would do that:

/*------------------------------------------------------------------
 * PARSER RULES
 *------------------------------------------------------------------*/
      
parse: loop;

loop: noloop LOOPSTART loop LOOPEND loop
    | noloop
    ;
   
noloop: (~( LOOPSTART | LOOPEND ))*
      ;

/*------------------------------------------------------------------
 * LEXER RULES
 *------------------------------------------------------------------*/

LOOPSTART: '%{';
LOOPEND: '}%';



However, the "match not" is not working.

"X" results in
    line 1:0 no viable alternative at character 'X'

"%{X}%" results in
    line 1:2 no viable alternative at character 'X'


If I replace the match-not part with a dummy 'X'*, then the grammar 
works (or atleast the mentioned tests run through). There is very 
limited documentation on the "match not", does anyone have a suggestion 
for me?

Tom


NB: if this works I will introduce a third token; an %{ with an id in 
between, written like: %id$

From micha-1 at fantasymail.de  Tue Aug  4 06:08:39 2009
From: micha-1 at fantasymail.de (michael)
Date: Tue, 4 Aug 2009 15:08:39 +0200
Subject: [antlr-interest] 'match not' not working
In-Reply-To: <4A782F18.1080001@tbee.org>
References: <4A782F18.1080001@tbee.org>
Message-ID: <200908041508.40162.micha-1@fantasymail.de>

Am Dienstag, 4. August 2009 14:52:40 schrieb Tom:
> I have a pretty simply grammar to construct; it must find balanced
> tokens in a stream. For example:
>     aaa %{ bbb }% ccc
>
> These may be nested:
>     aaa %{ aaa %{ bbb }% ccc }% ccc
>
> or not present at all:
>     aaa
>
> or consequtive:
>     aaa %{ bbb }% ccc %{ bbb }% ccc
>
> So all a need to do is find the tokens with non-tokens in between. This
> is the grammar I expected that would do that:
>
> /*------------------------------------------------------------------
>  * PARSER RULES
>  *------------------------------------------------------------------*/
>
> noloop: (~( LOOPSTART | LOOPEND ))*
>       ;

this combination of scanner rules, negation and parser rule is not easy to get 
to work.

Have you tried to add a lexer rule:

NOLOOP: (~( LOOPSTART | LOOPEND ))*;

this should match all other characters, then use this token in your parser 
rules...

allthough Ihave not tried it...

cheers
 Michael


From obua at me.com  Tue Aug  4 06:20:46 2009
From: obua at me.com (Steven Obua)
Date: Tue, 04 Aug 2009 15:20:46 +0200
Subject: [antlr-interest] 'match not' not working
In-Reply-To: <200908041508.40162.micha-1@fantasymail.de>
References: <4A782F18.1080001@tbee.org>
	<200908041508.40162.micha-1@fantasymail.de>
Message-ID: <50B9EDBF-8B4D-4D3C-9B0D-3109F61DDF84@me.com>


On Aug 4, 2009, at 3:08 PM, michael wrote:

> Am Dienstag, 4. August 2009 14:52:40 schrieb Tom:
>> I have a pretty simply grammar to construct; it must find balanced
>> tokens in a stream. For example:
>>    aaa %{ bbb }% ccc
>>
>> These may be nested:
>>    aaa %{ aaa %{ bbb }% ccc }% ccc
>>
>> or not present at all:
>>    aaa
>>
>> or consequtive:
>>    aaa %{ bbb }% ccc %{ bbb }% ccc
>>
>> So all a need to do is find the tokens with non-tokens in between.  
>> This
>> is the grammar I expected that would do that:
>>
>> /*------------------------------------------------------------------
>> * PARSER RULES
>> *------------------------------------------------------------------*/
>>
>> noloop: (~( LOOPSTART | LOOPEND ))*
>>      ;
>
> this combination of scanner rules, negation and parser rule is not  
> easy to get
> to work.
>
> Have you tried to add a lexer rule:
>
> NOLOOP: (~( LOOPSTART | LOOPEND ))*;


This probably will not work, as LOOPSTART and LOOPEND consist of two  
characters, not only one.

For example, in "%{}%"  the first % will match NOLOOP, leaving an  
unbalanced string.

I had also problems with not, although I only used lexer rules (see my  
post Strange Lexing behavior).

Cheers,

Steven


>
> this should match all other characters, then use this token in your  
> parser
> rules...
>
> allthough Ihave not tried it...
>
> cheers
> Michael
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From s.barnett-cormack at lancaster.ac.uk  Tue Aug  4 06:32:36 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Tue, 04 Aug 2009 14:32:36 +0100
Subject: [antlr-interest] Paranoia, paranoia...
Message-ID: <4A783874.1020808@lancaster.ac.uk>

Okay, I might just be being paranoid, but I wanted to sanity check 
something...

There's a rule "constraint" that matches LPAREN, a potentially unlimited 
number of other things (including nested constraints), then RPAREN. I 
wanted a rule that will match any number of these.

Any LPAREN after a constraint will be the start of another constraint.

So the rule I have is:

constraints : constraint ((LPAREN)=>constraint)* -> ^(CONSTRAINTS 
constraint+) ;

I believe this will match one or more constraints, and make a new 
subtree with each constraint a node under it (potentially being a 
subtree themselvs).

Does this do what I think it does?

NB: constraint+ doesn't work because it can't tell how far to look 
ahead. It has to finish matching one and then see if there's more.

-- 
Sam Barnett-Cormack

From safisce at gmail.com  Tue Aug  4 07:28:31 2009
From: safisce at gmail.com (Safiye Celik)
Date: Tue, 4 Aug 2009 17:28:31 +0300
Subject: [antlr-interest] Tree display
Message-ID: <bbf7e7d50908040728r659d5805ncc3d492d24b42797@mail.gmail.com>

Hi,
I am writing an ANTLR code in Java. I am using ANTLR version 3. I created my
tree, but how can I show the tree on the screen. On the internet, there are
lots of info about doing that job in ANTLR v2. They create an ASTFrame
object from created CommonAST tree and use ASTFrame's setVisible() function
to show it. But CommonTree is used in v3 instead of AST, so I cannot write
it in that way. So, what is the v3 correspondence of the ASTFrame usage??

Below is my CommonTree creation code.

String s = //assigned to an expression valid in my grammar;
MyLexer lexer = new MyLexer( new ANTLRStringStream(s) );
CommonTokenStream tokens = new CommonTokenStream(lexer);
MyParser.expression_return ret = parser.expression();
CommonTree exptree = ( CommonTree ) ret.tree;

What I need it how to show that "exptree" on the screen??

Thanks in advance.

--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090804/80ab6bd3/attachment.html 

From jimi at temporal-wave.com  Tue Aug  4 08:03:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 04 Aug 2009 08:03:59 -0700
Subject: [antlr-interest] C# 3 grammar needed
In-Reply-To: <c1960e000908032140x2a560456i6a7c7c19d1c78868@mail.gmail.com>
References: <c1960e000908032140x2a560456i6a7c7c19d1c78868@mail.gmail.com>
Message-ID: <4A784DDF.9090301@temporal-wave.com>

Aravinda Dassanayake wrote:
> Hi everybody,
>
> I am looking for a C# 3.0 ANTLR grammar. Is one available out there?
I sell one commercially (with tree grammar and pre-processing) - see it at:

http://www.temporal-wave.com  - select online demo link.

There are some skeletons for earlier versions of C# in the contributed 
grammars but they all have problems of various magnitudes I am afraid.

Jim

From jimi at temporal-wave.com  Tue Aug  4 08:14:13 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 04 Aug 2009 08:14:13 -0700
Subject: [antlr-interest] Tree display
In-Reply-To: <bbf7e7d50908040728r659d5805ncc3d492d24b42797@mail.gmail.com>
References: <bbf7e7d50908040728r659d5805ncc3d492d24b42797@mail.gmail.com>
Message-ID: <4A785045.2020208@temporal-wave.com>

Safiye Celik wrote:
> Hi,
> I am writing an ANTLR code in Java. I am using ANTLR version 3. I 
> created my tree, but how can I show the tree on the screen. On the 
> internet, there are lots of info about doing that job in ANTLR v2. 
> They create an ASTFrame object from created CommonAST tree and use 
> ASTFrame's setVisible() function to show it. But CommonTree is used in 
> v3 instead of AST, so I cannot write it in that way. So, what is the 
> v3 correspondence of the ASTFrame usage??
>
> Below is my CommonTree creation code.
>
> String s = //assigned to an expression valid in my grammar;
> MyLexer lexer = new MyLexer( new ANTLRStringStream(s) );
> CommonTokenStream tokens = new CommonTokenStream(lexer);
> MyParser.expression_return ret = parser.expression();
> CommonTree exptree = ( CommonTree ) ret.tree;
>
> What I need it how to show that "exptree" on the screen??
>
> Thanks in advance.
Search the list (see link to markmail in the support section of 
antlr.org) for my instructions on creating a .dot representiation of the 
AST then using the dot command to create a .png/.gif/.whatever. It is a 
few lines of code, reproduced in the email.

Jim



From Vandana.PATEL at 3ds.com  Tue Aug  4 09:36:15 2009
From: Vandana.PATEL at 3ds.com (PATEL Vandana)
Date: Tue, 4 Aug 2009 12:36:15 -0400
Subject: [antlr-interest] ECCN. License, & CCATS
Message-ID: <56ACDF559324B84E9D2F3CAA378284A6CAF2B0@CORP-CLT-EXB04.ds>

Hello, 

 

As a licensee of your 4 products---

1.       ANT 1.5.4,  

2.      ANTLR version 1.33 MR33, 

3.      Antlr 2.7.0, and 

4.      ANTLR PCCTS

 

we need to confirm its ECCN (Export Control Classification Number] to
assess the export requirement associated with it. We are especially
interested in assessing whether your product contains encryption
controlled under the United States EAR (Export Administration
Regulation). 

 

If you are not familiar with the EAR, you can find out more information
at http://www.bis.doc.gov/. Specific information concerning the export
classification of software containing encryption can be found in Parts
740.17, 742.15 and 774 Supp. 1 Category 5 part 2 (information security)
of Title 15 of the Code of Federal Regulations (
http://www.access.gpo.gov/bis/ear/ear_data.html). If your product has
been the subject of a classification review, please provide also the
CCATS number. In the case there is encryption in your product, please
confirm the key strength.

 

At last we also need to Confirm License requirements.  If it's
ENC/Unrestricted or NLR. Please provide ECCN & License Code. If you have
the exact website where we can look up this information will be even
more helpful in future. 

 

Thank you

 

 

 

Thank you

 

Best Regards,

________________________________

 

Vandana PATEL
Business Operations Team

514-940-2949
Vandana.PATEL at 3ds.com <mailto:Vandana.PATEL at 3ds.com> 

Visit us at: www.3ds.com <http://www.3ds.com/> 
Dassault Systemes Inc. - 393 St-Jacques West Suite 300 - MONTREAL, QC
H2Y 1N9, Canada 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090804/21249617/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 1447 bytes
Desc: image001.gif
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090804/21249617/attachment.gif 

From gerald at certiv.net  Tue Aug  4 09:49:59 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Tue, 04 Aug 2009 09:49:59 -0700
Subject: [antlr-interest] Tree display
In-Reply-To: <bbf7e7d50908040728r659d5805ncc3d492d24b42797@mail.gmail.co
 m>
References: <bbf7e7d50908040728r659d5805ncc3d492d24b42797@mail.gmail.com>
Message-ID: <200908041651.n74GpgTr008101@zinc.newtechlaw.com>

At 07:28 AM 8/4/2009, Safiye Celik wrote:
>Hi,
>I am writing an ANTLR code in Java. I am using ANTLR version 3. I 
>created my tree, but how can I show the tree on the screen. On the 
>internet, there are lots of info about doing that job in ANTLR v2. 
>They create an ASTFrame object from created CommonAST tree and use 
>ASTFrame's setVisible() function to show it. But CommonTree is used 
>in v3 instead of AST, so I cannot write it in that way. So, what is 
>the v3 correspondence of the ASTFrame usage??
>
>Below is my CommonTree creation code.
>
>String s = //assigned to an expression valid in my grammar;
>MyLexer lexer = new MyLexer( new ANTLRStringStream(s) );
>CommonTokenStream tokens = new CommonTokenStream(lexer);
>MyParser.expression_return ret = parser.expression();
>CommonTree exptree = ( CommonTree ) ret.tree;
>
>What I need it how to show that "exptree" on the screen??

If you are using Eclipse, AntlrDT provide views that will show the 
generated AST, the underlying token stream, and list of parsing/lexing errors.


From yotommy at gmail.com  Tue Aug  4 11:02:42 2009
From: yotommy at gmail.com (Tom Smith)
Date: Tue, 4 Aug 2009 14:02:42 -0400
Subject: [antlr-interest] problem with validating semantic predicate
	(related to backtracking)
Message-ID: <82dc0d190908041102n7c2fbfe4r892f353afcc9f07b@mail.gmail.com>

I have a rule (in a tree pattern matcher) that uses a validating
semantic predicate.  When the predicate returns false, I expected to
catch a FailedPredicateException and take some custom action.
However, the FailedPredicateException is not getting thrown.  Looking
at the generated code, the problem appears to be that the exception
only gets thrown conditionally (if state.backtracking==0).  For some
reason that is beyond my meager understanding, state.backtracking = 1
when the semantic predicate fails.

Any clues for me?

Thanks,
Tom Smith.

tree grammar Trans;

options {
	tokenVocab=SsipAST;
	output=AST;
	ASTLabelType=CommonTree;
	filter = true;
}
...
transition
scope {
    ...
}
@init {
    ...
}
	:	^(TRANSITION s1=stateName s2=stateName arcBody[$s1.text])
	{ checkTransition($s1.text, $s2.text) }?
	{ System.err.println("Transition from " + $s1.text + " to " +
$s2.text + " is OK"); }
	;
	catch [FailedPredicateException fpe] {
		String msg = String.format("In transition from \%s to \%s, liveness
is not consistent", $s1.text, $s2.text);
		throw new SemanticException(msg);
	}

From gerald at certiv.net  Tue Aug  4 11:40:15 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Tue, 04 Aug 2009 11:40:15 -0700
Subject: [antlr-interest] Tree display
In-Reply-To: <56ACDF559324B84E9D2F3CAA378284A6CAF2BB@CORP-CLT-EXB04.ds>
References: <bbf7e7d50908040728r659d5805ncc3d492d24b42797@mail.gmail.com>
	<200908041651.n74GpgTr008101@zinc.newtechlaw.com>
	<56ACDF559324B84E9D2F3CAA378284A6CAF2BB@CORP-CLT-EXB04.ds>
Message-ID: <200908041841.n74Ifgl2008922@zinc.newtechlaw.com>

Heh, you are on an email list.  What do you expect?

There are instructions on the bottom of every list email on how to unsubscribe.

At 09:57 AM 8/4/2009, PATEL Vandana wrote:

>Please don???t Copy my email again...
>
>
>Cordialement / Best regards,
>Vandana PATEL
>Business Operations Team
>Mobile:
>Vandana.PATEL at 3ds.com
>
>Visit us at: www.3ds.com
>Dassault Systemes Inc. - 393 St-Jacques West
>Suite 300 -  MONTREAL, QC H2Y 1N9,  Canada
>-----Original Message-----
>From: antlr-interest-bounces at antlr.org 
>[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Gerald Rosenberg
>Sent: Tuesday, August 04, 2009 12:50 PM
>To: Safiye Celik
>Cc: antlr-interest at antlr.org
>Subject: Re: [antlr-interest] Tree display
>
>At 07:28 AM 8/4/2009, Safiye Celik wrote:
> >Hi,
> >I am writing an ANTLR code in Java. I am using ANTLR version 3. I
> >created my tree, but how can I show the tree on the screen. On the
> >internet, there are lots of info about doing that job in ANTLR v2.
> >They create an ASTFrame object from created CommonAST tree and use
> >ASTFrame's setVisible() function to show it. But CommonTree is used
> >in v3 instead of AST, so I cannot write it in that way. So, what is
> >the v3 correspondence of the ASTFrame usage??
> >
> >Below is my CommonTree creation code.
> >
> >String s = //assigned to an expression valid in my grammar;
> >MyLexer lexer = new MyLexer( new ANTLRStringStream(s) );
> >CommonTokenStream tokens = new CommonTokenStream(lexer);
> >MyParser.expression_return ret = parser.expression();
> >CommonTree exptree = ( CommonTree ) ret.tree;
> >
> >What I need it how to show that "exptree" on the screen??
>
>If you are using Eclipse, AntlrDT provide views that will show the
>generated AST, the underlying token stream, and list of parsing/lexing errors.
>
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: 
>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From yotommy at gmail.com  Tue Aug  4 12:12:15 2009
From: yotommy at gmail.com (Tom Smith)
Date: Tue, 4 Aug 2009 15:12:15 -0400
Subject: [antlr-interest] problem with validating semantic predicate
	(related to backtracking)
In-Reply-To: <82dc0d190908041102n7c2fbfe4r892f353afcc9f07b@mail.gmail.com>
References: <82dc0d190908041102n7c2fbfe4r892f353afcc9f07b@mail.gmail.com>
Message-ID: <82dc0d190908041212o1591f549jcc663692c35de7fa@mail.gmail.com>

Forgot to mention: antlr-3.1.3

On Tue, Aug 4, 2009 at 2:02 PM, Tom Smith<yotommy at gmail.com> wrote:
> I have a rule (in a tree pattern matcher) that uses a validating
> semantic predicate. ?When the predicate returns false, I expected to
> catch a FailedPredicateException and take some custom action.
> However, the FailedPredicateException is not getting thrown. ?Looking
> at the generated code, the problem appears to be that the exception
> only gets thrown conditionally (if state.backtracking==0). ?For some
> reason that is beyond my meager understanding, state.backtracking = 1
> when the semantic predicate fails.
>
> Any clues for me?
>
> Thanks,
> Tom Smith.
>
> tree grammar Trans;
>
> options {
> ? ? ? ?tokenVocab=SsipAST;
> ? ? ? ?output=AST;
> ? ? ? ?ASTLabelType=CommonTree;
> ? ? ? ?filter = true;
> }
> ...
> transition
> scope {
> ? ?...
> }
> @init {
> ? ?...
> }
> ? ? ? ?: ? ? ? ^(TRANSITION s1=stateName s2=stateName arcBody[$s1.text])
> ? ? ? ?{ checkTransition($s1.text, $s2.text) }?
> ? ? ? ?{ System.err.println("Transition from " + $s1.text + " to " +
> $s2.text + " is OK"); }
> ? ? ? ?;
> ? ? ? ?catch [FailedPredicateException fpe] {
> ? ? ? ? ? ? ? ?String msg = String.format("In transition from \%s to \%s, liveness
> is not consistent", $s1.text, $s2.text);
> ? ? ? ? ? ? ? ?throw new SemanticException(msg);
> ? ? ? ?}
>

From david-sarah at jacaranda.org  Tue Aug  4 16:13:18 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Wed, 05 Aug 2009 00:13:18 +0100
Subject: [antlr-interest] 'match not' not working
In-Reply-To: <4A782F18.1080001@tbee.org>
References: <4A782F18.1080001@tbee.org>
Message-ID: <4A78C08E.8010108@jacaranda.org>

Tom wrote:
> I have a pretty simply grammar to construct; it must find balanced 
> tokens in a stream. For example:
>     aaa %{ bbb }% ccc
> 
> These may be nested:
>     aaa %{ aaa %{ bbb }% ccc }% ccc
> 
> or not present at all:
>     aaa
> 
> or consequtive:
>     aaa %{ bbb }% ccc %{ bbb }% ccc
> 
> So all a need to do is find the tokens with non-tokens in between. This 
> is the grammar I expected that would do that:
> 
> /*------------------------------------------------------------------
>  * PARSER RULES
>  *------------------------------------------------------------------*/
>       
> parse: loop;
> 
> loop: noloop LOOPSTART loop LOOPEND loop
>     | noloop
>     ;
>    
> noloop: (~( LOOPSTART | LOOPEND ))*
>       ;
> 
> /*------------------------------------------------------------------
>  * LEXER RULES
>  *------------------------------------------------------------------*/
> 
> LOOPSTART: '%{';
> LOOPEND: '}%';

The problem is that you have no tokens other than '%{' and '}%'.
What you want is for '%{' and '}%' to be treated like keywords, and
to add another lexer rule that will match anything else:

  // untested

  tokens {
    LOOPSTART = '%{';
    LOOPEND   = '}%';
  }

  // parse and loop as above

  noloop: OTHER*
        ;

  OTHER: .;

Note that OTHER is not ambiguous with LOOPSTART or LOOPEND because the
latter are declared in the tokens block.

> NB: if this works I will introduce a third token; an %{ with an id in 
> between, written like: %id$

  OTHER: ~'%';
  ID: '%' ('a'..'z')+ '\$';  // for example

This assumes that '%' followed by anything other than '{', or a valid
identifier then '$', should be a syntax error.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From sadie at kind.ocn.ne.jp  Tue Aug  4 20:04:55 2009
From: sadie at kind.ocn.ne.jp (sunao furukawa)
Date: Wed, 5 Aug 2009 12:04:55 +0900
Subject: [antlr-interest] How to debug grammars on Vista
In-Reply-To: <4A778154.6090409@jacaranda.org>
References: <9D23A17EC9A3439CA9EE77B75281E2A8@sunaoPC>	<4A64BC14.9030409@jacaranda.org><682E5600EAB043FA97ABD71A11E003C2@sunaoPC>
	<4A778154.6090409@jacaranda.org>
Message-ID: <1330FA03FF50408B843B94CF563D47EB@sunaoPC>

David-Sarah Hopwood wrote:
> This is very likely because the 'default local port' set in the ANTLRWorks
> preferences (File menu | Preferences | Debugger tab) is not the same as
> DEBUGGER_PORT in TestE.java. They must both be the same unused port.

 Some days ago,you give me the same advice.so I set preferences (File menu | 
Preferences | Debugger tab) default local port 48000.

> If the ports are already the same, then the problem may be that TestE 
> isn't
> running (you have to run it manually; sorry if this is stating the 
> obvious),
> or for some reason hasn't reached the point in the code where it listens,
> which is called from the parser constructor.

I executed command prompt "java TestE". But I didn't watch TCP 48000 by 
"netstat -an",.
I don't know why,but __Test__.java succeed.
Perhaps method "system.in" prevented me from getting a port 48000.
How did you get a port in Java and ANTLR?
Please teach me how to get a port, except __Test__.java. 



From gokul007 at gmail.com  Tue Aug  4 21:09:21 2009
From: gokul007 at gmail.com (Gokulakannan Somasundaram)
Date: Wed, 5 Aug 2009 09:39:21 +0530
Subject: [antlr-interest] simulating yyless in ANTLR
Message-ID: <9362e74e0908042109x777c6214m266a4ab2eb51a43c@mail.gmail.com>

Hi,
   Is it correct to simulate the yyless of FLEX by using PUSHSTREAM in
ANTLR? If we create a new stream for the characters to be re-introduced, and
switch to that stream, ANTLR automatically goes to the old stream once this
is exhausted.
    Is my approach correct?

Thanks,
Gokul.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/ac8ad183/attachment.html 

From sgoantlr at gmail.com  Wed Aug  5 01:16:40 2009
From: sgoantlr at gmail.com (Salvador Gomez)
Date: Wed, 5 Aug 2009 10:16:40 +0200
Subject: [antlr-interest] C# 3 grammar needed
In-Reply-To: <4A784DDF.9090301@temporal-wave.com>
References: <c1960e000908032140x2a560456i6a7c7c19d1c78868@mail.gmail.com>
	<4A784DDF.9090301@temporal-wave.com>
Message-ID: <2eefd630908050116j61953fd3o4b5e7a0bd459ea9d@mail.gmail.com>

Hi Jim,

have you think about opensource your C# and VB grammars? They could be
distributed under dual license (personal/opensource + commercial).

Open source .NET grammars would be a great contribution to antlr community.

Salva.


2009/8/4 Jim Idle <jimi at temporal-wave.com>

> Aravinda Dassanayake wrote:
> > Hi everybody,
> >
> > I am looking for a C# 3.0 ANTLR grammar. Is one available out there?
> I sell one commercially (with tree grammar and pre-processing) - see it at:
>
> http://www.temporal-wave.com  - select online demo link.
>
> There are some skeletons for earlier versions of C# in the contributed
> grammars but they all have problems of various magnitudes I am afraid.
>
> Jim
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/9feb45a5/attachment.html 

From safisce at gmail.com  Wed Aug  5 03:00:55 2009
From: safisce at gmail.com (Safiye Celik)
Date: Wed, 5 Aug 2009 13:00:55 +0300
Subject: [antlr-interest] class declaration in grammar file
Message-ID: <bbf7e7d50908050300p652fd146r4779c8b07919c1fd@mail.gmail.com>

Hi,
I am using ANTLR v3 with Java. What I want to ask is, when we should write
"class MyParser extends Parser;" statement at the beginning of the .g
grammar, and when we should write "grammar MyGrammar;" instead of that class
statement. I have MyGrammar.g as below:

grammar MyGrammar;
options {}
tokens{}
//and rules here

and when this grammar file is compiled, MyGrammarLexer.java and
MyGrammarParser.java files are automatically generated and I had no problem
till now. But I will add treewalker usage in my grammar file now, and in an
example in v2, "grammar xxx;" is not used and instead, class declaration is
used for xxxLexer, xxxParser and xxxTreeWalker. So, I try to do so, but I
get "unexpected token:class" and some other errors when I comment out
"grammar MyGrammar;" line and write "class MyParser extends Parser;"
instead.
What differs when I write "class MyParser extends Parser;" statement at the
beginning of the grammar? And how can I get rid of the errors I get when I
do so?
-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/8c0cef5c/attachment.html 

From safisce at gmail.com  Wed Aug  5 04:13:49 2009
From: safisce at gmail.com (Safiye Celik)
Date: Wed, 5 Aug 2009 14:13:49 +0300
Subject: [antlr-interest] class declaration in grammar file
In-Reply-To: <bbf7e7d50908050300p652fd146r4779c8b07919c1fd@mail.gmail.com>
References: <bbf7e7d50908050300p652fd146r4779c8b07919c1fd@mail.gmail.com>
Message-ID: <bbf7e7d50908050413t6c455917xab7c14663b63536@mail.gmail.com>

Ok, I got it. Thanks.

2009/8/5 Safiye Celik <safisce at gmail.com>

> Hi,
> I am using ANTLR v3 with Java. What I want to ask is, when we should write
> "class MyParser extends Parser;" statement at the beginning of the .g
> grammar, and when we should write "grammar MyGrammar;" instead of that class
> statement. I have MyGrammar.g as below:
>
> grammar MyGrammar;
> options {}
> tokens{}
> //and rules here
>
> and when this grammar file is compiled, MyGrammarLexer.java and
> MyGrammarParser.java files are automatically generated and I had no problem
> till now. But I will add treewalker usage in my grammar file now, and in an
> example in v2, "grammar xxx;" is not used and instead, class declaration is
> used for xxxLexer, xxxParser and xxxTreeWalker. So, I try to do so, but I
> get "unexpected token:class" and some other errors when I comment out
> "grammar MyGrammar;" line and write "class MyParser extends Parser;"
> instead.
> What differs when I write "class MyParser extends Parser;" statement at the
> beginning of the grammar? And how can I get rid of the errors I get when I
> do so?
> --
> -safiye
>



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/40b6fe3b/attachment.html 

From parrt at cs.usfca.edu  Wed Aug  5 12:25:33 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 5 Aug 2009 12:25:33 -0700
Subject: [antlr-interest] LLVM example: wiki or book?
In-Reply-To: <383056.53595.qm@web33304.mail.mud.yahoo.com>
References: <383056.53595.qm@web33304.mail.mud.yahoo.com>
Message-ID: <F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>

Hi Guys,

Ok, I'm rapidly running into my deadline for the book. by the end of  
the day I hope to finish the translation and then the generation  
chapters. you will see a beta of at least one of those chapters this  
week. That leaves the sort of " wrapping up" chapter, which doesn't  
really scream "Put a big LLVM example in".

To satisfy you folks, would be sufficient if I put it up on the wiki  
with some good but not perfect description as well as the full source  
code for my C subset to LLVM example?

Ter
On Jun 24, 2009, at 10:30 AM, J. Stephen Riley Silber wrote:

>
> I think Waverly's point wasn't the complexity of the grammar of the  
> language.  No one is arguing the simplicity of the Smalltalk  
> grammar.  His point was that compiling a simple imperative language  
> to LLVM will demonstrate the basics of LLVM IL generation.   
> "Everyone knows C", so it should make for a relatively simple  
> tutorial.
>
> I know nothing about LLVM besides what's on its project homepage,  
> but I am confident that a C subset example will allow me to ramp up  
> quickly to the point where I could implement "advanced" features  
> such as dynamic dispatch in short order.
>
> Ter, consider this a hearty seconding of Waverly's suggestion.  It's  
> a great idea.
>
> --- On Wed, 6/24/09, Damien Cassou <damien.cassou at gmail.com> wrote:
>
> From: Damien Cassou <damien.cassou at gmail.com>
> Subject: Re: [antlr-interest] ok, will build an LLVM example for book
> To: "Edwards, Waverly" <Waverly.Edwards at genesys.com>
> Cc: "antlr-interest at antlr.org ANTLR" <antlr-interest at antlr.org>
> Date: Wednesday, June 24, 2009, 9:47 AM
>
> On Wed, Jun 24, 2009 at 6:40 PM, Edwards,
> Waverly<Waverly.Edwards at genesys.com> wrote:
> > A Smalltalk or Java type language subset might be nice but overly  
> complex, possibly
> > loosing your reader.
>
> The entire Smalltalk language represents no more than 17 AST nodes. I
> don't consider that overly complex.
>
> -- 
> Damien Cassou
> http://damiencassou.seasidehosting.st
>
> "Lambdas are relegated to relative obscurity until Java makes them
> popular by not having them." James Iry
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From yotommy at gmail.com  Wed Aug  5 14:34:14 2009
From: yotommy at gmail.com (Tom Smith)
Date: Wed, 5 Aug 2009 17:34:14 -0400
Subject: [antlr-interest] revised subject: tree matcher problem with
	validating semantic predicate
Message-ID: <82dc0d190908051434i6709d5dfq184caccacab76d0e@mail.gmail.com>

I have narrowed down my problem.  The validating semantic predicate
properly throws a FailedPredicateException in a regular tree grammar,
but does not when filter=true.

I added the following TreeMatcher.g to the VecMath example from the
new book.  (I invoke this TreeMatcher before the Printer.)  Note that
the INT alternative has a validating semantic predicate that is
guaranteed to fail.  However when I run the program, no sign of the
FailedPredicateException.

Am I wrong to expect this?

Thanks,
Tom.

tree grammar TreeMatcher;

options {
	tokenVocab=VecMath;      // use token vocabulary from VecMath.g
	output = AST;
	ASTLabelType = CommonTree;
	filter = true;
}

topdown:	expr;

// START: expr
expr:   ^('+' expr expr)
    |   ^('*' expr expr)
    |   ^('.' expr expr)
    |   ^(VEC expr (expr)*)
    |   INT {false}?
    |   ID
    ;
// END: expr


On Tue, Aug 4, 2009 at 2:02 PM, Tom Smith<yotommy at gmail.com> wrote:
> I have a rule (in a tree pattern matcher) that uses a validating
> semantic predicate. ?When the predicate returns false, I expected to
> catch a FailedPredicateException and take some custom action.
> However, the FailedPredicateException is not getting thrown. ?Looking
> at the generated code, the problem appears to be that the exception
> only gets thrown conditionally (if state.backtracking==0). ?For some
> reason that is beyond my meager understanding, state.backtracking = 1
> when the semantic predicate fails.
>
> Any clues for me?
>
> Thanks,
> Tom Smith.
>
> tree grammar Trans;
>
> options {
> ? ? ? ?tokenVocab=SsipAST;
> ? ? ? ?output=AST;
> ? ? ? ?ASTLabelType=CommonTree;
> ? ? ? ?filter = true;
> }
> ...
> transition
> scope {
> ? ?...
> }
> @init {
> ? ?...
> }
> ? ? ? ?: ? ? ? ^(TRANSITION s1=stateName s2=stateName arcBody[$s1.text])
> ? ? ? ?{ checkTransition($s1.text, $s2.text) }?
> ? ? ? ?{ System.err.println("Transition from " + $s1.text + " to " +
> $s2.text + " is OK"); }
> ? ? ? ?;
> ? ? ? ?catch [FailedPredicateException fpe] {
> ? ? ? ? ? ? ? ?String msg = String.format("In transition from \%s to \%s, liveness
> is not consistent", $s1.text, $s2.text);
> ? ? ? ? ? ? ? ?throw new SemanticException(msg);
> ? ? ? ?}
>

From hugo.pcd at gmail.com  Wed Aug  5 14:38:55 2009
From: hugo.pcd at gmail.com (Hugo Picado)
Date: Wed, 5 Aug 2009 22:38:55 +0100
Subject: [antlr-interest] LLVM example: wiki or book?
In-Reply-To: <F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
References: <383056.53595.qm@web33304.mail.mud.yahoo.com>
	<F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
Message-ID: <3c2632090908051438j57d6e5e0jde4aae6e0d41738@mail.gmail.com>

Hi Terence,

You don't actually need to put a big example, as long as it is a good
example. Independently of the specific grammar, I think it should address
common issues such as parsing, tree walk, input/output parameters in rules,
lists, use of the most important predicates such as tokens, header, member,
etc.

Additionally, one think that I've seen that is commonly asked here is how to
implement unary minus, or how to construct tree nodes with different root
tokens, etc.

You can use a small example to show all this, I think a "too much big"
example will somewhere/sometime/somehow confuse the reader.

Back to the question, perhaps your C subset is a nice choice :)

Good luck with that.

Regards,
Hugo.

On Wed, Aug 5, 2009 at 8:25 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Hi Guys,
>
> Ok, I'm rapidly running into my deadline for the book. by the end of
> the day I hope to finish the translation and then the generation
> chapters. you will see a beta of at least one of those chapters this
> week. That leaves the sort of " wrapping up" chapter, which doesn't
> really scream "Put a big LLVM example in".
>
> To satisfy you folks, would be sufficient if I put it up on the wiki
> with some good but not perfect description as well as the full source
> code for my C subset to LLVM example?
>
> Ter
> On Jun 24, 2009, at 10:30 AM, J. Stephen Riley Silber wrote:
>
> >
> > I think Waverly's point wasn't the complexity of the grammar of the
> > language.  No one is arguing the simplicity of the Smalltalk
> > grammar.  His point was that compiling a simple imperative language
> > to LLVM will demonstrate the basics of LLVM IL generation.
> > "Everyone knows C", so it should make for a relatively simple
> > tutorial.
> >
> > I know nothing about LLVM besides what's on its project homepage,
> > but I am confident that a C subset example will allow me to ramp up
> > quickly to the point where I could implement "advanced" features
> > such as dynamic dispatch in short order.
> >
> > Ter, consider this a hearty seconding of Waverly's suggestion.  It's
> > a great idea.
> >
> > --- On Wed, 6/24/09, Damien Cassou <damien.cassou at gmail.com> wrote:
> >
> > From: Damien Cassou <damien.cassou at gmail.com>
> > Subject: Re: [antlr-interest] ok, will build an LLVM example for book
> > To: "Edwards, Waverly" <Waverly.Edwards at genesys.com>
> > Cc: "antlr-interest at antlr.org ANTLR" <antlr-interest at antlr.org>
> > Date: Wednesday, June 24, 2009, 9:47 AM
> >
> > On Wed, Jun 24, 2009 at 6:40 PM, Edwards,
> > Waverly<Waverly.Edwards at genesys.com> wrote:
> > > A Smalltalk or Java type language subset might be nice but overly
> > complex, possibly
> > > loosing your reader.
> >
> > The entire Smalltalk language represents no more than 17 AST nodes. I
> > don't consider that overly complex.
> >
> > --
> > Damien Cassou
> > http://damiencassou.seasidehosting.st
> >
> > "Lambdas are relegated to relative obscurity until Java makes them
> > popular by not having them." James Iry
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/b3594e05/attachment.html 

From parrt at cs.usfca.edu  Wed Aug  5 16:34:36 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 5 Aug 2009 16:34:36 -0700
Subject: [antlr-interest] LLVM example: wiki or book?
In-Reply-To: <3c2632090908051438j57d6e5e0jde4aae6e0d41738@mail.gmail.com>
References: <383056.53595.qm@web33304.mail.mud.yahoo.com>
	<F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
	<3c2632090908051438j57d6e5e0jde4aae6e0d41738@mail.gmail.com>
Message-ID: <6FF9E94E-BB92-4195-9346-88C97B96CD47@cs.usfca.edu>

Posting the grammar(s) for you to take a look at. do think this covers  
it? It seems like it covers a good deal. I will post the full source  
code after I take another pass over it and so on.
T
-------------- next part --------------
A non-text attachment was scrubbed...
Name: C.g
Type: application/octet-stream
Size: 3271 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/07e3245a/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: DefRef.g
Type: application/octet-stream
Size: 2773 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/07e3245a/attachment-0001.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Gen.g
Type: application/octet-stream
Size: 3824 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/07e3245a/attachment-0002.obj 
-------------- next part --------------

On Aug 5, 2009, at 2:38 PM, Hugo Picado wrote:

> Hi Terence,
>
> You don't actually need to put a big example, as long as it is a  
> good example. Independently of the specific grammar, I think it  
> should address common issues such as parsing, tree walk, input/ 
> output parameters in rules, lists, use of the most important  
> predicates such as tokens, header, member, etc.
>
> Additionally, one think that I've seen that is commonly asked here  
> is how to implement unary minus, or how to construct tree nodes with  
> different root tokens, etc.
>
> You can use a small example to show all this, I think a "too much  
> big" example will somewhere/sometime/somehow confuse the reader.
>
> Back to the question, perhaps your C subset is a nice choice :)
>
> Good luck with that.
>
> Regards,
> Hugo.
>
> On Wed, Aug 5, 2009 at 8:25 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> Hi Guys,
>
> Ok, I'm rapidly running into my deadline for the book. by the end of
> the day I hope to finish the translation and then the generation
> chapters. you will see a beta of at least one of those chapters this
> week. That leaves the sort of " wrapping up" chapter, which doesn't
> really scream "Put a big LLVM example in".
>
> To satisfy you folks, would be sufficient if I put it up on the wiki
> with some good but not perfect description as well as the full source
> code for my C subset to LLVM example?
>
> Ter
> On Jun 24, 2009, at 10:30 AM, J. Stephen Riley Silber wrote:
>
> >
> > I think Waverly's point wasn't the complexity of the grammar of the
> > language.  No one is arguing the simplicity of the Smalltalk
> > grammar.  His point was that compiling a simple imperative language
> > to LLVM will demonstrate the basics of LLVM IL generation.
> > "Everyone knows C", so it should make for a relatively simple
> > tutorial.
> >
> > I know nothing about LLVM besides what's on its project homepage,
> > but I am confident that a C subset example will allow me to ramp up
> > quickly to the point where I could implement "advanced" features
> > such as dynamic dispatch in short order.
> >
> > Ter, consider this a hearty seconding of Waverly's suggestion.  It's
> > a great idea.
> >
> > --- On Wed, 6/24/09, Damien Cassou <damien.cassou at gmail.com> wrote:
> >
> > From: Damien Cassou <damien.cassou at gmail.com>
> > Subject: Re: [antlr-interest] ok, will build an LLVM example for  
> book
> > To: "Edwards, Waverly" <Waverly.Edwards at genesys.com>
> > Cc: "antlr-interest at antlr.org ANTLR" <antlr-interest at antlr.org>
> > Date: Wednesday, June 24, 2009, 9:47 AM
> >
> > On Wed, Jun 24, 2009 at 6:40 PM, Edwards,
> > Waverly<Waverly.Edwards at genesys.com> wrote:
> > > A Smalltalk or Java type language subset might be nice but overly
> > complex, possibly
> > > loosing your reader.
> >
> > The entire Smalltalk language represents no more than 17 AST  
> nodes. I
> > don't consider that overly complex.
> >
> > --
> > Damien Cassou
> > http://damiencassou.seasidehosting.st
> >
> > "Lambdas are relegated to relative obscurity until Java makes them
> > popular by not having them." James Iry
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From gwlist at grahamwideman.com  Wed Aug  5 17:10:18 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Wed, 05 Aug 2009 17:10:18 -0700
Subject: [antlr-interest] Whitespace: More than meets the eye?
Message-ID: <4.1.20090805165514.02685e30@grahamwideman.com>

Hi folks:

Could someone clue me in to the zen of whitespace (or where this is discussed in The Books or online)?  By that I mean as follows: 

I see that grammars generally have a lexer rule that specifies the pattern for whitespace, but what's the correspondence between that and what ANTLR does with lexer rules, where the WHITESPACE token is generally not used.

I'm assuming that ANTLR makes assumptions that whitespace either may or must appear between tokens that appear in lexer rules, right?  Either that or it's picking up something from lexer rules that's subtler than I've noticed.

To pick a simple example, suppose you're defining what a function call should look like:

functionCall
    : Identifier LParen args RParen -> ....

... what variations does one need in order to assert that whitespace is, or is not, permitted or required between Identifier and LParen?

Thanks!

Graham

From lgcraymer at yahoo.com  Wed Aug  5 17:41:11 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Wed, 5 Aug 2009 17:41:11 -0700 (PDT)
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <4.1.20090805165514.02685e30@grahamwideman.com>
References: <4.1.20090805165514.02685e30@grahamwideman.com>
Message-ID: <977132.19106.qm@web55908.mail.re3.yahoo.com>

ANTLR makes no assumptions about whitespace; ANTLR lexers just slice up a stream (array) of characters into tokens according to a lexer grammar.  For most programming language grammars, whitespace can be ignored (and lexer grammars tend to put whitespace tokens on a "hidden" channel) since it basically serves to separate meaningful tokens.

If you want to require or forbid whitespace in parser rules, you either have to not ignore whitespace or insert semantic predicates to look for whitespace or its absence.  This gets messy fast, so modern languages avoid the old FORTRAN "interesting" lexical behavior, and you will not find much expertise in dealing with really outre lexer problems here--it is unusual to find a need to solve such problems.

--Loring



----- Original Message ----
> From: Graham Wideman <gwlist at grahamwideman.com>
> To: antlr-interest at antlr.org
> Sent: Wednesday, August 5, 2009 5:10:18 PM
> Subject: [antlr-interest] Whitespace: More than meets the eye?
> 
> Hi folks:
> 
> Could someone clue me in to the zen of whitespace (or where this is discussed in 
> The Books or online)?  By that I mean as follows: 
> 
> I see that grammars generally have a lexer rule that specifies the pattern for 
> whitespace, but what's the correspondence between that and what ANTLR does with 
> lexer rules, where the WHITESPACE token is generally not used.
> 
> I'm assuming that ANTLR makes assumptions that whitespace either may or must 
> appear between tokens that appear in lexer rules, right?  Either that or it's 
> picking up something from lexer rules that's subtler than I've noticed.
> 
> To pick a simple example, suppose you're defining what a function call should 
> look like:
> 
> functionCall
>     : Identifier LParen args RParen -> ....
> 
> ... what variations does one need in order to assert that whitespace is, or is 
> not, permitted or required between Identifier and LParen?
> 
> Thanks!
> 
> Graham
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From gwlist at grahamwideman.com  Wed Aug  5 19:00:07 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Wed, 05 Aug 2009 19:00:07 -0700
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <977132.19106.qm@web55908.mail.re3.yahoo.com>
References: <4.1.20090805165514.02685e30@grahamwideman.com>
	<4.1.20090805165514.02685e30@grahamwideman.com>
Message-ID: <4.1.20090805185842.05882f18@grahamwideman.com>

Hi Loring

Thanks for your comments. So when you say that "ANTLR makes no assumptions", I take that to mean ANTLR makes these assumptions:

a) whitespace is permitted between any tokens.

b) whitespace can be omitted between tokens so long as the beginning of the subsequent string doesn't make the end of the previous token anbiguous.

Is this correct?  

Further, is it correct to assume that the "WhiteSpace" lexer token name is special -- ie: recognized by ANTLR as the special pattern to be matched between tokens (and discarded by virtue of the hidden channel specifier)? (Except elsewhere I see "WS" used.)

Thanks,

Graham

At 8/5/2009 05:41 PM, Loring Craymer wrote:
>ANTLR makes no assumptions about whitespace; ANTLR lexers just slice up a 
>stream (array) of characters into tokens according to a lexer grammar.  For 
>most programming language grammars, whitespace can be ignored (and lexer 
>grammars tend to put whitespace tokens on a "hidden" channel) since it 
>basically serves to separate meaningful tokens.
>
>If you want to require or forbid whitespace in parser rules, you either have 
>to not ignore whitespace or insert semantic predicates to look for 
>whitespace or its absence.  This gets messy fast, so modern languages avoid 
>the old FORTRAN "interesting" lexical behavior, and you will not find much 
>expertise in dealing with really outre lexer problems here--it is unusual to 
>find a need to solve such problems.
>
>--Loring


From lgcraymer at yahoo.com  Wed Aug  5 19:12:17 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Wed, 5 Aug 2009 19:12:17 -0700 (PDT)
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <4.1.20090805185842.05882f18@grahamwideman.com>
References: <4.1.20090805165514.02685e30@grahamwideman.com>
	<4.1.20090805165514.02685e30@grahamwideman.com>
	<4.1.20090805185842.05882f18@grahamwideman.com>
Message-ID: <888150.60794.qm@web55903.mail.re3.yahoo.com>





----- Original Message ----
> From: Graham Wideman <gwlist at grahamwideman.com>
> To: antlr-interest at antlr.org
> Sent: Wednesday, August 5, 2009 7:00:07 PM
> Subject: Re: [antlr-interest] Whitespace: More than meets the eye?
> 
> Hi Loring
> 
> Thanks for your comments. So when you say that "ANTLR makes no assumptions", I 
> take that to mean ANTLR makes these assumptions:
> 
> a) whitespace is permitted between any tokens.
> 
> b) whitespace can be omitted between tokens so long as the beginning of the 
> subsequent string doesn't make the end of the previous token anbiguous.
> 
> Is this correct?  

No, I said what I meant.  The lexer grammar explicitly expresses those assumptions; ANTLR knows nothing about tokens except what it is told.  If you have defined the tokens "This", "is", "a", "token", in your lexer, then the resultant recognizer will interpret "Thisisatoken" as a sequence of four tokens.

There are no special lexer names.

--Loring

> 
> Further, is it correct to assume that the "WhiteSpace" lexer token name is 
> special -- ie: recognized by ANTLR as the special pattern to be matched between 
> tokens (and discarded by virtue of the hidden channel specifier)? (Except 
> elsewhere I see "WS" used.)
> 
> Thanks,
> 
> Graham
> 
> At 8/5/2009 05:41 PM, Loring Craymer wrote:
> >ANTLR makes no assumptions about whitespace; ANTLR lexers just slice up a 
> >stream (array) of characters into tokens according to a lexer grammar.  For 
> >most programming language grammars, whitespace can be ignored (and lexer 
> >grammars tend to put whitespace tokens on a "hidden" channel) since it 
> >basically serves to separate meaningful tokens.
> >
> >If you want to require or forbid whitespace in parser rules, you either have 
> >to not ignore whitespace or insert semantic predicates to look for 
> >whitespace or its absence.  This gets messy fast, so modern languages avoid 
> >the old FORTRAN "interesting" lexical behavior, and you will not find much 
> >expertise in dealing with really outre lexer problems here--it is unusual to 
> >find a need to solve such problems.
> >
> >--Loring
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address



      

From gerald at certiv.net  Wed Aug  5 19:38:55 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Wed, 05 Aug 2009 19:38:55 -0700
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <4.1.20090805185842.05882f18@grahamwideman.com>
References: <4.1.20090805165514.02685e30@grahamwideman.com>
	<4.1.20090805165514.02685e30@grahamwideman.com>
	<4.1.20090805185842.05882f18@grahamwideman.com>
Message-ID: <200908060239.n762dIOh021689@zinc.newtechlaw.com>

At 07:00 PM 8/5/2009, Graham Wideman wrote:
>Hi Loring
>
>Thanks for your comments. So when you say that "ANTLR makes no 
>assumptions", I take that to mean ANTLR makes these assumptions:

No assumptions means exactly that.  ANTLR itself has no concept of 
whitespace.  An input text is just a sequence of tokens and it 
entirely up to the lexer rules to group the tokens in some meaningful 
fashion.  ANTLR does have a concept of completely tossing (or hiding) 
tokens if, once recognized, they convey no further meaning in 
recognizing the input text.  That is, the only information they carry 
is that they separate other groups of tokens.

ANTLR allows any token to be skipped or hidden -- no presumption is 
made about the type or value.

So|if|your||input|text|was|||structured|in}some|strange|way.

The so-called white space rule could be:

BARS:  ( '|' | '}' | '.' ) {$channel=HIDDEN;} ;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/42b669b6/attachment.html 

From gwlist at grahamwideman.com  Wed Aug  5 20:38:45 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Wed, 05 Aug 2009 20:38:45 -0700
Subject: [antlr-interest] Whitespace: More than meets the eye?
Message-ID: <4.1.20090805203832.05a77a00@grahamwideman.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090805/3b18a970/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Wed Aug  5 22:59:39 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 06 Aug 2009 06:59:39 +0100
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <4.1.20090805203832.05a77a00@grahamwideman.com>
References: <4.1.20090805203832.05a77a00@grahamwideman.com>
Message-ID: <4A7A714B.7020406@lancaster.ac.uk>

Graham Wideman wrote:
> Ah-hah -- OK, time for slap on the forehead. (Mine! It must be the >100 
> degree weather here.)
> 
> Thanks for your answers. Yes, of COURSE it works as you say. Somehow, 
> after not really worrying about how the lexer works, my brain got stuck 
> thinking that lexer and parser work more analogously than they actually do.
> 
> Whereas at any juncture the parser only tries certain rules as predicted 
> by the grammar and the current state, the lexer effectively "tries all 
> its rules" every time it's starting to discern the next token.
> 
> So in that process, if the next characters match a rule that discards 
> the characters, (a la whitespace), then that pattern functions as an 
> optional separator.
> 
> And I also see that in order to do anything with whitespace at the 
> parser level, either whitespace has to not be discarded (in which case 
> many parser rules will have to deal with it) or custom code will need to 
> be included in the relevant rules to look at the hidden channel etc.

Don't forget that 'whitespace' is arbitrary - you could consider spaces 
to be whietspace, but not, say, tabs or newlines. I believe there are 
languages where this is the case - spaces are never significant, but 
some other types of whitespace are.

I'm curious as to why you want to sometimes consider whitespace, though. 
Is this a self-designed language, or a specification you're working from 
that makes whitespace 'sometimes' significant?

You example was a function call or declaration. You can always get help 
from the lexer here if there are situations where there *must* be a 
space, and situations where there *mustn't* be a space, and nothing 
else... have tokens that include the lparen.

-- 
Sam Barnett-Cormack

From sadie at kind.ocn.ne.jp  Wed Aug  5 23:51:53 2009
From: sadie at kind.ocn.ne.jp (sunao furukawa)
Date: Thu, 6 Aug 2009 15:51:53 +0900
Subject: [antlr-interest] Thank you very much!!! (Re: How to debug grammars
	on Vista)
In-Reply-To: <4A779A39.80901@jacaranda.org>
References: <9D23A17EC9A3439CA9EE77B75281E2A8@sunaoPC>	<4A64BC14.9030409@jacaranda.org><682E5600EAB043FA97ABD71A11E003C2@sunaoPC><4A778154.6090409@jacaranda.org>
	<4A779A39.80901@jacaranda.org>
Message-ID: <9470C9A0D7844D41A8A791452865A409@sunaoPC>

Hello Everybody!
I solved problem.
I come to a conclusion that,
    1.[java TestE]
    2.I inputted some expression from standard input
    3.I inputted [Ctrl-z]
    4.ANTLRWorks debug remote.
    5.connection is successful.

Sorry I didn't understand [Ctrl-z].

TCPView is good application.It is very useful.
Thack you very much for David-Sarah Hopwood ,and Everyone!!!


----- Original Message ----- 
From: "David-Sarah Hopwood" <david-sarah at jacaranda.org>
To: <antlr-interest at antlr.org>
Sent: Tuesday, August 04, 2009 11:17 AM
Subject: Re: [antlr-interest] How to debug grammars on Vista


> David-Sarah Hopwood wrote:
>> If all else fails, download a port monitor (e.g.
>> <http://www.nirsoft.net/utils/cports.html> -- although that is just the
>> first one I found using Google, and I cannot vouch for it)
>
> Actually, TCPView may be better for this:
> <http://www.rarst.net/software/app-worthy-to-watch-your-connections-tcpview-vs-currports/>
>
> -- 
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 



From hugo.pcd at gmail.com  Thu Aug  6 01:13:28 2009
From: hugo.pcd at gmail.com (Hugo Picado)
Date: Thu, 6 Aug 2009 09:13:28 +0100
Subject: [antlr-interest] LLVM example: wiki or book?
In-Reply-To: <6FF9E94E-BB92-4195-9346-88C97B96CD47@cs.usfca.edu>
References: <383056.53595.qm@web33304.mail.mud.yahoo.com>
	<F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
	<3c2632090908051438j57d6e5e0jde4aae6e0d41738@mail.gmail.com>
	<6FF9E94E-BB92-4195-9346-88C97B96CD47@cs.usfca.edu>
Message-ID: <3c2632090908060113k56256772v2a2871de7535e061@mail.gmail.com>

Hi,

I think it is a good "wrapping up" example. It seems to cover the most
important things.

Regards,
Hugo.

On Thu, Aug 6, 2009 at 12:34 AM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Posting the grammar(s) for you to take a look at. do think this covers it?
> It seems like it covers a good deal. I will post the full source code after
> I take another pass over it and so on.
> T
>
>
> On Aug 5, 2009, at 2:38 PM, Hugo Picado wrote:
>
>  Hi Terence,
>>
>> You don't actually need to put a big example, as long as it is a good
>> example. Independently of the specific grammar, I think it should address
>> common issues such as parsing, tree walk, input/output parameters in rules,
>> lists, use of the most important predicates such as tokens, header, member,
>> etc.
>>
>> Additionally, one think that I've seen that is commonly asked here is how
>> to implement unary minus, or how to construct tree nodes with different root
>> tokens, etc.
>>
>> You can use a small example to show all this, I think a "too much big"
>> example will somewhere/sometime/somehow confuse the reader.
>>
>> Back to the question, perhaps your C subset is a nice choice :)
>>
>> Good luck with that.
>>
>> Regards,
>> Hugo.
>>
>> On Wed, Aug 5, 2009 at 8:25 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>> Hi Guys,
>>
>> Ok, I'm rapidly running into my deadline for the book. by the end of
>> the day I hope to finish the translation and then the generation
>> chapters. you will see a beta of at least one of those chapters this
>> week. That leaves the sort of " wrapping up" chapter, which doesn't
>> really scream "Put a big LLVM example in".
>>
>> To satisfy you folks, would be sufficient if I put it up on the wiki
>> with some good but not perfect description as well as the full source
>> code for my C subset to LLVM example?
>>
>> Ter
>> On Jun 24, 2009, at 10:30 AM, J. Stephen Riley Silber wrote:
>>
>> >
>> > I think Waverly's point wasn't the complexity of the grammar of the
>> > language.  No one is arguing the simplicity of the Smalltalk
>> > grammar.  His point was that compiling a simple imperative language
>> > to LLVM will demonstrate the basics of LLVM IL generation.
>> > "Everyone knows C", so it should make for a relatively simple
>> > tutorial.
>> >
>> > I know nothing about LLVM besides what's on its project homepage,
>> > but I am confident that a C subset example will allow me to ramp up
>> > quickly to the point where I could implement "advanced" features
>> > such as dynamic dispatch in short order.
>> >
>> > Ter, consider this a hearty seconding of Waverly's suggestion.  It's
>> > a great idea.
>> >
>> > --- On Wed, 6/24/09, Damien Cassou <damien.cassou at gmail.com> wrote:
>> >
>> > From: Damien Cassou <damien.cassou at gmail.com>
>> > Subject: Re: [antlr-interest] ok, will build an LLVM example for book
>> > To: "Edwards, Waverly" <Waverly.Edwards at genesys.com>
>> > Cc: "antlr-interest at antlr.org ANTLR" <antlr-interest at antlr.org>
>> > Date: Wednesday, June 24, 2009, 9:47 AM
>> >
>> > On Wed, Jun 24, 2009 at 6:40 PM, Edwards,
>> > Waverly<Waverly.Edwards at genesys.com> wrote:
>> > > A Smalltalk or Java type language subset might be nice but overly
>> > complex, possibly
>> > > loosing your reader.
>> >
>> > The entire Smalltalk language represents no more than 17 AST nodes. I
>> > don't consider that overly complex.
>> >
>> > --
>> > Damien Cassou
>> > http://damiencassou.seasidehosting.st
>> >
>> > "Lambdas are relegated to relative obscurity until Java makes them
>> > popular by not having them." James Iry
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090806/b9cb985d/attachment.html 

From gwlist at grahamwideman.com  Thu Aug  6 01:52:06 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Thu, 06 Aug 2009 01:52:06 -0700
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <4A7A714B.7020406@lancaster.ac.uk>
References: <4.1.20090805203832.05a77a00@grahamwideman.com>
	<4.1.20090805203832.05a77a00@grahamwideman.com>
Message-ID: <4.1.20090806012709.05a7de28@grahamwideman.com>

Hi Sam,

Thanks for your comments. More below on your questions:

>I'm curious as to why you want to sometimes consider whitespace, though. 
>Is this a self-designed language, or a specification you're working from 
>that makes whitespace 'sometimes' significant?
>
>You example was a function call or declaration. You can always get help 
>from the lexer here if there are situations where there *must* be a 
>space, and situations where there *mustn't* be a space, and nothing 
>else... have tokens that include the lparen.

Yes, I am considering the least-messy way to tackle a few of these issues in PHP. (And the function example I gave was just a simple example, not a problem in PHP.)

One example that PHP has is the use of "$" as a prefix to identifiers, sometimes.

An ordinary variable:

    $myvar    = 'hello';
    $othervar = $myvar;

Everywhere that such a variable appears, the dollar prefix is required, and no space is allowed. Now it's tempting to write the grammar as:

variableName 
    : Dollar Identifier ...
...
Identifier
    : ('a'..'z' | 'A'..'Z' | '_')  ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')*

This Identifier rule is good for all named things in PHP, but the parser rule would allow whitespace between $ and Identifier, which is not accepted by the actual PHP parser.  

So, maybe it's better to stick the "$" at the beginning of the lexer rule for Identifier (call it DollarIdentifier or something).

But then you get to variables that are members of a class/object. 

    class C {
        var $mymember = 'Hello';
        ...
    }
    $c = new C();
    print $c->mymember;

Note how the declaration uses a $ prefix, but the usage does not (the only $ is on the object variable, not the id of the member variable).  But I'm somewhat loath to handle the $ sometimes in lexer rules, and sometimes in parser rules, as this seems apt to confuse later. (Maybe not... I haven't assessed how messy it gets going down this path.)

I do indeed see ways to lex/parse this more strictly, I'm just exploring for the least messy way.

-- Graham







From s.barnett-cormack at lancaster.ac.uk  Thu Aug  6 01:59:11 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 06 Aug 2009 09:59:11 +0100
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <4.1.20090806012709.05a7de28@grahamwideman.com>
References: <4.1.20090805203832.05a77a00@grahamwideman.com>	<4.1.20090805203832.05a77a00@grahamwideman.com>
	<4.1.20090806012709.05a7de28@grahamwideman.com>
Message-ID: <4A7A9B5F.5060705@lancaster.ac.uk>

Graham Wideman wrote:
> Hi Sam,
> 
> Thanks for your comments. More below on your questions:
> 
>> I'm curious as to why you want to sometimes consider whitespace, though. 
>> Is this a self-designed language, or a specification you're working from 
>> that makes whitespace 'sometimes' significant?
>>
>> You example was a function call or declaration. You can always get help 
>>from the lexer here if there are situations where there *must* be a 
>> space, and situations where there *mustn't* be a space, and nothing 
>> else... have tokens that include the lparen.
> 
> Yes, I am considering the least-messy way to tackle a few of these issues in PHP. (And the function example I gave was just a simple example, not a problem in PHP.)
> 
> One example that PHP has is the use of "$" as a prefix to identifiers, sometimes.
> 
> An ordinary variable:
> 
>     $myvar    = 'hello';
>     $othervar = $myvar;
> 
> Everywhere that such a variable appears, the dollar prefix is required, and no space is allowed. Now it's tempting to write the grammar as:
> 
> variableName 
>     : Dollar Identifier ...
> ...
> Identifier
>     : ('a'..'z' | 'A'..'Z' | '_')  ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')*
> 
> This Identifier rule is good for all named things in PHP, but the parser rule would allow whitespace between $ and Identifier, which is not accepted by the actual PHP parser.  
> 
> So, maybe it's better to stick the "$" at the beginning of the lexer rule for Identifier (call it DollarIdentifier or something).
> 
> But then you get to variables that are members of a class/object. 
> 
>     class C {
>         var $mymember = 'Hello';
>         ...
>     }
>     $c = new C();
>     print $c->mymember;
> 
> Note how the declaration uses a $ prefix, but the usage does not (the only $ is on the object variable, not the id of the member variable).  But I'm somewhat loath to handle the $ sometimes in lexer rules, and sometimes in parser rules, as this seems apt to confuse later. (Maybe not... I haven't assessed how messy it gets going down this path.)
> 
> I do indeed see ways to lex/parse this more strictly, I'm just exploring for the least messy way.

My limited experience has shown me that the more complex way usually 
ends up less messy in the end...

I'd lex $id and id entirely separately, as they are syntactically 
distinct entities. $blah is always a variable, a "true" variable, and 
$c->member should be three tokens - a VARIABLEID ($c), a MEMBER (->) and 
an ID (member). If PHP requires there be no space between those tokens, 
then that might be a problem, but conceptually you'd parse it to a tree like

^(MEMBER VARIABLEID ID)

or, filling in values,

^(MEMBER $c member)

The point being that -> is a member operator. Your tree walker would see 
the $member and give that class a member called member, perhaps, which 
the MEMBER operator would fine. It's easy to trim/add a '$' from a string.

-- 
Sam Barnett-Cormack

From antlr at mirality.co.nz  Thu Aug  6 02:51:54 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 06 Aug 2009 21:51:54 +1200
Subject: [antlr-interest] revised subject: tree matcher problem with
 validating semantic predicate
In-Reply-To: <82dc0d190908051434i6709d5dfq184caccacab76d0e@mail.gmail.co
 m>
References: <82dc0d190908051434i6709d5dfq184caccacab76d0e@mail.gmail.com>
Message-ID: <20090806095205.585243418483@www.antlr.org>

At 09:34 6/08/2009, Tom Smith wrote:
 >I have narrowed down my problem.  The validating semantic
 >predicate properly throws a FailedPredicateException in
 >a regular tree grammar, but does not when filter=true.
[...]
 >Am I wrong to expect this?

I've never really played with filter=true in tree grammars, but 
when used in lexers the whole point is to only define the rules 
you care about and anything that doesn't successfully match a rule 
is ignored.

Thus if the predicate fails, it's not an error -- it's simply not 
a match for that rule, and the parser will go try another 
alternative, or give up and skip it.

So I'm not surprised that the exception isn't being produced.


From yotommy at gmail.com  Thu Aug  6 03:08:18 2009
From: yotommy at gmail.com (Tom Smith)
Date: Thu, 6 Aug 2009 06:08:18 -0400
Subject: [antlr-interest] revised subject: tree matcher problem with
	validating semantic predicate
In-Reply-To: <82dc0d190908060259u1e421735o4df1c0c9b1ffcb94@mail.gmail.com>
References: <82dc0d190908051434i6709d5dfq184caccacab76d0e@mail.gmail.com>
	<4a7aa7c5.0d08c00a.4ee9.ffff875cSMTPIN_ADDED@mx.google.com>
	<82dc0d190908060259u1e421735o4df1c0c9b1ffcb94@mail.gmail.com>
Message-ID: <82dc0d190908060308m35d167e0n72465d9c7ad2eb19@mail.gmail.com>

Five more minutes' thought, and I'm no longer sure. =;^)

There are other kinds of semantic predicates that can be used for
disabling alternatives.  Is it really by design that a validating
semantic predicate does not validate when filter=true?

On Thu, Aug 6, 2009 at 5:59 AM, Tom Smith<yotommy at gmail.com> wrote:
> On Thu, Aug 6, 2009 at 5:51 AM, Gavin Lambert<antlr at mirality.co.nz> wrote:
>> I've never really played with filter=true in tree grammars, but when used in
>> lexers the whole point is to only define the rules you care about and
>> anything that doesn't successfully match a rule is ignored.
>>
>> Thus if the predicate fails, it's not an error -- it's simply not a match
>> for that rule, and the parser will go try another alternative, or give up
>> and skip it.
>>
>> So I'm not surprised that the exception isn't being produced.
>>
>
> Gavin:
>
> Presented this way, your reasoning makes sense to me. ?Thanks for
> taking the time to respond.
>
> Tom.
>

From gwlist at grahamwideman.com  Thu Aug  6 11:54:28 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Thu, 06 Aug 2009 11:54:28 -0700
Subject: [antlr-interest] Whitespace: More than meets the eye?
In-Reply-To: <4A7A9B5F.5060705@lancaster.ac.uk>
References: <4.1.20090806012709.05a7de28@grahamwideman.com>
	<4.1.20090805203832.05a77a00@grahamwideman.com>
	<4.1.20090805203832.05a77a00@grahamwideman.com>
	<4.1.20090806012709.05a7de28@grahamwideman.com>
Message-ID: <4.1.20090806113133.022109b8@grahamwideman.com>

Hi Sam:

>I'd lex $id and id entirely separately, as they are syntactically 
>distinct entities. $blah is always a variable, a "true" variable,

Tempting, but not necessarily the immediate winner because PHP also allows things like:

    $myvar = 'othervar';
    $$myvar = 'xxx';

... which means  "Get the string value of $myvar (here 'othervar'), and use that to compose a new variable name ($othervar) and use that variable. So here $othervar gets assigned 'xxx'.

This use of $ can be repeated:   $$$$$$$$$myvar  (though one might not see the usefulness for this).

Then there's

    ${'some' . 'var'}

Where { } encloses an arbitrary expression with a string result (here 'somevar'), and again this is used with $ to access the variable $somevar.

Multi $ and { } can be combined.  (And of course these appear in lengthier variable or method access expressions with -> for member and [ ] for array access.

So, this all led me to want $ to be handled uniformly in the parser grammar (not lexer).

However, this discussion has prompted me to test exactly where whitespace is permitted or not permitted.  So far as my brief test has discovered, it turns out that the only place whitespace is NOT permitted is the simple case of $myvar:

    $myvar = 'x';      // OK
    $  myvar = 'y';    // Syntax error
    $  $myvar = 'z';   // Syntax OK!

So, this really argues in favor of making a special lexer token DollarIdentifier to handle this case, as you were arguing. Essentially distinguishing $ as an id marker from $ used as an indirection operator.

>$c->member should be three tokens - a VARIABLEID ($c), a MEMBER (->) and 
>an ID (member).

Yes, this is the form of the existing solution for this part of the grammar.

Anyhow -- thanks for prompting this advance in thinking :-).

-- Graham


From martijn.reuvers at gmail.com  Thu Aug  6 12:15:47 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Thu, 6 Aug 2009 21:15:47 +0200
Subject: [antlr-interest] LLVM example: wiki or book?
In-Reply-To: <6FF9E94E-BB92-4195-9346-88C97B96CD47@cs.usfca.edu>
References: <383056.53595.qm@web33304.mail.mud.yahoo.com>
	<F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
	<3c2632090908051438j57d6e5e0jde4aae6e0d41738@mail.gmail.com>
	<6FF9E94E-BB92-4195-9346-88C97B96CD47@cs.usfca.edu>
Message-ID: <c376e6ec0908061215o556da11btc9c0aa106fc6f6b7@mail.gmail.com>

Hey Ter,

Looks fine to me. =)
Maybe you can explain a bit about why using backtrack here and there,
why it would be needed - maybe something about predicates (and the
limitations of them, e.g. things not always getting called).

Martijn

On Thu, Aug 6, 2009 at 1:34 AM, Terence Parr<parrt at cs.usfca.edu> wrote:
> Posting the grammar(s) for you to take a look at. do think this covers it?
> It seems like it covers a good deal. I will post the full source code after
> I take another pass over it and so on.
> T
>
>
> On Aug 5, 2009, at 2:38 PM, Hugo Picado wrote:
>
>> Hi Terence,
>>
>> You don't actually need to put a big example, as long as it is a good
>> example. Independently of the specific grammar, I think it should address
>> common issues such as parsing, tree walk, input/output parameters in rules,
>> lists, use of the most important predicates such as tokens, header, member,
>> etc.
>>
>> Additionally, one think that I've seen that is commonly asked here is how
>> to implement unary minus, or how to construct tree nodes with different root
>> tokens, etc.
>>
>> You can use a small example to show all this, I think a "too much big"
>> example will somewhere/sometime/somehow confuse the reader.
>>
>> Back to the question, perhaps your C subset is a nice choice :)
>>
>> Good luck with that.
>>
>> Regards,
>> Hugo.
>>
>> On Wed, Aug 5, 2009 at 8:25 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>> Hi Guys,
>>
>> Ok, I'm rapidly running into my deadline for the book. by the end of
>> the day I hope to finish the translation and then the generation
>> chapters. you will see a beta of at least one of those chapters this
>> week. That leaves the sort of " wrapping up" chapter, which doesn't
>> really scream "Put a big LLVM example in".
>>
>> To satisfy you folks, would be sufficient if I put it up on the wiki
>> with some good but not perfect description as well as the full source
>> code for my C subset to LLVM example?
>>
>> Ter
>> On Jun 24, 2009, at 10:30 AM, J. Stephen Riley Silber wrote:
>>
>> >
>> > I think Waverly's point wasn't the complexity of the grammar of the
>> > language. ?No one is arguing the simplicity of the Smalltalk
>> > grammar. ?His point was that compiling a simple imperative language
>> > to LLVM will demonstrate the basics of LLVM IL generation.
>> > "Everyone knows C", so it should make for a relatively simple
>> > tutorial.
>> >
>> > I know nothing about LLVM besides what's on its project homepage,
>> > but I am confident that a C subset example will allow me to ramp up
>> > quickly to the point where I could implement "advanced" features
>> > such as dynamic dispatch in short order.
>> >
>> > Ter, consider this a hearty seconding of Waverly's suggestion. ?It's
>> > a great idea.
>> >
>> > --- On Wed, 6/24/09, Damien Cassou <damien.cassou at gmail.com> wrote:
>> >
>> > From: Damien Cassou <damien.cassou at gmail.com>
>> > Subject: Re: [antlr-interest] ok, will build an LLVM example for book
>> > To: "Edwards, Waverly" <Waverly.Edwards at genesys.com>
>> > Cc: "antlr-interest at antlr.org ANTLR" <antlr-interest at antlr.org>
>> > Date: Wednesday, June 24, 2009, 9:47 AM
>> >
>> > On Wed, Jun 24, 2009 at 6:40 PM, Edwards,
>> > Waverly<Waverly.Edwards at genesys.com> wrote:
>> > > A Smalltalk or Java type language subset might be nice but overly
>> > complex, possibly
>> > > loosing your reader.
>> >
>> > The entire Smalltalk language represents no more than 17 AST nodes. I
>> > don't consider that overly complex.
>> >
>> > --
>> > Damien Cassou
>> > http://damiencassou.seasidehosting.st
>> >
>> > "Lambdas are relegated to relative obscurity until Java makes them
>> > popular by not having them." James Iry
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
>> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
>> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From parrt at cs.usfca.edu  Thu Aug  6 12:45:34 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 6 Aug 2009 12:45:34 -0700
Subject: [antlr-interest] revised subject: tree matcher problem with
	validating semantic predicate
In-Reply-To: <82dc0d190908060308m35d167e0n72465d9c7ad2eb19@mail.gmail.com>
References: <82dc0d190908051434i6709d5dfq184caccacab76d0e@mail.gmail.com>
	<4a7aa7c5.0d08c00a.4ee9.ffff875cSMTPIN_ADDED@mx.google.com>
	<82dc0d190908060259u1e421735o4df1c0c9b1ffcb94@mail.gmail.com>
	<82dc0d190908060308m35d167e0n72465d9c7ad2eb19@mail.gmail.com>
Message-ID: <B5D8E812-70DC-43D5-AFFE-D9056D8F7ADB@cs.usfca.edu>

When a semantic predicate fails to validate  when matching in filter  
mode, it assumes that the rule is not viable, rewind, and tries the  
next alternative.
Ter
On Aug 6, 2009, at 3:08 AM, Tom Smith wrote:

> Five more minutes' thought, and I'm no longer sure. =;^)
>
> There are other kinds of semantic predicates that can be used for
> disabling alternatives.  Is it really by design that a validating
> semantic predicate does not validate when filter=true?
>
> On Thu, Aug 6, 2009 at 5:59 AM, Tom Smith<yotommy at gmail.com> wrote:
>> On Thu, Aug 6, 2009 at 5:51 AM, Gavin Lambert<antlr at mirality.co.nz>  
>> wrote:
>>> I've never really played with filter=true in tree grammars, but  
>>> when used in
>>> lexers the whole point is to only define the rules you care about  
>>> and
>>> anything that doesn't successfully match a rule is ignored.
>>>
>>> Thus if the predicate fails, it's not an error -- it's simply not  
>>> a match
>>> for that rule, and the parser will go try another alternative, or  
>>> give up
>>> and skip it.
>>>
>>> So I'm not surprised that the exception isn't being produced.
>>>
>>
>> Gavin:
>>
>> Presented this way, your reasoning makes sense to me.  Thanks for
>> taking the time to respond.
>>
>> Tom.
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From vincedupuis at hotmail.com  Thu Aug  6 14:40:21 2009
From: vincedupuis at hotmail.com (Vincent Dupuis)
Date: Thu, 6 Aug 2009 17:40:21 -0400
Subject: [antlr-interest] Check for null ?
Message-ID: <SNT116-W499CCCDA55A4E7725F0997B60A0@phx.gbl>


Hello,

I would like to know if I need to "check for null" for every 
optional sub rule return value.

Like in the following example:

event
@init
{
    StringTemplate ddd = new StringTemplate();
    StringTemplate iii = new StringTemplate();
    String ggg = new String();
}
    :   'on' n=IDENT ('if' i=identifierList)? ('do' d=identifierList)? ('goto' g=IDENT)?
        {
            if (d != null) ddd = $d.st;
            if (i != null) iii = $i.st;
            if (g != null) ggg = $g.text;
        }
        -> event(eventName={$n.text}, doList={ddd}, ifList={iii}, gotoSate={ggg})
    ;

Thank you,

Vincent


_________________________________________________________________
Avec Windows Live, vous gardez le contact avec tous vos amis au m?me endroit.
http://go.microsoft.com/?linkid=9660830
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090806/0055b0be/attachment.html 

From everfall at hotmail.com  Thu Aug  6 19:02:21 2009
From: everfall at hotmail.com (Andrew Chalmers)
Date: Fri, 7 Aug 2009 02:02:21 +0000
Subject: [antlr-interest] VS 2008 build setup - Antlr is called
 unnecessarily when grammar.g hasn't changed
Message-ID: <SNT103-W502B3CAC97960F9FD6726ACC0B0@phx.gbl>


I followed the instructions here (http://www.antlr.org/wiki/display/ANTLR3/Integration+with+Development+Environments).

 

My grammar.g has two child (dependent) items, blahLexer.cs and blahParser.cs. When I build my solution, Antlr is called, and correctly rebuilds the lexer and parser, which is great.

 

My problem is that Antlr is called _every_ time I run a build, even when the two dependent items (lexer and parser.cs) are up-to-date wrt the grammar definition.

 

Anyone know how to instruct msbuild (or even Antlr; I'm not picky!) to skip the rebuild of lexer and parser when they're already up-to-date?

_________________________________________________________________
View photos of singles in your area Click Here
http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Fdating%2Eninemsn%2Ecom%2Eau%2Fsearch%2Fsearch%2Easpx%3Fexec%3Dgo%26tp%3Dq%26gc%3D2%26tr%3D1%26lage%3D18%26uage%3D55%26cl%3D14%26sl%3D0%26dist%3D50%26po%3D1%26do%3D2%26trackingid%3D1046138%26r2s%3D1&_t=773166090&_r=Hotmail_Endtext&_m=EXT
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090807/c2f78f5b/attachment.html 

From cmundi at gmail.com  Thu Aug  6 19:37:46 2009
From: cmundi at gmail.com (C. Mundi)
Date: Thu, 6 Aug 2009 19:37:46 -0700
Subject: [antlr-interest] LLVM example: wiki or book?
In-Reply-To: <F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
References: <383056.53595.qm@web33304.mail.mud.yahoo.com>
	<F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
Message-ID: <e794390908061937g46faeb68mc831f4a786efd3db@mail.gmail.com>

Llvm is so big it needs several books of its own.  I think your
audience is best served by your focus on antlr with maybe just an
outline of an example offered on the wiki.



On 8/5/09, Terence Parr <parrt at cs.usfca.edu> wrote:
> Hi Guys,
>
> Ok, I'm rapidly running into my deadline for the book. by the end of
> the day I hope to finish the translation and then the generation
> chapters. you will see a beta of at least one of those chapters this
> week. That leaves the sort of " wrapping up" chapter, which doesn't
> really scream "Put a big LLVM example in".
>
> To satisfy you folks, would be sufficient if I put it up on the wiki
> with some good but not perfect description as well as the full source
> code for my C subset to LLVM example?
>
> Ter
> On Jun 24, 2009, at 10:30 AM, J. Stephen Riley Silber wrote:
>
>>
>> I think Waverly's point wasn't the complexity of the grammar of the
>> language.  No one is arguing the simplicity of the Smalltalk
>> grammar.  His point was that compiling a simple imperative language
>> to LLVM will demonstrate the basics of LLVM IL generation.
>> "Everyone knows C", so it should make for a relatively simple
>> tutorial.
>>
>> I know nothing about LLVM besides what's on its project homepage,
>> but I am confident that a C subset example will allow me to ramp up
>> quickly to the point where I could implement "advanced" features
>> such as dynamic dispatch in short order.
>>
>> Ter, consider this a hearty seconding of Waverly's suggestion.  It's
>> a great idea.
>>
>> --- On Wed, 6/24/09, Damien Cassou <damien.cassou at gmail.com> wrote:
>>
>> From: Damien Cassou <damien.cassou at gmail.com>
>> Subject: Re: [antlr-interest] ok, will build an LLVM example for book
>> To: "Edwards, Waverly" <Waverly.Edwards at genesys.com>
>> Cc: "antlr-interest at antlr.org ANTLR" <antlr-interest at antlr.org>
>> Date: Wednesday, June 24, 2009, 9:47 AM
>>
>> On Wed, Jun 24, 2009 at 6:40 PM, Edwards,
>> Waverly<Waverly.Edwards at genesys.com> wrote:
>> > A Smalltalk or Java type language subset might be nice but overly
>> complex, possibly
>> > loosing your reader.
>>
>> The entire Smalltalk language represents no more than 17 AST nodes. I
>> don't consider that overly complex.
>>
>> --
>> Damien Cassou
>> http://damiencassou.seasidehosting.st
>>
>> "Lambdas are relegated to relative obscurity until Java makes them
>> popular by not having them." James Iry
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From parrt at cs.usfca.edu  Thu Aug  6 21:55:25 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 6 Aug 2009 21:55:25 -0700
Subject: [antlr-interest] LLVM example: wiki or book?
In-Reply-To: <c376e6ec0908061215o556da11btc9c0aa106fc6f6b7@mail.gmail.com>
References: <383056.53595.qm@web33304.mail.mud.yahoo.com>
	<F4125709-0735-4976-8B01-F7159E098E67@cs.usfca.edu>
	<3c2632090908051438j57d6e5e0jde4aae6e0d41738@mail.gmail.com>
	<6FF9E94E-BB92-4195-9346-88C97B96CD47@cs.usfca.edu>
	<c376e6ec0908061215o556da11btc9c0aa106fc6f6b7@mail.gmail.com>
Message-ID: <DCA1154B-36C2-41BA-8909-A850D2A42884@cs.usfca.edu>

I'll try to explain quickly but completely. also I'll explain the LLVM  
output; i.e., what the mapping is and how LLVM works.
Ter
On Aug 6, 2009, at 12:15 PM, Martijn Reuvers wrote:

> Hey Ter,
>
> Looks fine to me. =)
> Maybe you can explain a bit about why using backtrack here and there,
> why it would be needed - maybe something about predicates (and the
> limitations of them, e.g. things not always getting called).
>
> Martijn
>
> On Thu, Aug 6, 2009 at 1:34 AM, Terence Parr<parrt at cs.usfca.edu>  
> wrote:
>> Posting the grammar(s) for you to take a look at. do think this  
>> covers it?
>> It seems like it covers a good deal. I will post the full source  
>> code after
>> I take another pass over it and so on.
>> T
>>
>>
>> On Aug 5, 2009, at 2:38 PM, Hugo Picado wrote:
>>
>>> Hi Terence,
>>>
>>> You don't actually need to put a big example, as long as it is a  
>>> good
>>> example. Independently of the specific grammar, I think it should  
>>> address
>>> common issues such as parsing, tree walk, input/output parameters  
>>> in rules,
>>> lists, use of the most important predicates such as tokens,  
>>> header, member,
>>> etc.
>>>
>>> Additionally, one think that I've seen that is commonly asked here  
>>> is how
>>> to implement unary minus, or how to construct tree nodes with  
>>> different root
>>> tokens, etc.
>>>
>>> You can use a small example to show all this, I think a "too much  
>>> big"
>>> example will somewhere/sometime/somehow confuse the reader.
>>>
>>> Back to the question, perhaps your C subset is a nice choice :)
>>>
>>> Good luck with that.
>>>
>>> Regards,
>>> Hugo.
>>>
>>> On Wed, Aug 5, 2009 at 8:25 PM, Terence Parr <parrt at cs.usfca.edu>  
>>> wrote:
>>> Hi Guys,
>>>
>>> Ok, I'm rapidly running into my deadline for the book. by the end of
>>> the day I hope to finish the translation and then the generation
>>> chapters. you will see a beta of at least one of those chapters this
>>> week. That leaves the sort of " wrapping up" chapter, which doesn't
>>> really scream "Put a big LLVM example in".
>>>
>>> To satisfy you folks, would be sufficient if I put it up on the wiki
>>> with some good but not perfect description as well as the full  
>>> source
>>> code for my C subset to LLVM example?
>>>
>>> Ter
>>> On Jun 24, 2009, at 10:30 AM, J. Stephen Riley Silber wrote:
>>>
>>>>
>>>> I think Waverly's point wasn't the complexity of the grammar of the
>>>> language.  No one is arguing the simplicity of the Smalltalk
>>>> grammar.  His point was that compiling a simple imperative language
>>>> to LLVM will demonstrate the basics of LLVM IL generation.
>>>> "Everyone knows C", so it should make for a relatively simple
>>>> tutorial.
>>>>
>>>> I know nothing about LLVM besides what's on its project homepage,
>>>> but I am confident that a C subset example will allow me to ramp up
>>>> quickly to the point where I could implement "advanced" features
>>>> such as dynamic dispatch in short order.
>>>>
>>>> Ter, consider this a hearty seconding of Waverly's suggestion.   
>>>> It's
>>>> a great idea.
>>>>
>>>> --- On Wed, 6/24/09, Damien Cassou <damien.cassou at gmail.com> wrote:
>>>>
>>>> From: Damien Cassou <damien.cassou at gmail.com>
>>>> Subject: Re: [antlr-interest] ok, will build an LLVM example for  
>>>> book
>>>> To: "Edwards, Waverly" <Waverly.Edwards at genesys.com>
>>>> Cc: "antlr-interest at antlr.org ANTLR" <antlr-interest at antlr.org>
>>>> Date: Wednesday, June 24, 2009, 9:47 AM
>>>>
>>>> On Wed, Jun 24, 2009 at 6:40 PM, Edwards,
>>>> Waverly<Waverly.Edwards at genesys.com> wrote:
>>>>> A Smalltalk or Java type language subset might be nice but overly
>>>> complex, possibly
>>>>> loosing your reader.
>>>>
>>>> The entire Smalltalk language represents no more than 17 AST  
>>>> nodes. I
>>>> don't consider that overly complex.
>>>>
>>>> --
>>>> Damien Cassou
>>>> http://damiencassou.seasidehosting.st
>>>>
>>>> "Lambdas are relegated to relative obscurity until Java makes them
>>>> popular by not having them." James Iry
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe:
>>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe:
>>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email- 
>> address
>>
>>


From tbee at tbee.org  Fri Aug  7 06:46:38 2009
From: tbee at tbee.org (Tom)
Date: Fri, 07 Aug 2009 15:46:38 +0200
Subject: [antlr-interest] Antlr error reporting
Message-ID: <4A7C303E.50002@tbee.org>

After finally having my grammar working I want to tune the error 
reporting. I found something with that intend at the bottom of this wiki 
page, but my parser does not even have a "setTreeAdaptor".

http://www.antlr.org/wiki/display/ANTLR3/Tree+construction

I did not find any setter on my parser that makes sense nor an 
addListener thingy. There must be some way to hook into the error output 
stream that is now set to System.err?

Tom

From jackantlr at gmail.com  Fri Aug  7 08:59:38 2009
From: jackantlr at gmail.com (Jack Jack)
Date: Fri, 7 Aug 2009 23:59:38 +0800
Subject: [antlr-interest] Problem on left associative for AST
Message-ID: <904aa19f0908070859j41e8a4del7ea6e6e378a2e519@mail.gmail.com>

I have spent a lot of time on this issue, but failed to find a solution,
really hope that some kind soul could help.

Following is the definition of the grammar
Expr::=
                CONST
                |Expr>Expr //OUTPUT(left associative)
                |Expr<Expr //INPUT(right associative)
                |Expr;Expr //SEQUENCE(left associative)
                |if Expr then Expr else Expr //IF
CONST::=Boolean|Number|String

">" is right associative, "<" and ";" are left associative, the syntactic
constructs of Expr are ordered by precedence, from highest to lowest,
For examples "Expr>Expr" has higher precedence then "Expr<Expr"

Some examples
"if true then 1 else 1>1" will be interpreted as "if true then 1 else (1>1)"
"1>1>if true then 1 else 1" will be interpreted as "1>(1>if true then p else
1)"
"1<1<if true then 1 else 1" will be interpreted as "(1<1)<if true then p
else 1"
"1;2;if true then 1 else 1" will be interpreted as "((1;2); if true then 1
else 1);

I am having problem in defining left associative for AST, what I can achieve
is only right associative, following is the ANTLR grammar that defined by
me:
//====ANTLR GRAMMAR START===
grammar ORCTree;

options
{
    output=AST;
    ASTLabelType=CommonTree;
    backtrack = true;
    memoize=true;
}


tokens {
    OUTPUT_NODE;
    INPUT_NODE;
    SEQUENCE_NODE;
    IF_NODE;
}


expr
    : ifExpr
    ;

ifExpr
    : 'if' s1=expr 'then' s2=expr 'else' s3=expr ->^(IF_NODE $s1 $s2 $s3)
    | sequenceExpr
    ;

sequenceExpr
    : s1=inputExpr (';'^ s2=expr)*
    | inputExpr
    ;

inputExpr
    : p=outputExpr ('<'^ e=expr)*
    | outputExpr;

outputExpr
    : p=constExpr ('>'^ e=expr)*
    | constExpr;

constExpr
    :
    |CONST
    | '('! expr ')'!
    ;


WS  :  (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;} ;

fragment
STRING
    :  '"' (~('"') )* '"';

fragment
NUM
    : ('0'..'9')'.'('0'..'9')+
    |    ('1'..'9')('0'..'9')*
    ;
fragment
BOOL
    : 'true'
    |    'false'
    ;

CONST
    :    BOOL
    |    STRING
    |    NUM;
//====ANTLR GRAMMAR END===

outputExpr and sequenceExpr both are currently right associative(which is
not correct), may I know how to make them left associative?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090807/2db88719/attachment.html 

From andrew.bradnan at gmail.com  Fri Aug  7 10:10:08 2009
From: andrew.bradnan at gmail.com (Andrew Bradnan)
Date: Fri, 7 Aug 2009 10:10:08 -0700
Subject: [antlr-interest] VS 2008 build setup - Antlr is called
	unnecessarily when grammar.g hasn't changed
In-Reply-To: <SNT103-W502B3CAC97960F9FD6726ACC0B0@phx.gbl>
References: <SNT103-W502B3CAC97960F9FD6726ACC0B0@phx.gbl>
Message-ID: <8a5e9b780908071010y1323fb0u1875a084ac84f14c@mail.gmail.com>

There's a -make option to do what you want.

On Thu, Aug 6, 2009 at 7:02 PM, Andrew Chalmers <everfall at hotmail.com>wrote:

> I followed the instructions here (
> http://www.antlr.org/wiki/display/ANTLR3/Integration+with+Development+Environments
> ).
>
> My grammar.g has two child (dependent) items, blahLexer.cs and
> blahParser.cs. When I build my solution, Antlr is called, and correctly
> rebuilds the lexer and parser, which is great.
>
> My problem is that Antlr is called _every_ time I run a build, even when
> the two dependent items (lexer and parser.cs) are up-to-date wrt the grammar
> definition.
>
> Anyone know how to instruct msbuild (or even Antlr; I'm not picky!) to skip
> the rebuild of lexer and parser when they're already up-to-date?
>
> ------------------------------
> Click Here View photos of singles in your area<http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Fdating%2Eninemsn%2Ecom%2Eau%2Fsearch%2Fsearch%2Easpx%3Fexec%3Dgo%26tp%3Dq%26gc%3D2%26tr%3D1%26lage%3D18%26uage%3D55%26cl%3D14%26sl%3D0%26dist%3D50%26po%3D1%26do%3D2%26trackingid%3D1046138%26r2s%3D1&_t=773166090&_r=Hotmail_Endtext&_m=EXT>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>


-- 
/Andrew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090807/2cf96162/attachment.html 

From tdjastrzebski at yahoo.com  Fri Aug  7 10:38:02 2009
From: tdjastrzebski at yahoo.com (Tomasz Jastrzebski)
Date: Fri, 7 Aug 2009 10:38:02 -0700 (PDT)
Subject: [antlr-interest] could not even do k=1 for decision xx;
	reason: timed out
Message-ID: <326229.19905.qm@web52108.mail.re2.yahoo.com>

Hello all,
?
I have several rules "chained" like this:
?
additiveExpression
?: multiplicativeExpression ('+' | '-') multiplicativeExpression
?| multiplicativeExpression
?;
multiplicativeExpression
?: exponentiationExpression ('*' | '/') exponentiationExpression
?| exponentiationExpression
?;
?
and eventually the tool complains: could not even do k=1 for decision XX; reason: timed out (>1000ms)
?
Nothing unseen -?such rules could be easily left-factored:
?
additiveExpression
?: multiplicativeExpression (('+' | '-') multiplicativeExpression)*
?;
multiplicativeExpression
?: exponentiationExpression (('*' | '/') exponentiationExpression)*
?;
?
But the problem is that I cannot do that since I need to catch reference to each expression and operator to build nice AST tree. The real code looks more like this:
?
additiveExpression
?: e1=multiplicativeExpression (o='+' | o='-') e2=multiplicativeExpression -> BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree]
?| multiplicativeExpression
?;
multiplicativeExpression
?: e1=exponentiationExpression (o='*' | o='/') e2=exponentiationExpression -> BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree]
?| exponentiationExpression
?;
?
Any ideas?
?
Thanks,
?
Tomasz


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090807/c032c950/attachment.html 

From sharwell at pixelminegames.com  Fri Aug  7 11:32:35 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Fri, 7 Aug 2009 13:32:35 -0500
Subject: [antlr-interest] VS 2008 build setup - Antlr is
	calledunnecessarily when grammar.g hasn't changed
In-Reply-To: <8a5e9b780908071010y1323fb0u1875a084ac84f14c@mail.gmail.com>
References: <SNT103-W502B3CAC97960F9FD6726ACC0B0@phx.gbl>
	<8a5e9b780908071010y1323fb0u1875a084ac84f14c@mail.gmail.com>
Message-ID: <86403CA0939415448BCCB83855EFE09AA68512@Bloodymary.ironwillgames.com>

My build does not exhibit this behavior (the generated files are only
generated if they are out of date). I highlighted a section in the
Target definition which clearly differs from the web page description
and I know is used when checking for out-of-date dependencies.

 

Here is a combined grammar:

 

    <Antlr3 Include="UcLanguage\UcGrammar.g">

 
<OutputFiles>UcLanguage\UcGrammarLexer.cs;UcLanguage\UcGrammarParser.cs;
UcLanguage\UcGrammar.tokens</OutputFiles>

    </Antlr3>

 

Here is a lexer grammar:

 

    <Antlr3 Include="UcLanguage\DoxygenLexer.g3">

 
<OutputFiles>UcLanguage\DoxygenLexer.cs;UcLanguage\DoxygenLexer.tokens</
OutputFiles>

    </Antlr3>

 

Here is a tree walker:

 

    <Antlr3 Include="UcLanguage\UcGrammarWalker.g">

      <InputFiles>UcLanguage\UcGrammar.tokens</InputFiles>

 
<OutputFiles>UcLanguage\UcGrammarWalker.cs;UcLanguage\UcGrammarWalker.to
kens</OutputFiles>

      <TokensPath>$(MSBuildProjectDirectory)\UcLanguage\</TokensPath>

    </Antlr3>

 

Here is the target section:

 

  <PropertyGroup>

 
<Antlr3ToolPath>$(MSBuildProjectDirectory)\..\Reference\Antlr</Antlr3Too
lPath>

 
<CoreCompileDependsOn>$(CoreCompileDependsOn);GenerateAntlrCode</CoreCom
pileDependsOn>

  </PropertyGroup>

  <Target Name="GenerateAntlrCode" Inputs="@(Antlr3)"
Outputs="%(OutputFiles)">

    <Message Importance="normal" Text="Antlr: Transforming '@(Antlr3)'
to '%(Antlr3.OutputFiles)'" />

    <Exec Command="%22$(Antlr3ToolPath)\Antlr3.exe%22
-Xconversiontimeout 10000 -lib %22%(RootDir)%(Directory).%22
-message-format vs2005 @(Antlr3)" Outputs="%(OutputFiles)" />

  </Target>

 

Finally, I don't have InitialTargets set on the Project node, however I
do have the following set, which fixes the problem of requiring two
builds to catch changes to the compiled grammar. Perhaps setting the
InitialTargets is another method to accomplish the same thing? Either
way, this setting isn't the source of the particular build issue you're
asking about.

 

  <PropertyGroup>

    <UseHostCompilerIfAvailable>False</UseHostCompilerIfAvailable>

  </PropertyGroup>

 

Sam

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andrew Bradnan
Sent: Friday, August 07, 2009 12:10 PM
To: Andrew Chalmers; antlr-interest at antlr.org
Subject: Re: [antlr-interest] VS 2008 build setup - Antlr is
calledunnecessarily when grammar.g hasn't changed

 

There's a -make option to do what you want.

On Thu, Aug 6, 2009 at 7:02 PM, Andrew Chalmers <everfall at hotmail.com>
wrote:

I followed the instructions here
(http://www.antlr.org/wiki/display/ANTLR3/Integration+with+Development+E
nvironments).
 
My grammar.g has two child (dependent) items, blahLexer.cs and
blahParser.cs. When I build my solution, Antlr is called, and correctly
rebuilds the lexer and parser, which is great.
 
My problem is that Antlr is called _every_ time I run a build, even when
the two dependent items (lexer and parser.cs) are up-to-date wrt the
grammar definition.
 
Anyone know how to instruct msbuild (or even Antlr; I'm not picky!) to
skip the rebuild of lexer and parser when they're already up-to-date?

________________________________

Click Here View photos of singles in your area
<http://a.ninemsn.com.au/b.aspx?URL=http%3A%2F%2Fdating%2Eninemsn%2Ecom%
2Eau%2Fsearch%2Fsearch%2Easpx%3Fexec%3Dgo%26tp%3Dq%26gc%3D2%26tr%3D1%26l
age%3D18%26uage%3D55%26cl%3D14%26sl%3D0%26dist%3D50%26po%3D1%26do%3D2%26
trackingid%3D1046138%26r2s%3D1&_t=773166090&_r=Hotmail_Endtext&_m=EXT> 



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address






-- 
/Andrew

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090807/a26382ba/attachment.html 

From tdjastrzebski at yahoo.com  Fri Aug  7 13:32:37 2009
From: tdjastrzebski at yahoo.com (Tomasz Jastrzebski)
Date: Fri, 7 Aug 2009 13:32:37 -0700 (PDT)
Subject: [antlr-interest] could not even do k=1 for decision xx;
	reason: timed out
In-Reply-To: <4A7C72D0.5030208@lancaster.ac.uk>
Message-ID: <858881.99842.qm@web52102.mail.re2.yahoo.com>

But this creates a different tree, while what I need is plain and simple structure like this:
? +
?/ \
/?? \
a?? *
?? / \
? /?? \
?c???? d
?
Tomasz

--- On Fri, 8/7/09, Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk> wrote:


From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
Subject: Re: [antlr-interest] could not even do k=1 for decision xx; reason: timed out
To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>
Date: Friday, August 7, 2009, 2:30 PM


Tomasz Jastrzebski wrote:

> But the problem is that I cannot do that since I need to catch reference to each expression and operator to build nice AST tree. The real code looks more like this:
>? additiveExpression
>? : e1=multiplicativeExpression (o='+' | o='-') e2=multiplicativeExpression -> BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree]
>? | multiplicativeExpression
>? ;

Still left-factor it.

additiveExpression
? : e1=multiplicativeExpression ((o='+'|o='-') e2=multiplicativeExpression -> BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree])*
? ;

This means that the output expression is only considered if the optional subrule matches - otherwise it uses the default output (just e1).

-- Sam Barnett-Cormack



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090807/05fd719f/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Fri Aug  7 15:29:58 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Fri, 07 Aug 2009 23:29:58 +0100
Subject: [antlr-interest] could not even do k=1 for decision xx;
 reason: timed out
In-Reply-To: <858881.99842.qm@web52102.mail.re2.yahoo.com>
References: <858881.99842.qm@web52102.mail.re2.yahoo.com>
Message-ID: <4A7CAAE6.800@lancaster.ac.uk>

Tomasz Jastrzebski wrote:
> But this creates a different tree, while what I need is plain and simple 
> structure like this:
>   +
>  / \
> /   \
> a   *
>    / \
>   /   \
>  c     d

No, it does exactly what the one you provided does. The output rule is 
only observed if the subrule matches, otherwise it follows the default. 
It is identical in effect to the rule you provided...

additiveExpression
   : e1=multiplicativeExpression ((o='+'|o='-')
      e2=multiplicativeExpression ->
      BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree])?
   ;

(I've corrected where it should be a question mark, not * - * would 
accept chained expressions, but the tree rewrite would be awkward)

If the subrule matches, the rewrite (which I don't quite understand) 
applies. If it doesn't, then the default (just emit the token as a 
single node) takes place.

Your grammar doesn't appear to support expressions like

3 + 4 - 5
or
2 * 3 / 5

Sam

> --- On *Fri, 8/7/09, Sam Barnett-Cormack 
> /<s.barnett-cormack at lancaster.ac.uk>/* wrote:
> 
> 
>     From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
>     Subject: Re: [antlr-interest] could not even do k=1 for decision xx;
>     reason: timed out
>     To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>
>     Date: Friday, August 7, 2009, 2:30 PM
> 
>     Tomasz Jastrzebski wrote:
> 
>      > But the problem is that I cannot do that since I need to catch
>     reference to each expression and operator to build nice AST tree.
>     The real code looks more like this:
>      >  additiveExpression
>      >  : e1=multiplicativeExpression (o='+' | o='-')
>     e2=multiplicativeExpression ->
>     BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree]
>      >  | multiplicativeExpression
>      >  ;
> 
>     Still left-factor it.
> 
>     additiveExpression
>       : e1=multiplicativeExpression ((o='+'|o='-')
>     e2=multiplicativeExpression ->
>     BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree])*
>       ;
> 
>     This means that the output expression is only considered if the
>     optional subrule matches - otherwise it uses the default output
>     (just e1).
> 
>     -- Sam Barnett-Cormack
> 
> 


-- 
Sam Barnett-Cormack

From gwlist at grahamwideman.com  Fri Aug  7 16:36:23 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Fri, 07 Aug 2009 16:36:23 -0700
Subject: [antlr-interest] Bug? Line number off in generate lexer
Message-ID: <4.1.20090807154104.05ea0a80@grahamwideman.com>

Hi folks:

I see in the generated Lexer code that there are comments in each token method indicating the corresponding line:col in the xxx.g source file. 

For methods implementing lexer rules that line number is accurate.  However, for methods that recognize the tokens in the tokens{...} list, the line number is off by quite a bit.  (Generated with Antlr 3.1.3)

Example:
tokens{
    SemiColon         = ';';   // line 37

Generates
----------------------------------
    // $ANTLR start "SemiColon"
    public final void mSemiColon() throws RecognitionException {
        try {
            int _type = SemiColon;
            int _channel = DEFAULT_TOKEN_CHANNEL;
            // ipsum.g:7:11: ( ';' )      <------------- ERROR
            // ipsum.g:7:13: ';'
            {
            match(';'); if (state.failed) return ;

            }

            state.type = _type;
            state.channel = _channel;
        }
        finally {
        }
    }
    // $ANTLR end "SemiColon"

----------------------------------

In the case above, the line number is off by 30.  Items later in the token{...} list have line numbers progressively more undercounted to the extent there are any blank lines or comment lines in the list.

However I don't see a pattern explaining the undercount before the first token{} item. There may be a substantial size comment at the beginning, but its size doesn't match the initial undercount, so there's something more subtle going on there.

I attach a sample grammar file which demonstrates the problem.

-- Graham






-------------- next part --------------
/*
ipsum grammar
Graham Wideman
Lorem ipsum dolor sit amet,
consectetur adipiscing elit. Nam a
diam id urna lobortis vehicula non at

dolor. Nunc vulputate sem non odio ullamcorper
sodales. Nulla sed tortor a metus posuere tempor.
Etiam fringilla mi vel nisl pellentesque ac sodales dolor
ullamcorper. Suspendisse placerat sodales
turpis, ut auctor quam vestibulum sed. Maecenas

pulvinar blandit aliquet. Aliquam commodo ornare
pharetra. Maecenas a est ipsum, id porta tellus. In
sodales est vitae lectus adipiscing id sodales
nunc volutpat. Donec eu ipsum neque, at viverra o

rci. Sed a libero neque. Nulla eget nibh velit.
Vivamus enim nibh, pretium eget malesuada eu, vulputate
quis mauris. Praesent id mollis sapien. Pellentesque
ut dui eros, non varius nibh.
*/

grammar ipsum;

options {
    backtrack = true;
    memoize = true;
    k=2;
    output = AST;
    ASTLabelType = CommonTree;
}

tokens{
    //-------- Names and strings for non-alphabetical tokens ---------
    SemiColon         = ';';
    SkooglyBoogle     = '\\xx//';

    Comma             = ',';
    LParen            = '(';

    RParen            = ')';
}

@header{
package com.grahamwideman.ipsum.parser;
}
@lexer::header{
package com.grahamwideman.ipsum.parser;
}

prog : statement*;

statement
    : SkooglyBoogle SemiColon
    ;


//========================== Lexer ===================

//----------------------- Numbers -----------------

fragment
Digits
	: '0'..'9'+
	;

fragment
DNum
	:(('.' Digits)=>('.' Digits)|(Digits '.' Digits?))
	;

Boolean
    : 'true' | 'false' | 'TRUE' | 'FALSE'
    ;

Null
    : 'NULL'
    ;

//------------------ String-related -------------

Identifier
   : ('a'..'z' | 'A'..'Z' | '_')  ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')*
   ;

//----------------- white space ------------


WhiteSpace
@init{
    $channel=HIDDEN;
}
	:	(' '| '\t'| '\n'|'\r')*
	;




From tdjastrzebski at yahoo.com  Fri Aug  7 19:05:24 2009
From: tdjastrzebski at yahoo.com (Tomasz Jastrzebski)
Date: Fri, 7 Aug 2009 19:05:24 -0700 (PDT)
Subject: [antlr-interest] could not even do k=1 for decision xx;
	reason: timed out
In-Reply-To: <4A7CAAE6.800@lancaster.ac.uk>
Message-ID: <256862.77925.qm@web52111.mail.re2.yahoo.com>

I agree that 

additiveExpression
? : multiplicativeExpression ('+' | '-') multiplicativeExpression
? | multiplicativeExpression
? ;

is equiwalent to:
?
additiveExpression
? : multiplicativeExpression (('+' | '-') multiplicativeExpression)?
? ;

Why it does not generate the same AST tree I do not know. May be it is a bug - I have to investigate.
?
Goot point about the "a + b + c" case.
?
Thanks,
?
Tomasz

--- On Fri, 8/7/09, Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk> wrote:


From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
Subject: Re: [antlr-interest] could not even do k=1 for decision xx; reason: timed out
To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>
Cc: "antlr-interest" <antlr-interest at antlr.org>
Date: Friday, August 7, 2009, 6:29 PM


Tomasz Jastrzebski wrote:
> But this creates a different tree, while what I need is plain and simple structure like this:
>???+
>? / \
> /???\
> a???*
>? ? / \
>???/???\
>? c? ???d

No, it does exactly what the one you provided does. The output rule is only observed if the subrule matches, otherwise it follows the default. It is identical in effect to the rule you provided...

additiveExpression
? : e1=multiplicativeExpression ((o='+'|o='-')
? ???e2=multiplicativeExpression ->
? ???BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree])?
? ;

(I've corrected where it should be a question mark, not * - * would accept chained expressions, but the tree rewrite would be awkward)

If the subrule matches, the rewrite (which I don't quite understand) applies. If it doesn't, then the default (just emit the token as a single node) takes place.

Your grammar doesn't appear to support expressions like

3 + 4 - 5
or
2 * 3 / 5

Sam

> --- On *Fri, 8/7/09, Sam Barnett-Cormack /<s.barnett-cormack at lancaster.ac.uk>/* wrote:
> 
> 
>? ???From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
>? ???Subject: Re: [antlr-interest] could not even do k=1 for decision xx;
>? ???reason: timed out
>? ???To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>
>? ???Date: Friday, August 7, 2009, 2:30 PM
> 
>? ???Tomasz Jastrzebski wrote:
> 
>? ? ? > But the problem is that I cannot do that since I need to catch
>? ???reference to each expression and operator to build nice AST tree.
>? ???The real code looks more like this:
>? ? ? >? additiveExpression
>? ? ? >? : e1=multiplicativeExpression (o='+' | o='-')
>? ???e2=multiplicativeExpression ->
>? ???BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree]
>? ? ? >? | multiplicativeExpression
>? ? ? >? ;
> 
>? ???Still left-factor it.
> 
>? ???additiveExpression
>? ? ???: e1=multiplicativeExpression ((o='+'|o='-')
>? ???e2=multiplicativeExpression ->
>? ???BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree])*
>? ? ???;
> 
>? ???This means that the output expression is only considered if the
>? ???optional subrule matches - otherwise it uses the default output
>? ???(just e1).
> 
>? ???-- Sam Barnett-Cormack
> 
> 


-- Sam Barnett-Cormack



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090807/638d9f96/attachment.html 

From newsreply at areeda.com  Fri Aug  7 19:09:59 2009
From: newsreply at areeda.com (Joseph Areeda)
Date: Fri, 07 Aug 2009 19:09:59 -0700
Subject: [antlr-interest] Saving state on incomplete tokens
Message-ID: <4A7CDE77.9000904@areeda.com>

I'm working on an editor for the Open Office IDL in NetBeans, using 
antlr for the syntax coloring, error highlighting ...  Things are 
working well except for the "lexing while typing" part.

Looking at the results of getState() I see a RecognizerSharedState 
object when tokens are complete but null during a token such as a /* 
style comment or a "quoted string" causing a "state can't be null" 
exception.  Even weirder all the times the lexer returns a state NB 
doesn't complain if I pass back a null.

I've been searching and reading to no avail.  Anybody have a suggestion 
how to save and restore the lexer state for these partial token?

Thanks,
Joe

From s.barnett-cormack at lancaster.ac.uk  Sat Aug  8 03:36:10 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Sat, 08 Aug 2009 11:36:10 +0100
Subject: [antlr-interest] could not even do k=1 for decision xx;
 reason: timed out
In-Reply-To: <256862.77925.qm@web52111.mail.re2.yahoo.com>
References: <256862.77925.qm@web52111.mail.re2.yahoo.com>
Message-ID: <4A7D551A.3090806@lancaster.ac.uk>

Tomasz Jastrzebski wrote:
> I agree that
> additiveExpression
>   : multiplicativeExpression ('+' | '-') multiplicativeExpression
>   | multiplicativeExpression
>   ;
> is equiwalent to:
>  
> additiveExpression
>   : multiplicativeExpression (('+' | '-') multiplicativeExpression)?
>   ;
> Why it does not generate the same AST tree I do not know. May be it is a 
> bug - I have to investigate.

It should generate the same AST - both are handled by the default tree 
rule, and produce a flat list of the tokens. However, if you put the 
output rule *inside* the optional subrule, it only applies if the 
optional subrule matches. Thus the case where the subrule doesn't match 
produces a single node, and where it does it produces the output you 
specify.

> Goot point about the "a + b + c" case.
>  
> Thanks,
>  
> Tomasz
> 
> --- On *Fri, 8/7/09, Sam Barnett-Cormack 
> /<s.barnett-cormack at lancaster.ac.uk>/* wrote:
> 
> 
>     From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
>     Subject: Re: [antlr-interest] could not even do k=1 for decision xx;
>     reason: timed out
>     To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>
>     Cc: "antlr-interest" <antlr-interest at antlr.org>
>     Date: Friday, August 7, 2009, 6:29 PM
> 
>     Tomasz Jastrzebski wrote:
>      > But this creates a different tree, while what I need is plain and
>     simple structure like this:
>      >   +
>      >  / \
>      > /   \
>      > a   *
>      >    / \
>      >   /   \
>      >  c     d
> 
>     No, it does exactly what the one you provided does. The output rule
>     is only observed if the subrule matches, otherwise it follows the
>     default. It is identical in effect to the rule you provided...
> 
>     additiveExpression
>       : e1=multiplicativeExpression ((o='+'|o='-')
>          e2=multiplicativeExpression ->
>          BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree])?
>       ;
> 
>     (I've corrected where it should be a question mark, not * - * would
>     accept chained expressions, but the tree rewrite would be awkward)
> 
>     If the subrule matches, the rewrite (which I don't quite understand)
>     applies. If it doesn't, then the default (just emit the token as a
>     single node) takes place.
> 
>     Your grammar doesn't appear to support expressions like
> 
>     3 + 4 - 5
>     or
>     2 * 3 / 5
> 
>     Sam
> 
>      > --- On *Fri, 8/7/09, Sam Barnett-Cormack
>     /<s.barnett-cormack at lancaster.ac.uk
>     <http://us.mc521.mail.yahoo.com/mc/compose?to=s.barnett-cormack at lancaster.ac.uk>>/*
>     wrote:
>      >
>      >
>      >     From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk
>     <http://us.mc521.mail.yahoo.com/mc/compose?to=s.barnett-cormack at lancaster.ac.uk>>
>      >     Subject: Re: [antlr-interest] could not even do k=1 for
>     decision xx;
>      >     reason: timed out
>      >     To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com
>     <http://us.mc521.mail.yahoo.com/mc/compose?to=tdjastrzebski at yahoo.com>>
>      >     Date: Friday, August 7, 2009, 2:30 PM
>      >
>      >     Tomasz Jastrzebski wrote:
>      >
>      >      > But the problem is that I cannot do that since I need to catch
>      >     reference to each expression and operator to build nice AST tree.
>      >     The real code looks more like this:
>      >      >  additiveExpression
>      >      >  : e1=multiplicativeExpression (o='+' | o='-')
>      >     e2=multiplicativeExpression ->
>      >     BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree]
>      >      >  | multiplicativeExpression
>      >      >  ;
>      >
>      >     Still left-factor it.
>      >
>      >     additiveExpression
>      >       : e1=multiplicativeExpression ((o='+'|o='-')
>      >     e2=multiplicativeExpression ->
>      >     BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree,
>     $e2.tree])*
>      >       ;
>      >
>      >     This means that the output expression is only considered if the
>      >     optional subrule matches - otherwise it uses the default output
>      >     (just e1).
>      >
>      >     -- Sam Barnett-Cormack
>      >
>      >
> 
> 
>     -- Sam Barnett-Cormack
> 
> 


-- 
Sam Barnett-Cormack

From tdjastrzebski at yahoo.com  Sat Aug  8 11:18:57 2009
From: tdjastrzebski at yahoo.com (Tomasz Jastrzebski)
Date: Sat, 8 Aug 2009 11:18:57 -0700 (PDT)
Subject: [antlr-interest] could not even do k=1 for decision xx;
	reason: timed out
In-Reply-To: <4A7D551A.3090806@lancaster.ac.uk>
Message-ID: <912030.24878.qm@web52108.mail.re2.yahoo.com>

Thanks.
?
Now I understand that the only reasonable such declaration must look like:
?
multExpr
?: primaryExpr (('*' | '/') primaryExpr)*
?;
?
After adding rewrite rules this may look like that:

addExpr
?: (multExpr -> multExpr) ( (o='+' | o='-') e=multExpr -> ^($o $addExpr $e) )*
?;
multExpr
?: (primaryExpr -> primaryExpr) ( (o='*' | o='/') e=primaryExpr -> ^($o $multExpr $e) )*
?;
?
(tested, it works)
?
I would think that now I can simply replace:
-> ^($o $addExpr $e)
with
-> ^(BIN_EXPR<BinaryExpression>[o.text, $addExpr.tree, $e.tree]>)
?
- but not. $addExpr.tree in the second version is always NIL.
?
I am stucked. Please advice. The overall goal is to make ANTLR create my own "strongly typed" AST tree structure using, in this case, my BinaryExpression and UnaryExpression nodes.
?
Tomasz
?

--- On Sat, 8/8/09, Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk> wrote:


From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
Subject: Re: [antlr-interest] could not even do k=1 for decision xx; reason: timed out
To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>, "ANTLR Interest Mailing List" <antlr-interest at antlr.org>
Date: Saturday, August 8, 2009, 6:36 AM


Tomasz Jastrzebski wrote:
> I agree that
> additiveExpression
>???: multiplicativeExpression ('+' | '-') multiplicativeExpression
>???| multiplicativeExpression
>???;
> is equiwalent to:
>? additiveExpression
>???: multiplicativeExpression (('+' | '-') multiplicativeExpression)?
>???;
> Why it does not generate the same AST tree I do not know. May be it is a bug - I have to investigate.

It should generate the same AST - both are handled by the default tree rule, and produce a flat list of the tokens. However, if you put the output rule *inside* the optional subrule, it only applies if the optional subrule matches. Thus the case where the subrule doesn't match produces a single node, and where it does it produces the output you specify.

> Goot point about the "a + b + c" case.
>? Thanks,
>? Tomasz
> 
> --- On *Fri, 8/7/09, Sam Barnett-Cormack /<s.barnett-cormack at lancaster.ac.uk>/* wrote:
> 
> 
>? ???From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
>? ???Subject: Re: [antlr-interest] could not even do k=1 for decision xx;
>? ???reason: timed out
>? ???To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>
>? ???Cc: "antlr-interest" <antlr-interest at antlr.org>
>? ???Date: Friday, August 7, 2009, 6:29 PM
> 
>? ???Tomasz Jastrzebski wrote:
>? ? ? > But this creates a different tree, while what I need is plain and
>? ???simple structure like this:
>? ? ? >???+
>? ? ? >? / \
>? ? ? > /???\
>? ? ? > a???*
>? ? ? >? ? / \
>? ? ? >???/???\
>? ? ? >? c? ???d
> 
>? ???No, it does exactly what the one you provided does. The output rule
>? ???is only observed if the subrule matches, otherwise it follows the
>? ???default. It is identical in effect to the rule you provided...
> 
>? ???additiveExpression
>? ? ???: e1=multiplicativeExpression ((o='+'|o='-')
>? ? ? ? ? e2=multiplicativeExpression ->
>? ? ? ? ? BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree])?
>? ? ???;
> 
>? ???(I've corrected where it should be a question mark, not * - * would
>? ???accept chained expressions, but the tree rewrite would be awkward)
> 
>? ???If the subrule matches, the rewrite (which I don't quite understand)
>? ???applies. If it doesn't, then the default (just emit the token as a
>? ???single node) takes place.
> 
>? ???Your grammar doesn't appear to support expressions like
> 
>? ???3 + 4 - 5
>? ???or
>? ???2 * 3 / 5
> 
>? ???Sam
> 
>? ? ? > --- On *Fri, 8/7/09, Sam Barnett-Cormack
>? ???/<s.barnett-cormack at lancaster.ac.uk
>? ???<http://us.mc521.mail.yahoo.com/mc/compose?to=s.barnett-cormack at lancaster.ac.uk>>/*
>? ???wrote:
>? ? ? >
>? ? ? >
>? ? ? >? ???From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk
>? ???<http://us.mc521.mail.yahoo.com/mc/compose?to=s.barnett-cormack at lancaster.ac.uk>>
>? ? ? >? ???Subject: Re: [antlr-interest] could not even do k=1 for
>? ???decision xx;
>? ? ? >? ???reason: timed out
>? ? ? >? ???To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com
>? ???<http://us.mc521.mail.yahoo.com/mc/compose?to=tdjastrzebski at yahoo.com>>
>? ? ? >? ???Date: Friday, August 7, 2009, 2:30 PM
>? ? ? >
>? ? ? >? ???Tomasz Jastrzebski wrote:
>? ? ? >
>? ? ? >? ? ? > But the problem is that I cannot do that since I need to catch
>? ? ? >? ???reference to each expression and operator to build nice AST tree.
>? ? ? >? ???The real code looks more like this:
>? ? ? >? ? ? >? additiveExpression
>? ? ? >? ? ? >? : e1=multiplicativeExpression (o='+' | o='-')
>? ? ? >? ???e2=multiplicativeExpression ->
>? ? ? >? ???BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree, $e2.tree]
>? ? ? >? ? ? >? | multiplicativeExpression
>? ? ? >? ? ? >? ;
>? ? ? >
>? ? ? >? ???Still left-factor it.
>? ? ? >
>? ? ? >? ???additiveExpression
>? ? ? >? ? ???: e1=multiplicativeExpression ((o='+'|o='-')
>? ? ? >? ???e2=multiplicativeExpression ->
>? ? ? >? ???BINARY_EXPRESSION<BinaryExpression>[$o.text, $e1.tree,
>? ???$e2.tree])*
>? ? ? >? ? ???;
>? ? ? >
>? ? ? >? ???This means that the output expression is only considered if the
>? ? ? >? ???optional subrule matches - otherwise it uses the default output
>? ? ? >? ???(just e1).
>? ? ? >
>? ? ? >? ???-- Sam Barnett-Cormack
>? ? ? >
>? ? ? >
> 
> 
>? ???-- Sam Barnett-Cormack
> 
> 


-- Sam Barnett-Cormack



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090808/556083d1/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Sat Aug  8 11:50:14 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Sat, 08 Aug 2009 19:50:14 +0100
Subject: [antlr-interest] could not even do k=1 for decision xx;
 reason: timed out
In-Reply-To: <912030.24878.qm@web52108.mail.re2.yahoo.com>
References: <912030.24878.qm@web52108.mail.re2.yahoo.com>
Message-ID: <4A7DC8E6.6000202@lancaster.ac.uk>

Tomasz Jastrzebski wrote:
> Thanks.
>  
> Now I understand that the only reasonable such declaration must look like:
>  
> multExpr
>  : primaryExpr (('*' | '/') primaryExpr)*
>  ;
>  
> After adding rewrite rules this may look like that:
> addExpr
>  : (multExpr -> multExpr) ( (o='+' | o='-') e=multExpr -> ^($o $addExpr 
> $e) )*
>  ;
> multExpr
>  : (primaryExpr -> primaryExpr) ( (o='*' | o='/') e=primaryExpr -> ^($o 
> $multExpr $e) )*
>  ;
>  
> (tested, it works)

Well, you don't need "-> primaryExpr" in the first subrule there - it's 
implicit. To make your tree nodes binary only, I don't think you can use 
EBNF like that, I think you'll need to use recursion. After all, you want

3 + 2 - 4

to produce a tree like

    +
   / \
  3   -
     / \
    2   4

(Whether the - or + is at the root doesn't matter)

I don't think this is possible with just EBNF constructs. You need it to 
parse 2-4 as an expression that produces a subtree, and that expression 
be picked up by the match of the + operator. Alternatively, you could 
produce a non-binary tree like

     +
    /|\
   3 2 -4

Because subtraction is associative, this is viable. Same for 
multiplication/division, with  '/ a' becoming '* a^-1', if you care to 
model them via inverses as is typical in group/ring theory in 
mathematics. Personally, I think a binary tree is cleaner, but you have 
to do something much cleverer than normal EBNF to produce that, AFAICT.

> I would think that now I can simply replace:
> -> ^($o $addExpr $e)
> with
> -> ^(BIN_EXPR<BinaryExpression>[o.text, $addExpr.tree, $e.tree]>)
>  
> - but not. $addExpr.tree in the second version is always NIL.

Well, $addExpr is the result of the current parser rule, as that 
expression appears to appear in the addExpr: rule. Of course it's going 
to produce odd results.

-- 
Sam Barnett-Cormack


From tdjastrzebski at yahoo.com  Sat Aug  8 12:47:47 2009
From: tdjastrzebski at yahoo.com (Tomasz Jastrzebski)
Date: Sat, 8 Aug 2009 12:47:47 -0700 (PDT)
Subject: [antlr-interest] could not even do k=1 for decision xx;
	reason: timed out
In-Reply-To: <4A7DC8E6.6000202@lancaster.ac.uk>
Message-ID: <374600.8596.qm@web52104.mail.re2.yahoo.com>

This approach was borrowed right from Terence's book, page 187. He even stated that it looked odd, but made sense - explanation follows.?Anyway, I tested it. With rewrite like (multExpr -> multExpr) it works as expected, without it does not.
?
The point is that I need binary tree. Rewrite like:
?
multExpr
?: primaryExpr ((o='*' | o='/') e=primaryExpr -> ^($o $e) )*
?;
?
or:

multExpr
?: (primaryExpr -> primaryExpr) ( (o='*' | o='/') e=primaryExpr -> ^($o $multExpr $e) )*
?;
?
produces desired default AST binary tree. Just how modify it so it builds my binary tree...
I cannot figure this out.
?
Thanks,
?
Tomasz

--- On Sat, 8/8/09, Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk> wrote:


From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
Subject: Re: [antlr-interest] could not even do k=1 for decision xx; reason: timed out
To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>
Cc: "antlr-interest" <antlr-interest at antlr.org>
Date: Saturday, August 8, 2009, 2:50 PM


Tomasz Jastrzebski wrote:
> Thanks.
>? Now I understand that the only reasonable such declaration must look like:
>? multExpr
>? : primaryExpr (('*' | '/') primaryExpr)*
>? ;
>? After adding rewrite rules this may look like that:
> addExpr
>? : (multExpr -> multExpr) ( (o='+' | o='-') e=multExpr -> ^($o $addExpr $e) )*
>? ;
> multExpr
>? : (primaryExpr -> primaryExpr) ( (o='*' | o='/') e=primaryExpr -> ^($o $multExpr $e) )*
>? ;
>? (tested, it works)

Well, you don't need "-> primaryExpr" in the first subrule there - it's implicit. To make your tree nodes binary only, I don't think you can use EBNF like that, I think you'll need to use recursion. After all, you want

3 + 2 - 4

to produce a tree like

???+
? / \
3???-
? ? / \
???2???4

(Whether the - or + is at the root doesn't matter)

I don't think this is possible with just EBNF constructs. You need it to parse 2-4 as an expression that produces a subtree, and that expression be picked up by the match of the + operator. Alternatively, you could produce a non-binary tree like

? ? +
???/|\
? 3 2 -4

Because subtraction is associative, this is viable. Same for multiplication/division, with? '/ a' becoming '* a^-1', if you care to model them via inverses as is typical in group/ring theory in mathematics. Personally, I think a binary tree is cleaner, but you have to do something much cleverer than normal EBNF to produce that, AFAICT.

> I would think that now I can simply replace:
> -> ^($o $addExpr $e)
> with
> -> ^(BIN_EXPR<BinaryExpression>[o.text, $addExpr.tree, $e.tree]>)
>? - but not. $addExpr.tree in the second version is always NIL.

Well, $addExpr is the result of the current parser rule, as that expression appears to appear in the addExpr: rule. Of course it's going to produce odd results.

-- Sam Barnett-Cormack




      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090808/b9a66e55/attachment.html 

From spam_dumpster2 at cox.net  Sat Aug  8 15:09:00 2009
From: spam_dumpster2 at cox.net (Spam Dumpster)
Date: Sat, 08 Aug 2009 15:09:00 -0700
Subject: [antlr-interest] antlr-2.7.3 and CPP_parser_v_3.2 grammar
Message-ID: <20090808220914.GUGR26994.fed1rmmtao102.cox.net@fed1rmimpo03.cox.net>

Greetings,

I a new to ANTLR and I am attempting to use David Wigg's C++ v3.2
grammar with ANTLR 2.7.3.  However, I get errors when I
parse his example (i.e., "Quadratic.i") or another simple C++
class.

I've tried setting things up several times, but I think I'm still
overlooking something.  I am wondering if anyone else has had a similar
problem and can point me in the right direction.

Regards,
Bob

-----------------------------------------------------------------------

- I'm using Visual C++ 6.0 with Windows XP SP3.

- This is the content of the simple C++ class file, temp.cpp.

class X {
public:
     X() : x(0) { }
     ~X {}
     int f() { return (++x);  }
     int x;
};

- These messages were printed to cerr:

cerr test.cpp:4:5: unexpected token: ~
cerr test.cpp:4:6: unexpected token: X
cerr test.cpp:4:8: expecting RCURLY, found '{'
cerr test.cpp:5:13: unexpected token: {
cerr test.cpp:5:30: expecting EOF, found '}'


*** Here is what I did to build the parser. ***

1. Extracted antlr-2.7.3.tar.gz into D:\Devel\antlr\antlr-2.7.3.

2. Initialized the CPP_parser Visual C++ project.
     a) Created a Visual c++ console application project called
        CPP_parser.

     b) This creates these directories:
         D:\Devel\antlr\CPP_parser
         D:\Devel\antlr\CPP_parser\Debug

     C) Project settings

        o C++ Tab
        - Precompiled headers
             Not using precompiled headers
        - Preprocessor
           Additional include directories:
             D:\Devel\antlr\antlr-2.7.3\lib\cpp

        o Link Tab
        - Object/library modules:
             added lib\src.lib
          (I haven't added the lib\src.lib file to the directory
          yet.)

        o Browse info tab
        - Build browse info file
             Checked

     D) Extracted CPP_parser_v_3.2.zip into
        D:\Devel\antlr\CPP_parser.


3. Creating the static ANTLR library.
     a) Created a Visual c++ static library project called "src."
        Pre-compiled header and MFC support were not checked.

     b) Project setttings

        o C++ Tab
        - Precompiled headers
             Not using precompiled headers
        - Preprocessor
           Additional include directories:
             C:\Program Files\Microsoft Visual Studio\VC98\Include,
             D:\Devel\antlr\antlr-2.7.3\lib\cpp

        o Library Tab
        - Output file name
             Debug\src.lib

        o Browse info tab
        - Build browse info file
             Checked

     C) Copied these files into
        D:\Devel\antlr\antlr-2.7.3\lib\cpp\antlr.
        - D:\Devel\antlr\CPP_parser\LLkParser.hpp
        - D:\Devel\antlr\CPP_parser\CharScanner.hpp

     D) Changed the tabsize(?) initializer in the three
        CharScanner constructors in
        D:\Devel\antlr\antlr-2.7.3\lib\cpp\src\CharScanner.cpp
        from tabsize(8) to tabsize(4).

     E) Copied the following files into
        D:\Devel\antlr\antlr-2.7.3\lib\cpp\src.
        - D:\Devel\antlr\CPP_parser\LLkParser.cpp
        - D:\Devel\antlr\CPP_parser\Parser.cpp

     F. Changed the name of the file dll.cpp in
        D:\Devel\antlr\antlr-2.7.3\lib\cpp\src\ to
        dll.cpp.saved.

     G. Added all of the *.cpp files in
        D:\Devel\antlr\antlr-2.7.3\lib\cpp\src\
        to the project.

     H. Clicked on the Build src.lib menu item.
        The library compiles with 3
        "C4355: 'this' : used in base member initializer list"
        warnings and compiles and builds with no errors.

     J. Copied Debug\src.lib to
        D:\Devel\antlr\CPP_parser\lib\src.lib.
        See 2.C "Link Tab" above.

4. Building the parser.

     A. Addedd D:\Devel\antlr\antlr-2.7.3\antlr.jar to the CLASSPATH
        environment variable.

     B. Entered the following commands in a console window:
        > D:
        > cd D:\Devel\antlr\CPP_parser
        > java antlr.Tool CPP_parser.g

     C. Added the following files to the CPP_parser Visual C++
        project.
        - CPPLexer.cpp
        - CPPParser.cpp
        - Dictionary.cpp
        - Main.cpp
        - MyCode.cpp
        - Support.cpp

     D. Clicked Build CPP_parser.exe
        The program compiles with 87
        "warning C4101: 'pe' : unreferenced local variable"
        warnings, and compiles and links with no errors.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090808/d1180af3/attachment.html 

From antlr at mirality.co.nz  Sat Aug  8 15:26:05 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 09 Aug 2009 10:26:05 +1200
Subject: [antlr-interest] could not even do k=1 for decision xx;
 reason: timed out
In-Reply-To: <912030.24878.qm@web52108.mail.re2.yahoo.com>
References: <4A7D551A.3090806@lancaster.ac.uk>
	<912030.24878.qm@web52108.mail.re2.yahoo.com>
Message-ID: <20090808222620.350603418453@www.antlr.org>

At 06:18 9/08/2009, Tomasz Jastrzebski wrote:
>Now I understand that the only reasonable such declaration must 
>look like:
>
>multExpr
>  : primaryExpr (('*' | '/') primaryExpr)*
>  ;

Actually, you *could* use this:
   multExpr
     : primaryExpr (('*' | '/') multExpr)?
     ;

The recursion would even make it easier to apply the rewrites as 
you want.  The downside of this is that it will only work properly 
for left-associative operators (unlike the original, which can be 
done either way).  Using the * is generally preferred practice 
though; avoids using up stack space :)

>After adding rewrite rules this may look like that:
>addExpr
>  : (multExpr -> multExpr) ( (o='+' | o='-') e=multExpr -> ^($o 
> $addExpr $e) )*
>  ;
>multExpr
>  : (primaryExpr -> primaryExpr) ( (o='*' | o='/') e=primaryExpr 
> -> ^($o $multExpr $e) )*
>  ;

Yes, this is a good way to do it.

>I would think that now I can simply replace:
>-> ^($o $addExpr $e)
>with
>-> ^(BIN_EXPR<BinaryExpression>[o.text, $addExpr.tree, $e.tree]>)
>
>- but not. $addExpr.tree in the second version is always NIL.

Have you tried just using $addExpr instead of $addExpr.tree?  (Not 
sure if that's valid, but it's worth trying.)  Also, your o.text 
should be $o.text; although you're going to lose some context in 
your tree by not keeping the full token objects.


From tdjastrzebski at yahoo.com  Sat Aug  8 18:48:00 2009
From: tdjastrzebski at yahoo.com (Tomasz Jastrzebski)
Date: Sat, 8 Aug 2009 18:48:00 -0700 (PDT)
Subject: [antlr-interest] could not even do k=1 for decision xx;
	reason: timed out
Message-ID: <666341.27235.qm@web52109.mail.re2.yahoo.com>

I tried replacing:
-> ^($o $addExpr $e)

with:
-> ^(BIN_EXPR<BinaryExpression>[$o.text, $addExpr, $e.tree]>) // instead of $addExpr.tree

but the tool (at least ver 3.1.1) dooes not allow this - error(117):?missing attribute access on rule scope. Anyway, $addExpr is of type addExpr_return.
?
I do not know. This may be a bug.
?
Tomasz


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090808/d5933f43/attachment.html 

From antlr at mirality.co.nz  Sat Aug  8 18:56:14 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 09 Aug 2009 13:56:14 +1200
Subject: [antlr-interest] could not even do k=1 for decision xx;
 reason: timed out
In-Reply-To: <666341.27235.qm@web52109.mail.re2.yahoo.com>
References: <666341.27235.qm@web52109.mail.re2.yahoo.com>
Message-ID: <20090809015625.730553418453@www.antlr.org>

At 13:48 9/08/2009, Tomasz Jastrzebski wrote:
>I tried replacing:
>-> ^($o $addExpr $e)
>with:
>-> ^(BIN_EXPR<BinaryExpression>[$o.text, $addExpr, $e.tree]>) // 
>instead of $addExpr.tree
>but the tool (at least ver 3.1.1) dooes not allow this - 
>error(117): missing attribute access on rule scope. Anyway, 
>$addExpr is of type addExpr_return.
>
>I do not know. This may be a bug.

Maybe.  It does make a certain amount of sense for the 
intermediate tree result to not yet be assigned to the .tree 
field, though.  But there ought to be some way to get at it.

I guess in the meantime you could just hack in the variable name 
it uses in the generated code to track it (look near the end of 
the method to see what gets assigned to the .tree of 
addExpr_return).  Not ideal, but it should get you by.


From gwlist at grahamwideman.com  Sat Aug  8 19:08:05 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Sat, 08 Aug 2009 19:08:05 -0700
Subject: [antlr-interest] could not even do k=1 for decision  xx;
 reason: timed out
In-Reply-To: <666341.27235.qm@web52109.mail.re2.yahoo.com>
Message-ID: <4.1.20090808185817.01f6e210@grahamwideman.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090808/e7d0e2a9/attachment.html 

From antlr at mirality.co.nz  Sat Aug  8 20:09:24 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 09 Aug 2009 15:09:24 +1200
Subject: [antlr-interest] could not even do k=1 for decision  xx;
 reason: timed out
In-Reply-To: <4.1.20090808185817.01f6e210@grahamwideman.com>
References: <666341.27235.qm@web52109.mail.re2.yahoo.com>
	<4.1.20090808185817.01f6e210@grahamwideman.com>
Message-ID: <20090809030939.F1F193418383@www.antlr.org>

At 14:08 9/08/2009, Graham Wideman wrote:
>The basic issue is what the arguments to -> ^(NEWTOKEN[args] are 
>expected to be (ie: their types) and where such args can be 
>obtained from.

The arguments must match one of the available implementations of 
the tree adaptor's create method (with one extra parameter for the 
token type) -- unless you're using heterogeneous trees, as Tomasz 
was.  Then it's the constructor of the node type that 
matters.  Assuming you're using the standard nodes then you'll 
have these possibilities:

   no args: creates a blank token with the token type as its text
   [text]: creates a blank token with the specified text
   [token]: copies the specified token but changes its type
   [token, text]: copies the specified token but changes its type 
and text

>It wasn't clear to me if some form of this (eg: 
>$parserRule.something) should work... ie: should it be possible 
>to get a token from a parser rule?  Some further light on this 
>would be helpful.

You can use $rule.start and $rule.stop to get the start and end 
tokens of the range matched by a rule, or you can specify your own 
return values for a rule to return other specific tokens.  In both 
cases you need to be careful if the rule can successfully match no 
tokens at all (or not the one you're asking for).


From gwlist at grahamwideman.com  Sat Aug  8 20:32:30 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Sat, 08 Aug 2009 20:32:30 -0700
Subject: [antlr-interest] could not even do k=1 for decision  xx;
 reason: timed out
In-Reply-To: <200908090309.n7939dWQ003817@host2.fw2.com>
References: <4.1.20090808185817.01f6e210@grahamwideman.com>
	<666341.27235.qm@web52109.mail.re2.yahoo.com>
	<4.1.20090808185817.01f6e210@grahamwideman.com>
Message-ID: <4.1.20090808202738.058e84c8@grahamwideman.com>


>You can use $rule.start and $rule.stop to get the start and end 
>tokens of the range matched by a rule, 

Ah-HAH! Yes that makes a lot of sense, and obvious now that you point it out. Thanks!

> you need to be careful if the rule can successfully match no 
>tokens at all (or not the one you're asking for).

Yes, that worried me too.

-- Graham

From tdjastrzebski at yahoo.com  Sun Aug  9 05:17:07 2009
From: tdjastrzebski at yahoo.com (Tomasz Jastrzebski)
Date: Sun, 9 Aug 2009 05:17:07 -0700 (PDT)
Subject: [antlr-interest] could not even do k=1 for decision xx;
	reason: timed out
Message-ID: <569311.57680.qm@web52105.mail.re2.yahoo.com>

I did some more debugging. It seems that is exactly the case - during node construction:

-> ^(BIN_EXPR<BinaryExpression>[$o.text, $addExpr.tree, $e.tree]>)
?
$addExpr.tree is not assigned yet. It gets reassigned later.
?
Thanks for the pointer. I am gonna post a new subject.
?
Tomasz

--- On Sat, 8/8/09, Gavin Lambert <antlr at mirality.co.nz> wrote:


From: Gavin Lambert <antlr at mirality.co.nz>
Subject: Re: [antlr-interest] could not even do k=1 for decision xx; reason: timed out
To: "Tomasz Jastrzebski" <tdjastrzebski at yahoo.com>, "antlr-interest" <antlr-interest at antlr.org>
Date: Saturday, August 8, 2009, 9:56 PM


At 13:48 9/08/2009, Tomasz Jastrzebski wrote:
> I tried replacing:
> -> ^($o $addExpr $e)
> with:
> -> ^(BIN_EXPR<BinaryExpression>[$o.text, $addExpr, $e.tree]>) // instead of $addExpr.tree
> but the tool (at least ver 3.1.1) dooes not allow this - error(117): missing attribute access on rule scope. Anyway, $addExpr is of type addExpr_return.
> 
> I do not know. This may be a bug.

Maybe.? It does make a certain amount of sense for the intermediate tree result to not yet be assigned to the .tree field, though.? But there ought to be some way to get at it.

I guess in the meantime you could just hack in the variable name it uses in the generated code to track it (look near the end of the method to see what gets assigned to the .tree of addExpr_return).? Not ideal, but it should get you by.




      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090809/6a3ba4ea/attachment.html 

From ozalpismet at gmail.com  Sun Aug  9 18:18:29 2009
From: ozalpismet at gmail.com (Ismet Ozalp)
Date: Mon, 10 Aug 2009 04:18:29 +0300
Subject: [antlr-interest] Modifying Java Source
Message-ID: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>

Hello everybody,

I am a newbie; I am trying to modify java sources. What I am trying to do is

clear the codes in the methods and change them with one line of code

example method

    public void delete(T t) {
        PersistenceManager pm = PMF.get().getPersistenceManager();

        try {
            pm.deletePersistent(t);

        } finally {
            pm.close();
        }

    }

changed method

  public void delete(T t) {
    throw new UnsupportedOperationException();
  }

So i need to modify the grammar some how to do this for methods in the
source file
currently I am trying to do something with
http://www.antlr.org/grammar/1152141644268/Java.g
which is written by Terence Parr. But I am a little bit lost, if anybody can
point me to the right direction
where I can find more information or examples about how to achieve this, it
would be great....

Thank you very much
Ismet
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090810/8c9e51d1/attachment.html 

From parrt at cs.usfca.edu  Sun Aug  9 22:31:01 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 9 Aug 2009 22:31:01 -0700
Subject: [antlr-interest] Modifying Java Source
In-Reply-To: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>
References: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>
Message-ID: <C86A5062-CE15-44D6-AE4E-01DFAAD50AA6@cs.usfca.edu>

Hiya. Use the tokenrewrite stream and Java.g combo. add actions to  
replace between { } with new action. :)
Ter
On Aug 9, 2009, at 6:18 PM, Ismet Ozalp wrote:

> Hello everybody,
>
> I am a newbie; I am trying to modify java sources. What I am trying  
> to do is
>
> clear the codes in the methods and change them with one line of code
>
> example method
>
>     public void delete(T t) {
>         PersistenceManager pm = PMF.get().getPersistenceManager();
>
>         try {
>             pm.deletePersistent(t);
>
>         } finally {
>             pm.close();
>         }
>
>     }
>
> changed method
>
>   public void delete(T t) {
>     throw new UnsupportedOperationException();
>   }
>
> So i need to modify the grammar some how to do this for methods in  
> the source file
> currently I am trying to do something with http://www.antlr.org/grammar/1152141644268/Java.g
> which is written by Terence Parr. But I am a little bit lost, if  
> anybody can point me to the right direction
> where I can find more information or examples about how to achieve  
> this, it would be great....
>
> Thank you very much
> Ismet
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090809/7c687a5b/attachment.html 

From ozalpismet at gmail.com  Mon Aug 10 06:27:01 2009
From: ozalpismet at gmail.com (Ismet Ozalp)
Date: Mon, 10 Aug 2009 16:27:01 +0300
Subject: [antlr-interest] Modifying Java Source
In-Reply-To: <C86A5062-CE15-44D6-AE4E-01DFAAD50AA6@cs.usfca.edu>
References: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>
	<C86A5062-CE15-44D6-AE4E-01DFAAD50AA6@cs.usfca.edu>
Message-ID: <be77c8c90908100627v175ff547nfdc12036c36ba234@mail.gmail.com>

First of all thank you all for your fast comments on the subject.

Terence, after I created the tokenRewriteStream

JavaLexer javaLexer = new JavaLexer(new ANTLRFileStream(file));
TokenRewriteStream tokenRewriteStream = new TokenRewriteStream(javaLexer);

Are you suggesting me to find tokens between {} and replace them with the
tokens I want?
In that case how can I detect class definition and inner class definitions
because i don't want to replace them. Maybe I am not completely
understanding
your suggestion. I feel like telling the grammar skip method definitions but
yet i am not successful.  I am using antlr 3.1.3. Also TokenRewriteStream's
delete(int from, int to) seems not deleting the tokens in it's token list? I
am just calling tokenRewriteStream.delete(10,20) and the tokens are still
there? Thank you very much...

Regards,
Ismet


On Mon, Aug 10, 2009 at 8:31 AM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Hiya. Use the tokenrewrite stream and Java.g combo. add actions to replace
> between { } with new action. :)Ter
> On Aug 9, 2009, at 6:18 PM, Ismet Ozalp wrote:
>
> Hello everybody,
>
> I am a newbie; I am trying to modify java sources. What I am trying to do
> is
>
> clear the codes in the methods and change them with one line of code
>
> example method
>
>     public void delete(T t) {
>         PersistenceManager pm = PMF.get().getPersistenceManager();
>
>         try {
>             pm.deletePersistent(t);
>
>         } finally {
>             pm.close();
>         }
>
>     }
>
> changed method
>
>   public void delete(T t) {
>     throw new UnsupportedOperationException();
>   }
>
> So i need to modify the grammar some how to do this for methods in the
> source file
> currently I am trying to do something with
> http://www.antlr.org/grammar/1152141644268/Java.g
> which is written by Terence Parr. But I am a little bit lost, if anybody
> can point me to the right direction
> where I can find more information or examples about how to achieve this, it
> would be great....
>
> Thank you very much
> Ismet
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090810/adcd5085/attachment.html 

From Bayle-J at mgdis.fr  Mon Aug 10 09:09:48 2009
From: Bayle-J at mgdis.fr (Bayle Jonathan)
Date: Mon, 10 Aug 2009 18:09:48 +0200
Subject: [antlr-interest] Exception while debugging C# 2.0 with ANTLRWorks
	1.2.3
Message-ID: <B5FBE987BC901D4680B2268F2EDD0E6301902EF7@vpn.mgdis.fr>

Hi,

 

I am currently trying to debug a SQL grammar generated by ANTLR 3.1.3
with ANTLRWorks 1.2.3.

I have upgraded ANTLRWorks as explained in Readme.txt to make it
compliant with v 3.1.3.

I generate my lexer and parser files with "-debug" option. Then I launch
parsing under Visual Studio 2008, and finally I do a "Debug Remote"
under ANTLRWorks. All seems to work first. I was able to debug my
grammar with several .sql files. But sometimes, I get a :

java.lang.NumberFormatException: For input string: "False"

that is not handled by ANTLRWorks. Then the application freezes and I
have to stop debugging.

 

Do you have an idea to solve that issue ?

 

Cheers,

 

 

--

Jonathan Bayle
IUT Informatique Vannes

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090810/00349b13/attachment.html 

From parrt at cs.usfca.edu  Mon Aug 10 10:01:16 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 10 Aug 2009 10:01:16 -0700
Subject: [antlr-interest] Modifying Java Source
In-Reply-To: <be77c8c90908100627v175ff547nfdc12036c36ba234@mail.gmail.com>
References: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>
	<C86A5062-CE15-44D6-AE4E-01DFAAD50AA6@cs.usfca.edu>
	<be77c8c90908100627v175ff547nfdc12036c36ba234@mail.gmail.com>
Message-ID: <97DC2926-93A0-49D0-939B-979FFA49B0D7@cs.usfca.edu>

go to method definition in grammar. ask for tokens { and }. context is  
your key not simply scanning for tokens.
T
On Aug 10, 2009, at 6:27 AM, Ismet Ozalp wrote:

> First of all thank you all for your fast comments on the subject.
>
> Terence, after I created the tokenRewriteStream
>
> JavaLexer javaLexer = new JavaLexer(new ANTLRFileStream(file));
> TokenRewriteStream tokenRewriteStream = new  
> TokenRewriteStream(javaLexer);
>
> Are you suggesting me to find tokens between {} and replace them  
> with the tokens I want?
> In that case how can I detect class definition and inner class  
> definitions because i don't want to replace them. Maybe I am not  
> completely understanding
> your suggestion. I feel like telling the grammar skip method  
> definitions but yet i am not successful.  I am using antlr 3.1.3.  
> Also TokenRewriteStream's delete(int from, int to) seems not  
> deleting the tokens in it's token list? I am just calling  
> tokenRewriteStream.delete(10,20) and the tokens are still there?  
> Thank you very much...
>
> Regards,
> Ismet
>
>
> On Mon, Aug 10, 2009 at 8:31 AM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> Hiya. Use the tokenrewrite stream and Java.g combo. add actions to  
> replace between { } with new action. :)
> Ter
> On Aug 9, 2009, at 6:18 PM, Ismet Ozalp wrote:
>
>> Hello everybody,
>>
>> I am a newbie; I am trying to modify java sources. What I am trying  
>> to do is
>>
>> clear the codes in the methods and change them with one line of code
>>
>> example method
>>
>>     public void delete(T t) {
>>         PersistenceManager pm = PMF.get().getPersistenceManager();
>>
>>         try {
>>             pm.deletePersistent(t);
>>
>>         } finally {
>>             pm.close();
>>         }
>>
>>     }
>>
>> changed method
>>
>>   public void delete(T t) {
>>     throw new UnsupportedOperationException();
>>   }
>>
>> So i need to modify the grammar some how to do this for methods in  
>> the source file
>> currently I am trying to do something with http://www.antlr.org/grammar/1152141644268/Java.g
>> which is written by Terence Parr. But I am a little bit lost, if  
>> anybody can point me to the right direction
>> where I can find more information or examples about how to achieve  
>> this, it would be great....
>>
>> Thank you very much
>> Ismet
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090810/9f16f606/attachment.html 

From rob_dougan at sympatico.ca  Mon Aug 10 11:25:44 2009
From: rob_dougan at sympatico.ca (Rob Dougan)
Date: Mon, 10 Aug 2009 18:25:44 +0000
Subject: [antlr-interest] How do you create an adaptor in C# that allows you
 to extend CommonTree?
Message-ID: <COL121-W403B10D8C737396F8B10CE87060@phx.gbl>


I would like to add some stuff to the CommonTree node and hook it up using an adaptor,

I am not a java programmer and actually i am pretty new to ANTLR and C# as well ...

It just amounts to translating the following java snippet (thanks Terrence) into C#

 

java:

// An adaptor that tells ANTLR to build custom AST node (myAST)

public static TreeAdaptor anAdaptor = new CommonTreeAdaptor() {

    public Object create(Token token) {

        return new myAST(token);

    }

    public Object dupNode(Object obj) {

        if ( obj == null ) return null;

        return create(((myAST)obj).token);

    }

    public Object errorNode(TokenStream input,Token start,Token stop,RecognitionException ex) {

    return new myErrorNode(input,start,stop,ex);

    }

};

 

c#:

?

i am sure i will get this eventually but this must be a pretty common thing to do...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090810/4995c71a/attachment.html 

From parrt at cs.usfca.edu  Mon Aug 10 13:39:18 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 10 Aug 2009 13:39:18 -0700
Subject: [antlr-interest] Modifying Java Source
In-Reply-To: <be77c8c90908101238r745e1593me0210ceecc49e987@mail.gmail.com>
References: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>
	<C86A5062-CE15-44D6-AE4E-01DFAAD50AA6@cs.usfca.edu>
	<be77c8c90908100627v175ff547nfdc12036c36ba234@mail.gmail.com>
	<97DC2926-93A0-49D0-939B-979FFA49B0D7@cs.usfca.edu>
	<be77c8c90908101238r745e1593me0210ceecc49e987@mail.gmail.com>
Message-ID: <6437218A-D604-4644-A88D-EB2C0F075A6A@cs.usfca.edu>

do a replace not insert. get token index from '{' and '}'. label those  
tokens.
Ter
On Aug 10, 2009, at 12:38 PM, Ismet Ozalp wrote:

> Thanks again Terence.
>
> Ok I believe now I getting at least something correct
>
> i replaced the
> methodBody
>     :    block
>     ;
>
> With this
>
> methodBody
>     :    {
>             TokenRewriteStream input2 = (TokenRewriteStream) input;
>             input2.insertAfter(input.index(),"throw new  
> UnsupportedOperationException();");
>         }
>     ;
>
> and now i have throw new UnsupportedOperationException(); in methods  
> but how do i delete the existing codes in the methodBody?
>
> you said ask for { } how do i do that ? how can I find indexes of  
> { } in methodBody if I can find the index of them I can use replace  
> method and everything will be good.
>
> Regards,
> Ismet
>
>
> On Mon, Aug 10, 2009 at 8:01 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> go to method definition in grammar. ask for tokens { and }. context  
> is your key not simply scanning for tokens.
> T
>
> On Aug 10, 2009, at 6:27 AM, Ismet Ozalp wrote:
>
>> First of all thank you all for your fast comments on the subject.
>>
>> Terence, after I created the tokenRewriteStream
>>
>> JavaLexer javaLexer = new JavaLexer(new ANTLRFileStream(file));
>> TokenRewriteStream tokenRewriteStream = new  
>> TokenRewriteStream(javaLexer);
>>
>> Are you suggesting me to find tokens between {} and replace them  
>> with the tokens I want?
>> In that case how can I detect class definition and inner class  
>> definitions because i don't want to replace them. Maybe I am not  
>> completely understanding
>> your suggestion. I feel like telling the grammar skip method  
>> definitions but yet i am not successful.  I am using antlr 3.1.3.  
>> Also TokenRewriteStream's delete(int from, int to) seems not  
>> deleting the tokens in it's token list? I am just calling  
>> tokenRewriteStream.delete(10,20) and the tokens are still there?  
>> Thank you very much...
>>
>> Regards,
>> Ismet
>>
>>
>> On Mon, Aug 10, 2009 at 8:31 AM, Terence Parr <parrt at cs.usfca.edu>  
>> wrote:
>> Hiya. Use the tokenrewrite stream and Java.g combo. add actions to  
>> replace between { } with new action. :)
>> Ter
>> On Aug 9, 2009, at 6:18 PM, Ismet Ozalp wrote:
>>
>>> Hello everybody,
>>>
>>> I am a newbie; I am trying to modify java sources. What I am  
>>> trying to do is
>>>
>>> clear the codes in the methods and change them with one line of code
>>>
>>> example method
>>>
>>>     public void delete(T t) {
>>>         PersistenceManager pm = PMF.get().getPersistenceManager();
>>>
>>>         try {
>>>             pm.deletePersistent(t);
>>>
>>>         } finally {
>>>             pm.close();
>>>         }
>>>
>>>     }
>>>
>>> changed method
>>>
>>>   public void delete(T t) {
>>>     throw new UnsupportedOperationException();
>>>   }
>>>
>>> So i need to modify the grammar some how to do this for methods in  
>>> the source file
>>> currently I am trying to do something with http://www.antlr.org/grammar/1152141644268/Java.g
>>> which is written by Terence Parr. But I am a little bit lost, if  
>>> anybody can point me to the right direction
>>> where I can find more information or examples about how to achieve  
>>> this, it would be great....
>>>
>>> Thank you very much
>>> Ismet
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
>


From tomislav.adamic at gmail.com  Mon Aug 10 15:09:04 2009
From: tomislav.adamic at gmail.com (Adamic Tomislav)
Date: Tue, 11 Aug 2009 00:09:04 +0200
Subject: [antlr-interest]  C runtime and parser error reporting confusion
Message-ID: <8129e4430908101509o545b0b13rd34114788c88f547@mail.gmail.com>

Hi everybody...

I'm trying to override displayRecognitionError in C runtime for my
parser grammar. In my combined parser and lexer grammar file I have
following:

@parser::apifuncs {
	RECOGNIZER->displayRecognitionError = myDisplayRecognitionError;
}

In my code I have the implementation of myDisplayRecognitionError
which currently doesn't do anything smart except that it notifies me
it has been run:

.h file:

#ifdef __cplusplus
extern "C" {
#endif

//...
void myDisplayRecognitionError (pANTLR3_BASE_RECOGNIZER recognizer,
pANTLR3_UINT8 * tokenNames);
//...

#ifdef __cplusplus
}
#endif

.c file (compiled as C++):

#include <stdexcept>
//...
void myDisplayRecognitionError (pANTLR3_BASE_RECOGNIZER recognizer,
pANTLR3_UINT8 * tokenNames) {
    // Just a notification for now...
    throw std::logic_error();
}
//...

Now, I have two test strings for my parser. Both should triger
myDisplayRecognitionError. First one "somethingsomething" actually
does. Second one being "something2something" passes without triggering
myDisplayRecognitionError and gets parsed as "2" beacause my grammar
recognizes numbers. This is not what I want, the second one should
trigger error also. Things marked here as "something" can be anything
that is not defined by my grammar. I've been searching through
mailinglist archives but I just can't figure it out... What am I doing
wrong?

From jimi at temporal-wave.com  Mon Aug 10 16:03:55 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 10 Aug 2009 16:03:55 -0700
Subject: [antlr-interest] C runtime and parser error reporting confusion
In-Reply-To: <8129e4430908101509o545b0b13rd34114788c88f547@mail.gmail.com>
References: <8129e4430908101509o545b0b13rd34114788c88f547@mail.gmail.com>
Message-ID: <4A80A75B.7010906@temporal-wave.com>

Adamic Tomislav wrote:
> Hi everybody...
>
> I'm trying to override displayRecognitionError in C runtime for my
> parser grammar. In my combined parser and lexer grammar file I have
> following:
>
> @parser::apifuncs {
> 	RECOGNIZER->displayRecognitionError = myDisplayRecognitionError;
> }
>
> In my code I have the implementation of myDisplayRecognitionError
> which currently doesn't do anything smart except that it notifies me
> it has been run:
>
> .h file:
>
> #ifdef __cplusplus
> extern "C" {
> #endif
>
> //...
> void myDisplayRecognitionError (pANTLR3_BASE_RECOGNIZER recognizer,
> pANTLR3_UINT8 * tokenNames);
> //...
>
> #ifdef __cplusplus
> }
> #endif
>
> .c file (compiled as C++):
>
> #include <stdexcept>
> //...
> void myDisplayRecognitionError (pANTLR3_BASE_RECOGNIZER recognizer,
> pANTLR3_UINT8 * tokenNames) {
>     // Just a notification for now...
>     throw std::logic_error();
> }
> //...
>
> Now, I have two test strings for my parser. Both should triger
> myDisplayRecognitionError. First one "somethingsomething" actually
> does. Second one being "something2something" passes without triggering
> myDisplayRecognitionError and gets parsed as "2" beacause my grammar
> recognizes numbers. This is not what I want, the second one should
> trigger error also. Things marked here as "something" can be anything
> that is not defined by my grammar. I've been searching through
> mailinglist archives but I just can't figure it out... What am I doing
> wrong?
>   
I suspect that this is because of your grammar and nothing to do with 
the recognition error override. Fix your lexer/parser and you will get 
an error. For instance, do you have an EOF terminating the grammar rule 
you are calling? If not then ANTLR will just not recognize a token in 
error at certain points and stop. If you do have the EOF, then you must 
have some sequence that allows numbers, and either unrecognized tokens 
are coming through on a different channel or are being thrown out by the 
lexer and you are not ignoring lexer errors (you should not allow the 
lexer to generate errors in general).

You need to post your grammar, not your code to get some help here.

Jim

From parrt at cs.usfca.edu  Mon Aug 10 16:15:02 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 10 Aug 2009 16:15:02 -0700
Subject: [antlr-interest] released computer language translation chapter
Message-ID: <5AD8F480-C97E-419B-8874-9160D0BC253D@cs.usfca.edu>

Howdy.

I just added another chapter for the beta on translation to the  
language design patterns book:

http://pragprog.com/titles/tpdsl/language-design-patterns

The next chapter, will be out maybe this week on generating template- 
based output models.

The final chapter is short and explains the decision-making process  
concerning which patterns to choose and when. then we're done! ok,  
after the review process and editing etc. :)

Ter

From jimi at temporal-wave.com  Mon Aug 10 16:17:53 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 10 Aug 2009 16:17:53 -0700
Subject: [antlr-interest] C runtime and parser error reporting confusion
In-Reply-To: <4A80A75B.7010906@temporal-wave.com>
References: <8129e4430908101509o545b0b13rd34114788c88f547@mail.gmail.com>
	<4A80A75B.7010906@temporal-wave.com>
Message-ID: <4A80AAA1.20603@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090810/30698d3a/attachment.html 

From williamstw at gmail.com  Mon Aug 10 17:10:40 2009
From: williamstw at gmail.com (Tim Williams)
Date: Mon, 10 Aug 2009 20:10:40 -0400
Subject: [antlr-interest] Simple Tree Rewrite help
In-Reply-To: <897D53A4-3D0D-4841-AF9B-2B5089354666@temporal-wave.com>
References: <499888440907290825u31ce02fepacae90252136ff50@mail.gmail.com>
	<897D53A4-3D0D-4841-AF9B-2B5089354666@temporal-wave.com>
Message-ID: <499888440908101710o765ad385yfbeeb9a4cd8a2842@mail.gmail.com>

Thanks Jim,
 I actually get an error "cannot write to read only attribute:
$t.type" if I use your solution.

--tim

On Wed, Jul 29, 2009 at 1:07 PM, Jim Idle<jimi at temporal-wave.com> wrote:
> Just change the type of the token and don't use rewrites. It is simpler that
> way (assuming you add comments! ;)
>
>
> (t=OR_TOK^ { $t.type = OR; } ...
>
>
> Jim
>
> On Jul 29, 2009, at 5:25 AM, Tim Williams <williamstw at gmail.com> wrote:
>
>> I'm trying to get a tree rewrite version of something like this:
>>
>> query: ?LPAREN! expr (OR_TOK^ expr)+ RPAREN!;
>>
>> This seems to do what I want, but I need a tree rewrite version so
>> that I can send something other than OR_TOK as the root, namely an
>> normalized "OR" token. ?I've tried:
>>
>> -> ^(OR expr expr)+;
>>
>> with no luck.
>>
>> Any help appreciated,
>>
>> Thanks,
>> --tim
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From benblo+ANTLR at gmail.com  Tue Aug 11 15:26:52 2009
From: benblo+ANTLR at gmail.com (Benoit Fouletier)
Date: Wed, 12 Aug 2009 00:26:52 +0200
Subject: [antlr-interest] extracting invocations from an expression
Message-ID: <b02eee6b0908111526u1c790dc3ge21a621f2da4de4d@mail.gmail.com>

I have cascading rules that define operator precedence in an expression
(taken from the C# parser example), like so:
*           thisLevelExpression :*
*               nextHigherPrecedenceExpression (OPERATOR
nextHigherPrecedenceExpression)* ;*

I managed to isolate where method invocation takes place, and now I'd like
to insert some tokens to wrap around specific invocations, so that:

*a.b().c()*

would be translated to:

*[invoke: [invoke: a.b() ].c() ]*

or something like that.

It seems to me like I should follow the precedence pattern to insert a new
rule, unfortunately the invocation part is at the end of the precedence
chain, so I can't figure out how.
Here are the rules I've isolated:

*primaryExpression*
* **:** **basicPrimaryExpression*
* **(** **options { greedy = true; } : *
* **(** **LPAREN argumentList? RPAREN** **// invocationExpression <---- THIS
IS THE ONE!!*
* **|** **LBRACK expressionList RBRACK** **// elementAccess*
* **|** **DOT identifier** **// memberAccess*
* **|** **INC ** **// postIncrementExpression*
* **|** **DEC** **// postDecrementExpression*
* **)*
* **)**
* **;*
*
*
*basicPrimaryExpression*
* **:** **literal*
* **|** **identifier** **// simpleName*
* **|** **LPAREN assignmentExpression RPAREN** **// parenthesizedExpression*
* **|** **THIS** **// thisAccess*
* **|** **newExpression*
* **;*


Sorry for the cry for help, my brain is in total meltdown at the moment...

        Ben
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/a923f0e7/attachment.html 

From achintmehta at gmail.com  Tue Aug 11 22:34:05 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Wed, 12 Aug 2009 01:34:05 -0400
Subject: [antlr-interest] Extracting a string whose value clashes with token
	value
Message-ID: <4a3315250908112234t27ab360bm3d5a842920ed52fa@mail.gmail.com>

Hi,

I am stuck at a seemingly trivial problem.
I have written a simplified sample grammar which has this issue.

In the grammar I have a rule to extract a generic string
special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;

and a token ANTLR which is defined as:
ANTLRTOKEN:'ANTLR';

A rule which parses two words ( the first of which has to be ANTLR is
defined as follows):
requestline : ANTLRTOKEN WHITESPACE special_string ;

It seems that if the input word begins with keyword "ANTLR", then that word
is treated as it is beginning with ANTLRTOKEN and passed to the parser.
i.e. an input text "ANTLR ANTLRWORKS",  loosely seems to be treated as
sequence of
ANTLRTOKEN WHITESPACE ANTLRTOKEN special_string

The whole grammar file is as follows: (This grammer simply parses any word
followed by the keyword ANTLR)
-----------------------------------------------------------------------------
grammar sample_parser;

options
{
    language=C;
}

requestline : ANTLRTOKEN WHITESPACE special_string ;
special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;

WHITESPACE  : ( '\t' | ' ' | '\u000C' )+;
NEWLINE: ('\r')? '\n';
CHAR: (('a'..'z')|('A'..'Z'));
ANTLRTOKEN:'ANTLR';
-----------------------------------------------------------------------------

If i provide the input as
ANTLR WORKS

Then everything works  fine and I don't get any error.

Now if I provide the input as
ANTLR ANTLRWORKS
Then I get the error as
----------------------------------------------------------------------------
input(1)  : error 5 : Unexpected token, at offset 5
    near [Index: 2 (Start: 24666934-Stop: 24666938) ='ANTLR', type<4> Line:
1 LinePos:5]
     : missing elements...
----------------------------------------------------------------------------

Seems that the lexer treats the sub-string ANTLR in ANTLRWORKS as the token
ANTLRTOKEN and passes it to parser which is not expecting that token.

Is there a way to tell antlr to not to break the input word ANTLRWORKS into
token and treat the whole word as special_string ?

Can somebody help me getting around this issue ?

Thanks in advance.

Also, I am using the following version of the library, etc.
java version "1.6.0_14"
ANTLR version 3.1.3
Target language : C
C runtime library version: 3.1.3
gcc compiler: 4.3.3 (Ubuntu 4.3.3-5ubuntu4)


Regards,
Achint
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/53c0f40d/attachment.html 

From david-sarah at jacaranda.org  Tue Aug 11 23:09:30 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Wed, 12 Aug 2009 07:09:30 +0100
Subject: [antlr-interest] Tabs in browsable source files generated by doxygen
Message-ID: <4A825C9A.4050504@jacaranda.org>

The ANTLR source code is written with a tab stop distance of 4 and a
mixture of spaces and tabs, but doxygen seems to be assuming a tab stop
distance of 8 when generating the HTML for source code files.
This leads to ugliness such as the following example in
<http://www.antlr.org/api/Java/_common_token_stream_8java-source.html>:

00133         public void consume() {
00134                 if ( p<tokens.size() ) {
00135             p++;
00136                         p = skipOffTokenChannels(p); // leave p on
valid token
00137         }
00138     }

The fix for this is to put "TAB_SIZE = 4" in the doxygen config file
(see http://www.stack.nl/~dimitri/doxygen/config.html).

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From benblo+ANTLR at gmail.com  Tue Aug 11 23:10:37 2009
From: benblo+ANTLR at gmail.com (Benoit Fouletier)
Date: Wed, 12 Aug 2009 08:10:37 +0200
Subject: [antlr-interest] Extracting a string whose value clashes with
	token value
In-Reply-To: <4a3315250908112234t27ab360bm3d5a842920ed52fa@mail.gmail.com>
References: <4a3315250908112234t27ab360bm3d5a842920ed52fa@mail.gmail.com>
Message-ID: <b02eee6b0908112310w72af1a98nef06d21628d8816c@mail.gmail.com>

I think special_string should be a lexer rule, not a parser rule: rename it
to SPECIAL_STRING.Also, the lexer depends on the order with which you define
tokens, so make sure you put ANTLRTOKEN  above SPECIAL_STRING.


On Wed, Aug 12, 2009 at 7:34 AM, Achint Mehta <achintmehta at gmail.com> wrote:

>
> Hi,
>
> I am stuck at a seemingly trivial problem.
> I have written a simplified sample grammar which has this issue.
>
> In the grammar I have a rule to extract a generic string
> special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;
>
> and a token ANTLR which is defined as:
> ANTLRTOKEN:'ANTLR';
>
> A rule which parses two words ( the first of which has to be ANTLR is
> defined as follows):
> requestline : ANTLRTOKEN WHITESPACE special_string ;
>
> It seems that if the input word begins with keyword "ANTLR", then that word
> is treated as it is beginning with ANTLRTOKEN and passed to the parser.
> i.e. an input text "ANTLR ANTLRWORKS",  loosely seems to be treated as
> sequence of
> ANTLRTOKEN WHITESPACE ANTLRTOKEN special_string
>
> The whole grammar file is as follows: (This grammer simply parses any word
> followed by the keyword ANTLR)
>
> -----------------------------------------------------------------------------
> grammar sample_parser;
>
> options
> {
>     language=C;
> }
>
> requestline : ANTLRTOKEN WHITESPACE special_string ;
> special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;
>
> WHITESPACE  : ( '\t' | ' ' | '\u000C' )+;
> NEWLINE: ('\r')? '\n';
> CHAR: (('a'..'z')|('A'..'Z'));
> ANTLRTOKEN:'ANTLR';
>
> -----------------------------------------------------------------------------
>
> If i provide the input as
> ANTLR WORKS
>
> Then everything works  fine and I don't get any error.
>
> Now if I provide the input as
> ANTLR ANTLRWORKS
> Then I get the error as
>
> ----------------------------------------------------------------------------
> input(1)  : error 5 : Unexpected token, at offset 5
>     near [Index: 2 (Start: 24666934-Stop: 24666938) ='ANTLR', type<4> Line:
> 1 LinePos:5]
>      : missing elements...
>
> ----------------------------------------------------------------------------
>
> Seems that the lexer treats the sub-string ANTLR in ANTLRWORKS as the token
> ANTLRTOKEN and passes it to parser which is not expecting that token.
>
> Is there a way to tell antlr to not to break the input word ANTLRWORKS into
> token and treat the whole word as special_string ?
>
> Can somebody help me getting around this issue ?
>
> Thanks in advance.
>
> Also, I am using the following version of the library, etc.
> java version "1.6.0_14"
> ANTLR version 3.1.3
> Target language : C
> C runtime library version: 3.1.3
> gcc compiler: 4.3.3 (Ubuntu 4.3.3-5ubuntu4)
>
>
> Regards,
> Achint
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/3fde1c6f/attachment.html 

From weeliyen at hotmail.com  Tue Aug 11 23:32:00 2009
From: weeliyen at hotmail.com (Wee Li Yen)
Date: Wed, 12 Aug 2009 14:32:00 +0800
Subject: [antlr-interest] [antlrworks] Invaild or corrupt jarfile
Message-ID: <BAY114-DS7768554D6680C32295A37CF040@phx.gbl>

Hi,

Why is it that I get "Invaild or corrupt jarfile antlrworks-1.2.3.jar " when I use the downloaded version from http://www.antlr.org/works/index.html? I get a similar message with antlrworks-1.3b. Both of them can't be opened with just double click, so I used the cmd.


Regards,
yeeen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/0974bf99/attachment.html 

From david-sarah at jacaranda.org  Wed Aug 12 00:01:59 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Wed, 12 Aug 2009 08:01:59 +0100
Subject: [antlr-interest] Extracting a string whose value clashes with
 token value
In-Reply-To: <b02eee6b0908112310w72af1a98nef06d21628d8816c@mail.gmail.com>
References: <4a3315250908112234t27ab360bm3d5a842920ed52fa@mail.gmail.com>
	<b02eee6b0908112310w72af1a98nef06d21628d8816c@mail.gmail.com>
Message-ID: <4A8268E7.3040201@jacaranda.org>

Benoit Fouletier wrote:
> I think special_string should be a lexer rule, not a parser rule: rename it
> to SPECIAL_STRING. Also, the lexer depends on the order with which you define
> tokens, so make sure you put ANTLRTOKEN  above SPECIAL_STRING.

This will work, but it will generate ambiguity warnings (because "ANTLR"
can be lexed either as an ANTLRTOKEN or a SPECIAL_STRING). To eliminate
the warning and make the intent clear, put ANTLRTOKEN in a 'tokens' block,
i.e.:

  grammar sample_parser;

  options {
    language=C;
  }

  tokens {
    ANTLRTOKEN = 'ANTLR';
  }

  requestline : ANTLRTOKEN WHITESPACE special_string ;

  SPECIAL_STRING : (CHAR | '=' | '.' | '-' | '@' )+ ;
  WHITESPACE  : ( '\t' | ' ' | '\u000C' )+;
  NEWLINE: ('\r')? '\n';
  fragment CHAR: (('a'..'z')|('A'..'Z'));


Note that it is necessary to change CHAR to a fragment rule if
SPECIAL_STRING is a lexer rule (which I agree it probably should be).

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From Bayle-J at mgdis.fr  Wed Aug 12 05:47:15 2009
From: Bayle-J at mgdis.fr (Bayle Jonathan)
Date: Wed, 12 Aug 2009 14:47:15 +0200
Subject: [antlr-interest] Exception while debugging C# 2.0 with
	ANTLRWorks1.2.3
References: <B5FBE987BC901D4680B2268F2EDD0E6301902EF7@vpn.mgdis.fr>
Message-ID: <B5FBE987BC901D4680B2268F2EDD0E6301902F90@vpn.mgdis.fr>

Hi everybody,

 

I have identified which piece of code returns ? False ? (and sometimes ? True ?) and make ANTLRWorks throw a "java.lang.NumberFormatException".

It is the result of 2 semantic predicates embedded in the same rule :

 

// beginning of rule (...)

      | {input.LA(1) == MY_TOKEN}? // (...) First production

| {input.LA(1) != MY_TOKEN}? // (...) Second production

// (...) end of rule

;

 I am used to work with ANTLR 2.7.7, so this syntax may be wrong under ANTLR 3.1.3.

Could anybody help me please ?

 

 

--

Jonathan Bayle
IUT Informatique Vannes

________________________________

De : antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] De la part de Bayle Jonathan
Envoy? : lundi 10 ao?t 2009 18:10
? : antlr-interest at antlr.org
Objet : [antlr-interest] Exception while debugging C# 2.0 with ANTLRWorks1.2.3

 

Hi,

 

I am currently trying to debug a SQL grammar generated by ANTLR 3.1.3 with ANTLRWorks 1.2.3.

I have upgraded ANTLRWorks as explained in Readme.txt to make it compliant with v 3.1.3.

I generate my lexer and parser files with "-debug" option. Then I launch parsing under Visual Studio 2008, and finally I do a "Debug Remote" under ANTLRWorks. All seems to work first. I was able to debug my grammar with several .sql files. But sometimes, I get a :

java.lang.NumberFormatException: For input string: "False"

that is not handled by ANTLRWorks. Then the application freezes and I have to stop debugging.

 

Do you have an idea to solve that issue ?

 

Cheers,

 

 

--

Jonathan Bayle
IUT Informatique Vannes

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/b7babd8b/attachment.html 

From jimi at temporal-wave.com  Wed Aug 12 06:59:20 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 06:59:20 -0700
Subject: [antlr-interest] Extracting a string whose value clashes with
 token value
In-Reply-To: <4A8268E7.3040201@jacaranda.org>
References: <4a3315250908112234t27ab360bm3d5a842920ed52fa@mail.gmail.com>	<b02eee6b0908112310w72af1a98nef06d21628d8816c@mail.gmail.com>
	<4A8268E7.3040201@jacaranda.org>
Message-ID: <4A82CAB8.5020301@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/8123e637/attachment.html 

From jimi at temporal-wave.com  Wed Aug 12 07:06:02 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 07:06:02 -0700
Subject: [antlr-interest] Exception while debugging C# 2.0
	with	ANTLRWorks1.2.3
In-Reply-To: <B5FBE987BC901D4680B2268F2EDD0E6301902F90@vpn.mgdis.fr>
References: <B5FBE987BC901D4680B2268F2EDD0E6301902EF7@vpn.mgdis.fr>
	<B5FBE987BC901D4680B2268F2EDD0E6301902F90@vpn.mgdis.fr>
Message-ID: <4A82CC4A.2010202@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/ef937618/attachment.html 

From rohnsorg at student.ethz.ch  Wed Aug 12 07:06:04 2009
From: rohnsorg at student.ethz.ch (Ohnsorg  Reto)
Date: Wed, 12 Aug 2009 16:06:04 +0200
Subject: [antlr-interest] Eiffel grammar with Antlr v3
Message-ID: <092BC5B8FA15D64087C5354BFC494E8E0D2666@EX3.d.ethz.ch>

Hi 
 
As a newbie I'm trying to use the Eiffel grammar (found in the grammar section) and compile it. Unfortunately I couldn't migrate it with the v2v3 tool because an error occurs (NoSuchFieldError). Has anyone used the existing Eiffel grammar successfully either with version v2 or v3? Thanks for any help in advance
 
Reto

From yurushkin at rambler.ru  Wed Aug 12 07:18:39 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Wed, 12 Aug 2009 18:18:39 +0400
Subject: [antlr-interest] tokens in parser grammar
Message-ID: <op.uyjzddmnt3jqlu@win-mupvrp0jyrf>

Good day,
Is it possible to write the following:
"int_literal: CHAR_STRING "_" kind ..."

or I must specify the token UNDERSCORE in lexer grammar and write

"int_literal: CHAR_STRING UNDERSCORE kind ...".

C target. Last version of Antlr

-- 
Best regards,
Michael

From s.barnett-cormack at lancaster.ac.uk  Wed Aug 12 07:25:51 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Wed, 12 Aug 2009 15:25:51 +0100
Subject: [antlr-interest] tokens in parser grammar
In-Reply-To: <op.uyjzddmnt3jqlu@win-mupvrp0jyrf>
References: <op.uyjzddmnt3jqlu@win-mupvrp0jyrf>
Message-ID: <4A82D0EF.1080308@lancaster.ac.uk>

??????? ?????? wrote:
> Good day,
> Is it possible to write the following:
> "int_literal: CHAR_STRING "_" kind ..."
> 
> or I must specify the token UNDERSCORE in lexer grammar and write
> 
> "int_literal: CHAR_STRING UNDERSCORE kind ...".
> 
> C target. Last version of Antlr

If it's a combined grammar, that'll work, but it's better in many ways 
to put it in the lexer as a token.

If the lexer and parser are separate, I believe it won't work.


-- 
Sam Barnett-Cormack

From Bayle-J at mgdis.fr  Wed Aug 12 07:25:55 2009
From: Bayle-J at mgdis.fr (Bayle Jonathan)
Date: Wed, 12 Aug 2009 16:25:55 +0200
Subject: [antlr-interest] Exception while debugging C#
	2.0with	ANTLRWorks1.2.3
References: <B5FBE987BC901D4680B2268F2EDD0E6301902EF7@vpn.mgdis.fr><B5FBE987BC901D4680B2268F2EDD0E6301902F90@vpn.mgdis.fr>
	<4A82CC4A.2010202@temporal-wave.com>
Message-ID: <B5FBE987BC901D4680B2268F2EDD0E6301902FA7@vpn.mgdis.fr>

Thank you for answering me, Jim.

 

In fact, the original rule seems to work well (as unit tests succeed). It is only when I use ANTLRWorks for debugging that I encounter this exception.

I'm working with SQL2 grammar written by Lubos Vnuk. My goal is to migrate it from v2 to v3.1.3.

The rule in question is <value_exp_primary> :

 

value_exp_primary : 

        set_fct_spec

      | case_exp 

      | cast_spec 

      | {input.LA(1) == INTRODUCER}? ((column_ref)=>column_ref | unsigned_value_spec)

      | {input.LA(1) != INTRODUCER}? column_ref

      | (LEFT_PAREN value_exp RIGHT_PAREN)=> LEFT_PAREN value_exp RIGHT_PAREN 

      | scalar_subquery 

;

 

Yes, Lubos Vnuk wrote this to disambiguate his grammar.

 

The java.lang.NumberFormatException occurs when I launch this test :

select*from a where a = substring ( 'abcdefgh' || 'ijkl' from 5-2 for 1*2);

 

It does not matter that ANTLRWorks could not handle this input. My true problem is that my lexer is not able to recognize 'abcdefgh' and 'ijkl', because of quotes... But it's not the same story :-)

 

 

 

--

Jonathan Bayle
Stagiaire IUT Informatique Vannes
MGDIS - D?partement Etudes et D?veloppement

________________________________

De : antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] De la part de Jim Idle
Envoy? : mercredi 12 ao?t 2009 16:06
Cc : antlr-interest at antlr.org
Objet : Re: [antlr-interest] Exception while debugging C# 2.0with ANTLRWorks1.2.3

 

Bayle Jonathan wrote: 

Hi everybody,

 

I have identified which piece of code returns ? False ? (and sometimes ? True ?) and make ANTLRWorks throw a "java.lang.NumberFormatException".

It is the result of 2 semantic predicates embedded in the same rule :

 

// beginning of rule (...)

      | {input.LA(1) == MY_TOKEN}? // (...) First production

| {input.LA(1) != MY_TOKEN}? // (...) Second production

// (...) end of rule

;

 I am used to work with ANTLR 2.7.7, so this syntax may be wrong under ANTLR 3.1.3.

Could anybody help me please ?

 

ON the face of it, it looks like yuo can just remove the predicates and 3.1 will work it out correctly. However you need to post the rule in question or we are just guessing. Another possibility is that you want gated predicates and just need that on the first production:

rule
  : {input.LA(1) == MY_TOKEN}?=>  ....
  | // second rpodcution
  ;

The only advantage to that though would be to prevent some kind of warning so I can't see that you need that.

Yet another possibility is that your predicates are just not correct, so, post the actual rule in error :-)

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/a7b4d56e/attachment.html 

From jimi at temporal-wave.com  Wed Aug 12 07:40:45 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 07:40:45 -0700
Subject: [antlr-interest] tokens in parser grammar
In-Reply-To: <op.uyjzddmnt3jqlu@win-mupvrp0jyrf>
References: <op.uyjzddmnt3jqlu@win-mupvrp0jyrf>
Message-ID: <4A82D46D.9030006@temporal-wave.com>

??????? ?????? wrote:
> Good day,
> Is it possible to write the following:
> "int_literal: CHAR_STRING "_" kind ..."
>   

Literals are single quoted.
> or I must specify the token UNDERSCORE in lexer grammar and write
>
> "int_literal: CHAR_STRING UNDERSCORE kind ...".
>   
It is much better to do this as then the lexer rules will be explicit as 
you won't get confused over ambiguities.
> C target. Last version of Antlr
>
>   
The target does not make a difference in this case, but thank you for 
mentioning this as it sometimes does :-)

Jim


From jimi at temporal-wave.com  Wed Aug 12 07:48:04 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 07:48:04 -0700
Subject: [antlr-interest] Exception while debugging
	C#	2.0with	ANTLRWorks1.2.3
In-Reply-To: <B5FBE987BC901D4680B2268F2EDD0E6301902FA7@vpn.mgdis.fr>
References: <B5FBE987BC901D4680B2268F2EDD0E6301902EF7@vpn.mgdis.fr><B5FBE987BC901D4680B2268F2EDD0E6301902F90@vpn.mgdis.fr>	<4A82CC4A.2010202@temporal-wave.com>
	<B5FBE987BC901D4680B2268F2EDD0E6301902FA7@vpn.mgdis.fr>
Message-ID: <4A82D624.7000709@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/5a5487a5/attachment.html 

From yurushkin at rambler.ru  Wed Aug 12 08:17:25 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Wed, 12 Aug 2009 19:17:25 +0400
Subject: [antlr-interest] tokens in parser grammar
Message-ID: <op.uyj13bqwt3jqlu@win-mupvrp0jyrf>

And additional question:

"
constant[BlockStatement *stmntBlock]
returns [ExpressionBase *resultConstant]
	: resultConstant = literal_constant    // this line is wrong. Name  
conflict with result value //
	| T_IDENT { resultConstant = action.constant($T_IDENT, stmntBlock); }
	;
" - isn't parded :(

: resultConstant = literal_constant    <-- this line is wrong. Name  
conflict with result value

what i do wrong?

-- 
Best regards,
Michael

From jimi at temporal-wave.com  Wed Aug 12 08:17:55 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 08:17:55 -0700
Subject: [antlr-interest] Available for contract work
Message-ID: <4A82DD23.3020004@temporal-wave.com>

If any of you have decided that your frustration levels are too high and 
would like to farm out your parser/compiler/? project then please let me 
know off list - I will be twiddling my thumbs after the Sun JVM Language 
conference in September.

Jim

From ozalpismet at gmail.com  Wed Aug 12 09:16:46 2009
From: ozalpismet at gmail.com (Ismet Ozalp)
Date: Wed, 12 Aug 2009 19:16:46 +0300
Subject: [antlr-interest] Modifying Java Source
In-Reply-To: <6437218A-D604-4644-A88D-EB2C0F075A6A@cs.usfca.edu>
References: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>
	<C86A5062-CE15-44D6-AE4E-01DFAAD50AA6@cs.usfca.edu>
	<be77c8c90908100627v175ff547nfdc12036c36ba234@mail.gmail.com>
	<97DC2926-93A0-49D0-939B-979FFA49B0D7@cs.usfca.edu>
	<be77c8c90908101238r745e1593me0210ceecc49e987@mail.gmail.com>
	<6437218A-D604-4644-A88D-EB2C0F075A6A@cs.usfca.edu>
Message-ID: <be77c8c90908120916j2d69f04ag4cb4492d99e91fdb@mail.gmail.com>

Thank you very much Terence I got everything working fine right now.

On Mon, Aug 10, 2009 at 11:39 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> do a replace not insert. get token index from '{' and '}'. label those
> tokens.
> Ter
>
> On Aug 10, 2009, at 12:38 PM, Ismet Ozalp wrote:
>
>  Thanks again Terence.
>>
>> Ok I believe now I getting at least something correct
>>
>> i replaced the
>> methodBody
>>    :    block
>>    ;
>>
>> With this
>>
>> methodBody
>>    :    {
>>            TokenRewriteStream input2 = (TokenRewriteStream) input;
>>            input2.insertAfter(input.index(),"throw new
>> UnsupportedOperationException();");
>>        }
>>    ;
>>
>> and now i have throw new UnsupportedOperationException(); in methods but
>> how do i delete the existing codes in the methodBody?
>>
>> you said ask for { } how do i do that ? how can I find indexes of { } in
>> methodBody if I can find the index of them I can use replace method and
>> everything will be good.
>>
>> Regards,
>> Ismet
>>
>>
>> On Mon, Aug 10, 2009 at 8:01 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>> go to method definition in grammar. ask for tokens { and }. context is
>> your key not simply scanning for tokens.
>> T
>>
>> On Aug 10, 2009, at 6:27 AM, Ismet Ozalp wrote:
>>
>>  First of all thank you all for your fast comments on the subject.
>>>
>>> Terence, after I created the tokenRewriteStream
>>>
>>> JavaLexer javaLexer = new JavaLexer(new ANTLRFileStream(file));
>>> TokenRewriteStream tokenRewriteStream = new
>>> TokenRewriteStream(javaLexer);
>>>
>>> Are you suggesting me to find tokens between {} and replace them with the
>>> tokens I want?
>>> In that case how can I detect class definition and inner class
>>> definitions because i don't want to replace them. Maybe I am not completely
>>> understanding
>>> your suggestion. I feel like telling the grammar skip method definitions
>>> but yet i am not successful.  I am using antlr 3.1.3. Also
>>> TokenRewriteStream's delete(int from, int to) seems not deleting the tokens
>>> in it's token list? I am just calling tokenRewriteStream.delete(10,20) and
>>> the tokens are still there? Thank you very much...
>>>
>>> Regards,
>>> Ismet
>>>
>>>
>>> On Mon, Aug 10, 2009 at 8:31 AM, Terence Parr <parrt at cs.usfca.edu>
>>> wrote:
>>> Hiya. Use the tokenrewrite stream and Java.g combo. add actions to
>>> replace between { } with new action. :)
>>> Ter
>>> On Aug 9, 2009, at 6:18 PM, Ismet Ozalp wrote:
>>>
>>>  Hello everybody,
>>>>
>>>> I am a newbie; I am trying to modify java sources. What I am trying to
>>>> do is
>>>>
>>>> clear the codes in the methods and change them with one line of code
>>>>
>>>> example method
>>>>
>>>>    public void delete(T t) {
>>>>        PersistenceManager pm = PMF.get().getPersistenceManager();
>>>>
>>>>        try {
>>>>            pm.deletePersistent(t);
>>>>
>>>>        } finally {
>>>>            pm.close();
>>>>        }
>>>>
>>>>    }
>>>>
>>>> changed method
>>>>
>>>>  public void delete(T t) {
>>>>    throw new UnsupportedOperationException();
>>>>  }
>>>>
>>>> So i need to modify the grammar some how to do this for methods in the
>>>> source file
>>>> currently I am trying to do something with
>>>> http://www.antlr.org/grammar/1152141644268/Java.g
>>>> which is written by Terence Parr. But I am a little bit lost, if anybody
>>>> can point me to the right direction
>>>> where I can find more information or examples about how to achieve this,
>>>> it would be great....
>>>>
>>>> Thank you very much
>>>> Ismet
>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe:
>>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>
>>>
>>>
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/37e155d5/attachment.html 

From parrt at cs.usfca.edu  Wed Aug 12 11:06:25 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 12 Aug 2009 11:06:25 -0700
Subject: [antlr-interest] Modifying Java Source
In-Reply-To: <be77c8c90908120916j2d69f04ag4cb4492d99e91fdb@mail.gmail.com>
References: <be77c8c90908091818m58c8f0c1o25a7bbc0b058addc@mail.gmail.com>
	<C86A5062-CE15-44D6-AE4E-01DFAAD50AA6@cs.usfca.edu>
	<be77c8c90908100627v175ff547nfdc12036c36ba234@mail.gmail.com>
	<97DC2926-93A0-49D0-939B-979FFA49B0D7@cs.usfca.edu>
	<be77c8c90908101238r745e1593me0210ceecc49e987@mail.gmail.com>
	<6437218A-D604-4644-A88D-EB2C0F075A6A@cs.usfca.edu>
	<be77c8c90908120916j2d69f04ag4cb4492d99e91fdb@mail.gmail.com>
Message-ID: <01FA6617-D3E2-4B15-A206-836DE4ADF2DB@cs.usfca.edu>

hooray! how about adding a FAQ entry to the wiki? :)
Ter
On Aug 12, 2009, at 9:16 AM, Ismet Ozalp wrote:

> Thank you very much Terence I got everything working fine right now.
>
> On Mon, Aug 10, 2009 at 11:39 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> do a replace not insert. get token index from '{' and '}'. label  
> those tokens.
> Ter
>
> On Aug 10, 2009, at 12:38 PM, Ismet Ozalp wrote:
>
> Thanks again Terence.
>
> Ok I believe now I getting at least something correct
>
> i replaced the
> methodBody
>    :    block
>    ;
>
> With this
>
> methodBody
>    :    {
>            TokenRewriteStream input2 = (TokenRewriteStream) input;
>            input2.insertAfter(input.index(),"throw new  
> UnsupportedOperationException();");
>        }
>    ;
>
> and now i have throw new UnsupportedOperationException(); in methods  
> but how do i delete the existing codes in the methodBody?
>
> you said ask for { } how do i do that ? how can I find indexes of  
> { } in methodBody if I can find the index of them I can use replace  
> method and everything will be good.
>
> Regards,
> Ismet
>
>
> On Mon, Aug 10, 2009 at 8:01 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> go to method definition in grammar. ask for tokens { and }. context  
> is your key not simply scanning for tokens.
> T
>
> On Aug 10, 2009, at 6:27 AM, Ismet Ozalp wrote:
>
> First of all thank you all for your fast comments on the subject.
>
> Terence, after I created the tokenRewriteStream
>
> JavaLexer javaLexer = new JavaLexer(new ANTLRFileStream(file));
> TokenRewriteStream tokenRewriteStream = new  
> TokenRewriteStream(javaLexer);
>
> Are you suggesting me to find tokens between {} and replace them  
> with the tokens I want?
> In that case how can I detect class definition and inner class  
> definitions because i don't want to replace them. Maybe I am not  
> completely understanding
> your suggestion. I feel like telling the grammar skip method  
> definitions but yet i am not successful.  I am using antlr 3.1.3.  
> Also TokenRewriteStream's delete(int from, int to) seems not  
> deleting the tokens in it's token list? I am just calling  
> tokenRewriteStream.delete(10,20) and the tokens are still there?  
> Thank you very much...
>
> Regards,
> Ismet
>
>
> On Mon, Aug 10, 2009 at 8:31 AM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> Hiya. Use the tokenrewrite stream and Java.g combo. add actions to  
> replace between { } with new action. :)
> Ter
> On Aug 9, 2009, at 6:18 PM, Ismet Ozalp wrote:
>
> Hello everybody,
>
> I am a newbie; I am trying to modify java sources. What I am trying  
> to do is
>
> clear the codes in the methods and change them with one line of code
>
> example method
>
>    public void delete(T t) {
>        PersistenceManager pm = PMF.get().getPersistenceManager();
>
>        try {
>            pm.deletePersistent(t);
>
>        } finally {
>            pm.close();
>        }
>
>    }
>
> changed method
>
>  public void delete(T t) {
>    throw new UnsupportedOperationException();
>  }
>
> So i need to modify the grammar some how to do this for methods in  
> the source file
> currently I am trying to do something with http://www.antlr.org/grammar/1152141644268/Java.g
> which is written by Terence Parr. But I am a little bit lost, if  
> anybody can point me to the right direction
> where I can find more information or examples about how to achieve  
> this, it would be great....
>
> Thank you very much
> Ismet
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
>
>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/26ad8e21/attachment.html 

From jimi at temporal-wave.com  Wed Aug 12 11:23:09 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 11:23:09 -0700
Subject: [antlr-interest] tokens in parser grammar
In-Reply-To: <op.uyj13bqwt3jqlu@win-mupvrp0jyrf>
References: <op.uyj13bqwt3jqlu@win-mupvrp0jyrf>
Message-ID: <4A83088D.1030603@temporal-wave.com>

??????? ?????? wrote:
> And additional question:
>
> "
> constant[BlockStatement *stmntBlock]
> returns [ExpressionBase *resultConstant]
> 	: resultConstant = literal_constant    // this line is wrong. Name  
> conflict with result value //
> 	| T_IDENT { resultConstant = action.constant($T_IDENT, stmntBlock); }
> 	;
> " - isn't parded :(
>
> : resultConstant = literal_constant    <-- this line is wrong. Name  
> conflict with result value
>
> what i do wrong?
>
>   
Change the name:

: rC=literal_constant { $resultConstant = $rC.whateverTheReturnNameIs; }

...etc

The labeled return values return a struct, from which you need to 
reference the name of the return element in returns declaration of the 
sub_rule.

Jim

From nikolay.ognyanov at travelstoremaker.com  Wed Aug 12 14:45:02 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Thu, 13 Aug 2009 00:45:02 +0300
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail on
 non recursive grammar for finite language?
Message-ID: <4A8337DE.1080507@travelstoremaker.com>

Hi everybody,

Please have a look at a toy grammar for  language consisting of 2 
statements :

grammar Ambiguous;

expr
    : expr1
    | expr2
    ;
expr1
    : PREFIX_1 expr2 SUFFIX
    ;
expr2
    : PREFIX_2
    | PREFIX_2 SUFFIX
    ;

PREFIX_1   : 'prefix_1';
PREFIX_2   : 'prefix_2';
SUFFIX     : 'suffix';
WS         : (' ' | '\r' | '\n' | '\t')+ {$channel=HIDDEN;};


Please do not advise how to fix it :) I know that but the question is why
ANTLR considers rule for expr2 ambiguous?  Here is a tool run:

java org.antlr.Tool Ambiguous.g
warning(200): Ambiguous.g:11:5: Decision can match input such as 
"PREFIX_2 {EOF, SUFFIX}" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
error(201): Ambiguous.g:11:5: The following alternatives can never be 
matched: 2

Or with reversed order of alternatives;

java org.antlr.Tool Ambiguous.g
warning(200): Ambiguous.g:11:5: Decision can match input such as 
"PREFIX_2 SUFFIX" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input

The language is :

PREFIX_1 PREFIX_2 SUFFIX
PREFIX_1 PREFIX_2 SUFFIX SUFFIX

and none of the statements is really ambiguous per the grammar above. 
The only kind
of "ambiguity" I see is that second statement can be parsed as the first 
on plus some
extra input after end of program. And the only answer to the question I 
know is that
this is just how it goes with recursive descent parsers - they are OK 
with leaving extra
input after end of valid program in the input channel. I would not be 
surprised if this
is  the real answer but it is still interesting to know when and how 
exactly ANTLR gets
to this. There are real world problems of the kind which are much more 
difficult to
identify and fix than in the toy grammar above, so if anybody can advise 
of the more
detailed mechanics of how this happens with ANTLR, I would be grateful. 
And also -
of a way (other than the hard way:) to verify that this is or is the 
problem in real world
grammars when suspicious ambiguity is reported.

Regards
Nikolay





From cummings at kjchome.homeip.net  Wed Aug 12 14:59:25 2009
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Wed, 12 Aug 2009 17:59:25 -0400
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A8337DE.1080507@travelstoremaker.com>
References: <4A8337DE.1080507@travelstoremaker.com>
Message-ID: <4A833B3D.5060400@kjchome.homeip.net>

On 08/12/2009 05:45 PM, Nikolay Ognyanov wrote:
> Hi everybody,
> 
> Please have a look at a toy grammar for  language consisting of 2 
> statements :
> 
> grammar Ambiguous;
> 
> expr
>     : expr1
>     | expr2
>     ;
> expr1
>     : PREFIX_1 expr2 SUFFIX
>     ;
> expr2
>     : PREFIX_2
>     | PREFIX_2 SUFFIX
>     ;
> 
> PREFIX_1   : 'prefix_1';
> PREFIX_2   : 'prefix_2';
> SUFFIX     : 'suffix';
> WS         : (' ' | '\r' | '\n' | '\t')+ {$channel=HIDDEN;};
> 
> 
> Please do not advise how to fix it :) I know that but the question is why
> ANTLR considers rule for expr2 ambiguous?  Here is a tool run:

Because at the time it is in expr2, it is ambiguous as to whether it
should match PREFIX_2 and exit, or match PREFIX_2 SUFFIX and then exit.
You only have 1 token of lookahead (by default).  You might be able to
correct with syntactic predicates or a higher value of k, but your
grammar is not well defined because of the ambiguity.

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From jimi at temporal-wave.com  Wed Aug 12 15:13:35 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 15:13:35 -0700
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A8337DE.1080507@travelstoremaker.com>
References: <4A8337DE.1080507@travelstoremaker.com>
Message-ID: <4A833E8F.3070305@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/128a69c2/attachment.html 

From nikolay.ognyanov at travelstoremaker.com  Wed Aug 12 15:28:16 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Thu, 13 Aug 2009 01:28:16 +0300
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A833E8F.3070305@temporal-wave.com>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833E8F.3070305@temporal-wave.com>
Message-ID: <4A834200.7040204@travelstoremaker.com>



Jim Idle wrote:
> Nikolay Ognyanov wrote:
>> Hi everybody,
>>
>> Please have a look at a toy grammar for  language consisting of 2 
>> statements :
>>
>> grammar Ambiguous;
>>
>> expr
>>     : expr1
>>     | expr2
>>     ;
>> expr1
>>     : PREFIX_1 expr2 SUFFIX
>>     ;
>> expr2
>>     : PREFIX_2
>>     | PREFIX_2 SUFFIX
>>     ;
>>
>> PREFIX_1   : 'prefix_1';
>> PREFIX_2   : 'prefix_2';
>> SUFFIX     : 'suffix';
>> WS         : (' ' | '\r' | '\n' | '\t')+ {$channel=HIDDEN;};
>>
>>
>> Please do not advise how to fix it :) I know that but the question is why
>> ANTLR considers rule for expr2 ambiguous?  Here is a tool run:
>>
>> java org.antlr.Tool Ambiguous.g
>> warning(200): Ambiguous.g:11:5: Decision can match input such as 
>> "PREFIX_2 {EOF, SUFFIX}" using multiple alternatives: 1, 2
>> As a result, alternative(s) 2 were disabled for that input
>> error(201): Ambiguous.g:11:5: The following alternatives can never be 
>> matched: 2
>>   
> Clearly, this is ambiguous because you follow expr2 with SUFFIX in the 
> expr1 rule. When parsing expr2 as part of expr1, the paths of taking 
> /PREFIX_2 the using SUFFIX in expr1/ and taking PREFIX_2 then SUFFIX 
> in expr2 followed by SUFFIX in expr1 are ambiguous as written.
>
> You say you know how to fix it, but perhaps you do not if you cannot 
> see the ambiguity here. Because expr2 is a stand alone path from expr, 
> there is no way to know how to disambiguate when called from expr1. 
> Basically, you need to left factor these rules properly:
>
> expr
>    : PREFIX_1 PREFIX_2 SUFFIX SUFFIX?
>    | PREFIX_2 SUFFIX?
>    ;
>
>
>
> Jim
>
>
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>   
By definition a grammar is ambiguous if there is more than 1 way to 
derive at least one statement.
This is not the case here. There is only 1 way to derive the offending 
statement

PREFIX_1 PREFIX_2 SUFFIX SUFFIX

And it would take the procedure for expr2 just about 3 tokens lookahead 
to figure out what is the
right thing to do. The question is why ANTLR does not do this?

Regards
Nikolay


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/c7ca1577/attachment.html 

From jimi at temporal-wave.com  Wed Aug 12 15:39:14 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 15:39:14 -0700
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A834200.7040204@travelstoremaker.com>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
Message-ID: <4A834492.1000301@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/bb2ae2f5/attachment.html 

From lgcraymer at yahoo.com  Wed Aug 12 15:41:07 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Wed, 12 Aug 2009 15:41:07 -0700 (PDT)
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
	on non recursive grammar for finite language?
In-Reply-To: <4A834200.7040204@travelstoremaker.com>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
Message-ID: <336934.82931.qm@web55901.mail.re3.yahoo.com>

Not true; your example can be interpreted either as

(expr1:  PREFIX_1 (expr2:  PREFIX_2 SUFFIX) SUFFIX )

or as

(expr1:  PREFIX_1 (expr2:  PREFIX_2) SUFFIX) SUFFIX

with the extra SUFFIX belonging to something else

--Loring



>
>From: Nikolay Ognyanov <nikolay.ognyanov at travelstoremaker.com>
>To: Jim Idle <jimi at temporal-wave.com>
>Cc: antlr-interest at antlr.org
>Sent: Wednesday, August 12, 2009 3:28:16 PM
>Subject: Re: [antlr-interest] Why and how exactly does ANTLR manage to fail on non recursive grammar for finite language? 
>By definition a grammar is ambiguous if there is more than 1 way to
>derive at least one statement.
>>This is not the case here. There is only 1 way to derive the offending
>statement
>
>>PREFIX_1 PREFIX_2 SUFFIX SUFFIX
>
>>And it would take the procedure for expr2 just about 3 tokens lookahead
>to figure out what is the 
>>right thing to do. The question is why ANTLR does not do this?
>
>>Regards
>>Nikolay
>
>
> 


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/218b5027/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Wed Aug 12 15:49:48 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Wed, 12 Aug 2009 23:49:48 +0100
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <336934.82931.qm@web55901.mail.re3.yahoo.com>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833E8F.3070305@temporal-wave.com>	<4A834200.7040204@travelstoremaker.com>
	<336934.82931.qm@web55901.mail.re3.yahoo.com>
Message-ID: <4A83470C.6080003@lancaster.ac.uk>

Loring Craymer wrote:
> Not true; your example can be interpreted either as
> 
> (expr1:  PREFIX_1 (expr2:  PREFIX_2 SUFFIX) SUFFIX )
> 
> or as
> 
> (expr1:  PREFIX_1 (expr2:  PREFIX_2) SUFFIX) SUFFIX
> 
> with the extra SUFFIX belonging to something else

So, hazarding a guess, would it be okay if expr was EOF-terminated?

-- 
Sam Barnett-Cormack

From nikolay.ognyanov at travelstoremaker.com  Wed Aug 12 15:54:27 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Thu, 13 Aug 2009 01:54:27 +0300
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A834492.1000301@temporal-wave.com>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833E8F.3070305@temporal-wave.com>	<4A834200.7040204@travelstoremaker.com>
	<4A834492.1000301@temporal-wave.com>
Message-ID: <4A834823.70101@travelstoremaker.com>



Jim Idle wrote:
> Nikolay Ognyanov wrote:
>>
>>
>> Jim Idle wrote:
>>> Nikolay Ognyanov wrote:
>>>> Hi everybody,
>>>>
>>>> Please have a look at a toy grammar for  language consisting of 2 
>>>> statements :
>>>>
>>>> grammar Ambiguous;
>>>>
>>>> expr
>>>>     : expr1
>>>>     | expr2
>>>>     ;
>>>> expr1
>>>>     : PREFIX_1 expr2 SUFFIX
>>>>     ;
>>>> expr2
>>>>     : PREFIX_2
>>>>     | PREFIX_2 SUFFIX
>>>>     ;
>>>>
>>>> PREFIX_1   : 'prefix_1';
>>>> PREFIX_2   : 'prefix_2';
>>>> SUFFIX     : 'suffix';
>>>> WS         : (' ' | '\r' | '\n' | '\t')+ {$channel=HIDDEN;};
>>>>
>>>>
>>>> Please do not advise how to fix it :) I know that but the question is why
>>>> ANTLR considers rule for expr2 ambiguous?  Here is a tool run:
>>>>
>>>> java org.antlr.Tool Ambiguous.g
>>>> warning(200): Ambiguous.g:11:5: Decision can match input such as 
>>>> "PREFIX_2 {EOF, SUFFIX}" using multiple alternatives: 1, 2
>>>> As a result, alternative(s) 2 were disabled for that input
>>>> error(201): Ambiguous.g:11:5: The following alternatives can never be 
>>>> matched: 2
>>>>   
>>> Clearly, this is ambiguous because you follow expr2 with SUFFIX in 
>>> the expr1 rule. When parsing expr2 as part of expr1, the paths of 
>>> taking /PREFIX_2 the using SUFFIX in expr1/ and taking PREFIX_2 then 
>>> SUFFIX in expr2 followed by SUFFIX in expr1 are ambiguous as written.
>>>
>>> You say you know how to fix it, but perhaps you do not if you cannot 
>>> see the ambiguity here. Because expr2 is a stand alone path from 
>>> expr, there is no way to know how to disambiguate when called from 
>>> expr1. Basically, you need to left factor these rules properly:
>>>
>>> expr
>>>    : PREFIX_1 PREFIX_2 SUFFIX SUFFIX?
>>>    | PREFIX_2 SUFFIX?
>>>    ;
>>>
>>>
>>>
>>> Jim
>>>
>>>
>>> ------------------------------------------------------------------------
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>   
>> By definition a grammar is ambiguous if there is more than 1 way to 
>> derive at least one statement.
>> This is not the case here. There is only 1 way to derive the 
>> offending statement
>>
>> PREFIX_1 PREFIX_2 SUFFIX SUFFIX
>>
>> And it would take the procedure for expr2 just about 3 tokens 
>> lookahead to figure out what is the
>> right thing to do.
>> The question is why ANTLR does not do this?
> That isn't the definition of an ambiguous grammar in terms of what 
> ANTLR can anaylzye (at least at the moment.) How do you expect ANTLR 
> to generate disambiguation in  expr2 when called from expr1 but handle 
> being called from expr as well, where as you have the expr rule right 
> now it could be followed by SUFFIX and the parse can just stop. Sure, 
> as humans we can see that in this particular case it could be done if 
> we make assumptions about follow sets, but for the current analysis 
> algorithms, this is ambiguous.
>
> As I said, you need to left factor your rules - your grammar will be 
> much more readable that way too. You could also just conflate expr2 
> into expr1 and the lookahead predictions you think it should do now 
> would actually happen. However, that way your are increasing the 
> complexity.
>
> Consider:
>
> x : P1 P2? P2 ;
>
> vs
>
> x : P1 P2 P2?
>
> as the simplistic case, then when P2 is a series of tokens, and so on.
>
> Jim
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>   
Thank you, Jim. I really do know how to revamp the grammar. At least in 
such toy cases :) What
I am trying to understand better is in what situations ANTLR will fail 
to do otherwise doable by
recursive decent parser things. Your comment about competition between 
parsing of standalone
and embedded exp2 gives me something to think about. I am not really 
sure I can learn much
more than this without diving into ANLR inernals but I am giving it a try :)

Regards
Nikolay







-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/e4e3c03c/attachment.html 

From jimi at temporal-wave.com  Wed Aug 12 15:56:17 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 15:56:17 -0700
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <336934.82931.qm@web55901.mail.re3.yahoo.com>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
	<336934.82931.qm@web55901.mail.re3.yahoo.com>
Message-ID: <4A834891.9060704@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/af5f5944/attachment.html 

From cummings at kjchome.homeip.net  Wed Aug 12 15:57:20 2009
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Wed, 12 Aug 2009 18:57:20 -0400
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A834200.7040204@travelstoremaker.com>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
Message-ID: <4A8348D0.50903@kjchome.homeip.net>

On 08/12/2009 06:28 PM, Nikolay Ognyanov wrote:
> 
> 
> Jim Idle wrote:
>> Nikolay Ognyanov wrote:
>>> Hi everybody,
>>>
>>> Please have a look at a toy grammar for  language consisting of 2 
>>> statements :
>>>
>>> grammar Ambiguous;
>>>
>>> expr
>>>     : expr1
>>>     | expr2
>>>     ;
>>> expr1
>>>     : PREFIX_1 expr2 SUFFIX
>>>     ;
>>> expr2
>>>     : PREFIX_2
>>>     | PREFIX_2 SUFFIX
>>>     ;
>>>
>>> PREFIX_1   : 'prefix_1';
>>> PREFIX_2   : 'prefix_2';
>>> SUFFIX     : 'suffix';
>>> WS         : (' ' | '\r' | '\n' | '\t')+ {$channel=HIDDEN;};
>>>
>>>
>>> Please do not advise how to fix it :) I know that but the question is why
>>> ANTLR considers rule for expr2 ambiguous?  Here is a tool run:
>>>
>>> java org.antlr.Tool Ambiguous.g
>>> warning(200): Ambiguous.g:11:5: Decision can match input such as 
>>> "PREFIX_2 {EOF, SUFFIX}" using multiple alternatives: 1, 2
>>> As a result, alternative(s) 2 were disabled for that input
>>> error(201): Ambiguous.g:11:5: The following alternatives can never be 
>>> matched: 2
>>>   
>> Clearly, this is ambiguous because you follow expr2 with SUFFIX in the
>> expr1 rule. When parsing expr2 as part of expr1, the paths of taking
>> /PREFIX_2 the using SUFFIX in expr1/ and taking PREFIX_2 then SUFFIX
>> in expr2 followed by SUFFIX in expr1 are ambiguous as written.
>>
>> You say you know how to fix it, but perhaps you do not if you cannot
>> see the ambiguity here. Because expr2 is a stand alone path from expr,
>> there is no way to know how to disambiguate when called from expr1.
>> Basically, you need to left factor these rules properly:
>>
>> expr
>>    : PREFIX_1 PREFIX_2 SUFFIX SUFFIX?
>>    | PREFIX_2 SUFFIX?
>>    ;
>>
>>
>>
>> Jim

> By definition a grammar is ambiguous if there is more than 1 way to
> derive at least one statement.
> This is not the case here. There is only 1 way to derive the offending
> statement
> 
> PREFIX_1 PREFIX_2 SUFFIX SUFFIX
> 
> And it would take the procedure for expr2 just about 3 tokens lookahead
> to figure out what is the
> right thing to do. The question is why ANTLR does not do this?

Because you did not set "k=3" in your parser options?
(At least that's what I would do in ANTLR 2.7.7....)

> Regards
> Nikolay

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From nikolay.ognyanov at travelstoremaker.com  Wed Aug 12 15:57:25 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Thu, 13 Aug 2009 01:57:25 +0300
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <336934.82931.qm@web55901.mail.re3.yahoo.com>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
	<336934.82931.qm@web55901.mail.re3.yahoo.com>
Message-ID: <4A8348D5.2090103@travelstoremaker.com>

Well, there is nothing else that the extra SUFFIX can belong to 
according to the
grammar so this is not derivation/parsing of the statement per the grammar.

Regards
Nikolay

Loring Craymer wrote:
> Not true; your example can be interpreted either as
>
> (expr1:  PREFIX_1 (expr2:  PREFIX_2 SUFFIX) SUFFIX )
>
> or as
>
> (expr1:  PREFIX_1 (expr2:  PREFIX_2) SUFFIX) SUFFIX
>
> with the extra SUFFIX belonging to something else
>
> --Loring
>
>
>     *From:* Nikolay Ognyanov <nikolay.ognyanov at travelstoremaker.com>
>     *To:* Jim Idle <jimi at temporal-wave.com>
>     *Cc:* antlr-interest at antlr.org
>     *Sent:* Wednesday, August 12, 2009 3:28:16 PM
>     *Subject:* Re: [antlr-interest] Why and how exactly does ANTLR
>     manage to fail on non recursive grammar for finite language?
>     By definition a grammar is ambiguous if there is more than 1 way
>     to derive at least one statement.
>     This is not the case here. There is only 1 way to derive the
>     offending statement
>
>     PREFIX_1 PREFIX_2 SUFFIX SUFFIX
>
>     And it would take the procedure for expr2 just about 3 tokens
>     lookahead to figure out what is the
>     right thing to do. The question is why ANTLR does not do this?
>
>     Regards
>     Nikolay
>
>
>

-- 

*Nikolay Ognyanov, PhD*
Chief Technology Officer
*TravelStoreMaker.com Inc.* <http://www.travelstoremaker.com/>
Phone: +359 2 933 3832
Fax:     +359 2 983 6475

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/eccec001/attachment.html 

From jimi at temporal-wave.com  Wed Aug 12 15:58:14 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 12 Aug 2009 15:58:14 -0700
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A834823.70101@travelstoremaker.com>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833E8F.3070305@temporal-wave.com>	<4A834200.7040204@travelstoremaker.com>
	<4A834492.1000301@temporal-wave.com>
	<4A834823.70101@travelstoremaker.com>
Message-ID: <4A834906.4020407@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/c233cc69/attachment.html 

From lgcraymer at yahoo.com  Wed Aug 12 16:04:14 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Wed, 12 Aug 2009 16:04:14 -0700 (PDT)
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
	on non recursive grammar for finite language?
In-Reply-To: <4A83470C.6080003@lancaster.ac.uk>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
	<336934.82931.qm@web55901.mail.re3.yahoo.com>
	<4A83470C.6080003@lancaster.ac.uk>
Message-ID: <646237.31848.qm@web55905.mail.re3.yahoo.com>

The EOF won't fix the ambiguity, but it will make ANTLR parse all of
PREFIX_1 PREFIX_2 SUFFIX SUFFIX
instead of just parsing
PREFIX_1 PREFIX_2 SUFFIX
(as per the "disabling" message) and then "mysteriously" dropping the second SUFFIX on the floor.

--Loring



----- Original Message ----
> From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
> To: Loring Craymer <lgcraymer at yahoo.com>
> Cc: Nikolay Ognyanov <nikolay.ognyanov at travelstoremaker.com>; Jim Idle <jimi at temporal-wave.com>; antlr-interest at antlr.org
> Sent: Wednesday, August 12, 2009 3:49:48 PM
> Subject: Re: [antlr-interest] Why and how exactly does ANTLR manage to fail on non recursive grammar for finite language?
> 
> Loring Craymer wrote:
> > Not true; your example can be interpreted either as
> > 
> > (expr1:  PREFIX_1 (expr2:  PREFIX_2 SUFFIX) SUFFIX )
> > 
> > or as
> > 
> > (expr1:  PREFIX_1 (expr2:  PREFIX_2) SUFFIX) SUFFIX
> > 
> > with the extra SUFFIX belonging to something else
> 
> So, hazarding a guess, would it be okay if expr was EOF-terminated?
> 
> -- Sam Barnett-Cormack


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From nikolay.ognyanov at travelstoremaker.com  Wed Aug 12 16:08:48 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Thu, 13 Aug 2009 02:08:48 +0300
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A8348D0.50903@kjchome.homeip.net>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
	<4A8348D0.50903@kjchome.homeip.net>
Message-ID: <4A834B80.4090905@travelstoremaker.com>



Kevin J. Cummings wrote:
> On 08/12/2009 06:28 PM, Nikolay Ognyanov wrote:
>   
>> Jim Idle wrote:
>>     
>>> Nikolay Ognyanov wrote:
>>>       
>>>> Hi everybody,
>>>>
>>>> Please have a look at a toy grammar for  language consisting of 2 
>>>> statements :
>>>>
>>>> grammar Ambiguous;
>>>>
>>>> expr
>>>>     : expr1
>>>>     | expr2
>>>>     ;
>>>> expr1
>>>>     : PREFIX_1 expr2 SUFFIX
>>>>     ;
>>>> expr2
>>>>     : PREFIX_2
>>>>     | PREFIX_2 SUFFIX
>>>>     ;
>>>>
>>>> PREFIX_1   : 'prefix_1';
>>>> PREFIX_2   : 'prefix_2';
>>>> SUFFIX     : 'suffix';
>>>> WS         : (' ' | '\r' | '\n' | '\t')+ {$channel=HIDDEN;};
>>>>
>>>>
>>>> Please do not advise how to fix it :) I know that but the question is why
>>>> ANTLR considers rule for expr2 ambiguous?  Here is a tool run:
>>>>
>>>> java org.antlr.Tool Ambiguous.g
>>>> warning(200): Ambiguous.g:11:5: Decision can match input such as 
>>>> "PREFIX_2 {EOF, SUFFIX}" using multiple alternatives: 1, 2
>>>> As a result, alternative(s) 2 were disabled for that input
>>>> error(201): Ambiguous.g:11:5: The following alternatives can never be 
>>>> matched: 2
>>>>   
>>>>         
>>> Clearly, this is ambiguous because you follow expr2 with SUFFIX in the
>>> expr1 rule. When parsing expr2 as part of expr1, the paths of taking
>>> /PREFIX_2 the using SUFFIX in expr1/ and taking PREFIX_2 then SUFFIX
>>> in expr2 followed by SUFFIX in expr1 are ambiguous as written.
>>>
>>> You say you know how to fix it, but perhaps you do not if you cannot
>>> see the ambiguity here. Because expr2 is a stand alone path from expr,
>>> there is no way to know how to disambiguate when called from expr1.
>>> Basically, you need to left factor these rules properly:
>>>
>>> expr
>>>    : PREFIX_1 PREFIX_2 SUFFIX SUFFIX?
>>>    | PREFIX_2 SUFFIX?
>>>    ;
>>>
>>>
>>>
>>> Jim
>>>       
>
>   
>> By definition a grammar is ambiguous if there is more than 1 way to
>> derive at least one statement.
>> This is not the case here. There is only 1 way to derive the offending
>> statement
>>
>> PREFIX_1 PREFIX_2 SUFFIX SUFFIX
>>
>> And it would take the procedure for expr2 just about 3 tokens lookahead
>> to figure out what is the
>> right thing to do. The question is why ANTLR does not do this?
>>     
>
> Because you did not set "k=3" in your parser options?
> (At least that's what I would do in ANTLR 2.7.7....)
>
>   
By default ANTLR 3 looks roughly speaking as far ahead as it takes. 
Setting explicitly
high k does not help either.

Regards
Nikolay
>> Regards
>> Nikolay
>>     
>
>   

-- 

*Nikolay Ognyanov, PhD*
Chief Technology Officer
*TravelStoreMaker.com Inc.* <http://www.travelstoremaker.com/>
Phone: +359 2 933 3832
Fax:     +359 2 983 6475

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/0c5e5724/attachment.html 

From nikolay.ognyanov at travelstoremaker.com  Wed Aug 12 16:27:32 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Thu, 13 Aug 2009 02:27:32 +0300
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <646237.31848.qm@web55905.mail.re3.yahoo.com>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833E8F.3070305@temporal-wave.com>
	<4A834200.7040204@travelstoremaker.com>
	<336934.82931.qm@web55901.mail.re3.yahoo.com>
	<4A83470C.6080003@lancaster.ac.uk>
	<646237.31848.qm@web55905.mail.re3.yahoo.com>
Message-ID: <4A834FE4.4000201@travelstoremaker.com>

You know what, ANTLR can do it after all! With expr alternatives EOF 
terminated it still
issues the warning but then parses correctly

prefix_1 prefix_w suffix suffix
as
(expr(expr1(prefix expr2 (prefix_2 suffix) suffix)EOF))

even though the expr2 option "PREFIX2 SUFFIX" was allegedly disabled. As 
Alice says -
this is becoming "curiosuer and curiosier" :).

Regards
Nikolay

Loring Craymer wrote:
> The EOF won't fix the ambiguity, but it will make ANTLR parse all of
> PREFIX_1 PREFIX_2 SUFFIX SUFFIX
> instead of just parsing
> PREFIX_1 PREFIX_2 SUFFIX
> (as per the "disabling" message) and then "mysteriously" dropping the second SUFFIX on the floor.
>
> --Loring
>
>
>
> ----- Original Message ----
>   
>> From: Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>
>> To: Loring Craymer <lgcraymer at yahoo.com>
>> Cc: Nikolay Ognyanov <nikolay.ognyanov at travelstoremaker.com>; Jim Idle <jimi at temporal-wave.com>; antlr-interest at antlr.org
>> Sent: Wednesday, August 12, 2009 3:49:48 PM
>> Subject: Re: [antlr-interest] Why and how exactly does ANTLR manage to fail on non recursive grammar for finite language?
>>
>> Loring Craymer wrote:
>>     
>>> Not true; your example can be interpreted either as
>>>
>>> (expr1:  PREFIX_1 (expr2:  PREFIX_2 SUFFIX) SUFFIX )
>>>
>>> or as
>>>
>>> (expr1:  PREFIX_1 (expr2:  PREFIX_2) SUFFIX) SUFFIX
>>>
>>> with the extra SUFFIX belonging to something else
>>>       
>> So, hazarding a guess, would it be okay if expr was EOF-terminated?
>>
>> -- Sam Barnett-Cormack
>>     
>
>
> __________________________________________________
> Do You Yahoo!?
> Tired of spam?  Yahoo! Mail has the best spam protection around 
> http://mail.yahoo.com 
>
>
>   

-- 

*Nikolay Ognyanov, PhD*
Chief Technology Officer
*TravelStoreMaker.com Inc.* <http://www.travelstoremaker.com/>
Phone: +359 2 933 3832
Fax:     +359 2 983 6475

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/24783a7c/attachment.html 

From RButterfoss at ea.com  Wed Aug 12 17:48:34 2009
From: RButterfoss at ea.com (Butterfoss, Ryan)
Date: Wed, 12 Aug 2009 17:48:34 -0700
Subject: [antlr-interest] Code generation design philosophy?
Message-ID: <9AB6EA23FF6F13458DEF94FC6F20C8C92670A7DAFC@NA-MAIL-1-1.rws.ad.ea.com>

Hi all,

I'm currently working on a project to revamp an existing code generation system my team uses and add some new features.  The generator takes a set of pseudo-class/struct definitions like

class foo
{
      Int X;
      SomeClass Y;
      map<int,int> Z;
};

And generates an output C++ class with a bunch  of decoration.

class foo
{
public:
        int getX() const { return mX; }
        void setX(int val) { mX = val; }

        SomeClass &getY() { return mY; }

        Map<int,int> &getZ() { return mZ; }

Private:
 Int X;
 SomeClass Y;
 map<int,int> Z;
};

(There's a lot more to the specification, but this is good enough to demonstrate my issues).

One of our goals is to support a lot more than C++, and to allow people to override the generation as necessary to fit into their projects.  ANTLR + StringTemplates seems to suit our needs perfectly.  Our old model used flex/bison, a custom tree of classes (since classes can have inner classes, and we support namespaces), and a gnarly set of hand-written C++ output code.  Yuck.

So I've spent the past few weeks getting into ANTRL, reading the manual, reading the reference, trying out the samples, building samples, toy languages etc.  I'm now in the process of prototyping out our new tool, but I've run into a dilemma on the overall structure.

What I'd like to do is parse everything into an AST, then build a tree walker that outputs templates (and maybe another walker to do some error verification).  But what I can't figure out is how you separate the MVC model parts using a tree walker and templates.  I want to have a main template interface such that the "big items" (class, member, etc) are put out through there, and a subtemplate interface for overriding something like C++.  In that way, if I want to change the type of "map" to be "custommap" I just need to change the template that prints out a map type.  What I don't get though is that with a tree walker you get one stab at outputting text.  So if I have a template like:

class $className$
{
public:
        $members$
};

I can see how the top section gets printed out:

class : ^(CLASS n=SYMBOL m=members*) - > classTemplate(name={$n.text}, members={$m}) ;
member : ^(int n=SYMBOL) -> intMemberTemplate(name={$n.text}) ;
  | ^(t=SYMBOL n=SYMBOL) -> classMemberTemplate(name={$n.text}, type={$t}) ;
        ;

Where intMemberTemplate and classMemberTemplate print out the getter/setter funcs from above.

What I don't see how to do is have two sections where the class walks through the members.  It goes through them once, emits their templates once, and moves on.  To generate the C++ class above, I need two passes - one to generate the getters/setters, one to do the variable declarations.  I could do it in one pass with lots of public/private keywords, but the generated code is less readable.  I could duplicate the tree, but then I'm forcing view structure into the model, which seems to go against the whole ST philosophy.  I could also create a "member" object and use its attributes in the template, but I guess that seems a little less clean because then I'm really walking through some other data structure instead of using the tree walker.

One other reason I want to use the tree walker to print out the various getters/setters and declarations is that it has built in context as to what each member is.  If I just have something like

private:
$members:declVar()$
};

Then the template "declVar" either needs to have a bunch of if..else statements to split up the member type and print out the right thing, or I need to do something like have a Member.toString() function to do the dirty work of formatting the declaration.  That of course means potentially putting in view code in the model, which I'd really like to avoid.

So bottom line:  am I leaning to far in the "do everything in the tree walker" direction?  Has anyone had a problem where one input can generate several templates, and each template might have several different variations depending on the input?    I feel like I should have seen this done somewhere, but I looked through a lot of examples and didn't see exactly what I wanted.

Any advice here is appreciated.

Thanks
Ryan




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/8f8d02cd/attachment.html 

From williamstw at gmail.com  Wed Aug 12 18:45:43 2009
From: williamstw at gmail.com (Tim Williams)
Date: Wed, 12 Aug 2009 21:45:43 -0400
Subject: [antlr-interest] tree rewrite ambiguous enclosing rule/referenced
	in production
Message-ID: <499888440908121845udde857ei3a9edbe25373d7e@mail.gmail.com>

For the scopedClause rule below, I'm getting this error(132):
"$scopedClause is ambiguous; rule scopedClause is enclosing rule and
referenced in the production (assuming enclosing rule)"

I've had a similar rule working before.  I also tried Jim's suggestion
of just rewriting it inline and changing the .type of the Token to OR
but got a "cannot write to read-only attribute problem".  Hopefully,
below is enough for someone to gather what I'm attempting to achieve?
Thanks,
--tim

scopedClause:	
	LPAREN (scopedClause->scopedClause) ((OR_TOKEN s2=scopedClause) ->
^(OR $scopedClause $s2))+ RPAREN
    | LPAREN (scopedClause->scopedClause) ((AND_TOKEN s2=scopedClause)
-> ^(AND $scopedClause $s2))+ RPAREN
    | LPAREN (scopedClause->scopedClause) ((NOT_TOKEN s2=scopedClause)
-> ^(NOT $scopedClause $s2))+ RPAREN
	| searchClause
		-> searchClause
	;

From david-sarah at jacaranda.org  Wed Aug 12 19:24:47 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 13 Aug 2009 03:24:47 +0100
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A833B3D.5060400@kjchome.homeip.net>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833B3D.5060400@kjchome.homeip.net>
Message-ID: <4A83796F.7020602@jacaranda.org>

Kevin J. Cummings wrote:
> On 08/12/2009 05:45 PM, Nikolay Ognyanov wrote:
>> Hi everybody,
>>
>> Please have a look at a toy grammar for  language consisting of 2 
>> statements :
>>
>> grammar Ambiguous;
>>
>> expr
>>     : expr1
>>     | expr2
>>     ;
>> expr1
>>     : PREFIX_1 expr2 SUFFIX
>>     ;
>> expr2
>>     : PREFIX_2
>>     | PREFIX_2 SUFFIX
>>     ;
>>
>> PREFIX_1   : 'prefix_1';
>> PREFIX_2   : 'prefix_2';
>> SUFFIX     : 'suffix';
>> WS         : (' ' | '\r' | '\n' | '\t')+ {$channel=HIDDEN;};
>>
>>
>> Please do not advise how to fix it :) I know that but the question is why
>> ANTLR considers rule for expr2 ambiguous?  Here is a tool run:
> 
> Because at the time it is in expr2, it is ambiguous as to whether it
> should match PREFIX_2 and exit, or match PREFIX_2 SUFFIX and then exit.

Yes.

> You only have 1 token of lookahead (by default).

That's not right. The value of k is normally determined automatically
per rule (if not overridden). The problem here is that the grammar is
ambiguous *as an LL(k) grammar* for any k. Although ANTLR supports
backtracking (which makes it more powerful than LL(k)), that's not
enabled by default, and so is not taken into account by the ambiguity
warning.

For example, consider input starting with "prefix_1 prefix_2 suffix".
A non-backtracking LL(k) parser must predict and commit to a particular
alternative of expr2 by looking only at tokens that would be part of that
alternative, here either "prefix_2" or "prefix_2 suffix". It will never
look further ahead than that, regardless of k.

The default of not enabling backtracking is the right default, since the
ambiguity warnings are more conservative and more likely to help in
finding grammar errors. (To me this is more important than the loss
of efficiency that can result from backtracking.) In this case, the
left-factoring suggested by Jim Idle is a better solution than enabling
backtracking, even though the latter would handle this particular
grammar automatically.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From achintmehta at gmail.com  Wed Aug 12 20:07:36 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Wed, 12 Aug 2009 23:07:36 -0400
Subject: [antlr-interest] Extracting a string whose value clashes with
	token value
In-Reply-To: <b02eee6b0908112310w72af1a98nef06d21628d8816c@mail.gmail.com>
References: <4a3315250908112234t27ab360bm3d5a842920ed52fa@mail.gmail.com>
	<b02eee6b0908112310w72af1a98nef06d21628d8816c@mail.gmail.com>
Message-ID: <4a3315250908122007n75b143e6j51b57ac75738759c@mail.gmail.com>

Hi Benoit,

The solution suggested by you solved the problem.

Many thanks.

Regards,
Achint

On Wed, Aug 12, 2009 at 2:10 AM, Benoit Fouletier
<benblo+ANTLR at gmail.com<benblo%2BANTLR at gmail.com>
> wrote:

> I think special_string should be a lexer rule, not a parser rule: rename it
> to SPECIAL_STRING.Also, the lexer depends on the order with which you
> define tokens, so make sure you put ANTLRTOKEN  above SPECIAL_STRING.
>
>
> On Wed, Aug 12, 2009 at 7:34 AM, Achint Mehta <achintmehta at gmail.com>wrote:
>
>>
>> Hi,
>>
>> I am stuck at a seemingly trivial problem.
>> I have written a simplified sample grammar which has this issue.
>>
>> In the grammar I have a rule to extract a generic string
>> special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;
>>
>> and a token ANTLR which is defined as:
>> ANTLRTOKEN:'ANTLR';
>>
>> A rule which parses two words ( the first of which has to be ANTLR is
>> defined as follows):
>> requestline : ANTLRTOKEN WHITESPACE special_string ;
>>
>> It seems that if the input word begins with keyword "ANTLR", then that
>> word is treated as it is beginning with ANTLRTOKEN and passed to the parser.
>> i.e. an input text "ANTLR ANTLRWORKS",  loosely seems to be treated as
>> sequence of
>> ANTLRTOKEN WHITESPACE ANTLRTOKEN special_string
>>
>> The whole grammar file is as follows: (This grammer simply parses any word
>> followed by the keyword ANTLR)
>>
>> -----------------------------------------------------------------------------
>> grammar sample_parser;
>>
>> options
>> {
>>     language=C;
>> }
>>
>> requestline : ANTLRTOKEN WHITESPACE special_string ;
>> special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;
>>
>> WHITESPACE  : ( '\t' | ' ' | '\u000C' )+;
>> NEWLINE: ('\r')? '\n';
>> CHAR: (('a'..'z')|('A'..'Z'));
>> ANTLRTOKEN:'ANTLR';
>>
>> -----------------------------------------------------------------------------
>>
>> If i provide the input as
>> ANTLR WORKS
>>
>> Then everything works  fine and I don't get any error.
>>
>> Now if I provide the input as
>> ANTLR ANTLRWORKS
>> Then I get the error as
>>
>> ----------------------------------------------------------------------------
>> input(1)  : error 5 : Unexpected token, at offset 5
>>     near [Index: 2 (Start: 24666934-Stop: 24666938) ='ANTLR', type<4>
>> Line: 1 LinePos:5]
>>      : missing elements...
>>
>> ----------------------------------------------------------------------------
>>
>> Seems that the lexer treats the sub-string ANTLR in ANTLRWORKS as the
>> token ANTLRTOKEN and passes it to parser which is not expecting that token.
>>
>> Is there a way to tell antlr to not to break the input word ANTLRWORKS
>> into token and treat the whole word as special_string ?
>>
>> Can somebody help me getting around this issue ?
>>
>> Thanks in advance.
>>
>> Also, I am using the following version of the library, etc.
>> java version "1.6.0_14"
>> ANTLR version 3.1.3
>> Target language : C
>> C runtime library version: 3.1.3
>> gcc compiler: 4.3.3 (Ubuntu 4.3.3-5ubuntu4)
>>
>>
>> Regards,
>> Achint
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090812/0f2aa0bf/attachment.html 

From david-sarah at jacaranda.org  Wed Aug 12 20:24:00 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 13 Aug 2009 04:24:00 +0100
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A83796F.7020602@jacaranda.org>
References: <4A8337DE.1080507@travelstoremaker.com>
	<4A833B3D.5060400@kjchome.homeip.net>
	<4A83796F.7020602@jacaranda.org>
Message-ID: <4A838750.8040502@jacaranda.org>

David-Sarah Hopwood wrote:
[...]
> The default of not enabling backtracking is the right default, since the
> ambiguity warnings are more conservative and more likely to help in
> finding grammar errors. (To me this is more important than the loss
> of efficiency that can result from backtracking.) In this case, the
> left-factoring suggested by Jim Idle is a better solution than enabling
> backtracking, even though the latter would handle this particular
> grammar automatically...

... if the expr rule were changed to (expr1 | expr2) EOF, which is
needed anyway to reflect the intent of a finite language.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From Heiko.Folkerts at david-bs.de  Thu Aug 13 01:44:25 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Thu, 13 Aug 2009 10:44:25 +0200
Subject: [antlr-interest] Compiling generated C Code from ANTLR
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF130301107B@DC2>

Hello,
I have trouble compiling the generated C code from ANTLR with Visual Studio 2008. I get the following errors:
1>c:\Projekte\modelisar\trunk\vendorsrc\antlr-3.1.3\runtime\C\include\antlr3lexer.h(130) : error C2059: syntax error : '<L_TYPE_raw>'
1>c:\Projekte\modelisar\trunk\vendorsrc\antlr-3.1.3\runtime\C\include\antlr3lexer.h(130) : error C2238: unexpected token(s) preceding ';'

I try to link against the static libraries - but this is before linking so it shouldn't matter. 

The strange thing is, that I can't find any occurence of L_TYPE_RAW in my code or in the antlr headers.

I tried searching the docs and the web but nothing gave me a hint.

Here is the grammar causing the trouble.

/**
\file TFSS.g
\brief Grammatik der Testfallspezifikationssprache (TFSS) */ grammar TFSS; options
    {
    output = AST; // Dieser Parser erstellt einen abstrakten Syntaxbaum (AST)
    language = C;
    ASTLabelType=pANTLR3_BASE_TREE;
    backtrack = true;
    memoize = true;
    }
tokens
    {
    TFSROOT; // Hauptknoten des gesamten AST
    ACTIONEXPRESSION; // Eine Aktion mit Objekte und Option
    STATECHECK; // eine Zustandspr?fung mit Objekt und Option
    PARAMETERLIST; // Eine durch Klammern eingefasste Parameterliste
    PARAM; // Ein einzelner Parameter
    STEP; // ein einzelner Testschritt
    IFEXPRESSION; // Ein Wenn-Dann-Ausdruck
    LOOPEXPRESSION; // eine Schleife
    WHILEEXPRESSION; // Ein Ausdruck f?r gleichzeitige Zustandspr?fungen und Aktionen } @header {
    #include "../../TFSSController/TFSSElements.h" // Wir verwenden die Enumeration der TFSSElementsklasse f?r die Objektklassen zur Unterscheidung der Schl?sselw?rter
    #include "../../TFSSController/TFSSController.h"
}
@members
{
    LanguageID m_LanguageID;
}

// Eine TFS besteht aus einer Liste von Schritten (steps). Daraus erstellen wir einen AST mit dem imagin?ren Token TFSROOT als Wurzel.
tfs: steps -> ^(TFSROOT steps);
// Ein Schritt endet immer mit einem Semikolon.
// Eine Liste von Schritten ist somit durch das terminierende Simikolon getrennt.
// Dabei kann auch nur ein Schritt alleine in der Liste stehen.
steps: step ';'+ -> step+;
// Ein Schritt besteht aus der Anweisung und einem Semikolon am Ende (s.o.) // Innerhalb eines Testschritts kann zun?chst die Testphase und anschlie?end der anweisungsblock stehen.
// Phasetag und Anweisung sind durch einen Doppelpunkt getrennt.
// STEP ist dabei der Hauptknoten f?r die Teile des Testschritts.
step: phasetag ':' statement -> ^(STEP phasetag statement);

// Die Testphase ist entweder leer oder kann in der Symboltabelle nachgeschlagen werden:
// Wir verwenden hierf?r eine sog. validating semantic predicate (Siehe The definitive Antlr Reference Chapter 13f)
phasetag:   
    | p = ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$p.text->chars),m_LanguageID)) == TFSSElements::Phase}?
    ;

statement: actionexpression
    | statecheck
    | ifexpression
    | loopexpression
    | whileexpression;
// Eine Zustandspr?fung (statecheck) beinhaltet ein Zustandsobjekt, eine Zustandsoption und den Zustand. Die Option ist wie der Name sagt optional.
// Rechts vom Gleichheitszeichen steht der Zustand.
statecheck: stateobject stateoption '=' selectedstate -> ^(STATECHECK stateobject stateoption selectedstate)
    | stateobject '=' selectedstate -> ^(STATECHECK stateobject selectedstate); // Eine Aktion beinhaltet ein Aktionsobjekt , eine Aktionsoption und die Aktion selbst.
actionexpression: actionobject actionoption action -> ^(ACTIONEXPRESSION actionobject actionoption action)
    | actionobject action -> ^(ACTIONEXPRESSION actionobject action);

// Ein Wenn-Dann-Ausdruck hat optional einen Sonst-Zweig:
ifexpression: ifkeyword condition thenkeyword actionchain elsekeyword actionchain
    -> ^(IFEXPRESSION condition actionchain actionchain)
    | ifkeyword condition thenkeyword actionchain 
    -> ^(IFEXPRESSION condition actionchain);

loopexpression: loopkeyword condition ':' actionchain -> ^(LOOPEXPRESSION condition actionchain);

whileexpression: whilekeyword whilecondition ':' actionchain -> ^(WHILEEXPRESSION whilecondition actionchain);

// eine Bedingung f?r gleichzeitige Aktionen und Zustandspr?fungen kann sowohl eine Aktionskette als auch Parameter als auch eine Zustandspr?fungskette sein.
whilecondition: condition| actionchain;

condition: parameters | statecheckchain;

actionchain: actionexpression (andkeyword | orkeyword actionchain)*;
statecheckchain: statecheck (andkeyword | orkeyword statecheckchain); // letztlich sind alles einzelne W?rter die sog. keywords
stateobject: keyword;
stateoption: keyword;
selectedstate: keyword;
actionobject: keyword;
actionoption: keyword;
action: keyword;
// die Schl?sselw?rter f?r die Kontrollstrukturen sind jeweils auch nur Schl?sselw?rter, m?ssen aber im System nachgeschlagen werden:
ifkeyword: k=ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$k.text->chars),m_LanguageID)) == TFSSElements::IfKeyword}?;
loopkeyword: k=ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$k.text->chars),m_LanguageID)) == TFSSElements::LoopKeyword}?;
whilekeyword: k=ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$k.text->chars),m_LanguageID)) == TFSSElements::WhileKeyword}?;
thenkeyword: k=ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$k.text->chars),m_LanguageID)) == TFSSElements::ThenKeyword}?;
elsekeyword: k=ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$k.text->chars),m_LanguageID)) == TFSSElements::ElseKeyword}?;
andkeyword: k=ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$k.text->chars),m_LanguageID)) == TFSSElements::AndKeyword}?;
orkeyword: k=ALPHASTRING {TFSSController::Instance().lookup(TFSSKeyword(QString((char*)$k.text->chars),m_LanguageID)) == TFSSElements::OrKeyword}?;

keyword: ALPHASTRING WS+ -> ^(ALPHASTRING) | 
    '"' text '"' ->^(text);
text: ALPHASTRING (WS+ ALPHASTRING)*;
ALPHASTRING: ('a'..'z' | 'A'..'Z')+;
WS: (' ' | '\t' | '\r' | '\n')+;
parameters: '(' parameterdata ')' -> ^(PARAMETERLIST parameterdata)
    |
    ;
parameterdata: param (',' parameterdata)* -> ^(param parameterdata);

param: paramname paramoperator paramvalue (paramunit)? -> ^(PARAM paramname paramoperator paramvalue paramunit);
paramname: ALPHASTRING;
paramoperator: '=' | '<=' | '>=' '?=';
paramvalue: ALPHASTRING | '0'..'9' | '*';
paramunit: ALPHASTRING; // muss sp?ter um slashes erweitert werden z.B. f?r KM/H.

Thanks in advance

Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From s.barnett-cormack at lancaster.ac.uk  Thu Aug 13 02:34:32 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 13 Aug 2009 10:34:32 +0100
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A8348D5.2090103@travelstoremaker.com>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833E8F.3070305@temporal-wave.com>	<4A834200.7040204@travelstoremaker.com>	<336934.82931.qm@web55901.mail.re3.yahoo.com>
	<4A8348D5.2090103@travelstoremaker.com>
Message-ID: <4A83DE28.2050601@lancaster.ac.uk>

Nikolay Ognyanov wrote:
> Well, there is nothing else that the extra SUFFIX can belong to 
> according to the
> grammar so this is not derivation/parsing of the statement per the grammar.

ANTLR makes no assumptions where to stop, as when it is in a "deeper" 
rule, it does not know what path it took. The generated code for expr2 
can't tell whether it's possible that it will be followed by a SUFFIX 
(it's 'follow set' is undetermined). There's no real concept of a "start 
rule" definable in a grammar, although inclusion of EOF makes some 
improvements.

> Loring Craymer wrote:
>> Not true; your example can be interpreted either as
>>
>> (expr1:  PREFIX_1 (expr2:  PREFIX_2 SUFFIX) SUFFIX )
>>
>> or as
>>
>> (expr1:  PREFIX_1 (expr2:  PREFIX_2) SUFFIX) SUFFIX
>>
>> with the extra SUFFIX belonging to something else
>>
>> --Loring

-- 
Sam Barnett-Cormack

From marwan.alephn at gmail.com  Thu Aug 13 03:17:03 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Thu, 13 Aug 2009 12:17:03 +0200
Subject: [antlr-interest] How should I extend CommonTreeNodeStream? Do I
	need to change my adaptor or something else?
Message-ID: <6535fcb50908130317l40e8df64uad216993a7977edd@mail.gmail.com>

Hi there;

I did define a customized node, extending a commonTree, defined an
adaptor extending a  CommonTreeAdaptor, for my semantic analysis.

I did extend as well CommonErrorNode;

And now myAdaptor look like:

public class BTLTreeAdaptor extends CommonTreeAdaptor{
	@Override
	public Object create(Token payload) {
		return new BTLNodeTree(payload);
	}
	@Override
	public Object errorNode(TokenStream input, Token start, Token stop,
RecognitionException e) {
		return new BTLErrorNode(input, start, stop, e);
	}

Now I supose, that I have to extend CommonTreeNodeStream because I'm
getting a classCastExcpetion, I didn't find any information in the
book:
The Definitive ANTLR Reference, about how to deal with that. I'm using
ANTLR v3.1.

How should I extend CommonTreeNodeStream? Do I need to change my
adaptor or something else? My customized node tree has just few
attributes, to allow the walker to analyze the semantic of the
language I'm defining.

My customized node tree look like:

public class BTLNodeTree extends CommonTree {

	public Identificador identificador;
	public SymbolConst symbolConst;
	public String expType = "";
	public String expSecType = "";

	public BTLNodeTree(Token t)
	{
		 super(t);
	}
}


Thx in advance for your help,

Cheers

-- 
Marouane

From antlr at mirality.co.nz  Thu Aug 13 05:34:24 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 14 Aug 2009 00:34:24 +1200
Subject: [antlr-interest] tree rewrite ambiguous enclosing
 rule/referenced in production
In-Reply-To: <499888440908121845udde857ei3a9edbe25373d7e@mail.gmail.com>
References: <499888440908121845udde857ei3a9edbe25373d7e@mail.gmail.com>
Message-ID: <20090813123453.4C4DE34184CB@www.antlr.org>

At 13:45 13/08/2009, Tim Williams wrote:
 >For the scopedClause rule below, I'm getting this error(132):
 >"$scopedClause is ambiguous; rule scopedClause is enclosing rule 

 >and referenced in the production (assuming enclosing rule)"
[...]
 >scopedClause:	
 >	LPAREN (scopedClause->scopedClause) ((OR_TOKEN s2=scopedClause) 

 >->
 >^(OR $scopedClause $s2))+ RPAREN
 >    | LPAREN (scopedClause->scopedClause) ((AND_TOKEN
 >s2=scopedClause)
 >-> ^(AND $scopedClause $s2))+ RPAREN
 >    | LPAREN (scopedClause->scopedClause) ((NOT_TOKEN
 >s2=scopedClause)
 >-> ^(NOT $scopedClause $s2))+ RPAREN
 >	| searchClause
 >		-> searchClause
 >	;

I think the warning will go away if you explicitly label the first 
path -- ie. replace all of your (scopedClause->scopedClause) 
fragments with (s1=scopedClause->$s1).  (Using $scopedClause in 
the second rewrite is correct though, and should be left like 
that.)

You could, however, improve performance by first left factoring 
it:

scopedClause
   :  LPAREN (s1=scopedClause -> $s1)
      (  OR_TOKEN s2=scopedClause -> ^(OR $scopedClause $s2)
      |  AND_TOKEN s2=scopedClause -> ^(AND $scopedClause $s2)
      |  NOT_TOKEN s2=scopedClause -> ^(NOT $scopedClause $s2)
      )+ RPAREN
   |  searchClause -> searchClause
   ;

(Although that begs the question: is NOT really a binary operator 
in your language?  And is 'LPAREN searchClause RPAREN' supposed to 
be illegal?  Because as it stands, both are the case.)


From jeroen.v.schagen at gmail.com  Thu Aug 13 05:59:14 2009
From: jeroen.v.schagen at gmail.com (Jeroen van Schagen)
Date: Thu, 13 Aug 2009 14:59:14 +0200
Subject: [antlr-interest] Tree rewriting: java.lang.RuntimeException more
	than one node as root
Message-ID: <cabba3130908130559m1c1799a7ta02edd1631b9a545@mail.gmail.com>

Hello,

I recently started writing an interpreter for the WAEBRIC language, which is
a language for generating XHTML code based on self defined function blocks.
However, I keep getting runtime exceptions when running my parser. The
following program interprets fine:

module simple

def main
    html { title "Hello world"; }
end

But when I start adding attributes or arguments to my *title* tag the
exceptions start occuring, for example:

html { title#myidattribute "Hello world"; }

My rewrite rules are probably specified incorrectly, but I cannot seem to
figure out how to fix the problem. If somebody could give me some pointers
that would be greatly appreciated. Below is the related grammar:

statement: markup+ statement -> ^( markup markup* ',' statement )
            | ... ;
markup:            designator arguments? ;
designator:        IDCON attribute* ;
attribute:        '#' IDCON // ID attribute
            | '.' IDCON // Class attribute
            | '$' IDCON // Name attribute
            | ':' IDCON // Type attribute
            | '@' NATCON // Width attribute
            | '@' NATCON '%' NATCON; // Width-height attribute
arguments:        '(' argument? ( ',' argument )* ')' ;
argument:        expression ;

URL:
http://code.google.com/p/waebric/source/browse/#svn/trunk/implementations/java/antlr/src/main/grammar

Thanks in advance,
Jeroen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/580dca9e/attachment.html 

From safisce at gmail.com  Thu Aug 13 06:33:25 2009
From: safisce at gmail.com (Safiye Celik)
Date: Thu, 13 Aug 2009 16:33:25 +0300
Subject: [antlr-interest] parse tree construction
Message-ID: <bbf7e7d50908130633q48fe188cr4e23713abb22c790@mail.gmail.com>

Hi,
I have a grammar such below:

a: b A
b: C^ B

What I want is to set "A" token in rule "a" as the last branch of rule "b"
's parse tree without changing the grammar, rules, tokens etc. (because the
rules and tokens are used somewhere else, the grammar is not such simple of
course)

That's, I want a tree like: ^(C B A). But I only know how to set "A" as the
root of  rule "a" with this grammar(that is done by a: b A^), and it causes
a tree like ^(A C B) which I do not want.

Is there a way to construct the tree I want with above grammar??

I need an urgent answer. Thanks in advance.
-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/0154b7ef/attachment.html 

From antlr at mirality.co.nz  Thu Aug 13 06:44:19 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 14 Aug 2009 01:44:19 +1200
Subject: [antlr-interest] Tree rewriting: java.lang.RuntimeException
 more than one node as root
In-Reply-To: <cabba3130908130559m1c1799a7ta02edd1631b9a545@mail.gmail.co
 m>
References: <cabba3130908130559m1c1799a7ta02edd1631b9a545@mail.gmail.com>
Message-ID: <20090813134441.DF503341840B@www.antlr.org>

At 00:59 14/08/2009, Jeroen van Schagen wrote:
>I recently started writing an interpreter for the WAEBRIC 
>language, which is a language for generating XHTML code based on 
>self defined function blocks. However, I keep getting runtime 
>exceptions when running my parser. The following program 
>interprets fine:
[...]
>statement: markup+ statement -> ^( markup markup* ',' statement ) 
>
>             | ... ;
>markup:            designator arguments? ;

The root of a tree must be a single token/node.  Since the markup 
rule can match more than one token, it doesn't qualify.  When you 
have situations like this, it's often best to use an imaginary 
token as the root (and it's frequently useful even in other cases, 
to make the tree easier to read or parse in a tree parser.)

statement
   : markup+ statement
     -> ^(STATEMENT markup+ ',' statement)
   ;

Although bear in mind that as written, this rule is ambiguous -- 
it's nonsensical to follow a list of markup with a statement 
because a statement is just more markup.  It's also a bit strange 
to put a generated comma into the rewrite; the tree nesting should 
be sufficient indication of structure.


From jimi at temporal-wave.com  Thu Aug 13 08:25:33 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 13 Aug 2009 08:25:33 -0700
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A83796F.7020602@jacaranda.org>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833B3D.5060400@kjchome.homeip.net>
	<4A83796F.7020602@jacaranda.org>
Message-ID: <4A84306D.1090808@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/ae990361/attachment.html 

From jimi at temporal-wave.com  Thu Aug 13 08:43:34 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 13 Aug 2009 08:43:34 -0700
Subject: [antlr-interest] Compiling generated C Code from ANTLR
In-Reply-To: <93FCBF72DCE7634481C5DF1654D8FF130301107B@DC2>
References: <93FCBF72DCE7634481C5DF1654D8FF130301107B@DC2>
Message-ID: <4A8434A6.9000909@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/11a681cd/attachment.html 

From jimi at temporal-wave.com  Thu Aug 13 09:44:25 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 13 Aug 2009 09:44:25 -0700
Subject: [antlr-interest] parse tree construction
In-Reply-To: <bbf7e7d50908130633q48fe188cr4e23713abb22c790@mail.gmail.com>
References: <bbf7e7d50908130633q48fe188cr4e23713abb22c790@mail.gmail.com>
Message-ID: <4A8442E9.7060405@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/6d348466/attachment.html 

From nikolay.ognyanov at travelstoremaker.com  Thu Aug 13 11:25:34 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Thu, 13 Aug 2009 21:25:34 +0300
Subject: [antlr-interest] Why and how exactly does ANTLR manage to fail
 on non recursive grammar for finite language?
In-Reply-To: <4A84306D.1090808@temporal-wave.com>
References: <4A8337DE.1080507@travelstoremaker.com>	<4A833B3D.5060400@kjchome.homeip.net>	<4A83796F.7020602@jacaranda.org>
	<4A84306D.1090808@temporal-wave.com>
Message-ID: <4A845A9E.7070405@travelstoremaker.com>

Actually, even backtracking does not solve this. The problem is 
apparently as you noted Jim
resolving standalone vs embedded expr2. In standalone expr2 following 
SUFFIX has to be
consumed unconditionally whereas in embedded expr2 it has to be consumed 
only if followed
by yet another SUFFIX.  To resolve between the 2 cases though procedure 
for expr2 needs
to look back, not forward, so it does not matter how far ahead it looks. 
I guess this is what
ultimately makes the grammar not LL - with LL parser expr2 has to be 
handled in a context
dependent way even though the grammar as such is context free. LALR 
should be able to
solve this I think by shifting long enough to figure out what to do 
before making a reduction.

Regards
Nikolay

Jim Idle wrote:
> David-Sarah Hopwood wrote:
>>>
>>> Because at the time it is in expr2, it is ambiguous as to whether it
>>> should match PREFIX_2 and exit, or match PREFIX_2 SUFFIX and then exit.
>>>     
>>
>> Yes.
>>
>>   
>>> You only have 1 token of lookahead (by default).
>>>     
>>
>> That's not right. The value of k is normally determined automatically
>> per rule (if not overridden). The problem here is that the grammar is
>> ambiguous *as an LL(k) grammar* for any k. Although ANTLR supports
>> backtracking (which makes it more powerful than LL(k)), that's not
>> enabled by default, and so is not taken into account by the ambiguity
>> warning.
>>
>> For example, consider input starting with "prefix_1 prefix_2 suffix".
>> A non-backtracking LL(k) parser must predict and commit to a particular
>> alternative of expr2 by looking only at tokens that would be part of that
>> alternative, here either "prefix_2" or "prefix_2 suffix". It will never
>> look further ahead than that, regardless of k.
>>
>> The default of not enabling backtracking is the right default, since the
>> ambiguity warnings are more conservative and more likely to help in
>> finding grammar errors. (To me this is more important than the loss
>> of efficiency that can result from backtracking.) In this case, the
>> left-factoring suggested by Jim Idle is a better solution than enabling
>> backtracking, even though the latter would handle this particular
>> grammar automatically.
>>
>>   
> But, you must remember that once you use backtracking, you lose the 
> inherent ability of LL parsers to pin-point the locale of errors 
> accurately. Hence backtracking is only good for prototypes, or 
> situations where you expect the input to be syntactically sound (you 
> are transforming otherwise good code and so on).
>
> Jim
>
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>   


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/6d2becde/attachment.html 

From consiliens at gmail.com  Thu Aug 13 12:32:26 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Thu, 13 Aug 2009 13:32:26 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
	Debugger?
Message-ID: <4A846A4A.5010905@gmail.com>

I have a simple grammar for quizzes that doesn't work in the debugger, 
although works fine in the interpreter. However, using a * in place of a 
+ breaks it in the interpreter also. At one point it worked in the debugger.

Why does that line, noted in the below grammar, break the Interpreter?

Why doesn't the grammar work in the Debugger? It seems to work fine both 
in the Interpreter and a custom Java test rig running in an IDE outside 
of ANTLRWorks. The debugger only prints a parse tree of root -> quiz, 
with no input shown. When the debugger worked on this grammar, the input 
entered would show up in the Input window.

If there's a better way to write the grammar to fix these issues, I'd 
like to know.

Tested on antlrworks-1.2.3, 1.2.4-SNAPSHOT, 1.3b.

I found some ANTLRWorks code in Hudson and used maven to build the 
SNAPSHOT jar, but the source code link contained in pom.xml 
(http://fisheye2.cenqua.com/browse/antlrworks) is broken with a 404 Not 
Found error. Where is the source code repository for ANTLRWorks?

Thanks for your time.

Sample Input:
1.
*a.
b.

2.
b.
*a.


Grammar:
grammar Quiz;

quiz:
	multiple_choice*;

multiple_choice:
	mc_question responses;

responses:
	// breaks Interpreter causing <epsilon> and <NoViableAltException>
	// (mc_incorrect | mc_correct)*;
	(mc_incorrect | mc_correct)+;

mc_question  : MC_QUESTION;
mc_correct   : MC_CORRECT;
mc_incorrect : MC_INCORRECT;

LETTER 	    : ('a'..'z'|'A'..'Z');
INT         : '0'..'9'+;
NEWLINE     : '\n' '\r'? {skip();};
WS          : ('\n'|'\r'|'\t'|' ')+ {skip();};
MC_QUESTION : INT ('.'|')') .* NEWLINE;
MC_INCORRECT  : LETTER '.' .* NEWLINE;
MC_CORRECT  : '*' MC_INCORRECT;

From marwan.alephn at gmail.com  Thu Aug 13 12:45:50 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Thu, 13 Aug 2009 21:45:50 +0200
Subject: [antlr-interest] Getting cast exceptions in generated code for
	customized tree
Message-ID: <6535fcb50908131245t46b2276vd6abf6e700060a2e@mail.gmail.com>

Hi there;

I did define a customized node, extending a commonTree, defined an
adaptor extending a  CommonTreeAdaptor, for my semantic analysis.

I did extend as well CommonErrorNode;

And now myAdaptor look like:

public class BTLTreeAdaptor extends CommonTreeAdaptor{
       @Override
       public Object create(Token payload) {
               return new BTLNodeTree(payload);
       }
       @Override
       public Object errorNode(TokenStream input, Token start, Token stop,
RecognitionException e) {
               return new BTLErrorNode(input, start, stop, e);
       }

Now I supose, that I have to extend CommonTreeNodeStream because I'm
getting a classCastExcpetion, I didn't find any information in the
book:
The Definitive ANTLR Reference, about how to deal with that. I'm using
ANTLR v3.1.

How should I extend CommonTreeNodeStream? Do I need to change my
adaptor or something else? My customized node tree has just few
attributes, to allow the walker to analyze the semantic of the
language I'm defining.

My customized node tree look like:

public class BTLNodeTree extends CommonTree {

       public Identificador identificador;
       public SymbolConst symbolConst;
       public String expType = "";
       public String expSecType = "";

       public BTLNodeTree(Token t)
       {
                super(t);
       }
}


Thx in advance for your help,

Cheers

-- 
Marouane

From marwan.alephn at gmail.com  Thu Aug 13 12:47:39 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Thu, 13 Aug 2009 21:47:39 +0200
Subject: [antlr-interest] There is any documetation I can check;
	Fwd: How should I extend 	CommonTreeNodeStream?
Message-ID: <6535fcb50908131247i12ed4e90l6725f1704b288b1a@mail.gmail.com>

---------- Forwarded message ----------
From: Marwan Ajraoui <marwan.alephn at gmail.com>
Date: 2009/8/13
Subject: How should I extend CommonTreeNodeStream? Do I need to change
my adaptor or something else?
To: antlr-interest at antlr.org


Hi there;

I did define a customized node, extending a commonTree, defined an
adaptor extending a ?CommonTreeAdaptor, for my semantic analysis.

I did extend as well CommonErrorNode;

And now myAdaptor look like:

public class BTLTreeAdaptor extends CommonTreeAdaptor{
? ? ? ?@Override
? ? ? ?public Object create(Token payload) {
? ? ? ? ? ? ? ?return new BTLNodeTree(payload);
? ? ? ?}
? ? ? ?@Override
? ? ? ?public Object errorNode(TokenStream input, Token start, Token stop,
RecognitionException e) {
? ? ? ? ? ? ? ?return new BTLErrorNode(input, start, stop, e);
? ? ? ?}

Now I supose, that I have to extend CommonTreeNodeStream because I'm
getting a classCastExcpetion, I didn't find any information in the
book:
The Definitive ANTLR Reference, about how to deal with that. I'm using
ANTLR v3.1.

How should I extend CommonTreeNodeStream? Do I need to change my
adaptor or something else? My customized node tree has just few
attributes, to allow the walker to analyze the semantic of the
language I'm defining.

My customized node tree look like:

public class BTLNodeTree extends CommonTree {

? ? ? ?public Identificador identificador;
? ? ? ?public SymbolConst symbolConst;
? ? ? ?public String expType = "";
? ? ? ?public String expSecType = "";

? ? ? ?public BTLNodeTree(Token t)
? ? ? ?{
? ? ? ? ? ? ? ? super(t);
? ? ? ?}
}


Thx in advance for your help,

Cheers

--
Marouane



-- 
Marouane

From antlr at mirality.co.nz  Thu Aug 13 13:26:13 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 14 Aug 2009 08:26:13 +1200
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A846A4A.5010905@gmail.com>
References: <4A846A4A.5010905@gmail.com>
Message-ID: <20090813202631.0BD2834183F3@www.antlr.org>

At 07:32 14/08/2009, consiliens at gmail.com wrote:
 >I have a simple grammar for quizzes that doesn't work in the
 >debugger, although works fine in the interpreter.
[...]
 >LETTER 	    : ('a'..'z'|'A'..'Z');
 >INT         : '0'..'9'+;
 >NEWLINE     : '\n' '\r'? {skip();};

These rules should be marked as fragments, since you're consuming 
them from other lexer rules and not expecting to receive them in 
the parser.

The general rule of thumb is that you should never define two 
non-fragment lexer rules that can consume the same input, and try 
to avoid doing so when they consume the same common left 
prefix.  (Even in the cases where you can get away with having a 
common left prefix, it reduces performance to do so.)


From bruce.bauman at andesaservices.com  Thu Aug 13 13:28:06 2009
From: bruce.bauman at andesaservices.com (Bruce Bauman)
Date: Thu, 13 Aug 2009 16:28:06 -0400
Subject: [antlr-interest] case-insensitivity in ANTLR (Java)
Message-ID: <15DF771CF9BEAE418AA0C8D745F73D1505F0E64C@exchange.andesatpa.com>

I'm using Jim Idle's snippet of code from the wiki
(ANTLRNoCaseFileStream.java), but I'm not sure how to hook this into the
ANTLR generated Lexer.

Do I put ANTLRNoCaseFileStream.java in the same directory with my
"Main.java"?

How do I use the new  stream instead of the normal ANTLRFileStream?

Thanks for any guidance you could provide.

-- Bruce

 

CONFIDENTIALITY NOTICE: This e-mail is confidential and intended
solely for the use of the individual or entity to which it is addressed.  If
you are not the intended recipient, be advised that you have received 
this email in error and that any use, dissemination, forwarding, printing 
or copying of this e-mail is strictly prohibited. If you received this e-mail
in error, please delete it from your computer and contact the sender.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/7534864f/attachment.html 

From consiliens at gmail.com  Thu Aug 13 13:56:48 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Thu, 13 Aug 2009 14:56:48 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
References: <4A846A4A.5010905@gmail.com>
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
Message-ID: <4A847E10.6070209@gmail.com>

Gavin Lambert wrote:
> At 07:32 14/08/2009, consiliens at gmail.com wrote:
>  >I have a simple grammar for quizzes that doesn't work in the
>  >debugger, although works fine in the interpreter.
> [...]
>  >LETTER         : ('a'..'z'|'A'..'Z');
>  >INT         : '0'..'9'+;
>  >NEWLINE     : '\n' '\r'? {skip();};
> 
> These rules should be marked as fragments, since you're consuming them 
> from other lexer rules and not expecting to receive them in the parser.
> 
> The general rule of thumb is that you should never define two 
> non-fragment lexer rules that can consume the same input, and try to 
> avoid doing so when they consume the same common left prefix.  (Even in 
> the cases where you can get away with having a common left prefix, it 
> reduces performance to do so.)
> 
> 

Thanks for the tip! I marked the appropriate rules as fragments, however 
all the issues in the original post still stand. The debugger simply 
generates a Parse Tree of root -> quiz, while the Interpreter correctly 
generates the Parse Tree. Is this possibly an issue with ANTLRWorks itself?

From antlr at mirality.co.nz  Thu Aug 13 14:22:18 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 14 Aug 2009 09:22:18 +1200
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A847E10.6070209@gmail.com>
References: <4A846A4A.5010905@gmail.com>
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
	<4A847E10.6070209@gmail.com>
Message-ID: <20090813212233.E10DF341840B@www.antlr.org>

At 08:56 14/08/2009, consiliens at gmail.com wrote:
 >Thanks for the tip! I marked the appropriate rules as fragments, 

 >however all the issues in the original post still stand. The
 >debugger simply generates a Parse Tree of root -> quiz, while
 >the Interpreter correctly generates the Parse Tree. Is this
 >possibly an issue with ANTLRWorks itself?

Try changing your quiz rule to this:

quiz:
	  multiple_choice* EOF;

Without the EOF, you're saying to ANTLR "if you don't find 
something that matches multiple_choice, that's ok, just 
stop".  With it, you're saying "after you've matched all the 
multiple_choices you can, you must have no input left", which 
means that you'll get an error if there is unconsumed input (which 
would mean that your multiple_choice rule or its descendants 
aren't matching what you're expecting them to).

Tracing it through with either the debugger or a unit test should 
show where the problem lies.  A good thing to try is to write a 
unit test that simply pulls all the generated tokens off the lexer 
and verifies them; if your lexer isn't producing the tokens you're 
expecting then there's little chance the parser will work, and 
unfortunately the ANTLR/ANTLRworks environment isn't really set up 
to test the lexer properly.


From consiliens at gmail.com  Thu Aug 13 14:41:36 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Thu, 13 Aug 2009 15:41:36 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>
References: <4A846A4A.5010905@gmail.com>
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
	<4A847E10.6070209@gmail.com>
	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>
Message-ID: <4A848890.6000707@gmail.com>

Gavin Lambert wrote:
> At 08:56 14/08/2009, consiliens at gmail.com wrote:
>  >Thanks for the tip! I marked the appropriate rules as fragments,
>  >however all the issues in the original post still stand. The
>  >debugger simply generates a Parse Tree of root -> quiz, while
>  >the Interpreter correctly generates the Parse Tree. Is this
>  >possibly an issue with ANTLRWorks itself?
> 
> Try changing your quiz rule to this:
> 
> quiz:
>       multiple_choice* EOF;
> 
> Without the EOF, you're saying to ANTLR "if you don't find something 
> that matches multiple_choice, that's ok, just stop".  With it, you're 
> saying "after you've matched all the multiple_choices you can, you must 
> have no input left", which means that you'll get an error if there is 
> unconsumed input (which would mean that your multiple_choice rule or its 
> descendants aren't matching what you're expecting them to).
> 
> Tracing it through with either the debugger or a unit test should show 
> where the problem lies.  A good thing to try is to write a unit test 
> that simply pulls all the generated tokens off the lexer and verifies 
> them; if your lexer isn't producing the tokens you're expecting then 
> there's little chance the parser will work, and unfortunately the 
> ANTLR/ANTLRworks environment isn't really set up to test the lexer 
> properly.
> 
> 
I experimented a bit with EOF. Making your suggested change yields a 
Parse Tree, in the Debugger, of root -> quiz -> EOF. It seems like the 
debugger isn't getting any of the input for some reason.

Doesn't the Parse Tree correctly appearing in ANTLRWorks Interpreter 
allow one to verify the tokens are being produced correctly?

I'll try writing a unit test, as you suggest, and will see what happens.

From consiliens at gmail.com  Thu Aug 13 15:12:12 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Thu, 13 Aug 2009 16:12:12 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>
References: <4A846A4A.5010905@gmail.com>
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
	<4A847E10.6070209@gmail.com>
	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>
Message-ID: <4A848FBC.6080205@gmail.com>

Gavin Lambert wrote:
> Tracing it through with either the debugger or a unit test should show 
> where the problem lies.  A good thing to try is to write a unit test 
> that simply pulls all the generated tokens off the lexer and verifies 
> them; if your lexer isn't producing the tokens you're expecting then 
> there's little chance the parser will work, and unfortunately the 
> ANTLR/ANTLRworks environment isn't really set up to test the lexer 
> properly.

QuizLexer lexer = new QuizLexer(new ANTLRFileStream(input));
CommonTokenStream tokens = new CommonTokenStream(lexer);
// prints 0
System.out.println(tokens.size());

So according to this there are no tokens, which would explain the blank 
debugger Input window. If the ANTLRWorks Interpreter runs the code 
correctly, why not the Debugger or unit tests?

Any ideas on how to fix the Grammar?

From marwan.alephn at gmail.com  Thu Aug 13 16:33:45 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Fri, 14 Aug 2009 01:33:45 +0200
Subject: [antlr-interest] There is any documetation I can check;
	Fwd: How should I extend 	CommonTreeNodeStream?
In-Reply-To: <6535fcb50908131247i12ed4e90l6725f1704b288b1a@mail.gmail.com>
References: <6535fcb50908131247i12ed4e90l6725f1704b288b1a@mail.gmail.com>
Message-ID: <6535fcb50908131633t411cef01n9ec02a13e1ea7b33@mail.gmail.com>

I did find how to implement it;

1. changed my main class setting a walker myAdator

				 // Create a tree Walker attached to the nodes stream
				 BTLSem walker = new BTLSem(nodes);
				 //setting the adapter to use
				 walker.setTreeAdaptor(adaptor);

2. overrides public Tree dupNode() in MyAdaptor


3.  overrides public Tree dupNode() in MyNodeTree since is called by
the one is overriden in the point 2

Hope that will save little time, to others new bites like me, that get
lost with so many options of use of this framework and considerably
poor documentation in proportion. That's the common problem of
opensource projects :-(

Cheers,




2009/8/13 Marwan Ajraoui <marwan.alephn at gmail.com>:
> ---------- Forwarded message ----------
> From: Marwan Ajraoui <marwan.alephn at gmail.com>
> Date: 2009/8/13
> Subject: How should I extend CommonTreeNodeStream? Do I need to change
> my adaptor or something else?
> To: antlr-interest at antlr.org
>
>
> Hi there;
>
> I did define a customized node, extending a commonTree, defined an
> adaptor extending a ?CommonTreeAdaptor, for my semantic analysis.
>
> I did extend as well CommonErrorNode;
>
> And now myAdaptor look like:
>
> public class BTLTreeAdaptor extends CommonTreeAdaptor{
> ? ? ? ?@Override
> ? ? ? ?public Object create(Token payload) {
> ? ? ? ? ? ? ? ?return new BTLNodeTree(payload);
> ? ? ? ?}
> ? ? ? ?@Override
> ? ? ? ?public Object errorNode(TokenStream input, Token start, Token stop,
> RecognitionException e) {
> ? ? ? ? ? ? ? ?return new BTLErrorNode(input, start, stop, e);
> ? ? ? ?}
>
> Now I supose, that I have to extend CommonTreeNodeStream because I'm
> getting a classCastExcpetion, I didn't find any information in the
> book:
> The Definitive ANTLR Reference, about how to deal with that. I'm using
> ANTLR v3.1.
>
> How should I extend CommonTreeNodeStream? Do I need to change my
> adaptor or something else? My customized node tree has just few
> attributes, to allow the walker to analyze the semantic of the
> language I'm defining.
>
> My customized node tree look like:
>
> public class BTLNodeTree extends CommonTree {
>
> ? ? ? ?public Identificador identificador;
> ? ? ? ?public SymbolConst symbolConst;
> ? ? ? ?public String expType = "";
> ? ? ? ?public String expSecType = "";
>
> ? ? ? ?public BTLNodeTree(Token t)
> ? ? ? ?{
> ? ? ? ? ? ? ? ? super(t);
> ? ? ? ?}
> }
>
>
> Thx in advance for your help,
>
> Cheers
>
> --
> Marouane
>
>
>
> --
> Marouane
>



-- 
Marouane

From marwan.alephn at gmail.com  Thu Aug 13 17:18:44 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Fri, 14 Aug 2009 02:18:44 +0200
Subject: [antlr-interest] Why I'm getting syntax errors while I'm cheking
	for semantic errors?
Message-ID: <6535fcb50908131718v13feca65n70d0ecda32af7c5d@mail.gmail.com>

Hi comunity;

When I'm runing the tree grammar I defined I'm getting errors like

Error: mismatched input '[]' expecting FN_ID

So the it seems that it doesn't recognize ([])*. I 've already checked
the entry sintactically, so why antlr get confused?

What could be the problem, here is a part of my tree gramar:

type_return: 'void' | 'integer' ('[]')* | 'float'('[]')* |
'double'('[]')* | 'char'('[]')* | 'string'('[]')* | 'boolean'('[]')*;

decl_funcion

scope {
    String ambito;
}

: ^(DECL_FUN type_return FN_ID LISTA_PARAMS lista_instrucciones (t2=inst_return{

	if(!types_checker.areTypesEqual($type_return.text,$t2.type))
         	  emitErrorMessage("Funcion '"+ $FN_ID.text + "' en la linea
" + $FN_ID.line  +" : " + " devuelve un tipo de dato  incoherente con
el definido.");
 	
})?{if($type_return.text.equals("void") && ($t2.type!= null || $t2.type!=""))
		      emitErrorMessage("Funcion '"+ $FN_ID.text + "' en la linea " +
$FN_ID.line  +" : " + " devuelve void, no hay que devolver nada ?
cambia su tipo de retorno.");
	
	$decl_funcion::ambito = $FN_ID.text;	
}
);

Thx in advance for any help;
-- 
Marouane

From michael.bedward at gmail.com  Thu Aug 13 19:00:59 2009
From: michael.bedward at gmail.com (Michael Bedward)
Date: Fri, 14 Aug 2009 12:00:59 +1000
Subject: [antlr-interest] case-insensitivity in ANTLR (Java)
In-Reply-To: <15DF771CF9BEAE418AA0C8D745F73D1505F0E64C@exchange.andesatpa.com>
References: <15DF771CF9BEAE418AA0C8D745F73D1505F0E64C@exchange.andesatpa.com>
Message-ID: <e24c4c270908131900r359a8260g387e629437bfe2a1@mail.gmail.com>

Hi Bruce,

Just like this...

ANTLRNoCaseFileStream strm = new ANTLRNoCaseFileStream( myfilename );
MyLexer lexer = new MyLexer( strm );

That's all there is to it really.  If only all things in life were so easy :)

Michael

From achintmehta at gmail.com  Thu Aug 13 20:23:11 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Thu, 13 Aug 2009 23:23:11 -0400
Subject: [antlr-interest] Extracting a string whose value clashes with
	token value
In-Reply-To: <4a3315250908122007n75b143e6j51b57ac75738759c@mail.gmail.com>
References: <4a3315250908112234t27ab360bm3d5a842920ed52fa@mail.gmail.com>
	<b02eee6b0908112310w72af1a98nef06d21628d8816c@mail.gmail.com>
	<4a3315250908122007n75b143e6j51b57ac75738759c@mail.gmail.com>
Message-ID: <4a3315250908132023j1bf1815dw1c3081e9a265fddc@mail.gmail.com>

It seems that I missed one scenario.
Now if I give the input as ANTLR ANTLR then I get an error.

It seems that the second token is a super-set of the first token and this
case both the words are treated as ANTLRTOKEN . A similar situation is
described in the section "Ambiguities and Non determinisms" section of book
"The definitive ANTLR guide", that talks about the ambiguities in lexer
rules, but I am not sure how to resolve this.

How can this be done without making the first rule also as SPECIAL_STRING ?

In general, does any section of the book define any guidelines as to what
rules should be lexer rules and what should be parser rules ?

Thanks!

Regards,
Achint

On Wed, Aug 12, 2009 at 11:07 PM, Achint Mehta <achintmehta at gmail.com>wrote:

> Hi Benoit,
>
> The solution suggested by you solved the problem.
>
> Many thanks.
>
> Regards,
> Achint
>
>
> On Wed, Aug 12, 2009 at 2:10 AM, Benoit Fouletier <benblo+ANTLR at gmail.com<benblo%2BANTLR at gmail.com>
> > wrote:
>
>> I think special_string should be a lexer rule, not a parser rule: rename
>> it to SPECIAL_STRING. Also, the lexer depends on the order with which you
>> define tokens, so make sure you put ANTLRTOKEN  above SPECIAL_STRING.
>>
>>
>> On Wed, Aug 12, 2009 at 7:34 AM, Achint Mehta <achintmehta at gmail.com>wrote:
>>
>>>
>>> Hi,
>>>
>>> I am stuck at a seemingly trivial problem.
>>> I have written a simplified sample grammar which has this issue.
>>>
>>> In the grammar I have a rule to extract a generic string
>>> special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;
>>>
>>> and a token ANTLR which is defined as:
>>> ANTLRTOKEN:'ANTLR';
>>>
>>> A rule which parses two words ( the first of which has to be ANTLR is
>>> defined as follows):
>>> requestline : ANTLRTOKEN WHITESPACE special_string ;
>>>
>>> It seems that if the input word begins with keyword "ANTLR", then that
>>> word is treated as it is beginning with ANTLRTOKEN and passed to the parser.
>>> i.e. an input text "ANTLR ANTLRWORKS",  loosely seems to be treated as
>>> sequence of
>>> ANTLRTOKEN WHITESPACE ANTLRTOKEN special_string
>>>
>>> The whole grammar file is as follows: (This grammer simply parses any
>>> word followed by the keyword ANTLR)
>>>
>>> -----------------------------------------------------------------------------
>>> grammar sample_parser;
>>>
>>> options
>>> {
>>>     language=C;
>>> }
>>>
>>> requestline : ANTLRTOKEN WHITESPACE special_string ;
>>> special_string: (CHAR | '=' | '.' | '-' | '@' )+ ;
>>>
>>> WHITESPACE  : ( '\t' | ' ' | '\u000C' )+;
>>> NEWLINE: ('\r')? '\n';
>>> CHAR: (('a'..'z')|('A'..'Z'));
>>> ANTLRTOKEN:'ANTLR';
>>>
>>> -----------------------------------------------------------------------------
>>>
>>> If i provide the input as
>>> ANTLR WORKS
>>>
>>> Then everything works  fine and I don't get any error.
>>>
>>> Now if I provide the input as
>>> ANTLR ANTLRWORKS
>>> Then I get the error as
>>>
>>> ----------------------------------------------------------------------------
>>> input(1)  : error 5 : Unexpected token, at offset 5
>>>     near [Index: 2 (Start: 24666934-Stop: 24666938) ='ANTLR', type<4>
>>> Line: 1 LinePos:5]
>>>      : missing elements...
>>>
>>> ----------------------------------------------------------------------------
>>>
>>> Seems that the lexer treats the sub-string ANTLR in ANTLRWORKS as the
>>> token ANTLRTOKEN and passes it to parser which is not expecting that token.
>>>
>>> Is there a way to tell antlr to not to break the input word ANTLRWORKS
>>> into token and treat the whole word as special_string ?
>>>
>>> Can somebody help me getting around this issue ?
>>>
>>> Thanks in advance.
>>>
>>> Also, I am using the following version of the library, etc.
>>> java version "1.6.0_14"
>>> ANTLR version 3.1.3
>>> Target language : C
>>> C runtime library version: 3.1.3
>>> gcc compiler: 4.3.3 (Ubuntu 4.3.3-5ubuntu4)
>>>
>>>
>>> Regards,
>>> Achint
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/f75fb61e/attachment.html 

From shambolic at gmail.com  Thu Aug 13 23:34:53 2009
From: shambolic at gmail.com (Joe Schmoe)
Date: Thu, 13 Aug 2009 23:34:53 -0700
Subject: [antlr-interest] How can I match 1 or more tokens (or token
	streams) and then perform a different action or rewrite on
	the final one than on the others?
Message-ID: <443ad6690908132334y661ceb8bo14bdb781b29d2a0a@mail.gmail.com>

I want to perform a different embedded action (or generate a different
AST node) on the final rule in a list of rules.

Here's the most basic example I can think of:

identifierList:
        : (Identifier -> ^(ID $Identifier))* (Identifier -> ^(OTHER
$Identifier))
        ;

This doesn't work because there are two alternatives when matching
just against one Identifier.  So I tried making the first nongreedy
with no success:

identifierList:
        : ( options { greedy = false; } : Identifier -> ^(ID
$Identifier))*  (Identifier -> ^(OTHER $Identifier))
        ;

Again, ANTLR says this is ambiguous - if it's passed just "Identifier"
then it can supposedly either match the one that goes to ^(ID
$Identifier), or the one that goes to ^(OTHER $Identifier).  I don't
understand how this is the case given the first one is nongreedy

My actual example is a good amount lengthier and requires referencing
the rule itself in the rewrite, so solutions that require this to be
broken into multiple rules won't help me except maybe to help me
understand ANTLR better.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090813/128e1858/attachment.html 

From marwan.alephn at gmail.com  Fri Aug 14 00:31:54 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Fri, 14 Aug 2009 09:31:54 +0200
Subject: [antlr-interest] Antlr Behavior! Why notifying sintactic errors in
	My tree gramar where I'm cheking for Semantic errors ONLY.
Message-ID: <6535fcb50908140031t3ef4cfe6h2b370bf73ac30743@mail.gmail.com>

Hi comunity;

When I'm runing the tree grammar I defined I'm getting errors like

Error: mismatched input '[]' expecting FN_ID

So the it seems that it doesn't recognize ([])*. I 've already checked
the entry sintactically, so why antlr get confused?

What could be the problem, here is a part of my tree gramar:

type_return: 'void' | 'integer' ('[]')* | 'float'('[]')* |
'double'('[]')* | 'char'('[]')* | 'string'('[]')* | 'boolean'('[]')*;

decl_funcion

scope {
   String ambito;
}

: ^(DECL_FUN type_return FN_ID LISTA_PARAMS lista_instrucciones (t2=inst_return{

       if(!types_checker.areTypesEqual($type_return.text,$t2.type))
                 emitErrorMessage("Funcion '"+ $FN_ID.text + "' en la linea
" + $FN_ID.line  +" : " + " devuelve un tipo de dato  incoherente con
el definido.");

})?{if($type_return.text.equals("void") && ($t2.type!= null || $t2.type!=""))
                     emitErrorMessage("Funcion '"+ $FN_ID.text + "' en
la linea " +
$FN_ID.line  +" : " + " devuelve void, no hay que devolver nada ?
cambia su tipo de retorno.");

       $decl_funcion::ambito = $FN_ID.text;
}
);

Thx in advance for any help;
--
Marouane

-- 
Marouane

From antlr at mirality.co.nz  Fri Aug 14 00:40:27 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 14 Aug 2009 19:40:27 +1200
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A848FBC.6080205@gmail.com>
References: <4A846A4A.5010905@gmail.com>
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
	<4A847E10.6070209@gmail.com>
	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>
	<4A848FBC.6080205@gmail.com>
Message-ID: <20090814074039.048F03418419@www.antlr.org>

At 10:12 14/08/2009, consiliens at gmail.com wrote:
 >QuizLexer lexer = new QuizLexer(new ANTLRFileStream(input));
 >CommonTokenStream tokens = new CommonTokenStream(lexer);
 >// prints 0
 >System.out.println(tokens.size());
 >
 >So according to this there are no tokens, which would explain 
the
 >blank debugger Input window. If the ANTLRWorks Interpreter runs
 >the code correctly, why not the Debugger or unit tests?

Actually that's a bit deceptive :)

The stream starts out empty, and thus .size() returns 0.  It 
doesn't get populated until the first time a token is 
requested.  So after calling .nextToken() once then .size() should 
give you the true value.


Silly question, perhaps, but are you sure you're filling in the 
input window properly when starting the debugger?  And actually 
stepping through to the end?

Generally, I find the debugger significantly more reliable than 
the interpreter ever is...


From marwan.alephn at gmail.com  Fri Aug 14 04:35:28 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Fri, 14 Aug 2009 13:35:28 +0200
Subject: [antlr-interest] I get stuked;
	I don't know what to try. Fwd: Antlr Behavior! Why notifying
	sintactic errors in My tree gramar.
Message-ID: <6535fcb50908140435w2488429o50393368fab43919@mail.gmail.com>

---------- Forwarded message ----------
From: Marwan Ajraoui <marwan.alephn at gmail.com>
Date: 2009/8/14
Subject: Antlr Behavior! Why notifying sintactic errors in My tree
gramar where I'm cheking for Semantic errors ONLY.
To: antlr-interest at antlr.org


Hi comunity;

When I'm runing the tree grammar I defined I'm getting errors like

Error: mismatched input '[]' expecting FN_ID

So the it seems that it doesn't recognize ([])*. I 've already checked
the entry sintactically, so why antlr get confused?

What could be the problem, here is a part of my tree gramar:

type_return: 'void' | 'integer' ('[]')* | 'float'('[]')* |
'double'('[]')* | 'char'('[]')* | 'string'('[]')* | 'boolean'('[]')*;

decl_funcion

scope {
? String ambito;
}

: ^(DECL_FUN type_return FN_ID LISTA_PARAMS lista_instrucciones (t2=inst_return{

? ? ? if(!types_checker.areTypesEqual($type_return.text,$t2.type))
? ? ? ? ? ? ? ? emitErrorMessage("Funcion '"+ $FN_ID.text + "' en la linea
" + $FN_ID.line ?+" : " + " devuelve un tipo de dato ?incoherente con
el definido.");

})?{if($type_return.text.equals("void") && ($t2.type!= null || $t2.type!=""))
? ? ? ? ? ? ? ? ? ? emitErrorMessage("Funcion '"+ $FN_ID.text + "' en
la linea " +
$FN_ID.line ?+" : " + " devuelve void, no hay que devolver nada ?
cambia su tipo de retorno.");

? ? ? $decl_funcion::ambito = $FN_ID.text;
}
);

Thx in advance for any help;
--
Marouane

--
Marouane



-- 
Marouane

From jimi at temporal-wave.com  Fri Aug 14 07:07:05 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 14 Aug 2009 07:07:05 -0700
Subject: [antlr-interest] I get stuked;
 I don't know what to try. Fwd: Antlr Behavior! Why
 notifying	sintactic errors in My tree gramar.
In-Reply-To: <6535fcb50908140435w2488429o50393368fab43919@mail.gmail.com>
References: <6535fcb50908140435w2488429o50393368fab43919@mail.gmail.com>
Message-ID: <4A856F89.8050001@temporal-wave.com>

Marwan Ajraoui wrote:
> ---------- Forwarded message ----------
> From: Marwan Ajraoui <marwan.alephn at gmail.com>
> Date: 2009/8/14
> Subject: Antlr Behavior! Why notifying sintactic errors in My tree
> gramar where I'm cheking for Semantic errors ONLY.
> To: antlr-interest at antlr.org
>
>
> Hi comunity;
>
> When I'm runing the tree grammar I defined I'm getting errors like
>
> Error: mismatched input '[]' expecting FN_ID
>
>   
Get rid of the explicit 'literal strings' in your parser and tree parser 
and make lexer rules that define these. Then make sure that you generate 
in the order:

lexer.g parser.g treeparser.g

In the latest snapshot there is a -make option to ensure that the order 
is correct if you use *.g

Jim

From brothers at bros.com  Fri Aug 14 08:04:20 2009
From: brothers at bros.com (Dennis Brothers)
Date: Fri, 14 Aug 2009 11:04:20 -0400
Subject: [antlr-interest] Tracing in CSHARP2
Message-ID: <F8E3689A-6818-4D84-8443-A27F8ED01BDA@bros.com>

I've turned on -trace in AntlrWorks, and I see the TraceIn/TraceOut  
calls in the generated code, but I'm seeing no trace output in the  
Visual Studio "Output" window when I debug my app.  When I ran unit  
tests, the trace did show in the test output.

What do I need to do to see the trace output in Visual Studio?

Thanks -
     - Dennis Brothers


From tnurkkala at cse.taylor.edu  Fri Aug 14 09:10:33 2009
From: tnurkkala at cse.taylor.edu (Tom Nurkkala)
Date: Fri, 14 Aug 2009 12:10:33 -0400
Subject: [antlr-interest] Structuring back-end of translator
Message-ID: <A103D6E0-B135-433B-9D99-FA31ED1592EB@cse.taylor.edu>

I am writing a translator that takes high-level queries and generates  
code (e.g., Python, LLVM) that can find records within hierarchical  
data.  For example, hierarchical employee data might take the  
following format:

company {
	name: acme corp, llc
	url: ac.me
	division {
		name: r&d
		employee {
			id : 1551
			person {
				ssn: 123-12-1234
				name {
					first: Fred
					last: Ziffle
				}
				role: programmer
			}
		}
		employee {
			id : 1555
			person {
				ssn: 111-11-1111
				name {
					first: Zelda
					last: Ziffle
				}
				role: manager
			}
		}
		... more employees ...
	}
	division {
		name: it
		employee { ... }
		... more employees ...
	}
}

I'd like to be able to query this data structure with something like  
the following:

	select employee where role = programmer

The translator would take this query and return a program that would  
list all the employee records having a role of programmer.  A simple  
translation of this query would be something like:

	within company
		for each division
			for each employee
				look up role
				if role = 'programmer'
					output entire employee record

Assume that the translator can infer that an employee is within a  
division is within a company, and that a role is an attribute of an  
employee (e.g., these might all be unique attributes within the  
hierarchy).

I have a parser that translates the query into a Common AST, and a  
tree walker that traverses the resulting AST.  I would like to be able  
to use String Template to generate the translation.  However, there is  
a fair amount of processing that needs to be done (e.g., finding the  
connection between company and role in order to infer the necessary  
nested loops) and then this information needs to somehow drive an ST  
group.

What's the best way to structure the tree walker and ST group?  Can I  
leverage template invocation within the ST group to handle the  
generation of multiply nested "for each" clauses in the output above?   
Or do I need to do the heavy lifting in custom output code that  
invokes simpler templates?  Or do I turn to a custom AST (e.g.,  
heterogeneous AST pattern)?  Or something else entirely?

thanks,
tom.


From consiliens at gmail.com  Fri Aug 14 11:55:23 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Fri, 14 Aug 2009 12:55:23 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4a8514f6.2a02be0a.40a5.ffffe514SMTPIN_ADDED@mx.google.com>
References: <4A846A4A.5010905@gmail.com>
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
	<4A847E10.6070209@gmail.com>
	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>
	<4A848FBC.6080205@gmail.com>
	<4a8514f6.2a02be0a.40a5.ffffe514SMTPIN_ADDED@mx.google.com>
Message-ID: <4A85B31B.4040609@gmail.com>

Gavin Lambert wrote:
> At 10:12 14/08/2009, consiliens at gmail.com wrote:
>  >QuizLexer lexer = new QuizLexer(new ANTLRFileStream(input));
>  >CommonTokenStream tokens = new CommonTokenStream(lexer);
>  >// prints 0
>  >System.out.println(tokens.size());
>  >
>  >So according to this there are no tokens, which would explain the
>  >blank debugger Input window. If the ANTLRWorks Interpreter runs
>  >the code correctly, why not the Debugger or unit tests?
> 
> Actually that's a bit deceptive :)
> 
> The stream starts out empty, and thus .size() returns 0.  It doesn't get 
> populated until the first time a token is requested.  So after calling 
> .nextToken() once then .size() should give you the true value.

Even after calling lexer.nextToken() the .size() still returns zero.

> Silly question, perhaps, but are you sure you're filling in the input 
> window properly when starting the debugger?  And actually stepping 
> through to the end?
> Generally, I find the debugger significantly more reliable than the 
> interpreter ever is...

I'm filling the input window properly, and a __Test___input.txt file is 
generated in the output folder which contains the entered input. I make 
sure to step through to the end, using either the Fast Forward button or 
single stepping. At one point this Grammar did work correctly in the 
debugger.

I hope we can figure out why this is apparently difficult in ANTLR. 
Thanks for your help.

From david-sarah at jacaranda.org  Fri Aug 14 12:14:35 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 14 Aug 2009 20:14:35 +0100
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <20090814074039.048F03418419@www.antlr.org>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>
	<20090814074039.048F03418419@www.antlr.org>
Message-ID: <4A85B79B.6040605@jacaranda.org>

Gavin Lambert wrote:
> At 10:12 14/08/2009, consiliens at gmail.com wrote:
>  >QuizLexer lexer = new QuizLexer(new ANTLRFileStream(input));
>  >CommonTokenStream tokens = new CommonTokenStream(lexer);
>  >// prints 0
>  >System.out.println(tokens.size());
>  >
>  >So according to this there are no tokens, which would explain 
>  >the blank debugger Input window. If the ANTLRWorks Interpreter runs
>  >the code correctly, why not the Debugger or unit tests?
> 
> Actually that's a bit deceptive :)
> 
> The stream starts out empty, and thus .size() returns 0.

You're right, and that seems like a bug. In CommonTokenStream:

00315     public int size() {
00316         return tokens.size();
00317     }

should be
          public int size() {
              if ( p == -1 ) {
                  fillBuffer();
              }
              return tokens.size();
          }

Probably consume() also needs the same fix. (There are other methods
that don't check for p == -1, but they're declared as protected.)

> Generally, I find the debugger significantly more reliable than 
> the interpreter ever is...

Same here. The interpreter can't work properly on grammars that have any
significant reliance on target-language code.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From bruce.bauman at andesaservices.com  Fri Aug 14 12:14:09 2009
From: bruce.bauman at andesaservices.com (Bruce Bauman)
Date: Fri, 14 Aug 2009 15:14:09 -0400
Subject: [antlr-interest] case-insensitivity in ANTLR (Java)
References: <15DF771CF9BEAE418AA0C8D745F73D1505F0E64C@exchange.andesatpa.com>
Message-ID: <15DF771CF9BEAE418AA0C8D745F73D1503D5F4E1@exchange.andesatpa.com>

OK, with Terence's help I figured this out.
 
The example on the Wiki contains the line:
 
    package org.antlr.runtime;

but I think this should be:
 
    import org.antlr.runtime;
 
with this change I got things to work. 
 
-- Bruce

 
CONFIDENTIALITY NOTICE: This e-mail is confidential and intended
solely for the use of the individual or entity to which it is addressed.  If
you are not the intended recipient, be advised that you have received 
this email in error and that any use, dissemination, forwarding, printing 
or copying of this e-mail is strictly prohibited. If you received this e-mail
in error, please delete it from your computer and contact the sender.


From jimi at temporal-wave.com  Fri Aug 14 12:43:29 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 14 Aug 2009 12:43:29 -0700
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A85B79B.6040605@jacaranda.org>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>
	<4A85B79B.6040605@jacaranda.org>
Message-ID: <4A85BE61.6070404@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090814/972013c2/attachment.html 

From david-sarah at jacaranda.org  Fri Aug 14 15:49:58 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 14 Aug 2009 23:49:58 +0100
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A85BE61.6070404@temporal-wave.com>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>
	<4A85BE61.6070404@temporal-wave.com>
Message-ID: <4A85EA16.1050304@jacaranda.org>

Jim Idle wrote:
> David-Sarah Hopwood wrote:
>> Gavin Lambert wrote:
>>> At 10:12 14/08/2009, consiliens at gmail.com wrote:
>>>  >QuizLexer lexer = new QuizLexer(new ANTLRFileStream(input));
>>>  >CommonTokenStream tokens = new CommonTokenStream(lexer);
>>>  >// prints 0
>>>  >System.out.println(tokens.size());
>>>  >
>>>  >So according to this there are no tokens, which would explain 
>>>  >the blank debugger Input window. If the ANTLRWorks Interpreter runs
>>>  >the code correctly, why not the Debugger or unit tests?
>>>
>>> Actually that's a bit deceptive :)
>>>
>>> The stream starts out empty, and thus .size() returns 0.
>>
>> You're right, and that seems like a bug. In CommonTokenStream:
>>   
> No - you need to calls something like LT(1) first - otherwise all methods have 
> to check for init which is an overhead that isn't really needed.

Except that all public methods except .size() and .consume() already do
(directly or indirectly) perform this check. That is, almost all of the
overhead is being paid already -- and is needed, since the generated
parser code doesn't ensure that it calls LT, or any other single method,
first.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From s.barnett-cormack at lancaster.ac.uk  Fri Aug 14 15:56:46 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Fri, 14 Aug 2009 23:56:46 +0100
Subject: [antlr-interest] ANTLR Javadocs
Message-ID: <4A85EBAE.6060102@lancaster.ac.uk>

I remember a conversation about this before, but now I have a specific 
request that doesn't seem to have been fulfilled...

It'd be nice to have *online* viewable javadocs for ANTLR (and 
StringTemplate), as appears very easily if you have a maven-generated 
project site... I'd like this purely so that my generated javadocs 
cleanly link to it, automatically (with some config).

Any chance of this happening, or if it has, where is it?

-- 
Sam Barnett-Cormack

From kevin.trainer at bankofamerica.com  Fri Aug 14 16:08:12 2009
From: kevin.trainer at bankofamerica.com (Trainer, Kevin)
Date: Fri, 14 Aug 2009 16:08:12 -0700
Subject: [antlr-interest] Ruby Target
Message-ID: <876602C0E3977743BD1C71DDDA78C527656F87@ex2k.bankofamerica.com>

I am new to Antlr and Antlr Works.  I have a ruby project that uses a
DSL and would like to replace my custom parser with an ANTLR parser.
The problem is I cant seem to create a Ruby target.  I downloaded the
latest ANTLR tar and installed it but it doesn't appear to have the
required files for the Ruby Target.  I can see Perl5,C, Python and
Javascript but no Ruby.  Where can I get the required files to create a
Ruby Target?

 

Kevin Trainer

Cnslt - Apps Prog

PT-NexOS Database Team

(818) 597-4958

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090814/471472e1/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Trainer, Kevin.vcf
Type: text/x-vcard
Size: 452 bytes
Desc: Trainer, Kevin.vcf
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090814/471472e1/attachment.vcf 

From jimi at temporal-wave.com  Fri Aug 14 17:22:45 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 14 Aug 2009 17:22:45 -0700
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A85EA16.1050304@jacaranda.org>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>
	<4A85EA16.1050304@jacaranda.org>
Message-ID: <4A85FFD5.4030608@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090814/a31ad684/attachment.html 

From rsteiger at ensemblesoft.net  Fri Aug 14 17:35:20 2009
From: rsteiger at ensemblesoft.net (Richard Steiger)
Date: Fri, 14 Aug 2009 17:35:20 -0700
Subject: [antlr-interest] Getting weird jar error on antlr-3.1.3.jar
Message-ID: <058901ca1d40$4591dca0$d0b595e0$@net>

FWIW, I'm a first-timer on this list.

 

When attempting to list the contents of antlr-3.1.3.jar, I get the following
output (stderr + stdout):

 

META-INF/

META-INF/MANIFEST.MF

META-INF/maven/

META-INF/maven/org.antlr/

META-INF/maven/org.antlr/antlr/

META-INF/maven/org.antlr/antlr/pom.properties

META-INF/maven/org.antlr/antlr/pom.xml

META-INF/maven/org.antlr/antlr-runtime/

META-INF/maven/org.antlr/antlr-runtime/pom.properties

META-INF/maven/org.antlr/antlr-runtime/pom.xml

antlr/

antlr/ActionElement.class

antlr/actions/

antlr/actions/cpp/

java.io.EOFException: Unexpected end of ZLIB input stream

                at
java.util.zip.InflaterInputStream.fill(InflaterInputStream.java:223)

                at
java.util.zip.InflaterInputStream.read(InflaterInputStream.java:141)

                at
java.util.zip.ZipInputStream.read(ZipInputStream.java:146)

                at
java.util.zip.ZipInputStream.closeEntry(ZipInputStream.java:92)

                at sun.tools.jar.Main.list(Main.java:863)

                at sun.tools.jar.Main.run(Main.java:212)

                at sun.tools.jar.Main.main(Main.java:1022)

 

I've tried re-downloading the source distro twice, and tried the jar.exe in
both jdk1.5.0_15 and jdk1.6.0_13 (on Windoze), it's solidly repeatable.

 

Any ideas?

 

Thanks,

 

 

Richard Steiger

Founder & CTO, Ensemble Software Systems, Inc.

email: rsteiger at ensemblesoft.net

ph: 425.822.7423

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090814/0574bbee/attachment.html 

From gwlist at grahamwideman.com  Fri Aug 14 17:55:35 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Fri, 14 Aug 2009 17:55:35 -0700
Subject: [antlr-interest] Getting weird jar error on antlr-3.1.3.jar
In-Reply-To: <058901ca1d40$4591dca0$d0b595e0$@net>
Message-ID: <4.1.20090814174947.07a7e948@grahamwideman.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090814/72c0a447/attachment.html 

From williamstw at gmail.com  Fri Aug 14 18:54:21 2009
From: williamstw at gmail.com (Tim Williams)
Date: Fri, 14 Aug 2009 21:54:21 -0400
Subject: [antlr-interest] tree rewrite ambiguous enclosing
	rule/referenced in production
In-Reply-To: <4a84085c.0508c00a.4239.53d7SMTPIN_ADDED@mx.google.com>
References: <499888440908121845udde857ei3a9edbe25373d7e@mail.gmail.com>
	<4a84085c.0508c00a.4239.53d7SMTPIN_ADDED@mx.google.com>
Message-ID: <499888440908141854o6b7415d3j160bdfa95b452479@mail.gmail.com>

On Thu, Aug 13, 2009 at 8:34 AM, Gavin Lambert<antlr at mirality.co.nz> wrote:
> At 13:45 13/08/2009, Tim Williams wrote:
>>For the scopedClause rule below, I'm getting this error(132):
>>"$scopedClause is ambiguous; rule scopedClause is enclosing rule
>>and referenced in the production (assuming enclosing rule)"
> [...]
>>scopedClause:
>> ? ? ? LPAREN (scopedClause->scopedClause) ((OR_TOKEN s2=scopedClause)
>>->
>>^(OR $scopedClause $s2))+ RPAREN
>> ? ?| LPAREN (scopedClause->scopedClause) ((AND_TOKEN
>>s2=scopedClause)
>>-> ^(AND $scopedClause $s2))+ RPAREN
>> ? ?| LPAREN (scopedClause->scopedClause) ((NOT_TOKEN
>>s2=scopedClause)
>>-> ^(NOT $scopedClause $s2))+ RPAREN
>> ? ? ? | searchClause
>> ? ? ? ? ? ? ? -> searchClause
>> ? ? ? ;
>
> I think the warning will go away if you explicitly label the first path --
> ie. replace all of your (scopedClause->scopedClause) fragments with
> (s1=scopedClause->$s1). ?(Using $scopedClause in the second rewrite is
> correct though, and should be left like that.)

Unfortunately the error does not go away.  Is there a way to
explicitly reference the outer/parent/whatever-its-called clause?

> You could, however, improve performance by first left factoring it:
>
> scopedClause
> ?: ?LPAREN (s1=scopedClause -> $s1)
> ? ? ( ?OR_TOKEN s2=scopedClause -> ^(OR $scopedClause $s2)
> ? ? | ?AND_TOKEN s2=scopedClause -> ^(AND $scopedClause $s2)
> ? ? | ?NOT_TOKEN s2=scopedClause -> ^(NOT $scopedClause $s2)
> ? ? )+ RPAREN
> ?| ?searchClause -> searchClause
> ?;

I don't think that's a 1-to-1 refactoring.  I'm wanting to require
parens around heterogeneous clauses but not around homogeneous clauses
(e.g.
(cat or dog or mouse) => is ok
(cat or dog and mouse) => parse error

essentially forcing a user into explicit precedence.  My quick tests
leads me to think this isn't exactly the same as what I had?

> (Although that begs the question: is NOT really a binary operator in your
> language?

Well, it's a good question, the language[1] I'm trying to implement
does treat it as a binary operator.

> And is 'LPAREN searchClause RPAREN' supposed to be illegal?
> ?Because as it stands, both are the case.)

Yeah, I think that's a result of the "forced outer parens" problem
I've got.  I want to achieve what described above but haven't figured
out a way to do it yet that doesn't require parens on the outermost
statement.  I'm living with it for now, trying to crawl, walk, run...

Thanks,
--tim

[1] - http://www.loc.gov/standards/sru/specs/cql.html#bnf

From achintmehta at gmail.com  Fri Aug 14 22:41:32 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Sat, 15 Aug 2009 01:41:32 -0400
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
Message-ID: <4a3315250908142241t5840caas6f05831383d7c370@mail.gmail.com>

Hi All,

The section "Ambiguities and Non determinisms" of the book "The definitive
ANTLR guide" talks about the ambiguities in lexer rules, but I am not sure
how to resolve them.

Consider a following grammar which assigns a value to an ID. The ID can
either be VERSION or COUNT while its value can be anything:
-----------------------------------------------
grammar sample_parser;

requestline : ver EQUAL SPECIAL_STRING ;

/* Tokens */
ver:('VERSION'| 'V') {}
      | ('COUNT' | 'C') {} ;


SPECIAL_STRING:(CHAR)+ ;
WHITESPACE: ' ';
NEWLINE: ('\r')? '\n';
EQUAL: '=';

fragment
CHAR: (('a'..'z')|('A'..'Z'));
-----------------------------------------------

If the input is given as
VERSION=FIRST
Then it works, but if following input is given
VERSION=VERSION
Then I get an error (MissingTokenException after the "=").

How can this ambiguity be resolved ?

Thanks in advance.

Regards,
Achint
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/83c3cc1b/attachment.html 

From newsreply at areeda.com  Sat Aug 15 00:34:14 2009
From: newsreply at areeda.com (Joseph Areeda)
Date: Sat, 15 Aug 2009 00:34:14 -0700
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
In-Reply-To: <4a3315250908142241t5840caas6f05831383d7c370@mail.gmail.com>
References: <4a3315250908142241t5840caas6f05831383d7c370@mail.gmail.com>
Message-ID: <4A8664F6.4090601@areeda.com>

I don't see this as an ambiguity issue but rather a decision of whether 
your grammar uses reserved words or not.
I'm not an expert by any means but that doesn't mean I don't have an 
opinion just that you should take it with a grain of salt.

You can either handle this with a symbol table later in the process or 
rewrite the requestline to something like
requestline : ver EQUAL (SPECIAL_STRING | ver);

Joe


Achint Mehta wrote:
> Hi All,
>
> The section "Ambiguities and Non determinisms" of the book "The 
> definitive ANTLR guide" talks about the ambiguities in lexer rules, 
> but I am not sure how to resolve them.
>
> Consider a following grammar which assigns a value to an ID. The ID 
> can either be VERSION or COUNT while its value can be anything:
> -----------------------------------------------
> grammar sample_parser;
>
> requestline : ver EQUAL SPECIAL_STRING ;
>
> /* Tokens */
> ver:('VERSION'| 'V') {}
>       | ('COUNT' | 'C') {} ;
>
>    
> SPECIAL_STRING:(CHAR)+ ;
> WHITESPACE: ' ';
> NEWLINE: ('\r')? '\n';
> EQUAL: '=';
>
> fragment
> CHAR: (('a'..'z')|('A'..'Z'));
> -----------------------------------------------
>
> If the input is given as
> VERSION=FIRST
> Then it works, but if following input is given
> VERSION=VERSION
> Then I get an error (MissingTokenException after the "=").
>
> How can this ambiguity be resolved ?
>
> Thanks in advance.
>
> Regards,
> Achint
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/b8f1fca8/attachment.html 

From jimi at temporal-wave.com  Sat Aug 15 05:33:25 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 15 Aug 2009 05:33:25 -0700
Subject: [antlr-interest] Getting weird jar error on antlr-3.1.3.jar
In-Reply-To: <058901ca1d40$4591dca0$d0b595e0$@net>
References: <058901ca1d40$4591dca0$d0b595e0$@net>
Message-ID: <4A86AB15.8000004@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/95b2d044/attachment.html 

From jimi at temporal-wave.com  Sat Aug 15 05:41:38 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 15 Aug 2009 05:41:38 -0700
Subject: [antlr-interest] tree rewrite ambiguous
 enclosing	rule/referenced in production
In-Reply-To: <499888440908141854o6b7415d3j160bdfa95b452479@mail.gmail.com>
References: <499888440908121845udde857ei3a9edbe25373d7e@mail.gmail.com>	<4a84085c.0508c00a.4239.53d7SMTPIN_ADDED@mx.google.com>
	<499888440908141854o6b7415d3j160bdfa95b452479@mail.gmail.com>
Message-ID: <4A86AD02.2040508@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/22c6fe2d/attachment.html 

From marwan.alephn at gmail.com  Sat Aug 15 06:44:21 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Sat, 15 Aug 2009 15:44:21 +0200
Subject: [antlr-interest] Lexer rules
Message-ID: <6535fcb50908150644g5eda2f36w35872997a2e5c605@mail.gmail.com>

Hi everybody;

Having this lexer rules, parsing the input doesn't recognize 'integer'
as a type, only recognize types vector of integer as a token like
integer[] or integet[][][].

CORCHE_CIERE:']';

CORCHE_ABRE: '[';

fragment ENTERO_T: 'integer';

ENTERO_V: ENTERO_T(CORCHE_ABRE CORCHE_CIERE)*;

Am i missing something; I did try without fragment, and the same result.

Thx for any help,


-- 
Marouane

From s.barnett-cormack at lancaster.ac.uk  Sat Aug 15 07:26:22 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Sat, 15 Aug 2009 15:26:22 +0100
Subject: [antlr-interest] Lexer rules
In-Reply-To: <6535fcb50908150644g5eda2f36w35872997a2e5c605@mail.gmail.com>
References: <6535fcb50908150644g5eda2f36w35872997a2e5c605@mail.gmail.com>
Message-ID: <4A86C58E.5010101@lancaster.ac.uk>

Marwan Ajraoui wrote:
> Hi everybody;
> 
> Having this lexer rules, parsing the input doesn't recognize 'integer'
> as a type, only recognize types vector of integer as a token like
> integer[] or integet[][][].
> 
> CORCHE_CIERE:']';
> 
> CORCHE_ABRE: '[';
> 
> fragment ENTERO_T: 'integer';
> 
> ENTERO_V: ENTERO_T(CORCHE_ABRE CORCHE_CIERE)*;
> 
> Am i missing something; I did try without fragment, and the same result.

Off the top of my head, it should match any of 'integer', 'integer[]' 
and 'interger[][][]' as ENTERO_V tokens.

I think there's some rethinking wants to be done between what is in the 
lexer and what is in the parser. For example, isn't '[]' really an 
operator, or modifier, and wants to be dealt with in the parser, not 
bundled into the same token?

-- 
Sam Barnett-Cormack

From jimi at temporal-wave.com  Sat Aug 15 07:59:58 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 15 Aug 2009 07:59:58 -0700
Subject: [antlr-interest] Lexer rules
In-Reply-To: <4A86C58E.5010101@lancaster.ac.uk>
References: <6535fcb50908150644g5eda2f36w35872997a2e5c605@mail.gmail.com>
	<4A86C58E.5010101@lancaster.ac.uk>
Message-ID: <4A86CD6E.8000806@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/cef98ca6/attachment.html 

From marwan.alephn at gmail.com  Sat Aug 15 08:47:20 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Sat, 15 Aug 2009 17:47:20 +0200
Subject: [antlr-interest] Lexer rules
In-Reply-To: <4A86CD6E.8000806@temporal-wave.com>
References: <6535fcb50908150644g5eda2f36w35872997a2e5c605@mail.gmail.com>
	<4A86C58E.5010101@lancaster.ac.uk>
	<4A86CD6E.8000806@temporal-wave.com>
Message-ID: <6535fcb50908150847l35863af6ic9d4d37d6e4cb933@mail.gmail.com>

Hi;

Now it works when I added the rule tipo with this rules.

tipo  : (ENTERO_V | REAL_V | DOBLE_V | CARACTER_V | CADENA_V | LOGICO_V) ;

ENTERO_V: ENTERO_T(CORCHE_ABRE CORCHE_CIERE)*;

fragment ENTERO_T: 'integer';

...

Now I will try my tree matcher Jim;

Many thx for your help guys;

Cheers.




2009/8/15 Jim Idle <jimi at temporal-wave.com>:
> Sam Barnett-Cormack wrote:
>
> Marwan Ajraoui wrote:
>
>
> Hi everybody;
>
> Having this lexer rules, parsing the input doesn't recognize 'integer'
> as a type, only recognize types vector of integer as a token like
> integer[] or integet[][][].
>
> CORCHE_CIERE:']';
>
> CORCHE_ABRE: '[';
>
> fragment ENTERO_T: 'integer';
>
> ENTERO_V: ENTERO_T(CORCHE_ABRE CORCHE_CIERE)*;
>
> Am i missing something; I did try without fragment, and the same result.
>
>
> Off the top of my head, it should match any of 'integer', 'integer[]'
> and 'interger[][][]' as ENTERO_V tokens.
>
> I think there's some rethinking wants to be done between what is in the
> lexer and what is in the parser. For example, isn't '[]' really an
> operator, or modifier, and wants to be dealt with in the parser, not
> bundled into the same token?
>
>
>
> ENTERO_T needs to be a non-fragment, ENTERO_V needs to be a parser rule, you
> need to cater for whitespace and so on...
>
> CORCHE_CIERE : ']';
>
> CORCHE_ABRE  : '[';
>
> ENTERO_T     : 'integer';
>
>
> entero_v     : ENTERO_T (CORCHE_ABRE CORCHE_CIERE)* EOF;
>
>
> Jim
>
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>



-- 
Marouane

From david-sarah at jacaranda.org  Sat Aug 15 09:12:10 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sat, 15 Aug 2009 17:12:10 +0100
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A85FFD5.4030608@temporal-wave.com>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>	<4A85EA16.1050304@jacaranda.org>
	<4A85FFD5.4030608@temporal-wave.com>
Message-ID: <4A86DE5A.4050304@jacaranda.org>

Jim Idle wrote:
> David-Sarah Hopwood wrote:
>> Jim Idle wrote:
>>> David-Sarah Hopwood wrote:
>>>> Gavin Lambert wrote:
>>>>       
>>>>> At 10:12 14/08/2009, consiliens at gmail.com wrote:
>>>>>  >QuizLexer lexer = new QuizLexer(new ANTLRFileStream(input));
>>>>>  >CommonTokenStream tokens = new CommonTokenStream(lexer);
>>>>>  >// prints 0
>>>>>  >System.out.println(tokens.size());
>>>>>  >
>>>>>  >So according to this there are no tokens, which would explain 
>>>>>  >the blank debugger Input window. If the ANTLRWorks Interpreter runs
>>>>>  >the code correctly, why not the Debugger or unit tests?
>>>>>
>>>>> Actually that's a bit deceptive :)
>>>>>
>>>>> The stream starts out empty, and thus .size() returns 0.
>>>>>         
>>>> You're right, and that seems like a bug. In CommonTokenStream:  
>>>    
>>> No - you need to calls something like LT(1) first - otherwise all methods have 
>>> to check for init which is an overhead that isn't really needed.
>>
>> Except that all public methods except .size() and .consume() already do
>> (directly or indirectly) perform this check. That is, almost all of the
>> overhead is being paid already -- and is needed, since the generated
>> parser code doesn't ensure that it calls LT, or any other single method,
>> first.
> 
> Parser calls token stream, it checks for empty stream, then fills buffer.

Yes, and that check is implemented by testing for p == -1 in all of the
public methods of CommonTokenStream except .size() and .consume().

The omission of .size() and .consume() is a bug. Adding the check to
.size() wouldn't have any significant performance impact, since it's
not a frequently called method. Not adding it to .consume() on performance
grounds would be premature optimization. (There are obvious optimizations
to .consume() and .skipOffTokenChannels(int) that would more than offset
this, *if* profiling showed that it were important to do so.)

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From achintmehta at gmail.com  Sat Aug 15 16:08:33 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Sat, 15 Aug 2009 19:08:33 -0400
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
In-Reply-To: <4a3315250908151535l3b6870c9o35390a6a47c6ebb1@mail.gmail.com>
References: <4a3315250908151535l3b6870c9o35390a6a47c6ebb1@mail.gmail.com>
Message-ID: <4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>

Hi Joe,

Thanks for your response.

You have proposed two solutions:
1. Replace ver with SPECIAL_STRING and check in the target code for allowed
values. This means that if I intent to collect a generic unquoted string in
a antlr parser, then I cannot use any tokens in the whole parser. In a big
parser, this seems to be a limitation, which means that the target language
program validates every string where token should have been placed in the
parser.

2. The second option is that all the tokens have to given as alternate
rules/token with SPECIAL_STRING. Again, in a big/complicated parser, all the
tokens in the whole parser have to be repeated where-ever I intend to use
the SPECIAL_STRING. This can be simplified if I give the tokens in the
definition of SPECIAL_STRING iteself. But still in a parser which could use
tens or hundreds of tokens, it would seem to be impractical to repeat all
the tokens in SPECIAL_STRING rule and other similar rules (intended for
collecting the generic string).

The parser that I have put in the e-mail is a simplified version of the
issue I am facing. I am writing a SIP protocol message parser. The very
first line of a SIP message starts as (I am compressing the rules for
clarity):

Method SPACE Request-URI ... (other rules follow)
Method: "INVITE" | "ACK" | "OPTIONS" | "BYE" | "CANCEL" | "REGISTER"
Request-URI boils down to : "sip:" [userinfo "@"] hostport url-parameters
[headers]
and userinfo is an unquoted alpha-numeric string.

if the SIP starts as REGISTER SIP:REGISTER at ...
The parsing would fail if I write the rules as I mentioned in my sample
program earlier.
SIP protocol is filled with rules such as userinfo where unquoted
alphs-numeric strings have to be collected and there are tens of tokens in
its grammar. This is a typical scenario for any protocol grammar. I am not
sure  repeating all tokens in rules or treating everything as genric string
would be a neat solution.

I admit that I am a noob when it comes to familarity with other
lexers/parsers, and rest of them might require some other work-around as
well. But situation seems to be pretty common enough to have a straight
solution (though I might be wrong).

Thanks.

Regards,
Achint


>
> I don't see this as an ambiguity issue but rather a decision of whether
> your grammar uses reserved words or not.
> I'm not an expert by any means but that doesn't mean I don't have an
> opinion just that you should take it with a grain of salt.
>
> You can either handle this with a symbol table later in the process or
> rewrite the requestline to something like
> requestline : ver EQUAL (SPECIAL_STRING | ver);
>
> Joe
>
>
> Achint Mehta wrote:
> > Hi All,
> >
> > The section "Ambiguities and Non determinisms" of the book "The
> > definitive ANTLR guide" talks about the ambiguities in lexer rules,
> > but I am not sure how to resolve them.
> >
> > Consider a following grammar which assigns a value to an ID. The ID
> > can either be VERSION or COUNT while its value can be anything:
> > -----------------------------------------------
> > grammar sample_parser;
> >
> > requestline : ver EQUAL SPECIAL_STRING ;
> >
> > /* Tokens */
> > ver:('VERSION'| 'V') {}
> >       | ('COUNT' | 'C') {} ;
> >
> >
> > SPECIAL_STRING:(CHAR)+ ;
> > WHITESPACE: ' ';
> > NEWLINE: ('\r')? '\n';
> > EQUAL: '=';
> >
> > fragment
> > CHAR: (('a'..'z')|('A'..'Z'));
> > -----------------------------------------------
> >
> > If the input is given as
> > VERSION=FIRST
> > Then it works, but if following input is given
> > VERSION=VERSION
> > Then I get an error (MissingTokenException after the "=").
> >
> > How can this ambiguity be resolved ?
> >
> > Thanks in advance.
> >
> > Regards,
> > Achint
> > ------------------------------------------------------------------------
> >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/8180a68a/attachment.html 

From rsteiger at ensemblesoft.net  Sat Aug 15 16:09:11 2009
From: rsteiger at ensemblesoft.net (Richard Steiger)
Date: Sat, 15 Aug 2009 16:09:11 -0700
Subject: [antlr-interest] Getting weird jar error on antlr-3.1.3.jar
In-Reply-To: <4.1.20090814174947.07a7e948@grahamwideman.com>
References: <058901ca1d40$4591dca0$d0b595e0$@net>
	<4.1.20090814174947.07a7e948@grahamwideman.com>
Message-ID: <007401ca1dfd$67405080$35c0f180$@net>

Graham and Jim,

 

Thanks for attempting to help.  It took me a while to root-cause: the
"source distribution" jar has the same filename as the "Complete"
distribution, and the former contains the latter.  When unjarring, when the
latter is unpacked, it clobbers the former, causing the unzip fault.  

 

Terrence: May I suggest not overloading jar names in the future?  And while
I have the mike, thanks for creating such an amazingly powerful toolbox!
I've been using it since V1, I can't remember Life Before Antlr, and it just
keeps getting better and better.  Kudos!

 

-rjs

 

From: Graham Wideman [mailto:gwlist at grahamwideman.com] 
Sent: Friday, August 14, 2009 5:56 PM
To: Richard Steiger; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Getting weird jar error on antlr-3.1.3.jar

 

Hi Richard,

I jJust tried it like this:

D:\Antlr20090807\antlr-3.1.3\lib>jar -tf antlr-3.1.3.jar >
antlr_3.1.3_jar_out.txt

(Note to others -- you need the "f" flag along with t, even tho you'd think
that the f action would be default.) 

... and it ran to completion fine, no errors, complete listing.

I'm running:
D:\Antlr20090807\antlr-3.1.3\lib>java -version
java version "1.6.0_14"
Java(TM) SE Runtime Environment (build 1.6.0_14-b08)
Java HotSpot(TM) Client VM (build 14.0-b16, mixed mode, sharing)

On Windows XP SP3.

Hope that helps.

-- Graham



At 8/14/2009 05:35 PM, Richard Steiger wrote: 




FWIW, I m a first-timer on this list.

When attempting to list the contents of antlr-3.1.3.jar, I get the following
output (stderr + stdout):

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/28ff126a/attachment.html 

From newsreply at areeda.com  Sat Aug 15 17:34:40 2009
From: newsreply at areeda.com (Joseph Areeda)
Date: Sat, 15 Aug 2009 17:34:40 -0700
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
In-Reply-To: <4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>
References: <4a3315250908151535l3b6870c9o35390a6a47c6ebb1@mail.gmail.com>
	<4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>
Message-ID: <4A875420.10408@areeda.com>

Achint,

I am a newbie here too.  I don't mean to talk form a position of authority.

The trick is do you have keywords that are reserved.  Can you say in 
your language that Integer is a "type" or is it merely a string and only 
in certain contexts does it have a meaning?

Yes it is restrictive to have reserved words but it makes the parsing 
much easier.

Joe

Achint Mehta wrote:
> Hi Joe,
>
> Thanks for your response.
>
> You have proposed two solutions:
> 1. Replace ver with SPECIAL_STRING and check in the target code for 
> allowed values. This means that if I intent to collect a generic 
> unquoted string in a antlr parser, then I cannot use any tokens in the 
> whole parser. In a big parser, this seems to be a limitation, which 
> means that the target language program validates every string where 
> token should have been placed in the parser.
>
> 2. The second option is that all the tokens have to given as alternate 
> rules/token with SPECIAL_STRING. Again, in a big/complicated parser, 
> all the tokens in the whole parser have to be repeated where-ever I 
> intend to use the SPECIAL_STRING. This can be simplified if I give the 
> tokens in the definition of SPECIAL_STRING iteself. But still in a 
> parser which could use tens or hundreds of tokens, it would seem to be 
> impractical to repeat all the tokens in SPECIAL_STRING rule and other 
> similar rules (intended for collecting the generic string).
>
> The parser that I have put in the e-mail is a simplified version of 
> the issue I am facing. I am writing a SIP protocol message parser. The 
> very first line of a SIP message starts as (I am compressing the rules 
> for clarity):
>
> Method SPACE Request-URI ... (other rules follow)
> Method: "INVITE" | "ACK" | "OPTIONS" | "BYE" | "CANCEL" | "REGISTER"
> Request-URI boils down to : "sip:" [userinfo "@"] hostport 
> url-parameters [headers]
> and userinfo is an unquoted alpha-numeric string.
>
> if the SIP starts as REGISTER SIP:REGISTER at ...
> The parsing would fail if I write the rules as I mentioned in my 
> sample program earlier.
> SIP protocol is filled with rules such as userinfo where unquoted 
> alphs-numeric strings have to be collected and there are tens of 
> tokens in its grammar. This is a typical scenario for any protocol 
> grammar. I am not sure  repeating all tokens in rules or treating 
> everything as genric string would be a neat solution.
>
> I admit that I am a noob when it comes to familarity with other 
> lexers/parsers, and rest of them might require some other work-around 
> as well. But situation seems to be pretty common enough to have a 
> straight solution (though I might be wrong).
>
> Thanks.
>
> Regards,
> Achint 
>
>
>
>     I don't see this as an ambiguity issue but rather a decision of
>     whether
>     your grammar uses reserved words or not.
>     I'm not an expert by any means but that doesn't mean I don't have an
>     opinion just that you should take it with a grain of salt.
>
>     You can either handle this with a symbol table later in the process or
>     rewrite the requestline to something like
>     requestline : ver EQUAL (SPECIAL_STRING | ver);
>
>     Joe
>
>
>     Achint Mehta wrote:
>     > Hi All,
>     >
>     > The section "Ambiguities and Non determinisms" of the book "The
>     > definitive ANTLR guide" talks about the ambiguities in lexer rules,
>     > but I am not sure how to resolve them.
>     >
>     > Consider a following grammar which assigns a value to an ID. The ID
>     > can either be VERSION or COUNT while its value can be anything:
>     > ------------------------------
>     -----------------
>     > grammar sample_parser;
>     >
>     > requestline : ver EQUAL SPECIAL_STRING ;
>     >
>     > /* Tokens */
>     > ver:('VERSION'| 'V') {}
>     >       | ('COUNT' | 'C') {} ;
>     >
>     >
>     > SPECIAL_STRING:(CHAR)+ ;
>     > WHITESPACE: ' ';
>     > NEWLINE: ('\r')? '\n';
>     > EQUAL: '=';
>     >
>     > fragment
>     > CHAR: (('a'..'z')|('A'..'Z'));
>     > -----------------------------------------------
>     >
>     > If the input is given as
>     > VERSION=FIRST
>     > Then it works, but if following input is given
>     > VERSION=VERSION
>     > Then I get an error (MissingTokenException after the "=").
>     >
>     > How can this ambiguity be resolved ?
>     >
>     > Thanks in advance.
>     >
>     > Regards,
>     > Achint
>     >
>     ------------------------------------------------------------------------
>     >
>     >
>     > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>     > Unsubscribe:
>     http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>     >
>
>
> ------------------------------------------------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/9a9eb838/attachment.html 

From achintmehta at gmail.com  Sat Aug 15 19:19:45 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Sat, 15 Aug 2009 22:19:45 -0400
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
In-Reply-To: <4A875420.10408@areeda.com>
References: <4a3315250908151535l3b6870c9o35390a6a47c6ebb1@mail.gmail.com>
	<4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>
	<4A875420.10408@areeda.com>
Message-ID: <4a3315250908151919i1cc02525p2cd24e9a2f769609@mail.gmail.com>

Hi Joe,

I appreciate you helping me.
I am learning ANTLR, and from time to time need some ideas for
brainstorming.

The SIP parser I am working on parses SIP protocol message. SIP protocol is
text based, like HTTP.

There are places where only select keywords can appear but these keywords
can appear in other places also as normal string (with or without quotes).
So the keywords are not reserved in true sense.

Also, the integer is not a strict data-type. An input pattern 12 (without
any quotes) can be treated as integer or a normal string depending where it
is occurring.

I wish I could control the syntax/semantics of the language but SIP is a
well established protocol.

Thanks again.

Regards,
Achint

On Sat, Aug 15, 2009 at 8:34 PM, Joseph Areeda <newsreply at areeda.com> wrote:

>  Achint,
>
> I am a newbie here too.  I don't mean to talk form a position of authority.
>
> The trick is do you have keywords that are reserved.  Can you say in your
> language that Integer is a "type" or is it merely a string and only in
> certain contexts does it have a meaning?
>
> Yes it is restrictive to have reserved words but it makes the parsing much
> easier.
>
> Joe
>
> Achint Mehta wrote:
>
> Hi Joe,
>
> Thanks for your response.
>
> You have proposed two solutions:
> 1. Replace ver with SPECIAL_STRING and check in the target code for allowed
> values. This means that if I intent to collect a generic unquoted string in
> a antlr parser, then I cannot use any tokens in the whole parser. In a big
> parser, this seems to be a limitation, which means that the target language
> program validates every string where token should have been placed in the
> parser.
>
> 2. The second option is that all the tokens have to given as alternate
> rules/token with SPECIAL_STRING. Again, in a big/complicated parser, all the
> tokens in the whole parser have to be repeated where-ever I intend to use
> the SPECIAL_STRING. This can be simplified if I give the tokens in the
> definition of SPECIAL_STRING iteself. But still in a parser which could use
> tens or hundreds of tokens, it would seem to be impractical to repeat all
> the tokens in SPECIAL_STRING rule and other similar rules (intended for
> collecting the generic string).
>
> The parser that I have put in the e-mail is a simplified version of the
> issue I am facing. I am writing a SIP protocol message parser. The very
> first line of a SIP message starts as (I am compressing the rules for
> clarity):
>
> Method SPACE Request-URI ... (other rules follow)
> Method: "INVITE" | "ACK" | "OPTIONS" | "BYE" | "CANCEL" | "REGISTER"
> Request-URI boils down to : "sip:" [userinfo "@"] hostport url-parameters
> [headers]
> and userinfo is an unquoted alpha-numeric string.
>
> if the SIP starts as REGISTER SIP:REGISTER at ...
> The parsing would fail if I write the rules as I mentioned in my sample
> program earlier.
> SIP protocol is filled with rules such as userinfo where unquoted
> alphs-numeric strings have to be collected and there are tens of tokens in
> its grammar. This is a typical scenario for any protocol grammar. I am not
> sure  repeating all tokens in rules or treating everything as genric string
> would be a neat solution.
>
> I admit that I am a noob when it comes to familarity with other
> lexers/parsers, and rest of them might require some other work-around as
> well. But situation seems to be pretty common enough to have a straight
> solution (though I might be wrong).
>
> Thanks.
>
> Regards,
> Achint
>
>
>>
>> I don't see this as an ambiguity issue but rather a decision of whether
>> your grammar uses reserved words or not.
>> I'm not an expert by any means but that doesn't mean I don't have an
>> opinion just that you should take it with a grain of salt.
>>
>> You can either handle this with a symbol table later in the process or
>> rewrite the requestline to something like
>> requestline : ver EQUAL (SPECIAL_STRING | ver);
>>
>> Joe
>>
>>
>> Achint Mehta wrote:
>> > Hi All,
>> >
>> > The section "Ambiguities and Non determinisms" of the book "The
>> > definitive ANTLR guide" talks about the ambiguities in lexer rules,
>> > but I am not sure how to resolve them.
>> >
>> > Consider a following grammar which assigns a value to an ID. The ID
>> > can either be VERSION or COUNT while its value can be anything:
>> > ------------------------------ -----------------
>> > grammar sample_parser;
>> >
>> > requestline : ver EQUAL SPECIAL_STRING ;
>> >
>> > /* Tokens */
>> > ver:('VERSION'| 'V') {}
>> >       | ('COUNT' | 'C') {} ;
>> >
>> >
>> > SPECIAL_STRING:(CHAR)+ ;
>> > WHITESPACE: ' ';
>> > NEWLINE: ('\r')? '\n';
>> > EQUAL: '=';
>> >
>> > fragment
>> > CHAR: (('a'..'z')|('A'..'Z'));
>> > -----------------------------------------------
>> >
>> > If the input is given as
>> > VERSION=FIRST
>> > Then it works, but if following input is given
>> > VERSION=VERSION
>> > Then I get an error (MissingTokenException after the "=").
>> >
>> > How can this ambiguity be resolved ?
>> >
>> > Thanks in advance.
>> >
>> > Regards,
>> > Achint
>> > ------------------------------------------------------------------------
>> >
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> >
>>
>
> ------------------------------
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090815/b19ec520/attachment.html 

From achintmehta at gmail.com  Sat Aug 15 23:29:28 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Sun, 16 Aug 2009 02:29:28 -0400
Subject: [antlr-interest] Bypassing Lexical phase
Message-ID: <4a3315250908152329h6e80bcd9te2e63f30fb06c305@mail.gmail.com>

Hi All,

Is it possible to bypass the lexical phase and jump right onto the parsing
phase ?

Thanks.

Regards,
Achint
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/5fac1f06/attachment.html 

From rsteiger at ensemblesoft.net  Sun Aug 16 00:04:36 2009
From: rsteiger at ensemblesoft.net (Richard Steiger)
Date: Sun, 16 Aug 2009 00:04:36 -0700
Subject: [antlr-interest] Some sources missing from 3.1.3 source distro?
In-Reply-To: <4a3315250908152329h6e80bcd9te2e63f30fb06c305@mail.gmail.com>
References: <4a3315250908152329h6e80bcd9te2e63f30fb06c305@mail.gmail.com>
Message-ID: <00af01ca1e3f$d115cc00$73416400$@net>

Hi all,

 

I'm trying to get my head around how recognizer generation works in V3, by
stepping through a Tool run on a test grammar.  I'm using ANTLR 3.1.3, and
am hitting a wall when execution dives into
org.antlr.grammar.v2.DefineGrammarItemsWalker .  It seems that the source
for all org.antlr.grammar.* Java packages is missing from ANTLR 3.1.3 source
<http://antlr.org/download/antlr-3.1.3.tar.gz>  distribution, but is present
in ANTLR 3.1.2 source <http://antlr.org/download/antlr-3.1.2.tar.gz>
distribution.  Are these sources anywhere to be had?

 

-rjs

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/e69ebb10/attachment.html 

From jeroen.v.schagen at gmail.com  Sun Aug 16 01:33:39 2009
From: jeroen.v.schagen at gmail.com (jeroen.v.schagen at gmail.com)
Date: Sun, 16 Aug 2009 08:33:39 +0000
Subject: [antlr-interest] rule is ambiguous (tree grammar)
Message-ID: <0015174c410060418904713e2497@google.com>

The below parser grammar works, however when copying the rewrite rules into  
my tree grammar (as stated in the book). I seem to get the following error:  
reference $markupChain is ambiguous; rule markupChain is enclosing rule and  
referenced in the production (assuming enclosing rule). Anybody knows a  
solution that will fix my tree grammar?

Thanks in advance,
Jeroen


Parser grammar

markupChain: markup markupChain
-> ^( MARKUP_CHAIN markup markupChain )
| expression ';'
-> ^( MARKUP_CHAIN expression ';' )
| statement
-> ^( MARKUP_CHAIN statement )
| embedding ';'
-> ^( MARKUP_CHAIN embedding ';' )
| ';'
-> ^( MARKUP_CHAIN ';' ) ;

Tree grammar

markupChain: ^( MARKUP_CHAIN markup markupChain )
| ^( MARKUP_CHAIN expression ';' )
| ^( MARKUP_CHAIN statement )
| ^( MARKUP_CHAIN embedding ';' )
| ^( MARKUP_CHAIN ';' ) ;

URL:  
http://code.google.com/p/waebric/source/browse/trunk/implementations/java/antlr/src/main/grammar/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/89c1034d/attachment.html 

From jeroen.v.schagen at gmail.com  Sun Aug 16 01:39:48 2009
From: jeroen.v.schagen at gmail.com (jeroen.v.schagen at gmail.com)
Date: Sun, 16 Aug 2009 08:39:48 +0000
Subject: [antlr-interest] rule is ambiguous (tree grammar)
In-Reply-To: <0015174c410060418904713e2497@google.com>
Message-ID: <0015174c11bc646fe004713e3aca@google.com>

Nevermind the above question, the problem was caused by a $markupChain  
reference in my action code.

On Aug 16, 2009 10:33am, jeroen.v.schagen at gmail.com wrote:
> The below parser grammar works, however when copying the rewrite rules  
> into my tree grammar (as stated in the book). I seem to get the following  
> error: reference $markupChain is ambiguous; rule markupChain is enclosing  
> rule and referenced in the production (assuming enclosing rule). Anybody  
> knows a solution that will fix my tree grammar?

> Thanks in advance,
> Jeroen


> Parser grammar

> markupChain: markup markupChain
> -> ^( MARKUP_CHAIN markup markupChain )
> | expression ';'
> -> ^( MARKUP_CHAIN expression ';' )
> | statement
> -> ^( MARKUP_CHAIN statement )
> | embedding ';'
> -> ^( MARKUP_CHAIN embedding ';' )
> | ';'
> -> ^( MARKUP_CHAIN ';' ) ;

> Tree grammar

> markupChain: ^( MARKUP_CHAIN markup markupChain )
> | ^( MARKUP_CHAIN expression ';' )
> | ^( MARKUP_CHAIN statement )
> | ^( MARKUP_CHAIN embedding ';' )
> | ^( MARKUP_CHAIN ';' ) ;

> URL:  
> http://code.google.com/p/waebric/source/browse/trunk/implementations/java/antlr/src/main/grammar/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/192c1a55/attachment.html 

From JALuber at gmx.de  Sun Aug 16 07:31:16 2009
From: JALuber at gmx.de (Johannes Luber)
Date: Sun, 16 Aug 2009 16:31:16 +0200
Subject: [antlr-interest] Ruby Target
In-Reply-To: <876602C0E3977743BD1C71DDDA78C527656F87@ex2k.bankofamerica.com>
References: <876602C0E3977743BD1C71DDDA78C527656F87@ex2k.bankofamerica.com>
Message-ID: <20090816143116.97300@gmx.net>

> I am new to Antlr and Antlr Works.  I have a ruby project that uses a
> DSL and would like to replace my custom parser with an ANTLR parser.
> The problem is I cant seem to create a Ruby target.  I downloaded the
> latest ANTLR tar and installed it but it doesn't appear to have the
> required files for the Ruby Target.  I can see Perl5,C, Python and
> Javascript but no Ruby.  Where can I get the required files to create a
> Ruby Target?

Looking at <http://www.antlr.org/wiki/display/ANTLR3/Code+Generation+Targets> it seems that someone worked on a Ruby target, but gave up. To create a Ruby target you have basically to copy the Java target files and replace any Java specific code with Ruby ones. The code generation site contains two useful links for doing so.

I recommend to ask Ter for a Perforce account as the current files are already moving towards 3.2 and you would need to do less work overall.

Johannes
> 
>  
> 
> Kevin Trainer
> 
> Cnslt - Apps Prog
> 
> PT-NexOS Database Team
> 
> (818) 597-4958
> 
>  
> 

-- 
Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3 -
sicherer, schneller und einfacher! http://portal.gmx.net/de/go/chbrowser

From david-sarah at jacaranda.org  Sun Aug 16 07:45:54 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sun, 16 Aug 2009 15:45:54 +0100
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
In-Reply-To: <4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>
References: <4a3315250908151535l3b6870c9o35390a6a47c6ebb1@mail.gmail.com>
	<4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>
Message-ID: <4A881BA2.8040006@jacaranda.org>

Achint Mehta wrote:
> 2. The second option is that all the tokens have to given as alternate
> rules/token with SPECIAL_STRING. Again, in a big/complicated parser, all the
> tokens in the whole parser have to be repeated where-ever I intend to use
> the SPECIAL_STRING. This can be simplified if I give the tokens in the
> definition of SPECIAL_STRING iteself. But still in a parser which could use
> tens or hundreds of tokens, it would seem to be impractical to repeat all
> the tokens in SPECIAL_STRING rule and other similar rules (intended for
> collecting the generic string).

You only need one rule that collects all of the tokens, which can then be
included as an alternative in SPECIAL_STRING and similar rules. This is
the approach I use for ECMAScript 5 (which has some contexts in which
keywords are treated like identifiers). The duplication is mildly
irritating, but it still works quite well in practice.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From haluongvn at gmail.com  Sun Aug 16 09:34:38 2009
From: haluongvn at gmail.com (Ha Luong)
Date: Sun, 16 Aug 2009 09:34:38 -0700
Subject: [antlr-interest] Couldn't disable RecognitionException
Message-ID: <61577c8f0908160934hcf71616vfc545f67fd370e44@mail.gmail.com>

Dear all,

I'd like to catch the RecognitionException object and exit the Recognizer
upon First Error. I tried to use Bail.g in antlr code examples, and disable
"throw e" in it. The error doesn't print to Output of ANTLRWorks v1.2.3 but
print to console command (cygwin). I attached Bail.g, TestBail.java and
input files. Could you please help me?

Thank you very much,
Ha Luong
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/e964bcb3/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bail.zip
Type: application/zip
Size: 5739 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/e964bcb3/attachment.zip 

From achintmehta at gmail.com  Sun Aug 16 10:06:31 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Sun, 16 Aug 2009 13:06:31 -0400
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
In-Reply-To: <4A881BA2.8040006@jacaranda.org>
References: <4a3315250908151535l3b6870c9o35390a6a47c6ebb1@mail.gmail.com>
	<4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>
	<4A881BA2.8040006@jacaranda.org>
Message-ID: <4a3315250908161006s36bf2cc7l66180e164c7e646f@mail.gmail.com>

Hi David/Sarah,

Thanks for your response.

So If I have to include all the tokens in SPECIAL_STRING, then I assume that
SPECIAL_STRING has to be changed from lexer to parser rule.

Based on your and Joe's suggestion I have modified the grammar as following:
----------------------------------------------------------
grammar sample_parser;

options
{
   language=C;
}
tokens{
T_VERSION='VERSION';
T_COUNT='COUNT';
}

requestline : T_VERSION '=' special_string (NEWLINE)?;

special_string:WORD | tokenset;
tokenset: T_VERSION | T_COUNT;
fragment
CHAR: (('a'..'z')|('A'..'Z'));
fragment
DIGIT: ('0'..'9');
WORD: (CHAR|DIGIT)+;
NEWLINE:('\r')? '\n';
------------------------------------------------------------

This grammar seems to work.

Do you think this grammar is fine or can it be improved further ?

Thanks.

Regards,
Achint

On Sun, Aug 16, 2009 at 10:45 AM, David-Sarah Hopwood <
david-sarah at jacaranda.org> wrote:

> Achint Mehta wrote:
> > 2. The second option is that all the tokens have to given as alternate
> > rules/token with SPECIAL_STRING. Again, in a big/complicated parser, all
> the
> > tokens in the whole parser have to be repeated where-ever I intend to use
> > the SPECIAL_STRING. This can be simplified if I give the tokens in the
> > definition of SPECIAL_STRING iteself. But still in a parser which could
> use
> > tens or hundreds of tokens, it would seem to be impractical to repeat all
> > the tokens in SPECIAL_STRING rule and other similar rules (intended for
> > collecting the generic string).
>
> You only need one rule that collects all of the tokens, which can then be
> included as an alternative in SPECIAL_STRING and similar rules. This is
> the approach I use for ECMAScript 5 (which has some contexts in which
> keywords are treated like identifiers). The duplication is mildly
> irritating, but it still works quite well in practice.
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/a2ff10c3/attachment.html 

From cmundi at gmail.com  Sun Aug 16 10:06:38 2009
From: cmundi at gmail.com (C. Mundi)
Date: Sun, 16 Aug 2009 10:06:38 -0700
Subject: [antlr-interest] Sub-Lexers?
Message-ID: <e794390908161006o70691161wfad785cf2be952dd@mail.gmail.com>

I feel like I'm being denser than usual so any clue will do...

Suppose I have a legacy configuration file with an ad hoc grammar and
now I need to write a clean parser for it.  The parser is trivial if
the lexing is done cleanly.  The 'language' has easily detected and
disambiguated 'clauses' but each clause has its own dialect and some
dialects are in syntactic conflict.  For example a reserved word in
one dialect is legal freeform text in another and no (elegant)
predicate can handle all ambiguous contexts.

What I'm thinking is a lexer which finds the clauses followed by a
parser which does a trivial rewrite which embeds actions to invoke
specialized lexers for each clause type.  All of the specialized
levers target a single AST which is handled by a unified parser.

Seems like a lot of work to fake out 'sublexing'.  There must be a
better way to think about this.

Thanks for reading!
~Carlos

From david-sarah at jacaranda.org  Sun Aug 16 11:22:49 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sun, 16 Aug 2009 19:22:49 +0100
Subject: [antlr-interest] Resolving ambiguities in Lexer rules
In-Reply-To: <4a3315250908161006s36bf2cc7l66180e164c7e646f@mail.gmail.com>
References: <4a3315250908151535l3b6870c9o35390a6a47c6ebb1@mail.gmail.com>	
	<4a3315250908151608j32441cebjd4b2027b9ae560@mail.gmail.com>	
	<4A881BA2.8040006@jacaranda.org>
	<4a3315250908161006s36bf2cc7l66180e164c7e646f@mail.gmail.com>
Message-ID: <4A884E79.7090407@jacaranda.org>

Achint Mehta wrote:
> Hi David/Sarah,
> 
> Thanks for your response.
> 
> So If I have to include all the tokens in SPECIAL_STRING, then I assume that
> SPECIAL_STRING has to be changed from lexer to parser rule.

Yes, exactly.

You may find as you extend the grammar that you also need non-alphanumeric
tokens, in which case only alphanumeric tokens (called "reserved words" in
most computer languages) should go in what is now 'tokenset'. So I would
call it something like 'reservedWord' instead.

> Based on your and Joe's suggestion I have modified the grammar as following:
> ----------------------------------------------------------
> grammar sample_parser;
> 
> options
> {
>    language=C;
> }
> tokens{
> T_VERSION='VERSION';
> T_COUNT='COUNT';
> }
> 
> requestline : T_VERSION '=' special_string (NEWLINE)?;
> 
> special_string:WORD | tokenset;
> tokenset: T_VERSION | T_COUNT;
> fragment
> CHAR: (('a'..'z')|('A'..'Z'));
> fragment
> DIGIT: ('0'..'9');
> WORD: (CHAR|DIGIT)+;
> NEWLINE:('\r')? '\n';
> ------------------------------------------------------------

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From newsreply at areeda.com  Sun Aug 16 11:58:58 2009
From: newsreply at areeda.com (Joseph Areeda)
Date: Sun, 16 Aug 2009 11:58:58 -0700
Subject: [antlr-interest] Ruby Target
In-Reply-To: <20090816143116.97300@gmx.net>
References: <876602C0E3977743BD1C71DDDA78C527656F87@ex2k.bankofamerica.com>
	<20090816143116.97300@gmx.net>
Message-ID: <4A8856F2.6050105@areeda.com>

This may be totally worthless as I've only played with a few Ruby 
tutorials BUT:

Have you considered JRuby which is part of NetBeans?  It seems like you 
can call Java code directly from Ruby.  It might just be few wrappers 
for you.

Joe

Johannes Luber wrote:
>> I am new to Antlr and Antlr Works.  I have a ruby project that uses a
>> DSL and would like to replace my custom parser with an ANTLR parser.
>> The problem is I cant seem to create a Ruby target.  I downloaded the
>> latest ANTLR tar and installed it but it doesn't appear to have the
>> required files for the Ruby Target.  I can see Perl5,C, Python and
>> Javascript but no Ruby.  Where can I get the required files to create a
>> Ruby Target?
>>     
>
> Looking at <http://www.antlr.org/wiki/display/ANTLR3/Code+Generation+Targets> it seems that someone worked on a Ruby target, but gave up. To create a Ruby target you have basically to copy the Java target files and replace any Java specific code with Ruby ones. The code generation site contains two useful links for doing so.
>
> I recommend to ask Ter for a Perforce account as the current files are already moving towards 3.2 and you would need to do less work overall.
>
> Johannes
>   
>>  
>>
>> Kevin Trainer
>>
>> Cnslt - Apps Prog
>>
>> PT-NexOS Database Team
>>
>> (818) 597-4958
>>
>>  
>>
>>     
>
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090816/f751f009/attachment.html 

From consiliens at gmail.com  Sun Aug 16 17:25:38 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Sun, 16 Aug 2009 18:25:38 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A86DE5A.4050304@jacaranda.org>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>	<4A85EA16.1050304@jacaranda.org>	<4A85FFD5.4030608@temporal-wave.com>
	<4A86DE5A.4050304@jacaranda.org>
Message-ID: <4A88A382.4050807@gmail.com>

I looked at ANTLRStringStreams consume() method and noticed that it 
checks for a '\n'. In the current grammar I'm skip()ing newlines, 
instead of placing them on a hidden channel.

I made the following modification to the grammar in ANTLRWorks which 
promptly broke the compiler.
fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};
fragment WS      : ('\n'|'\r'|'\t'|' ')+ {$channel=HIDDEN;};

The error message is "cannot find symbol : variable _channel". I edited 
QuizLexer.java and added
public static int _channel; Now when I run the test rig, I can see the 
tokens returned from lexer.nextToken().getText(), although tokens.size() 
still reports zero. This change also enables the debugger to correctly 
parse the input.

Is $channel=HIDDEN not working in ANTLRWorks a known issue? The 404 Not 
Found error for its source code repository does not inspire confidence 
http://fisheye2.cenqua.com/browse/antlrworks.

From david-sarah at jacaranda.org  Sun Aug 16 18:08:50 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Mon, 17 Aug 2009 02:08:50 +0100
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A88A382.4050807@gmail.com>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>	<4A85EA16.1050304@jacaranda.org>	<4A85FFD5.4030608@temporal-wave.com>	<4A86DE5A.4050304@jacaranda.org>
	<4A88A382.4050807@gmail.com>
Message-ID: <4A88ADA2.9020608@jacaranda.org>

consiliens at gmail.com wrote:
> I looked at ANTLRStringStreams consume() method and noticed that it 
> checks for a '\n'. In the current grammar I'm skip()ing newlines, 
> instead of placing them on a hidden channel.
> 
> I made the following modification to the grammar in ANTLRWorks which 
> promptly broke the compiler.
> fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};
> fragment WS      : ('\n'|'\r'|'\t'|' ')+ {$channel=HIDDEN;};
> 
> The error message is "cannot find symbol : variable _channel".

That's quite strange; I'm using $channel = HIDDEN in ANTLRWorks (version
1.2.3) with no problems. Could something be wrong with your ANTLR/ANTLRWorks
installation?

Can you reduce the grammar to the minimum necessary to reproduce the above
error message, and post it here?

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From consiliens at gmail.com  Sun Aug 16 18:20:01 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Sun, 16 Aug 2009 19:20:01 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A88ADA2.9020608@jacaranda.org>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>	<4A85EA16.1050304@jacaranda.org>	<4A85FFD5.4030608@temporal-wave.com>	<4A86DE5A.4050304@jacaranda.org>	<4A88A382.4050807@gmail.com>
	<4A88ADA2.9020608@jacaranda.org>
Message-ID: <4A88B041.8000208@gmail.com>

On 09-08-16 07:08 PM, David-Sarah Hopwood wrote:
> consiliens at gmail.com wrote:
>> I looked at ANTLRStringStreams consume() method and noticed that it
>> checks for a '\n'. In the current grammar I'm skip()ing newlines,
>> instead of placing them on a hidden channel.
>>
>> I made the following modification to the grammar in ANTLRWorks which
>> promptly broke the compiler.
>> fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};
>> fragment WS      : ('\n'|'\r'|'\t'|' ')+ {$channel=HIDDEN;};
>>
>> The error message is "cannot find symbol : variable _channel".
>
> That's quite strange; I'm using $channel = HIDDEN in ANTLRWorks (version
> 1.2.3) with no problems. Could something be wrong with your ANTLR/ANTLRWorks
> installation?
>
> Can you reduce the grammar to the minimum necessary to reproduce the above
> error message, and post it here?
>

I tested on ANTLRWorks 1.2.3 also and the same error occurs. I don't 
think there's anything wrong with my ANTLRWorks installation? java -jar 
antlrworks-1.2.3.jar

grammar bug;
bug	:	 EOF;
fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};

Console:
[19:14:16] /output/bugLexer.java:50: cannot find symbol
[19:14:16] symbol  : variable _channel
[19:14:16] location: class bugLexer
[19:14:16]             _channel=HIDDEN;
[19:14:16]             ^
[19:14:16] 1 error

From jbb at acm.org  Sun Aug 16 19:00:16 2009
From: jbb at acm.org (John B. Brodie)
Date: Sun, 16 Aug 2009 22:00:16 -0400
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A88A382.4050807@gmail.com>
References: <4A846A4A.5010905@gmail.com>
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>
	<4A847E10.6070209@gmail.com>
	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>
	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>
	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>
	<4A85EA16.1050304@jacaranda.org>	<4A85FFD5.4030608@temporal-wave.com>
	<4A86DE5A.4050304@jacaranda.org>  <4A88A382.4050807@gmail.com>
Message-ID: <1250474416.4193.26.camel@gecko.home.org>

Greetings!

On Sun, 2009-08-16 at 18:25 -0600, consiliens at gmail.com wrote:
> I looked at ANTLRStringStreams consume() method and noticed that it 
> checks for a '\n'. In the current grammar I'm skip()ing newlines, 
> instead of placing them on a hidden channel.
> 
> I made the following modification to the grammar in ANTLRWorks which 
> promptly broke the compiler.
> fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};
> fragment WS      : ('\n'|'\r'|'\t'|' ')+ {$channel=HIDDEN;};
> 
> The error message is "cannot find symbol : variable _channel". I edited 
> QuizLexer.java and added
> public static int _channel; Now when I run the test rig, I can see the 
> tokens returned from lexer.nextToken().getText(), although tokens.size() 
> still reports zero. This change also enables the debugger to correctly 
> parse the input.
> 

$channel is only available - as far as i know - on non-fragment Lexer
rules ... e.g. $channel is an attribute of a Token and fragment Lexer
rules do not produce a Token.

Is there a reason for your NEWLINE and WS rules to be a fragment?

Maybe remove the fragment keyword from these two lexer rules.

BUT

do other Lexer rules reference NEWLINE and/or WS? If so, you probably
need to keep the fragment and want to create a trampoline-style Lexer
rule that creates a Token but then hides it. so perhape something like

fragment NEWLINE : '\n' '\r'? ; // for use by other Lexer rules
fragment WS      : ('\n'|'\r'|'\t'|' ')+ ; // for use by other Lexer rules

HIDDEN_NEWLINE : NEWLINE { $channel=HIDDEN; } ; // hide from Parser
HIDDEN_WS : WS { $channel=HIDDEN; } ; // hide from Parser

> Is $channel=HIDDEN not working in ANTLRWorks a known issue? 

I believe that ANTLRWorks already handles $channel=HIDDEN correctly,
when that construct is applied correctly. altho, in general, it is my
experience that it is not really reasonable to expect any of the ANTLR
tools to deal with any stuff that appears inside braces {} because that
stuff inside the braces is Target-Language specific and the ANTLR tool
suite tries to be Target agnostic...

> The 404 Not 
> Found error for its source code repository does not inspire confidence 
> http://fisheye2.cenqua.com/browse/antlrworks.
> 

a completely different issue which I am unable to address --- other than
the fisheye host has historically been unreliable (in my experience).

Hope this helps....
   -jbb




From david-sarah at jacaranda.org  Sun Aug 16 19:01:03 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Mon, 17 Aug 2009 03:01:03 +0100
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A88B041.8000208@gmail.com>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>	<4A85EA16.1050304@jacaranda.org>	<4A85FFD5.4030608@temporal-wave.com>	<4A86DE5A.4050304@jacaranda.org>	<4A88A382.4050807@gmail.com>	<4A88ADA2.9020608@jacaranda.org>
	<4A88B041.8000208@gmail.com>
Message-ID: <4A88B9DF.8070000@jacaranda.org>

consiliens at gmail.com wrote:
> On 09-08-16 07:08 PM, David-Sarah Hopwood wrote:
>> consiliens at gmail.com wrote:
>>> I looked at ANTLRStringStreams consume() method and noticed that it
>>> checks for a '\n'. In the current grammar I'm skip()ing newlines,
>>> instead of placing them on a hidden channel.
>>>
>>> I made the following modification to the grammar in ANTLRWorks which
>>> promptly broke the compiler.
>>> fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};
>>> fragment WS      : ('\n'|'\r'|'\t'|' ')+ {$channel=HIDDEN;};
>>>
>>> The error message is "cannot find symbol : variable _channel".
>> That's quite strange; I'm using $channel = HIDDEN in ANTLRWorks (version
>> 1.2.3) with no problems. Could something be wrong with your ANTLR/ANTLRWorks
>> installation?
>>
>> Can you reduce the grammar to the minimum necessary to reproduce the above
>> error message, and post it here?
> 
> I tested on ANTLRWorks 1.2.3 also and the same error occurs. I don't 
> think there's anything wrong with my ANTLRWorks installation? java -jar 
> antlrworks-1.2.3.jar
> 
> grammar bug;
> bug	:	 EOF;
> fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};
> 
> Console:
> [19:14:16] /output/bugLexer.java:50: cannot find symbol
> [19:14:16] symbol  : variable _channel
> [19:14:16] location: class bugLexer
> [19:14:16]             _channel=HIDDEN;
> [19:14:16]             ^
> [19:14:16] 1 error

OK, I can reproduce that using
  java org.antlr.Tool bug.g
  javac bug*.java
so we can eliminate ANTLRWorks.


The generated code for mNEWLINE does not contain

    int _channel = DEFAULT_TOKEN_CHANNEL;
    ...
    state.channel = _channel;

as I would expect it to. Someone with a deeper knowledge of ANTLR internals
will have to investigate why not.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Sun Aug 16 19:04:30 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Mon, 17 Aug 2009 03:04:30 +0100
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <4A88B9DF.8070000@jacaranda.org>
References: <4A846A4A.5010905@gmail.com>	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	<4A847E10.6070209@gmail.com>	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>	<4A85EA16.1050304@jacaranda.org>	<4A85FFD5.4030608@temporal-wave.com>	<4A86DE5A.4050304@jacaranda.org>	<4A88A382.4050807@gmail.com>	<4A88ADA2.9020608@jacaranda.org>	<4A88B041.8000208@gmail.com>
	<4A88B9DF.8070000@jacaranda.org>
Message-ID: <4A88BAAE.1060200@jacaranda.org>

David-Sarah Hopwood wrote:
> consiliens at gmail.com wrote:
>> grammar bug;
>> bug	:	 EOF;
>> fragment NEWLINE : '\n' '\r'? {$channel=HIDDEN;};
>>
>> Console:
>> [19:14:16] /output/bugLexer.java:50: cannot find symbol
>> [19:14:16] symbol  : variable _channel
>> [19:14:16] location: class bugLexer
>> [19:14:16]             _channel=HIDDEN;
>> [19:14:16]             ^
>> [19:14:16] 1 error
> 
> The generated code for mNEWLINE does not contain
> 
>     int _channel = DEFAULT_TOKEN_CHANNEL;
>     ...
>     state.channel = _channel;

Oh, this is as expected for fragment rules. See John Brodie's reply.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From consiliens at gmail.com  Sun Aug 16 20:14:32 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Sun, 16 Aug 2009 21:14:32 -0600
Subject: [antlr-interest] Simple Grammar breaks ANTLRWorks Interpreter &
 Debugger?
In-Reply-To: <1250474416.4193.26.camel@gecko.home.org>
References: <4A846A4A.5010905@gmail.com>	
	<4a8476f6.2008c00a.59b3.7eefSMTPIN_ADDED@mx.google.com>	
	<4A847E10.6070209@gmail.com>	
	<4a848419.0208c00a.7e2b.ffffc68aSMTPIN_ADDED@mx.google.com>	
	<4A848FBC.6080205@gmail.com>	<20090814074039.048F03418419@www.antlr.org>	
	<4A85B79B.6040605@jacaranda.org>	<4A85BE61.6070404@temporal-wave.com>	
	<4A85EA16.1050304@jacaranda.org>	<4A85FFD5.4030608@temporal-wave.com>	
	<4A86DE5A.4050304@jacaranda.org> <4A88A382.4050807@gmail.com>
	<1250474416.4193.26.camel@gecko.home.org>
Message-ID: <4A88CB18.9070309@gmail.com>

On 09-08-16 08:00 PM, John B. Brodie wrote:
 > Greetings!

I appreciate your detailed response. I was able to fix the grammar by 
adding a "trampoline-style" newline lexer rule.

 >> The 404 Not
 >> Found error for its source code repository does not inspire confidence
 >> http://fisheye2.cenqua.com/browse/antlrworks.
 >>
 >
 > a completely different issue which I am unable to address --- other than
 > the fisheye host has historically been unreliable (in my experience).

ANTLRWorks is a really useful tool and I'd love to be able to look at 
the source code repository. For example it's not immediately obvious 
where the source code is for antlrworks-1.3b.jar. Who is able to address 
this issue?

From weeliyen at hotmail.com  Sun Aug 16 23:12:08 2009
From: weeliyen at hotmail.com (Wee Li Yen)
Date: Mon, 17 Aug 2009 14:12:08 +0800
Subject: [antlr-interest] Difference btn files in CSharp and CSharp3
Message-ID: <BAY114-DS3BAE149F3BA117D4E5D7ECF010@phx.gbl>

Hi,

What are the differences btn the files in "antlr-3.1.3\runtime\CSharp\Sources\Antlr3.Runtime\Antlr.Runtime.Tree" and that of "antlr-3.1.3\runtime\CSharp3\Sources\Antlr3.Runtime\Tree"?

Why are there two different versions?  I noted that the API provided are for files in CSharp not CSharp3 (http://www.antlr.org/api/CSharp/files.html), any reason for that?

Regards,
LY
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090817/bced3256/attachment.html 

From marwan.alephn at gmail.com  Sun Aug 16 23:58:06 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Mon, 17 Aug 2009 08:58:06 +0200
Subject: [antlr-interest] How to specify NameX.tokens to AntlrWorks for
	generating a tree gramar
Message-ID: <6535fcb50908162358o6093d2b4h3f94ddc06f305402@mail.gmail.com>

Hi people;

In case you want to generate a NameX tree grammar; How to specify
NameX.tokens to AntlrWorks so it takes all the tokens defined in a
lexer.

Thx,

-- 
Marouane

From marwan.alephn at gmail.com  Mon Aug 17 00:02:45 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Mon, 17 Aug 2009 09:02:45 +0200
Subject: [antlr-interest] Couldn't disable RecognitionException
In-Reply-To: <61577c8f0908160934hcf71616vfc545f67fd370e44@mail.gmail.com>
References: <61577c8f0908160934hcf71616vfc545f67fd370e44@mail.gmail.com>
Message-ID: <6535fcb50908170002s4a3ccccdsc29f3a8e57ac630d@mail.gmail.com>

@rulecatch {

catch (RecognitionException e) {

    //throw e;



}

2009/8/16 Ha Luong <haluongvn at gmail.com>:
> Dear all,
>
> I'd like to catch the RecognitionException object and exit the Recognizer
> upon First Error. I tried to use Bail.g in antlr code examples, and disable
> "throw e" in it. The error doesn't print to Output of ANTLRWorks v1.2.3 but
> print to console command (cygwin). I attached Bail.g, TestBail.java and
> input files. Could you please help me?
>
> Thank you very much,
> Ha Luong
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>



-- 
Marouane

From marwan.alephn at gmail.com  Mon Aug 17 00:05:30 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Mon, 17 Aug 2009 09:05:30 +0200
Subject: [antlr-interest] Couldn't disable RecognitionException
In-Reply-To: <61577c8f0908160934hcf71616vfc545f67fd370e44@mail.gmail.com>
References: <61577c8f0908160934hcf71616vfc545f67fd370e44@mail.gmail.com>
Message-ID: <6535fcb50908170005s7cb1826fh375f2455b3c32e57@mail.gmail.com>

Add to your rulecatch System.exit(1); That wiill look like:

@rulecatch {

catch (RecognitionException e) {

    //throw e;
   System.exit(1)

}

2009/8/16 Ha Luong <haluongvn at gmail.com>:
> Dear all,
>
> I'd like to catch the RecognitionException object and exit the Recognizer
> upon First Error. I tried to use Bail.g in antlr code examples, and disable
> "throw e" in it. The error doesn't print to Output of ANTLRWorks v1.2.3 but
> print to console command (cygwin). I attached Bail.g, TestBail.java and
> input files. Could you please help me?
>
> Thank you very much,
> Ha Luong
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>



-- 
Marouane

From thomas.woelfle at interactive-objects.com  Mon Aug 17 01:47:34 2009
From: thomas.woelfle at interactive-objects.com (Thomas Woelfle)
Date: Mon, 17 Aug 2009 10:47:34 +0200
Subject: [antlr-interest] Problem with ambiguous grammar
Message-ID: <4A891926.5030202@interactive-objects.com>

Hi,

I have a problem with following grammar:

imperative_statement
  : imperative_compute_statement
  ;
 
imperative_statement_list
  : imperative_statement+
  ;

imperative_compute_statement
  : COMPUTE^ Identifier+ EQUAL Identifier END_COMPUTE?
  ;
 
conditional_compute_statement
  : COMPUTE^ Identifier+ EQUAL Identifier
      (ON? SIZE ERROR imperative_statement_list)?
      END_COMPUTE?
  ;

COMPUTE: 'COMPUTE';
NOT : 'NOT';
ON : 'ON';
SIZE : 'SIZE';
EQUAL : 'EQUAL';
ERROR : 'ERROR';
END_COMPUTE : 'END-COMPUTE';

Identifier :
  Letter (Letter | Digit)*;
 
fragment
Letter :
  'a'..'z' |
  'A'..'Z';
 
fragment
Digit :
  '0'..'9';

ANTLR tells me that the rule 'imperative_compute_statement' has more 
than one alternative to match the optional 'END_COMPUTE'. Can anybody 
give me a hint on how to rewrite this grammar so that the warning no 
longer appears?

Any help appreciated.

Regards,
Thomas

-- 
Interactive Objects Software GmbH
Basler Strasse 61
79100 Freiburg, Germany

Phone:  +49 761 400 73 0
mailto:thomas.woelfle at interactive-objects.com


------------------------------------------------------------------------

Interactive Objects' Legacy Modernization Solutions 

Get Your Applications SOA-Ready!

See http://www.interactive-objects.com/ for more information.

------------------------------------------------------------------------


Interactive Objects Software GmbH | Freiburg | Gesch?ftsf?hrer: Alberto Perandones, Andrea Hemprich
| AG Frbg. HRB 5810 | USt-ID: DE 197983057


From newsreply at areeda.com  Mon Aug 17 02:28:22 2009
From: newsreply at areeda.com (Joseph Areeda)
Date: Mon, 17 Aug 2009 02:28:22 -0700
Subject: [antlr-interest] Problem with ambiguous grammar
In-Reply-To: <4A891926.5030202@interactive-objects.com>
References: <4A891926.5030202@interactive-objects.com>
Message-ID: <4A8922B6.6020805@areeda.com>

Not an expert here but I'll hazard a guess.

It seems to me that a statement like:
COMPUTE a EQUAL b
can be either an imperative_compute_statement or a conditional compute
statement.

What if you take the ? off the conditional's ON clause?  Is it really a
conditional if that's not there?

Joe
Thomas Woelfle wrote:
> Hi,
>
> I have a problem with following grammar:
>
> imperative_statement
>   : imperative_compute_statement
>   ;
>  
> imperative_statement_list
>   : imperative_statement+
>   ;
>
> imperative_compute_statement
>   : COMPUTE^ Identifier+ EQUAL Identifier END_COMPUTE?
>   ;
>  
> conditional_compute_statement
>   : COMPUTE^ Identifier+ EQUAL Identifier
>       (ON? SIZE ERROR imperative_statement_list)?
>       END_COMPUTE?
>   ;
>
> COMPUTE: 'COMPUTE';
> NOT : 'NOT';
> ON : 'ON';
> SIZE : 'SIZE';
> EQUAL : 'EQUAL';
> ERROR : 'ERROR';
> END_COMPUTE : 'END-COMPUTE';
>
> Identifier :
>   Letter (Letter | Digit)*;
>  
> fragment
> Letter :
>   'a'..'z' |
>   'A'..'Z';
>  
> fragment
> Digit :
>   '0'..'9';
>
> ANTLR tells me that the rule 'imperative_compute_statement' has more 
> than one alternative to match the optional 'END_COMPUTE'. Can anybody 
> give me a hint on how to rewrite this grammar so that the warning no 
> longer appears?
>
> Any help appreciated.
>
> Regards,
> Thomas
>
>   


From beradrian at yahoo.com  Mon Aug 17 02:56:11 2009
From: beradrian at yahoo.com (Adrian Ber)
Date: Mon, 17 Aug 2009 02:56:11 -0700 (PDT)
Subject: [antlr-interest] unclosed strings in HTML
Message-ID: <544726.9334.qm@web30707.mail.mud.yahoo.com>

Hi,

I have an HTML grammar and I have a lexer rule for strings:

STRING    :    '"' (ESC|~('"'|'\\'|'\n'|'\r'))* '"'
        | '\'' (ESC|~('\''|'\\'|'\n'|'\r'))* '\''
        ;

But if I have a text in html like 
    I'm just a text
then the lexer will try to identify a string and it will generate an error.

How can I solve this?

Thanks,
Adrian.



      New Email addresses available on Yahoo!
Get the Email name you&#39;ve always wanted on the new @ymail and @rocketmail. 
Hurry before someone else does!
http://mail.promotions.yahoo.com/newdomains/aa/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090817/4b3ce4fc/attachment.html 

From Heiko.Folkerts at david-bs.de  Mon Aug 17 03:04:20 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Mon, 17 Aug 2009 12:04:20 +0200
Subject: [antlr-interest] Using predicates for keywords
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF130301119F@DC2>

Hi,
I want to use an abstract syntax in wich the keyword e.g. for an if statement is available at runtime with a database call. So I don't want to hard code 'if' in the parser but use an expression for a ifkeyword which checks the database and returns wether the token is an if keyword or not.

I've tried with syntactic and semantic predicates, but even after reading the sections from the antlr reference I don't know which way is the right one for me.

The grammar would like something like this:
Statement:
Ifexpresseion
| loopexpression
;

Ifexpression: ifkeyword condition thenkeyword actionexpression;
Loopexpression: loopkeyword condition ':' actionexpression;

So how to code the ifkeyword and loopkeyword rules?

Thx in advance.
Btw.: thx to Jim for the help compiling the generated C code.

Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From indhu.b at s7software.com  Mon Aug 17 03:11:25 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Mon, 17 Aug 2009 15:41:25 +0530
Subject: [antlr-interest] Using predicates for keywords
In-Reply-To: <93FCBF72DCE7634481C5DF1654D8FF130301119F@DC2>
References: <93FCBF72DCE7634481C5DF1654D8FF130301119F@DC2>
Message-ID: <011901ca1f23$14157f30$3c407d90$@b@s7software.com>

Maybe you can use a setter to set what 'ifKeyword' is and use that in a
semantic predicate.

Something like:

@members {
	String ifKeyword;

	Public void setIfKeyword(String str) {
		this.ifKeyword = str;
	}
}

ifKeyword
	:	{ LT(1).getText().equals(ifKeyword) }?=> /*nothing*/
	;

Lexer will lex 'if' as just an ID.

Hope that helps.


Cheers, Indhu


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Heiko Folkerts
Sent: Monday, August 17, 2009 3:34 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Using predicates for keywords

Hi,
I want to use an abstract syntax in wich the keyword e.g. for an if
statement is available at runtime with a database call. So I don't want to
hard code 'if' in the parser but use an expression for a ifkeyword which
checks the database and returns wether the token is an if keyword or not.

I've tried with syntactic and semantic predicates, but even after reading
the sections from the antlr reference I don't know which way is the right
one for me.

The grammar would like something like this:
Statement:
Ifexpresseion
| loopexpression
;

Ifexpression: ifkeyword condition thenkeyword actionexpression;
Loopexpression: loopkeyword condition ':' actionexpression;

So how to code the ifkeyword and loopkeyword rules?

Thx in advance.
Btw.: thx to Jim for the help compiling the generated C code.

Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From weeliyen at hotmail.com  Mon Aug 17 03:46:01 2009
From: weeliyen at hotmail.com (Wee Li Yen)
Date: Mon, 17 Aug 2009 18:46:01 +0800
Subject: [antlr-interest] Implementing ASTVisitor for C#
Message-ID: <BAY114-DS8314AD302EFEC08327695CF010@phx.gbl>

Hi,

I have now the C Sharp Parser and C Sharp Lexer. Now I need to implement the ASTVisitor to manipulate AST for C# after parsing in a directory/file.
I am doing sth like this "CSParser.compilation_unit_return x = parser.compilation_unit();" in my main class.

1. The problem now is how do I get the tree / root of the tree out of the compilation unit return to me?

2. From the TreeVisitor (http://www.antlr.org/api/CSharp/class_antlr_1_1_runtime_1_1_tree_1_1_tree_visitor.html), there is a Visit() method which has the traversal logic.
I plan to use it to implement the Action method in the Visitor pattern. 
Then for each visit to the each node (class, method, variables etc), I will write another class which has all the different visits (eg. Visit(class, action) n Visit(method, action)). 
The problem is how do I gain access to the info of class, methods, variables etc of the tree? Through the Adaptor? How do I get the adaptor from the compilation unit?
If not through the Adaptor, what other means can I use?

4. In addition, the Visit() method takes in 2 parameters one of which is an object, the other is a ITreeVisitorAction.
So now what is the object? The tree or the root of the tree?
For the ITreeVisitorAction and ITreeAdaptor, how do I know the right instance of which concrete class (BaseTree or CommonTree or other tree) to use, can I get clues it from the compilation unit as well?


Would be grateful if anyone can help me with at least one of the doubts...

Li Yen


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090817/794bed6c/attachment.html 

From antlr at mirality.co.nz  Mon Aug 17 04:27:02 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 17 Aug 2009 23:27:02 +1200
Subject: [antlr-interest] Problem with ambiguous grammar
In-Reply-To: <4A891926.5030202@interactive-objects.com>
References: <4A891926.5030202@interactive-objects.com>
Message-ID: <20090817112717.A4B7E341844A@www.antlr.org>

At 20:47 17/08/2009, Thomas Woelfle wrote:
 >imperative_statement
 >  : imperative_compute_statement
 >  ;
 >
 >imperative_statement_list
 >  : imperative_statement+
 >  ;
 >
 >imperative_compute_statement
 >  : COMPUTE^ Identifier+ EQUAL Identifier END_COMPUTE?
 >  ;
 >
 >conditional_compute_statement
 >  : COMPUTE^ Identifier+ EQUAL Identifier
 >      (ON? SIZE ERROR imperative_statement_list)?
 >      END_COMPUTE?
 >  ;
[...]
 >ANTLR tells me that the rule 'imperative_compute_statement' has
 >more than one alternative to match the optional 'END_COMPUTE'.
 >Can anybody give me a hint on how to rewrite this grammar so
 >that the warning no longer appears?

The problem here, I think, is that a conditional_compute_statement 
that uses the SIZE ERROR clause contains an 
imperative_statement_list, which in turn contains an 
imperative_statement, then an imperative_computer_statement, which 
finally has an optional END_COMPUTE token.  And then back in 
conditional_compute_statement immediately following that, there's 
another optional END_COMPUTE token.  So ANTLR is warning that it's 
unclear whether an END_COMPUTE at that point in the input should 
be for the inner statement (the imperative_compute_statement in 
the SIZE ERROR block) or the outer statement (the 
conditional_compute_statement).

You can just ignore the warning, as ANTLR will (I think) default 
to matching it in the inner statement (similar to the "nested 
else" problem discussed on the wiki).

Another possibility is to introduce some kind of delimiters (eg. 
braces around the imperative_statement_list) so that it's obvious 
where one ends and the other resumes.  Of course, that would 
require changing the input language, which might not be an option.

There's probably also a way to resolve this through rule 
restructuring, but I'm not sure offhand what that would be.


From thomas.woelfle at interactive-objects.com  Mon Aug 17 04:37:53 2009
From: thomas.woelfle at interactive-objects.com (Thomas Woelfle)
Date: Mon, 17 Aug 2009 13:37:53 +0200
Subject: [antlr-interest] Problem with ambiguous grammar
In-Reply-To: <0MKrmS-1Md0Mw0hBa-000Ama@mx.kundenserver.de>
References: <4A891926.5030202@interactive-objects.com>
	<0MKrmS-1Md0Mw0hBa-000Ama@mx.kundenserver.de>
Message-ID: <4A894111.1020908@interactive-objects.com>

Hi Gavin,

the problem is as you described it. Unfortunately I cannot change the 
input language. I think it is the same class of problem as the known "if 
then if then else" problem. But in this case I think I cannot use 
syntactic predicates to get rid of that warning as described in the 
ANTLR book, can't I?

You are right. ANTLR will do the correct thing by consuming the 
END_COMPUTE token early. All I wanted to have is to get rid of the 
warnings without enabling backtracking.

Thanks for your help,
Thomas
> At 20:47 17/08/2009, Thomas Woelfle wrote:
> >imperative_statement
> >  : imperative_compute_statement
> >  ;
> >
> >imperative_statement_list
> >  : imperative_statement+
> >  ;
> >
> >imperative_compute_statement
> >  : COMPUTE^ Identifier+ EQUAL Identifier END_COMPUTE?
> >  ;
> >
> >conditional_compute_statement
> >  : COMPUTE^ Identifier+ EQUAL Identifier
> >      (ON? SIZE ERROR imperative_statement_list)?
> >      END_COMPUTE?
> >  ;
> [...]
> >ANTLR tells me that the rule 'imperative_compute_statement' has
> >more than one alternative to match the optional 'END_COMPUTE'.
> >Can anybody give me a hint on how to rewrite this grammar so
> >that the warning no longer appears?
>
> The problem here, I think, is that a conditional_compute_statement 
> that uses the SIZE ERROR clause contains an imperative_statement_list, 
> which in turn contains an imperative_statement, then an 
> imperative_computer_statement, which finally has an optional 
> END_COMPUTE token.  And then back in conditional_compute_statement 
> immediately following that, there's another optional END_COMPUTE 
> token.  So ANTLR is warning that it's unclear whether an END_COMPUTE 
> at that point in the input should be for the inner statement (the 
> imperative_compute_statement in the SIZE ERROR block) or the outer 
> statement (the conditional_compute_statement).
>
> You can just ignore the warning, as ANTLR will (I think) default to 
> matching it in the inner statement (similar to the "nested else" 
> problem discussed on the wiki).
>
> Another possibility is to introduce some kind of delimiters (eg. 
> braces around the imperative_statement_list) so that it's obvious 
> where one ends and the other resumes.  Of course, that would require 
> changing the input language, which might not be an option.
>
> There's probably also a way to resolve this through rule 
> restructuring, but I'm not sure offhand what that would be.
>


-- 
Interactive Objects Software GmbH
Basler Strasse 61
79100 Freiburg, Germany

Phone:  +49 761 400 73 0
mailto:thomas.woelfle at interactive-objects.com


------------------------------------------------------------------------

Interactive Objects' Legacy Modernization Solutions 

Get Your Applications SOA-Ready!

See http://www.interactive-objects.com/ for more information.

------------------------------------------------------------------------


Interactive Objects Software GmbH | Freiburg | Gesch?ftsf?hrer: Alberto Perandones, Andrea Hemprich
| AG Frbg. HRB 5810 | USt-ID: DE 197983057


From lars.vonwedel at bayertechnology.com  Mon Aug 17 04:49:16 2009
From: lars.vonwedel at bayertechnology.com (lars.vonwedel at bayertechnology.com)
Date: Mon, 17 Aug 2009 13:49:16 +0200
Subject: [antlr-interest] Antwort:  Using predicates for keywords
In-Reply-To: <93FCBF72DCE7634481C5DF1654D8FF130301119F@DC2>
Message-ID: <OF56FDC3D4.E4FEF302-ONC1257615.0040B098-C1257615.0040EF59@bayer.de>

Hello,

I would suggest to look into the solution for abbreviated keywords, which 
could work out here as well, if I correctly understand your concern.

You could realize a generic lexer rule for identifier. Code associated 
with that rule could look into the database and obtain the correct token 
id depending on the content (text) of the identifier matched by the lexer. 
The parser would then only work with token IDs and look like a "normal" 
Antlr grammar without lots of predicates.

Freundliche Gr??e / Best Regards
Lars von Wedel
_________________________________________

Bayer Technology Services GmbH
BTS-PT-PD-ES
Leverkusen, E 41
Phone: +49 214 30 56456
Fax: +49 214 30 62677
E-mail: lars.vonwedel at bayertechnology.com
Web: www.bayertechnology.com

Gesch?ftsf?hrer: Achim Noack
Aufsichtsratsvorsitzender: Dr. Wolfgang Plischke
Sitz der Gesellschaft: Leverkusen   |   Eintragung: Amtsgericht K?ln, HRB 
49896




"Heiko Folkerts" <Heiko.Folkerts at david-bs.de> 
Gesendet von: antlr-interest-bounces at antlr.org
17.08.2009 12:04

An
<antlr-interest at antlr.org>
Kopie

Thema
[antlr-interest] Using predicates for keywords






Hi,
I want to use an abstract syntax in wich the keyword e.g. for an if 
statement is available at runtime with a database call. So I don't want to 
hard code 'if' in the parser but use an expression for a ifkeyword which 
checks the database and returns wether the token is an if keyword or not.

I've tried with syntactic and semantic predicates, but even after reading 
the sections from the antlr reference I don't know which way is the right 
one for me.

The grammar would like something like this:
Statement:
Ifexpresseion
| loopexpression
;

Ifexpression: ifkeyword condition thenkeyword actionexpression;
Loopexpression: loopkeyword condition ':' actionexpression;

So how to code the ifkeyword and loopkeyword rules?

Thx in advance.
Btw.: thx to Jim for the help compiling the generated C code.

Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de 
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: 
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090817/1aa10286/attachment.html 

From jimi at temporal-wave.com  Mon Aug 17 09:09:55 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 17 Aug 2009 09:09:55 -0700
Subject: [antlr-interest] Problem with ambiguous grammar
In-Reply-To: <4A891926.5030202@interactive-objects.com>
References: <4A891926.5030202@interactive-objects.com>
Message-ID: <4A8980D3.7000608@temporal-wave.com>

Thomas Woelfle wrote:
> Hi,
>
> I have a problem with following grammar:
>
> imperative_statement
>   : imperative_compute_statement
>   ;
>  
> imperative_statement_list
>   : imperative_statement+
>   ;
>
> imperative_compute_statement
>   : COMPUTE^ Identifier+ EQUAL Identifier END_COMPUTE?
>   ;
>  
> conditional_compute_statement
>   : COMPUTE^ Identifier+ EQUAL Identifier
>       (ON? SIZE ERROR imperative_statement_list)?
>       END_COMPUTE?
>   ;
>
>
> ANTLR tells me that the rule 'imperative_compute_statement' has more 
> than one alternative to match the optional 'END_COMPUTE'. Can anybody 
> give me a hint on how to rewrite this grammar so that the warning no 
> longer appears?
>   
Your problem is that these are basically two forms of the exact same 
thing. A common mistake is to take a language spec, where such things 
are distinguished and then try to distinguish these in ANTLR rules. You 
want to merge them and as you are making do distinction between the two 
forms, all you need do is:

imperative_statement
  : imperative_compute_statement
  ;
 
imperative_statement_list
  : compute_statement+
  ;

compute_statement
  : COMPUTE^ Identifier+ EQUAL Identifier
      (ON? SIZE ERROR compute_statement+)?
      END_COMPUTE?
  ;


Now, the compute statements that are part of a conditional computer are 
not allowed to have further conditions, so you want to either reject 
this with a semantic error at parse time, or at tree walking/semantic 
checking time. An error given in this form will make much more sense to 
your users:

imperative_statement
  : imperative_compute_statement
  ;
 
imperative_statement_list
  : compute_statement[true]+
  ;

compute_statement [ boolean conditionOK ]
  : COMPUTE^ Identifier+ EQUAL Identifier
      (ON? SIZE ERROR compute_statement[false]+ {if (!conditionOK) { /* semntic error here */ }  )?
      END_COMPUTE?
  ;

Now you will get:

Error: a conditional computer statement cannot itself contain 
conditional compute statements. (Or something better worded ;-)

Instead of:

Syntax error at 'SIZE' expected one of END_COMPUTE, COMPUTE, EOF



Jim

From tball at google.com  Mon Aug 17 09:16:16 2009
From: tball at google.com (Tom Ball)
Date: Mon, 17 Aug 2009 09:16:16 -0700
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A85EBAE.6060102@lancaster.ac.uk>
References: <4A85EBAE.6060102@lancaster.ac.uk>
Message-ID: <ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>

Do you mean something other than http://antlr.org/api/Java/index.html and
http://www.stringtemplate.org/api/index.html?

On Fri, Aug 14, 2009 at 3:56 PM, Sam Barnett-Cormack <
s.barnett-cormack at lancaster.ac.uk> wrote:

> I remember a conversation about this before, but now I have a specific
> request that doesn't seem to have been fulfilled...
>
> It'd be nice to have *online* viewable javadocs for ANTLR (and
> StringTemplate), as appears very easily if you have a maven-generated
> project site... I'd like this purely so that my generated javadocs
> cleanly link to it, automatically (with some config).
>
> Any chance of this happening, or if it has, where is it?
>
> --
> Sam Barnett-Cormack
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090817/01b13aae/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Mon Aug 17 09:46:29 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Mon, 17 Aug 2009 17:46:29 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>
References: <4A85EBAE.6060102@lancaster.ac.uk>
	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>
Message-ID: <4A898965.6070901@lancaster.ac.uk>

Tom Ball wrote:
> Do you mean something other than http://antlr.org/api/Java/index.html 
> and http://www.stringtemplate.org/api/index.html?

That ST one is great, but the antlr one is doxygen, not javadoc, and the 
auto-linking expects certain formats, paths, etc that doxygen doesn't 
put them in.

Sam

> On Fri, Aug 14, 2009 at 3:56 PM, Sam Barnett-Cormack 
> <s.barnett-cormack at lancaster.ac.uk 
> <mailto:s.barnett-cormack at lancaster.ac.uk>> wrote:
> 
>     I remember a conversation about this before, but now I have a specific
>     request that doesn't seem to have been fulfilled...
> 
>     It'd be nice to have *online* viewable javadocs for ANTLR (and
>     StringTemplate), as appears very easily if you have a maven-generated
>     project site... I'd like this purely so that my generated javadocs
>     cleanly link to it, automatically (with some config).
> 
>     Any chance of this happening, or if it has, where is it?
> 
>     --
>     Sam Barnett-Cormack
> 
>     List: http://www.antlr.org/mailman/listinfo/antlr-interest
>     Unsubscribe:
>     http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 


-- 
Sam Barnett-Cormack

From jimi at temporal-wave.com  Mon Aug 17 10:50:09 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 17 Aug 2009 10:50:09 -0700
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A898965.6070901@lancaster.ac.uk>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>
	<4A898965.6070901@lancaster.ac.uk>
Message-ID: <4A899851.6010106@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090817/57a944eb/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Mon Aug 17 11:29:47 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Mon, 17 Aug 2009 19:29:47 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A899851.6010106@temporal-wave.com>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>
	<4A899851.6010106@temporal-wave.com>
Message-ID: <4A89A19B.7040900@lancaster.ac.uk>

Jim Idle wrote:
> Sam Barnett-Cormack wrote:
>> Tom Ball wrote:
>>   
>>> Do you mean something other than http://antlr.org/api/Java/index.html 
>>> and http://www.stringtemplate.org/api/index.html?
>>>     
>>
>> That ST one is great, but the antlr one is doxygen, not javadoc, and the 
>> auto-linking expects certain formats, paths, etc that doxygen doesn't 
>> put them in.
>>
>> Sam
>>
>>   
> 
> Just type:
> 
> mvn javadoc:javadoc
> 
> Then you can host it anywhere you like including just out of the local 
> directory.

I was hoping for an "official" online doc location, so I don't have to 
either ship those docs with the product, or have dangling references in 
my own docs.

-- 
Sam Barnett-Cormack

From nvivo.misc at gmail.com  Mon Aug 17 19:59:07 2009
From: nvivo.misc at gmail.com (Natan)
Date: Mon, 17 Aug 2009 23:59:07 -0300
Subject: [antlr-interest] Sub-Lexers?
In-Reply-To: <e794390908161006o70691161wfad785cf2be952dd@mail.gmail.com>
References: <e794390908161006o70691161wfad785cf2be952dd@mail.gmail.com>
Message-ID: <4A8A18FB.7000304@gmail.com>

C. Mundi wrote:
> What I'm thinking is a lexer which finds the clauses followed by a
> parser which does a trivial rewrite which embeds actions to invoke
> specialized lexers for each clause type.  All of the specialized
> levers target a single AST which is handled by a unified parser.
>   
I once found this in the wiki while looking for ways to parse 
placeholders in strings:

http://www.antlr.org/wiki/display/ANTLR3/Island+Grammars+Under+Parser+Control

But in my case I found this to be too complicated for my needs, and I 
choose to create a new filter lexer, and do the parsing later in the 
code in a method. I just needed some info for replacements, so I created 
a method in the AST node that did the lexing and return a collection of 
objects for me.

I see that in your case, you are looking for a full grammar, but anyway, 
it helps to remember you don't need to do everything in one step. If the 
grammars are that much different, you can do a 2 step pass in the code: 
parse the basics and divide the grammars like they were really different 
files, and then get the list from the parser and call a different parser 
depending on the input.

Of course, someone here with more experience may have a better solution. =)

[]'s

From consiliens at gmail.com  Mon Aug 17 21:08:22 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Mon, 17 Aug 2009 22:08:22 -0600
Subject: [antlr-interest] Matching Last Line in ANTLR?
Message-ID: <4A8A2936.30706@gmail.com>

The last line, b., doesn't match the MC_INCORRECT token because there's 
no newline after it. Is there an easy way to match this in ANTLR?

Sample Input:
1.
*a.
b.


MC_QUESTION  : INT ('.'|')') .* NEWLINE;
MC_INCORRECT : LETTER '.' .* NEWLINE;
MC_CORRECT   : '*' MC_INCORRECT;

fragment NEWLINE : '\r'? '\n';
fragment LETTER  : ('a'..'z'|'A'..'Z');
fragment INT     : '0'..'9'+;

From haluongvn at gmail.com  Tue Aug 18 02:49:58 2009
From: haluongvn at gmail.com (Ha Luong)
Date: Tue, 18 Aug 2009 02:49:58 -0700
Subject: [antlr-interest] What is ANTLR's exception which output the message
	such as "line 1:75 missing 'aaa' at 'bbb' "?
Message-ID: <61577c8f0908180249m2096d37n978ae62d35d2e647@mail.gmail.com>

Dear all,

I met the error output message "line 1:75 missing '\?' at 'trong' ", I
couldn't debug which ANTLR exception. Could you please help me?

Thank you very much,
Ha Luong
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/b49ad8c7/attachment.html 

From marwan.alephn at gmail.com  Tue Aug 18 04:32:28 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Tue, 18 Aug 2009 13:32:28 +0200
Subject: [antlr-interest] Problems generating a tree gramar. It doesn't take
	in consideration the file.tokens.
Message-ID: <6535fcb50908180432g3328cb2rfd926423443c18ea@mail.gmail.com>

Having Mygramar.Tokens I want to generate a tree gramar, but when i
genertated it does generate the same tokens with others integer values
as IDs.

Is that normal? Or there is something I'm missing. I think that the
integer IDs for a tokens should at least have the same value. I'm
having a missMatchExpetions in the code generated for that reason.

Any idea?

Many thx,
-- 
Marouane

From safisce at gmail.com  Tue Aug 18 05:03:05 2009
From: safisce at gmail.com (Safiye Celik)
Date: Tue, 18 Aug 2009 15:03:05 +0300
Subject: [antlr-interest] Fwd:  parse tree construction
In-Reply-To: <bbf7e7d50908140421q158239e5g1e4a729c8c5c6a72@mail.gmail.com>
References: <bbf7e7d50908130633q48fe188cr4e23713abb22c790@mail.gmail.com>
	<4A8442E9.7060405@temporal-wave.com>
	<bbf7e7d50908140421q158239e5g1e4a729c8c5c6a72@mail.gmail.com>
Message-ID: <bbf7e7d50908180503odc6ab7yc7edb6a96e0e3a7c@mail.gmail.com>

Do you have any idea about my problem below??

---------- Forwarded message ----------
From: Safiye Celik <safisce at gmail.com>
Date: 2009/8/14
Subject: Re: [antlr-interest] parse tree construction
To: Jim Idle <jimi at temporal-wave.com>


So I think I cannot do anything about that problem :(
It would be good if there was some syntax like "^token" which makes a token
the root, but that makes it a branch of other tree :) My aim is not to make
the tree more readable. If A is the root, I can access the tokens in the
order A, C and B. But I wanna access them in the order C, B, A. I do not
wanna go over A to access C. That is the problem.

I wanna ask one more question to you about parse tree construction..
I have such a rule:

x: A B (C D A B)* and I have to create such a tree for it:

                                                  B
                                            /      |     \
                                       A        C        B
                                                  |       /  |  \
                                                 D    A  C   B
                                                             |
                                                            D
............and continues like that.

How can I create such a tree for that rule? the "*" confuses everything :(

2009/8/13 Jim Idle <jimi at temporal-wave.com>

>  Safiye Celik wrote:
>
> Hi,
> I have a grammar such below:
>
> a: b A
> b: C^ B
>
> What I want is to set "A" token in rule "a" as the last branch of rule "b"
> 's parse tree without changing the grammar, rules, tokens etc. (because the
> rules and tokens are used somewhere else, the grammar is not such simple of
> course)
>
> That's, I want a tree like: ^(C B A). But I only know how to set "A" as the
> root of  rule "a" with this grammar(that is done by a: b A^), and it causes
> a tree like ^(A C B) which I do not want.
>
> Is there a way to construct the tree I want with above grammar??
>
> Take a step back here - you probably don't need to do this. The point of an
> AST isn't to make it readable to you per se (though it helps ;-), but to
> make sure it is unambiguous to the tree parser. If this is your exact
> grammar then the tree rule is just:
>
> a: b A;
>
> b : ^(C B);
>
> And if you need to process A in some actions in rule b, then just pass it
> to rule B (but you might be better initiating the action in rule a and
> having the b tree available.
>
>
> If you cannot change the rules then there isn't much you *can *do ;-)
> However perhaps you could inherit the originating grammar in an *import*within a new grammar, then just override rule a:
>
> import existing.g
>
> a : C^ B A ;
>
> You could also use actions to build the AST yourself, but then that is a
> modification to the rules of course. You could also add action code in the
> tree parser to traverse the tree of b. Finally you could have an interim
> tree grammar that rewrites the tree to your purposes.
>
> Jim
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>


-- 
-safiye



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/7ad706f6/attachment.html 

From marwan.alephn at gmail.com  Tue Aug 18 05:29:00 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Tue, 18 Aug 2009 14:29:00 +0200
Subject: [antlr-interest] Urgent: where i have to locate the mygramar.Tokens
	to generate Tree Gramar?
Message-ID: <6535fcb50908180529n3be1a130rbb671c860a896343@mail.gmail.com>

Many thx,

-- 
Marouane

From sadau.emailme at gmail.com  Tue Aug 18 06:14:45 2009
From: sadau.emailme at gmail.com (Sumesh)
Date: Tue, 18 Aug 2009 18:44:45 +0530
Subject: [antlr-interest] Anybody has a grammer file for blaze rules ( blaze
	rules engine - fair issac)
Message-ID: <39b15cc10908180614j1d346d2ah802eb140da60f007@mail.gmail.com>

Hi,

I know.. may not be available out of the box ...just checking before
developing

I would be really greatful if some one has a bit in place

Thanks
Sadau
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/1c51a939/attachment.html 

From dave at tridecap.com  Tue Aug 18 06:21:32 2009
From: dave at tridecap.com (Dave Dutcher)
Date: Tue, 18 Aug 2009 08:21:32 -0500
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8A2936.30706@gmail.com>
References: <4A8A2936.30706@gmail.com>
Message-ID: <1C1B54E6B22445979BF0D80EB0EC86DC@tridecap.com>

> -----Original Message-----
> From: consiliens at gmail.com
> 
> The last line, b., doesn't match the MC_INCORRECT token 
> because there's no newline after it. Is there an easy way to 
> match this in ANTLR?


Do you need the newline in the text of the token?  You could try removing
fragment from the NEWLINE rule and then setting it to the hidden channel.
Then have your lexer rules match everything except the new line characters.
Like this:

MC_QUESTION  : INT ('.'|')') ~('\n'|'\r')*; 
MC_INCORRECT : LETTER '.' ~('\n'|'\r')*;
MC_CORRECT   : '*' MC_INCORRECT;

NEWLINE : '\r'? '\n' { $channel = HIDDEN };

fragment LETTER  : ('a'..'z'|'A'..'Z');
fragment INT     : '0'..'9'+;

I'm kind of new at Antlr too, but I think that would work.

Dave


From s.barnett-cormack at lancaster.ac.uk  Tue Aug 18 06:50:51 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Tue, 18 Aug 2009 14:50:51 +0100
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <1C1B54E6B22445979BF0D80EB0EC86DC@tridecap.com>
References: <4A8A2936.30706@gmail.com>
	<1C1B54E6B22445979BF0D80EB0EC86DC@tridecap.com>
Message-ID: <4A8AB1BB.4030509@lancaster.ac.uk>

Dave Dutcher wrote:
>> -----Original Message-----
>> From: consiliens at gmail.com
>>
>> The last line, b., doesn't match the MC_INCORRECT token 
>> because there's no newline after it. Is there an easy way to 
>> match this in ANTLR?
> 
> 
> Do you need the newline in the text of the token?  You could try removing
> fragment from the NEWLINE rule and then setting it to the hidden channel.
> Then have your lexer rules match everything except the new line characters.

That would remove the requirement that each thingy be on a separate 
line. You could consider various options. For one thing, I'm not sure 
you *really* want those to be huge lexer rules, rather than moving it up 
to the parsing stage. Then you could make newlines a separate rule but 
*don't* make them hidden, and account for them at parse-time.

Otherwise, there's a non-antlr solution. Pre-cache the file (ie load it 
to a string buffer), check if the last character is a \n, if it isn't, 
append one. Then use a relevant reader to pass the buffer to the lexer, 
rather than the file.

-- 
Sam Barnett-Cormack

From jimi at temporal-wave.com  Tue Aug 18 09:07:45 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 18 Aug 2009 09:07:45 -0700
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8A2936.30706@gmail.com>
References: <4A8A2936.30706@gmail.com>
Message-ID: <4A8AD1D1.608@temporal-wave.com>

consiliens at gmail.com wrote:
> The last line, b., doesn't match the MC_INCORRECT token because there's 
> no newline after it. Is there an easy way to match this in ANTLR?
>
> Sample Input:
> 1.
> *a.
> b.
>
>
> MC_QUESTION  : INT ('.'|')') .* NEWLINE;
> MC_INCORRECT : LETTER '.' .* NEWLINE;
> MC_CORRECT   : '*' MC_INCORRECT;
>
> fragment NEWLINE : '\r'? '\n';
> fragment LETTER  : ('a'..'z'|'A'..'Z');
> fragment INT     : '0'..'9'+;
>   
Just add a newline to the end of the input before submitting it. It is 
much easier than trying to cope with it at the parsing level.

Jim

From jimi at temporal-wave.com  Tue Aug 18 09:11:16 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 18 Aug 2009 09:11:16 -0700
Subject: [antlr-interest] What is ANTLR's exception which output the
 message such as "line 1:75 missing 'aaa' at 'bbb' "?
In-Reply-To: <61577c8f0908180249m2096d37n978ae62d35d2e647@mail.gmail.com>
References: <61577c8f0908180249m2096d37n978ae62d35d2e647@mail.gmail.com>
Message-ID: <4A8AD2A4.1060301@temporal-wave.com>

Ha Luong wrote:
> Dear all,
>
> I met the error output message "line 1:75 missing '\?' at 'trong' ", I 
> couldn't debug which ANTLR exception. Could you please help me?
>
> Thank you very much,
> Ha Luong

Please note that there are search facilitates for both the mailing list 
and the wiki:

http://www.antlr.org/wiki/display/ANTLR3/Error+reporting+and+recovery


Jim

From jimi at temporal-wave.com  Tue Aug 18 09:13:40 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 18 Aug 2009 09:13:40 -0700
Subject: [antlr-interest] Problems generating a tree gramar. It doesn't
 take	in consideration the file.tokens.
In-Reply-To: <6535fcb50908180432g3328cb2rfd926423443c18ea@mail.gmail.com>
References: <6535fcb50908180432g3328cb2rfd926423443c18ea@mail.gmail.com>
Message-ID: <4A8AD334.2040305@temporal-wave.com>

Marwan Ajraoui wrote:
> Having Mygramar.Tokens I want to generate a tree gramar, but when i
> genertated it does generate the same tokens with others integer values
> as IDs.
>
> Is that normal? Or there is something I'm missing. I think that the
> integer IDs for a tokens should at least have the same value. I'm
> having a missMatchExpetions in the code generated for that reason.
>
> Any idea?
>   
Have you set the token vocab options in your tree grammar such that it 
is looking for Mygramar.tokens [sic]?

Jim


From david-sarah at jacaranda.org  Tue Aug 18 11:43:09 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 18 Aug 2009 19:43:09 +0100
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8A2936.30706@gmail.com>
References: <4A8A2936.30706@gmail.com>
Message-ID: <4A8AF63D.3000809@jacaranda.org>

consiliens at gmail.com wrote:
> The last line, b., doesn't match the MC_INCORRECT token because there's 
> no newline after it. Is there an easy way to match this in ANTLR?

Yes. I had the same problem when matching the end of a //-style comment,
and solved it like this:

fragment ENDOFLINE
  : NEWLINE
  | { input.LA(1) == EOF }?
  ;

(If this were a non-fragment rule, it would be a problem that it can
sometimes match no characters, but since it's a fragment, that's OK.)

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From shambolic at gmail.com  Tue Aug 18 11:43:53 2009
From: shambolic at gmail.com (Joe Schmoe)
Date: Tue, 18 Aug 2009 11:43:53 -0700
Subject: [antlr-interest] Strategy for mapping output to line numbers from a
	tree walker
Message-ID: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>

I have a grammar that produces an AST and a tree walker, and I am coming up
blank trying to figure out a reasonable way to track line number information
in the tree walker so that I can map my output to source file lines.
The only solution I have come up with is incredibly wordy, which is to make
sure that every time I see a token name in the walker I track the line
number.

rule : ^(TOKENNAME .... ) { TrackLine($TOKENNAME.line) }
      ;

I am sure there are better solutions than this but I haven't been able to
figure out what they are.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/3115e5b2/attachment.html 

From rob_dougan at sympatico.ca  Tue Aug 18 11:53:34 2009
From: rob_dougan at sympatico.ca (Rob Dougan)
Date: Tue, 18 Aug 2009 18:53:34 +0000
Subject: [antlr-interest] tree walker executes method call twice?
Message-ID: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>


 

during testing i noticed that my tree walker seems to be walking the tree twice ...

 

tree grammar t.g

prog    : stat+  
 ;

stat
@init   {  Console.Out.WriteLine("INTO stat");   }
@after  {  Console.Out.WriteLine("OUTOF stat");  }   
        :  exprRoot
 ;

exprRoot
@init   { Console.Out.WriteLine("INTO exprRoot"); }
@after  { Console.Out.WriteLine("OUTOF exprRoot");   } 
        :  ^(EXPR expr)
        ;

expr 
@init { Console.Out.WriteLine("INTO expr"); }
@after  { Console.Out.WriteLine("OUTOF expr"); }
        : ID
        | call    
        ;

call    
@init   { Console.Out.WriteLine("INTO call"); }
@after  { Console.Out.WriteLine("OUTOF call");  } 
        : ^(CALL ID exprList?)
        {
          Console.Out.WriteLine("--------in call");
        }                   
        ;

exprList
        :   ^(EXPRLIST .*)
        |   EXPRLIST
        ;

 

my program is just one statement, one function call


input:
       myfunc(x);

 

 

trace:

INTO stat
INTO exprRoot
INTO expr
INTO call
INTO expr
OUTOF expr
-------------in call myfunc
OUTOF call
OUTOF expr
OUTOF exprRoot
OUTOF stat
                              and then it does it again ...
INTO stat
INTO exprRoot
INTO expr
INTO call
INTO expr
OUTOF expr
-------------in call myfunc
OUTOF call
OUTOF expr
OUTOF exprRoot
OUTOF stat


anyone spot a grammar problem?

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/a6c65a69/attachment.html 

From jimi at temporal-wave.com  Tue Aug 18 12:57:11 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 18 Aug 2009 12:57:11 -0700
Subject: [antlr-interest] Strategy for mapping output to line numbers
 from a	tree walker
In-Reply-To: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
References: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
Message-ID: <4A8B0797.7030106@temporal-wave.com>

Joe Schmoe wrote:
> I have a grammar that produces an AST and a tree walker, and I am 
> coming up blank trying to figure out a reasonable way to track line 
> number information in the tree walker so that I can map my output to 
> source file lines.
>
> The only solution I have come up with is incredibly wordy, which is to 
> make sure that every time I see a token name in the walker I track the 
> line number. 
>
> rule : ^(TOKENNAME .... ) { TrackLine($TOKENNAME.line) }  
>       ;
>
> I am sure there are better solutions than this but I haven't been able 
> to figure out what they are.
Search the list for code to do this.

Basically, create yourself some helper methods that given a tree node or 
a token, work this out for you. Form a tree node, you can ask for the 
starting token and ending token and use those tokens to compute the span 
of the tree by asking for their start and end indexes (for error 
underlining and other similar purposes). The best thing is to create a 
little framework for handling errors, picking up information and so on - 
you can reuse it for many grammars.

Here are a few methods you might find useful for stealing ideas from 
(they are just excerpts but show you the methods to use)

Jim


    protected int pos() {

        return pos(input.LT(1));
    }

    /**
     * Calculates the character position of the first character of the text
     * in the input stream that the supplied token represents.
     * @param tok The token to locate in the input stream
     * @return The character position of the next non-whitespace token 
in the input stream
     */
    protected int pos(Token tok) {
       
        return ((CommonToken)tok).getStartIndex();
    }

    /**
     * Calculates the character position of the last character of the text
     * in the input stream that the supplied token represents.
     * @param tok The token to locate in the input stream
     * @return The character position of the next non-whitespace token 
in the input stream
     */
    protected int endPos(Token tok) {

        return ((CommonToken)tok).getStopIndex();
    }

  /**
     * Log a particular message into the message log (typically from 
syntax errors and so on)
     *
     * @param msgDesc   The message we want to log
     * @param line      The line that this message appertains to
     * @param colPos    The column position in the line
     * @param startPos  The start offset of the error
     * @param endPos    The end offset of the error
     * @param args      The arguments for formatting the message
     */
    public void
    logMsg(MessageDescriptor msgDesc, int line, int colPos, int 
startPos, int endPos, Object... args)
    {
        // Instantiate the message
        //
        Message m = new Message(msgDesc, fileName, line, colPos, 
startPos, endPos, args);

        // Store in the vector
        //
        messages.add(m);

        // Count the severity
        //
        switch (msgDesc.getSeverity()) {

            case ERROR:

                errorCount++;
                break;

            case WARNING:

                warningCount++;
                break;

            case FATAL:

                errorCount++;
                fatalCount++;
                break;

            // No default as Enum is type safe
        }
    }
   
    /**
     * Create a message regarding a single token, taking the start and 
end positions
     * from the token.
     *
     * @param m    The type of message you want to create
     * @param ct   The CommonToken that we are reporting against
     * @param args The parameters for the message we are raising
     */
    public void logMsg(MessageDescriptor m, Token ct, Object... args) {

        // Call the standard logger, using the information in the token
        //
        logMsg(m, ((CommonToken)ct).getLine(), 
((CommonToken)ct).getCharPositionInLine(), 
((CommonToken)ct).getStartIndex(), ((CommonToken)ct).getStopIndex(), args);

    }

    /**
     * Create a message regarding a root node such as an expression, 
taking the start and end positions
     * from the tree node.
     *
     * @param m    The type of message you want to create
     * @param ct   The CommonToken that we are reporting against
     * @param args The parameters for the message we are raising
     */
    public void logMsg(MessageDescriptor m, CommonTree ct, Object... args) {

        CommonToken st;
        CommonToken et;

        st = (CommonToken)(tokens.get(ct.getTokenStartIndex()));
        et = (CommonToken)(tokens.get(ct.getTokenStopIndex()));

        // Call the standard logger, using the information in the tokens
        //
        logMsg(m, st.getLine(), st.getCharPositionInLine(), 
st.getStartIndex(), et.getStopIndex(), args);

    }
    /**
     * Create a message regarding a single token, taking the start position
     * from the token but the end position as specified
     *
     * @param m      The type of message you want to create
     * @param ct     The CommonToken that we are reporting against
     * @param endPos The absolute offset where the span of the error 
message should end
     * @param args   The parameters for the message we are raising
     */
    public void logMsg(MessageDescriptor m, Token ct, int endPos, 
Object... args) {

        // Call the standard logger, using the information in the token
        //
        logMsg(m, ((CommonToken)ct).getLine(), 
((CommonToken)ct).getCharPositionInLine(), 
((CommonToken)ct).getStartIndex(), endPos, args);

    }

    /**
     * Create a message that appertains to a span of tokens, such as 
when the
     * result of an expression is incorrect and so on.
     *
     * @param m         The type of message you want to create
     * @param startCt   The CommonToken that starts the message
     * @param stopCt    The commonToken that ends the message
     * @param args      The parameters for the message we are raising
     *
     */
    public void logMsg(MessageDescriptor m, Token startCt, Token stopCt, 
Object... args) {

        // Call the standard logger, using the information in the token
        //
       logMsg(m, ((CommonToken)startCt).getLine(), 
((CommonToken)startCt).getCharPositionInLine(), 
((CommonToken)startCt).getStartIndex(), 
((CommonToken)stopCt).getStopIndex(), args);
    }


From jimi at temporal-wave.com  Tue Aug 18 12:58:43 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 18 Aug 2009 12:58:43 -0700
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
Message-ID: <4A8B07F3.6090505@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/e6c36a4e/attachment.html 

From consiliens at gmail.com  Tue Aug 18 13:08:02 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Tue, 18 Aug 2009 14:08:02 -0600
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8AF63D.3000809@jacaranda.org>
References: <4A8A2936.30706@gmail.com> <4A8AF63D.3000809@jacaranda.org>
Message-ID: <4A8B0A22.1060407@gmail.com>

On 09-08-18 12:43 PM, David-Sarah Hopwood wrote:
> consiliens at gmail.com wrote:
>> The last line, b., doesn't match the MC_INCORRECT token because there's
>> no newline after it. Is there an easy way to match this in ANTLR?
>
> Yes. I had the same problem when matching the end of a //-style comment,
> and solved it like this:
>
> fragment ENDOFLINE
>    : NEWLINE
>    | { input.LA(1) == EOF }?
>    ;
>
> (If this were a non-fragment rule, it would be a problem that it can
> sometimes match no characters, but since it's a fragment, that's OK.)
>

I want to use your solution, however it throws errors about "The 
following alternatives can never be matched: 1" for MC_QUESTION and 
MC_INCORRECT. Shouldn't the below work?

MC_QUESTION  : INT ('.'|')') .* ENDOFLINE;
MC_INCORRECT : LETTER '.' .* ENDOFLINE;
MC_CORRECT   : '*' MC_INCORRECT;

fragment ENDOFLINE : NEWLINE | { input.LA(1) == EOF }?;
fragment NEWLINE : '\r'? '\n';
fragment LETTER  : ('a'..'z'|'A'..'Z');
fragment INT     : '0'..'9'+;

From antlr at mirality.co.nz  Tue Aug 18 13:22:18 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 19 Aug 2009 08:22:18 +1200
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8B0A22.1060407@gmail.com>
References: <4A8A2936.30706@gmail.com> <4A8AF63D.3000809@jacaranda.org>
	<4A8B0A22.1060407@gmail.com>
Message-ID: <20090818203620.DDFE734184C4@www.antlr.org>

At 08:08 19/08/2009, consiliens at gmail.com wrote:
 >I want to use your solution, however it throws errors about "The 

 >following alternatives can never be matched: 1" for MC_QUESTION
 >and MC_INCORRECT. Shouldn't the below work?
 >
 >MC_QUESTION  : INT ('.'|')') .* ENDOFLINE;
 >MC_INCORRECT : LETTER '.' .* ENDOFLINE;
 >MC_CORRECT   : '*' MC_INCORRECT;
 >
 >fragment ENDOFLINE : NEWLINE | { input.LA(1) == EOF }?;

No.  You can't use a .* wildcard loop without (a) always having at 
least one termination character and (b) specifying it inline 
rather than in a subrule.

If you remove the .* (or make it more specific, eg. WS*) then it 
should work.


From consiliens at gmail.com  Tue Aug 18 14:05:11 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Tue, 18 Aug 2009 15:05:11 -0600
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4a8b10c5.0408c00a.4e56.fffff6e9SMTPIN_ADDED@mx.google.com>
References: <4A8A2936.30706@gmail.com> <4A8AF63D.3000809@jacaranda.org>
	<4A8B0A22.1060407@gmail.com>
	<4a8b10c5.0408c00a.4e56.fffff6e9SMTPIN_ADDED@mx.google.com>
Message-ID: <4A8B1787.4090908@gmail.com>

On 09-08-18 02:22 PM, Gavin Lambert wrote:
> At 08:08 19/08/2009, consiliens at gmail.com wrote:
>  >I want to use your solution, however it throws errors about "The
>  >following alternatives can never be matched: 1" for MC_QUESTION
>  >and MC_INCORRECT. Shouldn't the below work?
>  >
>  >MC_QUESTION : INT ('.'|')') .* ENDOFLINE;
>  >MC_INCORRECT : LETTER '.' .* ENDOFLINE;
>  >MC_CORRECT : '*' MC_INCORRECT;
>  >
>  >fragment ENDOFLINE : NEWLINE | { input.LA(1) == EOF }?;
>
> No. You can't use a .* wildcard loop without (a) always having at least
> one termination character and (b) specifying it inline rather than in a
> subrule.
>
> If you remove the .* (or make it more specific, eg. WS*) then it should
> work.
>
>

For testing I removed the .* and, while there are no errors, it still 
doesn't match b. as the token MC_INCORRECT unless there is a newline 
after it. The purpose of .*, within the context of this grammar, is to 
match the text between the line identifier and the line end. So the 
input could be
1. Is ANTLR useful?
*a. True
b. False

The existing regular expression based parser solves many of these issues 
in an elegant way, however I want to use another tool for language 
recognition. I'm hoping that this ANTLR grammar will at least be able to 
reach feature parity.

Sample Input:
1.
*a.
b.

MC_QUESTION  : INT ('.'|')') ENDOFLINE;
MC_INCORRECT : LETTER '.' ENDOFLINE;
MC_CORRECT   : '*' MC_INCORRECT;

fragment ENDOFLINE : NEWLINE | { input.LA(1) == EOF }?;
fragment NEWLINE : '\r'? '\n';
fragment LETTER  : ('a'..'z'|'A'..'Z');
fragment INT     : '0'..'9'+;

From jimi at temporal-wave.com  Tue Aug 18 14:15:31 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 18 Aug 2009 14:15:31 -0700
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8B0A22.1060407@gmail.com>
References: <4A8A2936.30706@gmail.com> <4A8AF63D.3000809@jacaranda.org>
	<4A8B0A22.1060407@gmail.com>
Message-ID: <4A8B19F3.8020005@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/94e3a887/attachment.html 

From rob_dougan at sympatico.ca  Tue Aug 18 14:18:56 2009
From: rob_dougan at sympatico.ca (Rob Dougan)
Date: Tue, 18 Aug 2009 21:18:56 +0000
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <4A8B07F3.6090505@temporal-wave.com>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
	<4A8B07F3.6090505@temporal-wave.com>
Message-ID: <COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>


 

pass 1 - lex/parse produces heteroAst (nil root)

pass 2 - heteroAst  into symbol table walker 

nodes reset

pass 3 - heteroAst into type checking walker  (adds type info to ast)  ---> walks twice

 

its just a typical expression tree (C-like), the function call (abs(1.0)) is the smallest statement I could get to fail

but

the tree walker always walks the input twice ... almost like the tree was duplicated

hmmm

will continue investigating ... 

 

R


Date: Tue, 18 Aug 2009 12:58:43 -0700
From: jimi at temporal-wave.com
CC: antlr-interest at antlr.org
Subject: Re: [antlr-interest] tree walker executes method call twice?

Rob Dougan wrote: 


 
during testing i noticed that my tree walker seems to be walking the tree twice ...
  
anyone spot a grammar problem?
  
What does the input tree look like?

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/98bf08e5/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: DoubleWalk1.jpg
Type: image/pjpeg
Size: 2918 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/98bf08e5/attachment.bin 

From david-sarah at jacaranda.org  Tue Aug 18 14:22:06 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 18 Aug 2009 22:22:06 +0100
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8B0A22.1060407@gmail.com>
References: <4A8A2936.30706@gmail.com> <4A8AF63D.3000809@jacaranda.org>
	<4A8B0A22.1060407@gmail.com>
Message-ID: <4A8B1B7E.2070502@jacaranda.org>

consiliens at gmail.com wrote:
> On 09-08-18 12:43 PM, David-Sarah Hopwood wrote:
>> consiliens at gmail.com wrote:
>>> The last line, b., doesn't match the MC_INCORRECT token because there's
>>> no newline after it. Is there an easy way to match this in ANTLR?
>> Yes. I had the same problem when matching the end of a //-style comment,
>> and solved it like this:
>>
>> fragment ENDOFLINE
>>    : NEWLINE
>>    | { input.LA(1) == EOF }?
>>    ;
>>
>> (If this were a non-fragment rule, it would be a problem that it can
>> sometimes match no characters, but since it's a fragment, that's OK.)
> 
> I want to use your solution, however it throws errors about "The 
> following alternatives can never be matched: 1" for MC_QUESTION and 
> MC_INCORRECT. Shouldn't the below work?
> 
> MC_QUESTION  : INT ('.'|')') .* ENDOFLINE;
> MC_INCORRECT : LETTER '.' .* ENDOFLINE;
> MC_CORRECT   : '*' MC_INCORRECT;
> 
> fragment ENDOFLINE : NEWLINE | { input.LA(1) == EOF }?;
> fragment NEWLINE : '\r'? '\n';
> fragment LETTER  : ('a'..'z'|'A'..'Z');
> fragment INT     : '0'..'9'+;

ANTLR is correctly warning that .* will always match to the end of the
input (since . includes '\r' and '\n'), so the NEWLINE will never be
matched. This problem occurs in both the MC_QUESTION and MC_INCORRECT
rules.

Normally you would be able to use "(options { greedy=false; } : .)*" in
place of ".*" to correct a problem like this. However, that doesn't appear
to work in this particular case (in my experience the greedy=false option
can be a bit fragile), so I would suggest:

MC_QUESTION  : INT ('.' | ')') NOTNEWLINE* ENDOFLINE;
MC_INCORRECT : LETTER '.' NOTNEWLINE* ENDOFLINE;

// ~NEWLINE won't work in this case.
fragment NOTNEWLINE
  : ~('\r' | '\n')
  | { input.LA(2) != '\n' }? '\r'
  ;

// ENDOFLINE, NEWLINE, LETTER and INT unchanged


Alternatively, you might want to match bare '\r' as a newline (as used
in original MacOS). In that case change MC_QUESTION and MC_INCORRECT as
above, but use:

fragment NOTNEWLINE : ~('\r' | '\n');
fragment NEWLINE : '\r' '\n'? | '\n';

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From antlr at mirality.co.nz  Tue Aug 18 14:28:28 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 19 Aug 2009 09:28:28 +1200
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8B1787.4090908@gmail.com>
References: <4A8A2936.30706@gmail.com> <4A8AF63D.3000809@jacaranda.org>
	<4A8B0A22.1060407@gmail.com>
	<4a8b10c5.0408c00a.4e56.fffff6e9SMTPIN_ADDED@mx.google.com>
	<4A8B1787.4090908@gmail.com>
Message-ID: <20090818212839.181BD34184D4@www.antlr.org>

At 09:05 19/08/2009, consiliens at gmail.com wrote:
 >For testing I removed the .* and, while there are no errors, it
 >still doesn't match b. as the token MC_INCORRECT unless there
 >is a newline after it.
[...]
 >MC_QUESTION  : INT ('.'|')') ENDOFLINE;
 >MC_INCORRECT : LETTER '.' ENDOFLINE;
 >MC_CORRECT   : '*' MC_INCORRECT;
 >
 >fragment ENDOFLINE : NEWLINE | { input.LA(1) == EOF }?;

Are you using the debugger or the interpreter to test with?  The 
interpreter doesn't execute predicates, so it won't work properly; 
you need to use the debugger.

It also might pay to try a few variations on the ENDOFLINE rule; 
sometimes ANTLR seems to ignore predicates if it thinks that 
they're not accomplishing anything.  Try this, for example:

fragment ENDOFLINE : { input.LA(1) == EOF }? => | NEWLINE ;

or this:

fragment ENDOFLINE : NEWLINE | EOF ;


From rob_dougan at sympatico.ca  Tue Aug 18 14:32:52 2009
From: rob_dougan at sympatico.ca (Rob Dougan)
Date: Tue, 18 Aug 2009 21:32:52 +0000
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
	<4A8B07F3.6090505@temporal-wave.com> 
	<COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
Message-ID: <COL121-W42DD4615E413F463826F1987FF0@phx.gbl>


doh! reset dupes the tree
 


From: rob_dougan at sympatico.ca
To: jimi at temporal-wave.com
Date: Tue, 18 Aug 2009 21:18:56 +0000
CC: antlr-interest at antlr.org
Subject: Re: [antlr-interest] tree walker executes method call twice?



 
pass 1 - lex/parse produces heteroAst (nil root)
pass 2 - heteroAst  into symbol table walker 
nodes reset
pass 3 - heteroAst into type checking walker  (adds type info to ast)  ---> walks twice
 
its just a typical expression tree (C-like), the function call (abs(1.0)) is the smallest statement I could get to fail
but
the tree walker always walks the input twice ... almost like the tree was duplicated
hmmm
will continue investigating ... 
 
R


Date: Tue, 18 Aug 2009 12:58:43 -0700
From: jimi at temporal-wave.com
CC: antlr-interest at antlr.org
Subject: Re: [antlr-interest] tree walker executes method call twice?

Rob Dougan wrote: 


 
during testing i noticed that my tree walker seems to be walking the tree twice ...
  
anyone spot a grammar problem?
  
What does the input tree look like?

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/e4a3967f/attachment.html 

From lists at brachttal.net  Tue Aug 18 15:22:49 2009
From: lists at brachttal.net (Andreas Volz)
Date: Wed, 19 Aug 2009 00:22:49 +0200
Subject: [antlr-interest] VCard parser
Message-ID: <20090819002249.0018631f@frodo.mittelerde>

Hello,

I'm just starting with ANTLR and try to build a VCard parser. This is
the data I like to parse:

BEGIN:VCARD
VERSION:3.0
N:Mustermann;Max
FN:Max Mustermann
ORG:Wikipedia
URL:http://de.wikipedia.org/
EMAIL;TYPE=INTERNET:max.mustermann at example.org
TEL;TYPE=voice,work,pref:+49 1234 56788
ADR;TYPE=intl,work,postal,parcel:;;Musterstra?e 1;Musterstadt;;12345;Germany
END:VCARD

My very first try is this:

grammar VCard;

BEGIN	:	'BEGIN:VCARD';

END	:	'END:VCARD';

VCARD	:	BEGIN LINE+ END;

LINE	: 	KEY DP VALUE;

KEY	:	~':';

DP 	:	':';

VALUE	:	('a'..'z' |'A'..'Z' )+;


But this is only a first step. I couldn't get a more complex rule to work,

A problem that I open get is the message:

"The following token definitions can never be matched because prior tokens
 match the same input"

Even if I don't use that token somewhere, Could anyone maybe explain me why
this very simple grammar doesn't work:

grammar test;

KEY	:	('a'..'z' |'A'..'Z' )+;

VALUE	:	('a'..'z' |'A'..'Z' )+;

LINE	:	KEY '=' VALUE;

=> "The following token definitions can never be matched because prior tokens 
match the same input: VALUE"

How would I do this very simple key/value example?

regards
Andreas

From beradrian at yahoo.com  Tue Aug 18 15:33:35 2009
From: beradrian at yahoo.com (Adrian Ber)
Date: Tue, 18 Aug 2009 15:33:35 -0700 (PDT)
Subject: [antlr-interest] error recovery
Message-ID: <563885.61745.qm@web30701.mail.mud.yahoo.com>

Hi all,

I'm doing another attempt with the hope that somebody knows the answer and he/she wants to share.
I have an HTML grammar and I have a lexer rule for strings:

STRING    :    '"' (ESC|~('"'|'\\'|'\n'|'\r'))* '"'
        | '\'' (ESC|~('\''|'\\'|'\n'|'\r'))* '\''
        ;

But if I have a text in html like 
    I'm just a text
then the lexer will try to identify a string and it will generate an error.

How can I solve this?

Thanks,
Adrian.


      Get your preferred Email name!
Now you can @ymail.com and @rocketmail.com. 
http://mail.promotions.yahoo.com/newdomains/aa/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/61b56845/attachment.html 

From consiliens at gmail.com  Tue Aug 18 15:40:40 2009
From: consiliens at gmail.com (consiliens at gmail.com)
Date: Tue, 18 Aug 2009 16:40:40 -0600
Subject: [antlr-interest] Matching Last Line in ANTLR?
In-Reply-To: <4A8B1B7E.2070502@jacaranda.org>
References: <4A8A2936.30706@gmail.com>
	<4A8AF63D.3000809@jacaranda.org>	<4A8B0A22.1060407@gmail.com>
	<4A8B1B7E.2070502@jacaranda.org>
Message-ID: <4A8B2DE8.7030903@gmail.com>

On 09-08-18 03:22 PM, David-Sarah Hopwood wrote:
> Alternatively, you might want to match bare '\r' as a newline (as used
> in original MacOS). In that case change MC_QUESTION and MC_INCORRECT as
> above, but use:
>
> fragment NOTNEWLINE : ~('\r' | '\n');
> fragment NEWLINE : '\r' '\n'? | '\n';
>
I really appreciate all the help from the mailing list. The above 
appears to work quite well. Thank you.

From david-sarah at jacaranda.org  Tue Aug 18 15:42:10 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 18 Aug 2009 23:42:10 +0100
Subject: [antlr-interest] When can .* be used? (was: Matching Last Line in
	ANTLR)
In-Reply-To: <20090818212839.181BD34184D4@www.antlr.org>
References: <4A8A2936.30706@gmail.com>
	<4A8AF63D.3000809@jacaranda.org>	<4A8B0A22.1060407@gmail.com>	<4a8b10c5.0408c00a.4e56.fffff6e9SMTPIN_ADDED@mx.google.com>	<4A8B1787.4090908@gmail.com>
	<20090818212839.181BD34184D4@www.antlr.org>
Message-ID: <4A8B2E42.6010604@jacaranda.org>

[Note that the version I posted using NOTNEWLINE* solves the original
poster's problem (as would appending '\n' to the stream before lexing,
although that requires writing extra code). The discussion below is
just about details of why other approaches using .* don't work.]

Gavin Lambert wrote:
> At 09:05 19/08/2009, consiliens at gmail.com wrote:
>  >For testing I removed the .* and, while there are no errors, it
>  >still doesn't match b. as the token MC_INCORRECT unless there
>  >is a newline after it.
> [...]
>  >MC_QUESTION  : INT ('.'|')') ENDOFLINE;
>  >MC_INCORRECT : LETTER '.' ENDOFLINE;
>  >MC_CORRECT   : '*' MC_INCORRECT;
>  >
>  >fragment ENDOFLINE : NEWLINE | { input.LA(1) == EOF }?;
> 
> Are you using the debugger or the interpreter to test with?  The 
> interpreter doesn't execute predicates, so it won't work properly; 
> you need to use the debugger.

Right.

> It also might pay to try a few variations on the ENDOFLINE rule; 
> sometimes ANTLR seems to ignore predicates if it thinks that 
> they're not accomplishing anything.  Try this, for example:
> 
> fragment ENDOFLINE : { input.LA(1) == EOF }? => | NEWLINE ;
> 
> or this:
> 
> fragment ENDOFLINE : NEWLINE | EOF ;

ENDOFLINE can indeed be simplified to NEWLINE | EOF.

However, that won't help because it is not the predicate that
causes the problem here; it's the fact that the match immediately
following .* uses the '|' operator. Note that it doesn't matter
whether this match is "inlined" or in a separate fragment rule
(and it also doesn't matter whether (option { greedy=false; } : .)*
is used instead of .*).

For instance, this version of MC_QUESTION still produces the warning:

MC_QUESTION :
  INT ('.'|')') (options { greedy=false; } : .)* ('\r'? '\n' | EOF);

Either of these work, and do not warn (but do not accept end-of-file):

MC_QUESTION : INT ('.'|')') .* NEWLINE;
or
MC_QUESTION : INT ('.'|')') .* ('\r'? '\n');

but this produces the warning:

MC_QUESTION : INT ('.'|')') .* ('\r' '\n' | '\n');

even though you would normally expect ('\r'? '\n') to be equivalent to
('\r' '\n' | '\n').

Therefore, .* can't be used in cases where the match following it
necessarily involves an alternation that can't be expressed using '?'.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From simon at simoncave.info  Tue Aug 18 16:05:02 2009
From: simon at simoncave.info (Simon Cave)
Date: Wed, 19 Aug 2009 00:05:02 +0100
Subject: [antlr-interest] AS3 output from AntlrWorks seems incompatible with
	runtime SWC
Message-ID: <885DD06C-212E-4F00-885E-AC3A475A8E4D@simoncave.info>

Hi,

I'm trying to use ANTLR to create a simple math parser targetting AS3  
(Flash). I am using the latest version of AntlrWorks (1.2.3) on a Mac  
and have downloaded the runtime SWC fromhttp://antlr.org/download/ActionScript/antlr3.swc 
.

The generated code looks fine, but seems to be incompatible with the  
runtime. There are many compile-time issues due to missing ancestor  
functions, constants and variables. For example, both the lexer and  
the parser want to override grammarFileName() but it is not defined in  
either of the base classes in the runtime.

In addition to this, some Java seems to have found its way into the  
generated parser class:

             catch (FailedPredicateException fpe) {

                     String tvt = (tv!=null?tv.text:null);
                     String msg = "In function \"" + fnt +
                       "\" the term variable \"" + tvt +
                       "\" doesn't match function variable \"" + fvt +  
"\".";
                     throw new RuntimeException(msg);

             }
             finally {
             }

I'm just getting started with Antlr and I greatly appreciate any help  
the community can give me on this one. Please let me know if posting  
these files will help.

Thanks,

Simon Cave

From jimi at temporal-wave.com  Tue Aug 18 16:20:49 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 18 Aug 2009 16:20:49 -0700
Subject: [antlr-interest] error recovery
In-Reply-To: <563885.61745.qm@web30701.mail.mud.yahoo.com>
References: <563885.61745.qm@web30701.mail.mud.yahoo.com>
Message-ID: <4A8B3751.8080708@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/d2f5d173/attachment.html 

From david-sarah at jacaranda.org  Tue Aug 18 16:38:20 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Wed, 19 Aug 2009 00:38:20 +0100
Subject: [antlr-interest] error recovery
In-Reply-To: <563885.61745.qm@web30701.mail.mud.yahoo.com>
References: <563885.61745.qm@web30701.mail.mud.yahoo.com>
Message-ID: <4A8B3B6C.7080901@jacaranda.org>

Adrian Ber wrote:
> Hi all,
> 
> I'm doing another attempt with the hope that somebody knows the answer and he/she wants to share.
> I have an HTML grammar and I have a lexer rule for strings:
> 
> STRING  : '"' (ESC|~('"'|'\\'|'\n'|'\r'))* '"'
>         | '\'' (ESC|~('\''|'\\'|'\n'|'\r'))* '\''
>         ;
> 
> But if I have a text in html like 
>     I'm just a text
> then the lexer will try to identify a string and it will generate an error.
> 
> How can I solve this?

It depends whether you just want the answer to this specific question, or
whether you want to parse HTML ;-)

The single-quote character is valid because it is between tags.
STRING could be made a fragment rule that is only invoked within a
tag. Alternatively it could be guarded by a gated semantic predicate
that is only active within a tag. Or you could have separate
"island grammars" for tag and non-tag contexts.

However, this answer is just scratching the surface if you want to parse
full HTML -- even only correct HTML, never mind real-world "tag soup".

Personally, I wouldn't use ANTLR to parse HTML. There have been attempts
to do that, but they are rather limited and incomplete, and it would be a
*lot* of work to do better. I would use an existing HTML parser library
(and do a good deal of research into what users of various libraries have
said about them, and whether they satisfy your requirements for validation
etc.)

For Java, see <http://java-source.net/open-source/html-parsers> as a
starting point.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From tuncbah at gmail.com  Tue Aug 18 17:28:41 2009
From: tuncbah at gmail.com (tunc)
Date: Tue, 18 Aug 2009 19:28:41 -0500 (CDT)
Subject: [antlr-interest]  pANTLR3_INPUT_STREAM from char*
Message-ID: <1250641721915-3469570.post@n2.nabble.com>


Hi all,

I know this is basic, but reading the c documentation and googling for an
hour did not help.

Let's say I have a std::string or char* variable.
I want to get a pANTLR3_INPUT_STREAM.

How can I do this? (All examples I found is about getting one form a file.)

Thanks.
-- 
View this message in context: http://n2.nabble.com/pANTLR3_INPUT_STREAM-from-char*-tp3469570p3469570.html
Sent from the ANTLR mailing list archive at Nabble.com.

From haluongvn at gmail.com  Tue Aug 18 20:33:24 2009
From: haluongvn at gmail.com (Ha Luong)
Date: Tue, 18 Aug 2009 20:33:24 -0700
Subject: [antlr-interest] Couldn't catch the exception object at the last
	token in the rule
Message-ID: <61577c8f0908182033qf1099a7vd3598516cf026d5c@mail.gmail.com>

Dear all,

I'd like to catch the exception at the *last token* in the rule. I managed
to test some rules to catch the last token mismatch but I couldn't do.
Here is my test:

1. In "T.g" :

grammar T;
options {
    language=Java;
}
@members {
String s;
}

// Alter code generation so catch-clauses get replace with
// this action.
@rulecatch {

catch (RecognitionException e) {
    throw e;

}

}
// END:override

r : ID '#' {s = $ID.text; System.out.println("found "+s);} ;
ID: 'a'..'z'+ ;
WS: (' '|'\n'|'\r')+ {skip();} ; // ignore whitespace

2. In "input.txt":
b

3. In "Test.java":
import org.antlr.runtime.*;

public class Test {
    public static void main(String[] args) throws Exception {
        //ANTLRInputStream input = new ANTLRInputStream(System.in);
        //TLexer lexer = new TLexer(input);
        TLexer lexer = new TLexer(new ANTLRFileStream("input.txt"));
        CommonTokenStream tokens = new CommonTokenStream(lexer);
        TParser parser = new TParser(tokens);
        try{
            parser.r();
        }
        catch (RecognitionException e) {
            System.out.println(e.getClass().toString());
            //e.printStackTrace();
        }
    }
}

4. The output in console when I run Test:
$ java Test
line 0:-1 missing '#' at '<EOF>'
found b

I don't know why the last token mismatch couldn't catch in the main function
of Test. Could you please help me?

Thank you very much,
Ha Luong
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/275ceca6/attachment.html 
-------------- next part --------------
b 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: T.g
Type: application/octet-stream
Size: 380 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/275ceca6/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Test.java
Type: application/octet-stream
Size: 955 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090818/275ceca6/attachment-0001.obj 

From antlr at mirality.co.nz  Wed Aug 19 02:41:07 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 19 Aug 2009 21:41:07 +1200
Subject: [antlr-interest] When can .* be used? (was: Matching Last Line
 in ANTLR)
In-Reply-To: <4A8B2E42.6010604@jacaranda.org>
References: <4A8A2936.30706@gmail.com> <4A8AF63D.3000809@jacaranda.org>
	<4A8B0A22.1060407@gmail.com>
	<4a8b10c5.0408c00a.4e56.fffff6e9SMTPIN_ADDED@mx.google.com>
	<4A8B1787.4090908@gmail.com>
	<20090818212839.181BD34184D4@www.antlr.org>
	<4A8B2E42.6010604@jacaranda.org>
Message-ID: <20090819094133.B78A8341844B@www.antlr.org>

At 10:42 19/08/2009, David-Sarah Hopwood wrote:
 >ENDOFLINE can indeed be simplified to NEWLINE | EOF.
 >
 >However, that won't help because it is not the predicate that
 >causes the problem here; it's the fact that the match 
immediately
 >following .* uses the '|' operator. Note that it doesn't matter
 >whether this match is "inlined" or in a separate fragment rule
 >(and it also doesn't matter whether (option { greedy=false; } :
 >.)* is used instead of .*).

Right, but the version I was talking about didn't have the .* in 
it at all, so it would have worked (that far). :)

 >Therefore, .* can't be used in cases where the match following 
it
 >necessarily involves an alternation that can't be expressed 
using
 >'?'.

In my experience, .* in lexer rules only ever works properly when 
it is followed by a single inline sequence of 
characters.  (Nothing optional, no loops, no calling of other 
rules.)


From s.barnett-cormack at lancaster.ac.uk  Wed Aug 19 03:16:48 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Wed, 19 Aug 2009 11:16:48 +0100
Subject: [antlr-interest] VCard parser
In-Reply-To: <20090819002249.0018631f@frodo.mittelerde>
References: <20090819002249.0018631f@frodo.mittelerde>
Message-ID: <4A8BD110.4080308@lancaster.ac.uk>

Andreas Volz wrote:
> Hello,
> 
> I'm just starting with ANTLR and try to build a VCard parser. This is
> the data I like to parse:
> 
> BEGIN:VCARD
> VERSION:3.0
> N:Mustermann;Max
> FN:Max Mustermann
> ORG:Wikipedia
> URL:http://de.wikipedia.org/
> EMAIL;TYPE=INTERNET:max.mustermann at example.org
> TEL;TYPE=voice,work,pref:+49 1234 56788
> ADR;TYPE=intl,work,postal,parcel:;;Musterstra?e 1;Musterstadt;;12345;Germany
> END:VCARD
> 
> My very first try is this:
> 
> grammar VCard;
> 
> BEGIN	:	'BEGIN:VCARD';
> 
> END	:	'END:VCARD';
> 
> VCARD	:	BEGIN LINE+ END;
> 
> LINE	: 	KEY DP VALUE;
> 
> KEY	:	~':';
> 
> DP 	:	':';
> 
> VALUE	:	('a'..'z' |'A'..'Z' )+;
> 
> 
> But this is only a first step. I couldn't get a more complex rule to work,
> 
> A problem that I open get is the message:
> 
> "The following token definitions can never be matched because prior tokens
>  match the same input"
> 
> Even if I don't use that token somewhere, Could anyone maybe explain me why
> this very simple grammar doesn't work:
> 
> grammar test;
> 
> KEY	:	('a'..'z' |'A'..'Z' )+;
> 
> VALUE	:	('a'..'z' |'A'..'Z' )+;
> 
> LINE	:	KEY '=' VALUE;
> 
> => "The following token definitions can never be matched because prior tokens 
> match the same input: VALUE"
> 
> How would I do this very simple key/value example?

You're mixing up lexing and parsing. KEY and VALUE are identical, so 
it'll never work. If you really want LINE as a lexer rule, KEY and VALUE 
have to be fragment rules. It makes more sense to have a rule, say, 
SYMBOL, and a rule EQ, as follows:

SYMBOL	:	('a'..'z'|'A'..'Z')+;

EQ	:	'=';

And then a *parser* rule for a line:

line	:	SYMBOL EQ SYMBOL ;

This ignore any other problems you'll have with this parsing strategy, 
and particularly any problems using it for VCARD.

The general point is, lexer rules don't refer to other lexer rules, 
unless those lexer rules are fragments (which will never produce tokens).

-- 
Sam Barnett-Cormack

From elnur.j at gmail.com  Wed Aug 19 05:12:55 2009
From: elnur.j at gmail.com (Elnur Cabarov)
Date: Wed, 19 Aug 2009 17:12:55 +0500
Subject: [antlr-interest] Concatenating child nodes into one
Message-ID: <cb604c710908190512tb3de0d4i39a2458f6fe5c654@mail.gmail.com>

Hi, I'm trying to get custom AST from Java grammar

importDeclaration
    :   'import' 'static'? qualifiedName ('.' '*')? ';' -> qualifiedName
    ;

qualifiedName
    :   Identifier ('.' Identifier)*
    ;

How can I get single tree node for the whole import statement?

For example
org.antlr.runtime.ANTLRFileStream  instead of

org
.
antlr
.
runtime
.
ANTLRFileStream


-- 
Elnur Cabarov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/16b58b37/attachment.html 

From safisce at gmail.com  Wed Aug 19 05:59:37 2009
From: safisce at gmail.com (Safiye Celik)
Date: Wed, 19 Aug 2009 15:59:37 +0300
Subject: [antlr-interest] tree parser syntax
Message-ID: <bbf7e7d50908190559h67a1a2e4gdf4ed6da163e747d@mail.gmail.com>

Hi everyone,

I wanna write a tree grammar. But when I write "tree grammar MyGrammar;" at
the beginning of my .g file and then write some lexer rules such as

INTEGER : ('0'..'9')+

, I get an error saying "lexer rule INTEGER not allowed in parser". How
would I handle this issue? If I first write "grammar MyGrammar;" to my .g
file and after listing rules and tokens write "tree grammar MyGrammar;" in
order to parsing the tree, I get a syntax error. In ANTLR v2, we were able
to declare lexer, parser, and then tree walker in the same .g file. What is
the way of it in v3? Or how would I declare tokens such as INTEGER above to
the tree grammar?

--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/620bdcf5/attachment.html 

From antlr at mirality.co.nz  Wed Aug 19 06:31:54 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 20 Aug 2009 01:31:54 +1200
Subject: [antlr-interest] tree parser syntax
In-Reply-To: <bbf7e7d50908190559h67a1a2e4gdf4ed6da163e747d@mail.gmail.co
 m>
References: <bbf7e7d50908190559h67a1a2e4gdf4ed6da163e747d@mail.gmail.com>
Message-ID: <20090819133216.7ABE4341840A@www.antlr.org>

At 00:59 20/08/2009, Safiye Celik wrote:
>I get an error saying "lexer rule INTEGER not allowed in parser". 
>How would I handle this issue? If I first write "grammar 
>MyGrammar;" to my .g file and after listing rules and tokens 
>write "tree grammar MyGrammar;" in order to parsing the tree, I 
>get a syntax error. In ANTLR v2, we were able to declare lexer, 
>parser, and then tree walker in the same .g file. What is the way 
>of it in v3? Or how would I declare tokens such as INTEGER above 
>to the tree grammar?

In v3, each grammar must be in its own separate file.  (Though as 
a special case, a "combined" grammar can have both lexer and 
parser rules [not tree parser rules, though].)

The options section is used to tell the tree grammar where it will 
be getting its token definitions from.

Probably your best bet is to have a look at the examples (in the 
separate examples zipfile). 


From safisce at gmail.com  Wed Aug 19 07:25:47 2009
From: safisce at gmail.com (Safiye Celik)
Date: Wed, 19 Aug 2009 17:25:47 +0300
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
	<4A8B07F3.6090505@temporal-wave.com>
	<COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
Message-ID: <bbf7e7d50908190725i34d3e079s22ef514df01b092b@mail.gmail.com>

Hi,
How do you create DoubleWalk1.jpg tree? I wanna display my tree as yours
which is more understandable for a human, but I cannot get such a tree. I
use JTree component constructed from a DefaultTreeModel component, and the
tree I get is as in the attachment, which is in expandable folder format and
not readable enough. And I could not find any component in Java to display a
tree as yours. I would be glad if you share your way. Thanks.

2009/8/19 Rob Dougan <rob_dougan at sympatico.ca>

>
> pass 1 - lex/parse produces heteroAst (nil root)
> pass 2 - heteroAst  into symbol table walker
> nodes reset
> pass 3 - heteroAst into type checking walker  (adds type info to ast)  --->
> walks twice
>
> its just a typical expression tree (C-like), the function call (abs(1.0))
> is the smallest statement I could get to fail
> but
> the tree walker always walks the input twice ... almost like the tree was
> duplicated
> hmmm
> will continue investigating ...
>
> R
> ------------------------------
> Date: Tue, 18 Aug 2009 12:58:43 -0700
> From: jimi at temporal-wave.com
> CC: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] tree walker executes method call twice?
>
>
> Rob Dougan wrote:
>
>
> during testing i noticed that my tree walker seems to be walking the tree
> twice ...
>
> anyone spot a grammar problem?
>
>
> What does the input tree look like?
>
> Jim
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>


-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/a1de82ef/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: i_1950_0.gif
Type: image/gif
Size: 5535 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/a1de82ef/attachment.gif 

From safisce at gmail.com  Wed Aug 19 08:07:52 2009
From: safisce at gmail.com (Safiye Celik)
Date: Wed, 19 Aug 2009 18:07:52 +0300
Subject: [antlr-interest] tree parser syntax
In-Reply-To: <4a8bfed6.1108c00a.7ae3.0b69SMTPIN_ADDED@mx.google.com>
References: <bbf7e7d50908190559h67a1a2e4gdf4ed6da163e747d@mail.gmail.com>
	<4a8bfed6.1108c00a.7ae3.0b69SMTPIN_ADDED@mx.google.com>
Message-ID: <bbf7e7d50908190807xa01b485w9df3a450c3634b13@mail.gmail.com>

Thanks for the answer. Now I wonder what is the way of putting that INTEGER
: ('0'..'9')+ to the tokens {} part of my tree grammar. I want this, because
I get no error for the tokens defined in tokens {} block in my tree grammar.
But I cannot do this directly as
tokens {
...
INTEGER = '0'..'9'+
...
}
I get an error of "Expecting SEMI, found '..'".
How can get rid of this error and put INTEGER token to tokens block?
Thanks in advance..

2009/8/19 Gavin Lambert <antlr at mirality.co.nz>

> At 00:59 20/08/2009, Safiye Celik wrote:
>
>> I get an error saying "lexer rule INTEGER not allowed in parser". How
>> would I handle this issue? If I first write "grammar MyGrammar;" to my .g
>> file and after listing rules and tokens write "tree grammar MyGrammar;" in
>> order to parsing the tree, I get a syntax error. In ANTLR v2, we were able
>> to declare lexer, parser, and then tree walker in the same .g file. What is
>> the way of it in v3? Or how would I declare tokens such as INTEGER above to
>> the tree grammar?
>>
>
> In v3, each grammar must be in its own separate file.  (Though as a special
> case, a "combined" grammar can have both lexer and parser rules [not tree
> parser rules, though].)
>
> The options section is used to tell the tree grammar where it will be
> getting its token definitions from.
>
> Probably your best bet is to have a look at the examples (in the separate
> examples zipfile).
>



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/4ea95089/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Wed Aug 19 08:25:59 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Wed, 19 Aug 2009 16:25:59 +0100
Subject: [antlr-interest] tree parser syntax
In-Reply-To: <bbf7e7d50908190807xa01b485w9df3a450c3634b13@mail.gmail.com>
References: <bbf7e7d50908190559h67a1a2e4gdf4ed6da163e747d@mail.gmail.com>	<4a8bfed6.1108c00a.7ae3.0b69SMTPIN_ADDED@mx.google.com>
	<bbf7e7d50908190807xa01b485w9df3a450c3634b13@mail.gmail.com>
Message-ID: <4A8C1987.3020304@lancaster.ac.uk>

Safiye Celik wrote:
> Thanks for the answer. Now I wonder what is the way of putting that 
> INTEGER : ('0'..'9')+ to the tokens {} part of my tree grammar. I want 
> this, because I get no error for the tokens defined in tokens {} block 
> in my tree grammar. But I cannot do this directly as
> tokens {
> ...
> INTEGER = '0'..'9'+
> ...
> }
> I get an error of "Expecting SEMI, found '..'".
> How can get rid of this error and put INTEGER token to tokens block?
> Thanks in advance..

You need to create a separate lexer grammar first, defining your lexical 
rules. Before a tree parser is useful, you also need a conventional 
parser to build the tree the tree parser parses. You end up with three 
separate recognisers that feed into one another.

Lexer produces token stream which is consumed by
Parser produces AST which is consumed by
TreeParser

Sam

> 2009/8/19 Gavin Lambert <antlr at mirality.co.nz <mailto:antlr at mirality.co.nz>>
> 
>     At 00:59 20/08/2009, Safiye Celik wrote:
> 
>         I get an error saying "lexer rule INTEGER not allowed in
>         parser". How would I handle this issue? If I first write
>         "grammar MyGrammar;" to my .g file and after listing rules and
>         tokens write "tree grammar MyGrammar;" in order to parsing the
>         tree, I get a syntax error. In ANTLR v2, we were able to declare
>         lexer, parser, and then tree walker in the same .g file. What is
>         the way of it in v3? Or how would I declare tokens such as
>         INTEGER above to the tree grammar?
> 
> 
>     In v3, each grammar must be in its own separate file.  (Though as a
>     special case, a "combined" grammar can have both lexer and parser
>     rules [not tree parser rules, though].)
> 
>     The options section is used to tell the tree grammar where it will
>     be getting its token definitions from.
> 
>     Probably your best bet is to have a look at the examples (in the
>     separate examples zipfile).
> 
> 
> 
> 
> -- 
> -safiye
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


-- 
Sam Barnett-Cormack

From jimi at temporal-wave.com  Wed Aug 19 10:24:47 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 19 Aug 2009 10:24:47 -0700
Subject: [antlr-interest] pANTLR3_INPUT_STREAM from char*
In-Reply-To: <1250641721915-3469570.post@n2.nabble.com>
References: <1250641721915-3469570.post@n2.nabble.com>
Message-ID: <4A8C355F.1030409@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/de68a5e6/attachment.html 

From jimi at temporal-wave.com  Wed Aug 19 10:26:52 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 19 Aug 2009 10:26:52 -0700
Subject: [antlr-interest] Couldn't catch the exception object at the
 last token in the rule
In-Reply-To: <61577c8f0908182033qf1099a7vd3598516cf026d5c@mail.gmail.com>
References: <61577c8f0908182033qf1099a7vd3598516cf026d5c@mail.gmail.com>
Message-ID: <4A8C35DC.10805@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/39367634/attachment.html 

From greg at smolyn.org  Wed Aug 19 11:07:26 2009
From: greg at smolyn.org (Greg Smolyn)
Date: Wed, 19 Aug 2009 11:07:26 -0700
Subject: [antlr-interest] robust error recovery
Message-ID: <678DAD1C-EA41-4D06-A2C1-7C221E562DAA@smolyn.org>

Hi,

I've been using ANTLR quite successfully in a number of places in a  
fairly large product-- mainly for parsing CSS and Javascript.

However, I've recently tried to make my grammars more resilient to  
errors and recover a bit more gracefully, and I've encountered a lot  
of difficulty in finding information both in the ANTLR book (which  
pretty much only describes how to _print_ errors) and in the mailing  
list archives.  Mainly, I'd like to be able to catch a parsing  
exception, skip it, but _continue_ to parse the rest of the rule.   
Unfortunately, the way the exceptions are structured, there is no way  
to catch an exception in a rule and carry on-- you're already outside  
the main loop of that rule.

Here's a scenario I've encountered-- I'll use CSS as an example.

Say you're given a CSS ruleset with a bad property:

a {
      margin: 100px;
     *margin: 200px;
     background: foo.gif;
}

What I'd like to do is have it throw the exception and skip the  
property, but continue along with the next one.  I am stymied by how  
to do this, however.

All I've been able to manage is to skip the rule altogether, thus  
losing even the already properly parsed... here's the relevant bits of  
grammar (before I tried to modify it to skip just the single property):

<===== cut here ======>

ruleset
  	: selectors '{' properties RCURLY -> ^( RULE selectors properties )
	;
     catch[RecognitionException re]
	{
		ConsumeUntil(input, RCURLY);
		input.Consume();
	}

properties
	: declaration (SEMI declaration?)* ->  ^(PROPERTIES declaration*)
         |  -> PROPERTIES_EMPTY
         ;
     catch[RecognitionException re]
	{
		ConsumeUntil(input, RCURLY);
                 if(input.LA(1) != RCURLY)
                 {
                     throw;
                 }
		return properties();
	}
	

declaration
	: IDENT ':' args -> ^( PROPERTY IDENT args )
	;

<===== cut here ======>


I attempted to add a catch clause on declaration, with an appropriate  
ConsumeUntil(SEMI)--  however the issue is that it's in fact the  
'properties' rule that throws the exception, as it cannot find the  
right starting token for a 'declaration'.

So, of course, we can change the properties rule to instead  
ConsumeUntil(SEMI), but then what?  How do I convince it to continue  
looping through the (SEMI declaration?)* clause?  Even if I split it  
out into more rules, I have the same problem--  there is a list of  
declarations, but it's the rule containing the list that throws the  
exception--  since it sees the '*' before margin, and can't descend  
into declaration.  But that exception occurs outside of the looping of  
the rule, and thus I'm stuck.

Any help would be greatly greatly appreciated--  I'd really like to  
know a lot more about how to handle errors, insert/delete bits of tree  
into the AST in these exception scenarios.

Thanks so much!
-greg




From jimi at temporal-wave.com  Wed Aug 19 12:07:04 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 19 Aug 2009 12:07:04 -0700
Subject: [antlr-interest] Concatenating child nodes into one
In-Reply-To: <cb604c710908190512tb3de0d4i39a2458f6fe5c654@mail.gmail.com>
References: <cb604c710908190512tb3de0d4i39a2458f6fe5c654@mail.gmail.com>
Message-ID: <4A8C4D58.1040002@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/231746d1/attachment.html 

From jimi at temporal-wave.com  Wed Aug 19 12:10:12 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 19 Aug 2009 12:10:12 -0700
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <bbf7e7d50908190725i34d3e079s22ef514df01b092b@mail.gmail.com>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>	<4A8B07F3.6090505@temporal-wave.com>	<COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
	<bbf7e7d50908190725i34d3e079s22ef514df01b092b@mail.gmail.com>
Message-ID: <4A8C4E14.6050301@temporal-wave.com>

Safiye Celik wrote:
> Hi,
> How do you create DoubleWalk1.jpg tree? I wanna display my tree as 
> yours which is more understandable for a human, but I cannot get such 
> a tree. I use JTree component constructed from a DefaultTreeModel 
> component, and the tree I get is as in the attachment, which is in 
> expandable folder format and not readable enough. And I could not find 
> any component in Java to display a tree as yours. I would be glad if 
> you share your way. Thanks.
Search the past posting for how to generate a dot (www.graphviz.org) 
specification from the AST and then run dot:

 // Use the ANLTR built in dot generator
                    //
                    DOTTreeGenerator gen = new DOTTreeGenerator();
                   
                    // Which we can cause to generate the DOT specification
                    // with the input file name suffixed with .dot. You 
can then use
                    // the graphviz tools or zgrviewer (Java) to view 
the grahpical
                    // version of the dot file.
                    //
                    source = source.substring(0, source.length()-3);
                    String outputName = source + "dot";
                   
                    System.out.println("    Producing AST dot (graphviz) 
file");
                   
                    // It produces a jguru string template.
                    //
                    StringTemplate st = gen.toDOT(t, new 
CommonTreeAdaptor(), _treeST, _edgeST);

                    // Create the output file and write the dot spec to it
                    //
                    FileWriter outputStream = new FileWriter(outputName);
                    outputStream.write(st.toString());
                    outputStream.close();

                    // Invoke dot to generate a .png file
                    //
                    System.out.println("    Producing png graphic for 
tree");
                    pStart = System.currentTimeMillis();
                    Process proc = Runtime.getRuntime().exec("dot -Tpng 
-o" + source + "png " + outputName);
                    proc.waitFor();
                    stop = System.currentTimeMillis();
                    System.out.println("      PNG graphic produced in " 
+ (stop - pStart) + "ms.");


Jim

From jimi at temporal-wave.com  Wed Aug 19 12:15:23 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 19 Aug 2009 12:15:23 -0700
Subject: [antlr-interest] robust error recovery
In-Reply-To: <678DAD1C-EA41-4D06-A2C1-7C221E562DAA@smolyn.org>
References: <678DAD1C-EA41-4D06-A2C1-7C221E562DAA@smolyn.org>
Message-ID: <4A8C4F4B.3040609@temporal-wave.com>

Greg Smolyn wrote:
> Hi,
>
> I've been using ANTLR quite successfully in a number of places in a  
> fairly large product-- mainly for parsing CSS and Javascript.
>
> However, I've recently tried to make my grammars more resilient to  
> errors and recover a bit more gracefully, and I've encountered a lot  
> of difficulty in finding information both in the ANTLR book (which  
> pretty much only describes how to _print_ errors) and in the mailing  
> list archives.  Mainly, I'd like to be able to catch a parsing  
> exception, skip it, but _continue_ to parse the rest of the rule.   
> Unfortunately, the way the exceptions are structured, there is no way  
> to catch an exception in a rule and carry on-- you're already outside  
> the main loop of that rule.
>
> Here's a scenario I've encountered-- I'll use CSS as an example.
>
> Say you're given a CSS ruleset with a bad property:
>
> a {
>       margin: 100px;
>      *margin: 200px;
>      background: foo.gif;
> }
>
> What I'd like to do is have it throw the exception and skip the  
> property, but continue along with the next one.  I am stymied by how  
> to do this, however.
>   
Download the JavaFX source code and look at how I did error recovery 
from situations like this in that parser. Basically, you catch the 
exception in the appropriate rule and then resync to the appropriate 
follow/start set, which you can make available on the follow stack with 
a trick empty rule with actions only.

This technique allows you to resync within rules that would otherwise 
drop all the way out, such as class and method definitions where you 
have things like 'class' '{' classElement+ '}'


Jim

From jimi at temporal-wave.com  Wed Aug 19 12:27:55 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 19 Aug 2009 12:27:55 -0700
Subject: [antlr-interest] robust error recovery
In-Reply-To: <4A8C4F4B.3040609@temporal-wave.com>
References: <678DAD1C-EA41-4D06-A2C1-7C221E562DAA@smolyn.org>
	<4A8C4F4B.3040609@temporal-wave.com>
Message-ID: <4A8C523B.8000009@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/3216ee62/attachment.html 

From ymo.mail at gmail.com  Wed Aug 19 14:45:42 2009
From: ymo.mail at gmail.com (Ymo)
Date: Wed, 19 Aug 2009 17:45:42 -0400
Subject: [antlr-interest] Whats the license on grammars from the antlr web
	site ?
Message-ID: <7196ed5b0908191445k1315927bs14946cf402494450@mail.gmail.com>

I could not find anything that said what was the default license.

Regards.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090819/759e24ec/attachment.html 

From parrt at cs.usfca.edu  Wed Aug 19 15:16:45 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 19 Aug 2009 15:16:45 -0700
Subject: [antlr-interest] updated Language Design Patterns
Message-ID: <7B68B703-0FA9-4954-9501-9DF5DDC6C26B@cs.usfca.edu>

Howdy.  updated book:

http://www.pragprog.com/titles/tpdsl/language-design-patterns

Changes in This Release
	? Chapter 12, Generating DSLs. Added a chapter on generating DSLs  
with StringTemplate. It gives a good introduction to ST and shows by  
example how to build templatedriven output models.

Last chapter is short 10 pages...should be done next week.

Ter

From david-sarah at jacaranda.org  Wed Aug 19 17:31:10 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 20 Aug 2009 01:31:10 +0100
Subject: [antlr-interest] Whats the license on grammars from the antlr
 web	site ?
In-Reply-To: <7196ed5b0908191445k1315927bs14946cf402494450@mail.gmail.com>
References: <7196ed5b0908191445k1315927bs14946cf402494450@mail.gmail.com>
Message-ID: <4A8C994E.6000300@jacaranda.org>

Ymo wrote:
> I could not find anything that said what was the default license.

There is no default license. If a particular grammar you want to use does
not say in the source files what its license is, you will have to contact
the author.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From safisce at gmail.com  Thu Aug 20 01:49:41 2009
From: safisce at gmail.com (Safiye Celik)
Date: Thu, 20 Aug 2009 11:49:41 +0300
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <4A8C4E14.6050301@temporal-wave.com>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
	<4A8B07F3.6090505@temporal-wave.com>
	<COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
	<bbf7e7d50908190725i34d3e079s22ef514df01b092b@mail.gmail.com>
	<4A8C4E14.6050301@temporal-wave.com>
Message-ID: <bbf7e7d50908200149p8c614b3w12d2529d0638394c@mail.gmail.com>

Hi,
Thanks for help, but I cannot execute "dot" command in eclipse. I get the
error "exception: java.io.IOException: cannot run program "dot":
CreateProcess" error=2, The system cannot find the file specified". When I
try to execute the same command from the command line (after changing
directory to the directory where .dot file exists), I get the error ""dot"
is not recognized as an internal or external command, operable program or
batch file". Where is the dot executable in the Windows system? Or is it a
downloadable file? If so, where can I download it from?

2009/8/19 Jim Idle <jimi at temporal-wave.com>

> Safiye Celik wrote:
> > Hi,
> > How do you create DoubleWalk1.jpg tree? I wanna display my tree as
> > yours which is more understandable for a human, but I cannot get such
> > a tree. I use JTree component constructed from a DefaultTreeModel
> > component, and the tree I get is as in the attachment, which is in
> > expandable folder format and not readable enough. And I could not find
> > any component in Java to display a tree as yours. I would be glad if
> > you share your way. Thanks.
> Search the past posting for how to generate a dot (www.graphviz.org)
> specification from the AST and then run dot:
>
>  // Use the ANLTR built in dot generator
>                    //
>                    DOTTreeGenerator gen = new DOTTreeGenerator();
>
>                    // Which we can cause to generate the DOT specification
>                    // with the input file name suffixed with .dot. You
> can then use
>                    // the graphviz tools or zgrviewer (Java) to view
> the grahpical
>                    // version of the dot file.
>                    //
>                    source = source.substring(0, source.length()-3);
>                    String outputName = source + "dot";
>
>                    System.out.println("    Producing AST dot (graphviz)
> file");
>
>                    // It produces a jguru string template.
>                    //
>                    StringTemplate st = gen.toDOT(t, new
> CommonTreeAdaptor(), _treeST, _edgeST);
>
>                    // Create the output file and write the dot spec to it
>                    //
>                    FileWriter outputStream = new FileWriter(outputName);
>                    outputStream.write(st.toString());
>                    outputStream.close();
>
>                    // Invoke dot to generate a .png file
>                    //
>                    System.out.println("    Producing png graphic for
> tree");
>                    pStart = System.currentTimeMillis();
>                    Process proc = Runtime.getRuntime().exec("dot -Tpng
> -o" + source + "png " + outputName);
>                    proc.waitFor();
>                    stop = System.currentTimeMillis();
>                    System.out.println("      PNG graphic produced in "
> + (stop - pStart) + "ms.");
>
>
> Jim
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090820/3e4021ba/attachment.html 

From safisce at gmail.com  Thu Aug 20 01:58:42 2009
From: safisce at gmail.com (Safiye Celik)
Date: Thu, 20 Aug 2009 11:58:42 +0300
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <bbf7e7d50908200149p8c614b3w12d2529d0638394c@mail.gmail.com>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
	<4A8B07F3.6090505@temporal-wave.com>
	<COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
	<bbf7e7d50908190725i34d3e079s22ef514df01b092b@mail.gmail.com>
	<4A8C4E14.6050301@temporal-wave.com>
	<bbf7e7d50908200149p8c614b3w12d2529d0638394c@mail.gmail.com>
Message-ID: <bbf7e7d50908200158r33845c1fj786bf3df44317909@mail.gmail.com>

I have just realized I should download Graphviz to have dot executable in my
computer, right?

2009/8/20 Safiye Celik <safisce at gmail.com>

> Hi,
> Thanks for help, but I cannot execute "dot" command in eclipse. I get the
> error "exception: java.io.IOException: cannot run program "dot":
> CreateProcess" error=2, The system cannot find the file specified". When I
> try to execute the same command from the command line (after changing
> directory to the directory where .dot file exists), I get the error ""dot"
> is not recognized as an internal or external command, operable program or
> batch file". Where is the dot executable in the Windows system? Or is it a
> downloadable file? If so, where can I download it from?
>
> 2009/8/19 Jim Idle <jimi at temporal-wave.com>
>
> Safiye Celik wrote:
>> > Hi,
>> > How do you create DoubleWalk1.jpg tree? I wanna display my tree as
>> > yours which is more understandable for a human, but I cannot get such
>> > a tree. I use JTree component constructed from a DefaultTreeModel
>> > component, and the tree I get is as in the attachment, which is in
>> > expandable folder format and not readable enough. And I could not find
>> > any component in Java to display a tree as yours. I would be glad if
>> > you share your way. Thanks.
>> Search the past posting for how to generate a dot (www.graphviz.org)
>> specification from the AST and then run dot:
>>
>>  // Use the ANLTR built in dot generator
>>                    //
>>                    DOTTreeGenerator gen = new DOTTreeGenerator();
>>
>>                    // Which we can cause to generate the DOT specification
>>                    // with the input file name suffixed with .dot. You
>> can then use
>>                    // the graphviz tools or zgrviewer (Java) to view
>> the grahpical
>>                    // version of the dot file.
>>                    //
>>                    source = source.substring(0, source.length()-3);
>>                    String outputName = source + "dot";
>>
>>                    System.out.println("    Producing AST dot (graphviz)
>> file");
>>
>>                    // It produces a jguru string template.
>>                    //
>>                    StringTemplate st = gen.toDOT(t, new
>> CommonTreeAdaptor(), _treeST, _edgeST);
>>
>>                    // Create the output file and write the dot spec to it
>>                    //
>>                    FileWriter outputStream = new FileWriter(outputName);
>>                    outputStream.write(st.toString());
>>                    outputStream.close();
>>
>>                    // Invoke dot to generate a .png file
>>                    //
>>                    System.out.println("    Producing png graphic for
>> tree");
>>                    pStart = System.currentTimeMillis();
>>                    Process proc = Runtime.getRuntime().exec("dot -Tpng
>> -o" + source + "png " + outputName);
>>                    proc.waitFor();
>>                    stop = System.currentTimeMillis();
>>                    System.out.println("      PNG graphic produced in "
>> + (stop - pStart) + "ms.");
>>
>>
>> Jim
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
>
> --
> -safiye
>



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090820/37f6d055/attachment.html 

From safisce at gmail.com  Thu Aug 20 04:50:58 2009
From: safisce at gmail.com (Safiye Celik)
Date: Thu, 20 Aug 2009 14:50:58 +0300
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <bbf7e7d50908200158r33845c1fj786bf3df44317909@mail.gmail.com>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>
	<4A8B07F3.6090505@temporal-wave.com>
	<COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>
	<bbf7e7d50908190725i34d3e079s22ef514df01b092b@mail.gmail.com>
	<4A8C4E14.6050301@temporal-wave.com>
	<bbf7e7d50908200149p8c614b3w12d2529d0638394c@mail.gmail.com>
	<bbf7e7d50908200158r33845c1fj786bf3df44317909@mail.gmail.com>
Message-ID: <bbf7e7d50908200450i5f6e2b3et3d7897364f4b6248@mail.gmail.com>

It worked. Thank you so much.

2009/8/20 Safiye Celik <safisce at gmail.com>

> I have just realized I should download Graphviz to have dot executable in
> my computer, right?
>
> 2009/8/20 Safiye Celik <safisce at gmail.com>
>
> Hi,
>> Thanks for help, but I cannot execute "dot" command in eclipse. I get the
>> error "exception: java.io.IOException: cannot run program "dot":
>> CreateProcess" error=2, The system cannot find the file specified". When I
>> try to execute the same command from the command line (after changing
>> directory to the directory where .dot file exists), I get the error ""dot"
>> is not recognized as an internal or external command, operable program or
>> batch file". Where is the dot executable in the Windows system? Or is it a
>> downloadable file? If so, where can I download it from?
>>
>> 2009/8/19 Jim Idle <jimi at temporal-wave.com>
>>
>> Safiye Celik wrote:
>>> > Hi,
>>> > How do you create DoubleWalk1.jpg tree? I wanna display my tree as
>>> > yours which is more understandable for a human, but I cannot get such
>>> > a tree. I use JTree component constructed from a DefaultTreeModel
>>> > component, and the tree I get is as in the attachment, which is in
>>> > expandable folder format and not readable enough. And I could not find
>>> > any component in Java to display a tree as yours. I would be glad if
>>> > you share your way. Thanks.
>>> Search the past posting for how to generate a dot (www.graphviz.org)
>>> specification from the AST and then run dot:
>>>
>>>  // Use the ANLTR built in dot generator
>>>                    //
>>>                    DOTTreeGenerator gen = new DOTTreeGenerator();
>>>
>>>                    // Which we can cause to generate the DOT
>>> specification
>>>                    // with the input file name suffixed with .dot. You
>>> can then use
>>>                    // the graphviz tools or zgrviewer (Java) to view
>>> the grahpical
>>>                    // version of the dot file.
>>>                    //
>>>                    source = source.substring(0, source.length()-3);
>>>                    String outputName = source + "dot";
>>>
>>>                    System.out.println("    Producing AST dot (graphviz)
>>> file");
>>>
>>>                    // It produces a jguru string template.
>>>                    //
>>>                    StringTemplate st = gen.toDOT(t, new
>>> CommonTreeAdaptor(), _treeST, _edgeST);
>>>
>>>                    // Create the output file and write the dot spec to it
>>>                    //
>>>                    FileWriter outputStream = new FileWriter(outputName);
>>>                    outputStream.write(st.toString());
>>>                    outputStream.close();
>>>
>>>                    // Invoke dot to generate a .png file
>>>                    //
>>>                    System.out.println("    Producing png graphic for
>>> tree");
>>>                    pStart = System.currentTimeMillis();
>>>                    Process proc = Runtime.getRuntime().exec("dot -Tpng
>>> -o" + source + "png " + outputName);
>>>                    proc.waitFor();
>>>                    stop = System.currentTimeMillis();
>>>                    System.out.println("      PNG graphic produced in "
>>> + (stop - pStart) + "ms.");
>>>
>>>
>>> Jim
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>
>>
>>
>> --
>> -safiye
>>
>
>
>
> --
> -safiye
>



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090820/205f1e80/attachment.html 

From safisce at gmail.com  Thu Aug 20 05:28:29 2009
From: safisce at gmail.com (Safiye Celik)
Date: Thu, 20 Aug 2009 15:28:29 +0300
Subject: [antlr-interest] tree parser syntax
In-Reply-To: <4A8C1987.3020304@lancaster.ac.uk>
References: <bbf7e7d50908190559h67a1a2e4gdf4ed6da163e747d@mail.gmail.com>
	<4a8bfed6.1108c00a.7ae3.0b69SMTPIN_ADDED@mx.google.com>
	<bbf7e7d50908190807xa01b485w9df3a450c3634b13@mail.gmail.com>
	<4A8C1987.3020304@lancaster.ac.uk>
Message-ID: <bbf7e7d50908200528k2401d6a0o285e14275465dd6f@mail.gmail.com>

Hi,
I created two grammars, one is a lexer-parser grammar including tokens and
the parser rules, and the other is the tree grammar which walks on the tree
the lexer-parser grammar creates. But the problem is that, the two grammar
files create two .tokens files (each creates one) and the token reference
numbers are different in those files for the same token. And in the .tokens
file, the corresponding strings to the tokens are represented because there
are lexical rules in my lexer-parser grammar, whereas in the .tokens file of
the tree grammar, there are only the string names and their token numbers.
So, the two grammars do not know they are related. How should I make them
know this?Should I import lexer-parser grammar in the tree grammar or sth
like that?

Also, I have below two rules in my lexer-parser grammar:

a: b (x^ c)*;
b. d | y! a y!

and I want to parse the tree those rules create in the tree grammar file
with below rules:

a: b (x^ c)*;
b. d | a           // Here in the tree grammar I do not write "y"s which do
not exist in the tree

But I get left recursion error (for "a"s) in the second, tree grammar one.
Why? The tree has already been created, and I will parse it now, so there
should not be any left recursion problem here.

The questions I am asking may be very trivial, sorry for that. I am new to
ANTLR v3, and the document on ANTLR site telling about the differences
between the two versions is not enough for me to migrate to v3 easily.

Thanks in advance.

2009/8/19 Sam Barnett-Cormack <s.barnett-cormack at lancaster.ac.uk>

> Safiye Celik wrote:
>
>> Thanks for the answer. Now I wonder what is the way of putting that
>> INTEGER : ('0'..'9')+ to the tokens {} part of my tree grammar. I want this,
>> because I get no error for the tokens defined in tokens {} block in my tree
>> grammar. But I cannot do this directly as
>> tokens {
>> ...
>> INTEGER = '0'..'9'+
>> ...
>> }
>> I get an error of "Expecting SEMI, found '..'".
>> How can get rid of this error and put INTEGER token to tokens block?
>> Thanks in advance..
>>
>
> You need to create a separate lexer grammar first, defining your lexical
> rules. Before a tree parser is useful, you also need a conventional parser
> to build the tree the tree parser parses. You end up with three separate
> recognisers that feed into one another.
>
> Lexer produces token stream which is consumed by
> Parser produces AST which is consumed by
> TreeParser
>
> Sam
>
>  2009/8/19 Gavin Lambert <antlr at mirality.co.nz <mailto:
>> antlr at mirality.co.nz>>
>>
>>    At 00:59 20/08/2009, Safiye Celik wrote:
>>
>>        I get an error saying "lexer rule INTEGER not allowed in
>>        parser". How would I handle this issue? If I first write
>>        "grammar MyGrammar;" to my .g file and after listing rules and
>>        tokens write "tree grammar MyGrammar;" in order to parsing the
>>        tree, I get a syntax error. In ANTLR v2, we were able to declare
>>        lexer, parser, and then tree walker in the same .g file. What is
>>        the way of it in v3? Or how would I declare tokens such as
>>        INTEGER above to the tree grammar?
>>
>>
>>    In v3, each grammar must be in its own separate file.  (Though as a
>>    special case, a "combined" grammar can have both lexer and parser
>>    rules [not tree parser rules, though].)
>>
>>    The options section is used to tell the tree grammar where it will
>>    be getting its token definitions from.
>>
>>    Probably your best bet is to have a look at the examples (in the
>>    separate examples zipfile).
>>
>>
>>
>>
>> --
>> -safiye
>>
>>
>> ------------------------------------------------------------------------
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
> --
> Sam Barnett-Cormack
>



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090820/a2393fcb/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Thu Aug 20 05:40:44 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 20 Aug 2009 13:40:44 +0100
Subject: [antlr-interest] tree parser syntax
In-Reply-To: <bbf7e7d50908200528k2401d6a0o285e14275465dd6f@mail.gmail.com>
References: <bbf7e7d50908190559h67a1a2e4gdf4ed6da163e747d@mail.gmail.com>	
	<4a8bfed6.1108c00a.7ae3.0b69SMTPIN_ADDED@mx.google.com>	
	<bbf7e7d50908190807xa01b485w9df3a450c3634b13@mail.gmail.com>	
	<4A8C1987.3020304@lancaster.ac.uk>
	<bbf7e7d50908200528k2401d6a0o285e14275465dd6f@mail.gmail.com>
Message-ID: <4A8D444C.6020503@lancaster.ac.uk>

Safiye Celik wrote:
> Hi,
> I created two grammars, one is a lexer-parser grammar including tokens 
> and the parser rules, and the other is the tree grammar which walks on 
> the tree the lexer-parser grammar creates. But the problem is that, the 
> two grammar files create two .tokens files (each creates one) and the 
> token reference numbers are different in those files for the same token. 
> And in the .tokens file, the corresponding strings to the tokens are 
> represented because there are lexical rules in my lexer-parser grammar, 
> whereas in the .tokens file of the tree grammar, there are only the 
> string names and their token numbers. So, the two grammars do not know 
> they are related. How should I make them know this?Should I import 
> lexer-parser grammar in the tree grammar or sth like that?

Try the grammar option tokenVocab, explained in the context of 
treegrammars at http://www.antlr.org/wiki/display/ANTLR3/4.+Tree+Parsing

-- 
Sam Barnett-Cormack

From jimi at temporal-wave.com  Thu Aug 20 09:26:35 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 20 Aug 2009 09:26:35 -0700
Subject: [antlr-interest] tree walker executes method call twice?
In-Reply-To: <bbf7e7d50908200158r33845c1fj786bf3df44317909@mail.gmail.com>
References: <COL121-W48FBA307DF33D731B6382587FF0@phx.gbl>	
	<4A8B07F3.6090505@temporal-wave.com>	
	<COL121-W23F57841D2229C03DEC36287FF0@phx.gbl>	
	<bbf7e7d50908190725i34d3e079s22ef514df01b092b@mail.gmail.com>	
	<4A8C4E14.6050301@temporal-wave.com>	
	<bbf7e7d50908200149p8c614b3w12d2529d0638394c@mail.gmail.com>
	<bbf7e7d50908200158r33845c1fj786bf3df44317909@mail.gmail.com>
Message-ID: <4A8D793B.6080803@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090820/8b49d8a5/attachment.html 

From bsayatovic at creditinfonet.com  Thu Aug 20 09:47:47 2009
From: bsayatovic at creditinfonet.com (Brian J. Sayatovic)
Date: Thu, 20 Aug 2009 12:47:47 -0400
Subject: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
Message-ID: <006001ca21b5$f2aad6c0$d8008440$@com>

I'm trying to use NHibernate 2.1 and StringTemplate 3.1.  NHibernate depends
upon Antlr3.Runtime for its HQL query language.  NHibernate 2.1 depends upon
Antlr3.Runtime version 3.1.0.39271 public key 3a9cab8f8d22bfb7.  meanwhile,
StringTemplate 3.1 also depends upon Antlr3.Runtime, but version 3.1.3.6002
public key eb42632606e9261f.

 

I've tried using assembly binding redirection in my application
configuration, but because the public keys are different, it will never
work.

 

My question is, did the public key change?  My weak understanding of the
public key is that its supposed to ensure the assembly is from a certain
publisher, which I don't imagine has changed.

 

Any ideas?

 

Regards,

Brian.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090820/d0f01967/attachment.html 

From martin.danjou at neterion.com  Thu Aug 20 09:49:22 2009
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Thu, 20 Aug 2009 12:49:22 -0400 (EDT)
Subject: [antlr-interest] looking for "from foo import bar" examples in v2
In-Reply-To: <mailman.272.1250785842.3238.antlr-interest@antlr.org>
References: <mailman.272.1250785842.3238.antlr-interest@antlr.org>
Message-ID: <alpine.LRH.1.00.0908201241060.4396@algonquin>

Hello,

I am trying to find examples in antlr 2.7.7 of how to parse a syntax 
resembling the pyhton "from foo import bar1,bar2, ..." syntax. I have a 
working "import all" syntax, but a from-import is different because it is 
selective in what it imports. Is there any antlr v2 example or 
documentation on how to build this kind of selectiveness in an antlr tree 
builder (in the parser)?

Thanks,
Martin
PS: I cannot upgrade to antrl v3.

From JALuber at gmx.de  Thu Aug 20 11:51:09 2009
From: JALuber at gmx.de (Johannes Luber)
Date: Thu, 20 Aug 2009 20:51:09 +0200
Subject: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
In-Reply-To: <006001ca21b5$f2aad6c0$d8008440$@com>
References: <006001ca21b5$f2aad6c0$d8008440$@com>
Message-ID: <20090820185109.304080@gmx.net>

> I'm trying to use NHibernate 2.1 and StringTemplate 3.1.  NHibernate
> depends
> upon Antlr3.Runtime for its HQL query language.  NHibernate 2.1 depends
> upon
> Antlr3.Runtime version 3.1.0.39271 public key 3a9cab8f8d22bfb7. 
> meanwhile,
> StringTemplate 3.1 also depends upon Antlr3.Runtime, but version
> 3.1.3.6002
> public key eb42632606e9261f.
> 
> I've tried using assembly binding redirection in my application
> configuration, but because the public keys are different, it will never
> work.
> 
> My question is, did the public key change?  My weak understanding of the
> public key is that its supposed to ensure the assembly is from a certain
> publisher, which I don't imagine has changed.

Are you sure your using ST 3.1? This version still uses ANTLR 2.7.7 with an antlr.runtime.dll (note the different filenames). The only version with an Antlr3.Runtime.dll is the new ST 3.2. It also uses the CSharp3 target instead the current CSharp2 target, which uses a different namespace (may be ignored by the key signing). I imagine that the maintainer created an own keypair instead using the available one. It is also possible that NHibernate signed the DLL themselves.

The most simple solution, assuming that you are right in your diagnosis, is to rebuild NHibernate with the most current DLL. If you are using ST 3.2 then it may be worth to try to change the DLL name and rebuild ST then. I hope that covers it. :)

Johannes

> 
>  
> 
> Any ideas?
> 
>  
> 
> Regards,
> 
> Brian.
> 

-- 
Neu: GMX Doppel-FLAT mit Internet-Flatrate + Telefon-Flatrate
f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02

From bsayatovic at creditinfonet.com  Thu Aug 20 12:08:30 2009
From: bsayatovic at creditinfonet.com (Brian J. Sayatovic)
Date: Thu, 20 Aug 2009 15:08:30 -0400
Subject: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
In-Reply-To: <20090820185109.304080@gmx.net>
References: <006001ca21b5$f2aad6c0$d8008440$@com>
	<20090820185109.304080@gmx.net>
Message-ID: <006b01ca21c9$9acd9d70$d068d850$@com>

Thank you for the thorough response, Johannes!

You are correct that I am using ST 3.2 -- I misspoke when I said ST 3.1.

I'm mulling over building NH 2.1 myself against the newer Antlr3.Runtime.
Its open source, so I *can*, but its changing our "way of doing things" to
build our own copies of open source libs instead of just depending upon
official binaries.  This is a taste we have to change ourselves.

Regards,
Brian.

-----Original Message-----
From: Johannes Luber [mailto:JALuber at gmx.de] 
Sent: Thursday, August 20, 2009 2:51 PM
To: Brian J. Sayatovic; antlr-interest at antlr.org
Subject: Re: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?

> I'm trying to use NHibernate 2.1 and StringTemplate 3.1.  NHibernate
> depends
> upon Antlr3.Runtime for its HQL query language.  NHibernate 2.1 depends
> upon
> Antlr3.Runtime version 3.1.0.39271 public key 3a9cab8f8d22bfb7. 
> meanwhile,
> StringTemplate 3.1 also depends upon Antlr3.Runtime, but version
> 3.1.3.6002
> public key eb42632606e9261f.
> 
> I've tried using assembly binding redirection in my application
> configuration, but because the public keys are different, it will never
> work.
> 
> My question is, did the public key change?  My weak understanding of the
> public key is that its supposed to ensure the assembly is from a certain
> publisher, which I don't imagine has changed.

Are you sure your using ST 3.1? This version still uses ANTLR 2.7.7 with an
antlr.runtime.dll (note the different filenames). The only version with an
Antlr3.Runtime.dll is the new ST 3.2. It also uses the CSharp3 target
instead the current CSharp2 target, which uses a different namespace (may be
ignored by the key signing). I imagine that the maintainer created an own
keypair instead using the available one. It is also possible that NHibernate
signed the DLL themselves.

The most simple solution, assuming that you are right in your diagnosis, is
to rebuild NHibernate with the most current DLL. If you are using ST 3.2
then it may be worth to try to change the DLL name and rebuild ST then. I
hope that covers it. :)

Johannes

> 
>  
> 
> Any ideas?
> 
>  
> 
> Regards,
> 
> Brian.
> 

-- 
Neu: GMX Doppel-FLAT mit Internet-Flatrate + Telefon-Flatrate
f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02


From antlr at mirality.co.nz  Thu Aug 20 12:37:31 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 21 Aug 2009 07:37:31 +1200
Subject: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
In-Reply-To: <006001ca21b5$f2aad6c0$d8008440$@com>
References: <006001ca21b5$f2aad6c0$d8008440$@com>
Message-ID: <20090820193742.AE46B341814F@www.antlr.org>

At 04:47 21/08/2009, Brian J. Sayatovic wrote:
>I'm trying to use NHibernate 2.1 and StringTemplate 
>3.1.  NHibernate depends upon Antlr3.Runtime for its HQL query 
>language.  NHibernate 2.1 depends upon Antlr3.Runtime version 
>3.1.0.39271 public key 3a9cab8f8d22bfb7.  meanwhile, 
>StringTemplate 3.1 also depends upon Antlr3.Runtime, but version 
>3.1.3.6002 public key eb42632606e9261f.
>
>I've tried using assembly binding redirection in my application 
>configuration, but because the public keys are different, it will 
>never work.

If I recall correctly, the fact that they have different public 
keys should mean that it's possible to include both of them at the 
same time -- .NET will treat them as distinct and the types won't 
be compatible though.

If you rename one of the files, and ensure that NHibernate 
references one and your app references the other, then it should 
just work, I think.  (If your app needs to reference both then it 
introduces an ambiguity problem; I think there is a way to resolve 
that but I don't remember what it is offhand.)


From bsayatovic at creditinfonet.com  Thu Aug 20 12:41:26 2009
From: bsayatovic at creditinfonet.com (Brian J. Sayatovic)
Date: Thu, 20 Aug 2009 15:41:26 -0400
Subject: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
References: <006001ca21b5$f2aad6c0$d8008440$@com> 
Message-ID: <006c01ca21ce$34ecbc70$9ec63550$@com>

Well, I tried a few things.

I tried letting both exist in their natural state, but one overwrites the
other at build-time in the 'bin' folder.

Then I tried renaming one, the other and even both, but the .NET runtime
complained that the names didn't match their manifest.

Then I tried the assembly binding redirection, but the public key thing
thwarted me.

So now I seem to be left with compiling my own copy of NHibernate, or
dumping StringTemplate for something else (e.g. Velocity).

Regards,
Brian.

-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Thursday, August 20, 2009 3:38 PM
To: Brian J. Sayatovic; antlr-interest at antlr.org
Subject: Re: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?

At 04:47 21/08/2009, Brian J. Sayatovic wrote:
>I'm trying to use NHibernate 2.1 and StringTemplate 
>3.1.  NHibernate depends upon Antlr3.Runtime for its HQL query 
>language.  NHibernate 2.1 depends upon Antlr3.Runtime version 
>3.1.0.39271 public key 3a9cab8f8d22bfb7.  meanwhile, 
>StringTemplate 3.1 also depends upon Antlr3.Runtime, but version 
>3.1.3.6002 public key eb42632606e9261f.
>
>I've tried using assembly binding redirection in my application 
>configuration, but because the public keys are different, it will 
>never work.

If I recall correctly, the fact that they have different public 
keys should mean that it's possible to include both of them at the 
same time -- .NET will treat them as distinct and the types won't 
be compatible though.

If you rename one of the files, and ensure that NHibernate 
references one and your app references the other, then it should 
just work, I think.  (If your app needs to reference both then it 
introduces an ambiguity problem; I think there is a way to resolve 
that but I don't remember what it is offhand.)


From sharwell at pixelminegames.com  Thu Aug 20 12:54:20 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 20 Aug 2009 14:54:20 -0500
Subject: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
In-Reply-To: <006c01ca21ce$34ecbc70$9ec63550$@com>
References: <006001ca21b5$f2aad6c0$d8008440$@com>
	<006c01ca21ce$34ecbc70$9ec63550$@com>
Message-ID: <86403CA0939415448BCCB83855EFE09AA68585@Bloodymary.ironwillgames.com>

You'll need to reference both runtimes. I don't *think* there is a
namespace conflict but if there is, here's how you have to resolve it:

* Sign the assembly that references both ST 3.2 (my build) and the
CSharp runtime (Johannes' build). That's the only way to get it to
side-by-side load types that would normally conflict.

You can't use redirects because my build(s) use a different public API
than the CSharp runtime. Rather than port the CSharp target to C# 3, I
started completely over with the Java code so I could move it back to
the BSD 3-clause license instead of the 4-clause one that the
CSharp/CSharp2 targets come with.

The public keys are different because I sign my assemblies with a
private in-house key.

Also note that the assembly version numbers for the latest ST beta from
me are goofed. I need to make those consistent for the next build.

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Brian J.
Sayatovic
Sent: Thursday, August 20, 2009 2:41 PM
To: 'Gavin Lambert'; antlr-interest at antlr.org
Subject: Re: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?

Well, I tried a few things.

I tried letting both exist in their natural state, but one overwrites
the
other at build-time in the 'bin' folder.

Then I tried renaming one, the other and even both, but the .NET runtime
complained that the names didn't match their manifest.

Then I tried the assembly binding redirection, but the public key thing
thwarted me.

So now I seem to be left with compiling my own copy of NHibernate, or
dumping StringTemplate for something else (e.g. Velocity).

Regards,
Brian.

-----Original Message-----
From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
Sent: Thursday, August 20, 2009 3:38 PM
To: Brian J. Sayatovic; antlr-interest at antlr.org
Subject: Re: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?

At 04:47 21/08/2009, Brian J. Sayatovic wrote:
>I'm trying to use NHibernate 2.1 and StringTemplate 
>3.1.  NHibernate depends upon Antlr3.Runtime for its HQL query 
>language.  NHibernate 2.1 depends upon Antlr3.Runtime version 
>3.1.0.39271 public key 3a9cab8f8d22bfb7.  meanwhile, 
>StringTemplate 3.1 also depends upon Antlr3.Runtime, but version 
>3.1.3.6002 public key eb42632606e9261f.
>
>I've tried using assembly binding redirection in my application 
>configuration, but because the public keys are different, it will 
>never work.

If I recall correctly, the fact that they have different public 
keys should mean that it's possible to include both of them at the 
same time -- .NET will treat them as distinct and the types won't 
be compatible though.

If you rename one of the files, and ensure that NHibernate 
references one and your app references the other, then it should 
just work, I think.  (If your app needs to reference both then it 
introduces an ambiguity problem; I think there is a way to resolve 
that but I don't remember what it is offhand.)


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jeroen.v.schagen at gmail.com  Thu Aug 20 13:45:45 2009
From: jeroen.v.schagen at gmail.com (Jeroen van Schagen)
Date: Thu, 20 Aug 2009 22:45:45 +0200
Subject: [antlr-interest] import construct - parsing each module once
Message-ID: <cabba3130908201345y16df7119g601f67912403ca7a@mail.gmail.com>

The language I'm currently implementing contains import constructs. So far
I've used the standard import implementation from the ANTLR wiki which goes:

import: 'import' moduleId -> 'import' moduleId ^( {
parseFile($moduleId.path) } ) ;

However this implementation will hang on circular dependancies and reduce my
parser performance when having multiple imports to the same module. So I
decided to keep a list of all the modules I've parsed so far, meaning I only
have to parse each module once. This has resulted in the following
implementation:

imprt: 'import' moduleId {
if(! modules.contains($moduleId.path)) {
Object dependancy = adaptor.becomeRoot(parseFile($moduleId.path), (Object)
adaptor.nil());
adaptor.addChild(root_0, dependancy);
}
}

@member { CommonTree parseFile(String path) { ... } }

The implementation works, however I would like a cleaner solution,
preferably using a rewrite rule. Any suggestions?

Thanks in advance!
Jeroen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090820/dc3ac7f6/attachment.html 

From JALuber at gmx.de  Thu Aug 20 15:05:38 2009
From: JALuber at gmx.de (Johannes Luber)
Date: Fri, 21 Aug 2009 00:05:38 +0200
Subject: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
In-Reply-To: <006c01ca21ce$34ecbc70$9ec63550$@com>
References: <006001ca21b5$f2aad6c0$d8008440$@com>
	<006c01ca21ce$34ecbc70$9ec63550$@com>
Message-ID: <20090820220538.194000@gmx.net>

> Well, I tried a few things.
> 
> I tried letting both exist in their natural state, but one overwrites the
> other at build-time in the 'bin' folder.
> 
> Then I tried renaming one, the other and even both, but the .NET runtime
> complained that the names didn't match their manifest.
> 
> Then I tried the assembly binding redirection, but the public key thing
> thwarted me.
> 
> So now I seem to be left with compiling my own copy of NHibernate, or
> dumping StringTemplate for something else (e.g. Velocity).

I'd suggest that recompiling is easier. Switching to other products means to give up ST features as well its strengths - far more problematic in terms of maintainance.

Johannes
> 
> Regards,
> Brian.
> 
> -----Original Message-----
> From: Gavin Lambert [mailto:antlr at mirality.co.nz] 
> Sent: Thursday, August 20, 2009 3:38 PM
> To: Brian J. Sayatovic; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] .NET Antlr3.Runtime Public Key Changed?
> 
> At 04:47 21/08/2009, Brian J. Sayatovic wrote:
> >I'm trying to use NHibernate 2.1 and StringTemplate 
> >3.1.  NHibernate depends upon Antlr3.Runtime for its HQL query 
> >language.  NHibernate 2.1 depends upon Antlr3.Runtime version 
> >3.1.0.39271 public key 3a9cab8f8d22bfb7.  meanwhile, 
> >StringTemplate 3.1 also depends upon Antlr3.Runtime, but version 
> >3.1.3.6002 public key eb42632606e9261f.
> >
> >I've tried using assembly binding redirection in my application 
> >configuration, but because the public keys are different, it will 
> >never work.
> 
> If I recall correctly, the fact that they have different public 
> keys should mean that it's possible to include both of them at the 
> same time -- .NET will treat them as distinct and the types won't 
> be compatible though.
> 
> If you rename one of the files, and ensure that NHibernate 
> references one and your app references the other, then it should 
> just work, I think.  (If your app needs to reference both then it 
> introduces an ambiguity problem; I think there is a way to resolve 
> that but I don't remember what it is offhand.)
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-- 
Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3 -
sicherer, schneller und einfacher! http://portal.gmx.net/de/go/atbrowser

From parrt at cs.usfca.edu  Thu Aug 20 17:14:11 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 20 Aug 2009 17:14:11 -0700
Subject: [antlr-interest] examples from the last chapter
Message-ID: <3CE5827F-F382-4649-A437-ADCD86E3C539@cs.usfca.edu>

Howdy,

I just submitted the last chapter to the publisher for review. It  
describes the strategy and patterns you'd need to implement some  
sample applications, but does not actually implement them:

13 Where to Go from Here
13.1 Finding patterns in protein structures . . . . . . . . . . 353
13.2 Using a script to build 3D scenes . . . . . . . . . . . . . 354
13.3 Dealing with XML . . . . . . . . . . . . . . . . . . . . . . 355
13.4 Reading generic con?guration ?les . . . . . . . . . . . . 356
13.5 Tweaking source code . . . . . . . . . . . . . . . . . . . 357
13.6 Adding a new type to Java . . . . . . . . . . . . . . . . . 358
13.7 Pretty printing source code . . . . . . . . . . . . . . . . 359
13.8 Compiling to machine code . . . . . . . . . . . . . . . . 360

The compiler example points to the wiki, but all I have up there is  
the source code and some blah blah. I need to finish up the write up  
for that.

Ter

From elnur.j at gmail.com  Thu Aug 20 21:27:26 2009
From: elnur.j at gmail.com (Elnur Cabarov)
Date: Fri, 21 Aug 2009 09:27:26 +0500
Subject: [antlr-interest] Concatenating child nodes into one
Message-ID: <cb604c710908202127g1ef2617cj9d2537fb3ffea3c8@mail.gmail.com>

This method doesn't work for me. I have to use rewrite rules, not tree
operators, because I insert imaginary nodes.
Being precise I need this

importDeclaration

    :   'import' 'static'? qualifiedName ('.' '*')? ';' -> ^(REF
IMPORTS qualifiedName)
    ;

And when I change literals to lexer rules I get:
The following token definitions can never be matched because prior tokens
match the same input: IMPORT,STATIC

Thank you

-- 
Elnur Cabarov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090821/1a8113cc/attachment.html 

From antlr at mirality.co.nz  Fri Aug 21 05:34:57 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 22 Aug 2009 00:34:57 +1200
Subject: [antlr-interest] Concatenating child nodes into one
In-Reply-To: <cb604c710908202127g1ef2617cj9d2537fb3ffea3c8@mail.gmail.co
 m>
References: <cb604c710908202127g1ef2617cj9d2537fb3ffea3c8@mail.gmail.com>
Message-ID: <20090821123512.DBFA6341844B@www.antlr.org>

At 16:27 21/08/2009, Elnur Cabarov wrote:
>And when I change literals to lexer rules I get:
>The following token definitions can never be matched because 
>prior tokens match the same input: IMPORT,STATIC

Well, as the error message indicates, you need to re-order your 
lexer rules.

In case of ambiguity, ANTLR's lexer will generally choose the 
longest match; failing that it will pick whichever rule is listed 
first.

Most likely in this case there is a conflict between your 
IMPORT/STATIC rules and some kind of identifier rule.  Since the 
identifier rule is more generic, ensure that it is listed after 
the IMPORT/STATIC rules, which are more specific.  (This applies 
in other cases too -- the most generic lexer rule should be the 
last one.)


From marwan.alephn at gmail.com  Fri Aug 21 05:53:48 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Fri, 21 Aug 2009 14:53:48 +0200
Subject: [antlr-interest] Couldn't catch the exception object at the
	last token in the rule
In-Reply-To: <61577c8f0908182033qf1099a7vd3598516cf026d5c@mail.gmail.com>
References: <61577c8f0908182033qf1099a7vd3598516cf026d5c@mail.gmail.com>
Message-ID: <6535fcb50908210553n6a81cc0dgfabdcd2ad63b3916@mail.gmail.com>

r : ID '#' {s = $ID.text; System.out.println("found "+s);} ;

Tow alternatives

1. take out '#' from ur file.g

or

2.  Put it in ur input file. so it look like: b #


U should read about how it works. Jim did send u a link.

cheers,




2009/8/19 Ha Luong <haluongvn at gmail.com>:
> Dear all,
>
> I'd like to catch the exception at the last token in the rule. I managed to
> test some rules to catch the last token mismatch but I couldn't do.
> Here is my test:
>
> 1. In "T.g" :
>
> grammar T;
> options {
> ??? language=Java;
> }
> @members {
> String s;
> }
>
> // Alter code generation so catch-clauses get replace with
> // this action.
> @rulecatch {
>
> catch (RecognitionException e) {
> ??? throw e;
>
> }
>
> }
> // END:override
>
> r : ID '#' {s = $ID.text; System.out.println("found "+s);} ;
> ID: 'a'..'z'+ ;
> WS: (' '|'\n'|'\r')+ {skip();} ; // ignore whitespace
>
> 2. In "input.txt":
> b
>
> 3. In "Test.java":
> import org.antlr.runtime.*;
>
> public class Test {
> ??? public static void main(String[] args) throws Exception {
> ??????? //ANTLRInputStream input = new ANTLRInputStream(System.in);
> ??????? //TLexer lexer = new TLexer(input);
> ??????? TLexer lexer = new TLexer(new ANTLRFileStream("input.txt"));
> ??? ??? CommonTokenStream tokens = new CommonTokenStream(lexer);
> ??????? TParser parser = new TParser(tokens);
> ??? ??? try{
> ??? ??? ??? parser.r();
> ??? ??? }
> ??? ??? catch (RecognitionException e) {
> ??? ??? ??? System.out.println(e.getClass().toString());
> ??? ??? ??? //e.printStackTrace();
> ??? ??? }
> ??? }
> }
>
> 4. The output in console when I run Test:
> $ java Test
> line 0:-1 missing '#' at '<EOF>'
> found b
>
> I don't know why the last token mismatch couldn't catch in the main function
> of Test. Could you please help me?
>
> Thank you very much,
> Ha Luong
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>



-- 
Marouane

From marwan.alephn at gmail.com  Fri Aug 21 05:57:58 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Fri, 21 Aug 2009 14:57:58 +0200
Subject: [antlr-interest] Couldn't catch the exception object at the
	last token in the rule
In-Reply-To: <6535fcb50908210553n6a81cc0dgfabdcd2ad63b3916@mail.gmail.com>
References: <61577c8f0908182033qf1099a7vd3598516cf026d5c@mail.gmail.com>
	<6535fcb50908210553n6a81cc0dgfabdcd2ad63b3916@mail.gmail.com>
Message-ID: <6535fcb50908210557r1402c324mb31cc2a6fe1c1816@mail.gmail.com>

you can define in your members section a method

public String getErrorMessage(RecognitionException e,
                              String[] tokenNames)
{
        	 String msg = e.getMessage();
         if (e instanceof MissingTokenException) {
             MissingTokenException mte = (MissingTokenException) e;
             String tokenName = "";
             if (mte.expecting == Token.EOF) {
                 tokenName = "EOF";
             } else {
                 tokenName = tokenNames[mte.expecting];
             }
         ........


Or u can use @rulecatch.

cheers,


2009/8/21 Marwan Ajraoui <marwan.alephn at gmail.com>:
> r : ID '#' {s = $ID.text; System.out.println("found "+s);} ;
>
> Tow alternatives
>
> 1. take out '#' from ur file.g
>
> or
>
> 2. ?Put it in ur input file. so it look like: b #
>
>
> U should read about how it works. Jim did send u a link.
>
> cheers,
>
>
>
>
> 2009/8/19 Ha Luong <haluongvn at gmail.com>:
>> Dear all,
>>
>> I'd like to catch the exception at the last token in the rule. I managed to
>> test some rules to catch the last token mismatch but I couldn't do.
>> Here is my test:
>>
>> 1. In "T.g" :
>>
>> grammar T;
>> options {
>> ??? language=Java;
>> }
>> @members {
>> String s;
>> }
>>
>> // Alter code generation so catch-clauses get replace with
>> // this action.
>> @rulecatch {
>>
>> catch (RecognitionException e) {
>> ??? throw e;
>>
>> }
>>
>> }
>> // END:override
>>
>> r : ID '#' {s = $ID.text; System.out.println("found "+s);} ;
>> ID: 'a'..'z'+ ;
>> WS: (' '|'\n'|'\r')+ {skip();} ; // ignore whitespace
>>
>> 2. In "input.txt":
>> b
>>
>> 3. In "Test.java":
>> import org.antlr.runtime.*;
>>
>> public class Test {
>> ??? public static void main(String[] args) throws Exception {
>> ??????? //ANTLRInputStream input = new ANTLRInputStream(System.in);
>> ??????? //TLexer lexer = new TLexer(input);
>> ??????? TLexer lexer = new TLexer(new ANTLRFileStream("input.txt"));
>> ??? ??? CommonTokenStream tokens = new CommonTokenStream(lexer);
>> ??????? TParser parser = new TParser(tokens);
>> ??? ??? try{
>> ??? ??? ??? parser.r();
>> ??? ??? }
>> ??? ??? catch (RecognitionException e) {
>> ??? ??? ??? System.out.println(e.getClass().toString());
>> ??? ??? ??? //e.printStackTrace();
>> ??? ??? }
>> ??? }
>> }
>>
>> 4. The output in console when I run Test:
>> $ java Test
>> line 0:-1 missing '#' at '<EOF>'
>> found b
>>
>> I don't know why the last token mismatch couldn't catch in the main function
>> of Test. Could you please help me?
>>
>> Thank you very much,
>> Ha Luong
>>
>>
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
>
>
> --
> Marouane
>



-- 
Marouane

From safisce at gmail.com  Fri Aug 21 08:06:54 2009
From: safisce at gmail.com (Safiye Celik)
Date: Fri, 21 Aug 2009 18:06:54 +0300
Subject: [antlr-interest] 'DOWN' and <UP> tokens
Message-ID: <bbf7e7d50908210806m4cc21297yb3ba857e87d60b2a@mail.gmail.com>

Hi,
While parsing my AST tree, I get some errors such as "no viable alternative
at input 'DOWN'" or "mismatched tree node:1 expecting <UP>". What are those
UP and DOWN tokens? They are not mine :)

-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090821/11826b3c/attachment.html 

From JALuber at gmx.de  Fri Aug 21 08:44:32 2009
From: JALuber at gmx.de (Johannes Luber)
Date: Fri, 21 Aug 2009 17:44:32 +0200
Subject: [antlr-interest] 'DOWN' and <UP> tokens
In-Reply-To: <bbf7e7d50908210806m4cc21297yb3ba857e87d60b2a@mail.gmail.com>
References: <bbf7e7d50908210806m4cc21297yb3ba857e87d60b2a@mail.gmail.com>
Message-ID: <20090821154432.142250@gmx.net>

> Hi,
> While parsing my AST tree, I get some errors such as "no viable
> alternative
> at input 'DOWN'" or "mismatched tree node:1 expecting <UP>". What are
> those
> UP and DOWN tokens? They are not mine :)

This means that your tree grammar isn't entirely consistent with your parser. The UP and DOWN tokens are used to encode the two dimensional pare tree in a one dimensional stream. So check your rules at the appropriate place that what the parser actually creates is also expected by the tree grammar.

Johannes
> 
> -- 
> -safiye

-- 
Neu: GMX Doppel-FLAT mit Internet-Flatrate + Telefon-Flatrate
f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02

From sokorac at gmail.com  Fri Aug 21 13:47:32 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Fri, 21 Aug 2009 16:47:32 -0400
Subject: [antlr-interest] Strategy for mapping output to line numbers
	from a tree walker
In-Reply-To: <4A8B0797.7030106@temporal-wave.com>
References: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
	<4A8B0797.7030106@temporal-wave.com>
Message-ID: <f6be20450908211347h24e0b481t31705f6ea9e9e2cb@mail.gmail.com>

What is the best way to handle this problem when the children of a node are
coming from different CharStreams (include files, macros, what have you...),
and you could expect to have the first or last token be from another stream?

I.e. your tree is (PROGRAM STATEMENT STATEMENT STATEMENT), and your first
statement came from an include file, while the others are in the main file.
Retrieving the start token of the PROGRAM node will yield the first token of
the first STATEMENT, whose index will be the location in the include file,
and not the first token of the PROGRAM (which is most likely "#include").

It seems to me that the tree walker has no way of determining the location
of the first character in PROGRAM without us tracking the locations of char
stream switches during lexing, but that creates a special case to be checked
for every one of the nice and simple methods below. Is there a more elegant
solution available? Off the top of my head, I'm thinking that everything
would work out very nicely if the lexer could insert a "blank" token at the
beginning and the end of every included char stream, except that the extra
token would confuse the parser.

Stan

On Tue, Aug 18, 2009 at 3:57 PM, Jim Idle <jimi at temporal-wave.com> wrote:

> Joe Schmoe wrote:
> > I have a grammar that produces an AST and a tree walker, and I am
> > coming up blank trying to figure out a reasonable way to track line
> > number information in the tree walker so that I can map my output to
> > source file lines.
> >
> > The only solution I have come up with is incredibly wordy, which is to
> > make sure that every time I see a token name in the walker I track the
> > line number.
> >
> > rule : ^(TOKENNAME .... ) { TrackLine($TOKENNAME.line) }
> >       ;
> >
> > I am sure there are better solutions than this but I haven't been able
> > to figure out what they are.
> Search the list for code to do this.
>
> Basically, create yourself some helper methods that given a tree node or
> a token, work this out for you. Form a tree node, you can ask for the
> starting token and ending token and use those tokens to compute the span
> of the tree by asking for their start and end indexes (for error
> underlining and other similar purposes). The best thing is to create a
> little framework for handling errors, picking up information and so on -
> you can reuse it for many grammars.
>
> Here are a few methods you might find useful for stealing ideas from
> (they are just excerpts but show you the methods to use)
>
> Jim
>
>
>    protected int pos() {
>
>        return pos(input.LT(1));
>    }
>
>    /**
>     * Calculates the character position of the first character of the text
>     * in the input stream that the supplied token represents.
>     * @param tok The token to locate in the input stream
>     * @return The character position of the next non-whitespace token
> in the input stream
>     */
>    protected int pos(Token tok) {
>
>        return ((CommonToken)tok).getStartIndex();
>    }
>
>    /**
>     * Calculates the character position of the last character of the text
>     * in the input stream that the supplied token represents.
>     * @param tok The token to locate in the input stream
>     * @return The character position of the next non-whitespace token
> in the input stream
>     */
>    protected int endPos(Token tok) {
>
>        return ((CommonToken)tok).getStopIndex();
>    }
>
>  /**
>     * Log a particular message into the message log (typically from
> syntax errors and so on)
>     *
>     * @param msgDesc   The message we want to log
>     * @param line      The line that this message appertains to
>     * @param colPos    The column position in the line
>     * @param startPos  The start offset of the error
>     * @param endPos    The end offset of the error
>     * @param args      The arguments for formatting the message
>     */
>    public void
>    logMsg(MessageDescriptor msgDesc, int line, int colPos, int
> startPos, int endPos, Object... args)
>    {
>        // Instantiate the message
>        //
>        Message m = new Message(msgDesc, fileName, line, colPos,
> startPos, endPos, args);
>
>        // Store in the vector
>        //
>        messages.add(m);
>
>        // Count the severity
>        //
>        switch (msgDesc.getSeverity()) {
>
>            case ERROR:
>
>                errorCount++;
>                break;
>
>            case WARNING:
>
>                warningCount++;
>                break;
>
>            case FATAL:
>
>                errorCount++;
>                fatalCount++;
>                break;
>
>            // No default as Enum is type safe
>        }
>    }
>
>    /**
>     * Create a message regarding a single token, taking the start and
> end positions
>     * from the token.
>     *
>     * @param m    The type of message you want to create
>     * @param ct   The CommonToken that we are reporting against
>     * @param args The parameters for the message we are raising
>     */
>    public void logMsg(MessageDescriptor m, Token ct, Object... args) {
>
>        // Call the standard logger, using the information in the token
>        //
>        logMsg(m, ((CommonToken)ct).getLine(),
> ((CommonToken)ct).getCharPositionInLine(),
> ((CommonToken)ct).getStartIndex(), ((CommonToken)ct).getStopIndex(), args);
>
>    }
>
>    /**
>     * Create a message regarding a root node such as an expression,
> taking the start and end positions
>     * from the tree node.
>     *
>     * @param m    The type of message you want to create
>     * @param ct   The CommonToken that we are reporting against
>     * @param args The parameters for the message we are raising
>     */
>    public void logMsg(MessageDescriptor m, CommonTree ct, Object... args) {
>
>        CommonToken st;
>        CommonToken et;
>
>        st = (CommonToken)(tokens.get(ct.getTokenStartIndex()));
>        et = (CommonToken)(tokens.get(ct.getTokenStopIndex()));
>
>        // Call the standard logger, using the information in the tokens
>        //
>        logMsg(m, st.getLine(), st.getCharPositionInLine(),
> st.getStartIndex(), et.getStopIndex(), args);
>
>    }
>    /**
>     * Create a message regarding a single token, taking the start position
>     * from the token but the end position as specified
>     *
>     * @param m      The type of message you want to create
>     * @param ct     The CommonToken that we are reporting against
>     * @param endPos The absolute offset where the span of the error
> message should end
>     * @param args   The parameters for the message we are raising
>     */
>    public void logMsg(MessageDescriptor m, Token ct, int endPos,
> Object... args) {
>
>        // Call the standard logger, using the information in the token
>        //
>        logMsg(m, ((CommonToken)ct).getLine(),
> ((CommonToken)ct).getCharPositionInLine(),
> ((CommonToken)ct).getStartIndex(), endPos, args);
>
>    }
>
>    /**
>     * Create a message that appertains to a span of tokens, such as
> when the
>     * result of an expression is incorrect and so on.
>     *
>     * @param m         The type of message you want to create
>     * @param startCt   The CommonToken that starts the message
>     * @param stopCt    The commonToken that ends the message
>     * @param args      The parameters for the message we are raising
>     *
>     */
>    public void logMsg(MessageDescriptor m, Token startCt, Token stopCt,
> Object... args) {
>
>        // Call the standard logger, using the information in the token
>        //
>       logMsg(m, ((CommonToken)startCt).getLine(),
> ((CommonToken)startCt).getCharPositionInLine(),
> ((CommonToken)startCt).getStartIndex(),
> ((CommonToken)stopCt).getStopIndex(), args);
>    }
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090821/5f6b6307/attachment.html 

From antlr at mirality.co.nz  Fri Aug 21 14:19:05 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 22 Aug 2009 09:19:05 +1200
Subject: [antlr-interest] Strategy for mapping output to line numbers
 from a tree walker
In-Reply-To: <f6be20450908211347h24e0b481t31705f6ea9e9e2cb@mail.gmail.co
 m>
References: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
	<4A8B0797.7030106@temporal-wave.com>
	<f6be20450908211347h24e0b481t31705f6ea9e9e2cb@mail.gmail.com>
Message-ID: <20090821211919.6B48534183F3@www.antlr.org>

At 08:47 22/08/2009, Stanislav Sokorac wrote:
>What is the best way to handle this problem when the children of 
>a node are coming from different CharStreams (include files, 
>macros, what have you...), and you could expect to have the first 
>or last token be from another stream?
[...]
>It seems to me that the tree walker has no way of determining the 
>location of the first character in PROGRAM without us tracking 
>the locations of char stream switches during lexing, but that 
>creates a special case to be checked for every one of the nice 
>and simple methods below. Is there a more elegant solution 
>available?

You're going to want to track that information anyway, in order to 
provide good error reporting (people will want to know that an 
error is on line 16 of include file B, not on line 152 of the 
input after preprocessing).

ANTLR already includes a line number with each token, and the 
filename is in the char stream.  You just need to link the token 
with the char stream it came from (which might even already be 
done; I haven't checked) and you should be good to go.


If you don't care about the error reporting, then the simplest 
thing to do is to run a complete preprocessing pass to merge all 
the include files before starting the "real" lex/parse/treewalk.


From jimi at temporal-wave.com  Fri Aug 21 15:37:19 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 21 Aug 2009 15:37:19 -0700
Subject: [antlr-interest] Strategy for mapping output to line numbers
 from a tree walker
In-Reply-To: <auto-000000640606@temporal-wave.com>
References: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
	<4A8B0797.7030106@temporal-wave.com>
	<f6be20450908211347h24e0b481t31705f6ea9e9e2cb@mail.gmail.com>
	<auto-000000640606@temporal-wave.com>
Message-ID: <4A8F219F.8060002@temporal-wave.com>

Gavin Lambert wrote:
> At 08:47 22/08/2009, Stanislav Sokorac wrote:
>> What is the best way to handle this problem when the children of a 
>> node are coming from different CharStreams (include files, macros, 
>> what have you...), and you could expect to have the first or last 
>> token be from another stream?
> [...]
>> It seems to me that the tree walker has no way of determining the 
>> location of the first character in PROGRAM without us tracking the 
>> locations of char stream switches during lexing, but that creates a 
>> special case to be checked for every one of the nice and simple 
>> methods below. Is there a more elegant solution available?
>
> You're going to want to track that information anyway, in order to 
> provide good error reporting (people will want to know that an error 
> is on line 16 of include file B, not on line 152 of the input after 
> preprocessing).
>
> ANTLR already includes a line number with each token, and the filename 
> is in the char stream.  You just need to link the token with the char 
> stream it came from (which might even already be done; I haven't 
> checked) and you should be good to go.

Yes it is already done, there is a getInputStream() (or similar sounding 
method) that gives you this, which will then yield all the information 
you need.

Jim

From sokorac at gmail.com  Fri Aug 21 18:06:12 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Fri, 21 Aug 2009 21:06:12 -0400
Subject: [antlr-interest] Strategy for mapping output to line numbers
	from a tree walker
In-Reply-To: <4a8f0f56.0408c00a.7c6b.5a28SMTPIN_ADDED@mx.google.com>
References: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
	<4A8B0797.7030106@temporal-wave.com>
	<f6be20450908211347h24e0b481t31705f6ea9e9e2cb@mail.gmail.com>
	<4a8f0f56.0408c00a.7c6b.5a28SMTPIN_ADDED@mx.google.com>
Message-ID: <f6be20450908211806i6984bb3ax4227614e251afcd@mail.gmail.com>

Thanks for the replies, guys... I think I wasn't clear enough when I
described the situation, though. Certainly, you want to track where
individual tokens came from, which ANTLR does for you well as long as you
set the name for each of your char streams. And, that works great. My
question is, what is a good way to handle the situation where tokens *within
the same node* come from different char streams?

Here's a more concrete example. Say you run into this line in your C-like
language:

if (VALUE + a > 0) { echo "hi"; }

where 'VALUE' is a macro that's defined in an include file. Your lexer
substituted VALUE with the defined value (say '1.0'), and marked the char
stream appropriately. Now, your tree walker comes upon 1.0+a, and say your
language doesn't allow additional of reals and integers, so you want to
mark/underline the expression "VALUE + a" and say "No adding of reals and
integers".

So, your tree node looks like this: (+ 1.0 a). If you ask ANTLR to give you
the starting token for this tree node, it will correctly give you the "1.0"
token. If you look inside it, you'll find that it came from an include file,
at starting character 10, for example. Then you get the end token, which is
'a', and it came from 'main.c' ending at character 540.

Now what, how do you underline 'VALUE + a'? I.e. how do you figure out the
starting and ending character of your expression in 'main.c'? The user
doesn't want to see the VALUE definition in another file underlined as
there's nothing wrong with the line of code.

A similar problem occurs if you have a list of statements, and the first (or
last) few came from an include file.. if you wanted to show the proper range
in the original file, you can't determine the location of the 'include'
statement by only examining your "list of statements" tree node and the
tokens in it.

I hope what I'm describing makes sense.

Thanks,
Stan

On Fri, Aug 21, 2009 at 5:19 PM, Gavin Lambert <antlr at mirality.co.nz> wrote:

> At 08:47 22/08/2009, Stanislav Sokorac wrote:
>
>> What is the best way to handle this problem when the children of a node
>> are coming from different CharStreams (include files, macros, what have
>> you...), and you could expect to have the first or last token be from
>> another stream?
>>
> [...]
>
>> It seems to me that the tree walker has no way of determining the location
>> of the first character in PROGRAM without us tracking the locations of char
>> stream switches during lexing, but that creates a special case to be checked
>> for every one of the nice and simple methods below. Is there a more elegant
>> solution available?
>>
>
> You're going to want to track that information anyway, in order to provide
> good error reporting (people will want to know that an error is on line 16
> of include file B, not on line 152 of the input after preprocessing).
>
> ANTLR already includes a line number with each token, and the filename is
> in the char stream.  You just need to link the token with the char stream it
> came from (which might even already be done; I haven't checked) and you
> should be good to go.
>
>
> If you don't care about the error reporting, then the simplest thing to do
> is to run a complete preprocessing pass to merge all the include files
> before starting the "real" lex/parse/treewalk.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090821/dc8b8162/attachment.html 

From achintmehta at gmail.com  Fri Aug 21 20:34:05 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Fri, 21 Aug 2009 23:34:05 -0400
Subject: [antlr-interest] Checking whether an optional rule matched or not
Message-ID: <4a3315250908212034w26d411f4re8bcda72d064a527@mail.gmail.com>

Hi All,

If I have a option rule in my grammar, how can I check whether that rule
matched or not.
e.g. if I have a rule in my grammar

first: (second)? third
{
    if(/* second rule matched */)
      cout<<" Second rule matched"<<endl;
}

How do I write the if condition (in C/C++) ? (I am using version 3.1.3 of
the antlr)

Thanks!

Regards,
Achint
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090821/106c4e75/attachment.html 

From antlr at mirality.co.nz  Fri Aug 21 21:04:29 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 22 Aug 2009 16:04:29 +1200
Subject: [antlr-interest] Strategy for mapping output to line numbers
 from a tree walker
In-Reply-To: <f6be20450908211806i6984bb3ax4227614e251afcd@mail.gmail.com
 >
References: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
	<4A8B0797.7030106@temporal-wave.com>
	<f6be20450908211347h24e0b481t31705f6ea9e9e2cb@mail.gmail.com>
	<4a8f0f56.0408c00a.7c6b.5a28SMTPIN_ADDED@mx.google.com>
	<f6be20450908211806i6984bb3ax4227614e251afcd@mail.gmail.com>
Message-ID: <20090822040445.609AC3418456@www.antlr.org>

At 13:06 22/08/2009, Stanislav Sokorac wrote:
>if (VALUE + a > 0) { echo "hi"; }
>
>where 'VALUE' is a macro that's defined in an include file. Your 
>lexer substituted VALUE with the defined value (say '1.0'), and 
>marked the char stream appropriately. Now, your tree walker comes 
>upon 1.0+a, and say your language doesn't allow additional of 
>reals and integers, so you want to mark/underline the expression 
>"VALUE + a" and say "No adding of reals and integers".

Well, the error itself is anchored on the + (since, after all, 
each operand is ok, it's only when you try to add them that 
there's a problem).  You could probably get by with just flagging 
the + itself as the error and not worrying about where the 
operands came from.  Failing that, you can use the location of the 
+ to decide whether you've found the "right" location for the 
operands or not.

>Now what, how do you underline 'VALUE + a'? I.e. how do you 
>figure out the starting and ending character of your expression 
>in 'main.c'? The user doesn't want to see the VALUE definition in 
>another file underlined as there's nothing wrong with the line of 
>code.

Either don't have your lexer do the substitution (which is 
impractical if this is a C-style preprocessor that can have 
complex replacements), or expand the token definition so that the 
resulting "1.0" still remembers where the call site (the VALUE) 
was, so that you can use that for error reporting.

>A similar problem occurs if you have a list of statements, and 
>the first (or last) few came from an include file.. if you wanted 
>to show the proper range in the original file, you can't 
>determine the location of the 'include' statement by only 
>examining your "list of statements" tree node and the tokens in 
>it.

You could add an extra value to the token definition and lexer 
members (an "include list").  This starts out empty.  When any 
token is generated, the current include list is attached to 
it.  When that happens to be an include statement, the current 
include list is cloned and a reference to the include statement 
itself is added to the copy, then the copy is passed into the 
sublexer as its include list.

That way, every token would carry with it the full chain of 
include files (and line numbers of the include statements) that it 
took to get there, which would make for very useful error 
messages.

Obviously this will increase memory usage a bit (depending on how 
many levels of nested includes you have), but it's probably fairly 
minimal.  Just make sure you don't clone the list for each 
individual token ;)


From markwright at internode.on.net  Fri Aug 21 22:46:15 2009
From: markwright at internode.on.net (Mark Wright)
Date: Sat, 22 Aug 2009 15:46:15 +1000
Subject: [antlr-interest] Checking whether an optional rule matched or
 not
In-Reply-To: <4a3315250908212034w26d411f4re8bcda72d064a527@mail.gmail.com>
References: <4a3315250908212034w26d411f4re8bcda72d064a527@mail.gmail.com>
Message-ID: <20090822154615.00005e03@goanna>

Hi Achint,

Maybe something like:

first
@init { bool second_rule_matched = false; }
  : (second)? { second_rule_matched = true; } third
{
    if(second_rule_matched)
      cout<<" Second rule matched"<<endl;
}
;

Or p. 126 of the Antlr book describes how to do it with optional tokens,
something like (assuming 'second' is a token):

first
  : (second_rule_matched='second')? third
{
    if($second_rule_matched != 0)
      cout<<" Second rule matched"<<endl;
}
;

Regards, Mark

On Fri, 21 Aug 2009 23:34:05 -0400
Achint Mehta <achintmehta at gmail.com> wrote:

> Hi All,
> 
> If I have a option rule in my grammar, how can I check whether that rule
> matched or not.
> e.g. if I have a rule in my grammar
> 
> first: (second)? third
> {
>     if(/* second rule matched */)
>       cout<<" Second rule matched"<<endl;
> }
> 
> How do I write the if condition (in C/C++) ? (I am using version 3.1.3 of
> the antlr)
> 
> Thanks!
> 
> Regards,
> Achint


-- 

From achintmehta at gmail.com  Fri Aug 21 23:27:08 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Sat, 22 Aug 2009 02:27:08 -0400
Subject: [antlr-interest] Checking whether an optional rule matched or
	not
In-Reply-To: <20090822154615.00005e03@goanna>
References: <4a3315250908212034w26d411f4re8bcda72d064a527@mail.gmail.com>
	<20090822154615.00005e03@goanna>
Message-ID: <4a3315250908212327q14cfd32du8864011c3660355b@mail.gmail.com>

Hi Mark,

Thanks for your response.

When I tried the first solution, it seems that the action associated with
the optional (second) rule is always executed whether the optional (second)
rule matched or not.
I am pasting the actual grammar that I made to test this:
-------------------------------------------------
grammar sample_parser;
options
{
 language = C;
}

first : (second)? {printf("\n Second is present\n"); } ' ' third;
second: 'SECOND';
third: 'THIRD';
NEWLINE: ('\r')? '\n';
------------------------------------------------------------
For an input of " THIRD" (without the quotes) or "SECOND THIRD" (without the
quotes), the output is always "Second is present".

Now if the optional (second) rule did not match and I try to access the text
of the second rule (as $second.text->chars or even $second.text), then the
program crashes in toStringTT().

In the release notes of ANTLR 3.1 (
http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.1+Release+Notes), the
following is mentioned in the section "Element properties":

"Made refs to rule/token properties use conditional operator ?: to avoid
null ptr exceptions. $label.st, for example, is now label!=null?label.st:
null not label.st. This is useful not only for optional rule/token refs, but
also during error recovery. If ID is not matched, $ID.text won't cause a
null ptr."

This made me believe that in ver 3.1.3, it should be possible to check
whether the rule text is null or not (as you specified in solution 2 for
token) but I could not make it work (compilable).

Would you have any idea on this ?

Thanks in advance.

Regards,
Achint

On Sat, Aug 22, 2009 at 1:46 AM, Mark Wright <markwright at internode.on.net>wrote:

> Hi Achint,
>
> Maybe something like:
>
> first
> @init { bool second_rule_matched = false; }
>  : (second)? { second_rule_matched = true; } third
> {
>    if(second_rule_matched)
>      cout<<" Second rule matched"<<endl;
> }
> ;
>
> Or p. 126 of the Antlr book describes how to do it with optional tokens,
> something like (assuming 'second' is a token):
>
> first
>  : (second_rule_matched='second')? third
> {
>    if($second_rule_matched != 0)
>       cout<<" Second rule matched"<<endl;
> }
> ;
>
> Regards, Mark
>
> On Fri, 21 Aug 2009 23:34:05 -0400
> Achint Mehta <achintmehta at gmail.com> wrote:
>
> > Hi All,
> >
> > If I have a option rule in my grammar, how can I check whether that rule
> > matched or not.
> > e.g. if I have a rule in my grammar
> >
> > first: (second)? third
> > {
> >     if(/* second rule matched */)
> >       cout<<" Second rule matched"<<endl;
> > }
> >
> > How do I write the if condition (in C/C++) ? (I am using version 3.1.3 of
> > the antlr)
> >
> > Thanks!
> >
> > Regards,
> > Achint
>
>
> --
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090822/9bde359e/attachment.html 

From cummings at kjchome.homeip.net  Fri Aug 21 23:43:45 2009
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Sat, 22 Aug 2009 02:43:45 -0400
Subject: [antlr-interest] Checking whether an optional rule matched or
 not
In-Reply-To: <20090822154615.00005e03@goanna>
References: <4a3315250908212034w26d411f4re8bcda72d064a527@mail.gmail.com>
	<20090822154615.00005e03@goanna>
Message-ID: <4A8F93A1.1050304@kjchome.homeip.net>

On 08/22/2009 01:46 AM, Mark Wright wrote:
> Hi Achint,
> 
> Maybe something like:
> 
> first
> @init { bool second_rule_matched = false; }
>   : (second)? { second_rule_matched = true; } third

    : (second { second_rule_matches = true; })? third
> {
>     if(second_rule_matched)
>       cout<<" Second rule matched"<<endl;
> }
> ;

Put the assignment action inside the optional subrule.

-- 
Kevin J. Cummings
kjchome at rcn.com
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From achintmehta at gmail.com  Fri Aug 21 23:52:06 2009
From: achintmehta at gmail.com (Achint Mehta)
Date: Sat, 22 Aug 2009 02:52:06 -0400
Subject: [antlr-interest] Checking whether an optional rule matched or
	not
In-Reply-To: <4A8F93A1.1050304@kjchome.homeip.net>
References: <4a3315250908212034w26d411f4re8bcda72d064a527@mail.gmail.com>
	<20090822154615.00005e03@goanna> <4A8F93A1.1050304@kjchome.homeip.net>
Message-ID: <4a3315250908212352vf9713dfue89a56b333dbc802@mail.gmail.com>

Hi Kevin,

The changes suggested by you solved the problem.

Thanks.

Regards,
Achint

On Sat, Aug 22, 2009 at 2:43 AM, Kevin J. Cummings <
cummings at kjchome.homeip.net> wrote:

> On 08/22/2009 01:46 AM, Mark Wright wrote:
> > Hi Achint,
> >
> > Maybe something like:
> >
> > first
> > @init { bool second_rule_matched = false; }
> >   : (second)? { second_rule_matched = true; } third
>
>     : (second { second_rule_matches = true; })? third
> > {
> >     if(second_rule_matched)
> >       cout<<" Second rule matched"<<endl;
> > }
> > ;
>
> Put the assignment action inside the optional subrule.
>
> --
> Kevin J. Cummings
> kjchome at rcn.com
> cummings at kjchome.homeip.net
> cummings at kjc386.framingham.ma.us
> Registered Linux User #1232 (http://counter.li.org)
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090822/e5f51bd4/attachment.html 

From marwan.alephn at gmail.com  Sat Aug 22 09:55:30 2009
From: marwan.alephn at gmail.com (Marwan Ajraoui)
Date: Sat, 22 Aug 2009 18:55:30 +0200
Subject: [antlr-interest] how to specify cardinality in templates
Message-ID: <6535fcb50908220955r2d97a788x3624b093c039025@mail.gmail.com>

Hi comunity;

Would like to know how do u specify in a template the possible
repetition of some part of it.

for example in that the instelseif and cond_elseif could apper 0..n times:

instif(cond,instif,instelseif,cond_elseif,instesle) ::= <<
if(<cond>){
<instif>
}
else if(<cond>){
<instelseif>
}
else{
<instelse>
}>>


Many thx

-- 
Marouane

From parrt at cs.usfca.edu  Sat Aug 22 10:36:45 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 22 Aug 2009 10:36:45 -0700
Subject: [antlr-interest] how to specify cardinality in templates
In-Reply-To: <6535fcb50908220955r2d97a788x3624b093c039025@mail.gmail.com>
References: <6535fcb50908220955r2d97a788x3624b093c039025@mail.gmail.com>
Message-ID: <C5A791F3-0A0D-4E8D-A40F-04847AB821C6@cs.usfca.edu>

something i'm thinking about for next ST version.
Ter
On Aug 22, 2009, at 9:55 AM, Marwan Ajraoui wrote:

> Hi comunity;
>
> Would like to know how do u specify in a template the possible
> repetition of some part of it.
>
> for example in that the instelseif and cond_elseif could apper 0..n  
> times:
>
> instif(cond,instif,instelseif,cond_elseif,instesle) ::= <<
> if(<cond>){
> <instif>
> }
> else if(<cond>){
> <instelseif>
> }
> else{
> <instelse>
> }>>
>
>
> Many thx
>
> -- 
> Marouane
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From Tony.Gray at ca.schneider-electric.com  Sat Aug 22 16:02:36 2009
From: Tony.Gray at ca.schneider-electric.com (Tony.Gray at ca.schneider-electric.com)
Date: Sat, 22 Aug 2009 16:02:36 -0700
Subject: [antlr-interest] AUTO: Tony Gray is out of the office. (returning
	08/31/2009)
Message-ID: <OFD9A6A782.45532549-ON8825761A.007E94DE-8825761A.007E94DE@US.Schneider-Electric.com>



I am out of the office until 08/31/2009.

For urgent issues, please contact Nadeem Dharshi at extension 7640


Note: This is an automated response to your message  "antlr-interest Digest, Vol 57, Issue 22"
sent on 8/22/2009 12:00:01 PM.

This is the only notification you will receive while this person is away.


From Heiko.Folkerts at david-bs.de  Sun Aug 23 23:54:54 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Mon, 24 Aug 2009 08:54:54 +0200
Subject: [antlr-interest] Proper error handling in a C target parser
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF13030113D6@DC2>

Hi all,
I have an Parser creating an AST which uses the C target. After correct statements are parsed well I want to implement the error handling to provide meaningful error messages to the users.

I've read the coresponding sections of the antlr reference and I think that I need something like @rulecatch but I am a bit confused by the example in java and how to translate it to C correctly - do I have to catch the exceptions like normal C++ exceptions?

What I want to do ist to fill my own structures with the error information instead of displaying a text message. The reason is that the error message will be displayed by a separate component of the software. So I want to catch the errors and fill my own data structures. What is the right way to do that?

I should mention that I use wsyntactic predicates with backtracking in my parser. So a failed predicate doesn't mean that there is something wrong in all circumstances because there are more possible alternatives.

Thanks in advance
Heiko


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From safisce at gmail.com  Mon Aug 24 02:15:48 2009
From: safisce at gmail.com (Safiye Celik)
Date: Mon, 24 Aug 2009 12:15:48 +0300
Subject: [antlr-interest] 'DOWN' and <UP> tokens
In-Reply-To: <20090821154432.142250@gmx.net>
References: <bbf7e7d50908210806m4cc21297yb3ba857e87d60b2a@mail.gmail.com>
	<20090821154432.142250@gmx.net>
Message-ID: <bbf7e7d50908240215p7ecc2249lb8129d1b40fe42d@mail.gmail.com>

Yes, the problem was that my parser and tree grammars were not consistent.
And the inconsistency is about the tree of below rule a:

a : e (d^ e)* ;
e : b | c! a c! ;

How would I create the tree of a? I have no idea about dealing with
repetition of the token d, which is the root of a tree itself.
It would be good if you have any idea, and share with me. Thanks.

2009/8/21 Johannes Luber <JALuber at gmx.de>

> > Hi,
> > While parsing my AST tree, I get some errors such as "no viable
> > alternative
> > at input 'DOWN'" or "mismatched tree node:1 expecting <UP>". What are
> > those
> > UP and DOWN tokens? They are not mine :)
>
> This means that your tree grammar isn't entirely consistent with your
> parser. The UP and DOWN tokens are used to encode the two dimensional pare
> tree in a one dimensional stream. So check your rules at the appropriate
> place that what the parser actually creates is also expected by the tree
> grammar.
>
> Johannes
> >
> > --
> > -safiye
>
> --
> Neu: GMX Doppel-FLAT mit Internet-Flatrate + Telefon-Flatrate
> f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02
>



-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090824/e5970219/attachment.html 

From antlr at mirality.co.nz  Mon Aug 24 03:04:25 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 24 Aug 2009 22:04:25 +1200
Subject: [antlr-interest] 'DOWN' and <UP> tokens
In-Reply-To: <bbf7e7d50908240215p7ecc2249lb8129d1b40fe42d@mail.gmail.com
 >
References: <bbf7e7d50908210806m4cc21297yb3ba857e87d60b2a@mail.gmail.com>
	<20090821154432.142250@gmx.net>
	<bbf7e7d50908240215p7ecc2249lb8129d1b40fe42d@mail.gmail.com>
Message-ID: <20090824100439.3A5E034183F8@www.antlr.org>

At 21:15 24/08/2009, Safiye Celik wrote:
>Yes, the problem was that my parser and tree grammars were not 
>consistent. And the inconsistency is about the tree of below rule 
>a:
>
>a : e (d^ e)* ;
>e : b | c! a c! ;
>
>How would I create the tree of a? I have no idea about dealing 
>with repetition of the token d, which is the root of a tree 
>itself.

It helps if you think of how the corresponding rewrite rule will 
look.  (Or, failing that, some example trees.)

Rule 'a' above can produce several different kinds of tree, but 
they form a pattern:

   1. e
   2. ^(d e e)
   3. ^(d ^(d e e) e)

etc.  In fact, this first child is pretty much equivalent to 'a' 
itself.  So you can use:

a : e
   | ^(d a e)
   ;

Or, for symmetry (or in case you get a tree from something that 
might affect the second child as well):

a : e
   | ^(d a a)
   ;

Rule 'e', however, is going to get you into trouble.  Taken in 
isolation, its tree rule would be this:

e : a | b ;

Putting that with the other rule, though, you have a cycle.  An 
'a' can be an 'e' which can be an 'a'... that just won't 
work.  You'll probably need to resolve this by keeping one of the 
'c's and making it the root node, or by adding an imaginary root.

Alternatively, you could just drop the reference to 'a' entirely; 
if you do use the symmetric version of 'a' (and don't use 'e' in 
other contexts) then it's pretty much already taken care of.  So, 
from all the above:

a : e
   | ^(d a a)
   ;

e : b ;


From sokorac at gmail.com  Mon Aug 24 08:04:18 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Mon, 24 Aug 2009 11:04:18 -0400
Subject: [antlr-interest] Strategy for mapping output to line numbers
	from a tree walker
In-Reply-To: <4a8f6e5c.0c08c00a.0af7.46d4SMTPIN_ADDED@mx.google.com>
References: <443ad6690908181143y463a613byc0cc0fb957142d59@mail.gmail.com>
	<4A8B0797.7030106@temporal-wave.com>
	<f6be20450908211347h24e0b481t31705f6ea9e9e2cb@mail.gmail.com>
	<4a8f0f56.0408c00a.7c6b.5a28SMTPIN_ADDED@mx.google.com>
	<f6be20450908211806i6984bb3ax4227614e251afcd@mail.gmail.com>
	<4a8f6e5c.0c08c00a.0af7.46d4SMTPIN_ADDED@mx.google.com>
Message-ID: <f6be20450908240804xb5cf5dey97b844d6cbe7fe0b@mail.gmail.com>

Thanks for the tips, Gavin. I ended up doing something along the lines of
your "each token keeps a list of includes" idea, with a slight modification.
I did the following:

- each token in the "main" file stays as is, just a plain CommonToken
- each token included from another stream has two additional fields which
contain the first and the last token of the statement that caused the stream
switch (i.e. an include statement, a macro being used, etc.). This is used
for any nested includes, as well.

This way, I can follow a chain of includes up to any level I want, but
without having to keep a full list for each token... in most cases, I'll
want to go up the chain until the node root, the start token, and the end
token are all at the same level (i.e. same char stream), and then I can
underline the node in one file. Of course, I can also choose to go up until
I reach a CommonToken for all 3 and locate the originating include/macro
statement, if needed. ("No adding of reals and integers on line 23 of
foo.inc, included from main.c, line 543").

I think it's a flexible solution, and it's not too bad on memory usage.

Stan

On Sat, Aug 22, 2009 at 12:04 AM, Gavin Lambert <antlr at mirality.co.nz>wrote:

> At 13:06 22/08/2009, Stanislav Sokorac wrote:
>
>> if (VALUE + a > 0) { echo "hi"; }
>>
>> where 'VALUE' is a macro that's defined in an include file. Your lexer
>> substituted VALUE with the defined value (say '1.0'), and marked the char
>> stream appropriately. Now, your tree walker comes upon 1.0+a, and say your
>> language doesn't allow additional of reals and integers, so you want to
>> mark/underline the expression "VALUE + a" and say "No adding of reals and
>> integers".
>>
>
> Well, the error itself is anchored on the + (since, after all, each operand
> is ok, it's only when you try to add them that there's a problem).  You
> could probably get by with just flagging the + itself as the error and not
> worrying about where the operands came from.  Failing that, you can use the
> location of the + to decide whether you've found the "right" location for
> the operands or not.
>
>  Now what, how do you underline 'VALUE + a'? I.e. how do you figure out the
>> starting and ending character of your expression in 'main.c'? The user
>> doesn't want to see the VALUE definition in another file underlined as
>> there's nothing wrong with the line of code.
>>
>
> Either don't have your lexer do the substitution (which is impractical if
> this is a C-style preprocessor that can have complex replacements), or
> expand the token definition so that the resulting "1.0" still remembers
> where the call site (the VALUE) was, so that you can use that for error
> reporting.
>
>  A similar problem occurs if you have a list of statements, and the first
>> (or last) few came from an include file.. if you wanted to show the proper
>> range in the original file, you can't determine the location of the
>> 'include' statement by only examining your "list of statements" tree node
>> and the tokens in it.
>>
>
> You could add an extra value to the token definition and lexer members (an
> "include list").  This starts out empty.  When any token is generated, the
> current include list is attached to it.  When that happens to be an include
> statement, the current include list is cloned and a reference to the include
> statement itself is added to the copy, then the copy is passed into the
> sublexer as its include list.
>
> That way, every token would carry with it the full chain of include files
> (and line numbers of the include statements) that it took to get there,
> which would make for very useful error messages.
>
> Obviously this will increase memory usage a bit (depending on how many
> levels of nested includes you have), but it's probably fairly minimal.  Just
> make sure you don't clone the list for each individual token ;)
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090824/cafbe438/attachment.html 

From safisce at gmail.com  Mon Aug 24 23:06:27 2009
From: safisce at gmail.com (Safiye Celik)
Date: Tue, 25 Aug 2009 09:06:27 +0300
Subject: [antlr-interest] lexical rule problem
Message-ID: <bbf7e7d50908242306q52eb1ec9ja8613f4cdd9af09c@mail.gmail.com>

Hi,
I have to write a lexical rule such as

a: b c b
b: D | E

and I want 'b' tokens in rule 'a' to be the same. That's, when the first 'b2
in 'a' is D, then the last 'b' should be D. The same is true for E.

To provide this, do I have to write two alternatives for 'a' (that is, a: D
c D | E c E) or is there an easier way to make ANTLR to provide this
condition? I have to use explicit version (righthandside) of rule 'a' in
many rules, so it would be good if I have a chance to write 'a' in one
alternative.

-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090825/2a8760c9/attachment.html 

From marco at mtsystems.ch  Tue Aug 25 04:26:16 2009
From: marco at mtsystems.ch (Marco Trudel)
Date: Tue, 25 Aug 2009 13:26:16 +0200
Subject: [antlr-interest] inline code for multiple target languages
Message-ID: <4A93CA58.3050906@mtsystems.ch>

Hello all

I have a grammar that I use for C and Java. Is there a way to have
inline code for both languages? Something like:

options {
    language = C; // or Java
}

scope Symbols {
    antlr_if language == "Java" then
       Set types;
    else
       pANTLR3_HASH_TABLE types;
    end
}

Or is there something that allows me to do something similar? Currently
I manually comment/uncomment the code when I change the language.


Thanks
Marco


From mathieu.clabaut at gmail.com  Tue Aug 25 05:50:54 2009
From: mathieu.clabaut at gmail.com (Mathieu Clabaut)
Date: Tue, 25 Aug 2009 14:50:54 +0200
Subject: [antlr-interest] Tree rewriting with patterns in python
Message-ID: <db9360ca0908250550w338f9bb8ga3bdaf24189933af@mail.gmail.com>

Hello,

 I just tried the technique given in Terence article :
http://www.antlr.org/wiki/display/~admin/2008/11/30/Example+tree+rewriting+with+patterns
 for the python target.
 But it seems that tree filtering is not implemented.

 Do I have overlooked something ?
 Could anyone give me some pointer about it ?
 Do you intend to port this feature ?

 And, anyway, thank you for your work on python target.

-Mathieu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090825/260d70da/attachment.html 

From safisce at gmail.com  Tue Aug 25 07:57:18 2009
From: safisce at gmail.com (Safiye Celik)
Date: Tue, 25 Aug 2009 17:57:18 +0300
Subject: [antlr-interest] parse tree construction
Message-ID: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>

Hi
I wanna ask one more question about parse tree construction..
I have such a rule:

x: A B (C A B)* and I have to create such a tree for it:

                                                                         B
                                     /      |     \
                                A        C        B
                                                  /  |  \
                                               A  C    B
                                                        /  |  \
                                                      A..C. B......and
continues like that. (The leftmost a B is in the rule, the closest it is to
the root of the tree.This is true also for other tokens)

How can I create such a tree for that rule? the "*" confuses everything :(


-- 
-safiye
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090825/f32b0654/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Tue Aug 25 09:27:00 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Tue, 25 Aug 2009 17:27:00 +0100
Subject: [antlr-interest] parse tree construction
In-Reply-To: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>
References: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>
Message-ID: <4A9410D4.4090404@lancaster.ac.uk>

Safiye Celik wrote:
> Hi
> I wanna ask one more question about parse tree construction..
> I have such a rule:
> 
> x: A B (C A B)* and I have to create such a tree for it:
> 
>                               
>                                            B
>                                      /      |     \
>                                 A        C        B
>                                                   /  |  \
>                                                A  C    B
>                                                         /  |  \
>                                                       A..C. B......and 
> continues like that. (The leftmost a B is in the rule, the closest it is 
> to the root of the tree.This is true also for other tokens)
> 
> How can I create such a tree for that rule? the "*" confuses everything :(

I *believe* (I may be wrong) that you need to formulate the rule using 
recursion, rather than EBNF. While (tail-)recursion and EBNF are 
equivalent in matching, they produce different results in tree 
constructions. I could very well be wrong, of course.

-- 
Sam Barnett-Cormack

From s.barnett-cormack at lancaster.ac.uk  Tue Aug 25 09:28:14 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Tue, 25 Aug 2009 17:28:14 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A89A19B.7040900@lancaster.ac.uk>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>
	<4A89A19B.7040900@lancaster.ac.uk>
Message-ID: <4A94111E.7060002@lancaster.ac.uk>

So, no intetion to provide this, then, Ter et al?

Sam Barnett-Cormack wrote:
> Jim Idle wrote:
>> Sam Barnett-Cormack wrote:
>>> Tom Ball wrote:
>>>   
>>>> Do you mean something other than http://antlr.org/api/Java/index.html 
>>>> and http://www.stringtemplate.org/api/index.html?
>>>>     
>>> That ST one is great, but the antlr one is doxygen, not javadoc, and the 
>>> auto-linking expects certain formats, paths, etc that doxygen doesn't 
>>> put them in.
>>>
>>> Sam
>>>
>>>   
>> Just type:
>>
>> mvn javadoc:javadoc
>>
>> Then you can host it anywhere you like including just out of the local 
>> directory.
> 
> I was hoping for an "official" online doc location, so I don't have to 
> either ship those docs with the product, or have dangling references in 
> my own docs.
> 


-- 
Sam Barnett-Cormack

From martijn.reuvers at gmail.com  Tue Aug 25 09:50:51 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Tue, 25 Aug 2009 18:50:51 +0200
Subject: [antlr-interest] parse tree construction
In-Reply-To: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>
References: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>
Message-ID: <c376e6ec0908250950va33276cxe39358c8337c8348@mail.gmail.com>

Hi Safiye,

As Sam said, recursion might be what you need.

Something like this gives your tree I believe:

grammar test;

options {
	output=AST;
	
}

x
	: A B y    -> ^(B A y)
	;

y :	C A B y* -> ^(B A C y*)
	;

A :	'A';

B :	'B';

C :	'C';


Martijn

On Tue, Aug 25, 2009 at 4:57 PM, Safiye Celik<safisce at gmail.com> wrote:
> Hi
> I wanna ask one more question about parse tree construction..
> I have such a rule:
>
> x: A B (C A B)* and I have to create such a tree for it:
>
>
> ?????????????????????????????????????????? B
> ???????????????????????????????????? / ???? |???? \
> ??????????????????????????????? A??????? C??????? B
> ????????????????????????????????????????????????? /? |? \
> ?????????????????????????????????????????????? A? C??? B
> ??????????????????????????????????????????????????????? /? |? \
> ????????????????????????????????????????????????????? A..C. B......and
> continues like that. (The leftmost a B is in the rule, the closest it is to
> the root of the tree.This is true also for other tokens)
>
> How can I create such a tree for that rule? the "*" confuses everything :(
>
>
> --
> -safiye
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From jbb at acm.org  Tue Aug 25 10:26:53 2009
From: jbb at acm.org (John B. Brodie)
Date: Tue, 25 Aug 2009 13:26:53 -0400
Subject: [antlr-interest] parse tree construction
In-Reply-To: <c376e6ec0908250950va33276cxe39358c8337c8348@mail.gmail.com>
References: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>
	<c376e6ec0908250950va33276cxe39358c8337c8348@mail.gmail.com>
Message-ID: <1251221214.12960.9.camel@gecko.home.org>

Greetings!

Martijn's suggestions are close but need a couple of tweaks, see
below...

On Tue, 2009-08-25 at 18:50 +0200, Martijn Reuvers wrote:
> Hi Safiye,
> 
> As Sam said, recursion might be what you need.
> 
> Something like this gives your tree I believe:
> 
> grammar test;
> 
> options {
> 	output=AST;
> 	
> }
> 
> x
> 	: A B y    -> ^(B A y)
> 	;

this will REQUIRE at least 1 instance of the C A B clause. whereas the
original rule had it being 0 or more. to fix make the y be y?, e.g:

x : A B y? -> ^(B A y?) ;

> y :	C A B y* -> ^(B A C y*)
> 	;

this is a recursive application of the y rule inside a loop! i suspect
it will work but seems very dangerous to me. i would suggest using the ?
operator rather than the * operator, 0 or 1 vs 0 or many; e.g:

y : C A B y? -> ^(B A C y?) ;

> 
> A :	'A';
> 
> B :	'B';
> 
> C :	'C';
> 
> 
> Martijn
> 
> On Tue, Aug 25, 2009 at 4:57 PM, Safiye Celik<safisce at gmail.com> wrote:
> > Hi
> > I wanna ask one more question about parse tree construction..
> > I have such a rule:
> >
> > x: A B (C A B)* and I have to create such a tree for it:
> >
> >
> >                                            B
> >                                      /      |     \
> >                                 A        C        B
> >                                                   /  |  \
> >                                                A  C    B
> >                                                         /  |  \
> >                                                       A..C. B......and
> > continues like that. (The leftmost a B is in the rule, the closest it is to
> > the root of the tree.This is true also for other tokens)
> >
> > How can I create such a tree for that rule? the "*" confuses everything :(
> >
> >
> > --
> > -safiye

Hope this helps...
   -jbb



From david-sarah at jacaranda.org  Tue Aug 25 11:30:31 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 25 Aug 2009 19:30:31 +0100
Subject: [antlr-interest] lexical rule problem
In-Reply-To: <bbf7e7d50908242306q52eb1ec9ja8613f4cdd9af09c@mail.gmail.com>
References: <bbf7e7d50908242306q52eb1ec9ja8613f4cdd9af09c@mail.gmail.com>
Message-ID: <4A942DC7.8070803@jacaranda.org>

Safiye Celik wrote:
> Hi,
> I have to write a lexical rule such as
> 
> a: b c b
> b: D | E
> 
> and I want 'b' tokens in rule 'a' to be the same. That's, when the first 'b2
> in 'a' is D, then the last 'b' should be D. The same is true for E.
> 
> To provide this, do I have to write two alternatives for 'a' (that is, a: D
> c D | E c E) or is there an easier way to make ANTLR to provide this
> condition?

I think "a: D c D | E c E;" is probably the easiest way.

An alternative is

  a: x=b c y=b { $x != null && $y != null && $x.text.equals($y.text) }?;
  b: D | E;

but that is hardly simpler. (Also note that it is only equivalent when
D and E are fixed tokens, and it might have worse error recovery
behaviour.)

> I have to use explicit version (righthandside) of rule 'a' in
> many rules, so it would be good if I have a chance to write 'a' in one
> alternative.

Why do you need to use the RHS of rule 'a' rather than just saying "a"?

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Tue Aug 25 11:54:39 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 25 Aug 2009 19:54:39 +0100
Subject: [antlr-interest] parse tree construction
In-Reply-To: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>
References: <bbf7e7d50908250757k213cb970o5d16443dea008e04@mail.gmail.com>
Message-ID: <4A94336F.7020801@jacaranda.org>

Safiye Celik wrote:
> Hi
> I wanna ask one more question about parse tree construction..
> I have such a rule:
> 
> x: A B (C A B)* and I have to create such a tree for it:
> 
>                                         B
>                                      /  |  \
>                                    A    C    B
>                                           /  |  \
>                                         A    C    B
>                                                /  |  \
>                                              A..  C.   B......and
> continues like that. (The leftmost a B is in the rule, the closest it is to
> the root of the tree.This is true also for other tokens)

x : A B^ (C x)?;

(Martijn's solution as corrected by John Brodie also works, I think,
but this is much simpler.)

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From parrt at cs.usfca.edu  Tue Aug 25 12:19:53 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 25 Aug 2009 12:19:53 -0700
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A94111E.7060002@lancaster.ac.uk>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>
	<4A89A19B.7040900@lancaster.ac.uk>
	<4A94111E.7060002@lancaster.ac.uk>
Message-ID: <2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>

hi. not sure what's wrong with the doxygen..can you be more specific?
Ter
On Aug 25, 2009, at 9:28 AM, Sam Barnett-Cormack wrote:

> So, no intetion to provide this, then, Ter et al?
>
> Sam Barnett-Cormack wrote:
>> Jim Idle wrote:
>>> Sam Barnett-Cormack wrote:
>>>> Tom Ball wrote:
>>>>
>>>>> Do you mean something other than http://antlr.org/api/Java/index.html
>>>>> and http://www.stringtemplate.org/api/index.html?
>>>>>
>>>> That ST one is great, but the antlr one is doxygen, not javadoc,  
>>>> and the
>>>> auto-linking expects certain formats, paths, etc that doxygen  
>>>> doesn't
>>>> put them in.
>>>>
>>>> Sam
>>>>
>>>>
>>> Just type:
>>>
>>> mvn javadoc:javadoc
>>>
>>> Then you can host it anywhere you like including just out of the  
>>> local
>>> directory.
>>
>> I was hoping for an "official" online doc location, so I don't have  
>> to
>> either ship those docs with the product, or have dangling  
>> references in
>> my own docs.
>>
>
>
> -- 
> Sam Barnett-Cormack
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From david-sarah at jacaranda.org  Tue Aug 25 12:31:01 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 25 Aug 2009 20:31:01 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>	<4A89A19B.7040900@lancaster.ac.uk>	<4A94111E.7060002@lancaster.ac.uk>
	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
Message-ID: <4A943BF5.7070300@jacaranda.org>

Terence Parr wrote:
> hi. not sure what's wrong with the doxygen..can you be more specific?

Suppose someone wants their javadoc implementation to include links
into ANTLR classes. They could run javadoc on the full ANTLR source,
or they could just use the "-link <url>" option of javadoc to point
to somewhere on the ANTLR site. The latter is much easier, and doesn't
require them to ship the ANTLR documentation with their own documentation.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From th.trummer at gmail.com  Tue Aug 25 13:53:47 2009
From: th.trummer at gmail.com (Thomas Trummer)
Date: Tue, 25 Aug 2009 22:53:47 +0200
Subject: [antlr-interest] Simplify tree construction rule
Message-ID: <b5b1f1f50908251353h624660ccsd89671c740e07708@mail.gmail.com>

Hi,

is it possible to simplify this rule?

aaa
    :   ('TYPE AAA'   | 'TYPE' 'AAA'  ) ';' -> 'TYPE AAA'
    ;

It basically allows space between TYPE and AAA, but the tree node should
always be "TYPE AAA".


Thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090825/752f4fe6/attachment.html 

From antlr at mirality.co.nz  Tue Aug 25 14:05:45 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 26 Aug 2009 09:05:45 +1200
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A943BF5.7070300@jacaranda.org>
References: <4A85EBAE.6060102@lancaster.ac.uk>
	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>
	<4A898965.6070901@lancaster.ac.uk>
	<4A899851.6010106@temporal-wave.com>
	<4A89A19B.7040900@lancaster.ac.uk>
	<4A94111E.7060002@lancaster.ac.uk>
	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
	<4A943BF5.7070300@jacaranda.org>
Message-ID: <20090825210612.9D76934184F6@www.antlr.org>

At 07:31 26/08/2009, David-Sarah Hopwood wrote:
 >Suppose someone wants their javadoc implementation to include
 >links into ANTLR classes. They could run javadoc on the full
 >ANTLR source, or they could just use the "-link <url>" option
 >of javadoc to point to somewhere on the ANTLR site. The
 >latter is much easier, and doesn't require them to ship the
 >ANTLR documentation with their own documentation.

For that to be correct, though, you'd have to link to a specific 
version of the docs.  (ie. the site would have to have different 
URLs for the 3.1.0 docs vs. the 3.1.1 docs, etc).

Seems simpler just to include them yourself, if you need to.


From s.barnett-cormack at lancaster.ac.uk  Tue Aug 25 14:18:10 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Tue, 25 Aug 2009 22:18:10 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <20090825210612.9D76934184F6@www.antlr.org>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>	<4A89A19B.7040900@lancaster.ac.uk>	<4A94111E.7060002@lancaster.ac.uk>	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>	<4A943BF5.7070300@jacaranda.org>
	<20090825210612.9D76934184F6@www.antlr.org>
Message-ID: <4A945512.9010808@lancaster.ac.uk>

Gavin Lambert wrote:
> At 07:31 26/08/2009, David-Sarah Hopwood wrote:
>  >Suppose someone wants their javadoc implementation to include
>  >links into ANTLR classes. They could run javadoc on the full
>  >ANTLR source, or they could just use the "-link <url>" option
>  >of javadoc to point to somewhere on the ANTLR site. The
>  >latter is much easier, and doesn't require them to ship the
>  >ANTLR documentation with their own documentation.
> 
> For that to be correct, though, you'd have to link to a specific 
> version of the docs.  (ie. the site would have to have different 
> URLs for the 3.1.0 docs vs. the 3.1.1 docs, etc).
> 
> Seems simpler just to include them yourself, if you need to.

It's a matter of taste, but most java library/runtime projects seem to 
provide online docs. Given that they aren't huge, it's not usually much 
bother for a project website to include them, even for every release. 
This is especially true when compared with the bother for *every* 
project that'll use it. StringTemplate has online javadocs, the Java 
Platform does (obviously), so does, for example, junit. And, well, quite 
a lot of stuff.

-- 
Sam Barnett-Cormack

From s.barnett-cormack at lancaster.ac.uk  Tue Aug 25 14:19:06 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Tue, 25 Aug 2009 22:19:06 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A943BF5.7070300@jacaranda.org>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>	<4A89A19B.7040900@lancaster.ac.uk>	<4A94111E.7060002@lancaster.ac.uk>	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
	<4A943BF5.7070300@jacaranda.org>
Message-ID: <4A94554A.1010805@lancaster.ac.uk>

David-Sarah Hopwood wrote:
> Terence Parr wrote:
>> hi. not sure what's wrong with the doxygen..can you be more specific?
> 
> Suppose someone wants their javadoc implementation to include links
> into ANTLR classes. They could run javadoc on the full ANTLR source,
> or they could just use the "-link <url>" option of javadoc to point
> to somewhere on the ANTLR site. The latter is much easier, and doesn't
> require them to ship the ANTLR documentation with their own documentation.

Specifically, it has to be javadoc because of the specific directoy 
structures and suchlike used by javadoc, including a specific file I 
forget the name of, that it uses to figure out which classes are under 
which URL.

-- 
Sam Barnett-Cormack

From parrt at cs.usfca.edu  Tue Aug 25 16:37:01 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 25 Aug 2009 16:37:01 -0700
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A94554A.1010805@lancaster.ac.uk>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>	<4A89A19B.7040900@lancaster.ac.uk>	<4A94111E.7060002@lancaster.ac.uk>	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
	<4A943BF5.7070300@jacaranda.org> <4A94554A.1010805@lancaster.ac.uk>
Message-ID: <D2060F66-8FBC-4D72-A787-C5F9DEAB7C11@cs.usfca.edu>


On Aug 25, 2009, at 2:19 PM, Sam Barnett-Cormack wrote:

> David-Sarah Hopwood wrote:
>> Terence Parr wrote:
>>> hi. not sure what's wrong with the doxygen..can you be more  
>>> specific?
>>
>> Suppose someone wants their javadoc implementation to include links
>> into ANTLR classes. They could run javadoc on the full ANTLR source,
>> or they could just use the "-link <url>" option of javadoc to point
>> to somewhere on the ANTLR site. The latter is much easier, and  
>> doesn't
>> require them to ship the ANTLR documentation with their own  
>> documentation.
>
> Specifically, it has to be javadoc because of the specific directoy
> structures and suchlike used by javadoc, including a specific file I
> forget the name of, that it uses to figure out which classes are under
> which URL.

thanks everyone. I see the issue now. Yes, ANTLR should have a  
standard documentation but unfortunately we have doxygen at the  
moment. since it is just Java, though, can I just run Java doc on  
everything and put it at a standard place on the website? It would  
have to include a version number as you say.

ter

From jimi at temporal-wave.com  Tue Aug 25 16:45:15 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 25 Aug 2009 18:45:15 -0500
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <D2060F66-8FBC-4D72-A787-C5F9DEAB7C11@cs.usfca.edu>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>	<4A89A19B.7040900@lancaster.ac.uk>	<4A94111E.7060002@lancaster.ac.uk>	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
	<4A943BF5.7070300@jacaranda.org> <4A94554A.1010805@lancaster.ac.uk>
	<D2060F66-8FBC-4D72-A787-C5F9DEAB7C11@cs.usfca.edu>
Message-ID: <7E08D2CF-2BA8-445E-86FF-D1928DAA03A0@temporal-wave.com>

Ter,

Run

Mvn javadoc:javadoc

And look under target/site

I will make it part of the release cycle on my return from travel.

Jim



On Aug 25, 2009, at 6:37 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

>
> On Aug 25, 2009, at 2:19 PM, Sam Barnett-Cormack wrote:
>
>> David-Sarah Hopwood wrote:
>>> Terence Parr wrote:
>>>> hi. not sure what's wrong with the doxygen..can you be more
>>>> specific?
>>>
>>> Suppose someone wants their javadoc implementation to include links
>>> into ANTLR classes. They could run javadoc on the full ANTLR source,
>>> or they could just use the "-link <url>" option of javadoc to point
>>> to somewhere on the ANTLR site. The latter is much easier, and
>>> doesn't
>>> require them to ship the ANTLR documentation with their own
>>> documentation.
>>
>> Specifically, it has to be javadoc because of the specific directoy
>> structures and suchlike used by javadoc, including a specific file I
>> forget the name of, that it uses to figure out which classes are  
>> under
>> which URL.
>
> thanks everyone. I see the issue now. Yes, ANTLR should have a
> standard documentation but unfortunately we have doxygen at the
> moment. since it is just Java, though, can I just run Java doc on
> everything and put it at a standard place on the website? It would
> have to include a version number as you say.
>
> ter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From david-sarah at jacaranda.org  Tue Aug 25 18:49:21 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Wed, 26 Aug 2009 02:49:21 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <4A943BF5.7070300@jacaranda.org>
References: <4A85EBAE.6060102@lancaster.ac.uk>
	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>
	<4A898965.6070901@lancaster.ac.uk>
	<4A899851.6010106@temporal-wave.com>
	<4A89A19B.7040900@lancaster.ac.uk>
	<4A94111E.7060002@lancaster.ac.uk>
	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
	<4A943BF5.7070300@jacaranda.org>
Message-ID: <4A9494A1.8070000@jacaranda.org>

Gavin Lambert wrote:
> At 07:31 26/08/2009, David-Sarah Hopwood wrote:
>>Suppose someone wants their javadoc implementation to include
>>links into ANTLR classes. They could run javadoc on the full
>>ANTLR source, or they could just use the "-link <url>" option
>>of javadoc to point to somewhere on the ANTLR site. The
>>latter is much easier, and doesn't require them to ship the
>>ANTLR documentation with their own documentation.
> 
> For that to be correct, though, you'd have to link to a specific version
> of the docs.  (ie. the site would have to have different URLs for the
> 3.1.0 docs vs. the 3.1.1 docs, etc).

Even just the latest version would be useful, but yes, different URLs for
each version (and one for the latest) would be better. Once you have it
set up, it's really very little work per release.

In any case, my view is that it's always the responsibility of the
reader of documentation to make sure they are looking at the right
version. The convention for javadocs is to display the version prominently
at the top-right of every page.

> Seems simpler just to include them yourself, if you need to.

Not a chance. The problem isn't really the size of the generated docs;
it's the dependency on the ANTLR source distribution to build them.
Currently that is 10.2 MB gzipped, or 19 MB un-gzipped (23.4 MB on disk
for an NTFS filesystem, which stores small files wastefully).

Adding this huge and not-otherwise-needed dependency (for my current
project it would be over 200 times larger than my own code), especially
in the case of an open source project where you want users to be able to
build docs from source themselves, would be completely prohibitive.
There's just no comparison between that, and adding one line that says
something like '-link "http://www.antlr.org/api/3.1.3/javadoc/"' to a
javadoc options file.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com




From david-sarah at jacaranda.org  Tue Aug 25 18:51:54 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Wed, 26 Aug 2009 02:51:54 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <D2060F66-8FBC-4D72-A787-C5F9DEAB7C11@cs.usfca.edu>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>	<4A89A19B.7040900@lancaster.ac.uk>	<4A94111E.7060002@lancaster.ac.uk>	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
	<4A943BF5.7070300@jacaranda.org> <4A94554A.1010805@lancaster.ac.uk>
	<D2060F66-8FBC-4D72-A787-C5F9DEAB7C11@cs.usfca.edu>
Message-ID: <4A94953A.9080305@jacaranda.org>

Terence Parr wrote:
> On Aug 25, 2009, at 2:19 PM, Sam Barnett-Cormack wrote:
>> David-Sarah Hopwood wrote:
>>> Terence Parr wrote:
>>>> hi. not sure what's wrong with the doxygen..can you be more specific?
>>>
>>> Suppose someone wants their javadoc implementation to include links
>>> into ANTLR classes. They could run javadoc on the full ANTLR source,
>>> or they could just use the "-link <url>" option of javadoc to point
>>> to somewhere on the ANTLR site. The latter is much easier, and doesn't
>>> require them to ship the ANTLR documentation with their own
>>> documentation.
>>
>> Specifically, it has to be javadoc because of the specific directoy
>> structures and suchlike used by javadoc, including a specific file I
>> forget the name of, that it uses to figure out which classes are under
>> which URL.

(The name is "package-list".)

> thanks everyone. I see the issue now. Yes, ANTLR should have a standard
> documentation but unfortunately we have doxygen at the moment. since it
> is just Java, though, can I just run Java doc on everything and put it
> at a standard place on the website?

Yes. As far as I know there are no special options to javadoc needed to
produce output that can be linked to.

The following javadoc options are helpful, though:

  -linksource -sourcetab 4
    Link method and class names to an HTML version of the source code
    with line numbers, similar to the current doxygen ANTLR docs
    (not as pretty, but never mind).

  -link "http://java.sun.com/javase/6/docs/api/"
    Link names of Java API classes to Sun's docs. (The assumption of
    JavaSE 6 is good enough.)

  -header "<b>ANTLR API<br>Version ...</b>"
    Add a version header in a style consistent with Sun's docs.

I would put the options in a text file and use @<filename> on the
javadoc command line; that's easier to maintain, avoids command
length limits on some platforms, and allows you to control the set
of documented source files (e.g. excluding generated files) more
easily.

> It would have to include a version number as you say.

See the -header option above.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com




From marco at mtsystems.ch  Wed Aug 26 02:01:57 2009
From: marco at mtsystems.ch (Marco Trudel)
Date: Wed, 26 Aug 2009 11:01:57 +0200
Subject: [antlr-interest] translating Java frontend code to C frontend code
Message-ID: <4A94FA05.2090708@mtsystems.ch>

Dear all

I translated the "ANSI C grammar for ANTLR v3" from the grammar list 
(http://antlr.org/grammar/list) from Java to C.
The original is here: http://antlr.org/grammar/1153358328744/C.g
My new C one can be found here: http://mtsystems.ch/tmp/C.g
Diff: http://mtsystems.ch/tmp/grammar-diff.txt

Since I'm not at all familiar with the internals of the Java or C 
frontends, I don't know how good a job I did. Specifically, I have three 
questions/concerns:

1. I think my translation is not fully correct since I manually have to 
add a "!= NULL" check in the created CParser.c. This change:
  			{
-			if ($declaration.size()>0&&$declaration::isTypedef) {
-				$Symbols::types.add($IDENTIFIER.text);
-				//System.out.println("define type "+$IDENTIFIER.text);
+			if($declaration->size($declaration) > 0 && $declaration::isTypedef) {
+				$Symbols::types->put($Symbols::types, $IDENTIFIER.text->chars, 1, 
NULL);
+				//fprintf(stderr, "define type \%s\n", $IDENTIFIER.text->chars);
  			}
  			}
creates this code:
if(ctx->SCOPE_STACK(declaration)->size(ctx->SCOPE_STACK(declaration)) > 
0 && 	(SCOPE_TOP(declaration))->isTypedef) ...
And I have to manually adapt it to (additional "SCOPE_TOP(declaration) 
!= NULL"):
if(ctx->SCOPE_STACK(declaration)->size(ctx->SCOPE_STACK(declaration)) > 
0 && SCOPE_TOP(declaration) != NULL && 
(SCOPE_TOP(declaration))->isTypedef) ...

2.
The Java implementation uses a set. Since the C frontend doesn't have 
this data structure, I'm using a hash table (pANTLR3_HASH_TABLE). But I 
think this is ok unless I missed something obvious.

3.
I'm not yet freeing the allocated hash tables. Where/how could I do 
this? Or will it be done automatically on
	psr->free(psr);
	tstream->free(tstream);
	lxr->free(lxr);
	input->close(input);


I would be very happy about feedback on this three points. If someone 
with deeper insights than me would take a look at the whole change, that 
would also be great.


Thanks
Marco

From Heiko.Folkerts at david-bs.de  Wed Aug 26 02:38:14 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Wed, 26 Aug 2009 11:38:14 +0200
Subject: [antlr-interest] Proper errorhandling in grammars for the C target
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF13030114CA@DC2>

Hi all,
I haven't found any example using the C target that uses things like rulecatch etc. for errorhandling. The chapter in the book uses java and exceptions but I don't know how to translate it to C correctly.

So far I have a parser creating an AST and hooked up a displayRecognitionError function which exists in another CPP file. I had to separate it, because declaring the function in the @members section didn't declare the function in the header file. 

The displayErrorMessage function works correct and I get the errors from failed expressions, but I need more specific error handling. E.g. I use syntactic predicates to check for keywords. At the moment I get the error when the parser finds out, that the whole expression fails but I need to check for special conditions and raise an error.

So is there an example showing such features? 

Thanks in advance
Heiko


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From s.barnett-cormack at lancaster.ac.uk  Wed Aug 26 03:00:17 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Wed, 26 Aug 2009 11:00:17 +0100
Subject: [antlr-interest] ANTLR Javadocs
In-Reply-To: <7E08D2CF-2BA8-445E-86FF-D1928DAA03A0@temporal-wave.com>
References: <4A85EBAE.6060102@lancaster.ac.uk>	<ecf3d2390908170916u41b83908u50bd487aacd743ab@mail.gmail.com>	<4A898965.6070901@lancaster.ac.uk>	<4A899851.6010106@temporal-wave.com>	<4A89A19B.7040900@lancaster.ac.uk>	<4A94111E.7060002@lancaster.ac.uk>	<2045F3AC-A114-42E5-B27E-45EC1295E36D@cs.usfca.edu>
	<4A943BF5.7070300@jacaranda.org> <4A94554A.1010805@lancaster.ac.uk>
	<D2060F66-8FBC-4D72-A787-C5F9DEAB7C11@cs.usfca.edu>
	<7E08D2CF-2BA8-445E-86FF-D1928DAA03A0@temporal-wave.com>
Message-ID: <4A9507B1.9070206@lancaster.ac.uk>

Jim Idle wrote:
> Ter,
> 
> Run
> 
> Mvn javadoc:javadoc
> 
> And look under target/site
> 
> I will make it part of the release cycle on my return from travel.

And note that the options from David-Sarah Hopwood can easily be set in 
Maven as well, and for best appearance will be. Maven does set several 
of them to sane defaults, including (I believe) the java api doc url, 
based on the source/target options set, and setting the header based on 
the maven project title, version, etc etc. Going back in time to do old 
ones would be a little harder - would basically require branching off 
the version control points for each release to add the required config, 
etc etc.

Sam

> On Aug 25, 2009, at 6:37 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> 
>>
>> On Aug 25, 2009, at 2:19 PM, Sam Barnett-Cormack wrote:
>>
>>> David-Sarah Hopwood wrote:
>>>> Terence Parr wrote:
>>>>> hi. not sure what's wrong with the doxygen..can you be more
>>>>> specific?
>>>>
>>>> Suppose someone wants their javadoc implementation to include links
>>>> into ANTLR classes. They could run javadoc on the full ANTLR source,
>>>> or they could just use the "-link <url>" option of javadoc to point
>>>> to somewhere on the ANTLR site. The latter is much easier, and
>>>> doesn't
>>>> require them to ship the ANTLR documentation with their own
>>>> documentation.
>>>
>>> Specifically, it has to be javadoc because of the specific directoy
>>> structures and suchlike used by javadoc, including a specific file I
>>> forget the name of, that it uses to figure out which classes are under
>>> which URL.
>>
>> thanks everyone. I see the issue now. Yes, ANTLR should have a
>> standard documentation but unfortunately we have doxygen at the
>> moment. since it is just Java, though, can I just run Java doc on
>> everything and put it at a standard place on the website? It would
>> have to include a version number as you say.
>>
>> ter
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address


-- 
Sam Barnett-Cormack

From martijn.reuvers at gmail.com  Wed Aug 26 08:37:06 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Wed, 26 Aug 2009 17:37:06 +0200
Subject: [antlr-interest] Simplify tree construction rule
In-Reply-To: <b5b1f1f50908251353h624660ccsd89671c740e07708@mail.gmail.com>
References: <b5b1f1f50908251353h624660ccsd89671c740e07708@mail.gmail.com>
Message-ID: <c376e6ec0908260837x475d3028g6fa91b355d7d98dd@mail.gmail.com>

Hello,

Does not really look that complex to me, but you could probably
concatenate it in the lexer (but for that you need a real token) or
use something like:


tokens {
	SPACE = ' ';
}

aaa
    :		'TYPE' ' '? 'AAA' -> 'TYPE' SPACE 'AAA'
    ;

However this will result in 3 nodes, but concatenated again they are
the text you want... but the grammar is still more lengthy.

Martijn

On Tue, Aug 25, 2009 at 10:53 PM, Thomas Trummer<th.trummer at gmail.com> wrote:
> Hi,
>
> is it possible to simplify this rule?
>
> aaa
> ??? :?? ('TYPE AAA'?? | 'TYPE' 'AAA'? ) ';' -> 'TYPE AAA'
> ??? ;
>
> It basically allows space between TYPE and AAA, but the tree node should
> always be "TYPE AAA".
>
>
> Thomas
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From ian at telematter.com  Wed Aug 26 11:13:49 2009
From: ian at telematter.com (Ian Eyberg)
Date: Wed, 26 Aug 2009 13:13:49 -0500
Subject: [antlr-interest] misunderstanding channel HIDDEN
Message-ID: <20090826181349.GA11840@mhu>

Hi,
  I think I'm misunderstanding the usage of $channel = HIDDEN
or skip().

I have text that looks like:

  'b^@l^@a^@h^@'

(most of the time the text is simply 'blah')
and then it should come out like this:

  'blah'

my relevant rules are:

  startrule : BLAH;
  BLAH    : 'blah';
  UCODE   : '\u0000'{ $channel = HIDDEN; };

I'm reading in through antlrinputstream as "UTF8" as I do
want to support multi-byte chars and I have rules to help
that such as:

UNICODE : ('\u00a0'..'\uffff');

What am I doing wrong here?

Thanks,
Ian

From troy.daniels at baesystems.com  Wed Aug 26 11:47:00 2009
From: troy.daniels at baesystems.com (Daniels, Troy (US SSA))
Date: Wed, 26 Aug 2009 14:47:00 -0400
Subject: [antlr-interest] misunderstanding channel HIDDEN
Message-ID: <7naet7$18ghgo@dmzms99901.na.baesystems.com>

Your BLAH rule doesn't know that it can call UCODE between characters.
You want something like this.

startrule: blah;  /* Probably also want to include EOF here, otherwise
the parser will successfully run against "blahblah" */

blah: B L A H;
UCODE   : '\u0000'{ $channel = HIDDEN; };
B: 'b';
L: 'l';
A: 'a';
H: 'h';

You might be able to keep BLAH as a lexer rule, but I doubt that you can
generate a full token (UCODE) in the middle of another token (the blah).

This does mean that many of your basic "tokens" will actually be parser
rules, which probably has a negative impact on efficiency.  Assuming
your text is whitespace delimited, you'll also need extra bits in the
parser rules to ensure that you've reached the end of a "token".  In
all, it might be simpler to filter the input stream and strip out the ^@
where they're not meaningful.

Troy

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Ian Eyberg
> Sent: Wednesday, August 26, 2009 2:14 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] misunderstanding channel HIDDEN
> 
> Hi,
>   I think I'm misunderstanding the usage of $channel = HIDDEN
> or skip().
> 
> I have text that looks like:
> 
>   'b^@l^@a^@h^@'
> 
> (most of the time the text is simply 'blah')
> and then it should come out like this:
> 
>   'blah'
> 
> my relevant rules are:
> 
>   startrule : BLAH;
>   BLAH    : 'blah';
>   UCODE   : '\u0000'{ $channel = HIDDEN; };
> 
> I'm reading in through antlrinputstream as "UTF8" as I do
> want to support multi-byte chars and I have rules to help
> that such as:
> 
> UNICODE : ('\u00a0'..'\uffff');
> 
> What am I doing wrong here?
> 
> Thanks,
> Ian
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address


From kieran.beltran at gmail.com  Wed Aug 26 12:35:46 2009
From: kieran.beltran at gmail.com (Kieran Beltran)
Date: Wed, 26 Aug 2009 15:35:46 -0400
Subject: [antlr-interest] Recognizing 5-th hex digit
Message-ID: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>

I am working on an ANTLR grammar to support the ISO Standard Z notation
(specification language). The Z character set includes many non-ASCII
characters, so the lexer must recognize unicode character sequences, which,
for lexer token definitions comprising 4-hex escaped unicode (\uxxxx), I
believe ANTRL works fine.

I have encountered a problem when attempting to recognize two required
Standard Z symbols which are "above" the four-hex set recognized by my
generated lexer. The two symbols are \u1D538 and \u1D53D.

A review of the UCS documentation
http://unicode.org/Public/UNIDATA/UnicodeData.txt indicates that indeed
there is a 5-th hex digit that is used "publically", albeit infrequently -
primarily for mathematics, musical symbols and other areas. Not sure many
folks are writing grammars requiring recognition of such character sets.
Interestingly, the 5-th hex digit only needs to reach E as the highest UCS
symbol that might be used publically appears to currently be \uE01EF. Above
F0000 appears to be for private use only.

Looking at the ANTLRv3.g grammar within the ESC fragment definition, I
believe that the four-hex unicode definition is defined:
see line 495        'u' XDIGIT XDIGIT XDIGIT XDIGIT

Is the solution to include a fifth digit to be recognized optionally? Could
I simply replace line 495 (as below) and add a new fragment

'u' ZDIGIT? XDIGIT XDIGIT XDIGIT XDIGIT

fragment
ZDIGIT :
  '0' .. '9'
 | 'a' .. 'e'
 | 'A' .. 'E'
 ;

 Are there other implementation considerations I have overlooked?

Is the limited use of this too restricted to be considered / reported as an
actual ANTLR bug? Hence, should I build my own customized ANTLR?

Thank-you for considering this.

Kieran Beltran
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/7f6450df/attachment.html 

From sokorac at gmail.com  Wed Aug 26 12:57:36 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Wed, 26 Aug 2009 15:57:36 -0400
Subject: [antlr-interest] Tokens that span across char streams
Message-ID: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.com>

I have a language that allows macros to be used just about anywhere, which
makes things a bit difficult. For example, a macro could define half a
string, and something like this is legal:

#define FOO "start of a string
String a = FOO end of a string";

If I do on-the-fly substitution of macros by switching char streams (using
the include file technique from the FAQ), lexer cannot recognize the string
in the second line: it parses the macro text, encounters EOF of that stream,
throws an exception ("couldn't match anything"), and then start over at the
second half of the string, again not matching anything.

What's a good way to "smooth over" the EOF bump, and merge the streams into
one from lexer's point of view? Do I need to implement a custom CharStream
to do something like this?

Of course, I could have a pre-process run that replaces all the macros, and
then run through the resulting code, but I'd like to avoid that because (1)
it's slow to go through the file twice, and (2) the character/line numbers
in tokens will be messed up in the second run and it'll take a bit of work
to bring them back to the original locations.

Thanks,
Stan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/1e9ab462/attachment.html 

From antlr at mirality.co.nz  Wed Aug 26 14:07:26 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 27 Aug 2009 09:07:26 +1200
Subject: [antlr-interest] misunderstanding channel HIDDEN
In-Reply-To: <20090826181349.GA11840@mhu>
References: <20090826181349.GA11840@mhu>
Message-ID: <20090826210800.27FBA341841D@www.antlr.org>

At 06:13 27/08/2009, Ian Eyberg wrote:
 >I have text that looks like:
 >
 >  'b^@l^@a^@h^@'
 >
 >(most of the time the text is simply 'blah')
 >and then it should come out like this:
 >
 >  'blah'
[...]
 >  UCODE   : '\u0000'{ $channel = HIDDEN; };
 >
 >I'm reading in through antlrinputstream as "UTF8" as I do
 >want to support multi-byte chars and I have rules to help
 >that such as:

I think you're going about this the wrong way.  The input above 
looks like UTF-16; you should detect that case and use a UTF16 
file stream instead of a UTF8 one.  (Normally Unicode files will 
start with a BOM you can use for auto-detection.)

UTF-16 and UTF-8 encode high-order Unicode characters quite 
differently, so if your input can include them then trying to read 
it as UTF8 and just throwing away the nulls definitely isn't going 
to work.


From antlr at mirality.co.nz  Wed Aug 26 14:16:10 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 27 Aug 2009 09:16:10 +1200
Subject: [antlr-interest] Recognizing 5-th hex digit
In-Reply-To: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com
 >
References: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>
Message-ID: <20090826211634.7C008341847E@www.antlr.org>

At 07:35 27/08/2009, Kieran Beltran wrote:
>I have encountered a problem when attempting to recognize two 
>required Standard Z symbols which are "above" the four-hex set 
>recognized by my generated lexer. The two symbols are \u1D538 and 
>\u1D53D.
[...]
>Is the solution to include a fifth digit to be recognized 
>optionally? Could I simply replace line 495 (as below) and add a 
>new fragment
>
>'u' ZDIGIT? XDIGIT XDIGIT XDIGIT XDIGIT

No.  It also depends on the stream encoding.  IIRC the Java target 
at least reads in files as UTF-16.  So there's no "room" in a 
single character to store that single digit.

Instead, you need to encode it as a surrogate pair. \u1D538, for 
example, would be encoded as \uD835\uDD38.


I'm not entirely sure how it works in the C target, which uses 
UTF-32 encoding by default; I've never really needed to use 
characters that high up.


From antlr at mirality.co.nz  Wed Aug 26 14:34:32 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 27 Aug 2009 09:34:32 +1200
Subject: [antlr-interest] Tokens that span across char streams
In-Reply-To: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.co
 m>
References: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.com>
Message-ID: <20090826213456.99F10341847E@www.antlr.org>

At 07:57 27/08/2009, Stanislav Sokorac wrote:
>I have a language that allows macros to be used just about 
>anywhere, which makes things a bit difficult. For example, a 
>macro could define half a string, and something like this is 
>legal:
>
>#define FOO "start of a string
>String a = FOO end of a string";
>
>If I do on-the-fly substitution of macros by switching char 
>streams (using the include file technique from the FAQ), lexer 
>cannot recognize the string in the second line: it parses the 
>macro text, encounters EOF of that stream, throws an exception 
>("couldn't match anything"), and then start over at the second 
>half of the string, again not matching anything.
>
>What's a good way to "smooth over" the EOF bump, and merge the 
>streams into one from lexer's point of view? Do I need to 
>implement a custom CharStream to do something like this?

That wouldn't really help.  Consider the case where there is 
another unrelated line (perhaps another #define) between those two 
above.  Unless you were switching streams when you encounter *use* 
of the #defined tokens (and not just on include) you still 
wouldn't be able to parse a complete string token.

You *could* define a preprocessing CharStream, that recognises the 
use of #define and simply files the characters until EOL away 
without actually passing them on, then later recognises the name 
of the defined symbol and passes on the value rather than the 
name.  That's probably about the best you can do, if you don't 
want to do a full preprocessing pass.  I think it'll still have 
the same line numbering issues though.

>Of course, I could have a pre-process run that replaces all the 
>macros, and then run through the resulting code, but I'd like to 
>avoid that because (1) it's slow to go through the file twice, 
>and (2) the character/line numbers in tokens will be messed up in 
>the second run and it'll take a bit of work to bring them back to 
>the original locations.

I really think that the preprocess run is the simplest option for 
that sort of thing.  Either that or using only single characters 
as tokens; given your example you definitely can't match an entire 
quoted string as a single token without grief.

Is this your own language?  If it is, you should consider changing 
that rule and adopt something like C's string constant folding 
instead; for example the C equivalent to your above example (and 
which uses complete, lexable tokens) is this:

#define FOO "start of a string"
String a = FOO " end of a string";

(In C, two sequential string constants are treated as if they were 
a single constant with the text appended together.) 


From sokorac at gmail.com  Wed Aug 26 15:05:20 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Wed, 26 Aug 2009 18:05:20 -0400
Subject: [antlr-interest] Tokens that span across char streams
In-Reply-To: <4a95aa76.1108c00a.0a22.ffffb14eSMTPIN_ADDED@mx.google.com>
References: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.com>
	<4a95aa76.1108c00a.0a22.ffffb14eSMTPIN_ADDED@mx.google.com>
Message-ID: <f6be20450908261505w87e8edbjc9ef78c3d5486f39@mail.gmail.com>

I failed to mention that the language requires a special character to be
used before a macro *use*, which makes it easy to detect macros being used
(and allows the flexibility of having it used just about anywhere)... the
line below should read

String a = #FOO end of a string";

Unfortunately, it's not my language, so I'm stuck with the way it is.

With above in mind, it's easy for the lexer to detect both macro definitions
and macro uses. So, what I'm doing is having lexer record macro definitions,
and then have it perform stream switches when a macro use is detected. But,
since lexer can't look past the EOF of one stream into the next one, that
doesn't really help my case below. On the other hand, having the char stream
itself handle the insertion of the macro value will mess up the
line/character numbering, like you said.

Who keeps track of line numbers and character positions? The char stream, or
the lexer? If it's the stream, then I could "fool" the lexer into recording
the original numbers into tokens... If it's the lexer, then I'd have to do
post-processing on tokens to fix them, I guess.

Stan

On Wed, Aug 26, 2009 at 5:34 PM, Gavin Lambert <antlr at mirality.co.nz> wrote:

> At 07:57 27/08/2009, Stanislav Sokorac wrote:
>
>> I have a language that allows macros to be used just about anywhere, which
>> makes things a bit difficult. For example, a macro could define half a
>> string, and something like this is legal:
>>
>> #define FOO "start of a string
>> String a = FOO end of a string";
>>
>> If I do on-the-fly substitution of macros by switching char streams (using
>> the include file technique from the FAQ), lexer cannot recognize the string
>> in the second line: it parses the macro text, encounters EOF of that stream,
>> throws an exception ("couldn't match anything"), and then start over at the
>> second half of the string, again not matching anything.
>>
>> What's a good way to "smooth over" the EOF bump, and merge the streams
>> into one from lexer's point of view? Do I need to implement a custom
>> CharStream to do something like this?
>>
>
> That wouldn't really help.  Consider the case where there is another
> unrelated line (perhaps another #define) between those two above.  Unless
> you were switching streams when you encounter *use* of the #defined tokens
> (and not just on include) you still wouldn't be able to parse a complete
> string token.
>
> You *could* define a preprocessing CharStream, that recognises the use of
> #define and simply files the characters until EOL away without actually
> passing them on, then later recognises the name of the defined symbol and
> passes on the value rather than the name.  That's probably about the best
> you can do, if you don't want to do a full preprocessing pass.  I think
> it'll still have the same line numbering issues though.
>
>  Of course, I could have a pre-process run that replaces all the macros,
>> and then run through the resulting code, but I'd like to avoid that because
>> (1) it's slow to go through the file twice, and (2) the character/line
>> numbers in tokens will be messed up in the second run and it'll take a bit
>> of work to bring them back to the original locations.
>>
>
> I really think that the preprocess run is the simplest option for that sort
> of thing.  Either that or using only single characters as tokens; given your
> example you definitely can't match an entire quoted string as a single token
> without grief.
>
> Is this your own language?  If it is, you should consider changing that
> rule and adopt something like C's string constant folding instead; for
> example the C equivalent to your above example (and which uses complete,
> lexable tokens) is this:
>
> #define FOO "start of a string"
> String a = FOO " end of a string";
>
> (In C, two sequential string constants are treated as if they were a single
> constant with the text appended together.)
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/e3acd8e9/attachment.html 

From david-sarah at jacaranda.org  Wed Aug 26 16:29:04 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 00:29:04 +0100
Subject: [antlr-interest] misunderstanding channel HIDDEN
In-Reply-To: <20090826181349.GA11840@mhu>
References: <20090826181349.GA11840@mhu>
Message-ID: <4A95C540.9060406@jacaranda.org>

Ian Eyberg wrote:
> Hi,
>   I think I'm misunderstanding the usage of $channel = HIDDEN
> or skip().
> 
> I have text that looks like:
> 
>   'b^@l^@a^@h^@'
> 
> (most of the time the text is simply 'blah')
> and then it should come out like this:
> 
>   'blah'
> 
> my relevant rules are:
> 
>   startrule : BLAH;
>   BLAH    : 'blah';
>   UCODE   : '\u0000'{ $channel = HIDDEN; };
> 
> I'm reading in through antlrinputstream as "UTF8" as I do
> want to support multi-byte chars and I have rules to help
> that such as:
> 
> UNICODE : ('\u00a0'..'\uffff');
> 
> What am I doing wrong here?

Using a hidden channel won't work if you want 'blah' to be a single
token. The '$channel = HIDDEN;' in the action for UCODE sets the channel
for that token, but does not otherwise affect lexing, so you will end up
with a token stream like:

  'b' <hidden '^@'> 'l' <hidden '^@'> 'a' <hidden '^@'> 'h' <hidden '^@'>

It is possible to ignore characters within a token, but it requires more
work. If you only have to ignore NULs within an identifier, say, then
consider something like:

  Identifier
    @init { StringBuilder sb = new StringBuilder(); }
    : ( c='a'..'z' { sb.append((char) c); } | '\u0000' )*
        { state.text = sb.toString(); }
    ;

If you have to ignore certain characters or bytes anywhere, then I suggest
using a filtering InputStream (in the case of UTF-8; for UTF-16 it would
be a Reader) that strips them out before they get to the lexer.
Providing your own subclass of one of the ANTLR stream classes could
also be made to work, but is probably no simpler in this situation.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From s.barnett-cormack at lancaster.ac.uk  Wed Aug 26 16:29:36 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 27 Aug 2009 00:29:36 +0100
Subject: [antlr-interest] Recognizing 5-th hex digit
In-Reply-To: <20090826211634.7C008341847E@www.antlr.org>
References: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>
	<20090826211634.7C008341847E@www.antlr.org>
Message-ID: <4A95C560.5020501@lancaster.ac.uk>

Gavin Lambert wrote:
> At 07:35 27/08/2009, Kieran Beltran wrote:
>> I have encountered a problem when attempting to recognize two 
>> required Standard Z symbols which are "above" the four-hex set 
>> recognized by my generated lexer. The two symbols are \u1D538 and 
>> \u1D53D.
> [...]
>> Is the solution to include a fifth digit to be recognized 
>> optionally? Could I simply replace line 495 (as below) and add a 
>> new fragment
>>
>> 'u' ZDIGIT? XDIGIT XDIGIT XDIGIT XDIGIT
> 
> No.  It also depends on the stream encoding.  IIRC the Java target 
> at least reads in files as UTF-16.  So there's no "room" in a 
> single character to store that single digit.
> 
> Instead, you need to encode it as a surrogate pair. \u1D538, for 
> example, would be encoded as \uD835\uDD38.

I believe this is correct - Java's support beyond the BMP is confusing 
and somewhat patchy. Sometimes 'character' means a code point (a full 
UCS character, needing 4 bytes to fully specify) and sometimes, as in 
the char datatype, it means a 'code unit', a piece of UTF-16. Certainly 
anything that is ever going to be used to check the value of a char must 
be a code unit, not a code point, hence using surrogate pairs. This is 
awkward, but there's no sane way to get around it.

> I'm not entirely sure how it works in the C target, which uses 
> UTF-32 encoding by default; I've never really needed to use 
> characters that high up.

There may be a problem in that case in the java code used to generate 
the C, but I'm not sure. I can see how there could be. If, however, 
you're transcoding input from whatever it is (UTF-8, UTF-16, something 
from ISO-2022, whatever) to UTF-32, surrogate pairs are likely to *not* 
work, as they aren't present in the resulting byte stream.

Well, that was a random outpouring...

-- 
Sam Barnett-Cormack

From david-sarah at jacaranda.org  Wed Aug 26 16:41:19 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 00:41:19 +0100
Subject: [antlr-interest] misunderstanding channel HIDDEN
In-Reply-To: <7naet7$18ghgo@dmzms99901.na.baesystems.com>
References: <7naet7$18ghgo@dmzms99901.na.baesystems.com>
Message-ID: <4A95C81F.20001@jacaranda.org>

Daniels, Troy (US SSA) wrote:
> Your BLAH rule doesn't know that it can call UCODE between characters.
> You want something like this.
> 
> startrule: blah;  /* Probably also want to include EOF here, otherwise
> the parser will successfully run against "blahblah" */
> 
> blah: B L A H;
> UCODE   : '\u0000'{ $channel = HIDDEN; };
> B: 'b';
> L: 'l';
> A: 'a';
> H: 'h';

This won't work; the "$channel = HIDDEN;" will set the channel of the
entire token to HIDDEN if it contains any '\u0000' characters (and those
characters will still be present in the token's .text field, if that
matters).

If Gavin Lambert is correct that the zero bytes occur because the input
is UTF-16, then using a UTF-16 reader is definitely the right approach:

  Reader reader = new java.io.InputStreamReader(inputstream, "UTF-16");
  ANTLRReaderStream in = new ANTLRReaderStream(reader);

(This will auto-detect byte order if a Byte Order Mark is present, but
won't auto-detect between UTF-8 and UTF-16; you'll need extra code to do
that.)

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From kieran.beltran at gmail.com  Wed Aug 26 17:01:30 2009
From: kieran.beltran at gmail.com (Kieran Beltran)
Date: Wed, 26 Aug 2009 20:01:30 -0400
Subject: [antlr-interest] Recognizing 5-th hex digit
In-Reply-To: <4A95C560.5020501@lancaster.ac.uk>
References: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>
	<20090826211634.7C008341847E@www.antlr.org>
	<4A95C560.5020501@lancaster.ac.uk>
Message-ID: <dc6523af0908261701x45dace1dkadcf67e69f9a7720@mail.gmail.com>

Sam / Gavin thank-you.

So, in the case I am receiving UTF-32 input, I would need to preprocess
(using UTF-32-->UTF-16 algorithim) for characters in the 10000 to 10FFFF
ranges and convert them into surrogate pairs, passing that input to
ANTLRInputStream.

In my lexer definition, where appropriate, I would define the tokens to
recognize the surrogate pairs for example:

fragment ARITHMOS: '\uD835\uDD38'; // recognize UTF-32 (0001 D538) arithmos
fragment FINSET: '\uD835\uDD3D';      // recognize UTF-32 (0001 D53D) finite
set

As indicated this is only for a Java targets.

Have I got it right?

-Kieran




On Wed, Aug 26, 2009 at 7:29 PM, Sam Barnett-Cormack <
s.barnett-cormack at lancaster.ac.uk> wrote:

> Gavin Lambert wrote:
>
>> At 07:35 27/08/2009, Kieran Beltran wrote:
>>
>>> I have encountered a problem when attempting to recognize two required
>>> Standard Z symbols which are "above" the four-hex set recognized by my
>>> generated lexer. The two symbols are \u1D538 and \u1D53D.
>>>
>> [...]
>>
>>> Is the solution to include a fifth digit to be recognized optionally?
>>> Could I simply replace line 495 (as below) and add a new fragment
>>>
>>> 'u' ZDIGIT? XDIGIT XDIGIT XDIGIT XDIGIT
>>>
>>
>> No.  It also depends on the stream encoding.  IIRC the Java target at
>> least reads in files as UTF-16.  So there's no "room" in a single character
>> to store that single digit.
>>
>> Instead, you need to encode it as a surrogate pair. \u1D538, for example,
>> would be encoded as \uD835\uDD38.
>>
>
> I believe this is correct - Java's support beyond the BMP is confusing and
> somewhat patchy. Sometimes 'character' means a code point (a full UCS
> character, needing 4 bytes to fully specify) and sometimes, as in the char
> datatype, it means a 'code unit', a piece of UTF-16. Certainly anything that
> is ever going to be used to check the value of a char must be a code unit,
> not a code point, hence using surrogate pairs. This is awkward, but there's
> no sane way to get around it.
>
> I'm not entirely sure how it works in the C target, which uses UTF-32
>> encoding by default; I've never really needed to use characters that high
>> up.
>>
>
> There may be a problem in that case in the java code used to generate the
> C, but I'm not sure. I can see how there could be. If, however, you're
> transcoding input from whatever it is (UTF-8, UTF-16, something from
> ISO-2022, whatever) to UTF-32, surrogate pairs are likely to *not* work, as
> they aren't present in the resulting byte stream.
>
> Well, that was a random outpouring...
>
> --
> Sam Barnett-Cormack
>



-- 
Respectfully,
Kieran J. Beltran

Phone: (646) 294-7102
Web Page: www.lostrivercreations.com/kieran
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/90c1b8d1/attachment.html 

From david-sarah at jacaranda.org  Wed Aug 26 17:16:41 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 01:16:41 +0100
Subject: [antlr-interest] Recognizing 5-th hex digit
In-Reply-To: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>
References: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>
Message-ID: <4A95D069.7000809@jacaranda.org>

Kieran Beltran wrote:
> I am working on an ANTLR grammar to support the ISO Standard Z notation
> (specification language). The Z character set includes many non-ASCII
> characters, so the lexer must recognize unicode character sequences, which,
> for lexer token definitions comprising 4-hex escaped unicode (\uxxxx), I
> believe ANTRL works fine.
> 
> I have encountered a problem when attempting to recognize two required
> Standard Z symbols which are "above" the four-hex set recognized by my
> generated lexer. The two symbols are \u1D538 and \u1D53D.

> A review of the UCS documentation
> http://unicode.org/Public/UNIDATA/UnicodeData.txt indicates that indeed
> there is a 5-th hex digit that is used "publically", albeit infrequently -
> primarily for mathematics, musical symbols and other areas.

Strictly speaking the code unit range goes up to U+10FFFF (not all of which
are valid characters). The \u notation isn't typically used for characters
above U+FFFF, because it would be ambiguous with a four-digit escape
followed by an unescaped hex digit.

> Not sure many
> folks are writing grammars requiring recognition of such character sets.
> Interestingly, the 5-th hex digit only needs to reach E as the highest UCS
> symbol that might be used publically appears to currently be \uE01EF. Above
> F0000 appears to be for private use only.
> 
> Looking at the ANTLRv3.g grammar within the ESC fragment definition, I
> believe that the four-hex unicode definition is defined:
> see line 495        'u' XDIGIT XDIGIT XDIGIT XDIGIT

You can match such characters without changes to ANTLR by converting the
input to UTF-16 (for example by using java.io.InputStreamReader and
ANTLRReaderStream, if the target language is Java), and matching their
UTF-16 encodings. In this case that would be

  U+1D538  '\uD835\uDD38'
  U+1D53D  '\uD835\uDD3D'

Note that this relies on the fact that ANTLRStringStream and its subclasses
do not convert from UTF-16 to code points, even though ANTLR uses integer
code point streams internally. It is possible that this may cause you to
have to change your grammar if and when ANTLR supports supplementary
characters fully, although I don't see any easy way around that.

See <http://people.w3.org/rishida/scripts/uniview/conversion> for an on-line
converter between various escape formats. Here you want the output labelled
as "JavaScript escapes".

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Wed Aug 26 17:21:31 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 01:21:31 +0100
Subject: [antlr-interest] Recognizing 5-th hex digit [correction]
In-Reply-To: <4A95D069.7000809@jacaranda.org>
References: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>
	<4A95D069.7000809@jacaranda.org>
Message-ID: <4A95D18B.2030107@jacaranda.org>

David-Sarah Hopwood wrote:
> Kieran Beltran wrote:
>> A review of the UCS documentation
>> http://unicode.org/Public/UNIDATA/UnicodeData.txt indicates that indeed
>> there is a 5-th hex digit that is used "publically", albeit infrequently -
>> primarily for mathematics, musical symbols and other areas.
> 
> Strictly speaking the code unit range

code point range, I meant.

> goes up to U+10FFFF (not all of which
> are valid characters). The \u notation isn't typically used for characters
> above U+FFFF, because it would be ambiguous with a four-digit escape
> followed by an unescaped hex digit.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Wed Aug 26 17:31:46 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 01:31:46 +0100
Subject: [antlr-interest] Tokens that span across char streams
In-Reply-To: <f6be20450908261505w87e8edbjc9ef78c3d5486f39@mail.gmail.com>
References: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.com>	<4a95aa76.1108c00a.0a22.ffffb14eSMTPIN_ADDED@mx.google.com>
	<f6be20450908261505w87e8edbjc9ef78c3d5486f39@mail.gmail.com>
Message-ID: <4A95D3F2.3080901@jacaranda.org>

Stanislav Sokorac wrote:
> Who keeps track of line numbers and character positions? The char stream, or
> the lexer?

The char stream. It's actually fairly straightforward to override in your
own subclass -- look at the source code for the consume method of
ANTLRStringStream, for example:
<http://www.antlr.org/api/Java/_a_n_t_l_r_string_stream_8java-source.html#l00097>.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Wed Aug 26 17:42:53 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 01:42:53 +0100
Subject: [antlr-interest] Recognizing 5-th hex digit
In-Reply-To: <dc6523af0908261701x45dace1dkadcf67e69f9a7720@mail.gmail.com>
References: <dc6523af0908261235r576e166u6fb967c918470edd@mail.gmail.com>	<20090826211634.7C008341847E@www.antlr.org>	<4A95C560.5020501@lancaster.ac.uk>
	<dc6523af0908261701x45dace1dkadcf67e69f9a7720@mail.gmail.com>
Message-ID: <4A95D68D.3090601@jacaranda.org>

Kieran Beltran wrote:
> Sam / Gavin thank-you.
> 
> So, in the case I am receiving UTF-32 input, I would need to preprocess
> (using UTF-32-->UTF-16 algorithim) for characters in the 10000 to 10FFFF
> ranges and convert them into surrogate pairs, passing that input to
> ANTLRInputStream.

Or just use 'new ANTLRInputStream(inputstream, "UTF-32")' (which converts
UTF-32 to UTF-16, at least in the current version of ANTLR).

> In my lexer definition, where appropriate, I would define the tokens to
> recognize the surrogate pairs for example:
> 
> fragment ARITHMOS: '\uD835\uDD38'; // recognize UTF-32 (0001 D538) arithmos
> fragment FINSET: '\uD835\uDD3D';      // recognize UTF-32 (0001 D53D) finite
> set
> 
> As indicated this is only for a Java targets.
> 
> Have I got it right?

Yes.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From sokorac at gmail.com  Wed Aug 26 18:30:24 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Wed, 26 Aug 2009 21:30:24 -0400
Subject: [antlr-interest] Tokens that span across char streams
In-Reply-To: <4A95D3F2.3080901@jacaranda.org>
References: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.com>
	<4a95aa76.1108c00a.0a22.ffffb14eSMTPIN_ADDED@mx.google.com>
	<f6be20450908261505w87e8edbjc9ef78c3d5486f39@mail.gmail.com>
	<4A95D3F2.3080901@jacaranda.org>
Message-ID: <f6be20450908261830v118c2e40mb3a5010f1b3aaa3@mail.gmail.com>

I guess the tricky thing will be to insert this functionality without
significantly adding to the run time.. If the stream has to check for
macros, and also mux between the regular stream and the macro definition,
I'm adding two 'if' checks on every single character. Maybe more if I'm also
selectively updating character positions.

I could have the lexer signal to the stream when the switch is needed to
remove one of those, at least.

Or am I over-optimizing here, is lexer already doing way more on every
character than I'm talking about here? I am going to be running into some
significantly large files, so I'd like to avoid overhead wherever I can...

Stan

On Wed, Aug 26, 2009 at 8:31 PM, David-Sarah Hopwood <
david-sarah at jacaranda.org> wrote:

> Stanislav Sokorac wrote:
> > Who keeps track of line numbers and character positions? The char stream,
> or
> > the lexer?
>
> The char stream. It's actually fairly straightforward to override in your
> own subclass -- look at the source code for the consume method of
> ANTLRStringStream, for example:
> <
> http://www.antlr.org/api/Java/_a_n_t_l_r_string_stream_8java-source.html#l00097
> >.
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/e32dced5/attachment.html 

From david-sarah at jacaranda.org  Wed Aug 26 19:30:15 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 03:30:15 +0100
Subject: [antlr-interest] Tokens that span across char streams
In-Reply-To: <f6be20450908261830v118c2e40mb3a5010f1b3aaa3@mail.gmail.com>
References: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.com>	
	<4a95aa76.1108c00a.0a22.ffffb14eSMTPIN_ADDED@mx.google.com>	
	<f6be20450908261505w87e8edbjc9ef78c3d5486f39@mail.gmail.com>	
	<4A95D3F2.3080901@jacaranda.org>
	<f6be20450908261830v118c2e40mb3a5010f1b3aaa3@mail.gmail.com>
Message-ID: <4A95EFB7.9040909@jacaranda.org>

Stanislav Sokorac wrote:
> I guess the tricky thing will be to insert this functionality without
> significantly adding to the run time.. If the stream has to check for
> macros, and also mux between the regular stream and the macro definition,
> I'm adding two 'if' checks on every single character. Maybe more if I'm also
> selectively updating character positions.

I wouldn't worry about that. There are already several dynamically
dispatched method calls per character.

> I could have the lexer signal to the stream when the switch is needed to
> remove one of those, at least.
> 
> Or am I over-optimizing here, is lexer already doing way more on every
> character than I'm talking about here? I am going to be running into some
> significantly large files, so I'd like to avoid overhead wherever I can...

For parsing large files, I would worry more about memory. ANTLR lexer/
parsers are quite memory-hungry, and typically almost nothing can be gc'd
until the input is completely parsed and the CharStream and TokenStream
objects have been discarded.

(FWIW, I think most programmers systematically overestimate the performance
effect of running additional code, and underestimate the effect of memory
usage. The latter can absolutely kill performance if it leads to swapping.)

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From sokorac at gmail.com  Wed Aug 26 20:03:05 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Wed, 26 Aug 2009 23:03:05 -0400
Subject: [antlr-interest] Tokens that span across char streams
In-Reply-To: <4A95EFB7.9040909@jacaranda.org>
References: <f6be20450908261257p3d2bc252s5e222517a153cb60@mail.gmail.com>
	<4a95aa76.1108c00a.0a22.ffffb14eSMTPIN_ADDED@mx.google.com>
	<f6be20450908261505w87e8edbjc9ef78c3d5486f39@mail.gmail.com>
	<4A95D3F2.3080901@jacaranda.org>
	<f6be20450908261830v118c2e40mb3a5010f1b3aaa3@mail.gmail.com>
	<4A95EFB7.9040909@jacaranda.org>
Message-ID: <f6be20450908262003g37d34762q40c95f3766ba3396@mail.gmail.com>

That's very true. It's probably because performance is something that you
can have a "feel" for as you look at some code, while memory usage takes a
lot more (system-wide, sometimes) analysis to determine.

Do you have any tips on how to keep the memory usage down for large files?
And, how hungry is "quite hungry"? :) Will parsing 20,000 lines of generic
C-style code take tens, hundreds, or thousands of MBs?

Stan

On Wed, Aug 26, 2009 at 10:30 PM, David-Sarah Hopwood <
david-sarah at jacaranda.org> wrote:

> Stanislav Sokorac wrote:
> > I guess the tricky thing will be to insert this functionality without
> > significantly adding to the run time.. If the stream has to check for
> > macros, and also mux between the regular stream and the macro definition,
> > I'm adding two 'if' checks on every single character. Maybe more if I'm
> also
> > selectively updating character positions.
>
> I wouldn't worry about that. There are already several dynamically
> dispatched method calls per character.
>
> > I could have the lexer signal to the stream when the switch is needed to
> > remove one of those, at least.
> >
> > Or am I over-optimizing here, is lexer already doing way more on every
> > character than I'm talking about here? I am going to be running into some
> > significantly large files, so I'd like to avoid overhead wherever I
> can...
>
> For parsing large files, I would worry more about memory. ANTLR lexer/
> parsers are quite memory-hungry, and typically almost nothing can be gc'd
> until the input is completely parsed and the CharStream and TokenStream
> objects have been discarded.
>
> (FWIW, I think most programmers systematically overestimate the performance
> effect of running additional code, and underestimate the effect of memory
> usage. The latter can absolutely kill performance if it leads to swapping.)
>
> --
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/27b1e4ac/attachment.html 

From jeroen.v.schagen at gmail.com  Thu Aug 27 01:34:36 2009
From: jeroen.v.schagen at gmail.com (jeroen.v.schagen at gmail.com)
Date: Thu, 27 Aug 2009 08:34:36 +0000
Subject: [antlr-interest] Rewriting into nested AST nodes without recursive
	rule invocation
Message-ID: <001636c5bc3f13a03904721b7009@google.com>

Hello,

I am attempting to convert my production 'markupChain' into a nested  
hierchy of nodes. This allows me to always skip the remainder of my chain  
using a single wildcard symbol, regardless of my position in the chain.  
I've done just that in the grammar demonstrated below, however this grammar  
is not LL(*) due to recursive rule invocation.. meaning I have to enable  
backtracking.

markupChain: expression ';'
-> ^( MARKUP_CHAIN expression )
| statement
-> ^( MARKUP_CHAIN statement )
| embedding ';'
-> ^( MARKUP_CHAIN embedding )
| markup markupChain
-> ^( MARKUP_CHAIN markup markupChain )
| ';' ;

I've made the grammar LL(*) as follows:

markupChain: markup* ( ';' | expression ';' | embedding ';' | statement )

However, I am unable to specify a rewrite rule that allows me to retain my  
origional AST hierchy. Any help would be greatly appreciated!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090827/ba6e69c1/attachment.html 

From david-sarah at jacaranda.org  Thu Aug 27 11:37:20 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 19:37:20 +0100
Subject: [antlr-interest] more JSON spec questions
In-Reply-To: <op.uzah8utya3v5gv@hr-opera.oslo.opera.com>
References: <op.uzah8utya3v5gv@hr-opera.oslo.opera.com>
Message-ID: <4A96D260.9030003@jacaranda.org>

Hallvord R. M. Steen wrote:
> Hi,
> the feedback below refers to the "Initial ECMA formated ES5 draft" and
> consists of a few things I've noticed while working on a JSON test suite.
> 
> First, I think considerable work has gone into the JSON part of the spec
> since I first looked at it - it's beginning to look really good. My test
> suite is a work in progress, and of course both the tests and my
> questions might just show that there's something I haven't entirely
> understood rather than problems with the specification. Feedback is
> welcome.
> 
> Now, the questions..
> 
> 1) Apparently the grammar still disallows literal tab inside JSONString.
> Implementations that pass this test allow it:
> http://testsuites.opera.com/JSON/correctness/035.html
> - from earlier discussions I had the impression that the spec would
> change..?

The JSON spec (which isn't changing) says:

   The representation of strings is similar to conventions used in the C
   family of programming languages.  A string begins and ends with
   quotation marks.  All Unicode characters may be placed within the
   quotation marks except for the characters that must be escaped:
   quotation mark, reverse solidus, and the control characters (U+0000
   through U+001F).
   [...]

   unescaped = %x20-21 / %x23-5B / %x5D-10FFFF

Literal tab is in "U+0000 through U+001F" and therefore must be escaped,
as confirmed by the ABNF.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From parrt at cs.usfca.edu  Thu Aug 27 11:44:21 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 27 Aug 2009 11:44:21 -0700
Subject: [antlr-interest] what's in a name?
Message-ID: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>

Hi, so we're going back and forth on titles/subtitles for the new book  
on implementing DSLs and other languages.  Now, we're "Language Design  
Patterns", where Design is an adjective of Patterns; Language is not  
an adj of Design.  it's ambiguous though. Using Lang Impl Design  
Patterns was too long and unwieldy.  So, we added a subtitle about  
"Techniques for implementing DSLs".  Our marketing has been all about  
impl DSLs but the book became much more general.

The confusion is that the current title can be seen as about lang  
design.  We could do Lang Impl Patterns, but Kent Beck has a Impl  
Patterns book now that is totally different concept.

Publisher wants DSL in there somewhere.  Any ideas about title/subtitle?

Ter

From ian at telematter.com  Thu Aug 27 12:43:36 2009
From: ian at telematter.com (Ian Eyberg)
Date: Thu, 27 Aug 2009 14:43:36 -0500
Subject: [antlr-interest] misunderstanding channel HIDDEN
References: <20090826181349.GA11840@mhu>
Message-ID: <20090827194336.GA19792@mhu>

Thanks everyone,

  took a tad bit of reading and lots of cursing
but I eventually got it to do this:

basically I removed the refs. to the UCODE rule
in my grammars.

I set antlrinputstream to receive "UTF8"

  ANTLRInputStream input = new ANTLRInputStream(sin, "UTF-8");

and I rewrite my UTF-16 as UTF-8 if I find it
in my incoming files before I parse it..

  try {
    FileInputStream fis = new FileInputStream(args[args.length-1]);
    byte[] contents = new byte[fis.available()];
    fis.read(contents, 0, contents.length);

    if ( (contents[0] == (byte)0xFF) && (contents[1] == (byte)0xFE) ) {
      String asString = new String(contents, "UTF-16");
      byte[] newBytes = asString.getBytes("UTF8");
      FileOutputStream fos = new FileOutputStream(args[args.length-1]);
      fos.write(newBytes);
      fos.close();
    }

    fis.close();
    } catch(Exception e) {
      e.printStackTrace();
  }


it'd be wise to go ahead and include the other common
encodings in this but this got me going to do what I 
wanted..

thanks again,
Ian

On 09:07 Thu 27 Aug     , Gavin Lambert wrote:
> At 06:13 27/08/2009, Ian Eyberg wrote:
> >I have text that looks like:
> >
> >  'b^@l^@a^@h^@'
> >
> >(most of the time the text is simply 'blah')
> >and then it should come out like this:
> >
> >  'blah'
> [...]
> >  UCODE   : '\u0000'{ $channel = HIDDEN; };
> >
> >I'm reading in through antlrinputstream as "UTF8" as I do
> >want to support multi-byte chars and I have rules to help
> >that such as:
> 
> I think you're going about this the wrong way.  The input above
> looks like UTF-16; you should detect that case and use a UTF16 file
> stream instead of a UTF8 one.  (Normally Unicode files will start
> with a BOM you can use for auto-detection.)
> 
> UTF-16 and UTF-8 encode high-order Unicode characters quite
> differently, so if your input can include them then trying to read
> it as UTF8 and just throwing away the nulls definitely isn't going
> to work.
> 

From dev at mobileink.com  Thu Aug 27 13:03:53 2009
From: dev at mobileink.com (Gregg Reynolds)
Date: Thu, 27 Aug 2009 15:03:53 -0500
Subject: [antlr-interest] what's in a name?
In-Reply-To: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <75cc17ac0908271303t5ac573y60bd836edafdf477@mail.gmail.com>

On Thu, Aug 27, 2009 at 1:44 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Hi, so we're going back and forth on titles/subtitles for the new book
> on implementing DSLs and other languages.  Now, we're "Language Design
> Patterns", where Design is an adjective of Patterns; Language is not

an adj of Design.  it's ambiguous though. Using Lang Impl Design
> Patterns was too long and unwieldy.  So, we added a subtitle about
> "Techniques for implementing DSLs".  Our marketing has been all about
> impl DSLs but the book became much more general.
>
> The confusion is that the current title can be seen as about lang
> design.  We could do Lang Impl Patterns, but Kent Beck has a Impl
> Patterns book now that is totally different concept.
>
> Publisher wants DSL in there somewhere.  Any ideas about title/subtitle?
>

Favor "engineering" or "construction" or the like over "design", and go for
something suggestive from linguistics or culture for the title.  E.g.
"Towers of Babel:  Building DSLs for a Chaotic World".  Ok, silly, but you
get the idea.

When I hear the "design", even though (or because) it covers pretty much
everything, I tend not to think of the design that goes into implementation.
 If you're really emphasizing design in implementation, maybe something that
highlights the role of design as a distinct element of engineering, e.g.
"Elements of Design in DSL Engineering" (echoing Strunk and White).

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090827/4b7de27f/attachment.html 

From parrt at cs.usfca.edu  Thu Aug 27 13:07:30 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 27 Aug 2009 13:07:30 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <75cc17ac0908271303t5ac573y60bd836edafdf477@mail.gmail.com>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<75cc17ac0908271303t5ac573y60bd836edafdf477@mail.gmail.com>
Message-ID: <DA042090-5886-478A-87D9-368B708FE9A2@cs.usfca.edu>

hi Gregg,

Mostly what I was trying to do in the title is piggyback on the famous  
gang of four design patterns book. I add the term language in front,  
and voila! Cool impressive sounding title ;)

T
On Aug 27, 2009, at 1:03 PM, Gregg Reynolds wrote:

>
> On Thu, Aug 27, 2009 at 1:44 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
> Hi, so we're going back and forth on titles/subtitles for the new book
> on implementing DSLs and other languages.  Now, we're "Language Design
> Patterns", where Design is an adjective of Patterns; Language is not  
> an adj of Design.  it's ambiguous though. Using Lang Impl Design
> Patterns was too long and unwieldy.  So, we added a subtitle about
> "Techniques for implementing DSLs".  Our marketing has been all about
> impl DSLs but the book became much more general.
>
> The confusion is that the current title can be seen as about lang
> design.  We could do Lang Impl Patterns, but Kent Beck has a Impl
> Patterns book now that is totally different concept.
>
> Publisher wants DSL in there somewhere.  Any ideas about title/ 
> subtitle?
>
> Favor "engineering" or "construction" or the like over "design", and  
> go for something suggestive from linguistics or culture for the  
> title.  E.g. "Towers of Babel:  Building DSLs for a Chaotic World".   
> Ok, silly, but you get the idea.
>
> When I hear the "design", even though (or because) it covers pretty  
> much everything, I tend not to think of the design that goes into  
> implementation.  If you're really emphasizing design in  
> implementation, maybe something that highlights the role of design  
> as a distinct element of engineering, e.g. "Elements of Design in  
> DSL Engineering" (echoing Strunk and White).
>
> -g
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From s.barnett-cormack at lancaster.ac.uk  Thu Aug 27 13:25:52 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 27 Aug 2009 21:25:52 +0100
Subject: [antlr-interest] what's in a name?
In-Reply-To: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <4A96EBD0.3000204@lancaster.ac.uk>

Terence Parr wrote:
> Hi, so we're going back and forth on titles/subtitles for the new book  
> on implementing DSLs and other languages.  Now, we're "Language Design  
> Patterns", where Design is an adjective of Patterns; Language is not  
> an adj of Design.  it's ambiguous though. Using Lang Impl Design  
> Patterns was too long and unwieldy.  So, we added a subtitle about  
> "Techniques for implementing DSLs".  Our marketing has been all about  
> impl DSLs but the book became much more general.
> 
> The confusion is that the current title can be seen as about lang  
> design.  We could do Lang Impl Patterns, but Kent Beck has a Impl  
> Patterns book now that is totally different concept.
> 
> Publisher wants DSL in there somewhere.  Any ideas about title/subtitle?

I love the "design pattern" element, as it is following the same feeling 
as design patterns - and you'd hardly be the first to port the idea to 
another domain.

I guess the problem is that "language design patterns" sounds like 
you're designing languages. How about "Design Patterns for Language 
Implementation", or are we *not* excluding langauge design, just wanting 
to make sure it's clear that implementation is there as well?

-- 
Sam Barnett-Cormack

From a.serebrenik at tue.nl  Thu Aug 27 13:34:26 2009
From: a.serebrenik at tue.nl (Serebrenik, A.)
Date: Thu, 27 Aug 2009 22:34:26 +0200
Subject: [antlr-interest] SLE 2009 Denver Colorado - Call for participation
Message-ID: <7DF2365FF07C0E4E89419D65CCC93C9E0160CFC4F804@EXCHANGE11.campus.tue.nl>


___________________________________________________________

                  Call for Participation - SLE 2009

 2nd International Conference on Software Language Engineering

                     http://planet-sl.org/sle2009
                 Denver, Colorado, October 5-6, 2009



____________________________________________________________

           Co-located with 12th International Conference on
    Model-Driven Engineering Languages and Systems (MODELS 2009)
                and 8th International Conference on
     Generative Programming and Component Engineering (GPCE 2009)


Highlights:
- Research Program:   15 research papers, 6 short papers and 2 tool demos
                      (program listed below)
- Keynote Speakers:   Jean Bezivin and James Cordy
- Early Registration: Open until Sept 14, 2008


Conference
----------

The 2nd International Conference on Software Language Engineering (SLE)
is devoted to topics related to artificial languages in software
engineering. SLE's foremost mission is to encourage and organize
communication between communities that have traditionally looked
at software languages from different, more specialized, and yet
complementary perspectives. SLE emphasizes the fundamental notion
of languages as opposed to any realization in specific "technical
spaces". SLE 2009 will be co-located with the 12th IEEE/ACM
International Conference on Model-Driven Engineering Languages and
Systems (MODELS 2009) and  8th International Conference on
Generative Programming and Component Engineering (GPCE 2009).



Scope
-----

The term 'software language' comprises all sorts of artificial
languages used in software development, including general-purpose
programming languages, domain-specific languages, modeling and
meta-modeling languages, data models, and ontologies. Used in its
broadest sense, examples include modeling languages such as
UML-based and domain-specific modeling languages, business process
modeling languages, and web application modeling languages.  The
term 'software language' also comprises APIs and collections of
design patterns that are implicitly defined languages.

Software language engineering is the application of a systematic,
disciplined, quantifiable approach to the development, use, and
maintenance of these languages. Thus, the SLE conference is
concerned with all phases of the life cycle of software languages;
these include the design, implementation, documentation, testing,
deployment, evolution, recovery, and retirement of languages. Of
special interest are tools, techniques, methods and formalisms that
support these activities. In particular, tools are often based on
or even automatically generated from a formal description of the
language. Hence, of special interest is the treatment of language
descriptions as software artifacts, akin to programs - while paying
attention to the special status of language descriptions, subject
to tailored engineering principles and methods for modularization,
refactoring, refinement, composition, versioning, co-evolution,
and analysis.


Accepted Papers
---------------

Research Papers
    * August Schwerdfeger and Eric Van Wyk. Verifiable Parse
       Table Composition for Deterministic Parsing
    * Fr?d?ric Mallet, Francois Lagarde, Charles Andr?, Sebastien
       Gerard and Francois Terrier. An Automated Process for
       implementing Multi-level domain models
    * Krzysztof Czarnecki, Thiago Tonelli Bartolomei, Ralf Laemmel
       and Tijs van der Storm. Transcript of an API migration for
       two XML APIs
    * Lukas Renggli, Marcus Denker and Oscar Nierstrasz.
       Language Boxes: Bending the Host Language with Modular
       Language Changes
    * Maartje de Jonge, Emma Nilsson-Nyman, Lennart C. L. Kats
       and Eelco Visser. Natural and Flexible Error Recovery for
       Generated Parsers
    * Markus Herrmannsdoerfer, Daniel Ratiu and Guido Wachsmuth.
       Language Evolution in Practice: The History of GMF
    * Mathieu Acher, Philippe Collet, Philippe Lahire and
       Robert France.  Composing Feature Models
    * Mauricio Alferez, Jo?o Santos, Ana Moreira, Alessandro
       Garcia, Uir? Kulesza, Jo?o Ara?jo and Vasco Amaral.
       Multi-View Composition Language for Software Product
       Line Requirements
    * Nils Thieme, Christian Wende and Steffen Zschaler.
       A Role-based Approach Towards Modular Language
       Engineering
    * Steffen Zschaler, Dimitrios Kolovos, Nicholas Drivalos,
       Richard Paige and Awais Rashid. Domain-Specific
       Metamodelling Languages for Software Language Engineering
    * Steffen Zschaler, Pablo Sanchez, Joao Santos, Mauricio
       Alferez, Awais Rashid, Lidia Fuentes, Ana Moreira, Joao
       Araujo and Uira Kulesza. VML* -- A Family of Languages
       for Variability Management in Software Product Lines
    * Tihamer Levendovszky, Anantha Narayanan, Daniel
       Balasubramanian and Gabor Karsai. A Novel Approach to
       Semi-Automated Evolution of DSML Model Transformation
    * Tim Bauer and Martin Erwig.  Declarative Scripting in
       Haskell
    * Uwe Jugel. Generating Smart Wrapper Libraries for Arbitrary
       APIs
    * Zef Hemel and Eelco Visser. PIL: A Platform Independent
       Language for Retargetable DSLs

Short papers

    * Anya Helene Bagge. Yet Another Language Extension Scheme
    * Daniel Spiewak and Tian Zhao.  ScalaQL: Language-Integrated
       Database Queries for Scala
    * Danny M. Groenewegen and Eelco Visser. Integration of Data
       Validation and User Interface Concerns in a DSL for Web
       Applications
    * Ivan Kurtev and Alfons Laarman. Ontological Metamodeling with
       Explicit Instantiation
    * Jer?nimo Iraz?bal and Claudia Pons. Model transformation
       languages relying on models as ADTs
    * Paul Laird and Stephen Barrett. Towards the Dynamic
       Evolution of Domain Specific Languages

Tools

    * Elina Kalnina, Audris Kalnins, Edgars Celms and Agris
       Sostaks. Graphical template language for transformation
       synthesis
    * Florian Heidenreich, Jendrik Johannes, Mirko Seifert and
       Christian Wende. Closing the Gap between Modelling and Java


Registration
------------
Registration is open now. Early bird registration is open until Sept 14.
Regitration is available at:

     https://register.cce.umn.edu/Course.pl?sect_key=183427


Keynote Speakers
----------------

  * James Cordy, Queens University, Canada
  * Jean Bezivin, INRIA & Ecole des Mines de Nantes, France

Organization
------------
Steering Committee
  * Mark van den Brand, TU Eindhoven, The Netherlands
  * James Cordy, Queen's University, Canada
  * Jean-Marie Favre, University of Grenoble, France
  * Dragan Gasevic, Athabasca University, Canada
  * Gorel Hedin, Lund University, Sweden
  * Ralf Laemmel, Universitat Koblenz-Landau, Germany
  * Eric Van Wyk, University of Minnesota, USA
  * Andreas Winter, Johannes Gutenberg-Universitat Mainz, Germany

General Chair
 * Dragan Gasevic, Athabasca University, Canada

Program Committee Co-Chairs
 * Mark van den Brand, TU Eindhoven, The Netherlands
 * Jeff Gray, University of Alabama at Birmingham, USA

Program Committee
 * Colin Atkinson, Universit?t Mannheim, Germany
 * Don Batory, University of Texas at Austin, USA
 * Paulo Borba, Universidade Federal de Pernambuco, Brazil
 * John Boyland, University of Wisconsin, Milwaukee, USA
 * Marco Brambilla, Politecnico di Milano, Italy
 * Shigeru Chiba, Tokyo Institute of Technology, Japan
 * Charles Consel, LaBRI / INRIA, France
 * Gregor Engels, Universit?t Paderborn, Germany
 * Stephen A. Edwards, Columbia University, USA
 * Robert Fuhrer, IBM T.J. Watson Research, USA
 * Martin Gogolla, University of Bremen, Germany
 * Giancarlo Guizzardi, Federal University of Esp?rito Santo, Brazil
 * Reiko Heckel, University of Leicester, UK
 * Fr?d?ric Jouault, INRIA & Ecole des Mines de Nantes, France
 * Nicholas Kraft, University of Alabama, USA
 * Thomas K?hne, Victoria University of Wellington, New Zealand
 * Julia Lawall, University of Copenhagen, Denmark
 * Timothy Lethbridge, University Ottawa, Canada
 * Brian Malloy, Clemson University, USA
 * Kim Mens, Universit? catholique de Louvain, Belgium
 * Marjan Mernik, University of Maribor, Slovenia
 * Todd Millstein, University of California, Los Angeles, USA
 * Pierre-Etienne Moreau, INRIA Nancy - Grand Est, France
 * Pierre-Alain Muller, University of Haute-Alsace, France
 * Daniel Oberle, SAP Research, Germany
 * Richard Paige, University of York, UK
 * James Power, National University of Ireland, Ireland
 * Jo?o Saraiva, Universidade do Minho, Portugal
 * Mary Lou Soffa, University of Virginia, USA
 * Juha-Pekka Tolvanen, MetaCase, Finland
 * Alexander Serebrenik, Eindhoven University of Technology, Netherlands
 * Tony Sloane, Macquarie University, Australia
 * Steffen Staab, Universit?t Koblenz-Landau, Germany
 * Jun Suzuki, University of Massachusetts, Boston, USA
 * Walid Taha, Rice University, USA
 * Eli Tilevich, Virginia Tech, USA
 * Jurgen Vinju, CWI, Netherlands
 * Eelco Visser, Delft University of Technology, Netherlands
 * Ren? Witte, Concordia University, Canada

Organization Committee
 * Bardia Mohabbati, Simon Fraser University, Canada (Web Chair)
 * James Hill, Vanderbilt University, USA (Publicity co-Chair)
 * Alexander Serebrenik, TU Eindhoven, The Netherlands (Publicity co-Chair)
 * Eric Van Wyk, University of Minnesota (Finance Chair)

From parrt at cs.usfca.edu  Thu Aug 27 13:37:36 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 27 Aug 2009 13:37:36 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <4A96EBD0.3000204@lancaster.ac.uk>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
Message-ID: <958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>

> I love the "design pattern" element, as it is following the same  
> feeling
> as design patterns - and you'd hardly be the first to port the idea to
> another domain.

yep :)

> I guess the problem is that "language design patterns" sounds like
> you're designing languages.

yeah, it's ambiguous. we could add a hyphen but... ugly

> How about "Design Patterns for Language
> Implementation", or are we *not* excluding langauge design, just  
> wanting
> to make sure it's clear that implementation is there as well?

Yeah, we sort of went that direction but something short. I really do  
like the three word title. We are then doing the implementation stuff  
in the subtitle at the moment. I guess that would be clear if the  
subtitle has the implementation word.
T

From s.barnett-cormack at lancaster.ac.uk  Thu Aug 27 14:07:42 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 27 Aug 2009 22:07:42 +0100
Subject: [antlr-interest] what's in a name?
In-Reply-To: <958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
	<958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
Message-ID: <4A96F59E.70904@lancaster.ac.uk>

Terence Parr wrote:
>> I love the "design pattern" element, as it is following the same feeling
>> as design patterns - and you'd hardly be the first to port the idea to
>> another domain.
> 
> yep :)
> 
>> I guess the problem is that "language design patterns" sounds like
>> you're designing languages.
> 
> yeah, it's ambiguous. we could add a hyphen but... ugly
> 
>> How about "Design Patterns for Language
>> Implementation", or are we *not* excluding langauge design, just wanting
>> to make sure it's clear that implementation is there as well?
> 
> Yeah, we sort of went that direction but something short. I really do 
> like the three word title. We are then doing the implementation stuff in 
> the subtitle at the moment. I guess that would be clear if the subtitle 
> has the implementation word.

Three words is a great idea, but I'd sooner see another book later that 
really *is* about designing DSLs, and there'd be concept confusion with 
titles. It's awkward. Language Design Patterns is a little snappier than 
Design Patterns for Language Implementation, I'll admit, and replacing 
language with more implementations-specific words like "parser" is bad 
as it changes the emphasis to sound like it's about ANTLR "under the 
hood". Of course, there's always that word - ANTLR.

Seriously, ANTLR Design Patterns, and then a subtitle much as you've 
already mentioned. Sure, people won't be as likely to pick it up if 
they're not aware of ANTLR, but not many who pick it up will fail to put 
it down if they don't know of ANTLR anyway, unless you sell it 
differently. The only sort of book that sold ANTLR to 
non-ANTLR-aware-people would be a real newbie-level type thing 
introducing all of the concepts in tutorial fashion (like the difference 
between O'Reilly 'Learning ~' books and '~ in a Nutshell' books - ANTLR 
Reference is like a Nutshell). Of course, now I'm selling a concept for 
a third book...

So I think ANTLR Design Patterns - Techniques and Strategies for 
Language Implementation. Add "Domain Specific" before "Language" if the 
publishers are so keen on the buzzwords. Where do you draw the line on a 
DSL anyway?

-- 
Sam Barnett-Cormack

From antlr at mirality.co.nz  Thu Aug 27 14:11:30 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 28 Aug 2009 09:11:30 +1200
Subject: [antlr-interest] what's in a name?
In-Reply-To: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <20090827211159.ECE7B3418517@www.antlr.org>

At 06:44 28/08/2009, Terence Parr wrote:
 >Hi, so we're going back and forth on titles/subtitles for the 
new
 >book on implementing DSLs and other languages.  Now, we're
 >"Language Design Patterns", where Design is an adjective of
 >Patterns; Language is not an adj of Design.  it's ambiguous
 >though. Using Lang Impl Design Patterns was too long and 
unwieldy.
[...]
 >Publisher wants DSL in there somewhere.  Any ideas about
 >title/subtitle?

You could always go with the more prosaic "Domain Specific 
Languages using ANTLR" or "Implementing Domain Specific Languages 
with ANTLR".

Another idea: "ANTLR DSL Patterns" (or expanding DSL out).


From parrt at cs.usfca.edu  Thu Aug 27 14:13:01 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 27 Aug 2009 14:13:01 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <20090827211159.ECE7B3418517@www.antlr.org>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<20090827211159.ECE7B3418517@www.antlr.org>
Message-ID: <869EEB07-A427-4EDC-9F00-761DB63602D3@cs.usfca.edu>

Well, you could use these patterns with any tool, not just antlr.  
trying to avoid making it to specific.
T
On Aug 27, 2009, at 2:11 PM, Gavin Lambert wrote:

> At 06:44 28/08/2009, Terence Parr wrote:
>> Hi, so we're going back and forth on titles/subtitles for the
> new
>> book on implementing DSLs and other languages.  Now, we're
>> "Language Design Patterns", where Design is an adjective of
>> Patterns; Language is not an adj of Design.  it's ambiguous
>> though. Using Lang Impl Design Patterns was too long and
> unwieldy.
> [...]
>> Publisher wants DSL in there somewhere.  Any ideas about
>> title/subtitle?
>
> You could always go with the more prosaic "Domain Specific
> Languages using ANTLR" or "Implementing Domain Specific Languages
> with ANTLR".
>
> Another idea: "ANTLR DSL Patterns" (or expanding DSL out).
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From parrt at cs.usfca.edu  Thu Aug 27 14:26:47 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 27 Aug 2009 14:26:47 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <4A96F59E.70904@lancaster.ac.uk>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
	<958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
	<4A96F59E.70904@lancaster.ac.uk>
Message-ID: <85762619-9161-4D48-B6CA-5A03DCF6694D@cs.usfca.edu>


On Aug 27, 2009, at 2:07 PM, Sam Barnett-Cormack wrote:
> Three words is a great idea, but I'd sooner see another book later  
> that really *is* about designing DSLs, and there'd be concept  
> confusion with titles.

that is true; unfortunately I'm not really qualified to write that  
book ;)  Well, not if we're talking about programming languages too.

> It's awkward. Language Design Patterns is a little snappier than  
> Design Patterns for Language Implementation, I'll admit,

yup. snappy is good :)

> and replacing language with more implementations-specific words like  
> "parser" is bad as it changes the emphasis to sound like it's about  
> ANTLR "under the hood". Of course, there's always that word - ANTLR.
>
> Seriously, ANTLR Design Patterns, and then a subtitle much as you've  
> already mentioned.

yeah, trying to make it as general as possible.

> Sure, people won't be as likely to pick it up if they're not aware  
> of ANTLR, but not many who pick it up will fail to put it down if  
> they don't know of ANTLR anyway, unless you sell it differently. The  
> only sort of book that sold ANTLR to non-ANTLR-aware-people would be  
> a real newbie-level type thing introducing all of the concepts in  
> tutorial fashion (like the difference between O'Reilly 'Learning ~'  
> books and '~ in a Nutshell' books - ANTLR Reference is like a  
> Nutshell). Of course, now I'm selling a concept for a third book...

I'm not sure about this. There is a giant hole in the market sitting  
between the Dragon book and a number of language implementation books  
that use scheme instead of a language programmers use everyday.   
people can use this without ANTLR no problem. As I point out in the  
book, when you were learning to fly there's no choice but to pick an  
airplane. Later you can transfer your skills easily to another aircraft.

> So I think ANTLR Design Patterns - Techniques and Strategies for  
> Language Implementation. Add "Domain Specific" before "Language" if  
> the publishers are so keen on the buzzwords. Where do you draw the  
> line on a DSL anyway?

a tough question. yeah, making titles is really really hard.

T

From jimi at temporal-wave.com  Thu Aug 27 14:31:39 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 27 Aug 2009 16:31:39 -0500
Subject: [antlr-interest] what's in a name?
In-Reply-To: <958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
	<958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
Message-ID: <94CE4DB3-2FC0-4854-B82B-5D115E421B8C@temporal-wave.com>

Language : Design Patterns ;

:)

Jim

On Aug 27, 2009, at 3:37 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

>> I love the "design pattern" element, as it is following the same
>> feeling
>> as design patterns - and you'd hardly be the first to port the idea  
>> to
>> another domain.
>
> yep :)
>
>> I guess the problem is that "language design patterns" sounds like
>> you're designing languages.
>
> yeah, it's ambiguous. we could add a hyphen but... ugly
>
>> How about "Design Patterns for Language
>> Implementation", or are we *not* excluding langauge design, just
>> wanting
>> to make sure it's clear that implementation is there as well?
>
> Yeah, we sort of went that direction but something short. I really do
> like the three word title. We are then doing the implementation stuff
> in the subtitle at the moment. I guess that would be clear if the
> subtitle has the implementation word.
> T
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From s.barnett-cormack at lancaster.ac.uk  Thu Aug 27 14:34:34 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 27 Aug 2009 22:34:34 +0100
Subject: [antlr-interest] what's in a name?
In-Reply-To: <869EEB07-A427-4EDC-9F00-761DB63602D3@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>	<20090827211159.ECE7B3418517@www.antlr.org>
	<869EEB07-A427-4EDC-9F00-761DB63602D3@cs.usfca.edu>
Message-ID: <4A96FBEA.6090102@lancaster.ac.uk>

Terence Parr wrote:
> Well, you could use these patterns with any tool, not just antlr.  
> trying to avoid making it to specific.

"Language Recognition Design Patterns"

Still feels punchy, more so than "Language Implementation Design Patterns"

I still think "Language Design Patterns" is misleading, really, as it's 
not really about the languages, it's about recognisers and other 
implementation issues. It's design, in the sense of the design of the 
recogniser.

-- 
Sam Barnett-Cormack

From parrt at cs.usfca.edu  Thu Aug 27 14:41:11 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 27 Aug 2009 14:41:11 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <94CE4DB3-2FC0-4854-B82B-5D115E421B8C@temporal-wave.com>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
	<958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
	<94CE4DB3-2FC0-4854-B82B-5D115E421B8C@temporal-wave.com>
Message-ID: <AA4AFE8D-DAF3-4FF2-9B0B-9C811D0A2A30@cs.usfca.edu>

ha!
T
On Aug 27, 2009, at 2:31 PM, Jim Idle wrote:

> Language : Design Patterns ;
>
> :)


From parrt at cs.usfca.edu  Thu Aug 27 14:42:09 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 27 Aug 2009 14:42:09 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <4A96FBEA.6090102@lancaster.ac.uk>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>	<20090827211159.ECE7B3418517@www.antlr.org>
	<869EEB07-A427-4EDC-9F00-761DB63602D3@cs.usfca.edu>
	<4A96FBEA.6090102@lancaster.ac.uk>
Message-ID: <99DABB55-72E8-43D2-A396-30EBA6F5FFD9@cs.usfca.edu>


On Aug 27, 2009, at 2:34 PM, Sam Barnett-Cormack wrote:

> Terence Parr wrote:
>> Well, you could use these patterns with any tool, not just antlr.   
>> trying to avoid making it to specific.
>
> "Language Recognition Design Patterns"
>
> Still feels punchy, more so than "Language Implementation Design  
> Patterns"

well, we do a lot of analysis, translation, and code generation so  
that's not very inclusive.
>
> I still think "Language Design Patterns" is misleading, really, as  
> it's not really about the languages, it's about recognisers and  
> other implementation issues. It's design, in the sense of the design  
> of the recogniser.

If you assume that design is an adjective the patterns, then it is a  
perfect title. oh well.

T

From brothers at bros.com  Thu Aug 27 14:48:53 2009
From: brothers at bros.com (Dennis Brothers)
Date: Thu, 27 Aug 2009 17:48:53 -0400
Subject: [antlr-interest] what's in a name?
In-Reply-To: <AA4AFE8D-DAF3-4FF2-9B0B-9C811D0A2A30@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
	<958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
	<94CE4DB3-2FC0-4854-B82B-5D115E421B8C@temporal-wave.com>
	<AA4AFE8D-DAF3-4FF2-9B0B-9C811D0A2A30@cs.usfca.edu>
Message-ID: <5691BD29-179A-480E-B4AB-044A48B41CBE@bros.com>

As has been pointed out, it's _not_ a language you're designing, it's  
(almost always) a compiler or interpreter.  It's awkward, but how  
about "Compiler/Interpreter Design Patterns"?  ("Parser Design  
Patterns" is probably too techie to grab the widest audience).

     - Dennis

On Aug 27, 2009, at 5:41 PM, Terence Parr wrote:

> ha!
> T
> On Aug 27, 2009, at 2:31 PM, Jim Idle wrote:
>
>> Language : Design Patterns ;
>>
>> :)
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>


From gwlist at grahamwideman.com  Thu Aug 27 14:55:36 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Thu, 27 Aug 2009 14:55:36 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <5691BD29-179A-480E-B4AB-044A48B41CBE@bros.com>
References: <AA4AFE8D-DAF3-4FF2-9B0B-9C811D0A2A30@cs.usfca.edu>
	<1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
	<958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>
	<94CE4DB3-2FC0-4854-B82B-5D115E421B8C@temporal-wave.com>
	<AA4AFE8D-DAF3-4FF2-9B0B-9C811D0A2A30@cs.usfca.edu>
Message-ID: <4.1.20090827145055.016eba98@grahamwideman.com>

Hi Ter,

I'm glad you're bringing up the book title issue -- I had wanted to mention it but figured that it was already locked down. Apparently not.

First, I concur that the existing title does not do the book justice, it's not about the Design Patterns in Languages themselves.

Now what to do.

-- The book is not very much limited to DSLs per se either, (see the examples given in "Dissecting a few applications" p10, none are DSLs) so that doesn't belong in the title. The material could certainly be used for processing DSLs, so that could go in the subtitle, (but should be spelled out, because it's not that common or unique of an acronym.)

-- If there's a stong preference for a three word title, then part of the problem is that you're using up two of them with "Design Patterns", in an effort to piggyback on GoF. (GoF were following Christopher Alexander's A Pattern Language -- there the pattern business only gets one word!).

Perhaps just "Patterns" is sufficient to make the connection to GoF and followers.

What the book is almost entirely about is how to build Language Processors.

So how about:

"Language Processor Patterns"  or "Patterns in Language Processing" (3.5 words :-)

But if the Patterns business can be placed in the subtitle:

"Building Language Processors
Design patterns for building software that processes languages"

Or even

"Building Language Processors
Design patterns for building software that processes languages large and small"

Or, including (but not limiting to) the DSL aspect:

"Building Language Processors
Design patterns for building software that processes general and domain-specific languages"

Ie: I think an important hook word is "building" -- it conveys that this book is going to empower the reader to actually get something done.

-- Graham





From s.barnett-cormack at lancaster.ac.uk  Thu Aug 27 14:57:02 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 27 Aug 2009 22:57:02 +0100
Subject: [antlr-interest] what's in a name?
In-Reply-To: <99DABB55-72E8-43D2-A396-30EBA6F5FFD9@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>	<20090827211159.ECE7B3418517@www.antlr.org>	<869EEB07-A427-4EDC-9F00-761DB63602D3@cs.usfca.edu>	<4A96FBEA.6090102@lancaster.ac.uk>
	<99DABB55-72E8-43D2-A396-30EBA6F5FFD9@cs.usfca.edu>
Message-ID: <4A97012E.2090500@lancaster.ac.uk>

Terence Parr wrote:
> On Aug 27, 2009, at 2:34 PM, Sam Barnett-Cormack wrote:
>> I still think "Language Design Patterns" is misleading, really, as  
>> it's not really about the languages, it's about recognisers and  
>> other implementation issues. It's design, in the sense of the design  
>> of the recogniser.
> 
> If you assume that design is an adjective the patterns, then it is a  
> perfect title. oh well.

To me, it reads with "design patterns" as a compound noun - it seems to 
say it's design patterns for languages. And I love that design patterns 
is there.

-- 
Sam Barnett-Cormack

From s.barnett-cormack at lancaster.ac.uk  Thu Aug 27 14:59:34 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 27 Aug 2009 22:59:34 +0100
Subject: [antlr-interest] what's in a name?
In-Reply-To: <4.1.20090827145055.016eba98@grahamwideman.com>
References: <AA4AFE8D-DAF3-4FF2-9B0B-9C811D0A2A30@cs.usfca.edu>	<1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>	<4A96EBD0.3000204@lancaster.ac.uk>	<958BC83D-0AEE-40FD-8258-4BAC29A0F617@cs.usfca.edu>	<94CE4DB3-2FC0-4854-B82B-5D115E421B8C@temporal-wave.com>	<AA4AFE8D-DAF3-4FF2-9B0B-9C811D0A2A30@cs.usfca.edu>
	<4.1.20090827145055.016eba98@grahamwideman.com>
Message-ID: <4A9701C6.30607@lancaster.ac.uk>

Graham Wideman wrote:
> "Language Processor Patterns"  or "Patterns in Language Processing" (3.5 words :-)

"Language Implementation Patterns" would be lovely if it weren't for 
someone having bagged the term "implementation pattern"...

-- 
Sam Barnett-Cormack

From david-sarah at jacaranda.org  Thu Aug 27 14:59:33 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 22:59:33 +0100
Subject: [antlr-interest] misunderstanding channel HIDDEN
In-Reply-To: <20090827194336.GA19792@mhu>
References: <20090826181349.GA11840@mhu> <20090827194336.GA19792@mhu>
Message-ID: <4A9701C5.40309@jacaranda.org>

Ian Eyberg wrote:
[...]
> I set antlrinputstream to receive "UTF8"
> 
>   ANTLRInputStream input = new ANTLRInputStream(sin, "UTF-8");
> 
> and I rewrite my UTF-16 as UTF-8 if I find it
> in my incoming files before I parse it..
> 
>   try {
>     FileInputStream fis = new FileInputStream(args[args.length-1]);
>     byte[] contents = new byte[fis.available()];
>     fis.read(contents, 0, contents.length);
> 
>     if ( (contents[0] == (byte)0xFF) && (contents[1] == (byte)0xFE) ) {

You probably want to accept little-endian UTF-16 (as sometimes produced
by Windows systems) here, given that it's very easy to do:

      if ( (contents[0] == (byte)0xFF && contents[1] == (byte)0xFE) ||
           (contents[0] == (byte)0xFE && contents[1] == (byte)0xFF) ) {

The "UTF-16" encoding specified in the String constructor will use the
BOM to detect byte order, as documented at
<http://java.sun.com/javase/6/docs/api/java/nio/charset/Charset.html>.

>       String asString = new String(contents, "UTF-16");
>       byte[] newBytes = asString.getBytes("UTF8");

"UTF8" is accepted as an alias for "UTF-8", but I'd use the latter for
consistency.

>       FileOutputStream fos = new FileOutputStream(args[args.length-1]);
>       fos.write(newBytes);
>       fos.close();
>     }
> 
>     fis.close();
>     } catch(Exception e) {
>       e.printStackTrace();
>   }

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Thu Aug 27 15:02:52 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 27 Aug 2009 23:02:52 +0100
Subject: [antlr-interest] misunderstanding channel HIDDEN
In-Reply-To: <4A9701C5.40309@jacaranda.org>
References: <20090826181349.GA11840@mhu> <20090827194336.GA19792@mhu>
	<4A9701C5.40309@jacaranda.org>
Message-ID: <4A97028C.9030909@jacaranda.org>

David-Sarah Hopwood wrote:
> Ian Eyberg wrote:
>>     if ( (contents[0] == (byte)0xFF) && (contents[1] == (byte)0xFE) ) {
> 
> You probably want to accept little-endian UTF-16 (as sometimes produced
> by Windows systems) here, given that it's very easy to do:

Correction: you probably want to also accept big-endian UTF-16. Your
code above was detecting only little-endian.

>       if ( (contents[0] == (byte)0xFF && contents[1] == (byte)0xFE) ||
>            (contents[0] == (byte)0xFE && contents[1] == (byte)0xFF) ) {

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From Nicola.Musatti at objectway.it  Fri Aug 28 00:57:15 2009
From: Nicola.Musatti at objectway.it (Nicola Musatti)
Date: Fri, 28 Aug 2009 09:57:15 +0200
Subject: [antlr-interest] what's in a name?
In-Reply-To: <4779_1251398719_4A96D43E_4779_65363_1_1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <4779_1251398719_4A96D43E_4779_65363_1_1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <5136_1251446242_n7S7vFMr000692_4A978DDB.1000704@ObjectWay.it>

Terence Parr wrote:
> Hi, so we're going back and forth on titles/subtitles for the new book  
> on implementing DSLs and other languages.  Now, we're "Language Design  
> Patterns", where Design is an adjective of Patterns; Language is not  
> an adj of Design.  it's ambiguous though. Using Lang Impl Design  
> Patterns was too long and unwieldy.  So, we added a subtitle about  
> "Techniques for implementing DSLs".  Our marketing has been all about  
> impl DSLs but the book became much more general.
> 
> The confusion is that the current title can be seen as about lang  
> design.  We could do Lang Impl Patterns, but Kent Beck has a Impl  
> Patterns book now that is totally different concept.
> 
> Publisher wants DSL in there somewhere.  Any ideas about title/subtitle?

First of all, unfortunately "Language Design Patterns" is such a good 
sounding name that it makes it difficult to improve its meaning. A 
couple of suggestions:

"Language Processing Design Patterns" - Not as cute, but maybe somewhat 
more accurate

"Pattern Oriented Language Engineering" - Maybe a little too reminiscent 
of the Pattern Oriented Software Architecture series, but don't you love 
the POLE acronym? That would call for a white bear on the book cover :-)

As a subtitle you could use something like: "Implementing Domain 
Specific Languages the right way".

Cheers,
Nicola Musatti

-- 
La presente comunicazione potrebbe contenere informazioni riservate e/o protette
da segreto professionale ed e' indirizzata esclusivamente ai destinatari della
medesima qui indicati. Se avete ricevuto per errore la presente comunicazione,
siete invitati a segnalarcelo, rispondendo a questo stesso indirizzo di e-mail,
e a cancellare il presente messaggio dal Vostro sistema. E' strettamente proibito
e potrebbe essere fonte di violazione di legge qualsiasi uso, comunicazione, copia
o diffusione dei contenuti di questa comunicazione da parte di chi la abbia
ricevuta per errore o in violazione degli scopi della presente.
Il messaggio e' stato analizzato alla ricerca di virus o contenuti pericolosi
ed e' risultato NON infetto.


From martijn.reuvers at gmail.com  Fri Aug 28 01:26:26 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Fri, 28 Aug 2009 10:26:26 +0200
Subject: [antlr-interest] what's in a name?
In-Reply-To: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <c376e6ec0908280126v78921bb9w23163bb795faa112@mail.gmail.com>

What about 'Language Building Blocks'? Or maybe: 'Language Design
Building Blocks', though that's longer.

On Thu, Aug 27, 2009 at 8:44 PM, Terence Parr<parrt at cs.usfca.edu> wrote:
> Hi, so we're going back and forth on titles/subtitles for the new book
> on implementing DSLs and other languages. ?Now, we're "Language Design
> Patterns", where Design is an adjective of Patterns; Language is not
> an adj of Design. ?it's ambiguous though. Using Lang Impl Design
> Patterns was too long and unwieldy. ?So, we added a subtitle about
> "Techniques for implementing DSLs". ?Our marketing has been all about
> impl DSLs but the book became much more general.
>
> The confusion is that the current title can be seen as about lang
> design. ?We could do Lang Impl Patterns, but Kent Beck has a Impl
> Patterns book now that is totally different concept.
>
> Publisher wants DSL in there somewhere. ?Any ideas about title/subtitle?
>
> Ter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From kabnot at gmail.com  Fri Aug 28 01:42:44 2009
From: kabnot at gmail.com (stephane richard)
Date: Fri, 28 Aug 2009 10:42:44 +0200
Subject: [antlr-interest] newbie greedy option question
Message-ID: <ce2d5ab80908280142g149054e0ud6aea4c61b6e66be@mail.gmail.com>

Hi all.

I'm trying to build a simple xhtml recognizer (for whitespace
compression) in the purpose of learning antlr. Here's a sample of what
I like to match :

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>
            XHTML
            Example
        </title>
    </head>
    <body>
        <p>
            Please Choose a Day:
            <br /><br />
            <select name="day">
                <option selected="selected">Monday</option>
                <option>Tuesday</option>
                <option>Wednesday</option>
            </select>
        </p>
    </body>
</html>


This is the grammar :

grammar Html;

options {
    output=AST;
    ASTLabelType=CommonTree;
}

prog	: 	tag_element *
	;

element	:	tag_element
	| 	text_element
	;

tag_element
	: 	open_tag element* close_tag
	|	empty_tag
	;

open_tag:	OPEN_TAG name attribute* CLOSE_TAG
	;
	
close_tag
	:	OPEN_TAG '/' name CLOSE_TAG
	;

empty_tag
	:	OPEN_TAG name '/' CLOSE_TAG
	;

attribute
	:	namespace? ID '=' '"' (options{greedy=false;}: .)* '"'
	;

namespace
	:	ID ':'
	;


name	:	ID
	;
text_element	
	:	(~(OPEN_TAG) | WS)+
	;


ID  		: ('a'..'z'|'A'..'Z')+ ;
INT		: '0'..'9'+ ;
NEWLINE		: '\r'? '\n' ;
WS 		: (' '|'\t'|'\n'|'\r')+ {skip();} ;
OPEN_TAG	: '<';
CLOSE_TAG	: '>';


My problem is with the text_element rule. I'd like to match everything
until the recognizer find a OPEN_TAG, including whitespaces. While the
actuale rule work, this give me this error :

[10:32:12] warning(200): Html.g:43:21: Decision can match input such
as "WS" using multiple alternatives: 1, 2, 3
As a result, alternative(s) 3,2 were disabled for that input
[10:32:12] warning(200): Html.g:43:21: Decision can match input such
as "{CLOSE_TAG..ID, INT..':'}" using multiple alternatives: 1, 3
As a result, alternative(s) 3 were disabled for that input
[10:32:12] error(201): Html.g:43:21: The following alternatives can
never be matched: 2

How could I handle this case properly ?

Regard,
Kabnot

From antlr at mirality.co.nz  Fri Aug 28 02:23:39 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 28 Aug 2009 21:23:39 +1200
Subject: [antlr-interest] newbie greedy option question
In-Reply-To: <ce2d5ab80908280142g149054e0ud6aea4c61b6e66be@mail.gmail.co
 m>
References: <ce2d5ab80908280142g149054e0ud6aea4c61b6e66be@mail.gmail.com>
Message-ID: <20090828092410.B1DE4341814F@www.antlr.org>

At 20:42 28/08/2009, stephane richard wrote:
 >text_element	
 >	:	(~(OPEN_TAG) | WS)+
 >	;
[...]
 >NEWLINE		: '\r'? '\n' ;
 >WS 		: (' '|'\t'|'\n'|'\r')+ {skip();} ;

Given that you are skipping whitespace (although not individual 
newlines for some bizarre reason), there is no possible way that a 
WS could be matched in the text_element parser rule (which is what 
the "following alternatives can never be matched" error was 
about).

Even if that wasn't the case, since WS would already be included 
in the set of tokens that aren't OPEN_TAG, specifying it at all is 
completely redundant.

If you changed the text_element rule to this then it would 
eliminate most or all of the errors, and function equivalently 
(though I'm not sure if that behaviour is what you really want):

text_element : (~OPEN_TAG)+ ;


From tom at atlassian.com  Fri Aug 28 04:16:25 2009
From: tom at atlassian.com (Tom Davies)
Date: Fri, 28 Aug 2009 21:16:25 +1000
Subject: [antlr-interest] what's in a name?
In-Reply-To: <4A96EBD0.3000204@lancaster.ac.uk>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
Message-ID: <904B38E3-06CA-4EC2-AD61-3C89EA8708DE@atlassian.com>

On 28/08/2009, at 6:25 AM, Sam Barnett-Cormack wrote:
> you'd hardly be the first to port the idea to
> another domain.

Someone's even done it with Architecture (he uses the term to refer to  
buildings, not computer systems too -- doubly confusing!)

I like "Programming Language Construction : Patterns for Parsing,  
Interpreting and Compiling DSLs" (I would not mention DSLs if your  
publisher wasn't insisting)

Tom

--
ATLASSIAN - http://www.atlassian.com
Our products help over 8,500 customers in more than 95 countries to  
collaborate


From gwlist at grahamwideman.com  Fri Aug 28 04:37:42 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Fri, 28 Aug 2009 04:37:42 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <904B38E3-06CA-4EC2-AD61-3C89EA8708DE@atlassian.com>
References: <4A96EBD0.3000204@lancaster.ac.uk>
	<1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A96EBD0.3000204@lancaster.ac.uk>
Message-ID: <4.1.20090828043355.016620f0@grahamwideman.com>

At 8/28/2009 09:16 PM, Tom Davies wrote:
>On 28/08/2009, at 6:25 AM, Sam Barnett-Cormack wrote:
>> you'd hardly be the first to port the idea to
>> another domain.
>
>Someone's even done it with Architecture (he uses the term to refer to  
>buildings, not computer systems too -- doubly confusing!)

You are likely refering to "A Pattern Language" by Christopher Alexander and co, 1977. (A lovely book in my opinion!)  This is the book that started this usage of the word "pattern". So any confusion is attributable to the Johnny-come-lately software folks :-).

-- Graham

From jimi at temporal-wave.com  Fri Aug 28 05:18:41 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 28 Aug 2009 07:18:41 -0500
Subject: [antlr-interest] newbie greedy option question
In-Reply-To: <ce2d5ab80908280142g149054e0ud6aea4c61b6e66be@mail.gmail.com>
References: <ce2d5ab80908280142g149054e0ud6aea4c61b6e66be@mail.gmail.com>
Message-ID: <7F6CE036-23FF-45A6-A3E6-70476E0F7BF4@temporal-wave.com>

I suggest that you do not pick XHTML as your first grammar as it is  
too convoluted and you will get frustrated. Read the getting started  
guides on the wiki. I see othrs have answered these specific things.

Jim

On Aug 28, 2009, at 3:42 AM, stephane richard <kabnot at gmail.com> wrote:

> Hi all.
>
> I'm trying to build a simple xhtml recognizer (for whitespace
> compression) in the purpose of learning antlr. Here's a sample of what
> I like to match :
>
> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
>    <head>
>        <title>
>            XHTML
>            Example
>        </title>
>    </head>
>    <body>
>        <p>
>            Please Choose a Day:
>            <br /><br />
>            <select name="day">
>                <option selected="selected">Monday</option>
>                <option>Tuesday</option>
>                <option>Wednesday</option>
>            </select>
>        </p>
>    </body>
> </html>
>
>
> This is the grammar :
>
> grammar Html;
>
> options {
>    output=AST;
>    ASTLabelType=CommonTree;
> }
>
> prog    :    tag_element *
>    ;
>
> element    :    tag_element
>    |    text_element
>    ;
>
> tag_element
>    :    open_tag element* close_tag
>    |    empty_tag
>    ;
>
> open_tag:    OPEN_TAG name attribute* CLOSE_TAG
>    ;
>
> close_tag
>    :    OPEN_TAG '/' name CLOSE_TAG
>    ;
>
> empty_tag
>    :    OPEN_TAG name '/' CLOSE_TAG
>    ;
>
> attribute
>    :    namespace? ID '=' '"' (options{greedy=false;}: .)* '"'
>    ;
>
> namespace
>    :    ID ':'
>    ;
>
>
> name    :    ID
>    ;
> text_element
>    :    (~(OPEN_TAG) | WS)+
>    ;
>
>
> ID          : ('a'..'z'|'A'..'Z')+ ;
> INT        : '0'..'9'+ ;
> NEWLINE        : '\r'? '\n' ;
> WS        : (' '|'\t'|'\n'|'\r')+ {skip();} ;
> OPEN_TAG    : '<';
> CLOSE_TAG    : '>';
>
>
> My problem is with the text_element rule. I'd like to match everything
> until the recognizer find a OPEN_TAG, including whitespaces. While the
> actuale rule work, this give me this error :
>
> [10:32:12] warning(200): Html.g:43:21: Decision can match input such
> as "WS" using multiple alternatives: 1, 2, 3
> As a result, alternative(s) 3,2 were disabled for that input
> [10:32:12] warning(200): Html.g:43:21: Decision can match input such
> as "{CLOSE_TAG..ID, INT..':'}" using multiple alternatives: 1, 3
> As a result, alternative(s) 3 were disabled for that input
> [10:32:12] error(201): Html.g:43:21: The following alternatives can
> never be matched: 2
>
> How could I handle this case properly ?
>
> Regard,
> Kabnot
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From nvivo.misc at gmail.com  Fri Aug 28 06:45:08 2009
From: nvivo.misc at gmail.com (Natan)
Date: Fri, 28 Aug 2009 10:45:08 -0300
Subject: [antlr-interest] what's in a name?
In-Reply-To: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <4A97DF64.1060309@gmail.com>

Terence Parr wrote:
> The confusion is that the current title can be seen as about lang  
> design.  We could do Lang Impl Patterns, but Kent Beck has a Impl  
> Patterns book now that is totally different concept.
>
> Publisher wants DSL in there somewhere.  Any ideas about title/subtitle?
>   
I remember that discussion from the publisher website where that guy was 
asking: "Does this really teach us how to create a language?".
After that question I started to ask myself the same question, as the 
book isn't exactly what it sounds.

I would go with something with "Language Recognition Patterns" or 
"Language Parsing Patterns". Yes, its not as catchy as "Design 
Patterns", but the book isn't really about designing languages anyway. 
Also, it relates to ANTLR and what it does without adding "ANTLR" to the 
title, as you don't want it to be tool specific.

I don't think that DSL should go anywhere in the title or subtitle, 
since the techniques there can be applied to anything.



From laurent.caillette at gmail.com  Fri Aug 28 09:09:32 2009
From: laurent.caillette at gmail.com (Laurent Caillette)
Date: Fri, 28 Aug 2009 18:09:32 +0200
Subject: [antlr-interest] what's in a name?
In-Reply-To: <4A97DF64.1060309@gmail.com>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<4A97DF64.1060309@gmail.com>
Message-ID: <3b7c64070908280909l7cd96c33qd009ed91afcc55fe@mail.gmail.com>

How about:

Building Languages -
ANTLR Patterns for Domain-Specific Languages

Cheers,

c.

From dev at mobileink.com  Fri Aug 28 09:13:13 2009
From: dev at mobileink.com (Gregg Reynolds)
Date: Fri, 28 Aug 2009 11:13:13 -0500
Subject: [antlr-interest] what's in a name?
In-Reply-To: <5136_1251446242_n7S7vFMr000692_4A978DDB.1000704@ObjectWay.it>
References: <4779_1251398719_4A96D43E_4779_65363_1_1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<5136_1251446242_n7S7vFMr000692_4A978DDB.1000704@ObjectWay.it>
Message-ID: <75cc17ac0908280913p65157aa1ucb3d9e3f66f0d4b7@mail.gmail.com>

On Fri, Aug 28, 2009 at 2:57 AM, Nicola Musatti <Nicola.Musatti at objectway.it
> wrote:

>
> "Pattern Oriented Language Engineering" - Maybe a little too reminiscent
> of the Pattern Oriented Software Architecture series, but don't you love
> the POLE acronym? That would call for a white bear on the book cover :-)


Indeed.  Titles don't matter; what counts is good cover art.  I can remember
the name of the Wizard book, but not the Dragon book or the Camel book.

-g
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090828/320d0467/attachment.html 

From cmundi at gmail.com  Fri Aug 28 17:59:25 2009
From: cmundi at gmail.com (C. Mundi)
Date: Fri, 28 Aug 2009 17:59:25 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <e794390908281759j7beea1e1nbedd2e59f63de6cf@mail.gmail.com>

Terence,

After reading the entire manuscript, the original, "Language Design
Patterns," seems more appropriate than ever.  Many sections feel like
Language (Design Patterns) and others feel like (Language Design) Patterns.
So I say you can claim the associative ambiguity as a "feature."  :)

Instead, let me open another box o' monkeys (which will be in the notes I'm
sending to your publisher).  Domain specificity is a characteristic of a
language, and not necessarily of the tools used to implement the language.
I'm sure the publisher wants DSL in the title, in part because DSLs are Sexy
and Hot Right Now.  (And I would agree that's a good enough reason; I admire
effective marketing.)  But as I read the manuscript, I came away realizing
that -- apart from the choice of DSL-oriented examples -- the actual *
patterns* are for the most part broadly applicable beyond DSLs.  You might
convince me otherwise; you are the expert here.  I think your book is not
limited to DSLs, although that may be a good way to position it at Amazon.





On Thu, Aug 27, 2009 at 11:44 AM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Hi, so we're going back and forth on titles/subtitles for the new book
> on implementing DSLs and other languages.  Now, we're "Language Design
> Patterns", where Design is an adjective of Patterns; Language is not
> an adj of Design.  it's ambiguous though. Using Lang Impl Design
> Patterns was too long and unwieldy.  So, we added a subtitle about
> "Techniques for implementing DSLs".  Our marketing has been all about
> impl DSLs but the book became much more general.
>
> The confusion is that the current title can be seen as about lang
> design.  We could do Lang Impl Patterns, but Kent Beck has a Impl
> Patterns book now that is totally different concept.
>
> Publisher wants DSL in there somewhere.  Any ideas about title/subtitle?
>
> Ter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090828/c98134f5/attachment.html 

From parrt at cs.usfca.edu  Fri Aug 28 18:04:23 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 28 Aug 2009 18:04:23 -0700
Subject: [antlr-interest] what's in a name?
In-Reply-To: <e794390908281759j7beea1e1nbedd2e59f63de6cf@mail.gmail.com>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
	<e794390908281759j7beea1e1nbedd2e59f63de6cf@mail.gmail.com>
Message-ID: <FAA19749-8C19-4061-8B09-ECF62A49B861@cs.usfca.edu>


On Aug 28, 2009, at 5:59 PM, C. Mundi wrote:

>
> Terence,
>
> After reading the entire manuscript, the original, "Language Design  
> Patterns," seems more appropriate than ever.  Many sections feel  
> like Language (Design Patterns) and others feel like (Language  
> Design) Patterns.  So I say you can claim the associative ambiguity  
> as a "feature."  :)

ha! lol. well, i do talk *some* about design, but it's more side  
comments, right?

> Instead, let me open another box o' monkeys (which will be in the  
> notes I'm sending to your publisher).  Domain specificity is a  
> characteristic of a language, and not necessarily of the tools used  
> to implement the language.  I'm sure the publisher wants DSL in the  
> title, in part because DSLs are Sexy and Hot Right Now.  (And I  
> would agree that's a good enough reason; I admire effective  
> marketing.)  But as I read the manuscript, I came away realizing  
> that -- apart from the choice of DSL-oriented examples -- the actual  
> patterns are for the most part broadly applicable beyond DSLs.  You  
> might convince me otherwise; you are the expert here.  I think your  
> book is not limited to DSLs, although that may be a good way to  
> position it at Amazon.
>

It's definitely more general; at this point DSL keyword is marketing.  
I also do many little languages as examples. Last chapter even  
discusses a RNA sequence matcher :)

Ter

From jeroen.v.schagen at gmail.com  Sat Aug 29 03:57:36 2009
From: jeroen.v.schagen at gmail.com (Jeroen van Schagen)
Date: Sat, 29 Aug 2009 12:57:36 +0200
Subject: [antlr-interest] Recursive rule invocation
Message-ID: <cabba3130908290357s95d17c4o2af63ce80dd4c46f@mail.gmail.com>

Can somebody please tell me what is recursive about the
*markupStatement*production in the following grammar? The problem
disappears when I remove
the expression NT symbol from argument, but this is required for my
language. Is it solvable without having to enable backtracking?
*markupStatement: markup+ expression ';' *
* **| markup+ regularStatement ';' *
* **| markup+ embedding ';'*
* **| markup+ ';' *
* **;*

where..

markup: IDCON attributes arguments?
-> ^( MARKUP IDCON attributes arguments? ) ;
attributes: attribute*
-> ^( ATTRIBUTES attribute* );
attribute: '#' IDCON // ID attribute
| '.' IDCON // Class attribute
| '$' IDCON // Name attribute
| ':' IDCON // Type attribute
| '@' NATCON // Width attribute
| '@' NATCON '%' NATCON // Width-height attribute
;

arguments: '(' argument? ( ',' argument )* ')' ;

*argument:** **expression*
* **| IDCON '=' expression ;*

expression: ( IDCON | NATCON | TEXT | SYMBOLCON
| '[' expression? ( ',' expression )* ']' // List
| '{' keyValuePair? ( ',' keyValuePair )* '}' // Record
) ( '+' expression | '.' IDCON )* ;
keyValuePair: IDCON ':' expression ;

regularStatement:    'echo' expression ';' ;

embedding: PRETEXT embed textTail ;
embed: markup* expression ;
textTail: POSTTEXT | MIDTEXT embed textTail ;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090829/d2e48f1b/attachment.html 

From martijn.reuvers at gmail.com  Sat Aug 29 05:20:24 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Sat, 29 Aug 2009 14:20:24 +0200
Subject: [antlr-interest] Recursive rule invocation
In-Reply-To: <cabba3130908290357s95d17c4o2af63ce80dd4c46f@mail.gmail.com>
References: <cabba3130908290357s95d17c4o2af63ce80dd4c46f@mail.gmail.com>
Message-ID: <c376e6ec0908290520y627cb746g7060d04f07f154d4@mail.gmail.com>

Hi Jeroen,

I would rewrite the markupStatement like this:

markupStatement :
  markup+ (expression | regularStatement | embedding)? ';'

That way its valid again. The markup+ in each of your choices is the
problem now I guess.

Martijn

On Sat, Aug 29, 2009 at 12:57 PM, Jeroen van
Schagen<jeroen.v.schagen at gmail.com> wrote:
> Can somebody please tell me what is recursive about the markupStatement
> production in the following grammar? The problem disappears when I remove
> the expression NT symbol from argument, but this is required for my
> language. Is it solvable without having to enable backtracking?
> markupStatement:?markup+ expression ';'
> | markup+ regularStatement ';'
> | markup+ embedding ';'
> | markup+ ';'
> ;
> where..
> markup: IDCON attributes arguments?
> -> ^( MARKUP IDCON attributes arguments? ) ;
> attributes: attribute*
> -> ^( ATTRIBUTES attribute* );
> attribute: '#' IDCON // ID attribute
> | '.' IDCON // Class attribute
> | '$' IDCON // Name attribute
> | ':' IDCON // Type attribute
> | '@' NATCON // Width attribute
> | '@' NATCON '%' NATCON // Width-height attribute
> ;
> arguments: '(' argument? ( ',' argument )* ')' ;
> argument: expression
> | IDCON '=' expression ;
> expression: ( IDCON | NATCON | TEXT | SYMBOLCON
> | '[' expression? ( ',' expression )* ']' // List
> | '{' keyValuePair? ( ',' keyValuePair )* '}' // Record
> ) ( '+' expression | '.' IDCON )* ;
> keyValuePair: IDCON ':' expression ;
> regularStatement: ? ?'echo' expression ';' ;
> embedding: PRETEXT embed textTail ;
> embed: markup* expression ;
> textTail: POSTTEXT | MIDTEXT embed textTail ;
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From martijn.reuvers at gmail.com  Sat Aug 29 05:53:36 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Sat, 29 Aug 2009 14:53:36 +0200
Subject: [antlr-interest] Recursive rule invocation
In-Reply-To: <c376e6ec0908290520y627cb746g7060d04f07f154d4@mail.gmail.com>
References: <cabba3130908290357s95d17c4o2af63ce80dd4c46f@mail.gmail.com>
	<c376e6ec0908290520y627cb746g7060d04f07f154d4@mail.gmail.com>
Message-ID: <c376e6ec0908290553o503300f9r1f454ba433b09f65@mail.gmail.com>

Not sure if that actually solves it. Hard without having the grammar
to test it..

I think 'markup: IDCON attributes arguments?' is one of the trouble
makers, to be precise the attributes argument. As that goes to
'attribute' and that has options such as '#' IDCON. I think in that
case the parser does not know what IDCON is for (markup or attribute
rule). Not sure, just guessing here.. You could replace the IDCON in
markup with something else (e.g. '???') to see if it helps reduce the
errors.

Maybe someone else can shed some light?


On Sat, Aug 29, 2009 at 2:20 PM, Martijn
Reuvers<martijn.reuvers at gmail.com> wrote:
> Hi Jeroen,
>
> I would rewrite the markupStatement like this:
>
> markupStatement :
> ?markup+ (expression | regularStatement | embedding)? ';'
>
> That way its valid again. The markup+ in each of your choices is the
> problem now I guess.
>
> Martijn
>
> On Sat, Aug 29, 2009 at 12:57 PM, Jeroen van
> Schagen<jeroen.v.schagen at gmail.com> wrote:
>> Can somebody please tell me what is recursive about the markupStatement
>> production in the following grammar? The problem disappears when I remove
>> the expression NT symbol from argument, but this is required for my
>> language. Is it solvable without having to enable backtracking?
>> markupStatement:?markup+ expression ';'
>> | markup+ regularStatement ';'
>> | markup+ embedding ';'
>> | markup+ ';'
>> ;
>> where..
>> markup: IDCON attributes arguments?
>> -> ^( MARKUP IDCON attributes arguments? ) ;
>> attributes: attribute*
>> -> ^( ATTRIBUTES attribute* );
>> attribute: '#' IDCON // ID attribute
>> | '.' IDCON // Class attribute
>> | '$' IDCON // Name attribute
>> | ':' IDCON // Type attribute
>> | '@' NATCON // Width attribute
>> | '@' NATCON '%' NATCON // Width-height attribute
>> ;
>> arguments: '(' argument? ( ',' argument )* ')' ;
>> argument: expression
>> | IDCON '=' expression ;
>> expression: ( IDCON | NATCON | TEXT | SYMBOLCON
>> | '[' expression? ( ',' expression )* ']' // List
>> | '{' keyValuePair? ( ',' keyValuePair )* '}' // Record
>> ) ( '+' expression | '.' IDCON )* ;
>> keyValuePair: IDCON ':' expression ;
>> regularStatement: ? ?'echo' expression ';' ;
>> embedding: PRETEXT embed textTail ;
>> embed: markup* expression ;
>> textTail: POSTTEXT | MIDTEXT embed textTail ;
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>

From jeroen.v.schagen at gmail.com  Sat Aug 29 05:56:51 2009
From: jeroen.v.schagen at gmail.com (jeroen.v.schagen at gmail.com)
Date: Sat, 29 Aug 2009 12:56:51 +0000
Subject: [antlr-interest] Recursive rule invocation
In-Reply-To: <c376e6ec0908290520y627cb746g7060d04f07f154d4@mail.gmail.com>
Message-ID: <001636c5ba99a21bed04724755f0@google.com>

Thanks for the response. I'm aware of the left factoring approach, however  
then the alternative:

markup+ ';'

will have a higher priority then:

markup+ expression ';'

which is invalid for my language. Is there any way to specify priorities  
other then the ordering of alternatives?

On Aug 29, 2009 2:20pm, Martijn Reuvers <martijn.reuvers at gmail.com> wrote:
> Hi Jeroen,



> I would rewrite the markupStatement like this:



> markupStatement :

> markup+ (expression | regularStatement | embedding)? ';'



> That way its valid again. The markup+ in each of your choices is the

> problem now I guess.



> Martijn



> On Sat, Aug 29, 2009 at 12:57 PM, Jeroen van

> Schagenjeroen.v.schagen at gmail.com> wrote:

> > Can somebody please tell me what is recursive about the markupStatement

> > production in the following grammar? The problem disappears when I  
> remove

> > the expression NT symbol from argument, but this is required for my

> > language. Is it solvable without having to enable backtracking?

> > markupStatement: markup+ expression ';'

> > | markup+ regularStatement ';'

> > | markup+ embedding ';'

> > | markup+ ';'

> > ;

> > where..

> > markup: IDCON attributes arguments?

> > -> ^( MARKUP IDCON attributes arguments? ) ;

> > attributes: attribute*

> > -> ^( ATTRIBUTES attribute* );

> > attribute: '#' IDCON // ID attribute

> > | '.' IDCON // Class attribute

> > | '$' IDCON // Name attribute

> > | ':' IDCON // Type attribute

> > | '@' NATCON // Width attribute

> > | '@' NATCON '%' NATCON // Width-height attribute

> > ;

> > arguments: '(' argument? ( ',' argument )* ')' ;

> > argument: expression

> > | IDCON '=' expression ;

> > expression: ( IDCON | NATCON | TEXT | SYMBOLCON

> > | '[' expression? ( ',' expression )* ']' // List

> > | '{' keyValuePair? ( ',' keyValuePair )* '}' // Record

> > ) ( '+' expression | '.' IDCON )* ;

> > keyValuePair: IDCON ':' expression ;

> > regularStatement: 'echo' expression ';' ;

> > embedding: PRETEXT embed textTail ;

> > embed: markup* expression ;

> > textTail: POSTTEXT | MIDTEXT embed textTail ;

> >

> > List: http://www.antlr.org/mailman/listinfo/antlr-interest

> > Unsubscribe:

> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address

> >

> >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090829/7371c5f1/attachment.html 

From jeroen.v.schagen at gmail.com  Sat Aug 29 06:37:36 2009
From: jeroen.v.schagen at gmail.com (Jeroen van Schagen)
Date: Sat, 29 Aug 2009 15:37:36 +0200
Subject: [antlr-interest] Recursive rule invocation
In-Reply-To: <001636c5ba99a21bed04724755f0@google.com>
References: <c376e6ec0908290520y627cb746g7060d04f07f154d4@mail.gmail.com>
	<001636c5ba99a21bed04724755f0@google.com>
Message-ID: <cabba3130908290637p738ec7b1q871212a60d85efe8@mail.gmail.com>

Just noticed I forgot to include the grammar file, here it is.

On Sat, Aug 29, 2009 at 2:56 PM, <jeroen.v.schagen at gmail.com> wrote:

> Thanks for the response. I'm aware of the left factoring approach, however
> then the alternative:
>
> markup+ ';'
>
> will have a higher priority then:
>
> markup+ expression ';'
>
> which is invalid for my language. Is there any way to specify priorities
> other then the ordering of alternatives?
>
> On Aug 29, 2009 2:20pm, Martijn Reuvers <martijn.reuvers at gmail.com> wrote:
> > Hi Jeroen,
> >
> >
> >
> > I would rewrite the markupStatement like this:
> >
> >
> >
> > markupStatement :
> >
> >  markup+ (expression | regularStatement | embedding)? ';'
> >
> >
> >
> > That way its valid again. The markup+ in each of your choices is the
> >
> > problem now I guess.
> >
> >
> >
> > Martijn
> >
> >
> >
> > On Sat, Aug 29, 2009 at 12:57 PM, Jeroen van
> >
> > Schagenjeroen.v.schagen at gmail.com> wrote:
> >
> > > Can somebody please tell me what is recursive about the markupStatement
> >
> > > production in the following grammar? The problem disappears when I
> remove
> >
> > > the expression NT symbol from argument, but this is required for my
> >
> > > language. Is it solvable without having to enable backtracking?
> >
> > > markupStatement: markup+ expression ';'
> >
> > > | markup+ regularStatement ';'
> >
> > > | markup+ embedding ';'
> >
> > > | markup+ ';'
> >
> > > ;
> >
> > > where..
> >
> > > markup: IDCON attributes arguments?
> >
> > > -> ^( MARKUP IDCON attributes arguments? ) ;
> >
> > > attributes: attribute*
> >
> > > -> ^( ATTRIBUTES attribute* );
> >
> > > attribute: '#' IDCON // ID attribute
> >
> > > | '.' IDCON // Class attribute
> >
> > > | '$' IDCON // Name attribute
> >
> > > | ':' IDCON // Type attribute
> >
> > > | '@' NATCON // Width attribute
> >
> > > | '@' NATCON '%' NATCON // Width-height attribute
> >
> > > ;
> >
> > > arguments: '(' argument? ( ',' argument )* ')' ;
> >
> > > argument: expression
> >
> > > | IDCON '=' expression ;
> >
> > > expression: ( IDCON | NATCON | TEXT | SYMBOLCON
> >
> > > | '[' expression? ( ',' expression )* ']' // List
> >
> > > | '{' keyValuePair? ( ',' keyValuePair )* '}' // Record
> >
> > > ) ( '+' expression | '.' IDCON )* ;
> >
> > > keyValuePair: IDCON ':' expression ;
> >
> > > regularStatement:    'echo' expression ';' ;
> >
> > > embedding: PRETEXT embed textTail ;
> >
> > > embed: markup* expression ;
> >
> > > textTail: POSTTEXT | MIDTEXT embed textTail ;
> >
> > >
> >
> > > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> >
> > > Unsubscribe:
> >
> > > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >
> > >
> >
> > >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090829/6542d1f6/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: WaebricTest.g
Type: application/octet-stream
Size: 5805 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090829/6542d1f6/attachment.obj 

From david-sarah at jacaranda.org  Sat Aug 29 11:50:13 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sat, 29 Aug 2009 19:50:13 +0100
Subject: [antlr-interest] Recursive rule invocation
In-Reply-To: <001636c5ba99a21bed04724755f0@google.com>
References: <001636c5ba99a21bed04724755f0@google.com>
Message-ID: <4A997865.70302@jacaranda.org>

> On Aug 29, 2009 2:20pm, Martijn Reuvers <martijn.reuvers at gmail.com> wrote:
>> I would rewrite the markupStatement like this:
>
>> markupStatement :
>>   markup+ (expression | regularStatement | embedding)? ';'
   ;

jeroen.v.schagen at gmail.com wrote:
> Thanks for the response. I'm aware of the left factoring approach,
> however then the alternative:
> 
> markup+ ';'
> 
> will have a higher priority then:
> 
> markup+ expression ';'
> 
> which is invalid for my language.

The left-factored version is completely equivalent to the original unless
you have an ambiguity. We don't have enough of the grammar to be sure that
there isn't an ambiguity, but if there were, ANTLR would warn about it.

(Strictly speaking, left-factoring alone would give you

   markupStatement :
     markup+ (expression ';' | regularStatement ';' | embedding ';' | ';')
   ;

but the difference doesn't matter here.)

> Is there any way to specify priorities other then the ordering of alternatives?

At the risk of oversimplifying, alternatives are normally only prioritized
if at least one of them has a predicate. "The Definitive ANTLR Reference"
goes into detail about this in chapter 12.

Incidentally, you are matching ';' at the end of regularStatement as
well as in markupStatement, which seems likely to be wrong.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From bhanafee at gmail.com  Sat Aug 29 12:50:35 2009
From: bhanafee at gmail.com (Brian Hanafee)
Date: Sat, 29 Aug 2009 12:50:35 -0700
Subject: [antlr-interest] what's in a name?
Message-ID: <E8E8E8D6-3FFA-41F8-8031-5845040D78DF@gmail.com>


Trying to come up with ways to maximize the audience who would find  
the book if they didn't know what they were really looking for.  
Someone who already has an idea of what they want will probably find  
it regardless. Here are a few hooks: First, your publisher is probably  
right that DSL should be there somewhere, but in the title rather than  
subtitle is a gamble because only people who already know the acronym  
would catch it. With DSL in the main title, it wouldn't surprise me a  
bit to find the book stuck in the networking section at my local  
Borders or Barnes & Noble (I do miss Stacey's in SF - they would have  
figured it out).  So keep the acronym somewhere in the subtitle. I'd  
try to keep "ANTLR" in the subtitle too, again so it pops up in  
search. A lot of people first might first encounter ANTLR as a chained  
dependency for some other project that's using it, and again that  
could be in their search terms even when the idea of a DSL hasn't  
really popped up yet. GoF references the basic pattern as  
"interpreter". Also remember that for a typical undergraduate,  
compilers was either an upper division class to be avoided, or the  
hardest computer science class they took.

How about:
"Domain Language Patterns"
That echos the GoF reference without using up all the words and using  
"Domain" rather than "DSL" makes it feel more accessible to someone  
who isn't yet familiar with the subject. It might hit on a few more  
searches too.

Here are a few subtitles to play with:
"Building DSLs with Examples in ANTLR"
"Implementing DSLs with Examples in ANTLR"
"Using ANTLR to Build DSLs"
"Techniques for Building DSLs with ANTLR"
"Techniques for Building DSLs in the Real World with ANTLR"

Stretching to get the GoF pattern name "interpreter" in there:
"DSL Compilers and Interpreters with Examples in ANTLR"
"Interpreters for DSLs with Examples in ANTLR"
"Using ANTLR to Build DSL Interpreters"
"Using ANTLR to Build DSL Interpreters and Compilers"


-- Brian Hanafee


From david-sarah at jacaranda.org  Sat Aug 29 14:16:54 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sat, 29 Aug 2009 22:16:54 +0100
Subject: [antlr-interest] what's in a name?
In-Reply-To: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
References: <1E997824-B656-4A7A-A58D-86AE568A82A0@cs.usfca.edu>
Message-ID: <4A999AC6.1020506@jacaranda.org>

Terence Parr wrote:
> Hi, so we're going back and forth on titles/subtitles for the new book  
> on implementing DSLs and other languages.  Now, we're "Language Design  
> Patterns", where Design is an adjective of Patterns; Language is not  
> an adj of Design.  it's ambiguous though. Using Lang Impl Design  
> Patterns was too long and unwieldy.  So, we added a subtitle about  
> "Techniques for implementing DSLs".  Our marketing has been all about  
> impl DSLs but the book became much more general.
> 
> The confusion is that the current title can be seen as about lang  
> design.  We could do Lang Impl Patterns, but Kent Beck has a Impl  
> Patterns book now that is totally different concept.
> 
> Publisher wants DSL in there somewhere.  Any ideas about title/subtitle?

To be honest I can't see why the "DSL" is in there, since there's no
dependency in any of the patterns on the language being domain-specific.
It would be unfortunate if people didn't buy the book because they
think it's not applicable to implementing a general-purpose language
rather than a DSL.

How about "Language Engineering Patterns: Building Processors for
Domain-Specific and General-Purpose Languages"?

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From greg94301 at comcast.net  Sat Aug 29 15:50:31 2009
From: greg94301 at comcast.net (greg94301 at comcast.net)
Date: Sat, 29 Aug 2009 22:50:31 +0000 (UTC)
Subject: [antlr-interest] Preserving Unix end-of-line on Windows
In-Reply-To: <286518612.481711251586133655.JavaMail.root@sz0174a.emeryville.ca.mail.comcast.net>
Message-ID: <76982758.482441251586231895.JavaMail.root@sz0174a.emeryville.ca.mail.comcast.net>



I'm rewriting files with mixed Unix and Windows end-of-line conventions on a Windows system using the Java code-generation target and Antlr 3.1.3. I'd like to preserve the eol as they appear in the source files, but it appears that the template processor is converting Unix eol to Windows eol. This is a rewriting application, and it looks as if only lines that pass through "-> template" are affected. 

Can I prevent this? 

A stripped-down driver looks like this: 
ANTLRInputStream input = new ANTLRInputStream(new FileInputStream(args[0])); 
TestLexer lexer = new TestLexer(input); 
CommonTokenStream tokens = new TokenRewriteStream(lexer); 
TestParser parser = new TestParser(tokens); 

parser.prog(); 

System.out.print(tokens.toString().length()); 

The test grammar looks like this: 
grammar Test; 
options { 
output=template; rewrite=true; 
backtrack=true; 
memoize=true; 
k=2; 
} 
prog 
: 
IDENTIFIER* -> template(r={$text}) "<r>" 
; 

IDENTIFIER 
: LETTER LETTER* 
; 

fragment 
LETTER 
: 'A'..'Z' 
; 

WS : (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=HIDDEN;} 

Sample test file with Unix eol: 
A 
B 
C 

turns into 
A^M 
B^M 
C 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090829/e674a426/attachment.html 

From yurushkin at rambler.ru  Sun Aug 30 10:51:01 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 30 Aug 2009 21:51:01 +0400
Subject: [antlr-interest] can't build C target (release version).
Message-ID: <op.uzhk7bvgt3jqlu@win-mupvrp0jyrf>

Good day,
I have downloaded 3.1.3 version for Windows.
I try to compile it in MS Visual Studio 2005. Not older.
"Dubug" version is compiled, but "Release" - not.
Error	1	error C2220: warning treated as error - no 'object' file generated  
...\libantlr3c-3.1.3\src\antlr3collections.c	1383

best regards,
michael


-- 
???????? ? ???????? ??????? ???????? Opera: http://www.opera.com/mail/

From marco at mtsystems.ch  Sun Aug 30 10:58:07 2009
From: marco at mtsystems.ch (Marco Trudel)
Date: Sun, 30 Aug 2009 19:58:07 +0200
Subject: [antlr-interest] can't build C target (release version).
In-Reply-To: <op.uzhk7bvgt3jqlu@win-mupvrp0jyrf>
References: <op.uzhk7bvgt3jqlu@win-mupvrp0jyrf>
Message-ID: <4A9ABDAF.1070007@mtsystems.ch>

Dear Michael

Either set "treat warnings as errors" to false or adapt the function in 
question. The warning is that an attribute is not read. Just add 
something like "attr = attr". But I suggest to change the setting 
(either manually in the config file or in the VisualStudio gui settings).


Hope that helps
Marco


??????? ?????? wrote:
> Good day,
> I have downloaded 3.1.3 version for Windows.
> I try to compile it in MS Visual Studio 2005. Not older.
> "Dubug" version is compiled, but "Release" - not.
> Error	1	error C2220: warning treated as error - no 'object' file generated  
> ...\libantlr3c-3.1.3\src\antlr3collections.c	1383
> 
> best regards,
> michael
> 
> 


From yurushkin at rambler.ru  Sun Aug 30 11:10:01 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 30 Aug 2009 22:10:01 +0400
Subject: [antlr-interest] can't build C target (release version).
In-Reply-To: <4A9ABDAF.1070007@mtsystems.ch>
References: <op.uzhk7bvgt3jqlu@win-mupvrp0jyrf> <4A9ABDAF.1070007@mtsystems.ch>
Message-ID: <op.uzhl2ze2t3jqlu@win-mupvrp0jyrf>

thanks! =)

Marco Trudel <marco at mtsystems.ch> ?????(?) ? ????? ?????? Sun, 30 Aug 2009  
21:58:07 +0400:

> Dear Michael
>
> Either set "treat warnings as errors" to false or adapt the function in  
> question. The warning is that an attribute is not read. Just add  
> something like "attr = attr". But I suggest to change the setting  
> (either manually in the config file or in the VisualStudio gui settings).
>
>
> Hope that helps
> Marco
>
>
> ??????? ?????? wrote:
>> Good day,
>> I have downloaded 3.1.3 version for Windows.
>> I try to compile it in MS Visual Studio 2005. Not older.
>> "Dubug" version is compiled, but "Release" - not.
>> Error	1	error C2220: warning treated as error - no 'object' file  
>> generated  ...\libantlr3c-3.1.3\src\antlr3collections.c	1383
>>  best regards,
>> michael
>>
>
>
> __________ Information from ESET Smart Security, version of virus  
> signature database 4381 (20090830) __________
>
> The message was checked by ESET Smart Security.
>
> http://www.esetnod32.ru
>
>
>


-- 
???????? ? ???????? ??????? ???????? Opera: http://www.opera.com/mail/

From yurushkin at rambler.ru  Sun Aug 30 12:33:21 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 30 Aug 2009 23:33:21 +0400
Subject: [antlr-interest] proplem with tokens value (C target)
Message-ID: <op.uzhpxvqyt3jqlu@win-mupvrp0jyrf>

there is following problem. I have made simple grammar, generated c. file

But when I try to get "tokens text", the error is occured. here is a code  
of getters:

  #define getTokenText(token) string((char*)token->tokText.chars)
  #define getTokenInteger(token) atoi((char*)token->tokText.chars)

I think, that tokens aren't initialized correctly, but what I did wrong...

-- 
???????? ? ???????? ??????? ???????? Opera: http://www.opera.com/mail/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090830/ab1e2e80/attachment.html 

From marco at mtsystems.ch  Mon Aug 31 01:38:14 2009
From: marco at mtsystems.ch (Marco Trudel)
Date: Mon, 31 Aug 2009 10:38:14 +0200
Subject: [antlr-interest] proplem with tokens value (C target)
In-Reply-To: <op.uzhpxvqyt3jqlu@win-mupvrp0jyrf>
References: <op.uzhpxvqyt3jqlu@win-mupvrp0jyrf>
Message-ID: <4A9B8BF6.1090307@mtsystems.ch>

As far as I understood (respectively experienced), tokText is not always 
set. You probably want to do this:
char* tok_text = (token->getText(token) != NULL) ? 
token->getText(token)->chars : token->tokText.chars;

At least that's what I'm doing to get the same result as 
token.toString() in Java.


Hope that helps
Marco


??????? ?????? wrote:
> there is following problem. I have made simple grammar, generated c. file 
> 
> But when I try to get "tokens text", the error is occured. here is a 
> code of getters:
> 
> #define getTokenText(token) string((char*)token->tokText.chars)
> #define getTokenInteger(token) atoi((char*)token->tokText.chars)
> 
> I think, that tokens aren't initialized correctly, but what I did wrong...
> 
> -- 
> 
> ???????? ? ???????? ??????? ???????? Opera: http://www.opera.com/mail/
> 
> 
> ------------------------------------------------------------------------
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From salmir19 at yahoo.com  Mon Aug 31 09:12:51 2009
From: salmir19 at yahoo.com (salmir)
Date: Mon, 31 Aug 2009 09:12:51 -0700 (PDT)
Subject: [antlr-interest] Multiple Lexers/Parsers
Message-ID: <852329.11426.qm@web50101.mail.re2.yahoo.com>

Hi,

    
I'm writing a grammar which needs more than one lexer (token scope). I
just found a document from ANTLR 2 documents which explains using
"selector" for this purpose.
     Is this approach still valid for ANTLR 3? and should I make different files for different lexers?
     When there are more than one parser, what happens to the AST? how can I use rewrite rules?
 For example, in the following example, how can I add this rewrite rule    -> ^('javadoc'  content)
javadoc
    :   JAVADOC_OPEN
        {
        // create a parser to handle the javadoc comment
        JavaDocParser jdocparser =
          new JavaDocParser(getInputState());
        jdocparser.content(); // go parse the comment
        }
        JAVADOC_CLOSE  ;


  Regards
- Salmir


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090831/4dae35e9/attachment.html 

From Gordon.Tyler at quest.com  Mon Aug 31 14:25:25 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Mon, 31 Aug 2009 14:25:25 -0700
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>

Is it possible to use the Antlr v3 runtime with JDK 1.4? I'm getting this error when compiling generated parser code using JDK 1.4, which indicates that the runtime is compiled with JDK 1.5:

NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
bad class file: lib\antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
class file has wrong version 49.0, should be 48.0

Is it just a matter of a recompile of the runtime or does the runtime use Java 5 features?

Thanks,
Gordon

---
Gordon Tyler (Software Developer)
Quest Software <http://www.quest.com/>
260 King Street East, Toronto, Ontario M5A 4L5, Canada
Voice: (416) 933-5046 | Fax: (416) 933-5001

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090831/3aaae460/attachment.html 

From steve at hibernate.org  Mon Aug 31 15:26:07 2009
From: steve at hibernate.org (Steve Ebersole)
Date: Mon, 31 Aug 2009 17:26:07 -0500
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
Message-ID: <1251757567.29872.67.camel@localhost.localdomain>

I ran into the same issue when first looking at Antlr3.  I was told the
intention was to not have the Antlr runtime rely on JDK 1.5; but
unfortunately some JDK 1.5 features ended up getting exposed.  

The outcome of my queries, iirc, was that it would just remain JDK 1.5
compatible.  You could probably use a retro-weaver though to make it 1.4
compatible.  Did not try...


On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
> Is it possible to use the Antlr v3 runtime with JDK 1.4? I?m getting
> this error when compiling generated parser code using JDK 1.4, which
> indicates that the runtime is compiled with JDK 1.5:
> 
>  
> 
> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
> 
> bad class file: lib
> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
> 
> class file has wrong version 49.0, should be 48.0
> 
>  
> 
> Is it just a matter of a recompile of the runtime or does the runtime
> use Java 5 features?
> 
>  
> 
> Thanks,
> 
> Gordon
> 
>  
> 
> ---
> 
> Gordon Tyler (Software Developer)
> 
> Quest Software <http://www.quest.com/>
> 
> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
> 
> Voice: (416) 933-5046 | Fax: (416) 933-5001
> 
>  
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-- 
Steve Ebersole <steve at hibernate.org>
Hibernate.org


From Gordon.Tyler at quest.com  Mon Aug 31 15:30:51 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Mon, 31 Aug 2009 15:30:51 -0700
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <1251757567.29872.67.camel@localhost.localdomain>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>

Thanks Steve, and Jim Idle who replied off-list. I guess I'll have to stick to Antlr v2 until my project drops the JDK 1.4 requirement. Messing around with retro-weaver sounds dubious and I need to restrict my third-party dependencies.

-----Original Message-----
From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On Behalf Of Steve Ebersole
Sent: August 31, 2009 6:26 PM
To: Gordon Tyler
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4

I ran into the same issue when first looking at Antlr3.  I was told the
intention was to not have the Antlr runtime rely on JDK 1.5; but
unfortunately some JDK 1.5 features ended up getting exposed.  

The outcome of my queries, iirc, was that it would just remain JDK 1.5
compatible.  You could probably use a retro-weaver though to make it 1.4
compatible.  Did not try...


On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
> Is it possible to use the Antlr v3 runtime with JDK 1.4? I?m getting
> this error when compiling generated parser code using JDK 1.4, which
> indicates that the runtime is compiled with JDK 1.5:
> 
>  
> 
> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
> 
> bad class file: lib
> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
> 
> class file has wrong version 49.0, should be 48.0
> 
>  
> 
> Is it just a matter of a recompile of the runtime or does the runtime
> use Java 5 features?
> 
>  
> 
> Thanks,
> 
> Gordon
> 
>  
> 
> ---
> 
> Gordon Tyler (Software Developer)
> 
> Quest Software <http://www.quest.com/>
> 
> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
> 
> Voice: (416) 933-5046 | Fax: (416) 933-5001
> 
>  
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-- 
Steve Ebersole <steve at hibernate.org>
Hibernate.org


From parrt at cs.usfca.edu  Mon Aug 31 17:14:54 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 31 Aug 2009 17:14:54 -0700
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
Message-ID: <95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>

Hi. can we do 1.5 javac with -target jsr14?
Ter
On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:

> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have  
> to stick to Antlr v2 until my project drops the JDK 1.4 requirement.  
> Messing around with retro-weaver sounds dubious and I need to  
> restrict my third-party dependencies.
>
> -----Original Message-----
> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On Behalf Of  
> Steve Ebersole
> Sent: August 31, 2009 6:26 PM
> To: Gordon Tyler
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>
> I ran into the same issue when first looking at Antlr3.  I was told  
> the
> intention was to not have the Antlr runtime rely on JDK 1.5; but
> unfortunately some JDK 1.5 features ended up getting exposed.
>
> The outcome of my queries, iirc, was that it would just remain JDK 1.5
> compatible.  You could probably use a retro-weaver though to make it  
> 1.4
> compatible.  Did not try...
>
>
> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I?m getting
>> this error when compiling generated parser code using JDK 1.4, which
>> indicates that the runtime is compiled with JDK 1.5:
>>
>>
>>
>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>
>> bad class file: lib
>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>
>> class file has wrong version 49.0, should be 48.0
>>
>>
>>
>> Is it just a matter of a recompile of the runtime or does the runtime
>> use Java 5 features?
>>
>>
>>
>> Thanks,
>>
>> Gordon
>>
>>
>>
>> ---
>>
>> Gordon Tyler (Software Developer)
>>
>> Quest Software <http://www.quest.com/>
>>
>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>
>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>
>>
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> -- 
> Steve Ebersole <steve at hibernate.org>
> Hibernate.org
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Mon Aug 31 17:34:00 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 31 Aug 2009 19:34:00 -0500
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
	<95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
Message-ID: <804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>

Pretty sure we can't even though genetics are eluded at the byte code  
level. I will look at this definitively next week and we can decide  
what to do at the JVM language conference.

Jim

On Aug 31, 2009, at 7:14 PM, Terence Parr <parrt at cs.usfca.edu> wrote:

> Hi. can we do 1.5 javac with -target jsr14?
> Ter
> On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:
>
>> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have
>> to stick to Antlr v2 until my project drops the JDK 1.4 requirement.
>> Messing around with retro-weaver sounds dubious and I need to
>> restrict my third-party dependencies.
>>
>> -----Original Message-----
>> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On Behalf Of
>> Steve Ebersole
>> Sent: August 31, 2009 6:26 PM
>> To: Gordon Tyler
>> Cc: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>
>> I ran into the same issue when first looking at Antlr3.  I was told
>> the
>> intention was to not have the Antlr runtime rely on JDK 1.5; but
>> unfortunately some JDK 1.5 features ended up getting exposed.
>>
>> The outcome of my queries, iirc, was that it would just remain JDK  
>> 1.5
>> compatible.  You could probably use a retro-weaver though to make it
>> 1.4
>> compatible.  Did not try...
>>
>>
>> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I?m get 
>>> ting
>>> this error when compiling generated parser code using JDK 1.4, which
>>> indicates that the runtime is compiled with JDK 1.5:
>>>
>>>
>>>
>>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>>
>>> bad class file: lib
>>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>>
>>> class file has wrong version 49.0, should be 48.0
>>>
>>>
>>>
>>> Is it just a matter of a recompile of the runtime or does the  
>>> runtime
>>> use Java 5 features?
>>>
>>>
>>>
>>> Thanks,
>>>
>>> Gordon
>>>
>>>
>>>
>>> ---
>>>
>>> Gordon Tyler (Software Developer)
>>>
>>> Quest Software <http://www.quest.com/>
>>>
>>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>>
>>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>>
>>>
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> -- 
>> Steve Ebersole <steve at hibernate.org>
>> Hibernate.org
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From parrt at cs.usfca.edu  Mon Aug 31 17:48:21 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 31 Aug 2009 17:48:21 -0700
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
	<95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
	<804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>
Message-ID: <83A722C9-866C-4EA8-A1AE-1A741F15F506@cs.usfca.edu>

cool. see you at the conference. I'm pretty sure I used to run -target  
jsr14 on the releases I made earlier. Neil Gafter, the javac guy, told  
me it works

Ter

On Aug 31, 2009, at 5:34 PM, Jim Idle wrote:

> Pretty sure we can't even though genetics are eluded at the byte code
> level. I will look at this definitively next week and we can decide
> what to do at the JVM language conference.
>
> Jim
>
> On Aug 31, 2009, at 7:14 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>
>> Hi. can we do 1.5 javac with -target jsr14?
>> Ter
>> On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:
>>
>>> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have
>>> to stick to Antlr v2 until my project drops the JDK 1.4 requirement.
>>> Messing around with retro-weaver sounds dubious and I need to
>>> restrict my third-party dependencies.
>>>
>>> -----Original Message-----
>>> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On Behalf Of
>>> Steve Ebersole
>>> Sent: August 31, 2009 6:26 PM
>>> To: Gordon Tyler
>>> Cc: antlr-interest at antlr.org
>>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>>
>>> I ran into the same issue when first looking at Antlr3.  I was told
>>> the
>>> intention was to not have the Antlr runtime rely on JDK 1.5; but
>>> unfortunately some JDK 1.5 features ended up getting exposed.
>>>
>>> The outcome of my queries, iirc, was that it would just remain JDK
>>> 1.5
>>> compatible.  You could probably use a retro-weaver though to make it
>>> 1.4
>>> compatible.  Did not try...
>>>
>>>
>>> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>>>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I?m get
>>>> ting
>>>> this error when compiling generated parser code using JDK 1.4,  
>>>> which
>>>> indicates that the runtime is compiled with JDK 1.5:
>>>>
>>>>
>>>>
>>>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>>>
>>>> bad class file: lib
>>>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>>>
>>>> class file has wrong version 49.0, should be 48.0
>>>>
>>>>
>>>>
>>>> Is it just a matter of a recompile of the runtime or does the
>>>> runtime
>>>> use Java 5 features?
>>>>
>>>>
>>>>
>>>> Thanks,
>>>>
>>>> Gordon
>>>>
>>>>
>>>>
>>>> ---
>>>>
>>>> Gordon Tyler (Software Developer)
>>>>
>>>> Quest Software <http://www.quest.com/>
>>>>
>>>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>>>
>>>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>>>
>>>>
>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>> -- 
>>> Steve Ebersole <steve at hibernate.org>
>>> Hibernate.org
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jan.sture.nielsen at gmail.com  Mon Aug 31 22:24:47 2009
From: jan.sture.nielsen at gmail.com (Jan Nielsen)
Date: Mon, 31 Aug 2009 23:24:47 -0600
Subject: [antlr-interest] Language Design Patterns Section 12.5 Problem
Message-ID: <f79c7d4d0908312224h6eb9ccd6j52c6fb1d16cd9f0a@mail.gmail.com>

I'm not sure if this is the right forum to discuss a little problem I
encountered in section 12.5 of Language Design Patterns (B6.0), but
I'm sure this is the most likely spot for some help...I got the
following:

  java -cp antlr-3.1.3.jar org.antlr.Tool Cymbol.g Gen.g
  warning(200): Cymbol.g:94:45: Decision can match input such as
"'else'" using multiple alternatives: 1, 2
  As a result, alternative(s) 2 were disabled for that input
  error(100): :1:1: syntax error: antlr: Gen.g:1:1: unexpected token: operator
  error(10):  internal error: Exception java.lang.ClassCastException:
antlr.CommonToken cannot be cast to
antlr.TokenWithIndex at antlr.TokenStreamRewriteEngine.next
  Token(TokenStreamRewriteEngine.java:161): can't parse template action

  error(100): Gen.g:0:0: syntax error: codegen: <AST>:0:0: unexpected
end of subtree

Per the eBook, I'm expecting the warning(200) but the errors end up
causing the generated Gen.java to break:

  Gen.java:1851: illegal start of expression
              retval.st = ;
                          ^
  1 error

Any thoughts from those of you who have paid for the EA eBook (or
written it :-)?


Thanks,

Jan

