<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Backtracking and labels
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Backtracking%20and%20labels&In-Reply-To=%3CCAN45N12btCUp0Lkt97F0pOOSFriDjcOkBUxWmJ0_n9ZYgVdH4Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="044265.html">
   <LINK REL="Next"  HREF="044288.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Backtracking and labels</H1>
    <B>Eric</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Backtracking%20and%20labels&In-Reply-To=%3CCAN45N12btCUp0Lkt97F0pOOSFriDjcOkBUxWmJ0_n9ZYgVdH4Q%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Backtracking and labels">researcher0x00 at gmail.com
       </A><BR>
    <I>Sun Mar 18 07:24:32 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="044265.html">[antlr-interest] Backtracking and labels
</A></li>
        <LI>Next message: <A HREF="044288.html">[antlr-interest] Backtracking and labels
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44266">[ date ]</a>
              <a href="thread.html#44266">[ thread ]</a>
              <a href="subject.html#44266">[ subject ]</a>
              <a href="author.html#44266">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Kieran,

I looked at the github files and see that you are working with the C
target. I have never worked with the C target, that is Jim Idle's world.

I also noticed that you mention the grammar works with ANTLR 3.3 but that
you want to use ANTLR 3.4. If it were me and the grammar worked with ANTLR
3.3, I would skip the path of trying to fix ANTLR 3.4; you will learn a lot
by trying to fix ANTLR 3.4 but will you actually be productive on your
ultimate goal? I have spent time modifying ANTLR to extend for parsing
binary files; learned a lot but all of the changes went to bit heaven.

If there is something in the grammar forcing you to use 3.4, I would take
the easier route and see if I could modify the grammar to work with 3.4 as
is or 3.3.

One of the ways I view a grammar is as a high level language for parsing.
If I can't define what I need through the grammar, I use actions. Think of
a grammar as a high level language and actions as assembly language. It is
amazing how much you can do with actions. Remember all parts of a grammar,
including predicates are translated into the target language. Instead of
trying to patch ANTLR to use a predicate, just recreate the predicate using
actions; it should be easier than fixing ANTLR for someone who doesn't
understand all of ANTLRs internals.I don't even understand all of ANTLRs
internals.

Hope that helps,

Eric





On Sun, Mar 18, 2012 at 4:21 AM, Kieran Simpson &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">kierans777 at gmail.com</A>&gt;wrote:

&gt;<i> Eric (and list)
</I>&gt;<i>
</I>&gt;<i> I had a shot at porting Sam's fixes to the C target.  While it does indeed
</I>&gt;<i> fix the label generation issue (yay!), it unfortunately introduces a number
</I>&gt;<i> of other changes which results in uncompilable code :'( :'(
</I>&gt;<i>
</I>&gt;<i> I've forked the antlr3 repo at <A HREF="https://github.com/kierans/**antlr3&lt;https://github.com/kierans/antlr3">https://github.com/kierans/**antlr3&lt;https://github.com/kierans/antlr3</A>&gt;and pushed up my current changes.  If anyone has any suggestions (or wishes
</I>&gt;<i> to fork and add some patches) they're more than welcome.  With some more
</I>&gt;<i> tweaking hopefully this bug will go away :D
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 17/03/12 3:48 PM, Eric wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Kieran,
</I>&gt;&gt;<i> Did one of my crazy suggestions actually pan out?
</I>&gt;&gt;<i> I took a quick 30 second look at the code and it looks doable. When you
</I>&gt;&gt;<i> mentioned Sam I thought it would be C# code, but is actually a java,
</I>&gt;&gt;<i> grammar, and string template patch. I'm not sure if all three patches in
</I>&gt;&gt;<i> the update have to be applied. If I wasn't going to sleep right now I
</I>&gt;&gt;<i> would take a shot at it.
</I>&gt;&gt;<i> It might be as simple as applying the patch to the files and building.
</I>&gt;&gt;<i> Don't let the unknown file types scare you, just treat it like any patch
</I>&gt;&gt;<i> that you would do by hand, looking to make sure that the before and
</I>&gt;&gt;<i> after parts match up and there is a good change it will work.
</I>&gt;&gt;<i> I should be able to help you tomorrow with it. Drop a message if you
</I>&gt;&gt;<i> need help and I will jump in when I see it.
</I>&gt;&gt;<i> Good luck and great job on finding it, that fix is wanted by at least
</I>&gt;&gt;<i> several people. If you get it to work you might become someones hero.
</I>&gt;&gt;<i> Eric.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Sat, Mar 17, 2012 at 12:17 AM, Kieran Simpson &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">kierans777 at gmail.com</A>
</I>&gt;&gt;<i> &lt;mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">kierans777 at gmail.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Further to the related discussion of the Java grammar not compiling
</I>&gt;&gt;<i> (see
</I>&gt;&gt;<i>    <A HREF="http://antlr.markmail.org/**search/?q=java+parser+not+**">http://antlr.markmail.org/**search/?q=java+parser+not+**</A>
</I>&gt;&gt;<i> compiling#query:java%20parser%**20not%20compiling+page:1+mid:**
</I>&gt;&gt;<i> vyevxqph4xniwl6q+state:results&lt;<A HREF="http://antlr.markmail.org/search/?q=java+parser+not+compiling#query:java%20parser%20not%20compiling+page:1+mid:vyevxqph4xniwl6q+state:results">http://antlr.markmail.org/search/?q=java+parser+not+compiling#query:java%20parser%20not%20compiling+page:1+mid:vyevxqph4xniwl6q+state:results</A>&gt;
</I>&gt;&gt;<i>    ) I've found Sam's fix for the labels not being generated properly.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    It's
</I>&gt;&gt;<i>    <A HREF="https://github.com/antlr/**antlr3/commit/**">https://github.com/antlr/**antlr3/commit/**</A>
</I>&gt;&gt;<i> db6adaefb12a1901606f81c9c8931a**a07d12949f&lt;<A HREF="https://github.com/antlr/antlr3/commit/db6adaefb12a1901606f81c9c8931aa07d12949f">https://github.com/antlr/antlr3/commit/db6adaefb12a1901606f81c9c8931aa07d12949f</A>&gt;
</I>&gt;&gt;<i>    and building against the current head of the antlr3 repo, the fix still
</I>&gt;&gt;<i>    holds for the Java target, however the C target still has the bug.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    I'm not that familiar with Antlr's internal workings, nor String
</I>&gt;&gt;<i>    Template.  If anyone can help it would be appreciated (not just by my
</I>&gt;&gt;<i>    I'm sure).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Cheers,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    On 23/07/64 5:59 AM, Kieran Simpson wrote:
</I>&gt;&gt;<i>     &gt; As a follow up, I checked out the antlr3 repo from Git Hub and
</I>&gt;&gt;<i>    built the
</I>&gt;&gt;<i>     &gt; current master branch. Still have the same problem
</I>&gt;&gt;<i>     &gt;
</I>&gt;&gt;<i>     &gt; [java] '-classpath'
</I>&gt;&gt;<i>     &gt; [java]
</I>&gt;&gt;<i>     &gt;
</I>&gt;&gt;<i>    './lib/ST4-4.0.4.jar:./lib/**antlr-2.7.7.jar:./lib/antlr-3.**
</I>&gt;&gt;<i> 4.1-SNAPSHOT.jar:./lib/antlr-**runtime-3.4.1-SNAPSHOT.jar:./**
</I>&gt;&gt;<i> lib/stringtemplate-3.2.1.jar'
</I>&gt;&gt;<i>     &gt;
</I>&gt;&gt;<i>     &gt;
</I>&gt;&gt;<i>     &gt; Cheers,
</I>&gt;&gt;<i>     &gt;
</I>&gt;&gt;<i>     &gt; On 11/03/12 5:43 PM, Kieran Simpson wrote:
</I>&gt;&gt;<i>     &gt;&gt; @Bart - yes you're right, I forgot to add the leading ^ for the
</I>&gt;&gt;<i>     &gt;&gt; resulting AST in my example. Typo :(
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; @Ivan - I ran my build with Antlr 3.3 and the resulting code is OK
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; static void
</I>&gt;&gt;<i>    synpred9_CoreConfiguration_**fragment(**pCoreConfigurationParser
</I>&gt;&gt;<i>     &gt;&gt; ctx )
</I>&gt;&gt;<i>     &gt;&gt; {
</I>&gt;&gt;<i>     &gt;&gt; pANTLR3_COMMON_TOKEN value;
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; value = NULL;
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; However I want to use 3.4 ;)
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; I was thinking it might be a classpath issue, however I'm not
</I>&gt;&gt;<i>    certain.
</I>&gt;&gt;<i>     &gt;&gt; The classpaths are (from my Ant build):
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; [java] '-classpath'
</I>&gt;&gt;<i>     &gt;&gt; [java]
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>    './lib/ST4-4.0.4.jar:./lib/**antlr-2.7.7.jar:./lib/antlr-3.**
</I>&gt;&gt;<i> 4.jar:./lib/antlr-runtime-3.4.**jar:./lib/stringtemplate-3.2.**1.jar'
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; [java] '-classpath'
</I>&gt;&gt;<i>     &gt;&gt; [java]
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>    './lib/antlr-2.7.7.jar:./lib/**antlr-3.3.jar:./lib/antlr-**
</I>&gt;&gt;<i> runtime-3.3.jar:./lib/**stringtemplate-3.2.1.jar'
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; What is really bothering my is that the the code generated from
</I>&gt;&gt;<i>     &gt;&gt; Antlrworks (when I Debug the grammar) is OK
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; public final void synpred9_CoreConfiguration_**fragment() throws
</I>&gt;&gt;<i>     &gt;&gt; RecognitionException {
</I>&gt;&gt;<i>     &gt;&gt; Token value=null;
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; If I can get some pointers about where to look/what to look for
</I>&gt;&gt;<i>    in the
</I>&gt;&gt;<i>     &gt;&gt; code generators (eg: template fragments) I might be able to get
</I>&gt;&gt;<i> more
</I>&gt;&gt;<i>     &gt;&gt; info on the code that's playing up. It could be a bad JAR that's
</I>&gt;&gt;<i>    being
</I>&gt;&gt;<i>     &gt;&gt; retrieved by my build system (Apache Ivy).
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; Cheers,
</I>&gt;&gt;<i>     &gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt; On 23/07/64 5:59 AM, Ivan Brezina wrote:
</I>&gt;&gt;<i>     &gt;&gt;&gt; Hi
</I>&gt;&gt;<i>     &gt;&gt;&gt; maybe you're hitting already discovered bug. This was
</I>&gt;&gt;<i>    introduced in the
</I>&gt;&gt;<i>     &gt;&gt;&gt; version 3.4. What does the output look like when you use ANTLR
</I>&gt;&gt;<i>    version
</I>&gt;&gt;<i>     &gt;&gt;&gt; 3.3?
</I>&gt;&gt;<i>     &gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt; Ivan
</I>&gt;&gt;<i>     &gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt; Quoting Kieran Simpson &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">kierans777 at gmail.com</A>
</I>&gt;&gt;<i>    &lt;mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">kierans777 at gmail.com</A>&gt;&gt;**:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     &gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; For my rule:
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; rule
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; : OPTION1
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; | value=TION2 -&gt; ($value)
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; ;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; with backtracking on (and memoize not that I think that's
</I>&gt;&gt;<i>    relevant) the
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; synpredicate code generated has errors, both for the Java and
</I>&gt;&gt;<i>    C targets
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; where the variable name is missing in the declaration
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; eg:
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; public final void synpred9_grammar_fragment() throws
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; RecognitionException {
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; Token =ll;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; and
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; static void synpred9_grammar_fragment(**pCoreConfigurationParser
</I>&gt;&gt;<i>    ctx )
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; {
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; pANTLR3_COMMON_TOKEN ;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; =ULL;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; Interestingly this grammar runs in debug mode when used with
</I>&gt;&gt;<i>    Antlrworks
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; even though I'm using version 3.4 of Antlr with my project and
</I>&gt;&gt;<i>    3.4 is
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; included with Antlrworks (1.4.3).
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; Just in case it's due to an out of date version, here are some
</I>&gt;&gt;<i>    md5sums
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; 9638f9b7b1b823fcaba977f06f0dd7**61 ./antlr/3.4/antlrworks-1.4.3.
</I>&gt;&gt;<i> **jar
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; 465472089d78cd80f926f5825a29ec**7f ./lib/antlr-3.4.jar
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; 0e0318be407e51fdf7ba6777eabfdf**73 ./lib/antlr-runtime-3.4.jar
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; Is something out of date here or is this a bug with the
</I>&gt;&gt;<i>    backtracking
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; generation?
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt;
</I>&gt;&gt;<i>     &gt;&gt;&gt;&gt; Cheers,
</I>&gt;&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="044265.html">[antlr-interest] Backtracking and labels
</A></li>
	<LI>Next message: <A HREF="044288.html">[antlr-interest] Backtracking and labels
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44266">[ date ]</a>
              <a href="thread.html#44266">[ thread ]</a>
              <a href="subject.html#44266">[ subject ]</a>
              <a href="author.html#44266">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
