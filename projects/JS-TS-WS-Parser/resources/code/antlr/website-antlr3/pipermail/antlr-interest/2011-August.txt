From iannone at cs.manchester.ac.uk  Mon Aug  1 09:10:38 2011
From: iannone at cs.manchester.ac.uk (Luigi Iannone)
Date: Mon, 1 Aug 2011 17:10:38 +0100
Subject: [antlr-interest] Exception when generating tree grammar
Message-ID: <2F8BDDF1-E693-44CB-862A-6DED9F8BAE08@cs.manchester.ac.uk>

Hi all,

the purpose of the following grammar is to simplify trees. The idea is to remove CONJUNCTION and DISJUNCTION nodes that have only one child



 tree grammar ManchesterOWLSyntaxSimplify;

options {
  language = Java;
  tokenVocab = ManchesterOWLSyntax;
  ASTLabelType = ManchesterOWLSyntaxTree;
  filter=true;
  output= AST;
}

@header {
  package org.coode.parsers;
}

bottomup  : 
    conjunction 
    |	disjunction
  
  ;
   
conjunction :
  ^(CONJUNCTION single= .) -> ^($single)
  ;
 
disjunction  :
	^(DISJUNCTION single= .) -> ^($single) 
	; 
 
 
However when I try to generate the code with ANTRLWorks 1.4.2 I get the exception pasted below.
What am I doing wrong?

Thanks in advance,

Luigi



[17:07:50] error(10):  internal error: /Users/luigi/Documents/workspace/Parsers/src/ManchesterOWLSyntaxSimplify.g : java.lang.IllegalArgumentException: Can't find template rewriteWildcardLabelRefRoot.st; group hierarchy is [Java]
org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:507)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:484)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:484)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:392)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:404)
org.antlr.grammar.v2.CodeGenTreeWalker.rewrite_atom(CodeGenTreeWalker.java:3068)
org.antlr.grammar.v2.CodeGenTreeWalker.rewrite_tree(CodeGenTreeWalker.java:3193)
org.antlr.grammar.v2.CodeGenTreeWalker.rewrite_element(CodeGenTreeWalker.java:2666)
org.antlr.grammar.v2.CodeGenTreeWalker.rewrite_alternative(CodeGenTreeWalker.java:2521)
org.antlr.grammar.v2.CodeGenTreeWalker.rewrite(CodeGenTreeWalker.java:1422)
org.antlr.grammar.v2.CodeGenTreeWalker.block(CodeGenTreeWalker.java:1084)
org.antlr.grammar.v2.CodeGenTreeWalker.rule(CodeGenTreeWalker.java:797)
org.antlr.grammar.v2.CodeGenTreeWalker.rules(CodeGenTreeWalker.java:588)
org.antlr.grammar.v2.CodeGenTreeWalker.grammarSpec(CodeGenTreeWalker.java:530)
org.antlr.grammar.v2.CodeGenTreeWalker.grammar(CodeGenTreeWalker.java:336)
org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:430)
org.antlr.Tool.generateRecognizer(Tool.java:642)
org.antlr.Tool.process(Tool.java:455)
org.antlr.works.generate.CodeGenerate.generate(CodeGenerate.java:104)
org.antlr.works.generate.CodeGenerate.run(CodeGenerate.java:185)
java.lang.Thread.run(Thread.java:680)




From researcher0x00 at gmail.com  Mon Aug  1 15:49:28 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Mon, 1 Aug 2011 18:49:28 -0400
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
Message-ID: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>

I am working on building an ANTLR appliance and being a C# person have never
spent much if any time with Eclipse ANTLR plugins.
Checking the wiki page"Integration with Development Environments" I see two
plugins for Eclipse. AntlrDT and ANTLR IDE.

Does anyone know if they are stable enoungh to include in an appliance. i.e
The appliance should only be updated one or twice a year and so needs very
stable versions.

Thanks Eric

From ssmith at mainstreamdata.com  Tue Aug  2 16:11:19 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Tue, 2 Aug 2011 23:11:19 +0000
Subject: [antlr-interest] Help with a parser
Message-ID: <B29111A755EFB5419E6C7BC998C6E86742A6A6@hedwig.slc.mainstreamdata.com>

I assume this is the proper place to put this.  I'm trying to build a parser for filters generated by SOLR (lucene.apache.org).

Examples of valid "sentences" the parser should parse are:

fq = fred

fq = (fred OR bill)

fq = harry:(fred OR bill)

fq = (harry:fred OR jack:bill)

fq = ((harry:fred OR bill) AND (jane OR marry:sally))

terms can be nested to arbitrary levels.  The colon really binds to the word before it (e.g., "harry:").

I've listed the parser below (which doesn't work).  Can someone suggest what I can do?  It seems like a simple problem, but so far I haven't cracked it.  I will admit that I've only been playing with Antlr the last week or so.  I did play all of Scott Stanchfield's excellent videos on vimeo.  But, still I'm confused.

When I run the parser in antlrworks with example 3 ("fq = harry:(fred OR bill)" - no quote marks), it finds "fq = harry:(fred" and then it wants the right paren instead of expanding out the filter_expr rule.  What am I missing?

Thanks

Scott

Here's the parser.

grammar testGrammer;

options {
  language = Java;
}

@header {
  package a.b.c;
}

@lexer::header {
  package a.b.c;
}

filter:
  'fq' '=' filter_expr EOF
  ;

term
  : KEYWORD
  | STRING
  | '(' filter_expr ')'
  ;

fieldname
     :    FIELDNAME? term
     ;


filter_expr:
  fieldname (((AND | OR | NOT))? fieldname)*
  ;

FIELDNAME
     :    KEYWORD ':' ;

AND : 'AND' | '&&' ;
OR  : 'OR' | '||' ;
NOT : 'NOT' | '!' ;
KEYWORD : LETTER (LETTER | NUM_CHAR | '_')*;
STRING : '"' NONCONTROL_CHAR* '"' ;
WS  : ' ' | '\t' | '\n' | '\r' | '\u3000' {$channel=HIDDEN; } ;

fragment NONCONTROL_CHAR: LETTER | NUM_CHAR | SPACE | SYMBOL;
fragment SYMBOL:  ' '..'!' | '#'..'/' | ':'..'@' | '['..'`' | '{'..'~';
fragment LETTER: LOWER | UPPER;
fragment LOWER: 'a'..'z';
fragment UPPER: 'A'..'Z';
fragment NUM_CHAR: '0'..'9';
fragment SPACE: ' ' | '\t';

From kirby.bohling at gmail.com  Tue Aug  2 16:50:47 2011
From: kirby.bohling at gmail.com (Kirby Bohling)
Date: Tue, 2 Aug 2011 18:50:47 -0500
Subject: [antlr-interest] Help with a parser
In-Reply-To: <B29111A755EFB5419E6C7BC998C6E86742A6A6@hedwig.slc.mainstreamdata.com>
References: <B29111A755EFB5419E6C7BC998C6E86742A6A6@hedwig.slc.mainstreamdata.com>
Message-ID: <CA+bn5ryqQUQqjBdx-V6kz1e=sYDt5EecZbEFAMD=0SpqvQCZmg@mail.gmail.com>

By examination, I didn't run the grammar through ANTLR, I'm pretty
sure this is your problem:

 FIELDNAME
     :    KEYWORD ':' ;

FIELDNAME is a Lexer Rule, and KEYWORD is your lexer rule.  I'm pretty
sure that is at least one of the problem.  For me, every time ANTLR
does this the easiest thing to do is make sure the lexer is generating
the _exactly_ the tokens I think it does.  Generally, if I did
something obviously dumb in the parser, I'll spot it inside of 60
seconds.  The ones that take a long time to spot are when I'm sure I
know what tokens are being generated, and I'm wrong.

My guess here is that your guess as to which tokens are being
generated is wrong.  If you'd given the actual error message output,
it would I'd be more confident in my analysis.  Not sure what the best
way to go about fixing this is.  Not sure if you should create a
fragment named KEYWORD_STUB and then use it both places you use it in
the FIELDNAME and KEYWORD lexer rules, or if you should figure out how
to accomplish this some other way.

I'm 99% sure, this is a case where you are doing too much in the
lexer.  You might consider making a ':' a first class token, and
eliminate the difference between STRING vs. KEYWORD.  As Jim Idle
always points out, Lexer errors are useless to humans.  Parser errors
are better, but Tree Walker errors are the best place to generate
error messages.  If you have on token type for STRING and KEYWORD, and
a separate token for ':', pretty much everything you put in there will
Lex.  Then at least when you get to the parser, you'll be able to
generate a decent error message, rather than saying "Unexpected
character '1' at offset: 4", for an input like 'A 12:XYZ' (because it
appears keywords aren't allow to start with numbers).  You'd much
rather tell them "12" is not a valid keyword at offset: 4... You can
only do that if it lexes.  The parser will be able to kick out such an
error message (and likely the tree walker also).

Best of luck, I use SOLR and Lucene, so I look forward to better parsers!

Kirby



On Tue, Aug 2, 2011 at 6:11 PM, Scott Smith <ssmith at mainstreamdata.com> wrote:
> I assume this is the proper place to put this. ?I'm trying to build a parser for filters generated by SOLR (lucene.apache.org).
>
> Examples of valid "sentences" the parser should parse are:
>
> fq = fred
>
> fq = (fred OR bill)
>
> fq = harry:(fred OR bill)
>
> fq = (harry:fred OR jack:bill)
>
> fq = ((harry:fred OR bill) AND (jane OR marry:sally))
>
> terms can be nested to arbitrary levels. ?The colon really binds to the word before it (e.g., "harry:").
>
> I've listed the parser below (which doesn't work). ?Can someone suggest what I can do? ?It seems like a simple problem, but so far I haven't cracked it. ?I will admit that I've only been playing with Antlr the last week or so. ?I did play all of Scott Stanchfield's excellent videos on vimeo. ?But, still I'm confused.
>
> When I run the parser in antlrworks with example 3 ("fq = harry:(fred OR bill)" - no quote marks), it finds "fq = harry:(fred" and then it wants the right paren instead of expanding out the filter_expr rule. ?What am I missing?
>
> Thanks
>
> Scott
>
> Here's the parser.
>
> grammar testGrammer;
>
> options {
> ?language = Java;
> }
>
> @header {
> ?package a.b.c;
> }
>
> @lexer::header {
> ?package a.b.c;
> }
>
> filter:
> ?'fq' '=' filter_expr EOF
> ?;
>
> term
> ?: KEYWORD
> ?| STRING
> ?| '(' filter_expr ')'
> ?;
>
> fieldname
> ? ? : ? ?FIELDNAME? term
> ? ? ;
>
>
> filter_expr:
> ?fieldname (((AND | OR | NOT))? fieldname)*
> ?;
>
> FIELDNAME
> ? ? : ? ?KEYWORD ':' ;
>
> AND : 'AND' | '&&' ;
> OR ?: 'OR' | '||' ;
> NOT : 'NOT' | '!' ;
> KEYWORD : LETTER (LETTER | NUM_CHAR | '_')*;
> STRING : '"' NONCONTROL_CHAR* '"' ;
> WS ?: ' ' | '\t' | '\n' | '\r' | '\u3000' {$channel=HIDDEN; } ;
>
> fragment NONCONTROL_CHAR: LETTER | NUM_CHAR | SPACE | SYMBOL;
> fragment SYMBOL: ?' '..'!' | '#'..'/' | ':'..'@' | '['..'`' | '{'..'~';
> fragment LETTER: LOWER | UPPER;
> fragment LOWER: 'a'..'z';
> fragment UPPER: 'A'..'Z';
> fragment NUM_CHAR: '0'..'9';
> fragment SPACE: ' ' | '\t';
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jbb at acm.org  Tue Aug  2 18:02:29 2011
From: jbb at acm.org (John B. Brodie)
Date: Tue, 02 Aug 2011 21:02:29 -0400
Subject: [antlr-interest] Help with a parser
In-Reply-To: <B29111A755EFB5419E6C7BC998C6E86742A6A6@hedwig.slc.mainstreamdata.com>
References: <B29111A755EFB5419E6C7BC998C6E86742A6A6@hedwig.slc.mainstreamdata.com>
Message-ID: <1312333349.5958.13.camel@gecko>

Greetings!

On Tue, 2011-08-02 at 23:11 +0000, Scott Smith wrote:
> I assume this is the proper place to put this.  I'm trying to build a parser for filters generated by SOLR (lucene.apache.org).

i think this is exactly the correct place to post questions of this
kind.

> 
> Examples of valid "sentences" the parser should parse are:
> 
> fq = fred
> 
> fq = (fred OR bill)
> 
> fq = harry:(fred OR bill)
> 
> fq = (harry:fred OR jack:bill)
> 
> fq = ((harry:fred OR bill) AND (jane OR marry:sally))
> 
> terms can be nested to arbitrary levels.  The colon really binds to the word before it (e.g., "harry:").
> 
> I've listed the parser below (which doesn't work).  Can someone suggest what I can do?  It seems like a simple problem, but so far I haven't cracked it.  I will admit that I've only been playing with Antlr the last week or so.  I did play all of Scott Stanchfield's excellent videos on vimeo.  But, still I'm confused.
> 
> When I run the parser in antlrworks with example 3 ("fq = harry:(fred OR bill)" - no quote marks), it finds "fq = harry:(fred" and then it wants the right paren instead of expanding out the filter_expr rule.  What am I missing?

I assume you are using the Interpreter in ANTLRWorks and not the
Debugger.

If so, do not do that. ANTLRWorks' interpreter has a few quirks.

I do not use ANTLRWorks so can not really say for sure but I think using
the Debugger is the perferred way to go when using ANTLRWorks.


Your grammar, with just 1 change, operates just as you expect when
Tool'd, Compiled, and Executed from the command line.

Your WS rule needs some parens to group the characters to be hidden ---
due to ANTLR's meta-operator precedence for actions vs alternatives. So
replace your WS rule with this:

WS  : (' ' | '\t' | '\n' | '\r' | '\u3000') {$channel=HIDDEN; } ;

and it just works. 

I can post my test driver if you want...



oh and a small nitpick. the concept of KEYWORD usually equates to a
reserved word in the language (like your AND and OR and NOT). I would
suggest that the concept of IDENTIFIER more closely matches what you
have as keyword. Just nitpicking, sorry....


Hope this helps.
   -jbb



> Thanks
> 
> Scott
> 
> Here's the parser.
> 
> grammar testGrammer;
> 
> options {
>   language = Java;
> }
> 
> @header {
>   package a.b.c;
> }
> 
> @lexer::header {
>   package a.b.c;
> }
> 
> filter:
>   'fq' '=' filter_expr EOF
>   ;
> 
> term
>   : KEYWORD
>   | STRING
>   | '(' filter_expr ')'
>   ;
> 
> fieldname
>      :    FIELDNAME? term
>      ;
> 
> 
> filter_expr:
>   fieldname (((AND | OR | NOT))? fieldname)*
>   ;
> 
> FIELDNAME
>      :    KEYWORD ':' ;
> 
> AND : 'AND' | '&&' ;
> OR  : 'OR' | '||' ;
> NOT : 'NOT' | '!' ;
> KEYWORD : LETTER (LETTER | NUM_CHAR | '_')*;
> STRING : '"' NONCONTROL_CHAR* '"' ;
> WS  : ' ' | '\t' | '\n' | '\r' | '\u3000' {$channel=HIDDEN; } ;
> 
> fragment NONCONTROL_CHAR: LETTER | NUM_CHAR | SPACE | SYMBOL;
> fragment SYMBOL:  ' '..'!' | '#'..'/' | ':'..'@' | '['..'`' | '{'..'~';
> fragment LETTER: LOWER | UPPER;
> fragment LOWER: 'a'..'z';
> fragment UPPER: 'A'..'Z';
> fragment NUM_CHAR: '0'..'9';
> fragment SPACE: ' ' | '\t';



From ssmith at mainstreamdata.com  Tue Aug  2 21:44:49 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Wed, 3 Aug 2011 04:44:49 +0000
Subject: [antlr-interest] Help with a parser
In-Reply-To: <1312333349.5958.13.camel@gecko>
References: <B29111A755EFB5419E6C7BC998C6E86742A6A6@hedwig.slc.mainstreamdata.com>
	<1312333349.5958.13.camel@gecko>
Message-ID: <B29111A755EFB5419E6C7BC998C6E86742ABE0@hedwig.slc.mainstreamdata.com>

Thanks so much.   I guess I was looking for something complicated in how I wrote the EBNF.  I used the same parser (with your modification) on a much more complicated example and it also worked.    So, this was very helpful.

I will look at your other suggestion as well.  I like people with an opinion (nitpicky or not)!!  I appreciate your quick response.

Thanks again

I also appreciate Kirby taking the time to make suggestions.  While his "suspicion" wasn't correct, I still appreciate the comments as it will help me learn.

Cheers to you both.  I'll get back to trying to understand Mr. Parr's books. :-)

Scott

-----Original Message-----
From: John B. Brodie [mailto:jbb at acm.org] 
Sent: Tuesday, August 02, 2011 7:02 PM
To: Scott Smith
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Help with a parser

Greetings!

On Tue, 2011-08-02 at 23:11 +0000, Scott Smith wrote:
> I assume this is the proper place to put this.  I'm trying to build a parser for filters generated by SOLR (lucene.apache.org).

i think this is exactly the correct place to post questions of this kind.

> 
> Examples of valid "sentences" the parser should parse are:
> 
> fq = fred
> 
> fq = (fred OR bill)
> 
> fq = harry:(fred OR bill)
> 
> fq = (harry:fred OR jack:bill)
> 
> fq = ((harry:fred OR bill) AND (jane OR marry:sally))
> 
> terms can be nested to arbitrary levels.  The colon really binds to the word before it (e.g., "harry:").
> 
> I've listed the parser below (which doesn't work).  Can someone suggest what I can do?  It seems like a simple problem, but so far I haven't cracked it.  I will admit that I've only been playing with Antlr the last week or so.  I did play all of Scott Stanchfield's excellent videos on vimeo.  But, still I'm confused.
> 
> When I run the parser in antlrworks with example 3 ("fq = harry:(fred OR bill)" - no quote marks), it finds "fq = harry:(fred" and then it wants the right paren instead of expanding out the filter_expr rule.  What am I missing?

I assume you are using the Interpreter in ANTLRWorks and not the Debugger.

If so, do not do that. ANTLRWorks' interpreter has a few quirks.

I do not use ANTLRWorks so can not really say for sure but I think using the Debugger is the perferred way to go when using ANTLRWorks.


Your grammar, with just 1 change, operates just as you expect when Tool'd, Compiled, and Executed from the command line.

Your WS rule needs some parens to group the characters to be hidden --- due to ANTLR's meta-operator precedence for actions vs alternatives. So replace your WS rule with this:

WS  : (' ' | '\t' | '\n' | '\r' | '\u3000') {$channel=HIDDEN; } ;

and it just works. 

I can post my test driver if you want...



oh and a small nitpick. the concept of KEYWORD usually equates to a reserved word in the language (like your AND and OR and NOT). I would suggest that the concept of IDENTIFIER more closely matches what you have as keyword. Just nitpicking, sorry....


Hope this helps.
   -jbb



> Thanks
> 
> Scott
> 
> Here's the parser.
> 
> grammar testGrammer;
> 
> options {
>   language = Java;
> }
> 
> @header {
>   package a.b.c;
> }
> 
> @lexer::header {
>   package a.b.c;
> }
> 
> filter:
>   'fq' '=' filter_expr EOF
>   ;
> 
> term
>   : KEYWORD
>   | STRING
>   | '(' filter_expr ')'
>   ;
> 
> fieldname
>      :    FIELDNAME? term
>      ;
> 
> 
> filter_expr:
>   fieldname (((AND | OR | NOT))? fieldname)*
>   ;
> 
> FIELDNAME
>      :    KEYWORD ':' ;
> 
> AND : 'AND' | '&&' ;
> OR  : 'OR' | '||' ;
> NOT : 'NOT' | '!' ;
> KEYWORD : LETTER (LETTER | NUM_CHAR | '_')*; STRING : '"' 
> NONCONTROL_CHAR* '"' ; WS  : ' ' | '\t' | '\n' | '\r' | '\u3000' 
> {$channel=HIDDEN; } ;
> 
> fragment NONCONTROL_CHAR: LETTER | NUM_CHAR | SPACE | SYMBOL; fragment 
> SYMBOL:  ' '..'!' | '#'..'/' | ':'..'@' | '['..'`' | '{'..'~'; 
> fragment LETTER: LOWER | UPPER; fragment LOWER: 'a'..'z'; fragment 
> UPPER: 'A'..'Z'; fragment NUM_CHAR: '0'..'9'; fragment SPACE: ' ' | 
> '\t';



From patrick.ericx at gmail.com  Wed Aug  3 09:28:11 2011
From: patrick.ericx at gmail.com (Patrick Ericx)
Date: Wed, 3 Aug 2011 18:28:11 +0200
Subject: [antlr-interest] question: sql 2003 grammar
Message-ID: <CAGCWanoNK_isoH6LU4n2NNr9p1W--uguqXjZVc=NB5QnqCMu3g@mail.gmail.com>

hello Douglas,

you've done some interesting  work on sql 2003 grammar,

I have some questions on the generated java code:
when I put the 2 grammars lexer & parser in an eclipse project,
I get build successful (antlr 3.3) after some seconds, even without touching
the memory settings.

but the generated java code cannot compile:

in attachment you find the list of 22 compilation errors.

is this expected, but not yet documented behaviour, or am I missing
something?

I've  found some topics  on eclipse  forums for this one:
The code for the static initializer is exceeding the 65535 bytes limit
sql2003Parser.java
http://www.eclipse.org/forums/index.php/t/214270/
but that is beyond my current knowledge ...

best regards,
patrick ericx
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sql2003_compile_errors.log
Type: application/octet-stream
Size: 2647 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20110803/07c7b543/attachment.obj 

From kingces95 at gmail.com  Thu Aug  4 01:48:20 2011
From: kingces95 at gmail.com (chris king)
Date: Thu, 4 Aug 2011 01:48:20 -0700
Subject: [antlr-interest] Have I found an Antlr CSharp3 lexer bug if...
In-Reply-To: <015301cc4e00$479a68d0$d6cf3a70$@pixelminegames.com>
References: <CAJQwtsjVczemK9d_1G=Phq2A4m+CCvKLq2TTEc2ehHyi4C6EsA@mail.gmail.com>
	<00f801cc4d6e$7f548a90$7dfd9fb0$@pixelminegames.com>
	<CAJQwtsj7BXGYLv7J2J8zma9Oa3d02PnF1+t9mvocuctJ3J_GFw@mail.gmail.com>
	<011101cc4d96$ec982990$c5c87cb0$@pixelminegames.com>
	<CAJQwtsgbcbZfXZu_pGaawgB=jN4CzDBJubzXTWTj=egeMhMb5A@mail.gmail.com>
	<015301cc4e00$479a68d0$d6cf3a70$@pixelminegames.com>
Message-ID: <CAJQwtsh-y6qEPOL+CoGjpBEpO2W0wX1gQHh=BJ5ygntFHtHy-A@mail.gmail.com>

Sam, while trying build my pre-processor with a mixed parser/lexer I ran
across what I think might be a bug. I reduced the repro below. I expected
the program below to accept "/**/ " but instead fails because the lexer
prediction enters PP_SKIPPED_CHARACTERS. That rule has a gated semantic
predicate which is always false. I expected a lexer rule with a gated
semantic predicate which is always false to never be matched. If I comment
out the PP_SKIPPED_CHARACTERS rule then it does match "/**/ ". So the
inclusion of that rule is cause the problem. Let me know if you think this
is a bug and if you can repro.

Thanks,
Chris


grammar Bug;

options {
   language=CSharp3;
   output=AST;
}

public start
  : DELIMITED_COMMENT !EOF
  ;

PP_SKIPPED_CHARACTERS
  : { false }? => ~(F_NEW_LINE_CHARACTER | F_PP_POUND_SIGN)
F_INPUT_CHARACTER*
  ;

DELIMITED_COMMENT
  : { true }? => '/*' .* '*/'
  ;

WHITESPACE
  : F_WHITESPACE {skip();}
  ;

fragment F_WHITESPACE
  : (' ' | '\t' | '\v' | '\f')+
  ;

fragment F_NEW_LINE_CHARACTER
  : '\r'
  | '\n'
  ;

fragment F_PP_POUND_SIGN
  : '#'
  ;

fragment F_INPUT_CHARACTER
  : ~F_NEW_LINE_CHARACTER
  ;

From themightystephen at googlemail.com  Thu Aug  4 06:02:25 2011
From: themightystephen at googlemail.com (Stephen Tuttlebee)
Date: Thu, 04 Aug 2011 14:02:25 +0100
Subject: [antlr-interest] Exception when generating tree grammar
In-Reply-To: <2F8BDDF1-E693-44CB-862A-6DED9F8BAE08@cs.manchester.ac.uk>
References: <2F8BDDF1-E693-44CB-862A-6DED9F8BAE08@cs.manchester.ac.uk>
Message-ID: <4E3A9861.5040808@googlemail.com>

Hi Luigi,

At first I was thinking, why the heck are you getting an error about a 
missing StringTemplate file when you have an AST as your output 
(output=AST). Then I looked more closely at the name of the .st file -- 
rewriteWildcardLabelRefRoot.st. I think ANTLR sometimes throws these 
slightly misleading exceptions when you have a syntax error in your 
grammar.

The above StringTemplate file mentions 'wildcard' and 'label' in it, so 
I guess that the syntax error you have is possibly due to the space 
between 'single=' (the label) and '.' (the wildcard character). 
Therefore if you change 'single= .' to 'single=.', that might solve your 
problem.

Stephen



From themightystephen at googlemail.com  Thu Aug  4 06:55:09 2011
From: themightystephen at googlemail.com (Stephen Tuttlebee)
Date: Thu, 04 Aug 2011 14:55:09 +0100
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
Message-ID: <4E3AA4BD.4040205@googlemail.com>

By 'stable', do you mean, 'it's not updated very often', or 'there are 
not many bugs'? I'm guessing you meant the former.
Also, what exactly do you mean by an 'ANTLR appliance'?

I've used ANTLR IDE, and found it to be very good. I much prefer it to 
ANTLRWorks. (Although I do still use ANTLRWork's debugging 
functionality; ANTLR IDE seems to require you to put in breakpoints 
everywhere in your grammar if you want to be able to (meaningfully) 
debug your grammar). It seems pretty stable in terms of its 
'bug-freeness'. Looking at the website, 
http://antlrv3ide.sourceforge.net/, it also seems that the plug-in has 
not been updated for half a year or so. Looks like there were about 5 or 
so updates over 2010, whilst there's not been any yet this year. 
Therefore you could infer that it's becoming more stable (either because 
it does not need updates or because the developer is not actively 
working on it at the moment).

As for ANTLR DT, I don't know anything about it.

You might find better (i.e. more official) answers on these things by 
searching for posts on this mailing list which refer to ANTLR IDE or 
AntlrDT (using Google). There might be posts by the plug-in writers 
themselves.

Stephen



From iannone at cs.manchester.ac.uk  Thu Aug  4 07:02:05 2011
From: iannone at cs.manchester.ac.uk (Luigi Iannone)
Date: Thu, 4 Aug 2011 15:02:05 +0100
Subject: [antlr-interest] Exception when generating tree grammar
In-Reply-To: <4E3A9861.5040808@googlemail.com>
References: <2F8BDDF1-E693-44CB-862A-6DED9F8BAE08@cs.manchester.ac.uk>
	<4E3A9861.5040808@googlemail.com>
Message-ID: <D904DE28-210C-4043-A2C2-BCC5F2A74C7F@cs.manchester.ac.uk>

Hi,

unfortunately the removal of the whitespace does not solve it.
I get the same error.

Cheers,

Luigi

On 4 Aug 2011, at 14:02, Stephen Tuttlebee wrote:

> Hi Luigi,
> 
> At first I was thinking, why the heck are you getting an error about a 
> missing StringTemplate file when you have an AST as your output 
> (output=AST). Then I looked more closely at the name of the .st file -- 
> rewriteWildcardLabelRefRoot.st. I think ANTLR sometimes throws these 
> slightly misleading exceptions when you have a syntax error in your 
> grammar.
> 
> The above StringTemplate file mentions 'wildcard' and 'label' in it, so 
> I guess that the syntax error you have is possibly due to the space 
> between 'single=' (the label) and '.' (the wildcard character). 
> Therefore if you change 'single= .' to 'single=.', that might solve your 
> problem.
> 
> Stephen
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From sharwell at pixelminegames.com  Thu Aug  4 07:04:08 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 4 Aug 2011 09:04:08 -0500
Subject: [antlr-interest] Have I found an Antlr CSharp3 lexer bug if...
In-Reply-To: <CAJQwtsh-y6qEPOL+CoGjpBEpO2W0wX1gQHh=BJ5ygntFHtHy-A@mail.gmail.com>
References: <CAJQwtsjVczemK9d_1G=Phq2A4m+CCvKLq2TTEc2ehHyi4C6EsA@mail.gmail.com>	<00f801cc4d6e$7f548a90$7dfd9fb0$@pixelminegames.com>	<CAJQwtsj7BXGYLv7J2J8zma9Oa3d02PnF1+t9mvocuctJ3J_GFw@mail.gmail.com>	<011101cc4d96$ec982990$c5c87cb0$@pixelminegames.com>	<CAJQwtsgbcbZfXZu_pGaawgB=jN4CzDBJubzXTWTj=egeMhMb5A@mail.gmail.com>	<015301cc4e00$479a68d0$d6cf3a70$@pixelminegames.com>
	<CAJQwtsh-y6qEPOL+CoGjpBEpO2W0wX1gQHh=BJ5ygntFHtHy-A@mail.gmail.com>
Message-ID: <040101cc52af$623b4e30$26b1ea90$@pixelminegames.com>

Hi Chris,

 

I'm using the released version 3.4.0 of the ANTLR CSharp3 target. I
copy/pasted the grammar below (aside from renaming it to Preprocessor) and
it passed the following unit test.

 

[TestMethod]

public void TestEmptyComment()

{

    string inputText = "/**/";

    var input = new ANTLRStringStream(inputText);

    var lexer = new PreprocessorLexer(input);

    var tokenStream = new CommonTokenStream(lexer);

    tokenStream.Fill();

 

    List<IToken> tokens = tokenStream.GetTokens();

    Assert.AreEqual(2, tokens.Count);

    Assert.AreEqual(PreprocessorLexer.DELIMITED_COMMENT, tokens[0].Type);

    Assert.AreEqual(inputText, tokens[0].Text);

    Assert.AreEqual(PreprocessorLexer.EOF, tokens[1].Type);

}

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Thursday, August 04, 2011 3:48 AM
To: Sam Harwell; antlr-interest at antlr.org
Subject: Re: Have I found an Antlr CSharp3 lexer bug if...

 

Sam, while trying build my pre-processor with a mixed parser/lexer I ran
across what I think might be a bug. I reduced the repro below. I expected
the program below to accept "/**/ " but instead fails because the lexer
prediction enters PP_SKIPPED_CHARACTERS. That rule has a gated semantic
predicate which is always false. I expected a lexer rule with a gated
semantic predicate which is always false to never be matched. If I comment
out the PP_SKIPPED_CHARACTERS rule then it does match "/**/ ". So the
inclusion of that rule is cause the problem. Let me know if you think this
is a bug and if you can repro.

 

Thanks,
Chris

 

grammar Bug; 

 

options {

   language=CSharp3;

   output=AST;

}

 

public start

  : DELIMITED_COMMENT !EOF

  ;

  

PP_SKIPPED_CHARACTERS

  : { false }? => ~(F_NEW_LINE_CHARACTER | F_PP_POUND_SIGN)
F_INPUT_CHARACTER*

  ;

  

DELIMITED_COMMENT

  : { true }? => '/*' .* '*/'

  ;

  

WHITESPACE

  : F_WHITESPACE {skip();}

  ;

  

fragment F_WHITESPACE

  : (' ' | '\t' | '\v' | '\f')+ 

  ;

 

fragment F_NEW_LINE_CHARACTER

  : '\r'

  | '\n'

  ;

  

fragment F_PP_POUND_SIGN

  : '#'

  ;

  

fragment F_INPUT_CHARACTER

  : ~F_NEW_LINE_CHARACTER

  ;


From themightystephen at googlemail.com  Thu Aug  4 07:41:08 2011
From: themightystephen at googlemail.com (Stephen Tuttlebee)
Date: Thu, 04 Aug 2011 15:41:08 +0100
Subject: [antlr-interest] Exception when generating tree grammar
In-Reply-To: <D904DE28-210C-4043-A2C2-BCC5F2A74C7F@cs.manchester.ac.uk>
References: <D904DE28-210C-4043-A2C2-BCC5F2A74C7F@cs.manchester.ac.uk>
Message-ID: <4E3AAF84.20600@googlemail.com>

Well, to refresh my memory on this term rewriting stuff you're doing, I 
looked at Terence Parr's Language Implementation Patterns book which has 
a section about this (if you have the book, it's p138 in the pdf edition).

I think then it might be your tree construction rewrite rules that are 
syntactically incorrect.
Maybe it should be:
-> $single
rather than:
-> ^($single)

Hope it works this time...
Stephen


From iannone at cs.manchester.ac.uk  Thu Aug  4 08:01:22 2011
From: iannone at cs.manchester.ac.uk (Luigi Iannone)
Date: Thu, 4 Aug 2011 16:01:22 +0100
Subject: [antlr-interest] Exception when generating tree grammar
In-Reply-To: <4E3AAF84.20600@googlemail.com>
References: <D904DE28-210C-4043-A2C2-BCC5F2A74C7F@cs.manchester.ac.uk>
	<4E3AAF84.20600@googlemail.com>
Message-ID: <4A648DF8-4E9F-4E6B-8A06-FCFB0AF0E675@cs.manchester.ac.uk>

It works,

Thanks,

Luigi
On 4 Aug 2011, at 15:41, Stephen Tuttlebee wrote:

> Well, to refresh my memory on this term rewriting stuff you're doing, I 
> looked at Terence Parr's Language Implementation Patterns book which has 
> a section about this (if you have the book, it's p138 in the pdf edition).
> 
> I think then it might be your tree construction rewrite rules that are 
> syntactically incorrect.
> Maybe it should be:
> -> $single
> rather than:
> -> ^($single)
> 
> Hope it works this time...
> Stephen
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From kingces95 at gmail.com  Thu Aug  4 11:04:28 2011
From: kingces95 at gmail.com (Chris King)
Date: Thu, 4 Aug 2011 11:04:28 -0700
Subject: [antlr-interest] Have I found an Antlr CSharp3 lexer bug if...
In-Reply-To: <040101cc52af$623b4e30$26b1ea90$@pixelminegames.com>
References: <CAJQwtsjVczemK9d_1G=Phq2A4m+CCvKLq2TTEc2ehHyi4C6EsA@mail.gmail.com>
	<00f801cc4d6e$7f548a90$7dfd9fb0$@pixelminegames.com>
	<CAJQwtsj7BXGYLv7J2J8zma9Oa3d02PnF1+t9mvocuctJ3J_GFw@mail.gmail.com>
	<011101cc4d96$ec982990$c5c87cb0$@pixelminegames.com>
	<CAJQwtsgbcbZfXZu_pGaawgB=jN4CzDBJubzXTWTj=egeMhMb5A@mail.gmail.com>
	<015301cc4e00$479a68d0$d6cf3a70$@pixelminegames.com>
	<CAJQwtsh-y6qEPOL+CoGjpBEpO2W0wX1gQHh=BJ5ygntFHtHy-A@mail.gmail.com>
	<040101cc52af$623b4e30$26b1ea90$@pixelminegames.com>
Message-ID: <B312DE79-BF6E-4DD3-9AAF-4374497EA8C4@gmail.com>

I should have called out the space after the comment. That's what caused the problem. "/**/ ". So the input string has 5 characters. 

Thanks,
Chris

On Aug 4, 2011, at 7:04 AM, "Sam Harwell" <sharwell at pixelminegames.com> wrote:

> Hi Chris,
> 
>  
> 
> I?m using the released version 3.4.0 of the ANTLR CSharp3 target. I copy/pasted the grammar below (aside from renaming it to Preprocessor) and it passed the following unit test.
> 
>  
> 
> [TestMethod]
> 
> public void TestEmptyComment()
> 
> {
> 
>     string inputText = "/**/";
> 
>     var input = new ANTLRStringStream(inputText);
> 
>     var lexer = new PreprocessorLexer(input);
> 
>     var tokenStream = new CommonTokenStream(lexer);
> 
>     tokenStream.Fill();
> 
>  
> 
>     List<IToken> tokens = tokenStream.GetTokens();
> 
>     Assert.AreEqual(2, tokens.Count);
> 
>     Assert.AreEqual(PreprocessorLexer.DELIMITED_COMMENT, tokens[0].Type);
> 
>     Assert.AreEqual(inputText, tokens[0].Text);
> 
>     Assert.AreEqual(PreprocessorLexer.EOF, tokens[1].Type);
> 
> }
> 
>  
> 
> Sam
> 
>  
> 
> From: chris king [mailto:kingces95 at gmail.com] 
> Sent: Thursday, August 04, 2011 3:48 AM
> To: Sam Harwell; antlr-interest at antlr.org
> Subject: Re: Have I found an Antlr CSharp3 lexer bug if...
> 
>  
> 
> Sam, while trying build my pre-processor with a mixed parser/lexer I ran across what I think might be a bug. I reduced the repro below. I expected the program below to accept "/**/ " but instead fails because the lexer prediction enters PP_SKIPPED_CHARACTERS. That rule has a gated semantic predicate which is always false. I expected a lexer rule with a gated semantic predicate which is always false to never be matched. If I comment out the PP_SKIPPED_CHARACTERS rule then it does match "/**/ ". So the inclusion of that rule is cause the problem. Let me know if you think this is a bug and if you can repro.
> 
>  
> 
> Thanks,
> Chris
> 
>  
> 
> grammar Bug; 
> 
>  
> 
> options {
> 
>    language=CSharp3;
> 
>    output=AST;
> 
> }
> 
>  
> 
> public start
> 
>   : DELIMITED_COMMENT !EOF
> 
>   ;
> 
>   
> 
> PP_SKIPPED_CHARACTERS
> 
>   : { false }? => ~(F_NEW_LINE_CHARACTER | F_PP_POUND_SIGN) F_INPUT_CHARACTER*
> 
>   ;
> 
>   
> 
> DELIMITED_COMMENT
> 
>   : { true }? => '/*' .* '*/'
> 
>   ;
> 
>   
> 
> WHITESPACE
> 
>   : F_WHITESPACE {skip();}
> 
>   ;
> 
>   
> 
> fragment F_WHITESPACE
> 
>   : (' ' | '\t' | '\v' | '\f')+ 
> 
>   ;
> 
>  
> 
> fragment F_NEW_LINE_CHARACTER
> 
>   : '\r'
> 
>   | '\n'
> 
>   ;
> 
>   
> 
> fragment F_PP_POUND_SIGN
> 
>   : '#'
> 
>   ;
> 
>   
> 
> fragment F_INPUT_CHARACTER
> 
>   : ~F_NEW_LINE_CHARACTER
> 
>   ;

From researcher0x00 at gmail.com  Thu Aug  4 11:16:54 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Thu, 4 Aug 2011 14:16:54 -0400
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <4E3AA4BD.4040205@googlemail.com>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
Message-ID: <CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>

Stephen,

Thanks for the response.

An appliance is a application that can run as a virtual machine. I am making
one for people just learning ANTLR but that have trouble installing the
various components, or possibly in classroom use. Think VMware or Virtual
Box.

Since posing the question I checked the licenses and only ANTLR IDE can be
used.

One interesting thing is that Eclipse is up to version 3.7 (Indigo) but as
you note ANTLR IDE has not been updated. Its latest version is for Eclipse
3.6 (Helios).

I have never used it, but your notes will be of value when I document using
it.

Thanks

Eric

From Todd.T.Stevenson at ge.com  Thu Aug  4 11:37:18 2011
From: Todd.T.Stevenson at ge.com (Stevenson, Todd (GE Healthcare))
Date: Thu, 4 Aug 2011 14:37:18 -0400
Subject: [antlr-interest] Line oriented parsing with Unix files on Windows
	machine
Message-ID: <B4B0A329ACAB3247830EA5930E0C902F0AF2A9B5@ALPMLVEM16.e2k.ad.ge.com>

I have a line-oriented grammar that uses the following rule to define an
end of line:

 

EOL : ('\r' | '\n')+;

 

My grammar parses input files fine when they are in windows format
(lines end with '\r\n'), however the parser doesn't work when the input
files are in unix format (lines end with '\n' only).  It seems to ignore
the new line character and attach it to the subsequent rule.   Is there
something I need to do the process these files correctly?  Any ideas?

 

Thanks.

 

 

 

 


From Janet.Hurwitz at usc-bt.com  Thu Aug  4 12:48:29 2011
From: Janet.Hurwitz at usc-bt.com (Janet.Hurwitz at usc-bt.com)
Date: Thu, 4 Aug 2011 19:48:29 +0000
Subject: [antlr-interest] Looking for an example of tree walking using
	push/pop
Message-ID: <38FABFD667C19E44BC00A04C59B658B90FA59241@usemp110.ins.com>

Hello- I'm working on a grammar that has nested subtrees. I am successfully parsing the input to create the AST, but am having trouble navigating the tree to build the structure my Java program needs. The output is a HashMap<String,Object>.  When it's not a leaf node, the Object in the map will be a HashMap<String,Object>. Can you point me to some examples of more complicated tree walkers than the ones I've been able to find? I have been though the video tutorial as well. Thanks in advance.



From knifed at gmail.com  Thu Aug  4 13:01:32 2011
From: knifed at gmail.com (Jeff Hair)
Date: Thu, 4 Aug 2011 16:01:32 -0400
Subject: [antlr-interest] Looking for an example of tree walking using
	push/pop
In-Reply-To: <38FABFD667C19E44BC00A04C59B658B90FA59241@usemp110.ins.com>
References: <38FABFD667C19E44BC00A04C59B658B90FA59241@usemp110.ins.com>
Message-ID: <CALv2TkV74x8NE9RVJthWhNQZZ4P=PH3K0Hs6e8_TdQiS4dtmfw@mail.gmail.com>

This has an example of how to go down the AST and then back up.

http://www.antlr.org/wiki/display/ANTLR3/Tree+pattern+matching

This is a concrete example of the method on the wiki. I used it in my
experiment about learning how to make an interpreter. EveCore calls the
downup method. The .g file is the grammar, of course.

https://github.com/ProjectMoon/eve2/blob/master/src/eve/core/EveCore.java#L227
https://github.com/ProjectMoon/eve2/blob/master/src/eve/core/ASTParser.g

On Thu, Aug 4, 2011 at 3:48 PM, <Janet.Hurwitz at usc-bt.com> wrote:

> Hello- I'm working on a grammar that has nested subtrees. I am successfully
> parsing the input to create the AST, but am having trouble navigating the
> tree to build the structure my Java program needs. The output is a
> HashMap<String,Object>.  When it's not a leaf node, the Object in the map
> will be a HashMap<String,Object>. Can you point me to some examples of more
> complicated tree walkers than the ones I've been able to find? I have been
> though the video tutorial as well. Thanks in advance.
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From bkiers at gmail.com  Thu Aug  4 13:25:32 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Thu, 4 Aug 2011 22:25:32 +0200
Subject: [antlr-interest] Line oriented parsing with Unix files on
	Windows machine
In-Reply-To: <B4B0A329ACAB3247830EA5930E0C902F0AF2A9B5@ALPMLVEM16.e2k.ad.ge.com>
References: <B4B0A329ACAB3247830EA5930E0C902F0AF2A9B5@ALPMLVEM16.e2k.ad.ge.com>
Message-ID: <CAOrgODaDOe6swGeXZTyo4qUtt70Ck4eYLAjNgk7sLjzzFVM9Ng@mail.gmail.com>

Hi Todd,

Well, `EOL : ('\r' | '\n')+;` matches a single `\n`. So my guess is that
some other  rule in your grammar matches a `\n` as well. Can you post a
complete (small) grammar that shows the problem you're having?

Regards,

Bart.


On Thu, Aug 4, 2011 at 8:37 PM, Stevenson, Todd (GE Healthcare) <
Todd.T.Stevenson at ge.com> wrote:

> I have a line-oriented grammar that uses the following rule to define an
> end of line:
>
>
>
> EOL : ('\r' | '\n')+;
>
>
>
> My grammar parses input files fine when they are in windows format
> (lines end with '\r\n'), however the parser doesn't work when the input
> files are in unix format (lines end with '\n' only).  It seems to ignore
> the new line character and attach it to the subsequent rule.   Is there
> something I need to do the process these files correctly?  Any ideas?
>
>
>
> Thanks.
>
>
>
>
>
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From sharwell at pixelminegames.com  Thu Aug  4 16:34:53 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 4 Aug 2011 18:34:53 -0500
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>
Message-ID: <048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>

Hi Chris,

In build 3.4.1.9004 that I released today, I switched all the projects to
using $(ProjectDir) with relative paths.

http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
Sent: Monday, July 25, 2011 6:39 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] To Sam Harwell

Sam, hey, hope this finds you. Very small suggestion follows :). In
Antlr3.StringTemplate.csproj could you use


<AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
askPath>

to reference the bootstrap directory? Originally it used the solutionDir and
that prevented me from including a subset of the projects in my project (so
I could simply reference them and have all the debugging, pdb, source, etc
just work).

Thanks,
Chris

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From kingces95 at gmail.com  Thu Aug  4 16:47:37 2011
From: kingces95 at gmail.com (chris king)
Date: Thu, 4 Aug 2011 16:47:37 -0700
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>
	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>
Message-ID: <CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>

Awesome! I'll give it try. Did you see my follow up email that the parse
string is 5 characters (there is a trailing space)? "/**/ "

And again, love the tool chain. I only really started to get traction on my
project after I installed it. It's working great.

Thanks,
Chris

On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>wrote:

> Hi Chris,
>
> In build 3.4.1.9004 that I released today, I switched all the projects to
> using $(ProjectDir) with relative paths.
>
> http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases
>
> Sam
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
> Sent: Monday, July 25, 2011 6:39 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] To Sam Harwell
>
> Sam, hey, hope this finds you. Very small suggestion follows :). In
> Antlr3.StringTemplate.csproj could you use
>
>
>
> <AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
> askPath>
>
> to reference the bootstrap directory? Originally it used the solutionDir
> and
> that prevented me from including a subset of the projects in my project (so
> I could simply reference them and have all the debugging, pdb, source, etc
> just work).
>
> Thanks,
> Chris
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From ssmith at mainstreamdata.com  Thu Aug  4 18:15:23 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Fri, 5 Aug 2011 01:15:23 +0000
Subject: [antlr-interest] Another (hopefully easy) newby question
Message-ID: <B29111A755EFB5419E6C7BC998C6E867434DF8@hedwig.slc.mainstreamdata.com>

I have created a parser/lexer.  When I run it as a standard parser (no ASTs), it runs fine.  I've verified with the debugger, that it generates a reasonable tree.

But, I want to run it to generate ASTs.  So, I modified the code to do that (using ^ to promote operators and ! to eliminate some things).  I believe that is working just fine as well.

So, here's the problem.  My test harness looks like:

      String filename = ".\\somefile.txt";
      CharStream stream = new ANTLRFileStream(filename);
MyFilterLexer lexer = new MyFilterLexer(stream);
TokenStream tokenStream = new CommonTokenStream(lexer);
      MyFilterParser parser = new MyFilterParser(tokenStream);
      filter_return f = parser.filter();
      System.out.println(f.getTree().toString());

I want the print out to display the AST version of the parsed data.  I know it exists (at least mostly) because I can modify the top level parser item in my combined grammer as follows:

filter:
  FQ '='^ filter_expr EOF!
    {
      if ($filter_expr.tree != null)
        System.out.println($filter_expr.tree.toStringTree());
      else
        System.out.println("must be null");
    }
  ;

This compiles and does display (almost all) the ASTs as I would expect.  Note that it is referencing the "filter_expr" and not the "filter".  It does not display the "(= FQ" but the rest of my ASTs appear to be properly parsed and ordered.  If I change to use $filter instead, then I get the "must be null" message.

Isn't there a way to display the string of ASTs from the filter_return object?  Scott Stanchfield's video would say you could do "System.out.println(f.tree.getStringTree());", but that doesn't compile with Antlr 3.4.

If I run the harness as I have it above, it simply prints "=".

What am I missing?

Thanks

Scott


From jbb at acm.org  Thu Aug  4 19:09:09 2011
From: jbb at acm.org (John B. Brodie)
Date: Thu, 04 Aug 2011 22:09:09 -0400
Subject: [antlr-interest] Another (hopefully easy) newby question
In-Reply-To: <B29111A755EFB5419E6C7BC998C6E867434DF8@hedwig.slc.mainstreamdata.com>
References: <B29111A755EFB5419E6C7BC998C6E867434DF8@hedwig.slc.mainstreamdata.com>
Message-ID: <1312510149.14207.12.camel@gecko>

On Fri, 2011-08-05 at 01:15 +0000, Scott Smith wrote:
> I have created a parser/lexer.  When I run it as a standard parser (no ASTs),
> it runs fine.  I've verified with the debugger, that it generates a reasonable tree.
> 
> But, I want to run it to generate ASTs.  So, I modified the code to do that
> (using ^ to promote operators and ! to eliminate some things).  I believe that
> is working just fine as well.
> 
> So, here's the problem.  My test harness looks like:
> 
>       String filename = ".\\somefile.txt";
>       CharStream stream = new ANTLRFileStream(filename);
> MyFilterLexer lexer = new MyFilterLexer(stream);
> TokenStream tokenStream = new CommonTokenStream(lexer);
>       MyFilterParser parser = new MyFilterParser(tokenStream);
>       filter_return f = parser.filter();
>       System.out.println(f.getTree().toString());
> 
> I want the print out to display the AST version of the parsed data.  I know it
> exists (at least mostly) because I can modify the top level parser item in my
> combined grammer as follows:
> 
> filter:
>   FQ '='^ filter_expr EOF!
>     {
>       if ($filter_expr.tree != null)
>         System.out.println($filter_expr.tree.toStringTree());
>       else
>         System.out.println("must be null");
>     }
>   ;
> 
> This compiles and does display (almost all) the ASTs as I would expect.  Note that
> it is referencing the "filter_expr" and not the "filter".  It does not display the
> "(= FQ" but the rest of my ASTs appear to be properly parsed and ordered.  If I
> change to use $filter instead, then I get the "must be null" message.

when using the ^ and/or ! meta-operators, the result tree is not created
until the end of the rule.

technically your printing action is not at the end of the rule because
stuff could appear after that action.

put your print code in the rule's @after{...} section and a reference to
the rulename.tree will not be null.

> 
> Isn't there a way to display the string of ASTs from the filter_return object? 
> Scott Stanchfield's video would say you could do "System.out.println(f.tree.getStringTree());",
> but that doesn't compile with Antlr 3.4.
> 
> If I run the harness as I have it above, it simply prints "=".
> 

the toString() method of CommonTree does not recurse into the tree's
children (if any). so that is why you see just the root node printed by
your driver.

need to use the toStringTree() method in your driver in order to get the
entire tree printed --- just as you did in your rule's printing action.




From ranco.marcus at epirion.nl  Fri Aug  5 03:11:37 2011
From: ranco.marcus at epirion.nl (Ranco Marcus)
Date: Fri, 5 Aug 2011 10:11:37 +0000
Subject: [antlr-interest] CSharp3 3.4.1.9004
References: <2B65C901391C804DBB9CF9E6FE30C6F96CACB2B5@sun.epirion.local>
Message-ID: <4B68E5D4-B5A4-414C-B882-29B400F9F78B@epirion.local>

Hi Sam,

Thanks for updating the CSharp3 runtime! All our grammars are running smoothly now.

Is there already some kind of documentation of the AntlrAbstractGrammar Build Action?

Best regards,

Ranco Marcus

From ssmith at mainstreamdata.com  Fri Aug  5 11:31:57 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Fri, 5 Aug 2011 18:31:57 +0000
Subject: [antlr-interest] Another (hopefully easy) newby question
In-Reply-To: <1312510149.14207.12.camel@gecko>
References: <B29111A755EFB5419E6C7BC998C6E867434DF8@hedwig.slc.mainstreamdata.com>
	<1312510149.14207.12.camel@gecko>
Message-ID: <B29111A755EFB5419E6C7BC998C6E867436884@hedwig.slc.mainstreamdata.com>

I woke up this morning and realized what the problem was.  You can't access the "tree" member variable in filter_return directly because it's private.  So, I have to use getTree().  The return type for getTree() is a standard java Object.  However, I know it's a CommonTree (since that's what I specified in the parser definition).  So, I simply needed to cast the return to CommonTree.  CommonTree supports the toStringTree() and things now work as I wanted.  toStringTree() was coming up undefined because of the type of return for getTree() and that's what had me confused.

Thanks for your help

Scott

-----Original Message-----
From: John B. Brodie [mailto:jbb at acm.org] 
Sent: Thursday, August 04, 2011 8:09 PM
To: Scott Smith
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Another (hopefully easy) newby question

On Fri, 2011-08-05 at 01:15 +0000, Scott Smith wrote:
> I have created a parser/lexer.  When I run it as a standard parser (no ASTs),
> it runs fine.  I've verified with the debugger, that it generates a reasonable tree.
> 
> But, I want to run it to generate ASTs.  So, I modified the code to do that
> (using ^ to promote operators and ! to eliminate some things).  I believe that
> is working just fine as well.
> 
> So, here's the problem.  My test harness looks like:
> 
>       String filename = ".\\somefile.txt";
>       CharStream stream = new ANTLRFileStream(filename);
> MyFilterLexer lexer = new MyFilterLexer(stream);
> TokenStream tokenStream = new CommonTokenStream(lexer);
>       MyFilterParser parser = new MyFilterParser(tokenStream);
>       filter_return f = parser.filter();
>       System.out.println(f.getTree().toString());
> 
> I want the print out to display the AST version of the parsed data.  I know it
> exists (at least mostly) because I can modify the top level parser item in my
> combined grammer as follows:
> 
> filter:
>   FQ '='^ filter_expr EOF!
>     {
>       if ($filter_expr.tree != null)
>         System.out.println($filter_expr.tree.toStringTree());
>       else
>         System.out.println("must be null");
>     }
>   ;
> 
> This compiles and does display (almost all) the ASTs as I would expect.  Note that
> it is referencing the "filter_expr" and not the "filter".  It does not display the
> "(= FQ" but the rest of my ASTs appear to be properly parsed and ordered.  If I
> change to use $filter instead, then I get the "must be null" message.

when using the ^ and/or ! meta-operators, the result tree is not created
until the end of the rule.

technically your printing action is not at the end of the rule because
stuff could appear after that action.

put your print code in the rule's @after{...} section and a reference to
the rulename.tree will not be null.

> 
> Isn't there a way to display the string of ASTs from the filter_return object? 
> Scott Stanchfield's video would say you could do "System.out.println(f.tree.getStringTree());",
> but that doesn't compile with Antlr 3.4.
> 
> If I run the harness as I have it above, it simply prints "=".
> 

the toString() method of CommonTree does not recurse into the tree's
children (if any). so that is why you see just the root node printed by
your driver.

need to use the toStringTree() method in your driver in order to get the
entire tree printed --- just as you did in your rule's printing action.




From rod at infinitenil.com  Fri Aug  5 20:30:40 2011
From: rod at infinitenil.com (Rod Schmidt)
Date: Fri, 5 Aug 2011 21:30:40 -0600
Subject: [antlr-interest] Objective-C target problem no createTree:
Message-ID: <116EBFAB-F25F-420D-9C29-7A4DA338592B@infinitenil.com>

I'm using the latest antlr-3.4.jar to generate an ObjC target. The target is generated but I'm not sure it's correct. When I build I get the following warning (among others):

file://localhost/Users/rod/Desktop/Merlin/objc-impl/Merlin/Merlin/MerlinParser.m: warning: Semantic Issue: Instance method '-createTree:' not found (return type defaults to 'id')

I'm on Mac OS X Lion and using XCode 4.1. I've also downloaded the source to the Objective-C runtime, etc., and there is not a createTree: method. There are methods such as createTree:text:, etc. but no just createTree:

So at this point, I wondering. Is there a bug in the 3.4 (i.e. the templates are not correct), or am I just not setup right? Or is there something wrong with my grammar file? Here it is:

grammar Merlin;

options {
    language = ObjC;
    output = AST;
  
    // ANTLR can handle literally any tree node type.
    // For convenience, specify the Java type
    ASTLabelType = ANTLRCommonTree;    // type of $stat.tree ref etc.
}

@memVars {    
    // Map variable name to Integer object holding value
    NSMutableDictionary *memory;
}

@init {
    memory = [[NSMutableDictionary alloc] init];
}

/** Match a series of stat rules and, for each one, print out the
 * tree stat returns, $stat.tree. toStringTree() prints the tree
 * out in form: (root child1 .. childN). ANTLR's default tree
 * construction mechanism will build a list (flat tree) of the stat
 * result trees. This tree will be the input to the tree parser.
 */
prog    : ( stat { NSLog(@"\%@", $stat.tree == nil ? @"null" : [$stat.tree toStringTree]); } )+ ;

stat    : expr NEWLINE          -> expr
        | ID '=' expr NEWLINE   -> ^('=' ID expr)
        | NEWLINE               ->
        ;

expr    : multExpr (('+'^ | '-'^) multExpr)*
        ;

multExpr: atom ('*'^ atom)*
        ;

atom    : INT
        | ID
        | '('! expr ')'!
        ;

ID      : ('a'..'z' | 'A'..'Z')+ ;
INT     : '0'..'9'+ ;
NEWLINE : '\r'? '\n' ;
WS      : (' '|'\t')+  { [self skip]; } ;

If I take out the rewrite rules (i.e. all the AST generate stuff) and just use Objective-C code actions it works fine (lots of warnings though in the generated code).

If anybody could shed some light on this, I would very much appreciate it. Otherwise I'll have to try a C target or another tool besides ANTLR, which I'd rather not do since ANTLR seems like the best tool out there.

Thanks,

Rod Schmidt
www.infinitenil.com


From klausmartinschitz at gmail.com  Sat Aug  6 01:51:54 2011
From: klausmartinschitz at gmail.com (Klaus Martinschitz)
Date: Sat, 06 Aug 2011 10:51:54 +0200
Subject: [antlr-interest] AntlrWorks Problems
Message-ID: <4E3D00AA.3090008@gmail.com>

Hello,

I am new to Antlr and AntlrWorks but I must say that AntlrWorks drives 
me crazy. Perhaps someone can explain a very simple question to me.
I generate a grammar and compile it. I want AntlrWorks to save it in a 
src directory (indeed it is the src directory of a Netbeans project). 
This works. I define the save path in the

Properties-->General-->Output path field.

Now, if I want to debug the files, they have to be compiled. I assume 
AntlWroks to use javac to compile them. This also seems to work. The 
javac path is written to

Properties-->Compiler-->javac-->path

Then something happens I can not understand. there is a classes 
directory build within my output. It is not very nice that I can not 
specifiy where the class files are generated but OK, this is ugly but 
ok. The problem is, that AntlrWorks seems not to be able to connect to 
the class files. Of, course I have set the classpath custom option

Properties-->Compiler-->classpath-->custom

to the classes directory build. I get the errot message

Compiler failed with result code 1

How do you manage generated class objects, perhaps even in Netbeans, if 
you use them?

Thanks.

Regards,
Equi







From parrt at cs.usfca.edu  Sat Aug  6 09:57:57 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 6 Aug 2011 09:57:57 -0700
Subject: [antlr-interest] AntlrWorks Problems
In-Reply-To: <4E3D00AA.3090008@gmail.com>
References: <4E3D00AA.3090008@gmail.com>
Message-ID: <59815FBC-4523-410F-80E1-46A292C15FEB@cs.usfca.edu>

Hi Klaus, well, AW is not a build system. I use it in conjunction with Intellij.
Terence
On Aug 6, 2011, at 1:51 AM, Klaus Martinschitz wrote:

> Hello,
> 
> I am new to Antlr and AntlrWorks but I must say that AntlrWorks drives 
> me crazy. Perhaps someone can explain a very simple question to me.
> I generate a grammar and compile it. I want AntlrWorks to save it in a 
> src directory (indeed it is the src directory of a Netbeans project). 
> This works. I define the save path in the
> 
> Properties-->General-->Output path field.
> 
> Now, if I want to debug the files, they have to be compiled. I assume 
> AntlWroks to use javac to compile them. This also seems to work. The 
> javac path is written to
> 
> Properties-->Compiler-->javac-->path
> 
> Then something happens I can not understand. there is a classes 
> directory build within my output. It is not very nice that I can not 
> specifiy where the class files are generated but OK, this is ugly but 
> ok. The problem is, that AntlrWorks seems not to be able to connect to 
> the class files. Of, course I have set the classpath custom option
> 
> Properties-->Compiler-->classpath-->custom
> 
> to the classes directory build. I get the errot message
> 
> Compiler failed with result code 1
> 
> How do you manage generated class objects, perhaps even in Netbeans, if 
> you use them?
> 
> Thanks.
> 
> Regards,
> Equi
> 
> 
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Sat Aug  6 10:48:02 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 6 Aug 2011 10:48:02 -0700
Subject: [antlr-interest] AntlrWorks Problems
In-Reply-To: <4E3D00AA.3090008@gmail.com>
References: <4E3D00AA.3090008@gmail.com>
Message-ID: <06119d6a0691ef26e9bda69c25af32e0@mail.gmail.com>

Antlrworks is really either standalone (don't change where it
puts/compiles things) or a remote debugger (generate output with -debug)
and you are confounding these two cases. If using netbeans, then just use
Maven to build and install the ANTLR plugins. Remember to look at (perhaps
even read) the support page and antlr.markmail.org

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Klaus Martinschitz
> Sent: Saturday, August 06, 2011 1:52 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] AntlrWorks Problems
>
> Hello,
>
> I am new to Antlr and AntlrWorks but I must say that AntlrWorks drives
> me crazy. Perhaps someone can explain a very simple question to me.
> I generate a grammar and compile it. I want AntlrWorks to save it in a
> src directory (indeed it is the src directory of a Netbeans project).
> This works. I define the save path in the
>
> Properties-->General-->Output path field.
>
> Now, if I want to debug the files, they have to be compiled. I assume
> AntlWroks to use javac to compile them. This also seems to work. The
> javac path is written to
>
> Properties-->Compiler-->javac-->path
>
> Then something happens I can not understand. there is a classes
> directory build within my output. It is not very nice that I can not
> specifiy where the class files are generated but OK, this is ugly but
> ok. The problem is, that AntlrWorks seems not to be able to connect to
> the class files. Of, course I have set the classpath custom option
>
> Properties-->Compiler-->classpath-->custom
>
> to the classes directory build. I get the errot message
>
> Compiler failed with result code 1
>
> How do you manage generated class objects, perhaps even in Netbeans, if
> you use them?
>
> Thanks.
>
> Regards,
> Equi
>
>
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From acondit at ipns.com  Sat Aug  6 12:55:46 2011
From: acondit at ipns.com (Alan Condit)
Date: Sat, 6 Aug 2011 12:55:46 -0700
Subject: [antlr-interest] Objective-C target problem no createTree:
In-Reply-To: <mailman.0.1312657201.811.antlr-interest@antlr.org>
References: <mailman.0.1312657201.811.antlr-interest@antlr.org>
Message-ID: <C7153800-266D-4E23-8304-B07DEE62D118@ipns.com>

Rod,

From what you wrote I don't see the problem. There is not '-createTree:' there is a '-create:(id<ANTLRToken>)payload' in ANTLRBaseTreeAdaptor.h.

Alan

On Aug 6, 2011, at 12:00 PM, antlr-interest-request at antlr.org wrote:

> From: Rod Schmidt <rod at infinitenil.com>
> Date: August 5, 2011 8:30:40 PM PDT
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Objective-C target problem no createTree:
> 
> 
> I'm using the latest antlr-3.4.jar to generate an ObjC target. The target is generated but I'm not sure it's correct. When I build I get the following warning (among others):
> 
> file://localhost/Users/rod/Desktop/Merlin/objc-impl/Merlin/Merlin/MerlinParser.m: warning: Semantic Issue: Instance method '-createTree:' not found (return type defaults to 'id')
> 
> I'm on Mac OS X Lion and using XCode 4.1. I've also downloaded the source to the Objective-C runtime, etc., and there is not a createTree: method. There are methods such as createTree:text:, etc. but no just createTree:
> 
> So at this point, I wondering. Is there a bug in the 3.4 (i.e. the templates are not correct), or am I just not setup right? Or is there something wrong with my grammar file? Here it is:
> 
> grammar Merlin;
> 
> options {
>    language = ObjC;
>    output = AST;
> 
>    // ANTLR can handle literally any tree node type.
>    // For convenience, specify the Java type
>    ASTLabelType = ANTLRCommonTree;    // type of $stat.tree ref etc.
> }
> 
> @memVars {    
>    // Map variable name to Integer object holding value
>    NSMutableDictionary *memory;
> }
> 
> @init {
>    memory = [[NSMutableDictionary alloc] init];
> }
> 
> /** Match a series of stat rules and, for each one, print out the
> * tree stat returns, $stat.tree. toStringTree() prints the tree
> * out in form: (root child1 .. childN). ANTLR's default tree
> * construction mechanism will build a list (flat tree) of the stat
> * result trees. This tree will be the input to the tree parser.
> */
> prog    : ( stat { NSLog(@"\%@", $stat.tree == nil ? @"null" : [$stat.tree toStringTree]); } )+ ;
> 
> stat    : expr NEWLINE          -> expr
>        | ID '=' expr NEWLINE   -> ^('=' ID expr)
>        | NEWLINE               ->
>        ;
> 
> expr    : multExpr (('+'^ | '-'^) multExpr)*
>        ;
> 
> multExpr: atom ('*'^ atom)*
>        ;
> 
> atom    : INT
>        | ID
>        | '('! expr ')'!
>        ;
> 
> ID      : ('a'..'z' | 'A'..'Z')+ ;
> INT     : '0'..'9'+ ;
> NEWLINE : '\r'? '\n' ;
> WS      : (' '|'\t')+  { [self skip]; } ;
> 
> If I take out the rewrite rules (i.e. all the AST generate stuff) and just use Objective-C code actions it works fine (lots of warnings though in the generated code).
> 
> If anybody could shed some light on this, I would very much appreciate it. Otherwise I'll have to try a C target or another tool besides ANTLR, which I'd rather not do since ANTLR seems like the best tool out there.
> 
> Thanks,
> 
> Rod Schmidt
> www.infinitenil.com

---

Alan Condit
1085 Tierra Ct.
Woodburn, OR 97071

Email -- acondit at ipns.com
Home-Office (503) 982-0906


From sharwell at pixelminegames.com  Sat Aug  6 16:51:25 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Sat, 6 Aug 2011 18:51:25 -0500
Subject: [antlr-interest] Optimizations for CSharp3 target with large
	grammars and output=AST
Message-ID: <055001cc5493$c1788ad0$4469a070$@pixelminegames.com>

Hello everyone,

 

I'm working on codegen optimization for grammars with output=AST. Medium to
large grammars should see a significant improvement in the way local
variables are handled in rules, *especially* when rewrite operators are
used.

 

Since this is currently an experimental optimization, I'd prefer the initial
testers be advanced users familiar with both the creation/usage of grammars
and the C# code generated by ANTLR. If you have a grammar which would
particularly benefit from this and want to help test this version, let me
know and I'll send you information about the preview release. Here is a
summary of some the optimizations included:

 

.         Label aliasing where possible for both tokens and rule return
values.

.         Removal of Rewrite*Stream variables which are not actually
referenced by a rule's rewrite blocks.

.         Removal of local variables for tokens and rules which are not
referenced in an action and either aren't in the rewrite rule or have a
bang(!) operator.

 

Thanks,

Sam


From ngocminh.oss at gmail.com  Sat Aug  6 20:10:38 2011
From: ngocminh.oss at gmail.com (=?UTF-8?B?Tmfhu41jIE1pbmggTMOq?=)
Date: Sun, 7 Aug 2011 10:10:38 +0700
Subject: [antlr-interest] Identical characters cause error
Message-ID: <CANw1iroC3CYS2E8Ah-NobGVxJviDLczkbOY-MCye-mSVHMfkEg@mail.gmail.com>

This simplistic grammar can't be compiled:

grammar T;

x    :    '\u006c';
y    :    '\u006C';
z    :    'l';

ANTLR reports this error:

The following token definitions can never be matched because prior tokens
match the same input: T__5,T__6

In my grammar, by accident I had both ASCII character and Unicode escaped
character and it took me hours to figure out the problem. I think ANTLR
should recognize those are the same character before creating tokens for
them to avoid this error.

Best wishes,
Minh.

-- 
L? Ng?c Minh
Hanoi University of Science and Technology, Computer Science
Skype: ngocminh_oss | Yahoo: ngocminh_oss | Tel: +84 988 456 037

From ranco.marcus at epirion.nl  Sun Aug  7 00:09:01 2011
From: ranco.marcus at epirion.nl (Ranco Marcus)
Date: Sun, 7 Aug 2011 07:09:01 +0000
Subject: [antlr-interest] Optimizations for CSharp3 target with
	large	grammars and output=AST
In-Reply-To: <055001cc5493$c1788ad0$4469a070$@pixelminegames.com>
References: <055001cc5493$c1788ad0$4469a070$@pixelminegames.com>
Message-ID: <337B78C4-F948-4772-90C0-CBE35E8D628D@epirion.local>

Hi Sam,

Sounds interesting. I would be happy to test these improvements. Let me know if I can help you.

Regards, Ranco

On 7 aug. 2011, at 01:52, "Sam Harwell" <sharwell at pixelminegames.com> wrote:

> Hello everyone,
> 
> 
> 
> I'm working on codegen optimization for grammars with output=AST. Medium to
> large grammars should see a significant improvement in the way local
> variables are handled in rules, *especially* when rewrite operators are
> used.
> 
> 
> 
> Since this is currently an experimental optimization, I'd prefer the initial
> testers be advanced users familiar with both the creation/usage of grammars
> and the C# code generated by ANTLR. If you have a grammar which would
> particularly benefit from this and want to help test this version, let me
> know and I'll send you information about the preview release. Here is a
> summary of some the optimizations included:
> 
> 
> 
> .         Label aliasing where possible for both tokens and rule return
> values.
> 
> .         Removal of Rewrite*Stream variables which are not actually
> referenced by a rule's rewrite blocks.
> 
> .         Removal of local variables for tokens and rules which are not
> referenced in an action and either aren't in the rewrite rule or have a
> bang(!) operator.
> 
> 
> 
> Thanks,
> 
> Sam
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From dr.jaymahdi at gmail.com  Sun Aug  7 07:06:09 2011
From: dr.jaymahdi at gmail.com (Jay T)
Date: Sun, 7 Aug 2011 23:06:09 +0900
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
	<CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
Message-ID: <CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>

I had a compatibility issue with Eclipse 3.7 with the current version of
ANTLR IDE 2.1. I was not able to get Eclipse 3.7 to compile and generate the
target code from any grammar file that I wrote. Thus, I had to revert back
to 3.6.



On Fri, Aug 5, 2011 at 3:16 AM, The Researcher <researcher0x00 at gmail.com>wrote:

> Stephen,
>
> Thanks for the response.
>
> An appliance is a application that can run as a virtual machine. I am
> making
> one for people just learning ANTLR but that have trouble installing the
> various components, or possibly in classroom use. Think VMware or Virtual
> Box.
>
> Since posing the question I checked the licenses and only ANTLR IDE can be
> used.
>
> One interesting thing is that Eclipse is up to version 3.7 (Indigo) but as
> you note ANTLR IDE has not been updated. Its latest version is for Eclipse
> 3.6 (Helios).
>
> I have never used it, but your notes will be of value when I document using
> it.
>
> Thanks
>
> Eric
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From researcher0x00 at gmail.com  Sun Aug  7 11:38:29 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Sun, 7 Aug 2011 14:38:29 -0400
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
	<CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
	<CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>
Message-ID: <CAN45N10RT1VO61Qp_49xH+WW+-EeagwZWLMCrRRS8kR+Z0vr=g@mail.gmail.com>

Jay,

Thanks for the reply.

I had problems getting ANTLR IDE 2.1.1installed at first but using Debian 6
(Squeeze), Eclipse 3.5 (Galileo), and ANTLR IDE 2.0.2 I was able to install
and give it a quick test. I still need to do a full test with it.

The biggest problem I am facing is that I can not find any up to date Linux
packages for Eclipse, ANTLR, ANTLRWorks, or ANTLR IDE; so all the installs
are manual or using an older version of software.

Also, Edgar has not been posting to SourceForge for several months, but I
must say the plug-in is worth the effort. Thanks Edgar.

With regards to the appliance, the current one is at about 2.5 GB so I think
I will only be distributing the instructions unless I can find a place to
host the downloading of it for free.

VMWare and VirtualBox do host appliances for free downloading but VMware
requires rigorous testing and Oracle, for VirtualBox, only has several
appliances for download with none appearing to be user contributed.

Thanks, Eric

From rod at infinitenil.com  Sun Aug  7 12:53:52 2011
From: rod at infinitenil.com (Rod Schmidt)
Date: Sun, 7 Aug 2011 13:53:52 -0600
Subject: [antlr-interest] Objective-C target problem no createTree:
Message-ID: <EE726B05-C18B-44E1-9A92-6EB8D77C115A@infinitenil.com>

That 's the problem. ANTLR generates a call to createTree: but there is no createTree: Do I have the wrong templates? Is there a bug in the template? If so, how do I update them so the generate the right code?

Rod

> From what you wrote I don't see the problem. There is not '-createTree:' there is a '-create:(id<ANTLRToken>)payload' in ANTLRBaseTreeAdaptor.h.
> 
> Alan
> 
> On Aug 6, 2011, at 12:00 PM, antlr-interest-request at antlr.org wrote:
> 
>> From: Rod Schmidt <rod at infinitenil.com>
>> Date: August 5, 2011 8:30:40 PM PDT
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] Objective-C target problem no createTree:
>> 
>> 
>> I'm using the latest antlr-3.4.jar to generate an ObjC target. The target is generated but I'm not sure it's correct. When I build I get the following warning (among others):
>> 
>> file://localhost/Users/rod/Desktop/Merlin/objc-impl/Merlin/Merlin/MerlinParser.m: warning: Semantic Issue: Instance method '-createTree:' not found (return type defaults to 'id')
>> 
>> I'm on Mac OS X Lion and using XCode 4.1. I've also downloaded the source to the Objective-C runtime, etc., and there is not a createTree: method. There are methods such as createTree:text:, etc. but no just createTree:
>> 
>> So at this point, I wondering. Is there a bug in the 3.4 (i.e. the templates are not correct), or am I just not setup right? Or is there something wrong with my grammar file? Here it is:
>> 
>> grammar Merlin;
>> 
>> options {
>>   language = ObjC;
>>   output = AST;
>> 
>>   // ANTLR can handle literally any tree node type.
>>   // For convenience, specify the Java type
>>   ASTLabelType = ANTLRCommonTree;    // type of $stat.tree ref etc.
>> }
>> 
>> @memVars {    
>>   // Map variable name to Integer object holding value
>>   NSMutableDictionary *memory;
>> }
>> 
>> @init {
>>   memory = [[NSMutableDictionary alloc] init];
>> }
>> 
>> /** Match a series of stat rules and, for each one, print out the
>> * tree stat returns, $stat.tree. toStringTree() prints the tree
>> * out in form: (root child1 .. childN). ANTLR's default tree
>> * construction mechanism will build a list (flat tree) of the stat
>> * result trees. This tree will be the input to the tree parser.
>> */
>> prog    : ( stat { NSLog(@"\%@", $stat.tree == nil ? @"null" : [$stat.tree toStringTree]); } )+ ;
>> 
>> stat    : expr NEWLINE          -> expr
>>       | ID '=' expr NEWLINE   -> ^('=' ID expr)
>>       | NEWLINE               ->
>>       ;
>> 
>> expr    : multExpr (('+'^ | '-'^) multExpr)*
>>       ;
>> 
>> multExpr: atom ('*'^ atom)*
>>       ;
>> 
>> atom    : INT
>>       | ID
>>       | '('! expr ')'!
>>       ;
>> 
>> ID      : ('a'..'z' | 'A'..'Z')+ ;
>> INT     : '0'..'9'+ ;
>> NEWLINE : '\r'? '\n' ;
>> WS      : (' '|'\t')+  { [self skip]; } ;
>> 
>> If I take out the rewrite rules (i.e. all the AST generate stuff) and just use Objective-C code actions it works fine (lots of warnings though in the generated code).
>> 
>> If anybody could shed some light on this, I would very much appreciate it. Otherwise I'll have to try a C target or another tool besides ANTLR, which I'd rather not do since ANTLR seems like the best tool out there.
>> 
>> Thanks,
>> 
>> Rod Schmidt
>> www.infinitenil.com
> 
> ---
> 
> Alan Condit
> 1085 Tierra Ct.
> Woodburn, OR 97071
> 
> Email -- acondit at ipns.com
> Home-Office (503) 982-0906

From researcher0x00 at gmail.com  Sun Aug  7 13:53:38 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Sun, 7 Aug 2011 16:53:38 -0400
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <4E3EF815.9040402@shmuelhome.mine.nu>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
	<CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
	<CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>
	<CAN45N10RT1VO61Qp_49xH+WW+-EeagwZWLMCrRRS8kR+Z0vr=g@mail.gmail.com>
	<4E3EECEC.5020006@shmuelhome.mine.nu>
	<CAN45N11DXToraLh5sereNRieMYL6+dY+Gt4vGU9AwMzYnAwUwQ@mail.gmail.com>
	<4E3EF815.9040402@shmuelhome.mine.nu>
Message-ID: <CAN45N12g6gFULpEu3C4kJx0kQUwsFOO0VeoUTbcfXdzo3NcR1Q@mail.gmail.com>

Hi Shmuel,

I'll give it a go.

Could you just identify the correct names of the packages to use. Not being
a Fedora/Linux person I often find the wrong package. ie. ANTLR when I
really need ANTLR 3., or gnome when I need gnome-core.

Thanks, Eric

From antlr at shmuelhome.mine.nu  Sun Aug  7 14:31:48 2011
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Mon, 08 Aug 2011 00:31:48 +0300
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <CAN45N12g6gFULpEu3C4kJx0kQUwsFOO0VeoUTbcfXdzo3NcR1Q@mail.gmail.com>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
	<CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
	<CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>
	<CAN45N10RT1VO61Qp_49xH+WW+-EeagwZWLMCrRRS8kR+Z0vr=g@mail.gmail.com>
	<4E3EECEC.5020006@shmuelhome.mine.nu>
	<CAN45N11DXToraLh5sereNRieMYL6+dY+Gt4vGU9AwMzYnAwUwQ@mail.gmail.com>
	<4E3EF815.9040402@shmuelhome.mine.nu>
	<CAN45N12g6gFULpEu3C4kJx0kQUwsFOO0VeoUTbcfXdzo3NcR1Q@mail.gmail.com>
Message-ID: <4E3F0444.5060708@shmuelhome.mine.nu>


From antlr at shmuelhome.mine.nu  Sun Aug  7 14:52:29 2011
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Mon, 08 Aug 2011 00:52:29 +0300
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <4E3F0444.5060708@shmuelhome.mine.nu>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
	<CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
	<CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>
	<CAN45N10RT1VO61Qp_49xH+WW+-EeagwZWLMCrRRS8kR+Z0vr=g@mail.gmail.com>
	<4E3EECEC.5020006@shmuelhome.mine.nu>
	<CAN45N11DXToraLh5sereNRieMYL6+dY+Gt4vGU9AwMzYnAwUwQ@mail.gmail.com>
	<4E3EF815.9040402@shmuelhome.mine.nu>
	<CAN45N12g6gFULpEu3C4kJx0kQUwsFOO0VeoUTbcfXdzo3NcR1Q@mail.gmail.com>
	<4E3F0444.5060708@shmuelhome.mine.nu>
Message-ID: <4E3F091D.8010900@shmuelhome.mine.nu>


From antlr at shmuelhome.mine.nu  Sun Aug  7 14:55:57 2011
From: antlr at shmuelhome.mine.nu (shmuel siegel)
Date: Mon, 08 Aug 2011 00:55:57 +0300
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <CAN45N12g6gFULpEu3C4kJx0kQUwsFOO0VeoUTbcfXdzo3NcR1Q@mail.gmail.com>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
	<CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
	<CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>
	<CAN45N10RT1VO61Qp_49xH+WW+-EeagwZWLMCrRRS8kR+Z0vr=g@mail.gmail.com>
	<4E3EECEC.5020006@shmuelhome.mine.nu>
	<CAN45N11DXToraLh5sereNRieMYL6+dY+Gt4vGU9AwMzYnAwUwQ@mail.gmail.com>
	<4E3EF815.9040402@shmuelhome.mine.nu>
	<CAN45N12g6gFULpEu3C4kJx0kQUwsFOO0VeoUTbcfXdzo3NcR1Q@mail.gmail.com>
Message-ID: <4E3F09ED.6080902@shmuelhome.mine.nu>


From researcher0x00 at gmail.com  Sun Aug  7 20:33:44 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Sun, 7 Aug 2011 23:33:44 -0400
Subject: [antlr-interest] Are the Eclipse ANTLR plugins stable?
In-Reply-To: <4E3F13AD.9060201@shmuelhome.mine.nu>
References: <CAN45N12FznKu4xJi8dXZDetdh3-HyfSV+E_4M4e81nzGLA5hYw@mail.gmail.com>
	<4E3AA4BD.4040205@googlemail.com>
	<CAN45N10AAR+uEQjAX=psxPM8TRRPwM1rFk3jXcx3oSHDQxt79Q@mail.gmail.com>
	<CAGYdb_0vUZoNceVMJP41r-P34jGqXNUggeorY5m4dcYKQz5n5g@mail.gmail.com>
	<CAN45N10RT1VO61Qp_49xH+WW+-EeagwZWLMCrRRS8kR+Z0vr=g@mail.gmail.com>
	<4E3EECEC.5020006@shmuelhome.mine.nu>
	<CAN45N11DXToraLh5sereNRieMYL6+dY+Gt4vGU9AwMzYnAwUwQ@mail.gmail.com>
	<4E3EF815.9040402@shmuelhome.mine.nu>
	<CAN45N12g6gFULpEu3C4kJx0kQUwsFOO0VeoUTbcfXdzo3NcR1Q@mail.gmail.com>
	<4E3F0444.5060708@shmuelhome.mine.nu>
	<CAN45N12FYfY8Sar5u+hjcEByHh+-OsrfPx8-WJ-_g7JouxscwQ@mail.gmail.com>
	<4E3F13AD.9060201@shmuelhome.mine.nu>
Message-ID: <CAN45N12eJji7SqPJ4QQWSZKT+jnyx8ZxBW3z0f7aXg9+NpQexQ@mail.gmail.com>

Here are the Fedora packages that I found using yum.
If anyone knows of a better packace for any of these, please let me know.

elipse-jdt
antlr3-tool.noarch
antlrworks.noarch

ANTLR IDE will be done manually.

Thanks, Eric

From ruslan_zasukhin at valentina-db.com  Sun Aug  7 22:53:03 2011
From: ruslan_zasukhin at valentina-db.com (Ruslan Zasukhin)
Date: Mon, 08 Aug 2011 08:53:03 +0300
Subject: [antlr-interest] 3.4 C target release date?
In-Reply-To: <85f4a0537e30f302646122262ddd3094@mail.gmail.com>
Message-ID: <CA65546F.EFB54%ruslan_zasukhin@valentina-db.com>

On 7/29/11 8:05 PM, "Jim Idle" <jimi at temporal-wave.com> wrote:

Hi Jim,

Any news on this?


> Yeah the docs were holding me up. I will release it tomorrow.
> 
> Jim
> 
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Justin Murray
>> Sent: Friday, July 29, 2011 7:09 AM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] 3.4 C target release date?
>> 
>> Hi Jim,
>> 
>> I'm not trying to rush you or anything, but I am wondering if you have
>> an estimate for the release of the 3.4 C runtime. I'd like to use it in
>> our next release, and with deadlines approaching it would be helpful to
>> know if I'll have time to fit it in or not.
>> 
>> Thank you!
>> 
>> - Justin
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 

-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]



From parrt at antlr.org  Mon Aug  8 12:03:37 2011
From: parrt at antlr.org (Terence Parr)
Date: Mon, 8 Aug 2011 12:03:37 -0700
Subject: [antlr-interest] ANTLRWorks 1.4.3 released
Message-ID: <05054B95-2DE4-4E6B-9F9E-6002378F48C7@antlr.org>

Hi. Build with ANTLR 3.4:

http://antlr.org/download.html

Ter

From ssmith at mainstreamdata.com  Mon Aug  8 12:41:05 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Mon, 8 Aug 2011 19:41:05 +0000
Subject: [antlr-interest] Can't generate the AST I want
Message-ID: <B29111A755EFB5419E6C7BC998C6E86743AC0A@hedwig.slc.mainstreamdata.com>

I am writing a grammar to generate ASTs.  There are operators called "AND" and "OR" (defined in the lexer) in the language.  I want my parser to produce ASTs that group together all of the terms which are using the same operator.

Also, there can be cases where there is no operator given.  In that case, depending on the program configuration, it may be "AND" or "OR".  I've called it DFLT_OP for the time being.  Here are some examples:

(a OR b OR c) -> (OR a b c)
a b -> (DFLT_OP a b)                                                       // no operator
a AND (b OR c) AND d ->(AND a (OR b c) d)
a AND b OR c AND d ->(AND (OR (AND a b) c) d)  // I think this one is right; I don't need to reorder terms because AND was used twice

The grammar I've generated (somewhat simplified) is below.  I think everything is pretty vanilla except for the definition of "expression":

grammar testGr;

options {
  language = Java;
  output = AST;
  ASTLabelType = CommonTree;
}

tokens {
  DFLT_OP;
}

@header {
  package a.b.c;
}

@lexer::header {
  package a.b.c;
}

filter     :    expression EOF ;

term :    IDENTIFIER
     |    '('! expression ')'!
     ;

// parsing "(a AND b AND c)" (w/o quotes)

// ATTEMPT 1
// This gives (AND (AND a b) c).  This is correct, but what I
// really want is (AND a b c)
//expression
//   :    term ((AND^ | OR^)? term)*
//   ;

// ATTEMPT2
// This doesn't compile due to "recursive rule invocations".  I'm
// also not thrilled the term order changes
//expression
//   :    (id1=term OR)+ id2=term -> ^(OR id2 id1+)
//   |    (id1=term AND)+ id2=term -> ^(AND id2 id1+)
//   |    id1=term id2=term+  -> ^(DFLT_OP id1 id2+)
//   |    term -> term
//   ;

// ATTEMPT3
// This compiles but appears to produce (AND a c).  No "b".
// expression
//options {
//   backtrack=true;
//}
//   :    id1=term (OR id2=term)+ -> ^(OR $id1 $id2+)
//   |    id1=term (AND id2=term)+ -> ^(AND $id1 $id2+)
//   |    id1=term id2=term+  -> ^(DFLT_OP $id1 $id2+)
//   |    term -> term
//   ;
//

// This doesn't compile due to "recursive rule invocations".
expression
     :    id1=term OR id2=term (OR id3=term)+ -> ^(OR $id1 $id2 $id3+)
     |    id1=term AND id2=term (AND id3=term)+ -> ^(AND $id1 $id2 $id3+)
     |    id1=term id2=term+  -> ^(DFLT_OP $id1 $id2+)
     |    term -> term
     ;

AND  :    'AND' | '&&' ;
OR   :    'OR' | '||' ;
IDENTIFIER :    LETTER (LETTER | NUMBER)* ;
fragment LETTER :    LOWER | UPPER ;
fragment LOWER  :    'a'..'z' ;
fragment UPPER  :    'A'..'Z' ;
fragment NUMBER :    '0'..'9' ;
WS  : (' ' | '\t' | '\n' | '\r') {$channel=HIDDEN; } ;

Is there a way to tell ANTLR what I want to do?  How should I write the expression?

Any thoughts about the minor problem of substituting AND or OR instead of the DFLT_OP.  I figured out how to pass a Boolean to my parser which tells it which one of these is the correct one.  Can I write something like:

                ({dftlOpAND ? AND : OR} $id1 $id2)


From rod at infinitenil.com  Mon Aug  8 14:14:49 2011
From: rod at infinitenil.com (Rod Schmidt)
Date: Mon, 8 Aug 2011 15:14:49 -0600
Subject: [antlr-interest] ObjC problems
Message-ID: <76FF88FD-413C-4FFB-9D0C-3DF3B571258C@infinitenil.com>

Ok, I figured out that the latest antlr-3.4 doesn't have the right ObjC templates. I tried downloading the antlr-3.4 source, replacing the templates and ObjCTemplate.java file from Alan's latest ANTLR.framework downoad and building. The build fails with the following:

[INFO] Skipping ANTLR Master build control POM 3.4
[INFO] This project has been banned from the build due to previous failures.
[INFO] ------------------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] ANTLR Master build control POM 3.4 ................ SUCCESS [46.430s]
[INFO] Antlr 3.4 Runtime ................................. SUCCESS [1:53.877s]
[INFO] ANTLR Grammar Tool v 3.4 .......................... FAILURE [41.300s]
[INFO] Maven plugin for ANTLR V3.4 ....................... SKIPPED
[INFO] ANTLR gUnit v3.4 .................................. SKIPPED
[INFO] Maven plugin for gUnit ANTLR V3.4 ................. SKIPPED
[INFO] ANTLR3 Maven Archetype 3.4 ........................ SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 4:43.823s
[INFO] Finished at: Mon Aug 08 15:06:46 MDT 2011
[INFO] Final Memory: 25M/92M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project antlr: Compilation failure
[ERROR] /Users/rod/Downloads/antlr-3.4/tool/src/main/java/org/antlr/codegen/ObjCTarget.java:[46,11] write(org.stringtemplate.v4.ST,java.lang.String) in org.antlr.codegen.CodeGenerator cannot be applied to (org.antlr.stringtemplate.StringTemplate,java.lang.String)
[ERROR] -> [Help 1]

This leads me to believe that the latest ObjCTarget.java file may not be the latest. 
Does anybody have a version of antlr-3.4 that is built with the most up to date Objective-C templates?

Thanks.

From jbb at acm.org  Mon Aug  8 15:43:58 2011
From: jbb at acm.org (John B. Brodie)
Date: Mon, 08 Aug 2011 18:43:58 -0400
Subject: [antlr-interest] Can't generate the AST I want
In-Reply-To: <B29111A755EFB5419E6C7BC998C6E86743AC0A@hedwig.slc.mainstreamdata.com>
References: <B29111A755EFB5419E6C7BC998C6E86743AC0A@hedwig.slc.mainstreamdata.com>
Message-ID: <1312843438.11171.12.camel@gecko>

On Mon, 2011-08-08 at 19:41 +0000, Scott Smith wrote:
> I am writing a grammar to generate ASTs.  There are operators called "AND" and "OR" (defined in the lexer) in the language.  I want my parser to produce ASTs that group together all of the terms which are using the same operator.
> 
> Also, there can be cases where there is no operator given.  In that case, depending on the program configuration, it may be "AND" or "OR".  I've called it DFLT_OP for the time being.  Here are some examples:
> 
> (a OR b OR c) -> (OR a b c)
> a b -> (DFLT_OP a b)                                                       // no operator
> a AND (b OR c) AND d ->(AND a (OR b c) d)
> a AND b OR c AND d ->(AND (OR (AND a b) c) d)  // I think this one is right; I don't need to reorder terms because AND was used twice

i do not think this is correct.
you have (a AND b OR c AND d) as (((a AND b) OR c) AND d)
but i think most people would expect it to be ((a AND b) OR (c AND d))

e.g. AND has higher precedence than OR (i think)

> 
> The grammar I've generated (somewhat simplified) is below.  I think everything is pretty vanilla except for the definition of "expression":
> 
> grammar testGr;
> 
> options {
>   language = Java;
>   output = AST;
>   ASTLabelType = CommonTree;
> }
> 
> tokens {
>   DFLT_OP;
> }
> 
> @header {
>   package a.b.c;
> }
> 
> @lexer::header {
>   package a.b.c;
> }
> 
> filter     :    expression EOF ;
> 
> term :    IDENTIFIER
>      |    '('! expression ')'!
>      ;
> 
> // parsing "(a AND b AND c)" (w/o quotes)
> 
> // ATTEMPT 1
> // This gives (AND (AND a b) c).  This is correct, but what I
> // really want is (AND a b c)
> //expression
> //   :    term ((AND^ | OR^)? term)*
> //   ;
> 
> // ATTEMPT2
> // This doesn't compile due to "recursive rule invocations".  I'm
> // also not thrilled the term order changes
> //expression
> //   :    (id1=term OR)+ id2=term -> ^(OR id2 id1+)
> //   |    (id1=term AND)+ id2=term -> ^(AND id2 id1+)
> //   |    id1=term id2=term+  -> ^(DFLT_OP id1 id2+)
> //   |    term -> term
> //   ;
> 
> // ATTEMPT3
> // This compiles but appears to produce (AND a c).  No "b".

you want to use the `+=` meta operator (not `=`) when collecting a list
of elements on the left of the `->` meta operator. e.g. id2+=term not
id2=term. using the = on a list just gets the last element of the list
as you have observed.

> // expression
> //options {
> //   backtrack=true;
> //}
> //   :    id1=term (OR id2=term)+ -> ^(OR $id1 $id2+)
> //   |    id1=term (AND id2=term)+ -> ^(AND $id1 $id2+)
> //   |    id1=term id2=term+  -> ^(DFLT_OP $id1 $id2+)
> //   |    term -> term
> //   ;
> //
> 
> // This doesn't compile due to "recursive rule invocations".
> expression
>      :    id1=term OR id2=term (OR id3=term)+ -> ^(OR $id1 $id2 $id3+)
>      |    id1=term AND id2=term (AND id3=term)+ -> ^(AND $id1 $id2 $id3+)
>      |    id1=term id2=term+  -> ^(DFLT_OP $id1 $id2+)
>      |    term -> term
>      ;
> 
> AND  :    'AND' | '&&' ;
> OR   :    'OR' | '||' ;
> IDENTIFIER :    LETTER (LETTER | NUMBER)* ;
> fragment LETTER :    LOWER | UPPER ;
> fragment LOWER  :    'a'..'z' ;
> fragment UPPER  :    'A'..'Z' ;
> fragment NUMBER :    '0'..'9' ;
> WS  : (' ' | '\t' | '\n' | '\r') {$channel=HIDDEN; } ;
> 
> Is there a way to tell ANTLR what I want to do?  How should I write the expression?
> 
> Any thoughts about the minor problem of substituting AND or OR instead of the DFLT_OP.  I figured out how to pass a Boolean to my parser which tells it which one of these is the correct one.  Can I write something like:
> 
>                 ({dftlOpAND ? AND : OR} $id1 $id2)

I am not sure that you can do this in constructing a root of a sub-tree.

attached please find a complete grammar that solves all 3 of the
problems identified:
        a) precedence of AND over OR
        b) making AND and OR n-ary trees rather than binary
        c) inserting an imaginary AND or OR as root when no connective
           operator is present.

Hope this helps...
   -jbb

-------------- next part --------------
grammar Test;

options {
   output = AST;
   ASTLabelType = CommonTree;
}

@members {

   boolean dfltOpAND = true;

   private static final String [] x = new String[] {
      "a",                      // -> a
      "(a OR b OR c)",          // -> (OR a b c)
      "a AND (b OR c) AND d",   // -> (AND a (OR b c) d)
      "a AND b OR c AND d",     // -> (OR (AND a b) (AND c d))
      "a b",
      "a b c d",
      "a (b OR c) d",
      "a b OR c d",
 };

   public static void main(String [] args) {
      for( int i = 0; i < x.length; ++i ) {
         try {
            System.out.println("about to parse:`"+x[i]+"`");

            TestLexer lexer = new TestLexer(new ANTLRStringStream(x[i]));
            CommonTokenStream tokens = new CommonTokenStream(lexer);

            // System.out.format("dump of the token stream:\%n");
            // int j = 0;
            // boolean looping = true;
            // while( looping ) {
            //    Token token = lexer.nextToken();
            //    int typ = token.getType();
            //    System.out.format("\%d: type = \%s, text = `\%s`\%s\%n",
            //                      j++,
            //                      typ==EOF?"EOF":tokenNames[typ],
            //                      token.getText(),
            //                      token.getChannel()==HIDDEN?" (HIDDEN)":"");
            //    looping = typ != EOF;
            // }
            // lexer.reset();
            // System.out.format("now performing the parse\n");

            TestParser parser = new TestParser(tokens);
            TestParser.test_return p_result = parser.test();

            CommonTree ast = p_result.tree;
            if( ast == null ) {
               System.out.println("resultant tree: is NULL");
            } else {
               System.out.println("resultant tree: " + ast.toStringTree());
            }
            System.out.println();
         } catch(Exception e) {
            e.printStackTrace();
         }
      }
   }
}

test : filter ;

filter     :    expression EOF ;

expression :
      (disjunction -> disjunction)
      ((disjunctive_op x+=disjunction)+ -> ^(disjunctive_op $expression $x+))?
   ;
disjunctive_op :
      ( OR -> OR )
   |  ( ( { ! dfltOpAND }?=>/*empty*/ ) -> OR[input.LT(1), "OR"] )
   ;

disjunction :
      (conjunction -> conjunction)
      ((conjunctive_op x+=conjunction)+ -> ^(conjunctive_op $disjunction $x+))?
   ;
conjunctive_op :
      ( AND -> AND )
   |  ( ( { dfltOpAND }?=>/*empty*/ ) -> AND[input.LT(1), "AND"] )
   ;

conjunction : primary ;

primary : IDENTIFIER | '('! expression ')'! ;


AND  :    'AND' | '&&' ;
OR   :    'OR' | '||' ;
IDENTIFIER :    LETTER (LETTER | NUMBER)* ;
fragment LETTER :    LOWER | UPPER ;
fragment LOWER  :    'a'..'z' ;
fragment UPPER  :    'A'..'Z' ;
fragment NUMBER :    '0'..'9' ;
WS  : (' ' | '\t' | '\n' | '\r') {$channel=HIDDEN; } ;

From ssmith at mainstreamdata.com  Mon Aug  8 16:36:34 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Mon, 8 Aug 2011 23:36:34 +0000
Subject: [antlr-interest] Can't generate the AST I want
In-Reply-To: <1312843438.11171.12.camel@gecko>
References: <B29111A755EFB5419E6C7BC998C6E86743AC0A@hedwig.slc.mainstreamdata.com>
	<1312843438.11171.12.camel@gecko>
Message-ID: <B29111A755EFB5419E6C7BC998C6E86743D08B@hedwig.slc.mainstreamdata.com>

I will take a look at this.  Thanks for sending it.  I appreciate all of your help.

Interestingly (or unfortunately, depending on your perspective), my understanding is that the grammar I'm trying to parse doesn't have precedence.  It does support parentheses through which you can control precedence like you do in most languages.  

I've read one discussion which said (absent parentheses) the last operator wins.  So (a AND b OR c) would be interpreted as (a AND (b OR c)) but (a OR b AND c) would be interpreted as (a OR (b AND c)).  In fact, I just verified on our system that that's exactly how it works.  (a AND b OR c AND d) would be interpreted as (a AND (b OR (c AND d))).  Since this is an open source project (SOLR - lucene.apache.org), I don't have the option of changing how it works though it does seem a bit odd.

My experience is that people use a lot of parentheses with this system.  It's also very common to see long strings of items where the operator is the same (e.g., (a OR b OR c OR d... OR w)) though each of the terms (e.g., "a") could be several things ANDed together, but with parentheses around them to ensure they are treated as a single term.  This is why I want the AST to be (OR a b c d ... w).  For what I need to do (common sub-expression factoring/elimination), I think it's easier to deal with.

Thanks again

Scott

-----Original Message-----
From: John B. Brodie [mailto:jbb at acm.org] 
Sent: Monday, August 08, 2011 4:44 PM
To: Scott Smith
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Can't generate the AST I want

On Mon, 2011-08-08 at 19:41 +0000, Scott Smith wrote:
> I am writing a grammar to generate ASTs.  There are operators called "AND" and "OR" (defined in the lexer) in the language.  I want my parser to produce ASTs that group together all of the terms which are using the same operator.
> 
> Also, there can be cases where there is no operator given.  In that case, depending on the program configuration, it may be "AND" or "OR".  I've called it DFLT_OP for the time being.  Here are some examples:
> 
> (a OR b OR c) -> (OR a b c)
> a b -> (DFLT_OP a b)                                                       // no operator
> a AND (b OR c) AND d ->(AND a (OR b c) d) a AND b OR c AND d ->(AND 
> (OR (AND a b) c) d)  // I think this one is right; I don't need to 
> reorder terms because AND was used twice

i do not think this is correct.
you have (a AND b OR c AND d) as (((a AND b) OR c) AND d) but i think most people would expect it to be ((a AND b) OR (c AND d))

e.g. AND has higher precedence than OR (i think)

> 
> The grammar I've generated (somewhat simplified) is below.  I think everything is pretty vanilla except for the definition of "expression":
> 
> grammar testGr;
> 
> options {
>   language = Java;
>   output = AST;
>   ASTLabelType = CommonTree;
> }
> 
> tokens {
>   DFLT_OP;
> }
> 
> @header {
>   package a.b.c;
> }
> 
> @lexer::header {
>   package a.b.c;
> }
> 
> filter     :    expression EOF ;
> 
> term :    IDENTIFIER
>      |    '('! expression ')'!
>      ;
> 
> // parsing "(a AND b AND c)" (w/o quotes)
> 
> // ATTEMPT 1
> // This gives (AND (AND a b) c).  This is correct, but what I // 
> really want is (AND a b c) //expression
> //   :    term ((AND^ | OR^)? term)*
> //   ;
> 
> // ATTEMPT2
> // This doesn't compile due to "recursive rule invocations".  I'm // 
> also not thrilled the term order changes //expression
> //   :    (id1=term OR)+ id2=term -> ^(OR id2 id1+)
> //   |    (id1=term AND)+ id2=term -> ^(AND id2 id1+)
> //   |    id1=term id2=term+  -> ^(DFLT_OP id1 id2+)
> //   |    term -> term
> //   ;
> 
> // ATTEMPT3
> // This compiles but appears to produce (AND a c).  No "b".

you want to use the `+=` meta operator (not `=`) when collecting a list of elements on the left of the `->` meta operator. e.g. id2+=term not id2=term. using the = on a list just gets the last element of the list as you have observed.

> // expression
> //options {
> //   backtrack=true;
> //}
> //   :    id1=term (OR id2=term)+ -> ^(OR $id1 $id2+)
> //   |    id1=term (AND id2=term)+ -> ^(AND $id1 $id2+)
> //   |    id1=term id2=term+  -> ^(DFLT_OP $id1 $id2+)
> //   |    term -> term
> //   ;
> //
> 
> // This doesn't compile due to "recursive rule invocations".
> expression
>      :    id1=term OR id2=term (OR id3=term)+ -> ^(OR $id1 $id2 $id3+)
>      |    id1=term AND id2=term (AND id3=term)+ -> ^(AND $id1 $id2 $id3+)
>      |    id1=term id2=term+  -> ^(DFLT_OP $id1 $id2+)
>      |    term -> term
>      ;
> 
> AND  :    'AND' | '&&' ;
> OR   :    'OR' | '||' ;
> IDENTIFIER :    LETTER (LETTER | NUMBER)* ;
> fragment LETTER :    LOWER | UPPER ;
> fragment LOWER  :    'a'..'z' ;
> fragment UPPER  :    'A'..'Z' ;
> fragment NUMBER :    '0'..'9' ;
> WS  : (' ' | '\t' | '\n' | '\r') {$channel=HIDDEN; } ;
> 
> Is there a way to tell ANTLR what I want to do?  How should I write the expression?
> 
> Any thoughts about the minor problem of substituting AND or OR instead of the DFLT_OP.  I figured out how to pass a Boolean to my parser which tells it which one of these is the correct one.  Can I write something like:
> 
>                 ({dftlOpAND ? AND : OR} $id1 $id2)

I am not sure that you can do this in constructing a root of a sub-tree.

attached please find a complete grammar that solves all 3 of the problems identified:
        a) precedence of AND over OR
        b) making AND and OR n-ary trees rather than binary
        c) inserting an imaginary AND or OR as root when no connective
           operator is present.

Hope this helps...
   -jbb


From mmatinlassi at icinetic.com  Tue Aug  9 02:31:18 2011
From: mmatinlassi at icinetic.com (Mari Matinlassi)
Date: Tue, 9 Aug 2011 11:31:18 +0200
Subject: [antlr-interest] Problem when generating ANTLRv3.g for C Sharp
	target?
Message-ID: <000201cc5677$184517e0$48cf47a0$@icinetic.com>

Dear fellows,

 

Our research project wants to create meta-language for defining domain
specific languages. And, we have chosen to take ANTLR as a tool and
ANTLRv3.g as a starting point for our meta-language.

 

Therefore, I want to generate ANTLRv3Parser.cs and ANTLRv3Lexer.cs and build
them in Visual Studio (using C# target). However, I have a build error as
below:

"Error    1              The type or namespace name 'String' could not be
found (are you missing a using directive or an assembly reference?)
C:\VisualStudioProject\Testi\Testi\obj\Debug\ANTLRv3Parser.cs
2151       10           Testi"

 

And, indeed, there is a line in ANTLRv3Parser.cs as follows:

 

protected sealed partial class rule_scope

       {

              public String name;

 

              public rule_scope(ANTLRv3Parser grammar) { OnCreated(grammar);
}

              partial void OnCreated(ANTLRv3Parser grammar);

       }

 

Any idea what I am doing wrong?

 

I have followed this document (http://www.antlr.org/download/CSharp3.pdf) to
install and configure my Visual Studio project to work with Antlr.

 

This works fine, thanks for excellent guide! I get a simple grammar (such as
one below) to generate lexer and parser and compile them successfully.

Example grammar:

-----------------------------------Start of
T.g-----------------------------------------------------

grammar T;

 

options

{

       language=CSharp3;

       TokenLabelType=CommonToken;

       output=AST;

       ASTLabelType=CommonTree;

}

 

 

@lexer::namespace {ANTLRlanguage}

@parser::namespace {ANTLRlanguage}

 

public compileUnit 

       : ('x')+

       ;

 

 

IDENTIFIER

       :      ('a'..'z' | 'A'..'Z' |'_')('a'..'z' | 'A'..'Z' |'0'..'9'|'_')*

       ;

-----------------------------------End of
T.g--------------------------------------------------

 

Thanks for your help in advance,

 

Mari


From member at linkedin.com  Tue Aug  9 04:08:33 2011
From: member at linkedin.com (Mu Qiao via LinkedIn)
Date: Tue, 9 Aug 2011 11:08:33 +0000 (UTC)
Subject: [antlr-interest] Invitation to connect on LinkedIn
Message-ID: <272851308.7946914.1312888113323.JavaMail.app@ela4-app0131.prod>

LinkedIn
------------




    Mu Qiao requested to add you as a connection on LinkedIn:
  
------------------------------------------

Ian,

I'd like to add you to my professional network on LinkedIn.

- Mu

Accept invitation from Mu Qiao
http://www.linkedin.com/e/6i82p9-gr4ronl1-3g/XJ_Jh42eHeYQ_eJ2S5_J_0Ueq9jQFT3yBwA6v-/blk/I3020299517_2/1BpC5vrmRLoRZcjkkZt5YCpnlOt3RApnhMpmdzgmhxrSNBszYOnPsNdjAVcz0Oc3d9bSYPcnpPqCdDbP4MdjoRd38Me3cLrCBxbOYWrSlI/EML_comm_afe/

View invitation from Mu Qiao
http://www.linkedin.com/e/6i82p9-gr4ronl1-3g/XJ_Jh42eHeYQ_eJ2S5_J_0Ueq9jQFT3yBwA6v-/blk/I3020299517_2/39vdP4RejAOc38McQALqnpPbOYWrSlI/svi/ 

------------------------------------------
DID YOU KNOW you can use your LinkedIn profile as your website? Select a vanity URL and then promote this address on your business cards, email signatures, website, etc
http://www.linkedin.com/e/6i82p9-gr4ronl1-3g/ewp/inv-21/

 
-- 
(c) 2011, LinkedIn Corporation

From sharwell at pixelminegames.com  Tue Aug  9 07:18:00 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 9 Aug 2011 09:18:00 -0500
Subject: [antlr-interest] Problem when generating ANTLRv3.g for C
	Sharp	target?
In-Reply-To: <000201cc5677$184517e0$48cf47a0$@icinetic.com>
References: <000201cc5677$184517e0$48cf47a0$@icinetic.com>
Message-ID: <061201cc569f$25ed28b0$71c77a10$@pixelminegames.com>

Hi Mari,

I've never used ANTLRv3.g, so it may have errors and it's probably not
up-to-date with the latest ANTLR.g3 used in the C# port of the tool. The
CSharp3 target doesn't emit a "using System;" line, so you'll need to do one
of the following:

1. Change the definition of name in the scope{...} block of the rule 'rule'
from String to string.

2. Add the header block:

@parser::header {
using System;
}

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mari Matinlassi
Sent: Tuesday, August 09, 2011 4:31 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Problem when generating ANTLRv3.g for C Sharp
target?

Dear fellows,

 

Our research project wants to create meta-language for defining domain
specific languages. And, we have chosen to take ANTLR as a tool and
ANTLRv3.g as a starting point for our meta-language.

 

Therefore, I want to generate ANTLRv3Parser.cs and ANTLRv3Lexer.cs and build
them in Visual Studio (using C# target). However, I have a build error as
below:

"Error    1              The type or namespace name 'String' could not be
found (are you missing a using directive or an assembly reference?)
C:\VisualStudioProject\Testi\Testi\obj\Debug\ANTLRv3Parser.cs
2151       10           Testi"

 

And, indeed, there is a line in ANTLRv3Parser.cs as follows:

 

protected sealed partial class rule_scope

       {

              public String name;

 

              public rule_scope(ANTLRv3Parser grammar) { OnCreated(grammar);
}

              partial void OnCreated(ANTLRv3Parser grammar);

       }

 

Any idea what I am doing wrong?

 

I have followed this document (http://www.antlr.org/download/CSharp3.pdf) to
install and configure my Visual Studio project to work with Antlr.

 

This works fine, thanks for excellent guide! I get a simple grammar (such as
one below) to generate lexer and parser and compile them successfully.

Example grammar:

-----------------------------------Start of
T.g-----------------------------------------------------

grammar T;

 

options

{

       language=CSharp3;

       TokenLabelType=CommonToken;

       output=AST;

       ASTLabelType=CommonTree;

}

 

 

@lexer::namespace {ANTLRlanguage}

@parser::namespace {ANTLRlanguage}

 

public compileUnit 

       : ('x')+

       ;

 

 

IDENTIFIER

       :      ('a'..'z' | 'A'..'Z' |'_')('a'..'z' | 'A'..'Z' |'0'..'9'|'_')*

       ;

-----------------------------------End of
T.g--------------------------------------------------

 

Thanks for your help in advance,

 

Mari


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From researcher0x00 at gmail.com  Tue Aug  9 08:41:25 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 9 Aug 2011 11:41:25 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
	version 2.7.7
Message-ID: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>

I am test building ANTLR on Fedora 15 and installed package antlr3-tool
using the GUI.

Using the command line I entered antlr only to see version 2.7.7 not 3.x.

While I know that 2.x versions are needed for 3.x versions to build, if I
were to run from the command line shouldn't the antlr command be a 3.x
version?

So the real question is, can the antlr3-tool package be trusted for use from
the command line?

Thanks, Eric

From jbb at acm.org  Tue Aug  9 09:10:21 2011
From: jbb at acm.org (John B. Brodie)
Date: Tue, 09 Aug 2011 12:10:21 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
Message-ID: <1312906221.2426.3.camel@gecko>

I do not use Fedora; rather I use the jar file downloaded from antlr.org
on Ubunto 11.04 with proper CLASSPATH setting.

So my suggestion may be way off base...

On Tue, 2011-08-09 at 11:41 -0400, The Researcher wrote:
> I am test building ANTLR on Fedora 15 and installed package antlr3-tool
> using the GUI.
> 
> Using the command line I entered antlr only to see version 2.7.7 not 3.x.
> 
> While I know that 2.x versions are needed for 3.x versions to build, if I
> were to run from the command line shouldn't the antlr command be a 3.x
> version?
> 
> So the real question is, can the antlr3-tool package be trusted for use from
> the command line?

Did you use the correct command line?

java antlr.Tool # runs the v2 tool

java org.antlr.Tool # runs the v3 tool

Sorry if this was just noise....
   -jbb



From cummings at kjchome.homeip.net  Tue Aug  9 10:09:20 2011
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Tue, 09 Aug 2011 13:09:20 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
Message-ID: <4E4169C0.20901@kjchome.homeip.net>

On 08/09/2011 11:41 AM, The Researcher wrote:
> I am test building ANTLR on Fedora 15 and installed package antlr3-tool
> using the GUI.
>
> Using the command line I entered antlr only to see version 2.7.7 not 3.x.
>
> While I know that 2.x versions are needed for 3.x versions to build, if I
> were to run from the command line shouldn't the antlr command be a 3.x
> version?

Did you look at the package list to see what files got installed where?
On Fedora, ANTLR v3 is installed as /usr/bin/antlr3
In that way, ANTLR v2 and ANTLR v3 can both co-exist on the same system, 
and ANTLR v2 can be used to build ANTLR v3.

If you have a problem with that, file bugzilla request with Fedora for a 
change.

> So the real question is, can the antlr3-tool package be trusted for use from
> the command line?

I use it all the time, but with the command: antlr3

> Thanks, Eric

-- 
Kevin J. Cummings
kjchome at verizon.net
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From researcher0x00 at gmail.com  Tue Aug  9 10:16:25 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 9 Aug 2011 13:16:25 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <1312906221.2426.3.camel@gecko>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
	<1312906221.2426.3.camel@gecko>
Message-ID: <CAN45N106cyKQ1qdC-bHQm_47t0Ou4HPT1y7giTrVLP4zc-UCgQ@mail.gmail.com>

Hi John,

Thanks for the response.

No, I don't consider it noise. I never noticed the difference between
antlr.Tool and org.antlr.Tool.

I actually use a Visual Studio environment with ANTLRWorks and have been for
many years.

I am working to make it easier for a first time user of ANTLR to get
started. As such I was planing on creating an appliance (
http://en.wikipedia.org/wiki/Software_appliance) but it comes out to about
2.5 GB. So for now I will just distribute the detailed instructions and
beginner walk troughs. i.e. Eclipse with ANTLR IDE plug-in, ANTLRWorks, and
considering Maven.

While it would be nice to use Linux packages for doing the install, I can
only use them if they do as I need. The ANTLR packages do apply to ANTLR,
but I am finding out they are not what I was expecting for a first time
user.

The more I work on this the more I find out how varied the environments are
of the users of ANTLR and the more there should be documentation giving
insight to all of this. Clearly I only know a part of it, but hopefully can
explain one version of it well enough to help others.

Thanks, Eric

From jimi at temporal-wave.com  Tue Aug  9 10:29:12 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 9 Aug 2011 10:29:12 -0700
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
Message-ID: <9133fa9475709500bdc3a52c6d950745@mail.gmail.com>

It is just that the pre-packed stuff for the Linux releases is never up to
date and it is confounding the two releases. Just use yum to uninstall all
the antlr stuff and install it yourself.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of The Researcher
> Sent: Tuesday, August 09, 2011 8:41 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
> version 2.7.7
>
> I am test building ANTLR on Fedora 15 and installed package antlr3-tool
> using the GUI.
>
> Using the command line I entered antlr only to see version 2.7.7 not
> 3.x.
>
> While I know that 2.x versions are needed for 3.x versions to build, if
> I were to run from the command line shouldn't the antlr command be a
> 3.x version?
>
> So the real question is, can the antlr3-tool package be trusted for use
> from the command line?
>
> Thanks, Eric
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From researcher0x00 at gmail.com  Tue Aug  9 10:39:20 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 9 Aug 2011 13:39:20 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <4E4169C0.20901@kjchome.homeip.net>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
	<4E4169C0.20901@kjchome.homeip.net>
Message-ID: <CAN45N13ShU4N-9bv5RyRcrhWfnx+T7fLXfLkaXiEhU5AZEvhEQ@mail.gmail.com>

>
> Hi Kevin,


Thanks, I never thought about there being a second antlr command. I was also
only looking for jar files not directories or commands.

Also antlr3 is also in /usr/bin as you note.

Not being a Linux person I have to ask how do you determine where the files
in a package were installed?


Thanks, Eric

From researcher0x00 at gmail.com  Tue Aug  9 10:52:05 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 9 Aug 2011 13:52:05 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <9133fa9475709500bdc3a52c6d950745@mail.gmail.com>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
	<9133fa9475709500bdc3a52c6d950745@mail.gmail.com>
Message-ID: <CAN45N12ucdPmZFbW6tO-Q4FJsxCtMphwDGpw5bo+VcDMgROwdw@mail.gmail.com>

Hi Jim,

Thanks for the response.

Last week I spent a few days documenting how to install Linux on a virtual
machine, Java, ANTLR, Eclipse, ANTLR IDE and ANTLRWorks without using
packages and it does work, but the instructions have screen shots for each
Enter or mouse click and thus are very long, but exact.

It was suggested that I try the packages as they should be easier and
shorter. Right now I am leaning toward what you suggest because one can
learn what goes into an ANTLR system and why, as opposed to it being done
behind the a front-end. Doing it by hand also means I don't have to figure
out why extras are there and then explain them.

Thanks, Eric

From cummings at kjchome.homeip.net  Tue Aug  9 12:58:14 2011
From: cummings at kjchome.homeip.net (Kevin J. Cummings)
Date: Tue, 09 Aug 2011 15:58:14 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <CAN45N13ShU4N-9bv5RyRcrhWfnx+T7fLXfLkaXiEhU5AZEvhEQ@mail.gmail.com>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
	<4E4169C0.20901@kjchome.homeip.net>
	<CAN45N13ShU4N-9bv5RyRcrhWfnx+T7fLXfLkaXiEhU5AZEvhEQ@mail.gmail.com>
Message-ID: <4E419156.4020404@kjchome.homeip.net>

On 08/09/2011 01:39 PM, The Researcher wrote:
>>
>> Hi Kevin,
>
>
> Thanks, I never thought about there being a second antlr command. I was also
> only looking for jar files not directories or commands.
>
> Also antlr3 is also in /usr/bin as you note.
>
> Not being a Linux person I have to ask how do you determine where the files
> in a package were installed?

In the case of Fedora, try:

# rpm -ql antlr3-tool
/usr/bin/antlr3
/usr/share/doc/antlr3-tool-3.2
/usr/share/doc/antlr3-tool-3.2/CHANGES.txt
/usr/share/doc/antlr3-tool-3.2/LICENSE.txt
/usr/share/doc/antlr3-tool-3.2/README.txt
/usr/share/java/antlr-3.2.jar
/usr/share/java/antlr3-maven-plugin-3.2.jar
/usr/share/java/antlr3-maven-plugin.jar
/usr/share/java/antlr3.jar
/usr/share/maven2/poms/JPP-antlr.pom
/usr/share/maven2/poms/JPP-antlr3-maven-plugin.pom

As you can see, this will show you what files in the antlr3-tool.rpm 
were installed into which system directories.  There might still be some 
files which were installed via scripts in the RPM at installation time 
which do not appear in this list.

Of course, advanced RPM command options allow you to change where files 
actually get installed, but that is usually left for expert RPM users....

Likewise, if you have a pathname and you want to know which RPM it came 
from, try:

# rpm -qf /usr/bin/antl3
antlr3-tool-3.2-11.fc14.noarch

If you want to know where any command is (after it gets installed), the 
"which" command can be your friend:

# which antrl3
/usr/bin/antlr3

> Thanks, Eric

You are welcome.

-- 
Kevin J. Cummings
kjchome at verizon.net
cummings at kjchome.homeip.net
cummings at kjc386.framingham.ma.us
Registered Linux User #1232 (http://counter.li.org)

From ibre5041 at ibrezina.net  Tue Aug  9 13:44:21 2011
From: ibre5041 at ibrezina.net (Ivan Brezina)
Date: Tue, 09 Aug 2011 22:44:21 +0200
Subject: [antlr-interest] C Target Linux tip
Message-ID: <4E419C25.5090801@ibrezina.net>

Hi
I have two simple proposals for C target.
1. On windows you use pragmas to avoid unwanted compiler warnings
Similar thing is doable on gcc too.

#pragma GCC diagnostic ignored "-Wunused-variable"

Since gcc version 4.6 it is even possible to do this:

#pragma GCC diagnostic push
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic pop

2. For those who prefer cmake build system over automake tools
I attached build script for cmake. I offers same options as automake
but is is easier to "nest" libantlr3c library inside some larger project.
I was tested on Linux(Ubuntu 32bit/64bit) and also on 64bit Windows.
Mingw build was not tested.

Ivan



-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: CMakeLists.txt
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20110809/8e32e52b/attachment.txt 

From researcher0x00 at gmail.com  Tue Aug  9 14:43:38 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 9 Aug 2011 17:43:38 -0400
Subject: [antlr-interest] Fedora antlr3-tool command line antlr returns
 version 2.7.7
In-Reply-To: <4E419156.4020404@kjchome.homeip.net>
References: <CAN45N137yo2jAB0j1k7zg_1c7c9rH_NKnc6YpLqzefuD-G119w@mail.gmail.com>
	<4E4169C0.20901@kjchome.homeip.net>
	<CAN45N13ShU4N-9bv5RyRcrhWfnx+T7fLXfLkaXiEhU5AZEvhEQ@mail.gmail.com>
	<4E419156.4020404@kjchome.homeip.net>
Message-ID: <CAN45N100ygQCy87t3dLv0KD_fe5ZwLYnnh5O9SvejmoT7fs-aA@mail.gmail.com>

>
>  Kevin,
>

Thanks, I know that took a few some time.

Eric

From kingces95 at gmail.com  Tue Aug  9 16:29:20 2011
From: kingces95 at gmail.com (chris king)
Date: Tue, 9 Aug 2011 16:29:20 -0700
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>
	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>
	<CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>
	<048501cc530a$73f5d1d0$5be17570$@pixelminegames.com>
	<CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>
Message-ID: <CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>

Sam, hey, so I might have bumped into a code gen bug. I'm trying to access a
variable "skipSection" on the parent production of "pp_conditional". It
looks like the generated code is doing some computation involving the stack
count when really it should just pass my index without any calculation. For
example, below, shouldn't the highlighted code simply be my index? Or am I
missing something? Looks like the highlighted code is assuming TOS is Count
- 1 (like it would be with a stack implemented with a List<T>) but I don't
think that's the case. The stack is a System.Collections.Generic.Stack<T>
which maintains that TOS is always index 0.

$pp_conditional[1]::skipSection

The code above is transformed to:


System.Linq.Enumerable.ElementAt(pp_conditional_stack,
pp_conditional_stack.Count-1-1).skipSection;


Also, you may want to ensure that all user expressions are enclosed in
parens. As I was trying to work around this issue I used "count -2" which
got translated to stack.Count-count -2 -1. I had to add the parens to get it
to be stack.Count-(count -2) -1.

Thanks,
Chris

On Thu, Aug 4, 2011 at 6:00 PM, chris king <kingces95 at gmail.com> wrote:

> Ok. Thanks for looking into it.
>
>
> On Thu, Aug 4, 2011 at 5:56 PM, Sam Harwell <sharwell at pixelminegames.com>wrote:
>
>> I did, and I can repro the issue but I haven?t resolved it yet.****
>>
>> ** **
>>
>> Sam****
>>
>> ** **
>>
>> *From:* chris king [mailto:kingces95 at gmail.com]
>> *Sent:* Thursday, August 04, 2011 6:48 PM
>> *To:* Sam Harwell
>> *Cc:* antlr-interest at antlr.org
>> *Subject:* Re: [antlr-interest] To Sam Harwell****
>>
>> ** **
>>
>> Awesome! I'll give it try. Did you see my follow up email that the parse
>> string is 5 characters (there is a trailing space)? "/**/ " ****
>>
>> ** **
>>
>> And again, love the tool chain. I only really started to get traction on
>> my project after I installed it. It's working great.****
>>
>> ** **
>>
>> Thanks,
>> Chris****
>>
>> ** **
>>
>> On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>
>> wrote:****
>>
>> Hi Chris,
>>
>> In build 3.4.1.9004 that I released today, I switched all the projects to
>> using $(ProjectDir) with relative paths.
>>
>> http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases****
>>
>>
>> Sam
>>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org
>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
>> Sent: Monday, July 25, 2011 6:39 PM
>> To: antlr-interest at antlr.org
>> Subject: [antlr-interest] To Sam Harwell****
>>
>> Sam, hey, hope this finds you. Very small suggestion follows :). In
>> Antlr3.StringTemplate.csproj could you use
>>
>>
>>
>> <AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
>> askPath>
>>
>> to reference the bootstrap directory? Originally it used the solutionDir
>> and
>> that prevented me from including a subset of the projects in my project
>> (so
>> I could simply reference them and have all the debugging, pdb, source, etc
>> just work).
>>
>> Thanks,
>> Chris****
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address***
>> *
>>
>> ** **
>>
>
>

From sharwell at pixelminegames.com  Tue Aug  9 17:02:16 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 9 Aug 2011 19:02:16 -0500
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>	<CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>	<048501cc530a$73f5d1d0$5be17570$@pixelminegames.com>	<CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>
	<CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>
Message-ID: <067401cc56f0$c4ec9300$4ec5b900$@pixelminegames.com>

Hi Chris,

 

I got rid of the use of Stack<T> and the call to ElementAt() quite a while
back. Instead I use a ListStack<T> which derives from List<T> and adds Push
and Pop methods. I recommend updating to ANTLR 3.4.1 to correct this issue.

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Tuesday, August 09, 2011 6:29 PM
To: Sam Harwell; antlr-interest at antlr.org
Subject: Re: [antlr-interest] To Sam Harwell

 

Sam, hey, so I might have bumped into a code gen bug. I'm trying to access a
variable "skipSection" on the parent production of "pp_conditional". It
looks like the generated code is doing some computation involving the stack
count when really it should just pass my index without any calculation. For
example, below, shouldn't the highlighted code simply be my index? Or am I
missing something? Looks like the highlighted code is assuming TOS is Count
- 1 (like it would be with a stack implemented with a List<T>) but I don't
think that's the case. The stack is a System.Collections.Generic.Stack<T>
which maintains that TOS is always index 0. 

 

$pp_conditional[1]::skipSection

 

The code above is transformed to:

 

System.Linq.Enumerable.ElementAt(pp_conditional_stack,
pp_conditional_stack.Count-1-1).skipSection;

 

Also, you may want to ensure that all user expressions are enclosed in
parens. As I was trying to work around this issue I used "count -2" which
got translated to stack.Count-count -2 -1. I had to add the parens to get it
to be stack.Count-(count -2) -1.

 

Thanks,

Chris

 

On Thu, Aug 4, 2011 at 6:00 PM, chris king <kingces95 at gmail.com> wrote:

Ok. Thanks for looking into it. 

 

On Thu, Aug 4, 2011 at 5:56 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

I did, and I can repro the issue but I haven't resolved it yet.

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Thursday, August 04, 2011 6:48 PM
To: Sam Harwell
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] To Sam Harwell

 

Awesome! I'll give it try. Did you see my follow up email that the parse
string is 5 characters (there is a trailing space)? "/**/ " 

 

And again, love the tool chain. I only really started to get traction on my
project after I installed it. It's working great.

 

Thanks,
Chris

 

On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

Hi Chris,

In build 3.4.1.9004 that I released today, I switched all the projects to
using $(ProjectDir) with relative paths.

http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases


Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
Sent: Monday, July 25, 2011 6:39 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] To Sam Harwell

Sam, hey, hope this finds you. Very small suggestion follows :). In
Antlr3.StringTemplate.csproj could you use


<AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
askPath>

to reference the bootstrap directory? Originally it used the solutionDir and
that prevented me from including a subset of the projects in my project (so
I could simply reference them and have all the debugging, pdb, source, etc
just work).

Thanks,
Chris

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

 

 

 


From kingces95 at gmail.com  Tue Aug  9 19:55:40 2011
From: kingces95 at gmail.com (chris king)
Date: Tue, 9 Aug 2011 19:55:40 -0700
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <CAJQwtshGkA2HV_Q9WkVmxzxvUnOQk-6mUfSHfxOd+TVzAfVogg@mail.gmail.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>
	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>
	<CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>
	<048501cc530a$73f5d1d0$5be17570$@pixelminegames.com>
	<CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>
	<CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>
	<067401cc56f0$c4ec9300$4ec5b900$@pixelminegames.com>
	<CAJQwtshkH0XhCaGUsHPx4Q3B_4-_GSQvktW6HHtbaiZfQhVQTQ@mail.gmail.com>
	<CAJQwtshGkA2HV_Q9WkVmxzxvUnOQk-6mUfSHfxOd+TVzAfVogg@mail.gmail.com>
Message-ID: <CAJQwtsi3v7uRepYo46JU5sMwNwwhjHV4aJdO+ipWZDVvJd=Jqg@mail.gmail.com>

Sam, hey. Sorry to shower you with e-mails today. :) I got your new version
setup up and building but now one of my grammar file is causing a stack
overflow. I'm not sure if this is a problem with the CSharp port or a bug in
the Java ANTLR logic. Anyway, the attached grammer file of mine worked with
v3.3.1.7705 but with v3.4.1.9004 is causing a stack overflow in antlr3.exe.
To repro include the attached file in a .csproj as an Antlr3 include per
your instructions. Then uncomment either one of these rules and save to
execute Antlr3.


pp_conditional_section
  : //{ !SkipSection }? => input_section
  | //{ SkipSection }? => pp_skipped_section_part*
  ;


Here's how I'm include the file in the project:

    <Antlr3 Include="CSharp.g">
      <Generator>MSBuild:Compile</Generator>
    </Antlr3>

Here's the top of the function signature that I'm recursing through:

        // Factor so (a || b) == (result || a || b)
        public static SemanticContext FactorOr(ref SemanticContext a, ref
SemanticContext b)
        {
            HashSet<SemanticContext> opsA = new
HashSet<SemanticContext>(GetOrOperands(a));
            HashSet<SemanticContext> opsB = new
HashSet<SemanticContext>(GetOrOperands(b));

Here's a stack trace of the recursion I'm seeing. The line numbers should
match the source in v3.4.1.9004. I used that source to build the Antlr3.exe
that's having the stack overflow.

  Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681 C#
  Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 809 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 730 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 823 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 740 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 740 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 823 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 730 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 813 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 730 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 823 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 823 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt, context,
semanticContext, d, collectPredicates) Line 760 C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.ComputeStartState() Line 176
C#
  Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Convert() Line 90 C#
  Antlr3.EXE!Antlr3.Analysis.DFA.CreateFromNfa(decisionNumber,
decisionStartState) Line 243 C#
  Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFA(decision,
wackTempStructures) Line 1858 C#
  Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs(wackTempStructures)
Line 1586 C#
  Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs() Line 1526 C#
  Antlr3.EXE!Antlr3.Codegen.Target.PerformGrammarAnalysis(generator,
grammar) Line 121 C#
  Antlr3.EXE!Antlr3.Codegen.CodeGenerator.GenRecognizer() Line 670 C#
  Antlr3.EXE!Antlr3.AntlrTool.GenerateRecognizer(grammar) Line 791 C#
  Antlr3.EXE!Antlr3.AntlrTool.Process() Line 586 C#
  AntlrBuildTask.DLL!Antlr3.Build.Tasks.AntlrClassGenerationTaskInternal.Execute()
Line 135 C#

Thanks,
Chris


On Tue, Aug 9, 2011 at 6:39 PM, chris king <kingces95 at gmail.com> wrote:

> Also, in Antlr3.csproj I think LeftRecursiveRules.stg was pointing to the
> wrong place. I changed it to this and then the solution compiled:
>
>     <EmbeddedResource
> Include="..\..\..\antlr\antlr3-main\tool\src\main\resources\org\antlr\codegen\templates\LeftRecursiveRules.stg">
>
> Thanks,
> Chris
>
> On Tue, Aug 9, 2011 at 6:24 PM, chris king <kingces95 at gmail.com> wrote:
>
>> Sam, thanks! FYI The compilation of your source drop fails because the key
>> file is not included. You may want to disabled signing in all your projects
>> before you release the source drop or provide a dummy key file or find some
>> work around so folks can just open up the source and compile it. That would
>> help upgrading to the next version.
>>
>> Thanks,
>> Chris
>>
>> On Tue, Aug 9, 2011 at 5:02 PM, Sam Harwell <sharwell at pixelminegames.com>wrote:
>>
>>> Hi Chris,****
>>>
>>> ** **
>>>
>>> I got rid of the use of Stack<T> and the call to ElementAt() quite a
>>> while back. Instead I use a ListStack<T> which derives from List<T> and adds
>>> Push and Pop methods. I recommend updating to ANTLR 3.4.1 to correct this
>>> issue.****
>>>
>>> ** **
>>>
>>> Sam****
>>>
>>> ** **
>>>
>>> *From:* chris king [mailto:kingces95 at gmail.com]
>>> *Sent:* Tuesday, August 09, 2011 6:29 PM
>>> *To:* Sam Harwell; antlr-interest at antlr.org
>>>
>>> *Subject:* Re: [antlr-interest] To Sam Harwell****
>>>
>>> ** **
>>>
>>> Sam, hey, so I might have bumped into a code gen bug. I'm trying to
>>> access a variable "skipSection" on the parent production of
>>> "pp_conditional". It looks like the generated code is doing some computation
>>> involving the stack count when really it should just pass my index without
>>> any calculation. For example, below, shouldn't the highlighted code
>>> simply be my index? Or am I missing something? Looks like the
>>> highlighted code is assuming TOS is Count - 1 (like it would be with a stack
>>> implemented with a List<T>) but I don't think that's the case. The stack is
>>> a System.Collections.Generic.Stack<T> which maintains that TOS is always
>>> index 0. ****
>>>
>>> ** **
>>>
>>> $pp_conditional[1]::skipSection****
>>>
>>> ** **
>>>
>>> The code above is transformed to:****
>>>
>>> ** **
>>>
>>> System.Linq.Enumerable.ElementAt(pp_conditional_stack,
>>> pp_conditional_stack.Count-1-1).skipSection;****
>>>
>>> ** **
>>>
>>> Also, you may want to ensure that all user expressions are enclosed in
>>> parens. As I was trying to work around this issue I used "count -2" which
>>> got translated to stack.Count-count -2 -1. I had to add the parens to get it
>>> to be stack.Count-(count -2) -1.****
>>>
>>> ** **
>>>
>>> Thanks,****
>>>
>>> Chris****
>>>
>>> ** **
>>>
>>> On Thu, Aug 4, 2011 at 6:00 PM, chris king <kingces95 at gmail.com> wrote:*
>>> ***
>>>
>>> Ok. Thanks for looking into it. ****
>>>
>>> ** **
>>>
>>> On Thu, Aug 4, 2011 at 5:56 PM, Sam Harwell <sharwell at pixelminegames.com>
>>> wrote:****
>>>
>>> I did, and I can repro the issue but I haven?t resolved it yet.****
>>>
>>>  ****
>>>
>>> Sam****
>>>
>>>  ****
>>>
>>> *From:* chris king [mailto:kingces95 at gmail.com]
>>> *Sent:* Thursday, August 04, 2011 6:48 PM
>>> *To:* Sam Harwell
>>> *Cc:* antlr-interest at antlr.org
>>> *Subject:* Re: [antlr-interest] To Sam Harwell****
>>>
>>>  ****
>>>
>>> Awesome! I'll give it try. Did you see my follow up email that the parse
>>> string is 5 characters (there is a trailing space)? "/**/ " ****
>>>
>>>  ****
>>>
>>> And again, love the tool chain. I only really started to get traction on
>>> my project after I installed it. It's working great.****
>>>
>>>  ****
>>>
>>> Thanks,
>>> Chris****
>>>
>>>  ****
>>>
>>> On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>
>>> wrote:****
>>>
>>> Hi Chris,
>>>
>>> In build 3.4.1.9004 that I released today, I switched all the projects to
>>> using $(ProjectDir) with relative paths.
>>>
>>> http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases****
>>>
>>>
>>> Sam
>>>
>>> -----Original Message-----
>>> From: antlr-interest-bounces at antlr.org
>>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
>>> Sent: Monday, July 25, 2011 6:39 PM
>>> To: antlr-interest at antlr.org
>>> Subject: [antlr-interest] To Sam Harwell****
>>>
>>> Sam, hey, hope this finds you. Very small suggestion follows :). In
>>> Antlr3.StringTemplate.csproj could you use
>>>
>>>
>>>
>>> <AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
>>> askPath>
>>>
>>> to reference the bootstrap directory? Originally it used the solutionDir
>>> and
>>> that prevented me from including a subset of the projects in my project
>>> (so
>>> I could simply reference them and have all the debugging, pdb, source,
>>> etc
>>> just work).
>>>
>>> Thanks,
>>> Chris****
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address**
>>> **
>>>
>>>  ****
>>>
>>> ** **
>>>
>>> ** **
>>>
>>
>>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CSharp.cs
Type: application/octet-stream
Size: 21831 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20110809/14ad6512/attachment.obj 

From sharwell at pixelminegames.com  Tue Aug  9 21:41:39 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Tue, 9 Aug 2011 23:41:39 -0500
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <CAJQwtsi3v7uRepYo46JU5sMwNwwhjHV4aJdO+ipWZDVvJd=Jqg@mail.gmail.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>	<CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>	<048501cc530a$73f5d1d0$5be17570$@pixelminegames.com>	<CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>	<CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>	<067401cc56f0$c4ec9300$4ec5b900$@pixelminegames.com>	<CAJQwtshkH0XhCaGUsHPx4Q3B_4-_GSQvktW6HHtbaiZfQhVQTQ@mail.gmail.com>	<CAJQwtshGkA2HV_Q9WkVmxzxvUnOQk-6mUfSHfxOd+TVzAfVogg@mail.gmail.com>
	<CAJQwtsi3v7uRepYo46JU5sMwNwwhjHV4aJdO+ipWZDVvJd=Jqg@mail.gmail.com>
Message-ID: <069601cc5717$cc3bb0b0$64b31210$@pixelminegames.com>

Hi Chris,

 

You attached CSharp.cs instead of CSharp.g3, so I currently can't reproduce
this issue.

 

I'm glad you caught this. It definitely looks like a bug in some work I
recently did on the predicate analyzer.

 

I'll have to get this taken care of tomorrow since it's late here. :)

 

Thanks,

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Tuesday, August 09, 2011 9:56 PM
To: Sam Harwell; antlr-interest at antlr.org
Subject: Re: [antlr-interest] To Sam Harwell

 

Sam, hey. Sorry to shower you with e-mails today. :) I got your new version
setup up and building but now one of my grammar file is causing a stack
overflow. I'm not sure if this is a problem with the CSharp port or a bug in
the Java ANTLR logic. Anyway, the attached grammer file of mine worked with
v3.3.1.7705 but with v3.4.1.9004 is causing a stack overflow in antlr3.exe.
To repro include the attached file in a .csproj as an Antlr3 include per
your instructions. Then uncomment either one of these rules and save to
execute Antlr3. 

 

pp_conditional_section

  : //{ !SkipSection }? => input_section

  | //{ SkipSection }? => pp_skipped_section_part*

  ;

 

Here's how I'm include the file in the project: 

 

    <Antlr3 Include="CSharp.g">

      <Generator>MSBuild:Compile</Generator>

    </Antlr3>

 

Here's the top of the function signature that I'm recursing through:

 

        // Factor so (a || b) == (result || a || b)

        public static SemanticContext FactorOr(ref SemanticContext a, ref
SemanticContext b)

        {

            HashSet<SemanticContext> opsA = new
HashSet<SemanticContext>(GetOrOperands(a));

            HashSet<SemanticContext> opsB = new
HashSet<SemanticContext>(GetOrOperands(b));

 

Here's a stack trace of the recursion I'm seeing. The line numbers should
match the source in v3.4.1.9004. I used that source to build the Antlr3.exe
that's having the stack overflow.

 

            Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
C#

            Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 809     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 730     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 740     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 740     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 730     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 813     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 730     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.ComputeStartState()
Line 176           C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Convert() Line 90
C#

            Antlr3.EXE!Antlr3.Analysis.DFA.CreateFromNfa(decisionNumber,
decisionStartState) Line 243           C#

            Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFA(decision,
wackTempStructures) Line 1858      C#

 
Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs(wackTempStructures) Line
1586        C#

            Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs() Line 1526
C#

 
Antlr3.EXE!Antlr3.Codegen.Target.PerformGrammarAnalysis(generator, grammar)
Line 121       C#

            Antlr3.EXE!Antlr3.Codegen.CodeGenerator.GenRecognizer() Line 670
C#

            Antlr3.EXE!Antlr3.AntlrTool.GenerateRecognizer(grammar) Line 791
C#

            Antlr3.EXE!Antlr3.AntlrTool.Process() Line 586     C#

 
AntlrBuildTask.DLL!Antlr3.Build.Tasks.AntlrClassGenerationTaskInternal.Execu
te() Line 135   C#

 

Thanks,

Chris

 

 

On Tue, Aug 9, 2011 at 6:39 PM, chris king <kingces95 at gmail.com> wrote:

Also, in Antlr3.csproj I think LeftRecursiveRules.stg was pointing to the
wrong place. I changed it to this and then the solution compiled:

 

    <EmbeddedResource
Include="..\..\..\antlr\antlr3-main\tool\src\main\resources\org\antlr\codege
n\templates\LeftRecursiveRules.stg">

 

Thanks,
Chris

 

On Tue, Aug 9, 2011 at 6:24 PM, chris king <kingces95 at gmail.com> wrote:

Sam, thanks! FYI The compilation of your source drop fails because the key
file is not included. You may want to disabled signing in all your projects
before you release the source drop or provide a dummy key file or find some
work around so folks can just open up the source and compile it. That would
help upgrading to the next version.

Thanks,
Chris

 

On Tue, Aug 9, 2011 at 5:02 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

Hi Chris,

 

I got rid of the use of Stack<T> and the call to ElementAt() quite a while
back. Instead I use a ListStack<T> which derives from List<T> and adds Push
and Pop methods. I recommend updating to ANTLR 3.4.1 to correct this issue.

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Tuesday, August 09, 2011 6:29 PM
To: Sam Harwell; antlr-interest at antlr.org


Subject: Re: [antlr-interest] To Sam Harwell

 

Sam, hey, so I might have bumped into a code gen bug. I'm trying to access a
variable "skipSection" on the parent production of "pp_conditional". It
looks like the generated code is doing some computation involving the stack
count when really it should just pass my index without any calculation. For
example, below, shouldn't the highlighted code simply be my index? Or am I
missing something? Looks like the highlighted code is assuming TOS is Count
- 1 (like it would be with a stack implemented with a List<T>) but I don't
think that's the case. The stack is a System.Collections.Generic.Stack<T>
which maintains that TOS is always index 0. 

 

$pp_conditional[1]::skipSection

 

The code above is transformed to:

 

System.Linq.Enumerable.ElementAt(pp_conditional_stack,
pp_conditional_stack.Count-1-1).skipSection;

 

Also, you may want to ensure that all user expressions are enclosed in
parens. As I was trying to work around this issue I used "count -2" which
got translated to stack.Count-count -2 -1. I had to add the parens to get it
to be stack.Count-(count -2) -1.

 

Thanks,

Chris

 

On Thu, Aug 4, 2011 at 6:00 PM, chris king <kingces95 at gmail.com> wrote:

Ok. Thanks for looking into it. 

 

On Thu, Aug 4, 2011 at 5:56 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

I did, and I can repro the issue but I haven't resolved it yet.

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Thursday, August 04, 2011 6:48 PM
To: Sam Harwell
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] To Sam Harwell

 

Awesome! I'll give it try. Did you see my follow up email that the parse
string is 5 characters (there is a trailing space)? "/**/ " 

 

And again, love the tool chain. I only really started to get traction on my
project after I installed it. It's working great.

 

Thanks,
Chris

 

On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

Hi Chris,

In build 3.4.1.9004 that I released today, I switched all the projects to
using $(ProjectDir) with relative paths.

http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases


Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
Sent: Monday, July 25, 2011 6:39 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] To Sam Harwell

Sam, hey, hope this finds you. Very small suggestion follows :). In
Antlr3.StringTemplate.csproj could you use


<AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
askPath>

to reference the bootstrap directory? Originally it used the solutionDir and
that prevented me from including a subset of the projects in my project (so
I could simply reference them and have all the debugging, pdb, source, etc
just work).

Thanks,
Chris

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

 

 

 

 

 

 


From kingces95 at gmail.com  Tue Aug  9 21:47:20 2011
From: kingces95 at gmail.com (chris king)
Date: Tue, 9 Aug 2011 21:47:20 -0700
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <069601cc5717$cc3bb0b0$64b31210$@pixelminegames.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>
	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>
	<CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>
	<048501cc530a$73f5d1d0$5be17570$@pixelminegames.com>
	<CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>
	<CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>
	<067401cc56f0$c4ec9300$4ec5b900$@pixelminegames.com>
	<CAJQwtshkH0XhCaGUsHPx4Q3B_4-_GSQvktW6HHtbaiZfQhVQTQ@mail.gmail.com>
	<CAJQwtshGkA2HV_Q9WkVmxzxvUnOQk-6mUfSHfxOd+TVzAfVogg@mail.gmail.com>
	<CAJQwtsi3v7uRepYo46JU5sMwNwwhjHV4aJdO+ipWZDVvJd=Jqg@mail.gmail.com>
	<069601cc5717$cc3bb0b0$64b31210$@pixelminegames.com>
Message-ID: <CAJQwtsgb6MBdirjuzxJjszoA4CFioRo3J1JqZtJ7QbeEvv832w@mail.gmail.com>

Oops. Let's try this again...

On Tue, Aug 9, 2011 at 9:41 PM, Sam Harwell <sharwell at pixelminegames.com>wrote:

> Hi Chris,****
>
> ** **
>
> You attached CSharp.cs instead of CSharp.g3, so I currently can?t reproduce
> this issue.****
>
> ** **
>
> I?m glad you caught this. It definitely looks like a bug in some work I
> recently did on the predicate analyzer.****
>
> ** **
>
> I?ll have to get this taken care of tomorrow since it?s late here. :)****
>
> ** **
>
> Thanks,****
>
> Sam****
>
> ** **
>
> *From:* chris king [mailto:kingces95 at gmail.com]
> *Sent:* Tuesday, August 09, 2011 9:56 PM
>
> *To:* Sam Harwell; antlr-interest at antlr.org
> *Subject:* Re: [antlr-interest] To Sam Harwell****
>
> ** **
>
> Sam, hey. Sorry to shower you with e-mails today. :) I got your new version
> setup up and building but now one of my grammar file is causing a stack
> overflow. I'm not sure if this is a problem with the CSharp port or a bug in
> the Java ANTLR logic. Anyway, the attached grammer file of mine worked with
> v3.3.1.7705 but with v3.4.1.9004 is causing a stack overflow in antlr3.exe.
> To repro include the attached file in a .csproj as an Antlr3 include per
> your instructions. Then uncomment either one of these rules and save to
> execute Antlr3. ****
>
> ** **
>
> pp_conditional_section****
>
>   : //{ !SkipSection }? => input_section****
>
>   | //{ SkipSection }? => pp_skipped_section_part*****
>
>   ;****
>
> ** **
>
> Here's how I'm include the file in the project: ****
>
> ** **
>
>     <Antlr3 Include="CSharp.g">****
>
>       <Generator>MSBuild:Compile</Generator>****
>
>     </Antlr3>****
>
> ** **
>
> Here's the top of the function signature that I'm recursing through:****
>
> ** **
>
>         // Factor so (a || b) == (result || a || b)****
>
>         public static SemanticContext FactorOr(ref SemanticContext a, ref
> SemanticContext b)****
>
>         {****
>
>             HashSet<SemanticContext> opsA = new
> HashSet<SemanticContext>(GetOrOperands(a));****
>
>             HashSet<SemanticContext> opsB = new
> HashSet<SemanticContext>(GetOrOperands(b));****
>
> ** **
>
> Here's a stack trace of the recursion I'm seeing. The line numbers should
> match the source in v3.4.1.9004. I used that source to build the
> Antlr3.exe that's having the stack overflow.****
>
> ** **
>
>             Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
> C#****
>
>             Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
> C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 809     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 730     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 740     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 740     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 730     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 813     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 730     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.ComputeStartState()
> Line 176           C#****
>
>             Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Convert() Line 90
> C#****
>
>             Antlr3.EXE!Antlr3.Analysis.DFA.CreateFromNfa(decisionNumber,
> decisionStartState) Line 243           C#****
>
>             Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFA(decision,
> wackTempStructures) Line 1858      C#****
>
>             Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs(wackTempStructures)
> Line 1586        C#****
>
>             Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs() Line 1526
> C#****
>
>             Antlr3.EXE!Antlr3.Codegen.Target.PerformGrammarAnalysis(generator,
> grammar) Line 121       C#****
>
>             Antlr3.EXE!Antlr3.Codegen.CodeGenerator.GenRecognizer() Line
> 670    C#****
>
>             Antlr3.EXE!Antlr3.AntlrTool.GenerateRecognizer(grammar) Line
> 791       C#****
>
>             Antlr3.EXE!Antlr3.AntlrTool.Process() Line 586     C#****
>
>             AntlrBuildTask.DLL!Antlr3.Build.Tasks.AntlrClassGenerationTaskInternal.Execute()
> Line 135   C#****
>
> ** **
>
> Thanks,****
>
> Chris****
>
> ** **
>
> ** **
>
> On Tue, Aug 9, 2011 at 6:39 PM, chris king <kingces95 at gmail.com> wrote:***
> *
>
> Also, in Antlr3.csproj I think LeftRecursiveRules.stg was pointing to the
> wrong place. I changed it to this and then the solution compiled:****
>
> ** **
>
>     <EmbeddedResource
> Include="..\..\..\antlr\antlr3-main\tool\src\main\resources\org\antlr\codegen\templates\LeftRecursiveRules.stg">
> ****
>
> ** **
>
> Thanks,
> Chris****
>
> ** **
>
> On Tue, Aug 9, 2011 at 6:24 PM, chris king <kingces95 at gmail.com> wrote:***
> *
>
> Sam, thanks! FYI The compilation of your source drop fails because the key
> file is not included. You may want to disabled signing in all your projects
> before you release the source drop or provide a dummy key file or find some
> work around so folks can just open up the source and compile it. That would
> help upgrading to the next version.****
>
> Thanks,
> Chris****
>
> ** **
>
> On Tue, Aug 9, 2011 at 5:02 PM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:****
>
> Hi Chris,****
>
>  ****
>
> I got rid of the use of Stack<T> and the call to ElementAt() quite a while
> back. Instead I use a ListStack<T> which derives from List<T> and adds Push
> and Pop methods. I recommend updating to ANTLR 3.4.1 to correct this issue.
> ****
>
>  ****
>
> Sam****
>
>  ****
>
> *From:* chris king [mailto:kingces95 at gmail.com]
> *Sent:* Tuesday, August 09, 2011 6:29 PM
> *To:* Sam Harwell; antlr-interest at antlr.org****
>
>
> *Subject:* Re: [antlr-interest] To Sam Harwell****
>
>  ****
>
> Sam, hey, so I might have bumped into a code gen bug. I'm trying to access
> a variable "skipSection" on the parent production of "pp_conditional". It
> looks like the generated code is doing some computation involving the stack
> count when really it should just pass my index without any calculation. For
> example, below, shouldn't the highlighted code simply be my index? Or am I
> missing something? Looks like the highlighted code is assuming TOS is Count
> - 1 (like it would be with a stack implemented with a List<T>) but I don't
> think that's the case. The stack is a System.Collections.Generic.Stack<T>
> which maintains that TOS is always index 0. ****
>
>  ****
>
> $pp_conditional[1]::skipSection****
>
>  ****
>
> The code above is transformed to:****
>
>  ****
>
> System.Linq.Enumerable.ElementAt(pp_conditional_stack,
> pp_conditional_stack.Count-1-1).skipSection;****
>
>  ****
>
> Also, you may want to ensure that all user expressions are enclosed in
> parens. As I was trying to work around this issue I used "count -2" which
> got translated to stack.Count-count -2 -1. I had to add the parens to get it
> to be stack.Count-(count -2) -1.****
>
>  ****
>
> Thanks,****
>
> Chris****
>
>  ****
>
> On Thu, Aug 4, 2011 at 6:00 PM, chris king <kingces95 at gmail.com> wrote:***
> *
>
> Ok. Thanks for looking into it. ****
>
>  ****
>
> On Thu, Aug 4, 2011 at 5:56 PM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:****
>
> I did, and I can repro the issue but I haven?t resolved it yet.****
>
>  ****
>
> Sam****
>
>  ****
>
> *From:* chris king [mailto:kingces95 at gmail.com]
> *Sent:* Thursday, August 04, 2011 6:48 PM
> *To:* Sam Harwell
> *Cc:* antlr-interest at antlr.org
> *Subject:* Re: [antlr-interest] To Sam Harwell****
>
>  ****
>
> Awesome! I'll give it try. Did you see my follow up email that the parse
> string is 5 characters (there is a trailing space)? "/**/ " ****
>
>  ****
>
> And again, love the tool chain. I only really started to get traction on my
> project after I installed it. It's working great.****
>
>  ****
>
> Thanks,
> Chris****
>
>  ****
>
> On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:****
>
> Hi Chris,
>
> In build 3.4.1.9004 that I released today, I switched all the projects to
> using $(ProjectDir) with relative paths.
>
> http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases****
>
>
> Sam
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
> Sent: Monday, July 25, 2011 6:39 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] To Sam Harwell****
>
> Sam, hey, hope this finds you. Very small suggestion follows :). In
> Antlr3.StringTemplate.csproj could you use
>
>
>
> <AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
> askPath>
>
> to reference the bootstrap directory? Originally it used the solutionDir
> and
> that prevented me from including a subset of the projects in my project (so
> I could simply reference them and have all the debugging, pdb, source, etc
> just work).
>
> Thanks,
> Chris****
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address****
>
>  ****
>
>  ****
>
>  ****
>
> ** **
>
> ** **
>
> ** **
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CSharp.g
Type: application/octet-stream
Size: 8676 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20110809/14fb9329/attachment.obj 

From contact at maik-schmidt.de  Wed Aug 10 00:06:54 2011
From: contact at maik-schmidt.de (Maik Schmidt)
Date: Wed, 10 Aug 2011 09:06:54 +0200
Subject: [antlr-interest] Differences in Java and C# error handling
Message-ID: <CACotV_1f0UKBtrQ5BWyFayJi0_xsApyLYP3fA5qv6T8oDamVBA@mail.gmail.com>

Hi!

At the moment I am reading "Language Implementation Patterns" and I am
translating the book's examples to C#. While doing so I've seen some
differences in error handling that I cannot explain. I'm using the following
grammar:

grammar Graphics;

file : command+ ; // a file is a list of commands

command : 'line' 'from' point 'to' point ;

point : INT ',' INT ; // E.g., "0,10"

INT : '0'..'9'+ ; // lexer rule to match 1-or-more digits

/** Skip whitespace */
WS : (' ' | '\t' | '\r' | '\n') { Skip(); } ;

I translate it using 'java org.antlr.Tool Graphics.g3' into
GraphicsLexer.java and GraphicsLexer.java and I use the following driver
code for controlling the parser:

public static void main(String[] args) throws Exception {
  CharStream input = new ANTLRFileStream(args[0]);
  GraphicsLexer lex = new GraphicsLexer(input);
  CommonTokenStream tokens = new CommonTokenStream(lex);
  GraphicsParser p = new GraphicsParser(tokens);
  p.file();
}

Also I have a file named invalid.txt that contains the following invalid
input sentence:

line to 2,3

When I pass this file to the driver code, the program outputs the following
message:

line 1:5 mismatched input 'to' expecting 'from'

This is exactly what I would expect and it's exactly the behavior Terrence
describes in his book.

Then I have translated the grammar to C#, so it looks like this:

grammar Graphics;

options {
    language=CSharp3;
    TokenLabelType=CommonToken;
    output=AST;
    ASTLabelType=CommonTree;
}

@parser::namespace { GraphicsTool }
@lexer::namespace { GraphicsTool }

public

file : command+ ; // a file is a list of commands

command : 'line' 'from' point 'to' point ;

point : INT ',' INT ; // E.g., "0,10"

INT : '0'..'9'+ ; // lexer rule to match 1-or-more digits

/** Skip whitespace */
WS : (' ' | '\t' | '\r' | '\n') { Skip(); } ;

Using the ANTLR extensions for Visual Studio 2010 I have created
GraphicsLexer.cs and GraphicsParser.cs. Then I use the following driver
code:

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Antlr.Runtime;

namespace GraphicsTool
{
    class Program
    {
        static void Main(string[] args)
        {
            ANTLRStringStream input = new ANTLRFileStream(args[0]);
            GraphicsLexer lex = new GraphicsLexer(input);
            CommonTokenStream tokens = new CommonTokenStream(lex);
            GraphicsParser p = new GraphicsParser(tokens);
            p.file();
        }
    }
}

When I invoke the program with invalid.txt it silently ignores all errors
and stops without a message.

I have added

@rulecatch {
    catch (RecognitionException ex) {
    System.Console.WriteLine(ex);
        throw ex;
    }
}

to the grammar, so at least the program outputs an error message:

MismatchedTokenException('to'!='from')
MismatchedTokenException('to'!='from')

Unhandled Exception: Antlr.Runtime.MismatchedTokenException: A recognition
error occurred.
at GraphicsTool.GraphicsParser.file() in
C:\Users\mschmidt2\Documents\VisualStudio
2010\Projects\GraphicsTool\GraphicsTool\obj\x86\Debug\GraphicsParser.cs:line
174
at GraphicsTool.Program.Main(String[] args) in
C:\Users\mschmidt2\Documents\Visual Studio
2010\Projects\GraphicsTool\GraphicsTool\Program.cs:line 20

Of course, this isn't as nice as the Java behavior and I am wondering what
is causing the different behavior.

Is it possible to use the Java parser's behavior in C#?

Cheers,
Maik

From vester at jaist.ac.jp  Wed Aug 10 00:08:22 2011
From: vester at jaist.ac.jp (Rene Vestergaard)
Date: Wed, 10 Aug 2011 16:08:22 +0900
Subject: [antlr-interest] Semantical disambiguation of rule conflicts
Message-ID: <4E422E66.2060501@jaist.ac.jp>

I have a couple of rewrite rules on ASTs of the following kind, for use 
as part of bottomup:

flattenOuter	@init{boolean nestd=false;}
   : ^(c=OUTER 	( ^(OUTER ds+=.*)	{nestd=true;}
   	 	| ds+=.
   	 	)+)
	{nestd}?
	-> ^(OUTER $ds+)
   ;

The effect is to flatten nested occurrences of the OUTER constructor.

The inner two rules are obviously conflicting but, as the top rule is 
given preference, all is well. To suppress the resulting conflict 
warnings, I used to write these type of rules with a gated semantic 
predicate:

flattenOuter	@init{boolean nestd=false;}
   : ^(c=OUTER 	( {true}?=>	^(OUTER ds+=.*)	{nestd=true;}
   	 	| ds+=.
   	 	)+)
	{nestd}?
	-> ^(OUTER $ds+)
   ;

ANTLR 3.2 is happy with this. ANTLR 3.4 is not: the gated rules are 
seemingly not invoked.

This doesn't quite make sense. Might this be a bug, or could someone 
enlighten me about the rationale for the seemingly changed behaviour of 
ANTLR 3.4?

From mmatinlassi at icinetic.com  Wed Aug 10 01:17:35 2011
From: mmatinlassi at icinetic.com (Mari Matinlassi)
Date: Wed, 10 Aug 2011 10:17:35 +0200
Subject: [antlr-interest] Problem when generating ANTLRv3.g for C
	Sharp	target?
In-Reply-To: <061201cc569f$25ed28b0$71c77a10$@pixelminegames.com>
References: <000201cc5677$184517e0$48cf47a0$@icinetic.com>
	<061201cc569f$25ed28b0$71c77a10$@pixelminegames.com>
Message-ID: <001001cc5735$f6445ba0$e2cd12e0$@icinetic.com>

Thanks Sam!

After fixing the String issue I found 21 new errors.. However, after knowing
that the problem is an out-of-date grammar I managed to fix them too e.g.
"HIDDEN" -> "Hidden" and 
"(CommonTree)adaptor.create(.." -> "(CommonTree)adaptor.Create(.."

Now, going to continue with my experiments :-)

Laters,

Mari

-----Original Message-----
From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: Tuesday, August 09, 2011 4:18 PM
To: 'Mari Matinlassi'; antlr-interest at antlr.org
Subject: RE: [antlr-interest] Problem when generating ANTLRv3.g for C Sharp
target?

Hi Mari,

I've never used ANTLRv3.g, so it may have errors and it's probably not
up-to-date with the latest ANTLR.g3 used in the C# port of the tool. The
CSharp3 target doesn't emit a "using System;" line, so you'll need to do one
of the following:

1. Change the definition of name in the scope{...} block of the rule 'rule'
from String to string.

2. Add the header block:

@parser::header {
using System;
}

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Mari Matinlassi
Sent: Tuesday, August 09, 2011 4:31 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Problem when generating ANTLRv3.g for C Sharp
target?

Dear fellows,

 

Our research project wants to create meta-language for defining domain
specific languages. And, we have chosen to take ANTLR as a tool and
ANTLRv3.g as a starting point for our meta-language.

 

Therefore, I want to generate ANTLRv3Parser.cs and ANTLRv3Lexer.cs and build
them in Visual Studio (using C# target). However, I have a build error as
below:

"Error    1              The type or namespace name 'String' could not be
found (are you missing a using directive or an assembly reference?)
C:\VisualStudioProject\Testi\Testi\obj\Debug\ANTLRv3Parser.cs
2151       10           Testi"

 

And, indeed, there is a line in ANTLRv3Parser.cs as follows:

 

protected sealed partial class rule_scope

       {

              public String name;

 

              public rule_scope(ANTLRv3Parser grammar) { OnCreated(grammar);
}

              partial void OnCreated(ANTLRv3Parser grammar);

       }

 

Any idea what I am doing wrong?

 

I have followed this document (http://www.antlr.org/download/CSharp3.pdf) to
install and configure my Visual Studio project to work with Antlr.

 

This works fine, thanks for excellent guide! I get a simple grammar (such as
one below) to generate lexer and parser and compile them successfully.

Example grammar:

-----------------------------------Start of
T.g-----------------------------------------------------

grammar T;

 

options

{

       language=CSharp3;

       TokenLabelType=CommonToken;

       output=AST;

       ASTLabelType=CommonTree;

}

 

 

@lexer::namespace {ANTLRlanguage}

@parser::namespace {ANTLRlanguage}

 

public compileUnit 

       : ('x')+

       ;

 

 

IDENTIFIER

       :      ('a'..'z' | 'A'..'Z' |'_')('a'..'z' | 'A'..'Z' |'0'..'9'|'_')*

       ;

-----------------------------------End of
T.g--------------------------------------------------

 

Thanks for your help in advance,

 

Mari


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address




From contact at maik-schmidt.de  Wed Aug 10 02:42:52 2011
From: contact at maik-schmidt.de (Maik Schmidt)
Date: Wed, 10 Aug 2011 11:42:52 +0200
Subject: [antlr-interest] Differences in Java and C# error handling
In-Reply-To: <CACotV_1f0UKBtrQ5BWyFayJi0_xsApyLYP3fA5qv6T8oDamVBA@mail.gmail.com>
References: <CACotV_1f0UKBtrQ5BWyFayJi0_xsApyLYP3fA5qv6T8oDamVBA@mail.gmail.com>
Message-ID: <CACotV_01GWXiZMuom7yt1Kouub5-c8NG4BEONSzfJAg4bKehiQ@mail.gmail.com>

Hi!

At the moment I am reading "Language Implementation Patterns" and I am
translating the book's examples to C#. While doing so I've seen some
differences in error handling that I cannot explain. I'm using the following
grammar:

grammar Graphics;

file : command+ ; // a file is a list of commands

command : 'line' 'from' point 'to' point ;

point : INT ',' INT ; // E.g., "0,10"

INT : '0'..'9'+ ; // lexer rule to match 1-or-more digits

/** Skip whitespace */
WS : (' ' | '\t' | '\r' | '\n') { Skip(); } ;

I translate it using 'java org.antlr.Tool Graphics.g3' into
GraphicsLexer.java and GraphicsLexer.java and I use the following driver
code for controlling the parser:

public static void main(String[] args) throws Exception {
  CharStream input = new ANTLRFileStream(args[0]);
  GraphicsLexer lex = new GraphicsLexer(input);
  CommonTokenStream tokens = new CommonTokenStream(lex);
  GraphicsParser p = new GraphicsParser(tokens);
  p.file();
}

Also I have a file named invalid.txt that contains the following invalid
input sentence:

line to 2,3

When I pass this file to the driver code, the program outputs the following
message:

line 1:5 mismatched input 'to' expecting 'from'

This is exactly what I would expect and it's exactly the behavior Terrence
describes in his book.

Then I have translated the grammar to C#, so it looks like this:

grammar Graphics;

options {
    language=CSharp3;
    TokenLabelType=CommonToken;
    output=AST;
    ASTLabelType=CommonTree;
}

@parser::namespace { GraphicsTool }
@lexer::namespace { GraphicsTool }

public

file : command+ ; // a file is a list of commands

command : 'line' 'from' point 'to' point ;

point : INT ',' INT ; // E.g., "0,10"

INT : '0'..'9'+ ; // lexer rule to match 1-or-more digits

/** Skip whitespace */
WS : (' ' | '\t' | '\r' | '\n') { Skip(); } ;

Using the ANTLR extensions for Visual Studio 2010 I have created
GraphicsLexer.cs and GraphicsParser.cs. Then I use the following driver
code:

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Antlr.Runtime;

namespace GraphicsTool
{
    class Program
    {
        static void Main(string[] args)
        {
            ANTLRStringStream input = new ANTLRFileStream(args[0]);
            GraphicsLexer lex = new GraphicsLexer(input);
            CommonTokenStream tokens = new CommonTokenStream(lex);
            GraphicsParser p = new GraphicsParser(tokens);
            p.file();
        }
    }
}

When I invoke the program with invalid.txt it silently ignores all errors
and stops without a message.

I have added

@rulecatch {
    catch (RecognitionException ex) {
     System.Console.WriteLine(ex);
        throw ex;
    }
}

to the grammar, so at least the program outputs an error message:

MismatchedTokenException('to'!='from')
MismatchedTokenException('to'!='from')

Unhandled Exception: Antlr.Runtime.MismatchedTokenException: A recognition
error occurred.
at GraphicsTool.GraphicsParser.file() in
C:\Users\mschmidt2\Documents\VisualStudio
2010\Projects\GraphicsTool\GraphicsTool\obj\x86\Debug\GraphicsParser.cs:line
174
at GraphicsTool.Program.Main(String[] args) in
C:\Users\mschmidt2\Documents\Visual Studio
2010\Projects\GraphicsTool\GraphicsTool\Program.cs:line 20

Of course, this isn't as nice as the Java behavior and I am wondering what
is causing the different behavior.

Is it possible to use the Java parser's behavior in C#?

Cheers,
Maik

From david.smith at cc.gatech.edu  Wed Aug 10 07:02:22 2011
From: david.smith at cc.gatech.edu (David Smith)
Date: Wed, 10 Aug 2011 10:02:22 -0400
Subject: [antlr-interest] Access to line numbers
Message-ID: <E1Qr9MO-00037I-B1@elasmtp-curtail.atl.sa.earthlink.net>

It seems that the parse tree generated by the parser has a data field 
'line' that seems to correspond to the source line when parsing.  How 
do i access that to include the line number in the tree generated by 
my grammar?

DMS

David M. Smith http://www.cc.gatech.edu/fac/David.Smith
Georgia Institute of Technology, College of Computing
Sent from my ASR-33 Teletype 


From sharwell at pixelminegames.com  Wed Aug 10 07:36:28 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Wed, 10 Aug 2011 09:36:28 -0500
Subject: [antlr-interest] Access to line numbers
In-Reply-To: <E1Qr9MO-00037I-B1@elasmtp-curtail.atl.sa.earthlink.net>
References: <E1Qr9MO-00037I-B1@elasmtp-curtail.atl.sa.earthlink.net>
Message-ID: <06e601cc576a$e4a48980$aded9c80$@pixelminegames.com>

Both the Tree and Token interfaces have a method getLine().

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of David Smith
Sent: Wednesday, August 10, 2011 9:02 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Access to line numbers

It seems that the parse tree generated by the parser has a data field 'line'
that seems to correspond to the source line when parsing.  How do i access
that to include the line number in the tree generated by my grammar?

DMS

David M. Smith http://www.cc.gatech.edu/fac/David.Smith
Georgia Institute of Technology, College of Computing Sent from my ASR-33
Teletype 


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From sharwell at pixelminegames.com  Wed Aug 10 10:32:35 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Wed, 10 Aug 2011 12:32:35 -0500
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <CAJQwtsgb6MBdirjuzxJjszoA4CFioRo3J1JqZtJ7QbeEvv832w@mail.gmail.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>	<CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>	<048501cc530a$73f5d1d0$5be17570$@pixelminegames.com>	<CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>	<CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>	<067401cc56f0$c4ec9300$4ec5b900$@pixelminegames.com>	<CAJQwtshkH0XhCaGUsHPx4Q3B_4-_GSQvktW6HHtbaiZfQhVQTQ@mail.gmail.com>	<CAJQwtshGkA2HV_Q9WkVmxzxvUnOQk-6mUfSHfxOd+TVzAfVogg@mail.gmail.com>	<CAJQwtsi3v7uRepYo46JU5sMwNwwhjHV4aJdO+ipWZDVvJd=Jqg@mail.gmail.com>	<069601cc5717$cc3bb0b0$64b31210$@pixelminegames.com>
	<CAJQwtsgb6MBdirjuzxJjszoA4CFioRo3J1JqZtJ7QbeEvv832w@mail.gmail.com>
Message-ID: <06ed01cc5783$7ee57140$7cb053c0$@pixelminegames.com>

Hi Chris,

 

I fixed this for the next release, but I don't have a build ready yet. If
you'd like to make the change locally so you can keep working, just do the
following:

 

1. Add the following at the beginning of
SemanticContext.And(SemanticContext, SemanticContext):

 

if (a is FalsePredicate || b is FalsePredicate)

    return FalsePredicate.Instance;

 

2. Add the following at the beginning of SemanticContext.Or(SemanticContext,
SemanticContext):

 

if (a is TruePredicate || b is TruePredicate)

    return TruePredicate.Instance;

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Tuesday, August 09, 2011 11:47 PM
To: Sam Harwell
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] To Sam Harwell

 

Oops. Let's try this again...

On Tue, Aug 9, 2011 at 9:41 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

Hi Chris,

 

You attached CSharp.cs instead of CSharp.g3, so I currently can't reproduce
this issue.

 

I'm glad you caught this. It definitely looks like a bug in some work I
recently did on the predicate analyzer.

 

I'll have to get this taken care of tomorrow since it's late here. :)

 

Thanks,

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Tuesday, August 09, 2011 9:56 PM


To: Sam Harwell; antlr-interest at antlr.org
Subject: Re: [antlr-interest] To Sam Harwell

 

Sam, hey. Sorry to shower you with e-mails today. :) I got your new version
setup up and building but now one of my grammar file is causing a stack
overflow. I'm not sure if this is a problem with the CSharp port or a bug in
the Java ANTLR logic. Anyway, the attached grammer file of mine worked with
v3.3.1.7705 but with v3.4.1.9004 is causing a stack overflow in antlr3.exe.
To repro include the attached file in a .csproj as an Antlr3 include per
your instructions. Then uncomment either one of these rules and save to
execute Antlr3. 

 

pp_conditional_section

  : //{ !SkipSection }? => input_section

  | //{ SkipSection }? => pp_skipped_section_part*

  ;

 

Here's how I'm include the file in the project: 

 

    <Antlr3 Include="CSharp.g">

      <Generator>MSBuild:Compile</Generator>

    </Antlr3>

 

Here's the top of the function signature that I'm recursing through:

 

        // Factor so (a || b) == (result || a || b)

        public static SemanticContext FactorOr(ref SemanticContext a, ref
SemanticContext b)

        {

            HashSet<SemanticContext> opsA = new
HashSet<SemanticContext>(GetOrOperands(a));

            HashSet<SemanticContext> opsB = new
HashSet<SemanticContext>(GetOrOperands(b));

 

Here's a stack trace of the recursion I'm seeing. The line numbers should
match the source in v3.4.1.9004. I used that source to build the Antlr3.exe
that's having the stack overflow.

 

            Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
C#

            Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 809     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 730     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 740     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 740     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 730     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 813     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 730     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 823     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
context, semanticContext, d, collectPredicates) Line 760     C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.ComputeStartState()
Line 176           C#

            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Convert() Line 90
C#

            Antlr3.EXE!Antlr3.Analysis.DFA.CreateFromNfa(decisionNumber,
decisionStartState) Line 243           C#

            Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFA(decision,
wackTempStructures) Line 1858      C#

 
Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs(wackTempStructures) Line
1586        C#

            Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs() Line 1526
C#

 
Antlr3.EXE!Antlr3.Codegen.Target.PerformGrammarAnalysis(generator, grammar)
Line 121       C#

            Antlr3.EXE!Antlr3.Codegen.CodeGenerator.GenRecognizer() Line 670
C#

            Antlr3.EXE!Antlr3.AntlrTool.GenerateRecognizer(grammar) Line 791
C#

            Antlr3.EXE!Antlr3.AntlrTool.Process() Line 586     C#

 
AntlrBuildTask.DLL!Antlr3.Build.Tasks.AntlrClassGenerationTaskInternal.Execu
te() Line 135   C#

 

Thanks,

Chris

 

 

On Tue, Aug 9, 2011 at 6:39 PM, chris king <kingces95 at gmail.com> wrote:

Also, in Antlr3.csproj I think LeftRecursiveRules.stg was pointing to the
wrong place. I changed it to this and then the solution compiled:

 

    <EmbeddedResource
Include="..\..\..\antlr\antlr3-main\tool\src\main\resources\org\antlr\codege
n\templates\LeftRecursiveRules.stg">

 

Thanks,
Chris

 

On Tue, Aug 9, 2011 at 6:24 PM, chris king <kingces95 at gmail.com> wrote:

Sam, thanks! FYI The compilation of your source drop fails because the key
file is not included. You may want to disabled signing in all your projects
before you release the source drop or provide a dummy key file or find some
work around so folks can just open up the source and compile it. That would
help upgrading to the next version.

Thanks,
Chris

 

On Tue, Aug 9, 2011 at 5:02 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

Hi Chris,

 

I got rid of the use of Stack<T> and the call to ElementAt() quite a while
back. Instead I use a ListStack<T> which derives from List<T> and adds Push
and Pop methods. I recommend updating to ANTLR 3.4.1 to correct this issue.

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Tuesday, August 09, 2011 6:29 PM
To: Sam Harwell; antlr-interest at antlr.org


Subject: Re: [antlr-interest] To Sam Harwell

 

Sam, hey, so I might have bumped into a code gen bug. I'm trying to access a
variable "skipSection" on the parent production of "pp_conditional". It
looks like the generated code is doing some computation involving the stack
count when really it should just pass my index without any calculation. For
example, below, shouldn't the highlighted code simply be my index? Or am I
missing something? Looks like the highlighted code is assuming TOS is Count
- 1 (like it would be with a stack implemented with a List<T>) but I don't
think that's the case. The stack is a System.Collections.Generic.Stack<T>
which maintains that TOS is always index 0. 

 

$pp_conditional[1]::skipSection

 

The code above is transformed to:

 

System.Linq.Enumerable.ElementAt(pp_conditional_stack,
pp_conditional_stack.Count-1-1).skipSection;

 

Also, you may want to ensure that all user expressions are enclosed in
parens. As I was trying to work around this issue I used "count -2" which
got translated to stack.Count-count -2 -1. I had to add the parens to get it
to be stack.Count-(count -2) -1.

 

Thanks,

Chris

 

On Thu, Aug 4, 2011 at 6:00 PM, chris king <kingces95 at gmail.com> wrote:

Ok. Thanks for looking into it. 

 

On Thu, Aug 4, 2011 at 5:56 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

I did, and I can repro the issue but I haven't resolved it yet.

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Thursday, August 04, 2011 6:48 PM
To: Sam Harwell
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] To Sam Harwell

 

Awesome! I'll give it try. Did you see my follow up email that the parse
string is 5 characters (there is a trailing space)? "/**/ " 

 

And again, love the tool chain. I only really started to get traction on my
project after I installed it. It's working great.

 

Thanks,
Chris

 

On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

Hi Chris,

In build 3.4.1.9004 that I released today, I switched all the projects to
using $(ProjectDir) with relative paths.

http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases


Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
Sent: Monday, July 25, 2011 6:39 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] To Sam Harwell

Sam, hey, hope this finds you. Very small suggestion follows :). In
Antlr3.StringTemplate.csproj could you use


<AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
askPath>

to reference the bootstrap directory? Originally it used the solutionDir and
that prevented me from including a subset of the projects in my project (so
I could simply reference them and have all the debugging, pdb, source, etc
just work).

Thanks,
Chris

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

 

 

 

 

 

 

 


From parrt at cs.usfca.edu  Wed Aug 10 11:53:00 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 10 Aug 2011 11:53:00 -0700
Subject: [antlr-interest] To Sam Harwell
In-Reply-To: <06ed01cc5783$7ee57140$7cb053c0$@pixelminegames.com>
References: <CAJQwtsgc3jjCMAdWwJqzabHizK_xQYTLGNy1xNR4y7LW1+WYoQ@mail.gmail.com>	<048101cc52ff$1d6247a0$5826d6e0$@pixelminegames.com>	<CAJQwtsiKHSRua-=ER1uCjRmqQ6_e2OVok7HfuOF6r9wYefghwA@mail.gmail.com>	<048501cc530a$73f5d1d0$5be17570$@pixelminegames.com>	<CAJQwtsjHPZVGk=GNnmmEQiESBp29opYEnaswt+exAdQkz0-FYg@mail.gmail.com>	<CAJQwtshE1w_R+zPbxkrP_HFAMQp4t4STUJOSu_75T2LzG4z7vg@mail.gmail.com>	<067401cc56f0$c4ec9300$4ec5b900$@pixelminegames.com>	<CAJQwtshkH0XhCaGUsHPx4Q3B_4-_GSQvktW6HHtbaiZfQhVQTQ@mail.gmail.com>	<CAJQwtshGkA2HV_Q9WkVmxzxvUnOQk-6mUfSHfxOd+TVzAfVogg@mail.gmail.com>	<CAJQwtsi3v7uRepYo46JU5sMwNwwhjHV4aJdO+ipWZDVvJd=Jqg@mail.gmail.com>	<069601cc5717$cc3bb0b0$64b31210$@pixelminegames.com>
	<CAJQwtsgb6MBdirjuzxJjszoA4CFioRo3J1JqZtJ7QbeEvv832w@mail.gmail.com>
	<06ed01cc5783$7ee57140$7cb053c0$@pixelminegames.com>
Message-ID: <BEBDB36C-DFC5-47EB-8D19-FBACBFF27AEE@cs.usfca.edu>

Sam: do i need to fix in java version?
Ter
On Aug 10, 2011, at 10:32 AM, Sam Harwell wrote:

> Hi Chris,
> 
> 
> 
> I fixed this for the next release, but I don't have a build ready yet. If
> you'd like to make the change locally so you can keep working, just do the
> following:
> 
> 
> 
> 1. Add the following at the beginning of
> SemanticContext.And(SemanticContext, SemanticContext):
> 
> 
> 
> if (a is FalsePredicate || b is FalsePredicate)
> 
>    return FalsePredicate.Instance;
> 
> 
> 
> 2. Add the following at the beginning of SemanticContext.Or(SemanticContext,
> SemanticContext):
> 
> 
> 
> if (a is TruePredicate || b is TruePredicate)
> 
>    return TruePredicate.Instance;
> 
> 
> 
> Sam
> 
> 
> 
> From: chris king [mailto:kingces95 at gmail.com] 
> Sent: Tuesday, August 09, 2011 11:47 PM
> To: Sam Harwell
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] To Sam Harwell
> 
> 
> 
> Oops. Let's try this again...
> 
> On Tue, Aug 9, 2011 at 9:41 PM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:
> 
> Hi Chris,
> 
> 
> 
> You attached CSharp.cs instead of CSharp.g3, so I currently can't reproduce
> this issue.
> 
> 
> 
> I'm glad you caught this. It definitely looks like a bug in some work I
> recently did on the predicate analyzer.
> 
> 
> 
> I'll have to get this taken care of tomorrow since it's late here. :)
> 
> 
> 
> Thanks,
> 
> Sam
> 
> 
> 
> From: chris king [mailto:kingces95 at gmail.com] 
> Sent: Tuesday, August 09, 2011 9:56 PM
> 
> 
> To: Sam Harwell; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] To Sam Harwell
> 
> 
> 
> Sam, hey. Sorry to shower you with e-mails today. :) I got your new version
> setup up and building but now one of my grammar file is causing a stack
> overflow. I'm not sure if this is a problem with the CSharp port or a bug in
> the Java ANTLR logic. Anyway, the attached grammer file of mine worked with
> v3.3.1.7705 but with v3.4.1.9004 is causing a stack overflow in antlr3.exe.
> To repro include the attached file in a .csproj as an Antlr3 include per
> your instructions. Then uncomment either one of these rules and save to
> execute Antlr3. 
> 
> 
> 
> pp_conditional_section
> 
>  : //{ !SkipSection }? => input_section
> 
>  | //{ SkipSection }? => pp_skipped_section_part*
> 
>  ;
> 
> 
> 
> Here's how I'm include the file in the project: 
> 
> 
> 
>    <Antlr3 Include="CSharp.g">
> 
>      <Generator>MSBuild:Compile</Generator>
> 
>    </Antlr3>
> 
> 
> 
> Here's the top of the function signature that I'm recursing through:
> 
> 
> 
>        // Factor so (a || b) == (result || a || b)
> 
>        public static SemanticContext FactorOr(ref SemanticContext a, ref
> SemanticContext b)
> 
>        {
> 
>            HashSet<SemanticContext> opsA = new
> HashSet<SemanticContext>(GetOrOperands(a));
> 
>            HashSet<SemanticContext> opsB = new
> HashSet<SemanticContext>(GetOrOperands(b));
> 
> 
> 
> Here's a stack trace of the recursion I'm seeing. The line numbers should
> match the source in v3.4.1.9004. I used that source to build the Antlr3.exe
> that's having the stack overflow.
> 
> 
> 
>            Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
> C#
> 
>            Antlr3.EXE!Antlr3.Analysis.SemanticContext.And(a, b) Line 681
> C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 809     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 730     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 740     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 740     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 730     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 813     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 730     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 823     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Closure(p, alt,
> context, semanticContext, d, collectPredicates) Line 760     C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.ComputeStartState()
> Line 176           C#
> 
>            Antlr3.EXE!Antlr3.Analysis.NFAToDFAConverter.Convert() Line 90
> C#
> 
>            Antlr3.EXE!Antlr3.Analysis.DFA.CreateFromNfa(decisionNumber,
> decisionStartState) Line 243           C#
> 
>            Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFA(decision,
> wackTempStructures) Line 1858      C#
> 
> 
> Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs(wackTempStructures) Line
> 1586        C#
> 
>            Antlr3.EXE!Antlr3.Tool.Grammar.CreateLookaheadDFAs() Line 1526
> C#
> 
> 
> Antlr3.EXE!Antlr3.Codegen.Target.PerformGrammarAnalysis(generator, grammar)
> Line 121       C#
> 
>            Antlr3.EXE!Antlr3.Codegen.CodeGenerator.GenRecognizer() Line 670
> C#
> 
>            Antlr3.EXE!Antlr3.AntlrTool.GenerateRecognizer(grammar) Line 791
> C#
> 
>            Antlr3.EXE!Antlr3.AntlrTool.Process() Line 586     C#
> 
> 
> AntlrBuildTask.DLL!Antlr3.Build.Tasks.AntlrClassGenerationTaskInternal.Execu
> te() Line 135   C#
> 
> 
> 
> Thanks,
> 
> Chris
> 
> 
> 
> 
> 
> On Tue, Aug 9, 2011 at 6:39 PM, chris king <kingces95 at gmail.com> wrote:
> 
> Also, in Antlr3.csproj I think LeftRecursiveRules.stg was pointing to the
> wrong place. I changed it to this and then the solution compiled:
> 
> 
> 
>    <EmbeddedResource
> Include="..\..\..\antlr\antlr3-main\tool\src\main\resources\org\antlr\codege
> n\templates\LeftRecursiveRules.stg">
> 
> 
> 
> Thanks,
> Chris
> 
> 
> 
> On Tue, Aug 9, 2011 at 6:24 PM, chris king <kingces95 at gmail.com> wrote:
> 
> Sam, thanks! FYI The compilation of your source drop fails because the key
> file is not included. You may want to disabled signing in all your projects
> before you release the source drop or provide a dummy key file or find some
> work around so folks can just open up the source and compile it. That would
> help upgrading to the next version.
> 
> Thanks,
> Chris
> 
> 
> 
> On Tue, Aug 9, 2011 at 5:02 PM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:
> 
> Hi Chris,
> 
> 
> 
> I got rid of the use of Stack<T> and the call to ElementAt() quite a while
> back. Instead I use a ListStack<T> which derives from List<T> and adds Push
> and Pop methods. I recommend updating to ANTLR 3.4.1 to correct this issue.
> 
> 
> 
> Sam
> 
> 
> 
> From: chris king [mailto:kingces95 at gmail.com] 
> Sent: Tuesday, August 09, 2011 6:29 PM
> To: Sam Harwell; antlr-interest at antlr.org
> 
> 
> Subject: Re: [antlr-interest] To Sam Harwell
> 
> 
> 
> Sam, hey, so I might have bumped into a code gen bug. I'm trying to access a
> variable "skipSection" on the parent production of "pp_conditional". It
> looks like the generated code is doing some computation involving the stack
> count when really it should just pass my index without any calculation. For
> example, below, shouldn't the highlighted code simply be my index? Or am I
> missing something? Looks like the highlighted code is assuming TOS is Count
> - 1 (like it would be with a stack implemented with a List<T>) but I don't
> think that's the case. The stack is a System.Collections.Generic.Stack<T>
> which maintains that TOS is always index 0. 
> 
> 
> 
> $pp_conditional[1]::skipSection
> 
> 
> 
> The code above is transformed to:
> 
> 
> 
> System.Linq.Enumerable.ElementAt(pp_conditional_stack,
> pp_conditional_stack.Count-1-1).skipSection;
> 
> 
> 
> Also, you may want to ensure that all user expressions are enclosed in
> parens. As I was trying to work around this issue I used "count -2" which
> got translated to stack.Count-count -2 -1. I had to add the parens to get it
> to be stack.Count-(count -2) -1.
> 
> 
> 
> Thanks,
> 
> Chris
> 
> 
> 
> On Thu, Aug 4, 2011 at 6:00 PM, chris king <kingces95 at gmail.com> wrote:
> 
> Ok. Thanks for looking into it. 
> 
> 
> 
> On Thu, Aug 4, 2011 at 5:56 PM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:
> 
> I did, and I can repro the issue but I haven't resolved it yet.
> 
> 
> 
> Sam
> 
> 
> 
> From: chris king [mailto:kingces95 at gmail.com] 
> Sent: Thursday, August 04, 2011 6:48 PM
> To: Sam Harwell
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] To Sam Harwell
> 
> 
> 
> Awesome! I'll give it try. Did you see my follow up email that the parse
> string is 5 characters (there is a trailing space)? "/**/ " 
> 
> 
> 
> And again, love the tool chain. I only really started to get traction on my
> project after I installed it. It's working great.
> 
> 
> 
> Thanks,
> Chris
> 
> 
> 
> On Thu, Aug 4, 2011 at 4:34 PM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:
> 
> Hi Chris,
> 
> In build 3.4.1.9004 that I released today, I switched all the projects to
> using $(ProjectDir) with relative paths.
> 
> http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases
> 
> 
> Sam
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of chris king
> Sent: Monday, July 25, 2011 6:39 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] To Sam Harwell
> 
> Sam, hey, hope this finds you. Very small suggestion follows :). In
> Antlr3.StringTemplate.csproj could you use
> 
> 
> <AntlrBuildTaskPath>$(MSBuildProjectDirectory)\..\bin\Bootstrap</AntlrBuildT
> askPath>
> 
> to reference the bootstrap directory? Originally it used the solutionDir and
> that prevented me from including a subset of the projects in my project (so
> I could simply reference them and have all the debugging, pdb, source, etc
> just work).
> 
> Thanks,
> Chris
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From david.smith at cc.gatech.edu  Wed Aug 10 13:09:29 2011
From: david.smith at cc.gatech.edu (David Smith)
Date: Wed, 10 Aug 2011 16:09:29 -0400
Subject: [antlr-interest] Follow-up on line numbers
Message-ID: <E1QrF5f-0006rk-DJ@elasmtp-spurfowl.atl.sa.earthlink.net>

Sam,
I understood the answer, but we're talking novice here - if the front 
end of my grammar looks like this:

prog:   body EOF!
         ;

body    :
         parts -> ^(BODY parts)
         ;

parts   :
         ( (stat
            | ifStat
            | switchStat
            | whileStat
            | forStat)   )*
         ;

stat:
         (ID OPENP actualParameters CLOSEP DOT ID GETS)
          => str=ID OPENP actualParameters CLOSEP  DOT fld=ID GETS expr
          -> ^(GETS ?????? ^(STRUCTA $str $fld actualParameters) expr)
     |   (ID OPENP actualParameters CLOSEP DOT OPENP)
          => str=ID OPENP actualParameters CLOSEP DOT OPENP var=ID 
CLOSEP GETS expr
          -> ^(GETS ???????? ^(STRUCTAV $str $var actualParameters) expr)
// etc
     ;
how would I insert the line number at the ???????

DMS
Message: 13
Date: Wed, 10 Aug 2011 10:02:22 -0400
From: David Smith <david.smith at cc.gatech.edu>
Subject: [antlr-interest] Access to line numbers
To: antlr-interest at antlr.org
Message-ID: <E1Qr9MO-00037I-B1 at elasmtp-curtail.atl.sa.earthlink.net>
Content-Type: text/plain; charset="us-ascii"; format=flowed

It seems that the parse tree generated by the parser has a data field
'line' that seems to correspond to the source line when parsing.  How
do i access that to include the line number in the tree generated by
my grammar?

DMS

David M. Smith http://www.cc.gatech.edu/fac/David.Smith
Georgia Institute of Technology, College of Computing
Sent from my ASR-33 Teletype



------------------------------

Message: 14
Date: Wed, 10 Aug 2011 09:36:28 -0500
From: "Sam Harwell" <sharwell at pixelminegames.com>
Subject: Re: [antlr-interest] Access to line numbers
To: "'David Smith'" <david.smith at cc.gatech.edu>,
         <antlr-interest at antlr.org>
Message-ID: <06e601cc576a$e4a48980$aded9c80$@pixelminegames.com>
Content-Type: text/plain;       charset="us-ascii"

Both the Tree and Token interfaces have a method getLine().

Sam

 >From: antlr-interest-bounces at antlr.org
 >[mailto:antlr-interest-bounces at antlr.org] On Behalf Of David Smith
 >Sent: Wednesday, August 10, 2011 9:02 AM
  ...snip...
 >List: http://www.antlr.org/mailman/listinfo/antlr-interest
 >Unsubscribe:
 >http://www.antlr.org/mailman/options/antlr-interest/your-email-address



David M. Smith http://www.cc.gatech.edu/fac/David.Smith
Georgia Institute of Technology, College of Computing
Sent from my ASR-33 Teletype 


From jbb at acm.org  Wed Aug 10 14:41:56 2011
From: jbb at acm.org (John B. Brodie)
Date: Wed, 10 Aug 2011 17:41:56 -0400
Subject: [antlr-interest] Follow-up on line numbers
In-Reply-To: <E1QrF5f-0006rk-DJ@elasmtp-spurfowl.atl.sa.earthlink.net>
References: <E1QrF5f-0006rk-DJ@elasmtp-spurfowl.atl.sa.earthlink.net>
Message-ID: <1313012516.3002.8.camel@gecko>

Sorry for jumping in where i may not belong....

On Wed, 2011-08-10 at 16:09 -0400, David Smith wrote:
> Sam,
> I understood the answer, but we're talking novice here - if the front 
> end of my grammar looks like this:
> 
> prog:   body EOF!
>          ;
> 
> body    :
>          parts -> ^(BODY parts)
>          ;
> 
> parts   :
>          ( (stat
>             | ifStat
>             | switchStat
>             | whileStat
>             | forStat)   )*
>          ;
> 
> stat:
>          (ID OPENP actualParameters CLOSEP DOT ID GETS)
>           => str=ID OPENP actualParameters CLOSEP  DOT fld=ID GETS expr
>           -> ^(GETS ?????? ^(STRUCTA $str $fld actualParameters) expr)
>      |   (ID OPENP actualParameters CLOSEP DOT OPENP)
>           => str=ID OPENP actualParameters CLOSEP DOT OPENP var=ID 
> CLOSEP GETS expr
>           -> ^(GETS ???????? ^(STRUCTAV $str $var actualParameters) expr)
> // etc
>      ;
> how would I insert the line number at the ???????

so rather than calling $stat.tree.getLine() in your tree walker's action
code when you need the location of the stat rule; you want to include
the line number as an explicit node in the tree?

if the later (e.g. want an explicit node) then i think you can just
construct an imaginary token to hold the line number as its text.

something like (untested):

foo : (...)=> x=ID '(' ... ')' '.'  y=ID z='=' expr
    -> ^($z LINE[$x, Integer.toString($x.getLine())] ^(...) expr)
  ;

> 
> DMS
> Message: 13
> Date: Wed, 10 Aug 2011 10:02:22 -0400
> From: David Smith <david.smith at cc.gatech.edu>
> Subject: [antlr-interest] Access to line numbers
> To: antlr-interest at antlr.org
> Message-ID: <E1Qr9MO-00037I-B1 at elasmtp-curtail.atl.sa.earthlink.net>
> Content-Type: text/plain; charset="us-ascii"; format=flowed
> 
> It seems that the parse tree generated by the parser has a data field
> 'line' that seems to correspond to the source line when parsing.  How
> do i access that to include the line number in the tree generated by
> my grammar?
> 
> DMS
> 
> David M. Smith http://www.cc.gatech.edu/fac/David.Smith
> Georgia Institute of Technology, College of Computing
> Sent from my ASR-33 Teletype
> 
> 
> 
> ------------------------------
> 
> Message: 14
> Date: Wed, 10 Aug 2011 09:36:28 -0500
> From: "Sam Harwell" <sharwell at pixelminegames.com>
> Subject: Re: [antlr-interest] Access to line numbers
> To: "'David Smith'" <david.smith at cc.gatech.edu>,
>          <antlr-interest at antlr.org>
> Message-ID: <06e601cc576a$e4a48980$aded9c80$@pixelminegames.com>
> Content-Type: text/plain;       charset="us-ascii"
> 
> Both the Tree and Token interfaces have a method getLine().
> 
> Sam
> 
>  >From: antlr-interest-bounces at antlr.org
>  >[mailto:antlr-interest-bounces at antlr.org] On Behalf Of David Smith
>  >Sent: Wednesday, August 10, 2011 9:02 AM
>   ...snip...
>  >List: http://www.antlr.org/mailman/listinfo/antlr-interest
>  >Unsubscribe:
>  >http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 
> 
> David M. Smith http://www.cc.gatech.edu/fac/David.Smith
> Georgia Institute of Technology, College of Computing
> Sent from my ASR-33 Teletype 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address




From leodido99 at gmail.com  Thu Aug 11 00:40:41 2011
From: leodido99 at gmail.com (leodido)
Date: Thu, 11 Aug 2011 00:40:41 -0700 (PDT)
Subject: [antlr-interest] Using ANTLR in Visual C# 2010 Express?
Message-ID: <1313048441977-6675388.post@n2.nabble.com>

Hi all,

I'm wondering if it is possible to use ANTLR with the free version Visual C#
2010 Express?
I'm really confused about now because I found two different "guides":

http://www.antlr.org/wiki/pages/viewpage.action?pageId=557075# and
http://www.tunnelvisionlabs.com/downloads/antlr/ANTLRCSharpDocumentation-9004.xps

I tried following both and none of them works. 

I have an issue while following the ANTLRCSharpDocumentation-9004.xps guide
because apparently you can't install all types of extension in the version
of Visual Studio I'm using. It says This extension is not installable on any
currently installed products. Also I can't seem to find the line in my .sln
file that needs to be modified.

I haven't even done anything in my code and it won't compile giving me
errors. (ie. The type or namespace name 'GrammarRuleAttribute' could not be
found (are you missing a using directive or an assembly reference?) OR The
type or namespace name 'String' could not be found (are you missing a using
directive or an assembly reference?))

I generated my cs files using antlrworks-1.4.3.jar and target CSharp2 and
CSharp3 (Which target should I use?) and using the C Grammar file available
on the ANTLR page (just added the line language = 'CSharp2'; and
output=AST;)

Could a generous soul come to my rescue? I'd also be willing to write a
small document to clearly describe how to use ANTLR with C# if I ever
succeed into doing so :p

Thanks in advance.



--
View this message in context: http://antlr.1301665.n2.nabble.com/Using-ANTLR-in-Visual-C-2010-Express-tp6675388p6675388.html
Sent from the ANTLR mailing list archive at Nabble.com.

From sharwell at pixelminegames.com  Thu Aug 11 07:00:37 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 11 Aug 2011 09:00:37 -0500
Subject: [antlr-interest] Using ANTLR in Visual C# 2010 Express?
In-Reply-To: <1313048441977-6675388.post@n2.nabble.com>
References: <1313048441977-6675388.post@n2.nabble.com>
Message-ID: <074401cc582f$0c96fa30$25c4ee90$@pixelminegames.com>

The Visual Studio Express Editions do not support any extensions other than
simple code templates.

You *should* be able to use the ANTLR extension with the free Visual Studio
2010 Shell (Integrated Mode), but I haven't tried this. Here are links to
the installer and the SP1 update.

Visual Studio 2010 Shell (Integrated Mode):
http://www.microsoft.com/download/en/details.aspx?id=115

Visual Studio 2010 SP1 Update:
http://www.microsoft.com/download/en/details.aspx?id=23691

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of leodido
Sent: Thursday, August 11, 2011 2:41 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Using ANTLR in Visual C# 2010 Express?

Hi all,

I'm wondering if it is possible to use ANTLR with the free version Visual C#
2010 Express?
I'm really confused about now because I found two different "guides":

http://www.antlr.org/wiki/pages/viewpage.action?pageId=557075# and
http://www.tunnelvisionlabs.com/downloads/antlr/ANTLRCSharpDocumentation-900
4.xps

I tried following both and none of them works. 

I have an issue while following the ANTLRCSharpDocumentation-9004.xps guide
because apparently you can't install all types of extension in the version
of Visual Studio I'm using. It says This extension is not installable on any
currently installed products. Also I can't seem to find the line in my .sln
file that needs to be modified.

I haven't even done anything in my code and it won't compile giving me
errors. (ie. The type or namespace name 'GrammarRuleAttribute' could not be
found (are you missing a using directive or an assembly reference?) OR The
type or namespace name 'String' could not be found (are you missing a using
directive or an assembly reference?))

I generated my cs files using antlrworks-1.4.3.jar and target CSharp2 and
CSharp3 (Which target should I use?) and using the C Grammar file available
on the ANTLR page (just added the line language = 'CSharp2'; and
output=AST;)

Could a generous soul come to my rescue? I'd also be willing to write a
small document to clearly describe how to use ANTLR with C# if I ever
succeed into doing so :p

Thanks in advance.



--
View this message in context:
http://antlr.1301665.n2.nabble.com/Using-ANTLR-in-Visual-C-2010-Express-tp66
75388p6675388.html
Sent from the ANTLR mailing list archive at Nabble.com.

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From member at linkedin.com  Thu Aug 11 07:42:57 2011
From: member at linkedin.com (Gunjan Gupta via LinkedIn)
Date: Thu, 11 Aug 2011 14:42:57 +0000 (UTC)
Subject: [antlr-interest] Invitation to connect on LinkedIn
Message-ID: <1226166148.2334883.1313073777040.JavaMail.app@ela4-bed78.prod>

LinkedIn
------------




    Gunjan Gupta requested to add you as a connection on LinkedIn:
  
------------------------------------------

Ian,

I'd like to add you to my professional network on LinkedIn.

- Gunjan

Accept invitation from Gunjan Gupta
http://www.linkedin.com/e/6i82p9-gr7u82lz-6k/XJ_Jh42eHeYQ_eJ2S5_J_0Ueq9jQFT3yBwA6v-/blk/I3026836759_2/1BpC5vrmRLoRZcjkkZt5YCpnlOt3RApnhMpmdzgmhxrSNBszYOnPARdPoPe3oOc3d9bSlHp55hmDdAbPgPcjkNe30Pe3cLrCBxbOYWrSlI/EML_comm_afe/

View invitation from Gunjan Gupta
http://www.linkedin.com/e/6i82p9-gr7u82lz-6k/XJ_Jh42eHeYQ_eJ2S5_J_0Ueq9jQFT3yBwA6v-/blk/I3026836759_2/39vejkTdzcUdz8McQALqnpPbOYWrSlI/svi/

------------------------------------------

Why might connecting with Gunjan Gupta be a good idea?

Gunjan Gupta's connections could be useful to you:
After accepting Gunjan Gupta's invitation, check Gunjan Gupta's connections to see who else you may know and who you might want an introduction to. Building these connections can create opportunities in the future.
 
-- 
(c) 2011, LinkedIn Corporation

From shiranthad at gmail.com  Thu Aug 11 08:14:15 2011
From: shiranthad at gmail.com (shirantha fernando)
Date: Thu, 11 Aug 2011 20:44:15 +0530
Subject: [antlr-interest] Extract Code Related Metrics
Message-ID: <CAMMWqQz2CwOosi+JpTKW=AXgOmZ4aWpEwmuhYmGR6MbR8aYioQ@mail.gmail.com>

*Hi,*

I am totally new to Antlr C# grammar. I am trying to use the grammar to
extract C# code related metrics like *Halstead *and *Object Oriented
(according to C&K Model). *

I stuck on extracting details as following.


I need to extract *operators *and *operands *from the source code. If you
could please explain bellow scenarios I could be able to overcome the same
(Need to know in which place that I need to catch the detail from the
grammar).

Ex:-

   - * Int x = 1; *

*Answer*

Operators { = }

Operands { int , x, 1 }

 *
*

   - *For( int k = 0; k < 10; k++) { }*

*Answer*

Operators { for(), = , =, ++ }

Operands { int, k, 0, k, 10, k }


*I need to get only the count of these Operators and Operands by
incrementing a variable*. Please be kind enough to help me. Thanks.




*Thanks and Regards,*

*Shirantha Fernando*

*( IT student)*

From kingces95 at gmail.com  Thu Aug 11 12:59:28 2011
From: kingces95 at gmail.com (chris king)
Date: Thu, 11 Aug 2011 12:59:28 -0700
Subject: [antlr-interest] ANTLR build process performance improvement
In-Reply-To: <075401cc5844$10485ce0$30d916a0$@pixelminegames.com>
References: <075401cc5844$10485ce0$30d916a0$@pixelminegames.com>
Message-ID: <CAJQwtshVNkiHupTUYqh31jLUpBbf51hM_UxOQ7xD2tm37wCD+g@mail.gmail.com>

Hey Sam, thanks! I'm using it now and it's faster. Love the VS tool-chain!
I'd be dead in the water without it. And haven't bumped into any bugs with
the new version. So cool!

I've bummed into a slightly different problem and no matter how I arrange my
grammar (included) I can't seem to work around it. I think it might be a bug
in the SpecialStateTransition logic...

Below is what I'm trying to parse along with the trace using your enter-exit
partial methods (wonderful addition BTW) for my C# preprocessor interleaved
with when the tokens get pulled from the stream. Also interleaved are my
calls to toggle SkipSection which is trying to keep track of when code is
#ifdefed out. So what we see is that [#if] is pulled and then [false] and
[\r\n]. At that point in the parse I'm at the end of the pre-processor line
and so I look up the pp_conditional stack to see if I'm in a #ifdefed out
section of code. In this case I am so I set SkipSection to True. That
enables (via semantic predicate) my lexer rule
PP_SKIPPED_CHARACTERS=45 which should suck up any code that is not a pragma
statement (doesn't start with #). That's all well and good and so the next
thing that get tokenized is [#pragma warning disable] which is good.

Now at this point I expect that no tokens should get pulled until I reach
the pp_pragma production. I expect this because I figure ANLTER should be
able to predict where it needs to go without pulling any more tokens --
after all the only thing that can follow a [#pragma warning disable] token
is a list of integers. The actual behavior is that in my
pp_condition_section production ANTLR pulls [10] as a
PP_SKIPPED_CHARACTERS instead of an INTEGER because SkipSection is set to
True. If things had gone as expected and [10] had been pulled in the
pp_pragma production. If that had happened then SkipSection would have been
set to False and [10] would be pulled as an INTEGER.

The code that's actually pulling the [10] is DFA.Predict in the
SpecialStateTransition loop when trying to predict where to go for the
pp_conditional_section production:

pp_conditional_section
: { !SkipSection }? => input_section
| { SkipSection }? => pp_skipped_section
;

I'm guessing that this production is "special" because it's got those gated
semantic predicates and that's why DFA.Predict enters into the
SpecialStateTransition logic. What I don't understand is why it would need
to pull any more tokens to know where to go next. Do you think that's a bug
that it's pulling tokens in this case?

After writing this e-mail it occurred to me that I might manually try to do
the prediction. I did this by putting a break point in the
pp_conditional_section rule at the dfa.Predict line. But instead of asking
the DFA to do the prediction I just set-ip to the case I wanted (e.g. {...}?
=> pp_skipped_section). Then hit F5. And it works! I included the trace of
that run below. Given that I really do think that the SpecialStateTransition
logic (or there abouts) is being to aggressive about pulling tokens... what
do you think?

Thanks,
Chris

CSharpAst.Parse("#if false\r\n#pragma warning disable
10\r\n/*foo*/\r\n#endif");

Enter start 1
[@-1,0:2='#if',<38>,1:0]
 Enter input_section 2
  Enter input_section_part 3
   Enter pp_directive 6
    Enter pp_conditional 8
     Enter pp_if_section 9
[@-1,4:8='false',<4>,1:4]
      Enter pp_expression 17
       Enter pp_or_expression 18
        Enter pp_and_expression 19
         Enter pp_equality_expression 20
          Enter pp_unary_expression 21
           Enter pp_primary_expression 22
[@-1,9:10='\\r\\n',<29>,1:9]
           Leave pp_primary_expression 22
          Leave pp_unary_expression 21
         Leave pp_equality_expression 20
        Leave pp_and_expression 19
       Leave pp_or_expression 18
      Leave pp_expression 17
      Enter pp_conditional_block 12
       Enter pp_new_line 31
SkipSection = True
[@-1,11:33='#pragma warning disable',<42>,2:0]
       Leave pp_new_line 31
       Enter pp_conditional_section 13
[@-1,34:36=' 10',<45>,2:23]
[@-1,37:38='\\r\\n',<29>,2:26]
        Enter pp_skipped_section 14
         Enter pp_skipped_section_part 15
          Enter pp_directive 6
           Enter pp_leaf_directive 7
            Enter pp_pragma 29
SkipSection = False
             Enter pp_warning_list 30

 Here is the trace when I make the prediction by hand:

Enter start 1
[@-1,0:2='#if',<38>,1:0]
 Enter input_section 2
  Enter input_section_part 3
   Enter pp_directive 6
    Enter pp_conditional 8
     Enter pp_if_section 9
[@-1,4:8='false',<4>,1:4]
      Enter pp_expression 17
       Enter pp_or_expression 18
        Enter pp_and_expression 19
         Enter pp_equality_expression 20
          Enter pp_unary_expression 21
           Enter pp_primary_expression 22
[@-1,9:10='\\r\\n',<29>,1:9]
           Leave pp_primary_expression 22
          Leave pp_unary_expression 21
         Leave pp_equality_expression 20
        Leave pp_and_expression 19
       Leave pp_or_expression 18
      Leave pp_expression 17
      Enter pp_conditional_block 12
       Enter pp_new_line 31
SkipSection = True
[@-1,11:33='#pragma warning disable',<42>,2:0]
       Leave pp_new_line 31
       Enter pp_conditional_section 13
        Enter pp_skipped_section 14
         Enter pp_skipped_section_part 15
          Enter pp_directive 6
           Enter pp_leaf_directive 7
            Enter pp_pragma 29
SkipSection = False
[@-1,35:36='10',<28>,2:24]
             Enter pp_warning_list 30
[@-1,37:38='\\r\\n',<29>,2:26]
             Leave pp_warning_list 30
             Enter pp_new_line 31
SkipSection = True
[@-1,39:45='/*foo*/',<45>,3:0]
             Leave pp_new_line 31
            Leave pp_pragma 29
           Leave pp_leaf_directive 7
          Leave pp_directive 6
         Leave pp_skipped_section_part 15
         Enter pp_skipped_section_part 15
[@-1,46:47='\\r\\n',<29>,3:7]
[@-1,48:53='#endif',<35>,4:0]
         Leave pp_skipped_section_part 15
        Leave pp_skipped_section 14
       Leave pp_conditional_section 13
      Leave pp_conditional_block 12
     Leave pp_if_section 9
     Enter pp_endif 16
      Enter pp_new_line 31
SkipSection = True
      Leave pp_new_line 31
     Leave pp_endif 16
    Leave pp_conditional 8
   Leave pp_directive 6
  Leave input_section_part 3
 Leave input_section 2
Leave start 1


On Thu, Aug 11, 2011 at 9:31 AM, Sam Harwell <sharwell at pixelminegames.com>wrote:


> Hi ?brave testers? :)****
>
> ** **
>
> I updated the MSBuild integration for the CSharp3 target to significantly
> improve its performance in several areas. I haven?t tested the update to see
> if it fixes the issues with ReSharper?s IntelliSense engine, but it sure
> would be sweet if it did!****
>
> ** **
>
> **1.       **Time to compile grammars should be reduced by 1-2 seconds per
> project containing grammars.****
>
> **2.       **The ?lag? in the IDE when you change windows away from a
> modified grammar file and when you save a grammar file should be reduced by
> 1-2 seconds each time.****
>
> **3.       **When you open a project IntelliSense will be ready
> immediately as opposed to waiting until you save a grammar or build the
> project.****
>
> **4.       **When you add or remove a file from the project, IntelliSense
> won?t break.****
>
> ** **
>
> If you?d like to test out the new tool, it?s available in the following 7z
> file. Simply close Visual Studio and replace your existing Antlr3.targets
> and AntlrBuildTask.dll with the ones from this archive and you?re ready to
> go.****
>
> ** **
>
>
> http://www.tunnelvisionlabs.com/downloads/antlr/AntlrBuildTask-experimental-9029.7z
> ****
>
> ** **
>
> Thanks,****
>
> Sam****
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CSharp.g
Type: application/octet-stream
Size: 8500 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20110811/a6956cdb/attachment.obj 

From sharwell at pixelminegames.com  Thu Aug 11 14:03:15 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 11 Aug 2011 16:03:15 -0500
Subject: [antlr-interest] ANTLR build process performance improvement
In-Reply-To: <CAJQwtshVNkiHupTUYqh31jLUpBbf51hM_UxOQ7xD2tm37wCD+g@mail.gmail.com>
References: <075401cc5844$10485ce0$30d916a0$@pixelminegames.com>
	<CAJQwtshVNkiHupTUYqh31jLUpBbf51hM_UxOQ7xD2tm37wCD+g@mail.gmail.com>
Message-ID: <078201cc586a$175536e0$45ffa4a0$@pixelminegames.com>

ANTLR is designed so with the lexer and parser as independent units. Your
lexer should be able to run to completion (the entire document) before the
parser is even created.

 

There are ways around it, but I intentionally avoid getting into situations
where I have to think about what they might be.

 

Sam

 

From: chris king [mailto:kingces95 at gmail.com] 
Sent: Thursday, August 11, 2011 2:59 PM
To: Sam Harwell; antlr-interest at antlr.org
Subject: Re: ANTLR build process performance improvement

 

Hey Sam, thanks! I'm using it now and it's faster. Love the VS tool-chain!
I'd be dead in the water without it. And haven't bumped into any bugs with
the new version. So cool! 

 

I've bummed into a slightly different problem and no matter how I arrange my
grammar (included) I can't seem to work around it. I think it might be a bug
in the SpecialStateTransition logic...

 

Below is what I'm trying to parse along with the trace using your enter-exit
partial methods (wonderful addition BTW) for my C# preprocessor interleaved
with when the tokens get pulled from the stream. Also interleaved are my
calls to toggle SkipSection which is trying to keep track of when code is
#ifdefed out. So what we see is that [#if] is pulled and then [false] and
[\r\n]. At that point in the parse I'm at the end of the pre-processor line
and so I look up the pp_conditional stack to see if I'm in a #ifdefed out
section of code. In this case I am so I set SkipSection to True. That
enables (via semantic predicate) my lexer rule PP_SKIPPED_CHARACTERS=45
which should suck up any code that is not a pragma statement (doesn't start
with #). That's all well and good and so the next thing that get tokenized
is [#pragma warning disable] which is good. 

 

Now at this point I expect that no tokens should get pulled until I reach
the pp_pragma production. I expect this because I figure ANLTER should be
able to predict where it needs to go without pulling any more tokens --
after all the only thing that can follow a [#pragma warning disable] token
is a list of integers. The actual behavior is that in my
pp_condition_section production ANTLR pulls [10] as a PP_SKIPPED_CHARACTERS
instead of an INTEGER because SkipSection is set to True. If things had gone
as expected and [10] had been pulled in the pp_pragma production. If that
had happened then SkipSection would have been set to False and [10] would be
pulled as an INTEGER. 

 

The code that's actually pulling the [10] is DFA.Predict in the
SpecialStateTransition loop when trying to predict where to go for the
pp_conditional_section production:

pp_conditional_section

: { !SkipSection }? => input_section

| { SkipSection }? => pp_skipped_section

;

I'm guessing that this production is "special" because it's got those gated
semantic predicates and that's why DFA.Predict enters into the
SpecialStateTransition logic. What I don't understand is why it would need
to pull any more tokens to know where to go next. Do you think that's a bug
that it's pulling tokens in this case?

 

After writing this e-mail it occurred to me that I might manually try to do
the prediction. I did this by putting a break point in the
pp_conditional_section rule at the dfa.Predict line. But instead of asking
the DFA to do the prediction I just set-ip to the case I wanted (e.g. {...}?
=> pp_skipped_section). Then hit F5. And it works! I included the trace of
that run below. Given that I really do think that the SpecialStateTransition
logic (or there abouts) is being to aggressive about pulling tokens... what
do you think? 

 

Thanks,

Chris

 

CSharpAst.Parse("#if false\r\n#pragma warning disable
10\r\n/*foo*/\r\n#endif");

 

Enter start 1

[@-1,0:2='#if',<38>,1:0]

 Enter input_section 2

  Enter input_section_part 3

   Enter pp_directive 6

    Enter pp_conditional 8

     Enter pp_if_section 9

[@-1,4:8='false',<4>,1:4]

      Enter pp_expression 17

       Enter pp_or_expression 18

        Enter pp_and_expression 19

         Enter pp_equality_expression 20

          Enter pp_unary_expression 21

           Enter pp_primary_expression 22

[@-1,9:10='\\r\\n',<29>,1:9]

           Leave pp_primary_expression 22

          Leave pp_unary_expression 21

         Leave pp_equality_expression 20

        Leave pp_and_expression 19

       Leave pp_or_expression 18

      Leave pp_expression 17

      Enter pp_conditional_block 12

       Enter pp_new_line 31

SkipSection = True

[@-1,11:33='#pragma warning disable',<42>,2:0]

       Leave pp_new_line 31

       Enter pp_conditional_section 13

[@-1,34:36=' 10',<45>,2:23]

[@-1,37:38='\\r\\n',<29>,2:26]

        Enter pp_skipped_section 14

         Enter pp_skipped_section_part 15

          Enter pp_directive 6

           Enter pp_leaf_directive 7

            Enter pp_pragma 29

SkipSection = False

             Enter pp_warning_list 30

 

 Here is the trace when I make the prediction by hand:

 

Enter start 1
[@-1,0:2='#if',<38>,1:0]
 Enter input_section 2
  Enter input_section_part 3
   Enter pp_directive 6
    Enter pp_conditional 8
     Enter pp_if_section 9
[@-1,4:8='false',<4>,1:4]
      Enter pp_expression 17
       Enter pp_or_expression 18
        Enter pp_and_expression 19
         Enter pp_equality_expression 20
          Enter pp_unary_expression 21
           Enter pp_primary_expression 22
[@-1,9:10='\\r\\n',<29>,1:9]
           Leave pp_primary_expression 22
          Leave pp_unary_expression 21
         Leave pp_equality_expression 20
        Leave pp_and_expression 19
       Leave pp_or_expression 18
      Leave pp_expression 17
      Enter pp_conditional_block 12
       Enter pp_new_line 31
SkipSection = True
[@-1,11:33='#pragma warning disable',<42>,2:0]
       Leave pp_new_line 31
       Enter pp_conditional_section 13
        Enter pp_skipped_section 14
         Enter pp_skipped_section_part 15
          Enter pp_directive 6
           Enter pp_leaf_directive 7
            Enter pp_pragma 29
SkipSection = False
[@-1,35:36='10',<28>,2:24]
             Enter pp_warning_list 30
[@-1,37:38='\\r\\n',<29>,2:26]
             Leave pp_warning_list 30
             Enter pp_new_line 31
SkipSection = True
[@-1,39:45='/*foo*/',<45>,3:0]
             Leave pp_new_line 31
            Leave pp_pragma 29
           Leave pp_leaf_directive 7
          Leave pp_directive 6
         Leave pp_skipped_section_part 15
         Enter pp_skipped_section_part 15
[@-1,46:47='\\r\\n',<29>,3:7]
[@-1,48:53='#endif',<35>,4:0]
         Leave pp_skipped_section_part 15
        Leave pp_skipped_section 14
       Leave pp_conditional_section 13
      Leave pp_conditional_block 12
     Leave pp_if_section 9
     Enter pp_endif 16
      Enter pp_new_line 31
SkipSection = True
      Leave pp_new_line 31
     Leave pp_endif 16
    Leave pp_conditional 8
   Leave pp_directive 6
  Leave input_section_part 3
 Leave input_section 2
Leave start 1

 

 

On Thu, Aug 11, 2011 at 9:31 AM, Sam Harwell <sharwell at pixelminegames.com>
wrote:

 

Hi "brave testers" :)

 

I updated the MSBuild integration for the CSharp3 target to significantly
improve its performance in several areas. I haven't tested the update to see
if it fixes the issues with ReSharper's IntelliSense engine, but it sure
would be sweet if it did!

 

1.       Time to compile grammars should be reduced by 1-2 seconds per
project containing grammars.

2.       The "lag" in the IDE when you change windows away from a modified
grammar file and when you save a grammar file should be reduced by 1-2
seconds each time.

3.       When you open a project IntelliSense will be ready immediately as
opposed to waiting until you save a grammar or build the project.

4.       When you add or remove a file from the project, IntelliSense won't
break.

 

If you'd like to test out the new tool, it's available in the following 7z
file. Simply close Visual Studio and replace your existing Antlr3.targets
and AntlrBuildTask.dll with the ones from this archive and you're ready to
go.

 

http://www.tunnelvisionlabs.com/downloads/antlr/AntlrBuildTask-experimental-
9029.7z

 

Thanks,

Sam

 


From kingces95 at gmail.com  Thu Aug 11 14:12:07 2011
From: kingces95 at gmail.com (chris king)
Date: Thu, 11 Aug 2011 14:12:07 -0700
Subject: [antlr-interest] ANTLR build process performance improvement
In-Reply-To: <078201cc586a$175536e0$45ffa4a0$@pixelminegames.com>
References: <075401cc5844$10485ce0$30d916a0$@pixelminegames.com>
	<CAJQwtshVNkiHupTUYqh31jLUpBbf51hM_UxOQ7xD2tm37wCD+g@mail.gmail.com>
	<078201cc586a$175536e0$45ffa4a0$@pixelminegames.com>
Message-ID: <CAJQwtsjni6FBq3RZAcodWyO=i5L6ei1gTT_XJXtUXSxHtxLdug@mail.gmail.com>

Really? Because I found a comment on BufferedTokenStream that seems to imply
that the Lexer is lazy so that the parser can pass state to it (presumably
to flip gated semantic predicates) and that some ST template feature already
depends on this behavior... Am I reading this wrong?

    /** Buffer all input tokens but do on-demand fetching of new tokens from
     *  lexer. Useful when the parser or lexer has to set context/mode info
before
     *  proper lexing of future tokens. The ST template parser needs this,
     *  for example, because it has to constantly flip back and forth
between
     *  inside/output templates. E.g., <names:{hi, <it>}> has to parse names
     *  as part of an expression but "hi, <it>" as a nested template.

Thanks,
Chris

On Thu, Aug 11, 2011 at 2:03 PM, Sam Harwell <sharwell at pixelminegames.com>wrote:

> ANTLR is designed so with the lexer and parser as independent units. Your
> lexer should be able to run to completion (the entire document) before the
> parser is even created.****
>
> ** **
>
> There are ways around it, but I intentionally avoid getting into situations
> where I have to think about what they might be.****
>
> ** **
>
> Sam****
>
> ** **
>
> *From:* chris king [mailto:kingces95 at gmail.com]
> *Sent:* Thursday, August 11, 2011 2:59 PM
> *To:* Sam Harwell; antlr-interest at antlr.org
> *Subject:* Re: ANTLR build process performance improvement****
>
> ** **
>
> Hey Sam, thanks! I'm using it now and it's faster. Love the VS tool-chain!
> I'd be dead in the water without it. And haven't bumped into any bugs with
> the new version. So cool! ****
>
>  ****
>
> I've bummed into a slightly different problem and no matter how I arrange
> my grammar (included) I can't seem to work around it. I think it might be a
> bug in the SpecialStateTransition logic...****
>
>  ****
>
> Below is what I'm trying to parse along with the trace using your
> enter-exit partial methods (wonderful addition BTW) for my C# preprocessor
> interleaved with when the tokens get pulled from the stream. Also
> interleaved are my calls to toggle SkipSection which is trying to keep track
> of when code is #ifdefed out. So what we see is that [#if] is pulled and
> then [false] and [\r\n]. At that point in the parse I'm at the end of the
> pre-processor line and so I look up the pp_conditional stack to see if
> I'm in a #ifdefed out section of code. In this case I am so I set
> SkipSection to True. That enables (via semantic predicate) my lexer rule
> PP_SKIPPED_CHARACTERS=45 which should suck up any code that is not a pragma
> statement (doesn't start with #). That's all well and good and so the next
> thing that get tokenized is [#pragma warning disable] which is good. ****
>
>  ****
>
> Now at this point I expect that no tokens should get pulled until I reach
> the pp_pragma production. I expect this because I figure ANLTER should be
> able to predict where it needs to go without pulling any more tokens --
> after all the only thing that can follow a [#pragma warning disable] token
> is a list of integers. The actual behavior is that in my
> pp_condition_section production ANTLR pulls [10] as a
> PP_SKIPPED_CHARACTERS instead of an INTEGER because SkipSection is set to
> True. If things had gone as expected and [10] had been pulled in the
> pp_pragma production. If that had happened then SkipSection would have been
> set to False and [10] would be pulled as an INTEGER. ****
>
>  ****
>
> The code that's actually pulling the [10] is DFA.Predict in the
> SpecialStateTransition loop when trying to predict where to go for the
> pp_conditional_section production:****
>
> pp_conditional_section****
>
> : { !SkipSection }? => input_section****
>
> | { SkipSection }? => pp_skipped_section****
>
> ;****
>
> I'm guessing that this production is "special" because it's got those gated
> semantic predicates and that's why DFA.Predict enters into the
> SpecialStateTransition logic. What I don't understand is why it would need
> to pull any more tokens to know where to go next. Do you think that's a bug
> that it's pulling tokens in this case?****
>
>  ****
>
> After writing this e-mail it occurred to me that I might manually try to do
> the prediction. I did this by putting a break point in the
> pp_conditional_section rule at the dfa.Predict line. But instead of asking
> the DFA to do the prediction I just set-ip to the case I wanted (e.g. {...}?
> => pp_skipped_section). Then hit F5. And it works! I included the trace of
> that run below. Given that I really do think that the SpecialStateTransition
> logic (or there abouts) is being to aggressive about pulling tokens... what
> do you think? ****
>
>  ****
>
> Thanks,****
>
> Chris****
>
>  ****
>
> CSharpAst.Parse("#if false\r\n#pragma warning disable
> 10\r\n/*foo*/\r\n#endif");****
>
>  ****
>
> Enter start 1****
>
> [@-1,0:2='#if',<38>,1:0]****
>
>  Enter input_section 2****
>
>   Enter input_section_part 3****
>
>    Enter pp_directive 6****
>
>     Enter pp_conditional 8****
>
>      Enter pp_if_section 9****
>
> [@-1,4:8='false',<4>,1:4]****
>
>       Enter pp_expression 17****
>
>        Enter pp_or_expression 18****
>
>         Enter pp_and_expression 19****
>
>          Enter pp_equality_expression 20****
>
>           Enter pp_unary_expression 21****
>
>            Enter pp_primary_expression 22****
>
> [@-1,9:10='\\r\\n',<29>,1:9]****
>
>            Leave pp_primary_expression 22****
>
>           Leave pp_unary_expression 21****
>
>          Leave pp_equality_expression 20****
>
>         Leave pp_and_expression 19****
>
>        Leave pp_or_expression 18****
>
>       Leave pp_expression 17****
>
>       Enter pp_conditional_block 12****
>
>        Enter pp_new_line 31****
>
> SkipSection = True****
>
> [@-1,11:33='#pragma warning disable',<42>,2:0]****
>
>        Leave pp_new_line 31****
>
>        Enter pp_conditional_section 13****
>
> [@-1,34:36=' 10',<45>,2:23]****
>
> [@-1,37:38='\\r\\n',<29>,2:26]****
>
>         Enter pp_skipped_section 14****
>
>          Enter pp_skipped_section_part 15****
>
>           Enter pp_directive 6****
>
>            Enter pp_leaf_directive 7****
>
>             Enter pp_pragma 29****
>
> SkipSection = False****
>
>              Enter pp_warning_list 30****
>
>  ****
>
>  Here is the trace when I make the prediction by hand:****
>
>  ****
>
> Enter start 1
> [@-1,0:2='#if',<38>,1:0]
>  Enter input_section 2
>   Enter input_section_part 3
>    Enter pp_directive 6
>     Enter pp_conditional 8
>      Enter pp_if_section 9
> [@-1,4:8='false',<4>,1:4]
>       Enter pp_expression 17
>        Enter pp_or_expression 18
>         Enter pp_and_expression 19
>          Enter pp_equality_expression 20
>           Enter pp_unary_expression 21
>            Enter pp_primary_expression 22
> [@-1,9:10='\\r\\n',<29>,1:9]
>            Leave pp_primary_expression 22
>           Leave pp_unary_expression 21
>          Leave pp_equality_expression 20
>         Leave pp_and_expression 19
>        Leave pp_or_expression 18
>       Leave pp_expression 17
>       Enter pp_conditional_block 12
>        Enter pp_new_line 31
> SkipSection = True
> [@-1,11:33='#pragma warning disable',<42>,2:0]
>        Leave pp_new_line 31
>        Enter pp_conditional_section 13
>         Enter pp_skipped_section 14
>          Enter pp_skipped_section_part 15
>           Enter pp_directive 6
>            Enter pp_leaf_directive 7
>             Enter pp_pragma 29
> SkipSection = False
> [@-1,35:36='10',<28>,2:24]
>              Enter pp_warning_list 30
> [@-1,37:38='\\r\\n',<29>,2:26]
>              Leave pp_warning_list 30
>              Enter pp_new_line 31
> SkipSection = True
> [@-1,39:45='/*foo*/',<45>,3:0]
>              Leave pp_new_line 31
>             Leave pp_pragma 29
>            Leave pp_leaf_directive 7
>           Leave pp_directive 6
>          Leave pp_skipped_section_part 15
>          Enter pp_skipped_section_part 15
> [@-1,46:47='\\r\\n',<29>,3:7]
> [@-1,48:53='#endif',<35>,4:0]
>          Leave pp_skipped_section_part 15
>         Leave pp_skipped_section 14
>        Leave pp_conditional_section 13
>       Leave pp_conditional_block 12
>      Leave pp_if_section 9
>      Enter pp_endif 16
>       Enter pp_new_line 31
> SkipSection = True
>       Leave pp_new_line 31
>      Leave pp_endif 16
>     Leave pp_conditional 8
>    Leave pp_directive 6
>   Leave input_section_part 3
>  Leave input_section 2
> Leave start 1****
>
>  ****
>
>  ****
>
> On Thu, Aug 11, 2011 at 9:31 AM, Sam Harwell <sharwell at pixelminegames.com>
> wrote:****
>
>  ****
>
> Hi ?brave testers? :)****
>
>  ****
>
> I updated the MSBuild integration for the CSharp3 target to significantly
> improve its performance in several areas. I haven?t tested the update to see
> if it fixes the issues with ReSharper?s IntelliSense engine, but it sure
> would be sweet if it did!****
>
>  ****
>
> 1.       Time to compile grammars should be reduced by 1-2 seconds per
> project containing grammars.****
>
> 2.       The ?lag? in the IDE when you change windows away from a modified
> grammar file and when you save a grammar file should be reduced by 1-2
> seconds each time.****
>
> 3.       When you open a project IntelliSense will be ready immediately as
> opposed to waiting until you save a grammar or build the project.****
>
> 4.       When you add or remove a file from the project, IntelliSense
> won?t break.****
>
>  ****
>
> If you?d like to test out the new tool, it?s available in the following 7z
> file. Simply close Visual Studio and replace your existing Antlr3.targets
> and AntlrBuildTask.dll with the ones from this archive and you?re ready to
> go.****
>
>  ****
>
>
> http://www.tunnelvisionlabs.com/downloads/antlr/AntlrBuildTask-experimental-9029.7z
> ****
>
>  ****
>
> Thanks,****
>
> Sam****
>
>  ****
>

From jimi at temporal-wave.com  Thu Aug 11 14:51:49 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 11 Aug 2011 14:51:49 -0700
Subject: [antlr-interest] ANTLR build process performance improvement
In-Reply-To: <CAJQwtsjni6FBq3RZAcodWyO=i5L6ei1gTT_XJXtUXSxHtxLdug@mail.gmail.com>
References: <075401cc5844$10485ce0$30d916a0$@pixelminegames.com>
	<CAJQwtshVNkiHupTUYqh31jLUpBbf51hM_UxOQ7xD2tm37wCD+g@mail.gmail.com>
	<078201cc586a$175536e0$45ffa4a0$@pixelminegames.com>
	<CAJQwtsjni6FBq3RZAcodWyO=i5L6ei1gTT_XJXtUXSxHtxLdug@mail.gmail.com>
Message-ID: <e6ffc3933420626faf5fe4267d8620da@mail.gmail.com>

There is a non-buffered  stream but lexer/parser communication is fraught
with difficulties unless you have a scannerless parser. However, this does
not matter anyway because a C# pre-processor MUST be ENTIRELY lexer based
as per the language specification (and it tells you why). Read through
that section as it will help you a lot.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of chris king
> Sent: Thursday, August 11, 2011 2:12 PM
> To: Sam Harwell
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] ANTLR build process performance
> improvement
>
> Really? Because I found a comment on BufferedTokenStream that seems to
> imply that the Lexer is lazy so that the parser can pass state to it
> (presumably to flip gated semantic predicates) and that some ST
> template feature already depends on this behavior... Am I reading this
> wrong?
>
>     /** Buffer all input tokens but do on-demand fetching of new tokens
> from
>      *  lexer. Useful when the parser or lexer has to set context/mode
> info before
>      *  proper lexing of future tokens. The ST template parser needs
> this,
>      *  for example, because it has to constantly flip back and forth
> between
>      *  inside/output templates. E.g., <names:{hi, <it>}> has to parse
> names
>      *  as part of an expression but "hi, <it>" as a nested template.
>
> Thanks,
> Chris
>
> On Thu, Aug 11, 2011 at 2:03 PM, Sam Harwell
> <sharwell at pixelminegames.com>wrote:
>
> > ANTLR is designed so with the lexer and parser as independent units.
> > Your lexer should be able to run to completion (the entire document)
> > before the parser is even created.****
> >
> > ** **
> >
> > There are ways around it, but I intentionally avoid getting into
> > situations where I have to think about what they might be.****
> >
> > ** **
> >
> > Sam****
> >
> > ** **
> >
> > *From:* chris king [mailto:kingces95 at gmail.com]
> > *Sent:* Thursday, August 11, 2011 2:59 PM
> > *To:* Sam Harwell; antlr-interest at antlr.org
> > *Subject:* Re: ANTLR build process performance improvement****
> >
> > ** **
> >
> > Hey Sam, thanks! I'm using it now and it's faster. Love the VS tool-
> chain!
> > I'd be dead in the water without it. And haven't bumped into any bugs
> > with the new version. So cool! ****
> >
> >  ****
> >
> > I've bummed into a slightly different problem and no matter how I
> > arrange my grammar (included) I can't seem to work around it. I think
> > it might be a bug in the SpecialStateTransition logic...****
> >
> >  ****
> >
> > Below is what I'm trying to parse along with the trace using your
> > enter-exit partial methods (wonderful addition BTW) for my C#
> > preprocessor interleaved with when the tokens get pulled from the
> > stream. Also interleaved are my calls to toggle SkipSection which is
> > trying to keep track of when code is #ifdefed out. So what we see is
> > that [#if] is pulled and then [false] and [\r\n]. At that point in
> the
> > parse I'm at the end of the pre-processor line and so I look up the
> > pp_conditional stack to see if I'm in a #ifdefed out section of code.
> > In this case I am so I set SkipSection to True. That enables (via
> > semantic predicate) my lexer rule
> > PP_SKIPPED_CHARACTERS=45 which should suck up any code that is not a
> > pragma statement (doesn't start with #). That's all well and good and
> > so the next thing that get tokenized is [#pragma warning disable]
> > which is good. ****
> >
> >  ****
> >
> > Now at this point I expect that no tokens should get pulled until I
> > reach the pp_pragma production. I expect this because I figure ANLTER
> > should be able to predict where it needs to go without pulling any
> > more tokens -- after all the only thing that can follow a [#pragma
> > warning disable] token is a list of integers. The actual behavior is
> > that in my pp_condition_section production ANTLR pulls [10] as a
> > PP_SKIPPED_CHARACTERS instead of an INTEGER because SkipSection is
> set
> > to True. If things had gone as expected and [10] had been pulled in
> > the pp_pragma production. If that had happened then SkipSection would
> > have been set to False and [10] would be pulled as an INTEGER. ****
> >
> >  ****
> >
> > The code that's actually pulling the [10] is DFA.Predict in the
> > SpecialStateTransition loop when trying to predict where to go for
> the
> > pp_conditional_section production:****
> >
> > pp_conditional_section****
> >
> > : { !SkipSection }? => input_section****
> >
> > | { SkipSection }? => pp_skipped_section****
> >
> > ;****
> >
> > I'm guessing that this production is "special" because it's got those
> > gated semantic predicates and that's why DFA.Predict enters into the
> > SpecialStateTransition logic. What I don't understand is why it would
> > need to pull any more tokens to know where to go next. Do you think
> > that's a bug that it's pulling tokens in this case?****
> >
> >  ****
> >
> > After writing this e-mail it occurred to me that I might manually try
> > to do the prediction. I did this by putting a break point in the
> > pp_conditional_section rule at the dfa.Predict line. But instead of
> > asking the DFA to do the prediction I just set-ip to the case I
> wanted (e.g. {...}?
> > => pp_skipped_section). Then hit F5. And it works! I included the
> > trace of that run below. Given that I really do think that the
> > SpecialStateTransition logic (or there abouts) is being to aggressive
> > about pulling tokens... what do you think? ****
> >
> >  ****
> >
> > Thanks,****
> >
> > Chris****
> >
> >  ****
> >
> > CSharpAst.Parse("#if false\r\n#pragma warning disable
> > 10\r\n/*foo*/\r\n#endif");****
> >
> >  ****
> >
> > Enter start 1****
> >
> > [@-1,0:2='#if',<38>,1:0]****
> >
> >  Enter input_section 2****
> >
> >   Enter input_section_part 3****
> >
> >    Enter pp_directive 6****
> >
> >     Enter pp_conditional 8****
> >
> >      Enter pp_if_section 9****
> >
> > [@-1,4:8='false',<4>,1:4]****
> >
> >       Enter pp_expression 17****
> >
> >        Enter pp_or_expression 18****
> >
> >         Enter pp_and_expression 19****
> >
> >          Enter pp_equality_expression 20****
> >
> >           Enter pp_unary_expression 21****
> >
> >            Enter pp_primary_expression 22****
> >
> > [@-1,9:10='\\r\\n',<29>,1:9]****
> >
> >            Leave pp_primary_expression 22****
> >
> >           Leave pp_unary_expression 21****
> >
> >          Leave pp_equality_expression 20****
> >
> >         Leave pp_and_expression 19****
> >
> >        Leave pp_or_expression 18****
> >
> >       Leave pp_expression 17****
> >
> >       Enter pp_conditional_block 12****
> >
> >        Enter pp_new_line 31****
> >
> > SkipSection = True****
> >
> > [@-1,11:33='#pragma warning disable',<42>,2:0]****
> >
> >        Leave pp_new_line 31****
> >
> >        Enter pp_conditional_section 13****
> >
> > [@-1,34:36=' 10',<45>,2:23]****
> >
> > [@-1,37:38='\\r\\n',<29>,2:26]****
> >
> >         Enter pp_skipped_section 14****
> >
> >          Enter pp_skipped_section_part 15****
> >
> >           Enter pp_directive 6****
> >
> >            Enter pp_leaf_directive 7****
> >
> >             Enter pp_pragma 29****
> >
> > SkipSection = False****
> >
> >              Enter pp_warning_list 30****
> >
> >  ****
> >
> >  Here is the trace when I make the prediction by hand:****
> >
> >  ****
> >
> > Enter start 1
> > [@-1,0:2='#if',<38>,1:0]
> >  Enter input_section 2
> >   Enter input_section_part 3
> >    Enter pp_directive 6
> >     Enter pp_conditional 8
> >      Enter pp_if_section 9
> > [@-1,4:8='false',<4>,1:4]
> >       Enter pp_expression 17
> >        Enter pp_or_expression 18
> >         Enter pp_and_expression 19
> >          Enter pp_equality_expression 20
> >           Enter pp_unary_expression 21
> >            Enter pp_primary_expression 22 [@-
> 1,9:10='\\r\\n',<29>,1:9]
> >            Leave pp_primary_expression 22
> >           Leave pp_unary_expression 21
> >          Leave pp_equality_expression 20
> >         Leave pp_and_expression 19
> >        Leave pp_or_expression 18
> >       Leave pp_expression 17
> >       Enter pp_conditional_block 12
> >        Enter pp_new_line 31
> > SkipSection = True
> > [@-1,11:33='#pragma warning disable',<42>,2:0]
> >        Leave pp_new_line 31
> >        Enter pp_conditional_section 13
> >         Enter pp_skipped_section 14
> >          Enter pp_skipped_section_part 15
> >           Enter pp_directive 6
> >            Enter pp_leaf_directive 7
> >             Enter pp_pragma 29
> > SkipSection = False
> > [@-1,35:36='10',<28>,2:24]
> >              Enter pp_warning_list 30
> > [@-1,37:38='\\r\\n',<29>,2:26]
> >              Leave pp_warning_list 30
> >              Enter pp_new_line 31
> > SkipSection = True
> > [@-1,39:45='/*foo*/',<45>,3:0]
> >              Leave pp_new_line 31
> >             Leave pp_pragma 29
> >            Leave pp_leaf_directive 7
> >           Leave pp_directive 6
> >          Leave pp_skipped_section_part 15
> >          Enter pp_skipped_section_part 15
> > [@-1,46:47='\\r\\n',<29>,3:7] [@-1,48:53='#endif',<35>,4:0]
> >          Leave pp_skipped_section_part 15
> >         Leave pp_skipped_section 14
> >        Leave pp_conditional_section 13
> >       Leave pp_conditional_block 12
> >      Leave pp_if_section 9
> >      Enter pp_endif 16
> >       Enter pp_new_line 31
> > SkipSection = True
> >       Leave pp_new_line 31
> >      Leave pp_endif 16
> >     Leave pp_conditional 8
> >    Leave pp_directive 6
> >   Leave input_section_part 3
> >  Leave input_section 2
> > Leave start 1****
> >
> >  ****
> >
> >  ****
> >
> > On Thu, Aug 11, 2011 at 9:31 AM, Sam Harwell
> > <sharwell at pixelminegames.com>
> > wrote:****
> >
> >  ****
> >
> > Hi "brave testers" :)****
> >
> >  ****
> >
> > I updated the MSBuild integration for the CSharp3 target to
> > significantly improve its performance in several areas. I haven't
> > tested the update to see if it fixes the issues with ReSharper's
> > IntelliSense engine, but it sure would be sweet if it did!****
> >
> >  ****
> >
> > 1.       Time to compile grammars should be reduced by 1-2 seconds
> per
> > project containing grammars.****
> >
> > 2.       The "lag" in the IDE when you change windows away from a
> modified
> > grammar file and when you save a grammar file should be reduced by 1-
> 2
> > seconds each time.****
> >
> > 3.       When you open a project IntelliSense will be ready
> immediately as
> > opposed to waiting until you save a grammar or build the project.****
> >
> > 4.       When you add or remove a file from the project, IntelliSense
> > won't break.****
> >
> >  ****
> >
> > If you'd like to test out the new tool, it's available in the
> > following 7z file. Simply close Visual Studio and replace your
> > existing Antlr3.targets and AntlrBuildTask.dll with the ones from
> this
> > archive and you're ready to
> > go.****
> >
> >  ****
> >
> >
> > http://www.tunnelvisionlabs.com/downloads/antlr/AntlrBuildTask-
> experim
> > ental-9029.7z
> > ****
> >
> >  ****
> >
> > Thanks,****
> >
> > Sam****
> >
> >  ****
> >
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From kingces95 at gmail.com  Thu Aug 11 15:47:56 2011
From: kingces95 at gmail.com (chris king)
Date: Thu, 11 Aug 2011 15:47:56 -0700
Subject: [antlr-interest] ANTLR build process performance improvement
In-Reply-To: <CAJQwtsjni6FBq3RZAcodWyO=i5L6ei1gTT_XJXtUXSxHtxLdug@mail.gmail.com>
References: <075401cc5844$10485ce0$30d916a0$@pixelminegames.com>
	<CAJQwtshVNkiHupTUYqh31jLUpBbf51hM_UxOQ7xD2tm37wCD+g@mail.gmail.com>
	<078201cc586a$175536e0$45ffa4a0$@pixelminegames.com>
	<CAJQwtsjni6FBq3RZAcodWyO=i5L6ei1gTT_XJXtUXSxHtxLdug@mail.gmail.com>
Message-ID: <CAJQwtsi4SiFBTD46FEYKd_pHjvAZP+U4-Rk6sv00Lm37oUX4dQ@mail.gmail.com>

Sam, hey, I figured out what I was doing wrong and why the predictor was
scanning a head. In the grammar (attached) I had a production I expect would
wouldn't pull any tokens from the stream:

pp_conditional_section
  : { true }? => pp_pragma
  | { false }? => pp_pragma
  ;

But instead I got the following trace:

Enter start 1
[@-1,0:22='#pragma warning disable',<11>,1:0]
 Enter pp_conditional_section 2
[@-1,24:25='10',<9>,1:24]
  Enter pp_pragma 3
   Enter pp_warning_list 4
   Leave pp_warning_list 4
  Leave pp_pragma 3
 Leave pp_conditional_section 2
Leave start 1

Clearly the predictor doesn't need to scan ahead to know whether to take
pp_pragma or pp_pragma but more to the point why would anyone code up such a
grammar in the first place! Well I did advertently do just. I removed the
second pp_pragma condition and it worked.

Thanks,
Chris

On Thu, Aug 11, 2011 at 2:12 PM, chris king <kingces95 at gmail.com> wrote:


> Really? Because I found a comment on BufferedTokenStream that seems to
> imply that the Lexer is lazy so that the parser can pass state to
> it (presumably to flip gated semantic predicates) and that some ST template
> feature already depends on this behavior... Am I reading this wrong?
>
>     /** Buffer all input tokens but do on-demand fetching of new tokens
> from
>      *  lexer. Useful when the parser or lexer has to set context/mode info
> before
>      *  proper lexing of future tokens. The ST template parser needs this,
>      *  for example, because it has to constantly flip back and forth
> between
>       *  inside/output templates. E.g., <names:{hi, <it>}> has to parse
> names
>      *  as part of an expression but "hi, <it>" as a nested template.
>
>
>
> Thanks,
> Chris
>
> On Thu, Aug 11, 2011 at 2:03 PM, Sam Harwell <sharwell at pixelminegames.com>wrote:
>
>
>> ANTLR is designed so with the lexer and parser as independent units. Your
>> lexer should be able to run to completion (the entire document) before the
>> parser is even created.****
>>
>> ** **
>>
>> There are ways around it, but I intentionally avoid getting into
>> situations where I have to think about what they might be.****
>>
>> ** **
>>
>> Sam****
>>
>> ** **
>>
>> *From:* chris king [mailto:kingces95 at gmail.com]
>> *Sent:* Thursday, August 11, 2011 2:59 PM
>> *To:* Sam Harwell; antlr-interest at antlr.org
>> *Subject:* Re: ANTLR build process performance improvement****
>>
>> ** **
>>
>> Hey Sam, thanks! I'm using it now and it's faster. Love the VS tool-chain!
>> I'd be dead in the water without it. And haven't bumped into any bugs with
>> the new version. So cool! ****
>>
>>  ****
>>
>> I've bummed into a slightly different problem and no matter how I arrange
>> my grammar (included) I can't seem to work around it. I think it might be a
>> bug in the SpecialStateTransition logic...****
>>
>>  ****
>>
>> Below is what I'm trying to parse along with the trace using your
>> enter-exit partial methods (wonderful addition BTW) for my C# preprocessor
>> interleaved with when the tokens get pulled from the stream. Also
>> interleaved are my calls to toggle SkipSection which is trying to keep track
>> of when code is #ifdefed out. So what we see is that [#if] is pulled and
>> then [false] and [\r\n]. At that point in the parse I'm at the end of the
>> pre-processor line and so I look up the pp_conditional stack to see if
>> I'm in a #ifdefed out section of code. In this case I am so I set
>> SkipSection to True. That enables (via semantic predicate) my lexer rule
>> PP_SKIPPED_CHARACTERS=45 which should suck up any code that is not a pragma
>> statement (doesn't start with #). That's all well and good and so the next
>> thing that get tokenized is [#pragma warning disable] which is good. ****
>>
>>  ****
>>
>> Now at this point I expect that no tokens should get pulled until I reach
>> the pp_pragma production. I expect this because I figure ANLTER should be
>> able to predict where it needs to go without pulling any more tokens --
>> after all the only thing that can follow a [#pragma warning disable] token
>> is a list of integers. The actual behavior is that in my
>> pp_condition_section production ANTLR pulls [10] as a
>> PP_SKIPPED_CHARACTERS instead of an INTEGER because SkipSection is set to
>> True. If things had gone as expected and [10] had been pulled in the
>> pp_pragma production. If that had happened then SkipSection would have been
>> set to False and [10] would be pulled as an INTEGER. ****
>>
>>  ****
>>
>> The code that's actually pulling the [10] is DFA.Predict in the
>> SpecialStateTransition loop when trying to predict where to go for the
>> pp_conditional_section production:****
>>
>> pp_conditional_section****
>>
>> : { !SkipSection }? => input_section****
>>
>> | { SkipSection }? => pp_skipped_section****
>>
>> ;****
>>
>> I'm guessing that this production is "special" because it's got those
>> gated semantic predicates and that's why DFA.Predict enters into the
>> SpecialStateTransition logic. What I don't understand is why it would need
>> to pull any more tokens to know where to go next. Do you think that's a bug
>> that it's pulling tokens in this case?****
>>
>>  ****
>>
>> After writing this e-mail it occurred to me that I might manually try to
>> do the prediction. I did this by putting a break point in the
>> pp_conditional_section rule at the dfa.Predict line. But instead of asking
>> the DFA to do the prediction I just set-ip to the case I wanted (e.g. {...}?
>> => pp_skipped_section). Then hit F5. And it works! I included the trace of
>> that run below. Given that I really do think that the SpecialStateTransition
>> logic (or there abouts) is being to aggressive about pulling tokens... what
>> do you think? ****
>>
>>  ****
>>
>> Thanks,****
>>
>> Chris****
>>
>>  ****
>>
>> CSharpAst.Parse("#if false\r\n#pragma warning disable
>> 10\r\n/*foo*/\r\n#endif");****
>>
>>  ****
>>
>> Enter start 1****
>>
>> [@-1,0:2='#if',<38>,1:0]****
>>
>>  Enter input_section 2****
>>
>>   Enter input_section_part 3****
>>
>>    Enter pp_directive 6****
>>
>>     Enter pp_conditional 8****
>>
>>      Enter pp_if_section 9****
>>
>> [@-1,4:8='false',<4>,1:4]****
>>
>>       Enter pp_expression 17****
>>
>>        Enter pp_or_expression 18****
>>
>>         Enter pp_and_expression 19****
>>
>>          Enter pp_equality_expression 20****
>>
>>           Enter pp_unary_expression 21****
>>
>>            Enter pp_primary_expression 22****
>>
>> [@-1,9:10='\\r\\n',<29>,1:9]****
>>
>>            Leave pp_primary_expression 22****
>>
>>           Leave pp_unary_expression 21****
>>
>>          Leave pp_equality_expression 20****
>>
>>         Leave pp_and_expression 19****
>>
>>        Leave pp_or_expression 18****
>>
>>       Leave pp_expression 17****
>>
>>       Enter pp_conditional_block 12****
>>
>>        Enter pp_new_line 31****
>>
>> SkipSection = True****
>>
>> [@-1,11:33='#pragma warning disable',<42>,2:0]****
>>
>>        Leave pp_new_line 31****
>>
>>        Enter pp_conditional_section 13****
>>
>> [@-1,34:36=' 10',<45>,2:23]****
>>
>> [@-1,37:38='\\r\\n',<29>,2:26]****
>>
>>         Enter pp_skipped_section 14****
>>
>>          Enter pp_skipped_section_part 15****
>>
>>           Enter pp_directive 6****
>>
>>            Enter pp_leaf_directive 7****
>>
>>             Enter pp_pragma 29****
>>
>> SkipSection = False****
>>
>>              Enter pp_warning_list 30****
>>
>>  ****
>>
>>  Here is the trace when I make the prediction by hand:****
>>
>>  ****
>>
>> Enter start 1
>> [@-1,0:2='#if',<38>,1:0]
>>  Enter input_section 2
>>   Enter input_section_part 3
>>    Enter pp_directive 6
>>     Enter pp_conditional 8
>>      Enter pp_if_section 9
>> [@-1,4:8='false',<4>,1:4]
>>       Enter pp_expression 17
>>        Enter pp_or_expression 18
>>         Enter pp_and_expression 19
>>          Enter pp_equality_expression 20
>>           Enter pp_unary_expression 21
>>            Enter pp_primary_expression 22
>> [@-1,9:10='\\r\\n',<29>,1:9]
>>            Leave pp_primary_expression 22
>>           Leave pp_unary_expression 21
>>          Leave pp_equality_expression 20
>>         Leave pp_and_expression 19
>>        Leave pp_or_expression 18
>>       Leave pp_expression 17
>>       Enter pp_conditional_block 12
>>        Enter pp_new_line 31
>> SkipSection = True
>> [@-1,11:33='#pragma warning disable',<42>,2:0]
>>        Leave pp_new_line 31
>>        Enter pp_conditional_section 13
>>         Enter pp_skipped_section 14
>>          Enter pp_skipped_section_part 15
>>           Enter pp_directive 6
>>            Enter pp_leaf_directive 7
>>             Enter pp_pragma 29
>> SkipSection = False
>> [@-1,35:36='10',<28>,2:24]
>>              Enter pp_warning_list 30
>> [@-1,37:38='\\r\\n',<29>,2:26]
>>              Leave pp_warning_list 30
>>              Enter pp_new_line 31
>> SkipSection = True
>> [@-1,39:45='/*foo*/',<45>,3:0]
>>              Leave pp_new_line 31
>>             Leave pp_pragma 29
>>            Leave pp_leaf_directive 7
>>           Leave pp_directive 6
>>          Leave pp_skipped_section_part 15
>>          Enter pp_skipped_section_part 15
>> [@-1,46:47='\\r\\n',<29>,3:7]
>> [@-1,48:53='#endif',<35>,4:0]
>>          Leave pp_skipped_section_part 15
>>         Leave pp_skipped_section 14
>>         Leave pp_conditional_section 13
>>       Leave pp_conditional_block 12
>>      Leave pp_if_section 9
>>      Enter pp_endif 16
>>       Enter pp_new_line 31
>> SkipSection = True
>>       Leave pp_new_line 31
>>      Leave pp_endif 16
>>     Leave pp_conditional 8
>>    Leave pp_directive 6
>>   Leave input_section_part 3
>>  Leave input_section 2
>> Leave start 1****
>>
>>  ****
>>
>>  ****
>>
>> On Thu, Aug 11, 2011 at 9:31 AM, Sam Harwell <sharwell at pixelminegames.com>
>> wrote:****
>>
>>  ****
>>
>> Hi ?brave testers? :)****
>>
>>  ****
>>
>> I updated the MSBuild integration for the CSharp3 target to significantly
>> improve its performance in several areas. I haven?t tested the update to see
>> if it fixes the issues with ReSharper?s IntelliSense engine, but it sure
>> would be sweet if it did!****
>>
>>  ****
>>
>> 1.       Time to compile grammars should be reduced by 1-2 seconds per
>> project containing grammars.****
>>
>> 2.       The ?lag? in the IDE when you change windows away from a
>> modified grammar file and when you save a grammar file should be reduced by
>> 1-2 seconds each time.****
>>
>> 3.       When you open a project IntelliSense will be ready immediately
>> as opposed to waiting until you save a grammar or build the project.****
>>
>> 4.       When you add or remove a file from the project, IntelliSense
>> won?t break.****
>>
>>  ****
>>
>> If you?d like to test out the new tool, it?s available in the following 7z
>> file. Simply close Visual Studio and replace your existing Antlr3.targets
>> and AntlrBuildTask.dll with the ones from this archive and you?re ready to
>> go.****
>>
>>  ****
>>
>>
>> http://www.tunnelvisionlabs.com/downloads/antlr/AntlrBuildTask-experimental-9029.7z
>> ****
>>
>>  ****
>>
>> Thanks,****
>>
>> Sam****
>>
>>  ****
>>
>>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Bug1.g
Type: application/octet-stream
Size: 2632 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20110811/e5fde58d/attachment.obj 

From ranco.marcus at epirion.nl  Fri Aug 12 01:58:50 2011
From: ranco.marcus at epirion.nl (Ranco Marcus)
Date: Fri, 12 Aug 2011 08:58:50 +0000
Subject: [antlr-interest] CSharp3 code generation suggestions
Message-ID: <2B65C901391C804DBB9CF9E6FE30C6F96CB00794@sun.epirion.local>

Hi Sam,

I have a few rather small suggestions for the code generated by the CSharp3 target.

1. We used to have a namespace XXXX.Antlr in the same project as where our grammars are located. The compiler fails when it tries to resolve the generated grammar's base classes (Antlr.Runtime.___) and the included namespaces (using Antlr.___ ). Maybe you could make this explicit by prefixing those reference with global::.

2. The generated grammars are public by default. If the visibility modifier would be omitted from the partial class declaration, the grammar would be internal by default (something I usually prefer). In case somebody wants the grammar to be public, he/she only needs to add another partial class definition with a public modifier.

3. We are currently in the process of annotating our code with code contracts (see
http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx, separate assembly in .NET 3.5, included in the BCL in 4.0). The static checker (freely available for VS Premium or above) is able to check after compilation where contracts might be violated. Very cool stuff and maybe something to consider for the Antlr runtime.

These are only suggestions, as none of the above are show-stoppers.

Best regards,

Ranco


From ben.corne at gmail.com  Fri Aug 12 06:22:21 2011
From: ben.corne at gmail.com (Ben Corne)
Date: Fri, 12 Aug 2011 15:22:21 +0200
Subject: [antlr-interest] Pre parse keyworded function calls into canonical
	function calls
Message-ID: <CAGcyXXHv84oUZySfmhXa9vA_io9x7_REt1GVm90wSGN+wEfKUw@mail.gmail.com>

Hello ANTLR users

I'm wondering if it's possible to do two translation passes using ANTLR for
writing a parser for a language in which both keyworded function
calls/definitions as canonical function calls are possible.
Appart from the syntax, both calls are semantically equal to eachother.

example:
is: 1 + 2 equal: 3;
is:equal:(1+2, 3);

The reason why I want to translate the keyworded function calls into
canonical is to separate language-specific code to convert keyworded calls
to their canonical representation from the grammar, to make porting to a
different backend easier. Also, introducing the keyworded style to my
grammar introduces some ambiguities that are inherrent to unbounded keyword
expressions.

What I'd like to know is wether the folowing is a good idea or does it sound
like I'm not seeing a more obvious approach?
The idea to achieve this is having 2 parser passes:

1) Translate keyworded occurences from the original input to their canonical
representations (using the rule: always try to form the longest possible
keyword chain)
prog
  : (KEYWORD) => keyword prog*
  | ~KEYWORD prog*
  ;
keyword
  : (kws+=singlekeyword)+
  ;
single_keyword
  : key=KEYWORD arg=(~KEYWORD*)
  ;

KEYWORD
  : ( 'A'..'Z' | 'a'..'z' ) ':'
  ;

do some magic to rewrite foo: x bar: y into foo:bar:(x,y);

2) Run the regular language grammar over the modified input from the first
pass.

Kind Regards
Ben Corne.

From sharwell at pixelminegames.com  Fri Aug 12 08:03:47 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Fri, 12 Aug 2011 10:03:47 -0500
Subject: [antlr-interest] CSharp3 code generation suggestions
In-Reply-To: <2B65C901391C804DBB9CF9E6FE30C6F96CB00794@sun.epirion.local>
References: <2B65C901391C804DBB9CF9E6FE30C6F96CB00794@sun.epirion.local>
Message-ID: <07de01cc5901$0a55db60$1f019220$@pixelminegames.com>

1. I?ll make this change for all references to the Antlr namespace (using
statements and base classes). To change the base class of a grammar, you can
use ?@lexer::superClass{global::Antlr.Runtime.Lexer}? (non-combined grammars
may omit the lexer::, and any type name may be specified as the superClass).

 

2. You can use @lexer::modifier{internal} to control access to the classes.
Use @lexer::ctorModifier{private} if you?ve declared your own constructor(s)
and need to prevent external code from using the generated ones. Section 5.1
of the C# 3 documentation shows this new feature (added for the 3.4
release).

 

3. I use Code Contracts with rewriting extensively in one of my other (side)
projects. For now it?s a love/hate relationship, but the real reason I
haven?t annotated the existing code is there are some big questions about
the compatibility of the CC library with the BSD license used for the
runtime.

 

Sam

 

From: Ranco Marcus [mailto:ranco.marcus at epirion.nl] 
Sent: Friday, August 12, 2011 3:59 AM
To: antlr-interest at antlr.org
Cc: Sam Harwell ?[sharwell at pixelminegames.com]?
Subject: CSharp3 code generation suggestions

 

Hi Sam,

 

I have a few rather small suggestions for the code generated by the CSharp3
target.

 

1. We used to have a namespace XXXX.Antlr in the same project as where our
grammars are located. The compiler fails when it tries to resolve the
generated grammar's base classes (Antlr.Runtime.___) and the included
namespaces (using Antlr.___ ). Maybe you could make this explicit by
prefixing those reference with global::.

 

2. The generated grammars are public by default. If the visibility modifier
would be omitted from the partial class declaration, the grammar would be
internal by default (something I usually prefer). In case somebody wants the
grammar to be public, he/she only needs to add another partial class
definition with a public modifier.

 

3. We are currently in the process of annotating our code with code
contracts (see 

http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx, separate assembly in
.NET 3.5, included in the BCL in 4.0). The static checker (freely available
for VS Premium or above) is able to check after compilation where contracts
might be violated. Very cool stuff and maybe something to consider for the
Antlr runtime.

 

These are only suggestions, as none of the above are show-stoppers.

 

Best regards, 

 

Ranco

 


From kingces95 at gmail.com  Fri Aug 12 11:33:06 2011
From: kingces95 at gmail.com (chris king)
Date: Fri, 12 Aug 2011 11:33:06 -0700
Subject: [antlr-interest] Change Parser\Lexer Visibility
Message-ID: <CAJQwtsi0Vj97NeK+gdA_eSo0VBp0FOgUhpGD4Ked=OkR5o0FqQ@mail.gmail.com>

Hey Sam, is there a way to change the visibility of the generated
parser\lexer classes to internal? I thought read somewhere about a directive
specific for C# like the @namespace to do that but I can't find it anymore.

Thanks!
Chris

From joelmarty2 at gmail.com  Sat Aug 13 05:33:51 2011
From: joelmarty2 at gmail.com (=?ISO-8859-1?Q?Jo=EBl_Marty?=)
Date: Sat, 13 Aug 2011 14:33:51 +0200
Subject: [antlr-interest] Test dynamic scope presence
Message-ID: <4E466F2F.1040808@gmail.com>

Hi,

I'm currently working with the Java 1.6 grammar available on antlr 
website (not the tree grammar) and I need to detect method calls in my 
code (probably in the identifierSuffix rule).
Since parameter passing doesn't work very well with predicates, I 
thought following the advice of using a dynamic scope high enough in the 
hierarchy to pass contextual information between an arbitrary rule (say 
methodDeclaration) and identifierSuffix; but how can I be certain that 
the scope defined in methodDeclaration is available to identifierSuffix? 
What happens if identifierSuffix is called from another rule and the 
scope is not available?

Joel

From researcher0x00 at gmail.com  Sat Aug 13 12:29:26 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Sat, 13 Aug 2011 15:29:26 -0400
Subject: [antlr-interest] Test dynamic scope presence
In-Reply-To: <4E466F2F.1040808@gmail.com>
References: <4E466F2F.1040808@gmail.com>
Message-ID: <CAN45N122zSB8bRhpTShCTc_t5OrM20C9sbbvjVunn-Na2V_kkw@mail.gmail.com>

Hi Joel,

If I understand your basic problem you are just trying to spy on the method
calls.

While it is probably possible to use dynamic scopes have you considered a
global scope.

Personally, when I debug a few rules for a special case, I just modify the
source code directly after ANTLR generates it. I also stick the spying
support methods in a separate package and make calls to it.

Hope that helps,

Eric

From joelmarty2 at gmail.com  Sat Aug 13 12:47:27 2011
From: joelmarty2 at gmail.com (=?UTF-8?B?Sm/Dq2wgTWFydHk=?=)
Date: Sat, 13 Aug 2011 21:47:27 +0200
Subject: [antlr-interest] Test dynamic scope presence
In-Reply-To: <CAN45N122zSB8bRhpTShCTc_t5OrM20C9sbbvjVunn-Na2V_kkw@mail.gmail.com>
References: <4E466F2F.1040808@gmail.com>
	<CAN45N122zSB8bRhpTShCTc_t5OrM20C9sbbvjVunn-Na2V_kkw@mail.gmail.com>
Message-ID: <4E46D4CF.7010408@gmail.com>

Basically the intent of my project is to modelise Java code in a RDF 
graph so I need much more than spying method calls.
I defined class members that registers declared types, methods or 
fields and my main problem is to keep track of the context in which an 
element has been declared.
Basically I pass a 'container' information along my rules: a type 
container is its declaring file, a method's container is its declaring 
type, a method call container is the method from which it is called etc 
etc.
My question was relative to the way dynamic scopes are implemented and 
how I can test for the existence of the parent container information 
but I have my answer now. The fact that they are implemented using 
inner static classes helps me in that way.

I can't really modify the generated class at that point, I'm still 
developing the grammar and when I regenerate my modifications are 
erased.

Le sam. 13 ao?t 2011 21:29:26 CEST, The Researcher a ?crit :
> Hi Joel,
> 
> If I understand your basic problem you are just trying to spy on the method
> calls.
> 
> While it is probably possible to use dynamic scopes have you considered a
> global scope.
> 
> Personally, when I debug a few rules for a special case, I just modify the
> source code directly after ANTLR generates it. I also stick the spying
> support methods in a separate package and make calls to it.
> 
> Hope that helps,
> 
> Eric
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From ben.corne at gmail.com  Sun Aug 14 06:22:34 2011
From: ben.corne at gmail.com (Ben Corne)
Date: Sun, 14 Aug 2011 15:22:34 +0200
Subject: [antlr-interest] gathering any character until specified char
Message-ID: <CAGcyXXESJYdV8B6uJVi+8wgRgS0qeHLV60fhzitcSiu3Lw5AJQ@mail.gmail.com>

HI all

I'm trying to create a list of any characters but trailing whitespaces
separated by comma's.
Here are the rules for a specific case where I need this kind of list:

authors
: (auth+=(.*)) WS* (',' WS* auth+=(.*) WS*)
 -> ^(AGAUTHORS $auth)
;
WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        )
    ;

Input: Ben Corne ,  An antlr FAN
Parse tree should look like this:
authors
|------------ 'Ben Corne'
|------------ WS
|------------ ','
|------------ WS
|------------ 'An antlr FAN'

Instead I get one that doesn't seem to gather any character but the ','
(tested in debugger)
Anyone know what I'm doing wrong here?

Kind regards
Ben Corne

From ben.corne at gmail.com  Mon Aug 15 02:26:05 2011
From: ben.corne at gmail.com (Ben Corne)
Date: Mon, 15 Aug 2011 11:26:05 +0200
Subject: [antlr-interest] gathering any character until specified char
In-Reply-To: <CAGcyXXESJYdV8B6uJVi+8wgRgS0qeHLV60fhzitcSiu3Lw5AJQ@mail.gmail.com>
References: <CAGcyXXESJYdV8B6uJVi+8wgRgS0qeHLV60fhzitcSiu3Lw5AJQ@mail.gmail.com>
Message-ID: <CAGcyXXHq_et5QSNr4ROG+Q1Ree334Z3WkF60f=cZB=QH8m3TSQ@mail.gmail.com>

Here's another try:
authors
: auth+=until_separator (',' auth+=until_separator)*
 -> ^(AGAUTHORS $auth)
;

until_separator
: (~SEPARATOR)*
 ;

SEPARATOR : ',' ;

This results again in empty values.
Is there an option I need to toggle to make sure the characters get
accounted for?

2011/8/14 Ben Corne <ben.corne at gmail.com>

> HI all
>
> I'm trying to create a list of any characters but trailing whitespaces
> separated by comma's.
> Here are the rules for a specific case where I need this kind of list:
>
> authors
> : (auth+=(.*)) WS* (',' WS* auth+=(.*) WS*)
>  -> ^(AGAUTHORS $auth)
> ;
> WS  :   ( ' '
>         | '\t'
>         | '\r'
>         | '\n'
>         )
>     ;
>
> Input: Ben Corne ,  An antlr FAN
> Parse tree should look like this:
> authors
> |------------ 'Ben Corne'
> |------------ WS
> |------------ ','
> |------------ WS
> |------------ 'An antlr FAN'
>
> Instead I get one that doesn't seem to gather any character but the ','
> (tested in debugger)
> Anyone know what I'm doing wrong here?
>
> Kind regards
> Ben Corne
>

From david.smith at cc.gatech.edu  Tue Aug 16 08:49:20 2011
From: david.smith at cc.gatech.edu (David Smith)
Date: Tue, 16 Aug 2011 11:49:20 -0400
Subject: [antlr-interest] Not consuming the next token
Message-ID: <E1QtLtD-0007sl-2U@elasmtp-galgo.atl.sa.earthlink.net>

Sorry to bother you again. Another question indicating a complete 
lack of understanding of the basic Antlr mechanism. Matlab over-uses 
the token END and I am trying to distinguish two uses based on the 
token that follows END.  If it is followed by COMMA, COLON, CLOSEP or 
SEMI, it is used in an indexing context.  Otherwise, it's the normal 
usage.  So this rule:

endIndex: END (COMMA | COLON | CLOSEP | SEMI) => END;

seems to work except that it consumes the following token.  How do I 
express this rule in such a way that the following token is not consumed?

DMS

David M. Smith http://www.cc.gatech.edu/fac/David.Smith
Georgia Institute of Technology, College of Computing
Sent from my ASR-33 Teletype 


From jeremy.long at gmail.com  Tue Aug 16 16:32:41 2011
From: jeremy.long at gmail.com (Jeremy Long)
Date: Tue, 16 Aug 2011 19:32:41 -0400
Subject: [antlr-interest] Antlr3 Maven Plugin - import cannot be resolved
Message-ID: <CAKAumBGAvUDdYy199k7WhW==+JJxEMW4biSM5v8niLc1ua-ZMg@mail.gmail.com>

I am trying to setup a maven project utilizing the antlr3-maven-plugin
(version 3.4). I generated the project in Eclipse using m2e and the
antlr3-maven-archetype version 3.4. The generated sources are correctly put
into the "target/generated-sources". However, the classpath in Eclipse is
not updated to reference the generated classes so I cannot import any of the
generated code to use in other classes. This occurs with just using the
arntl3-maven-archetype with the TLexer.g, TParser.g, and TTree.g.

Any hints on this?

Thanks,

Jeremy

From arteminus at yandex.ru  Wed Aug 17 05:02:06 2011
From: arteminus at yandex.ru (=?koi8-r?B?8s/Nwc7P1yDh0tTFzQ==?=)
Date: Wed, 17 Aug 2011 16:02:06 +0400
Subject: [antlr-interest] iniFile grammer
Message-ID: <777191313582526@web68.yandex.ru>

I try define iniFile grammer(keys contains few subvalues).
I defined it from C# Regex:
Regex commentLine = new Regex(@"^\s*#(?<comment>.*)", RegexOptions.Compiled);
Regex sectionLine = new Regex(@"^\s*\[(?<section>.*)\].*", RegexOptions.Compiled);
//Regex recordLine = new Regex(@"^\s*(?<key>[^#[=\s]+)\s*=?\s*(?<values>[^#]*)(#(?<comment>.*))?", RegexOptions.Compiled);
Regex recordLine2 = new Regex(@"^\s*(?<key>[^#[=\s]+)\s*=?\s*((?<value>[^;\#]*);)*(?<endValue>[^;\#]*[^;\s\#]+)?\s*(#(?<comment>.*))?", RegexOptions.Compiled);
foreach(var c in recordLine2.Math(string).Groups["value"].Captures)
	//access to each value of key
Sample ini struct:
#comment
[section]
key1
key2=
key3= # this and earlier lines contains 0 values
key4=a# 1 values
key5=;# 1 empty values
key6=a;f # 2 values
key7= a ; f;; # 3 values
[section2]
..
But I don't know how implement endValue(without semicolon) and get lot of warnings from my grammer. 
This grammer return wrong parse tree([section2] as keyLine).
I testet grammer in ANTLRWork 1.4.3

grammar test;
WS	:	(' '|'\t')	{$channel=HIDDEN;};
EOL	:	('\r\n'|'\n'|'\r') ;
SHARP	:	'#' {System.out.println("#");};
EQUAL	:	'=' {System.out.println("=");};
SEMICOLON	:	';' {System.out.println(";");};		
COMMENT	:	SHARP .* EOL ;//{System.out.println("COM");};
SECTION	:	'[' .* ']' {System.out.println("SEC");};
ANY	:	. {System.out.println("ANY");};
iniFile	
	:	section* EOF;
section 
	: commentLine* sectionLine COMMENT* (keyLine COMMENT?)*;
commentLine 	
	: COMMENT;
sectionLine
	: SECTION (EOL|COMMENT);
keyLine	
	:	key keyValues* (EOL|COMMENT);
key	
	:	~('='|'#'|'['|EOL)+  {System.out.println("key");};
keyValues
	: '=' (keyValue';')*;
keyValue:	~(';'|'#'|EOL)* ;	

From bkiers at gmail.com  Wed Aug 17 11:10:02 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Wed, 17 Aug 2011 20:10:02 +0200
Subject: [antlr-interest] iniFile grammer
In-Reply-To: <777191313582526@web68.yandex.ru>
References: <777191313582526@web68.yandex.ru>
Message-ID: <CAOrgODYo2bZQBLz5gLHYJQbMEO_JOHHGtGVgFTjaSgAuDjpdwQ@mail.gmail.com>

Hi ???????,

How about something like this:

grammar INIFile;

parse
  :  Comment* section+ EOF
  ;

section
  :  SectionStart (property | Comment)*
  ;

property
  :  NameOrValue (Assign valueList?)? eol
  ;

valueList
  :  (Separator | NameOrValue)+
  ;

eol
  :  LineBreak
  |  Comment
  |  EOF
  ;

Comment
  :  '#' ~('\r' | '\n')* LineBreak
  ;

SectionStart
  :  '[' ~(']')+ ']' Spaces? LineBreak
  ;

Separator
  :  ';'
  ;

Assign
  :  '='
  ;

NameOrValue
  :  ~(' ' | '\t' | '=' | '\r' | '\n' | '#' | ';') ~('=' | '\r' | '\n' | '#'
| ';')*
  ;

LineBreak
  :  '\r'? '\n'
  |  '\r'
  ;

Spaces
  :  (' ' | '\t')+  {$channel=HIDDEN;}
  ;


Regards,

Bart.


On Wed, Aug 17, 2011 at 2:02 PM, ??????? ????? <arteminus at yandex.ru> wrote:

> I try define iniFile grammer(keys contains few subvalues).
> I defined it from C# Regex:
> Regex commentLine = new Regex(@"^\s*#(?<comment>.*)",
> RegexOptions.Compiled);
> Regex sectionLine = new Regex(@"^\s*\[(?<section>.*)\].*",
> RegexOptions.Compiled);
> //Regex recordLine = new
> Regex(@"^\s*(?<key>[^#[=\s]+)\s*=?\s*(?<values>[^#]*)(#(?<comment>.*))?",
> RegexOptions.Compiled);
> Regex recordLine2 = new
> Regex(@"^\s*(?<key>[^#[=\s]+)\s*=?\s*((?<value>[^;\#]*);)*(?<endValue>[^;\#]*[^;\s\#]+)?\s*(#(?<comment>.*))?",
> RegexOptions.Compiled);
> foreach(var c in recordLine2.Math(string).Groups["value"].Captures)
>        //access to each value of key
> Sample ini struct:
> #comment
> [section]
> key1
> key2=
> key3= # this and earlier lines contains 0 values
> key4=a# 1 values
> key5=;# 1 empty values
> key6=a;f # 2 values
> key7= a ; f;; # 3 values
> [section2]
> ..
> But I don't know how implement endValue(without semicolon) and get lot of
> warnings from my grammer.
> This grammer return wrong parse tree([section2] as keyLine).
> I testet grammer in ANTLRWork 1.4.3
>
> grammar test;
> WS      :       (' '|'\t')      {$channel=HIDDEN;};
> EOL     :       ('\r\n'|'\n'|'\r') ;
> SHARP   :       '#' {System.out.println("#");};
> EQUAL   :       '=' {System.out.println("=");};
> SEMICOLON       :       ';' {System.out.println(";");};
> COMMENT :       SHARP .* EOL ;//{System.out.println("COM");};
> SECTION :       '[' .* ']' {System.out.println("SEC");};
> ANY     :       . {System.out.println("ANY");};
> iniFile
>        :       section* EOF;
> section
>        : commentLine* sectionLine COMMENT* (keyLine COMMENT?)*;
> commentLine
>        : COMMENT;
> sectionLine
>        : SECTION (EOL|COMMENT);
> keyLine
>        :       key keyValues* (EOL|COMMENT);
> key
>        :       ~('='|'#'|'['|EOL)+  {System.out.println("key");};
> keyValues
>        : '=' (keyValue';')*;
> keyValue:       ~(';'|'#'|EOL)* ;
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From robert.jarzmik at free.fr  Wed Aug 17 12:02:14 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Wed, 17 Aug 2011 21:02:14 +0200
Subject: [antlr-interest] AST build with input tokens out of order
Message-ID: <m339gzuaix.fsf@free.fr>

Hello,

I have a little problem to build an AST for my specific grammar. As I'm an ANTLR
beginner please be patient with me ...

I narrowed down the problem to a simple usecase.

The input : INTEGER ARRAY P1[10], P2[40,MAX_NB_CLOUDS]
The wished output (in lisp notation) :
  #( #('P1' ARRAY #( #('DIMS' 10) INTEGER)) #('P2' ARRAY #( #('DIMS' 40 MAX_NB_CLOUDS) INTEGER)) )

My main problem is that the type (INTEGER) is before the ARRAY token, and I
cannot think of a way to write the rewrite rules. I provided at the end of the
mail the extract of my grammar [1] narrowed down to my specific problem.

Can anyone figure out how to properly write the rules to have my wished output
please ?

Cheers.

--
Robert

[1] LTR_ex1.g

grammar LTR_ex1;
options {
    k=1;
    output=AST;
}

tokens {
DIMS;
}

declaration
    : (type_specifier ARRAY) => type_specifier ARRAY identifiers
      -> ^(ARRAY identifiers type_specifier)+
    ;

identifiers
    : array_or_single_identifier ( ',' array_or_single_identifier )*
        -> array_or_single_identifier+
    ;

array_or_single_identifier
    : (IDENTIFIER '[') => array
    | IDENTIFIER
    ;

array
    : IDENTIFIER '[' constant ( ',' constant )* ']'
        -> IDENTIFIER ^( DIMS constant+ )
    ;

constant
    : DECIMAL_LITERAL
    | IDENTIFIER
    ;

type_specifier
    : 'LOGICAL'
    | 'INTEGER'
    | 'BOOLEAN'
    ;


//////////////////////////////////////////////////////////////////////
//                         LEXER definitions                        //
//////////////////////////////////////////////////////////////////////

ARRAY : 'ARRAY' ;

DECIMAL_LITERAL : ('0' | '1'..'9' '0'..'9'*) ;

IDENTIFIER
	:	LETTER (LETTER|'0'..'9'|'#')*
	;
	
fragment
LETTER
    :	'A'..'Z'
	|	'a'..'z'
	|	'_'
	;

From robert.jarzmik at free.fr  Wed Aug 17 12:02:25 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Wed, 17 Aug 2011 21:02:25 +0200
Subject: [antlr-interest] AST build with input tokens out of order
Message-ID: <m31uwjuaim.fsf@free.fr>

Hello,

I have a little problem to build an AST for my specific grammar. As I'm an ANTLR
beginner please be patient with me ...

I narrowed down the problem to a simple usecase.

The input : INTEGER ARRAY P1[10], P2[40,MAX_NB_CLOUDS]
The wished output (in lisp notation) :
  #( #('P1' ARRAY #( #('DIMS' 10) INTEGER)) #('P2' ARRAY #( #('DIMS' 40 MAX_NB_CLOUDS) INTEGER)) )

My main problem is that the type (INTEGER) is before the ARRAY token, and I
cannot think of a way to write the rewrite rules. I provided at the end of the
mail the extract of my grammar [1] narrowed down to my specific problem.

Can anyone figure out how to properly write the rules to have my wished output
please ?

Cheers.

--
Robert

[1] LTR_ex1.g

grammar LTR_ex1;
options {
    k=1;
    output=AST;
}

tokens {
DIMS;
}

declaration
    : (type_specifier ARRAY) => type_specifier ARRAY identifiers
      -> ^(ARRAY identifiers type_specifier)+
    ;

identifiers
    : array_or_single_identifier ( ',' array_or_single_identifier )*
        -> array_or_single_identifier+
    ;

array_or_single_identifier
    : (IDENTIFIER '[') => array
    | IDENTIFIER
    ;

array
    : IDENTIFIER '[' constant ( ',' constant )* ']'
        -> IDENTIFIER ^( DIMS constant+ )
    ;

constant
    : DECIMAL_LITERAL
    | IDENTIFIER
    ;

type_specifier
    : 'LOGICAL'
    | 'INTEGER'
    | 'BOOLEAN'
    ;


//////////////////////////////////////////////////////////////////////
//                         LEXER definitions                        //
//////////////////////////////////////////////////////////////////////

ARRAY : 'ARRAY' ;

DECIMAL_LITERAL : ('0' | '1'..'9' '0'..'9'*) ;

IDENTIFIER
	:	LETTER (LETTER|'0'..'9'|'#')*
	;
	
fragment
LETTER
    :	'A'..'Z'
	|	'a'..'z'
	|	'_'
	;

From bkiers at gmail.com  Wed Aug 17 13:28:43 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Wed, 17 Aug 2011 22:28:43 +0200
Subject: [antlr-interest] AST build with input tokens out of order
In-Reply-To: <m339gzuaix.fsf@free.fr>
References: <m339gzuaix.fsf@free.fr>
Message-ID: <CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>

Hi Robert,

AFAIK, you'll need to pass the 'type' of your array down your tree as a
parameter.

A little demo:

grammar LTR_ex1;

options {
  k=1;
  output=AST;
  ASTLabelType=CommonTree;
}

tokens {
  DIMS;
}

declaration
  :  (type_specifier ARRAY)=> type_specifier ARRAY
identifiers[$type_specifier.tree]
                              -> ^(ARRAY identifiers)+
  ;

identifiers[CommonTree type]
  :  array_or_single_identifier[type] (','
array_or_single_identifier[type])*
     -> array_or_single_identifier+
  ;

array_or_single_identifier[CommonTree type]
  :  (IDENTIFIER '[')=> array[type]
  |                     IDENTIFIER
  ;

array[CommonTree type]
  :  IDENTIFIER '[' constant (',' constant)* ']'
     -> ^(IDENTIFIER ^( DIMS constant+) {new CommonTree(type)})
  ;

constant
  :  DECIMAL_LITERAL
  |  IDENTIFIER
  ;

type_specifier
  :  'LOGICAL'
  |  'INTEGER'
  |  'BOOLEAN'
  ;

ARRAY           : 'ARRAY' ;
DECIMAL_LITERAL : ('0' | '1'..'9' '0'..'9'*);
IDENTIFIER      : LETTER (LETTER|'0'..'9'|'#')*;
SPACE           : ' ' {skip();};
fragment LETTER : 'A'..'Z' | 'a'..'z' | '_';


Regards,

Bart.

On Wed, Aug 17, 2011 at 9:02 PM, Robert Jarzmik <robert.jarzmik at free.fr>wrote:

> Hello,
>
> I have a little problem to build an AST for my specific grammar. As I'm an
> ANTLR
> beginner please be patient with me ...
>
> I narrowed down the problem to a simple usecase.
>
> The input : INTEGER ARRAY P1[10], P2[40,MAX_NB_CLOUDS]
> The wished output (in lisp notation) :
>  #( #('P1' ARRAY #( #('DIMS' 10) INTEGER)) #('P2' ARRAY #( #('DIMS' 40
> MAX_NB_CLOUDS) INTEGER)) )
>
> My main problem is that the type (INTEGER) is before the ARRAY token, and I
> cannot think of a way to write the rewrite rules. I provided at the end of
> the
> mail the extract of my grammar [1] narrowed down to my specific problem.
>
> Can anyone figure out how to properly write the rules to have my wished
> output
> please ?
>
> Cheers.
>
> --
> Robert
>
> [1] LTR_ex1.g
>
> grammar LTR_ex1;
> options {
>    k=1;
>    output=AST;
> }
>
> tokens {
> DIMS;
> }
>
> declaration
>    : (type_specifier ARRAY) => type_specifier ARRAY identifiers
>      -> ^(ARRAY identifiers type_specifier)+
>    ;
>
> identifiers
>    : array_or_single_identifier ( ',' array_or_single_identifier )*
>        -> array_or_single_identifier+
>    ;
>
> array_or_single_identifier
>    : (IDENTIFIER '[') => array
>    | IDENTIFIER
>    ;
>
> array
>    : IDENTIFIER '[' constant ( ',' constant )* ']'
>        -> IDENTIFIER ^( DIMS constant+ )
>    ;
>
> constant
>    : DECIMAL_LITERAL
>    | IDENTIFIER
>    ;
>
> type_specifier
>    : 'LOGICAL'
>    | 'INTEGER'
>    | 'BOOLEAN'
>    ;
>
>
> //////////////////////////////////////////////////////////////////////
> //                         LEXER definitions                        //
> //////////////////////////////////////////////////////////////////////
>
> ARRAY : 'ARRAY' ;
>
> DECIMAL_LITERAL : ('0' | '1'..'9' '0'..'9'*) ;
>
> IDENTIFIER
>        :       LETTER (LETTER|'0'..'9'|'#')*
>        ;
>
> fragment
> LETTER
>    :   'A'..'Z'
>        |       'a'..'z'
>        |       '_'
>        ;
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From knifed at gmail.com  Wed Aug 17 17:22:26 2011
From: knifed at gmail.com (Jeff Hair)
Date: Wed, 17 Aug 2011 20:22:26 -0400
Subject: [antlr-interest] JavaScript Target
Message-ID: <CALv2TkWNA-FzYT=5YDfo_8rbm7n9G8aC44xCwC3cyaJexUJ=RA@mail.gmail.com>

Hello,

I tried generating a very simple "hello world" grammar with the JavaScript
target using v 3.4. It put out a bunch of warnings and generated invalid
code. In particular, it created a strange JS object literal like { : }. It
had the colons but not the variables or values. Is this a known issue?

From gary at sumwise.com  Wed Aug 17 18:34:55 2011
From: gary at sumwise.com (Gary Miller)
Date: Thu, 18 Aug 2011 11:34:55 +1000
Subject: [antlr-interest] JavaScript Target
In-Reply-To: <CALv2TkWNA-FzYT=5YDfo_8rbm7n9G8aC44xCwC3cyaJexUJ=RA@mail.gmail.com>
References: <CALv2TkWNA-FzYT=5YDfo_8rbm7n9G8aC44xCwC3cyaJexUJ=RA@mail.gmail.com>
Message-ID: <CAFCNb3jQMWGX59BwZjtuRUO+ZtTif1Mt1r8PdmVUK6JDtXyvvw@mail.gmail.com>

Hey Jeff,

I can't talk to the JS target, but I get to JS via a round about root.
ANTLR -> Java -> JS using the GWT compiler.
There are some minor changes needed for the ANTLR runtime to be GWT
compatible.
For 3.2 I've put these online at http://code.google.com/p/gwtified/

There is a nice project that enable the generated JS code
being accessible as a JS library http://code.google.com/p/gwt-exporter/

There is quite a lot of tooling need to get this to work, but imo it's worth
it.

If there is interest I might invest some time, branch antlr at github, get
gwt working for 3.4 and setup build support.

Regards
Gary


On Thu, Aug 18, 2011 at 10:22 AM, Jeff Hair <knifed at gmail.com> wrote:

> Hello,
>
> I tried generating a very simple "hello world" grammar with the JavaScript
> target using v 3.4. It put out a bunch of warnings and generated invalid
> code. In particular, it created a strange JS object literal like { : }. It
> had the colons but not the variables or values. Is this a known issue?
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From dtrebbien at gmail.com  Thu Aug 18 07:23:51 2011
From: dtrebbien at gmail.com (Daniel Trebbien)
Date: Thu, 18 Aug 2011 10:23:51 -0400
Subject: [antlr-interest] JavaScript Target
In-Reply-To: <CALv2TkWNA-FzYT=5YDfo_8rbm7n9G8aC44xCwC3cyaJexUJ=RA@mail.gmail.com>
References: <CALv2TkWNA-FzYT=5YDfo_8rbm7n9G8aC44xCwC3cyaJexUJ=RA@mail.gmail.com>
Message-ID: <CABrgu5RnrSHOonxoyhdfU_XFve3Jq6d6XBm2U89N_5wDBk3iow@mail.gmail.com>

Hello Jeff,

I know what you mean.  I recently tried using the JavaScript target with
v3.4 and was unable to do so.  I also tried building from source, but this
turns out to be fruitless as the JavaScript target only works with
v3.1, as stated
on the wiki page<http://www.antlr.org/wiki/display/ANTLR3/ANTLR3JavaScriptTarget>
.

Here's how to get started with ANTLR and the JavaScript back-end:

   1. Download ANTLRWorks 1.2.2:  <
   http://antlr.org/download/antlrworks-1.2.2.jar>.  The JavaScript target
   only works when the IDE generates the lexer and parser code (see <
   http://antlr.1301665.n2.nabble.com/maven-plugin-and-javascript-target-td3647109.html>).
   If you try to run ANTLR v3.1 from the command line, you will see the error
   message "error(10):  internal error: group JavaScript does not satisfy
   interface ANTLRCore".
   2. Download the JS runtime distribution:
   http://antlr.org/download/antlr-javascript-runtime-3.1.zip


>From then on you can use ANTLRWorks 1.2.2 to generate the lexer and parser
code by selecting "Generate Code" from the "Generate" menu.  ANTLRWorks will
place the generated files into an `output` directory in the folder in which
the grammar file resides.

Note that if an error occurs in the generation process, then for some reason
the "Generate Code" action no longer works.  Simply close the grammar and
re-open it from the "Open Recent" menu.

Daniel Trebbien

On Wed, Aug 17, 2011 at 8:22 PM, Jeff Hair <knifed at gmail.com> wrote:

> Hello,
>
> I tried generating a very simple "hello world" grammar with the JavaScript
> target using v 3.4. It put out a bunch of warnings and generated invalid
> code. In particular, it created a strange JS object literal like { : }. It
> had the colons but not the variables or values. Is this a known issue?
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From dtrebbien at gmail.com  Thu Aug 18 07:42:13 2011
From: dtrebbien at gmail.com (Daniel Trebbien)
Date: Thu, 18 Aug 2011 10:42:13 -0400
Subject: [antlr-interest] ANTLR3 build errors
Message-ID: <CABrgu5TgRX0f3fq84QB6F+Ju2-NOWivgKRrC1SOHiMh++=nUsA@mail.gmail.com>

I recently tried to build ANTLR3 from the latest source snapshot (identical
to a999523<https://github.com/antlr/antlr/commit/a9995231e5d16b883ae08b039db3380b84ae4a84>of
the git repository), but I encountered a number of difficulties while
building.  Once built, I then encountered a NullPointerException whenever
running the Tool program.  Are these known issues?

If anyone is interested, I have uploaded a couple of commits that fix these
problems to my fork of antlr/antlr on GitHub:

   1. 6d4fed20<https://github.com/dtrebbien/antlr/commit/6d4fed20fcb0192f0b96511757955ad3c8576c0c>Fix
compilation errors
   2. c8afa2a9<https://github.com/dtrebbien/antlr/commit/c8afa2a9e21968bd67e0f30cf96efd5b08934787>Fix
NullPointerException

See also the diff
a999523...c8afa2a9<https://github.com/dtrebbien/antlr/compare/a9995231e5...c8afa2a9e2>
.

Daniel Trebbien

From robert.jarzmik at free.fr  Thu Aug 18 11:53:26 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Thu, 18 Aug 2011 20:53:26 +0200
Subject: [antlr-interest] AST build with input tokens out of order
In-Reply-To: <CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	(Bart Kiers's message of "Wed, 17 Aug 2011 22:28:43 +0200")
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
Message-ID: <m3sjoysg9l.fsf@free.fr>

Bart Kiers <bkiers at gmail.com> writes:

> Hi Robert,
>
> AFAIK, you'll need to pass the 'type' of your array down your tree as
> a parameter.

Thank you very much, it's exactly what I needed.

Just for the record, I had to change
>     -> ^(IDENTIFIER ^( DIMS constant+) {new CommonTree(type)})
into
      -> ^(IDENTIFIER ^( DIMS constant+) {type})

That might be linked with antlrworks-1.4.3.jar maybe ...

But the solution is exactly what I was looking for, and will provide me with the
key to finish my AST.

Cheers.

--
Robert

From robert.jarzmik at free.fr  Thu Aug 18 11:53:46 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Thu, 18 Aug 2011 20:53:46 +0200
Subject: [antlr-interest] AST build with input tokens out of order
In-Reply-To: <CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	(Bart Kiers's message of "Wed, 17 Aug 2011 22:28:43 +0200")
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
Message-ID: <m3r54isg91.fsf@free.fr>

Bart Kiers <bkiers at gmail.com> writes:

> Hi Robert,
>
> AFAIK, you'll need to pass the 'type' of your array down your tree as
> a parameter.

Thank you very much, it's exactly what I needed.

Just for the record, I had to change
>     -> ^(IDENTIFIER ^( DIMS constant+) {new CommonTree(type)})
into
      -> ^(IDENTIFIER ^( DIMS constant+) {type})

That might be linked with antlrworks-1.4.3.jar maybe ...

But the solution is exactly what I was looking for, and will provide me with the
key to finish my AST.

Cheers.

--
Robert

From bkiers at gmail.com  Thu Aug 18 12:19:02 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Thu, 18 Aug 2011 21:19:02 +0200
Subject: [antlr-interest] AST build with input tokens out of order
In-Reply-To: <m3r54isg91.fsf@free.fr>
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	<m3r54isg91.fsf@free.fr>
Message-ID: <CAOrgODaDr5=hMcRvHXrKNtqtQtrKxYZGYiMcY-81-VwEU0eP0A@mail.gmail.com>

On Thu, Aug 18, 2011 at 8:53 PM, Robert Jarzmik <robert.jarzmik at free.fr>wrote:

>
> Just for the record, I had to change
> >     -> ^(IDENTIFIER ^( DIMS constant+) {new CommonTree(type)})
> into
>      -> ^(IDENTIFIER ^( DIMS constant+) {type})
>
> That might be linked with antlrworks-1.4.3.jar maybe ...
>
>
Both should work from the command line. Using `{type}` only "recycles" the
type-token, possibly causing two or more nodes to point to the same instance
of `type` (by default a CommonTree).

Regards,

Bart.

From preethi.sundar at gmail.com  Thu Aug 18 12:24:33 2011
From: preethi.sundar at gmail.com (Preethi Sundar)
Date: Fri, 19 Aug 2011 00:54:33 +0530
Subject: [antlr-interest] ANTLR Python 2.3.3 grammar - indentation
Message-ID: <CA+N6WBSxtYMh4BL6E44nhfHgCr_ADU7KQKWDm7Y5Zsh1+wSchA@mail.gmail.com>

Hi all,

When the Python 2.3.3 grammar posted in antlr.org is built using ANTLR
plugin for eclipse, a few warnings are generated.

Two warnings state that there are no rules corresponding to INDENT and
DEDENT tokens. On closer examination, it is found that python's indentation
has not been implemented.

I have resolved this issue (and two other warnings) and posted a description
of my solution on
http://mobilesystemsengineering.appspot.com/staticdocs/AdvancedMobileSystemsEngineering/Solution3.pdf
.
 Could someone please take a look and let me know if my reasoning is sound?

Thanks,
Preethi

From stefika at gmail.com  Thu Aug 18 12:32:24 2011
From: stefika at gmail.com (Andreas Stefik)
Date: Thu, 18 Aug 2011 14:32:24 -0500
Subject: [antlr-interest]  Jasmin/LLVM/other
Message-ID: <CABiHOJkp4X++NsnBwzZ_gES81zNC8E1S5UWyC_HsLoc37NGY5Q@mail.gmail.com>

Hey folks,

I'm teaching a compiler theory course in ANTLR this fall and am trying
to decide what kind of code I want the students to output to by the
end of the course. I have considered something like Jasmin, as it's in
chapter 9 of Terence's book:

http://jasmin.sourceforge.net/

However, I have some concerns that Jasmin isn't well supported any
more, with the last source check-in, it seems, around 6 years ago, and
am considering something like LLVM:

http://llvm.org/

I'm not an expert in either tool, as in the past I've had students
writing something more akin to a VM, so I'll have a bit of a learning
curve myself before we get into that part of the course. Folks have
any recommendations? Does one or the other, or a third alternative,
have a particularly good/nasty (learning curve | documentation |
real-world applicability | other issue)? Any other better supported
Java byte code generators (which might be preferable)?

Stefik

From ssmith at mainstreamdata.com  Thu Aug 18 13:37:47 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Thu, 18 Aug 2011 20:37:47 +0000
Subject: [antlr-interest] Error in Eclipse Plugin
Message-ID: <B29111A755EFB5419E6C7BC998C6E867464D30@hedwig.slc.mainstreamdata.com>

I'm running the latest antlr eclipse plugin (Antlr - http://antlrv3ide.sourceforge.net/updates - eclipse 3.5).  When there's a problem in the grammar, I almost always see the following error message:

ANTLR Parser Generator  Version 3.4.
Using project classpath: No.
Grammar: C:\Users\scotts\workspace3.5\SolrParser\Solr\SolrQuery.g
java.lang.NoSuchFieldError: offendingToken
      at org.deved.antlride.runtime.AntlrErrorListener.extractToken(AntlrErrorListener.java:108)
      at org.deved.antlride.runtime.AntlrErrorListener.report(AntlrErrorListener.java:79)
      at org.deved.antlride.runtime.AntlrErrorListener.message(AntlrErrorListener.java:63)
      at org.deved.antlride.runtime.AntlrErrorListener.error(AntlrErrorListener.java:53)
      at org.antlr.tool.ErrorManager.syntaxError(ErrorManager.java:768)
      at org.antlr.grammar.v3.ANTLRParser.reportError(ANTLRParser.java:443)
      at org.antlr.runtime.BaseRecognizer.recoverFromMismatchedToken(BaseRecognizer.java:613)
      at org.antlr.runtime.BaseRecognizer.match(BaseRecognizer.java:115)
      at org.antlr.grammar.v3.ANTLRParser.grammar_(ANTLRParser.java:707)
      at org.antlr.tool.Grammar.parseAndBuildAST(Grammar.java:644)
      at org.antlr.Tool.getRootGrammar(Tool.java:626)
      at org.antlr.Tool.process(Tool.java:459)
      at org.deved.antlride.runtime.Tool2.main(Tool2.java:24)
BUILD SUCCESSFUL

This has no information about what or where the problem is.  I figured out how to compile the grammar from the command line which gave me a specific error (and told me where the problem was).  I guess I think this is a bug.  Not sure if this is the right place to post it, but I'm not sure where else to post it either.

Scott

From stefika at gmail.com  Thu Aug 18 13:42:06 2011
From: stefika at gmail.com (Andreas Stefik)
Date: Thu, 18 Aug 2011 15:42:06 -0500
Subject: [antlr-interest] Jasmin/LLVM/other
In-Reply-To: <CABiHOJkp4X++NsnBwzZ_gES81zNC8E1S5UWyC_HsLoc37NGY5Q@mail.gmail.com>
References: <CABiHOJkp4X++NsnBwzZ_gES81zNC8E1S5UWyC_HsLoc37NGY5Q@mail.gmail.com>
Message-ID: <CABiHOJkK1fKmTeQz-4cGzpo2CgJJb1WDQpOhEkLo7mjGzOjJUA@mail.gmail.com>

anyone used these:

http://asm.ow2.org/index.html

for example? Seems like a plausible candidate.

Stefik

On Thu, Aug 18, 2011 at 2:32 PM, Andreas Stefik <stefika at gmail.com> wrote:
> Hey folks,
>
> I'm teaching a compiler theory course in ANTLR this fall and am trying
> to decide what kind of code I want the students to output to by the
> end of the course. I have considered something like Jasmin, as it's in
> chapter 9 of Terence's book:
>
> http://jasmin.sourceforge.net/
>
> However, I have some concerns that Jasmin isn't well supported any
> more, with the last source check-in, it seems, around 6 years ago, and
> am considering something like LLVM:
>
> http://llvm.org/
>
> I'm not an expert in either tool, as in the past I've had students
> writing something more akin to a VM, so I'll have a bit of a learning
> curve myself before we get into that part of the course. Folks have
> any recommendations? Does one or the other, or a third alternative,
> have a particularly good/nasty (learning curve | documentation |
> real-world applicability | other issue)? Any other better supported
> Java byte code generators (which might be preferable)?
>
> Stefik
>

From jimi at temporal-wave.com  Thu Aug 18 14:40:03 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 18 Aug 2011 14:40:03 -0700
Subject: [antlr-interest] Jasmin/LLVM/other
In-Reply-To: <CABiHOJkK1fKmTeQz-4cGzpo2CgJJb1WDQpOhEkLo7mjGzOjJUA@mail.gmail.com>
References: <CABiHOJkp4X++NsnBwzZ_gES81zNC8E1S5UWyC_HsLoc37NGY5Q@mail.gmail.com>
	<CABiHOJkK1fKmTeQz-4cGzpo2CgJJb1WDQpOhEkLo7mjGzOjJUA@mail.gmail.com>
Message-ID: <a51b54941fbbc25bd9c37f81428fb29f@mail.gmail.com>

ASM is easily the best .class generator in my mind. LLVM is very
mainstream too and I would recommend either of these as being useful after
you are a student on top.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Andreas Stefik
> Sent: Thursday, August 18, 2011 1:42 PM
> To: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Jasmin/LLVM/other
>
> anyone used these:
>
> http://asm.ow2.org/index.html
>
> for example? Seems like a plausible candidate.
>
> Stefik
>
> On Thu, Aug 18, 2011 at 2:32 PM, Andreas Stefik <stefika at gmail.com>
> wrote:
> > Hey folks,
> >
> > I'm teaching a compiler theory course in ANTLR this fall and am
> trying
> > to decide what kind of code I want the students to output to by the
> > end of the course. I have considered something like Jasmin, as it's
> in
> > chapter 9 of Terence's book:
> >
> > http://jasmin.sourceforge.net/
> >
> > However, I have some concerns that Jasmin isn't well supported any
> > more, with the last source check-in, it seems, around 6 years ago,
> and
> > am considering something like LLVM:
> >
> > http://llvm.org/
> >
> > I'm not an expert in either tool, as in the past I've had students
> > writing something more akin to a VM, so I'll have a bit of a learning
> > curve myself before we get into that part of the course. Folks have
> > any recommendations? Does one or the other, or a third alternative,
> > have a particularly good/nasty (learning curve | documentation |
> > real-world applicability | other issue)? Any other better supported
> > Java byte code generators (which might be preferable)?
> >
> > Stefik
> >
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From stefika at gmail.com  Thu Aug 18 14:55:14 2011
From: stefika at gmail.com (Andreas Stefik)
Date: Thu, 18 Aug 2011 16:55:14 -0500
Subject: [antlr-interest] Jasmin/LLVM/other
In-Reply-To: <a51b54941fbbc25bd9c37f81428fb29f@mail.gmail.com>
References: <CABiHOJkp4X++NsnBwzZ_gES81zNC8E1S5UWyC_HsLoc37NGY5Q@mail.gmail.com>
	<CABiHOJkK1fKmTeQz-4cGzpo2CgJJb1WDQpOhEkLo7mjGzOjJUA@mail.gmail.com>
	<a51b54941fbbc25bd9c37f81428fb29f@mail.gmail.com>
Message-ID: <CABiHOJmsav9t4s+CwyoXr-mpw3GnWL+AUF=SsUg2om_-Gkqi=w@mail.gmail.com>

Cool, thanks Jim. I looked at ASM this afternoon and it seems very
promising. I'm glad to have some confirmation outside myself that it
works pretty well before I dive in.

Stefik

On Thu, Aug 18, 2011 at 4:40 PM, Jim Idle <jimi at temporal-wave.com> wrote:
> ASM is easily the best .class generator in my mind. LLVM is very
> mainstream too and I would recommend either of these as being useful after
> you are a student on top.
>
> Jim
>
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>> bounces at antlr.org] On Behalf Of Andreas Stefik
>> Sent: Thursday, August 18, 2011 1:42 PM
>> To: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] Jasmin/LLVM/other
>>
>> anyone used these:
>>
>> http://asm.ow2.org/index.html
>>
>> for example? Seems like a plausible candidate.
>>
>> Stefik
>>
>> On Thu, Aug 18, 2011 at 2:32 PM, Andreas Stefik <stefika at gmail.com>
>> wrote:
>> > Hey folks,
>> >
>> > I'm teaching a compiler theory course in ANTLR this fall and am
>> trying
>> > to decide what kind of code I want the students to output to by the
>> > end of the course. I have considered something like Jasmin, as it's
>> in
>> > chapter 9 of Terence's book:
>> >
>> > http://jasmin.sourceforge.net/
>> >
>> > However, I have some concerns that Jasmin isn't well supported any
>> > more, with the last source check-in, it seems, around 6 years ago,
>> and
>> > am considering something like LLVM:
>> >
>> > http://llvm.org/
>> >
>> > I'm not an expert in either tool, as in the past I've had students
>> > writing something more akin to a VM, so I'll have a bit of a learning
>> > curve myself before we get into that part of the course. Folks have
>> > any recommendations? Does one or the other, or a third alternative,
>> > have a particularly good/nasty (learning curve | documentation |
>> > real-world applicability | other issue)? Any other better supported
>> > Java byte code generators (which might be preferable)?
>> >
>> > Stefik
>> >
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>> email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From parrt at cs.usfca.edu  Thu Aug 18 17:28:44 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 18 Aug 2011 17:28:44 -0700
Subject: [antlr-interest] Jasmin/LLVM/other
In-Reply-To: <CABiHOJmsav9t4s+CwyoXr-mpw3GnWL+AUF=SsUg2om_-Gkqi=w@mail.gmail.com>
References: <CABiHOJkp4X++NsnBwzZ_gES81zNC8E1S5UWyC_HsLoc37NGY5Q@mail.gmail.com>
	<CABiHOJkK1fKmTeQz-4cGzpo2CgJJb1WDQpOhEkLo7mjGzOjJUA@mail.gmail.com>
	<a51b54941fbbc25bd9c37f81428fb29f@mail.gmail.com>
	<CABiHOJmsav9t4s+CwyoXr-mpw3GnWL+AUF=SsUg2om_-Gkqi=w@mail.gmail.com>
Message-ID: <AB839FBF-0199-433A-B426-59C4CEB27777@cs.usfca.edu>

Hi. Could also look at my antlr llvm example that did not make it into the book:

http://www.antlr.org/wiki/display/ANTLR3/LLVM

Ter
On Aug 18, 2011, at 2:55 PM, Andreas Stefik wrote:

> Cool, thanks Jim. I looked at ASM this afternoon and it seems very
> promising. I'm glad to have some confirmation outside myself that it
> works pretty well before I dive in.
> 
> Stefik
> 
> On Thu, Aug 18, 2011 at 4:40 PM, Jim Idle <jimi at temporal-wave.com> wrote:
>> ASM is easily the best .class generator in my mind. LLVM is very
>> mainstream too and I would recommend either of these as being useful after
>> you are a student on top.
>> 
>> Jim
>> 
>>> -----Original Message-----
>>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>>> bounces at antlr.org] On Behalf Of Andreas Stefik
>>> Sent: Thursday, August 18, 2011 1:42 PM
>>> To: antlr-interest at antlr.org
>>> Subject: Re: [antlr-interest] Jasmin/LLVM/other
>>> 
>>> anyone used these:
>>> 
>>> http://asm.ow2.org/index.html
>>> 
>>> for example? Seems like a plausible candidate.
>>> 
>>> Stefik
>>> 
>>> On Thu, Aug 18, 2011 at 2:32 PM, Andreas Stefik <stefika at gmail.com>
>>> wrote:
>>>> Hey folks,
>>>> 
>>>> I'm teaching a compiler theory course in ANTLR this fall and am
>>> trying
>>>> to decide what kind of code I want the students to output to by the
>>>> end of the course. I have considered something like Jasmin, as it's
>>> in
>>>> chapter 9 of Terence's book:
>>>> 
>>>> http://jasmin.sourceforge.net/
>>>> 
>>>> However, I have some concerns that Jasmin isn't well supported any
>>>> more, with the last source check-in, it seems, around 6 years ago,
>>> and
>>>> am considering something like LLVM:
>>>> 
>>>> http://llvm.org/
>>>> 
>>>> I'm not an expert in either tool, as in the past I've had students
>>>> writing something more akin to a VM, so I'll have a bit of a learning
>>>> curve myself before we get into that part of the course. Folks have
>>>> any recommendations? Does one or the other, or a third alternative,
>>>> have a particularly good/nasty (learning curve | documentation |
>>>> real-world applicability | other issue)? Any other better supported
>>>> Java byte code generators (which might be preferable)?
>>>> 
>>>> Stefik
>>>> 
>>> 
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>>> email-address
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From stefika at gmail.com  Fri Aug 19 05:15:25 2011
From: stefika at gmail.com (Andreas Stefik)
Date: Fri, 19 Aug 2011 07:15:25 -0500
Subject: [antlr-interest] Jasmin/LLVM/other
In-Reply-To: <AB839FBF-0199-433A-B426-59C4CEB27777@cs.usfca.edu>
References: <CABiHOJkp4X++NsnBwzZ_gES81zNC8E1S5UWyC_HsLoc37NGY5Q@mail.gmail.com>
	<CABiHOJkK1fKmTeQz-4cGzpo2CgJJb1WDQpOhEkLo7mjGzOjJUA@mail.gmail.com>
	<a51b54941fbbc25bd9c37f81428fb29f@mail.gmail.com>
	<CABiHOJmsav9t4s+CwyoXr-mpw3GnWL+AUF=SsUg2om_-Gkqi=w@mail.gmail.com>
	<AB839FBF-0199-433A-B426-59C4CEB27777@cs.usfca.edu>
Message-ID: <CABiHOJmo7SVzF50AYO1cbN36bdkePNko9tu-H8ZXuuZrqNKVjg@mail.gmail.com>

Great, thanks guys. This helps,

Stefik

On Thu, Aug 18, 2011 at 7:28 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> Hi. Could also look at my antlr llvm example that did not make it into the book:
>
> http://www.antlr.org/wiki/display/ANTLR3/LLVM
>
> Ter
> On Aug 18, 2011, at 2:55 PM, Andreas Stefik wrote:
>
>> Cool, thanks Jim. I looked at ASM this afternoon and it seems very
>> promising. I'm glad to have some confirmation outside myself that it
>> works pretty well before I dive in.
>>
>> Stefik
>>
>> On Thu, Aug 18, 2011 at 4:40 PM, Jim Idle <jimi at temporal-wave.com> wrote:
>>> ASM is easily the best .class generator in my mind. LLVM is very
>>> mainstream too and I would recommend either of these as being useful after
>>> you are a student on top.
>>>
>>> Jim
>>>
>>>> -----Original Message-----
>>>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>>>> bounces at antlr.org] On Behalf Of Andreas Stefik
>>>> Sent: Thursday, August 18, 2011 1:42 PM
>>>> To: antlr-interest at antlr.org
>>>> Subject: Re: [antlr-interest] Jasmin/LLVM/other
>>>>
>>>> anyone used these:
>>>>
>>>> http://asm.ow2.org/index.html
>>>>
>>>> for example? Seems like a plausible candidate.
>>>>
>>>> Stefik
>>>>
>>>> On Thu, Aug 18, 2011 at 2:32 PM, Andreas Stefik <stefika at gmail.com>
>>>> wrote:
>>>>> Hey folks,
>>>>>
>>>>> I'm teaching a compiler theory course in ANTLR this fall and am
>>>> trying
>>>>> to decide what kind of code I want the students to output to by the
>>>>> end of the course. I have considered something like Jasmin, as it's
>>>> in
>>>>> chapter 9 of Terence's book:
>>>>>
>>>>> http://jasmin.sourceforge.net/
>>>>>
>>>>> However, I have some concerns that Jasmin isn't well supported any
>>>>> more, with the last source check-in, it seems, around 6 years ago,
>>>> and
>>>>> am considering something like LLVM:
>>>>>
>>>>> http://llvm.org/
>>>>>
>>>>> I'm not an expert in either tool, as in the past I've had students
>>>>> writing something more akin to a VM, so I'll have a bit of a learning
>>>>> curve myself before we get into that part of the course. Folks have
>>>>> any recommendations? Does one or the other, or a third alternative,
>>>>> have a particularly good/nasty (learning curve | documentation |
>>>>> real-world applicability | other issue)? Any other better supported
>>>>> Java byte code generators (which might be preferable)?
>>>>>
>>>>> Stefik
>>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>>>> email-address
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From researcher0x00 at gmail.com  Fri Aug 19 06:31:12 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Fri, 19 Aug 2011 09:31:12 -0400
Subject: [antlr-interest] ANTLR IDE,
	Run (Java) selection causing ANTLR Event Listener internal error
Message-ID: <CAN45N12tPFix9ua06yS5HmvYU8rGh4X7JoWxFy12azc2cP0h0Q@mail.gmail.com>

Hi all,

I am writing a document on how to build a working ANTLR environment for a
first time user.

While I am more of a Windows/C# person, this is being done with LINUX and
Eclipse so that it can be distributed for free.

When I try to use the Run (Java) selection for ANTLR IDE
see
http://antlrv3ide.sourceforge.net/doc/gettingstarted/basictutorial/runningantlrgrammars.html

I get a Problem Occurred dialog that reads

'ANTLR Event Listener' has encountered a problem.
An Internal error occurred during: "ANTLR Event Listener".

Details:

   For input string: "false"

By following the documentation at the ANTLR IDE I was able to
compile/interpret the Expr.g grammar without a problem and run it for the
interpreter by clicking on the RUN button. However the RUN button has
another mode of operation where a selection can be made for either Run
(Java) or Debug (Java), and selecting the Run (Java) option is causing the
problem.

Since I have never worked with the ANTLR Event Listener, this bug is
baffling me. I don't know if it is an ANTLR IDE bug or a "ANTLR Event
Listener" problem.

Any help or hints would be appreciated.

Thanks, Eric

From gokul007 at gmail.com  Sat Aug 20 02:27:03 2011
From: gokul007 at gmail.com (Gokulakannan Somasundaram)
Date: Sat, 20 Aug 2011 17:27:03 +0800
Subject: [antlr-interest] gathering any character until specified char
In-Reply-To: <CAGcyXXHq_et5QSNr4ROG+Q1Ree334Z3WkF60f=cZB=QH8m3TSQ@mail.gmail.com>
References: <CAGcyXXESJYdV8B6uJVi+8wgRgS0qeHLV60fhzitcSiu3Lw5AJQ@mail.gmail.com>
	<CAGcyXXHq_et5QSNr4ROG+Q1Ree334Z3WkF60f=cZB=QH8m3TSQ@mail.gmail.com>
Message-ID: <CAHMh4-bg0=vPZF6Tak4dOuPpug1hn5yHNzcOEh2PQqhQkaw3Mg@mail.gmail.com>

Try and check the following steps.
a) Make the WS Token, as above and set $channel = HIDDEN.
b) make until_separator as a token with (~(WS|SEPERATOR))*.
c) Try with the same rule for authors.

On Mon, Aug 15, 2011 at 5:26 PM, Ben Corne <ben.corne at gmail.com> wrote:

> Here's another try:
> authors
> : auth+=until_separator (',' auth+=until_separator)*
>  -> ^(AGAUTHORS $auth)
> ;
>
> until_separator
> : (~SEPARATOR)*
>  ;
>
> SEPARATOR : ',' ;
>
> This results again in empty values.
> Is there an option I need to toggle to make sure the characters get
> accounted for?
>
> 2011/8/14 Ben Corne <ben.corne at gmail.com>
>
> > HI all
> >
> > I'm trying to create a list of any characters but trailing whitespaces
> > separated by comma's.
> > Here are the rules for a specific case where I need this kind of list:
> >
> > authors
> > : (auth+=(.*)) WS* (',' WS* auth+=(.*) WS*)
> >  -> ^(AGAUTHORS $auth)
> > ;
> > WS  :   ( ' '
> >         | '\t'
> >         | '\r'
> >         | '\n'
> >         )
> >     ;
> >
> > Input: Ben Corne ,  An antlr FAN
> > Parse tree should look like this:
> > authors
> > |------------ 'Ben Corne'
> > |------------ WS
> > |------------ ','
> > |------------ WS
> > |------------ 'An antlr FAN'
> >
> > Instead I get one that doesn't seem to gather any character but the ','
> > (tested in debugger)
> > Anyone know what I'm doing wrong here?
> >
> > Kind regards
> > Ben Corne
> >
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From robert.jarzmik at free.fr  Sat Aug 20 05:39:59 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Sat, 20 Aug 2011 14:39:59 +0200
Subject: [antlr-interest] AST build with input tokens out of order
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	<m3r54isg91.fsf@free.fr>
	<CAOrgODaDr5=hMcRvHXrKNtqtQtrKxYZGYiMcY-81-VwEU0eP0A@mail.gmail.com>
Message-ID: <m38vqos1cw.fsf@free.fr>


Hi Bart,

Could I abuse a bit more of your time ?

My initial ordering problem came back because of the order of my rules.

I have this input : STRUCT myvar1, myvar2 ( INTEGER i1; INTEGER j1; )

The tree I'd like to have is :
 #(DECL_VARIABLE 'myVar1' 
   #(STRUCT
     #(DECL_VARIABLE 'i1' INTEGER)
     #(DECL_VARIABLE 'j1' INTEGER)
    )
   )
 #(DECL_VARIABLE 'myVar2' 
   #(STRUCT
     #(DECL_VARIABLE 'i1' INTEGER)
     #(DECL_VARIABLE 'j1' INTEGER)
    )
   )

I have a rule 'structure_members which rewrites '( INTEGER i1; INTEGER j1;
)' into #(STRUCT #(DECL_VARIABLE 'i1' INTEGER) #(DECL_VARIABLE 'j1' INTEGER)).

My problem is the main declaration rule :
declaration
    : STRUCT identifiers[$structure_members.tree] structure_members
      -> ^(DECL_VARIABLE identifiers+ structure_members)

The 'structure_members' are only available after identifiers are parsed, and I
cannot give identifiers the parameter $structure_members.tree as I wished (I get
a forward reference error).

Is there a way to pass the structure_members tree to identifiers rule ?

Cheers.

--

Robert

PS: All the input data I'm using:
  => INPUT = "INTEGER good; STRUCT myvar1, myvar2 ( INTEGER i1; INTEGER j1; )"
  => The example grammar to demonstrate the issue
/******************************************************************************
 * LTR_ex4.g
 ******************************************************************************/
grammar LTR_ex4;

options {
  k=1;
  output=AST;
  ASTLabelType=CommonTree;
}

tokens {
  DIMS; DECL_VARIABLE;
}

translation_unit
	: declaration (';'! declaration)*
	;
    
declaration
	: type_identifier identifiers[$type_identifier.tree]
	-> ^(DECL_VARIABLE identifiers)+
	| STRUCT identifiers[$structure_members.tree] '(' structure_members ')'
	-> ^(DECL_VARIABLE identifiers)
	;

structure_members
	: (declaration ';')+
	-> ^(STRUCT declaration+)
	;
    
identifiers[CommonTree type]
	: IDENTIFIER (',' IDENTIFIER)*
	-> ({type} IDENTIFIER)+
	;

type_identifier
    	:	 'INTEGER'
	;

STRUCT 	:	'STRUCT' ;
IDENTIFIER  :('a'..'z' | '0'..'9')+ ;
WS  :   ( ' ' | '\t'| '\r'| '\n') {$channel=HIDDEN;};

From robert.jarzmik at free.fr  Sat Aug 20 05:40:08 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Sat, 20 Aug 2011 14:40:08 +0200
Subject: [antlr-interest] AST build with input tokens out of order
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	<m3r54isg91.fsf@free.fr>
	<CAOrgODaDr5=hMcRvHXrKNtqtQtrKxYZGYiMcY-81-VwEU0eP0A@mail.gmail.com>
Message-ID: <m37h68s1cn.fsf@free.fr>


Hi Bart,

Could I abuse a bit more of your time ?

My initial ordering problem came back because of the order of my rules.

I have this input : STRUCT myvar1, myvar2 ( INTEGER i1; INTEGER j1; )

The tree I'd like to have is :
 #(DECL_VARIABLE 'myVar1' 
   #(STRUCT
     #(DECL_VARIABLE 'i1' INTEGER)
     #(DECL_VARIABLE 'j1' INTEGER)
    )
   )
 #(DECL_VARIABLE 'myVar2' 
   #(STRUCT
     #(DECL_VARIABLE 'i1' INTEGER)
     #(DECL_VARIABLE 'j1' INTEGER)
    )
   )

I have a rule 'structure_members which rewrites '( INTEGER i1; INTEGER j1;
)' into #(STRUCT #(DECL_VARIABLE 'i1' INTEGER) #(DECL_VARIABLE 'j1' INTEGER)).

My problem is the main declaration rule :
declaration
    : STRUCT identifiers[$structure_members.tree] structure_members
      -> ^(DECL_VARIABLE identifiers+ structure_members)

The 'structure_members' are only available after identifiers are parsed, and I
cannot give identifiers the parameter $structure_members.tree as I wished (I get
a forward reference error).

Is there a way to pass the structure_members tree to identifiers rule ?

Cheers.

--

Robert

PS: All the input data I'm using:
  => INPUT = "INTEGER good; STRUCT myvar1, myvar2 ( INTEGER i1; INTEGER j1; )"
  => The example grammar to demonstrate the issue
/******************************************************************************
 * LTR_ex4.g
 ******************************************************************************/
grammar LTR_ex4;

options {
  k=1;
  output=AST;
  ASTLabelType=CommonTree;
}

tokens {
  DIMS; DECL_VARIABLE;
}

translation_unit
	: declaration (';'! declaration)*
	;
    
declaration
	: type_identifier identifiers[$type_identifier.tree]
	-> ^(DECL_VARIABLE identifiers)+
	| STRUCT identifiers[$structure_members.tree] '(' structure_members ')'
	-> ^(DECL_VARIABLE identifiers)
	;

structure_members
	: (declaration ';')+
	-> ^(STRUCT declaration+)
	;
    
identifiers[CommonTree type]
	: IDENTIFIER (',' IDENTIFIER)*
	-> ({type} IDENTIFIER)+
	;

type_identifier
    	:	 'INTEGER'
	;

STRUCT 	:	'STRUCT' ;
IDENTIFIER  :('a'..'z' | '0'..'9')+ ;
WS  :   ( ' ' | '\t'| '\r'| '\n') {$channel=HIDDEN;};

From todor.dimitrov at stud.uni-due.de  Sat Aug 20 07:39:07 2011
From: todor.dimitrov at stud.uni-due.de (Todor Dimitrov)
Date: Sat, 20 Aug 2011 16:39:07 +0200
Subject: [antlr-interest] Sparql Grammar & Huge C Files
Message-ID: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>

Dear *,

generating the C lexer and parser for the Sparql grammar using the options below produces huge files:

options {
	language = C;
	output = AST;
	ASTLabelType = pANTLR3_BASE_TREE;
}

2.4K Sparql.tokens
85M SparqlLexer.c <---
30K SparqlLexer.h
1.5M SparqlParser.c <---
69K SparqlParser.h

In addition, the files cannot be compiled as it seems that the generators have not been updated to reflect the API changes in the latest C runtime (or maybe it is the other way round :)). In particular, I see errors like these:

SparqlLexer.c:1214276:48: error: member reference type 'pANTLR3_STRING' (aka 'struct ANTLR3_STRING_struct *') is a
      pointer; maybe you meant to use '->'?
                     setText(LEXER->getText(LEXER).substring(1, LEXER->getText(LEXER).length()-1)); 
                             ~~~~~~~~~~~~~~~~~~~~~^
                                                  ->
SparqlLexer.c:1214276:49: error: no member named 'substring' in 'struct ANTLR3_STRING_struct'; did you mean 'subString'?
                     setText(LEXER->getText(LEXER).substring(1, LEXER->getText(LEXER).length()-1)); 
                                                   ^~~~~~~~~
                                                   subString
./antlr3string.h:179:8: note: 'subString' declared here
                                        (*subString)    (struct ANTLR3_STRING_struct * string, ANTLR3_UINT32 ...
                                          ^
SparqlLexer.c:1214276:83: error: member reference type 'pANTLR3_STRING' (aka 'struct ANTLR3_STRING_struct *') is a
      pointer; maybe you meant to use '->'?
                     setText(LEXER->getText(LEXER).substring(1, LEXER->getText(LEXER).length()-1)); 
                                                                ~~~~~~~~~~~~~~~~~~~~~^
                                                                                     ->
SparqlLexer.c:1214276:84: error: no member named 'length' in 'struct ANTLR3_STRING_struct'
                     setText(LEXER->getText(LEXER).substring(1, LEXER->getText(LEXER).length()-1)); 


I'm using antlr 3.4, but I have also tested this with antlr 3.3. Generating the Java lexer and parser works as expected and the files are much smaller:

2.4K Sparql.tokens
582K SparqlLexer.java
876K SparqlParser.java

Any suggestions and help are highly appreciated.

Thanks in advance,

Todor



From jbb at acm.org  Sat Aug 20 07:39:51 2011
From: jbb at acm.org (John B. Brodie)
Date: Sat, 20 Aug 2011 10:39:51 -0400
Subject: [antlr-interest] AST build with input tokens out of order
In-Reply-To: <m37h68s1cn.fsf@free.fr>
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	<m3r54isg91.fsf@free.fr>
	<CAOrgODaDr5=hMcRvHXrKNtqtQtrKxYZGYiMcY-81-VwEU0eP0A@mail.gmail.com>
	<m37h68s1cn.fsf@free.fr>
Message-ID: <1313851191.32017.6.camel@gecko>

Greetings!

Sorry for jumping in...

On Sat, 2011-08-20 at 14:40 +0200, Robert Jarzmik wrote:
> Hi Bart,
> 
> Could I abuse a bit more of your time ?
> 
> My initial ordering problem came back because of the order of my rules.
> 
> I have this input : STRUCT myvar1, myvar2 ( INTEGER i1; INTEGER j1; )
> 
> The tree I'd like to have is :
>  #(DECL_VARIABLE 'myVar1' 
>    #(STRUCT
>      #(DECL_VARIABLE 'i1' INTEGER)
>      #(DECL_VARIABLE 'j1' INTEGER)
>     )
>    )
>  #(DECL_VARIABLE 'myVar2' 
>    #(STRUCT
>      #(DECL_VARIABLE 'i1' INTEGER)
>      #(DECL_VARIABLE 'j1' INTEGER)
>     )
>    )
> 
> I have a rule 'structure_members which rewrites '( INTEGER i1; INTEGER j1;
> )' into #(STRUCT #(DECL_VARIABLE 'i1' INTEGER) #(DECL_VARIABLE 'j1' INTEGER)).
> 
> My problem is the main declaration rule :
> declaration
>     : STRUCT identifiers[$structure_members.tree] structure_members
>       -> ^(DECL_VARIABLE identifiers+ structure_members)
> 
> The 'structure_members' are only available after identifiers are parsed, and I
> cannot give identifiers the parameter $structure_members.tree as I wished (I get
> a forward reference error).
> 
> Is there a way to pass the structure_members tree to identifiers rule ?

i do not think there is 

but you may lift the identifiers rule into the declaration rule so that
all of the elements (e.g. the list of identifiers) are available to the
rewrite meta-operation. so the identifiers rule is deleted and the
declaration rule becomes:

declaration
: type_identifier id+=IDENTIFIER (',' id+=IDENTIFIER)*
   -> ^(DECL_VARIABLE $id type_identifier)+
| STRUCT id+=IDENTIFIER (',' id+=IDENTIFIER)* '(' structure_members ')'
  -> ^(DECL_VARIABLE $id structure_members)+
;

see attached for a complete grammar including test driver that i used to
verify this.

> 
> Cheers.
> 
> --
> 
> Robert
> 
> PS: All the input data I'm using:
>   => INPUT = "INTEGER good; STRUCT myvar1, myvar2 ( INTEGER i1; INTEGER j1; )"
>   => The example grammar to demonstrate the issue
> /******************************************************************************
>  * LTR_ex4.g
>  ******************************************************************************/
> grammar LTR_ex4;
> 
> options {
>   k=1;
>   output=AST;
>   ASTLabelType=CommonTree;
> }
> 
> tokens {
>   DIMS; DECL_VARIABLE;
> }
> 
> translation_unit
> 	: declaration (';'! declaration)*
> 	;
>     
> declaration
> 	: type_identifier identifiers[$type_identifier.tree]
> 	-> ^(DECL_VARIABLE identifiers)+
> 	| STRUCT identifiers[$structure_members.tree] '(' structure_members ')'
> 	-> ^(DECL_VARIABLE identifiers)
> 	;
> 
> structure_members
> 	: (declaration ';')+
> 	-> ^(STRUCT declaration+)
> 	;
>     
> identifiers[CommonTree type]
> 	: IDENTIFIER (',' IDENTIFIER)*
> 	-> ({type} IDENTIFIER)+
> 	;
> 
> type_identifier
>     	:	 'INTEGER'
> 	;
> 
> STRUCT 	:	'STRUCT' ;
> IDENTIFIER  :('a'..'z' | '0'..'9')+ ;
> WS  :   ( ' ' | '\t'| '\r'| '\n') {$channel=HIDDEN;};
> 

-------------- next part --------------
grammar Test;

options {
   output = AST;
   ASTLabelType = CommonTree;
}

tokens {
  DIMS; DECL_VARIABLE;
}

@members {

   // test data - each string in the following array is parsed separately
   private static final String [] x = new String[] {
      "INTEGER v1",
      "INTEGER v1; INTEGER v2",
      "INTEGER v1, v2",
      "STRUCT myvar1 ( INTEGER i1; INTEGER j1; )",
      "STRUCT myvar2 ( INTEGER i1, j1; )",
      "INTEGER v1, v2; STRUCT myvar1, myvar2 ( INTEGER i1; INTEGER j1; )",
      "STRUCT x (STRUCT y (STRUCT z (INTEGER i,j;););)"
   };

   public static void main(String [] args) {
      for( int i = 0; i < x.length; ++i ) {
         try {
            System.out.println("about to parse:`"+x[i]+"`");

            TestLexer lexer = new TestLexer(new ANTLRStringStream(x[i]));
            CommonTokenStream tokens = new CommonTokenStream(lexer);

            // System.out.format("dump of the token stream:\%n");
            // int j = 0;
            // boolean looping = true;
            // while( looping ) {
            //    Token token = lexer.nextToken();
            //    int typ = token.getType();
            //    System.out.format("\%d: type = \%s, text = `\%s`\%s\%n",
            //                      j++,
            //                      typ==EOF?"EOF":tokenNames[typ],
            //                      token.getText(),
            //                      token.getChannel()==HIDDEN?" (HIDDEN)":"");
            //    looping = typ != EOF;
            // }
            // lexer.reset();
            // System.out.format("now performing the parse\n");

            TestParser parser = new TestParser(tokens);
            TestParser.test_return p_result = parser.test();

            CommonTree ast = p_result.tree;
            if( ast == null ) {
               System.out.println("resultant tree: is NULL");
            } else {
               System.out.println("resultant tree: " + ast.toStringTree());
            }
            System.out.println();
         } catch(Exception e) {
            e.printStackTrace();
         }
      }
   }
}

test : translation_unit EOF! ;

translation_unit
        : declaration (';'! declaration)*
        ;
    
declaration
        : type_identifier id+=IDENTIFIER (',' id+=IDENTIFIER)*
        -> ^(DECL_VARIABLE $id type_identifier)+
        | STRUCT id+=IDENTIFIER (',' id+=IDENTIFIER)* '(' structure_members ')'
        -> ^(DECL_VARIABLE $id structure_members)+
        ;

structure_members
        : (declaration ';')+
        -> ^(STRUCT declaration+)
        ;
    
type_identifier
        :        'INTEGER'
        ;

STRUCT  :       'STRUCT' ;
IDENTIFIER  :('a'..'z' | '0'..'9')+ ;
WS  :   ( ' ' | '\t'| '\r'| '\n') {$channel=HIDDEN;};

From gaoshang1999 at 163.com  Sat Aug 20 07:54:16 2011
From: gaoshang1999 at 163.com (gaoshang1999)
Date: Sat, 20 Aug 2011 22:54:16 +0800 (CST)
Subject: [antlr-interest] gathering any character until specified char
In-Reply-To: <CAGcyXXHq_et5QSNr4ROG+Q1Ree334Z3WkF60f=cZB=QH8m3TSQ@mail.gmail.com>
References: <CAGcyXXHq_et5QSNr4ROG+Q1Ree334Z3WkF60f=cZB=QH8m3TSQ@mail.gmail.com>
	<CAGcyXXESJYdV8B6uJVi+8wgRgS0qeHLV60fhzitcSiu3Lw5AJQ@mail.gmail.com>
Message-ID: <48162d7b.1047f.131e7af61ec.Coremail.gaoshang1999@163.com>

Hi  Ben

I do a test  based your problem.  It runs perfectly well.  Here is what I've done.

//begin grammar
grammar Author;

options{
    output = AST;
    ASTLabelType = CommonTree;
}

tokens{
    AUTHORS;
}

authors
: auth+=UNTIL_SEPARATOR (SEPARATOR auth+=UNTIL_SEPARATOR)*
 -> ^(AUTHORS $auth*)
;

WS : (' ' |'\t' |'\r' |'\n' )+ {skip();} ;

SEPARATOR : ',' ;

UNTIL_SEPARATOR
: (~SEPARATOR)*
 ;
//end grammar


Here is a test by using the parser Antlr genereated. The AST is built successfully.

Input : Ben Corne , An antlr FAN, Gao ,  Another antlr FAN
(AUTHORS Ben Corne   An antlr FAN  Gao    Another antlr FAN)

Hope it will be helpful for you.


Best regards
Gao







At 2011-08-15 17:26:05,"Ben Corne" <ben.corne at gmail.com> wrote:
>Here's another try:
>authors
>: auth+=until_separator (',' auth+=until_separator)*
> -> ^(AGAUTHORS $auth)
>;
>
>until_separator
>: (~SEPARATOR)*
> ;
>
>SEPARATOR : ',' ;
>
>This results again in empty values.
>Is there an option I need to toggle to make sure the characters get
>accounted for?
>
>2011/8/14 Ben Corne <ben.corne at gmail.com>
>
>> HI all
>>
>> I'm trying to create a list of any characters but trailing whitespaces
>> separated by comma's.
>> Here are the rules for a specific case where I need this kind of list:
>>
>> authors
>> : (auth+=(.*)) WS* (',' WS* auth+=(.*) WS*)
>>  -> ^(AGAUTHORS $auth)
>> ;
>> WS  :   ( ' '
>>         | '\t'
>>         | '\r'
>>         | '\n'
>>         )
>>     ;
>>
>> Input: Ben Corne ,  An antlr FAN
>> Parse tree should look like this:
>> authors
>> |------------ 'Ben Corne'
>> |------------ WS
>> |------------ ','
>> |------------ WS
>> |------------ 'An antlr FAN'
>>
>> Instead I get one that doesn't seem to gather any character but the ','
>> (tested in debugger)
>> Anyone know what I'm doing wrong here?
>>
>> Kind regards
>> Ben Corne
>>
>
>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jimi at temporal-wave.com  Sat Aug 20 08:19:14 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 20 Aug 2011 08:19:14 -0700
Subject: [antlr-interest] gathering any character until specified char
In-Reply-To: <CAHMh4-bg0=vPZF6Tak4dOuPpug1hn5yHNzcOEh2PQqhQkaw3Mg@mail.gmail.com>
References: <CAGcyXXESJYdV8B6uJVi+8wgRgS0qeHLV60fhzitcSiu3Lw5AJQ@mail.gmail.com>
	<CAGcyXXHq_et5QSNr4ROG+Q1Ree334Z3WkF60f=cZB=QH8m3TSQ@mail.gmail.com>
	<CAHMh4-bg0=vPZF6Tak4dOuPpug1hn5yHNzcOEh2PQqhQkaw3Mg@mail.gmail.com>
Message-ID: <4414df2ebb63b3f335f9c2f2e8fcbf09@mail.gmail.com>

You need $auth+ for a start.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Gokulakannan Somasundaram
> Sent: Saturday, August 20, 2011 2:27 AM
> To: Ben Corne
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] gathering any character until specified
> char
>
> Try and check the following steps.
> a) Make the WS Token, as above and set $channel = HIDDEN.
> b) make until_separator as a token with (~(WS|SEPERATOR))*.
> c) Try with the same rule for authors.
>
> On Mon, Aug 15, 2011 at 5:26 PM, Ben Corne <ben.corne at gmail.com> wrote:
>
> > Here's another try:
> > authors
> > : auth+=until_separator (',' auth+=until_separator)*  -> ^(AGAUTHORS
> > $auth) ;
> >
> > until_separator
> > : (~SEPARATOR)*
> >  ;
> >
> > SEPARATOR : ',' ;
> >
> > This results again in empty values.
> > Is there an option I need to toggle to make sure the characters get
> > accounted for?
> >
> > 2011/8/14 Ben Corne <ben.corne at gmail.com>
> >
> > > HI all
> > >
> > > I'm trying to create a list of any characters but trailing
> > > whitespaces separated by comma's.
> > > Here are the rules for a specific case where I need this kind of
> list:
> > >
> > > authors
> > > : (auth+=(.*)) WS* (',' WS* auth+=(.*) WS*)  -> ^(AGAUTHORS $auth)
> ;
> > > WS  :   ( ' '
> > >         | '\t'
> > >         | '\r'
> > >         | '\n'
> > >         )
> > >     ;
> > >
> > > Input: Ben Corne ,  An antlr FAN
> > > Parse tree should look like this:
> > > authors
> > > |------------ 'Ben Corne'
> > > |------------ WS
> > > |------------ ','
> > > |------------ WS
> > > |------------ 'An antlr FAN'
> > >
> > > Instead I get one that doesn't seem to gather any character but the
> ','
> > > (tested in debugger)
> > > Anyone know what I'm doing wrong here?
> > >
> > > Kind regards
> > > Ben Corne
> > >
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-
> address
> >
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From jimi at temporal-wave.com  Sat Aug 20 08:36:37 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 20 Aug 2011 08:36:37 -0700
Subject: [antlr-interest] Sparql Grammar & Huge C Files
In-Reply-To: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
References: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
Message-ID: <9871c3c56fc3382e0d719fd50a8666a7@mail.gmail.com>

The huge file size occurs because your lexer/parser is probably trying to
do too much or asking ANTLR to do lots of disambiguation and the complex
overlaps are generating huge tables. In the case of the parser, I suspect
that you need some single token predicates to help with keyword
disambiguation; have you removed ALL the warnings that ANTLR generates on
your grammar? If you do not remove all the warnings then this sort of
thing happens a lot. Especially on a terrible language such as SQL has
morphed in to.

The code only LOOKS small in Java because the generated java uses run
length encoded strings for the table values that it must expand at runtime
- the C target lays down the exact same tables, but in static so that it
is set up at compile time. Java is unable to use compile time initialized
tables like this until JDK 1.7, so the Java target must jump through hoops
to generate the tables. So in fact generating the C is a better indicator
of how efficient your grammar is. You can probably trace the table sizes
down to a few key decisions.

Your set text errors are likely that you are not using the SETTEXT macro
correctly in some way. Also, I would avoid doing that at lex time and do
any manipulation if you actually use the token in question. I can't help
unless I see the lexer code in question though.

Use the 3.4 beta C runtime - there is no difference in the release version
except for the API documentation that I keep trying to finish but my boat
keeps winking at me and making me go on the river.


Jim



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Todor Dimitrov
> Sent: Saturday, August 20, 2011 7:39 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Sparql Grammar & Huge C Files
>
> Dear *,
>
> generating the C lexer and parser for the Sparql grammar using the
> options below produces huge files:
>
> options {
> 	language = C;
> 	output = AST;
> 	ASTLabelType = pANTLR3_BASE_TREE;
> }
>
> 2.4K Sparql.tokens
> 85M SparqlLexer.c <---
> 30K SparqlLexer.h
> 1.5M SparqlParser.c <---
> 69K SparqlParser.h
>
> In addition, the files cannot be compiled as it seems that the
> generators have not been updated to reflect the API changes in the
> latest C runtime (or maybe it is the other way round :)). In
> particular, I see errors like these:
>
> SparqlLexer.c:1214276:48: error: member reference type 'pANTLR3_STRING'
> (aka 'struct ANTLR3_STRING_struct *') is a
>       pointer; maybe you meant to use '->'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>                              ~~~~~~~~~~~~~~~~~~~~~^
>                                                   ->
> SparqlLexer.c:1214276:49: error: no member named 'substring' in 'struct
> ANTLR3_STRING_struct'; did you mean 'subString'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>                                                    ^~~~~~~~~
>                                                    subString
> ./antlr3string.h:179:8: note: 'subString' declared here
>                                         (*subString)    (struct
> ANTLR3_STRING_struct * string, ANTLR3_UINT32 ...
>                                           ^
> SparqlLexer.c:1214276:83: error: member reference type 'pANTLR3_STRING'
> (aka 'struct ANTLR3_STRING_struct *') is a
>       pointer; maybe you meant to use '->'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>
> ~~~~~~~~~~~~~~~~~~~~~^
>
> ->
> SparqlLexer.c:1214276:84: error: no member named 'length' in 'struct
> ANTLR3_STRING_struct'
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>
>
> I'm using antlr 3.4, but I have also tested this with antlr 3.3.
> Generating the Java lexer and parser works as expected and the files
> are much smaller:
>
> 2.4K Sparql.tokens
> 582K SparqlLexer.java
> 876K SparqlParser.java
>
> Any suggestions and help are highly appreciated.
>
> Thanks in advance,
>
> Todor
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From jimi at temporal-wave.com  Sat Aug 20 08:44:50 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 20 Aug 2011 08:44:50 -0700
Subject: [antlr-interest] Sparql Grammar & Huge C Files
In-Reply-To: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
References: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
Message-ID: <739b0d76823eec2e6f975f8b9f483104@mail.gmail.com>

Actually I think that you are just generating the lexer that was written
for the Java target by only changing the language= option. You must use
the SETTEXT macro for the C target.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Todor Dimitrov
> Sent: Saturday, August 20, 2011 7:39 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Sparql Grammar & Huge C Files
>
> Dear *,
>
> generating the C lexer and parser for the Sparql grammar using the
> options below produces huge files:
>
> options {
> 	language = C;
> 	output = AST;
> 	ASTLabelType = pANTLR3_BASE_TREE;
> }
>
> 2.4K Sparql.tokens
> 85M SparqlLexer.c <---
> 30K SparqlLexer.h
> 1.5M SparqlParser.c <---
> 69K SparqlParser.h
>
> In addition, the files cannot be compiled as it seems that the
> generators have not been updated to reflect the API changes in the
> latest C runtime (or maybe it is the other way round :)). In
> particular, I see errors like these:
>
> SparqlLexer.c:1214276:48: error: member reference type 'pANTLR3_STRING'
> (aka 'struct ANTLR3_STRING_struct *') is a
>       pointer; maybe you meant to use '->'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>                              ~~~~~~~~~~~~~~~~~~~~~^
>                                                   ->
> SparqlLexer.c:1214276:49: error: no member named 'substring' in 'struct
> ANTLR3_STRING_struct'; did you mean 'subString'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>                                                    ^~~~~~~~~
>                                                    subString
> ./antlr3string.h:179:8: note: 'subString' declared here
>                                         (*subString)    (struct
> ANTLR3_STRING_struct * string, ANTLR3_UINT32 ...
>                                           ^
> SparqlLexer.c:1214276:83: error: member reference type 'pANTLR3_STRING'
> (aka 'struct ANTLR3_STRING_struct *') is a
>       pointer; maybe you meant to use '->'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>
> ~~~~~~~~~~~~~~~~~~~~~^
>
> ->
> SparqlLexer.c:1214276:84: error: no member named 'length' in 'struct
> ANTLR3_STRING_struct'
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>
>
> I'm using antlr 3.4, but I have also tested this with antlr 3.3.
> Generating the Java lexer and parser works as expected and the files
> are much smaller:
>
> 2.4K Sparql.tokens
> 582K SparqlLexer.java
> 876K SparqlParser.java
>
> Any suggestions and help are highly appreciated.
>
> Thanks in advance,
>
> Todor
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From todor.dimitrov at stud.uni-due.de  Sat Aug 20 09:03:58 2011
From: todor.dimitrov at stud.uni-due.de (Todor Dimitrov)
Date: Sat, 20 Aug 2011 18:03:58 +0200
Subject: [antlr-interest] Fwd:  Sparql Grammar & Huge C Files
References: <A8DF15C2-01B3-456E-8285-DC6A610924FB@stud.uni-due.de>
Message-ID: <4D3DC02C-2F39-4EAE-ACC0-CBF80A569D45@stud.uni-due.de>



Begin forwarded message:

> From: Todor Dimitrov <todor.dimitrov at stud.uni-due.de>
> Subject: Re: [antlr-interest] Sparql Grammar & Huge C Files
> Date: August 20, 2011 5:52:33 PM GMT+02:00
> To: Jim Idle <jimi at temporal-wave.com>
> 
> Hi Jim,
> 
> this is an open source grammar for the Sparql language that has not been developed by me. I have run the ANTLR tool like this:
> 
> java -Xms1024m -Xmx1024m -cp antlr-3.4-complete.jar org.antlr.Tool Sparql.g
> 
> No warnings have been outputted and looking at the ANTLR tool options, I don't see any switches that would enable/disable warnings generation. I'm not using the SETTEXT macro and I'm not quite sure where to use it. Are there any examples for it? In addition, the Sparql grammar contains only rewriting rules so I'm not sure whether I have to use the SETTEXT macro. I've attached the grammar file for reference.
> 
> Todor
> 
> 
> On Aug 20, 2011, at 5:36 PM, Jim Idle wrote:
> 
>> The huge file size occurs because your lexer/parser is probably trying to
>> do too much or asking ANTLR to do lots of disambiguation and the complex
>> overlaps are generating huge tables. In the case of the parser, I suspect
>> that you need some single token predicates to help with keyword
>> disambiguation; have you removed ALL the warnings that ANTLR generates on
>> your grammar? If you do not remove all the warnings then this sort of
>> thing happens a lot. Especially on a terrible language such as SQL has
>> morphed in to.
>> 
>> The code only LOOKS small in Java because the generated java uses run
>> length encoded strings for the table values that it must expand at runtime
>> - the C target lays down the exact same tables, but in static so that it
>> is set up at compile time. Java is unable to use compile time initialized
>> tables like this until JDK 1.7, so the Java target must jump through hoops
>> to generate the tables. So in fact generating the C is a better indicator
>> of how efficient your grammar is. You can probably trace the table sizes
>> down to a few key decisions.
>> 
>> Your set text errors are likely that you are not using the SETTEXT macro
>> correctly in some way. Also, I would avoid doing that at lex time and do
>> any manipulation if you actually use the token in question. I can't help
>> unless I see the lexer code in question though.
>> 
>> Use the 3.4 beta C runtime - there is no difference in the release version
>> except for the API documentation that I keep trying to finish but my boat
>> keeps winking at me and making me go on the river.
>> 
>> 
>> Jim
>> 
>> 
>> 
>>> -----Original Message-----
>>> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
>>> bounces at antlr.org] On Behalf Of Todor Dimitrov
>>> Sent: Saturday, August 20, 2011 7:39 AM
>>> To: antlr-interest at antlr.org
>>> Subject: [antlr-interest] Sparql Grammar & Huge C Files
>>> 
>>> Dear *,
>>> 
>>> generating the C lexer and parser for the Sparql grammar using the
>>> options below produces huge files:
>>> 
>>> options {
>>> 	language = C;
>>> 	output = AST;
>>> 	ASTLabelType = pANTLR3_BASE_TREE;
>>> }
>>> 
>>> 2.4K Sparql.tokens
>>> 85M SparqlLexer.c <---
>>> 30K SparqlLexer.h
>>> 1.5M SparqlParser.c <---
>>> 69K SparqlParser.h
>>> 
>>> In addition, the files cannot be compiled as it seems that the
>>> generators have not been updated to reflect the API changes in the
>>> latest C runtime (or maybe it is the other way round :)). In
>>> particular, I see errors like these:
>>> 
>>> SparqlLexer.c:1214276:48: error: member reference type 'pANTLR3_STRING'
>>> (aka 'struct ANTLR3_STRING_struct *') is a
>>>     pointer; maybe you meant to use '->'?
>>>                    setText(LEXER->getText(LEXER).substring(1, LEXER-
>>>> getText(LEXER).length()-1));
>>>                            ~~~~~~~~~~~~~~~~~~~~~^
>>>                                                 ->
>>> SparqlLexer.c:1214276:49: error: no member named 'substring' in 'struct
>>> ANTLR3_STRING_struct'; did you mean 'subString'?
>>>                    setText(LEXER->getText(LEXER).substring(1, LEXER-
>>>> getText(LEXER).length()-1));
>>>                                                  ^~~~~~~~~
>>>                                                  subString
>>> ./antlr3string.h:179:8: note: 'subString' declared here
>>>                                       (*subString)    (struct
>>> ANTLR3_STRING_struct * string, ANTLR3_UINT32 ...
>>>                                         ^
>>> SparqlLexer.c:1214276:83: error: member reference type 'pANTLR3_STRING'
>>> (aka 'struct ANTLR3_STRING_struct *') is a
>>>     pointer; maybe you meant to use '->'?
>>>                    setText(LEXER->getText(LEXER).substring(1, LEXER-
>>>> getText(LEXER).length()-1));
>>> 
>>> ~~~~~~~~~~~~~~~~~~~~~^
>>> 
>>> ->
>>> SparqlLexer.c:1214276:84: error: no member named 'length' in 'struct
>>> ANTLR3_STRING_struct'
>>>                    setText(LEXER->getText(LEXER).substring(1, LEXER-
>>>> getText(LEXER).length()-1));
>>> 
>>> 
>>> I'm using antlr 3.4, but I have also tested this with antlr 3.3.
>>> Generating the Java lexer and parser works as expected and the files
>>> are much smaller:
>>> 
>>> 2.4K Sparql.tokens
>>> 582K SparqlLexer.java
>>> 876K SparqlParser.java
>>> 
>>> Any suggestions and help are highly appreciated.
>>> 
>>> Thanks in advance,
>>> 
>>> Todor
>>> 
>>> 
>>> 
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
>>> email-address
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> 
> 


From jimi at temporal-wave.com  Sat Aug 20 09:13:42 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 20 Aug 2011 09:13:42 -0700
Subject: [antlr-interest] Sparql Grammar & Huge C Files
In-Reply-To: <A8DF15C2-01B3-456E-8285-DC6A610924FB@stud.uni-due.de>
References: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
	<9871c3c56fc3382e0d719fd50a8666a7@mail.gmail.com>
	<A8DF15C2-01B3-456E-8285-DC6A610924FB@stud.uni-due.de>
Message-ID: <03333a079de4eb3dd56608e85a3b834f@mail.gmail.com>

The lexer rules:

BLANK_NODE_LABEL : '_:' t=PN_LOCAL { setText($t.text); };

VAR1 : QUESTION_MARK v=VARNAME { setText($v.text); };

VAR2 : '$' v=VARNAME { setText($v.text); }


Are coded for Java and not C, you cannot simply change the target language
when there is embedded Java code.

All the lexer rules are specified as ('E'|'e' etc, which will generate
bigger tables than the other ways to implement case insensitivity as
explained on the wiki. Also, it has a lot  of rules that it has just left
ANTLR to sort out, which is fair enough, but it is much better to left
factor the rules and change the $type once you know what the token is. For
instance all the numeric rules.

The parser grammar will just work, but it is just naturally a big one. You
might contact the authors about it. There are probably a lot of ways it
could be made more efficient, but as the tables are all static, then it
does not matter that much in C. Look at the size of the data segment once
it is compiled as this is a better indicator than the size of the source
code, which has lots of annotations.

Finally look at the code that it is output, find the decisions that are
generating large decision trees and look at the corresponding rules for
any optimizations. However fix up the SETTEXT and it will just work.

To fix the SETTEXT I would just not do what they are doing but merely
advance the start pointer in the token by 1 or 2 when/if you use it (or
within the lexer code if you must). That is trivial and better
performance. In otherwords just take the setText() actions out altogether.

Don't forget to use antlr.markmail.org


Jim


> -----Original Message-----
> From: Todor Dimitrov [mailto:todor.dimitrov at stud.uni-due.de]
> Sent: Saturday, August 20, 2011 8:53 AM
> To: Jim Idle
> Subject: Re: [antlr-interest] Sparql Grammar & Huge C Files
>
> Hi Jim,
>
> this is an open source grammar for the Sparql language that has not
> been developed by me. I have run the ANTLR tool like this:
>
> java -Xms1024m -Xmx1024m -cp antlr-3.4-complete.jar org.antlr.Tool
> Sparql.g
>
> No warnings have been outputted and looking at the ANTLR tool options,
> I don't see any switches that would enable/disable warnings generation.
> I'm not using the SETTEXT macro and I'm not quite sure where to use it.
> Are there any examples for it? In addition, the Sparql grammar contains
> only rewriting rules so I'm not sure whether I have to use the SETTEXT
> macro. I've attached the grammar file for reference.
>
> Todor

From todor.dimitrov at stud.uni-due.de  Sat Aug 20 10:03:53 2011
From: todor.dimitrov at stud.uni-due.de (Todor Dimitrov)
Date: Sat, 20 Aug 2011 19:03:53 +0200
Subject: [antlr-interest] Sparql Grammar & Huge C Files
In-Reply-To: <03333a079de4eb3dd56608e85a3b834f@mail.gmail.com>
References: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
	<9871c3c56fc3382e0d719fd50a8666a7@mail.gmail.com>
	<A8DF15C2-01B3-456E-8285-DC6A610924FB@stud.uni-due.de>
	<03333a079de4eb3dd56608e85a3b834f@mail.gmail.com>
Message-ID: <2324BEC8-8C7B-41A1-93FD-CB85F50172A3@stud.uni-due.de>

I followed your instructions and successfully compiled the lexer to a static library. The file size of the library is 82M, which is still quite large for my needs. I will try to rewrite/simplify the grammar.

Thank you very much for your support!

Todor



On Aug 20, 2011, at 6:13 PM, Jim Idle wrote:

> The lexer rules:
> 
> BLANK_NODE_LABEL : '_:' t=PN_LOCAL { setText($t.text); };
> 
> VAR1 : QUESTION_MARK v=VARNAME { setText($v.text); };
> 
> VAR2 : '$' v=VARNAME { setText($v.text); }
> 
> 
> Are coded for Java and not C, you cannot simply change the target language
> when there is embedded Java code.
> 
> All the lexer rules are specified as ('E'|'e' etc, which will generate
> bigger tables than the other ways to implement case insensitivity as
> explained on the wiki. Also, it has a lot  of rules that it has just left
> ANTLR to sort out, which is fair enough, but it is much better to left
> factor the rules and change the $type once you know what the token is. For
> instance all the numeric rules.
> 
> The parser grammar will just work, but it is just naturally a big one. You
> might contact the authors about it. There are probably a lot of ways it
> could be made more efficient, but as the tables are all static, then it
> does not matter that much in C. Look at the size of the data segment once
> it is compiled as this is a better indicator than the size of the source
> code, which has lots of annotations.
> 
> Finally look at the code that it is output, find the decisions that are
> generating large decision trees and look at the corresponding rules for
> any optimizations. However fix up the SETTEXT and it will just work.
> 
> To fix the SETTEXT I would just not do what they are doing but merely
> advance the start pointer in the token by 1 or 2 when/if you use it (or
> within the lexer code if you must). That is trivial and better
> performance. In otherwords just take the setText() actions out altogether.
> 
> Don't forget to use antlr.markmail.org
> 
> 
> Jim
> 
> 
>> -----Original Message-----
>> From: Todor Dimitrov [mailto:todor.dimitrov at stud.uni-due.de]
>> Sent: Saturday, August 20, 2011 8:53 AM
>> To: Jim Idle
>> Subject: Re: [antlr-interest] Sparql Grammar & Huge C Files
>> 
>> Hi Jim,
>> 
>> this is an open source grammar for the Sparql language that has not
>> been developed by me. I have run the ANTLR tool like this:
>> 
>> java -Xms1024m -Xmx1024m -cp antlr-3.4-complete.jar org.antlr.Tool
>> Sparql.g
>> 
>> No warnings have been outputted and looking at the ANTLR tool options,
>> I don't see any switches that would enable/disable warnings generation.
>> I'm not using the SETTEXT macro and I'm not quite sure where to use it.
>> Are there any examples for it? In addition, the Sparql grammar contains
>> only rewriting rules so I'm not sure whether I have to use the SETTEXT
>> macro. I've attached the grammar file for reference.
>> 
>> Todor
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 


From jimi at temporal-wave.com  Sat Aug 20 10:13:25 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 20 Aug 2011 10:13:25 -0700
Subject: [antlr-interest] Sparql Grammar & Huge C Files
In-Reply-To: <2324BEC8-8C7B-41A1-93FD-CB85F50172A3@stud.uni-due.de>
References: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
	<9871c3c56fc3382e0d719fd50a8666a7@mail.gmail.com>
	<A8DF15C2-01B3-456E-8285-DC6A610924FB@stud.uni-due.de>
	<03333a079de4eb3dd56608e85a3b834f@mail.gmail.com>
	<2324BEC8-8C7B-41A1-93FD-CB85F50172A3@stud.uni-due.de>
Message-ID: <d8ae4cf1930fcfae2fae5db1605aed4e@mail.gmail.com>

The library may be that big, but look at the load size. It may not be as
big as it looks.

Jim

> -----Original Message-----
> From: Todor Dimitrov [mailto:todor.dimitrov at stud.uni-due.de]
> Sent: Saturday, August 20, 2011 10:04 AM
> To: Jim Idle
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Sparql Grammar & Huge C Files
>
> I followed your instructions and successfully compiled the lexer to a
> static library. The file size of the library is 82M, which is still
> quite large for my needs. I will try to rewrite/simplify the grammar.
>
> Thank you very much for your support!
>
> Todor
>
>
>
> On Aug 20, 2011, at 6:13 PM, Jim Idle wrote:
>
> > The lexer rules:
> >
> > BLANK_NODE_LABEL : '_:' t=PN_LOCAL { setText($t.text); };
> >
> > VAR1 : QUESTION_MARK v=VARNAME { setText($v.text); };
> >
> > VAR2 : '$' v=VARNAME { setText($v.text); }
> >
> >
> > Are coded for Java and not C, you cannot simply change the target
> > language when there is embedded Java code.
> >
> > All the lexer rules are specified as ('E'|'e' etc, which will
> generate
> > bigger tables than the other ways to implement case insensitivity as
> > explained on the wiki. Also, it has a lot  of rules that it has just
> > left ANTLR to sort out, which is fair enough, but it is much better
> to
> > left factor the rules and change the $type once you know what the
> > token is. For instance all the numeric rules.
> >
> > The parser grammar will just work, but it is just naturally a big
> one.
> > You might contact the authors about it. There are probably a lot of
> > ways it could be made more efficient, but as the tables are all
> > static, then it does not matter that much in C. Look at the size of
> > the data segment once it is compiled as this is a better indicator
> > than the size of the source code, which has lots of annotations.
> >
> > Finally look at the code that it is output, find the decisions that
> > are generating large decision trees and look at the corresponding
> > rules for any optimizations. However fix up the SETTEXT and it will
> just work.
> >
> > To fix the SETTEXT I would just not do what they are doing but merely
> > advance the start pointer in the token by 1 or 2 when/if you use it
> > (or within the lexer code if you must). That is trivial and better
> > performance. In otherwords just take the setText() actions out
> altogether.
> >
> > Don't forget to use antlr.markmail.org
> >
> >
> > Jim
> >
> >
> >> -----Original Message-----
> >> From: Todor Dimitrov [mailto:todor.dimitrov at stud.uni-due.de]
> >> Sent: Saturday, August 20, 2011 8:53 AM
> >> To: Jim Idle
> >> Subject: Re: [antlr-interest] Sparql Grammar & Huge C Files
> >>
> >> Hi Jim,
> >>
> >> this is an open source grammar for the Sparql language that has not
> >> been developed by me. I have run the ANTLR tool like this:
> >>
> >> java -Xms1024m -Xmx1024m -cp antlr-3.4-complete.jar org.antlr.Tool
> >> Sparql.g
> >>
> >> No warnings have been outputted and looking at the ANTLR tool
> >> options, I don't see any switches that would enable/disable warnings
> generation.
> >> I'm not using the SETTEXT macro and I'm not quite sure where to use
> it.
> >> Are there any examples for it? In addition, the Sparql grammar
> >> contains only rewriting rules so I'm not sure whether I have to use
> >> the SETTEXT macro. I've attached the grammar file for reference.
> >>
> >> Todor
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-
> address
> >

From jimi at temporal-wave.com  Sat Aug 20 10:21:03 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 20 Aug 2011 10:21:03 -0700
Subject: [antlr-interest] Sparql Grammar & Huge C Files
In-Reply-To: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
References: <C09636F9-29D7-472B-97C8-D8E8611E6085@stud.uni-due.de>
Message-ID: <a14b4d9bb1933f8c470bc057d12dfcd9@mail.gmail.com>

So I looked in to this a bit more. The parser is fine as the C output is
1.5M, but the lexer is terrible and is where all the problems are. I'll
try fixing this up...

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Todor Dimitrov
> Sent: Saturday, August 20, 2011 7:39 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Sparql Grammar & Huge C Files
>
> Dear *,
>
> generating the C lexer and parser for the Sparql grammar using the
> options below produces huge files:
>
> options {
> 	language = C;
> 	output = AST;
> 	ASTLabelType = pANTLR3_BASE_TREE;
> }
>
> 2.4K Sparql.tokens
> 85M SparqlLexer.c <---
> 30K SparqlLexer.h
> 1.5M SparqlParser.c <---
> 69K SparqlParser.h
>
> In addition, the files cannot be compiled as it seems that the
> generators have not been updated to reflect the API changes in the
> latest C runtime (or maybe it is the other way round :)). In
> particular, I see errors like these:
>
> SparqlLexer.c:1214276:48: error: member reference type 'pANTLR3_STRING'
> (aka 'struct ANTLR3_STRING_struct *') is a
>       pointer; maybe you meant to use '->'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>                              ~~~~~~~~~~~~~~~~~~~~~^
>                                                   ->
> SparqlLexer.c:1214276:49: error: no member named 'substring' in 'struct
> ANTLR3_STRING_struct'; did you mean 'subString'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>                                                    ^~~~~~~~~
>                                                    subString
> ./antlr3string.h:179:8: note: 'subString' declared here
>                                         (*subString)    (struct
> ANTLR3_STRING_struct * string, ANTLR3_UINT32 ...
>                                           ^
> SparqlLexer.c:1214276:83: error: member reference type 'pANTLR3_STRING'
> (aka 'struct ANTLR3_STRING_struct *') is a
>       pointer; maybe you meant to use '->'?
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>
> ~~~~~~~~~~~~~~~~~~~~~^
>
> ->
> SparqlLexer.c:1214276:84: error: no member named 'length' in 'struct
> ANTLR3_STRING_struct'
>                      setText(LEXER->getText(LEXER).substring(1, LEXER-
> >getText(LEXER).length()-1));
>
>
> I'm using antlr 3.4, but I have also tested this with antlr 3.3.
> Generating the Java lexer and parser works as expected and the files
> are much smaller:
>
> 2.4K Sparql.tokens
> 582K SparqlLexer.java
> 876K SparqlParser.java
>
> Any suggestions and help are highly appreciated.
>
> Thanks in advance,
>
> Todor
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From robert.jarzmik at free.fr  Sat Aug 20 10:55:03 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Sat, 20 Aug 2011 19:55:03 +0200
Subject: [antlr-interest] AST build with input tokens out of order
In-Reply-To: <1313851191.32017.6.camel@gecko> (John B. Brodie's message of
	"Sat, 20 Aug 2011 10:39:51 -0400")
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	<m3r54isg91.fsf@free.fr>
	<CAOrgODaDr5=hMcRvHXrKNtqtQtrKxYZGYiMcY-81-VwEU0eP0A@mail.gmail.com>
	<m37h68s1cn.fsf@free.fr> <1313851191.32017.6.camel@gecko>
Message-ID: <m34o1cx91k.fsf@free.fr>

"John B. Brodie" <jbb at acm.org> writes:

> Greetings!
>
> Sorry for jumping in...

Hi John, you're most welcome, thanks for your answer.

I had a look at your proposition. It's good for the simple case I gave you, but
the complete problem still eludes me.

The complete input is : 
  STRUCT myvar1,myarr1[maxx,maxy] ( INTEGER i1; INTEGER j2; )

The expected output should be :
#(DECL_VARIABLE 'myvar1' 
  #(STRUCT
    #(DECL_VARIABLE 'i1' INTEGER)
    #(DECL_VARIABLE 'j1' INTEGER)
   )
  )
#(DECL_VARIABLE 'myarr1'
  #(ARRAY
    #(DIMS 'maxx' 'maxy')
    #(STRUCT
      #(DECL_VARIABLE 'i1' INTEGER)
      #(DECL_VARIABLE 'j1' INTEGER)
     )
    )
  )

That was the purpose of passing the type as parameter to "indentifiers", so that
the 'ARRAY' node could have as its second child the type (here the structure).

And that's why I'm still needing a bit help ...

Cheers.

--
Robert

From robert.jarzmik at free.fr  Sat Aug 20 10:55:18 2011
From: robert.jarzmik at free.fr (Robert Jarzmik)
Date: Sat, 20 Aug 2011 19:55:18 +0200
Subject: [antlr-interest] AST build with input tokens out of order
In-Reply-To: <1313851191.32017.6.camel@gecko> (John B. Brodie's message of
	"Sat, 20 Aug 2011 10:39:51 -0400")
References: <m339gzuaix.fsf@free.fr>
	<CAOrgODYfCHGYGPHRxsX7sE7ORF_Rr1Zn3r1oAJEf-DfpNNrj5A@mail.gmail.com>
	<m3r54isg91.fsf@free.fr>
	<CAOrgODaDr5=hMcRvHXrKNtqtQtrKxYZGYiMcY-81-VwEU0eP0A@mail.gmail.com>
	<m37h68s1cn.fsf@free.fr> <1313851191.32017.6.camel@gecko>
Message-ID: <m339gwx915.fsf@free.fr>

"John B. Brodie" <jbb at acm.org> writes:

> Greetings!
>
> Sorry for jumping in...

Hi John, you're most welcome, thanks for your answer.

I had a look at your proposition. It's good for the simple case I gave you, but
the complete problem still eludes me.

The complete input is : 
  STRUCT myvar1,myarr1[maxx,maxy] ( INTEGER i1; INTEGER j2; )

The expected output should be :
#(DECL_VARIABLE 'myvar1' 
  #(STRUCT
    #(DECL_VARIABLE 'i1' INTEGER)
    #(DECL_VARIABLE 'j1' INTEGER)
   )
  )
#(DECL_VARIABLE 'myarr1'
  #(ARRAY
    #(DIMS 'maxx' 'maxy')
    #(STRUCT
      #(DECL_VARIABLE 'i1' INTEGER)
      #(DECL_VARIABLE 'j1' INTEGER)
     )
    )
  )

That was the purpose of passing the type as parameter to "indentifiers", so that
the 'ARRAY' node could have as its second child the type (here the structure).

And that's why I'm still needing a bit of help ...

Cheers.

--
Robert

From swathiv at zinniasystems.com  Sat Aug 20 22:18:00 2011
From: swathiv at zinniasystems.com (Swathi V)
Date: Sun, 21 Aug 2011 10:48:00 +0530
Subject: [antlr-interest] parsing a file
Message-ID: <CAKYno599be07Xcf__BdUMtQgKD2iPqrAF+Es_a8qAUwBD8vV3g@mail.gmail.com>

Hi...
    I have so far used parse trees . But now i have started using ASTs in my
project. Its little new to me.

Problem: i have a huge file. i want to create an AST for certain rules
written and ignore whatever comes in file other than that. how could this be
done?
Can anyone help me out with an example?


Thanking you,

-- 
Regards,
Swathi.V.

From swathiv at zinniasystems.com  Mon Aug 22 04:27:27 2011
From: swathiv at zinniasystems.com (Swathi V)
Date: Mon, 22 Aug 2011 16:57:27 +0530
Subject: [antlr-interest] ignoring the rest of the file other than the rules
	defined
Message-ID: <CAKYno59CxxONfiOKaLg5AHQVhgKkiSuEW=gmYpOuakORsoPuTA@mail.gmail.com>

Would be thankful if anyone helps me out.

Problem :

I have a huge file with certain categories and  properties in those.
Ex:
CATEGORY1(XYZ) {

PROPERTY1 : .....
PROPERTY2 : ....

}

CATEGORY2(XYZ) {

PROPERTY3 : .....
PROPERTY4 : ....

}
......




What i need to do is ...
i need only few categories and in that only few properties. for the rest i
gotta ignore in the file.
i have written
1. lexer
2. parser
 and AST creation for it here
3. to invoke the same.


i have also used
 options { filter = true; }

but i'm able to get the required thing.
Can anyone help me out please... with an example for the above?



Thank You..





-- 
Regards,
Swathi.V.

From david_wynter at yahoo.com  Mon Aug 22 05:13:21 2011
From: david_wynter at yahoo.com (David Wynter)
Date: Mon, 22 Aug 2011 05:13:21 -0700 (PDT)
Subject: [antlr-interest] Noob question on code assist and other helpers
Message-ID: <1314015201.52814.YahooMailNeo@web38005.mail.mud.yahoo.com>

Hi,

New to ANTLR. Can someone point me to a resource that explains how I might achieve the following. My grammar is based on this google query language,?http://code.google.com/apis/base/docs/2.0/query-lang-spec.html

The differences are that I have defined set of codes that go on the left hand side of the matching parts of the expressions, I'd like to have content assist on these keywords. The keywords correlate to table.columns in a relational database. Thus they have a data type associated with each keyword. Therefore it should be possible to do a check on the value entered on the right hand side of any matching expression. Is there?guidance?anywhere on how to achieve these features in the produced parser? I want to implement in Javascript.

Thanks in advance.

David   

From seaside.ki at me.com  Mon Aug 22 15:48:24 2011
From: seaside.ki at me.com (Stefan)
Date: Tue, 23 Aug 2011 00:48:24 +0200
Subject: [antlr-interest] ActionScript runtime in ANTLRWorks still broken?
Message-ID: <5EDCFF2A-0AA8-4E23-B109-7F59E6F36A8F@me.com>

Hi,

since the previous release of ANTLR didn't compile correctly for the ActionScript runtime, I tried the most recent ANTLRWorks build.

Using these options

options {
backtrack = true; 
memoize = true;
k=2;
output = AST;
language=ActionScript;
ASTLabelType = CommonTree;
}

Compiling to Java runtime works fine. Compiling to ActionScript target gives this:

[22:34:10] error(10):  internal error: /***localPath***/Documents/downloads/Php.g : java.lang.NullPointerException
org.antlr.grammar.v3.CodeGenTreeWalker.getTokenElementST(CodeGenTreeWalker.java:290)
org.antlr.grammar.v3.CodeGenTreeWalker.set(CodeGenTreeWalker.java:5709)
org.antlr.grammar.v3.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:5496)
org.antlr.grammar.v3.CodeGenTreeWalker.element(CodeGenTreeWalker.java:3984)
org.antlr.grammar.v3.CodeGenTreeWalker.element(CodeGenTreeWalker.java:3850)
org.antlr.grammar.v3.CodeGenTreeWalker.alternative(CodeGenTreeWalker.java:3756)
org.antlr.grammar.v3.CodeGenTreeWalker.block(CodeGenTreeWalker.java:3128)
org.antlr.grammar.v3.CodeGenTreeWalker.ebnf(CodeGenTreeWalker.java:4816)
org.antlr.grammar.v3.CodeGenTreeWalker.element(CodeGenTreeWalker.java:3970)
org.antlr.grammar.v3.CodeGenTreeWalker.alternative(CodeGenTreeWalker.java:3756)
org.antlr.grammar.v3.CodeGenTreeWalker.block(CodeGenTreeWalker.java:3128)
org.antlr.grammar.v3.CodeGenTreeWalker.rule(CodeGenTreeWalker.java:2382)
org.antlr.grammar.v3.CodeGenTreeWalker.rules(CodeGenTreeWalker.java:1537)
org.antlr.grammar.v3.CodeGenTreeWalker.grammarSpec(CodeGenTreeWalker.java:1441)
org.antlr.grammar.v3.CodeGenTreeWalker.grammar_(CodeGenTreeWalker.java:509)
org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:421)
org.antlr.Tool.generateRecognizer(Tool.java:655)
org.antlr.Tool.process(Tool.java:468)
org.antlr.works.generate.CodeGenerate.generate(CodeGenerate.java:104)
org.antlr.works.generate.CodeGenerate.run(CodeGenerate.java:185)
java.lang.Thread.run(Thread.java:680)

Does anybody know, if the ActionScript target is still out of sync? Or is ActionScript no longer supported?


Kind regards,

Stefan

From miller.garym at gmail.com  Mon Aug 22 18:46:16 2011
From: miller.garym at gmail.com (Gary Miller)
Date: Tue, 23 Aug 2011 11:46:16 +1000
Subject: [antlr-interest] Antlr (& ST) source repository
Message-ID: <CAFCNb3gqgdkJaBH8Ke2qFMivS32bmZtvyYNLK9AHxfJegkY4Bw@mail.gmail.com>

How often is the ANTLR repository pushed to the github repository?

Currently the tools directories last change in the github repository
last seems to be

  April 13, 2011 (https://github.com/antlr/antlr/blob/master/tool/CHANGES.txt)

where as the?http://www.antlr.org/depot/antlr3/main/tool/CHANGES.txt?is

??August 10, 2011

Is there read-only access to the main repository?

Regards
Gary

From bkiers at gmail.com  Tue Aug 23 02:38:56 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Tue, 23 Aug 2011 11:38:56 +0200
Subject: [antlr-interest] ignoring the rest of the file other than the
 rules defined
In-Reply-To: <CAKYno59CxxONfiOKaLg5AHQVhgKkiSuEW=gmYpOuakORsoPuTA@mail.gmail.com>
References: <CAKYno59CxxONfiOKaLg5AHQVhgKkiSuEW=gmYpOuakORsoPuTA@mail.gmail.com>
Message-ID: <CAOrgODZ+tNvc_Oo3RAq2UEwiXxbDZsZRF1ZHEH030UeD_ShUHw@mail.gmail.com>

Could you post your grammar(s) and actual input?
Example input containing .... is not really helpful.

Regards,

Bart.


On Mon, Aug 22, 2011 at 1:27 PM, Swathi V <swathiv at zinniasystems.com> wrote:

> Would be thankful if anyone helps me out.
>
> Problem :
>
> I have a huge file with certain categories and  properties in those.
> Ex:
> CATEGORY1(XYZ) {
>
> PROPERTY1 : .....
> PROPERTY2 : ....
>
> }
>
> CATEGORY2(XYZ) {
>
> PROPERTY3 : .....
> PROPERTY4 : ....
>
> }
> ......
>
>
>
>
> What i need to do is ...
> i need only few categories and in that only few properties. for the rest i
> gotta ignore in the file.
> i have written
> 1. lexer
> 2. parser
>  and AST creation for it here
> 3. to invoke the same.
>
>
> i have also used
>  options { filter = true; }
>
> but i'm able to get the required thing.
> Can anyone help me out please... with an example for the above?
>
>
>
> Thank You..
>
>
>
>
>
> --
> Regards,
> Swathi.V.
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From david_wynter at yahoo.com  Tue Aug 23 02:51:13 2011
From: david_wynter at yahoo.com (David Wynter)
Date: Tue, 23 Aug 2011 02:51:13 -0700 (PDT)
Subject: [antlr-interest] Noob question on code assist and other helpers
In-Reply-To: <1314015201.52814.YahooMailNeo@web38005.mail.mud.yahoo.com>
References: <1314015201.52814.YahooMailNeo@web38005.mail.mud.yahoo.com>
Message-ID: <1314093073.81055.YahooMailNeo@web38005.mail.mud.yahoo.com>

Hi,

Let me rephrase this. Does the book by Terence Parr cover these subjects? I'll buy it if it does.

Thx.

David


________________________________
From: David Wynter <david_wynter at yahoo.com>
To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
Sent: Monday, 22 August 2011, 13:13
Subject: [antlr-interest] Noob question on code assist and other helpers

Hi,

New to ANTLR. Can someone point me to a resource that explains how I might achieve the following. My grammar is based on this google query language,?http://code.google.com/apis/base/docs/2.0/query-lang-spec.html

The differences are that I have defined set of codes that go on the left hand side of the matching parts of the expressions, I'd like to have content assist on these keywords. The keywords correlate to table.columns in a relational database. Thus they have a data type associated with each keyword. Therefore it should be possible to do a check on the value entered on the right hand side of any matching expression. Is there?guidance?anywhere on how to achieve these features in the produced parser? I want to implement in Javascript.

Thanks in advance.

David? 

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From luke_tucker at yahoo.co.uk  Tue Aug 23 03:27:44 2011
From: luke_tucker at yahoo.co.uk (Luke Tucker)
Date: Tue, 23 Aug 2011 11:27:44 +0100 (BST)
Subject: [antlr-interest] ANTLR Parser file different on different machines
	- method to exceed 65535 characters
Message-ID: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>

Hi, first of all, a little bit of background that you might find interesting in terms of what ANTLR is being used for...

I have been using ANTLR to convert a language called STL into JavaScript. This STL language is used to define control procedures for commanding European Space Agency ground station monitoring and control equipment. This is a custom language only used by ESA and is quite quirky in terms of grammar. The existing system is around 15 years old and is being replaced with a new system. These STL procedures are being converted into equivalent in JavaScript which will run in a Rhino engine. My grammar for doing this conversion is more or less complete and the new JavaScripts are successfully commanding ground station equipment running in a simulator. I should also mention that the target language for the grammar is Java and that I am using antlr-3.2.


Now for the problem and the reason for my message...

As part of the build process for the application doing the conversion, ANTLR is run to generate the lexer and parser files from ant before building the Java application. Previously I had been generating the Parser and Lexer in our environment and committing the resulting java files to the repository rather than performing the generation as part of the build. This works perfectly well here on our development machines on a number of different machines and even a virtual machine with a small amount of memory.

Typically however, when we deliver the software to ESA and they try to run the build process on their machines, the Parser file produced is different and the build fails. The reason for the build failure is that "static final String DFA53_specialS" and "static final String DFA53_transitionS" arrays are being produced with a huge number elements, together with a massive switch statement in a "specialStateTransition()" method that is causing the method to exceed 65535 characters.
I have read that this can occur with complex and/or unoptimised grammar and I will be the first to admit that the grammar I have written might not be 100% optimised. Since the parser generation works on our machines and not on ESAs, my limited ANTLR-foo is not the root cause of this problem. I have also confirmed that the version of ANTLR being used is exactly the same.

I have done a lot of searching through the mailing list archives and found a suggestion that using -Xconversiontimeout 100000 as an input to ANTLR might help solve this issue, but that doesn't seem to be helping. Just in case I did this wrong, this is how I used this option to generate the file:

java -Xms1024M -Xmx1024M -jar antlr-3.2.jar -Xconversiontimeout 100000

Is there anything else that might cause a large switch block in specialStateTransition() on one machine and not another with the same grammar/same ANTLR version? Should I get them to try with even higher values for Xconversiontimeout or am I barking up the wrong tree with this?

If necessary I can post the grammar I am using (minus the inline code) and an example of the STL language being parsed, but I don't think that's necessary at this stage. In any case, it will probably hurt your eyes.

Thanks very much in advance for any help.

Luke

From jmurray at aerotech.com  Tue Aug 23 06:57:54 2011
From: jmurray at aerotech.com (Justin Murray)
Date: Tue, 23 Aug 2011 09:57:54 -0400
Subject: [antlr-interest] ANTLR Parser file different on different
	machines - method to exceed 65535 characters
In-Reply-To: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>
References: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>
Message-ID: <6B458D23F5D4A24ABCDB3C78EA97393B02AFFD9D@EXCH-VIRTUAL.aerotechad.com>

Hi Luke,

I may not be the best person to answer, but I do have some suggestions. 
My guess as to why you are seeing different behavior on different 
machines is that the machines probably have different amounts of memory 
available for ANTLR to use. You are requesting 1GB of stack and heap 
each for the JVM, but if you are running on a machine with limited ram 
available, there will be issues.

The reason you are using so much ram and time to generate the parser is 
probably because of some ambiguities in your grammar. Is there a reason 
why you are using ANTLR 3.2 instead of 3.3 or 3.4? There were changes 
made in 3.3 to eliminate the need for ever using -Xconversiontimeout. 
See the Important things to note section on this page: 
http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.3+Release+Notes. You 
should try using -Xwatchconversion to figure out where exactly your 
grammar is getting stuck, and try to find and fix the ambiguity.

Hope that helps,

- Justin

On 8/23/2011 6:27 AM, Luke Tucker wrote:
> Hi, first of all, a little bit of background that you might find interesting in terms of what ANTLR is being used for...
>
> I have been using ANTLR to convert a language called STL into JavaScript. This STL language is used to define control procedures for commanding European Space Agency ground station monitoring and control equipment. This is a custom language only used by ESA and is quite quirky in terms of grammar. The existing system is around 15 years old and is being replaced with a new system. These STL procedures are being converted into equivalent in JavaScript which will run in a Rhino engine. My grammar for doing this conversion is more or less complete and the new JavaScripts are successfully commanding ground station equipment running in a simulator. I should also mention that the target language for the grammar is Java and that I am using antlr-3.2.
>
>
> Now for the problem and the reason for my message...
>
> As part of the build process for the application doing the conversion, ANTLR is run to generate the lexer and parser files from ant before building the Java application. Previously I had been generating the Parser and Lexer in our environment and committing the resulting java files to the repository rather than performing the generation as part of the build. This works perfectly well here on our development machines on a number of different machines and even a virtual machine with a small amount of memory.
>
> Typically however, when we deliver the software to ESA and they try to run the build process on their machines, the Parser file produced is different and the build fails. The reason for the build failure is that "static final String DFA53_specialS" and "static final String DFA53_transitionS" arrays are being produced with a huge number elements, together with a massive switch statement in a "specialStateTransition()" method that is causing the method to exceed 65535 characters.
> I have read that this can occur with complex and/or unoptimised grammar and I will be the first to admit that the grammar I have written might not be 100% optimised. Since the parser generation works on our machines and not on ESAs, my limited ANTLR-foo is not the root cause of this problem. I have also confirmed that the version of ANTLR being used is exactly the same.
>
> I have done a lot of searching through the mailing list archives and found a suggestion that using -Xconversiontimeout 100000 as an input to ANTLR might help solve this issue, but that doesn't seem to be helping. Just in case I did this wrong, this is how I used this option to generate the file:
>
> java -Xms1024M -Xmx1024M -jar antlr-3.2.jar -Xconversiontimeout 100000
>
> Is there anything else that might cause a large switch block in specialStateTransition() on one machine and not another with the same grammar/same ANTLR version? Should I get them to try with even higher values for Xconversiontimeout or am I barking up the wrong tree with this?
>
> If necessary I can post the grammar I am using (minus the inline code) and an example of the STL language being parsed, but I don't think that's necessary at this stage. In any case, it will probably hurt your eyes.
>
> Thanks very much in advance for any help.
>
> Luke
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From luke_tucker at yahoo.co.uk  Tue Aug 23 07:59:30 2011
From: luke_tucker at yahoo.co.uk (Luke Tucker)
Date: Tue, 23 Aug 2011 15:59:30 +0100 (BST)
Subject: [antlr-interest] ANTLR Parser file different on different
	machines - method to exceed 65535 characters
In-Reply-To: <6B458D23F5D4A24ABCDB3C78EA97393B02AFFD9D@EXCH-VIRTUAL.aerotechad.com>
References: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>
	<6B458D23F5D4A24ABCDB3C78EA97393B02AFFD9D@EXCH-VIRTUAL.aerotechad.com>
Message-ID: <1314111570.94783.YahooMailNeo@web27107.mail.ukl.yahoo.com>

Thanks for you response. The good news is that based on your comments, I have now managed to reproduce the problem at least. I ran the generation on a virtual machine with reduced memory and resources and got the same problem.


I will try to use the -Xwatchconversion option to try to identify places where I need to improve the grammar. Am I correct in assuming that this might be related to using predicates with high-level rules? i.e. along the lines of "(expression)=>"


Another possibility is that the STL language I am parsing has case-insensitive keywords therefore instead of setting up tokens the normal way, I have had to set up tokens for keywords in the following format:

PROCEDURE??? :??? ('P'|'p')('R'|'r')('O'|'o')('C'|'c')('E'|'e')('D'|'d')('U'|'u')('R'|'r')('E'|'e');


Could this be adding a lot of extra complexity? If so I would love to find a better way of doing this.

The reason I am using ANTLR 3.2 is that this was the latest version available when development on the project began and now this version has become part of ESA's platform definition for Linux servers. If I can get this changed to ANTLR 3.4, will this work better with reduced memory or will the same thing occur?

Luke



________________________________
From: Justin Murray <jmurray at aerotech.com>
To: antlr-interest at antlr.org
Sent: Tuesday, 23 August 2011, 15:57
Subject: Re: [antlr-interest] ANTLR Parser file different on different machines - method to exceed 65535 characters

Hi Luke,

I may not be the best person to answer, but I do have some suggestions. 
My guess as to why you are seeing different behavior on different 
machines is that the machines probably have different amounts of memory 
available for ANTLR to use. You are requesting 1GB of stack and heap 
each for the JVM, but if you are running on a machine with limited ram 
available, there will be issues.

The reason you are using so much ram and time to generate the parser is 
probably because of some ambiguities in your grammar. Is there a reason 
why you are using ANTLR 3.2 instead of 3.3 or 3.4? There were changes 
made in 3.3 to eliminate the need for ever using -Xconversiontimeout. 
See the Important things to note section on this page: 
http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.3+Release+Notes. You 
should try using -Xwatchconversion to figure out where exactly your 
grammar is getting stuck, and try to find and fix the ambiguity.

Hope that helps,

- Justin

On 8/23/2011 6:27 AM, Luke Tucker wrote:
> Hi, first of all, a little bit of background that you might find interesting in terms of what ANTLR is being used for...
>
> I have been using ANTLR to convert a language called STL into JavaScript. This STL language is used to define control procedures for commanding European Space Agency ground station monitoring and control equipment. This is a custom language only used by ESA and is quite quirky in terms of grammar. The existing system is around 15 years old and is being replaced with a new system. These STL procedures are being converted into equivalent in JavaScript which will run in a Rhino engine. My grammar for doing this conversion is more or less complete and the new JavaScripts are successfully commanding ground station equipment running in a simulator. I should also mention that the target language for the grammar is Java and that I am using antlr-3.2.
>
>
> Now for the problem and the reason for my message...
>
> As part of the build process for the application doing the conversion, ANTLR is run to generate the lexer and parser files from ant before building the Java application. Previously I had been generating the Parser and Lexer in our environment and committing the resulting java files to the repository rather than performing the generation as part of the build. This works perfectly well here on our development machines on a number of different machines and even a virtual machine with a small amount of memory.
>
> Typically however, when we deliver the software to ESA and they try to run the build process on their machines, the Parser file produced is different and the build fails. The reason for the build failure is that "static final String DFA53_specialS" and "static final String DFA53_transitionS" arrays are being produced with a huge number elements, together with a massive switch statement in a "specialStateTransition()" method that is causing the method to exceed 65535 characters.
> I have read that this can occur with complex and/or unoptimised grammar and I will be the first to admit that the grammar I have written might not be 100% optimised. Since the parser generation works on our machines and not on ESAs, my limited ANTLR-foo is not the root cause of this problem. I have also confirmed that the version of ANTLR being used is exactly the same.
>
> I have done a lot of searching through the mailing list archives and found a suggestion that using -Xconversiontimeout 100000 as an input to ANTLR might help solve this issue, but that doesn't seem to be helping. Just in case I did this wrong, this is how I used this option to generate the file:
>
> java -Xms1024M -Xmx1024M -jar antlr-3.2.jar -Xconversiontimeout 100000
>
> Is there anything else that might cause a large switch block in specialStateTransition() on one machine and not another with the same grammar/same ANTLR version? Should I get them to try with even higher values for Xconversiontimeout or am I barking up the wrong tree with this?
>
> If necessary I can post the grammar I am using (minus the inline code) and an example of the STL language being parsed, but I don't think that's necessary at this stage. In any case, it will probably hurt your eyes.
>
> Thanks very much in advance for any help.
>
> Luke
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jmurray at aerotech.com  Tue Aug 23 08:25:15 2011
From: jmurray at aerotech.com (Justin Murray)
Date: Tue, 23 Aug 2011 11:25:15 -0400
Subject: [antlr-interest] ANTLR Parser file different on different
	machines - method to exceed 65535 characters
In-Reply-To: <1314111570.94783.YahooMailNeo@web27107.mail.ukl.yahoo.com>
References: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>
	<6B458D23F5D4A24ABCDB3C78EA97393B02AFFD9D@EXCH-VIRTUAL.aerotechad.com>
	<1314111570.94783.YahooMailNeo@web27107.mail.ukl.yahoo.com>
Message-ID: <6B458D23F5D4A24ABCDB3C78EA97393B02AFFDA0@EXCH-VIRTUAL.aerotechad.com>

I think that your suspicions are correct. Complex predicates lead to 
complex lookahead, and complex keyword matches in the lexer lead to lots 
of function calls. Simplifying these things wherever you can will help. 
Because you are only having this problem with limited resources, it 
means that ANTLR is not getting stuck in an infinite loop at least. Your 
grammar is just very complex and requires lots of time and resources to 
process.

Someone else may be able to give you better advice on how to improve 
your predicates. The short answer is to make them as simple as they can 
be (as few lookahead tokens as are necessary to make the decision).

I can tell you from experience that if the language keywords are 
case-insensitive, there is a far better way than what you are doing. The 
trick is to define the tokens in all uppercase

PROCEDURE : 'PROCEDURE';

Then override the LA() function so that it returns in uppercase as well. 
I've only done this with the C target, so I won't be much help with 
specifics for the Javascript target. I'd suggest searching 
antlr.markmail.org for more info on this: 
http://markmail.org/message/yxjncd3vvew2vplu

- Justin

On 8/23/2011 10:59 AM, Luke Tucker wrote:
> Thanks for you response. The good news is that based on your comments, I have now managed to reproduce the problem at least. I ran the generation on a virtual machine with reduced memory and resources and got the same problem.
>
>
> I will try to use the -Xwatchconversion option to try to identify places where I need to improve the grammar. Am I correct in assuming that this might be related to using predicates with high-level rules? i.e. along the lines of "(expression)=>"
>
>
> Another possibility is that the STL language I am parsing has case-insensitive keywords therefore instead of setting up tokens the normal way, I have had to set up tokens for keywords in the following format:
>
> PROCEDURE    :    ('P'|'p')('R'|'r')('O'|'o')('C'|'c')('E'|'e')('D'|'d')('U'|'u')('R'|'r')('E'|'e');
>
>
> Could this be adding a lot of extra complexity? If so I would love to find a better way of doing this.
>
> The reason I am using ANTLR 3.2 is that this was the latest version available when development on the project began and now this version has become part of ESA's platform definition for Linux servers. If I can get this changed to ANTLR 3.4, will this work better with reduced memory or will the same thing occur?
>
> Luke
>
>
>
> ________________________________
> From: Justin Murray<jmurray at aerotech.com>
> To: antlr-interest at antlr.org
> Sent: Tuesday, 23 August 2011, 15:57
> Subject: Re: [antlr-interest] ANTLR Parser file different on different machines - method to exceed 65535 characters
>
> Hi Luke,
>
> I may not be the best person to answer, but I do have some suggestions.
> My guess as to why you are seeing different behavior on different
> machines is that the machines probably have different amounts of memory
> available for ANTLR to use. You are requesting 1GB of stack and heap
> each for the JVM, but if you are running on a machine with limited ram
> available, there will be issues.
>
> The reason you are using so much ram and time to generate the parser is
> probably because of some ambiguities in your grammar. Is there a reason
> why you are using ANTLR 3.2 instead of 3.3 or 3.4? There were changes
> made in 3.3 to eliminate the need for ever using -Xconversiontimeout.
> See the Important things to note section on this page:
> http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.3+Release+Notes. You
> should try using -Xwatchconversion to figure out where exactly your
> grammar is getting stuck, and try to find and fix the ambiguity.
>
> Hope that helps,
>
> - Justin
>
> On 8/23/2011 6:27 AM, Luke Tucker wrote:
>> Hi, first of all, a little bit of background that you might find interesting in terms of what ANTLR is being used for...
>>
>> I have been using ANTLR to convert a language called STL into JavaScript. This STL language is used to define control procedures for commanding European Space Agency ground station monitoring and control equipment. This is a custom language only used by ESA and is quite quirky in terms of grammar. The existing system is around 15 years old and is being replaced with a new system. These STL procedures are being converted into equivalent in JavaScript which will run in a Rhino engine. My grammar for doing this conversion is more or less complete and the new JavaScripts are successfully commanding ground station equipment running in a simulator. I should also mention that the target language for the grammar is Java and that I am using antlr-3.2.
>>
>>
>> Now for the problem and the reason for my message...
>>
>> As part of the build process for the application doing the conversion, ANTLR is run to generate the lexer and parser files from ant before building the Java application. Previously I had been generating the Parser and Lexer in our environment and committing the resulting java files to the repository rather than performing the generation as part of the build. This works perfectly well here on our development machines on a number of different machines and even a virtual machine with a small amount of memory.
>>
>> Typically however, when we deliver the software to ESA and they try to run the build process on their machines, the Parser file produced is different and the build fails. The reason for the build failure is that "static final String DFA53_specialS" and "static final String DFA53_transitionS" arrays are being produced with a huge number elements, together with a massive switch statement in a "specialStateTransition()" method that is causing the method to exceed 65535 characters.
>> I have read that this can occur with complex and/or unoptimised grammar and I will be the first to admit that the grammar I have written might not be 100% optimised. Since the parser generation works on our machines and not on ESAs, my limited ANTLR-foo is not the root cause of this problem. I have also confirmed that the version of ANTLR being used is exactly the same.
>>
>> I have done a lot of searching through the mailing list archives and found a suggestion that using -Xconversiontimeout 100000 as an input to ANTLR might help solve this issue, but that doesn't seem to be helping. Just in case I did this wrong, this is how I used this option to generate the file:
>>
>> java -Xms1024M -Xmx1024M -jar antlr-3.2.jar -Xconversiontimeout 100000
>>
>> Is there anything else that might cause a large switch block in specialStateTransition() on one machine and not another with the same grammar/same ANTLR version? Should I get them to try with even higher values for Xconversiontimeout or am I barking up the wrong tree with this?
>>
>> If necessary I can post the grammar I am using (minus the inline code) and an example of the STL language being parsed, but I don't think that's necessary at this stage. In any case, it will probably hurt your eyes.
>>
>> Thanks very much in advance for any help.
>>
>> Luke
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From luke_tucker at yahoo.co.uk  Tue Aug 23 08:48:45 2011
From: luke_tucker at yahoo.co.uk (Luke Tucker)
Date: Tue, 23 Aug 2011 16:48:45 +0100 (BST)
Subject: [antlr-interest] ANTLR Parser file different on different
	machines - method to exceed 65535 characters
In-Reply-To: <6B458D23F5D4A24ABCDB3C78EA97393B02AFFDA0@EXCH-VIRTUAL.aerotechad.com>
References: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>
	<6B458D23F5D4A24ABCDB3C78EA97393B02AFFD9D@EXCH-VIRTUAL.aerotechad.com>
	<1314111570.94783.YahooMailNeo@web27107.mail.ukl.yahoo.com>
	<6B458D23F5D4A24ABCDB3C78EA97393B02AFFDA0@EXCH-VIRTUAL.aerotechad.com>
Message-ID: <1314114525.82801.YahooMailNeo@web27101.mail.ukl.yahoo.com>

I have now found the issue. On my machine the lookahead is timing out and not producing the full DFA table, and is therefore not producing the enormous switch statements. When the conversion timeout is sufficiently high, I get the issues with the switch statements.

So the solution is clear, I need to simplify some of my rules. I might be back here with new questions soon :-).

Anyway thanks for your replies, they have been really helpful.

I will look into the LA() function trick when I have a bit more time.

Luke




________________________________
From: Justin Murray <jmurray at aerotech.com>
To: antlr-interest at antlr.org
Sent: Tuesday, 23 August 2011, 17:25
Subject: Re: [antlr-interest] ANTLR Parser file different on different machines - method to exceed 65535 characters

I think that your suspicions are correct. Complex predicates lead to 
complex lookahead, and complex keyword matches in the lexer lead to lots 
of function calls. Simplifying these things wherever you can will help. 
Because you are only having this problem with limited resources, it 
means that ANTLR is not getting stuck in an infinite loop at least. Your 
grammar is just very complex and requires lots of time and resources to 
process.

Someone else may be able to give you better advice on how to improve 
your predicates. The short answer is to make them as simple as they can 
be (as few lookahead tokens as are necessary to make the decision).

I can tell you from experience that if the language keywords are 
case-insensitive, there is a far better way than what you are doing. The 
trick is to define the tokens in all uppercase

PROCEDURE : 'PROCEDURE';

Then override the LA() function so that it returns in uppercase as well. 
I've only done this with the C target, so I won't be much help with 
specifics for the Javascript target. I'd suggest searching 
antlr.markmail.org for more info on this: 
http://markmail.org/message/yxjncd3vvew2vplu

- Justin

On 8/23/2011 10:59 AM, Luke Tucker wrote:
> Thanks for you response. The good news is that based on your comments, I have now managed to reproduce the problem at least. I ran the generation on a virtual machine with reduced memory and resources and got the same problem.
>
>
> I will try to use the -Xwatchconversion option to try to identify places where I need to improve the grammar. Am I correct in assuming that this might be related to using predicates with high-level rules? i.e. along the lines of "(expression)=>"
>
>
> Another possibility is that the STL language I am parsing has case-insensitive keywords therefore instead of setting up tokens the normal way, I have had to set up tokens for keywords in the following format:
>
> PROCEDURE? ? :? ? ('P'|'p')('R'|'r')('O'|'o')('C'|'c')('E'|'e')('D'|'d')('U'|'u')('R'|'r')('E'|'e');
>
>
> Could this be adding a lot of extra complexity? If so I would love to find a better way of doing this.
>
> The reason I am using ANTLR 3.2 is that this was the latest version available when development on the project began and now this version has become part of ESA's platform definition for Linux servers. If I can get this changed to ANTLR 3.4, will this work better with reduced memory or will the same thing occur?
>
> Luke
>
>
>
> ________________________________
> From: Justin Murray<jmurray at aerotech.com>
> To: antlr-interest at antlr.org
> Sent: Tuesday, 23 August 2011, 15:57
> Subject: Re: [antlr-interest] ANTLR Parser file different on different machines - method to exceed 65535 characters
>
> Hi Luke,
>
> I may not be the best person to answer, but I do have some suggestions.
> My guess as to why you are seeing different behavior on different
> machines is that the machines probably have different amounts of memory
> available for ANTLR to use. You are requesting 1GB of stack and heap
> each for the JVM, but if you are running on a machine with limited ram
> available, there will be issues.
>
> The reason you are using so much ram and time to generate the parser is
> probably because of some ambiguities in your grammar. Is there a reason
> why you are using ANTLR 3.2 instead of 3.3 or 3.4? There were changes
> made in 3.3 to eliminate the need for ever using -Xconversiontimeout.
> See the Important things to note section on this page:
> http://www.antlr.org/wiki/display/ANTLR3/ANTLR+3.3+Release+Notes. You
> should try using -Xwatchconversion to figure out where exactly your
> grammar is getting stuck, and try to find and fix the ambiguity.
>
> Hope that helps,
>
> - Justin
>
> On 8/23/2011 6:27 AM, Luke Tucker wrote:
>> Hi, first of all, a little bit of background that you might find interesting in terms of what ANTLR is being used for...
>>
>> I have been using ANTLR to convert a language called STL into JavaScript. This STL language is used to define control procedures for commanding European Space Agency ground station monitoring and control equipment. This is a custom language only used by ESA and is quite quirky in terms of grammar. The existing system is around 15 years old and is being replaced with a new system. These STL procedures are being converted into equivalent in JavaScript which will run in a Rhino engine. My grammar for doing this conversion is more or less complete and the new JavaScripts are successfully commanding ground station equipment running in a simulator. I should also mention that the target language for the grammar is Java and that I am using antlr-3.2.
>>
>>
>> Now for the problem and the reason for my message...
>>
>> As part of the build process for the application doing the conversion, ANTLR is run to generate the lexer and parser files from ant before building the Java application. Previously I had been generating the Parser and Lexer in our environment and committing the resulting java files to the repository rather than performing the generation as part of the build. This works perfectly well here on our development machines on a number of different machines and even a virtual machine with a small amount of memory.
>>
>> Typically however, when we deliver the software to ESA and they try to run the build process on their machines, the Parser file produced is different and the build fails. The reason for the build failure is that "static final String DFA53_specialS" and "static final String DFA53_transitionS" arrays are being produced with a huge number elements, together with a massive switch statement in a "specialStateTransition()" method that is causing the method to exceed 65535 characters.
>> I have read that this can occur with complex and/or unoptimised grammar and I will be the first to admit that the grammar I have written might not be 100% optimised. Since the parser generation works on our machines and not on ESAs, my limited ANTLR-foo is not the root cause of this problem. I have also confirmed that the version of ANTLR being used is exactly the same.
>>
>> I have done a lot of searching through the mailing list archives and found a suggestion that using -Xconversiontimeout 100000 as an input to ANTLR might help solve this issue, but that doesn't seem to be helping. Just in case I did this wrong, this is how I used this option to generate the file:
>>
>> java -Xms1024M -Xmx1024M -jar antlr-3.2.jar -Xconversiontimeout 100000
>>
>> Is there anything else that might cause a large switch block in specialStateTransition() on one machine and not another with the same grammar/same ANTLR version? Should I get them to try with even higher values for Xconversiontimeout or am I barking up the wrong tree with this?
>>
>> If necessary I can post the grammar I am using (minus the inline code) and an example of the STL language being parsed, but I don't think that's necessary at this stage. In any case, it will probably hurt your eyes.
>>
>> Thanks very much in advance for any help.
>>
>> Luke
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From researcher0x00 at gmail.com  Tue Aug 23 09:14:49 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 23 Aug 2011 12:14:49 -0400
Subject: [antlr-interest] Is the -profile option suppose to work with tree
	grammars?
Message-ID: <CAN45N11KZu5ch_Tbg=vbGFHMwj1+QUyq_5acOpuQzOgu3FK-Xg@mail.gmail.com>

>From http://www.antlr.org/download  examples-v3.tar.gz
java/simplecTreeParser I tried

java org.antlr.Tool -profile SiimpleC.g SimpleCWalker.g
javac *.java

and received error

org.antlr.runtime.debug.Profiler can not be applied to (SimpleCWalker)

Is the error correct, did I miss something, or is this a bug?

I did get the profile option to work with the cminus example.

Thanks, Eric

From researcher0x00 at gmail.com  Tue Aug 23 10:23:32 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 23 Aug 2011 13:23:32 -0400
Subject: [antlr-interest] -nfa -dfa command line options not working for
	release 3.4 Jul, 19 2011
Message-ID: <CAN45N12yPkUTWrt38MGzi3Ditrvf_jF3n-J2fEw51YjqMdNzTQ@mail.gmail.com>

Please repost to dev list if needed there.

student at antlr:~/cminus$ java -classpath
/home/student/antlr-3.3-complete.jar  org.antlr.Tool -nfa CMinus.g
student at antlr:~/cminus$ java -classpath
/home/student/antlr-3.4-complete.jar  org.antlr.Tool -nfa CMinus.g
Exception in thread "main" java.lang.ExceptionInInitializerError
 at org.antlr.Tool.generateNFAs(Tool.java:694)
 at org.antlr.Tool.generateRecognizer(Tool.java:651)
 at org.antlr.Tool.process(Tool.java:468)
 at org.antlr.Tool.main(Tool.java:93)
Caused by: java.lang.IllegalArgumentException: No such directory:
org/antlr/tool/templates/dot/dfa
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:73)
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:48)
 at org.antlr.tool.DOTGenerator.<clinit>(DOTGenerator.java:48)
 ... 4 more
student at antlr:~/cminus$ java -classpath
/home/student/antlr-3.4-complete-no-antlrv2.jar  org.antlr.Tool -nfa
CMinus.g
Exception in thread "main" java.lang.ExceptionInInitializerError
 at org.antlr.Tool.generateNFAs(Tool.java:694)
 at org.antlr.Tool.generateRecognizer(Tool.java:651)
 at org.antlr.Tool.process(Tool.java:468)
 at org.antlr.Tool.main(Tool.java:93)
Caused by: java.lang.IllegalArgumentException: No such directory:
org/antlr/tool/templates/dot/dfa
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:73)
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:48)
 at org.antlr.tool.DOTGenerator.<clinit>(DOTGenerator.java:48)
 ... 4 more
student at antlr:~/cminus$ java -classpath
/home/student/antlr-3.3-complete.jar  org.antlr.Tool -dfa CMinus.g
student at antlr:~/cminus$ java -classpath
/home/student/antlr-3.4-complete.jar  org.antlr.Tool -dfa CMinus.g
Exception in thread "main" java.lang.ExceptionInInitializerError
 at org.antlr.Tool.generateDFAs(Tool.java:677)
 at org.antlr.Tool.generateRecognizer(Tool.java:658)
 at org.antlr.Tool.process(Tool.java:468)
 at org.antlr.Tool.main(Tool.java:93)
Caused by: java.lang.IllegalArgumentException: No such directory:
org/antlr/tool/templates/dot/dfa
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:73)
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:48)
 at org.antlr.tool.DOTGenerator.<clinit>(DOTGenerator.java:48)
 ... 4 more
student at antlr:~/cminus$ java -classpath
/home/student/antlr-3.4-complete-no-antlrv2.jar  org.antlr.Tool -dfa
CMinus.g
Exception in thread "main" java.lang.ExceptionInInitializerError
 at org.antlr.Tool.generateDFAs(Tool.java:677)
 at org.antlr.Tool.generateRecognizer(Tool.java:658)
 at org.antlr.Tool.process(Tool.java:468)
 at org.antlr.Tool.main(Tool.java:93)
Caused by: java.lang.IllegalArgumentException: No such directory:
org/antlr/tool/templates/dot/dfa
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:73)
 at org.stringtemplate.v4.STGroupDir.<init>(STGroupDir.java:48)
 at org.antlr.tool.DOTGenerator.<clinit>(DOTGenerator.java:48)
 ... 4 more
student at antlr:~/cminus$

Sorry if this means a new push.

Eric

From jimi at temporal-wave.com  Tue Aug 23 10:24:48 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 23 Aug 2011 10:24:48 -0700
Subject: [antlr-interest] ANTLR Parser file different on different
 machines - method to exceed 65535 characters
In-Reply-To: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>
References: <1314095264.39500.YahooMailNeo@web27105.mail.ukl.yahoo.com>
Message-ID: <30e064a905be60d36e5a8f90d9a9e8af@mail.gmail.com>

Switch to 3.4. The timeout is temporal based, not CPU based and so the
'speed' of your CPU will influence how far the alogorithm gets. In 3.4 the
timeout is not needed so you should get the same result. However, a large
conversion timeout, say 25000 should achieve the same.

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Luke Tucker
> Sent: Tuesday, August 23, 2011 3:28 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] ANTLR Parser file different on different
> machines - method to exceed 65535 characters
>
> Hi, first of all, a little bit of background that you might find
> interesting in terms of what ANTLR is being used for...
>
> I have been using ANTLR to convert a language called STL into
> JavaScript. This STL language is used to define control procedures for
> commanding European Space Agency ground station monitoring and control
> equipment. This is a custom language only used by ESA and is quite
> quirky in terms of grammar. The existing system is around 15 years old
> and is being replaced with a new system. These STL procedures are being
> converted into equivalent in JavaScript which will run in a Rhino
> engine. My grammar for doing this conversion is more or less complete
> and the new JavaScripts are successfully commanding ground station
> equipment running in a simulator. I should also mention that the target
> language for the grammar is Java and that I am using antlr-3.2.
>
>
> Now for the problem and the reason for my message...
>
> As part of the build process for the application doing the conversion,
> ANTLR is run to generate the lexer and parser files from ant before
> building the Java application. Previously I had been generating the
> Parser and Lexer in our environment and committing the resulting java
> files to the repository rather than performing the generation as part
> of the build. This works perfectly well here on our development
> machines on a number of different machines and even a virtual machine
> with a small amount of memory.
>
>
> Typically however, when we deliver the software to ESA and they try to
> run the build process on their machines, the Parser file produced is
> different and the build fails. The reason for the build failure is that
> "static final String DFA53_specialS" and "static final String
> DFA53_transitionS" arrays are being produced with a huge number
> elements, together with a massive switch statement in a
> "specialStateTransition()" method that is causing the method to exceed
> 65535 characters.
> I have read that this can occur with complex and/or unoptimised grammar
> and I will be the first to admit that the grammar I have written might
> not be 100% optimised. Since the parser generation works on our
> machines and not on ESAs, my limited ANTLR-foo is not the root cause of
> this problem. I have also confirmed that the version of ANTLR being
> used is exactly the same.
>
> I have done a lot of searching through the mailing list archives and
> found a suggestion that using -Xconversiontimeout 100000 as an input to
> ANTLR might help solve this issue, but that doesn't seem to be helping.
> Just in case I did this wrong, this is how I used this option to
> generate the file:
>
> java -Xms1024M -Xmx1024M -jar antlr-3.2.jar -Xconversiontimeout 100000
>
> Is there anything else that might cause a large switch block in
> specialStateTransition() on one machine and not another with the same
> grammar/same ANTLR version? Should I get them to try with even higher
> values for Xconversiontimeout or am I barking up the wrong tree with
> this?
>
> If necessary I can post the grammar I am using (minus the inline code)
> and an example of the STL language being parsed, but I don't think
> that's necessary at this stage. In any case, it will probably hurt your
> eyes.
>
> Thanks very much in advance for any help.
>
> Luke
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From ssmith at mainstreamdata.com  Tue Aug 23 14:19:20 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Tue, 23 Aug 2011 21:19:20 +0000
Subject: [antlr-interest] Lexer question
Message-ID: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>

I have a parser that is doing pretty much what I want.  However, I want to do the following.

I have a definition for an IDENTIFIER

IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and NUMBER mean the usual thing

Now in some of my rules, I'm looking for an IDENTIFIER and in one of my rules I look for a NAME.  NAME has exactly the same definition as IDENTIFIER (starts with a letter followed by alphanumerics).  However, you can tell by the token after whether it was a NAME or an IDENTIFIER.  To be more explicit, a NAME is ALWAYS followed by a colon.  An IDENTIFIER can be followed by a number of things, but NEVER by a colon.

So, I have rules that looksomething like:

rule1:
                NAME ':' expression
                ;

rule2:
                IDENTIFIER '+' expression
      |       IDENTIFIER  '-' expression
     ;

I don't seem to be able to make this work.  Can someone suggest a solution?  Do I have to turn on backtracking to make this work?

Thanks

Scott


From jimi at temporal-wave.com  Tue Aug 23 14:54:03 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 23 Aug 2011 14:54:03 -0700
Subject: [antlr-interest] Lexer question
In-Reply-To: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
References: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
Message-ID: <ddf8094d236f97f27f6cac183e347e9e@mail.gmail.com>

fragment NAME : ;
IDENTIFIER : LETTER (LETTER | NUMBER)*
			(
				  ':' { $type = NAME; }
				|
			)
;

However you could just do that in the parser, which would allow better
error reporting I suspect.


Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Scott Smith
> Sent: Tuesday, August 23, 2011 2:19 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Lexer question
>
> I have a parser that is doing pretty much what I want.  However, I want
> to do the following.
>
> I have a definition for an IDENTIFIER
>
> IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and
> NUMBER mean the usual thing
>
> Now in some of my rules, I'm looking for an IDENTIFIER and in one of my
> rules I look for a NAME.  NAME has exactly the same definition as
> IDENTIFIER (starts with a letter followed by alphanumerics).  However,
> you can tell by the token after whether it was a NAME or an IDENTIFIER.
> To be more explicit, a NAME is ALWAYS followed by a colon.  An
> IDENTIFIER can be followed by a number of things, but NEVER by a colon.
>
> So, I have rules that looksomething like:
>
> rule1:
>                 NAME ':' expression
>                 ;
>
> rule2:
>                 IDENTIFIER '+' expression
>       |       IDENTIFIER  '-' expression
>      ;
>
> I don't seem to be able to make this work.  Can someone suggest a
> solution?  Do I have to turn on backtracking to make this work?
>
> Thanks
>
> Scott
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From jbb at acm.org  Tue Aug 23 14:57:40 2011
From: jbb at acm.org (John B. Brodie)
Date: Tue, 23 Aug 2011 17:57:40 -0400
Subject: [antlr-interest] Lexer question
In-Reply-To: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
References: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
Message-ID: <1314136660.18023.1.camel@gecko>

try

rule1: IDENTIFIER ':' expression ;

that is why bother differentiating the two tokens?

On Tue, 2011-08-23 at 21:19 +0000, Scott Smith wrote:
> I have a parser that is doing pretty much what I want.  However, I want to do the following.
> 
> I have a definition for an IDENTIFIER
> 
> IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and NUMBER mean the usual thing
> 
> Now in some of my rules, I'm looking for an IDENTIFIER and in one of my rules I look for a NAME.  NAME has exactly the same definition as IDENTIFIER (starts with a letter followed by alphanumerics).  However, you can tell by the token after whether it was a NAME or an IDENTIFIER.  To be more explicit, a NAME is ALWAYS followed by a colon.  An IDENTIFIER can be followed by a number of things, but NEVER by a colon.
> 
> So, I have rules that looksomething like:
> 
> rule1:
>                 NAME ':' expression
>                 ;
> 
> rule2:
>                 IDENTIFIER '+' expression
>       |       IDENTIFIER  '-' expression
>      ;
> 
> I don't seem to be able to make this work.  Can someone suggest a solution?  Do I have to turn on backtracking to make this work?
> 



From David.Weiler-Thiessen at purina.nestle.com  Tue Aug 23 15:07:05 2011
From: David.Weiler-Thiessen at purina.nestle.com (Weiler-Thiessen, David, SASKATOON,
	Engineering)
Date: Tue, 23 Aug 2011 17:07:05 -0500
Subject: [antlr-interest] Lexer question
In-Reply-To: <1314136660.18023.1.camel@gecko>
References: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
	<1314136660.18023.1.camel@gecko>
Message-ID: <733EAE2B81DE7E46B9021523960043A60126E672@USSTLE0006.nestle.com>

Hi

I was going to suggest the same as what John suggests.

If it matters what type of IDENTIFIER it is, you can capture that in a rewrite rule if your building an AST

rule1:	IDENTIFIER ':' expression -> ^(NAME_ID expression) ;

rule2:
               IDENTIFIER '+' expression -> ^('+' IDENTIFIER expression )
       |       IDENTIFIER  '-' expression -> ^('-' IDENTIFIER expression )
      ;


David Weiler-Thiessen
Nestl? Purina PetCare
phone: 306-933-0232
cell: 306-291-9770

This e-mail, its electronic document attachments, and the contents of its website linkages may contain confidential information. This information is intended solely for use by the individual or entity to whom it is addressed. If you have received this information in error, please notify the sender immediately and promptly destroy the material and any accompanying attachments from your system.


-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of John B. Brodie
Sent: Tuesday, August 23, 2011 3:58 PM
To: Scott Smith
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Lexer question

try

rule1: IDENTIFIER ':' expression ;

that is why bother differentiating the two tokens?

On Tue, 2011-08-23 at 21:19 +0000, Scott Smith wrote:
> I have a parser that is doing pretty much what I want.  However, I want to do the following.
> 
> I have a definition for an IDENTIFIER
> 
> IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and NUMBER mean the usual thing
> 
> Now in some of my rules, I'm looking for an IDENTIFIER and in one of my rules I look for a NAME.  NAME has exactly the same definition as IDENTIFIER (starts with a letter followed by alphanumerics).  However, you can tell by the token after whether it was a NAME or an IDENTIFIER.  To be more explicit, a NAME is ALWAYS followed by a colon.  An IDENTIFIER can be followed by a number of things, but NEVER by a colon.
> 
> So, I have rules that looksomething like:
> 
> rule1:
>                 NAME ':' expression
>                 ;
> 
> rule2:
>                 IDENTIFIER '+' expression
>       |       IDENTIFIER  '-' expression
>      ;
> 
> I don't seem to be able to make this work.  Can someone suggest a solution?  Do I have to turn on backtracking to make this work?
> 



List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Tue Aug 23 15:37:42 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 23 Aug 2011 15:37:42 -0700
Subject: [antlr-interest] Lexer question
In-Reply-To: <1314136660.18023.1.camel@gecko>
References: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
	<1314136660.18023.1.camel@gecko>
Message-ID: <512c0e49c4901649de4b3892b4633573@mail.gmail.com>

Because that allows ID    : as well as ID: so you have to check that the
start position of the ':' is consistent with the end position of ID. I
prefer this approach when an error message such as "A colon for a name
must follow immediately after the name without any whitespace or something
worded better than this" will make more sense than "Syntax error, expected
NAME, found ID"

Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of John B. Brodie
> Sent: Tuesday, August 23, 2011 2:58 PM
> To: Scott Smith
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Lexer question
>
> try
>
> rule1: IDENTIFIER ':' expression ;
>
> that is why bother differentiating the two tokens?
>
> On Tue, 2011-08-23 at 21:19 +0000, Scott Smith wrote:
> > I have a parser that is doing pretty much what I want.  However, I
> want to do the following.
> >
> > I have a definition for an IDENTIFIER
> >
> > IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and
> NUMBER mean the usual thing
> >
> > Now in some of my rules, I'm looking for an IDENTIFIER and in one of
> my rules I look for a NAME.  NAME has exactly the same definition as
> IDENTIFIER (starts with a letter followed by alphanumerics).  However,
> you can tell by the token after whether it was a NAME or an IDENTIFIER.
> To be more explicit, a NAME is ALWAYS followed by a colon.  An
> IDENTIFIER can be followed by a number of things, but NEVER by a colon.
> >
> > So, I have rules that looksomething like:
> >
> > rule1:
> >                 NAME ':' expression
> >                 ;
> >
> > rule2:
> >                 IDENTIFIER '+' expression
> >       |       IDENTIFIER  '-' expression
> >      ;
> >
> > I don't seem to be able to make this work.  Can someone suggest a
> solution?  Do I have to turn on backtracking to make this work?
> >
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From jimi at temporal-wave.com  Tue Aug 23 15:39:44 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 23 Aug 2011 15:39:44 -0700
Subject: [antlr-interest] Lexer question
In-Reply-To: <733EAE2B81DE7E46B9021523960043A60126E672@USSTLE0006.nestle.com>
References: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
	<1314136660.18023.1.camel@gecko>
	<733EAE2B81DE7E46B9021523960043A60126E672@USSTLE0006.nestle.com>
Message-ID: <9ba8f24964775c84b38dcefb38e612cd@mail.gmail.com>

Except that creates look ahead that you should really left factor anyway
and still allows the whitespace and uses literals in the parser that are
difficult to identify in error messages a the token names are made up on
the fly.


Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Weiler-Thiessen, David, SASKATOON,
> Engineering
> Sent: Tuesday, August 23, 2011 3:07 PM
> To: John B. Brodie; Scott Smith
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Lexer question
>
> Hi
>
> I was going to suggest the same as what John suggests.
>
> If it matters what type of IDENTIFIER it is, you can capture that in a
> rewrite rule if your building an AST
>
> rule1:	IDENTIFIER ':' expression -> ^(NAME_ID expression) ;
>
> rule2:
>                IDENTIFIER '+' expression -> ^('+' IDENTIFIER expression
> )
>        |       IDENTIFIER  '-' expression -> ^('-' IDENTIFIER
> expression )
>       ;
>
>
> David Weiler-Thiessen
> Nestl? Purina PetCare
> phone: 306-933-0232
> cell: 306-291-9770
>
> This e-mail, its electronic document attachments, and the contents of
> its website linkages may contain confidential information. This
> information is intended solely for use by the individual or entity to
> whom it is addressed. If you have received this information in error,
> please notify the sender immediately and promptly destroy the material
> and any accompanying attachments from your system.
>
>
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of John B. Brodie
> Sent: Tuesday, August 23, 2011 3:58 PM
> To: Scott Smith
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Lexer question
>
> try
>
> rule1: IDENTIFIER ':' expression ;
>
> that is why bother differentiating the two tokens?
>
> On Tue, 2011-08-23 at 21:19 +0000, Scott Smith wrote:
> > I have a parser that is doing pretty much what I want.  However, I
> want to do the following.
> >
> > I have a definition for an IDENTIFIER
> >
> > IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and
> NUMBER mean the usual thing
> >
> > Now in some of my rules, I'm looking for an IDENTIFIER and in one of
> my rules I look for a NAME.  NAME has exactly the same definition as
> IDENTIFIER (starts with a letter followed by alphanumerics).  However,
> you can tell by the token after whether it was a NAME or an IDENTIFIER.
> To be more explicit, a NAME is ALWAYS followed by a colon.  An
> IDENTIFIER can be followed by a number of things, but NEVER by a colon.
> >
> > So, I have rules that looksomething like:
> >
> > rule1:
> >                 NAME ':' expression
> >                 ;
> >
> > rule2:
> >                 IDENTIFIER '+' expression
> >       |       IDENTIFIER  '-' expression
> >      ;
> >
> > I don't seem to be able to make this work.  Can someone suggest a
> solution?  Do I have to turn on backtracking to make this work?
> >
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From ssmith at mainstreamdata.com  Tue Aug 23 16:22:19 2011
From: ssmith at mainstreamdata.com (Scott Smith)
Date: Tue, 23 Aug 2011 23:22:19 +0000
Subject: [antlr-interest] Lexer question
In-Reply-To: <1314136660.18023.1.camel@gecko>
References: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
	<1314136660.18023.1.camel@gecko>
Message-ID: <B29111A755EFB5419E6C7BC998C6E86746FD38@hedwig.slc.mainstreamdata.com>

That's what I have now.  It does work.  I was just hoping to differentiate it in my tree grammar so I wanted "NAME" to have a different token.

-----Original Message-----
From: John B. Brodie [mailto:jbb at acm.org] 
Sent: Tuesday, August 23, 2011 3:58 PM
To: Scott Smith
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Lexer question

try

rule1: IDENTIFIER ':' expression ;

that is why bother differentiating the two tokens?

On Tue, 2011-08-23 at 21:19 +0000, Scott Smith wrote:
> I have a parser that is doing pretty much what I want.  However, I want to do the following.
> 
> I have a definition for an IDENTIFIER
> 
> IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and NUMBER mean the usual thing
> 
> Now in some of my rules, I'm looking for an IDENTIFIER and in one of my rules I look for a NAME.  NAME has exactly the same definition as IDENTIFIER (starts with a letter followed by alphanumerics).  However, you can tell by the token after whether it was a NAME or an IDENTIFIER.  To be more explicit, a NAME is ALWAYS followed by a colon.  An IDENTIFIER can be followed by a number of things, but NEVER by a colon.
> 
> So, I have rules that looksomething like:
> 
> rule1:
>                 NAME ':' expression
>                 ;
> 
> rule2:
>                 IDENTIFIER '+' expression
>       |       IDENTIFIER  '-' expression
>      ;
> 
> I don't seem to be able to make this work.  Can someone suggest a solution?  Do I have to turn on backtracking to make this work?
> 



From jimi at temporal-wave.com  Tue Aug 23 16:24:29 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 23 Aug 2011 16:24:29 -0700
Subject: [antlr-interest] Lexer question
In-Reply-To: <B29111A755EFB5419E6C7BC998C6E86746FD38@hedwig.slc.mainstreamdata.com>
References: <B29111A755EFB5419E6C7BC998C6E86746F67D@hedwig.slc.mainstreamdata.com>
	<1314136660.18023.1.camel@gecko>
	<B29111A755EFB5419E6C7BC998C6E86746FD38@hedwig.slc.mainstreamdata.com>
Message-ID: <d20a8657d8812595a1496e646ee8f25e@mail.gmail.com>

Change it in the rewrite. I presume that you are OK with

"ABC   :  3 + 4"

Matching that parser rule though?


Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Scott Smith
> Sent: Tuesday, August 23, 2011 4:22 PM
> To: John B. Brodie
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Lexer question
>
> That's what I have now.  It does work.  I was just hoping to
> differentiate it in my tree grammar so I wanted "NAME" to have a
> different token.
>
> -----Original Message-----
> From: John B. Brodie [mailto:jbb at acm.org]
> Sent: Tuesday, August 23, 2011 3:58 PM
> To: Scott Smith
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Lexer question
>
> try
>
> rule1: IDENTIFIER ':' expression ;
>
> that is why bother differentiating the two tokens?
>
> On Tue, 2011-08-23 at 21:19 +0000, Scott Smith wrote:
> > I have a parser that is doing pretty much what I want.  However, I
> want to do the following.
> >
> > I have a definition for an IDENTIFIER
> >
> > IDENTIFIER: LETTER (LETTER | NUMBER)                // LETTER and
> NUMBER mean the usual thing
> >
> > Now in some of my rules, I'm looking for an IDENTIFIER and in one of
> my rules I look for a NAME.  NAME has exactly the same definition as
> IDENTIFIER (starts with a letter followed by alphanumerics).  However,
> you can tell by the token after whether it was a NAME or an IDENTIFIER.
> To be more explicit, a NAME is ALWAYS followed by a colon.  An
> IDENTIFIER can be followed by a number of things, but NEVER by a colon.
> >
> > So, I have rules that looksomething like:
> >
> > rule1:
> >                 NAME ':' expression
> >                 ;
> >
> > rule2:
> >                 IDENTIFIER '+' expression
> >       |       IDENTIFIER  '-' expression
> >      ;
> >
> > I don't seem to be able to make this work.  Can someone suggest a
> solution?  Do I have to turn on backtracking to make this work?
> >
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From researcher0x00 at gmail.com  Wed Aug 24 07:31:16 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Wed, 24 Aug 2011 10:31:16 -0400
Subject: [antlr-interest] Simplifier.g generates invalid Java for release
	3.4 Jul, 19 2001
Message-ID: <CAN45N12unYcX+P2NGgZsbOeNYNBaHmQj9O5xHdtr0Uabv+nuLQ@mail.gmail.com>

Usnig Simplifier.g from http://www.antlr.org/download
*examples-v3.tar.gz*<http://www.antlr.org/download/examples-v3.tar.gz>
java/polydiff


student at antlr:~/polydiff$ java -classpath
/home/student/antlr-3.3-complete.jar org.antlr.Tool
Simplifier.g<Simplifier.gstudent at antlr:~/polydiff$>
student at antlr:~/polydiff$ javac *.java

student at antlr:~/polydiff$ java -classpath
/home/student/antlr-3.4-complete.jar org.antlr.Tool Simplifier.g
student at antlr:~/polydiff$ javac *.java
Simplifier.java:760: illegal start of expression
        void  =null;
        ^
Simplifier.java:797: illegal start of expression
        void  =null;
        ^
Simplifier.java:832: illegal start of expression
        void  =null;
        ^
Simplifier.java:834: illegal start of expression
        void  =null;
        ^
4 errors
student at antlr:~/polydiff$

Sorry, I just hope it helps.

Eric

From researcher0x00 at gmail.com  Wed Aug 24 10:15:33 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Wed, 24 Aug 2011 13:15:33 -0400
Subject: [antlr-interest] Command line option -Xnoprune, what does it do?
Message-ID: <CAN45N13aXkfnwETr_Z_TxnyEET9-f5s2AR+hP+DnxLa+K_rb=A@mail.gmail.com>

In my endeavor to understand all of the ANTLR options I am currently working
on -Xnoprune: do not test EBNF block exit branches.

I did search for an answer using Google, the book, the wiki, markmail, and
nothing of detail was found.

Comparing the parser code with and without the option,  it is apparent that
there are extra test for the lookaheads in certain rules. The extra test set
the value for the switch to a nonexistent case. So without the option these
test are pruned from the code.

>From what I can make of this, these extra test work like asserts to help
validate the input by verifying the lookahead against the computed
lookaheads.

Is this correct?

Thanks, Eric

From kingces95 at gmail.com  Wed Aug 24 12:41:09 2011
From: kingces95 at gmail.com (chris king)
Date: Wed, 24 Aug 2011 12:41:09 -0700
Subject: [antlr-interest] Syntatic Predicate vs Backtracking Optimizations;
 Why are Syntactic Predicates always Evaluated?
Message-ID: <CAJQwtsjh6xDopr-10JNhNtC=MfEukNRiO_ZZzuQqgL9w52-AfQ@mail.gmail.com>

I'm working to resolve a C# grammar ambiguity in my
class_member_declarationrule arising because (1) all members are
prefixed with custom attributes (a
recursive rule) and (2) many productions are prefixed with a type (recursive
due to generics). I could solve the first by left-factoring but that's not
as readable. The second would be a super pain to left-factor. So like the
reference says, I solve these problems using backtracking and syntactic
predicates (Chapter 12). And those techniques do solve the problem.

My issue is with the optimizations. Backtracking optimizes the common case
(no custom attributes, non-generic types) by sticking a DFA in front of the
implicit syntactic predicate so those decisions that can be made via regex
(trained monkey). This is the "Java For-Loop" (p. 300) optimization. However
for the hard case backtracking tries to match the entire rule and some rules
like method_declaration have a body (nested_type_declaration is even worse).
This is the "C Function Definition vs. Declaration" ambiguity and Tar's
advice here is not to use backtracking but instead use a Syntactic Predicate
(p. 303, "Although you could simply turn on the auto-backtracking feature,
that is unnecessarily inefficient because the parser will backtrack over the
entire function body").

So to optimize the hard case I use a syntactic predicate and specify just
the prefix for each class_member_declaration rule necessary to choose that
alternative (again p. 303, "A more efficient approach is to use a manually
specified syntactic predicate that provides the minimum necessary lookahead
to distinguish the first alternative from the second."). That optimizes the
hard case well; I don't match method bodies during backtracking. However now
the common case is slow because explicitly specified syntactic predicates
are always evaluated; no DFA; no trained monkey; (p. 302 "Manually specified
syntactic predicates are always evaluated, but those implicitly added by
auto-backtracking mode are not.").

So now I'm feeling a bit stuck. I got a solution but can only optimize the
common case using backtracking or the hard case (or just slightly less
common) using syntactic predicates. So I guess my question is: *Why are
syntactic predicates are always evaluated when a DFA monkey could have
predicted the alternative? *

Thanks,
Chris

p.s.

To make sure my understanding is correct I have some traces. I share them
here for posterity (i.e. Google). For simplicity I only include
class_member_declaration
rules that are ambiguous because of the leading attribute_section -- not
type which I have restricted to only match non-recursive non-generic types.
My common case input is "const int c = 1;" and my hard case input is
"[Foo]const
int c = 1;". Here is the grammar for the back tracking solution:

public
unattributed_class_member_declaration
  options { backtrack=true; }
  : constant_declaration
  | event_declaration

constant_declaration
  : attribute_section* CONST type constant_declarators SEMI_COLON
  ;

event_declaration
  : attribute_section* EVENT type variable_declarators SEMI_COLON
  ;

attribute_section // is recursive
  options { memoize=true; }
  : OPEN_SQUARE_BRACKET attribute_target_specifier? attribute_list COMMA?
CLOSE_SQUARE_BRACKET
  ;

And here is the trace for the common case (it's optimized in that there are
no invocation of syntactic predicates -- pure DFA monkey).

Enter class_member_declaration 49
[@-1,0:4='const',<31>,1:0]
 Enter constant_declaration 50
[@-1,6:8='int',<108>,1:6]
  Enter type 26
   Enter named_type 27
    Enter named_value_type 29
     Enter named_numeric_type 30
      Enter named_integral_type 31
[@-1,10:10='c',<104>,1:10]
      Leave named_integral_type 31
     Leave named_numeric_type 30
    Leave named_value_type 29
   Leave named_type 27
  Leave type 26
  Enter constant_declarators 52
   Enter constant_declarator 53
[@-1,12:12='=',<58>,1:12]
[@-1,14:14='1',<37>,1:14]
    Enter constant_expression 203
     Enter expression 201
       ...
                      Enter literal 113
                       Enter integer_literal 114
[@-1,15:15=';',<158>,1:15]
                       Leave integer_literal 114
                      Leave literal 113
       ...
     Leave expression 201
    Leave constant_expression 203
   Leave constant_declarator 53
  Leave constant_declarators 52
 Leave constant_declaration 50
Leave class_member_declaration 49

Here is the trace for the hard case (it's unoptimized as the backtracking
syntactic predicate [in yellow] is matching tokens past 'const' [in red]) :

Enter class_member_declaration 49
[@-1,0:0='[',<129>,1:0]
[@-1,1:3='Foo',<104>,1:1]
 Enter synpred1_CSharp_fragment 308
  Enter constant_declaration 50
   Enter attribute_section 292
    Enter attribute_list 295
     Enter attribute 296
      Enter attribute_name 297
       Enter type_name 15
        Enter namespace_or_type_name 16
[@-1,4:4=']',<28>,1:4]
        Leave namespace_or_type_name 16
       Leave type_name 15
      Leave attribute_name 297
     Leave attribute 296
    Leave attribute_list 295
[@-1,5:9='const',<31>,1:5]
   Leave attribute_section 292
[@-1,11:13='int',<108>,1:11]
   Enter type 26
    Enter named_type 27
     Enter named_value_type 29
      Enter named_numeric_type 30
       Enter named_integral_type 31
[@-1,15:15='c',<104>,1:15]
       Leave named_integral_type 31
      Leave named_numeric_type 30
     Leave named_value_type 29
    Leave named_type 27
   Leave type 26
   Enter constant_declarators 52
    Enter constant_declarator 53
[@-1,17:17='=',<58>,1:17]
[@-1,19:19='1',<37>,1:19]
     Enter constant_expression 203
      Enter expression 201
       ...
                       Enter literal 113
                        Enter integer_literal 114
[@-1,20:20=';',<158>,1:20]
                        Leave integer_literal 114
                       Leave literal 113
       ...
   Leave constant_declarators 52
  Leave constant_declaration 50
 Leave synpred1_CSharp_fragment 308

Here is the Syntactic Predicate solution (same as backtracking solution with
the addition of syntactic predicates [yellow]):

public
unattributed_class_member_declaration
  options { backtrack=true; }
  : (attribute_section* constant_modifier* CONST)=> constant_declaration
  | (attribute_section* event_modifier* EVENT)=> event_declaration

constant_declaration
  : attribute_section* CONST type constant_declarators SEMI_COLON
  ;

event_declaration
  : attribute_section* EVENT type variable_declarators SEMI_COLON
  ;

attribute_section // is recursive
  options { memoize=true; }
  : OPEN_SQUARE_BRACKET attribute_target_specifier? attribute_list COMMA?
CLOSE_SQUARE_BRACKET
  ;

Here is the trace for the hard case (now optimized as the syntactic
predicate bails soon after it sees 'const'):

Enter class_member_declaration 49
[@-1,0:0='[',<129>,1:0]
[@-1,1:3='Foo',<104>,1:1]
 Enter synpred1_CSharp_fragment 308
  Enter attribute_section 292
   Enter attribute_list 295
    Enter attribute 296
     Enter attribute_name 297
      Enter type_name 15
       Enter namespace_or_type_name 16
[@-1,4:4=']',<28>,1:4]
       Leave namespace_or_type_name 16
      Leave type_name 15
     Leave attribute_name 297
    Leave attribute 296
   Leave attribute_list 295
[@-1,5:9='const',<31>,1:5]
  Leave attribute_section 292
[@-1,11:13='int',<108>,1:11]
 Leave synpred1_CSharp_fragment 308

And here is the trace for the common case (now unoptimized as a DFA monkey
could have predicted the alternative but instead the syntactic predicate was
invoked):

Enter class_member_declaration 49
[@-1,0:4='const',<31>,1:0]
 Enter synpred1_CSharp_fragment 308
[@-1,6:8='int',<108>,1:6]
 Leave synpred1_CSharp_fragment 308

From jimi at temporal-wave.com  Wed Aug 24 13:03:51 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 24 Aug 2011 13:03:51 -0700
Subject: [antlr-interest] Syntatic Predicate vs Backtracking
 Optimizations; Why are Syntactic Predicates always Evaluated?
In-Reply-To: <CAJQwtsjh6xDopr-10JNhNtC=MfEukNRiO_ZZzuQqgL9w52-AfQ@mail.gmail.com>
References: <CAJQwtsjh6xDopr-10JNhNtC=MfEukNRiO_ZZzuQqgL9w52-AfQ@mail.gmail.com>
Message-ID: <2aeeff2e77c22b0ba0227b833691431e@mail.gmail.com>

The only good way to do this is via left factoring. Left factoring the
common prefixes to declarations is in fact more readable not less. You
also allow ALL the possible types and declarations and then report any
erroneous ones. This all works perfectly in my C# 3.5 grammars for
instance.

C function vs prototyping is best solved by left factoring as is basically
anything else that can be left factored to be honest. All backtracking can
do is try and parser every option in order until one works that it has not
tried before. Some syntactic predicates can be removed by ANTLR but
generally they are not. If you feel that they should be then it would
generally indicate that you can refactor your grammar. Sometimes the
reasons that they are required are for decisions far away.

Generally if you need backtracking or predicates using more than a token
or two or three then you would have a case for refactoring. I have only
used backtracking for a VBScript grammar where because the syntax is very
stupid and it is interpreted, there are some ambiguities that can only be
resolved by pseudo executing it, which is what the backtracking mode fakes
for me.

I know it can be a pain if you have typed in 200 rules and realize that
you now have to refactor, but it is well worth it if you need performance
and good error messages.

I can't comment on your specific cases without seeing the grammar and as I
sell a C# grammar, then it is best I don't see yours ;)


Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of chris king
> Sent: Wednesday, August 24, 2011 12:41 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Syntatic Predicate vs Backtracking
> Optimizations; Why are Syntactic Predicates always Evaluated?
>
> I'm working to resolve a C# grammar ambiguity in my
> class_member_declarationrule arising because (1) all members are
> prefixed with custom attributes (a recursive rule) and (2) many
> productions are prefixed with a type (recursive due to generics). I
> could solve the first by left-factoring but that's not as readable. The
> second would be a super pain to left-factor. So like the reference
> says, I solve these problems using backtracking and syntactic
> predicates (Chapter 12). And those techniques do solve the problem.
>
> My issue is with the optimizations. Backtracking optimizes the common
> case (no custom attributes, non-generic types) by sticking a DFA in
> front of the implicit syntactic predicate so those decisions that can
> be made via regex (trained monkey). This is the "Java For-Loop" (p.
> 300) optimization. However for the hard case backtracking tries to
> match the entire rule and some rules like method_declaration have a
> body (nested_type_declaration is even worse).
> This is the "C Function Definition vs. Declaration" ambiguity and Tar's
> advice here is not to use backtracking but instead use a Syntactic
> Predicate (p. 303, "Although you could simply turn on the auto-
> backtracking feature, that is unnecessarily inefficient because the
> parser will backtrack over the entire function body").
>
> So to optimize the hard case I use a syntactic predicate and specify
> just the prefix for each class_member_declaration rule necessary to
> choose that alternative (again p. 303, "A more efficient approach is to
> use a manually specified syntactic predicate that provides the minimum
> necessary lookahead to distinguish the first alternative from the
> second."). That optimizes the hard case well; I don't match method
> bodies during backtracking. However now the common case is slow because
> explicitly specified syntactic predicates are always evaluated; no DFA;
> no trained monkey; (p. 302 "Manually specified syntactic predicates are
> always evaluated, but those implicitly added by auto-backtracking mode
> are not.").
>
> So now I'm feeling a bit stuck. I got a solution but can only optimize
> the common case using backtracking or the hard case (or just slightly
> less
> common) using syntactic predicates. So I guess my question is: *Why are
> syntactic predicates are always evaluated when a DFA monkey could have
> predicted the alternative? *
>
> Thanks,
> Chris
>
> p.s.
>
> To make sure my understanding is correct I have some traces. I share
> them here for posterity (i.e. Google). For simplicity I only include
> class_member_declaration rules that are ambiguous because of the
> leading attribute_section -- not type which I have restricted to only
> match non-recursive non-generic types.
> My common case input is "const int c = 1;" and my hard case input is
> "[Foo]const int c = 1;". Here is the grammar for the back tracking
> solution:
>
> public
> unattributed_class_member_declaration
>   options { backtrack=true; }
>   : constant_declaration
>   | event_declaration
>
> constant_declaration
>   : attribute_section* CONST type constant_declarators SEMI_COLON
>   ;
>
> event_declaration
>   : attribute_section* EVENT type variable_declarators SEMI_COLON
>   ;
>
> attribute_section // is recursive
>   options { memoize=true; }
>   : OPEN_SQUARE_BRACKET attribute_target_specifier? attribute_list
> COMMA?
> CLOSE_SQUARE_BRACKET
>   ;
>
> And here is the trace for the common case (it's optimized in that there
> are no invocation of syntactic predicates -- pure DFA monkey).
>
> Enter class_member_declaration 49
> [@-1,0:4='const',<31>,1:0]
>  Enter constant_declaration 50
> [@-1,6:8='int',<108>,1:6]
>   Enter type 26
>    Enter named_type 27
>     Enter named_value_type 29
>      Enter named_numeric_type 30
>       Enter named_integral_type 31
> [@-1,10:10='c',<104>,1:10]
>       Leave named_integral_type 31
>      Leave named_numeric_type 30
>     Leave named_value_type 29
>    Leave named_type 27
>   Leave type 26
>   Enter constant_declarators 52
>    Enter constant_declarator 53
> [@-1,12:12='=',<58>,1:12]
> [@-1,14:14='1',<37>,1:14]
>     Enter constant_expression 203
>      Enter expression 201
>        ...
>                       Enter literal 113
>                        Enter integer_literal 114 [@-
> 1,15:15=';',<158>,1:15]
>                        Leave integer_literal 114
>                       Leave literal 113
>        ...
>      Leave expression 201
>     Leave constant_expression 203
>    Leave constant_declarator 53
>   Leave constant_declarators 52
>  Leave constant_declaration 50
> Leave class_member_declaration 49
>
> Here is the trace for the hard case (it's unoptimized as the
> backtracking syntactic predicate [in yellow] is matching tokens past
> 'const' [in red]) :
>
> Enter class_member_declaration 49
> [@-1,0:0='[',<129>,1:0]
> [@-1,1:3='Foo',<104>,1:1]
>  Enter synpred1_CSharp_fragment 308
>   Enter constant_declaration 50
>    Enter attribute_section 292
>     Enter attribute_list 295
>      Enter attribute 296
>       Enter attribute_name 297
>        Enter type_name 15
>         Enter namespace_or_type_name 16
> [@-1,4:4=']',<28>,1:4]
>         Leave namespace_or_type_name 16
>        Leave type_name 15
>       Leave attribute_name 297
>      Leave attribute 296
>     Leave attribute_list 295
> [@-1,5:9='const',<31>,1:5]
>    Leave attribute_section 292
> [@-1,11:13='int',<108>,1:11]
>    Enter type 26
>     Enter named_type 27
>      Enter named_value_type 29
>       Enter named_numeric_type 30
>        Enter named_integral_type 31
> [@-1,15:15='c',<104>,1:15]
>        Leave named_integral_type 31
>       Leave named_numeric_type 30
>      Leave named_value_type 29
>     Leave named_type 27
>    Leave type 26
>    Enter constant_declarators 52
>     Enter constant_declarator 53
> [@-1,17:17='=',<58>,1:17]
> [@-1,19:19='1',<37>,1:19]
>      Enter constant_expression 203
>       Enter expression 201
>        ...
>                        Enter literal 113
>                         Enter integer_literal 114 [@-
> 1,20:20=';',<158>,1:20]
>                         Leave integer_literal 114
>                        Leave literal 113
>        ...
>    Leave constant_declarators 52
>   Leave constant_declaration 50
>  Leave synpred1_CSharp_fragment 308
>
> Here is the Syntactic Predicate solution (same as backtracking solution
> with the addition of syntactic predicates [yellow]):
>
> public
> unattributed_class_member_declaration
>   options { backtrack=true; }
>   : (attribute_section* constant_modifier* CONST)=>
> constant_declaration
>   | (attribute_section* event_modifier* EVENT)=> event_declaration
>
> constant_declaration
>   : attribute_section* CONST type constant_declarators SEMI_COLON
>   ;
>
> event_declaration
>   : attribute_section* EVENT type variable_declarators SEMI_COLON
>   ;
>
> attribute_section // is recursive
>   options { memoize=true; }
>   : OPEN_SQUARE_BRACKET attribute_target_specifier? attribute_list
> COMMA?
> CLOSE_SQUARE_BRACKET
>   ;
>
> Here is the trace for the hard case (now optimized as the syntactic
> predicate bails soon after it sees 'const'):
>
> Enter class_member_declaration 49
> [@-1,0:0='[',<129>,1:0]
> [@-1,1:3='Foo',<104>,1:1]
>  Enter synpred1_CSharp_fragment 308
>   Enter attribute_section 292
>    Enter attribute_list 295
>     Enter attribute 296
>      Enter attribute_name 297
>       Enter type_name 15
>        Enter namespace_or_type_name 16
> [@-1,4:4=']',<28>,1:4]
>        Leave namespace_or_type_name 16
>       Leave type_name 15
>      Leave attribute_name 297
>     Leave attribute 296
>    Leave attribute_list 295
> [@-1,5:9='const',<31>,1:5]
>   Leave attribute_section 292
> [@-1,11:13='int',<108>,1:11]
>  Leave synpred1_CSharp_fragment 308
>
> And here is the trace for the common case (now unoptimized as a DFA
> monkey could have predicted the alternative but instead the syntactic
> predicate was
> invoked):
>
> Enter class_member_declaration 49
> [@-1,0:4='const',<31>,1:0]
>  Enter synpred1_CSharp_fragment 308
> [@-1,6:8='int',<108>,1:6]
>  Leave synpred1_CSharp_fragment 308
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From ramanand_mandayam at yahoo.com  Wed Aug 24 13:36:32 2011
From: ramanand_mandayam at yahoo.com (Ramanand Mandayam)
Date: Wed, 24 Aug 2011 13:36:32 -0700 (PDT)
Subject: [antlr-interest] Antlr v3.3/3.4 documentation hurdles
Message-ID: <1314218192.90259.YahooMailNeo@web160703.mail.bf1.yahoo.com>

I have been using Antlr (and PCCTS before that) for a long time and am very happy with it. However of late I am having difficulties getting information about more recent changes specifically v3.4 released in July. I believe it would help if documentation were easier to get to in a meaningful way.?

(Sorry Terr, I am ***not*** taking a pot shot at you here)



I am not sure if it is just me or others too but I am finding it very difficult to find the root cause of many errors based on the feedback from running the tool. Attempts to navigate online documentation (FAQs, V3 documentation, etc.) all lead to web sites that were apparently last updated in 2008 or 2009 and bear little information for me to understand why my grammar (or my compiler generation command) is generating errors such as:

error(10):? internal error: GTgrammar.g : java.lang.ClassCastException: org.antlr.runtime.tree.CommonTree cannot be cast to org.antlr.tool.GrammarAST

when in fact I am not creating any ASTs (I am using option = template). 


In addition, the same grammar when checked with Antlrworks generates an error about left factoring a rule "Tokens" which I struggled to find out was an "implicit" rule for the lexer. However I do not see any obvious culprits and the line number provided by the tool is line 1 which is the first line in my grammar file.
Any suggestions, pointers, or clues where to look to? I have Terr's book but that only matches v 2.7.

Cheers

Ramanand

From researcher0x00 at gmail.com  Wed Aug 24 15:37:20 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Wed, 24 Aug 2011 18:37:20 -0400
Subject: [antlr-interest] -Xgrtree not working in 3.4 Jul, 19 2001
In-Reply-To: <91839034-C2E6-4EDE-A2CF-D85B43610957@cs.usfca.edu>
References: <CAN45N11-Rr-DZ17QiiKyHPbReYHwKMeGURXwFL861k2b+4nbcw@mail.gmail.com>
	<91839034-C2E6-4EDE-A2CF-D85B43610957@cs.usfca.edu>
Message-ID: <CAN45N13r=CD9X3Ab+7fcOe+XR+9E8_i_Qx6BJV+bs=0cphxYYQ@mail.gmail.com>

Ter,

No problem, no rush. I am actually glad they are getting queued up.

Again, thank you and all the others that make ANTLR such a great and free
tool.

Eric

From researcher0x00 at gmail.com  Wed Aug 24 16:35:20 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Wed, 24 Aug 2011 19:35:20 -0400
Subject: [antlr-interest] Antlr v3.3/3.4 documentation hurdles
In-Reply-To: <1314218192.90259.YahooMailNeo@web160703.mail.bf1.yahoo.com>
References: <1314218192.90259.YahooMailNeo@web160703.mail.bf1.yahoo.com>
Message-ID: <CAN45N11vSobNKdhY-KGyDazNJAXEPm5O9+DwuWq-FHbPzMbg0Q@mail.gmail.com>

Hi Ramanand,

Any suggestions, pointers, or clues where to look to?

My last option when all others have been exhausted is to just compile a
version of ANTLR with the source code, not the jar, and start debugging.
Even though I prefer the C# version I have worked in the Java version to
hunt down the root cause. It's worth the trouble because of what is learned.


Eric

From christian_benjamin.ries at fh-bielefeld.de  Thu Aug 25 02:48:53 2011
From: christian_benjamin.ries at fh-bielefeld.de (Christian Benjamin Ries)
Date: Thu, 25 Aug 2011 11:48:53 +0200
Subject: [antlr-interest] AST within Qt's QTreeWidget?
Message-ID: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>

Hello,

could you give me some information how I can display an AST within a QTreeWidget?

Suggestions, links, already running implementations would be perfect!

I use the C-target for my work.

Cheers, Christian

From s.barnett-cormack at lancaster.ac.uk  Thu Aug 25 03:31:47 2011
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 25 Aug 2011 11:31:47 +0100
Subject: [antlr-interest] AST within Qt's QTreeWidget?
In-Reply-To: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>
References: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>
Message-ID: <4E562493.8040707@lancaster.ac.uk>

On 25/08/2011 10:48, Christian Benjamin Ries wrote:
> Hello,
>
> could you give me some information how I can display an AST within a
> QTreeWidget?
>
> Suggestions, links, already running implementations would be
> perfect!
>
> I use the C-target for my work.

I can't say anything specific, but I can say that I've done a similar
use-case (in Java, and not an ANTLR AST but a different tree structure)
just by making use of the adapter pattern, wrapping the tree in a class
that provides the functions expected by the GUI and delegating to the
'real' tree.

Sam

From christian_benjamin.ries at fh-bielefeld.de  Thu Aug 25 03:40:01 2011
From: christian_benjamin.ries at fh-bielefeld.de (Christian Benjamin Ries)
Date: Thu, 25 Aug 2011 12:40:01 +0200
Subject: [antlr-interest] AST within Qt's QTreeWidget?
In-Reply-To: <4E562493.8040707@lancaster.ac.uk>
References: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>
	<4E562493.8040707@lancaster.ac.uk>
Message-ID: <9487_1314268802_ZZh0z0m_AYu4S.00_4E562681.4020400@fh-bielefeld.de>

A similar approach is in my mind, in Qt I would spezialize
  - QStandardItemModel
  - QStandardItem
to do this, as a wrapper or copy. During weekend I will try this.

@Ivan,
I recognized some collisions with Qt and ANTLR, "emit" is used in both and this is reserved by Qt, 
just we know. Could you share your approach?

Christian

Am 25/08/11 12:31, schrieb Sam Barnett-Cormack:
> On 25/08/2011 10:48, Christian Benjamin Ries wrote:
>> Hello,
>>
>> could you give me some information how I can display an AST within a
>> QTreeWidget?
>>
>> Suggestions, links, already running implementations would be
>> perfect!
>>
>> I use the C-target for my work.
>
> I can't say anything specific, but I can say that I've done a similar
> use-case (in Java, and not an ANTLR AST but a different tree structure)
> just by making use of the adapter pattern, wrapping the tree in a class
> that provides the functions expected by the GUI and delegating to the
> 'real' tree.
>
> Sam


From contact at maik-schmidt.de  Thu Aug 25 04:28:11 2011
From: contact at maik-schmidt.de (Maik Schmidt)
Date: Thu, 25 Aug 2011 13:28:11 +0200
Subject: [antlr-interest] How to use StringTemplate 4 with C#
Message-ID: <CACotV_1Von+Vk7fRbFzEaCxuvgC_oGD=mndiVOdvAxRR0s7Ceg@mail.gmail.com>

Hi!

I am writing a tree grammar with the following header

tree grammar Translator;

options {
    language=CSharp3;
    tokenVocab=Test;
    ASTLabelType=CommonTree;
    output = template;
}

My problem is that the generated code contains statements such as "using
Antlr3.ST". I have added a reference to the Antl3 StringTemplate DLL but I
am wondering how I can use version 4.

Cheers,
Maik

From arteminus at yandex.ru  Thu Aug 25 05:00:21 2011
From: arteminus at yandex.ru (=?koi8-r?B?8s/Nwc7P1yDh0tTFzQ==?=)
Date: Thu, 25 Aug 2011 16:00:21 +0400
Subject: [antlr-interest] formulaGrammar without backtracking
Message-ID: <381341314273621@web46.yandex.ru>

grammar formulaGrammar;
options{ 
backtrack=true; 
}
formula	:	expr ;
expr	:	atom ( OPERATOR expr )*
	|	'(' expr ( OPERATOR expr )* ')' ;
atom	:	( NUMBER | ID | function ) ;
function:	ID '(' ( expr ',' )* expr ')' ;
NUMBER	:	( INT | FLOAT );
fragment INT	:	'0'..'9'+ ;
fragment FLOAT	:	('0'..'9')+ '.' ('0'..'9')* ;
ID  :	('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*   ;    
OPERATOR:	('+'|'-'|'*'|'/'|'^');
WS  :   ( ' ' | '\t' ) {$channel=HIDDEN;} ;

This grammar is work, but can i do this without backtracking(without backtracking not compiling)?
sampleinput: func(p1,func2(p1,func4(b)),p3)
And i can not understand why from "sqrt(a)" input grammer return this parse tree:
-formula
 -expr
  -atom
   -function
    |sqrt
    |(
    -expr
     -atom
      |a
    -expr
     -atom
      |a
    |)
instead:
..
    |sqrt
    |(
    -expr
     -atom
      |a
    |)

From drippel at yahoo.com  Thu Aug 25 06:00:15 2011
From: drippel at yahoo.com (Daniel Rippel)
Date: Thu, 25 Aug 2011 06:00:15 -0700 (PDT)
Subject: [antlr-interest] Multiple Language Lexers - Single Parser
Message-ID: <1314277215.42903.YahooMailNeo@web161312.mail.bf1.yahoo.com>



I have a situation where I would like multiple lexers to feed the same parser.
In particular I would like to have lexers that allow a user to write code in their native language.

For example, an English lexer would define
IF : 'if' ;

WHILE : 'while' ;

A German lexer might have (and this is just a babefish lookup)

IF : 'wenn';
WHILE : 'wahrend';

Ideally, these lexers should be able to feed the same parser.

I was wondering what the best approach would be in Antlr.? Any pointers or tips would be appreciated.


This may be a newby question but I could not find answer in the FAQs or recent mail archives.

Thanks,
Dan

From sharwell at pixelminegames.com  Thu Aug 25 06:34:02 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 25 Aug 2011 08:34:02 -0500
Subject: [antlr-interest] How to use StringTemplate 4 with C#
In-Reply-To: <CACotV_1Von+Vk7fRbFzEaCxuvgC_oGD=mndiVOdvAxRR0s7Ceg@mail.gmail.com>
References: <CACotV_1Von+Vk7fRbFzEaCxuvgC_oGD=mndiVOdvAxRR0s7Ceg@mail.gmail.com>
Message-ID: <0c4301cc632b$a7938bf0$f6baa3d0$@pixelminegames.com>

In ANTLR 3, the "output=template" option is only able to produce code for
ST3. You'll have to remove that option and write all your own actions if you
want to target ST4.

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Maik Schmidt
Sent: Thursday, August 25, 2011 6:28 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] How to use StringTemplate 4 with C#

Hi!

I am writing a tree grammar with the following header

tree grammar Translator;

options {
    language=CSharp3;
    tokenVocab=Test;
    ASTLabelType=CommonTree;
    output = template;
}

My problem is that the generated code contains statements such as "using
Antlr3.ST". I have added a reference to the Antl3 StringTemplate DLL but I
am wondering how I can use version 4.

Cheers,
Maik

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jbb at acm.org  Thu Aug 25 08:06:41 2011
From: jbb at acm.org (John B. Brodie)
Date: Thu, 25 Aug 2011 11:06:41 -0400
Subject: [antlr-interest] formulaGrammar without backtracking
In-Reply-To: <381341314273621@web46.yandex.ru>
References: <381341314273621@web46.yandex.ru>
Message-ID: <1314284801.15571.3.camel@gecko>

Greetings!

On Thu, 2011-08-25 at 16:00 +0400, ??????? ????? wrote:
> grammar formulaGrammar;
> options{ 
> backtrack=true; 
> }
> formula	:	expr ;
> expr	:	atom ( OPERATOR expr )*
> 	|	'(' expr ( OPERATOR expr )* ')' ;
> atom	:	( NUMBER | ID | function ) ;
> function:	ID '(' ( expr ',' )* expr ')' ;
> NUMBER	:	( INT | FLOAT );
> fragment INT	:	'0'..'9'+ ;
> fragment FLOAT	:	('0'..'9')+ '.' ('0'..'9')* ;
> ID  :	('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*   ;    
> OPERATOR:	('+'|'-'|'*'|'/'|'^');
> WS  :   ( ' ' | '\t' ) {$channel=HIDDEN;} ;
> 
> This grammar is work, but can i do this without backtracking(without backtracking not compiling)?
> sampleinput: func(p1,func2(p1,func4(b)),p3)

try these:

expr    :       atom ( OPERATOR expr )? ;
atom    :       NUMBER | ID | function
        |       '(' expr ')' ;
function:       ID '(' ( expr (',' expr)* )? ')' ;

Note that in the above I have added the capability for functions to have
zero parameters......

> And i can not understand why from "sqrt(a)" input grammer return this parse tree:
> -formula
>  -expr
>   -atom
>    -function
>     |sqrt
>     |(
>     -expr
>      -atom
>       |a
>     -expr
>      -atom
>       |a
>     |)
> instead:
> ..
>     |sqrt
>     |(
>     -expr
>      -atom
>       |a
>     |)
> 

do not know about this. does not happen with the above changes. sorry.

hope this helps...
   -jbb



From contact at maik-schmidt.de  Thu Aug 25 08:15:13 2011
From: contact at maik-schmidt.de (Maik Schmidt)
Date: Thu, 25 Aug 2011 17:15:13 +0200
Subject: [antlr-interest] Problems with Tree Grammars outputting Templates
	in C#
Message-ID: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>

Hi!

I am working through the "Language Implementation Patterns" book and I am
translating all examples to C#. Unfortunately, I cannot get StringTemplate
output to work.

Attached you'll find a grammar named Cymbol.g3 and a tree parser named
Gen.g3. I have downloaded them from the publisher's web site and only had to
change a few minor thing to make them compliant with C#.

VisualStudio 2010 turns the g3 files into grammars and lexers nicely, but
unfortunately I cannot compile them. The problem seems to appear whenever an
expression such as "d+=" is used as in the following rule:

compilationUnit:   ( d+=classDeclaration | d+=methodDeclaration |
d+=varDeclaration )+ -> file(defs={$d})

For such rules I get errors like the following:

Error 6 Argument 1: cannot convert from 'Antlr3.ST.StringTemplate' to
'Antlr.Runtime.Tree.CommonTree' c:\users\mschmidt2\documents\visual studio
2010\Projects\StringTemplateTest\StringTemplateTest\obj\x86\Debug\Gen.cs

The corresponding code snippet looks as follows:

case 1:
DebugEnterAlt(1);
// Gen.g3:13:11: d+= classDeclaration
{
DebugLocation(13, 12);
PushFollow(Follow._classDeclaration_in_compilationUnit74);
d=classDeclaration();
PopFollow();
if (state.failed) return retval;
if (list_d==null) list_d=new List<StringTemplate>();
list_d.Add(d.Template);

The problem seems to be the initial definition of list_d which is

List<CommonTree> list_d = null;

What am I doing wrong?

Cheers,
Maik
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Cymbol.g3
Type: application/octet-stream
Size: 4536 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20110825/2d01979d/attachment.obj 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Gen.g3
Type: application/octet-stream
Size: 3141 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20110825/2d01979d/attachment-0001.obj 

From garry at dynafocus.com  Thu Aug 25 08:22:12 2011
From: garry at dynafocus.com (Garry Watkins)
Date: Thu, 25 Aug 2011 11:22:12 -0400
Subject: [antlr-interest] Rewriting an AST with the same type listed twice
Message-ID: <CACJx7cwd-XAPMJwEjxXkTYsyusV8+DH60CsY6XBsrSCp58CrYQ@mail.gmail.com>

 mapType

: 'map' '<'! anyType ','! anyType '>'!
| 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)
;


I am trying to re-write the AST generated on this alternative:

| 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)


How does one alias the anyTypes?  I am getting an error on the code above?

However the bigger question is my parser won't recognize the following
map<string,string> if it uses just the first line in my rule.  However, it
will recognize map <string,string>.

Thanks
Garry

From bkiers at gmail.com  Thu Aug 25 08:25:53 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Thu, 25 Aug 2011 17:25:53 +0200
Subject: [antlr-interest] Rewriting an AST with the same type listed
	twice
In-Reply-To: <CACJx7cwd-XAPMJwEjxXkTYsyusV8+DH60CsY6XBsrSCp58CrYQ@mail.gmail.com>
References: <CACJx7cwd-XAPMJwEjxXkTYsyusV8+DH60CsY6XBsrSCp58CrYQ@mail.gmail.com>
Message-ID: <CAOrgODYXbUUhQzPOT-+F0qaHDRkr-54iTN_7Y2EBFhLVivvwFQ@mail.gmail.com>

Hi Garry,

You either use inline operators ^ and !, or use a rewrite rule, not both. To
reference a rule, add a $ before its label:

mapType
  :  'map' '<' k=anyType ',' v=anyType '>' -> ^('map' $k $v)
  ;

but I think this should work too:

mapType
  :  'map' '<' anyType ',' anyType '>' -> ^('map' anyType anyType)
  ;

Regards,

Bart.

On Thu, Aug 25, 2011 at 5:22 PM, Garry Watkins <garry at dynafocus.com> wrote:

>  mapType
>
> : 'map' '<'! anyType ','! anyType '>'!
> | 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)
> ;
>
>
> I am trying to re-write the AST generated on this alternative:
>
> | 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)
>
>
> How does one alias the anyTypes?  I am getting an error on the code above?
>
> However the bigger question is my parser won't recognize the following
> map<string,string> if it uses just the first line in my rule.  However, it
> will recognize map <string,string>.
>
> Thanks
> Garry
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From garry at dynafocus.com  Thu Aug 25 08:48:21 2011
From: garry at dynafocus.com (Garry Watkins)
Date: Thu, 25 Aug 2011 11:48:21 -0400
Subject: [antlr-interest] Rewriting an AST with the same type listed
	twice
In-Reply-To: <CAOrgODYXbUUhQzPOT-+F0qaHDRkr-54iTN_7Y2EBFhLVivvwFQ@mail.gmail.com>
References: <CACJx7cwd-XAPMJwEjxXkTYsyusV8+DH60CsY6XBsrSCp58CrYQ@mail.gmail.com>
	<CAOrgODYXbUUhQzPOT-+F0qaHDRkr-54iTN_7Y2EBFhLVivvwFQ@mail.gmail.com>
Message-ID: <CACJx7cxjwPsJ59JWCzJQphdUapKQO3aKt4bcrQLCiSN=aHgR9Q@mail.gmail.com>

Thanks for the quick response.  However I cannot get it to recognize the
'map' '<' construct.  That is ok.

Next question.  I am trying to re-write this but it complains about this
with a "reference to undefined token in rewrite rule."

constList
: '[' cv+=constValue (',' cv+=constValue)* ']' -> ^('constval' $cv+)
;


On Thu, Aug 25, 2011 at 11:25 AM, Bart Kiers <bkiers at gmail.com> wrote:

> Hi Garry,
>
> You either use inline operators ^ and !, or use a rewrite rule, not both.
> To reference a rule, add a $ before its label:
>
> mapType
>   :  'map' '<' k=anyType ',' v=anyType '>' -> ^('map' $k $v)
>   ;
>
> but I think this should work too:
>
> mapType
>   :  'map' '<' anyType ',' anyType '>' -> ^('map' anyType anyType)
>   ;
>
> Regards,
>
> Bart.
>
> On Thu, Aug 25, 2011 at 5:22 PM, Garry Watkins <garry at dynafocus.com>wrote:
>
>>  mapType
>>
>> : 'map' '<'! anyType ','! anyType '>'!
>> | 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)
>> ;
>>
>>
>> I am trying to re-write the AST generated on this alternative:
>>
>> | 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)
>>
>>
>> How does one alias the anyTypes?  I am getting an error on the code above?
>>
>> However the bigger question is my parser won't recognize the following
>> map<string,string> if it uses just the first line in my rule.  However, it
>> will recognize map <string,string>.
>>
>> Thanks
>> Garry
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>


-- 
Garry Watkins
Managing Director
DynaFOCUS, LLC
(843) 608-8004 (google voice)
(843) 276-6808 (cell)

From researcher0x00 at gmail.com  Thu Aug 25 08:50:08 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Thu, 25 Aug 2011 11:50:08 -0400
Subject: [antlr-interest] Problems with Tree Grammars outputting
 Templates in C#
In-Reply-To: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>
References: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>
Message-ID: <CAN45N13an_NqL-B63OOegKBTNSscZYQCxR+fNf9wHqbaX7kJWw@mail.gmail.com>

Hi Maik,

Sorry this is not an answer to your question. It sounds like you need Sam's
help.

> I am working through the "Language Implementation Patterns" book and I am
> translating all examples to C#.


I was planning on doing the same in a few months, but if you would be
willing to donate the files to the ATNLR site or if you could send me a copy
when you are done it would be greatly appreciated.

Thanks, Eric

From bkiers at gmail.com  Thu Aug 25 09:15:48 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Thu, 25 Aug 2011 18:15:48 +0200
Subject: [antlr-interest] Rewriting an AST with the same type listed
	twice
In-Reply-To: <CACJx7cxjwPsJ59JWCzJQphdUapKQO3aKt4bcrQLCiSN=aHgR9Q@mail.gmail.com>
References: <CACJx7cwd-XAPMJwEjxXkTYsyusV8+DH60CsY6XBsrSCp58CrYQ@mail.gmail.com>
	<CAOrgODYXbUUhQzPOT-+F0qaHDRkr-54iTN_7Y2EBFhLVivvwFQ@mail.gmail.com>
	<CACJx7cxjwPsJ59JWCzJQphdUapKQO3aKt4bcrQLCiSN=aHgR9Q@mail.gmail.com>
Message-ID: <CAOrgODaPW3zr-9B334H62z7Ctjr=mmE_jUa_p+u8Tco-1CwJTA@mail.gmail.com>

Hi Garry

The operator += creates a List of tokens, just use constValue+ in your
rewrite rule. And the literal token 'constval' is never used in your parser
rule, so you can't use it in a rewrite rule (this is what the error is
about).

Try this using an imaginary token (see the 'tokens { ... }' block below):

grammar YourGrammar;

options {
  ...
}

tokens {
  CONSTVAL;
}

...

constList
  :  '[' constValue (',' constValue)* ']' -> ^(CONSTVAL constValue+)
  ;

...


Regards,

Bart.

On Thu, Aug 25, 2011 at 5:48 PM, Garry Watkins <garry at dynafocus.com> wrote:

> Thanks for the quick response.  However I cannot get it to recognize the
> 'map' '<' construct.  That is ok.
>
> Next question.  I am trying to re-write this but it complains about this
> with a "reference to undefined token in rewrite rule."
>
> constList
> : '[' cv+=constValue (',' cv+=constValue)* ']' -> ^('constval' $cv+)
>  ;
>
>
> On Thu, Aug 25, 2011 at 11:25 AM, Bart Kiers <bkiers at gmail.com> wrote:
>
>> Hi Garry,
>>
>> You either use inline operators ^ and !, or use a rewrite rule, not both.
>> To reference a rule, add a $ before its label:
>>
>> mapType
>>   :  'map' '<' k=anyType ',' v=anyType '>' -> ^('map' $k $v)
>>   ;
>>
>> but I think this should work too:
>>
>> mapType
>>   :  'map' '<' anyType ',' anyType '>' -> ^('map' anyType anyType)
>>   ;
>>
>> Regards,
>>
>> Bart.
>>
>> On Thu, Aug 25, 2011 at 5:22 PM, Garry Watkins <garry at dynafocus.com>wrote:
>>
>>>  mapType
>>>
>>> : 'map' '<'! anyType ','! anyType '>'!
>>> | 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)
>>> ;
>>>
>>>
>>> I am trying to re-write the AST generated on this alternative:
>>>
>>> | 'map<' k=anyType ','! v=anyType '>'! -> ^('map' k v)
>>>
>>>
>>> How does one alias the anyTypes?  I am getting an error on the code
>>> above?
>>>
>>> However the bigger question is my parser won't recognize the following
>>> map<string,string> if it uses just the first line in my rule.  However,
>>> it
>>> will recognize map <string,string>.
>>>
>>> Thanks
>>> Garry
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>
>>
>
>
> --
> Garry Watkins
> Managing Director
> DynaFOCUS, LLC
> (843) 608-8004 (google voice)
> (843) 276-6808 (cell)
>
>

From jimi at temporal-wave.com  Thu Aug 25 10:14:11 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 25 Aug 2011 10:14:11 -0700
Subject: [antlr-interest] AST within Qt's QTreeWidget?
In-Reply-To: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>
References: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>
Message-ID: <592433FB-E03E-49B6-8294-BD437AE8AA73@temporal-wave.com>

You know that there is a built in function to produce a DOT spec and that graphviz will turn this in to a jpg or png? Probably easier than trying to integrate QT. 

Jim

On Aug 25, 2011, at 2:48, Christian Benjamin Ries <christian_benjamin.ries at fh-bielefeld.de> wrote:

> Hello,
> 
> could you give me some information how I can display an AST within a QTreeWidget?
> 
> Suggestions, links, already running implementations would be perfect!
> 
> I use the C-target for my work.
> 
> Cheers, Christian
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jimi at temporal-wave.com  Thu Aug 25 10:18:42 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 25 Aug 2011 10:18:42 -0700
Subject: [antlr-interest] Multiple Language Lexers - Single Parser
In-Reply-To: <1314277215.42903.YahooMailNeo@web161312.mail.bf1.yahoo.com>
References: <1314277215.42903.YahooMailNeo@web161312.mail.bf1.yahoo.com>
Message-ID: <92DD5162-88CD-47CA-ACCB-B9C596225A24@temporal-wave.com>

You mean you want to switch languages on the fly or just use one or the other? If the latter just make a copy of the English one and change to german as you did below and call it another name. Then just invoke the one you want. 

To make the token numbers the same, generate the tokens with the English version then use the tokenVocab option in both levers. 

Jim

On Aug 25, 2011, at 6:00, Daniel Rippel <drippel at yahoo.com> wrote:

> 
> 
> I have a situation where I would like multiple lexers to feed the same parser.
> In particular I would like to have lexers that allow a user to write code in their native language.
> 
> For example, an English lexer would define
> IF : 'if' ;
> 
> WHILE : 'while' ;
> 
> A German lexer might have (and this is just a babefish lookup)
> 
> IF : 'wenn';
> WHILE : 'wahrend';
> 
> Ideally, these lexers should be able to feed the same parser.
> 
> I was wondering what the best approach would be in Antlr.  Any pointers or tips would be appreciated.
> 
> 
> This may be a newby question but I could not find answer in the FAQs or recent mail archives.
> 
> Thanks,
> Dan
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From s.barnett-cormack at lancaster.ac.uk  Thu Aug 25 10:23:34 2011
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Thu, 25 Aug 2011 18:23:34 +0100
Subject: [antlr-interest] AST within Qt's QTreeWidget?
In-Reply-To: <592433FB-E03E-49B6-8294-BD437AE8AA73@temporal-wave.com>
References: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>
	<592433FB-E03E-49B6-8294-BD437AE8AA73@temporal-wave.com>
Message-ID: <4E568516.3020801@lancaster.ac.uk>

On 25/08/2011 18:14, Jim Idle wrote:
> You know that there is a built in function to produce a DOT spec and that graphviz will turn this in to a jpg or png? Probably easier than trying to integrate QT.all

If all that's wanted is visualisation, that's fair, but if the goal is 
integration with a GUI, then it's less useful. Also, even if it's 
visualisation that's wanted, then it might want to be interactive, or at 
least stylistically consistent with other elements.

Sam

From researcher0x00 at gmail.com  Thu Aug 25 10:57:21 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Thu, 25 Aug 2011 13:57:21 -0400
Subject: [antlr-interest] AST within Qt's QTreeWidget?
In-Reply-To: <4E568516.3020801@lancaster.ac.uk>
References: <14038_1314265734_ZZh0z0m5oYv4K.00_4E561A85.6080906@fh-bielefeld.de>
	<592433FB-E03E-49B6-8294-BD437AE8AA73@temporal-wave.com>
	<4E568516.3020801@lancaster.ac.uk>
Message-ID: <CAN45N12N1j+goFQvgu+wfOEyzMmKbUEeN=mbVCA=ftZJRX3nCQ@mail.gmail.com>

FWIW

I have been generating many dot files lately and the applications for them
run from turning them into static images, to standalone viewers, to
integrable components, to editors. The dotty app from the graphviz site is
nice for a quick view but the best integration I have seen so far is what is
done in ANTLRWorks.

Right now I just need screen shots from dot files and am using ZGRViewer
because it lets me move and resize the images better than dotty, but it
can't move the individual nodes. However ZGRViewer is based on ZVTM ,
http://zvtm.sourceforge.net and is Java based, which might be worth a look.

Eric

From contact at maik-schmidt.de  Thu Aug 25 11:38:47 2011
From: contact at maik-schmidt.de (pragmaik)
Date: Thu, 25 Aug 2011 11:38:47 -0700 (PDT)
Subject: [antlr-interest] Problems with Tree Grammars outputting
	Templates in C#
In-Reply-To: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>
References: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>
Message-ID: <1314297527495-6725691.post@n2.nabble.com>

I think that my problem is exactly the same as in
http://antlr.1301665.n2.nabble.com/C-antlr-dotnet-tool-3-3-1-7705-issue-with-collected-template-list-td6065737.html.

Unfortunately, changing ST.stg doesn't help.

Is there anything else I can do?


--
View this message in context: http://antlr.1301665.n2.nabble.com/Problems-with-Tree-Grammars-outputting-Templates-in-C-tp6724828p6725691.html
Sent from the ANTLR mailing list archive at Nabble.com.

From sharwell at pixelminegames.com  Thu Aug 25 13:13:51 2011
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 25 Aug 2011 15:13:51 -0500
Subject: [antlr-interest] Problems with Tree Grammars
	outputting	Templates in C#
In-Reply-To: <1314297527495-6725691.post@n2.nabble.com>
References: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>
	<1314297527495-6725691.post@n2.nabble.com>
Message-ID: <0c6f01cc6363$82ac16d0$88044470$@pixelminegames.com>

What version of Antlr3.exe are you using to generate code?

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of pragmaik
Sent: Thursday, August 25, 2011 1:39 PM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Problems with Tree Grammars outputting
Templates in C#

I think that my problem is exactly the same as in
http://antlr.1301665.n2.nabble.com/C-antlr-dotnet-tool-3-3-1-7705-issue-with
-collected-template-list-td6065737.html.

Unfortunately, changing ST.stg doesn't help.

Is there anything else I can do?


--
View this message in context:
http://antlr.1301665.n2.nabble.com/Problems-with-Tree-Grammars-outputting-Te
mplates-in-C-tp6724828p6725691.html
Sent from the ANTLR mailing list archive at Nabble.com.

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From researcher0x00 at gmail.com  Thu Aug 25 18:45:16 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Thu, 25 Aug 2011 21:45:16 -0400
Subject: [antlr-interest] Antlr v3.3/3.4 documentation hurdles
In-Reply-To: <CAN45N11vSobNKdhY-KGyDazNJAXEPm5O9+DwuWq-FHbPzMbg0Q@mail.gmail.com>
References: <1314218192.90259.YahooMailNeo@web160703.mail.bf1.yahoo.com>
	<CAN45N11vSobNKdhY-KGyDazNJAXEPm5O9+DwuWq-FHbPzMbg0Q@mail.gmail.com>
Message-ID: <CAN45N11o=V3_kWntEncJRmxBSa99OoBDYLY730MWAy10u5K14A@mail.gmail.com>

Hi Ramanand,

Just to let you know that you are not alone in having trouble finding the
documentation. For two days I have been looking for an explanation of alt1
when using the option -Xdfaverbose and just found it explained in Ter's
blog. http://www.antlr.org/blog/antlr3/lookahead.html

But I also stumbled upon
http://www.antlr.org/wiki/display/ST4/StringTemplate+Inspector+GUI when
using -XdbgST, and am also reading source code to figure out how to get the
-Xm option to trigger.

But in so doing I am learning alot.

Best wishes, Eric

From contact at maik-schmidt.de  Thu Aug 25 21:45:58 2011
From: contact at maik-schmidt.de (pragmaik)
Date: Thu, 25 Aug 2011 21:45:58 -0700 (PDT)
Subject: [antlr-interest] Problems with Tree Grammars
	outputting	Templates in C#
In-Reply-To: <0c6f01cc6363$82ac16d0$88044470$@pixelminegames.com>
References: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>
	<1314297527495-6725691.post@n2.nabble.com>
	<0c6f01cc6363$82ac16d0$88044470$@pixelminegames.com>
Message-ID: <1314333958377-6727380.post@n2.nabble.com>

The Antlr3.exe in the "Reference" directory of my Visual Studio project
outputs "Version 3.4.1.9004".

Maik


--
View this message in context: http://antlr.1301665.n2.nabble.com/Problems-with-Tree-Grammars-outputting-Templates-in-C-tp6724828p6727380.html
Sent from the ANTLR mailing list archive at Nabble.com.

From mike at cargal.net  Fri Aug 26 02:35:58 2011
From: mike at cargal.net (Mike Cargal)
Date: Fri, 26 Aug 2011 05:35:58 -0400
Subject: [antlr-interest] Ignoring white space in the interpreter.
Message-ID: <77004DF3-FCF1-42F6-955E-B511AF70033C@cargal.net>

I'm trying to get the eclipse IDE working for me.  I have everything installed and I can generate and compile fine.  

The problem I'm having is with the interpreter.

If I define a rule that puts whitespace on the hidden channel, the interpreter doesn't handle that.  I understand why the interpreter might not handle predicates in general, but it seems that not handling something like sending whitespace to the hidden channel makes the interpreter pretty much useless.

On the assumption that it's not useless, can anyone tell me how to get the interpreter to handle a grammar that sends whitespace to the hide channel?

Based on the videos I was watching, it appears that this worked at one time.

I'm using Helios with ANTLR 3.4.  I do see that the IDE only lists support through ANTLR 3.2, but don't see where I can download 3.2 (and would rather hate to be limited by an older version of ANTLR.  Already backed off to Helios from Indigo just to get it installed.)

Or, is the answer that I just need to skip the interpreter since I won't really make it very far without predicates even if I can get hidden channel to work.

Mike Cargal
mike at cargal.net


From thebigsmalln at gmail.com  Fri Aug 26 04:40:13 2011
From: thebigsmalln at gmail.com (Adam Adamski)
Date: Fri, 26 Aug 2011 13:40:13 +0200
Subject: [antlr-interest] Problem with AST rewrite and variable
Message-ID: <4E57861D.4020108@gmail.com>

Dear all ANTLR users,

I have question about my rewrite rule - what is wrong with it?

type:
            (ARRAY_OF)* typ1=(simpleType|systemType|objectType)
            ->^(TYPE ^(ARRAY_OFLIST ARRAY_OF*) $typ1)
            ;

I get error when I try to check my rules (with eclipse 3.6).

var i,j:integer;

Console spits out this:

Exception in thread "main" java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at
org.deved.antlride.runtime.LaunchParser.invokeRule(LaunchParser.java:202)
    at org.deved.antlride.runtime.LaunchParser.launch(LaunchParser.java:130)
    at org.deved.antlride.runtime.LaunchParser.main(LaunchParser.java:228)

Caused by: org.antlr.runtime.tree.RewriteEmptyStreamException: token typ1
    at
org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:157)
    at
org.antlr.runtime.tree.RewriteRuleTokenStream.nextNode(RewriteRuleTokenStream.java:58)
    at Loglan82iParser.type(Loglan82iParser.java:14261)
    at Loglan82iParser.varDecl(Loglan82iParser.java:1464)
    at Loglan82iParser.varDecList(Loglan82iParser.java:1136)
    at Loglan82iParser.declaration(Loglan82iParser.java:892)
    at Loglan82iParser.declarations(Loglan82iParser.java:656)
    at Loglan82iParser.program(Loglan82iParser.java:461)
    ... 7 more

Is it a mistake to use variable like I used? I mean:

rule:
        IDN typ=(type1|type2|typ3)
        ;

My final question: is it wrong to use same var name for many rules ? I
used variable 'typ' in 4 rules. (I don't think It cause the problem, but
I'm not sure)
Ps. I'm using Eclipse (3.6.2) as my IDE and Antlr v3.3

Thank you in advance.
Adam.

From bkiers at gmail.com  Fri Aug 26 04:48:53 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Fri, 26 Aug 2011 13:48:53 +0200
Subject: [antlr-interest] Problem with AST rewrite and variable
In-Reply-To: <4E57861D.4020108@gmail.com>
References: <4E57861D.4020108@gmail.com>
Message-ID: <CAOrgODZAG+jeDyt_YmPCz4CQhg5PN3RQ5EfBpHJ5SOLESoQf7Q@mail.gmail.com>

On Fri, Aug 26, 2011 at 1:40 PM, Adam Adamski <thebigsmalln at gmail.com>wrote:

> Dear all ANTLR users,
>

Hi Adam,


Is it a mistake to use variable like I used? I mean:
>
> rule:
>        IDN typ=(type1|type2|typ3)
>        ;
>

Yes, you can't do that. Try this instead:

rule
  :  (ARRAY_OF)* intermediate -> ^(TYPE ^(ARRAY_OFLIST
ARRAY_OF*) intermediate)
  ;

intermediate
  :  simpleType
  |  systemType
  |  objectType
  ;


> My final question: is it wrong to use same var name for many rules ? I
> used variable 'typ' in 4 rules. (I don't think It cause the problem, but
> I'm not sure)


No, there's nothing wrong with that.

Regards,

Bart.

From researcher0x00 at gmail.com  Fri Aug 26 05:04:41 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Fri, 26 Aug 2011 08:04:41 -0400
Subject: [antlr-interest] Ignoring white space in the interpreter.
In-Reply-To: <77004DF3-FCF1-42F6-955E-B511AF70033C@cargal.net>
References: <77004DF3-FCF1-42F6-955E-B511AF70033C@cargal.net>
Message-ID: <CAN45N12U9mf=CpbwqKx_dU41Od26+g464CJ3cX_g5qJ=Dgi9Gw@mail.gmail.com>

Hi Mike,


> don't see where I can download 3.2


 http://www.antlr.org/download

 (and would rather hate to be limited by an older version of ANTLR.  Already
backed off to Helios from Indigo just to get it installed.)

If you use virtual machines like VirtualBox http://www.virtualbox.org/ ,
these will allow you build a new system in which you could run a different
version of the software without forcing you to give up your current version.
If you are interested I could send you a preliminary copy of my instructions
for building such, but it based on Debian Linux so as to be freely
available.


> Or, is the answer that I just need to skip the interpreter since I won't
> really make it very far without predicates even if I can get hidden channel
> to work.
>

If you are just learning ANTLR then spending some time with the interpreter
is good but for any thing more than learning I don't use it. Sounds like you
just need a nudge to move off of the interpreter and start using the
debugger.

Best wishes,

Eric

From rbellamy at pteradigm.com  Fri Aug 26 08:34:09 2011
From: rbellamy at pteradigm.com (G. Richard Bellamy)
Date: Fri, 26 Aug 2011 08:34:09 -0700
Subject: [antlr-interest] Ignoring white space in the interpreter.
In-Reply-To: <CAN45N12U9mf=CpbwqKx_dU41Od26+g464CJ3cX_g5qJ=Dgi9Gw@mail.gmail.com>
References: <77004DF3-FCF1-42F6-955E-B511AF70033C@cargal.net>
	<CAN45N12U9mf=CpbwqKx_dU41Od26+g464CJ3cX_g5qJ=Dgi9Gw@mail.gmail.com>
Message-ID: <4E57BCF1.2090703@pteradigm.com>

I'd be interested in those destructions.

-rb

On 8/26/2011 5:04 AM, The Researcher wrote:
> Hi Mike,
>
>
>> don't see where I can download 3.2
>
>   http://www.antlr.org/download
>
>   (and would rather hate to be limited by an older version of ANTLR.  Already
> backed off to Helios from Indigo just to get it installed.)
>
> If you use virtual machines like VirtualBox http://www.virtualbox.org/ ,
> these will allow you build a new system in which you could run a different
> version of the software without forcing you to give up your current version.
> If you are interested I could send you a preliminary copy of my instructions
> for building such, but it based on Debian Linux so as to be freely
> available.
>
>
>> Or, is the answer that I just need to skip the interpreter since I won't
>> really make it very far without predicates even if I can get hidden channel
>> to work.
>>
> If you are just learning ANTLR then spending some time with the interpreter
> is good but for any thing more than learning I don't use it. Sounds like you
> just need a nudge to move off of the interpreter and start using the
> debugger.
>
> Best wishes,
>
> Eric
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From garry at dynafocus.com  Fri Aug 26 09:14:52 2011
From: garry at dynafocus.com (Garry Watkins)
Date: Fri, 26 Aug 2011 12:14:52 -0400
Subject: [antlr-interest] I am using ANTLRWorks,
 How do I specify the template that it should use for generation.
Message-ID: <CACJx7cxOOPhtrxU8FmxeZ9qQKW5TKYabVDnzx50_B144hxbG5w@mail.gmail.com>

I am working on a DSL and I want to use StringTemplate to generate the
output.  What should the .stg be named and where should I put it so
ANTLRWorks can find it.

Assume that I am using the following:

grammar MyGrammar.g which produces an AST
generator MyGenerator.g output = template

These are both currently saved on my Desktop.  The output folder is
Desktop/output.

-- 
Garry Watkins
Managing Director
DynaFOCUS, LLC
(843) 608-8004 (google voice)
(843) 276-6808 (cell)

From jimi at temporal-wave.com  Fri Aug 26 09:28:10 2011
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 26 Aug 2011 09:28:10 -0700
Subject: [antlr-interest] Problem with AST rewrite and variable
In-Reply-To: <4E57861D.4020108@gmail.com>
References: <4E57861D.4020108@gmail.com>
Message-ID: <55806aaedb982f9e983788601387bac3@mail.gmail.com>

type:
             (ARRAY_OF)* typ1=(t1=simpleType|t2=systemType|t3=objectType)
             ->^(TYPE ^(ARRAY_OFLIST ARRAY_OF*) $t1? $t2? $t3?)
             ;

Not that :

^(ARRAY_OFLIST ARRAY_OF*)

Is going to need a rule like this in the tree parser""

: ^(ARRAY_OFLIST ARRAY_OF+)
| ARRAY_OFLIST
;

The node for ARRAY_OFLIST is superfluous and I would just use:


type:
             (ARRAY_OF)* typ1=(t1=simpleType|t2=systemType|t3=objectType)
             ->^(TYPE ARRAY_OF* $t1? $t2? $t3?)
             ;


Jim

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Adam Adamski
> Sent: Friday, August 26, 2011 4:40 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Problem with AST rewrite and variable
>
> Dear all ANTLR users,
>
> I have question about my rewrite rule - what is wrong with it?
>
> type:
>             (ARRAY_OF)* typ1=(simpleType|systemType|objectType)
>             ->^(TYPE ^(ARRAY_OFLIST ARRAY_OF*) $typ1)
>             ;
>
> I get error when I try to check my rules (with eclipse 3.6).
>
> var i,j:integer;
>
> Console spits out this:
>
> Exception in thread "main" java.lang.reflect.InvocationTargetException
>     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>     at
> sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.ja
> va:57)
>     at
> sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccesso
> rImpl.java:43)
>     at java.lang.reflect.Method.invoke(Method.java:616)
>     at
> org.deved.antlride.runtime.LaunchParser.invokeRule(LaunchParser.java:20
> 2)
>     at
> org.deved.antlride.runtime.LaunchParser.launch(LaunchParser.java:130)
>     at
> org.deved.antlride.runtime.LaunchParser.main(LaunchParser.java:228)
>
> Caused by: org.antlr.runtime.tree.RewriteEmptyStreamException: token
> typ1
>     at
> org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElemen
> tStream.java:157)
>     at
> org.antlr.runtime.tree.RewriteRuleTokenStream.nextNode(RewriteRuleToken
> Stream.java:58)
>     at Loglan82iParser.type(Loglan82iParser.java:14261)
>     at Loglan82iParser.varDecl(Loglan82iParser.java:1464)
>     at Loglan82iParser.varDecList(Loglan82iParser.java:1136)
>     at Loglan82iParser.declaration(Loglan82iParser.java:892)
>     at Loglan82iParser.declarations(Loglan82iParser.java:656)
>     at Loglan82iParser.program(Loglan82iParser.java:461)
>     ... 7 more
>
> Is it a mistake to use variable like I used? I mean:
>
> rule:
>         IDN typ=(type1|type2|typ3)
>         ;
>
> My final question: is it wrong to use same var name for many rules ? I
> used variable 'typ' in 4 rules. (I don't think It cause the problem,
> but I'm not sure) Ps. I'm using Eclipse (3.6.2) as my IDE and Antlr
> v3.3
>
> Thank you in advance.
> Adam.
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address

From bill.andersen at mac.com  Fri Aug 26 11:15:45 2011
From: bill.andersen at mac.com (Bill Andersen)
Date: Fri, 26 Aug 2011 11:15:45 -0700
Subject: [antlr-interest] Quick ANTLR/ST question
Message-ID: <33B3DDC2-6CD9-4501-BF30-B999584880AB@mac.com>

Hi all...

I have the following production alternative:

  | ^(ASTERISK e1=unary_expression e2=unary_expression)

and want to use templates that look like this in my STG:

     app2(op,e1,e2) ::= "<op>(<e1>,<e2>)"

     op_ASTERISK() ::= "mult"

Question is - if I want to keep the translation of ASTERISK in the STG, how do I express the template return in the alternative above.  E.g.,

  | ^(ASTERISK e1=unary_expression e2=unary_expression)
         -> app2(op=???, e1={$e1.st}, e2={$e2.st})

What goes in the place of ??? to cause op_ASTERISK() to be inserted into the resulting ST?

Using ANTLR 3.3 / ST 3...

Thanks

	.bill



From researcher0x00 at gmail.com  Fri Aug 26 11:24:49 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Fri, 26 Aug 2011 14:24:49 -0400
Subject: [antlr-interest] org.antlr.Tool API documentation
Message-ID: <CAN45N13fWVHT7gS=ys6r-Yq+923vi9_iJ7w0kwXFsTc7OAVShA@mail.gmail.com>

Hi all,

Just to make sure I didn't miss it.

The runtime API can be found at www.antlr.org/api/
but the tool api has to be built on your own machine using JavaDoc.
i.e class org.antlr.Tool

Thanks, Eric

From nicolas.hernandez at gmail.com  Sat Aug 27 09:57:57 2011
From: nicolas.hernandez at gmail.com (Nicolas Hernandez)
Date: Sat, 27 Aug 2011 18:57:57 +0200
Subject: [antlr-interest] how to implement a regular expression engine
Message-ID: <CAB7Now6=pxRWwSAJkR+jurcwCLOr-9e==UxWQ52FWHwnoxpZ8w@mail.gmail.com>

Dear Everyone,

I ve got some questions. I am a newbie with ANTLR. I ve got the
feeling it can help me with my problem but I m not sure exactly how.

Roughly speaking I would like to design my own pattern matching
language (a bit like the perl character regex or XPath)...

I feel that ANTLR can help me to define the grammar of this language.
But my point is how to use expressions of this grammar after that. I'm
asking for advices or good practices.

Let's say I have written a grammar for defining some matching rules.
ANTLR offers me some way to recognize the syntax of some given rules as input.
But now I would like to apply my rules on a flow of structured data to
recognize the parts which match the defined patterns.
I understand there is the possibility to associate actions (either
directly in parsing the grammar or in a second phase by walking a tree
grammar built from the parsing stage).

Would the best way be to build a rule structure by parsing them and
use this structure for parsing my flow of structured data in a
dedicated way ? Can the AST tree be useful for that ? Or what ?

I am a bit confused because there is actually two levels of parsing...
the rule parsing and the data structure I aim to parse with the rules
(a kind of meta one).

Thanks in advance for any suggestion

Regards

/Nicolas

From researcher0x00 at gmail.com  Sat Aug 27 10:34:55 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Sat, 27 Aug 2011 13:34:55 -0400
Subject: [antlr-interest] how to implement a regular expression engine
In-Reply-To: <CAB7Now6=pxRWwSAJkR+jurcwCLOr-9e==UxWQ52FWHwnoxpZ8w@mail.gmail.com>
References: <CAB7Now6=pxRWwSAJkR+jurcwCLOr-9e==UxWQ52FWHwnoxpZ8w@mail.gmail.com>
Message-ID: <CAN45N11Jj0O7f9804804LMm+-=P1qnJUOkmCqO_BpUXMMrNjfQ@mail.gmail.com>

Hi Nicolas,

To get you started take a look at http://antlr.markmail.org/  and search for
"regular expression."

Eric

From jonne.zutt.ml at gmail.com  Sun Aug 28 06:20:34 2011
From: jonne.zutt.ml at gmail.com (Jonne Zutt)
Date: Sun, 28 Aug 2011 15:20:34 +0200
Subject: [antlr-interest] Match token {n} times
Message-ID: <CAJg62X9bq5UOA1xd5+9cFa1wKmjG0v+oZ8rU4G9uy1MSApubBw@mail.gmail.com>

Dear all,

Is it possible with antlr to match a token exactly n times?
Something like the following:

ACCOUNT : NUMBER{8};

NUMBER	:	ZERO
	|	(NONZERO DIGIT*)
	;
ZERO	:	'0';
NONZERO	:	'1'..'9';
DIGIT	:	'0'..'9';

Thanks,
Jonne.

From bkiers at gmail.com  Sun Aug 28 06:23:15 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Sun, 28 Aug 2011 15:23:15 +0200
Subject: [antlr-interest] Match token {n} times
In-Reply-To: <CAJg62X9bq5UOA1xd5+9cFa1wKmjG0v+oZ8rU4G9uy1MSApubBw@mail.gmail.com>
References: <CAJg62X9bq5UOA1xd5+9cFa1wKmjG0v+oZ8rU4G9uy1MSApubBw@mail.gmail.com>
Message-ID: <CAOrgODZidcvpO4RqhD3LWMjKxoTKqW2RPYBjT8z4MtNv_yKqZQ@mail.gmail.com>

Hi Jonne,

No, that is not possible with a quantifier like {x}. You'll have to do it
the "hard" way:

ACCOUNT
  :  NUMBER NUMBER NUMBER NUMBER NUMBER NUMBER NUMBER NUMBER
  ;

Regards,

Bart.


On Sun, Aug 28, 2011 at 3:20 PM, Jonne Zutt <jonne.zutt.ml at gmail.com> wrote:

> Dear all,
>
> Is it possible with antlr to match a token exactly n times?
> Something like the following:
>
> ACCOUNT : NUMBER{8};
>
> NUMBER  :       ZERO
>        |       (NONZERO DIGIT*)
>        ;
> ZERO    :       '0';
> NONZERO :       '1'..'9';
> DIGIT   :       '0'..'9';
>
> Thanks,
> Jonne.
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From researcher0x00 at gmail.com  Sun Aug 28 07:33:01 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Sun, 28 Aug 2011 10:33:01 -0400
Subject: [antlr-interest] Match token {n} times
In-Reply-To: <CAOrgODZidcvpO4RqhD3LWMjKxoTKqW2RPYBjT8z4MtNv_yKqZQ@mail.gmail.com>
References: <CAJg62X9bq5UOA1xd5+9cFa1wKmjG0v+oZ8rU4G9uy1MSApubBw@mail.gmail.com>
	<CAOrgODZidcvpO4RqhD3LWMjKxoTKqW2RPYBjT8z4MtNv_yKqZQ@mail.gmail.com>
Message-ID: <CAN45N10q=3Y3YMQS8NDcqH=ayRO6LTMGRwy2EotkkwY9-9vLQA@mail.gmail.com>

> On Sun, Aug 28, 2011 at 3:20 PM, Jonne Zutt <jonne.zutt.ml at gmail.com>
> wrote:
>
> > Dear all,
> >
> > Is it possible with antlr to match a token exactly n times?
> > Something like the following:
> >
> > ACCOUNT : NUMBER{8};
> >
>

Hi Jonne,

Bart is correct in that matching a exact quantity is not built in to ANTLR,
and most likely never will. Exact quantities is a feature of Regular
Expressions.

If you are willing to work with gated semantic predicates it can be done.

>From the grammars page http://www.antlr.org/grammar/list download the Java
.class file grammar and take a look at classfile.g; specifically rule for
constant_utf8_info.

I believe it is a older v 2.x grammar but will put you in the ball park.

With this I was able to parse binary files, but eventually took a different
route that didn't use ANTLR.

If you are going to be doing lots of these types of rules in a single
grammar then you should really step back and consider if you want to abuse
ANTLR, and instead take a different approach.

Good Luck,
Eric

From jonne.zutt.ml at gmail.com  Sun Aug 28 13:26:25 2011
From: jonne.zutt.ml at gmail.com (Jonne Zutt)
Date: Sun, 28 Aug 2011 22:26:25 +0200
Subject: [antlr-interest] FEN grammar
Message-ID: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>

Hi all,

I made my first attempts to use antlr today.
Although I read some tutorials, example programs and a page about
common pitfalls, I stepped
into several pitfalls myself as well, I guess.
Is there anybody who wants to shed some light on the below grammar to
parse chess FEN strings
(see http://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation).

I am debugging with the string:
"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"
without the quotes (this is the initial position for chess).

I have several problems:
- I was using more tokens, but several are overlapping (e.g., for the
enPassant rule I used to have FILE RANK
  where RANK was a lexer token '1'..'8', but that overlaps with the
NUMBER token and also with pieces).
  I'm not sure how to deal with tokens that have overlap? Should they
always be changed into fragments?
  I wanted to make tokens for each piece as well. Such as KNIGHT : 'n'
| 'N'; But the bishop turns out to be
  quite overloaded as well (with BLACK and FILE).

- For some reason, 0 seems to match my NUMBER, but 1 does not match.
This is what the debugger shows
  me. If I switch 0 1 into 1 0, the halfmoveClock is not matching.

- If I press ctrl-Y in the AntlrWorks plugin, I loose all my data!!
arghh. In IntelliJ that is my shortcut to delete
  a line.

Below is my grammer. Any help / comments would be nice :)
Thanks,
Jonne.


grammar Fen;

input
	:	fen EOF;

fen
	:	piecePlacement WS activeColor WS castling WS enPassant WS
halfmoveClock WS fullmoveNumber;

piecePlacement
	:	pieces SEP pieces SEP pieces SEP pieces SEP pieces SEP pieces SEP
pieces SEP pieces;

pieces
	:	('p'|'P' | 'n'|'N' | 'b'|'B' | 'r'|'R' | 'q'|'Q' | 'k'|'K' | '1'..'8')+;

activeColor
	:	'w' | 'b';
	
castling
	:	NONE
	|	('K' | 'Q' | 'k' | 'q')+;
	
enPassant
	:	NONE
	|	FILE '1'..'8';
		
halfmoveClock
	:	NUMBER;

fullmoveNumber
	:	NUMBER;	
	
// LEXER

WS	:	(' ' | '\t')+;
SEP 	:	'/';

NONE	:	'-';
FILE	:	'a'..'h';
NUMBER  :       '0' | ('1'..'9' ('0'..'9')*);

From bkiers at gmail.com  Sun Aug 28 13:49:18 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Sun, 28 Aug 2011 22:49:18 +0200
Subject: [antlr-interest] FEN grammar
In-Reply-To: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
References: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
Message-ID: <CAOrgODbpDXHhCvB=g4TLy8xs0PXUQ9gpVY_pEdsUQxXGE9vx0Q@mail.gmail.com>

Hi Jonne,

*On Sun, Aug 28, 2011 at 10:26 PM, Jonne Zutt <jonne.zutt.ml at gmail.com>
 wrote:
*
>
> *...
>
>
> pieces
>        :       ('p'|'P' | 'n'|'N' | 'b'|'B' | 'r'|'R' | 'q'|'Q' | 'k'|'K' |
> '1'..'8')+;
> *


In parser rules, you _can_ use "literal tokens", but it's best to refrain
from doing this: create separate lexer rules for them. And the `..` (range
operator) is only valid inside lexer rules. So the rules `enPassant` and
`pieces` are not doing what you think they are.

Change those things and try your grammar again.

Regards,

Bart.

From bkiers at gmail.com  Sun Aug 28 14:36:50 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Sun, 28 Aug 2011 23:36:50 +0200
Subject: [antlr-interest] FEN grammar
In-Reply-To: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
References: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
Message-ID: <CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>

Hi Jonne,

After skimming through the Wiki page you mentioned, I realize what you mean
by "overlap". Then no, making fragments will not help you since you will
only know at parse-time if a digit should be a part of a `number` or a
`rank` or a `move`. Fragment rules are only for other fragment rules: the
parser has no notion of them.

I quickly hacked a FEN grammar together. I'm sure I goofed up some things,
but perhaps it's a starting point:

grammar Fen;

parse
  :  placement Space
     color     Space
     castling  Space
     enPassant Space
     number    Space
     number    EOF
  ;

placement
  :  place+ (FSlash place+)+
  ;

place
  :  piece
  |  Rank
  ;

color
  :  W_lc
  |  B_lc
  ;

castling
  :  Hyphen
  |  K_uc? Q_uc? K_lc? Q_lc? // Must macth at least one though! You can do
that by using a semantic predicate.
  ;

enPassant
  :  position
  |  Hyphen
  ;

position
  :  file Rank
  ;

file
  :  A_lc
  |  B_lc
  |  C_H_lc
  ;

number
  :  digit+
  ;

digit
  :  Zero
  |  Rank
  |  Nine
  ;

piece
  :  rook
  |  knight
  |  bishop
  |  queen
  |  king
  |  pawn
  ;

rook   : R_lc | R_uc;
knight : N_lc | N_uc;
bishop : B_lc | B_uc;
queen  : Q_lc | Q_uc;
king   : K_lc | K_uc;
pawn   : P_lc | P_uc;

FSlash : '/';
Space  : ' ';
Zero   : '0';
Rank   : '1'..'8';
Nine   : '9';
Hyphen : '-';
W_lc   : 'w';
R_lc   : 'r';
N_lc   : 'n';
A_lc   : 'a';
B_lc   : 'b';
C_H_lc : 'c'..'h';
Q_lc   : 'q';
K_lc   : 'k';
P_lc   : 'p';
R_uc   : 'R';
N_uc   : 'N';
B_uc   : 'B';
Q_uc   : 'Q';
K_uc   : 'K';
P_uc   : 'P';


Regards,

Bart.



On Sun, Aug 28, 2011 at 10:26 PM, Jonne Zutt <jonne.zutt.ml at gmail.com>wrote:

> Hi all,
>
> I made my first attempts to use antlr today.
> Although I read some tutorials, example programs and a page about
> common pitfalls, I stepped
> into several pitfalls myself as well, I guess.
> Is there anybody who wants to shed some light on the below grammar to
> parse chess FEN strings
> (see http://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation).
>
> I am debugging with the string:
> "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"
> without the quotes (this is the initial position for chess).
>
> I have several problems:
> - I was using more tokens, but several are overlapping (e.g., for the
> enPassant rule I used to have FILE RANK
>  where RANK was a lexer token '1'..'8', but that overlaps with the
> NUMBER token and also with pieces).
>  I'm not sure how to deal with tokens that have overlap? Should they
> always be changed into fragments?
>  I wanted to make tokens for each piece as well. Such as KNIGHT : 'n'
> | 'N'; But the bishop turns out to be
>  quite overloaded as well (with BLACK and FILE).
>
> - For some reason, 0 seems to match my NUMBER, but 1 does not match.
> This is what the debugger shows
>  me. If I switch 0 1 into 1 0, the halfmoveClock is not matching.
>
> - If I press ctrl-Y in the AntlrWorks plugin, I loose all my data!!
> arghh. In IntelliJ that is my shortcut to delete
>  a line.
>
> Below is my grammer. Any help / comments would be nice :)
> Thanks,
> Jonne.
>
>
> grammar Fen;
>
> input
>        :       fen EOF;
>
> fen
>        :       piecePlacement WS activeColor WS castling WS enPassant WS
> halfmoveClock WS fullmoveNumber;
>
> piecePlacement
>        :       pieces SEP pieces SEP pieces SEP pieces SEP pieces SEP
> pieces SEP
> pieces SEP pieces;
>
> pieces
>        :       ('p'|'P' | 'n'|'N' | 'b'|'B' | 'r'|'R' | 'q'|'Q' | 'k'|'K' |
> '1'..'8')+;
>
> activeColor
>        :       'w' | 'b';
>
> castling
>        :       NONE
>        |       ('K' | 'Q' | 'k' | 'q')+;
>
> enPassant
>        :       NONE
>        |       FILE '1'..'8';
>
> halfmoveClock
>        :       NUMBER;
>
> fullmoveNumber
>        :       NUMBER;
>
> // LEXER
>
> WS      :       (' ' | '\t')+;
> SEP     :       '/';
>
> NONE    :       '-';
> FILE    :       'a'..'h';
> NUMBER  :       '0' | ('1'..'9' ('0'..'9')*);
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From espina.edgar at gmail.com  Sun Aug 28 14:38:28 2011
From: espina.edgar at gmail.com (Edgar Espina)
Date: Sun, 28 Aug 2011 18:38:28 -0300
Subject: [antlr-interest] ANTLR IDE 2.1.2 is out!
Message-ID: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>

Hey,

 A new version of ANTLR IDE is available for download. This version
includes:
  * ANTLR 3.4 support
  * Eclipse Indigo support.

Thanks.
-- 
edgar

From parrt at cs.usfca.edu  Sun Aug 28 14:41:01 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 28 Aug 2011 14:41:01 -0700
Subject: [antlr-interest] Squirrel away the trees, call on the visitors
Message-ID: <EB3C1487-D0DA-4A8D-8101-2BD8F5EC84AB@cs.usfca.edu>

Oliver Zeigermann and I have been discussing the potential for automatic tree and visitor construction in ANTLR v4. I wrote up some of my thoughts, including how we could hide tree construction entirely while still getting visitors:

http://bit.ly/ouwfcc

Ter

From parrt at cs.usfca.edu  Sun Aug 28 14:46:14 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 28 Aug 2011 14:46:14 -0700
Subject: [antlr-interest] ANTLR IDE 2.1.2 is out!
In-Reply-To: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
References: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
Message-ID: <953F1A07-88BE-470C-88CD-F63A134333C2@cs.usfca.edu>

Congratulations on your hard work, Edgar!
Ter
On Aug 28, 2011, at 2:38 PM, Edgar Espina wrote:

> Hey,
> 
> A new version of ANTLR IDE is available for download. This version
> includes:
>  * ANTLR 3.4 support
>  * Eclipse Indigo support.
> 
> Thanks.
> -- 
> edgar
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From gary at sumwise.com  Sun Aug 28 16:50:37 2011
From: gary at sumwise.com (Gary Miller)
Date: Mon, 29 Aug 2011 09:50:37 +1000
Subject: [antlr-interest] Match token {n} times
In-Reply-To: <CAN45N10q=3Y3YMQS8NDcqH=ayRO6LTMGRwy2EotkkwY9-9vLQA@mail.gmail.com>
References: <CAJg62X9bq5UOA1xd5+9cFa1wKmjG0v+oZ8rU4G9uy1MSApubBw@mail.gmail.com>
	<CAOrgODZidcvpO4RqhD3LWMjKxoTKqW2RPYBjT8z4MtNv_yKqZQ@mail.gmail.com>
	<CAN45N10q=3Y3YMQS8NDcqH=ayRO6LTMGRwy2EotkkwY9-9vLQA@mail.gmail.com>
Message-ID: <CAFCNb3heg3gKwkMwmb_uvgiF3F0O_xfYAAKGOSiwse0vn7FQ5w@mail.gmail.com>

Hi Jonne,

Take a look at "The Definitive ANTLR Reference"
http://pragprog.com/book/tpantlr/the-definitive-antlr-reference

Page 294 The Three Semantic Predicate Variations

"
Consider the problem of matching an element at most four times.

data: BYTE BYTE BYTE BYTE
| BYTE BYTE BYTE
| BYTE BYTE
| BYTE
;

validating semantic predicate.
data: ( b+=BYTE )+ {$b.size()<=4}?
;

gated semantic predicate
data
@init {int n=1;} // n becomes a local variable
: ( {n<=4}?=> BYTE {n++;} )+ // enter loop only if n<=4
;
"

There are also disambiguating semantic predicate {?expression?}?
before the match.

Hope this helps.

Regards
Gary

On Mon, Aug 29, 2011 at 12:33 AM, The Researcher
<researcher0x00 at gmail.com> wrote:
>> On Sun, Aug 28, 2011 at 3:20 PM, Jonne Zutt <jonne.zutt.ml at gmail.com>
>> wrote:
>>
>> > Dear all,
>> >
>> > Is it possible with antlr to match a token exactly n times?
>> > Something like the following:
>> >
>> > ACCOUNT : NUMBER{8};
>> >
>>
>
> Hi Jonne,
>
> Bart is correct in that matching a exact quantity is not built in to ANTLR,
> and most likely never will. Exact quantities is a feature of Regular
> Expressions.
>
> If you are willing to work with gated semantic predicates it can be done.
>
> >From the grammars page http://www.antlr.org/grammar/list download the Java
> .class file grammar and take a look at classfile.g; specifically rule for
> constant_utf8_info.
>
> I believe it is a older v 2.x grammar but will put you in the ball park.
>
> With this I was able to parse binary files, but eventually took a different
> route that didn't use ANTLR.
>
> If you are going to be doing lots of these types of rules in a single
> grammar then you should really step back and consider if you want to abuse
> ANTLR, and instead take a different approach.
>
> Good Luck,
> Eric
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From bill.andersen at mac.com  Sun Aug 28 17:08:41 2011
From: bill.andersen at mac.com (Bill Andersen)
Date: Sun, 28 Aug 2011 17:08:41 -0700
Subject: [antlr-interest] Quick ANTLR/ST question
In-Reply-To: <33B3DDC2-6CD9-4501-BF30-B999584880AB@mac.com>
References: <33B3DDC2-6CD9-4501-BF30-B999584880AB@mac.com>
Message-ID: <C19F5849-B754-4124-9775-0BFDEBEAFE1D@mac.com>

Nevermind, answered my own question with some dim memories and some playing around.

On Aug 26, 2011, at 11:15 , Bill Andersen wrote:

> Hi all...
> 
> I have the following production alternative:
> 
>  | ^(ASTERISK e1=unary_expression e2=unary_expression)
> 
> and want to use templates that look like this in my STG:
> 
>     app2(op,e1,e2) ::= "<op>(<e1>,<e2>)"
> 
>     op_ASTERISK() ::= "mult"
> 
> Question is - if I want to keep the translation of ASTERISK in the STG, how do I express the template return in the alternative above.  E.g.,
> 
>  | ^(ASTERISK e1=unary_expression e2=unary_expression)
>         -> app2(op=???, e1={$e1.st}, e2={$e2.st})
> 
> What goes in the place of ??? to cause op_ASTERISK() to be inserted into the resulting ST?

The answer is:

	-> app2(op={%op_ASTERISK()}, e1={$e1.st}, e2={$e2.st})

Could not find this in any doc to save my life, but the generated code is correct.

> 
> Using ANTLR 3.3 / ST 3...
> 
> Thanks
> 
> 	.bill
> 
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address



From wclodius at los-alamos.net  Sun Aug 28 17:55:42 2011
From: wclodius at los-alamos.net (William Clodius)
Date: Sun, 28 Aug 2011 18:55:42 -0600
Subject: [antlr-interest] Match token {n} times
In-Reply-To: <CAOrgODZidcvpO4RqhD3LWMjKxoTKqW2RPYBjT8z4MtNv_yKqZQ@mail.gmail.com>
References: <CAJg62X9bq5UOA1xd5+9cFa1wKmjG0v+oZ8rU4G9uy1MSApubBw@mail.gmail.com>
	<CAOrgODZidcvpO4RqhD3LWMjKxoTKqW2RPYBjT8z4MtNv_yKqZQ@mail.gmail.com>
Message-ID: <DB869294-D46F-4728-AAA6-E77E8656AF78@los-alamos.net>

Janne:

While it can be done using syntactic analysis, this sort of problem is almost invariably best addressed with semantic analysis and not with syntactic analysis. Semantic analysis allows the ready identification of common errors, e.g. if the input has dropped the whitespace between numbers, or if the creator of the input has lost track and repeated a number. A common problem with novices attempting to implement language analysis is to believe that their task is simplified by moving sophisticated tasks to conceptually simple tasks. They will try to simplify semantic analysis by creating a more detailed syntactic analysis and syntactic analysis by creating a more detailed lexical analysis. Almost invariably they discover that this attempt is fruitless and has to be undone, because it results in poor error reporting, runs into conflicts as the implementation becomes more complete, duplicates functionality in the later portions of the analysis, and is hard to maintain. For example I suspect that your account has an underlying structure: e.g.

ACCOUNT
    : BankID BranchID AccountType UserID ...

On Aug 28, 2011, at 7:23 AM, Bart Kiers wrote:

> Hi Jonne,
> 
> No, that is not possible with a quantifier like {x}. You'll have to do it
> the "hard" way:
> 
> ACCOUNT
>  :  NUMBER NUMBER NUMBER NUMBER NUMBER NUMBER NUMBER NUMBER
>  ;
> 
> Regards,
> 
> Bart.
> 
> 
> On Sun, Aug 28, 2011 at 3:20 PM, Jonne Zutt <jonne.zutt.ml at gmail.com> wrote:
> 
>> Dear all,
>> 
>> Is it possible with antlr to match a token exactly n times?
>> Something like the following:
>> 
>> ACCOUNT : NUMBER{8};
>> 
>> NUMBER  :       ZERO
>>       |       (NONZERO DIGIT*)
>>       ;
>> ZERO    :       '0';
>> NONZERO :       '1'..'9';
>> DIGIT   :       '0'..'9';
>> 
>> Thanks,
>> Jonne.
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From bkiers at gmail.com  Mon Aug 29 00:24:54 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Mon, 29 Aug 2011 09:24:54 +0200
Subject: [antlr-interest] FEN grammar
In-Reply-To: <CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
References: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
	<CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
Message-ID: <CAOrgODaa95WaNAavCZ-JvDqg=Z+XzrOvssHrfjKz5pzbrCmr6Q@mail.gmail.com>

On Sun, Aug 28, 2011 at 11:36 PM, Bart Kiers <bkiers at gmail.com> wrote:

> ... Fragment rules are only for other *fragment* rules: the parser has no
> notion of them. ...
>
>
Correction, I meant to say: *Fragment rules are only for other lexer rule**s
...*
Note that you can also call a fragment from another fragment rule.

Regards,

Bart.

From bkiers at gmail.com  Mon Aug 29 00:25:56 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Mon, 29 Aug 2011 09:25:56 +0200
Subject: [antlr-interest] FEN grammar
In-Reply-To: <CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
References: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
	<CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
Message-ID: <CAOrgODabiVfudBzvjz5qnA_Dpc=V3ZD12pEiaPJ7T_BMVzH7Rw@mail.gmail.com>

On Sun, Aug 28, 2011 at 11:36 PM, Bart Kiers <bkiers at gmail.com> wrote:

> ... Fragment rules are only for other *fragment* rules: the parser has no
> notion of them. ...
>
>
Correction, I meant to say: *Fragment rules are only for other lexer rule**s
...*
Note that you can also call a fragment from another fragment rule.

Regards,

Bart.

From bkiers at gmail.com  Mon Aug 29 00:24:54 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Mon, 29 Aug 2011 09:24:54 +0200
Subject: [antlr-interest] FEN grammar
In-Reply-To: <CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
References: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
	<CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
Message-ID: <CAOrgODaa95WaNAavCZ-JvDqg=Z+XzrOvssHrfjKz5pzbrCmr6Q@mail.gmail.com>

On Sun, Aug 28, 2011 at 11:36 PM, Bart Kiers <bkiers at gmail.com> wrote:

> ... Fragment rules are only for other *fragment* rules: the parser has no
> notion of them. ...
>
>
Correction, I meant to say: *Fragment rules are only for other lexer rule**s
...*
Note that you can also call a fragment from another fragment rule.

Regards,

Bart.

From bkiers at gmail.com  Mon Aug 29 00:24:54 2011
From: bkiers at gmail.com (Bart Kiers)
Date: Mon, 29 Aug 2011 09:24:54 +0200
Subject: [antlr-interest] FEN grammar
In-Reply-To: <CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
References: <CAJg62X892=Urge6mzODAz-JX=x6sva8uE1gzgB7XaQN8VBRXXw@mail.gmail.com>
	<CAOrgODawFMzWN=k7Azirg4riNdOLB=47ksQD4AU965ZRyW7THA@mail.gmail.com>
Message-ID: <CAOrgODaa95WaNAavCZ-JvDqg=Z+XzrOvssHrfjKz5pzbrCmr6Q@mail.gmail.com>

On Sun, Aug 28, 2011 at 11:36 PM, Bart Kiers <bkiers at gmail.com> wrote:

> ... Fragment rules are only for other *fragment* rules: the parser has no
> notion of them. ...
>
>
Correction, I meant to say: *Fragment rules are only for other lexer rule**s
...*
Note that you can also call a fragment from another fragment rule.

Regards,

Bart.

From error0x2b1 at googlemail.com  Mon Aug 29 04:01:59 2011
From: error0x2b1 at googlemail.com (Anonym)
Date: Mon, 29 Aug 2011 13:01:59 +0200
Subject: [antlr-interest] Exceptions on C#-Target
Message-ID: <4E5B71A7.40105@googlemail.com>

i?m working with antlrworks 1.4.2
i have the following, extremly simple grammar (combined lexer and parser):
*
public sqlfile :
commands*
EOF
;

commands:
STARTWORD (options { greedy=false; } : .*) SEM
;

STARTWORD
: ('SELECT'|'INSERT'|'UPDATE'|'DELETE')
;

SEM : ';' ;

COMMENT : '/*' ( options { greedy=false; } : .*) '*/'
{
$channel = 2;
}
;

SHARP
: '#' ( options { greedy=false; } : .*) NL
{
$channel = 2;
}
;
SINGLELINECOMMENT
: '--' ( options { greedy=false; } : .*) NL
{
$channel = 2;
}
;
WS : (' '|'\t')+ { $channel = 5; } ;
NL : ('\r' '\n'? | '\n') { $channel = 5; } ;
*

i?ve debugged it in antlrworks and works fine (as expected). i used this
test-string:
*--
-- SQL to create the guestbook table
--


CREATE TABLE `guestbook` (
`id` int(11) NOT NULL auto_increment,
`TimeStamp` int(11) default '0',
`Email` varchar(60) default NULL,
`Name` varchar(100) NOT NULL default '',
`Website` varchar(60) default NULL,
`Title` varchar(255) default NULL,
`Message` text,
`Verified` smallint(1) NOT NULL default '0',
`Code` varchar(40) NOT NULL default '',
UNIQUE KEY `id` (`id`)
) TYPE=MyISAM AUTO_INCREMENT=6 ;
*

then i build against csharp3-target and used the parser in my
c#-application.
while executing the parser.sqlfile()-Method 317 Exceptions
(MissmatchToken and NoViableAlt) are thrown!
now i wonder why, because my grammar is REALLY simple and should match,
like it in the java-target did (no error in antlrworks-console).
In the C#-Output the exceptions are thrown at the line
STARTWORD1=(IToken)Match(input,STARTWORD,Follow._STARTWORD_in_commands135);
in commands()-Rule

where is my mistake?


From contact at maik-schmidt.de  Mon Aug 29 11:01:56 2011
From: contact at maik-schmidt.de (pragmaik)
Date: Mon, 29 Aug 2011 11:01:56 -0700 (PDT)
Subject: [antlr-interest] Problems with Tree Grammars
	outputting	Templates in C#
In-Reply-To: <1314333958377-6727380.post@n2.nabble.com>
References: <CACotV_1HAyNAUZuABywR7Y0ofqpeyYWDYAfNgXkEu6mbtZ0nVA@mail.gmail.com>
	<1314297527495-6725691.post@n2.nabble.com>
	<0c6f01cc6363$82ac16d0$88044470$@pixelminegames.com>
	<1314333958377-6727380.post@n2.nabble.com>
Message-ID: <1314640916157-6738756.post@n2.nabble.com>

Hi Sam!

Do you have any news regarding this topic?

Cheers,

Maik


--
View this message in context: http://antlr.1301665.n2.nabble.com/Problems-with-Tree-Grammars-outputting-Templates-in-C-tp6724828p6738756.html
Sent from the ANTLR mailing list archive at Nabble.com.

From oliver.zeigermann at gmail.com  Mon Aug 29 12:55:26 2011
From: oliver.zeigermann at gmail.com (Oliver Zeigermann)
Date: Mon, 29 Aug 2011 21:55:26 +0200
Subject: [antlr-interest] ANTLR IDE 2.1.2 is out!
In-Reply-To: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
References: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
Message-ID: <CABJr57D0ejOA5ELgpoUxH6MvTg5FBpCctSFe9Lcve9kVdUY8Kw@mail.gmail.com>

He, Edgar!

Thanks a lot, works well!

Olivrt
Am 28.08.2011 23:39 schrieb "Edgar Espina" <espina.edgar at gmail.com>:
> Hey,
>
> A new version of ANTLR IDE is available for download. This version
> includes:
> * ANTLR 3.4 support
> * Eclipse Indigo support.
>
> Thanks.
> --
> edgar
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From gary at sumwise.com  Mon Aug 29 17:42:52 2011
From: gary at sumwise.com (Gary Miller)
Date: Tue, 30 Aug 2011 10:42:52 +1000
Subject: [antlr-interest] ANTLR IDE 2.1.2 is out!
In-Reply-To: <CABJr57D0ejOA5ELgpoUxH6MvTg5FBpCctSFe9Lcve9kVdUY8Kw@mail.gmail.com>
References: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
	<CABJr57D0ejOA5ELgpoUxH6MvTg5FBpCctSFe9Lcve9kVdUY8Kw@mail.gmail.com>
Message-ID: <CAFCNb3gwn_VtHbqZSBET4S=-ni1Azg0rFhyD1NmTSUjywgAo0g@mail.gmail.com>

Much appreciated. Thanks.

From kferrio at gmail.com  Mon Aug 29 18:10:15 2011
From: kferrio at gmail.com (Kyle Ferrio)
Date: Mon, 29 Aug 2011 18:10:15 -0700
Subject: [antlr-interest] ANTLR IDE 2.1.2 is out!
In-Reply-To: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
References: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
Message-ID: <CAAfeETqwM7NUsKtd0tEO18q5XgzuUDLZSoY4K9qHwKkNWQkHog@mail.gmail.com>

Thank you!  ANTLR IDE is a great tool and having it work with Indigo is a
huge help.
On Aug 28, 2011 2:39 PM, "Edgar Espina" <espina.edgar at gmail.com> wrote:
> Hey,
>
> A new version of ANTLR IDE is available for download. This version
> includes:
> * ANTLR 3.4 support
> * Eclipse Indigo support.
>
> Thanks.
> --
> edgar
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From ruslan_zasukhin at valentina-db.com  Tue Aug 30 00:01:05 2011
From: ruslan_zasukhin at valentina-db.com (Ruslan Zasukhin)
Date: Tue, 30 Aug 2011 10:01:05 +0300
Subject: [antlr-interest] reuse() methos in 3.4 C runtime
In-Reply-To: <7c0bbbf0ff9affa15bf236fadbb6bd26@mail.gmail.com>
Message-ID: <CA826561.F1512%ruslan_zasukhin@valentina-db.com>

On 6/24/11 7:49 PM, "Jim Idle" <jimi at temporal-wave.com> wrote:

Hi Jim,

I do now third attempt switch from ANTLR2 to ANTLR3,

And reuse is very important for us, because we do parse SQL strings in the
DBMS servers ... 
I am very happy to read it should work now again in 3.4!

But I have got question after this your letter.

You say that TreeParser cannot be reused. Then:

A) what do method reset() in the generated TreeParser?
    can/should we use it?  If yes when and for what?

B) Do you mean that on each loop we must free() Nodes and TreeParser
        nodes   ->free( nodes );        nodes   = NULL;
       treePsr ->free( treePsr );      treePsr = NULL;

And then create them again

    nodes   = antlr3CommonTreeNodeStreamNewTree(langAST.tree,
ANTLR3_SIZE_HINT); 
    treePsr = SqlTreeParser_v3New( nodes );


Or I can just do on each loop
    treePsr->reset( treePsr  );


Thank you in advance for explain


> Because the documentation is not yet up to date, here is an example of
> reusing the allocated memory in input streams and token streams:
> 
> 
> 
>     for (i=0; i<iterations; i++) {
> 
> 
> 
>         // Run the parser.
> 
>         //
> 
>         psr->start(psr);
> 
> 
> 
>         // --------------------------------------
> 
>         // Now reset everything for the next run.
> 
>         // Order of calls is important.
> 
> 
> 
>         // Input stream can now be reused
> 
>         //
> 
>         input->reuse(input, sourceCode, sourceLen, sourceName);
> 
> 
> 
>         // Reset the common token stream so that it will reuse its resources
> 
>         //
> 
>         tstream->reset(tstream);
> 
> 
> 
>         // Reset the lexer (new function generated by antlr now)
> 
>         //
> 
>         lxr->reset(lxr);
> 
> 
> 
>         // Reset the parser (new function generated by antlr now)
> 
>         //
> 
>         psr->reset(psr);
> 
>     }
> 
> 
> 
> Note that tree parsers cannot reuse their allocations but this is rarely an
> issue. The input->reuse() will reuse any memory it has allocated, but
> requires that you handle the reading of the input files (or otherwise supply
> a pointer to them). The input files are assumed to be encoded in the way
> that the original input was created, for instance:
> 
> 
> 
> input       = antlr3FileStreamNew(fname, ANTLR3_ENC_8BIT);
> 
> 
> 
> Then all reused input must be 8 bit encoded.
> 
> 
> 
> Jim
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 

-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]


From WeikEngOff at aol.com  Tue Aug 30 03:43:27 2011
From: WeikEngOff at aol.com (Udo Weik)
Date: Tue, 30 Aug 2011 12:43:27 +0200
Subject: [antlr-interest] ANTLR IDE 2.1.2 is out! - Problem...
In-Reply-To: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
References: <CAGWJpGYVNZ_gzO-Krca2EhJgPQ+hY1VqwN47s0NTF-NAamgRWQ@mail.gmail.com>
Message-ID: <4E5CBECF.7010304@aol.com>

Hello Edgar,

>   A new version of ANTLR IDE is available for download. This version
> includes:
>    * ANTLR 3.4 support
>    * Eclipse Indigo support.

yep, really a great tool. Many thanks for it.-


I have the problem that no Java-files (lexer/parser) are created after saving a grammar:
- using Indigo/64Bit
- is it sufficient to use
   ...\antlr-3.4\lib\antlr-3.4-complete.jar
   as installed package -  ...\antlr-3.4\lib\ contains
   just that file: antlr-3.4-complete.jar
- I created a new Java-project and added ANTLR via File -> New -> Other ->
   ANTLR -> Combined Grammar
   On
   http://antlrv3ide.sourceforge.net/doc/gettingstarted/basictutorial/addingantlrsupport.html
   ANTLR is shown in the file menu above "Properties".
- I can run the grammar with F5 (or via the corresponding menu button),
   a diagram is shown. But the buttons "Run (Java)" and "Debug (Java)"
   are grayed (because the lexer/parser-files aren't created?)
- I can see ANTLR via Windows -> Preferences, but not via
   Project -> Properties

Any hints? When you need mor infos pls. ask!

Concerning your www.pages: When I open an HTML-document from
http://antlrv3ide.sourceforge.net/
tab "Documentation"
and press the "Back"-button of FF, the tab "Welcome" is then shown.


Many thanks and greetings
Udo

From ruslan_zasukhin at valentina-db.com  Tue Aug 30 06:17:00 2011
From: ruslan_zasukhin at valentina-db.com (Ruslan Zasukhin)
Date: Tue, 30 Aug 2011 16:17:00 +0300
Subject: [antlr-interest] [C] Crashes if NULL name in antlr3StringStreamNew()
Message-ID: <CA82BD7C.F1566%ruslan_zasukhin@valentina-db.com>


If I call

    input = antlr3StringStreamNew(
        input_string, Encoding, input_len, NULL );
            
NULL is name of stream
Then it crashes inside of


newStr8    (pANTLR3_STRING_FACTORY factory, pANTLR3_UINT8 ptr)
{
    return factory->newPtr8(factory, ptr,
         (ANTLR3_UINT32)strlen((const char *)ptr));        <<<<<< crash
}


Because on mac and linux strlen()  crashes on NULL.



-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]



From wujek.srujek at googlemail.com  Tue Aug 30 07:06:24 2011
From: wujek.srujek at googlemail.com (Wujek Srujek)
Date: Tue, 30 Aug 2011 16:06:24 +0200
Subject: [antlr-interest] Multiple newlines question
Message-ID: <CAAuGTBg0V_-3V-Q8N8PcX3EfsDc1MoBXgy7yHtmgcDOgLOtVGw@mail.gmail.com>

Hi. I am very new to parser generators, BNF grammars and stuff. I am reading
The definitive ANTLR reference and try things out. Currently I have the
following simple grammar:

grammar Test;

@header {
package test;
}

@lexer::header {
package test;
}

program:
    INT (NEWLINE+ INT)* EOF;

INT: '0'..'9'+;
NEWLINE: '\r'?'\n';
WS: (' ' | '\t' | '\r' | '\n')+ {skip();};


and the following test (TestNG):


package test;


import org.antlr.runtime.ANTLRStringStream;
import org.antlr.runtime.CommonTokenStream;
import org.antlr.runtime.TokenStream;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;


public class ANTLRTest {

    @DataProvider(name = "data")
    public Object[][] getData() {
        return new Object[][] {
                { "1\n2\n\n3" }
                };
    }

    @Test(dataProvider = "data")
    public void test(String value) throws Exception {
        ANTLRStringStream in = new ANTLRStringStream(value);
        TestLexer l = new TestLexer(in);
        TokenStream ts = new CommonTokenStream(l);
        TestParser p = new TestParser(ts);
        p.program();
    }
}


So, a program is an INT, followed by a sequence of one or many NEWLINES
followed by an INT; at the very end is an EOF (I think I have to do it to
force ANTLR read the whole input?). However, I get the following error
printed out to stderr:

line 4:0 extraneous input '3' expecting EOF

The parser doesn't like the two adjacent newlines. If I leave only one, it
works without errors, but I would like it to be able to deal with multiple
newlines.

Could anybody more experienced with me please take a look and tell me what I
am doing wrong here?


Q2. The same rules (almost - the newlines) are in the NEWLINE and WS tokens
- how does it work that once the newlines are matched and sometimes skipped?
Is the sequence in the grammar file important in this case?

Q3. For some reason, I get the errors printed out on System.err, and the
test passes even with errors. This is not exactly what I would need, I would
need it to fail laudly on any erros (be it lexical or parsing). Any quick
pointer would be nice, but if not, I guess the book will deal cover it
sooner or later.

Best regards,
wujek

From macolange at gmail.com  Tue Aug 30 09:51:56 2011
From: macolange at gmail.com (Maximilien Colange)
Date: Tue, 30 Aug 2011 18:51:56 +0200
Subject: [antlr-interest] [C target] bug in hidden syntactic predicates
Message-ID: <4E5D152C.8070506@gmail.com>

Hi,

I've been using antlr for a few months in order to parse logical 
formulae, with the C target.

I have a rule in a parser such as
subformula:
       atom
     | term (x='and' term)+  -> ^($x term+)
     | term ('or' term)+    -> ^('or' term+)
     | term
     ;

As far as i have understood, antlr generates a syntactic predicate in 
order to distinguish between the 'and' and 'or' alternatives.
In the case as presented above, the code of such a predicate is 
incorrect, as it begins with :
     pANTLR3_COMMON_TOKEN    ;
            = NULL ;
It looks like the name x is omitted in this declaration, though it 
appears later in the code.

I don't actually need to name the token 'and', and deleting x fixes the 
problem.
Expliciting the syntactic predicate seems to fix it as well.
I also noted that the bug does not appear without the +.

Hope this may help improving this great tool:-)

-- 
Max

From researcher0x00 at gmail.com  Tue Aug 30 11:11:33 2011
From: researcher0x00 at gmail.com (The Researcher)
Date: Tue, 30 Aug 2011 14:11:33 -0400
Subject: [antlr-interest] Is this a Maven related bug? syntax error @[1,
	9] in ._Antlr3ErrorLog.java
Message-ID: <CAN45N12YQiF7i2LQW+Y21c4usOiJ6qfCh68jnU=KrBmt-GSWDQ@mail.gmail.com>

Hi,

This is my first time using Maven.

My goal was to build the Tool because I needed to flip a debug flag in the
analysis code.
Yes, I know that I probably only need uber jar, but for first time I stuck
to the instructions.

I based this on the instructions in BUILD.txt.
Yes I did read the comments in ANTLR-3.4/pom.xml.

Since I am using snapshots on a Virtual Machine, I did it three times,
restoring the snapshot each time, to make sure it was reproducible.

So,

Maven command works.

student at antlr:~$ mvn --version
Apache Maven 3.0.3 (r1075438; 2011-02-28 12:31:09-0500)
Maven home: /usr/local/apache-maven/apache-maven-3.0.3
Java version: 1.6.0_18, vendor: Sun Microsystems Inc.
Java home: /usr/lib/jvm/java-6-openjdk/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "2.6.32-5-686", arch: "i386", family: "unix"
student at antlr:~$


Maven install worked

student at antlr:~/antlr-3.4$ mvn -N install
...


[INFO] Installing /home/student/antlr-3.4/pom.xml to
/home/student/.m2/repository/org/antlr/antlr-master/3.4/antlr-master-3.4.pom
[INFO]
------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO]
------------------------------------------------------------------------
[INFO] Total time: 1:10.373s
[INFO] Finished at: Tue Aug 30 13:29:46 EDT 2011
[INFO] Final Memory: 3M/6M
[INFO]
------------------------------------------------------------------------
student at antlr:~/antlr-3.4$


Build of ANTLR-3.4 failed for Maven plugin.


 student at antlr:~/antlr-3.4$ mvn -Dmaven.test.skip=true
[INFO] Using 'UTF-8' encoding to read mojo metadata.
[INFO] Applying mojo extractor for language: java
[INFO]
------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO]
[INFO] ANTLR Master build control POM 3.4 ................ SUCCESS [0.391s]
[INFO] Antlr 3.4 Runtime ................................. SUCCESS [44.632s]
[INFO] ANTLR Grammar Tool v 3.4 .......................... SUCCESS [31.997s]
[INFO] Maven plugin for ANTLR V3.4 ....................... FAILURE
[1:07.349s]
[INFO] ANTLR gUnit v3.4 .................................. SKIPPED
[INFO] Maven plugin for gUnit ANTLR V3.4 ................. SKIPPED
[INFO] ANTLR3 Maven Archetype 3.4 ........................ SKIPPED
[INFO]
------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO]
------------------------------------------------------------------------
[INFO] Total time: 3:09.551s
[INFO] Finished at: Tue Aug 30 13:46:56 EDT 2011
[INFO] Final Memory: 18M/52M
[INFO]
------------------------------------------------------------------------
[ERROR] Failed to execute goal
org.apache.maven.plugins:maven-plugin-plugin:2.7:descriptor
(default-descriptor) on project antlr3-maven-plugin: Execution
default-descriptor of goal
org.apache.maven.plugins:maven-plugin-plugin:2.7:descriptor failed: syntax
error @[1,9] in
file:/home/student/antlr-3.4/antlr3-maven-plugin/src/main/java/org/antlr/mojo/antlr3/._Antlr3ErrorLog.java
-> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e
switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please
read the following articles:
[ERROR] [Help 1]
http://cwiki.apache.org/confluence/display/MAVEN/PluginExecutionException
[ERROR]
[ERROR] After correcting the problems, you can resume the build with the
command
[ERROR]   mvn <goals> -rf :antlr3-maven-plugin
student at antlr:~/antlr-3.4$

I took a look at the file  ._Antlr3ErrorLog.java and it is not all text.

If you need more detail, don't hesitate to ask.

Thanks,

Eric

From miller.garym at gmail.com  Tue Aug 30 19:40:25 2011
From: miller.garym at gmail.com (Gary Miller)
Date: Wed, 31 Aug 2011 12:40:25 +1000
Subject: [antlr-interest] Rob Pike on writing a lexer in Go for a template
	language
Message-ID: <CAFCNb3iS8Mzs_=0x_yyWoYKboWf7tKEFxnZpyyWgP8XbMhSDgw@mail.gmail.com>

Hey All,

Slightly off topic post, I thought there might be some interest.

Last night I went to a talk by Rob Pike of Google, you can watch the talk at
   https://www.youtube.com/watch?v=HxaD_trXwRE&feature=player_embedded

Before I went my thinking was that this could probably be knocked up
in ANTLR in a few minutes, but then ....
All the uncomfort I have with ANTLR lexering came back to me.
So I though I'd go to the source and have a look at the lexer for ST,
and low and behold ST's lexer is written by hand.
Now I'm feeling quite uncomfortable about ANTLR's lexing.

I think it basically comes down to the stateless nature of the ANTLR lexing.
Not the first time context-sensitive scanning has been mentioned on
the list (*).
Yes I know that it can be made statefull (*) and/or I can push more
onto the parser, but both of these have issues.
Statefull ANTLR lexing code I generally find more confusing and harder
to write then functionally equivalent code in a target language.
Pushing more into the parser in this particular case is inefficient as
there are large chunks of text that doesn't need to be tokenized and
there is the issue the whitespace tokens might need to behaving
differently in different places (hidden verse not).


Started off as an off topic post, ended as a rant about lexing regards
Gary
P.S. I've started on the ANTLR target for Go, still very immature.
https://github.com/millergarym/antlr/tree/,

* Scott Stanchfield's context-sensitive scanning
http://javadude.com/articles/antlr-context-sensitive-scanner.html

* a good example of this is Jim's numerical lexing for JavaFX
http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point,+dot,+range,+time+specs

From ramanand_mandayam at yahoo.com  Tue Aug 30 19:41:50 2011
From: ramanand_mandayam at yahoo.com (Ramanand)
Date: Tue, 30 Aug 2011 19:41:50 -0700
Subject: [antlr-interest] -debug option with C code
Message-ID: <4E5D9F6E.2080606@yahoo.com>

Hi

I am using ANTLR v3.4 to generate a parser in C. The generated grammar 
compiles with no problems on my Linux machine with GCC.

When I use the -debug option then ANTLR adds a whole bunch of location 
tracking information such as DBG->location(DBG, M, N).
I am guessing that the  M and N are line number and column number 
respectively.

However the very first call to the DBG->location function for every 
terminal in the grammar is missing the 3rd parameter.
The output file contains the call as
     DBG->location(DBG, M, )    // notice that N is not printed in the 
generated C file.

However the function call seems to be correctly printed for nested 
syntactical constructs on the right hand side of a production/rule.

Is the -debug option not fully supported in ANTLR v3.4 with C target?

Cheers

Ramanand


From ruslan_zasukhin at valentina-db.com  Tue Aug 30 23:35:00 2011
From: ruslan_zasukhin at valentina-db.com (Ruslan Zasukhin)
Date: Wed, 31 Aug 2011 09:35:00 +0300
Subject: [antlr-interest] [C] Crashes if NULL name in
 antlr3StringStreamNew()
In-Reply-To: <CA82BD7C.F1566%ruslan_zasukhin@valentina-db.com>
Message-ID: <CA83B0C4.F15EA%ruslan_zasukhin@valentina-db.com>

On 8/30/11 4:17 PM, "Ruslan Zasukhin" <ruslan_zasukhin at valentina-db.com>
wrote:

> 
> If I call
> 
>     input = antlr3StringStreamNew(
>         input_string, Encoding, input_len, NULL );
>             
> NULL is name of stream
> Then it crashes inside of
> 
> 
> newStr8    (pANTLR3_STRING_FACTORY factory, pANTLR3_UINT8 ptr)
> {
>     return factory->newPtr8(factory, ptr,
>          (ANTLR3_UINT32)strlen((const char *)ptr));        <<<<<< crash
> }
> 
> 
> Because on mac and linux strlen()  crashes on NULL.

In contrast to above, new  reuse() method can handle stream name as NULL,
Replacing to ?-memory-? name.


========================================================
antlr38BitReuse(pANTLR3_INPUT_STREAM input, pANTLR3_UINT8 inString,
ANTLR3_UINT32 size, pANTLR3_UINT8 name)
{
    input->isAllocated    = ANTLR3_FALSE;
    input->data        = inString;
    input->sizeBuf    = size;
    
    // Now we can set up the file name. As we are reusing the stream, there
may already
    // be a string that we can reuse for holding the filename.
    //
    if    (input->istream->streamName == NULL)
    {
        input->istream->streamName    =
input->strFactory->newStr(input->strFactory, name == NULL ?
(pANTLR3_UINT8)"-memory-" : name);
        input->fileName        = input->istream->streamName;
    }
    else
    {
        input->istream->streamName->set(input->istream->streamName,  (name
== NULL ? (const char *)"-memory-" : (const char *)name));
    }

    input->reset(input);
}



-- 
Best regards,

Ruslan Zasukhin
VP Engineering and New Technology
Paradigma Software, Inc

Valentina - Joining Worlds of Information
http://www.paradigmasoft.com

[I feel the need: the need for speed]


From parrt at cs.usfca.edu  Wed Aug 31 09:24:36 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 31 Aug 2011 09:24:36 -0700
Subject: [antlr-interest] Rob Pike on writing a lexer in Go for a
	template language
In-Reply-To: <CAFCNb3iS8Mzs_=0x_yyWoYKboWf7tKEFxnZpyyWgP8XbMhSDgw@mail.gmail.com>
References: <CAFCNb3iS8Mzs_=0x_yyWoYKboWf7tKEFxnZpyyWgP8XbMhSDgw@mail.gmail.com>
Message-ID: <57D26594-DFF6-4119-976A-48513C23D0FD@cs.usfca.edu>

Hi Gary,

thanks for the thoughts. I agree that ANTLR lexers have been annoying, which is why I've gone back to a traditional lex-like system including lexical modes in v4.

To deal with the island grammars and context-sensitive Lexing issues, I'm supporting scannerless parsers in v4.

The reason I wrote the StringTemplate lexer by hand was partially due to the island grammar issue, but primarily because the delimiters can be dynamically specified by the user. That tends to defeat any automata-based systems for lexing.

Ter

On Aug 30, 2011, at 7:40 PM, Gary Miller wrote:

> Hey All,
> 
> Slightly off topic post, I thought there might be some interest.
> 
> Last night I went to a talk by Rob Pike of Google, you can watch the talk at
>   https://www.youtube.com/watch?v=HxaD_trXwRE&feature=player_embedded
> 
> Before I went my thinking was that this could probably be knocked up
> in ANTLR in a few minutes, but then ....
> All the uncomfort I have with ANTLR lexering came back to me.
> So I though I'd go to the source and have a look at the lexer for ST,
> and low and behold ST's lexer is written by hand.
> Now I'm feeling quite uncomfortable about ANTLR's lexing.
> 
> I think it basically comes down to the stateless nature of the ANTLR lexing.
> Not the first time context-sensitive scanning has been mentioned on
> the list (*).
> Yes I know that it can be made statefull (*) and/or I can push more
> onto the parser, but both of these have issues.
> Statefull ANTLR lexing code I generally find more confusing and harder
> to write then functionally equivalent code in a target language.
> Pushing more into the parser in this particular case is inefficient as
> there are large chunks of text that doesn't need to be tokenized and
> there is the issue the whitespace tokens might need to behaving
> differently in different places (hidden verse not).
> 
> 
> Started off as an off topic post, ended as a rant about lexing regards
> Gary
> P.S. I've started on the ANTLR target for Go, still very immature.
> https://github.com/millergarym/antlr/tree/,
> 
> * Scott Stanchfield's context-sensitive scanning
> http://javadude.com/articles/antlr-context-sensitive-scanner.html
> 
> * a good example of this is Jim's numerical lexing for JavaFX
> http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point,+dot,+range,+time+specs
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From bill.andersen at mac.com  Wed Aug 31 10:46:30 2011
From: bill.andersen at mac.com (Bill Andersen)
Date: Wed, 31 Aug 2011 10:46:30 -0700
Subject: [antlr-interest] Composite tree grammar in 3.4 fail
Message-ID: <C9E535C0-0C1F-439D-B1EF-949CE50D6046@mac.com>

I see this, no matter which of several independent composite tree grammars I try.  Any ideas?

ANTLR Parser Generator 3.4 Jul 19, 2011 11:35:12.
Using project classpath: Yes.
Grammar: /Users/bill/Documents/Eclipse Workspaces/workspace4/TripleStore/src/com/highfleet/lang/sparql/grammar/Sparql11ReplaceBlankNode.g
java.lang.NoSuchFieldError: offendingToken
	at org.deved.antlride.runtime.AntlrErrorListener.extractToken(AntlrErrorListener.java:111)
	at org.deved.antlride.runtime.AntlrErrorListener.report(AntlrErrorListener.java:79)
	at org.deved.antlride.runtime.AntlrErrorListener.message(AntlrErrorListener.java:65)
	at org.deved.antlride.runtime.AntlrErrorListener.warning(AntlrErrorListener.java:49)
	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:742)
	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:750)
	at org.antlr.grammar.v3.TreeToNFAConverter.finish(TreeToNFAConverter.java:235)
	at org.antlr.grammar.v3.TreeToNFAConverter.grammar_(TreeToNFAConverter.java:384)
	at org.antlr.tool.Grammar.buildNFA(Grammar.java:1006)
	at org.antlr.tool.CompositeGrammar.createNFAs(CompositeGrammar.java:390)
	at org.antlr.Tool.process(Tool.java:466)
	at org.deved.antlride.runtime.Tool2.main(Tool2.java:24)
BUILD SUCCESSFUL
Total time: 1 second

From andersen at highfleet.com  Wed Aug 31 10:53:59 2011
From: andersen at highfleet.com (Bill Andersen)
Date: Wed, 31 Aug 2011 10:53:59 -0700
Subject: [antlr-interest] Composite tree grammar in 3.4 fail
In-Reply-To: <C9E535C0-0C1F-439D-B1EF-949CE50D6046@mac.com>
References: <C9E535C0-0C1F-439D-B1EF-949CE50D6046@mac.com>
Message-ID: <6966BC77-1DC6-4FF2-933D-4F76ABA84E9C@highfleet.com>

Forgot to add - all of this worked under 3.3.  I switched so I could get ST 4 in the complete binary for 3.4

On Aug 31, 2011, at 10:46 , Bill Andersen wrote:

> I see this, no matter which of several independent composite tree grammars I try.  Any ideas?
> 
> ANTLR Parser Generator 3.4 Jul 19, 2011 11:35:12.
> Using project classpath: Yes.
> Grammar: /Users/bill/Documents/Eclipse Workspaces/workspace4/TripleStore/src/com/highfleet/lang/sparql/grammar/Sparql11ReplaceBlankNode.g
> java.lang.NoSuchFieldError: offendingToken
> 	at org.deved.antlride.runtime.AntlrErrorListener.extractToken(AntlrErrorListener.java:111)
> 	at org.deved.antlride.runtime.AntlrErrorListener.report(AntlrErrorListener.java:79)
> 	at org.deved.antlride.runtime.AntlrErrorListener.message(AntlrErrorListener.java:65)
> 	at org.deved.antlride.runtime.AntlrErrorListener.warning(AntlrErrorListener.java:49)
> 	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:742)
> 	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:750)
> 	at org.antlr.grammar.v3.TreeToNFAConverter.finish(TreeToNFAConverter.java:235)
> 	at org.antlr.grammar.v3.TreeToNFAConverter.grammar_(TreeToNFAConverter.java:384)
> 	at org.antlr.tool.Grammar.buildNFA(Grammar.java:1006)
> 	at org.antlr.tool.CompositeGrammar.createNFAs(CompositeGrammar.java:390)
> 	at org.antlr.Tool.process(Tool.java:466)
> 	at org.deved.antlride.runtime.Tool2.main(Tool2.java:24)
> BUILD SUCCESSFUL
> Total time: 1 second
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

Bill Andersen 
Highfleet, Inc. (www.highfleet.com)
3600 O'Donnell Street, Suite 600
Baltimore, MD 21224
Office: +1.410.675.1201
Cell: +1.443.858.6444
Fax: +1.410.675.1204






From parrt at cs.usfca.edu  Wed Aug 31 11:40:17 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 31 Aug 2011 11:40:17 -0700
Subject: [antlr-interest] Composite tree grammar in 3.4 fail
In-Reply-To: <C9E535C0-0C1F-439D-B1EF-949CE50D6046@mac.com>
References: <C9E535C0-0C1F-439D-B1EF-949CE50D6046@mac.com>
Message-ID: <AB8A8F19-93CB-4D94-BBDC-0A328CF23DE9@cs.usfca.edu>

Hi Bill,
can you pass me a simple example poetry grammar with its imported tree grammar that fails? I will add to the list.
T
On Aug 31, 2011, at 10:46 AM, Bill Andersen wrote:

> I see this, no matter which of several independent composite tree grammars I try.  Any ideas?
> 
> ANTLR Parser Generator 3.4 Jul 19, 2011 11:35:12.
> Using project classpath: Yes.
> Grammar: /Users/bill/Documents/Eclipse Workspaces/workspace4/TripleStore/src/com/highfleet/lang/sparql/grammar/Sparql11ReplaceBlankNode.g
> java.lang.NoSuchFieldError: offendingToken
> 	at org.deved.antlride.runtime.AntlrErrorListener.extractToken(AntlrErrorListener.java:111)
> 	at org.deved.antlride.runtime.AntlrErrorListener.report(AntlrErrorListener.java:79)
> 	at org.deved.antlride.runtime.AntlrErrorListener.message(AntlrErrorListener.java:65)
> 	at org.deved.antlride.runtime.AntlrErrorListener.warning(AntlrErrorListener.java:49)
> 	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:742)
> 	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:750)
> 	at org.antlr.grammar.v3.TreeToNFAConverter.finish(TreeToNFAConverter.java:235)
> 	at org.antlr.grammar.v3.TreeToNFAConverter.grammar_(TreeToNFAConverter.java:384)
> 	at org.antlr.tool.Grammar.buildNFA(Grammar.java:1006)
> 	at org.antlr.tool.CompositeGrammar.createNFAs(CompositeGrammar.java:390)
> 	at org.antlr.Tool.process(Tool.java:466)
> 	at org.deved.antlride.runtime.Tool2.main(Tool2.java:24)
> BUILD SUCCESSFUL
> Total time: 1 second
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From parrt at cs.usfca.edu  Wed Aug 31 11:56:26 2011
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 31 Aug 2011 11:56:26 -0700
Subject: [antlr-interest] Composite tree grammar in 3.4 fail
In-Reply-To: <AB8A8F19-93CB-4D94-BBDC-0A328CF23DE9@cs.usfca.edu>
References: <C9E535C0-0C1F-439D-B1EF-949CE50D6046@mac.com>
	<AB8A8F19-93CB-4D94-BBDC-0A328CF23DE9@cs.usfca.edu>
Message-ID: <45AEF15E-07C1-4981-992C-BC2BF70FF9AE@cs.usfca.edu>

Sorry about that. voice recognition error. I meant "a simple tree grammar"...
T
On Aug 31, 2011, at 11:40 AM, Terence Parr wrote:

> Hi Bill,
> can you pass me a simple example poetry grammar with its imported tree grammar that fails? I will add to the list.
> T
> On Aug 31, 2011, at 10:46 AM, Bill Andersen wrote:
> 
>> I see this, no matter which of several independent composite tree grammars I try.  Any ideas?
>> 
>> ANTLR Parser Generator 3.4 Jul 19, 2011 11:35:12.
>> Using project classpath: Yes.
>> Grammar: /Users/bill/Documents/Eclipse Workspaces/workspace4/TripleStore/src/com/highfleet/lang/sparql/grammar/Sparql11ReplaceBlankNode.g
>> java.lang.NoSuchFieldError: offendingToken
>> 	at org.deved.antlride.runtime.AntlrErrorListener.extractToken(AntlrErrorListener.java:111)
>> 	at org.deved.antlride.runtime.AntlrErrorListener.report(AntlrErrorListener.java:79)
>> 	at org.deved.antlride.runtime.AntlrErrorListener.message(AntlrErrorListener.java:65)
>> 	at org.deved.antlride.runtime.AntlrErrorListener.warning(AntlrErrorListener.java:49)
>> 	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:742)
>> 	at org.antlr.tool.ErrorManager.grammarWarning(ErrorManager.java:750)
>> 	at org.antlr.grammar.v3.TreeToNFAConverter.finish(TreeToNFAConverter.java:235)
>> 	at org.antlr.grammar.v3.TreeToNFAConverter.grammar_(TreeToNFAConverter.java:384)
>> 	at org.antlr.tool.Grammar.buildNFA(Grammar.java:1006)
>> 	at org.antlr.tool.CompositeGrammar.createNFAs(CompositeGrammar.java:390)
>> 	at org.antlr.Tool.process(Tool.java:466)
>> 	at org.deved.antlride.runtime.Tool2.main(Tool2.java:24)
>> BUILD SUCCESSFUL
>> Total time: 1 second
>> 
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From miller.garym at gmail.com  Wed Aug 31 21:33:59 2011
From: miller.garym at gmail.com (Gary Miller)
Date: Thu, 1 Sep 2011 14:33:59 +1000
Subject: [antlr-interest] Rob Pike on writing a lexer in Go for a
	template language
In-Reply-To: <57D26594-DFF6-4119-976A-48513C23D0FD@cs.usfca.edu>
References: <CAFCNb3iS8Mzs_=0x_yyWoYKboWf7tKEFxnZpyyWgP8XbMhSDgw@mail.gmail.com>
	<57D26594-DFF6-4119-976A-48513C23D0FD@cs.usfca.edu>
Message-ID: <CAFCNb3hoLS-4Q5-g-0iYC+uxviX2sFdVdppDq9d8AToT3jD8ZQ@mail.gmail.com>

Terence,

Can you point me a some more details about "traditional lex-like
system including lexical modes in v4"

I'm don't know enough about scannerless parsering, are there details
on how it support island grammars?

Thanks for the response.
Regards
Gary

> ... traditional lex-like system including lexical modes in v4.
>
> To deal with the island grammars and context-sensitive Lexing issues, I'm supporting scannerless parsers in v4.
>
> The reason I wrote the StringTemplate lexer by hand was partially due to the island grammar issue, but primarily because the delimiters can be dynamically specified by the user. That tends to defeat any automata-based systems for lexing.
>
> Ter
>
> On Aug 30, 2011, at 7:40 PM, Gary Miller wrote:
>
>> Hey All,
>>
>> Slightly off topic post, I thought there might be some interest.
>>
>> Last night I went to a talk by Rob Pike of Google, you can watch the talk at
>> ? https://www.youtube.com/watch?v=HxaD_trXwRE&feature=player_embedded
>>
>> Before I went my thinking was that this could probably be knocked up
>> in ANTLR in a few minutes, but then ....
>> All the uncomfort I have with ANTLR lexering came back to me.
>> So I though I'd go to the source and have a look at the lexer for ST,
>> and low and behold ST's lexer is written by hand.
>> Now I'm feeling quite uncomfortable about ANTLR's lexing.
>>
>> I think it basically comes down to the stateless nature of the ANTLR lexing.
>> Not the first time context-sensitive scanning has been mentioned on
>> the list (*).
>> Yes I know that it can be made statefull (*) and/or I can push more
>> onto the parser, but both of these have issues.
>> Statefull ANTLR lexing code I generally find more confusing and harder
>> to write then functionally equivalent code in a target language.
>> Pushing more into the parser in this particular case is inefficient as
>> there are large chunks of text that doesn't need to be tokenized and
>> there is the issue the whitespace tokens might need to behaving
>> differently in different places (hidden verse not).
>>
>>
>> Started off as an off topic post, ended as a rant about lexing regards
>> Gary
>> P.S. I've started on the ANTLR target for Go, still very immature.
>> https://github.com/millergarym/antlr/tree/,
>>
>> * Scott Stanchfield's context-sensitive scanning
>> http://javadude.com/articles/antlr-context-sensitive-scanner.html
>>
>> * a good example of this is Jim's numerical lexing for JavaFX
>> http://www.antlr.org/wiki/display/ANTLR3/Lexer+grammar+for+floating+point,+dot,+range,+time+specs
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From David.Meibusch at csgi.com  Wed Aug 31 22:48:54 2011
From: David.Meibusch at csgi.com (David Meibusch)
Date: Thu, 1 Sep 2011 15:48:54 +1000
Subject: [antlr-interest] Simplifier.g generates invalid Java for
	release	3.4 Jul, 19 2001
Message-ID: <A7BB7EF4D43DCC49B9E8201A2743F71E09F4E9AF@ibbriex01.intecbilling.com>

Following up on post with the same subject:
http://www.antlr.org/pipermail/antlr-interest/2011-August/042470.html

 

I've just upgraded from 3.2 to 3.4 and I've encountered the same issues
with our own combined grammar:

 

The generated parser contains numerous predicates with missing variable
names (invalid Java syntax):

 

    public final void synpred81_EPM_fragment() throws
RecognitionException {

        Token =null;

        ;void  =null

   ...

 

I think the previous post above indicates that an example grammar
exhibits the same issue.

I can post more details (perhaps a repro grammar) if no-one has a simple
fix or workaround.

 

Regards,

Dave
 
All emails in this message string and any attachments are the confidential information of CSG Systems International, Inc. (CSG), or its affiliates and subsidiaries, and may contain privileged and/or confidential material. If you are not an intended recipient, please delete it immediately and notify the sender; unintended recipients are not authorized to read or otherwise use the information contained herein.

