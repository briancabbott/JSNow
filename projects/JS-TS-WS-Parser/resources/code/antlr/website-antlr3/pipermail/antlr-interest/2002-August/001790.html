<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] a proposed enhancement to lexers [hoisting?]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20a%20proposed%20enhancement%20to%20lexers%20%5Bhoisting%3F%5D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001787.html">
   <LINK REL="Next"  HREF="001791.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] a proposed enhancement to lexers [hoisting?]</H1>
    <B>Terence Parr</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20a%20proposed%20enhancement%20to%20lexers%20%5Bhoisting%3F%5D&In-Reply-To="
       TITLE="[antlr-interest] a proposed enhancement to lexers [hoisting?]">parrt at jguru.com
       </A><BR>
    <I>Sat Aug 31 11:06:44 PDT 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="001787.html">[antlr-interest] Problem in BaseAST.equals
</A></li>
        <LI>Next message: <A HREF="001791.html">[antlr-interest] a proposed enhancement to lexers [hoisting?]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1790">[ date ]</a>
              <a href="thread.html#1790">[ thread ]</a>
              <a href="subject.html#1790">[ subject ]</a>
              <a href="author.html#1790">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Folks,

I have gotten bitten by the &quot;match only at the start of line&quot; issue one 
last time!  I'm going to fix this.  I can see multiple solutions.  What 
you really want is for this to work:

STAR_AT_LEFT_EDGE
	:	{getColumn()==1}? '['
	;

STAR
	:	'*'
	;

It doesn't because the autogenerated rule nextToken that invokes these 
only considers syntax.  I.e., it builds

nextToken() {
	switch (LA(1)) {
	case '*' : STAR_AT_LEFT_EDGE(); break;
	case '*' : STAR(); break;
	}
}

naturally this is nondeterministic since '*' starts both rules.  One 
way to handle this is a rule option that specifies the semantic context 
under which the rule applies.  But then I realized that a simple form 
of HOISTING from the left edge of rules into nextToken()'s 
computations, would solve this.

All I have to do is look for any semantic predicates on the left edge 
of any alternative and hoist them into the prediction expression for 
the rules in nextToken().  It will make some things slower.  For 
example, most stuff gets predicted with a switch, but now '*' would be 
checked with

if ( getColumn()==1 &amp;&amp; LA(1)=='*' ) STAR_AT_LEFT_EDGE();
else STAR_AT_LEFT_EDGE();

and if there are many of these, the linear walk could prove a bit more 
expensive, but we should need this much.

Anyway, it nicely solves the &quot;only apply this rule under these semantic 
conditions&quot; problem.  Remember the '^' rexpr char for &quot;beginning of a 
line&quot; is a bit weird as &quot;beginning of a line&quot; is a state of the lexer 
not a character.  This solution would be more powerful and a more 
natural expression of your needs.

Sound like the right thing to do?  It would probably require the C++ 
and C# generators to change also to be consistent.

Ter
--
Co-founder, <A HREF="http://www.jguru.com">http://www.jguru.com</A>
Creator, ANTLR Parser Generator: <A HREF="http://www.antlr.org">http://www.antlr.org</A>


 

Your use of Yahoo! Groups is subject to <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A> 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001787.html">[antlr-interest] Problem in BaseAST.equals
</A></li>
	<LI>Next message: <A HREF="001791.html">[antlr-interest] a proposed enhancement to lexers [hoisting?]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1790">[ date ]</a>
              <a href="thread.html#1790">[ thread ]</a>
              <a href="subject.html#1790">[ subject ]</a>
              <a href="author.html#1790">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
