<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Bug ? In C++, the parameters passed to a rule become ASTRefCount&lt;AST&gt;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Bug%20%3F%20In%20C%2B%2B%2C%20the%20parameters%20passed%20to%20a%20rule%20become%20ASTRefCount%3CAST%3E&In-Reply-To=000b01c34c47%240ab5c720%24ae646464%40lavaserver">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004551.html">
   <LINK REL="Next"  HREF="004559.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Bug ? In C++, the parameters passed to a rule become ASTRefCount&lt;AST&gt;</H1>
    <B>Ric Klaren</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Bug%20%3F%20In%20C%2B%2B%2C%20the%20parameters%20passed%20to%20a%20rule%20become%20ASTRefCount%3CAST%3E&In-Reply-To=000b01c34c47%240ab5c720%24ae646464%40lavaserver"
       TITLE="[antlr-interest] Bug ? In C++, the parameters passed to a rule become ASTRefCount&lt;AST&gt;">klaren at cs.utwente.nl
       </A><BR>
    <I>Thu Jul 17 03:06:14 PDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004551.html">[antlr-interest] Bug ? In C++, the parameters passed to a rule become ASTRefCount&lt;AST&gt;
</A></li>
        <LI>Next message: <A HREF="004559.html">[antlr-interest] reengineering from generated java to grammar source
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4552">[ date ]</a>
              <a href="thread.html#4552">[ thread ]</a>
              <a href="subject.html#4552">[ subject ]</a>
              <a href="author.html#4552">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On Thu, Jul 17, 2003 at 11:37:25AM +0200, Anthony Breneli&#232;re wrote:
&gt;<i> // Here is the root rule, ciaoTreeDocument :
</I>&gt;<i>
</I>&gt;<i> ciaoTreeDocument
</I>&gt;<i>
</I>&gt;<i>       :     ( statementA )*
</I>&gt;<i>
</I>&gt;<i> ;
</I>&gt;<i>
</I>&gt;<i> // A pointer is created, named '_curstat'.
</I>&gt;<i>
</I>&gt;<i> // This pointer is passed to the rule 'statProperties'
</I>&gt;<i>
</I>&gt;<i> // Everything is OK when the rule is called, and _curstat is OK, with a
</I>&gt;<i> type 'CObject *'
</I>&gt;<i>
</I>&gt;<i> statementA
</I>&gt;<i>       {
</I>&gt;<i>
</I>&gt;<i>             CObject * _curstat = world-&gt;addObject();
</I>&gt;<i>             _curstat-&gt;aP(CATEGORY, &quot;Statement&quot;);
</I>&gt;<i>       }
</I>&gt;<i>
</I>&gt;<i>       :     #(R_STA ( statProperties[ _curstat ])* statement)
</I>&gt;<i>
</I>&gt;<i> ;
</I>&gt;<i>
</I>&gt;<i> // In the statProperties rule, _curstat has changed : the value of the
</I>&gt;<i> pointer has changed, // and the type of _curstat has also changed :
</I>&gt;<i>
</I>&gt;<i> // _curstat IS NOW 'antlr::ASTRefCount&lt;antlr::AST&gt;' instead of 'CObject
</I>&gt;<i> *' !!!!!!!!!!!
</I>
This sounds more as a memory corruption bug to me than as a problem with
antlr. Did you inspect the generated code for strange things? Try turning
genHashLines off and stepping through the code step by step to see what
actually changes the pointer.

&gt;<i> Any idea to pass a pointer from a rule to another rule in the Treewalker
</I>&gt;<i> in C++ ?
</I>
In principle your approach to passing a pointer is ok, at least I'm not
seeing anything strange about it.

Cheers,

Ric
--
-----+++++*****************************************************+++++++++-------
    ---- Ric Klaren ----- <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">j.klaren at utwente.nl</A> ----- +31 53 4893722  ----
-----+++++*****************************************************+++++++++-------
  Wit is cultured insolence. --- Aristotle


 

Your use of Yahoo! Groups is subject to <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A> 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004551.html">[antlr-interest] Bug ? In C++, the parameters passed to a rule become ASTRefCount&lt;AST&gt;
</A></li>
	<LI>Next message: <A HREF="004559.html">[antlr-interest] reengineering from generated java to grammar source
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4552">[ date ]</a>
              <a href="thread.html#4552">[ thread ]</a>
              <a href="subject.html#4552">[ subject ]</a>
              <a href="author.html#4552">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
