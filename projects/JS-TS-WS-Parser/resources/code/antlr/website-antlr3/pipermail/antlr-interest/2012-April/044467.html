<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Can%20an%20Antlr%20Parser%20return%20a%20TreeNodeStream%20so%0A%20as%20to%20not%20have%20to%20parse%20the%20whole%20file%20at%20once%3F&In-Reply-To=%3CD2A5C7470D67A54FACE86B838946D49D14B379AD27%40NJ4MSGSCR02.markit.partners%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="044453.html">
   <LINK REL="Next"  HREF="044471.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?</H1>
    <B>Burton Samograd</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Can%20an%20Antlr%20Parser%20return%20a%20TreeNodeStream%20so%0A%20as%20to%20not%20have%20to%20parse%20the%20whole%20file%20at%20once%3F&In-Reply-To=%3CD2A5C7470D67A54FACE86B838946D49D14B379AD27%40NJ4MSGSCR02.markit.partners%3E"
       TITLE="[antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?">burton.samograd at markit.com
       </A><BR>
    <I>Wed Apr 18 10:19:50 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="044453.html">[antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?
</A></li>
        <LI>Next message: <A HREF="044471.html">[antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44467">[ date ]</a>
              <a href="thread.html#44467">[ thread ]</a>
              <a href="subject.html#44467">[ subject ]</a>
              <a href="author.html#44467">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jim,

Personally, I think we should be using flex/bison because I don't think that Antlr is the right tool for the job.  Our initial requirements have been exceeded by over 2 orders of magnitude and I just don't think that the Antlr architecture is up for the task, and I feel that we might need to be able to handle another order of magnitude on top of that in the not so near future.  For what we are creating I don't think we need all the features that Antlr provides, but it was chosen before I got to my new job and before these new requirements came up.
--
Burton Samograd

-----Original Message-----
From: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A> [mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A>] On Behalf Of Jim Idle
Sent: Monday, April 16, 2012 2:52 PM
Cc: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
Subject: Re: [antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?

3.1? You should try 3.3 or maybe 3.4

However, your best bet is to partition your input. I have suggested some ways to do that in past posts but if your input is not a calculator, then I can't be any more specific. However, the fact that you can process the TreeNodeStream (which is what is produced anyway) suggests that you can partition this up before the lexer.

Jim



&gt;<i> -----Original Message-----
</I>&gt;<i> From: Burton Samograd [mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">burton.samograd at markit.com</A>]
</I>&gt;<i> Sent: Monday, April 16, 2012 1:48 PM
</I>&gt;<i> To: Eric; Jim Idle
</I>&gt;<i> Cc: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
</I>&gt;<i> Subject: RE: [antlr-interest] Can an Antlr Parser return a
</I>&gt;<i> TreeNodeStream so as to not have to parse the whole file at once?
</I>&gt;<i>
</I>&gt;<i> Antlr 3.1.3, C target wrapped for a C++ program.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Burton Samograd
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A> [mailto:antlr-interest-
</I>&gt;<i> <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bounces at antlr.org</A>] On Behalf Of Eric
</I>&gt;<i> Sent: Monday, April 16, 2012 2:46 PM
</I>&gt;<i> To: Jim Idle
</I>&gt;<i> Cc: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
</I>&gt;<i> Subject: Re: [antlr-interest] Can an Antlr Parser return a
</I>&gt;<i> TreeNodeStream so as to not have to parse the whole file at once?
</I>&gt;<i>
</I>&gt;<i> Nice catch Jim.
</I>&gt;<i>
</I>&gt;<i> Burton, which ANTLR target are you using? e.g. ANTLR 3.4 C# 3, ANTLR
</I>&gt;<i> 3.4 Java, ...
</I>&gt;<i>
</I>&gt;<i> On Mon, Apr 16, 2012 at 4:41 PM, Jim Idle &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">jimi at temporal-wave.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; This isn't the C target unless someone added 'new' to the ANSI C
</I>&gt;<i> &gt; standard when I was not looking.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Jim
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; From: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A> [mailto:antlr-interest-
</I>&gt;<i> &gt; &gt; <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bounces at antlr.org</A>] On Behalf Of Eric
</I>&gt;<i> &gt; &gt; Sent: Monday, April 16, 2012 1:12 PM
</I>&gt;<i> &gt; &gt; To: Burton Samograd
</I>&gt;<i> &gt; &gt; Cc: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
</I>&gt;<i> &gt; &gt; Subject: Re: [antlr-interest] Can an Antlr Parser return a
</I>&gt;<i> &gt; &gt; TreeNodeStream so as to not have to parse the whole file at once?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I just notice that you are using an earlier version of the C
</I>&gt;<i> target.
</I>&gt;<i> &gt; &gt; There has been lots of messages here about running out of memory
</I>&gt;<i> for
</I>&gt;<i> &gt; &gt; that version. Check the mailing list for old post. Since I don't
</I>&gt;<i> use
</I>&gt;<i> &gt; &gt; the C target and Jim Idle created it, is the expert on it, and is
</I>&gt;<i> &gt; &gt; here regularly, he might jump in on this. Anything he suggests is
</I>&gt;<i> &gt; &gt; worth the trouble of looking into, even if it means a few days of
</I>&gt;<i> work.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Eric
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; On Mon, Apr 16, 2012 at 3:47 PM, Eric &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">researcher0x00 at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; On Mon, Apr 16, 2012 at 3:03 PM, Burton Samograd &lt;
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">burton.samograd at markit.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; Hello,
</I>&gt;<i> &gt; &gt; &gt;&gt; In the following Antlr example, the parser is used to generate
</I>&gt;<i> an
</I>&gt;<i> &gt; &gt; AST
</I>&gt;<i> &gt; &gt; &gt;&gt; which is then converted into a CommonTreeNodeStream, which is
</I>&gt;<i> &gt; &gt; &gt;&gt; then passed to the checker.
</I>&gt;<i> &gt; &gt; &gt;&gt; public static void main(String[] args) {
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; CalcLexer  lex  = new CalcLexer(
</I>&gt;<i> &gt; &gt; &gt;&gt;                        new ANTLRInputStream(System.in));
</I>&gt;<i> &gt; &gt; &gt;&gt; CommonTokenStream tokens = new CommonTokenStream(lex);
</I>&gt;<i> CalcParser
</I>&gt;<i> &gt; &gt; &gt;&gt; parser = new CalcParser(tokens);
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; CalcParser.program_result result = parser.program(); CommonTree
</I>&gt;<i> &gt; &gt; &gt;&gt; tree = (CommonTree) result.getTree();
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; CommonTreeNodeStream nodes = new CommonTreeNodeStream(tree);
</I>&gt;<i> &gt; &gt; &gt;&gt; CalcChecker checker = new CalcChecker(nodes);
</I>&gt;<i> &gt; &gt; &gt;&gt; checker.program();
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; CommonTreeNodeStream nodes = new CommonTreeNodeStream(tree);
</I>&gt;<i> &gt; &gt; &gt;&gt; CalcInterpreter interpreter = new CalcInterpreter(nodes);
</I>&gt;<i> &gt; &gt; &gt;&gt; interpreter.program(); } Is it possible to get the parser to
</I>&gt;<i> &gt; &gt; &gt;&gt; return
</I>&gt;<i> &gt; &gt; a
</I>&gt;<i> &gt; &gt; &gt;&gt; CommonTreeNodeStream that can be then passed to the Checker so
</I>&gt;<i> &gt; &gt; &gt;&gt; that the whole file does not have to be lexed and parsed at
</I>&gt;<i> &gt; &gt; &gt;&gt; once and rather as a stream of tokens and then tree nodes?
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt; If I am understanding this correctly, you want to do partial
</I>&gt;<i> &gt; &gt; &gt; parsing, and then generating a partial AST because the file is
</I>&gt;<i> &gt; &gt; &gt; to large. Since the lexer has to lex/scan the entire text file
</I>&gt;<i> &gt; &gt; &gt; to create the tokens for the parser, you cannot do a partial
</I>&gt;<i> &gt; &gt; &gt; lexing
</I>&gt;<i> of the input.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Ter did something with scannerless parsing several months ago,
</I>&gt;<i> but
</I>&gt;<i> &gt; &gt; &gt; since I never worked with it I cannot say it will help, but is
</I>&gt;<i> &gt; &gt; &gt; something I personally would look into for your problem, but not
</I>&gt;<i> &gt; &gt; &gt; expect it to work. I have had stranger suggestions that worked.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I would also profile the running of the grammar to see which
</I>&gt;<i> &gt; &gt; &gt; part of the grammar is using too much memory and try altering
</I>&gt;<i> &gt; &gt; &gt; the grammar and/or adding actions to correct the problem.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Usually one wants the entire AST before doing analysis, so I am
</I>&gt;<i> &gt; &gt; &gt; curious as to what you would do with an the AST tokens being
</I>&gt;<i> &gt; &gt; processed
</I>&gt;<i> &gt; &gt; &gt; as a stream instead of a DOM.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; As a worse case, you could switch to overriding parts of the
</I>&gt;<i> ANTLR
</I>&gt;<i> &gt; &gt; &gt; parser with hand written code, or even worse, switch to a
</I>&gt;<i> &gt; &gt; &gt; different type of parser, i.e. LR, parser combinator, fully hand
</I>&gt;<i> &gt; &gt; &gt; written
</I>&gt;<i> &gt; &gt; recursive descent.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; You can also contract for support from Ter.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;  Eric.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; I ask because we are running into a problem with an extremely
</I>&gt;<i> &gt; &gt; &gt;&gt; large file being passed into our Antlr parser and it is causing
</I>&gt;<i> &gt; &gt; &gt;&gt; memory exhaustion in the parsing phase. I am thinking that
</I>&gt;<i> &gt; &gt; &gt;&gt; using a TreeNodeStream would solve this problem if it is even
</I>&gt;<i> possible.
</I>&gt;<i> &gt; &gt; &gt;&gt; --
</I>&gt;<i> &gt; &gt; &gt;&gt; Burton Samograd
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; ________________________________ This e-mail, including
</I>&gt;<i> &gt; &gt; &gt;&gt; accompanying communications and attachments, is strictly
</I>&gt;<i> &gt; &gt; &gt;&gt; confidential and only for the intended recipient. Any
</I>&gt;<i> &gt; &gt; &gt;&gt; retention, use or disclosure not expressly authorised by Markit
</I>&gt;<i> &gt; &gt; &gt;&gt; is prohibited. This email is subject to all waivers and other
</I>&gt;<i> &gt; &gt; &gt;&gt; terms at
</I>&gt;<i> &gt; &gt; the following link:
</I>&gt;<i> &gt; &gt; &gt;&gt; <A HREF="http://www.markit.com/en/about/legal/email-disclaimer.page">http://www.markit.com/en/about/legal/email-disclaimer.page</A>
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; Please visit <A HREF="http://www.markit.com/en/about/contact/contact-">http://www.markit.com/en/about/contact/contact-</A>
</I>&gt;<i> us.page?
</I>&gt;<i> &gt; &gt; &gt;&gt; for contact information on our offices worldwide.
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;&gt; List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;<i> &gt; &gt; &gt;&gt; Unsubscribe:
</I>&gt;<i> &gt; &gt; &gt;&gt; <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-email-">http://www.antlr.org/mailman/options/antlr-interest/your-email-</A>
</I>&gt;<i> &gt; &gt; addres
</I>&gt;<i> &gt; &gt; &gt;&gt; s
</I>&gt;<i> &gt; &gt; &gt;&gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;<i> &gt; &gt; Unsubscribe:
</I>&gt;<i> &gt; &gt; <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-">http://www.antlr.org/mailman/options/antlr-interest/your-</A>
</I>&gt;<i> &gt; &gt; email-address
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;<i> &gt; Unsubscribe:
</I>&gt;<i> &gt; <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-email-">http://www.antlr.org/mailman/options/antlr-interest/your-email-</A>
</I>&gt;<i> address
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;<i> Unsubscribe: <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-">http://www.antlr.org/mailman/options/antlr-interest/your-</A>
</I>&gt;<i> email-address
</I>&gt;<i>
</I>&gt;<i> This e-mail, including accompanying communications and attachments, is
</I>&gt;<i> strictly confidential and only for the intended recipient. Any
</I>&gt;<i> retention, use or disclosure not expressly authorised by Markit is
</I>&gt;<i> prohibited. This email is subject to all waivers and other terms at
</I>&gt;<i> the following link: <A HREF="http://www.markit.com/en/about/legal/email-">http://www.markit.com/en/about/legal/email-</A>
</I>&gt;<i> disclaimer.page
</I>&gt;<i>
</I>&gt;<i> Please visit <A HREF="http://www.markit.com/en/about/contact/contact-us.page?">http://www.markit.com/en/about/contact/contact-us.page?</A>
</I>&gt;<i> for contact information on our offices worldwide.
</I>
List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
Unsubscribe: <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-email-address">http://www.antlr.org/mailman/options/antlr-interest/your-email-address</A>

This e-mail, including accompanying communications and attachments, is strictly confidential and only for the intended recipient. Any retention, use or disclosure not expressly authorised by Markit is prohibited. This email is subject to all waivers and other terms at the following link: <A HREF="http://www.markit.com/en/about/legal/email-disclaimer.page">http://www.markit.com/en/about/legal/email-disclaimer.page</A>

Please visit <A HREF="http://www.markit.com/en/about/contact/contact-us.page?">http://www.markit.com/en/about/contact/contact-us.page?</A> for contact information on our offices worldwide.
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="044453.html">[antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?
</A></li>
	<LI>Next message: <A HREF="044471.html">[antlr-interest] Can an Antlr Parser return a TreeNodeStream so as to not have to parse the whole file at once?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44467">[ date ]</a>
              <a href="thread.html#44467">[ thread ]</a>
              <a href="subject.html#44467">[ subject ]</a>
              <a href="author.html#44467">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
