<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] C++ code, help with custom AST initialize() method
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20C%2B%2B%20code%2C%20help%20with%20custom%20AST%20initialize%28%29%20method&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015950.html">
   <LINK REL="Next"  HREF="015956.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] C++ code, help with custom AST initialize() method</H1>
    <B>Bryan Ewbank</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20C%2B%2B%20code%2C%20help%20with%20custom%20AST%20initialize%28%29%20method&In-Reply-To="
       TITLE="[antlr-interest] C++ code, help with custom AST initialize() method">ewbank at gmail.com
       </A><BR>
    <I>Tue Apr 11 12:59:16 PDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="015950.html">[antlr-interest] Re: [stringtemplate-interest] StringTemplate name
</A></li>
        <LI>Next message: <A HREF="015956.html">[antlr-interest] ANTLR Studio website- Very Serious Crash :(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15954">[ date ]</a>
              <a href="thread.html#15954">[ thread ]</a>
              <a href="subject.html#15954">[ subject ]</a>
              <a href="author.html#15954">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've run into a problem that I can't seem to get my mind around...

    - ANTLR 2.7.5
    - C++ codegen
    - Custom AST class

I've defined a custom AST class, TreeNode, derived from
antlr::CommonAST, and am using the associated smart-pointer class in
all my grammars.

The problem comes when ANTLR generates code to initialize RefTreeNode objects:
     RefTreeNode id = RefTreeNode(antlr::nullAST);
Since antlr::nullAST is /not/ a TreeNode, this is effectively an
incorrect cast from a base class to a derived class.

Later on, when &quot;id&quot; is used in the TreeNode::initialize() function, it
dies because the object pointed to be antlr::nullAST does not have the
correct information from which to completely initialize a TreeNode. 
It only has the stuff for a CommonAST.

So, how am I supposed to handle the fact that something which is an
antlr::nullAST may be used where an object of type RefTreeNode is
expected?

If this sounds at all familiar, please let me know what you did to get
around this problem.

Thank you,
- Bryan Ewbank
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015950.html">[antlr-interest] Re: [stringtemplate-interest] StringTemplate name
</A></li>
	<LI>Next message: <A HREF="015956.html">[antlr-interest] ANTLR Studio website- Very Serious Crash :(
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15954">[ date ]</a>
              <a href="thread.html#15954">[ thread ]</a>
              <a href="subject.html#15954">[ subject ]</a>
              <a href="author.html#15954">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
