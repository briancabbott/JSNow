<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] normalize \n to \n in ST
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20normalize%20%5Cn%20to%20%5Cn%20in%20ST&In-Reply-To=%3CA7746824D386F947BBC285F6EC4716B002131FD7A7%40vmtbosmail01.VMTBOSTON.VAULTUS.COM%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028569.html">
   <LINK REL="Next"  HREF="028624.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] normalize \n to \n in ST</H1>
    <B>Doucette, Charles</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20normalize%20%5Cn%20to%20%5Cn%20in%20ST&In-Reply-To=%3CA7746824D386F947BBC285F6EC4716B002131FD7A7%40vmtbosmail01.VMTBOSTON.VAULTUS.COM%3E"
       TITLE="[antlr-interest] normalize \n to \n in ST">cdoucette at vaultus.com
       </A><BR>
    <I>Mon Jun  9 20:30:41 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028569.html">[antlr-interest] normalize \n to \n in ST
</A></li>
        <LI>Next message: <A HREF="028624.html">[antlr-interest] normalize \n to \n in ST
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28620">[ date ]</a>
              <a href="thread.html#28620">[ thread ]</a>
              <a href="subject.html#28620">[ subject ]</a>
              <a href="author.html#28620">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>By the way, will this change ultimately resolve the issue with consistent line endings in files generated by ANTLR
(for those of us not using StringTemplate directly)?

Right now I am forced to do this:

&gt;<i> &gt; 2)      Normalize the line endings of the parser/lexer each time
</I>&gt;<i> &gt; they are generated
</I>&gt;<i> &gt;        (this is what I am doing now)
</I>
Since this didn't work:

&gt;<i> &gt; 1)      Permanently change the line endings in the grammar file to
</I>&gt;<i> &gt; just use \n
</I>&gt;<i> &gt;        (so it will be consistent with the rest of the
</I>&gt;<i> generated code)
</I>
Thanks,
Chuck

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Terence Parr [mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">parrt at cs.usfca.edu</A>]
</I>&gt;<i> Sent: Wednesday, June 04, 2008 4:33 PM
</I>&gt;<i> To: Doucette, Charles
</I>&gt;<i> Cc: stringtemplate-interest; Antlr Interest
</I>&gt;<i> Subject: Re: [antlr-interest] normalize \n to \n in ST
</I>&gt;<i>
</I>&gt;<i> Here are 3 of my unit tests. Basically, no matter which you
</I>&gt;<i> used in templates or attributes or options, ST normalizes
</I>&gt;<i> everything to be the newline field of the output writer
</I>&gt;<i> AutoIndentWriter and its subclass NoIndentWriter. Pushing. I
</I>&gt;<i> guess I need to push 3.2 ST soon :)
</I>&gt;<i>
</I>&gt;<i> Ter
</I>&gt;<i>
</I>&gt;<i>         public void
</I>&gt;<i> testNewlineNormalizationInTemplateString() throws Exception {
</I>&gt;<i>                 StringTemplate st = new StringTemplate(
</I>&gt;<i>                                 &quot;Foo\r\n&quot;+
</I>&gt;<i>                                 &quot;Bar\n&quot;,
</I>&gt;<i>                                 AngleBracketTemplateLexer.class
</I>&gt;<i>                                 );
</I>&gt;<i>                 StringWriter sw = new StringWriter();
</I>&gt;<i>                 st.write(new AutoIndentWriter(sw,&quot;\n&quot;)); //
</I>&gt;<i> force \n as newline
</I>&gt;<i>                 String result = st.toString();
</I>&gt;<i>                 String expecting =&quot;Foo\nBar\n&quot;;     // expect
</I>&gt;<i> \n in output
</I>&gt;<i>                 assertEquals(expecting, result);
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         public void
</I>&gt;<i> testNewlineNormalizationInTemplateStringPC() throws Exception {
</I>&gt;<i>                 StringTemplate st = new StringTemplate(
</I>&gt;<i>                                 &quot;Foo\r\n&quot;+
</I>&gt;<i>                                 &quot;Bar\n&quot;,
</I>&gt;<i>                                 AngleBracketTemplateLexer.class
</I>&gt;<i>                                 );
</I>&gt;<i>                 StringWriter sw = new StringWriter();
</I>&gt;<i>                 st.write(new AutoIndentWriter(sw,&quot;\r\n&quot;)); //
</I>&gt;<i> force \r\n as newline
</I>&gt;<i>                 String result = st.toString();
</I>&gt;<i>                 String expecting =&quot;Foo\r\nBar\r\n&quot;;     //
</I>&gt;<i> expect \r\n in output
</I>&gt;<i>                 assertEquals(expecting, result);
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>         public void testNewlineNormalizationInAttribute()
</I>&gt;<i> throws Exception {
</I>&gt;<i>                 StringTemplate st = new StringTemplate(
</I>&gt;<i>                                 &quot;Foo\r\n&quot;+
</I>&gt;<i>                                 &quot;&lt;name&gt;\n&quot;,
</I>&gt;<i>                                 AngleBracketTemplateLexer.class
</I>&gt;<i>                                 );
</I>&gt;<i>                 st.setAttribute(&quot;name&quot;, &quot;a\nb\r\nc&quot;);
</I>&gt;<i>                 StringWriter sw = new StringWriter();
</I>&gt;<i>                 st.write(new AutoIndentWriter(sw,&quot;\n&quot;)); //
</I>&gt;<i> force \n as newline
</I>&gt;<i>                 String result = st.toString();
</I>&gt;<i>                 String expecting =&quot;Foo\na\nb\nc\n&quot;;     //
</I>&gt;<i> expect \n in output
</I>&gt;<i>                 assertEquals(expecting, result);
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Jun 4, 2008, at 1:13 PM, Doucette, Charles wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; I'm glad you are looking to fix this, as this is affecting
</I>&gt;<i> me know (as
</I>&gt;<i> &gt; I reported previously).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We prefer to run ANTLR manually only when our grammar changes, and
</I>&gt;<i> &gt; then commit the latest generated parsers and lexers to our source
</I>&gt;<i> &gt; control system (to be compiled with the rest of the sources). The
</I>&gt;<i> &gt; problem is that
</I>&gt;<i> &gt; a) our grammar was developed on Windows and has \r\n as line endings
</I>&gt;<i> &gt; b) the rest of the lexer/parser generated code (from
</I>&gt;<i> StringTemplate I
</I>&gt;<i> &gt; assume) has only \n as line endings
</I>&gt;<i> &gt; c) our source control system (SVN) will not accept a file with
</I>&gt;<i> &gt; inconsistent line endings
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I can work around this in at least these 2 ways:
</I>&gt;<i> &gt; 1)      Permanently change the line endings in the grammar file to
</I>&gt;<i> &gt; just use \n
</I>&gt;<i> &gt;        (so it will be consistent with the rest of the
</I>&gt;<i> generated code)
</I>&gt;<i> &gt; 2)      Normalize the line endings of the parser/lexer each time
</I>&gt;<i> &gt; they are generated
</I>&gt;<i> &gt;        (this is what I am doing now)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It could be fixed permanently if I could configure StringTemplate
</I>&gt;<i> &gt; and/or ANTLR to generate lexer/parser code which matches the line
</I>&gt;<i> &gt; endings of my grammar.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; FYI, here's a suggested way to configure this.
</I>&gt;<i> &gt; Subversion has a property called &quot;svn:eol-style&quot; whose value can be:
</I>&gt;<i> &gt; a) native (automatically determined based on the platform)
</I>&gt;<i> &gt; b) CRLF
</I>&gt;<i> &gt; c) LF
</I>&gt;<i> &gt; d) CR
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Chuck
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; -----Original Message-----
</I>&gt;<i> &gt;&gt; From: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A>
</I>&gt;<i> &gt;&gt; [mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A>] On Behalf Of Terence Parr
</I>&gt;<i> &gt;&gt; Sent: Wednesday, June 04, 2008 3:52 PM
</I>&gt;<i> &gt;&gt; To: stringtemplate-interest
</I>&gt;<i> &gt;&gt; Cc: Antlr Interest
</I>&gt;<i> &gt;&gt; Subject: [antlr-interest] normalize \n to \n in ST
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Hi,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I am proposing to normalize the use of \n in templates. If
</I>&gt;<i> you say \n
</I>&gt;<i> &gt;&gt; you get \n or \r\n depending on locale.  Actually, maybe we should
</I>&gt;<i> &gt;&gt; make it a parameter you send to the template group? You
</I>&gt;<i> might have a
</I>&gt;<i> &gt;&gt; Web server that should be sensitive to the client locale not the
</I>&gt;<i> &gt;&gt; server locale, right?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; When you say wrap=&quot;\n&quot; it would actually generate \r\n on a PC.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; When you have a UNIX file with \n line endings, you would
</I>&gt;<i> still get
</I>&gt;<i> &gt;&gt; \r \n on a PC.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; The problem is that I really should fix this inside ST,
</I>&gt;<i> but I need to
</I>&gt;<i> &gt;&gt; send out ANTLR v3.1 shortly. given all of the recent bug fixes,
</I>&gt;<i> &gt;&gt; should I add this to ST and then release ST 3.2 for use with ANTLR
</I>&gt;<i> &gt;&gt; 3.1?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Ter
</I>&gt;<i> &gt;&gt;
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028569.html">[antlr-interest] normalize \n to \n in ST
</A></li>
	<LI>Next message: <A HREF="028624.html">[antlr-interest] normalize \n to \n in ST
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28620">[ date ]</a>
              <a href="thread.html#28620">[ thread ]</a>
              <a href="subject.html#28620">[ subject ]</a>
              <a href="author.html#28620">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
