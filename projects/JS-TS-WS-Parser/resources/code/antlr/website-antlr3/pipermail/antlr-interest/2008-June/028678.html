<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] FW: CSharp Target...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20FW%3A%20CSharp%20Target...&In-Reply-To=%3C20080614170633.316620%40gmx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="028666.html">
   <LINK REL="Next"  HREF="028709.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] FW: CSharp Target...</H1>
    <B>Johannes Luber</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20FW%3A%20CSharp%20Target...&In-Reply-To=%3C20080614170633.316620%40gmx.net%3E"
       TITLE="[antlr-interest] FW: CSharp Target...">JALuber at gmx.de
       </A><BR>
    <I>Sat Jun 14 10:06:33 PDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="028666.html">[antlr-interest] FW: CSharp Target...
</A></li>
        <LI>Next message: <A HREF="028709.html">[antlr-interest] FW: CSharp Target...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28678">[ date ]</a>
              <a href="thread.html#28678">[ thread ]</a>
              <a href="subject.html#28678">[ subject ]</a>
              <a href="author.html#28678">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> First of all, let me state that Antlr appears to be an awesome tool.
</I>&gt;<i> AntlrWorks is amazing, being able to debug, combining the lexer and
</I>&gt;<i> parser, and having a parser for walking the trees.  The Antlr book is
</I>&gt;<i> fantastic, the website is at time frustrating, but still and excellent
</I>&gt;<i> reference and the short period of time I have spent with the project has
</I>&gt;<i> made me start considering DSL's for all sorts of purposes.  However,
</I>&gt;<i> trying to work in Csharp has been a bit of a nightmare.  
</I>&gt;<i> 
</I>&gt;<i> Initially I was trying to work in Antlr 3.1b1, but getting random errors
</I>&gt;<i> that simply did not occur when debugging the parser in Java (as well as
</I>&gt;<i> endless compile errors when even attempting to create a debug, but
</I>&gt;<i> compiling the &quot;Simple tree-based interpreter&quot; (the first one)
</I>&gt;<i> <A HREF="http://www.antlr.org/wiki/display/ANTLR3/Simple+tree-based+interpeter">http://www.antlr.org/wiki/display/ANTLR3/Simple+tree-based+interpeter</A>
</I>&gt;<i> 
</I>&gt;<i> With the following changes:
</I>&gt;<i> 
</I>&gt;<i> 4a5
</I>&gt;<i> &gt;     language=CSharp2;
</I>&gt;<i> 13a15,18
</I>&gt;<i> &gt; @header {
</I>&gt;<i> &gt; using System.Collections.Generic;
</I>&gt;<i> &gt; }
</I>&gt;<i> &gt; 
</I>&gt;<i> 16c21
</I>&gt;<i> &lt;     List&lt;CommonTree&gt; functionDefinitions = new
</I>&gt;<i> ArrayList&lt;CommonTree&gt;();
</I>&gt;<i> ---
</I>&gt;<i> &gt;     public List&lt;CommonTree&gt; functionDefinitions = new 
</I>&gt;<i> &gt; List&lt;CommonTree&gt;();
</I>&gt;<i> 32c37
</I>&gt;<i> &lt; 	  functionDefinitions.add($func.tree);
</I>&gt;<i> ---
</I>&gt;<i> &gt; 	  functionDefinitions.Add($func.tree);
</I>&gt;<i> 68c73
</I>&gt;<i> &lt; WS  :   (' '|'\t')+ { skip(); }
</I>&gt;<i> ---
</I>&gt;<i> &gt; WS  :   (' '|'\t')+ { Skip(); }
</I>&gt;<i> 
</I>&gt;<i> Results in:
</I>&gt;<i> 
</I>&gt;<i> C:\svnprojects\Expression\Expression&gt;java org.antlr.Tool -debug Expr1.g
</I>&gt;<i> ANTLR Parser Generator  Version 3.1b1 (May 20, 2008)  1989-2008
</I>&gt;<i> error(10):  internal error: Expr1.g : java.util.NoSuchElementException:
</I>&gt;<i> no such attribute: n in template context [output File parser
</I>&gt;<i> genericParser(...) region__genericParser__members
</I>&gt;<i> region__genericParser__members if(grammar.grammarIsRoot)_s ubtemplate
</I>&gt;<i> else_subtemplate ctorForRootGrammar createListenerAndHandshake
</I>&gt;<i> if(PARSER)_subtemplate]
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.checkNullAttributeAgainstFormalA
</I>&gt;<i> rguments(StringTemplate.java:1290)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:814)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.get(StringTemplate.java:812)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.getAttribute(StringTemplate.java
</I>&gt;<i> :696)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.attribute(ActionEvalua
</I>&gt;<i> tor.java:360)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.expr(ActionEvaluator.j
</I>&gt;<i> ava:136)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator
</I>&gt;<i> .java:84)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:148)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ConditionalExpr.writeSubTemplate(Condi
</I>&gt;<i> tionalExpr.java:152)
</I>&gt;<i> org.antlr.stringtemplate.language.ConditionalExpr.write(ConditionalExpr.
</I>&gt;<i> java:103)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:715)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:65
</I>&gt;<i> 2)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator
</I>&gt;<i> .java:86)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:148)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:715)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:65
</I>&gt;<i> 2)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator
</I>&gt;<i> .java:86)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:148)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ConditionalExpr.write(ConditionalExpr.
</I>&gt;<i> java:126)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ConditionalExpr.writeSubTemplate(Condi
</I>&gt;<i> tionalExpr.java:152)
</I>&gt;<i> org.antlr.stringtemplate.language.ConditionalExpr.write(ConditionalExpr.
</I>&gt;<i> java:103)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:715)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:65
</I>&gt;<i> 2)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator
</I>&gt;<i> .java:86)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:148)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:715)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:65
</I>&gt;<i> 2)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator
</I>&gt;<i> .java:86)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:148)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:715)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:65
</I>&gt;<i> 2)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator
</I>&gt;<i> .java:86)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:148)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:715)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.writeAttribute(ASTExpr.java:65
</I>&gt;<i> 2)
</I>&gt;<i> org.antlr.stringtemplate.language.ActionEvaluator.action(ActionEvaluator
</I>&gt;<i> .java:86)
</I>&gt;<i> org.antlr.stringtemplate.language.ASTExpr.write(ASTExpr.java:148)
</I>&gt;<i> org.antlr.stringtemplate.StringTemplate.write(StringTemplate.java:714)
</I>&gt;<i> org.antlr.codegen.CodeGenerator.write(CodeGenerator.java:1271)
</I>&gt;<i> org.antlr.codegen.Target.genRecognizerFile(Target.java:94)
</I>&gt;<i> org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:455)
</I>&gt;<i> org.antlr.Tool.generateRecognizer(Tool.java:419)
</I>&gt;<i> org.antlr.Tool.process(Tool.java:286)
</I>&gt;<i> org.antlr.Tool.main(Tool.java:71)
</I>&gt;<i> 
</I>&gt;<i> C:\svnprojects\Expression\Expression&gt;
</I>
This looks like that the genericParser() template is out of sync with the Java target.
&gt;<i> 
</I>&gt;<i> Turning off debug, it compiles but now when it runs, it gets a null
</I>&gt;<i> exception in Expr1Parser.cs
</I>&gt;<i> 
</I>&gt;<i> char_literal19=(IToken)Match(input,13,FOLLOW_13_in_expr319);
</I>&gt;<i> char_literal19_tree = (CommonTree)adaptor.Create(char_literal19);
</I>&gt;<i> root_0 = (CommonTree)adaptor.BecomeRoot(char_literal19_tree, root_0);
</I>&gt;<i> 
</I>&gt;<i> Because char_literal19 is null.  Input looks good to me: {3+4\n}, so I
</I>&gt;<i> don't know why Match is returning null...
</I>
This may the same issue already reported to me: &lt;<A HREF="http://www.antlr.org:8888/browse/ANTLR-297">http://www.antlr.org:8888/browse/ANTLR-297</A>&gt;
&gt;<i> 
</I>&gt;<i> Compiling with 3.0.1 works fine.  So I think, great, I'll use 3.0.1,
</I>&gt;<i> however trying to run --debug with this.  But I get the same error when
</I>&gt;<i> debugging any tree grammer:
</I>&gt;<i> 
</I>&gt;<i> In the prog
</I>&gt;<i> 
</I>&gt;<i> 	int LA1_0 = input.LA(1);
</I>&gt;<i> 
</I>&gt;<i> Message: 	&quot;Object reference is not set to an instance of an
</I>&gt;<i> object.&quot;
</I>&gt;<i> Source:  	&quot;Antlr3.Rutime&quot;
</I>&gt;<i> StackTrace: &quot;   at Antlr.Runtime.Debug.DebugTreeNodeStream.LA(Int32
</I>&gt;<i> i)\r\n   at Eval1.prog() in
</I>&gt;<i> C:\\svnprojects\\Expression\\Expression2\\Eval1.cs:line 184\r\n   at
</I>&gt;<i> ConsoleApplication1.Program.Main(String[] args) in
</I>&gt;<i> C:\\svnprojects\\Expression\\Expression2\\Program.cs:line 22\r\n   at
</I>&gt;<i> System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)\r\n
</I>&gt;<i> at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence
</I>&gt;<i> assemblySecurity, String[] args)\r\n   at
</I>&gt;<i> Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\r\n
</I>&gt;<i> at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\r\n
</I>&gt;<i> at System.Threading.ExecutionContext.Run(ExecutionContext
</I>&gt;<i> executionContext, ContextCallback callback, Object state)\r\n   at
</I>&gt;<i> System.Threading.ThreadHelper.ThreadStart()&quot;
</I>&gt;<i> TargetSite:  {Int32 LA(Int32)}
</I>
I have never seen this kind of error, so I'm wondering if you mix the 3.0.1 generated code with the libraries of 3.1b1. As those are binary incompatible, this won't work ever. Otherwise, I've got myself the debugger for 3.0.1 running, so I don't believe that there is a bug hidden there causing this problem.
&gt;<i> 
</I>&gt;<i> So, I was wondering:
</I>&gt;<i> 
</I>&gt;<i> 1) Is there any version of Antlr with CSharp that run with debug (in the
</I>&gt;<i> tree grammar)?
</I>
Try my suggestions above.

&gt;<i> 2) Where can I find the sources to the 3.0.1 CSharp runtime so I can
</I>&gt;<i> figure out why the DebugTreeNodeStream fails?  I tried finding it at
</I>&gt;<i> FishEye but downloading the source from Aug 2007 results only in the
</I>&gt;<i> DLL's.
</I>
No one has the original sources for these assemblies. Long story short: You have to wait until I've fixed the bugs. May take a few days, as I've got to deal with long backlog due to harddrive failure.
&gt;<i> 3) Is there any examples of Antlr with CSharp for any projects that use
</I>&gt;<i> a Tree Grammar?
</I>
Yes. Fisheye has more recent examples which may not be released yet officially.

&gt;<i> 4) If the 3.1.b1 is the only version of Antlr that supports the CSharp2
</I>&gt;<i> target, and the CSharp2
</I>&gt;<i>    target is so broken it won't run against a simple grammar like the
</I>&gt;<i> &quot;Simple Tree based interpreter&quot;,
</I>&gt;<i>    should the all the Wiki examples point to the CSharp2 grammar?  I
</I>&gt;<i> spent many hours thinking my
</I>&gt;<i>    own grammar had some weird errors because I was getting NULL
</I>&gt;<i> exceptions only to find out that
</I>&gt;<i>    the 3.1.b1 with CSharp2 is very broken.
</I>
Sorry about that. My reasoning for pointing to CSharp2 instead CSharp is that CSharp2 is the future and once CSharp is retired someone may find an old example and wonder why things don't work. So I've edited them already in the expectation that 3.1 would be released soon with working CSharp(2) targets. And as the version is 3.1 BETA 1 you have to expect that some things are broken. Granted, my test coverage is far from ideal, but to a certain extent this is a legacy issue. I couldn't fix things as fast as I would like, so I have to rely on other users to find the showstoppers. :(

Johannes
-- 
Ist Ihr Browser Vista-kompatibel? Jetzt die neuesten 
Browser-Versionen downloaden: <A HREF="http://www.gmx.net/de/go/browser">http://www.gmx.net/de/go/browser</A>
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="028666.html">[antlr-interest] FW: CSharp Target...
</A></li>
	<LI>Next message: <A HREF="028709.html">[antlr-interest] FW: CSharp Target...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28678">[ date ]</a>
              <a href="thread.html#28678">[ thread ]</a>
              <a href="subject.html#28678">[ subject ]</a>
              <a href="author.html#28678">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
