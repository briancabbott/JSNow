<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Minor suggestion re. Java output
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Minor%20suggestion%20re.%20Java%20output&In-Reply-To=%3C%22L07A47765C5144cb2848A2E1E14FBBD28.1202229194.scalix.temporal-wave.com%2A%22%40MHS%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026211.html">
   <LINK REL="Next"  HREF="026216.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Minor suggestion re. Java output</H1>
    <B>Jim Idle</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Minor%20suggestion%20re.%20Java%20output&In-Reply-To=%3C%22L07A47765C5144cb2848A2E1E14FBBD28.1202229194.scalix.temporal-wave.com%2A%22%40MHS%3E"
       TITLE="[antlr-interest] Minor suggestion re. Java output">jimi at temporal-wave.com
       </A><BR>
    <I>Tue Feb  5 08:09:49 PST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="026211.html">[antlr-interest] Minor suggestion re. Java output
</A></li>
        <LI>Next message: <A HREF="026216.html">[antlr-interest] Minor suggestion re. Java output
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26215">[ date ]</a>
              <a href="thread.html#26215">[ thread ]</a>
              <a href="subject.html#26215">[ subject ]</a>
              <a href="author.html#26215">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As I was intimating in my last over-reaction ;-), I think that if the 
target was changed to 1.5+, then it may not be unreasonable to expect a 
certain level of interface compatibility and so perhaps some of this 
could be changed. However CommonTree, while by its name intimating that 
it is expected to be what people will generally use, might be too high 
up. The C target expects that you have implemented the calls to base 
tree and therefore the internal pointers are all to that type. That type 
contains a pointer to the next higher type, which can be CommonTree or 
anything you like really. So, you never cast anything in C.

In generated code, smaller is still good of course but the generating of 
the casts and so on isn't a big deal. In your own custom code you can 
derive from the existing classes and create the method signatures you 
need. The cast involves a runtime check to be sure, but I think it 
unlikely that you could measure its effects on the average tree parser.

I also believe that Ter has been contemplating targeting 1.5 for a while 
because of the use of generics and I think that 3.1 may in fact be 1.5 
dependant. At some point, another look at the situation is warranted. 
There are also plenty of other elements that can be improved for code 
generation and will be addressed over time I am sure. For now, it is 
faster than the v2 system and so is heading in the right direction.

Jim

&gt;<i> -----Original Message-----
</I>&gt;<i> From: Guntis Ozols [mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">guntiso at latnet.lv</A>]
</I>&gt;<i> Sent: Tuesday, February 05, 2008 6:36 AM
</I>&gt;<i> To: Jim Idle
</I>&gt;<i> Cc: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A>
</I>&gt;<i> Subject: Re: [antlr-interest] Minor suggestion re. Java output
</I>&gt;<i> 
</I>&gt;<i> &gt;  - Remember that the Java code target is 1.4;
</I>&gt;<i> &gt;  - The code is put together by the string template hence it is a 
</I>view
&gt;<i> &gt; and cannot know anything about the model;
</I>&gt;<i> &gt;  - All the elements of the output can be derived from, hence these
</I>&gt;<i> &gt; questions are about being lazy. I am all for development tools
</I>&gt;<i> allowing
</I>&gt;<i> &gt; one to be lazy, but only as lazy as possible. There is a bigger view
</I>&gt;<i> to
</I>&gt;<i> &gt; consider here;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Jim
</I>&gt;<i> 
</I>&gt;<i> It is also about less memory/cycles for each node and smaller/simpler
</I>&gt;<i> code.
</I>&gt;<i> 
</I>&gt;<i> The question that is puzzling me is:
</I>&gt;<i>   if java code target was 1.5 or later
</I>&gt;<i>   would then it be possible for CommonTree to return CommonTree
</I>&gt;<i> children?
</I>&gt;<i> 
</I>&gt;<i> I think the typical use cases are (no casting necessary, covariance
</I>&gt;<i> ok):
</I>&gt;<i>   - use default ast
</I>&gt;<i>   - extend TreeAdaptor and extend Tree/BaseTree/CommonTree
</I>&gt;<i> 
</I>&gt;<i> How typical do you think is to create a tree with nodes that are
</I>&gt;<i> instances of CommonTree having children that are not? (btw,
</I>&gt;<i> BaseTree.children
</I>&gt;<i> is protected, can be accessed anyway)
</I>&gt;<i> 
</I>&gt;<i> Guntis
</I>&gt;<i> 
</I>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026211.html">[antlr-interest] Minor suggestion re. Java output
</A></li>
	<LI>Next message: <A HREF="026216.html">[antlr-interest] Minor suggestion re. Java output
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26215">[ date ]</a>
              <a href="thread.html#26215">[ thread ]</a>
              <a href="subject.html#26215">[ subject ]</a>
              <a href="author.html#26215">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
