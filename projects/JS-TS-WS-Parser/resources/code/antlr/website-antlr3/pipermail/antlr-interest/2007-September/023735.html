<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Python target v3 unicode problems
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Python%20target%20v3%20unicode%20problems&In-Reply-To=%3Cfcddcd%2492g%241%40sea.gmane.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023731.html">
   <LINK REL="Next"  HREF="023736.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Python target v3 unicode problems</H1>
    <B>Kirill Lapshin</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Python%20target%20v3%20unicode%20problems&In-Reply-To=%3Cfcddcd%2492g%241%40sea.gmane.org%3E"
       TITLE="[antlr-interest] Python target v3 unicode problems">kir at lapshin.net
       </A><BR>
    <I>Fri Sep 14 00:31:24 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023731.html">[antlr-interest] Python target v3 unicode problems
</A></li>
        <LI>Next message: <A HREF="023736.html">[antlr-interest] Python target v3 unicode problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23735">[ date ]</a>
              <a href="thread.html#23735">[ thread ]</a>
              <a href="subject.html#23735">[ subject ]</a>
              <a href="author.html#23735">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Vi&#240;ar Svansson wrote:
&gt;<i> I tried this, now I can successfully load the strings thanks. However,
</I>&gt;<i> they seem to be somehow wrong after the parse. Here is my doctest:
</I>&gt;<i> 
</I>&gt;<i>     &gt;&gt;&gt; unicode_str = u'author : &quot;Vi&#240;ar Svansson&quot; ; '
</I>&gt;<i>     &gt;&gt;&gt; tree = transform(unicode_str,SymbolTable(), Decorator, Linker)
</I>&gt;<i>     &gt;&gt;&gt; tree
</I>&gt;<i>     {u'author' : u'Vi&#240;ar Svansson'}
</I>&gt;<i> 
</I>&gt;<i> Here, the transform function scans, and parses the string. Before I
</I>&gt;<i> used ANTLRFileStream(path, encoding='utf-8'), it would fail on the
</I>&gt;<i> scanning. Now the lexer works but the test fails in the end with this
</I>&gt;<i> output:
</I>&gt;<i> 
</I>&gt;<i> Failed example:
</I>&gt;<i>     tree
</I>&gt;<i> Expected:
</I>&gt;<i>     {u'author' : u'Vi&#240;ar Svansson'}
</I>&gt;<i> Got:
</I>&gt;<i>     {u'author': u'Vi\xc3\xb0ar Svansson'}
</I>&gt;<i> 
</I>&gt;<i> I am not sure what is wrong here, never seen seen hex values inside a
</I>&gt;<i> unicode encoding string. Any ideas?
</I>
Just a wild guess. There are many ways to encode the same string using 
Unicode, so two unicode strings representing the same sequence of 
characters could potentially have different sequence of bytes.

You can try to normalize strings before comparing, for example using 
Python's unicodedata.normalize function.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023731.html">[antlr-interest] Python target v3 unicode problems
</A></li>
	<LI>Next message: <A HREF="023736.html">[antlr-interest] Python target v3 unicode problems
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23735">[ date ]</a>
              <a href="thread.html#23735">[ thread ]</a>
              <a href="subject.html#23735">[ subject ]</a>
              <a href="author.html#23735">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
