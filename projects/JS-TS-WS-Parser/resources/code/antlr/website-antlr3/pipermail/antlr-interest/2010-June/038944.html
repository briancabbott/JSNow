<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Semantic predicate losing token/char position on	error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Semantic%20predicate%20losing%20token/char%20position%20on%0A%09error&In-Reply-To=%3CAANLkTinsS7EPz2WZ7GcsQiNjUPk7tB26N1GqrjDQjs1C%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038943.html">
   <LINK REL="Next"  HREF="038946.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Semantic predicate losing token/char position on	error</H1>
    <B>Karim Chichakly</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Semantic%20predicate%20losing%20token/char%20position%20on%0A%09error&In-Reply-To=%3CAANLkTinsS7EPz2WZ7GcsQiNjUPk7tB26N1GqrjDQjs1C%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Semantic predicate losing token/char position on	error">karimc17 at gmail.com
       </A><BR>
    <I>Mon Jun  7 08:43:56 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="038943.html">[antlr-interest] Discard comment text
</A></li>
        <LI>Next message: <A HREF="038946.html">[antlr-interest] Semantic predicate losing token/char position	on error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38944">[ date ]</a>
              <a href="thread.html#38944">[ thread ]</a>
              <a href="subject.html#38944">[ subject ]</a>
              <a href="author.html#38944">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Thank you again for your previous help.  I now know about
antlr.markmail.org(perhaps a link from
www.antlr.org would help others) and have searched for this problem to no
avail.  A year ago, someone asked what may be a related question, but no one
answered.

If you use the grammar I posted last week, and type in &quot;a ab&quot;, it will give
you an error and by looking at (token-&gt;start - parser-&gt;input_start) and
(token-&gt;stop - parser-&gt;input_start), it is possible to extract the character
position of the erroneous text in the input (giving 2 and 3, respectively,
corresponding to &quot;ab&quot;).  [Note token is picked up from
recognizer-&gt;state-&gt;exception-&gt;token and parser is picked up from
base_parser-&gt;super, where base_parser = recognizer-&gt;super.  The recognizer
is passed by ANTLR to my error handler, which overrides
displayRecognitionError.]

If, however, I add a semantic predicate to that grammar (enclosed) to
distinguish between X as a function call and X as a variable (which is
described starting on page 297 of the Definitive ANTLR Reference), I no
longer get a character position.  All four of the variables involved in the
position calculation are set to 1, and the start and stop then become zero.
These values are, by the way, a bit peculiar as these fields usually hold
pointers into the text.  I also note that token-&gt;input is now NULL.

I am guessing that perhaps the erroneous text has been consumed before the
error has been triggered, but I do not really know.  I do need the character
position of the text causing the error and would like to know how to get it
when using a semantic predicate in this manner.  Using a semantic predicate
at the end of the rule works just fine.  It is just this disambiguation
usage that fails to give the token causing the error.

Thank you,

Karim

PS is_function() takes an pANTLR3_STRING and can unconditionally return
false to drive this problem.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Test.g
Type: application/octet-stream
Size: 2112 bytes
Desc: not available
Url : <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20100607/55763903/attachment.obj">http://www.antlr.org/pipermail/antlr-interest/attachments/20100607/55763903/attachment.obj</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038943.html">[antlr-interest] Discard comment text
</A></li>
	<LI>Next message: <A HREF="038946.html">[antlr-interest] Semantic predicate losing token/char position	on error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38944">[ date ]</a>
              <a href="thread.html#38944">[ thread ]</a>
              <a href="subject.html#38944">[ subject ]</a>
              <a href="author.html#38944">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
