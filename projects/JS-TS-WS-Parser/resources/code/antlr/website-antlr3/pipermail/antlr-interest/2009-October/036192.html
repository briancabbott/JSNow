<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] [c target] debugging using antlrworks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20%5Bc%20target%5D%20debugging%20using%20antlrworks&In-Reply-To=%3Cop.u1bmuglmt3jqlu%40win-mupvrp0jyrf%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="036190.html">
   <LINK REL="Next"  HREF="036193.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] [c target] debugging using antlrworks</H1>
    <B>&#1070;&#1088;&#1091;&#1096;&#1082;&#1080;&#1085; &#1052;&#1080;&#1093;&#1072;&#1080;&#1083;</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20%5Bc%20target%5D%20debugging%20using%20antlrworks&In-Reply-To=%3Cop.u1bmuglmt3jqlu%40win-mupvrp0jyrf%3E"
       TITLE="[antlr-interest] [c target] debugging using antlrworks">yurushkin at rambler.ru
       </A><BR>
    <I>Mon Oct  5 02:48:06 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="036190.html">[antlr-interest] help on rewritting the tree
</A></li>
        <LI>Next message: <A HREF="036193.html">[antlr-interest] Out of Memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36192">[ date ]</a>
              <a href="thread.html#36192">[ thread ]</a>
              <a href="subject.html#36192">[ subject ]</a>
              <a href="author.html#36192">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> Then you have something wrong in one of your rules.  Specifically, you  
</I>&gt;<i> have a line that says &quot;progName = $program_stmt.progName&quot; in the wrong  
</I>&gt;<i> place, or using the wrong syntax; ANTLR is trying to treat it as a  
</I>&gt;<i> predicate instead of an action.  This also might explain why the  
</I>&gt;<i> debugger is not stopping.
</I>&gt;<i>
</I>&gt;<i> If you want further help with that, then you'll need to post the rule.
</I>
I used your grammar (with small modification). the same result...


MyLexer.g
=================================
lexer grammar MyLexer;

options
{
    language = C;
}


ID  :   ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')*
       ;

INT :	('0'..'9')+
       ;

WS  :   (   ' '
           |   '\t'
           |   '\r'
           |   '\n'
           )+
           { $channel=HIDDEN; }
       ;


MyParser.g
=================================

parser grammar MyParser;

options
{
       language	= C;
       tokenVocab = MyLexer;
}

@members
{
       ANTLR3_BOOLEAN enableEnum = ANTLR3_FALSE;
}

statement[ANTLR3_BOOLEAN asIDs]

       @init
       {
	enableEnum  = $asIDs;
       }
       : identifier    {printf(&quot;enum is an ID\n&quot;);}
       | enumAsKeyword {printf(&quot;enum is a keyword\n&quot;);}
       ;

identifier
       : ID
       | enumAsID
       ;

enumAsKeyword : {enableEnum}? enum1 ;

enumAsID : {!enableEnum}? enum1 ;


enum1: ID ;





MyParser.cpp
=================================

#include    &lt;antlr3.h&gt;
#include &lt;stdio.h&gt;
#include &quot;generated/MyLexer.h&quot;
#include &quot;generated/MyParser.h&quot;

int ANTLR3_CDECL
main	(int argc, char *argv[])
{
        pANTLR3_UINT8	    fName;

       pANTLR3_INPUT_STREAM    input;

       pMyLexer		    lxr;

       pANTLR3_COMMON_TOKEN_STREAM	    tstream;

       pMyParser				psr;
	fName	=(pANTLR3_UINT8)&quot;out/test.txt&quot;; // Note in VS2005 debug, working
directory must be configured

       input	= antlr3AsciiFileStreamNew(fName);

       if ( (ANTLR3_UINT64)input &lt; 0 )
       {
	switch((ANTLR3_UINT64)input)
	{
	case    ANTLR3_ERR_NOMEM:

	    fprintf(stderr, &quot;Unable to open file %s due to malloc() failure1\n&quot;,
(char *)fName);
	    exit(1);
	    break;

	default:

	    fprintf(stderr, &quot;Failed to open file %s - exit with code %d\n&quot;, (char
*)fName, (ANTLR3_UINT64)input);
	    exit((int)((ANTLR3_UINT64)input));
	    break;
	}
       }

       // Our input stream is now open and all set to go, so we can create a
new instance of our
       // lexer and set the lexer input to our input stream:
       //  (file | memory | ?) --&gt; inputstream -&gt; lexer --&gt; tokenstream --&gt;
parser ( --&gt; treeparser )?
       //
       lxr	    = MyLexerNew(input);	    // CLexerNew is generated by ANTLR

       // Need to check for errors
       //
       if ( (ANTLR3_UINT64)lxr &lt; 0 )
       {
	switch((ANTLR3_UINT64)lxr)
	{
	case    ANTLR3_ERR_NOMEM:

	    fprintf(stderr, &quot;Unable to create the lexer due to malloc()
failure1\n&quot;);
	    exit(1);
	    break;

	default:

	    fprintf(stderr, &quot;Failed to create lexer - exit with code %d\n&quot;,
(ANTLR3_UINT64)lxr);
	    exit((int)((ANTLR3_UINT64)lxr));
	    break;
	}
       }

       tstream = antlr3CommonTokenStreamSourceNew(ANTLR3_SIZE_HINT,
TOKENSOURCE(lxr));

       if ((ANTLR3_UINT64)tstream == ANTLR3_ERR_NOMEM)
       {
	fprintf(stderr, &quot;Out of memory trying to allocate token stream\n&quot;);
	exit(ANTLR3_ERR_NOMEM);
       }

       // Finally, now that we have our lexer constructed, we can create the
parser
       //
       psr	    = MyParserNew(tstream);  // CParserNew is generated by ANTLR3

       if ((ANTLR3_UINT64)tstream == ANTLR3_ERR_NOMEM)
       {
	fprintf(stderr, &quot;Out of memory trying to allocate parser\n&quot;);
	exit(ANTLR3_ERR_NOMEM);
       }

       psr-&gt;statement(psr, ANTLR3_TRUE);    // First see enum as a keyword


       psr	    -&gt;free  (psr);	    psr = NULL;
       tstream -&gt;free  (tstream);	    tstream = NULL;
       lxr	    -&gt;free  (lxr);	    lxr = NULL;
       input   -&gt;close (input);	    input = NULL;

       return 0;
}

===============================================
How do I use antlrworks debugger:
1) I generate lexer and parser using -debug option.
2) I run my project. It starts to listen antlrworks (standard port, I
checked).
3) I open MyParser.g grammar and click &quot;Remote debug&quot;. I use standard port.
4) My parser continies to work... and stops when it reach
		    &quot;DBG-&gt;enterRule(DBG, getGrammarFileName(), (const char
*)&quot;statement&quot;);&quot;  line
5) In this procedure parser transmits some info to debugger and waits.
6) I click &quot;Step forward&quot; and parser continies it work and returns.. In
AntlrWorks I tried to use breakpoints and &quot;step over&quot; button - no results.

-- 
Best regards,
Michael
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="036190.html">[antlr-interest] help on rewritting the tree
</A></li>
	<LI>Next message: <A HREF="036193.html">[antlr-interest] Out of Memory
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36192">[ date ]</a>
              <a href="thread.html#36192">[ thread ]</a>
              <a href="subject.html#36192">[ subject ]</a>
              <a href="author.html#36192">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
