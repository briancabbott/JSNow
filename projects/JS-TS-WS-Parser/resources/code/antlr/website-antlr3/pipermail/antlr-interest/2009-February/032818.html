<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Fwd: Referencing an expression on another parser	tree branch
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Fwd%3A%20Referencing%20an%20expression%20on%20another%20parser%0A%09tree%20branch&In-Reply-To=%3C8773d42e0902091553j7471de10t4d1caad16d02a0a1%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="032816.html">
   <LINK REL="Next"  HREF="032820.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Fwd: Referencing an expression on another parser	tree branch</H1>
    <B>Des Hartman</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Fwd%3A%20Referencing%20an%20expression%20on%20another%20parser%0A%09tree%20branch&In-Reply-To=%3C8773d42e0902091553j7471de10t4d1caad16d02a0a1%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Fwd: Referencing an expression on another parser	tree branch">des at deshartman.com
       </A><BR>
    <I>Mon Feb  9 15:53:50 PST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="032816.html">[antlr-interest] Bug in DFA matching?
</A></li>
        <LI>Next message: <A HREF="032820.html">[antlr-interest] multiple tree walkers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32818">[ date ]</a>
              <a href="thread.html#32818">[ thread ]</a>
              <a href="subject.html#32818">[ subject ]</a>
              <a href="author.html#32818">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I have been working on a formula input parser, using a lot of the code
Robert Stehwien wrote here
<A HREF="http://arcanearcade.blogspot.com/2008/04/using-antlr-to-create-excel-like.htmlI">http://arcanearcade.blogspot.com/2008/04/using-antlr-to-create-excel-like.htmlI</A>
changed the code to use the concept of a cell reference instead of
predefined values.

Think of this as an Excel spreadsheet where all the formulas of a column are
the same, so I refer to a column like this &quot;=B+5-SUM(8,A)&quot; for example. I am
stroring the row as a &quot;;&quot; separated string and thus process the &quot;;&quot; as part
of the input. I can get neat separation between cells and in the parser tree
you can see the value of each cell. this means I can store the values of
column A,B and C as follows:

34;12;=B+5-SUM(8,A)

I have attached my grammar code below and if you run the formula, you get a
nice grammar tree showing the decoded cells and references.

Question I have is, is there a way to now decode the references to the
previous cells A and B? In effect I want to &quot;copy&quot; the tress that the actual
cell has and then calculate the value. This is indicated by the red arrows
in the attached tree grammar.

another reason for doing this is that I want to check for circular
references while doing this, so if cell A has any references to cell C for
example, I will flag a circular reference.

I have been learning as fast as I can and really just need a nudge in the
right direction on this one, so any help would be great. Do I need to build
a specific tree grammar to do this?


Thanks
Des
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20090210/c24e79c6/attachment.html">http://www.antlr.org/pipermail/antlr-interest/attachments/20090210/c24e79c6/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CellFormula.g
Type: application/octet-stream
Size: 2407 bytes
Desc: not available
Url : <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20090210/c24e79c6/attachment.obj">http://www.antlr.org/pipermail/antlr-interest/attachments/20090210/c24e79c6/attachment.obj</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cellformulatree.GIF
Type: image/gif
Size: 37088 bytes
Desc: not available
Url : <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20090210/c24e79c6/attachment.gif">http://www.antlr.org/pipermail/antlr-interest/attachments/20090210/c24e79c6/attachment.gif</A> 
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="032816.html">[antlr-interest] Bug in DFA matching?
</A></li>
	<LI>Next message: <A HREF="032820.html">[antlr-interest] multiple tree walkers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#32818">[ date ]</a>
              <a href="thread.html#32818">[ thread ]</a>
              <a href="subject.html#32818">[ subject ]</a>
              <a href="author.html#32818">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
