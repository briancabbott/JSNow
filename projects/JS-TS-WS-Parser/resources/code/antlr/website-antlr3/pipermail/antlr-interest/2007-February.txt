From kroepke at classdump.org  Thu Feb  1 02:50:27 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Thu, 1 Feb 2007 11:50:27 +0100
Subject: [antlr-interest] antlr irc channel anywhere?
In-Reply-To: <4153ee230701311433p4e0f9365k7cb096060bf98701@mail.gmail.com>
References: <4153ee230701311433p4e0f9365k7cb096060bf98701@mail.gmail.com>
Message-ID: <1D91CC49-43A5-4A36-9097-9C49AD67834D@classdump.org>


On Jan 31, 2007, at 11:33 PM, Mark Mandel wrote:

> There isn't a ANTLR irc channel anywhere, is there?

Not that I know of, no. And I couldn't really justify hanging out on  
IRC during work anyway...;)

cheers,
-k

-- 
Kay R?pke
http://classdump.org/





From wiggjd at lsbu.ac.uk  Thu Feb  1 05:55:41 2007
From: wiggjd at lsbu.ac.uk (Wigg, J D)
Date: Thu, 1 Feb 2007 13:55:41 -0000
Subject: [antlr-interest] Antlr 2.7 Header sectiond
Message-ID: <10A786EB5741DE4DB252F7B9B9423D3A022C53B8@CSD-EXBE-VS2.lsbu.ac.uk>

Is it possible to declare separate header sections for lexer and
parser (even when lexer and parser are within the same *.g file)? I
seem to remember this being possible (in the past?).
 
I have had a look at the Antlr documentation under Header Section. It
refers to "respective addendums". Where are these?
 
A problem I see with the (standard?) header file is that as it appears
in both the CPPLexer and CPPparser we can't declare any variables in
it, only externs.
 
What I would like to do is to declare a variable set in the lexer
which I can use in the parser. To do this I think I need to declare it
as a global in the lexer and use it as an extern in the parser (or
vice versa). to do that I need separate headers for lexer and parser.
 
Can anyone point me in the right direction please?
 
David Wigg
CPP_parser.g
 
 
 
 



This e-mail message may be confidential and is intended only for the use of the individual(s) to whom it is addressed.  It may contain information which is or may be confidential, non-public or legally privileged. Please do not disseminate or distribute this message other than to its intended recipient without permission of the author. You should not copy it or use it for any purpose nor disclose its contents to any other person. If you have received this message in error, please notify me by email immediately and delete the original message and all copies in your computer systems.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070201/5e982926/attachment.html 

From dguy at bea.com  Thu Feb  1 08:58:22 2007
From: dguy at bea.com (David Guy)
Date: Thu, 1 Feb 2007 08:58:22 -0800
Subject: [antlr-interest] newbie question about nondeterminism between
	keywords and identifiers
Message-ID: <B5840546E892DD4587FF0DEBC11732E8033A5E2E@repbex01.amer.bea.com>

I have a typical lexer IDENT rule:

IDENT

options {testLiterals=true;}

   : ('_'|'a'..'z')('_'|'a'..'z'|'0'..'9')*

  ;

The language has some built in types. For example (from lexer):

 

TYPE_DATE   :"date";

// declares type

COLON        : ':';

 

In my parser, if I have a rule like:

 

decl:

IDENT COLON TYPE_DATE

;

 

I cannot parse "mydate : date" or "date_foo : date". The first example
gets IDENT than unexpected TYPE_DATE and the second case gets unexpected
TYPE_DATE. 

 

I know this is very basic stuff, but I have looked at sample Java
grammars and don't see anything different and of course in Java you can
say

int myint; int int_xxx;

 

_______________________________________________________________________
Notice:  This email message, together with any attachments, may contain
information  of  BEA Systems,  Inc.,  its subsidiaries  and  affiliated
entities,  that may be confidential,  proprietary,  copyrighted  and/or
legally privileged, and is intended solely for the use of the individual
or entity named in this message. If you are not the intended recipient,
and have received this message in error, please immediately return this
by email and then delete it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070201/a95ee6a5/attachment-0001.html 

From zhixueyong at hotmail.com  Thu Feb  1 09:39:45 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Thu, 01 Feb 2007 12:39:45 -0500
Subject: [antlr-interest] Antlr 2.7 Header sectiond
In-Reply-To: <10A786EB5741DE4DB252F7B9B9423D3A022C53B8@CSD-EXBE-VS2.lsbu.ac.uk>
References: <10A786EB5741DE4DB252F7B9B9423D3A022C53B8@CSD-EXBE-VS2.lsbu.ac.uk>
Message-ID: <ept8l1$5ae$1@sea.gmane.org>


>  
> What I would like to do is to declare a variable set in the lexer which 
> I can use in the parser. To do this I think I need to declare it as a 
> global in the lexer and use it as an extern in the parser (or vice 
> versa). to do that I need separate headers for lexer and parser.
>  

You can declare it in another file, then refer it ("extern") in .g file.



-- 
Xue Yong Zhi
http://xruby.blogspot.com


From dave at badgers-in-foil.co.uk  Fri Feb  2 00:59:48 2007
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Fri, 2 Feb 2007 08:59:48 +0000
Subject: [antlr-interest] newbie question about nondeterminism between
	keywords and identifiers
In-Reply-To: <B5840546E892DD4587FF0DEBC11732E8033A5E2E@repbex01.amer.bea.com>
References: <B5840546E892DD4587FF0DEBC11732E8033A5E2E@repbex01.amer.bea.com>
Message-ID: <20070202085947.GA8093@badgers-in-foil.co.uk>

On Thu, Feb 01, 2007 at 08:58:22AM -0800, David Guy wrote:
> I have a typical lexer IDENT rule:
> IDENT
> options {testLiterals=true;}
>    : ('_'|'a'..'z')('_'|'a'..'z'|'0'..'9')*
>   ;
> 
> The language has some built in types. For example (from lexer):
> TYPE_DATE   :"date";
> // declares type
> COLON        : ':';
> 
> In my parser, if I have a rule like:
> decl:
> IDENT COLON TYPE_DATE
> ;
> 
> I cannot parse "mydate : date" or "date_foo : date". The first example
> gets IDENT than unexpected TYPE_DATE and the second case gets unexpected
> TYPE_DATE. 

I'm not sure what's up, but,

- Is the IDENT lexer rule defined after all the keyword rules?  IIRC,
  order is important.

- Does 'date' really need to be a keyword (i.e. it's not allowed as an
  identifier, or will drive some other part of the grammar)?


ta,
dave

-- 
http://david.holroyd.me.uk/

From dguy at bea.com  Fri Feb  2 07:45:44 2007
From: dguy at bea.com (David Guy)
Date: Fri, 2 Feb 2007 07:45:44 -0800
Subject: [antlr-interest] newbie question about nondeterminism between
	keywords and identifiers
Message-ID: <B5840546E892DD4587FF0DEBC11732E8033A634B@repbex01.amer.bea.com>

I have tried putting my IDENT lexer rule last, but TYPE_DATE still
matches first. No matter what order I have tried, TYPE_DATE matches
first.

 

If "mydate : date" , "mydate" gets tokenized as IDENT, TYPE_DATE,

 

I am using ANTLR 2.7.2 in case that matters.

 

I am parsing a pre-existing language that I cannot change. Actually,
"date" can be an identifier and a type.

"date : date" is valid.

 

 

_______________________________________________________________________
Notice:  This email message, together with any attachments, may contain
information  of  BEA Systems,  Inc.,  its subsidiaries  and  affiliated
entities,  that may be confidential,  proprietary,  copyrighted  and/or
legally privileged, and is intended solely for the use of the individual
or entity named in this message. If you are not the intended recipient,
and have received this message in error, please immediately return this
by email and then delete it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070202/caa76bca/attachment.html 

From gilbert.williams at prosync.com  Fri Feb  2 08:10:52 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Fri, 2 Feb 2007 11:10:52 -0500
Subject: [antlr-interest] ANTLR 3 or 2.7 for new project?
Message-ID: <001b01c746e4$c3422bd0$b982e6cd@tsitelsys.com>

Greetings:

 

It appears that the ANTLR tool may be just the ticket for a small parsing
application, supplanting the old-fashioned hand-coded recursive descent
method I was going to use.

 

Questions for the list:

 

1.	Should I start out using 2.7 or the newly released 3.0?  I have
never used this tool, but do understand its potential.  A little guidance
before I get started would be greatly appreciated.
2.	I looked for a ANTLR grammars for Posix/Perl regular expressions.
It should not be difficult to generate this, but I would certainly rather
stand on the shoulders of giants than start from scratch.  Anyone got one of
these that they can share?

 

 

Thanks and have a great day!

 

Gilbert T. Williams

ProSync Technology Group, LLC

gilbert.williams at prosync.com

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070202/d04f7dc9/attachment.html 

From Kurt at AlphaSoftware.com  Fri Feb  2 08:43:06 2007
From: Kurt at AlphaSoftware.com (Kurt Rayner)
Date: Fri, 2 Feb 2007 11:43:06 -0500
Subject: [antlr-interest] newbie question about nondeterminism
	betweenkeywords and identifiers
In-Reply-To: <B5840546E892DD4587FF0DEBC11732E8033A5E2E@repbex01.amer.bea.com>
References: <B5840546E892DD4587FF0DEBC11732E8033A5E2E@repbex01.amer.bea.com>
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAAAFrvD8k4y1BvmbeLFcYHNLCgAAAEAAAAOy4ehMBd8dDi8khI8DWe8oBAAAAAA==@AlphaSoftware.com>

David,
 
You don't say which version you are using.  I am using 2.7.6 and generating
C++.
 
I have found that I have to declare keywords in the tokens section to avoid
ambiguities with identifiers.  I also set testLiterals to false.  
 
In cases where a keyword is also a valid identifier, I add the keyword to
the grammar's identifier rule.  I would be happy to hear about a simpler
approach.
 
Enjoy!
 
Kurt
 
class SqlLexer extends Lexer;
 
options {
            testLiterals = false;
            k = 12;
            caseSensitive = false;
            caseSensitiveLiterals = false;
            exportVocab = Sql;
            charVocabulary = '\3'..'\377'; 
}
 
tokens {
            A5SQLTOKEN_ALL = "all" ;
            A5SQLTOKEN_AND = "and" ;
            A5SQLTOKEN_APPEND = "append" ;
            A5SQLTOKEN_ANY = "any" ;
            A5SQLTOKEN_AS = "as" ;
 
  _____  

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of David Guy
Sent: Thursday, February 01, 2007 11:58 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] newbie question about nondeterminism
betweenkeywords and identifiers
 
I have a typical lexer IDENT rule:
IDENT
options {testLiterals=true;}
   : ('_'|'a'..'z')('_'|'a'..'z'|'0'..'9')*
  ;
The language has some built in types. For example (from lexer):
 
TYPE_DATE   :"date";
// declares type
COLON        : ':';
 
In my parser, if I have a rule like:
 
decl:
IDENT COLON TYPE_DATE
;
 
I cannot parse "mydate : date" or "date_foo : date". The first example gets
IDENT than unexpected TYPE_DATE and the second case gets unexpected
TYPE_DATE. 
 
I know this is very basic stuff, but I have looked at sample Java grammars
and don't see anything different and of course in Java you can say
int myint; int int_xxx;
 
_______________________________________________________________________

Notice:  This email message, together with any attachments, may contain

information  of  BEA Systems,  Inc.,  its subsidiaries  and  affiliated

entities,  that may be confidential,  proprietary,  copyrighted  and/or

legally privileged, and is intended solely for the use of the individual

or entity named in this message. If you are not the intended recipient,

and have received this message in error, please immediately return this

by email and then delete it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070202/38094815/attachment-0001.html 

From zhixueyong at hotmail.com  Fri Feb  2 11:56:11 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Fri, 02 Feb 2007 14:56:11 -0500
Subject: [antlr-interest] ANTLR 3 or 2.7 for new project?
In-Reply-To: <001b01c746e4$c3422bd0$b982e6cd@tsitelsys.com>
References: <001b01c746e4$c3422bd0$b982e6cd@tsitelsys.com>
Message-ID: <eq050r$38u$1@sea.gmane.org>


>    1. Should I start out using 2.7 or the newly released 3.0?  I have
>       never used this tool, but do understand its potential.  A little
>       guidance before I get started would be greatly appreciated.

Upgrading to 3.0 from 2.7 is not very easy (well, depends on the nature 
of your grammar),
So if your release date is at the second half of the the year (antlr 3.0 
stable and the book will come out), you may want to start with 3.0.

Meanwhile 2.7 is very stable and I am happy with it.

-- 
Xue Yong Zhi
http://xruby.blogspot.com


From antlr at mirality.co.nz  Fri Feb  2 12:31:41 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 03 Feb 2007 09:31:41 +1300
Subject: [antlr-interest] ANTLR 3 or 2.7 for new project?
In-Reply-To: <001b01c746e4$c3422bd0$b982e6cd@tsitelsys.com>
References: <001b01c746e4$c3422bd0$b982e6cd@tsitelsys.com>
Message-ID: <7.0.1.0.0.20070203092849.03478e70@mirality.co.nz>

At 05:10 3/02/2007, Bert Williams wrote:
>    * Should I start out using 2.7 or the newly released 3.0?  I 
> have never used this tool, but do understand its potential.  A 
> little guidance before I get started would be greatly 
> appreciated.
It depends a bit on which language you intend to use.  If it's 
Java, then you won't have any trouble with either version, since 
that's ANTLR's "native" language and so is always up to 
date.  Several of the other languages for 3.0, however, are out of 
date or completely nonexistent, which would make using them a bit 
tricky :)  So if you're using one of those languages then you 
might be better off sticking with 2.7 for now, since it's more 
mature.


From TomL at avokia.com  Fri Feb  2 14:40:49 2007
From: TomL at avokia.com (Tom Liu)
Date: Fri, 2 Feb 2007 17:40:49 -0500
Subject: [antlr-interest] Is ANTLR C runtime thread-safe?
Message-ID: <C8EB616CF20CA143AD2DE9BF45C911B4012D5679@cx41.800onemail.com>

 

Hi Jim

 

Is ANTLR C runtime thread-safe?

Or Is there a special version supporting multi-thread ?

 

 

Thanks

Tom

 


--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.14/578 - Release Date:
12/7/2006 1:27 AM



--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date:
12/7/2006 1:31 PM



--
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date:
12/7/2006 1:31 PM



--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date:
12/7/2006 1:31 PM



--
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date:
12/7/2006 1:31 PM


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070202/981a11ba/attachment.html 

From jimi at intersystems.com  Fri Feb  2 15:11:01 2007
From: jimi at intersystems.com (Jim Idle)
Date: Fri, 2 Feb 2007 18:11:01 -0500
Subject: [antlr-interest] Is ANTLR C runtime thread-safe?
In-Reply-To: <C8EB616CF20CA143AD2DE9BF45C911B4012D5679@cx41.800onemail.com>
References: <C8EB616CF20CA143AD2DE9BF45C911B4012D5679@cx41.800onemail.com>
Message-ID: <20070202231102.7DC856C9@mail.intersystems.com>

Tom,

 

The C runtime is actually free threading, subject to any system calls that you make in actions or the malloc/realloc/free() calls that it may cause. I deliberately made sure that the code generated and the runtime libraries do nothing that gets in the way of being thread safe. That isn?t to say there are not bugs (as I have not done lots of testing) but those can be fixed. The design is sound for threading though.

 

Jim

 

From: Tom Liu [mailto:TomL at avokia.com] 
Sent: Friday, February 02, 2007 2:41 PM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: Is ANTLR C runtime thread-safe?

 

 

Hi Jim

 

Is ANTLR C runtime thread-safe?

Or Is there a special version supporting multi-thread ?

 

 

Thanks

Tom

 

 

--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.14/578 - Release Date: 12/7/2006 1:27 AM

 

--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date: 12/7/2006 1:31 PM

 

--
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date: 12/7/2006 1:31 PM

 

--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date: 12/7/2006 1:31 PM

 

--
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.15.15/579 - Release Date: 12/7/2006 1:31 PM

 

--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.17.19/663 - Release Date: 2/1/2007 2:28 PM


-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.5.432 / Virus Database: 268.17.19/663 - Release Date: 2/1/2007 2:28 PM
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070202/318c049d/attachment.html 

From vadimtro at yahoo.com  Fri Feb  2 17:15:59 2007
From: vadimtro at yahoo.com (Vadim Tropashko)
Date: Fri, 2 Feb 2007 17:15:59 -0800 (PST)
Subject: [antlr-interest] options {output=AST;}
Message-ID: <557581.18342.qm@web36802.mail.mud.yahoo.com>

I'm hitting the same bug that Ilia reported in Dec:

org.antlr.Tool complains about unexpected token:
options. However, I don't have any workaround.
Interestingly, antlworks interpreter works fine as
long as "options" follows immediately the "grammar".

Questions: 
1. If there are only 2 output values: "AST" together
with "template", and "template" is some new feature,
wouldn't AST generation assumed to be default? 
2. Since interpreter and debugger output AST tree
without any options setting, I assume there is a way
to get AST programmatically without setting
output=AST?  
    


 
____________________________________________________________________________________
The fish are biting. 
Get more visitors on your site using Yahoo! Search Marketing.
http://searchmarketing.yahoo.com/arp/sponsoredsearch_v2.php

From martin.nordin at gmail.com  Fri Feb  2 20:58:00 2007
From: martin.nordin at gmail.com (Martin Nordin)
Date: Sat, 3 Feb 2007 10:28:00 +0530
Subject: [antlr-interest] newbie question about nondeterminism between
	keywords and identifiers
In-Reply-To: <B5840546E892DD4587FF0DEBC11732E8033A5E2E@repbex01.amer.bea.com>
References: <B5840546E892DD4587FF0DEBC11732E8033A5E2E@repbex01.amer.bea.com>
Message-ID: <ef6e9f1c0702022058v7c3fd866u4e01099d6cb6e416@mail.gmail.com>

Hi David.

I think you'll have to move the type identifying stuff to the parser.

As I'm quite a newbie myself I don't know if this is what you need or event
if it is a good approach or not.

If you have more types than just date you probably have to add a type-rule
in the parser:

type : ( "date" | "int" ) ;

and change decl to use type instead of "date".

Here is my test grammar, you need to run it through a debugger to see that
it actually does something:

header { import java.io.*; }

class DateLexer extends Lexer;

options { k=1; }
WS
  :
  (' '
  | '\t'
  | '\r' '\n' { newline(); }
  | '\n'      { newline(); }
  )
  { $setType(Token.SKIP); } ;

IDENT
options {testLiterals=true;}
  : ('_'|'a'..'z')('_'|'a'..'z'|'0'..'9')*
  ;

COLON  : ':';
SEMI   : ';';

class DateParser extends Parser;

{

  // a sample main
  public static void main(String[] args)
  {

    // Use a try/catch block for parser exceptions
    try {
      InputStream input  = new StringBufferInputStream("date1 : date; date2
: date;");
      DateLexer   lexer  = new DateLexer(input);
      DateParser  parser = new DateParser(lexer);
      parser.declarations();
    }
    catch (Exception e) {
      System.err.println("parser exception: "+e);
      e.printStackTrace();   // so we can get stack trace
    }
  }
}

decl:
  IDENT COLON "date" SEMI
  ;

declarations :
  (decl)*
  ;

Regards,
Martin


On 2/1/07, David Guy <dguy at bea.com> wrote:
>
>  I have a typical lexer IDENT rule:
>
> IDENT
>
> options {testLiterals=true;}
>
>    : ('_'|'a'..'z')('_'|'a'..'z'|'0'..'9')*
>
>   ;
>
> The language has some built in types. For example (from lexer):
>
>
>
> TYPE_DATE   :"date";
>
> // declares type
>
> COLON        : ':';
>
>
>
> In my parser, if I have a rule like:
>
>
>
> decl:
>
> IDENT COLON TYPE_DATE
>
> ;
>
>
>
> I cannot parse "mydate : date" or "date_foo : date". The first example
> gets IDENT than unexpected TYPE_DATE and the second case gets unexpected
> TYPE_DATE.
>
>
>
> I know this is very basic stuff, but I have looked at sample Java grammars
> and don't see anything different and of course in Java you can say
>
> int myint; int int_xxx;
>
>
>
> _______________________________________________________________________
> Notice:  This email message, together with any attachments, may contain
> information  of  BEA Systems,  Inc.,  its subsidiaries  and  affiliated
> entities,  that may be confidential,  proprietary,  copyrighted  and/or
> legally privileged, and is intended solely for the use of the individual
> or entity named in this message. If you are not the intended recipient,
> and have received this message in error, please immediately return this
> by email and then delete it.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070203/01bfdbf7/attachment-0001.html 

From parrt at cs.usfca.edu  Fri Feb  2 21:01:14 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 2 Feb 2007 21:01:14 -0800
Subject: [antlr-interest] options {output=AST;}
In-Reply-To: <557581.18342.qm@web36802.mail.mud.yahoo.com>
References: <557581.18342.qm@web36802.mail.mud.yahoo.com>
Message-ID: <97B8E3A8-A369-4E02-BD01-6EED85D913C5@cs.usfca.edu>


On Feb 2, 2007, at 5:15 PM, Vadim Tropashko wrote:
> Questions:
> 1. If there are only 2 output values: "AST" together
> with "template", and "template" is some new feature,
> wouldn't AST generation assumed to be default?

Hi. can only output template or ASt.

> 2. Since interpreter and debugger output AST tree
> without any options setting, I assume there is a way
> to get AST programmatically without setting
> output=AST?

You can get a parse tree not an AST, which is what th edebugger can  
do automatically.  See the debug interface to get the parse tree.

Ter

From martin.nordin at gmail.com  Fri Feb  2 21:35:36 2007
From: martin.nordin at gmail.com (Martin Nordin)
Date: Sat, 3 Feb 2007 11:05:36 +0530
Subject: [antlr-interest] newbie question about nondeterminism between
	keywords and identifiers
In-Reply-To: <B5840546E892DD4587FF0DEBC11732E8033A634B@repbex01.amer.bea.com>
References: <B5840546E892DD4587FF0DEBC11732E8033A634B@repbex01.amer.bea.com>
Message-ID: <ef6e9f1c0702022135w51825a7ob7fd228abc9b10ee@mail.gmail.com>

Hi again.

Here is a version that allows date : date; and does some printouts :)

header {
import java.io.*; }

class DateLexer extends Lexer;

options { k=1; }
WS
  :
  (' '
  | '\t'
  | '\r' '\n' { newline(); }
  | '\n'      { newline(); }
  )
  { $setType(Token.SKIP); } ;

IDENT
options {testLiterals=true;}
  : ('_'|'a'..'z')('_'|'a'..'z'|'0'..'9')*
  ;

COLON  : ':';
SEMI   : ';';

class DateParser extends Parser;

{
  public static void main(String[] args)
  {

    // Use a try/catch block for parser exceptions
    try {
      InputStream input  = new StringBufferInputStream("date : date; date1 :
date; an_int : int;");
      DateLexer   lexer  = new DateLexer(input);
      DateParser  parser = new DateParser(lexer);
      parser.declarations();
    }
    catch (Exception e) {
      System.err.println("parser exception: "+e);
      e.printStackTrace();   // so we can get stack trace
    }
  }
}

decl:
  theVar:IDENT COLON theType:IDENT SEMI { System.out.println("Type
declaration. Variable: " + theVar.getText() + " Type: " + theType.getText()
); }
  ;

declarations :
  (decl)*
  ;




On 2/2/07, David Guy <dguy at bea.com> wrote:
>
>  I have tried putting my IDENT lexer rule last, but TYPE_DATE still
> matches first. No matter what order I have tried, TYPE_DATE matches first.
>
>
>
> If "mydate : date" , "mydate" gets tokenized as IDENT, TYPE_DATE,
>
>
>
> I am using ANTLR 2.7.2 in case that matters.
>
>
>
> I am parsing a pre-existing language that I cannot change. Actually,
> "date" can be an identifier and a type.
>
> "date : date" is valid.
>
>
>
>
>
> _______________________________________________________________________
> Notice:  This email message, together with any attachments, may contain
> information  of  BEA Systems,  Inc.,  its subsidiaries  and  affiliated
> entities,  that may be confidential,  proprietary,  copyrighted  and/or
> legally privileged, and is intended solely for the use of the individual
> or entity named in this message. If you are not the intended recipient,
> and have received this message in error, please immediately return this
> by email and then delete it.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070203/45eee229/attachment.html 

From JeanMarc.Vanel at mathworks.fr  Sat Feb  3 04:31:32 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Sat, 3 Feb 2007 13:31:32 +0100
Subject: [antlr-interest] Translating from Java to C++
Message-ID: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>

Yesterday I tried Antlr. The initial motivation was to translate my Java
code into C++. There is a very nice and clean Java 5 grammar with Antlr
3b6 <http://www.antlr.org/grammar/1152141644268/java.g>  (other Java
grammars for antlr 2.7.X
<http://www.antlr.org/grammar/1090713067533/index.html>  ). I can parse
any Java source tree. But apparently no one has written a translator on
top of the Java 5 grammar . Of course there is some work to do, but
certainly less than the translation from C++ to Java; see comparing c++
and java
<http://www.javacoffeebreak.com/articles/thinkinginjava/comparingc++andj
ava.html>  for a list of differences. I don't expect a full translation
at first, I would be satisfied by something translating over 95% of the
syntax, leaving 5% to correct manually.

I don't know yet how to implement the translator:

*	use Tree construction (rewrite rules) as explained in 

http://www.antlr.org/wiki/display/ANTLR3/Tree+construction

http://www.antlr.org/doc/trees.html#_bb1

*	traverse the Abstract Syntax tree in Java and directly output
what I want 
*	use stringtemplate <http://www.stringtemplate.org/>  , which
seems well integrated with Antlr, having the same author . 

In fact in first approximation, neglecting the .h files, a C++ class is
very similar to a Java class with some local changes (like replacing
"extends" by ":" ) or less local changes, like:

A a = new A(); ===> A* a = new A();

Is it possible to start from a verbatim recursive template, then adding
rules incrementally, like is often done in XSLT ? In fact I'd be
interested to read about comparison of concepts between Antlr and XSLT.

Or wouldn't it be possible to use the multi-language layer that is
inside Antlr and which allows Antlr to generate parsers in several
languages like Java, C++, C# ?

Among the questions I have is this one. Which is the best way to keep
the grammar definition separate from the different uses of that grammar
? Like reusing the pure Java 5 grammar for 1) a translator to C++ , 2) a
Java code quality checker , 3) a pattern recognizer for design patterns
, etc . 

I have to confess that I'm new to Antlr, although I collaborated to
eXist <http://exist-db.org/>  , which has an Antlr grammar for XQuery. I
already wrote a non-trivial flex-bison parser and lots of XSLT.

Jean Marc Vanel

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070203/1dd29c97/attachment.html 

From voytechs at yahoo.com  Sat Feb  3 12:51:31 2007
From: voytechs at yahoo.com (Mark Bednarczyk)
Date: Sat, 3 Feb 2007 15:51:31 -0500
Subject: [antlr-interest] Embedding ANTLR in my grammar
Message-ID: <20070203205300.CFA191907D4@www.antlr.org>

Hope you guys don't mind I share some excittement.

I have an interesting idea. I'm embedding ANTLR into my own grammar (NPL)
and adding few extra's to make it work nice as a NPL file.
 
Here is a non working sample as of yet, of the resulting syntax mix. I'm
still working on the grammar, but I'm getting very excitted over here.

Quick NPL intro: NPL is used to convert binary buffers full of network
packet data (byte streams), into object oriented packet/header/field tree
structured result. User's can access any of the declared members, fields and
headers that were produced from a resulting Packet object.
 
But what to do with textual protocols? This has been a major problem in
previous version of jNetStream. My idea is to embed a full parser and let it
handle all the complexity of parsing text input and then generate the proper
output expected by the runtime:

// HTTP NPL definition with ANTLR grammar definition embeded
// First creates a parser with HTTP EBNF grammar
// At end of NPL definition, we activate the parser  

public header HTTP {
	
	/*
	 * RFC 2616
	 * Define a grammar for HTTP messages using ANTLR v3 syntax.
	 * This a type definition for the parser, the parser is not
instantiated
	 * here.
	 */
	public typedef parser HTTPParser {
		generic					// RFC 822 - generic
message format
			:	Request | Response	// HTTP/1.1 messages
			;
			
		message
			:	
			
			start 
				(header CRLF)* 
				CRLF
				body?
			;
			
		start
			:	request | status
			;
			
		public final field string 
		request
			:	method SP requestURI SP Version CRLF
				(
					(	generalHeader
					|	requestHeader
					|	entityHeader
					) CRLF
				)*
				CRLF
				body?
			;
				
		public final field uri 
		requestURI
			:	'*'
			|	absoluteURI
			|	absPath
			|	authority
			;
				
		method
			:	'OPTIONS"
			|	'GET'
			|	'HEAD'
			|	'POST'
			|	'PUT'
			|	'DELETE'
			|	'TRACE'
			|	'CONNECT'
			|	extensionMethod
			;
			
		extensionMethod
			:	token
			;
	}; 
	
	/*
	 * Allocate our parser statically, we don't want to allocate one per
header
	 * but 1 for all HTTP headers, and tell the runtime to use the
parser as input
	 * The parser will export all rules that are marked with "field"
modifier as
	 * fields to the HTTP header. Any of its subrules will become
subfields.
	 * So be careful not to go overboard or we could potentially create
fields
	 * down to individual tokens or worse, down to each character.
	 */
	public static final HTTPParser parser = new HTTPParser();
	
	/*
	 * We only need to invoke the parser at runtime to kick start the
parsing.
	 * We pass in a reference to this header so that the parser can
export the
	 * fields its generates. The input is aready aligned at the start of
HTTP 
	 * data and ready for parsing.
	 */
	parser.generic(this);
}

Notice that certain rules are prefixed with "public final field" which would
be filtered out and replaced by appropriate action to produce a "field" and
export it into the parent header which is passed as an argument as the last
line of code. After the filtering what would remain is pure ANTLR grammar
that can be fed into ANTLR compiler. NPL definitions are cross compiled to
normal java, so the NPL compilation step already involves invoking the javac
as a second stage.

If the above were to compile and to be used in a java program you'd use it
like this. The NPL compiler generates java classes for headers and fields
are accessible as class members. 

	// Capture 10 HTTP packets
	LiveCapture capture = Captures.openLive(10, new PcapFilter("http"));

	for (Packet packet: capture) {

	  // A java class is generated for every NPL header statement - same
name
	  HTTP http = packet.getHeader(HTTP.class);

	  // ANTLR rule "request: ..." turned into HTTP.request() and
HTTP.hasRequest()
	  if (http.hasRequest()) {  
	    System.out.printf("HTTP packet was a request [%s] to URI=%s\n",
	           http.request().toString(), http.requestURI().toString());
	  } else {
	    System.out.printf("HTTP packet was something else\n");
	  }
	}
	capture.close();

I think this is a pretty neat way to leverage the power of ANTLR.

Cheers,
Mark...

http://jnetstream.sf.net



From antlr at jazillian.com  Sun Feb  4 07:19:58 2007
From: antlr at jazillian.com (Andy Tripp)
Date: Sun, 04 Feb 2007 10:19:58 -0500
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
Message-ID: <45C5F99E.20505@jazillian.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070204/6bf1d6c0/attachment.html 

From omry at yadan.net  Sun Feb  4 07:43:10 2007
From: omry at yadan.net (Omry Yadan)
Date: Sun, 04 Feb 2007 17:43:10 +0200
Subject: [antlr-interest] Preprocessor
Message-ID: <45C5FF0E.8090005@yadan.net>

Hi all,

I want to write a Java preprocessor, and I bumped into this in the FAQ: 
http://www.jguru.com/faq/view.jsp?EID=893706

as I understand it, the problem is that its hard to detect the beginning 
of the line with grammar because there is nothing to match against.

The suggestion approach (java loop breaking the lines and sending them 
for preprocessing) would work, but its not as nice as having ANLR spit 
lines for me


I was thinking of the following little hack, that might work:

to append a special symbol that indicate the beginning of the next line 
when an EOL is encountered. and also before the first line using a 
syntactic start point.

my question is really

1. how do I consume the EOL and insert the LINE_START symbol in its place?

2. am I in the right direction?


Thanks,

    Omry.




From rschulz at sonic.net  Sun Feb  4 07:57:28 2007
From: rschulz at sonic.net (Randall R Schulz)
Date: Sun, 4 Feb 2007 07:57:28 -0800
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <45C5F99E.20505@jazillian.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
	<45C5F99E.20505@jazillian.com>
Message-ID: <200702040757.28829.rschulz@sonic.net>

Andy,

On Sunday 04 February 2007 07:19, Andy Tripp wrote:
>  I spent three years building a C-to-Java translator, and also have a
> COBOL-to-Java translator and C++-to-Java translator both in beta
> trials now. See jazillian.com. It's harder than it looks, and the
> biggest issue is what to do with the libraries.

This is probably only a tangent, but now that Sun's Java is open-source 
(and the library sources, at least the non-native methods, were 
available in the SDK for a long time), you could just take the library 
sources (for the pure Java classes, anyway) and apply your translator.


Randall Schulz

From antlr at jazillian.com  Sun Feb  4 08:50:26 2007
From: antlr at jazillian.com (Andy Tripp)
Date: Sun, 04 Feb 2007 11:50:26 -0500
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <200702040757.28829.rschulz@sonic.net>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>	<45C5F99E.20505@jazillian.com>
	<200702040757.28829.rschulz@sonic.net>
Message-ID: <45C60ED2.7060506@jazillian.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070204/20adf360/attachment.html 

From antlr at jazillian.com  Sun Feb  4 08:51:05 2007
From: antlr at jazillian.com (Andy Tripp)
Date: Sun, 04 Feb 2007 11:51:05 -0500
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
Message-ID: <45C60EF9.7020906@jazillian.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070204/8debebdd/attachment-0001.html 

From rschulz at sonic.net  Sun Feb  4 08:56:23 2007
From: rschulz at sonic.net (Randall R Schulz)
Date: Sun, 4 Feb 2007 08:56:23 -0800
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <45C60ED2.7060506@jazillian.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
	<200702040757.28829.rschulz@sonic.net>
	<45C60ED2.7060506@jazillian.com>
Message-ID: <200702040856.23411.rschulz@sonic.net>

On Sunday 04 February 2007 08:50, Andy Tripp wrote:
>  I only do C++ to Java, not Java to C++.

Sorry. I obviously didn't pay close enough attention to what you wrote.

For the OP, translating Java to C++, the availability of the Sun sources 
may still be useful. But the terms of the open source license under 
which Sun has released Java could still be problematic.

RRS

From jimi at intersystems.com  Sun Feb  4 11:05:01 2007
From: jimi at intersystems.com (Jim Idle)
Date: Sun, 4 Feb 2007 14:05:01 -0500
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <45C5F99E.20505@jazillian.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
	<45C5F99E.20505@jazillian.com>
Message-ID: <20070204190522.2A79C9E@mail.intersystems.com>

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andy Tripp
Sent: Sunday, February 04, 2007 7:20 AM
To: Jean Marc Vanel
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Translating from Java to C++

 

I spent three years building a C-to-Java translator, and also have a
COBOL-to-Java translator
and C++-to-Java translator both in beta trials now. See jazillian.com.
It's harder than it looks,
and the biggest issue is what to do with the libraries.

 

Although the original post was about Java to C++ Andy. Potentially this
is an easier problem, but your conjecture here is otherwise completely
accurate, the work is in all the support libraries. What do you do when
the java code creates a remote interface, calls swing classes, etc. Lots
of work providing the C++ equivalent of all the Java interfaces,
compared to which the code translation is trivial (especially as you can
ignore a lot of optimizations you would perform the other way as the C++
compiler will do them for you.

 

Jim

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070204/3dcf4d52/attachment.html 

From mail at martin-probst.com  Mon Feb  5 08:40:18 2007
From: mail at martin-probst.com (Martin Probst)
Date: Mon, 5 Feb 2007 17:40:18 +0100
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <20070130232613.EBC997A2@mail.intersystems.com>
References: <236822.88749.qm@web36811.mail.mud.yahoo.com>
	<20070130232613.EBC997A2@mail.intersystems.com>
Message-ID: <2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>

Hi,

> You need to use @header::lexer and @header::parser. Otherwise the  
> header element will only appear in one of them (can?t remember  
> which it is now by default ;-).

Why is that actually so? Apparently 95% of all beginners with ANTLR 3  
run into this problem, maybe you should simply adjust to the users  
and make @header {} be inherited by both parser and lexer?

Regards,
Martin



From dguy at bea.com  Mon Feb  5 09:12:12 2007
From: dguy at bea.com (David Guy)
Date: Mon, 5 Feb 2007 09:12:12 -0800
Subject: [antlr-interest] newbie question about nondeterminism between
	keywords and identifiers
In-Reply-To: <ef6e9f1c0702022135w51825a7ob7fd228abc9b10ee@mail.gmail.com>
References: <B5840546E892DD4587FF0DEBC11732E8033A634B@repbex01.amer.bea.com>
	<ef6e9f1c0702022135w51825a7ob7fd228abc9b10ee@mail.gmail.com>
Message-ID: <B5840546E892DD4587FF0DEBC11732E8033A69C3@repbex01.amer.bea.com>

Thanks very much Martin.

 

I tried your suggestion, and it worked fine. I defined tokens (e.g.,
TYPE_DATE) and then override the type when the literal "date" matches in
the parser so my types are correct. 

 

I have a strong suspicion that there is a better solution, but I'm
getting the results I need.

 

Thanks again,

 

David

 

________________________________

From: Martin Nordin [mailto:martin.nordin at gmail.com] 
Sent: Saturday, February 03, 2007 12:36 AM
To: David Guy
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] newbie question about nondeterminism
between keywords and identifiers

 

Hi again. 

Here is a version that allows date : date; and does some printouts :)

header {
import java.io.* ; }

class DateLexer extends Lexer;

options { k=1; }
WS
  :
  (' ' 
  | '\t' 
  | '\r' '\n' { newline(); } 
  | '\n'      { newline(); }
  ) 
  { $setType( Token.SKIP); } ;
    
IDENT
options {testLiterals=true;}
  : ('_'|'a'..'z')('_'|'a'..'z'|'0'..'9')*
  ;

COLON  : ':';
SEMI   : ';'; 
  
class DateParser extends Parser;

{
  public static void main(String[] args) 
  {

    // Use a try/catch block for parser exceptions
    try {
      InputStream input  = new StringBufferInputStream("date : date;
date1 : date; an_int : int;"); 
      DateLexer   lexer  = new DateLexer(input);
      DateParser  parser = new DateParser(lexer);
      parser.declarations();
    }
    catch (Exception e) {
      System.err.println("parser exception: "+e); 
      e.printStackTrace();   // so we can get stack trace        
    }
  }
}   

decl:
  theVar:IDENT COLON theType:IDENT SEMI { System.out.println("Type
declaration. Variable: " + theVar.getText () + " Type: " +
theType.getText() ); } 
  ;
  
declarations :
  (decl)*
  ;
  
 



On 2/2/07, David Guy < dguy at bea.com <mailto:dguy at bea.com> > wrote:

I have tried putting my IDENT lexer rule last, but TYPE_DATE still
matches first. No matter what order I have tried, TYPE_DATE matches
first.

 

If "mydate : date" , "mydate" gets tokenized as IDENT, TYPE_DATE,

 

I am using ANTLR 2.7.2 in case that matters.

 

I am parsing a pre-existing language that I cannot change. Actually,
"date" can be an identifier and a type.

"date : date" is valid.

 

 

_______________________________________________________________________

Notice:  This email message, together with any attachments, may contain

information  of  BEA Systems,  Inc.,  its subsidiaries  and  affiliated


entities,  that may be confidential,  proprietary,  copyrighted  and/or

legally privileged, and is intended solely for the use of the individual

or entity named in this message. If you are not the intended recipient,


and have received this message in error, please immediately return this

by email and then delete it.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070205/1de7fcdb/attachment.html 

From jimi at intersystems.com  Mon Feb  5 09:19:10 2007
From: jimi at intersystems.com (Jim Idle)
Date: Mon, 5 Feb 2007 12:19:10 -0500
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>
References: <236822.88749.qm@web36811.mail.mud.yahoo.com>
	<20070130232613.EBC997A2@mail.intersystems.com>
	<2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>
Message-ID: <20070205171911.ECB5E967@mail.intersystems.com>

ANTLR3 beginners will then just run into a different behavior issue as
soon as they want something in the headers other than the package and
want one thing in the lexer and another in the parser ;-). Also, now
that the book is virtually out the door, such things should be much less
of an issue providing the book is read beforehand.

One possibility though is to not have a default for the @header {} which
will then just leave @lexer::header and @parser::header, which are
probably more obvious.

Jim

-----Original Message-----
From: Martin Probst [mailto:mail at martin-probst.com] 
Sent: Monday, February 05, 2007 8:40 AM
To: Jim Idle
Cc: Vadim Tropashko; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Lexer and Parser class packaging

Hi,

> You need to use @header::lexer and @header::parser. Otherwise the  
> header element will only appear in one of them (can't remember  
> which it is now by default ;-).

Why is that actually so? Apparently 95% of all beginners with ANTLR 3  
run into this problem, maybe you should simply adjust to the users  
and make @header {} be inherited by both parser and lexer?

Regards,
Martin



From dave at badgers-in-foil.co.uk  Mon Feb  5 09:37:40 2007
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Mon, 5 Feb 2007 17:37:40 +0000
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <20070205171911.ECB5E967@mail.intersystems.com>
References: <236822.88749.qm@web36811.mail.mud.yahoo.com>
	<20070130232613.EBC997A2@mail.intersystems.com>
	<2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>
	<20070205171911.ECB5E967@mail.intersystems.com>
Message-ID: <20070205173740.GA475@badgers-in-foil.co.uk>

On Mon, Feb 05, 2007 at 12:19:10PM -0500, Jim Idle wrote:
> One possibility though is to not have a default for the @header {} which
> will then just leave @lexer::header and @parser::header, which are
> probably more obvious.

+1 !

ta,
dave

-- 
http://david.holroyd.me.uk/

From mail at martin-probst.com  Mon Feb  5 11:14:15 2007
From: mail at martin-probst.com (Martin Probst)
Date: Mon, 5 Feb 2007 20:14:15 +0100
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <20070205171911.ECB5E967@mail.intersystems.com>
References: <236822.88749.qm@web36811.mail.mud.yahoo.com>
	<20070130232613.EBC997A2@mail.intersystems.com>
	<2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>
	<20070205171911.ECB5E967@mail.intersystems.com>
Message-ID: <04835DCF-FBF6-4D2C-8527-0F5789F3919B@martin-probst.com>

Hi,

> Also, now that the book is virtually out the door, such things  
> should be
> much less of an issue providing the book is read beforehand.

Come on, you don't really believe people will start reading manuals,  
do you? :-)

> One possibility though is to not have a default for the @header {}  
> which
> will then just leave @lexer::header and @parser::header, which are
> probably more obvious.

The standard language is Java, and the standard use case for the  
header in that language is setting the package. The only other thing  
you can do there is add additional imports, which are probably  
identical for Parser and Lexer, too (or you just import all in both  
and don't care...).  I think the cases where people want different  
things for lexer/parser in the header are really corner cases. Stuff  
should work by default.

So I think this is indeed not a very user friendly design as the  
default of what the user wants and the default of what ANLTR does and  
requires do not really agree.

Regards,
Martin



From jimi at intersystems.com  Mon Feb  5 11:24:24 2007
From: jimi at intersystems.com (Jim Idle)
Date: Mon, 5 Feb 2007 14:24:24 -0500
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <04835DCF-FBF6-4D2C-8527-0F5789F3919B@martin-probst.com>
References: <236822.88749.qm@web36811.mail.mud.yahoo.com>
	<20070130232613.EBC997A2@mail.intersystems.com>
	<2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>
	<20070205171911.ECB5E967@mail.intersystems.com>
	<04835DCF-FBF6-4D2C-8527-0F5789F3919B@martin-probst.com>
Message-ID: <20070205192425.96673867@mail.intersystems.com>

These can also be used to define variables/flags/etc that are specific
to the lexer and parser (and in fact cannot be seen by both at once).
However though I am not against it, this isn't my design, so you should
pursue such a change suggestion with Ter really. Though to be honest I
think by changing this you shift the issue of learning how it works
elsewhere: "My definition is turning up in both the lexer and parser and
I only want it in the parser?" 

IMO, it is just part of the learning curve for the tool and if it is
documented it should be enough, even if the syntax were ::l/h-ins at 4 ;-)
Writing recognizers, while not the most difficult thing in the world, is
also not for beginner level programmers. I do expect that if there is a
manual available that people trying to write recognizers would be at
least experienced enough in programming to consult it if they cannot
work something out by osmosis ;-). I don't think that ANTLR should be
written with ease of use as TOP priority, though it should not be
deliberately difficult to use of course.

In other output languages, there are potentially additional @ elements
that are language specific and the @ mechanism is meant to be fairly
generic. While java is the default output and the language in which it
is developed, I would bet that most serious applications would prefer
something other than the terrible overheads of calling JVMs when using a
recognizer, unless the rest of the system is already in Java.

Jim

-----Original Message-----
From: Martin Probst [mailto:mail at martin-probst.com] 
Sent: Monday, February 05, 2007 11:14 AM
To: Jim Idle
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Lexer and Parser class packaging

Hi,

> Also, now that the book is virtually out the door, such things  
> should be
> much less of an issue providing the book is read beforehand.

Come on, you don't really believe people will start reading manuals,  
do you? :-)

> One possibility though is to not have a default for the @header {}  
> which
> will then just leave @lexer::header and @parser::header, which are
> probably more obvious.

The standard language is Java, and the standard use case for the  
header in that language is setting the package. The only other thing  
you can do there is add additional imports, which are probably  
identical for Parser and Lexer, too (or you just import all in both  
and don't care...).  I think the cases where people want different  
things for lexer/parser in the header are really corner cases. Stuff  
should work by default.

So I think this is indeed not a very user friendly design as the  
default of what the user wants and the default of what ANLTR does and  
requires do not really agree.

Regards,
Martin



From hugo.a.garcia at gmail.com  Mon Feb  5 11:27:05 2007
From: hugo.a.garcia at gmail.com (Hugo Garcia)
Date: Mon, 5 Feb 2007 14:27:05 -0500
Subject: [antlr-interest] Beta of the book?
Message-ID: <f9637ada0702051127i4c9eab1ew2872906b3b33611d@mail.gmail.com>

Are we there yet?

-H

From parrt at cs.usfca.edu  Mon Feb  5 12:39:45 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 5 Feb 2007 12:39:45 -0800
Subject: [antlr-interest] Beta of the book?
In-Reply-To: <f9637ada0702051127i4c9eab1ew2872906b3b33611d@mail.gmail.com>
References: <f9637ada0702051127i4c9eab1ew2872906b3b33611d@mail.gmail.com>
Message-ID: <DD339FA8-56E4-454A-8D35-A17D7BCA82CA@cs.usfca.edu>

  I have just asked them.  I am waiting for a response.
Ter
On Feb 5, 2007, at 11:27 AM, Hugo Garcia wrote:

> Are we there yet?
>
> -H


From parrt at cs.usfca.edu  Mon Feb  5 12:42:28 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 5 Feb 2007 12:42:28 -0800
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>
References: <236822.88749.qm@web36811.mail.mud.yahoo.com>
	<20070130232613.EBC997A2@mail.intersystems.com>
	<2A6C3F1E-7242-4290-8AEE-7CC70BEBD7B4@martin-probst.com>
Message-ID: <6B38860E-FFDA-4572-BA27-5F4C1F76EFFE@cs.usfca.edu>


On Feb 5, 2007, at 8:40 AM, Martin Probst wrote:

> Hi,
>
>> You need to use @header::lexer and @header::parser. Otherwise the  
>> header element will only appear in one of them (can?t remember  
>> which it is now by default ;-).
>
> Why is that actually so? Apparently 95% of all beginners with ANTLR  
> 3 run into this problem, maybe you should simply adjust to the  
> users and make @header {} be inherited by both parser and lexer?

Well,  this has come up a number of times.  I suppose that

@header {package foo;}

Could split across both lexer and parser, but then @members {int i;}  
should parallel this and send the member declaration to both parser  
and lexer, which I can't agree with.

I don't like special cases; either we insist that the lack of a scope  
means both or it means parser.  Having one with some both and one  
assume parser is not correct.

You can see my conundrum here. clearly if we don't change this it  
will have to be the first entry in the FAQ ;)

Ter

From antlr at mirality.co.nz  Mon Feb  5 13:01:51 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 06 Feb 2007 10:01:51 +1300
Subject: [antlr-interest] Lexer and Parser class packaging
Message-ID: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>

At 08:30 6/02/2007, Jim Idle wrote:
 >One possibility though is to not have a default for the @header 
{}
 >which will then just leave @lexer::header and @parser::header,
 >which are probably more obvious.

IMO, @header should either go to both files or it should produce 
an error message telling the user to go use @lexer::header or 
@parser::header instead.  Having it just assume the parser:: 
prefix just doesn't feel right -- especially if you're using 
type-hinting file extensions such as .g3l & .g3lp.


From mdepascale at dii.unisi.it  Mon Feb  5 13:13:58 2007
From: mdepascale at dii.unisi.it (Maurizio de Pascale)
Date: Mon, 05 Feb 2007 22:13:58 +0100
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <45C60EF9.7020906@jazillian.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
	<45C60EF9.7020906@jazillian.com>
Message-ID: <45C79E16.5010703@dii.unisi.it>

performances? ;D


Andy Tripp wrote:
> Jean Marc Vanel wrote:
>>
>> Yesterday I tried Antlr. The initial motivation was to translate my 
>> Java code into C++.
>>
> Just curious...why would you want to translate Java to C++?

From mdepascale at dii.unisi.it  Mon Feb  5 13:18:16 2007
From: mdepascale at dii.unisi.it (Maurizio de Pascale)
Date: Mon, 05 Feb 2007 22:18:16 +0100
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <200702040856.23411.rschulz@sonic.net>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>	<200702040757.28829.rschulz@sonic.net>	<45C60ED2.7060506@jazillian.com>
	<200702040856.23411.rschulz@sonic.net>
Message-ID: <45C79F18.4040100@dii.unisi.it>

Hi,
maybe the libgcj from the GCJ project could also be really helpful for 
such purpose.

cheers,
Maurizio de Pascale
mdepascale at dii.unisi.it



Randall R Schulz wrote:
> On Sunday 04 February 2007 08:50, Andy Tripp wrote:
>   
>>  I only do C++ to Java, not Java to C++.
>>     
>
> Sorry. I obviously didn't pay close enough attention to what you wrote.
>
> For the OP, translating Java to C++, the availability of the Sun sources 
> may still be useful. But the terms of the open source license under 
> which Sun has released Java could still be problematic.
>
> RRS
>
>
>   

From rschulz at sonic.net  Mon Feb  5 13:20:24 2007
From: rschulz at sonic.net (Randall R Schulz)
Date: Mon, 5 Feb 2007 13:20:24 -0800
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <45C79E16.5010703@dii.unisi.it>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
	<45C60EF9.7020906@jazillian.com> <45C79E16.5010703@dii.unisi.it>
Message-ID: <200702051320.24390.rschulz@sonic.net>

On Monday 05 February 2007 13:13, Maurizio de Pascale wrote:
> Andy Tripp wrote:
> > ...
> >
> > Just curious...why would you want to translate Java to C++?
>
> performance? ;D

Yes, definitely a wink and a smile go with that one!


RRS

From parrt at cs.usfca.edu  Mon Feb  5 13:49:09 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 5 Feb 2007 13:49:09 -0800
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>
References: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>
Message-ID: <C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu>


On Feb 5, 2007, at 1:01 PM, Gavin Lambert wrote:

> At 08:30 6/02/2007, Jim Idle wrote:
> >One possibility though is to not have a default for the @header {}
> >which will then just leave @lexer::header and @parser::header,
> >which are probably more obvious.
>
> IMO, @header should either go to both files or it should produce an  
> error message telling the user to go use @lexer::header or  
> @parser::header instead.  Having it just assume the parser:: prefix  
> just doesn't feel right -- especially if you're using type-hinting  
> file extensions such as .g3l & .g3lp.


So @members {int i;} should also code to both parser and lexer. Which  
makes you feel more uncomfortable? the inconsistency or the fact that  
@header doesn't go to both? ;)

Ter

From parrt at cs.usfca.edu  Mon Feb  5 15:19:40 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 5 Feb 2007 15:19:40 -0800
Subject: [antlr-interest] ANTLR v3 book beta available!!!
Message-ID: <ACE60ECC-FCD9-4A37-B4E6-C55B9888F4CE@cs.usfca.edu>

Howdy,

Ok, it's up:

http://www.pragmaticprogrammer.com/titles/tpantlr/index.html

$22 for the PDF, but you can also preorder the print book at a  
discount if you get the PDF now.

It is missing the templates chapter, intro, preface.  I just gutted  
the templates chapter.  Should be up in another week or so.

Still getting tech reviews in too.  I'll make necessary changes.

Ter

From contingencyplan at gmail.com  Mon Feb  5 16:17:52 2007
From: contingencyplan at gmail.com (Brian DeVries)
Date: Mon, 5 Feb 2007 18:17:52 -0600
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <a3db01e90702051615l2167f9cbweb3b59b37c33a893@mail.gmail.com>
References: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>
	<C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu>
	<a3db01e90702051615l2167f9cbweb3b59b37c33a893@mail.gmail.com>
Message-ID: <a3db01e90702051617q5c8f81e4pedc35bec7548df86@mail.gmail.com>

As an ANTLR newbie ;-), I've run into this exact problem myself.

Personally, I think keystrokes are (relatively) cheap, so making the user be
explicit about where things go isn't a bad way to do it, even if it means
having @parser::members and @lexer::members too. Having the "anonymous"
@header automatically map to one or the other (parser, in the current form)
seems counter-intuitive, while only having the explicit specifications gives
the system a more "symmetric" feel. If there's an inconsistency, as
mentioned by Dr. Parr, then we should make the system consistent, all the
way, as much as possible.

As Mr. Probst put it, it's definitely a newbie trap. While it's easy (and
certainly true) to just respond with a "Read The Fine Manual," I'm in
agreement with one of my undergrad professors, Dr. Daniel Cooke: programming
languages should be adapted to people, not the other way around
(paraphrase).

Changing to use @parser::header and @parser::members doesn't require a
change in the language semantics. Both the parser and lexer have a header,
and both have members. Requiring @parser::header simply makes it explicit
which you mean, and eliminates a point of ambiguity, especially for people
who are just starting out with the system.

Thanks,
~Brian DeVries
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070205/7b001970/attachment.html 

From pwhite at peter-white.info  Mon Feb  5 16:38:31 2007
From: pwhite at peter-white.info (Peter White)
Date: Mon, 05 Feb 2007 16:38:31 -0800
Subject: [antlr-interest] TokenStreamSelector/includeFile example for 3.0?
Message-ID: <1170722311.24908.21.camel@localhost>

Hello,

I've written a simple filtering grammar to extract instances of our
custom JSP tags from our JSP pages and I've been unable to parse JSP
includes "in-line" successfully. Initially, I tried to include files by
using the following "include" method in my lexer class but that only
resulted in the exception following my code snippet.

@lexer::members {
public void include(String filename) {
		if (filename.endsWith("top.jspf\"")) return;
		indent();
		// Might need to escape filename...
		String relativePath = filename.substring(1, filename.length()-1);
		String absolutePath = BASE_DIR + "/" + relativePath;
		System.out.println("<!-- Including: " + absolutePath + " -->");
		
		
		try {
			UITagLexer lex = new UITagLexer(new ANTLRFileStream(absolutePath));
			CommonTokenStream tokens = new CommonTokenStream(lex);

			UITagParser g = new UITagParser(tokens);
			g.document();
		} catch (IOException e) {
			e.printStackTrace();
		} catch (RecognitionException e) {
			e.printStackTrace();
		}
	}
}

org.antlr.runtime.debug.DebugParser.reportError(DebugParser.java:87):
java.net.BindException: Address already in use: JVM_Bind

After searching the mail archives, I realized the above approach
wouldn't work and I came across several references to the includeFile
example so I downloaded the source to 2.7.7 to examine it. I've noticed
that TokenStreamSelector.java isn't included in the 3.0 beta source
distribution and was wondering if there's some other mechanism for
achieving the same results in 3.0. My apologies if this is currently
documented somewhere - I searched the ANTLR website and mail archives
and didn't see anything.

Any pointers in the right direction would be greatly appreciated!

Thanks,
Peter
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070205/0051f14b/attachment.html 

From jimi at intersystems.com  Mon Feb  5 17:26:33 2007
From: jimi at intersystems.com (Jim Idle)
Date: Mon, 5 Feb 2007 20:26:33 -0500
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <a3db01e90702051617q5c8f81e4pedc35bec7548df86@mail.gmail.com>
References: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz><C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu><a3db01e90702051615l2167f9cbweb3b59b37c33a893@mail.gmail.com>
	<a3db01e90702051617q5c8f81e4pedc35bec7548df86@mail.gmail.com>
Message-ID: <20070206012635.EB47B83@mail.intersystems.com>

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Brian DeVries



 

> I'm in agreement with one of my undergrad professors, Dr. Daniel
Cooke: programming languages should be adapted to people, not the other
way around (paraphrase). 

 

While recognizing that the statement is meant to be qualified and is
aimed in limited sense, nevertheless, taken to its logical conclusion,
this would mean that languages should be full of incorrect and
incomplete grammar and slang, be oblivious to spelling mistakes and just
guess, and automatically email error messages to the next person up some
arbitrary line of seniority with a subject of "Can you tell me how to
fix this because I can't be bothered to look it up myself", while
cross-posting to comp.* along similar lines and reporting "Don't do
anything for the next 4 days while someone else sorts it out for you" to
the programmer. The compiler should also "know what you meant" and
optimize the code like that. While we are at it, best we have "loop
until done/while not finished" and all the classic rest ;-)

 

Just kidding of course*

 

Jim

 

 

 

 

*Mostly.

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070205/218f1940/attachment-0001.html 

From antlr at mirality.co.nz  Mon Feb  5 18:25:35 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 06 Feb 2007 15:25:35 +1300
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu>
References: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>
	<C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu>
Message-ID: <7.0.1.0.0.20070206150542.033be5b0@mirality.co.nz>

At 10:49 6/02/2007, Terence Parr wrote:
 >
 >So @members {int i;} should also code to both parser and lexer.
 >Which makes you feel more uncomfortable? the inconsistency or 
the
 >fact that @header doesn't go to both? ;)

Inconsistency is simply inexcusable, so I guess that makes me the 
most uncomfortable :)

But I was also proposing a third option: making unqualified 
@header sections illegal.  That's what I actually prefer over 
sending it to both, if I had to choose one.

In my ideal world, you'd have the following constructs:

@lexer::header {}         => written to lexer only
@parser::header {}        => written to parser only
@lexer,parser::header {}  => written to both
@header {}                => special case

... where the unqualified version is accepted if only one of the 
two are being generated (eg. only parser rules are supplied, or 
it's specified as a 'lexer graamar' or 'parser grammar'), and 
generates an error otherwise.  Or maybe just generates a warning 
and then writes it to both.  I don't think it should quietly write 
it to both and I definitely don't think it should write it to only 
one if multiple files are being generated.

The same holds true for @members, and @footer (if such a thing 
exists, and if not, it should, so that you can do namespaces in 
C++, among other things).  They all need to be consistent.


From contingencyplan at gmail.com  Mon Feb  5 18:56:18 2007
From: contingencyplan at gmail.com (Brian DeVries)
Date: Mon, 5 Feb 2007 20:56:18 -0600
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <7.0.1.0.0.20070206150542.033be5b0@mirality.co.nz>
References: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>
	<C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu>
	<7.0.1.0.0.20070206150542.033be5b0@mirality.co.nz>
Message-ID: <a3db01e90702051856i2432d2edifee855cce09e2f2f@mail.gmail.com>

On 2/5/07, Gavin Lambert <antlr at mirality.co.nz> wrote:
>
> At 10:49 6/02/2007, Terence Parr wrote:
> >
> >So @members {int i;} should also code to both parser and lexer.
> >Which makes you feel more uncomfortable? the inconsistency or
> the
> >fact that @header doesn't go to both? ;)
>
> Inconsistency is simply inexcusable, so I guess that makes me the
> most uncomfortable :)


Ditto. :-)

But I was also proposing a third option: making unqualified
> @header sections illegal.  That's what I actually prefer over
> sending it to both, if I had to choose one.


This is what I'm arguing for.

In my ideal world, you'd have the following constructs:
>
> @lexer::header {}         => written to lexer only
> @parser::header {}        => written to parser only
> @lexer,parser::header {}  => written to both
> @header {}                => special case
>
> ... where the unqualified version is accepted if only one of the
> two are being generated (eg. only parser rules are supplied, or
> it's specified as a 'lexer graamar' or 'parser grammar'), and
> generates an error otherwise.  Or maybe just generates a warning
> and then writes it to both.  I don't think it should quietly write
> it to both and I definitely don't think it should write it to only
> one if multiple files are being generated.


For what it's worth, I'd advocate getting rid of @header entirely. If we
have the individual versions and the combined syntax (which exists as a
convenience), then we have no need for the unqualified @header anymore. It
only serves as a point of ambiguity, and necessitates a "special case".

Furthermore, if this change were implemented, we have a lot of ANTLR v3
grammars (mine included) that expect @header to send its contents to the
parser only. If we change the semantics of the @header section to have it
send its contents to both the parser and lexer, then grammar writers may
encounter unexpected behavior when they upgrade. Removing @header entirely
will cause the ANTLR system to emit a syntax error (hopefully with some
helpful output), and the grammar writers can update their grammar easily.
The change from @header to @parser::header is minimal (9 characters),
requires no changes to the contents of the header, and has no additional
side effects.

The same holds true for @members, and @footer (if such a thing
> exists, and if not, it should, so that you can do namespaces in
> C++, among other things).  They all need to be consistent.
>

Similarly for these - if we change their semantics, but leave them intact
syntactically, then we'll get a lot of upset ANTLR users posting in here
about the change. If we change the syntax, and point them in the right
direction when they run it through, then they'll grumble about it, but
probably just to themselves instead of the mailing list. ;-)

@ Mr. Idle: I'm coming up with a retort, though I'll email you individually
so as not to derail the discussion (moreso than I have). :-)

Thanks,
~Brian DeVries
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070205/73b6732d/attachment.html 

From omry at yadan.net  Tue Feb  6 00:28:44 2007
From: omry at yadan.net (Omry Yadan)
Date: Tue, 06 Feb 2007 10:28:44 +0200
Subject: [antlr-interest] nondeterminism help
In-Reply-To: <a3db01e90702051856i2432d2edifee855cce09e2f2f@mail.gmail.com>
References: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>	<C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu>	<7.0.1.0.0.20070206150542.033be5b0@mirality.co.nz>
	<a3db01e90702051856i2432d2edifee855cce09e2f2f@mail.gmail.com>
Message-ID: <45C83C3C.2020304@yadan.net>

Hi all,
my grammar need to tell the difference between a line of code, that can 
be anything, and a directive - that starts with //#
example for a line:
public class foo extends bar{

example for a directive:
//# if blah=8

each line can end with a EOL or EOF.

I want to first line to match the rule code and the second to match the 
rule directive
I tried to do something like:

code : (.)*;

line :
(
   (
       (PREFIX) => PREFIX ((conditaional expression) | nonconditional)
       |
       code
   )
   (EOL)?
);

I have two problems:
1. my code rule gives an error when it encounter "{" : line 1:17: 
unexpected char: '{'
2. I get the following warning: nondeterminism upon k==1:EOL between alt 
1 and exit branch of block

any ideas?

From renyedi at gmail.com  Tue Feb  6 01:29:57 2007
From: renyedi at gmail.com (Robert Enyedi)
Date: Tue, 6 Feb 2007 11:29:57 +0200
Subject: [antlr-interest] JavaCC to Antlr grammar converter
Message-ID: <2e67829d0702060129p6838eb32j4471f1f7d3546741@mail.gmail.com>

Does anyone know about a tool that converts JavaCC grammars to Antlr ones?

The concepts and syntax of both JavaCC and Antlr look quite similar to me,
so I suppose this shouldn't be that difficult. But I might be wrong here...

Regards,
Robert
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070206/2788d319/attachment.html 

From JeanMarc.Vanel at mathworks.fr  Tue Feb  6 01:40:57 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Tue, 6 Feb 2007 10:40:57 +0100
Subject: [antlr-interest] Translating from Java to C++
Message-ID: <632C3E36DCF16649AD770FE2646E9A1801481B12@message-fr.ad.mathworks.com>

> maybe the libgcj from the GCJ project could also be really helpful for
> such purpose.

[Jean-Marc Vanel] Sure.
And now that the JDK libraries are open source, it will soon be complete
in that respect.
And also they are switching to the eclipse compiler, which will allow to
use the latest Java 5 syntax.
And you can debug with gdb a mixed language application.
On the darker side, I heard that on Windows the Cygwin distribution has
an inconvenient license, while the MinGW distribution is not up-to-date
with the latest compiler version.

BTW, what do you think prevents eclipse or gcc to use Antlr ?

From jeremy.rayner at gmail.com  Tue Feb  6 01:47:10 2007
From: jeremy.rayner at gmail.com (Jeremy Rayner)
Date: Tue, 6 Feb 2007 09:47:10 +0000
Subject: [antlr-interest] alternative treewalker
Message-ID: <90a60e760702060147n25c33918ua02829c3ad4b50f3@mail.gmail.com>

Hiya,
  A video and slides by myself have just been made available explaining the
alternative treewalker I use for navigating the Antlr AST.

This covers a technique for implementing the visitor pattern and ideas for
future use...

video -> http://video.google.co.uk/videoplay?docid=-7209282334029676664
slides -> http://groovy.javanicus.com/ggug2/

Enjoy

Jez

P.S. Thanks to http://skillsmatter.com/ for uploading the video.
-- 
Groovy Engineer
http://javanicus.com/blog2
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070206/823eccc9/attachment.html 

From mail at martin-probst.com  Tue Feb  6 03:15:06 2007
From: mail at martin-probst.com (Martin Probst)
Date: Tue, 6 Feb 2007 12:15:06 +0100
Subject: [antlr-interest] Lexer and Parser class packaging
In-Reply-To: <a3db01e90702051617q5c8f81e4pedc35bec7548df86@mail.gmail.com>
References: <7.0.1.0.0.20070206095806.034d8ec0@mirality.co.nz>
	<C5E3EE3B-FA23-42E8-898F-A678589D2377@cs.usfca.edu>
	<a3db01e90702051615l2167f9cbweb3b59b37c33a893@mail.gmail.com>
	<a3db01e90702051617q5c8f81e4pedc35bec7548df86@mail.gmail.com>
Message-ID: <48D39CE9-5148-497F-A2F0-466310D60B3E@martin-probst.com>

> Having the "anonymous" @header automatically map to one or the  
> other (parser, in the current form) seems counter-intuitive, while  
> only having the explicit specifications gives the system a more  
> "symmetric" feel.

It's indeed counter intuitive.

If I say "At a station, you'll usually find a bus stop", it's usually  
taken that I imply all sorts of stations that make sense in the  
context, i.e. train stations, tramway stations, subway stations, etc.  
If I want to limit the statement to "subway stations", then I'll  
specify that by being explicit. This is simply a convention in human  
language, and it's also logical.

I think ANTLR should follow that and put stuff that shows up in  
"@header {}" in both the lexer and parser, and it should do the same  
for "@member {}". While of course putting something in "@member {}"  
without a qualifier is nearly always an error, it seems a lot more  
sensible to me to require explicit specification if you want uh,  
explicit specification ;-)

@parser::header ==> to parser
@lexer::header ==> to lexer
@header ==> to both

All @ statements without a qualification should go into all generated  
products. It's also not obvious why the Parser should take such  
precedence over a lexer or over any tree parser.

Regards,
Martin

From gilbert.williams at prosync.com  Tue Feb  6 06:57:13 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Tue, 6 Feb 2007 09:57:13 -0500
Subject: [antlr-interest] Disambiguating Lexemes Question
Message-ID: <001301c749ff$163aaa20$b982e6cd@tsitelsys.com>

Greetings:

 

I looked for an example of this for ? a day, but still cannot get my
?expected? results.

 

I have a grammar with lexer components (not all are shown):

 

DIGIT : '0'..'9' ;

 

protected

ALPHA :     ('a'..'z'|'A'..'Z' ) ;

 

protected

COLL_ELEM

      :     ALPHA

      |     DIGIT

      ;

 

I used the ?protected? keyword to eliminate ambiguity warnings during the
Antlr build process.  My test case is based on the ?Calc? Java example.

 

When I run the lexer and print tokens, I get ?ALPHA? as the token type for
input ?a? rather than the expected ?COLL_ELEM?. (There are other terminals
in the grammar composed of DIGIT | ALPHA as well).

 

Could someone provide a quick guide or point me to additional documentation?

 

I need to be able to identify the ?highest order? lexeme if ANTLR supports
this capability.

 

Thanks and have a great day!

 

Bert Williams.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070206/23436a8a/attachment-0001.html 

From antlr at jazillian.com  Tue Feb  6 06:59:48 2007
From: antlr at jazillian.com (Andy Tripp)
Date: Tue, 06 Feb 2007 09:59:48 -0500
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <200702051320.24390.rschulz@sonic.net>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>	<45C60EF9.7020906@jazillian.com>
	<45C79E16.5010703@dii.unisi.it>
	<200702051320.24390.rschulz@sonic.net>
Message-ID: <45C897E4.9030405@jazillian.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070206/b5757e07/attachment.html 

From wiggjd at lsbu.ac.uk  Tue Feb  6 07:53:22 2007
From: wiggjd at lsbu.ac.uk (Wigg, J D)
Date: Tue, 6 Feb 2007 15:53:22 -0000
Subject: [antlr-interest] Antlr 2.7 Header Sections
Message-ID: <10A786EB5741DE4DB252F7B9B9423D3A022C53C1@CSD-EXBE-VS2.lsbu.ac.uk>

Please could someone confirm that it is not possible to set separate
header sections in CPPParser and CPPLexer in Antlr 2.7 (or, if it is
possible, please let me know how, or where I can find out)?
 
The Antlr documentation doesn't say much about headers. It refers to
"respective addendums". Please could someone let me know where they
are?
 
Basically what I want to do is to make information obtained by the
lexer from Line Directives in the preprocessed *.i file available to
the parser without involving an external file (thanks for your
suggestion Xue Yong Zhi (Digest vol 27 no 2, 2 Feb) but I was already
declaring them in another file (main.cpp)).
 
Thanks,
 
David Wigg
CPP_parser.g



This e-mail message may be confidential and is intended only for the use of the individual(s) to whom it is addressed.  It may contain information which is or may be confidential, non-public or legally privileged. Please do not disseminate or distribute this message other than to its intended recipient without permission of the author. You should not copy it or use it for any purpose nor disclose its contents to any other person. If you have received this message in error, please notify me by email immediately and delete the original message and all copies in your computer systems.

London South Bank University is a company limited by guarantee registered in England and Wales. The following details apply to London South Bank University: Company number 00986761; Registered office and trading address - 103 Borough Road London SE1 0AA; VAT number - 778 1116 17
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070206/52f45d52/attachment.html 

From mail at martin-probst.com  Tue Feb  6 08:31:00 2007
From: mail at martin-probst.com (Martin Probst)
Date: Tue, 6 Feb 2007 17:31:00 +0100
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <45C897E4.9030405@jazillian.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>	<45C60EF9.7020906@jazillian.com>
	<45C79E16.5010703@dii.unisi.it>
	<200702051320.24390.rschulz@sonic.net>
	<45C897E4.9030405@jazillian.com>
Message-ID: <63217FE9-44D0-46BC-8453-0433F6BAF0B1@martin-probst.com>

My language is bigger than yours.

From ric.klaren at gmail.com  Tue Feb  6 10:28:26 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Tue, 6 Feb 2007 19:28:26 +0100
Subject: [antlr-interest] Antlr 2.7 Header Sections
In-Reply-To: <10A786EB5741DE4DB252F7B9B9423D3A022C53C1@CSD-EXBE-VS2.lsbu.ac.uk>
References: <10A786EB5741DE4DB252F7B9B9423D3A022C53C1@CSD-EXBE-VS2.lsbu.ac.uk>
Message-ID: <bc607a4e0702061028k90923eg1b3643e49d6ee29e@mail.gmail.com>

Hi David,

On 2/6/07, Wigg, J D <wiggjd at lsbu.ac.uk> wrote:
> Please could someone confirm that it is not possible to set separate header
> sections in CPPParser and CPPLexer in Antlr 2.7 (or, if it is possible,
> please let me know how, or where I can find out)?
>
> The Antlr documentation doesn't say much about headers. It refers to
> "respective addendums". Please could someone let me know where they are?

For C++ it would be this one:

http://www.antlr.org/doc/cpp-runtime.html

If you got lexer and parser in the same file then they'll share the
same header sections. But attributes/methods added to the generated
classes are of course in the respective lexer/parser header files
(maybe a static attribute is an option, depends on what you want to
achieve)

> Basically what I want to do is to make information obtained by the lexer
> from Line Directives in the preprocessed *.i file available to the parser
> without involving an external file (thanks for your suggestion Xue Yong Zhi
> (Digest vol 27 no 2, 2 Feb) but I was already declaring them in another file
> (main.cpp)).

You might be able to pilfer the Token class implementation from this
version of your grammar:

http://pts14043.pts.nl/antlr/cppparser.tar.bz2

That way the real line/file information would be present on the token.

Cheers,

Ric

From mdepascale at dii.unisi.it  Tue Feb  6 10:27:19 2007
From: mdepascale at dii.unisi.it (Maurizio de Pascale)
Date: Tue, 06 Feb 2007 19:27:19 +0100
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <63217FE9-44D0-46BC-8453-0433F6BAF0B1@martin-probst.com>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>	<45C60EF9.7020906@jazillian.com>	<45C79E16.5010703@dii.unisi.it>	<200702051320.24390.rschulz@sonic.net>	<45C897E4.9030405@jazillian.com>
	<63217FE9-44D0-46BC-8453-0433F6BAF0B1@martin-probst.com>
Message-ID: <45C8C887.5080009@dii.unisi.it>

hey dudes, take it easy...

it looks like we are still in a free world, so hopefully everyone is 
free to believe everything he wants, and the fact that java pays your 
meals doesn't seem a good reason to take that up so seriously.
Randall already saved the java-pride without making it a national 
security issue, we were all friends as before and for me there was 
certainly no need to give it a follow up.
it was not my intention to offend anyone, and if my unhappy answer with 
its unrespectful question mark and smiles has hurt any of you, I beg you 
my excuses, really.

Anyway, since I'm the thirteen here, please be more mature than me and 
don't reply, neither I'll answer, and hopefully this accident ends here.


happy parsing,
Maurizio
mdepascale at dii.unisi.it

Martin Probst wrote:
> My language is bigger than yours.
>
>

From crickett at lanl.gov  Tue Feb  6 11:16:44 2007
From: crickett at lanl.gov (Christopher D. Rickett)
Date: Tue, 6 Feb 2007 12:16:44 -0700 (MST)
Subject: [antlr-interest] generated file names
Message-ID: <Pine.LNX.4.64.0702061212240.6454@lennox.lanl.gov>

hello all,

how do you prevent antlr-3.0b6 from appending 'Lexer' or 'Parser' to the 
end of the generated java file names?  i have two grammars in separate 
files, and with antlr-3.0b4 the 'Lexer'/'Parser' are not appended to the 
generated file names, but they are with 3.0b6.  i'd prefer that they not 
be appended and the generated file names simply be the name of the 
grammar, as specified by 'lexer grammar <name>', etc.

thanks for the help.
Chris


From sohail at taggedtype.net  Tue Feb  6 18:44:53 2007
From: sohail at taggedtype.net (Sohail Somani)
Date: Tue, 06 Feb 2007 18:44:53 -0800
Subject: [antlr-interest] Translating from Java to C++
In-Reply-To: <45C8C887.5080009@dii.unisi.it>
References: <632C3E36DCF16649AD770FE2646E9A1801481827@message-fr.ad.mathworks.com>
	<45C60EF9.7020906@jazillian.com>	<45C79E16.5010703@dii.unisi.it>
	<200702051320.24390.rschulz@sonic.net>	<45C897E4.9030405@jazillian.com>
	<63217FE9-44D0-46BC-8453-0433F6BAF0B1@martin-probst.com>
	<45C8C887.5080009@dii.unisi.it>
Message-ID: <1170816293.5137.7.camel@localhost.localdomain>

On Tue, 2007-02-06 at 19:27 +0100, Maurizio de Pascale wrote:
> hey dudes, take it easy...
> 
> it looks like we are still in a free world, so hopefully everyone is 
> free to believe everything he wants, and the fact that java pays your 
> meals doesn't seem a good reason to take that up so seriously.
> Randall already saved the java-pride without making it a national 
> security issue, 

Mentioning national security in any context puts this list on a list.


From cameron.taggart at gmail.com  Tue Feb  6 19:43:53 2007
From: cameron.taggart at gmail.com (Cameron Taggart)
Date: Tue, 6 Feb 2007 19:43:53 -0800
Subject: [antlr-interest] ANTLR 3.0b6 released!
In-Reply-To: <A1B65B68-F2B1-4E70-B10E-6AD78313BA2E@cs.usfca.edu>
References: <A1B65B68-F2B1-4E70-B10E-6AD78313BA2E@cs.usfca.edu>
Message-ID: <c3606140702061943t7be4bb82tb90dfd94a45945e0@mail.gmail.com>

Looks like you don't own mantra.org, but instead use this one:

http://www.linguamantra.org/

off to buy the book,
Cameron

On 1/31/07, Terence Parr <parrt at cs.usfca.edu> wrote:
> Lots of bug fixes etc... Has some backward incompatibilities. This
> version corresponds to the beta PDF ANTLR v3 book.
>
> Updated the 3.0 examples to ensure they work.  Working on updating
> mantra.org example.
>
> Ter
>

From jono at mail2Juggler.com  Tue Feb  6 23:07:56 2007
From: jono at mail2Juggler.com (Jono Juggler)
Date: Tue, 6 Feb 2007 23:07:56 -0800
Subject: [antlr-interest] Declaring globals
Message-ID: <395801c74a86$b1914830$8dca010a@mail2world.com>

Hey all,

I am a Antlr gnub with a quick question. Is there a way to declare
globals or something within the scope of the main class that can be
accessed by the parser? I want a way to count language features (ie - if
statements, for loops, method calls) in Java source.

Thanks.



Rock bottom prices! Click to save on brand name copiers today
<http://tagline.bidsystem.com/fc/CAaCDCaBAAdfKLM6lRsIfSZraM91wp8p/> 



<span id=m2wTl><p><font face="Arial, Helvetica, sans-serif" size="2" style="font-size:13.5px">_______________________________________________________________<BR>Get the Free email that has everyone talking at <a href=http://www.mail2world.com target=new>http://www.mail2world.com</a><br>  <font color=#999999>Unlimited Email Storage &#150; POP3 &#150; Calendar &#150; SMS &#150; Translator &#150; Much More!</font></font></span>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070206/3456a853/attachment.html 

From gilbert.williams at prosync.com  Wed Feb  7 10:01:05 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Wed, 7 Feb 2007 13:01:05 -0500
Subject: [antlr-interest] Antlr 3.0b6 Error Issue (ANTLRWorks 1.0b8)
Message-ID: <002101c74ae1$f0217510$b982e6cd@tsitelsys.com>

Greetings:

 

After a few download issues, I have successfully installed and run the Antlr
3.0 beta software.

 

This is a great improvement over the 2.7.7 I was previously trying.  At
least I appear to be getting further along.  The automatic left recursion
removal is a very nice feature, especially for someone who doesn't write
grammars every day.

 

 

When I try to run the grammar below (Posix Extended Regular Expressions, a
subset), using the ANTLRWorks 1.0b8 GUI,

I get the following warnings/errors.  I also get occasional internal errors
as shown below.  Whenever I make a change that fails the "Check Grammar"
operation, I seem to get this and other internal errors.

 

My question is:

 

With respect to the warning (200), how does one specify that the parser be
generated?  I really have just one alternative (and I did try e (e)* instead
of (e)+)

Is there a "greedy=false" option?  I don't see anything wrong with the
grammar, but perhaps there is something subtle I am missing.

 

Thanks for your helpful reply.

 

Bert Williams.

 

 

 

------------------------------Warnings/Errors-------------------------------
------------------------------------------------------

 

[12:36:11] error(106): regexshort.g:9:23: reference to undefined rule:
one_character_ERE

[12:36:11] error(106): regexshort.g:9:59: reference to undefined rule:
extended_reg_exp

[12:36:16] Checking Grammar...

[12:36:17] warning(200): regexshort.g:7:37: Decision can match input such as
"<EOT>" using multiple alternatives: 1, 2

As a result, alternative(s) 2 were disabled for that input

[12:36:17] warning(201): regexshort.g:7:37: The following alternatives are
unreachable: 2

 

[12:36:17] warning(208): regexshort.g:136:1: The following token definitions
are unreachable:
ERE_expression,ERE_dupl_symbol,DIGITSET,ALPHASET,ALPHA,DIGIT,COLL_ELEM,PLUS,
DOLLAR,STAR,QUESTION,CARET  

 

 

 

-----------------Antlr Internal
Error-----------------------------------------------------------------------
-------------

 

[12:46:58] error(10):  internal error:
org.antlr.tool.Message.toString(Message.java:124): Assertion failed! Message
ID 106 created but is not present in errorMsgIDs or warningMsgIDs.

 

 

 

--------------------------------------------------------ANTLR 3.0 Grammar
(regexshort.g)----------------------------------------------------

 

grammar regexshort;

 

 

 

extended_reg_exp   : (ERE_branch) ('|' ERE_branch)* (EOF)

                   ;

ERE_branch         : (ERE_expression)+

                   ;

ERE_expression     : (one_character_ERE | '^' | '$' | '(' extended_reg_exp
')') (ERE_dupl_symbol)?

                   ;

one_character_ERE  : ORD_CHAR

                   | QUOTED_CHAR

                   | '.'

                   | bracket_expression

                   ;

ERE_dupl_symbol    : '*'

                   | '+'

                   | '?'

                   | '{' DUP_COUNT               '}'

                   | '{' DUP_COUNT ','           '}'

                   | '{' DUP_COUNT ',' DUP_COUNT '}'

                   ;

DUP_COUNT 

            :           DIGIT ;                   

QUOTED_CHAR

            :           '\\' ORD_CHAR;

 

ORD_CHAR 

            :           COLL_ELEM

            |           DOLLAR

            ;

 

 

bracket_expression : '[' matching_list    ']'

               | '[' nonmatching_list ']'

               ;

matching_list  : bracket_list

               ;

nonmatching_list : '^' bracket_list

               ;

bracket_list   : follow_list

               | follow_list '-'

               ;

follow_list    :  (expression_term) (expression_term)*

               ;

expression_term : single_expression

               | range_expression

               ;

single_expression : end_range

               ;

range_expression : start_range end_range

               | start_range '-'

               ;

start_range    : end_range '-'

               ;

end_range      : COLL_ELEM

//               | collating_symbol

               ;

 

 

 

protected

DIGITSET : '0'..'9' ;

 

protected

ALPHASET :     ('a'..'z'|'A'..'Z' ) ;

 

ALPHA : ALPHASET;

 

DIGIT    : DIGITSET ;

 

COLL_ELEM

      :     ALPHASET

      |     DIGITSET

 

      ;

 

            

 

PLUS

            :           '+'

            ;

            

COMMA

            :           ','

            ;           

 

DOLLAR

            :           '$'

            ;

 

STAR

            :           '*'

            ;

QUESTION

            :           '?'

            ;

LPAREN

            :           '('

            ;           

 

RPAREN

            :           ')'

            ;           

 

ALTERNATION

            :           '|'

            ;

 

LBRACE

            :           '{'

            ;

RBRACE

            :           '}'

            ;           

 

LBRACKET

            :           '['

            ;

            

RBRACKET

            :           ']'

            ;           

 

PERIOD

            :           '.'

            ;

 

DASH

            :           '-'

            ;

BACKSLASH 

            :           '\\'

            ;

 

CARET

            :           '^'

            ;

 

WS       :           ' '

            |           '\t'

            |           '\n'

            |           '\r'

            ;

 

SEMI:   ';'

            ;

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070207/86fde051/attachment-0001.html 

From vincent.isambart at gmail.com  Thu Feb  8 02:42:34 2007
From: vincent.isambart at gmail.com (Vincent Isambart)
Date: Thu, 8 Feb 2007 19:42:34 +0900
Subject: [antlr-interest] Bug in ANTLR 3.0b6
Message-ID: <7d9a1f530702080242u24ef12dfk1af3e77de761bc9d@mail.gmail.com>

Hi,

I'm a new user of ANTLR, and after reading some of the book, I've been
playing a little with ANTLR 3.0b6 and I ran into a little problem:
ANTLR Parser Generator  Version 3.0b6 (Jan 31, 2007)  1989-2007
error(10):  internal error: Test.g :
java.lang.IllegalArgumentException: Can't find template
matchSetTrack.st
org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:485)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:372)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:384)
org.antlr.stringtemplate.StringTemplateGroup.lookupTemplate(StringTemplateGroup.java:464)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:372)
org.antlr.stringtemplate.StringTemplateGroup.getInstanceOf(StringTemplateGroup.java:384)
org.antlr.codegen.CodeGenTreeWalker.getTokenElementST(CodeGenTreeWalker.java:160)
org.antlr.codegen.CodeGenTreeWalker.set(CodeGenTreeWalker.java:2557)
org.antlr.codegen.CodeGenTreeWalker.atom(CodeGenTreeWalker.java:2243)
org.antlr.codegen.CodeGenTreeWalker.element(CodeGenTreeWalker.java:1370)
org.antlr.codegen.CodeGenTreeWalker.alternative(CodeGenTreeWalker.java:1115)
org.antlr.codegen.CodeGenTreeWalker.block(CodeGenTreeWalker.java:999)
org.antlr.codegen.CodeGenTreeWalker.rule(CodeGenTreeWalker.java:725)
org.antlr.codegen.CodeGenTreeWalker.rules(CodeGenTreeWalker.java:516)
org.antlr.codegen.CodeGenTreeWalker.grammarSpec(CodeGenTreeWalker.java:458)
org.antlr.codegen.CodeGenTreeWalker.grammar(CodeGenTreeWalker.java:305)
org.antlr.codegen.CodeGenerator.genRecognizer(CodeGenerator.java:415)
org.antlr.Tool.processGrammar(Tool.java:329)
org.antlr.Tool.process(Tool.java:266)
org.antlr.Tool.main(Tool.java:69)

I reduced my grammar to this simple 3 lines code:
grammar Test;
options { output = AST; }
a: ('1'|'2') -> ;

The internal error disapears if I change the ouput type or remove
either the | or the ->.

And by the way is there a way to have org.antlr.Tool exit in error
(shell return code != 0) when there is an error in the grammar?

Cheers,
Vincent Isambart

From omry at yadan.net  Thu Feb  8 06:29:25 2007
From: omry at yadan.net (Omry Yadan)
Date: Thu, 08 Feb 2007 16:29:25 +0200
Subject: [antlr-interest] literals in 2.7.6
Message-ID: <45CB33C5.5010003@yadan.net>

the docs at http://www.antlr.org/doc/lexer.html#Keywords and literals 
mentions something about a literal option that can be used to solve 
ambiguity between reserved keywords and literals, but when  I follow the 
link (http://www.antlr.org/doc/options.html#literal) there doesn't seem 
to be such an option.

where can I find more information about the literal option and of how to 
use it?


    thanks.


From omry at yadan.net  Thu Feb  8 06:57:17 2007
From: omry at yadan.net (Omry Yadan)
Date: Thu, 08 Feb 2007 16:57:17 +0200
Subject: [antlr-interest] literals in 2.7.6
In-Reply-To: <45CB33C5.5010003@yadan.net>
References: <45CB33C5.5010003@yadan.net>
Message-ID: <45CB3A4D.7010402@yadan.net>

Here is a simple example that demonstrate my problem:

class TestLexter extends Lexer;
protected CHAR : ('a'..'z' | 'A'..'Z');
RESERVED     : "foo";
SYMBOL  : CHAR (CHAR)* ;



Lets say foo is a reserved keywork and that SYMBOL can be any sequence 
of chars.
obviously SYMBOL also matches "foo", so I get the following warning:

lexical nondeterminism between rules RESERVED and SYMBOL upon k==1:'f'

Increasing the k value (even to 4) does not help here.

any suggestion how to work around this warning?
I believe it has something to do with the 
http://www.antlr.org/doc/lexer.html#Keywords_and_literals section in the 
doc, but I didn't understand how to solve it from what's written there.

From david.crosson at wanadoo.fr  Thu Feb  8 07:10:22 2007
From: david.crosson at wanadoo.fr (David CROSSON)
Date: Thu,  8 Feb 2007 16:10:22 +0100 (CET)
Subject: [antlr-interest] Antlr 3.0b6 - problem with '!' operator ? Or did I
 miss something...
Message-ID: <15577678.314601170947422648.JavaMail.www@wwinf2202>

Hi,

I can't achieve to make the operator '!' working in order to change text returned by a rule.
In the following test grammar and test unit, I'm using the string "32 secs" as input and I expect
to get the string "32" but this not the case I got "32 secs".

-----------------------------------
grammar Debug;
options {
    filter=false;
    output=AST;
}
@header {
  package logparser.parsers;
}
@lexer::header {
  package logparser.parsers;
}
duration returns [String value] :
    ts=timestamp
    {$duration.value = $ts.text;}
    ;
timestamp :
    INT 'secs'!
    ;
INT :
    ('0'..'9')+
    ;
WS :
    ' '+ {$channel=HIDDEN;}
    ;

-----------------------------------
And the test unit :

package logparser.test;

import junit.framework.*;
import logparser.parsers.DebugLexer;
import org.antlr.runtime.ANTLRStringStream;
import org.antlr.runtime.CharStream;
import org.antlr.runtime.CommonTokenStream;
import logparser.parsers.DebugParser;

public class DebugTest extends TestCase {
    public DebugTest(String testName) {super(testName);}
    protected void setUp() throws Exception {}
    protected void tearDown() throws Exception {}
    
    public void testDebug() throws Exception {
        CharStream in = new ANTLRStringStream("32 secs");
        DebugLexer lexer = new DebugLexer(in);
        CommonTokenStream tokens = new CommonTokenStream(lexer);
        DebugParser parser = new DebugParser(tokens);
        String value = parser.duration().value;
        assertTrue("ERR returned value : '" + value+"'","32".equals(value));
    }
}
-----------------------------------
Thanks for all,
David Crosson.




From parrt at cs.usfca.edu  Thu Feb  8 09:28:24 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 8 Feb 2007 09:28:24 -0800
Subject: [antlr-interest] moving antlr.org/st.org server
Message-ID: <77AA6CC7-7E17-431F-9DC3-A4FBC4F65E10@cs.usfca.edu>

hi DNS change today around noon CA time.  Moving server to a subnet  
that should be faster.

Ter

From zhixueyong at hotmail.com  Thu Feb  8 12:10:57 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Thu, 08 Feb 2007 15:10:57 -0500
Subject: [antlr-interest] literals in 2.7.6
In-Reply-To: <45CB3A4D.7010402@yadan.net>
References: <45CB33C5.5010003@yadan.net> <45CB3A4D.7010402@yadan.net>
Message-ID: <eqg04g$u29$1@sea.gmane.org>

You do not have to list RESERVED as a rule, just use it as a string in 
the parser.

For example:

...
parser_rule_1
   : "keyword"  IDENTIFIER
   ;
...
class FooLexer extends Lexer;
options {
	testLiterals=false;	
}
...
IDENTIFIER
options{testLiterals=true;}:
...

You can use java.g as a reference.

Omry Yadan wrote:
> Here is a simple example that demonstrate my problem:
> 
> class TestLexter extends Lexer;
> protected CHAR : ('a'..'z' | 'A'..'Z');
> RESERVED     : "foo";
> SYMBOL  : CHAR (CHAR)* ;
> 


-- 
Xue Yong Zhi
http://xruby.blogspot.com


From zhixueyong at hotmail.com  Thu Feb  8 12:15:26 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Thu, 08 Feb 2007 15:15:26 -0500
Subject: [antlr-interest] Declaring globals
In-Reply-To: <395801c74a86$b1914830$8dca010a@mail2world.com>
References: <395801c74a86$b1914830$8dca010a@mail2world.com>
Message-ID: <eqg0ct$v2b$1@sea.gmane.org>

Definately you can. If you want to add fields to the parser, just insert 
code block after options and before parser rules:

...
class FooParser extends Parser;
options {
}

{
   //you code here: fields, methods
}

first_rule:
...

Jono Juggler wrote:
> Hey all,
> 
> I am a Antlr gnub with a quick question. Is there a way to declare 
> globals or something within the scope of the main class that can be 
> accessed by the parser? I want a way to count language features (ie - if 
> statements, for loops, method calls) in Java source.
> 


-- 
Xue Yong Zhi
http://xruby.blogspot.com


From eitan.suez at gmail.com  Thu Feb  8 14:14:53 2007
From: eitan.suez at gmail.com (Eitan Suez)
Date: Thu, 8 Feb 2007 16:14:53 -0600
Subject: [antlr-interest] comments on ant task for v3..
Message-ID: <a21b55590702081414l41e0e34ep6fadc6b0340857ee@mail.gmail.com>

hi all,

  i'm an antlr newbie.  just got a copy of the betabook
  from pragprog and got a copy of antlrv3.

i have some feedback on antlr3 ant task..
or rather a laundry list of questions and
changes i'd like to see..

1. if specified outputdirectory is "gen"
  and specified package name (in .g files) is "com.xyz.foo"
  then files should auto-output to gen/com/xyz/foo

  analog:  when i invoke javac and specify target directory
  to "classes" the package directories are auto-created

2. i'd like to be able to specify "classpathref" as an xml attribute
  to antlr task, like one can do with the javac task;  e.g.:

  <antlr:antlr3 xmlns:antlr="..."
     target="Expr.g" classpathref="antlr.path" ... />

  (i.e. i prefer the above to having to define a nested
    element to specify the classpath)

3. i'd like to see support for nested fileset element for
  specifying more than one .g file.  for example if want
  to process both a parser and a tree grammar in one
  step.  e.g.:

    <antlr:antlr3 ...>
      <fileset dir="grammars" includes="*.g" />
    </antlr:antlr3>

  i believe from the command line i can specify more than
  one grammar file.

4. this is not really an issue with the ant task, more
  with the default behaviour of the tool..
   why doesn't the token libdir value default to same
   dir the .java files are written?

5. the ant task appears to be built with java 6.
  i tried to run a test target and am getting this:
BUILD FAILED
java.lang.UnsupportedClassVersionError: Bad version number in .class file

i suppose i can unbundle the source copy and manually
copy the necessary dependent libs and compile and jar
the source.  it'd be nice if the whole project were available
for download with its build file.  it would save others a little
time.

thanks!
/ eitan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070208/85ec37a4/attachment.html 

From parrt at cs.usfca.edu  Thu Feb  8 15:43:50 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 8 Feb 2007 15:43:50 -0800
Subject: [antlr-interest] antlr.org back up and new IP address / location
Message-ID: <6660D764-6643-4C71-B3AA-90640D57134C@cs.usfca.edu>

Let me know if there is trouble or if it seems better.

Ter

From caishaoting at gmail.com  Thu Feb  8 16:35:08 2007
From: caishaoting at gmail.com (Shaoting Cai)
Date: Fri, 9 Feb 2007 08:35:08 +0800
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <6660D764-6643-4C71-B3AA-90640D57134C@cs.usfca.edu>
References: <6660D764-6643-4C71-B3AA-90640D57134C@cs.usfca.edu>
Message-ID: <9b1ada6d0702081635q7b8ce7ebk53e921cf9c401f7a@mail.gmail.com>

Working well to me :-) Very fast.

On 2/9/07, Terence Parr <parrt at cs.usfca.edu> wrote:
> Let me know if there is trouble or if it seems better.
>
> Ter
>


-- 
Best Regards!

Shaoting Cai

http://caishaoting.spaces.live.com/
http://caishaoting.blogger.net/
MSN: caishaoting at hotmail.com
QQ: 82436272

From pwhite at peter-white.info  Thu Feb  8 17:10:31 2007
From: pwhite at peter-white.info (Peter White)
Date: Thu, 08 Feb 2007 17:10:31 -0800
Subject: [antlr-interest] TokenStreamSelector/includeFile example
	for	3.0?
In-Reply-To: <1170722311.24908.21.camel@localhost>
References: <1170722311.24908.21.camel@localhost>
Message-ID: <1170983432.16888.6.camel@localhost>

Being somewhat of an ANTLR noob, I didn't realize my problem could be
solved with only a lexer and no parser.  The following include method
did the trick:

@lexer::members {
public void include(String filename) {
		if (filename.endsWith("top.jspf\"")) return;
		indent();
		// Might need to escape filename...
		String relativePath = filename.substring(1, filename.length()-1);
		String absolutePath = BASE_DIR + "/" + relativePath;
		System.out.println("<!-- Including: " + absolutePath + " -->");
		
		try {
			UITagLexer lex = new UITagLexer(new ANTLRFileStream(absolutePath));
			while (lex.nextToken().getType() != EOF) {
	            		lex.nextToken();
	        	}
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
}

On Mon, 2007-02-05 at 16:38 -0800, Peter White wrote:

> Hello,
> 
> I've written a simple filtering grammar to extract instances of our
> custom JSP tags from our JSP pages and I've been unable to parse JSP
> includes "in-line" successfully. Initially, I tried to include files
> by using the following "include" method in my lexer class but that
> only resulted in the exception following my code snippet.
> 
> @lexer::members {
> public void include(String filename) {
> if (filename.endsWith("top.jspf\"")) return;
> indent();
> // Might need to escape filename...
> String relativePath = filename.substring(1, filename.length()-1);
> String absolutePath = BASE_DIR + "/" + relativePath;
> System.out.println("<!-- Including: " + absolutePath + " -->");
> 
> 
> try {
> UITagLexer lex = new UITagLexer(new ANTLRFileStream(absolutePath));
> CommonTokenStream tokens = new CommonTokenStream(lex);
> 
> UITagParser g = new UITagParser(tokens);
> g.document();
> } catch (IOException e) {
> e.printStackTrace();
> } catch (RecognitionException e) {
> e.printStackTrace();
> }
> }
> }
> 
> org.antlr.runtime.debug.DebugParser.reportError(DebugParser.java:87):
> java.net.BindException: Address already in use: JVM_Bind
> 
> After searching the mail archives, I realized the above approach
> wouldn't work and I came across several references to the includeFile
> example so I downloaded the source to 2.7.7 to examine it. I've
> noticed that TokenStreamSelector.java isn't included in the 3.0 beta
> source distribution and was wondering if there's some other mechanism
> for achieving the same results in 3.0. My apologies if this is
> currently documented somewhere - I searched the ANTLR website and mail
> archives and didn't see anything.
> 
> Any pointers in the right direction would be greatly appreciated!
> 
> Thanks,
> Peter
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070208/1c8498e1/attachment-0001.html 

From parrt at cs.usfca.edu  Thu Feb  8 18:00:59 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 8 Feb 2007 18:00:59 -0800
Subject: [antlr-interest] predicated LL(*) parsing examples chapter
Message-ID: <9363A581-80EE-485B-8F96-E4237D1D2DF6@cs.usfca.edu>

Howdy, this chapter did not fit in the book so I am putting it in the  
wiki:

http://www.antlr.org/wiki/display/ANTLR3/Predicated-LL+Parsing+Examples

Ter

From email at williamwright.info  Thu Feb  8 19:40:42 2007
From: email at williamwright.info (Bill)
Date: Thu, 8 Feb 2007 22:40:42 -0500
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <9b1ada6d0702081635q7b8ce7ebk53e921cf9c401f7a@mail.gmail.com>
Message-ID: <001a01c74bfc$13dcfcc0$0700a8c0@BILL>

It may be associated with time of day, but the downloads seem over 100%
faster.

Bill

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Shaoting Cai
Sent: Thursday, February 08, 2007 7:35 PM
To: Terence Parr
Cc: ANTLR Interest
Subject: Re: [antlr-interest] antlr.org back up and new IP address /
location

Working well to me :-) Very fast.

On 2/9/07, Terence Parr <parrt at cs.usfca.edu> wrote:
> Let me know if there is trouble or if it seems better.
>
> Ter
>


-- 
Best Regards!

Shaoting Cai

http://caishaoting.spaces.live.com/
http://caishaoting.blogger.net/
MSN: caishaoting at hotmail.com
QQ: 82436272



From Imran.AR at in.bosch.com  Thu Feb  8 20:20:30 2007
From: Imran.AR at in.bosch.com (Imran A R (RBIN/EMT2))
Date: Fri, 9 Feb 2007 09:50:30 +0530
Subject: [antlr-interest] Extending java.g
Message-ID: <141D986BB4749448AB843778A4DD236B07EB259D@kormail02.in.bosch.com>

Hello all,

	I am extending java.g . I have one special requirement.
	whenever I see string "TE_" in a .java file, my parser should
not
	consider that line. It should just print the content of that
line
	and continue parsing the next line. How to do this?

	I tried following

	protected UNDEFINED_TOKEN :"TE_"	;

	compilation of .g file went fine. But when I run with a sample
file , throws error

	parser exception: T.java:4:1: unexpected token: .
	T.java:4:1: unexpected token: "TE_"
		        at
JavaRecognizer.compilationUnit(JavaRecognizer.java:209)
		        at Main.parseFile(Main.java:71)
		        at Main.doFile(Main.java:54)
		        at Main.main(Main.java:24)

	Thank you in Advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/4c342bef/attachment.html 

From hugo.a.garcia at gmail.com  Fri Feb  9 01:55:30 2007
From: hugo.a.garcia at gmail.com (Hugo Garcia)
Date: Fri, 9 Feb 2007 04:55:30 -0500
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <6660D764-6643-4C71-B3AA-90640D57134C@cs.usfca.edu>
References: <6660D764-6643-4C71-B3AA-90640D57134C@cs.usfca.edu>
Message-ID: <f9637ada0702090155w1c1f33ecpc510dd60e566e9c7@mail.gmail.com>

On 2/8/07, Terence Parr <parrt at cs.usfca.edu> wrote:
> Let me know if there is trouble or if it seems better.
>
> Ter
>


hmmm... trying to download antlrworks... and it hangs at 1.7 MB.

Anyone seen this?

From kroepke at classdump.org  Fri Feb  9 02:12:26 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Fri, 9 Feb 2007 11:12:26 +0100
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <f9637ada0702090155w1c1f33ecpc510dd60e566e9c7@mail.gmail.com>
References: <6660D764-6643-4C71-B3AA-90640D57134C@cs.usfca.edu>
	<f9637ada0702090155w1c1f33ecpc510dd60e566e9c7@mail.gmail.com>
Message-ID: <2583BEFE-6043-4741-B0E1-C78774FF9486@classdump.org>


On Feb 9, 2007, at 10:55 AM, Hugo Garcia wrote:

> hmmm... trying to download antlrworks... and it hangs at 1.7 MB.
>
> Anyone seen this?

Yes, very often. I'm in Europe and the connection to USF seems to be  
weird at times. Not sure whose fault it is, might even be someone in  
the middle.
Where are trying this from, outside the US?

Maybe we can setup a mirror for the recent downloads or something...

cheers,
-k
-- 
Kay R?pke
http://classdump.org/





From email at williamwright.info  Fri Feb  9 07:18:11 2007
From: email at williamwright.info (Bill)
Date: Fri, 9 Feb 2007 10:18:11 -0500
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <2583BEFE-6043-4741-B0E1-C78774FF9486@classdump.org>
Message-ID: <000501c74c5d$83e52310$0700a8c0@BILL>

Actually yeah that keeps happening to me too.  Transfer speed will go from
200+kbps down to 70...60...8.9kbps, kind of hang.  I'll cancel the download,
restart, it will jump to where it was and then sort of move forward at an OK
speed.

I just pinged antlr.org heavily and the connection was consistently
responsive for the entire 2-3 minutes I did that.

Bill

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Kay Roepke
Sent: Friday, February 09, 2007 5:12 AM
To: Hugo Garcia
Cc: ANTLR Interest; Terence Parr
Subject: Re: [antlr-interest] antlr.org back up and new IP address /
location


On Feb 9, 2007, at 10:55 AM, Hugo Garcia wrote:

> hmmm... trying to download antlrworks... and it hangs at 1.7 MB.
>
> Anyone seen this?

Yes, very often. I'm in Europe and the connection to USF seems to be  
weird at times. Not sure whose fault it is, might even be someone in  
the middle.
Where are trying this from, outside the US?

Maybe we can setup a mirror for the recent downloads or something...

cheers,
-k
-- 
Kay R?pke
http://classdump.org/







From email at williamwright.info  Fri Feb  9 07:21:15 2007
From: email at williamwright.info (Bill)
Date: Fri, 9 Feb 2007 10:21:15 -0500
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <2583BEFE-6043-4741-B0E1-C78774FF9486@classdump.org>
Message-ID: <000601c74c5d$f136abf0$0700a8c0@BILL>

All 2 MB of Antlrworks just downloaded for me in about 20 seconds.

Bill

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Kay Roepke
Sent: Friday, February 09, 2007 5:12 AM
To: Hugo Garcia
Cc: ANTLR Interest; Terence Parr
Subject: Re: [antlr-interest] antlr.org back up and new IP address /
location


On Feb 9, 2007, at 10:55 AM, Hugo Garcia wrote:

> hmmm... trying to download antlrworks... and it hangs at 1.7 MB.
>
> Anyone seen this?

Yes, very often. I'm in Europe and the connection to USF seems to be  
weird at times. Not sure whose fault it is, might even be someone in  
the middle.
Where are trying this from, outside the US?

Maybe we can setup a mirror for the recent downloads or something...

cheers,
-k
-- 
Kay R?pke
http://classdump.org/







From eitan.suez at gmail.com  Fri Feb  9 07:30:53 2007
From: eitan.suez at gmail.com (Eitan Suez)
Date: Fri, 9 Feb 2007 09:30:53 -0600
Subject: [antlr-interest] antlrv3 ant task comments from a newbie..
Message-ID: <a21b55590702090730r5ea9d8a6naec674b727d909d2@mail.gmail.com>

hi all,

  i'm an antlr newbie.  just got a copy of the betabook
  from pragprog and downloaded a copy of antlrv3.

  i have some feedback on antlr3 ant task..
  or rather a laundry list of questions and
  changes i'd like to see..

1.   i tried to run a test target and am getting this:

BUILD FAILED
java.lang.UnsupportedClassVersionError: Bad version number in .class file

  i'm running java 5.  is anyone else seeing this?


2. if specified outputdirectory is "gen"
  and specified package name (in .g files) is "com.xyz.foo"
  then files should auto-output to gen/com/xyz/foo

  analog:  when i invoke javac and specify target directory
  to "classes" the package directories are auto-created

3. i'd like to be able to specify "classpathref" as an xml attribute
  to antlr task, like one can do with the javac task;  e.g .:

  <antlr:antlr3 xmlns:antlr="..."
     target="Expr.g" classpathref="antlr.path" ... />

  (i.e. i prefer the above to having to define a nested
    element to specify the classpath)

4. i'd like to see support for nested fileset element for
  specifying more than one .g file.  for example if want
  to process both a parser and a tree grammar in one
  step.  e.g.:

    <antlr:antlr3 ...>
      <fileset dir="grammars" includes="*.g" />
    </antlr:antlr3>

  i believe from the command line i can specify more than
  one grammar file.

5. this is not really an issue with the ant task, more
  with the default behaviour of the tool..
   why doesn't the token libdir value default to same
   dir the .java files are written?

  separately, it's nice to see that in v3 you don't have
  to specify both a parser and lexer class declaration,
  but i'm baffled that to place the generated code in
  a specific package (which i think should be the default
  case) one must specify two @header entries.

thanks!
/ eitan
--
eitan suez / austin, texas

 ( i sent a copy of this message yesterday but it didn't
   make it through..i'm guessing perhaps it coincided
   with some of the dns settings changes.. )
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/7261fd24/attachment.html 

From parrt at cs.usfca.edu  Fri Feb  9 08:12:27 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 9 Feb 2007 08:12:27 -0800
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <000501c74c5d$83e52310$0700a8c0@BILL>
References: <000501c74c5d$83e52310$0700a8c0@BILL>
Message-ID: <88C17E23-732B-46BE-83D7-A5089754F4A8@cs.usfca.edu>


On Feb 9, 2007, at 7:18 AM, Bill wrote:

> Actually yeah that keeps happening to me too.  Transfer speed will  
> go from
> 200+kbps down to 70...60...8.9kbps, kind of hang.  I'll cancel the  
> download,
> restart, it will jump to where it was and then sort of move forward  
> at an OK
> speed.

> I just pinged antlr.org heavily and the connection was consistently
> responsive for the entire 2-3 minutes I did that.
>

So it *used* to hang and now that we moved it it's better?

If it's still bad, I'll have to move to our computer science network,  
which we know how to configure ;)

Ter



From email at williamwright.info  Fri Feb  9 08:26:31 2007
From: email at williamwright.info (Bill)
Date: Fri, 9 Feb 2007 11:26:31 -0500
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <88C17E23-732B-46BE-83D7-A5089754F4A8@cs.usfca.edu>
Message-ID: <000a01c74c67$0fa85120$0700a8c0@BILL>

Hmm, I wish that were the case.  I was hoping so.

 

However right now I am look at
http://www.antlr.org/download/antlr-3.0b6.tar.gz being downloaded and it is
stuck at 20% (see screenshot)

 

Simultaneous pings look good though.  The whole setup definitely needs to be
looked at; the connection looks functional but downloads are getting stuck.

 

Hey, look at this, these two nodes

 

Host antlr.org 69.108.221.142 - took a long time to respond

 

Host VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142] - took a long time to respond

 

speaking of which this is kind of sluggish too:

 

 

Maybe there really is a prob on the local network!

 

Details:

 

C:\>tracert antlr.org

 

Tracing route to antlr.org [138.202.192.53]

over a maximum of 30 hops:

 

  1     2 ms     2 ms     2 ms  192.168.102.1

  2    14 ms     *        *     10.163.160.1

  3    14 ms    15 ms    17 ms  67.20.33.137

  4    17 ms    15 ms    11 ms  68.71.246.133

  5    13 ms    12 ms    12 ms  68.168.17.53

  6    46 ms    21 ms    15 ms  66.109.15.169

  7    13 ms    16 ms    13 ms  66.109.1.137

  8    13 ms    28 ms    13 ms  66.109.1.154

  9    30 ms    23 ms    16 ms  66.109.11.70

 10    88 ms    87 ms    91 ms  ded-p1-0.pltn13.sbcglobal.net
[151.164.191.245]

 

 11    90 ms    92 ms   111 ms
VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142]

 12   129 ms   109 ms   100 ms  www.antlr.org [138.202.192.53]

 

Trace complete.

 

C:\>

 

Bill

 

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Terence Parr
Sent: Friday, February 09, 2007 11:12 AM
To: ANTLR Interest
Subject: Re: [antlr-interest] antlr.org back up and new IP address /
location

 

 

On Feb 9, 2007, at 7:18 AM, Bill wrote:

 

> Actually yeah that keeps happening to me too.  Transfer speed will  

> go from

> 200+kbps down to 70...60...8.9kbps, kind of hang.  I'll cancel the  

> download,

> restart, it will jump to where it was and then sort of move forward  

> at an OK

> speed.

 

> I just pinged antlr.org heavily and the connection was consistently

> responsive for the entire 2-3 minutes I did that.

> 

 

So it *used* to hang and now that we moved it it's better?

 

If it's still bad, I'll have to move to our computer science network,  

which we know how to configure ;)

 

Ter

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/8d95e658/attachment-0001.html 

From email at williamwright.info  Fri Feb  9 08:29:31 2007
From: email at williamwright.info (Bill)
Date: Fri, 9 Feb 2007 11:29:31 -0500
Subject: [antlr-interest] antlr.org back up and new IP address / location
Message-ID: <000f01c74c67$7ae18150$0700a8c0@BILL>

oops.

 

speaking of which this node (your upstream provider) is unbearably sluggish
too:

 

ded-p1-0.pltn13.sbcglobal.net [151.164.191.245]

 

anyone over there ever complain about slow internet connections?  Do these
problems go away at night?

 

Bill

 

  _____  

From: Bill [mailto:email at williamwright.info] 
Sent: Friday, February 09, 2007 11:27 AM
To: 'Terence Parr'; 'ANTLR Interest'
Subject: RE: [antlr-interest] antlr.org back up and new IP address /
location

 

Hmm, I wish that were the case.  I was hoping so.

 

However right now I am look at
http://www.antlr.org/download/antlr-3.0b6.tar.gz being downloaded and it is
stuck at 20% (see screenshot)

 

Simultaneous pings look good though.  The whole setup definitely needs to be
looked at; the connection looks functional but downloads are getting stuck.

 

Hey, look at this, these two nodes

 

Host antlr.org 69.108.221.142 - took a long time to respond

 

Host VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142] - took a long time to respond

 

speaking of which this is kind of sluggish too:

 

 

Maybe there really is a prob on the local network!

 

Details:

 

C:\>tracert antlr.org

 

Tracing route to antlr.org [138.202.192.53]

over a maximum of 30 hops:

 

  1     2 ms     2 ms     2 ms  192.168.102.1

  2    14 ms     *        *     10.163.160.1

  3    14 ms    15 ms    17 ms  67.20.33.137

  4    17 ms    15 ms    11 ms  68.71.246.133

  5    13 ms    12 ms    12 ms  68.168.17.53

  6    46 ms    21 ms    15 ms  66.109.15.169

  7    13 ms    16 ms    13 ms  66.109.1.137

  8    13 ms    28 ms    13 ms  66.109.1.154

  9    30 ms    23 ms    16 ms  66.109.11.70

 10    88 ms    87 ms    91 ms  ded-p1-0.pltn13.sbcglobal.net
[151.164.191.245]

 

 11    90 ms    92 ms   111 ms
VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142]

 12   129 ms   109 ms   100 ms  www.antlr.org [138.202.192.53]

 

Trace complete.

 

C:\>

 

Bill

 

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Terence Parr
Sent: Friday, February 09, 2007 11:12 AM
To: ANTLR Interest
Subject: Re: [antlr-interest] antlr.org back up and new IP address /
location

 

 

On Feb 9, 2007, at 7:18 AM, Bill wrote:

 

> Actually yeah that keeps happening to me too.  Transfer speed will  

> go from

> 200+kbps down to 70...60...8.9kbps, kind of hang.  I'll cancel the  

> download,

> restart, it will jump to where it was and then sort of move forward  

> at an OK

> speed.

 

> I just pinged antlr.org heavily and the connection was consistently

> responsive for the entire 2-3 minutes I did that.

> 

 

So it *used* to hang and now that we moved it it's better?

 

If it's still bad, I'll have to move to our computer science network,  

which we know how to configure ;)

 

Ter

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/5179dfab/attachment.html 

From VAUCHER at fermat.eu  Fri Feb  9 08:39:02 2007
From: VAUCHER at fermat.eu (VAUCHER Laurent)
Date: Fri, 9 Feb 2007 17:39:02 +0100
Subject: [antlr-interest] antlr.org back up and new IP address / location
Message-ID: <200702091739607.SM08604@037f27dd816a40c>

Seen from here (France), the journey under the atlantic ocean is longish. And also the step between 10 and 11...
 
  1    <1 ms     3 ms    <1 ms  192.168.2.1
  2     1 ms     1 ms     1 ms  reverse.completel.net [213.30.171.65]
  3    18 ms    16 ms     8 ms  reverse.completel.net [213.244.29.50]
  4    17 ms    16 ms    16 ms  213.30.129.74
  5    16 ms    16 ms    16 ms  reverse.completel.net [213.244.0.246]
  6    18 ms    17 ms    17 ms  unknown.Level3.net [212.73.204.145]
  7   109 ms    17 ms    17 ms  ae-0-51.mp1.Paris1.Level3.net [4.68.109.1]
  8   115 ms   115 ms   115 ms  ae-0-0.bbr1.Washington1.Level3.net [64.159.0.229]
  9   115 ms   116 ms   117 ms  ae-14-53.car4.Washington1.Level3.net [4.68.121.81]
 10   106 ms   106 ms   106 ms  asn3356-level3.eqabva.sbcglobal.net [4.68.111.186]
 11   193 ms   192 ms   183 ms  ded-p1-0.pltn13.sbcglobal.net [151.164.191.245]
 12   185 ms   185 ms   185 ms  VIP-University-of-San-Francisco-IAF1073874.cust-rtr.pacbell.net [69.108.221.142]
 13   186 ms   185 ms   186 ms  www.antlr.org [138.202.192.53]

________________________________

De : antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] De la part de Bill
Envoy? : 09 February 2007 17:30
? : 'Terence Parr'; 'ANTLR Interest'
Objet : Re: [antlr-interest] antlr.org back up and new IP address / location



oops...

 

speaking of which this node (your upstream provider) is unbearably sluggish too:

 

ded-p1-0.pltn13.sbcglobal.net [151.164.191.245]

 

anyone over there ever complain about slow internet connections?  Do these problems go away at night?

 

Bill

 

________________________________

From: Bill [mailto:email at williamwright.info] 
Sent: Friday, February 09, 2007 11:27 AM
To: 'Terence Parr'; 'ANTLR Interest'
Subject: RE: [antlr-interest] antlr.org back up and new IP address / location

 

Hmm, I wish that were the case.  I was hoping so.

 

However right now I am look at http://www.antlr.org/download/antlr-3.0b6.tar.gz being downloaded and it is stuck at 20% (see screenshot)

 

Simultaneous pings look good though.  The whole setup definitely needs to be looked at; the connection looks functional but downloads are getting stuck.

 

Hey, look at this, these two nodes

 

Host antlr.org 69.108.221.142 - took a long time to respond

 

Host VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142] - took a long time to respond

 

speaking of which this is kind of sluggish too:

 

 

Maybe there really is a prob on the local network!

 

Details:

 

C:\>tracert antlr.org

 

Tracing route to antlr.org [138.202.192.53]

over a maximum of 30 hops:

 

  1     2 ms     2 ms     2 ms  192.168.102.1

  2    14 ms     *        *     10.163.160.1

  3    14 ms    15 ms    17 ms  67.20.33.137

  4    17 ms    15 ms    11 ms  68.71.246.133

  5    13 ms    12 ms    12 ms  68.168.17.53

  6    46 ms    21 ms    15 ms  66.109.15.169

  7    13 ms    16 ms    13 ms  66.109.1.137

  8    13 ms    28 ms    13 ms  66.109.1.154

  9    30 ms    23 ms    16 ms  66.109.11.70

 10    88 ms    87 ms    91 ms  ded-p1-0.pltn13.sbcglobal.net [151.164.191.245]

 

 11    90 ms    92 ms   111 ms  VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142]

 12   129 ms   109 ms   100 ms  www.antlr.org [138.202.192.53]

 

Trace complete.

 

C:\>

 

Bill

 

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Terence Parr
Sent: Friday, February 09, 2007 11:12 AM
To: ANTLR Interest
Subject: Re: [antlr-interest] antlr.org back up and new IP address / location

 

 

On Feb 9, 2007, at 7:18 AM, Bill wrote:

 

> Actually yeah that keeps happening to me too.  Transfer speed will  

> go from

> 200+kbps down to 70...60...8.9kbps, kind of hang.  I'll cancel the  

> download,

> restart, it will jump to where it was and then sort of move forward  

> at an OK

> speed.

 

> I just pinged antlr.org heavily and the connection was consistently

> responsive for the entire 2-3 minutes I did that.

> 

 

So it *used* to hang and now that we moved it it's better?

 

If it's still bad, I'll have to move to our computer science network,  

which we know how to configure ;)

 

Ter

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/4836d143/attachment-0001.html 

From zhixueyong at hotmail.com  Fri Feb  9 08:42:41 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Fri, 09 Feb 2007 11:42:41 -0500
Subject: [antlr-interest] Extending java.g
In-Reply-To: <141D986BB4749448AB843778A4DD236B07EB259D@kormail02.in.bosch.com>
References: <141D986BB4749448AB843778A4DD236B07EB259D@kormail02.in.bosch.com>
Message-ID: <eqi89v$rnn$1@sea.gmane.org>

1. Make the rule public.
2. Fix ambiguities if has
3. Add an action for the rule (check how whitesapce is handled):
$setType(Token.SKIP);


 >         I tried following
 >
 >         protected UNDEFINED_TOKEN :"TE_"        ;
 >


-- 
Xue Yong Zhi
XRuby (Ruby to Java bytecode compiler):
http://xruby.blogspot.com



From eitan.suez at gmail.com  Fri Feb  9 09:22:13 2007
From: eitan.suez at gmail.com (Eitan Suez)
Date: Fri, 9 Feb 2007 11:22:13 -0600
Subject: [antlr-interest] general f/b on antlrworks idea plugin
Message-ID: <a21b55590702090922x7632be55ld0b914b12b6ba1b8@mail.gmail.com>

hello all,

  i just joined the antlr-interest mailing list and am
  very new to antlr.

  wanted to note a couple of comments about the antlrworks
  plugin:

  [a] it'd be nice if it supported displaying line numbers
  [b] pressing ctrl-z in the editor (undo), freezes the ide

  (running on ubuntu linux with intellij idea)

/ eitan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/a8b942d4/attachment.html 

From email at williamwright.info  Fri Feb  9 10:22:31 2007
From: email at williamwright.info (Bill)
Date: Fri, 9 Feb 2007 13:22:31 -0500
Subject: [antlr-interest] antlr.org back up and new IP address / location
In-Reply-To: <200702091739607.SM08604@037f27dd816a40c>
Message-ID: <003001c74c77$43c96600$0700a8c0@BILL>

Sure enough. Whenever I point these problems out to the network people they
complain about my using tracert and ping.  They say the traffic is low
priority, which it is.  I tell them of course I use the most low priority
traffic to check the performance of a circuit, that?s the only way to see
how it is really performing!  They don?t have much to say to that
 then they
go fix the problem.

 

Bill

 

  _____  

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of VAUCHER Laurent
Sent: Friday, February 09, 2007 11:39 AM
To: ANTLR Interest
Subject: Re: [antlr-interest] antlr.org back up and new IP address /
location

 

Seen from here (France), the journey under the atlantic ocean is longish.
And also the step between 10 and 11...

 

  1    <1 ms     3 ms    <1 ms  192.168.2.1
  2     1 ms     1 ms     1 ms  reverse.completel.net [213.30.171.65]
  3    18 ms    16 ms     8 ms  reverse.completel.net [213.244.29.50]
  4    17 ms    16 ms    16 ms  213.30.129.74
  5    16 ms    16 ms    16 ms  reverse.completel.net [213.244.0.246]
  6    18 ms    17 ms    17 ms  unknown.Level3.net [212.73.204.145]
  7   109 ms    17 ms    17 ms  ae-0-51.mp1.Paris1.Level3.net [4.68.109.1]
  8   115 ms   115 ms   115 ms  ae-0-0.bbr1.Washington1.Level3.net
[64.159.0.229]
  9   115 ms   116 ms   117 ms  ae-14-53.car4.Washington1.Level3.net
[4.68.121.81]
 10   106 ms   106 ms   106 ms  asn3356-level3.eqabva.sbcglobal.net
[4.68.111.186]
 11   193 ms   192 ms   183 ms  ded-p1-0.pltn13.sbcglobal.net
[151.164.191.245]
 12   185 ms   185 ms   185 ms
VIP-University-of-San-Francisco-IAF1073874.cust-rtr.pacbell.net
[69.108.221.142]
 13   186 ms   185 ms   186 ms  www.antlr.org [138.202.192.53]

  _____  

De : antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] De la part de Bill
Envoy? : 09 February 2007 17:30
? : 'Terence Parr'; 'ANTLR Interest'
Objet : Re: [antlr-interest] antlr.org back up and new IP address / location

oops


 

speaking of which this node (your upstream provider) is unbearably sluggish
too:

 

ded-p1-0.pltn13.sbcglobal.net [151.164.191.245]

 

anyone over there ever complain about slow internet connections?  Do these
problems go away at night?

 

Bill

 

  _____  

From: Bill [mailto:email at williamwright.info] 
Sent: Friday, February 09, 2007 11:27 AM
To: 'Terence Parr'; 'ANTLR Interest'
Subject: RE: [antlr-interest] antlr.org back up and new IP address /
location

 

Hmm, I wish that were the case.  I was hoping so.

 

However right now I am look at
http://www.antlr.org/download/antlr-3.0b6.tar.gz being downloaded and it is
stuck at 20% (see screenshot)

 

Simultaneous pings look good though.  The whole setup definitely needs to be
looked at; the connection looks functional but downloads are getting stuck.

 

Hey, look at this, these two nodes

 

Host antlr.org 69.108.221.142 ? took a long time to respond

 

Host VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142] - took a long time to respond

 

speaking of which this is kind of sluggish too:

 

 

Maybe there really is a prob on the local network!

 

Details:

 

C:\>tracert antlr.org

 

Tracing route to antlr.org [138.202.192.53]

over a maximum of 30 hops:

 

  1     2 ms     2 ms     2 ms  192.168.102.1

  2    14 ms     *        *     10.163.160.1

  3    14 ms    15 ms    17 ms  67.20.33.137

  4    17 ms    15 ms    11 ms  68.71.246.133

  5    13 ms    12 ms    12 ms  68.168.17.53

  6    46 ms    21 ms    15 ms  66.109.15.169

  7    13 ms    16 ms    13 ms  66.109.1.137

  8    13 ms    28 ms    13 ms  66.109.1.154

  9    30 ms    23 ms    16 ms  66.109.11.70

 10    88 ms    87 ms    91 ms  ded-p1-0.pltn13.sbcglobal.net
[151.164.191.245]

 

 11    90 ms    92 ms   111 ms
VIP-University-of-San-Francisco-IAF1073874.cust-

rtr.pacbell.net [69.108.221.142]

 12   129 ms   109 ms   100 ms  www.antlr.org [138.202.192.53]

 

Trace complete.

 

C:\>

 

Bill

 

 

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Terence Parr
Sent: Friday, February 09, 2007 11:12 AM
To: ANTLR Interest
Subject: Re: [antlr-interest] antlr.org back up and new IP address /
location

 

 

On Feb 9, 2007, at 7:18 AM, Bill wrote:

 

> Actually yeah that keeps happening to me too.  Transfer speed will  

> go from

> 200+kbps down to 70...60...8.9kbps, kind of hang.  I'll cancel the  

> download,

> restart, it will jump to where it was and then sort of move forward  

> at an OK

> speed.

 

> I just pinged antlr.org heavily and the connection was consistently

> responsive for the entire 2-3 minutes I did that.

> 

 

So it *used* to hang and now that we moved it it's better?

 

If it's still bad, I'll have to move to our computer science network,  

which we know how to configure ;)

 

Ter

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/629c9d7c/attachment-0001.html 

From parrt at cs.usfca.edu  Fri Feb  9 10:23:35 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 9 Feb 2007 10:23:35 -0800
Subject: [antlr-interest] general f/b on antlrworks idea plugin
In-Reply-To: <a21b55590702090922x7632be55ld0b914b12b6ba1b8@mail.gmail.com>
References: <a21b55590702090922x7632be55ld0b914b12b6ba1b8@mail.gmail.com>
Message-ID: <8E31667B-E70A-493F-90F9-2DC13D29918F@cs.usfca.edu>

Hi Eitan,

Jean responds:

> I have to double-check but I think it takes the IntelliJ command  
> instead
> of the AW ones. That's something I haven't figured out is how to  
> hook up
> my command into IntelliJ's menu... if someone knows how to do that, it
> would be great. That's the really annoying part with IntelliJ is that
> its missing documentation make it hard to finish the integration with
> the IDE without spending months testing/trying various things....
>
> Jean

On Feb 9, 2007, at 9:22 AM, Eitan Suez wrote:

> hello all,
>
>   i just joined the antlr-interest mailing list and am
>   very new to antlr.
>
>   wanted to note a couple of comments about the antlrworks
>   plugin:
>
>   [a] it'd be nice if it supported displaying line numbers
>   [b] pressing ctrl-z in the editor (undo), freezes the ide
>
>   (running on ubuntu linux with intellij idea)
>
> / eitan
>


From eitan.suez at gmail.com  Fri Feb  9 11:25:54 2007
From: eitan.suez at gmail.com (Eitan Suez)
Date: Fri, 9 Feb 2007 13:25:54 -0600
Subject: [antlr-interest] general f/b on antlrworks idea plugin
In-Reply-To: <8E31667B-E70A-493F-90F9-2DC13D29918F@cs.usfca.edu>
References: <a21b55590702090922x7632be55ld0b914b12b6ba1b8@mail.gmail.com>
	<8E31667B-E70A-493F-90F9-2DC13D29918F@cs.usfca.edu>
Message-ID: <a21b55590702091125i5e802949ubebe3f1fc8edaa87@mail.gmail.com>

thanks.  i have limited experience with writing idea
plugins myself;  i've written a partial idea plugin a while
ago and i'm sure their api has not been standing
still either.

the idea folks do seem to be responsive when asking
questions directly.

AW is much more than i expected in terms of features
so i don't mean to sound like i'm complaining.  just wanted
to make sure you were aware of the issues i came across.
i'd love to use it but i find myself freezing idea way too
often at the moment.. :-)

/ eitan



On 2/9/07, Terence Parr <parrt at cs.usfca.edu> wrote:
>
> Hi Eitan,
>
> Jean responds:
>
> > I have to double-check but I think it takes the IntelliJ command
> > instead
> > of the AW ones. That's something I haven't figured out is how to
> > hook up
> > my command into IntelliJ's menu... if someone knows how to do that, it
> > would be great. That's the really annoying part with IntelliJ is that
> > its missing documentation make it hard to finish the integration with
> > the IDE without spending months testing/trying various things....
> >
> > Jean
>
> On Feb 9, 2007, at 9:22 AM, Eitan Suez wrote:
>
> > hello all,
> >
> >   i just joined the antlr-interest mailing list and am
> >   very new to antlr.
> >
> >   wanted to note a couple of comments about the antlrworks
> >   plugin:
> >
> >   [a] it'd be nice if it supported displaying line numbers
> >   [b] pressing ctrl-z in the editor (undo), freezes the ide
> >
> >   (running on ubuntu linux with intellij idea)
> >
> > / eitan
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/707a6295/attachment.html 

From parrt at cs.usfca.edu  Fri Feb  9 11:38:02 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 9 Feb 2007 11:38:02 -0800
Subject: [antlr-interest] general f/b on antlrworks idea plugin
In-Reply-To: <a21b55590702091125i5e802949ubebe3f1fc8edaa87@mail.gmail.com>
References: <a21b55590702090922x7632be55ld0b914b12b6ba1b8@mail.gmail.com>
	<8E31667B-E70A-493F-90F9-2DC13D29918F@cs.usfca.edu>
	<a21b55590702091125i5e802949ubebe3f1fc8edaa87@mail.gmail.com>
Message-ID: <503084F1-0E58-4019-8DAC-A632B34AF011@cs.usfca.edu>

Yep, AW is more stable if you run it by itself.  Jean is still  
working on the plug-in.

  I have no issues using AW by itself.

Ter
On Feb 9, 2007, at 11:25 AM, Eitan Suez wrote:

> thanks.  i have limited experience with writing idea
> plugins myself;  i've written a partial idea plugin a while
> ago and i'm sure their api has not been standing
> still either.
>
> the idea folks do seem to be responsive when asking
> questions directly.
>
> AW is much more than i expected in terms of features
> so i don't mean to sound like i'm complaining.  just wanted
> to make sure you were aware of the issues i came across.
> i'd love to use it but i find myself freezing idea way too
> often at the moment.. :-)
>
> / eitan
>
>
>
> On 2/9/07, Terence Parr <parrt at cs.usfca.edu> wrote: Hi Eitan,
>
> Jean responds:
>
> > I have to double-check but I think it takes the IntelliJ command
> > instead
> > of the AW ones. That's something I haven't figured out is how to
> > hook up
> > my command into IntelliJ's menu... if someone knows how to do  
> that, it
> > would be great. That's the really annoying part with IntelliJ is  
> that
> > its missing documentation make it hard to finish the integration  
> with
> > the IDE without spending months testing/trying various things....
> >
> > Jean
>
> On Feb 9, 2007, at 9:22 AM, Eitan Suez wrote:
>
> > hello all,
> >
> >   i just joined the antlr-interest mailing list and am
> >   very new to antlr.
> >
> >   wanted to note a couple of comments about the antlrworks
> >   plugin:
> >
> >   [a] it'd be nice if it supported displaying line numbers
> >   [b] pressing ctrl-z in the editor (undo), freezes the ide
> >
> >   (running on ubuntu linux with intellij idea)
> >
> > / eitan
> >
>
>


From parrt at cs.usfca.edu  Fri Feb  9 11:38:42 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 9 Feb 2007 11:38:42 -0800
Subject: [antlr-interest] antlrv3 ant task comments from a newbie..
In-Reply-To: <a21b55590702090730r5ea9d8a6naec674b727d909d2@mail.gmail.com>
References: <a21b55590702090730r5ea9d8a6naec674b727d909d2@mail.gmail.com>
Message-ID: <79A4F7E8-E49E-43B7-A502-CDB9CC573E89@cs.usfca.edu>

Hi. should I add this task to the repository and give you an account  
so you can update? perhaps you can work with Juergen, the original  
author.

Ter
On Feb 9, 2007, at 7:30 AM, Eitan Suez wrote:

> hi all,
>
>   i'm an antlr newbie.  just got a copy of the betabook
>   from pragprog and downloaded a copy of antlrv3.
>
>   i have some feedback on antlr3 ant task..
>   or rather a laundry list of questions and
>   changes i'd like to see..
>
> 1.   i tried to run a test target and am getting this:
>
> BUILD FAILED
> java.lang.UnsupportedClassVersionError: Bad version number  
> in .class file
>
>   i'm running java 5.  is anyone else seeing this?
>
>
> 2. if specified outputdirectory is "gen"
>   and specified package name (in .g files) is "com.xyz.foo"
>   then files should auto-output to gen/com/xyz/foo
>
>   analog:  when i invoke javac and specify target directory
>   to "classes" the package directories are auto-created
>
> 3. i'd like to be able to specify "classpathref" as an xml attribute
>   to antlr task, like one can do with the javac task;  e.g .:
>
>   <antlr:antlr3 xmlns:antlr="..."
>      target="Expr.g" classpathref="antlr.path" ... />
>
>   (i.e. i prefer the above to having to define a nested
>     element to specify the classpath)
>
> 4. i'd like to see support for nested fileset element for
>   specifying more than one .g file.  for example if want
>   to process both a parser and a tree grammar in one
>   step.  e.g.:
>
>     <antlr:antlr3 ...>
>       <fileset dir="grammars" includes="*.g" />
>     </antlr:antlr3>
>
>   i believe from the command line i can specify more than
>   one grammar file.
>
> 5. this is not really an issue with the ant task, more
>   with the default behaviour of the tool..
>    why doesn't the token libdir value default to same
>    dir the .java files are written?
>
>   separately, it's nice to see that in v3 you don't have
>   to specify both a parser and lexer class declaration,
>   but i'm baffled that to place the generated code in
>   a specific package (which i think should be the default
>   case) one must specify two @header entries.
>
> thanks!
> / eitan
> --
> eitan suez / austin, texas
>
>  ( i sent a copy of this message yesterday but it didn't
>    make it through..i'm guessing perhaps it coincided
>    with some of the dns settings changes.. )
>
>


From jimi at intersystems.com  Fri Feb  9 12:07:46 2007
From: jimi at intersystems.com (Jim Idle)
Date: Fri, 9 Feb 2007 15:07:46 -0500
Subject: [antlr-interest] Antlr 3.0b6 Error Issue (ANTLRWorks 1.0b8)
In-Reply-To: <002101c74ae1$f0217510$b982e6cd@tsitelsys.com>
References: <002101c74ae1$f0217510$b982e6cd@tsitelsys.com>
Message-ID: <20070209200748.571888E7@mail.intersystems.com>

Bert,

 

Looks like nobody answered this one, so:

 

First, it looks like you are confusing parser and lexer rules a bit.
Parser rules should start with a lower case letter and lexer rules
should start with an UPPER case letter. This will get rid of a lot of
your warnings I suggest.

 

When I told you about changing he lexer rules, I assumed that you were
using them a part of bigger elements, if this is your full grammar then
you are not and you will never fire the COL_ELEM lexer rule because
ALPHA or DIGIT will fire first. Instead get rid of COL_ELEM and create a
parser rule col_elem : ALPHA | DIGIT ; However, if this can occur where
you would otherwise be able to have an ALPHA or DIGIT then you will just
create ambiguities. You probably just want to recognize ALPHA and DIGIT
and decide what their context is afterwards the lexer doesn't know what
you want at any particular point, it just says "Here are some digits".
Try to construct the minimum results that makes a syntactically possible
tree then use the tree to work out what the things are.

 

I suggest that you forget about what you have and build things up in
very gradual steps, eliminating errors and so on at each step. 

 

Jim

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Bert Williams
Sent: Wednesday, February 07, 2007 10:01 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Antlr 3.0b6 Error Issue (ANTLRWorks 1.0b8)

 

Greetings:

 

After a few download issues, I have successfully installed and run the
Antlr 3.0 beta software.

 

This is a great improvement over the 2.7.7 I was previously trying.  At
least I appear to be getting further along.  The automatic left
recursion removal is a very nice feature, especially for someone who
doesn't write grammars every day.

 

 

When I try to run the grammar below (Posix Extended Regular Expressions,
a subset), using the ANTLRWorks 1.0b8 GUI,

I get the following warnings/errors.  I also get occasional internal
errors as shown below.  Whenever I make a change that fails the "Check
Grammar" operation, I seem to get this and other internal errors.

 

My question is:

 

With respect to the warning (200), how does one specify that the parser
be generated?  I really have just one alternative (and I did try e (e)*
instead of (e)+)

Is there a "greedy=false" option?  I don't see anything wrong with the
grammar, but perhaps there is something subtle I am missing.

 

Thanks for your helpful reply.

 

Bert Williams.

 

 

 

------------------------------Warnings/Errors---------------------------
----------------------------------------------------------

 

[12:36:11] error(106): regexshort.g:9:23: reference to undefined rule:
one_character_ERE

[12:36:11] error(106): regexshort.g:9:59: reference to undefined rule:
extended_reg_exp

[12:36:16] Checking Grammar...

[12:36:17] warning(200): regexshort.g:7:37: Decision can match input
such as "<EOT>" using multiple alternatives: 1, 2

As a result, alternative(s) 2 were disabled for that input

[12:36:17] warning(201): regexshort.g:7:37: The following alternatives
are unreachable: 2

 

[12:36:17] warning(208): regexshort.g:136:1: The following token
definitions are unreachable:
ERE_expression,ERE_dupl_symbol,DIGITSET,ALPHASET,ALPHA,DIGIT,COLL_ELEM,P
LUS,DOLLAR,STAR,QUESTION,CARET  

 

 

 

-----------------Antlr Internal
Error-------------------------------------------------------------------
-----------------

 

[12:46:58] error(10):  internal error:
org.antlr.tool.Message.toString(Message.java:124): Assertion failed!
Message ID 106 created but is not present in errorMsgIDs or
warningMsgIDs.

 

 

 

--------------------------------------------------------ANTLR 3.0
Grammar
(regexshort.g)----------------------------------------------------

 

grammar regexshort;

 

 

 

extended_reg_exp   : (ERE_branch) ('|' ERE_branch)* (EOF)

                   ;

ERE_branch         : (ERE_expression)+

                   ;

ERE_expression     : (one_character_ERE | '^' | '$' | '('
extended_reg_exp ')') (ERE_dupl_symbol)?

                   ;

one_character_ERE  : ORD_CHAR

                   | QUOTED_CHAR

                   | '.'

                   | bracket_expression

                   ;

ERE_dupl_symbol    : '*'

                   | '+'

                   | '?'

                   | '{' DUP_COUNT               '}'

                   | '{' DUP_COUNT ','           '}'

                   | '{' DUP_COUNT ',' DUP_COUNT '}'

                   ;

DUP_COUNT 

            :           DIGIT ;                   

QUOTED_CHAR

            :           '\\' ORD_CHAR;

 

ORD_CHAR 

            :           COLL_ELEM

            |           DOLLAR

            ;

 

 

bracket_expression : '[' matching_list    ']'

               | '[' nonmatching_list ']'

               ;

matching_list  : bracket_list

               ;

nonmatching_list : '^' bracket_list

               ;

bracket_list   : follow_list

               | follow_list '-'

               ;

follow_list    :  (expression_term) (expression_term)*

               ;

expression_term : single_expression

               | range_expression

               ;

single_expression : end_range

               ;

range_expression : start_range end_range

               | start_range '-'

               ;

start_range    : end_range '-'

               ;

end_range      : COLL_ELEM

//               | collating_symbol

               ;

 

 

 

protected

DIGITSET : '0'..'9' ;

 

protected

ALPHASET :     ('a'..'z'|'A'..'Z' ) ;

 

ALPHA : ALPHASET;

 

DIGIT    : DIGITSET ;

 

COLL_ELEM

      :     ALPHASET

      |     DIGITSET

 

      ;

 

            

 

PLUS

            :           '+'

            ;

            

COMMA

            :           ','

            ;           

 

DOLLAR

            :           '$'

            ;

 

STAR

            :           '*'

            ;

QUESTION

            :           '?'

            ;

LPAREN

            :           '('

            ;           

 

RPAREN

            :           ')'

            ;           

 

ALTERNATION

            :           '|'

            ;

 

LBRACE

            :           '{'

            ;

RBRACE

            :           '}'

            ;           

 

LBRACKET

            :           '['

            ;

            

RBRACKET

            :           ']'

            ;           

 

PERIOD

            :           '.'

            ;

 

DASH

            :           '-'

            ;

BACKSLASH 

            :           '\\'

            ;

 

CARET

            :           '^'

            ;

 

WS       :           ' '

            |           '\t'

            |           '\n'

            |           '\r'

            ;

 

SEMI:   ';'

            ;

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/8c0c8514/attachment-0001.html 

From jimi at intersystems.com  Fri Feb  9 12:13:15 2007
From: jimi at intersystems.com (Jim Idle)
Date: Fri, 9 Feb 2007 15:13:15 -0500
Subject: [antlr-interest] Antlr 3.0b6 - problem with '!' operator ? Or
	did I miss something...
In-Reply-To: <15577678.314601170947422648.JavaMail.www@wwinf2202>
References: <15577678.314601170947422648.JavaMail.www@wwinf2202>
Message-ID: <20070209201316.235BE9CD@mail.intersystems.com>

duration returns [String value] :
    ts=timestamp
    {$value = $ts.value;}
    ;
timestamp returns [String value] :
    t=INT 'secs'
	{ $value=$t.text}
    ;

Or:

duration 
returns [String value]
scope { String time }
: timestamp
	{$value = $duration::time;}
;
timestamp 
: t=INT 'secs' { $duration::time = $t.text; }
;

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of David CROSSON
Sent: Thursday, February 08, 2007 7:10 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Antlr 3.0b6 - problem with '!' operator ? Or did I miss something...

Hi,

I can't achieve to make the operator '!' working in order to change text returned by a rule.
In the following test grammar and test unit, I'm using the string "32 secs" as input and I expect
to get the string "32" but this not the case I got "32 secs".

-----------------------------------
grammar Debug;
options {
    filter=false;
    output=AST;
}
@header {
  package logparser.parsers;
}
@lexer::header {
  package logparser.parsers;
}
duration returns [String value] :
    ts=timestamp
    {$duration.value = $ts.text;}
    ;
timestamp :
    INT 'secs'!
    ;
INT :
    ('0'..'9')+
    ;
WS :
    ' '+ {$channel=HIDDEN;}
    ;

-----------------------------------
And the test unit :

package logparser.test;

import junit.framework.*;
import logparser.parsers.DebugLexer;
import org.antlr.runtime.ANTLRStringStream;
import org.antlr.runtime.CharStream;
import org.antlr.runtime.CommonTokenStream;
import logparser.parsers.DebugParser;

public class DebugTest extends TestCase {
    public DebugTest(String testName) {super(testName);}
    protected void setUp() throws Exception {}
    protected void tearDown() throws Exception {}
    
    public void testDebug() throws Exception {
        CharStream in = new ANTLRStringStream("32 secs");
        DebugLexer lexer = new DebugLexer(in);
        CommonTokenStream tokens = new CommonTokenStream(lexer);
        DebugParser parser = new DebugParser(tokens);
        String value = parser.duration().value;
        assertTrue("ERR returned value : '" + value+"'","32".equals(value));
    }
}
-----------------------------------
Thanks for all,
David Crosson.




From eitan.suez at gmail.com  Fri Feb  9 13:01:24 2007
From: eitan.suez at gmail.com (Eitan Suez)
Date: Fri, 9 Feb 2007 15:01:24 -0600
Subject: [antlr-interest] antlrv3 ant task comments from a newbie..
In-Reply-To: <79A4F7E8-E49E-43B7-A502-CDB9CC573E89@cs.usfca.edu>
References: <a21b55590702090730r5ea9d8a6naec674b727d909d2@mail.gmail.com>
	<79A4F7E8-E49E-43B7-A502-CDB9CC573E89@cs.usfca.edu>
Message-ID: <a21b55590702091301i2e1c16d6mde37afb5899ffcc2@mail.gmail.com>

On 2/9/07, Terence Parr <parrt at cs.usfca.edu> wrote:
>
> Hi. should I add this task to the repository and give you an account
> so you can update? perhaps you can work with Juergen, the original
> author.


sounds nice.  i should be able to find some time to
work on this.   the changes i envision shouldn't require
too much work.

thanks, eitan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/596c0727/attachment.html 

From gilbert.williams at prosync.com  Fri Feb  9 16:48:12 2007
From: gilbert.williams at prosync.com (gilbert.williams at prosync.com)
Date: Fri, 09 Feb 2007 18:48:12 -0600
Subject: [antlr-interest] ANTLR 3.0 "feature"
Message-ID: <4037.1171068492@prosync.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/91705185/attachment.html 

From gilbert.williams at prosync.com  Fri Feb  9 17:27:01 2007
From: gilbert.williams at prosync.com (gilbert.williams at prosync.com)
Date: Fri, 09 Feb 2007 19:27:01 -0600
Subject: [antlr-interest] Scratch That Last Post.
Message-ID: <4888.1171070821@prosync.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/7ffbd0b7/attachment.html 

From antlr at jazillian.com  Fri Feb  9 18:37:01 2007
From: antlr at jazillian.com (Andy Tripp)
Date: Fri, 09 Feb 2007 21:37:01 -0500
Subject: [antlr-interest] Extending java.g
In-Reply-To: <141D986BB4749448AB843778A4DD236B07EB259D@kormail02.in.bosch.com>
References: <141D986BB4749448AB843778A4DD236B07EB259D@kormail02.in.bosch.com>
Message-ID: <45CD2FCD.7040400@jazillian.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070209/fa9f2179/attachment.html 

From Imran.AR at in.bosch.com  Fri Feb  9 20:10:29 2007
From: Imran.AR at in.bosch.com (Imran A R (RBIN/EMT2))
Date: Sat, 10 Feb 2007 09:40:29 +0530
Subject: [antlr-interest] Extending java.g
In-Reply-To: <45CD2FCD.7040400@jazillian.com>
Message-ID: <141D986BB4749448AB843778A4DD236B07F107FA@kormail02.in.bosch.com>

Hello 
 
    case which I am trying to write is TE_ apperaring in the begining of
the line.
 
    basically I am trying to achive "//" comment feature. instead of //
i want to user "TE_"
 
    Thank you in advance.

________________________________

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andy Tripp
Sent: Saturday, 10. February 2007 8:07 AM
To: Imran A R (RBIN/EMT2)
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] Extending java.g


Imran A R (RBIN/EMT2) wrote: 

	Hello all, 

	        I am extending java.g . I have one special requirement. 
	        whenever I see string "TE_" in a .java file, my parser
should not 
	        consider that line. It should just print the content of
that line 
	        and continue parsing the next line. How to do this

If "TE_" really can appear anywhere on a physical line, there's no way
to do this with ANTLR or similar tools. You'd have to write a simple
preprocessor that just reads the file a line at a time, searches the
line
for "TE_", and throws the line away if it's found.

Or, just use:
$ grep -v "TE_" myfile

Andy

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070210/abe08907/attachment.html 

From rob.hill at blueyonder.co.uk  Sat Feb 10 04:38:33 2007
From: rob.hill at blueyonder.co.uk (Rob Hill)
Date: Sat, 10 Feb 2007 12:38:33 -0000
Subject: [antlr-interest] Scratch That Last Post.
In-Reply-To: <4888.1171070821@prosync.com>
References: <4888.1171070821@prosync.com>
Message-ID: <002101c74d10$6093c160$21bb4420$@hill@blueyonder.co.uk>

15 hours? Lightweight!

 

;)

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of
gilbert.williams at prosync.com
Sent: 10 February 2007 01:27
To: antlr-interest at antlr.org
Subject: [antlr-interest] Scratch That Last Post.

 


Just working too long on that one.  It was _my_ typo.

( looks like { after 15 hrs.

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070210/4c9112f9/attachment-0001.html 

From antlr at mirality.co.nz  Sat Feb 10 13:01:01 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 11 Feb 2007 10:01:01 +1300
Subject: [antlr-interest] ANTLR 3.0 "feature"
Message-ID: <7.0.1.0.0.20070211095728.0350bd18@mirality.co.nz>

At 09:38 11/02/2007, Gilbert Williams wrote:
>ere_dupl_symbol    : '*'{prn("ere_dupl_symbol found:"+$text);}
>                    | '+'{prn("ere_dupl_symbol found:"+$text);}
>                    | '?'{prn("ere_dupl_symbol found:"+$text);}
>                    | '{' dup_count ',' dup_count 
> '}'{prn("ere_dupl_symbol found:"+$text);}
>                    | '{' dup_count 
> ','           '}'{prn("ere_dupl_symbol found:"+$text);}
>                    | '{' 
> dup_count               '}'{prn("ere_dupl_symbol found:"+$text);}

If you're going to be doing similar actions for those last three 
alts, then I would write it as a single alt like so:

| '{' dup_count (',' dup_count?)? '}' { prn(...); }

Doesn't really make a lot of difference, though.  I think :)


From parrt at cs.usfca.edu  Sat Feb 10 16:08:49 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 10 Feb 2007 16:08:49 -0800
Subject: [antlr-interest] updated antlr3 ANT task
Message-ID: <E11E1FE0-EB3E-4260-A824-2D2EA70743D8@cs.usfca.edu>

Hi. Juergen Pfundt has updated his antlr3 ANT task.

http://www.antlr.org/share/1169924912745/antlr3-task.zip
Changes:


?       Adapted the grammar type recognition to the changed naming  
conventions for tree parsers.

?       Compiled the antlr3 taks with -source 5 for compatibility  
with Java 5.

?       Dropped -trace, -tracelexer and traceparser as it is not  
supported by antlr any more.

?       Added project "SimpleTreeWalker" as an example for a multi  
grammar project.


Ter

From omry at yadan.net  Sun Feb 11 00:15:25 2007
From: omry at yadan.net (Omry Yadan)
Date: Sun, 11 Feb 2007 10:15:25 +0200
Subject: [antlr-interest] literals in 2.7.6
In-Reply-To: <eqg04g$u29$1@sea.gmane.org>
References: <45CB33C5.5010003@yadan.net> <45CB3A4D.7010402@yadan.net>
	<eqg04g$u29$1@sea.gmane.org>
Message-ID: <45CED09D.3080308@yadan.net>

It worked, thanks.

here is a complete example, for future newbies:

-----------------------------Grammar 
----------------------------------------------

class FooLexer extends Lexer;
options
{
    testLiterals=false;   
}

// skip whitespaces
WS : ( ' ' | '\t' ) { $setType(Token.SKIP); };

protected CHAR : ('a'..'z' | 'A'..'Z');
protected DIGIT : ('0'..'9');

// a classic definition of an identifier.
IDENTIFIER  options{testLiterals=true;} : CHAR (CHAR|DIGIT)*;

class FooParser extends Parser;
options
{
    // build AST to allow post parse analysis
    buildAST=true;
}

// keywords be here
keyword : "keyword1" | "keyword2" | "keyword3";

// just a line with keywords and identifiers
line : (keyword | IDENTIFIER)*;


------------------------------------------------------------------------


------------------------Tester -----------------------------------------

public class TestLexer
{
    public static void main(String[] args) throws TokenStreamException, 
RecognitionException
    {
        String str = "str1 keyword1 str2 keyword2";
        FooLexer lex = new FooLexer(new StringReader(str));
        FooParser parse = new FooParser(lex);
        parse.line();
        CommonAST ast = (CommonAST)parse.getAST();
        DumpASTVisitor visitor = new DumpASTVisitor();
        visitor.visit(ast);
    }
}

------------------------------------------------------------------------

Xue Yong Zhi wrote:

> You do not have to list RESERVED as a rule, just use it as a string in 
> the parser.


From mail at ghost23.de  Sun Feb 11 01:36:23 2007
From: mail at ghost23.de (Sven Busse)
Date: Sun, 11 Feb 2007 10:36:23 +0100
Subject: [antlr-interest] expecting "class", found 'class'
Message-ID: <000001c74dc0$188e0a50$9231fea9@Werkbank>

Hi,

i am very new to antlr. I am using antlr 2.7.7.

I have a parser rule like this (i am using the c# version):

startRule
	:	"class" cl:IDENT 
		{Console.WriteLine("classname: "+cl.getText());}
	;

IDENT is my Lexer rule:

IDENT
	:	('a'..'z'|'A'..'Z'|'_'|'$')
('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
	;

But running the stuff with an example text, i allways get this error
message:

line 4:1: expecting "class", found 'class'

Can someone explain that to me?

Thank you


From hwk.cortex-brainware at t-online.de  Sun Feb 11 03:14:24 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Sun, 11 Feb 2007 12:14:24 +0100
Subject: [antlr-interest] Problem using predicates in V3
Message-ID: <05c001c74dcd$c9ad9820$0a0012c6@kocher>

I have a combined grammar that has the normal identifier definition in the
lexer.

 

fragment DIGIT  :    '0'..'9';

 

fragment LETTER :    ('a'..'z'|'A'..'Z');

 

INT :    DIGIT+;

 

ID   :    ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

 

Now I have a keyword ?abc? that?s used in the parser grammar like so:

 

test : ?abc? INT?;

 

The rule ?test? should match input ?abc?, ?abc 2?, and ?abc2?.

 

Unfortunately, the latter matches ID as well. Now, I?m trying to force ANTLR
to parse ?abc2? as two tokens ?abc? and INT.

 

When I change ID to use a predicate, the predicate is called but the lexer
still emits an ID token


 

ID   :    ('srg' DIGIT) => 'srg' | ('a'..'z'|'A'..'Z')
('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

 

What is the best approach to parse this? (I have more such combinations such
as ?abd? or ?add? 
).

 

Any ideas?

 

Thanks

 

Dr. Hartmut Kocher

Cortex Brainware Consulting & Training GmbH

Kirchplatz 5
D-82049 Pullach

Tel: +49 (89) 744  850 0
Fax: +49 (89) 744  850 11

 <http://www.cortex-brainware.de/> http://www.cortex-brainware.de

E-Mail: hwk at cortex-brainware.de

Handelsregister:
Registergericht: Amtsgericht M?nchen
HRB-Nr. 120614

Vertretungsberechtigte Gesch?ftsf?hrer:
Dipl.-Inform. Dorothea Burger, Dr.-Ing. Hartmut Kocher, Dr.-Ing. Martin
Lang, Dr. rer. nat. Rolf Peter Wehrum 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070211/93577300/attachment.html 

From ric.klaren at gmail.com  Sun Feb 11 03:15:36 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Sun, 11 Feb 2007 12:15:36 +0100
Subject: [antlr-interest] expecting "class", found 'class'
In-Reply-To: <000001c74dc0$188e0a50$9231fea9@Werkbank>
References: <000001c74dc0$188e0a50$9231fea9@Werkbank>
Message-ID: <bc607a4e0702110315x1af2f065qb4d2c8288b823828@mail.gmail.com>

Hi,

On 2/11/07, Sven Busse <mail at ghost23.de> wrote:
> i am very new to antlr. I am using antlr 2.7.7.
>
> I have a parser rule like this (i am using the c# version):
>
> startRule
>         :       "class" cl:IDENT
>                 {Console.WriteLine("classname: "+cl.getText());}
>         ;
>
> IDENT is my Lexer rule:
>
> IDENT
>         :       ('a'..'z'|'A'..'Z'|'_'|'$')
> ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
>         ;
>
> But running the stuff with an example text, i allways get this error
> message:
>
> line 4:1: expecting "class", found 'class'
>
> Can someone explain that to me?

The ident rule gobbles up the 'class' key word, think you have to turn
the testLiterals = yes option on the IDENT rule. Just look at the docs
for testLiterals (or an example like the java grammar)

Cheers,

Ric

From mail at ghost23.de  Sun Feb 11 04:13:01 2007
From: mail at ghost23.de (Sven Busse)
Date: Sun, 11 Feb 2007 13:13:01 +0100
Subject: [antlr-interest] expecting "class", found 'class'
In-Reply-To: <bc607a4e0702110315x1af2f065qb4d2c8288b823828@mail.gmail.com>
References: <000001c74dc0$188e0a50$9231fea9@Werkbank>
	<bc607a4e0702110315x1af2f065qb4d2c8288b823828@mail.gmail.com>
Message-ID: <000001c74dd5$f9e92f10$9231fea9@Werkbank>

Hi,

i tried this already with the testLiterals option, but it
doesn't change anything :(
Also, i read, that if you don't set any option, then
testLiterals would be true by default.


-----Urspr?ngliche Nachricht-----
Von: Ric Klaren [mailto:ric.klaren at gmail.com] 
Gesendet: Sonntag, 11. Februar 2007 12:16
An: Sven Busse
Cc: antlr-interest at antlr.org
Betreff: Re: [antlr-interest] expecting "class", found 'class'

Hi,

On 2/11/07, Sven Busse <mail at ghost23.de> wrote:
> i am very new to antlr. I am using antlr 2.7.7.
>
> I have a parser rule like this (i am using the c# version):
>
> startRule
>         :       "class" cl:IDENT
>                 {Console.WriteLine("classname: "+cl.getText());}
>         ;
>
> IDENT is my Lexer rule:
>
> IDENT
>         :       ('a'..'z'|'A'..'Z'|'_'|'$')
> ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
>         ;
>
> But running the stuff with an example text, i allways get this error
> message:
>
> line 4:1: expecting "class", found 'class'
>
> Can someone explain that to me?

The ident rule gobbles up the 'class' key word, think you have to turn
the testLiterals = yes option on the IDENT rule. Just look at the docs
for testLiterals (or an example like the java grammar)

Cheers,

Ric


From ric.klaren at gmail.com  Sun Feb 11 05:49:37 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Sun, 11 Feb 2007 14:49:37 +0100
Subject: [antlr-interest] expecting "class", found 'class'
In-Reply-To: <000001c74dd5$f9e92f10$9231fea9@Werkbank>
References: <000001c74dc0$188e0a50$9231fea9@Werkbank>
	<bc607a4e0702110315x1af2f065qb4d2c8288b823828@mail.gmail.com>
	<000001c74dd5$f9e92f10$9231fea9@Werkbank>
Message-ID: <bc607a4e0702110549i3528fab3t496260e3315e248d@mail.gmail.com>

Hi,

On 2/11/07, Sven Busse <mail at ghost23.de> wrote:
> i tried this already with the testLiterals option, but it
> doesn't change anything :(
> Also, i read, that if you don't set any option, then
> testLiterals would be true by default.

Do you have lexer and parser in one file? If not then it might be that
there's something out of sync with the token definitions. You can
double check this by looking at the *TokenTypes.txt files generated.
Also genreating the lexer with the -traceLexer could be helpfull.

Cheers,

Ric

From matthias.gutheil at informatik.uni-mannheim.de  Sun Feb 11 05:54:54 2007
From: matthias.gutheil at informatik.uni-mannheim.de (Matthias Gutheil)
Date: Sun, 11 Feb 2007 14:54:54 +0100
Subject: [antlr-interest] Why is that part needed?
In-Reply-To: <eqi89v$rnn$1@sea.gmane.org>
References: <141D986BB4749448AB843778A4DD236B07EB259D@kormail02.in.bosch.com>
	<eqi89v$rnn$1@sea.gmane.org>
Message-ID: <45CF202E.8050804@informatik.uni-mannheim.de>

Hello,

in my expr rule, I need that (IDENT COLON) part, otherwise my parser 
doesn't behave like a want.
I tested it with a System.out, but the (IDENT COLON) part is not in one 
of my examples.

At the end of the mql rule I test if there comes a next token and store 
the position, so I can find the beginning position of the rest.

Everything works fine, but why only with that (IDENT COLON) part?

Matthias

expr :    
   (mql | (IDENT COLON)) rest?    
    EOF
;


IDENT        
   :  
           ('a'..'z'|'A'..'Z'|'_'|'0'..'9'| STAR | DOLLAR | (LBRACK 
RBRACK))+      
  ;

rest     :
    (.)*
 ;

From mail at ghost23.de  Sun Feb 11 08:10:45 2007
From: mail at ghost23.de (Sven Busse)
Date: Sun, 11 Feb 2007 17:10:45 +0100
Subject: [antlr-interest] expecting "class", found 'class'
In-Reply-To: <bc607a4e0702110549i3528fab3t496260e3315e248d@mail.gmail.com>
References: <000001c74dc0$188e0a50$9231fea9@Werkbank>
	<bc607a4e0702110315x1af2f065qb4d2c8288b823828@mail.gmail.com>
	<000001c74dd5$f9e92f10$9231fea9@Werkbank>
	<bc607a4e0702110549i3528fab3t496260e3315e248d@mail.gmail.com>
Message-ID: <000b01c74df7$2fbfd370$9231fea9@Werkbank>

Hi,

i have lexer and parser in one file. Using the
traceLexer or traceParser didn't help me.

What does this message mean anyway?

-----Urspr?ngliche Nachricht-----
Von: Ric Klaren [mailto:ric.klaren at gmail.com] 
Gesendet: Sonntag, 11. Februar 2007 14:50
An: Sven Busse
Cc: antlr-interest at antlr.org
Betreff: Re: [antlr-interest] expecting "class", found 'class'

Hi,

On 2/11/07, Sven Busse <mail at ghost23.de> wrote:
> i tried this already with the testLiterals option, but it
> doesn't change anything :(
> Also, i read, that if you don't set any option, then
> testLiterals would be true by default.

Do you have lexer and parser in one file? If not then it might be that
there's something out of sync with the token definitions. You can
double check this by looking at the *TokenTypes.txt files generated.
Also genreating the lexer with the -traceLexer could be helpfull.

Cheers,

Ric


From parrt at cs.usfca.edu  Sun Feb 11 11:33:54 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 11 Feb 2007 11:33:54 -0800
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <05c001c74dcd$c9ad9820$0a0012c6@kocher>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher>
Message-ID: <D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu>


On Feb 11, 2007, at 3:14 AM, Dr. Hartmut Kocher wrote:

> I have a combined grammar that has the normal identifier definition  
> in the lexer.
>
>
>
> fragment DIGIT  :    '0'..'9';
>
>
>
> fragment LETTER :    ('a'..'z'|'A'..'Z');
>
>
>
> INT :    DIGIT+;
>
>
>
> ID   :    ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;
>
>
>
> Now I have a keyword ?abc? that?s used in the parser grammar like so:
>
>
>
> test : ?abc? INT?;
>
>
>
> The rule ?test? should match input ?abc?, ?abc 2?, and ?abc2?.
>
>
>
> Unfortunately, the latter matches ID as well. Now, I?m trying to  
> force ANTLR to parse ?abc2? as two tokens ?abc? and INT.

hi.
Then you have an ambiguity.  abc2 matches ID.  Take 0..9 out of ID.

Ter

From hwk.cortex-brainware at t-online.de  Sun Feb 11 12:26:46 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Sun, 11 Feb 2007 21:26:46 +0100
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher>
	<D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu>
Message-ID: <062201c74e1a$f3c66450$0a0012c6@kocher>

I know that this is ambiguous. That's why I tried to solve it with a
predicate. I need both definitions. In other places in the grammar I have
identifiers like "t123a". Still 'abc' must always be parsed as 'abc' never
as identifier. That means 'abc2' must be parsed as 'abc' INT even though it
matches the definition of the ID token.

So I need to force the lexer to never parse 'abc' as ID.

Any ideas?

Dr. Hartmut Kocher
Cortex Brainware Consulting & Training GmbH
Kirchplatz 5
D-82049 Pullach

Tel: +49 (89) 744  850 0
Fax: +49 (89) 744  850 11

http://www.cortex-brainware.de
E-Mail: hwk at cortex-brainware.de
Handelsregister:
Registergericht: Amtsgericht M?nchen
HRB-Nr. 120614

Vertretungsberechtigte Gesch?ftsf?hrer:
Dipl.-Inform. Dorothea Burger, Dr.-Ing. Hartmut Kocher, Dr.-Ing. Martin
Lang, Dr. rer. nat. Rolf Peter Wehrum  
-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Terence Parr
Gesendet: Sonntag, 11. Februar 2007 20:34
An: ANTLR Interest
Betreff: Re: [antlr-interest] Problem using predicates in V3


On Feb 11, 2007, at 3:14 AM, Dr. Hartmut Kocher wrote:

> I have a combined grammar that has the normal identifier definition  
> in the lexer.
>
>
>
> fragment DIGIT  :    '0'..'9';
>
>
>
> fragment LETTER :    ('a'..'z'|'A'..'Z');
>
>
>
> INT :    DIGIT+;
>
>
>
> ID   :    ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;
>
>
>
> Now I have a keyword ?abc? that?s used in the parser grammar like so:
>
>
>
> test : ?abc? INT?;
>
>
>
> The rule ?test? should match input ?abc?, ?abc 2?, and ?abc2?.
>
>
>
> Unfortunately, the latter matches ID as well. Now, I?m trying to  
> force ANTLR to parse ?abc2? as two tokens ?abc? and INT.

hi.
Then you have an ambiguity.  abc2 matches ID.  Take 0..9 out of ID.

Ter



From parrt at cs.usfca.edu  Sun Feb 11 12:38:55 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 11 Feb 2007 12:38:55 -0800
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <062201c74e1a$f3c66450$0a0012c6@kocher>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher>
	<D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu>
	<062201c74e1a$f3c66450$0a0012c6@kocher>
Message-ID: <B1841FD8-CA29-4C9B-A6C5-9B6D6676DBEC@cs.usfca.edu>


On Feb 11, 2007, at 12:26 PM, Dr. Hartmut Kocher wrote:

> I know that this is ambiguous. That's why I tried to solve it with a
> predicate. I need both definitions. In other places in the grammar  
> I have
> identifiers like "t123a". Still 'abc' must always be parsed as  
> 'abc' never
> as identifier. That means 'abc2' must be parsed as 'abc' INT even  
> though it
> matches the definition of the ID token.
>
> So I need to force the lexer to never parse 'abc' as ID.

Oh, you have a context-sensitivity problem.  First thing.  Try not to  
do that.  Either redesign your language or send hate mail to the  
designer. ;)  Now, it might be a simple problem.  Just match ID w/o  
digits and then put back together later using the context from the  
parser.

identifierInSomeCase : IDENT INT? {put backtogether} ;

Ter


From hwk.cortex-brainware at t-online.de  Sun Feb 11 13:15:32 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Sun, 11 Feb 2007 22:15:32 +0100
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <B1841FD8-CA29-4C9B-A6C5-9B6D6676DBEC@cs.usfca.edu>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher><D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu><062201c74e1a$f3c66450$0a0012c6@kocher>
	<B1841FD8-CA29-4C9B-A6C5-9B6D6676DBEC@cs.usfca.edu>
Message-ID: <062c01c74e21$c3e090b0$0a0012c6@kocher>

The language is fixed :-( And no, I didn't invent it.

Your second solution is also not possible because then "t123a" would parse
OK, but "t 123 a" too, which is not allowed. (Of course there's a whitespace
rule)...

In ANTLR2 I did the following:

tokens {
"abc";
}

IDENT  
   options { 
     testLiterals=true; 
   }
  :     
    ("abc" DIGIT) => "abc"  
  | ('a'..'z') (LD | '_')*;  // LD is letter or digit

This worked quite well. Now I'm trying to accomplish the same with ANTLR 3.
No such luck so far.

Hartmut

-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Terence Parr
Gesendet: Sonntag, 11. Februar 2007 21:39
An: ANTLR Interest
Betreff: Re: [antlr-interest] Problem using predicates in V3


On Feb 11, 2007, at 12:26 PM, Dr. Hartmut Kocher wrote:

> I know that this is ambiguous. That's why I tried to solve it with a
> predicate. I need both definitions. In other places in the grammar  
> I have
> identifiers like "t123a". Still 'abc' must always be parsed as  
> 'abc' never
> as identifier. That means 'abc2' must be parsed as 'abc' INT even  
> though it
> matches the definition of the ID token.
>
> So I need to force the lexer to never parse 'abc' as ID.

Oh, you have a context-sensitivity problem.  First thing.  Try not to  
do that.  Either redesign your language or send hate mail to the  
designer. ;)  Now, it might be a simple problem.  Just match ID w/o  
digits and then put back together later using the context from the  
parser.

identifierInSomeCase : IDENT INT? {put backtogether} ;

Ter




From parrt at cs.usfca.edu  Sun Feb 11 13:24:10 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 11 Feb 2007 13:24:10 -0800
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <062c01c74e21$c3e090b0$0a0012c6@kocher>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher><D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu><062201c74e1a$f3c66450$0a0012c6@kocher>
	<B1841FD8-CA29-4C9B-A6C5-9B6D6676DBEC@cs.usfca.edu>
	<062c01c74e21$c3e090b0$0a0012c6@kocher>
Message-ID: <9B6BF07A-F1DD-4AED-A01F-95DE124DA581@cs.usfca.edu>


On Feb 11, 2007, at 1:15 PM, Dr. Hartmut Kocher wrote:

> The language is fixed :-( And no, I didn't invent it.

;)

> Your second solution is also not possible because then "t123a"  
> would parse
> OK, but "t 123 a" too, which is not allowed. (Of course there's a  
> whitespace
> rule)...

actually, it would only match "t 123" as part of tha rule, but no  
biggie.

> In ANTLR2 I did the following:
>
> tokens {
> "abc";
> }
>
> IDENT
>    options {
>      testLiterals=true;
>    }
>   :
>     ("abc" DIGIT) => "abc"
>   | ('a'..'z') (LD | '_')*;  // LD is letter or digit
>
> This worked quite well. Now I'm trying to accomplish the same with  
> ANTLR 3.
> No such luck so far.

OHhhhhh....ok, abc is a keyword and for some reason it's not taken as  
a special case; oh, because antlr matches longest it can.

IDENT : ("abc" DIGIT)=> "abc" | ('a'..'z') (LD | '_')* ;

should work.  It doesn't?

Ter

From hwk.cortex-brainware at t-online.de  Sun Feb 11 13:38:39 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Sun, 11 Feb 2007 22:38:39 +0100
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <9B6BF07A-F1DD-4AED-A01F-95DE124DA581@cs.usfca.edu>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher><D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu><062201c74e1a$f3c66450$0a0012c6@kocher><B1841FD8-CA29-4C9B-A6C5-9B6D6676DBEC@cs.usfca.edu><062c01c74e21$c3e090b0$0a0012c6@kocher>
	<9B6BF07A-F1DD-4AED-A01F-95DE124DA581@cs.usfca.edu>
Message-ID: <063301c74e24$fecb1620$0a0012c6@kocher>


No it doesn't work. I appended the C# code (which ist he same for Java).

Here's the rule:

ID 	:	('abc' DIGIT) => 'abc' | ('a'..'z'|'A'..'Z')
('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

If you look at the code, you see that it correctly checks for the predicate.
It then matches the string, but this does not emit a token!
Instead it emits a token at the end of the ID rule, with type ID.

This is the part I don't understand, or where a bug might hide...

Hartmut


Here comes the code:

if ( (LA3_0 == 'a') )
            {
                int LA3_1 = input.LA(2);
                if ( (LA3_1 == 'b') )
                {
                    int LA3_3 = input.LA(3);
                    if ( (LA3_3 == 'c') )
                    {
                        if ( (synpred1()) )
                        {
                            alt3 = 1;
                        }

This matches the predicate. => alt3 = 1.

Now the rule is processed:

switch (alt3) 
            {
                case 1 :
                    // Test.g:30:7: ( 'abc' DIGIT )=> 'abc'
                    {
                    	Match("abc"); if (failed) return ;

                    
                    }
                    break;

This matches the string, but does not set the token type.

Then the token is created:

if ( backtracking == 0 ) 
            {
              
                      if ( (token == null) && (ruleNestingLevel == 1) )
                      {
                          Emit(_type, _line, _charPosition, _channel,
_start, CharIndex-1);
                      }
              
                      
            }    }

Which is "abc" but of type ID!!!

Hope this helps.


-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Terence Parr
Gesendet: Sonntag, 11. Februar 2007 22:24
An: ANTLR Interest
Betreff: Re: [antlr-interest] Problem using predicates in V3


On Feb 11, 2007, at 1:15 PM, Dr. Hartmut Kocher wrote:

> The language is fixed :-( And no, I didn't invent it.

;)

> Your second solution is also not possible because then "t123a"  
> would parse
> OK, but "t 123 a" too, which is not allowed. (Of course there's a  
> whitespace
> rule)...

actually, it would only match "t 123" as part of tha rule, but no  
biggie.

> In ANTLR2 I did the following:
>
> tokens {
> "abc";
> }
>
> IDENT
>    options {
>      testLiterals=true;
>    }
>   :
>     ("abc" DIGIT) => "abc"
>   | ('a'..'z') (LD | '_')*;  // LD is letter or digit
>
> This worked quite well. Now I'm trying to accomplish the same with  
> ANTLR 3.
> No such luck so far.

OHhhhhh....ok, abc is a keyword and for some reason it's not taken as  
a special case; oh, because antlr matches longest it can.

IDENT : ("abc" DIGIT)=> "abc" | ('a'..'z') (LD | '_')* ;

should work.  It doesn't?

Ter



From parrt at cs.usfca.edu  Sun Feb 11 13:46:17 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 11 Feb 2007 13:46:17 -0800
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <063301c74e24$fecb1620$0a0012c6@kocher>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher><D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu><062201c74e1a$f3c66450$0a0012c6@kocher><B1841FD8-CA29-4C9B-A6C5-9B6D6676DBEC@cs.usfca.edu><062c01c74e21$c3e090b0$0a0012c6@kocher>
	<9B6BF07A-F1DD-4AED-A01F-95DE124DA581@cs.usfca.edu>
	<063301c74e24$fecb1620$0a0012c6@kocher>
Message-ID: <3DB8F7AC-D6E2-4A2B-8444-B0BB99F895B4@cs.usfca.edu>


On Feb 11, 2007, at 1:38 PM, Dr. Hartmut Kocher wrote:

>
> No it doesn't work. I appended the C# code (which ist he same for  
> Java).
>
> Here's the rule:
>
> ID 	:	('abc' DIGIT) => 'abc' | ('a'..'z'|'A'..'Z')
> ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;
>
> If you look at the code, you see that it correctly checks for the  
> predicate.
> It then matches the string, but this does not emit a token!
> Instead it emits a token at the end of the ID rule, with type ID.
>
> This is the part I don't understand, or where a bug might hide...

Oh, i think you have to set the type.  $type = ABC_KEYWORD;  ID is  
just matching stuff and yep, it matches.  It has no idea you mean it  
to be the keyword.  This was a quirk of v2 that it tested every token  
against the literals table.

Ter

From hwk.cortex-brainware at t-online.de  Sun Feb 11 13:46:11 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Sun, 11 Feb 2007 22:46:11 +0100
Subject: [antlr-interest] Problem using predicates in V3
In-Reply-To: <063301c74e24$fecb1620$0a0012c6@kocher>
References: <05c001c74dcd$c9ad9820$0a0012c6@kocher><D44C65F4-7CA8-4001-8C5F-34E33C231E0A@cs.usfca.edu><062201c74e1a$f3c66450$0a0012c6@kocher><B1841FD8-CA29-4C9B-A6C5-9B6D6676DBEC@cs.usfca.edu><062c01c74e21$c3e090b0$0a0012c6@kocher><9B6BF07A-F1DD-4AED-A01F-95DE124DA581@cs.usfca.edu>
	<063301c74e24$fecb1620$0a0012c6@kocher>
Message-ID: <063401c74e26$0bd794f0$0a0012c6@kocher>

One more:

If I change the following:

tokens{
ABC = 'abc';
}

ID 	:	('abc' DIGIT) => 'abc' {$type=ABC;} | ('a'..'z'|'A'..'Z')
('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

Then it works as expected (because I set the token type manually...).

Kind regards

Hartmut

-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Dr. Hartmut Kocher
Gesendet: Sonntag, 11. Februar 2007 22:39
An: 'Terence Parr'; 'ANTLR Interest'
Betreff: Re: [antlr-interest] Problem using predicates in V3


No it doesn't work. I appended the C# code (which ist he same for Java).

Here's the rule:

ID 	:	('abc' DIGIT) => 'abc' | ('a'..'z'|'A'..'Z')
('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

If you look at the code, you see that it correctly checks for the predicate.
It then matches the string, but this does not emit a token!
Instead it emits a token at the end of the ID rule, with type ID.

This is the part I don't understand, or where a bug might hide...

Hartmut


Here comes the code:

if ( (LA3_0 == 'a') )
            {
                int LA3_1 = input.LA(2);
                if ( (LA3_1 == 'b') )
                {
                    int LA3_3 = input.LA(3);
                    if ( (LA3_3 == 'c') )
                    {
                        if ( (synpred1()) )
                        {
                            alt3 = 1;
                        }

This matches the predicate. => alt3 = 1.

Now the rule is processed:

switch (alt3) 
            {
                case 1 :
                    // Test.g:30:7: ( 'abc' DIGIT )=> 'abc'
                    {
                    	Match("abc"); if (failed) return ;

                    
                    }
                    break;

This matches the string, but does not set the token type.

Then the token is created:

if ( backtracking == 0 ) 
            {
              
                      if ( (token == null) && (ruleNestingLevel == 1) )
                      {
                          Emit(_type, _line, _charPosition, _channel,
_start, CharIndex-1);
                      }
              
                      
            }    }

Which is "abc" but of type ID!!!

Hope this helps.


-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Terence Parr
Gesendet: Sonntag, 11. Februar 2007 22:24
An: ANTLR Interest
Betreff: Re: [antlr-interest] Problem using predicates in V3


On Feb 11, 2007, at 1:15 PM, Dr. Hartmut Kocher wrote:

> The language is fixed :-( And no, I didn't invent it.

;)

> Your second solution is also not possible because then "t123a"  
> would parse
> OK, but "t 123 a" too, which is not allowed. (Of course there's a  
> whitespace
> rule)...

actually, it would only match "t 123" as part of tha rule, but no  
biggie.

> In ANTLR2 I did the following:
>
> tokens {
> "abc";
> }
>
> IDENT
>    options {
>      testLiterals=true;
>    }
>   :
>     ("abc" DIGIT) => "abc"
>   | ('a'..'z') (LD | '_')*;  // LD is letter or digit
>
> This worked quite well. Now I'm trying to accomplish the same with  
> ANTLR 3.
> No such luck so far.

OHhhhhh....ok, abc is a keyword and for some reason it's not taken as  
a special case; oh, because antlr matches longest it can.

IDENT : ("abc" DIGIT)=> "abc" | ('a'..'z') (LD | '_')* ;

should work.  It doesn't?

Ter





From parrt at cs.usfca.edu  Sun Feb 11 14:19:51 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 11 Feb 2007 14:19:51 -0800
Subject: [antlr-interest] added new -depend option
Message-ID: <4FC1BE59-7E1E-4A76-AF61-11B89D6BA829@cs.usfca.edu>

Hi,

We've been arguing about file extensions on antlr-dev.  I've decided  
that the file extensions can't say enough due to dependencies on  
token files etc... so only .g will be used.  To help build tools, I  
built a -depend option at Ric Klaren's suggestion.  It just lists the  
make-compatible dependencies to stdout.  You can change the template  
to gen what you want though.  Also available as an API. :)

Note this ain't exactly cheap to execute as it has to do a lot of  
normal ANTLR processing to answer these dependency questions.

Here are my notes from the readme:

* Added -depend command-line option that, instead of processing files,
   it shows you what files the input grammar(s) depend on and what files
   they generate. For combined grammar T.g:

   $ java org.antlr.Tool -depend T.g

   You get:

   TParser.java : T.g
   T.tokens : T.g
   T__.g : T.g

   Now, assuming U.g is a tree grammar ref'd T's tokens:

   $ java org.antlr.Tool -depend T.g U.g

   TParser.java : T.g
   T.tokens : T.g
   T__.g : T.g
   U.g: T.tokens
   U.java : U.g
   U.tokens : U.g

   Handles spaces by escaping them.  Pays attention to -o, -fo and -lib.
   Dir 'x y' is a valid dir in current dir.

   $ java org.antlr.Tool -depend -lib /usr/local/lib -o 'x y' T.g U.g
   x\ y/TParser.java : T.g
   x\ y/T.tokens : T.g
   x\ y/T__.g : T.g
   U.g: /usr/local/lib/T.tokens
   x\ y/U.java : U.g
   x\ y/U.tokens : U.g

   You have API access via org.antlr.tool.BuildDependencyGenerator  
class:
   getGeneratedFileList(), getDependenciesFileList().  You can also  
access
   the output template: getDependencies().  The file
   org/antlr/tool/templates/depend.stg contains the template.  You can
   modify as you want.  File objects go in so you can play with path  
etc...

Ter

From gbr at newtechlaw.com  Sun Feb 11 22:49:46 2007
From: gbr at newtechlaw.com (Gerald B. Rosenberg)
Date: Sun, 11 Feb 2007 22:49:46 -0800
Subject: [antlr-interest] Is there a way to separately categorize known HTML
 and unknown XML tags in the lexer?
Message-ID: <200702120649.l1C6npEC006134@morpho.newtechlaw.com>

Antlr 3.0b6

Trying to process a defined set of HTML tags while treating any other 
XML tags encountered as "just text".  Categorizing the known HTML tag 
types in the lexer seems cleaner, but requires some kind of catchall 
for the unknown category of XML tags.

Any way to do this, or do I have to push it all up into the parser?

Thanks,
Gerald

XML_TYPE
:  catchall for all tag types that are not a known BLOCK_TYPE OR SIMPLE_TYPE...
;

BLOCK_TYPE
: ( 'html'
| 'head'
| 'body'
| 'p'
| 'a'
...
| 'th'
| 'td' ){ if (debug) System.out.print("Block  "); }
;

SIMPLE_TYPE
: ( 'br'
| 'hr'
| 'col'){ if (debug) System.out.print("Simple "); }
;

----
Gerald B. Rosenberg, Esq.
NewTechLaw
285 Hamilton Avenue, Suite 520
Palo Alto, CA  94301-2576

650.325.2100  (office)  /  650.703.1724  (cell)
650.325.2107  (fax)

www.newtechlaw.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070211/851ad0e9/attachment.html 

From omry at yadan.net  Mon Feb 12 00:40:29 2007
From: omry at yadan.net (Omry Yadan)
Date: Mon, 12 Feb 2007 10:40:29 +0200
Subject: [antlr-interest] Newbie : resolving ambiguity between "number" and
	"string"
Message-ID: <45D027FD.2070604@yadan.net>

Hi,

I am trying to get my grammar (2.7.6)  to match the following :
12.3 : Number.
"12.3" : Number.
"abc" : String

I tried the following:
protected DOT : '.';
protected NUM : (DIGIT)+ ((DOT)(DIGIT)+)?;
NUMBER : NUM | "\""! NUM "\""!;
STRING : "\""! (~'"')* "\""!;

but as expected there is an ambiguity between string and number.
how can I express that the content of the a string may not be a NUMBER?

    Thanks,
       Omry.

From e.papegaaij at student.utwente.nl  Mon Feb 12 01:32:22 2007
From: e.papegaaij at student.utwente.nl (Emond Papegaaij)
Date: Mon, 12 Feb 2007 10:32:22 +0100
Subject: [antlr-interest] added new -depend option
In-Reply-To: <4FC1BE59-7E1E-4A76-AF61-11B89D6BA829@cs.usfca.edu>
References: <4FC1BE59-7E1E-4A76-AF61-11B89D6BA829@cs.usfca.edu>
Message-ID: <200702121032.22255.e.papegaaij@student.utwente.nl>

On Sunday 11 February 2007 23:19:51 Terence Parr wrote:
<cut great -depend feature>
> * Added -depend command-line option that, instead of processing files,
>    it shows you what files the input grammar(s) depend on and what files
>    they generate. For combined grammar T.g:
>
>    $ java org.antlr.Tool -depend T.g
>
>    You get:
>
>    TParser.java : T.g
>    T.tokens : T.g
>    T__.g : T.g

What about TLexer.java?

Best regards,
Emond


From omry at yadan.net  Mon Feb 12 07:44:25 2007
From: omry at yadan.net (Omry Yadan)
Date: Mon, 12 Feb 2007 17:44:25 +0200
Subject: [antlr-interest] Modifying lexer state from parser
Message-ID: <45D08B59.1000406@yadan.net>

Hi,

I want my lexer to start skipping whitespaces after a certain condition 
is met in the Parser.

what I am trying to do is to access the lexer and modify it when this 
condition is met.

something like this (note the magical $lexer.m_conditionMet which is 
just wishful thinking):


class L extends Lexer;
{
    boolean m_conditionMet= false;
}


WS
  : ( ' '
    | '\t'
    )
    { if (m_conditionMet) $setType(Token.SKIP); };



class P extends Parser;


foo: bar{$lexer.m_conditionMet = true;}


Is that possible?


      Omry.

From zhixueyong at hotmail.com  Mon Feb 12 08:17:08 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Mon, 12 Feb 2007 11:17:08 -0500
Subject: [antlr-interest] Modifying lexer state from parser
In-Reply-To: <45D08B59.1000406@yadan.net>
References: <45D08B59.1000406@yadan.net>
Message-ID: <eqq3u5$of$1@sea.gmane.org>

Yes you can. But there is no such thing as '$lexer', just add a regular 
field youself.

> 
> what I am trying to do is to access the lexer and modify it when this 
> condition is met.
> 

> 
> foo: bar{$lexer.m_conditionMet = true;}
> 
> 
> Is that possible?
> 
> 
>      Omry.
> 


-- 
Xue Yong Zhi
XRuby (Ruby to Java bytecode compiler):
http://xruby.blogspot.com


From prashant.deva at gmail.com  Mon Feb 12 08:27:53 2007
From: prashant.deva at gmail.com (Prashant Deva)
Date: Mon, 12 Feb 2007 08:27:53 -0800
Subject: [antlr-interest] Modifying lexer state from parser
In-Reply-To: <45D08B59.1000406@yadan.net>
References: <45D08B59.1000406@yadan.net>
Message-ID: <41fed8f80702120827q2ca6590jc0dae94d0ba25fd6@mail.gmail.com>

Use the observer pattern.
Make an event in the parser and attach the lexer as a listener.

-- 
Prashant Deva
Creator, ANTLR Studio, Virtual Ant
Founder, Placid Systems, www.placidsystems.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070212/95744232/attachment.html 

From zhixueyong at hotmail.com  Mon Feb 12 08:23:37 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Mon, 12 Feb 2007 11:23:37 -0500
Subject: [antlr-interest] Newbie : resolving ambiguity between "number"
	and "string"
In-Reply-To: <45D027FD.2070604@yadan.net>
References: <45D027FD.2070604@yadan.net>
Message-ID: <45D09489.9050400@hotmail.com>

You can use antlr's 'Syntactic Predicates'. Or just accept "12.3" as 
String, then use semantic action to set it back to Number.

> 12.3 : Number.
> "12.3" : Number.
> "abc" : String
> 
> but as expected there is an ambiguity between string and number.
> how can I express that the content of the a string may not be a NUMBER?


-- 
Xue Yong Zhi
XRuby (Ruby to Java bytecode compiler):
http://xruby.blogspot.com


From ric.klaren at gmail.com  Mon Feb 12 08:40:07 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Mon, 12 Feb 2007 17:40:07 +0100
Subject: [antlr-interest] Modifying lexer state from parser
In-Reply-To: <45D08B59.1000406@yadan.net>
References: <45D08B59.1000406@yadan.net>
Message-ID: <bc607a4e0702120840g6c2ba183oe14ffee003ba376a@mail.gmail.com>

Hi,

On 2/12/07, Omry Yadan <omry at yadan.net> wrote:
> I want my lexer to start skipping whitespaces after a certain condition
> is met in the Parser.
>
> what I am trying to do is to access the lexer and modify it when this
> condition is met.
>
> something like this (note the magical $lexer.m_conditionMet which is
> just wishful thinking):

Yes you can (like Yue and Prashant said)....

But... in general you *really* have to know what you're doing. Because
generally speaking the lexer can be way ahead of the parser due to
guessing mode (syntactic predicates) which will lead to really strange
behaviour e.g. it will start skipping spaces in another spot than you
expect.

If you're parser is LL(1) and does not use syntactic predicates (the
'=>' operator) then it is safe (I think). If that is not the case then
it *might* be safe, but you really have to know how antlr generates
code and how your parser behaves on input.

Cheers,

Ric

From gilbert.williams at prosync.com  Mon Feb 12 08:52:48 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Mon, 12 Feb 2007 11:52:48 -0500
Subject: [antlr-interest] Language-specific Keyword/parser definitiion
	warning (Antlr3.0)
Message-ID: <001d01c74ec6$39eb6dd0$b982e6cd@tsitelsys.com>

Greetings:

 

I just built a grammar using Antlr 3.0b6 for Java with a token named "char",
which of course causes all sorts of compilation errors.

 

It would be useful to remind the user that this causes issues via a warning
message.

 

Thanks and have a great day!

 

Bert Williams.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070212/c9ca9330/attachment.html 

From omry at yadan.net  Mon Feb 12 08:59:56 2007
From: omry at yadan.net (Omry Yadan)
Date: Mon, 12 Feb 2007 18:59:56 +0200
Subject: [antlr-interest] Refactoring grammar
Message-ID: <45D09D0C.6050600@yadan.net>

here is a rule from my line parser.

the line parser identifies the type of the line, and also break it into 
components.

this part identifies the type of command this line represents, and keep 
the command text as a member:

command

    {String s = "";}
    :
    (
        "if" {m_type = TYPE_IF;m_text = "if";}|
        "ifdef" {m_type = TYPE_IFDEF;m_text="ifdef";}|
        "ifndef" {m_type = TYPE_IFNDEF;m_text="ifndef";}
    )
    s = cmd_args
    {
        m_text += s;
    };



is there a generic way to do it (I got about 8 more such rules) ?

I mean, something that will not require me to type each command twice.

I tried something like:


    (
        c:"if" {m_type = TYPE_IF;}|
        c:"ifdef" {m_type = TYPE_IFDEF;}|
        c:"ifndef" {m_type = TYPE_IFNDEF;}
    )
    {m_text=c.getText();}

But antlr complained that c is already defined (although the code it 
would have generated should have compiled fine).
any other ideas?


From gilbert.williams at prosync.com  Mon Feb 12 10:16:20 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Mon, 12 Feb 2007 13:16:20 -0500
Subject: [antlr-interest] ANTLR 3.0b6 Code Generation Issue
Message-ID: <000601c74ed1$e56ce980$b982e6cd@tsitelsys.com>

If I remove the comment at line 130 of the attached grammar file, ANTLR3.0b6
generates code with the following types of errors:

*	"eregexParser.java": LA12_2 is already defined in expression_term()
at line 1052, column 25 

The error does not occur if the line is commented out.

 

No ANTLR error is generated with either grammar.

 

What's causing this?  Is there a workaround?

 

Bert Williams.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070212/9f6ac73c/attachment-0001.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: eregex.g
Type: application/octet-stream
Size: 6449 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20070212/9f6ac73c/attachment-0001.obj 

From jimi at intersystems.com  Mon Feb 12 11:00:48 2007
From: jimi at intersystems.com (Jim Idle)
Date: Mon, 12 Feb 2007 14:00:48 -0500
Subject: [antlr-interest] ANTLR 3.0b6 Code Generation Issue
In-Reply-To: <000601c74ed1$e56ce980$b982e6cd@tsitelsys.com>
References: <000601c74ed1$e56ce980$b982e6cd@tsitelsys.com>
Message-ID: <20070212190050.4E196633@mail.intersystems.com>

While you may have stumbled on a code generation issue, there are a
couple of questions about your grammar:

 

Did you mean your grammar to read:

 

character_class :

                | CCE_ALNUM        

                | CCE_ALPHA  

...

 

Or:

 

character_class : CCE_ALNUM        

                | CCE_ALPHA  

...

 

Similarly:

 

end_range      : range_chars

                 character_class

               | collating_symbol

;               

 

Or

 

end_range      : range_chars

               | character_class

               | collating_symbol

;               

 

Also, it looks like this:

 

expression_term : end_range //single_expression

                | range_expression

                ;

 

range_expression : start_range end_range

                 | start_range '-'

                 ;

 

start_range      : end_range '-'

                 ;

 

Could possibly be just:

 

expression_term  : end_range ('-' (end_range)? )? ;

 

Use actions rather than ambiguous rules to decide what pieces you have?
That said You may be trying to achieve something different ;-)

 

Jim

 

 

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Bert Williams
Sent: Monday, February 12, 2007 10:16 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR 3.0b6 Code Generation Issue

 

If I remove the comment at line 130 of the attached grammar file,
ANTLR3.0b6 generates code with the following types of errors:

*	"eregexParser.java": LA12_2 is already defined in
expression_term() at line 1052, column 25 

The error does not occur if the line is commented out.

 

No ANTLR error is generated with either grammar.

 

What's causing this?  Is there a workaround?

 

Bert Williams.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070212/ec30cea5/attachment.html 

From vgusev at graphlogic.com  Mon Feb 12 17:31:25 2007
From: vgusev at graphlogic.com (vgusev at graphlogic.com)
Date: Mon, 12 Feb 2007 20:31:25 -0500 (EST)
Subject: [antlr-interest] antlr as a model for a language editor
Message-ID: <1751.75.37.238.254.1171330285.squirrel@webmail.graphlogic.com>

Hello,

I am writing an eclipse-based editor for a tiny domain language using
antlr. I do understand the basic editing eclipse technology. However, I am
trying to learn how to use antlr facility as the model for syntax
highlighting, completion etc. I have seen only some anectodal evidence of
the work done already in this field and would appreciate either the
pointers to the existing code or general design suggestions.

Thank you very much.

Vladimir


From Abhijit_Ghonge at infosys.com  Mon Feb 12 19:08:40 2007
From: Abhijit_Ghonge at infosys.com (Abhijit Nandkumar Ghonge)
Date: Tue, 13 Feb 2007 08:38:40 +0530
Subject: [antlr-interest] antlr as a model for a language editor
References: <1751.75.37.238.254.1171330285.squirrel@webmail.graphlogic.com>
Message-ID: <D72A054DF5002D4FA6CF14252F7997B8D97F0F@BLRKECMSG13.ad.infosys.com>


Hi,
	Read the DeveloperWorks tutorial: Creating Commercial Quality
IDEs on top of Eclipse. This is a good article to develop your IDE
plugin on Eclipse framework using Antlr for language recognition,
development of Abstract Syntax Tree and Document Object Model. Also it
gives a good insight into design details with some code snippets. Follow
the link:
http://www-128.ibm.com/developerworks/views/opensource/libraryview.jsp?s
earch_by=Create+commercial-quality+eclipse+ide

~abhijit.

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of
vgusev at graphlogic.com
Sent: Tuesday, February 13, 2007 7:01 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] antlr as a model for a language editor

Hello,

I am writing an eclipse-based editor for a tiny domain language using
antlr. I do understand the basic editing eclipse technology. However, I
am
trying to learn how to use antlr facility as the model for syntax
highlighting, completion etc. I have seen only some anectodal evidence
of
the work done already in this field and would appreciate either the
pointers to the existing code or general design suggestions.

Thank you very much.

Vladimir



**************** CAUTION - Disclaimer *****************
This e-mail contains PRIVILEGED AND CONFIDENTIAL INFORMATION intended solely for the use of the addressee(s). If you are not the intended recipient, please notify the sender by e-mail and delete the original message. Further, you are not to copy, disclose, or distribute this e-mail or its contents to any other person and any such actions are unlawful. This e-mail may contain viruses. Infosys has taken every reasonable precaution to minimize this risk, but is not liable for any damage you may sustain as a result of any virus in this e-mail. You should carry out your own virus checks before opening the e-mail or attachment. Infosys reserves the right to monitor and review the content of all messages sent to or from this e-mail address. Messages sent to or from this e-mail address may be stored on the Infosys e-mail system.
***INFOSYS******** End of Disclaimer ********INFOSYS***
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070213/9f7884cc/attachment.html 

From henryb at ntlworld.com  Tue Feb 13 07:31:44 2007
From: henryb at ntlworld.com (Henry Butowsky)
Date: Tue, 13 Feb 2007 15:31:44 +0000
Subject: [antlr-interest] Paraphrase (ing)
Message-ID: <45D1D9E0.2050903@ntlworld.com>

Hi Guys,
    I have the following Lexer rule  (cpp runtime)

// Return var or attribute (var_nm at att_nm) or function
VAR_ATT options {testLiterals=true; paraphrase="variable or attribute 
identifier"; }
        :  (LPH)(LPH|DGT)*  
            {// check function table
            if( prs_arg->ptr_sym_vtr->find($getText) !=NULL )
               $setType(FUNC);            
             else $setType(VAR_ID);
           }  
           ('@'(LPH)(LPH|DGT)*  {$setType(ATT_ID); })?
   ;

How do I a custom paraphrase for each of the types it may be ?
e.g if  VAR_ID    paraphrase="variable identifier"
          ATT_ID    paraphrase="attribute identifier"
         FUNC       paraphrase="function identifier"

Many thx
Regards Henry

From omry at yadan.net  Tue Feb 13 08:38:34 2007
From: omry at yadan.net (Omry Yadan)
Date: Tue, 13 Feb 2007 18:38:34 +0200
Subject: [antlr-interest] unexpected token: null
Message-ID: <45D1E98A.6080804@yadan.net>

Hi,

When I use StringReader() as the input stream, and the input incomplete, 
I get the warning: "unexpected token: null" printed to the console, and 
my AST is incomplete.

is there's an easy way to get a hard error when this happens (Exception) ?


Thanks,

    Omry.


From sfortma1 at swarthmore.edu  Tue Feb 13 13:15:27 2007
From: sfortma1 at swarthmore.edu (Scott Fortmann-Roe)
Date: Tue, 13 Feb 2007 16:15:27 -0500
Subject: [antlr-interest] Lexer Strangeness
Message-ID: <f18f141c0702131315h4dff5678jed36ead2bfc3ff3a@mail.gmail.com>

Hi,

I am having a small issue with matching line comments in the lexer.
The following code works correctly:

fragment NEWLINE
       :       '\r'|'\n'
;
LINECOMMENT
       :       '//' (~('\r'|'\n'))* NEWLINE {$channel=HIDDEN;}
;


But if I convert the line comment command to the following form ANTLR
complains that the start state cannot be found for the rule:

LINECOMMENT
       :       '//' (~(NEWLINE))* NEWLINE {$channel=HIDDEN;}
;

I am having a hard time seeing how these are functionally different.
I'm a noob though so please help.

Thanks, Scott

From hwk.cortex-brainware at t-online.de  Tue Feb 13 13:28:33 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Tue, 13 Feb 2007 22:28:33 +0100
Subject: [antlr-interest] Error in "rewriteTokenRef" template
Message-ID: <00e201c74fb5$ea4e8dc0$1601a8c0@kocher>

The following grammar triggers a 

?error(10):  internal error: Simple.g : java.util.NoSuchElementException: no
such attribute: args in template context [rewriteTokenRef]

?

rewriteTokenRef does not have an args parameter. But I couldn?t figure out,
how to fix it.

 

 

The rewrite rule -> ^(vars ID INT["1"])  triggers the error.

 

Any ideas?

 

Hartmut

 

 

grammar Simple;

 

options {

     language=Java;

     output=AST;

     ASTLabelType=CommonTree;

     }

 

 

t :

vars (

     'in' 'table' ID 

          ( '>' INT -> ^(vars ID INT)

          |               -> ^(vars ID INT["1"])  // The INT[?1?] triggers
the error

          )

);

 

vars : 'abc' | 'abd';

 

fragment DIGIT  :    '0'..'9';

 

 

INT :    DIGIT+;

 

 

ID   :    ('abc' DIGIT) => 'abc' {$type = ABC;} | ('a'..'z'|'A'..'Z')
('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

 

 

WS  :  (' '|'\r'|'\t'|'\f'|'\n')+ { $channel=HIDDEN; };

 

 

Dr. Hartmut Kocher

Cortex Brainware Consulting & Training GmbH

Kirchplatz 5
D-82049 Pullach

Tel: +49 (89) 744  850 0
Fax: +49 (89) 744  850 11

 <http://www.cortex-brainware.de/> http://www.cortex-brainware.de

E-Mail: hwk at cortex-brainware.de

Handelsregister:
Registergericht: Amtsgericht M?nchen
HRB-Nr. 120614

Vertretungsberechtigte Gesch?ftsf?hrer:
Dipl.-Inform. Dorothea Burger, Dr.-Ing. Hartmut Kocher, Dr.-Ing. Martin
Lang, Dr. rer. nat. Rolf Peter Wehrum 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070213/7513daea/attachment.html 

From Imran.AR at in.bosch.com  Tue Feb 13 19:37:03 2007
From: Imran.AR at in.bosch.com (Imran A R (RBIN/EMT2))
Date: Wed, 14 Feb 2007 09:07:03 +0530
Subject: [antlr-interest] Antlr for SunOS
Message-ID: <141D986BB4749448AB843778A4DD236B07FEF999@kormail02.in.bosch.com>

Hello all

	I have written an application in Java which uses Antlr for
parsing files, this app is in Windows.
	Now I want to bring same application to SunOs. Before that, I
have one question. Do we have
	Antlr for SunOS?  Thank you in Advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070214/b9080099/attachment.html 

From mail at martin-probst.com  Tue Feb 13 23:34:01 2007
From: mail at martin-probst.com (Martin Probst)
Date: Wed, 14 Feb 2007 08:34:01 +0100
Subject: [antlr-interest] expecting "class", found 'class'
In-Reply-To: <000b01c74df7$2fbfd370$9231fea9@Werkbank>
References: <000001c74dc0$188e0a50$9231fea9@Werkbank>
	<bc607a4e0702110315x1af2f065qb4d2c8288b823828@mail.gmail.com>
	<000001c74dd5$f9e92f10$9231fea9@Werkbank>
	<bc607a4e0702110549i3528fab3t496260e3315e248d@mail.gmail.com>
	<000b01c74df7$2fbfd370$9231fea9@Werkbank>
Message-ID: <5FD7CD0E-651B-40D8-9B9D-CBB73B2E8F4B@martin-probst.com>

Hi,

> i have lexer and parser in one file. Using the
> traceLexer or traceParser didn't help me.
>
> What does this message mean anyway?

It means that the parser expected a token with the text 'class' and  
found one with the text 'class'. The problem is that the parser  
actually expected a token with a certain token type, and it found one  
with a different token type. However the error message doesn't show  
that (I hope this was fixed in ANTLR 3...).

So this is usually a bug coming from a rule IDENT like this:
IDENT: ('a'..'z' | 'A'..'Z')+;
And a rule:
CLASS: 'class';

Where the text 'class' can be matched by both rules, and somehow it  
ends up being matched by IDENT where the parser expects a CLASS  
token. This is a very common problem, and you can usually solve it by  
removing the CLASS rule altogether and replacing it with a  
testLiterals=true and simply write "class" in the parser, instead of  
CLASS.

To further debug it, you will probably have to turn of the default  
error handler, catch the exception, and investigate the actual token  
types that are available from the exception. Those token types are  
offsets into YourParser._tokenNames[], look there to find the token  
name.

HTH,
Martin

From pink at odahoda.de  Wed Feb 14 00:51:44 2007
From: pink at odahoda.de (Benjamin Niemann)
Date: Wed, 14 Feb 2007 09:51:44 +0100
Subject: [antlr-interest] Antlr for SunOS
References: <141D986BB4749448AB843778A4DD236B07FEF999@kormail02.in.bosch.com>
Message-ID: <equij0$p8m$1@sea.gmane.org>

Imran A R (RBIN/EMT2) wrote:

> Hello all
> 
> I have written an application in Java which uses Antlr for
> parsing files, this app is in Windows.
> Now I want to bring same application to SunOs. Before that, I
> have one question. Do we have
> Antlr for SunOS?  Thank you in Advance.

ANTLR should be portable across platforms. It runs fine on Windows and
Linux, so I assume that SunOS is ok as well.

-- 
Benjamin Niemann
Email: pink at odahoda dot de
WWW: http://pink.odahoda.de/


From ssiegel at finjan.com  Wed Feb 14 02:10:15 2007
From: ssiegel at finjan.com (Shmuel Siegel)
Date: Wed, 14 Feb 2007 12:10:15 +0200
Subject: [antlr-interest] Lexer Strangeness
In-Reply-To: <f18f141c0702131315h4dff5678jed36ead2bfc3ff3a@mail.gmail.com>
References: <f18f141c0702131315h4dff5678jed36ead2bfc3ff3a@mail.gmail.com>
Message-ID: <E344C433F006AB45A306D422F9C3EB4C015DFB34@exmail1.finjan.com>

The way I look at this is:
In the lexer, '~' is a set operator. It says to use all of the other
symbols from the vocabulary. NEWLINE is neither a character nor a set of
characters; hence, set complement doesn't have any meaning.

Hope that this works for you.

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Scott
Fortmann-Roe
Sent: Tuesday, February 13, 2007 11:15 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Lexer Strangeness

Hi,

I am having a small issue with matching line comments in the lexer.
The following code works correctly:

fragment NEWLINE
       :       '\r'|'\n'
;
LINECOMMENT
       :       '//' (~('\r'|'\n'))* NEWLINE {$channel=HIDDEN;}
;


But if I convert the line comment command to the following form ANTLR
complains that the start state cannot be found for the rule:

LINECOMMENT
       :       '//' (~(NEWLINE))* NEWLINE {$channel=HIDDEN;}
;

I am having a hard time seeing how these are functionally different.
I'm a noob though so please help.

Thanks, Scott


From ssiegel at finjan.com  Wed Feb 14 02:18:01 2007
From: ssiegel at finjan.com (Shmuel Siegel)
Date: Wed, 14 Feb 2007 12:18:01 +0200
Subject: [antlr-interest] Error in "rewriteTokenRef" template
In-Reply-To: <00e201c74fb5$ea4e8dc0$1601a8c0@kocher>
References: <00e201c74fb5$ea4e8dc0$1601a8c0@kocher>
Message-ID: <E344C433F006AB45A306D422F9C3EB4C015DFB50@exmail1.finjan.com>

There is a bug in the rewrite rules when trying to create an artificial token using one of the token IDs that is in the pattern. I dealt with this by creating a new token type, XINT. I then treated XINT and INT as identical during tree walking.

In other words, make you rewrite rule ^(vars ID XINT["1"])

 

________________________________

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Dr. Hartmut Kocher
Sent: Tuesday, February 13, 2007 11:29 PM
To: 'ANTLR Interest'
Subject: [antlr-interest] Error in "rewriteTokenRef" template

 

The following grammar triggers a 

"error(10):  internal error: Simple.g : java.util.NoSuchElementException: no such attribute: args in template context [rewriteTokenRef]

"

rewriteTokenRef does not have an args parameter. But I couldn't figure out, how to fix it.

 

 

The rewrite rule -> ^(vars ID INT["1"])  triggers the error.

 

Any ideas?

 

Hartmut

 

 

grammar Simple;

 

options {

     language=Java;

     output=AST;

     ASTLabelType=CommonTree;

     }

 

 

t :

vars (

     'in' 'table' ID 

          ( '>' INT -> ^(vars ID INT)

          |               -> ^(vars ID INT["1"])  // The INT["1"] triggers the error

          )

);

 

vars : 'abc' | 'abd';

 

fragment DIGIT  :    '0'..'9';

 

 

INT :    DIGIT+;

 

 

ID   :    ('abc' DIGIT) => 'abc' {$type = ABC;} | ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

 

 

WS  :  (' '|'\r'|'\t'|'\f'|'\n')+ { $channel=HIDDEN; };

 

 

Dr. Hartmut Kocher

Cortex Brainware Consulting & Training GmbH

Kirchplatz 5
D-82049 Pullach

Tel: +49 (89) 744  850 0
Fax: +49 (89) 744  850 11

http://www.cortex-brainware.de <http://www.cortex-brainware.de/> 

E-Mail: hwk at cortex-brainware.de

Handelsregister:
Registergericht: Amtsgericht M?nchen
HRB-Nr. 120614

Vertretungsberechtigte Gesch?ftsf?hrer:
Dipl.-Inform. Dorothea Burger, Dr.-Ing. Hartmut Kocher, Dr.-Ing. Martin Lang, Dr. rer. nat. Rolf Peter Wehrum 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070214/ca06c2c4/attachment.html 

From antlr at mirality.co.nz  Wed Feb 14 03:08:09 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 15 Feb 2007 00:08:09 +1300
Subject: [antlr-interest] Lexer Strangeness
Message-ID: <7.0.1.0.0.20070215000403.033cd300@mirality.co.nz>

At 23:30 14/02/2007, Shmuel Siegel wrote:
 >The way I look at this is:
 >In the lexer, '~' is a set operator. It says to use all of the
 >other symbols from the vocabulary. NEWLINE is neither a 
character
 >nor a set of characters; hence, set complement doesn't have any
 >meaning.

I can see the logic behind that position, but I can distinctly 
remember when writing a 2.7 grammar that I heartily wished that 
was not the case.  Ok, for complex lexer rules that's fair enough 
(but it should probably generate an error if it doesn't know how 
to treat it as a set), but for simple set-of-alternatives lexer 
rules it should be able to treat the two the same way.

This hasn't come up yet when using ANTLR 3, but then I've only 
been playing with a very simple grammar in v3 so far :)


From vgusev at graphlogic.com  Wed Feb 14 06:58:11 2007
From: vgusev at graphlogic.com (Vladimir Gusev)
Date: Wed, 14 Feb 2007 09:58:11 -0500
Subject: [antlr-interest] Getting token types programmatically from lexer
In-Reply-To: <7.0.1.0.0.20070215000403.033cd300@mirality.co.nz>
References: <7.0.1.0.0.20070215000403.033cd300@mirality.co.nz>
Message-ID: <002c01c75048$8c090fe0$186fa8c0@graphlogic.com>

Hello,

For my domain language editor I need to determine programmatically the
available functions and display them for the user. Currently I am extending
from the generated MyLexer and add in the child class add a public method
getLiterals(), which is a public getter for the protected literals
hashTable. Is this a "recommended" approach? 

Thanks a lot.

Vladimir


From JeanMarc.Vanel at mathworks.fr  Wed Feb 14 07:33:52 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Wed, 14 Feb 2007 16:33:52 +0100
Subject: [antlr-interest] still trying to make a crude Java to C++
	translator in Antlr 3
Message-ID: <632C3E36DCF16649AD770FE2646E9A18014ABE63@message-fr.ad.mathworks.com>

Hi

 

The title says it all.

 

After playing with the examples in Antlr 3, I hesitate between 2
technologies:

-          using TokenRewriteStream like in tweak example

-          using a tree parser like in treeparser and simplecTreeParser
examples

 

In the later case, I don't know how to recover in the final output the
original white spaces. What I did was calling getTree() on the root of
the grammar, and then a simple recursive printing with Tree.getChild() .

 

Thanks

 

Jean Marc Vanel

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070214/a43891df/attachment-0001.html 

From jimi at intersystems.com  Wed Feb 14 09:44:32 2007
From: jimi at intersystems.com (Jim Idle)
Date: Wed, 14 Feb 2007 12:44:32 -0500
Subject: [antlr-interest] Antlr for SunOS
In-Reply-To: <141D986BB4749448AB843778A4DD236B07FEF999@kormail02.in.bosch.com>
References: <141D986BB4749448AB843778A4DD236B07FEF999@kormail02.in.bosch.com>
Message-ID: <20070214174433.B79CB776@mail.intersystems.com>

You have more chance with SunOS than most other Unixes. The JVMs for
many Unixes tend to be broken by default ;-). Unless someone else has
already discovered the broken JVM, and therefore installed the relevant
70 kernel patches and jvm updates that they always seem to need, I
usually find that the jar won't run correctly - especially with HPUX.
However, so long as you have your OS patched up to date then you will be
fine.

 

Jim

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Imran A R
(RBIN/EMT2)
Sent: Tuesday, February 13, 2007 7:37 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Antlr for SunOS

 

Hello all 

        I have written an application in Java which uses Antlr for
parsing files, this app is in Windows. 
        Now I want to bring same application to SunOs. Before that, I
have one question. Do we have 
        Antlr for SunOS?  Thank you in Advance. 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070214/e1c1e92e/attachment.html 

From hwk.cortex-brainware at t-online.de  Wed Feb 14 15:09:22 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Thu, 15 Feb 2007 00:09:22 +0100
Subject: [antlr-interest] Error in predicate logic
Message-ID: <012301c7508d$2a320340$1601a8c0@kocher>

The following stripped grammar shows an error in the predicate code
generation:

 

Whereas for ?aa? a correct predicate is generated, this is not the case for
?aab?.

 

grammar Simple;

 

options {

     language=Java;

     output=AST;

     ASTLabelType=CommonTree;

     }

 

tokens {

AA = 'aa';

AAB = 'aab';

}

 

t :

  vars INT -> ^(vars INT)

| ID

;

 

vars : 'aa' | 'aab' ;

 

fragment DIGIT  :    '0'..'9';

 

INT :    DIGIT+;

 

ID   :    

    (AA DIGIT) => AA {$type = AA;} 

  | (AAB DIGIT) => AAB {$type = AAB;} 

  | ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+ ;

 

 

WS  :  (' '|'\r'|'\t'|'\f'|'\n')+ { $channel=HIDDEN; };

 

 

The code excerpt shows that for ?aab? the result is simply set without
checking the predicate first. ?aab? does not check for a following digit,
but accepts any character


 

Note this only happens if the tokens are a subset of each other, e.g. ?aa?
and ?aab?, which also starts with ?aa?
 

 

// Simple.g:28:5: ( ( AA DIGIT )=> AA | ( AAB DIGIT )=> AAB |
('a'..'z'|'A'..'Z') ( ('a'..'z'|'A'..'Z'|'_'|'0'..'9'))+ )

            int alt3=3;

            int LA3_0 = input.LA(1);

            if ( (LA3_0=='a') ) {

                int LA3_1 = input.LA(2);

                if ( (LA3_1=='a') ) {

                    if ( (LA3_3=='b') ) {

                        alt3=2;        // a predicate function should be
called here!!!

                    }

                    else if ( (synpred1()) ) {

                        alt3=1;

                    }

                    else if ( (true) ) {

                        alt3=3;

                    }

 

Hope this helps to fix it


 

Kind regards

 

Dr. Hartmut Kocher

Cortex Brainware Consulting & Training GmbH

Kirchplatz 5
D-82049 Pullach

Tel: +49 (89) 744  850 0
Fax: +49 (89) 744  850 11

 <http://www.cortex-brainware.de/> http://www.cortex-brainware.de

E-Mail: hwk at cortex-brainware.de

Handelsregister:
Registergericht: Amtsgericht M?nchen
HRB-Nr. 120614

Vertretungsberechtigte Gesch?ftsf?hrer:
Dipl.-Inform. Dorothea Burger, Dr.-Ing. Hartmut Kocher, Dr.-Ing. Martin
Lang, Dr. rer. nat. Rolf Peter Wehrum 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/2e75585a/attachment.html 

From hwk.cortex-brainware at t-online.de  Wed Feb 14 15:18:52 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Thu, 15 Feb 2007 00:18:52 +0100
Subject: [antlr-interest] Error in predicate logic
In-Reply-To: <012301c7508d$2a320340$1601a8c0@kocher>
References: <012301c7508d$2a320340$1601a8c0@kocher>
Message-ID: <012f01c7508e$7dbb8d50$1601a8c0@kocher>

And BTW: It doesn't compile either as LA3_3 is never set in the code below.

Hartmut

.

 

The code excerpt shows that for 'aab' the result is simply set without
checking the predicate first. 'aab' does not check for a following digit,
but accepts any character.

 

Note this only happens if the tokens are a subset of each other, e.g. 'aa"
and 'aab', which also starts with 'aa'. 

 

// Simple.g:28:5: ( ( AA DIGIT )=> AA | ( AAB DIGIT )=> AAB |
('a'..'z'|'A'..'Z') ( ('a'..'z'|'A'..'Z'|'_'|'0'..'9'))+ )

            int alt3=3;

            int LA3_0 = input.LA(1);

            if ( (LA3_0=='a') ) {

                int LA3_1 = input.LA(2);

                if ( (LA3_1=='a') ) {

                    if ( (LA3_3=='b') ) {

                        alt3=2;        // a predicate function should be
called here!!!

                    }

                    else if ( (synpred1()) ) {

                        alt3=1;

                    }

                    else if ( (true) ) {

                        alt3=3;

                    }

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/381f96df/attachment-0001.html 

From parrt at cs.usfca.edu  Wed Feb 14 17:53:05 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 14 Feb 2007 17:53:05 -0800
Subject: [antlr-interest] Error in predicate logic
In-Reply-To: <012301c7508d$2a320340$1601a8c0@kocher>
References: <012301c7508d$2a320340$1601a8c0@kocher>
Message-ID: <CF6AE7DB-B471-42DF-A5ED-C6A5D48F1BCC@cs.usfca.edu>

Hi Harmut,

Hmm...that is suspicious:

ID   :
     (AA DIGIT) => AA
   | (AAB DIGIT) => AAB
   | ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+
   ;

AAB collides with 3rd alt as does AA so it should test synpred1 then  
synpred2 then 3rd alt (no pred).  Odd.

Adding to bug db.

Ter

From FranklinChen at cmu.edu  Wed Feb 14 20:47:40 2007
From: FranklinChen at cmu.edu (FranklinChen at cmu.edu)
Date: Wed, 14 Feb 2007 23:47:40 -0500
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
Message-ID: <17875.58860.286903.923473@swan.psy.cmu.edu>

I noticed that output=AST for tree parsers in 3.0b6 isn't working
yet.  When will this be available?  I have large ANTLR 2 projects that
make extensive use of multiple passes gradually transforming an AST
until the final pass generates output, and I would like to convert
them to ANTLR 3.

-- 
Franklin

From caishaoting at gmail.com  Wed Feb 14 23:19:38 2007
From: caishaoting at gmail.com (Shaoting Cai)
Date: Thu, 15 Feb 2007 15:19:38 +0800
Subject: [antlr-interest] How to get Parser rule's return value?
Message-ID: <9b1ada6d0702142319u6f6d7f61lc5c59a3001424931@mail.gmail.com>

Hi, I'm a beginner.  Could you tell me how to get parser rule's return
value?
eg: I have this parser rule...

*variable* [int iPos] returns [int iOffset]
    : IDENT { iOffset= 1; }
    ;
*declare*
    : "var" variable *{ /* I need return value here */ }*
    ;

I'm using CPP output.
Thanks!

Shaoting
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/e83692a2/attachment.html 

From a.shneyderman at gmail.com  Wed Feb 14 23:46:00 2007
From: a.shneyderman at gmail.com (Alex Shneyderman)
Date: Thu, 15 Feb 2007 08:46:00 +0100
Subject: [antlr-interest] Performance question.
Message-ID: <693a69ba0702142346n6ac43a7cscb311d0b33ca3784@mail.gmail.com>

I need to  parse java files to augment them with some code. So, I went
to antlr's site downlaoded the availble java grammar and generted
myself a parser.

Now, I run the parser on one of the projects - it has approximately
1000 java files. To parse each file I use the following code:

try {
  Java15Lexer lexer = new Java15Lexer(new FileInputStream(file));
  Java15Parser parser = new Java15Parser(lexer);
  parser.compilationUnit();
} catch (Throwable t) {
  System.out.println ("Can't parse: " + file.getAbsolutePath() + "; "
+ t.getMessage());
}

Parsing of this many files takes about 41 sec.

Then I came across ecj (eclipse compiler that is distributed
separately now) that has parser as part of it. So I run the parser
only part on the same source set and the turn-around there is about 3
sec. I am not sure of the quality of the AST it generated but I can
definitely navigate typpe declarations, fields, methods and statements
within the methods.

I am wondering whether I am doing anything wrong while runing ANTLR
(2.6.7 version).
Any suggestions to improve performance?

-- 
Thanks,
Alex.

From ric.klaren at gmail.com  Thu Feb 15 00:43:05 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Thu, 15 Feb 2007 09:43:05 +0100
Subject: [antlr-interest] Performance question.
In-Reply-To: <693a69ba0702142346n6ac43a7cscb311d0b33ca3784@mail.gmail.com>
References: <693a69ba0702142346n6ac43a7cscb311d0b33ca3784@mail.gmail.com>
Message-ID: <bc607a4e0702150043i17693d1dmc20d7d9c8476d4e9@mail.gmail.com>

Hi,

On 2/15/07, Alex Shneyderman <a.shneyderman at gmail.com> wrote:
> try {
>   Java15Lexer lexer = new Java15Lexer(new FileInputStream(file));
>   Java15Parser parser = new Java15Parser(lexer);
>   parser.compilationUnit();
> } catch (Throwable t) {
>   System.out.println ("Can't parse: " + file.getAbsolutePath() + "; "
> + t.getMessage());
> }

Don't destroy the parser and lexer between runs but reinitialize them
for the new input with help of InputBuffers. I'm don't know what the
java invocations are for this of the top of my head. But there should
be some reset methods on the inputbuffer used for the lexer and you
might have to add some reset or reinitialize methods to your lexer and
parser depending on what amount state you keep.

Cheers,

Ric

From a.shneyderman at gmail.com  Thu Feb 15 02:09:41 2007
From: a.shneyderman at gmail.com (Alex Shneyderman)
Date: Thu, 15 Feb 2007 11:09:41 +0100
Subject: [antlr-interest] what's the deal with the port 8080 of antlr
	archives?
Message-ID: <693a69ba0702150209n64afa770oe91e628bc2422ad5@mail.gmail.com>

This is really getting on my nerves every time I try to search
archives from within the office at work.

Why do you have to run those on this dreaded 8080 port? It just makes
your site unsearchable from within corp firewalls. Please, fix the
port!

-- 
Thanks,
Alex.

From serefarikan at kurumsalteknoloji.com  Thu Feb 15 02:16:11 2007
From: serefarikan at kurumsalteknoloji.com (Seref Arikan)
Date: Thu, 15 Feb 2007 12:16:11 +0200
Subject: [antlr-interest] Performance question.
In-Reply-To: <693a69ba0702142346n6ac43a7cscb311d0b33ca3784@mail.gmail.com>
References: <693a69ba0702142346n6ac43a7cscb311d0b33ca3784@mail.gmail.com>
Message-ID: <45D432EB.3090407@kurumsalteknoloji.com>

This is an interesting question that I'd also be very glad to see an answer.

Best Regards
Seref

Alex Shneyderman wrote:
> I need to  parse java files to augment them with some code. So, I went
> to antlr's site downlaoded the availble java grammar and generted
> myself a parser.
>
> Now, I run the parser on one of the projects - it has approximately
> 1000 java files. To parse each file I use the following code:
>
> try {
>  Java15Lexer lexer = new Java15Lexer(new FileInputStream(file));
>  Java15Parser parser = new Java15Parser(lexer);
>  parser.compilationUnit();
> } catch (Throwable t) {
>  System.out.println ("Can't parse: " + file.getAbsolutePath() + "; "
> + t.getMessage());
> }
>
> Parsing of this many files takes about 41 sec.
>
> Then I came across ecj (eclipse compiler that is distributed
> separately now) that has parser as part of it. So I run the parser
> only part on the same source set and the turn-around there is about 3
> sec. I am not sure of the quality of the AST it generated but I can
> definitely navigate typpe declarations, fields, methods and statements
> within the methods.
>
> I am wondering whether I am doing anything wrong while runing ANTLR
> (2.6.7 version).
> Any suggestions to improve performance?
>




From j.reid at mail.cryst.bbk.ac.uk  Thu Feb 15 03:05:39 2007
From: j.reid at mail.cryst.bbk.ac.uk (John Reid)
Date: Thu, 15 Feb 2007 11:05:39 +0000
Subject: [antlr-interest] C++ TokenStreamSelector
Message-ID: <er1erl$23t$1@sea.gmane.org>

Hi,

I'm attaching my parser to a TokenStreamSelector. In some of my parser 
rules I call push on the selector to switch between lexers.

Unfortunately subsequently I do not always get tokens matched from the 
newly pushed lexer. Often I see tokens that have been lexed by the 
previous lexer. These must be buffered somewhere (perhaps in a 
TokenBuffer?).

What is the recommended way to flush this buffer and force re-lexing of 
the input stream? I have seen some documentation referring to 
selector->retry() but this throws an exception that terminates the parse.

The example code always pushes new lexers in the lexer immediately after 
a token has been matched. I would like to push lexers in the parser. 
Perhaps using the selector from the parser is not supported?

Sorry for not posting example code :(

Hope that makes sense and thx in advance for any help,
John.


From madcapmaggie at yahoo.com  Thu Feb 15 04:32:03 2007
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Thu, 15 Feb 2007 04:32:03 -0800 (PST)
Subject: [antlr-interest] problem with antlr-2.7.5
Message-ID: <778682.5077.qm@web60023.mail.yahoo.com>

 
  I'm running antlr 2.7.5 on Linux and using it to generate c++ code.  
   
  Everything works fine when built with gcc 3.2.2 (antlr and test driver, parser input) but when built with gcc 4.1.1 (antlr, test driver) that same input loops infinitely in the c++ runtime --
  I think in token buffer delete  -- anyway somewhere in the ref/deref stuff.
   
  I'm going to spend some time narrowing down the cause of the problem (hopefully) but meanwhile has anyone else run across this?  
   
  Thanks.


Margaret Fieland
    www.margaretfieland.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/55fcd06d/attachment.html 

From ric.klaren at gmail.com  Thu Feb 15 05:21:33 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Thu, 15 Feb 2007 14:21:33 +0100
Subject: [antlr-interest] C++ TokenStreamSelector
In-Reply-To: <er1erl$23t$1@sea.gmane.org>
References: <er1erl$23t$1@sea.gmane.org>
Message-ID: <bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>

Hi,

On 2/15/07, John Reid <j.reid at mail.cryst.bbk.ac.uk> wrote:
> I'm attaching my parser to a TokenStreamSelector. In some of my parser
> rules I call push on the selector to switch between lexers.

This does not work in the general case (due to lookahead,
tokenbuffering and presence of syntactic predicates).

> What is the recommended way to flush this buffer and force re-lexing of
> the input stream?

There is no such mechanism. You might get something to work with very
creative use of mark, rewind on the buffer and adding code to
invalidate/reset the state of the lookahead. But this requires a
*very* *very* good understanding of your parser and how it parses.
E.g. you have to mark the input at the start of a rule if you suspect
that a switch might be necessary and rewind and cleanup if it fails.
Or unregister the mark if it was not needed (e.g. no switch needed)
(in short: a maintenance nightmare)

I would not go tread way unless I *really* had no other option. E.g.
more passes, uses AST's.. maybe use tokenstream rewriting. It depends
on what you want to accomplish.

Cheers,

Ric

From ric.klaren at gmail.com  Thu Feb 15 05:25:24 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Thu, 15 Feb 2007 14:25:24 +0100
Subject: [antlr-interest] problem with antlr-2.7.5
In-Reply-To: <778682.5077.qm@web60023.mail.yahoo.com>
References: <778682.5077.qm@web60023.mail.yahoo.com>
Message-ID: <bc607a4e0702150525j69a7237fw50a97deba3cff4b6@mail.gmail.com>

Hi,

On 2/15/07, Peggy Fieland <madcapmaggie at yahoo.com> wrote:
> Everything works fine when built with gcc 3.2.2 (antlr and test driver,
> parser input) but when built with gcc 4.1.1 (antlr, test driver) that same
> input loops infinitely in the c++ runtime --
> I think in token buffer delete  -- anyway somewhere in the ref/deref stuff.

Hmm weird, I think I've used antlr generated code on gcc 4.1.1 without
problems, at least I've got 4.1.1 on a fedora box at home. I can do a
check when I get back from work.

Are there also problems with examples supplied with antlr?

Cheers,

Ric

From madcapmaggie at yahoo.com  Thu Feb 15 05:41:07 2007
From: madcapmaggie at yahoo.com (Peggy Fieland)
Date: Thu, 15 Feb 2007 05:41:07 -0800 (PST)
Subject: [antlr-interest] problem with antlr-2.7.5
In-Reply-To: <bc607a4e0702150525j69a7237fw50a97deba3cff4b6@mail.gmail.com>
Message-ID: <873159.71470.qm@web60015.mail.yahoo.com>


I doubt there are problems with the examples but I'll check when I get into work --
  the input with the problem is very large (an oracle package) and the parser in question is
  also very large. I've also modified antlr 2.7.5 to support unicode (using your example as a starting point.)
   
  I'll be spending today narrowing down the problem 
   
  I doubt it's an actual antlr problem -- I'd guess it's either a problem in my grammar exposed
  by the compiler change or a gcc 4.1.1 code generator bug ...
   
  <sigh>.  I'm hoping it's a problem with my grammar.
   
  
Ric Klaren <ric.klaren at gmail.com> wrote:
  Hi,

On 2/15/07, Peggy Fieland wrote:
> Everything works fine when built with gcc 3.2.2 (antlr and test driver,
> parser input) but when built with gcc 4.1.1 (antlr, test driver) that same
> input loops infinitely in the c++ runtime --
> I think in token buffer delete -- anyway somewhere in the ref/deref stuff.

Hmm weird, I think I've used antlr generated code on gcc 4.1.1 without
problems, at least I've got 4.1.1 on a fedora box at home. I can do a
check when I get back from work.

Are there also problems with examples supplied with antlr?

Cheers,

Ric



Margaret Fieland
    www.margaretfieland.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/0b55197c/attachment-0001.html 

From j.reid at mail.cryst.bbk.ac.uk  Thu Feb 15 06:16:23 2007
From: j.reid at mail.cryst.bbk.ac.uk (John Reid)
Date: Thu, 15 Feb 2007 14:16:23 +0000
Subject: [antlr-interest] C++ TokenStreamSelector
In-Reply-To: <bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>
References: <er1erl$23t$1@sea.gmane.org>
	<bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>
Message-ID: <er1q19$bhi$1@sea.gmane.org>

Ric Klaren wrote:
> Hi,
> 
> On 2/15/07, John Reid 
> <j.reid at mail.cryst.bbk.ac.uk> wrote:
> 
>> I'm attaching my parser to a TokenStreamSelector. In some of my parser
>> rules I call push on the selector to switch between lexers.
> 
> 
> This does not work in the general case (due to lookahead,
> tokenbuffering and presence of syntactic predicates).
> 
>> What is the recommended way to flush this buffer and force re-lexing of
>> the input stream?
> 
> 
> There is no such mechanism. You might get something to work with very
> creative use of mark, rewind on the buffer and adding code to
> invalidate/reset the state of the lookahead. But this requires a
> *very* *very* good understanding of your parser and how it parses.
> E.g. you have to mark the input at the start of a rule if you suspect
> that a switch might be necessary and rewind and cleanup if it fails.
> Or unregister the mark if it was not needed (e.g. no switch needed)
> (in short: a maintenance nightmare)
The token stream must know what input has been consumed and what is 
pending. I can't see why it could not re-lex the pending input but I 
have to admit I don't understand the antlr internals: so I'll take your 
word for it.

> 
> I would not go tread way unless I *really* had no other option. E.g.
> more passes, uses AST's.. maybe use tokenstream rewriting. It depends
> on what you want to accomplish.
> 
My parsing problem is that sometimes fields in my text file are 
delimited by '.', ':', ';', and various other tokens. My problem is that 
in many cases these characters are part of the values of the fields and 
in other cases they are delimiters. I can only know which is which at 
parse time. So I thought what I was doing was the natural solution. 
Obviously I just misinterpreted the documentation!

Does anyone have any advice for how to approach this problem? None of 
the examples in the antlr documentation deal with this sort of grammar.

Thanks,
John.


From ric.klaren at gmail.com  Thu Feb 15 06:53:37 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Thu, 15 Feb 2007 15:53:37 +0100
Subject: [antlr-interest] C++ TokenStreamSelector
In-Reply-To: <er1q19$bhi$1@sea.gmane.org>
References: <er1erl$23t$1@sea.gmane.org>
	<bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>
	<er1q19$bhi$1@sea.gmane.org>
Message-ID: <bc607a4e0702150653sfa7f18bwf1b95971d6dd56fe@mail.gmail.com>

Hi,

On 2/15/07, John Reid <j.reid at mail.cryst.bbk.ac.uk> wrote:
> >> What is the recommended way to flush this buffer and force re-lexing of
> >> the input stream?
> >
> >
> > There is no such mechanism. You might get something to work with very
> > creative use of mark, rewind on the buffer and adding code to
> > invalidate/reset the state of the lookahead. But this requires a
> > *very* *very* good understanding of your parser and how it parses.
> > E.g. you have to mark the input at the start of a rule if you suspect
> > that a switch might be necessary and rewind and cleanup if it fails.
> > Or unregister the mark if it was not needed (e.g. no switch needed)
> > (in short: a maintenance nightmare)
> The token stream must know what input has been consumed and what is
> pending. I can't see why it could not re-lex the pending input but I
> have to admit I don't understand the antlr internals: so I'll take your
> word for it.

The problem is that antlr uses a recursive descent parser. E.g. the
call stack of the various parser rules is significant and might have
to be rewound depending on a number of factors. If you mix in guessing
mode then things get tricky.

> > I would not go tread way unless I *really* had no other option. E.g.
> > more passes, uses AST's.. maybe use tokenstream rewriting. It depends
> > on what you want to accomplish.
>
> My parsing problem is that sometimes fields in my text file are
> delimited by '.', ':', ';', and various other tokens. My problem is that
> in many cases these characters are part of the values of the fields and
> in other cases they are delimiters. I can only know which is which at
> parse time. So I thought what I was doing was the natural solution.

It may indeed feel the most intuitive, but the way antlr2 is built
makes this hard to do.

> Obviously I just misinterpreted the documentation!

I'm not sure if this is really explicit in the documentation. Although
I think there are some FAQ entries about it.

> Does anyone have any advice for how to approach this problem? None of
> the examples in the antlr documentation deal with this sort of grammar.

If you're using AST's: Is it an option to pass the tricky bits with
the delimiters as big chunk to the parser? And then deal with what
they are in a tree parser ? (E.g. refine the generated AST in an extra
pass, the good old divide and conquer) Or alternatively use a small
extra lexer (and maybe even parser) to parse the string with the chunk
when you encounter them and then built an AST.

Cheers,

Ric

From gilbert.williams at prosync.com  Thu Feb 15 07:29:01 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Thu, 15 Feb 2007 10:29:01 -0500
Subject: [antlr-interest] Undocumented ANTLR 3.0b6 Message?
Message-ID: <000001c75116$05198f40$b982e6cd@tsitelsys.com>

Greetings:

 

Whilst adding even more complexity to the grammar upon which I am working, I
got this message from the tool:

 

What does this mean?

 

 

The message came out after adding this fragment to my grammar.  I had to
enable backtracking to get ANTLR to handle the tail

differences without complaining.

 

perl_lpar_ere_expression 

options{

backtrack=true;

}

:

     perl_lpar_ere RPAREN

    | perl_lpar_ere ALTERNATE_PAREN

          ;

 

perl_lpar_ere :  perl_lpar ere ;

 

Tool Message:

 

 

F:\regexparse\tregex>java org.antlr.Tool -o src\com\prosync\regexparse
tregex.g

ANTLR Parser Generator  Version 3.0b6 (Jan 31, 2007)  1989-2007

non-LL(*) DFA 7

non-LL(*) DFA 7

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/e519d045/attachment.html 

From j.reid at mail.cryst.bbk.ac.uk  Thu Feb 15 08:37:27 2007
From: j.reid at mail.cryst.bbk.ac.uk (John Reid)
Date: Thu, 15 Feb 2007 16:37:27 +0000
Subject: [antlr-interest] C++ TokenStreamSelector
In-Reply-To: <bc607a4e0702150653sfa7f18bwf1b95971d6dd56fe@mail.gmail.com>
References: <er1erl$23t$1@sea.gmane.org>	<bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>	<er1q19$bhi$1@sea.gmane.org>
	<bc607a4e0702150653sfa7f18bwf1b95971d6dd56fe@mail.gmail.com>
Message-ID: <er229p$ntr$1@sea.gmane.org>

Ric Klaren wrote:
> The problem is that antlr uses a recursive descent parser. E.g. the
> call stack of the various parser rules is significant and might have
> to be rewound depending on a number of factors. If you mix in guessing
> mode then things get tricky.
I don't need any guessing to span pushes and pops of the lexer.

> If you're using AST's: Is it an option to pass the tricky bits with
> the delimiters as big chunk to the parser? And then deal with what
> they are in a tree parser ? (E.g. refine the generated AST in an extra
> pass, the good old divide and conquer) Or alternatively use a small
> extra lexer (and maybe even parser) to parse the string with the chunk
> when you encounter them and then built an AST.
I'm going to implement separate lexers (and possibly parsers).

Thanks for your help,
John.


From gbr at newtechlaw.com  Thu Feb 15 09:42:55 2007
From: gbr at newtechlaw.com (Gerald B. Rosenberg)
Date: Thu, 15 Feb 2007 09:42:55 -0800
Subject: [antlr-interest] Error in predicate logic
In-Reply-To: <CF6AE7DB-B471-42DF-A5ED-C6A5D48F1BCC@cs.usfca.edu>
References: <012301c7508d$2a320340$1601a8c0@kocher>
	<CF6AE7DB-B471-42DF-A5ED-C6A5D48F1BCC@cs.usfca.edu>
Message-ID: <200702151743.l1FHgxEC011275@morpho.newtechlaw.com>

Did I just run into the same bug, or is this a different problem (and 
how to fix)?

Trying to parse HTML to recognize the ampersand encoded special characters.

SPCHAR
: ( AMP GRIDLET INT SEMI ) => AMP GRIDLET INT SEMI
| ( AMP LETTERS SEMI ) => AMP LETTERS SEMI
| ( AMP ) => AMP { $type=PCCHAR; }
;

fragment PCCHAR : LETTER | DIGIT | PUNCTUATION | '>' | '/' ;
fragment LETTERS : (LETTER)+ ;
fragment LETTER  : 'a'..'z'| 'A'..'Z';
fragment AMP: '&' ;
fragment GRIDLET: '#' ;
fragment SEMI: ';' ;

The SPCHAR rule works as expected for input that:
- fully matches either of the first two subrules
- matches "&X" -- where "X" is anything *other* than a GRIDLET or a LETTER

For input "&hello there" , I get line 1:6 mismatched character ' ' 
expecting ';'

Thanks,
Gerald




At 05:53 PM 2/14/2007, you wrote:
>Hi Harmut,
>
>Hmm...that is suspicious:
>
>ID   :
>     (AA DIGIT) => AA
>   | (AAB DIGIT) => AAB
>   | ('a'..'z'|'A'..'Z') ('a'..'z'|'A'..'Z'|'_'|'0'..'9')+
>   ;
>
>AAB collides with 3rd alt as does AA so it should test synpred1 then
>synpred2 then 3rd alt (no pred).  Odd.
>
>Adding to bug db.
>
>Ter

----
Gerald B. Rosenberg, Esq.
NewTechLaw
285 Hamilton Avenue, Suite 520
Palo Alto, CA  94301-2576

650.325.2100  (office)  /  650.703.1724  (cell)
650.325.2107  (fax)

www.newtechlaw.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/fc2fba90/attachment.html 

From ml-antlr at riverside-machines.co.uk  Thu Feb 15 09:50:17 2007
From: ml-antlr at riverside-machines.co.uk (Evan Lavelle)
Date: Thu, 15 Feb 2007 17:50:17 +0000
Subject: [antlr-interest] Address harvesting from this list
Message-ID: <45D49D59.50403@riverside-machines.co.uk>

I've just had, after some years, the first spam to my current work email 
address (not the address above). Some Googling shows that the likely 
source is these two messages:

http://www.antlr.org/pipermail/antlr-interest/2005-May/012079.html
http://www.antlr.org/pipermail/antlr-interest/2005-June/012715.html

I'm afraid that a simple "s/@/ at /" is not going to put off any 
spammers. There's only one other Google hit on my address, in another 
list, which uses the more complex substitution "s/@/=user domain=/".

So, it looks like someone is harvesting addresses from this list.
Could somebody please scrub the two messages above from the archives?

Thanks

Evan

From jimi at intersystems.com  Thu Feb 15 10:37:16 2007
From: jimi at intersystems.com (Jim Idle)
Date: Thu, 15 Feb 2007 13:37:16 -0500
Subject: [antlr-interest] C++ TokenStreamSelector
In-Reply-To: <er1q19$bhi$1@sea.gmane.org>
References: <er1erl$23t$1@sea.gmane.org><bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>
	<er1q19$bhi$1@sea.gmane.org>
Message-ID: <20070215183726.0813C64D@mail.intersystems.com>

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of John Reid
Sent: Thursday, February 15, 2007 6:16 AM
To: antlr-interest at antlr.org
Subject: Re: [antlr-interest] C++ TokenStreamSelector


> My parsing problem is that sometimes fields in my text file are 
> delimited by '.', ':', ';', and various other tokens. My problem is
that 
> in many cases these characters are part of the values of the fields
and 
> in other cases they are delimiters. I can only know which is which at 
> parse time. So I thought what I was doing was the natural solution. 
> Obviously I just misinterpreted the documentation!

> Does anyone have any advice for how to approach this problem? None of 
> the examples in the antlr documentation deal with this sort of
grammar.

What is usually happening is that you are trying to do too much work in
the one place (the first parsing pass and the lexer). You could of
course write a hand crafted recognizer that could do this, but in
general communications between lexer and parser are difficult and of
course maintaining a hand crafted recognizer usually outweighs the
flexibility of parsing.

Try to construct lexer and parser rules that can construct a tree that
will be valid one way or another. Then, when the parse has consumed the
tokens, you can either pass the resulting AST to a further pass, that
will use semantic context to decide what it really means, or, if
possible at the end of the parse of a particular rule, rewrite the
tokens you have parsed as a tree with the correct semantics. As in you
are collecting the information required to make the judgment at the
first pass time and can guarantee to always have the information at the
point of disambiguation (at the end of some rule that allows its use.)

Maybe that isn't so easy to follow as text so here is an artificial
example that might help ;-). 

Let's invent a language that has identifiers with combinations of upper
case letters and a dot as valid names. But let's suppose that '.' is
also used as Object.something. When you are lexing this, you don't have
any context so you don't know whether to return say ID or OBJECT DOT
METHOD. This should tell you that you don't want to use tokens like
that, but make compound parsing rules that work on more primitive lexing
tokens. Then you can do this for your lexer:

fragment
LETTERS : 'A'..'Z';
ID: LETTERS+;
DOT: '.' ;

So whether the input is an ID or an object reference the parser will
get: ID DOT ID

In your parser you can now do:

thingy: ID (DOT ID)? ;

Now, if you know that the declaration of something being an object will
ALWAYS precede the use of it as the parser sees it (line 1 through line
nnn), then when you see a declaration (let's say it is: object ID; which
makes no sense really but you get the point, then you can do this:

OBJECT : 'object' ;
SEMI : ';';

objdecl : OBJECT o=ID SEMI
		{ Some code to add o.text into a symbol table }

Now your thingy rule is (just where you put the actions depends on how
you detect (DOT ID)? and so on, but again this is just a silly example:

thingy: object=ID (DOT method=ID)? 
	{
		Code that sees if object.text is declared as an object 
		If not assemble the bits of .text into a full id
	}
	->{thingy::isObject}? ^(OREF $object $method)
	->                    ^(ID[$thingy::idtext])
;

You need to add some local variables to check and so on.

Languages may be syntactically constructed such that you cannot
guarantee to see the OBJECT declaration before the use of it. In this
case you have to rewrite the tree as it, then use a tree parser/pass to
find all the declarations at the correct scope, then reparse the tree
with that information and rewrite it with the correct context. A
difficult to parse language like C++ comes to mind for instance. 

So:
 - Split your tokens into the largest character collections that don't
mean it is too 
   late by the time the parser gets it (I know that doesn't sound too
well defined, 
   if in doubt make new tokens);
 - Construct parser rules that will accept all the combinations of these
that COULD be semantically
   valid. Note that you might end up constructing parser rules that
accept token strings that are
   syntactically invalid and have to reject them once you know the
context;
 - Either in the first pass if you have all the info as you go, or in a
subsequent pass if not,
   rewrite a tree that is now both syntactically and semantically valid.
Use as many passes as you
   need to do different things but bear in mind performance when making
multiple passes.

Then you will have a tree that you can optimize, walk for code gen, and
so on.

Hope that helps,

Jim


From jimi at intersystems.com  Thu Feb 15 10:44:20 2007
From: jimi at intersystems.com (Jim Idle)
Date: Thu, 15 Feb 2007 13:44:20 -0500
Subject: [antlr-interest] Spam: Undocumented ANTLR 3.0b6 Message?
In-Reply-To: <000001c75116$05198f40$b982e6cd@tsitelsys.com>
References: <000001c75116$05198f40$b982e6cd@tsitelsys.com>
Message-ID: <20070215184422.4E692FDC@mail.intersystems.com>

It is probably some not well defined diagnostic that will all be cleaned up once Ter can rewrite ANTLR3 using an ANTLR3 grammar and has more time to spend on error messages and so on. It means that DFA number 7 is not LL(*) ;-)

 

You are using backtracking=true, which can be very useful when grammars are very ambiguous (maybe regular expressions are a good example, I haven?t thought about it), but try to construct a parser that does not need this option, or just use it on rules that have no other option (which I see you are trying to do of course).

 

In the case of this rule, I think (without seeing what the other rules are)you can use:

 

perl_lpar_ere_expression 

: perl_lpar ere (RPAREN | ALTERNATE_PAREN)

;

 

Otherwise you are making the runtime code try to work out a way to parse your tokens to see if there is RPAREN or ALTERNATE_PAREN, when you can parser it more naturally and decide what to do in actions.

 

Jim

 

 

From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Bert Williams
Sent: Thursday, February 15, 2007 7:29 AM
To: antlr-interest at antlr.org
Subject: Spam:[antlr-interest] Undocumented ANTLR 3.0b6 Message?

 

Greetings:

 

Whilst adding even more complexity to the grammar upon which I am working, I got this message from the tool:

 

What does this mean?

 

 

The message came out after adding this fragment to my grammar.  I had to enable backtracking to get ANTLR to handle the tail

differences without complaining.

 

perl_lpar_ere_expression 

options{

backtrack=true;

}

:

     perl_lpar_ere RPAREN

    | perl_lpar_ere ALTERNATE_PAREN

          ;

 

perl_lpar_ere :  perl_lpar ere ;

 

Tool Message:

 

 

F:\regexparse\tregex>java org.antlr.Tool -o src\com\prosync\regexparse tregex.g

ANTLR Parser Generator  Version 3.0b6 (Jan 31, 2007)  1989-2007

non-LL(*) DFA 7

non-LL(*) DFA 7

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070215/71d2892d/attachment.html 

From parrt at cs.usfca.edu  Thu Feb 15 10:59:34 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 15 Feb 2007 10:59:34 -0800
Subject: [antlr-interest] Address harvesting from this list
In-Reply-To: <45D49D59.50403@riverside-machines.co.uk>
References: <45D49D59.50403@riverside-machines.co.uk>
Message-ID: <7527A904-0518-432D-B451-3A0DD5F30505@cs.usfca.edu>

Hi.  I'll scrub if a mailman expert tells me how... :)
Ter
On Feb 15, 2007, at 9:50 AM, Evan Lavelle wrote:

> I've just had, after some years, the first spam to my current work  
> email address (not the address above). Some Googling shows that the  
> likely source is these two messages:
>
> http://www.antlr.org/pipermail/antlr-interest/2005-May/ 
> 012079.html
> http://www.antlr.org/pipermail/antlr-interest/2005-June/ 
> 012715.html
>
> I'm afraid that a simple "s/@/ at /" is not going to put off any  
> spammers. There's only one other Google hit on my address, in  
> another list, which uses the more complex substitution "s/@/=user  
> domain=/".
>
> So, it looks like someone is harvesting addresses from this list.
> Could somebody please scrub the two messages above from the archives?
>
> Thanks
>
> Evan


From zhixueyong at hotmail.com  Thu Feb 15 11:03:22 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Thu, 15 Feb 2007 14:03:22 -0500
Subject: [antlr-interest] How to get Parser rule's return value?
In-Reply-To: <9b1ada6d0702142319u6f6d7f61lc5c59a3001424931@mail.gmail.com>
References: <9b1ada6d0702142319u6f6d7f61lc5c59a3001424931@mail.gmail.com>
Message-ID: <er2apq$5b2$1@sea.gmane.org>

Shaoting Cai wrote:
> Hi, I'm a beginner.  Could you tell me how to get parser rule's return 
> value?
> eg: I have this parser rule...
>  
> *variable* [int iPos] returns [int iOffset]
>     : IDENT { iOffset= 1; }
>     ;
> *declare*
>     : "var" variable /{ /* I need return value here */ }/
>     ;
>  

declare
{int v;}
      : "var" v=variable {/*use v here*/}
      ;

See http://www.antlr.org/doc/metalang.html#_bb1

-- 
Xue Yong Zhi
XRuby (Ruby to Java bytecode compiler):
http://xruby.blogspot.com


From antlr at mirality.co.nz  Fri Feb 16 00:57:12 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 16 Feb 2007 21:57:12 +1300
Subject: [antlr-interest] Error in predicate logic
Message-ID: <7.0.1.0.0.20070216215652.033e0ec0@mirality.co.nz>

At 06:42 16/02/2007, Gerald B. Rosenberg wrote:
>SPCHAR
>: ( AMP GRIDLET INT SEMI ) => AMP GRIDLET INT SEMI
>| ( AMP LETTERS SEMI ) => AMP LETTERS SEMI
>| ( AMP ) => AMP { $type=PCCHAR; }
>;

Ok, I could be wrong, but I don't think you need any of those 
syntactic predicates, since your lookahead matches what you're 
trying to parse anyway.

Oh, and what you call a GRIDLET is normally called a "hash 
mark".  Except for some Americans, who inexplicably call it a 
"pound sign".  


From vitaliy.akimov at gmail.com  Fri Feb 16 01:44:49 2007
From: vitaliy.akimov at gmail.com (Vitaliy Akimov)
Date: Fri, 16 Feb 2007 11:44:49 +0200
Subject: [antlr-interest] BitSet and big charVocabulary in C++
Message-ID: <b5a352580702160144l2b958d8bw1968c4dd3cf260a5@mail.gmail.com>

Hi, I'm implementing unicode lexer using antlr v.2.7 (for C++). And
I've found annoyance with patterns which translated to BitSet. Using
big vocabulary lead to spending sensible amount of time for BitSet
construction.  Extending codeGenBitsetTestThreshold gets large
condition line in "if" statement (millions of symbols). Why doesn't
antlr generate conditions with not operator (!) in simple expressions
such as "(~ ('a'| 'z'))" ? And why does antlr copy generated bitset
from array of longs to vector<bool> which is very time consuming?  I
think it's more reasonable use reference to this packed array and
unpack bits in match function.

From ric.klaren at gmail.com  Fri Feb 16 06:32:45 2007
From: ric.klaren at gmail.com (Ric Klaren)
Date: Fri, 16 Feb 2007 15:32:45 +0100
Subject: [antlr-interest] BitSet and big charVocabulary in C++
In-Reply-To: <b5a352580702160144l2b958d8bw1968c4dd3cf260a5@mail.gmail.com>
References: <b5a352580702160144l2b958d8bw1968c4dd3cf260a5@mail.gmail.com>
Message-ID: <bc607a4e0702160632i7f58258alae4a0401982a5d34@mail.gmail.com>

Hi,

On 2/16/07, Vitaliy Akimov <vitaliy.akimov at gmail.com> wrote:
> Hi, I'm implementing unicode lexer using antlr v.2.7 (for C++). And
> I've found annoyance with patterns which translated to BitSet. Using
> big vocabulary lead to spending sensible amount of time for BitSet
> construction.

By reusing Lexer/Parser objects and just refreshing the inputbuffer
you can make sure this initialization is only done once for a set of
files.

> Extending codeGenBitsetTestThreshold gets large
> condition line in "if" statement (millions of symbols). Why doesn't
> antlr generate conditions with not operator (!) in simple expressions
> such as "(~ ('a'| 'z'))" ?

I think Terence could shed more light on that. This is not decided in
the C++ codegen, although the BitSet class could be made smarter.

> And why does antlr copy generated bitset
> from array of longs to vector<bool> which is very time consuming?

Legacy, a lot of C++ classes are direct ports of existing java classes
and not the most optimal solution to the problem. Since most
parsers/lexers do not contain very large bitsets this problem has not
become very apparent (yet). Unicode is more or less experimental in
C++ mode.

> I think it's more reasonable use reference to this packed array and
> unpack bits in match function.

I agree. If you would create a patch for the bitset class to fix this
I'll be happy to include it in the next release.

Cheers,

Ric

From gbr at newtechlaw.com  Fri Feb 16 07:17:39 2007
From: gbr at newtechlaw.com (Gerald B. Rosenberg)
Date: Fri, 16 Feb 2007 07:17:39 -0800
Subject: [antlr-interest] Error in predicate logic
In-Reply-To: <7.0.1.0.0.20070216215652.033e0ec0@mirality.co.nz>
References: <7.0.1.0.0.20070216215652.033e0ec0@mirality.co.nz>
Message-ID: <200702161517.l1GFHvEC012523@morpho.newtechlaw.com>

At 12:57 AM 2/16/2007, Gavin Lambert wrote:
>At 06:42 16/02/2007, Gerald B. Rosenberg wrote:
>>SPCHAR
>>: ( AMP GRIDLET INT SEMI ) => AMP GRIDLET INT SEMI
>>| ( AMP LETTERS SEMI ) => AMP LETTERS SEMI
>>| ( AMP ) => AMP { $type=PCCHAR; }
>>;
>
>Ok, I could be wrong, but I don't think you need any of those 
>syntactic predicates, since your lookahead matches what you're 
>trying to parse anyway.

Right, but seems I still have to take care of the intervening states 
somehow to prevent getting the error message -- after a bit of trial 
and error, I found this to work:

SPCHAR :
     ( AMP GRIDLET INT SEMI    { printState("SpDigit "); }
     | AMP LETTERS SEMI        { printState("SpLettr "); }
     | AMP LETTERS ~';'        { $type=PCDATA; printState("P1Data  "); }
     | AMP GRIDLET INT ~';'    { $type=PCDATA; printState("P2Data  "); }
     | AMP GRIDLET ~INT        { $type=PCDATA; printState("P3Data  "); }
     | AMP                     { $type=PCDATA; printState("PcData  "); }
     ) ;

A bit literal.  Still, is there a better way?

Also, using ~SEMI  produced a lexer with an undefined set 
variable.  Using an explicit ~';' works, but seems counter-intuitive 
given that both the plain SEMI and  ~INT work.

>Oh, and what you call a GRIDLET is normally called a "hash 
>mark".  Except for some Americans, who inexplicably call it a "pound sign".

I have always taken "Gridlet" to be far more descriptive ;)

Thanks,
Gerald
----
Gerald B. Rosenberg, Esq.
NewTechLaw
285 Hamilton Avenue, Suite 520
Palo Alto, CA  94301-2576

650.325.2100  (office)  /  650.703.1724  (cell)
650.325.2107  (fax)

www.newtechlaw.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070216/65f1db64/attachment.html 

From j.reid at mail.cryst.bbk.ac.uk  Fri Feb 16 10:08:52 2007
From: j.reid at mail.cryst.bbk.ac.uk (John Reid)
Date: Fri, 16 Feb 2007 18:08:52 +0000
Subject: [antlr-interest] C++ TokenStreamSelector
In-Reply-To: <20070215183726.0813C64D@mail.intersystems.com>
References: <er1erl$23t$1@sea.gmane.org><bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>	<er1q19$bhi$1@sea.gmane.org>
	<20070215183726.0813C64D@mail.intersystems.com>
Message-ID: <er4s17$9uo$1@sea.gmane.org>


Jim Idle wrote:
> So:
>  - Split your tokens into the largest character collections that don't
> mean it is too 
>    late by the time the parser gets it (I know that doesn't sound too
> well defined, 
>    if in doubt make new tokens);
>  - Construct parser rules that will accept all the combinations of these
> that COULD be semantically
>    valid. Note that you might end up constructing parser rules that
> accept token strings that are
>    syntactically invalid and have to reject them once you know the
> context;
>  - Either in the first pass if you have all the info as you go, or in a
> subsequent pass if not,
>    rewrite a tree that is now both syntactically and semantically valid.
> Use as many passes as you
>    need to do different things but bear in mind performance when making
> multiple passes.
> 
> Then you will have a tree that you can optimize, walk for code gen, and
> so on.
> 
> Hope that helps,
> 
> Jim
> 
> 

That certainly sounds like good advice and I hope it will help. Thanks 
for the ideas.

John.


From antlr at mirality.co.nz  Fri Feb 16 12:30:32 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 17 Feb 2007 09:30:32 +1300
Subject: [antlr-interest] Error in predicate logic
In-Reply-To: <200702161517.l1GFHvEC012523@morpho.newtechlaw.com>
References: <7.0.1.0.0.20070216215652.033e0ec0@mirality.co.nz>
	<200702161517.l1GFHvEC012523@morpho.newtechlaw.com>
Message-ID: <7.0.1.0.0.20070217091400.0374bf08@mirality.co.nz>

At 04:17 17/02/2007, Gerald B. Rosenberg wrote:
>SPCHAR :
>     ( AMP GRIDLET INT SEMI    { printState("SpDigit "); }
>     | AMP LETTERS SEMI        { printState("SpLettr "); }
>     | AMP LETTERS ~';'        { $type=PCDATA; 
> printState("P1Data  "); }
>     | AMP GRIDLET INT ~';'    { $type=PCDATA; 
> printState("P2Data  "); }
>     | AMP GRIDLET ~INT        { $type=PCDATA; 
> printState("P3Data  "); }
>     | AMP                     { $type=PCDATA; 
> printState("PcData  "); }
>     ) ;

That one's going to consume the non-semicolon character following 
the letters as part of the PCDATA.  That could potentially be a 
problem (eg. if it's an angle bracket or quote mark).  Leaving 
those "not this" alternatives out should still actually work, it 
just may produce a nondeterminism warning.  If you want to get rid 
of that, then you probably will need to put the syntactic 
predicates back in, but they should be different from your 
matching set.  Like so:

SPCHAR
   : AMP GRIDLET INT SEMI              { printState("SpDigit "); }
   | AMP LETTERS SEMI                  { printState("SpLettr "); }
   | (AMP LETTERS ~';') => AMP LETTERS { $type = PCDATA; 
printState("P1Data "); }
   | (AMP GRIDLET INT ~';') => AMP GRIDLET INT { $type = PCDATA; 
printState("P2Data "); }
   | (AMP GRIDLET ~INT) => AMP GRIDLET { $type = PCDATA; 
printState("P3Data "); }
   | (AMP ~(GRIDLET | LETTERS)) => AMP { $type = PCDATA; 
printState("P4Data "); }
   ;

Though I'm not entirely sure about that last alt.  It might run 
afoul of the annoying inverse set thing mentioned below.

Also, I always thought that part of the point of ANTLR3 (and LL(*) 
parsing) was that it could handle grammars like the above as two 
separate rules with no need to do type-tweaking, since it could 
use as much lookahead as it needed to in order to disambiguate 
them.  Was I wrong about that?  Or haven't you tried it?

>Also, using ~SEMI  produced a lexer with an undefined set 
>variable.  Using an explicit ~';' works, but seems 
>counter-intuitive given that both the plain SEMI and  ~INT work.

Yeah, I know.  That one has annoyed me for ages, both in ANTLR2 
and 3.  I posted about it just a few days ago, in fact.


From gilbert.williams at prosync.com  Fri Feb 16 16:00:25 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Fri, 16 Feb 2007 19:00:25 -0500
Subject: [antlr-interest] ANTLR 3.0b6 --Debug Mode Gets Infinite Loop
Message-ID: <000301c75226$a1912f70$b982e6cd@tsitelsys.com>

Greetings:

 

When I compile my grammar without the -debug flag, I get a lexer/parser that
completes.  The lexer/parser hangs in an infinite loop if I add the -debug
flag.  Use of the -trace flag appears to cause no change in behaviour.

 

I do have to use the backtrack=true option in places and I do get the
"non-LL(*) DFA 9" message several times during the build.

 

I did not find this problem in the ANTLR issue tracking system.

 

If this is not a known issue, I can provide the grammar and test program to
support analysis.

 

Bert Williams.

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070216/bad70b1f/attachment.html 

From parrt at cs.usfca.edu  Fri Feb 16 16:26:30 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 16 Feb 2007 16:26:30 -0800
Subject: [antlr-interest] ANTLR 3.0b6 --Debug Mode Gets Infinite Loop
In-Reply-To: <000301c75226$a1912f70$b982e6cd@tsitelsys.com>
References: <000301c75226$a1912f70$b982e6cd@tsitelsys.com>
Message-ID: <604FD438-A548-413D-806F-49F042118EDA@cs.usfca.edu>

-debug puts parser into a server mode. it is waiting for a socket  
connection from ANTLRWorks.
Ter
On Feb 16, 2007, at 4:00 PM, Bert Williams wrote:

> Greetings:
>
>
>
> When I compile my grammar without the ?debug flag, I get a lexer/ 
> parser that completes.  The lexer/parser hangs in an infinite loop  
> if I add the ?debug flag.  Use of the ?trace flag appears to cause  
> no change in behaviour.
>
>
>
> I do have to use the backtrack=true option in places and I do get  
> the ?non-LL(*) DFA 9? message several times during the build.
>
>
>
> I did not find this problem in the ANTLR issue tracking system.
>
>
>
> If this is not a known issue, I can provide the grammar and test  
> program to support analysis.
>
>
>
> Bert Williams.
>
>
>
>
>
>


From hurui_email at yahoo.com  Fri Feb 16 17:25:29 2007
From: hurui_email at yahoo.com (Richard Hu)
Date: Fri, 16 Feb 2007 17:25:29 -0800 (PST)
Subject: [antlr-interest] Test  the lexer
Message-ID: <20070217012529.20516.qmail@web52024.mail.yahoo.com>

Hi, All:

Is it possible to test the lexer without testing the parser? I would like to send some stream into the lexer and see tokens being generate. But all the test samples I've seen include parser.

Thanks

--Rui 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070216/390323a1/attachment.html 

From pink at odahoda.de  Sat Feb 17 05:04:12 2007
From: pink at odahoda.de (Benjamin Niemann)
Date: Sat, 17 Feb 2007 14:04:12 +0100
Subject: [antlr-interest] Test  the lexer
References: <20070217012529.20516.qmail@web52024.mail.yahoo.com>
Message-ID: <er6ugc$hbm$1@sea.gmane.org>

Hello,

Richard Hu wrote:

> Is it possible to test the lexer without testing the parser? I would like
> to send some stream into the lexer and see tokens being generate. But all
> the test samples I've seen include parser.

Just create the Lexer and call its nextToken() method to get one Token after
the other and test if the tokens match your expectations.
If you need a explicit example, you'd have to tell us which ANTLR version
(2.x or 3) and which target language you are using.

HTH

-- 
Benjamin Niemann
Email: pink at odahoda dot de
WWW: http://pink.odahoda.de/


From mail at ghost23.de  Sat Feb 17 06:13:43 2007
From: mail at ghost23.de (Sven Busse)
Date: Sat, 17 Feb 2007 15:13:43 +0100
Subject: [antlr-interest] expecting "class", found 'class'
In-Reply-To: <5FD7CD0E-651B-40D8-9B9D-CBB73B2E8F4B@martin-probst.com>
References: <000001c74dc0$188e0a50$9231fea9@Werkbank>
	<bc607a4e0702110315x1af2f065qb4d2c8288b823828@mail.gmail.com>
	<000001c74dd5$f9e92f10$9231fea9@Werkbank>
	<bc607a4e0702110549i3528fab3t496260e3315e248d@mail.gmail.com>
	<000b01c74df7$2fbfd370$9231fea9@Werkbank>
	<5FD7CD0E-651B-40D8-9B9D-CBB73B2E8F4B@martin-probst.com>
Message-ID: <000001c7529d$d4f30d30$9231fea9@Werkbank>

Hi,

arghh, after several days now, i found, what the problem is.
Since i originally copied the java grammar as a starting point
for my own, now i found this line in the Parser options caused the problem:

exportVocab = myLanguage;

I deleted the line and now it works.

I read, that exportVocab is allways set, also if you don't
actually provide it, so i don't really understand that.

Cheers

Sven

-----Urspr?ngliche Nachricht-----
Von: Martin Probst [mailto:mail at martin-probst.com] 
Gesendet: Mittwoch, 14. Februar 2007 08:34
An: Sven Busse
Cc: 'Ric Klaren'; antlr-interest at antlr.org
Betreff: Re: [antlr-interest] expecting "class", found 'class'

Hi,

> i have lexer and parser in one file. Using the
> traceLexer or traceParser didn't help me.
>
> What does this message mean anyway?

It means that the parser expected a token with the text 'class' and  
found one with the text 'class'. The problem is that the parser  
actually expected a token with a certain token type, and it found one  
with a different token type. However the error message doesn't show  
that (I hope this was fixed in ANTLR 3...).

So this is usually a bug coming from a rule IDENT like this:
IDENT: ('a'..'z' | 'A'..'Z')+;
And a rule:
CLASS: 'class';

Where the text 'class' can be matched by both rules, and somehow it  
ends up being matched by IDENT where the parser expects a CLASS  
token. This is a very common problem, and you can usually solve it by  
removing the CLASS rule altogether and replacing it with a  
testLiterals=true and simply write "class" in the parser, instead of  
CLASS.

To further debug it, you will probably have to turn of the default  
error handler, catch the exception, and investigate the actual token  
types that are available from the exception. Those token types are  
offsets into YourParser._tokenNames[], look there to find the token  
name.

HTH,
Martin


From gilbert.williams at prosync.com  Sat Feb 17 07:51:34 2007
From: gilbert.williams at prosync.com (Bert Williams)
Date: Sat, 17 Feb 2007 10:51:34 -0500
Subject: [antlr-interest] Lexer Character Set Question (ANTLR3.0b6)
Message-ID: <000601c752ab$806338e0$b982e6cd@tsitelsys.com>

Greetings:

 

Given the following rules abstracted from a larger grammar:

 

using_rule_1: '$' flag id ')' ;

 

flag   : ( 'U' ) ;

 

id: (ALPHA)+ ;

 

using_rule_2 : (ALPHA)+ ;

 

ALPHA : ('a'..'z'|'A'..'Z' ) ;

 

I need to understand how to indicate in "using_rule" that other rules that
ALPHA is intended.  I believe that I should use a Semantic Predicate, but
can find no way to indicate something like:

 

" if I am in "using_rule_1", accept as "flag" those characters indicated in
rule "flag". "

i.e.,

 

The lexer appears to generate different tokes for 'U' and for ALPHA, which
means that in "using_rule_2", I get no matches for 'U' (one of the flags).
This is true even though 'U' is a member of the ALPHA set.

 

Is this the right direction here or should I consider making "flag" a lexer
rule and modifying ALPHA accordlingly?

 

Thanks!

 

Bert Williams.

 

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070217/626c443f/attachment-0001.html 

From omry at yadan.net  Mon Feb 19 05:35:57 2007
From: omry at yadan.net (Omry Yadan)
Date: Mon, 19 Feb 2007 15:35:57 +0200
Subject: [antlr-interest] AST getColumn() returns 0
Message-ID: <45D9A7BD.30904@yadan.net>

Hi all,

Given an AST node, how can I tell what is its location in the original 
line of text?

getColumn() seems to return 0 for some reason.


Thanks,

    Omry.



From zhixueyong at hotmail.com  Mon Feb 19 07:26:09 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Mon, 19 Feb 2007 10:26:09 -0500
Subject: [antlr-interest] AST getColumn() returns 0
In-Reply-To: <45D9A7BD.30904@yadan.net>
References: <45D9A7BD.30904@yadan.net>
Message-ID: <ercfif$l0l$1@sea.gmane.org>

Omry Yadan wrote:
> 
> Given an AST node, how can I tell what is its location in the original 
> line of text?
> 
> getColumn() seems to return 0 for some reason.
> 

Please google "antlr ast line number".

-- 
Xue Yong Zhi
XRuby (Ruby to Java bytecode compiler):
http://xruby.blogspot.com


From zhixueyong at hotmail.com  Mon Feb 19 07:30:39 2007
From: zhixueyong at hotmail.com (Xue Yong Zhi)
Date: Mon, 19 Feb 2007 10:30:39 -0500
Subject: [antlr-interest] Test  the lexer
In-Reply-To: <20070217012529.20516.qmail@web52024.mail.yahoo.com>
References: <20070217012529.20516.qmail@web52024.mail.yahoo.com>
Message-ID: <ercfqu$mus$1@sea.gmane.org>

Richard Hu wrote:
> Hi, All:
> 
> Is it possible to test the lexer without testing the parser? I would 
> like to send some stream into the lexer and see tokens being generate. 
> But all the test samples I've seen include parser.
> 

If you use ANTLR 2.7.* and Java, you can use this as an example:
http://xruby.googlecode.com/svn/trunk/src/com/xruby/compiler/parser/RubyLexerTest.java

-- 
Xue Yong Zhi
XRuby (Ruby to Java bytecode compiler):
http://xruby.blogspot.com


From martin.danjou at neterion.com  Mon Feb 19 11:41:14 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Mon, 19 Feb 2007 14:41:14 -0500 (EST)
Subject: [antlr-interest] v3 island grammar status
In-Reply-To: <mailman.900.1171727402.1974.antlr-interest@antlr.org>
References: <mailman.900.1171727402.1974.antlr-interest@antlr.org>
Message-ID: <Pine.LNX.4.63.0702182152490.14995@tennents.s2io.com>

What is the status on 
http://www.antlr.org/wiki/display/ANTLR3/island+grammar+formalization

Is there any chance that island grammar solutions ever become easier than 
this solution:
http://www.antlr.org/wiki/display/ANTLR3/Island+Grammars+Under+Parser+Control

I have a lexer-only solution, but it has lots of multiple alternatives due 
to the same tokens that need to be recognized in some sections of the 
input, and ignored in other sections of the input. For example:

function
int float
float int int

here is random input, this line can be skipped including mentions of float 
and int which won't matter until after the we see the explicit token for 
end of a function and a new function start.

endfunction

function
float
int
...


Regards,
Martin

From gbr at newtechlaw.com  Mon Feb 19 12:01:21 2007
From: gbr at newtechlaw.com (Gerald B. Rosenberg)
Date: Mon, 19 Feb 2007 12:01:21 -0800
Subject: [antlr-interest] Error in predicate logic
In-Reply-To: <7.0.1.0.0.20070217091400.0374bf08@mirality.co.nz>
References: <7.0.1.0.0.20070216215652.033e0ec0@mirality.co.nz>
	<200702161517.l1GFHvEC012523@morpho.newtechlaw.com>
	<7.0.1.0.0.20070217091400.0374bf08@mirality.co.nz>
Message-ID: <200702192002.l1JK2MEC026243@morpho.newtechlaw.com>

Thanks much for the help, Gavin.

You were right about the unanticipated consuming of the 
non-SEMIs.  Missed it in my test case.  Seems the  ~(GRIDLET | 
LETTERS) is not needed because of how Antlr resolves equal length 
matches.  This should be the final version:

SPCHAR : { !tagMode && !attrMode }?=>
     ( AMP GRIDLET INT SEMI                     { printState("SpDigit "); }
     | AMP LETTERS SEMI                         { printState("SpLettr "); }
     | (AMP GRIDLET INT ~';')=> AMP GRIDLET INT { $type=PCDATA; 
printState("P2Data  "); }
     | (AMP GRIDLET ~INT)=> AMP GRIDLET         { $type=PCDATA; 
printState("P3Data  "); }
     | (AMP LETTERS ~';')=> AMP LETTERS         { $type=PCDATA; 
printState("P1Data  "); }
     | AMP                                      { $type=PCDATA; 
printState("PcData  "); }
     ) ;

At 12:30 PM 2/16/2007, Gavin Lambert wrote:
>At 04:17 17/02/2007, Gerald B. Rosenberg wrote:
>>SPCHAR :
>>     ( AMP GRIDLET INT SEMI    { printState("SpDigit "); }
>>     | AMP LETTERS SEMI        { printState("SpLettr "); }
>>     | AMP LETTERS ~';'        { $type=PCDATA; printState("P1Data  "); }
>>     | AMP GRIDLET INT ~';'    { $type=PCDATA; printState("P2Data  "); }
>>     | AMP GRIDLET ~INT        { $type=PCDATA; printState("P3Data  "); }
>>     | AMP                     { $type=PCDATA; printState("PcData  "); }
>>     ) ;
>
>That one's going to consume the non-semicolon character following 
>the letters as part of the PCDATA.

----
Gerald B. Rosenberg
Certiv Analytics

www.certiv.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070219/bc91107f/attachment.html 

From martin.danjou at neterion.com  Mon Feb 19 15:16:34 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Mon, 19 Feb 2007 18:16:34 -0500 (EST)
Subject: [antlr-interest] v3 ignore=WS gone?
In-Reply-To: <Pine.LNX.4.63.0702191813150.10543@algonquin>
References: <Pine.LNX.4.63.0702191813150.10543@algonquin>
Message-ID: <Pine.LNX.4.63.0702191816190.10543@algonquin>

Hi,

options { ignore=WS; } no longer works.

Whitespace can only be ignored in the parser?

Thanks,
Martin

From h.kocher at pharmatechnik.de  Tue Feb 20 01:02:25 2007
From: h.kocher at pharmatechnik.de (Dr. Kocher, Hartmut)
Date: Tue, 20 Feb 2007 10:02:25 +0100
Subject: [antlr-interest] v3 ignore=WS gone?
In-Reply-To: <Pine.LNX.4.63.0702191816190.10543@algonquin>
References: <Pine.LNX.4.63.0702191813150.10543@algonquin>
	<Pine.LNX.4.63.0702191816190.10543@algonquin>
Message-ID: <D43540A44D3F794787378D8B08E8AE53F711A8@staexc01.pharmatechnik.de>

No, the new lexer uses channels to ignore WS.

Two options:
{ $channel = HIDDEN; } if you want WS in the token stream (but invisible). This might be handy for pretty printing etc.
Of
{ skip(); }  skips over WS altogether.

See the v3 docs.

Regards
Hartmut

-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Martin d'Anjou
Gesendet: Dienstag, 20. Februar 2007 00:17
An: antlr-interest at antlr.org
Betreff: [antlr-interest] v3 ignore=WS gone?

Hi,

options { ignore=WS; } no longer works.

Whitespace can only be ignored in the parser?

Thanks,
Martin


--------------------------------------------------------------------
Pharmatechnik GmbH & Co. KG
M?nchner Stra?e 15
D-82319 Starnberg

Sitz der Gesellschaft: Starnberg
HRA: 64434, HRB: 66369, Amtsgericht M?nchen
Gesch?ftsf?hrer: Dr. Detlef Graessner, Werner Torns, Stephan J?rgens

From alexander at gaengel.de  Tue Feb 20 02:50:18 2007
From: alexander at gaengel.de (=?ISO-8859-15?Q?Alexander_G=E4ngel?=)
Date: Tue, 20 Feb 2007 11:50:18 +0100
Subject: [antlr-interest] DoubleLinkedTree
Message-ID: <45DAD26A.5000109@gaengel.de>

Can Somebody give me a hint how to use DoubleLinkTrees.

I tried it this way:

I have    
ASTLabelType=MyAst; in my V3 Grammar

I created a Class MyAst extends DoubleLinkTree

I Implemented the Abstract functions from BaseTree like in CommonTree

but when I try to use the Grammar I get Exception in thread "main"
java.lang.ClassCastException: org.antlr.runtime.tree.CommonTree

Alexander


From martin.danjou at neterion.com  Tue Feb 20 05:39:00 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 20 Feb 2007 08:39:00 -0500 (EST)
Subject: [antlr-interest] v3 ignore=WS gone?
In-Reply-To: <D43540A44D3F794787378D8B08E8AE53F711A8@staexc01.pharmatechnik.de>
References: <Pine.LNX.4.63.0702191813150.10543@algonquin>
	<Pine.LNX.4.63.0702191816190.10543@algonquin>
	<D43540A44D3F794787378D8B08E8AE53F711A8@staexc01.pharmatechnik.de>
Message-ID: <Pine.LNX.4.63.0702200831530.14397@tennents.s2io.com>

Yes, I have read about HIDDEN and skip(), but that's not what I meant. I 
meant ignoring whitespace in the lexer rules before the tokens get to the 
parser: ie how to tell the INCLUDE lexer rule below to ignore whitespace 
between it's '#include' and QUOTED_STRING tokens:

WS : ' ';

INCLUDE :
   options { ignore=WS; }
   '#include' QUOTED_STRING ;
   ;

QUOTED_STRING :
   '"' ( 'a'..'z' | 'A'..'Z' | '.' | ... etc. ) '"'
   ;

Thanks,
Martin

On Tue, 20 Feb 2007, Dr. Kocher, Hartmut wrote:

> No, the new lexer uses channels to ignore WS.
>
> Two options:
> { $channel = HIDDEN; } if you want WS in the token stream (but invisible). This might be handy for pretty printing etc.
> Of
> { skip(); }  skips over WS altogether.
>
> See the v3 docs.
>
> Regards
> Hartmut
>
> -----Urspr?ngliche Nachricht-----
> Von: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Martin d'Anjou
> Gesendet: Dienstag, 20. Februar 2007 00:17
> An: antlr-interest at antlr.org
> Betreff: [antlr-interest] v3 ignore=WS gone?
>
> Hi,
>
> options { ignore=WS; } no longer works.
>
> Whitespace can only be ignored in the parser?
>
> Thanks,
> Martin
>
>
> --------------------------------------------------------------------
> Pharmatechnik GmbH & Co. KG
> M?nchner Stra?e 15
> D-82319 Starnberg
>
> Sitz der Gesellschaft: Starnberg
> HRA: 64434, HRB: 66369, Amtsgericht M?nchen
> Gesch?ftsf?hrer: Dr. Detlef Graessner, Werner Torns, Stephan J?rgens
>

From amohombe at yahoo.com  Tue Feb 20 06:16:27 2007
From: amohombe at yahoo.com (Ahmed Mohombe)
Date: Tue, 20 Feb 2007 15:16:27 +0100
Subject: [antlr-interest] JavaCC to Antlr grammar converter
In-Reply-To: <2e67829d0702060129p6838eb32j4471f1f7d3546741@mail.gmail.com>
References: <2e67829d0702060129p6838eb32j4471f1f7d3546741@mail.gmail.com>
Message-ID: <erevrs$s70$1@sea.gmane.org>

> The concepts and syntax of both JavaCC and Antlr look quite similar to 
> me, so I suppose this shouldn't be that difficult. 
It would be fantastic if such a thing would exist.

I would be even very happy with a detailed *tutorial* on how to covert it manually :).
(especially javacc->antlr3)

At the moment there are many open source projects that use javacc and could be a target
to ANTLR if such a detailed tutorial would exist.

Thanks in advance,

Ahmed.


From martin.danjou at neterion.com  Tue Feb 20 07:14:16 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 20 Feb 2007 10:14:16 -0500 (EST)
Subject: [antlr-interest] ignoring tokens baed on parser context
Message-ID: <Pine.LNX.4.63.0702201008470.3947@algonquin>

Hello,

What do I do in my grammar to ignore tokens based on parser context as 
described here: 
http://www.antlr.org/wiki/pages/viewpage.action?pageId=1734

Thanks,
Martin

From gudnabrsam at yahoo.com  Tue Feb 20 08:32:47 2007
From: gudnabrsam at yahoo.com (Matt Benson)
Date: Tue, 20 Feb 2007 08:32:47 -0800 (PST)
Subject: [antlr-interest] ignoring tokens baed on parser context
In-Reply-To: <Pine.LNX.4.63.0702201008470.3947@algonquin>
Message-ID: <213236.47588.qm@web55110.mail.re4.yahoo.com>

For those of us (like myself) who are complete idiots
and can't see how the example on this wiki page
blossoms into a complete solution, could you elaborate
on the wiki or on the list? If the latter, I will push
to the wiki.  To be clear, how specifically do you use
this extended TokenStream in code?  I am going to need
this soon.

Thanks,
Matt

--- Martin d'Anjou <martin.danjou at neterion.com> wrote:

> Hello,
> 
> What do I do in my grammar to ignore tokens based on
> parser context as 
> described here: 
>
http://www.antlr.org/wiki/pages/viewpage.action?pageId=1734
> 
> Thanks,
> Martin
> 



 
____________________________________________________________________________________
Any questions? Get answers on any topic at www.Answers.yahoo.com.  Try it now.

From parrt at cs.usfca.edu  Tue Feb 20 11:25:30 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 20 Feb 2007 11:25:30 -0800
Subject: [antlr-interest] ANTLR v3 lexer performance
References: <45D1865C.2050302@sun.com>
Message-ID: <5B564AF8-1941-4A1C-93A0-257E7F6E5554@cs.usfca.edu>

Hi.  Egor Ushakov, from the netbeans project, has some very  
interesting lexer performance numbers.

Terence

Begin forwarded message:
> Hi Terence,
>
> new interesting results below!
> I created small and simple lexer grammar to test our grammar  
> optimizations and here are the results:
>
> this simple lexer grammar only recognizes these tokens (ans  
> whitespaces):
> LESS : '<';
> LESSLESS : '<<';
> LESSEQUALS : '<=';
> LESSLESSEQUALS : '<<=';
>
> Actually my intension was to find why v3 is slower, but...
>
> our super tuned :) antlr v2 with no exceptions and so on seems to  
> be 30% slower on this grammar than v3!
>
> (smaller is better)
> v2Sun                   19859
> v2Sun tuned         17328
> v3                          13000
> v3 tuned               12578
>
> tuned here means that we use combined grammar rule:
>
> FIRST_LESS :
>    '<' ({$type=LESS;}|
>           '<'  {$type=LESSLESS;}|
>           '=' {$type=LESSEQUALS;}|
>           '<=' {$type=LESSLESSEQUALS;}
>          )
>    ;
>
> These result have shown several things:
> 1. this kind of tuning can potentially give 10% in v2 (that's why  
> we already use it :)
> 2. even without this tuning v3 is ~20% faster
> 3. for v3 this kind of tuning gives less improvement ~4%
>
> Looking deeper inside the generated code we can find that in v3:
> - text is not saved in tokens (saving text reduces performance of  
> v3 to ~16000) and this can be done in v2
> - better optimized alternative selection code
>
> Although this test case is very simple, it brings me to an idea  
> that v3 was 60% slower on our lexer grammar because of some kind of  
> big imperfection in predicates generated code or something.
> I will continue analysis.
>
> Egor


From martin.danjou at neterion.com  Tue Feb 20 11:40:26 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 20 Feb 2007 14:40:26 -0500 (EST)
Subject: [antlr-interest] v3 antlr hangs at waitpid
Message-ID: <Pine.LNX.4.63.0702201430140.3947@algonquin>

Hello,

My grammar hangs... or I should say when I use my compiled grammar it 
hangs. I don't know where or how. The -debug switch does not print 
information. This is using 3.0b6.

I ran it with strace to see if I learned something, and it hangs at
waitpid(-1,  <unfinished ...>

The CPU is at 0% utilization, so control-C is the only way out.

How can I debug this problem? Prune things out of my grammar until it no 
longer hangs?

Thanks,
Martin

From parrt at cs.usfca.edu  Tue Feb 20 11:51:03 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 20 Feb 2007 11:51:03 -0800
Subject: [antlr-interest] v3 antlr hangs at waitpid
In-Reply-To: <Pine.LNX.4.63.0702201430140.3947@algonquin>
References: <Pine.LNX.4.63.0702201430140.3947@algonquin>
Message-ID: <B544CE76-75F8-4A8C-8DC6-439FDFDE2E12@cs.usfca.edu>

Hi. If you use -debug, it is a server and waits for AW to connect.
Ter
On Feb 20, 2007, at 11:40 AM, Martin d'Anjou wrote:

> Hello,
>
> My grammar hangs... or I should say when I use my compiled grammar  
> it hangs. I don't know where or how. The -debug switch does not  
> print information. This is using 3.0b6.
>
> I ran it with strace to see if I learned something, and it hangs at
> waitpid(-1,  <unfinished ...>
>
> The CPU is at 0% utilization, so control-C is the only way out.
>
> How can I debug this problem? Prune things out of my grammar until  
> it no longer hangs?
>
> Thanks,
> Martin


From parrt at cs.usfca.edu  Tue Feb 20 11:51:35 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 20 Feb 2007 11:51:35 -0800
Subject: [antlr-interest] v3 ignore=WS gone?
In-Reply-To: <Pine.LNX.4.63.0702200831530.14397@tennents.s2io.com>
References: <Pine.LNX.4.63.0702191813150.10543@algonquin>
	<Pine.LNX.4.63.0702191816190.10543@algonquin>
	<D43540A44D3F794787378D8B08E8AE53F711A8@staexc01.pharmatechnik.de>
	<Pine.LNX.4.63.0702200831530.14397@tennents.s2io.com>
Message-ID: <8BBB7FAC-CD28-4374-AC36-3D980F4638AC@cs.usfca.edu>

v3 doesn't have this feature. sorry.
Ter
On Feb 20, 2007, at 5:39 AM, Martin d'Anjou wrote:

> Yes, I have read about HIDDEN and skip(), but that's not what I  
> meant. I meant ignoring whitespace in the lexer rules before the  
> tokens get to the parser: ie how to tell the INCLUDE lexer rule  
> below to ignore whitespace between it's '#include' and  
> QUOTED_STRING tokens:
>
> WS : ' ';
>
> INCLUDE :
>   options { ignore=WS; }
>   '#include' QUOTED_STRING ;
>   ;
>
> QUOTED_STRING :
>   '"' ( 'a'..'z' | 'A'..'Z' | '.' | ... etc. ) '"'
>   ;
>
> Thanks,
> Martin


From parrt at cs.usfca.edu  Tue Feb 20 11:52:17 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 20 Feb 2007 11:52:17 -0800
Subject: [antlr-interest] DoubleLinkedTree
In-Reply-To: <45DAD26A.5000109@gaengel.de>
References: <45DAD26A.5000109@gaengel.de>
Message-ID: <129E468D-762F-4491-BADE-3928DAF16F79@cs.usfca.edu>

Where does it get the exception?  Is it for the UP and DOWN nodes?
Ter
On Feb 20, 2007, at 2:50 AM, Alexander G?ngel wrote:

> Can Somebody give me a hint how to use DoubleLinkTrees.
>
> I tried it this way:
>
> I have
> ASTLabelType=MyAst; in my V3 Grammar
>
> I created a Class MyAst extends DoubleLinkTree
>
> I Implemented the Abstract functions from BaseTree like in CommonTree
>
> but when I try to use the Grammar I get Exception in thread "main"
> java.lang.ClassCastException: org.antlr.runtime.tree.CommonTree
>
> Alexander
>


From martin.danjou at neterion.com  Tue Feb 20 11:58:31 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 20 Feb 2007 14:58:31 -0500 (EST)
Subject: [antlr-interest] v3 antlr hangs at waitpid
In-Reply-To: <Pine.LNX.4.63.0702201430140.3947@algonquin>
References: <Pine.LNX.4.63.0702201430140.3947@algonquin>
Message-ID: <Pine.LNX.4.63.0702201457210.3947@algonquin>

Ok, the problem is I had options {filter=true;} from an old lexer grammar 
file at the top of my parser grammar. Don't do that.

On Tue, 20 Feb 2007, Martin d'Anjou wrote:

> Hello,
>
> My grammar hangs... or I should say when I use my compiled grammar it hangs. 
> I don't know where or how. The -debug switch does not print information. This 
> is using 3.0b6.
>
> I ran it with strace to see if I learned something, and it hangs at
> waitpid(-1,  <unfinished ...>
>
> The CPU is at 0% utilization, so control-C is the only way out.
>
> How can I debug this problem? Prune things out of my grammar until it no 
> longer hangs?
>
> Thanks,
> Martin
>

From martin.danjou at neterion.com  Tue Feb 20 12:09:12 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 20 Feb 2007 15:09:12 -0500 (EST)
Subject: [antlr-interest] how to say filter=true with combined parser/lexer?
In-Reply-To: <Pine.LNX.4.63.0702201457210.3947@algonquin>
References: <Pine.LNX.4.63.0702201430140.3947@algonquin>
	<Pine.LNX.4.63.0702201457210.3947@algonquin>
Message-ID: <Pine.LNX.4.63.0702201505440.3947@algonquin>

This begs the question: In a combined lexer/parser, is there a way to set 
the lexer option filter=true?

I tried @lexer::options { filter=true; } but it did not work.

Martin

On Tue, 20 Feb 2007, Martin d'Anjou wrote:

> Ok, the problem is I had options {filter=true;} from an old lexer grammar 
> file at the top of my parser grammar. Don't do that.
>
> On Tue, 20 Feb 2007, Martin d'Anjou wrote:
>
>> Hello,
>> 
>> My grammar hangs... or I should say when I use my compiled grammar it 
>> hangs. I don't know where or how. The -debug switch does not print 
>> information. This is using 3.0b6.
>> 
>> I ran it with strace to see if I learned something, and it hangs at
>> waitpid(-1,  <unfinished ...>
>> 
>> The CPU is at 0% utilization, so control-C is the only way out.
>> 
>> How can I debug this problem? Prune things out of my grammar until it no 
>> longer hangs?
>> 
>> Thanks,
>> Martin
>> 
>

From parrt at cs.usfca.edu  Tue Feb 20 13:13:37 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 20 Feb 2007 13:13:37 -0800
Subject: [antlr-interest] how to say filter=true with combined
	parser/lexer?
In-Reply-To: <Pine.LNX.4.63.0702201505440.3947@algonquin>
References: <Pine.LNX.4.63.0702201430140.3947@algonquin>
	<Pine.LNX.4.63.0702201457210.3947@algonquin>
	<Pine.LNX.4.63.0702201505440.3947@algonquin>
Message-ID: <B8471F8B-D8B7-4B2F-8C6D-D7BC40643B65@cs.usfca.edu>


On Feb 20, 2007, at 12:09 PM, Martin d'Anjou wrote:

> This begs the question: In a combined lexer/parser, is there a way  
> to set the lexer option filter=true?
>
> I tried @lexer::options { filter=true; } but it did not work.

good question...hmm...i guess not.  I never really intended that to  
work in a 2-level grammar.  Perhaps just build the lexer in a  
separate .g file.

Ter


From omry at yadan.net  Tue Feb 20 14:10:33 2007
From: omry at yadan.net (Omry Yadan)
Date: Wed, 21 Feb 2007 00:10:33 +0200
Subject: [antlr-interest] v3 antlr hangs at waitpid
In-Reply-To: <B544CE76-75F8-4A8C-8DC6-439FDFDE2E12@cs.usfca.edu>
References: <Pine.LNX.4.63.0702201430140.3947@algonquin>
	<B544CE76-75F8-4A8C-8DC6-439FDFDE2E12@cs.usfca.edu>
Message-ID: <45DB71D9.80202@yadan.net>

This question is asked again and again.

maybe the -debug switch should print "waiting for connection on port
XXX" to the stdout  (if its not doing it already)?



Terence Parr wrote:

> Hi. If you use -debug, it is a server and waits for AW to connect.
> Ter
> On Feb 20, 2007, at 11:40 AM, Martin d'Anjou wrote:
>
>> Hello,
>>
>> My grammar hangs... or I should say when I use my compiled grammar it
>> hangs. I don't know where or how. The -debug switch does not print
>> information. This is using 3.0b6.
>>
>> I ran it with strace to see if I learned something, and it hangs at
>> waitpid(-1,  <unfinished ...>
>>
>> The CPU is at 0% utilization, so control-C is the only way out.
>>
>> How can I debug this problem? Prune things out of my grammar until it
>> no longer hangs?
>>
>> Thanks,
>> Martin
>


From parrt at cs.usfca.edu  Tue Feb 20 14:23:52 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 20 Feb 2007 14:23:52 -0800
Subject: [antlr-interest] v3 antlr hangs at waitpid
In-Reply-To: <45DB71D9.80202@yadan.net>
References: <Pine.LNX.4.63.0702201430140.3947@algonquin>
	<B544CE76-75F8-4A8C-8DC6-439FDFDE2E12@cs.usfca.edu>
	<45DB71D9.80202@yadan.net>
Message-ID: <4F2E1A39-DCD5-4537-8725-37ACC4F6949E@cs.usfca.edu>

good idea...adding to bug list.
Ter
On Feb 20, 2007, at 2:10 PM, Omry Yadan wrote:

> This question is asked again and again.
>
> maybe the -debug switch should print "waiting for connection on port
> XXX" to the stdout  (if its not doing it already)?
>
>
>
> Terence Parr wrote:
>
>> Hi. If you use -debug, it is a server and waits for AW to connect.
>> Ter
>> On Feb 20, 2007, at 11:40 AM, Martin d'Anjou wrote:
>>
>>> Hello,
>>>
>>> My grammar hangs... or I should say when I use my compiled  
>>> grammar it
>>> hangs. I don't know where or how. The -debug switch does not print
>>> information. This is using 3.0b6.
>>>
>>> I ran it with strace to see if I learned something, and it hangs at
>>> waitpid(-1,  <unfinished ...>
>>>
>>> The CPU is at 0% utilization, so control-C is the only way out.
>>>
>>> How can I debug this problem? Prune things out of my grammar  
>>> until it
>>> no longer hangs?
>>>
>>> Thanks,
>>> Martin
>>
>


From voytechs at yahoo.com  Wed Feb 21 03:31:25 2007
From: voytechs at yahoo.com (Mark Bednarczyk)
Date: Wed, 21 Feb 2007 06:31:25 -0500
Subject: [antlr-interest] Working with tree walkers in V3
Message-ID: <20070221113131.1CDB7190895@www.antlr.org>

I'm having difficulty accessing values from my tree walker. The tree is
built and has hierachy of nodes in it. The walker properly matches on the
various rules and that's where my problems start. I can't seem to get the
grasp on all the special $ prefixed attributes. Everything throws NULL ptrs
exceptions when I access them.

Here is my tree that I feed to my tree walker:
(HEADER_DEF (MODIFIERS public) (ID Ethernet) (SLIST (VAR_DEF (MODIFIERS
public field) (TYPE mac) (ID destination))))

I've gotten it down to a fairely manual way of accessing atleast a return
value.

Is there a better way to access the value of the following rule?

modifier returns [String ret]
@finally {
$ret = $m.text;
}
    :   m='public'
    |   m='protected'
    |   m='private'
    |   m='static'
    |   m='final'
    |   m='synchronized'
    |   m='transient'
    |   m='volatile'
    |	  m='field'
    ;

It would be nice if there was a way to tell the rule to return whatever
value it matched such as:

modifier returns [String ret]
@finally {
$ret = $text; // Will throw NULL Ptr exception
}
    :   'public'
    |   'protected'
    |   'private'
    |   'static'
    |   'final'
    |   'synchronized'
    |   'transient'
    |   'volatile'
    |	  'field'
    ;

Again, this is all in "tree grammar".

Cheers,
mark...



From tirelli at post.com  Wed Feb 21 04:58:27 2007
From: tirelli at post.com (Edson Tirelli)
Date: Wed, 21 Feb 2007 09:58:27 -0300
Subject: [antlr-interest] ignoring tokens baed on parser context
In-Reply-To: <213236.47588.qm@web55110.mail.re4.yahoo.com>
References: <213236.47588.qm@web55110.mail.re4.yahoo.com>
Message-ID: <45DC41F3.5030107@post.com>

 
   All,

   You need to take some care when using that token stream but what I 
did was simply to have a semantic action in the parser switching token 
type. For instance, in my use case I wanted to preserve spaces inside a 
curly chunk block and ignoring it outside. So, I have  a "curly chunk" 
rule doing:

curly_chunk
        @init {
           Integer channel = null;
        }
    :
        LEFT_CURLY
        {
            // saving previous channel and switching WS to default channel.
            channel = 
((SwitchingCommonTokenStream)input).getTokenTypeChannel( WS );
            ((SwitchingCommonTokenStream)input).setTokenTypeChannel( WS, 
Token.DEFAULT_CHANNEL );
        }
        // DO YOUR STUFF HERE
        {
            // switching back to original channel
            ((SwitchingCommonTokenStream)input).setTokenTypeChannel(WS, 
channel.intValue());
        }
        RIGHT_CURLY
    ;

     Please note that you need to add the semantic action to switch your 
token type back to original channel just before the end delimiter of you 
context. This is because of the lookahead.

     It may not be a clean way of doing, but was the only way I found to 
do what I needed.

     []s
     Edson

Matt Benson wrote:

>For those of us (like myself) who are complete idiots
>and can't see how the example on this wiki page
>blossoms into a complete solution, could you elaborate
>on the wiki or on the list? If the latter, I will push
>to the wiki.  To be clear, how specifically do you use
>this extended TokenStream in code?  I am going to need
>this soon.
>
>Thanks,
>Matt
>
>--- Martin d'Anjou <martin.danjou at neterion.com> wrote:
>
>  
>
>>Hello,
>>
>>What do I do in my grammar to ignore tokens based on
>>parser context as 
>>described here: 
>>
>>    
>>
>http://www.antlr.org/wiki/pages/viewpage.action?pageId=1734
>  
>
>>Thanks,
>>Martin
>>
>>    
>>
>
>
>
> 
>____________________________________________________________________________________
>Any questions? Get answers on any topic at www.Answers.yahoo.com.  Try it now.
>
>  
>


-- 
 Edson Tirelli
 Software Engineer - JBoss Rules Core Developer
 Office: +55 11 3124-6000
 Mobile: +55 11 9218-4151
 JBoss, a division of Red Hat @ www.jboss.com



From alexander at gaengel.de  Wed Feb 21 05:36:46 2007
From: alexander at gaengel.de (=?ISO-8859-1?Q?Alexander_G=E4ngel?=)
Date: Wed, 21 Feb 2007 14:36:46 +0100
Subject: [antlr-interest] DoubleLinkedTree
In-Reply-To: <129E468D-762F-4491-BADE-3928DAF16F79@cs.usfca.edu>
References: <45DAD26A.5000109@gaengel.de>
	<129E468D-762F-4491-BADE-3928DAF16F79@cs.usfca.edu>
Message-ID: <45DC4AEE.8080800@gaengel.de>

The exception comes when call the parser.Rule

19        CharStream input = new ANTLRFileStream(args[0]);
20        oclLexer lex = new oclLexer(input);
21        CommonTokenStream tokens = new CommonTokenStream(lex);
22
23        oclParser parser = new oclParser(tokens);
24        oclParser.start_return r = parser.start();


Exception in thread "main" java.lang.ClassCastException:
org.antlr.runtime.tree.CommonTree
    at ocl_parser.oclParser.ocl(oclParser.java:186)
    at ocl_parser.oclParser.start(oclParser.java:122)
    at tests.ImBaumsuchen.main(ImBaumsuchen.java:24)

(oclParser.java:122)
117        try {
118            // src/ocl_parser/ocl.g:102:9: ( ocl -> ^( OCL ocl ) )
119            // src/ocl_parser/ocl.g:102:9: ocl
120            {
121            pushFollow(FOLLOW_ocl_in_start193);
122            ocl1=ocl();
123            _fsp--;
124            if (failed) return retval;
125            if ( backtracking==0 ) list_ocl.add(ocl1.getTree());

(oclParser.java:186)
182        try {
183            // src/ocl_parser/ocl.g:105:2: ( ( package_decl | context
)+ )
184            // src/ocl_parser/ocl.g:105:2: ( package_decl | context )+
185            {
186            root_0 = (OclAst)adaptor.nil();
187
188            // src/ocl_parser/ocl.g:105:2: ( package_decl | context )+
189            int cnt1=0;
190            loop1:
191            do {

I tried to make myAst extend DoublelinkTree or Commontree both with same
effect

when I use Commontree in my Grammar everything works fine.

Alexander

Terence Parr schrieb:
> Where does it get the exception?  Is it for the UP and DOWN nodes?
> Ter
> On Feb 20, 2007, at 2:50 AM, Alexander G?ngel wrote:
>
>> Can Somebody give me a hint how to use DoubleLinkTrees.
>>
>> I tried it this way:
>>
>> I have
>> ASTLabelType=MyAst; in my V3 Grammar
>>
>> I created a Class MyAst extends DoubleLinkTree
>>
>> I Implemented the Abstract functions from BaseTree like in CommonTree
>>
>> but when I try to use the Grammar I get Exception in thread "main"
>> java.lang.ClassCastException: org.antlr.runtime.tree.CommonTree
>>
>> Alexander
>>
>

From JeanMarc.Vanel at mathworks.fr  Wed Feb 21 08:32:50 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Wed, 21 Feb 2007 17:32:50 +0100
Subject: [antlr-interest] adding content at end of rule with
	TokenRewriteStream
Message-ID: <632C3E36DCF16649AD770FE2646E9A18014D44C0@message-fr.ad.mathworks.com>

Suppose I have such rules : 

 

rule1 : A B* C?

rule2 : A BB? C*

rule3 : A BBB* C*

 

I'd like to add content after C (when C is present ), using TokenRewriteStream.insertAfter() .

When C is not present, calling . insertAfter( C.stop, "my content" ) triggers a NullPointerException.

 

In all the ? tweak ?  example, one only adds content around unconditional items, i.e. ones with cardinality 1 or + . 

 

Thanks

 

Jean Marc Vanel

Developer

Journal: file://///fr-vanelj-dev.mathworks.fr/Aslrtwn/scp_project/perso/jvanel/journal.html <file:///\\fr-vanelj-dev.mathworks.fr\Aslrtwn\scp_project\perso\jvanel\journal.html> 

The MathWorks      Tel : +33 (0)1 41 14 67 24

20 rue Troyon      Cell: +33 (0)6 89 16 29 52

92316 S?vres       Fax : +33 (0)1 41 14 67 15

France             Web : http://www.mathworks.fr

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070221/89abef92/attachment-0001.html 

From js at cin.ufpe.br  Wed Feb 21 11:22:44 2007
From: js at cin.ufpe.br (Joel da Silva)
Date: Wed, 21 Feb 2007 16:22:44 -0300
Subject: [antlr-interest] ANTLR Error Messages
Message-ID: <37529690702211122x2e7ef03j18bd4f7c0c8243d@mail.gmail.com>

Hello friends,
I am trying to develop an application that uses a parser generated by the
Antlr.
In my application source code, I call:
...
       MDXLexer lexer = new MDXLexer(...
       MDXRecognizer parser = new MDXRecognizer(lexer);
        try {
            parser.mdx_statement();
        }
        catch (RecognitionException e) {
            e.printStackTrace();
        }
        catch (TokenStreamException e) {
            e.printStackTrace();
        }

Thus, sending a erroneous input, a error message will appear:
" line 1:106: unexpected token: null
  line 1:106: expecting "FROM", found 'null'  "

But, how can I return the error messages for my application?  and handling
this message?
thanks for your attention,
best regards
Joel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070221/96be3510/attachment.html 

From parrt at cs.usfca.edu  Wed Feb 21 11:51:02 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 21 Feb 2007 11:51:02 -0800
Subject: [antlr-interest] adding content at end of rule with
	TokenRewriteStream
In-Reply-To: <632C3E36DCF16649AD770FE2646E9A18014D44C0@message-fr.ad.mathworks.com>
References: <632C3E36DCF16649AD770FE2646E9A18014D44C0@message-fr.ad.mathworks.com>
Message-ID: <CF60B2CA-2460-4D5B-90C8-3B9454DBA7A2@cs.usfca.edu>

Hi.  Try using $rule1.stop attribute to get last token.
Ter
On Feb 21, 2007, at 8:32 AM, Jean Marc Vanel wrote:

> Suppose I have such rules :
>
>
>
> rule1 : A B* C?
>
> rule2 : A BB? C*
>
> rule3 : A BBB* C*
>
>
>
> I?d like to add content after C (when C is present ), using  
> TokenRewriteStream.insertAfter() .
>
> When C is not present, calling . insertAfter( C.stop, ?my  
> content? ) triggers a NullPointerException.
>
>
>
> In all the ? tweak ?  example, one only adds content around  
> unconditional items, i.e. ones with cardinality 1 or + .
>
>
>
> Thanks
>
>
>
> Jean Marc Vanel
> Developer
> Journal: file://///fr-vanelj-dev.mathworks.fr/Aslrtwn/scp_project/ 
> perso/jvanel/journal.html
> The MathWorks      Tel : +33 (0)1 41 14 67 24
> 20 rue Troyon      Cell: +33 (0)6 89 16 29 52
> 92316 S?vres       Fax : +33 (0)1 41 14 67 15
> France             Web : http://www.mathworks.fr
>
>
>


From martin.danjou at neterion.com  Wed Feb 21 12:24:47 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Wed, 21 Feb 2007 15:24:47 -0500 (EST)
Subject: [antlr-interest] v3 java error in antlr output
Message-ID: <Pine.LNX.4.63.0702211520520.4004@algonquin>

Hello,

I am getting a java error in antlr output. Here is the snippet of java 
code generated by antlr:

// $ANTLR start list_of_params
// ./antlr/DUMMY_Parser.g:125:1: list_of_params : PARAMETER parameter_assignment ( COMMA parameter_assignment )* ;
public void list_of_params() throws RecognitionException {
     try {
         // ./antlr/DUMMY_Parser.g:126:12: ( PARAMETER parameter_assignment ( COMMA parameter_assignment )* )
         // ./antlr/DUMMY_Parser.g:126:12: PARAMETER parameter_assignment ( COMMA parameter_assignment )*
         {
         match(input,PARAMETER,FOLLOW_PARAMETER_in_list_of_params1152);
          System.out.print("parameter ");
         pushFollow(FOLLOW_parameter_assignment_in_list_of_params1180);
         parameter_assignment();
         _fsp--;

         // ./antlr/DUMMY_Parser.g:128:12: ( COMMA parameter_assignment )*
         loop14:
         do {
             int alt14=2;
             int LA14_0 = input.LA(1);
             if ( (LA14_0==COMMA) ) {
                 switch ( input.LA(2) ) {
                 case IDENTIFIER:
                     int LA14_3 = input.LA(3);
                     if ( (LA14_3==ASSIGN) ) {
                         int LA14_6 = input.LA(4);
                         if ( (LA14_6==IDENTIFIER) ) {
                             alt14=1;
                         }


                     }


                     break;
                 case BITRANGE:
                     int LA14_4 = input.LA(3);
                     if ( (LA14_4==IDENTIFIER) ) {
                         int LA14_3 = input.LA(4);
                         if ( (LA14_3==ASSIGN) ) {
                             int LA14_6 = input.LA(5);
                             if ( (LA14_6==IDENTIFIER) ) {
                                 alt14=1;
                             }


...


The error given by the java compiler is:
LA14_3 is already defined in list_of_params()

Is this a bug or is my grammar throwing antlr off rails?

Thanks,
Martin

From vgusev at graphlogic.com  Wed Feb 21 13:57:08 2007
From: vgusev at graphlogic.com (Vladimir Gusev)
Date: Wed, 21 Feb 2007 16:57:08 -0500
Subject: [antlr-interest] Token categories in grammar file
In-Reply-To: <er4s17$9uo$1@sea.gmane.org>
References: <er1erl$23t$1@sea.gmane.org><bc607a4e0702150521n7ba6b456l58369afe67cd3403@mail.gmail.com>	<er1q19$bhi$1@sea.gmane.org><20070215183726.0813C64D@mail.intersystems.com>
	<er4s17$9uo$1@sea.gmane.org>
Message-ID: <000001c75603$3b458190$186fa8c0@graphlogic.com>

Hello,

Is there a way to assign token categories in the grammar file, which then
could be used to highlight syntax in the editor? I suppose one will have to
make use of a custom Token class augmented with the category field, but how
one tells antlr to set this field?

Thanks.

Vladimir


From NOSPAM at TheSnakePitDev.com  Wed Feb 21 16:56:18 2007
From: NOSPAM at TheSnakePitDev.com (Curtis Clauson)
Date: Wed, 21 Feb 2007 16:56:18 -0800
Subject: [antlr-interest] Lexer Character Set Question (ANTLR3.0b6)
In-Reply-To: <000601c752ab$806338e0$b982e6cd@tsitelsys.com>
References: <000601c752ab$806338e0$b982e6cd@tsitelsys.com>
Message-ID: <eripnk$s01$1@sea.gmane.org>

Your problem is indeed lexer related. The Antlr lexer is separate from 
the parser and is not capable of taking parser context into account. 
There is no way for the lexer to know that the single letter after the 
escape start character '$' is a different token from a sequence of 
letters. This means you must include the escape flag character as part 
of the escape start token.

The following is one way to accomplish this. Tested on antlr-3.0b6:

/*
  * Parser rules
  */
content
     :   (   escape
             {
                 System.out.println(
                       "Escape " + $escape.flag + ": \""
                     + $escape.id + "\""
                 );
             }
         |   Letters
             {
                 System.out.println(
                     "String  : \"" + $Letters.text + "\""
                 );
             }
         )*
     ;

escape
returns [char flag, String id]
     :   EscapeStart Letters EscapeEnd
         {
             $flag = $EscapeStart.text.charAt(0);
             $id   = $Letters.text;
         }
     ;


/*
  * Lexer rules
  */
Letters	    :   Letter+;
EscapeStart :	'$' Letter {setText($Letter.text);};
EscapeEnd   :	')';

fragment
Letter	:	'a'..'z' | 'A'..'Z';



Bert Williams wrote:
> Given the following rules abstracted from a larger grammar:
> 
> using_rule_1: ?$? flag id ')' ;
> flag   : ( 'U' ) ;
> id: (ALPHA)+ ;
> using_rule_2 : (ALPHA)+ ;
> 
> ALPHA : ('a'..'z'|'A'..'Z' ) ;
> 
> 
> I need to understand how to indicate in ?using_rule? that other rules 
> that ALPHA is intended.  I believe that I should use a Semantic 
> Predicate, but can find no way to indicate something like:
> 
> ? if I am in ?using_rule_1?, accept as ?flag? those characters indicated 
> in rule ?flag?. ?
> 
> i.e.,
> The lexer appears to generate different tokes for ?U? and for ALPHA, 
> which means that in ?using_rule_2?, I get no matches for ?U? (one of the 
> flags).  This is true even though ?U? is a member of the ALPHA set.
> 
> Is this the right direction here or should I consider making ?flag? a 
> lexer rule and modifying ALPHA accordlingly?
> 
> Thanks!
> Bert Williams.

-- 
"Any sufficiently over-complicated magic is indistinguishable from 
technology." -- Llelan D.


From rmann at latencyzero.com  Wed Feb 21 19:36:59 2007
From: rmann at latencyzero.com (Rick Mann)
Date: Wed, 21 Feb 2007 19:36:59 -0800
Subject: [antlr-interest] Parsing documentation comments (with nesting!) (v3)
Message-ID: <24443D08-BAD4-47F9-8BDB-8084AB65A5CD@latencyzero.com>

Antlr v3b6.

I've been working an a tool to create a symbol database for the D  
programming language. This means that I don't need a complete parser,  
just enough of one to identify a few "global" symbol definitions. I'm  
doing okay with some language basics, but I'm running in to trouble  
parsing comments. I have a couple of big questions.

If you're unfamiliar, D is a programming language that looks a lot  
like C++ and Java. In particular, it has multiline comments delimited  
by '/*' and '*/'. It has "to-EOL" comments that start with '//' and  
go to the end of the line.

It also has nesting multiline comments. You can delimit a comment  
with '/+' and '+/', and nest these arbitrarily deeply.

A variant of each of these three denotes a Documentation Comment. If  
a comment starts with '/**', '/++' or '///', it is considered  
documentation, and applies to the symbols defined "nearby" (the  
specific rules are not important). The comment itself has a structure  
that would be nice to include in the overall grammar.

At the most basic level, I'd like to be able to get at the content of  
a regular multiline comment. The beta book shows an example like this:

COMMENT
     :    '/*' ( options {greedy=false;} : . )* '*/'
     ;

I've tried this, and it works fine, but I can't get at the text of  
the comment. I tried labeling the subrule, but it didn't like that.  
So I tried this:

COMMENT
     :    '/*'! COMMENTTEXT '*/'! { System.out.println("Found a  
comment [" + $COMMENTTEXT.text + "]"); }
     ;

fragment
COMMENTTEXT
options
{
     greedy = false;
}
     :    .*
     ;

But I get "The following alternatives are unreachable: 1".

(Keep in mind, my grammar will eventually generate an AST, but right  
now has code to help me debug and learn).

I'd like to parse the structure of the Doc Comments, which is  
somewhat line-oriented, so getting each line in turn would be helpful.

Question 1: How would I write a grammar to accommodate this need?

-------------

Question 2: How can I write grammar to essentially skip a function  
body? In D you can both declare and define functions, just like in C:

int foo(char x, int, long y);

or

int bar(char x, int, long y)
{
}

For my purposes, I don't care what happens inside the {}, but since  
braces can nest arbitrarily deeply, I need to parse through it  
properly. I'm having trouble understanding how to avoid the left  
recursion that makes ANTLR choke. In any case, I suspect this grammar  
will look just like the grammar for the nesting comments above,  
except that I can throw out anything inside the body.

I'd really appreciate any help anyone can give. Thank you!

-- 
Rick



From rmann at latencyzero.com  Wed Feb 21 19:41:27 2007
From: rmann at latencyzero.com (Rick Mann)
Date: Wed, 21 Feb 2007 19:41:27 -0800
Subject: [antlr-interest] Specifying ranges with exclusions?
Message-ID: <AD607601-5066-4772-9010-ABC594F8D503@latencyzero.com>

Is there any way to specify a range and then specify arbitrary  
exclusions to the range? Something like:

['\u0020'..'\uFFFE' ~'\u0123' ~['\u0500'..'\u0600']]

I just made up that syntax, but it would be helpful.

TIA,


-- 
Rick



From rmann at latencyzero.com  Wed Feb 21 19:49:07 2007
From: rmann at latencyzero.com (Rick Mann)
Date: Wed, 21 Feb 2007 19:49:07 -0800
Subject: [antlr-interest] Parsing documentation comments (with nesting!)
	(v3)
In-Reply-To: <24443D08-BAD4-47F9-8BDB-8084AB65A5CD@latencyzero.com>
References: <24443D08-BAD4-47F9-8BDB-8084AB65A5CD@latencyzero.com>
Message-ID: <B9212E18-42FD-41C5-AB75-C7C77572D79A@latencyzero.com>


On Feb 21, 2007, at 19:36 , Rick Mann wrote:

> COMMENT
>     :    '/*' ( options {greedy=false;} : . )* '*/'
>     ;
>
> I've tried this, and it works fine, but I can't get at the text of  
> the comment. I tried labeling the subrule, but it didn't like that.  
> So I tried this:
>
> COMMENT
>     :    '/*'! COMMENTTEXT '*/'! { System.out.println("Found a  
> comment [" + $COMMENTTEXT.text + "]"); }
>     ;
>
> fragment
> COMMENTTEXT
> options
> {
>     greedy = false;
> }
>     :    .*
>     ;
>
> But I get "The following alternatives are unreachable: 1".


I noticed one error in the above: the '*" should go after  
"COMMENTTEXT" in the COMMENT rule, but then I can't reference  
$COMMENTTEXT (I get other errors).


From antlr-list at arizona-software.ch  Wed Feb 21 21:54:41 2007
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Wed, 21 Feb 2007 21:54:41 -0800
Subject: [antlr-interest] ANTLRWorks 1.0b9
Message-ID: <0503B6EE-8F62-4841-8CD3-E082BD576507@arizona-software.ch>

Hello,

ANTLRWorks 1.0b9 is now available:

http://www.antlr.org/works/index.html

Changes:

- removed message to console when trying to create the syntax diagram
- improved ability to cancel the grammar checking operation
- can open now files with extension g, gl, gp and gtp.
- fixed a bug where inline template where incorrectly flagged as  
"syntax error"
- fixed a bug introduced in b8 that prevented syntax diagram from  
being displayed when moving the caret in the text pane
- fixed a bug where error reporting was not working properly if  
generating a grammar after checking it

Regards,

Jean


From dave at badgers-in-foil.co.uk  Thu Feb 22 00:49:46 2007
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Thu, 22 Feb 2007 08:49:46 +0000
Subject: [antlr-interest] Parsing documentation comments (with nesting!)
	(v3)
In-Reply-To: <24443D08-BAD4-47F9-8BDB-8084AB65A5CD@latencyzero.com>
References: <24443D08-BAD4-47F9-8BDB-8084AB65A5CD@latencyzero.com>
Message-ID: <20070222084946.GA11628@badgers-in-foil.co.uk>

Hi,

On Wed, Feb 21, 2007 at 07:36:59PM -0800, Rick Mann wrote:
> I've been working an a tool to create a symbol database for the D  
> programming language. This means that I don't need a complete parser,  
> just enough of one to identify a few "global" symbol definitions. I'm  
> doing okay with some language basics, but I'm running in to trouble  
> parsing comments. I have a couple of big questions.
> 
> If you're unfamiliar, D is a programming language that looks a lot  
> like C++ and Java. In particular, it has multiline comments delimited  
> by '/*' and '*/'. It has "to-EOL" comments that start with '//' and  
> go to the end of the line.
> 
> It also has nesting multiline comments. You can delimit a comment  
> with '/+' and '+/', and nest these arbitrarily deeply.

Have you seen the 'island' grammar in the v3 examples?


> A variant of each of these three denotes a Documentation Comment. If  
> a comment starts with '/**', '/++' or '///', it is considered  
> documentation, and applies to the symbols defined "nearby" (the  
> specific rules are not important). The comment itself has a structure  
> that would be nice to include in the overall grammar.
> 
> At the most basic level, I'd like to be able to get at the content of  
> a regular multiline comment. The beta book shows an example like this:
> 
> COMMENT
>     :    '/*' ( options {greedy=false;} : . )* '*/'
>     ;
> 
> I've tried this, and it works fine, but I can't get at the text of  
> the comment. I tried labeling the subrule, but it didn't like that.  
> So I tried this:
> 
> COMMENT
>     :    '/*'! COMMENTTEXT '*/'! { System.out.println("Found a  
> comment [" + $COMMENTTEXT.text + "]"); }
>     ;
> 
> fragment
> COMMENTTEXT
> options
> {
>     greedy = false;
> }
>     :    .*
>     ;
> 
> But I get "The following alternatives are unreachable: 1".
> 
> (Keep in mind, my grammar will eventually generate an AST, but right  
> now has code to help me debug and learn).
> 
> I'd like to parse the structure of the Doc Comments, which is  
> somewhat line-oriented, so getting each line in turn would be helpful.
> 
> Question 1: How would I write a grammar to accommodate this need?

FWIW, I leave the comment in it's 'natural' form, and strip the
start/end markers when I process the AST.  Doing it earlier is resonable
too though -- try using setText() in a COMMENT lexer action and doing
the obvious substring() work:

  http://www.antlr.org/wiki/pages/viewpage.action?pageId=1461


> Question 2: How can I write grammar to essentially skip a function  
> body? In D you can both declare and define functions, just like in C:
> 
> int foo(char x, int, long y);
> 
> or
> 
> int bar(char x, int, long y)
> {
> }
> 
> For my purposes, I don't care what happens inside the {}, but since  
> braces can nest arbitrarily deeply, I need to parse through it  
> properly. I'm having trouble understanding how to avoid the left  
> recursion that makes ANTLR choke. In any case, I suspect this grammar  
> will look just like the grammar for the nesting comments above,  
> except that I can throw out anything inside the body.

How about a construction like,

  function_body_skip
      :    LBRACE
           (any_token_but_brace | function_body_skip)*
           RBRACE
      ;

Where 'any_token_but_brace' is a parser rule that will match any token
allowed in function bodies.


ta,
dave

-- 
http://david.holroyd.me.uk/

From dave at badgers-in-foil.co.uk  Thu Feb 22 01:50:27 2007
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Thu, 22 Feb 2007 09:50:27 +0000
Subject: [antlr-interest] Parsing documentation comments (with nesting!)
	(v3)
In-Reply-To: <20070222084946.GA11628@badgers-in-foil.co.uk>
References: <24443D08-BAD4-47F9-8BDB-8084AB65A5CD@latencyzero.com>
	<20070222084946.GA11628@badgers-in-foil.co.uk>
Message-ID: <20070222095027.GA12548@badgers-in-foil.co.uk>

On Thu, Feb 22, 2007 at 08:49:46AM +0000, David Holroyd wrote:
> On Wed, Feb 21, 2007 at 07:36:59PM -0800, Rick Mann wrote:
> > It also has nesting multiline comments. You can delimit a comment  
> > with '/+' and '+/', and nest these arbitrarily deeply.
> 
> Have you seen the 'island' grammar in the v3 examples?

Actually, if comments can only have further comments nested in them,
then the island grammar example isn't very helpful.  Sorry for the
noise.

-- 
http://david.holroyd.me.uk/

From axel at rauschma.de  Thu Feb 22 05:30:32 2007
From: axel at rauschma.de (Axel Rauschmayer)
Date: Thu, 22 Feb 2007 14:30:32 +0100
Subject: [antlr-interest] v3: Do semantic predicates work differently?
Message-ID: <9975F538-4F17-4407-AFE1-8A141395FE37@rauschma.de>

Given the following grammar (motivation: templates for a web  
application, text in triple brackets is not escaped, all other text  
will be escaped):

block returns [ List<String> value = new ArrayList<String>() ] :
     ( DIRECT_TEXT { $value.add("("+new DirectText 
(DirectText.removeBrackets($DIRECT_TEXT.text))+")"); }
     | ESCAPED_TEXT { $value.add($ESCAPED_TEXT.text); }
     )+;

ESCAPED_TEXT :
     ( {input.LA(2)!='[' || input.LA(3)!='['}?=> '['
     | ~( '[' | '{' | '}' | '\\' )
     )+
;

DIRECT_TEXT :
    '[[[' (options {greedy=false;} : .)* ']]]'
;

and the input "a[[[b]]]c", I get the following warning:
> line 1:1 required (...)+ loop did not match anything at character '['

Any ideas as to why this does not work?

Thanks,

Axel

--
Axel Rauschmayer
http://www.pst.ifi.lmu.de/~rauschma/




From antlr-list at arizona-software.ch  Thu Feb 22 08:27:55 2007
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Thu, 22 Feb 2007 08:27:55 -0800
Subject: [antlr-interest] ANTLRWorks 1.0b9
In-Reply-To: <1172145145.45dd83f95bc81@mail.hds.utc.fr>
References: <0503B6EE-8F62-4841-8CD3-E082BD576507@arizona-software.ch>
	<1172145145.45dd83f95bc81@mail.hds.utc.fr>
Message-ID: <A8278A30-1230-4B9C-AF18-5B9B05CE6876@arizona-software.ch>

I did a quick fix for now: download again the version from online and  
it will work this time.

Jean

On Feb 22, 2007, at 3:52 AM, jean-louis.boulanger at utc.fr wrote:

> Hello,
>
>  I download the MAC OS X version and install it on my MacBoop Pro last
> generation and After the first windows that ask informations. I  
> have the next
> message :
>
>  ANTLRWorks will quit because ANTLR reported an error:
>  no such locale file org/antlr/tool/templates/messages/languages/ 
> fr.stg retrying
> with English locale
>
>  This message appear at all execution.
>
>  How manage this error ?
>
> Selon Jean Bovet <antlr-list at arizona-software.ch>:
>
>> Hello,
>>
>> ANTLRWorks 1.0b9 is now available:
>>
>> http://www.antlr.org/works/index.html
>>
>> Changes:
>>
>> - removed message to console when trying to create the syntax diagram
>> - improved ability to cancel the grammar checking operation
>> - can open now files with extension g, gl, gp and gtp.
>> - fixed a bug where inline template where incorrectly flagged as
>> "syntax error"
>> - fixed a bug introduced in b8 that prevented syntax diagram from
>> being displayed when moving the caret in the text pane
>> - fixed a bug where error reporting was not working properly if
>> generating a grammar after checking it
>>
>> Regards,
>>
>> Jean
>>
>
>
>
>
> -------------------------------------------------
>


From parrt at cs.usfca.edu  Thu Feb 22 10:41:46 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 22 Feb 2007 10:41:46 -0800
Subject: [antlr-interest] Fwd: Next Beta release of The Definitive ANTLR
	Reference
References: <bulk.13788.20070222085343@mike.pragprog.com>
Message-ID: <40E623A8-AA1A-4077-AEF4-9274DD9FF1CB@cs.usfca.edu>

Howdy folks,

Very heavily updated b2 of the book available.

http://www.pragmaticprogrammer.com/titles/tpantlr/index.html

At this point, I'm working on tech reviews (although I'm out of  
action til Sunday) and within 2 weeks we should have a final draft,  
which the copy editor will work on.  I should start the sprint  
towards software v3.0 final release mid March.  Expect v3 final in  
April.  Hooray!  Getting closer.

Terence

Begin forwarded message:

> From: andy at pragprog.com
> Date: February 22, 2007 8:53:43 AM PST
> To: undisclosed-recipients: ;
> Subject: Next Beta release of The Definitive ANTLR Reference
>
> Folks:
>
> I've uploaded the latest beta release (B2) of The Definitive ANTLR  
> Reference.
>
> There's brand new material including:
>
> * Preface
> * Chapter 1, Introduction
> * Chapter 2, The Nature of Computer Languages
> * Chapter 9, Generating Structured Text with Templates and Grammars
> * Chapter 12, Predicated-LL(*) Parsing
> * Revised Chapter 14, Syntactic Predicates.
>
>
> As usual, the update is available for free from
>
>    http://books.pragprog.com/titles/tpantlr/reorder
>
> Enter just two of the three pieces of information to identify your  
> PDF.
> I recommend using your order number and your email address, as  
> these tend
> to be be the most consistent.
>
> Thanks for your support for this project.
>
> /\ndy
>


From rmann at latencyzero.com  Thu Feb 22 10:58:37 2007
From: rmann at latencyzero.com (Rick Mann)
Date: Thu, 22 Feb 2007 10:58:37 -0800
Subject: [antlr-interest] ANTLRworks errors debugging fuzzy grammars
Message-ID: <9C6A4250-EA9F-4D33-814D-3786DC2D861A@latencyzero.com>

I'm trying to write a fuzzy grammar, but it appears that ANTLRWorks  
can't debug them. Is this the case? For example, if I attempt to  
debug the FuzzyJava.g example, I get this:

[10:56:52] java.lang.NullPointerException
	at org.antlr.works.generate.CodeGenerate.getGeneratedClassName 
(Unknown Source)
	at org.antlr.works.generate.CodeGenerate.getGeneratedTextFileName 
(Unknown Source)
	at org.antlr.works.debugger.local.DBLocal.prepare(Unknown Source)
	at org.antlr.works.debugger.local.DBLocal.run(Unknown Source)
	at java.lang.Thread.run(Thread.java:613)



If I try to "Generate Code", it says it can only generate code for  
the Java language.

However, if I just run the ANTLR tool on the grammar, it completes  
without complaint. Am I misunderstanding something?

ANTLRWorks 1.0b9 and ANTLR 3b6

TIA,


-- 
Rick



From rmann at latencyzero.com  Thu Feb 22 11:16:26 2007
From: rmann at latencyzero.com (Rick Mann)
Date: Thu, 22 Feb 2007 11:16:26 -0800
Subject: [antlr-interest] Using fuzzy lexer to build AST
Message-ID: <EC0DC922-6470-4DBA-864C-1F97C043D813@latencyzero.com>

ANTLRv3b6

Is it possible to build an AST using a fuzzy lexer? Do I need to make  
3 separate ANTLR source files (one for the lexer, one for the parser,  
and one for the tree parser)?

I don't need to parse the complete language, but I probably do need  
semantic predicates, and I certainly need some context (to what  
function does this arg belong?).

TIA,

-- 
Rick



From kroepke at classdump.org  Thu Feb 22 12:31:06 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Thu, 22 Feb 2007 21:31:06 +0100
Subject: [antlr-interest] ANTLRworks errors debugging fuzzy grammars
In-Reply-To: <9C6A4250-EA9F-4D33-814D-3786DC2D861A@latencyzero.com>
References: <9C6A4250-EA9F-4D33-814D-3786DC2D861A@latencyzero.com>
Message-ID: <4AABB4DE-3334-41FB-A76C-862FE4712BC8@classdump.org>


On Feb 22, 2007, at 7:58 PM, Rick Mann wrote:

> I'm trying to write a fuzzy grammar, but it appears that ANTLRWorks  
> can't debug them. Is this the case? For example, if I attempt to  
> debug the FuzzyJava.g example, I get this:
>
> [10:56:52] java.lang.NullPointerException
> 	at org.antlr.works.generate.CodeGenerate.getGeneratedClassName 
> (Unknown Source)
> 	at org.antlr.works.generate.CodeGenerate.getGeneratedTextFileName 
> (Unknown Source)
> 	at org.antlr.works.debugger.local.DBLocal.prepare(Unknown Source)
> 	at org.antlr.works.debugger.local.DBLocal.run(Unknown Source)
> 	at java.lang.Thread.run(Thread.java:613)
>
>
>
> If I try to "Generate Code", it says it can only generate code for  
> the Java language.
>
> However, if I just run the ANTLR tool on the grammar, it completes  
> without complaint. Am I misunderstanding something?

No, you aren't: ANTLRWorks uses the ANTLR interpreter which can't do  
syntactic predicates at the moment, so that's why ANTLRWorks misses  
out on this one. :(

sorry about that,

cheers,
-k
-- 
Kay R?pke
http://classdump.org/





From martin.danjou at neterion.com  Thu Feb 22 13:30:35 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Thu, 22 Feb 2007 16:30:35 -0500 (EST)
Subject: [antlr-interest] v3 lexer cannot tell keyword from identifier (very
	strange)
Message-ID: <Pine.LNX.4.63.0702221449350.23757@algonquin>

Hi,

I have a very strange problem in 3.0b6. Given the input text:

     int id;
     int int_id;

The error:

    line 2:4 mismatched input 'int' expecting IDENTIFIER

It is mistaking "int_id" for "int", treating the underscore as a token 
separator. The (ridiculous looking) lexer is:

    lexer grammar DUMMY_Lexer;
    options { filter=true; }

    MOD          : 'mod' ;
    END          : 'end' ;
    DEF          : 'def' ;
    INC          : 'inc' ;
    PAR          : 'par' ;
    INP          : 'inp' ;
    OUT          : 'out' ;
    INO          : 'ino' ;
    INT          : 'int' ;
    WER          : 'wer' ;
    COMMA        : ',' ;
    SEMI         : ';' ;
    L_PAREN      : '(' ;
    R_PAREN      : ')' ;
    ASSIGN       : '=' ;
    SHARP        : '#' ;
    LSHIFT       : '<<' ;
    MULT         : '*' ;
    MINUS        : '-' ;
    PLUS         : '+' ;
    COLON        : ':' ;
    LTEQ         : '<=' ;
    L_CURLY      : '{' ;
    R_CURLY      : '}' ;
    OR           : '|' ;
    SQUARE       :  '[]' ;
    QUOTE        :  '"' ;
    DIGIT        :  '0' ;
    WS           :  (  ' ' | EOL )+ {$channel=HIDDEN;} ;
    EOL          :  ('\r\n'|'\r'|'\n') ;
    LetterC      :  'c' |   Nothing ;
    Nothing      :   't' ;
    SL_COMMENT   :'a';
    ML_COMMENT   : '/' ;
    BASE         : 'b' ;
    BASE_NUM     : DIGIT+ (BASE DIGIT+)? ;

    IDENTIFIER   : ('a'..'z'|UNDERSCORE)+ ;

    fragment
    UNDERSCORE  :  '_' ;

The only token I was able to get out was the QUESTION : '?'; token. When I 
remove any other token (like MOD or other), the error changes to:

     line 1:0 required (...)+ loop did not match anything at input 'int'

Which makes it even weirder...

Now the parser is fairly minimal:

    parser grammar DUMMY_Parser;
    options {
      tokenVocab=DUMMY_Lexer;
    }

    source_text :
      int_defs+
      ;

    int_defs :
      INT            { System.out.print("int "); }
      id=IDENTIFIER  { System.out.print($id.text); }
      SEMI           { System.out.println(";"); }
    ;

Help!!! (and thanks!)
Martin

From vgusev at graphlogic.com  Thu Feb 22 14:02:04 2007
From: vgusev at graphlogic.com (Vladimir Gusev)
Date: Thu, 22 Feb 2007 17:02:04 -0500
Subject: [antlr-interest] Operator overloading?
In-Reply-To: <CF60B2CA-2460-4D5B-90C8-3B9454DBA7A2@cs.usfca.edu>
References: <632C3E36DCF16649AD770FE2646E9A18014D44C0@message-fr.ad.mathworks.com>
	<CF60B2CA-2460-4D5B-90C8-3B9454DBA7A2@cs.usfca.edu>
Message-ID: <001401c756cd$160f62e0$186fa8c0@graphlogic.com>

Hello,

Is there a way to implement in my language operator overloading using ANTLR?
I would appreciate any thoughts about this.

Thanks.

Vladimir


From rschulz at sonic.net  Thu Feb 22 14:21:35 2007
From: rschulz at sonic.net (Randall R Schulz)
Date: Thu, 22 Feb 2007 14:21:35 -0800
Subject: [antlr-interest] Operator overloading?
In-Reply-To: <001401c756cd$160f62e0$186fa8c0@graphlogic.com>
References: <001401c756cd$160f62e0$186fa8c0@graphlogic.com>
Message-ID: <200702221421.35650.rschulz@sonic.net>

Vladimir,

On Thursday 22 February 2007 14:02, Vladimir Gusev wrote:
> Hello,
>
> Is there a way to implement in my language operator overloading using
> ANTLR? I would appreciate any thoughts about this.

Operator overloading is really not a syntactic aspect of any given 
programming language (that I know of). It's more a matter of symbol 
table organization and semantic actions to verify that a fragment of 
code that is (purely) syntactically valid is actually grammatical or 
legal in the larger sense of the rules for valid programs of that 
language.

For example, in Java the methods in a (putative) method overload set 
must each be distinct from all others (in that overload set) without 
regard to their return types (i.e., their argument signatures must all 
be distinct). It would probably not make sense (or even be possible) to 
try to encode this rule syntactically.

Instead, the parser would just make sure the parentheses, argument 
type / argument name pairs, commas, etc. were lexically and 
syntactically valid. Then, once a syntactically correct class 
definition was parsed, a later pass of the compiler (or verifier or 
translator, etc.) would verify the aforementioned rule, along with all 
the other non-syntactic rules governing valid Java programs.


> Thanks.
>
> Vladimir


Randall Schulz

From mblp at mega.ist.utl.pt  Thu Feb 22 14:29:32 2007
From: mblp at mega.ist.utl.pt (Miguel Ping)
Date: Thu, 22 Feb 2007 22:29:32 +0000
Subject: [antlr-interest] Tree Rewrite doubt | errors on parser generation
Message-ID: <ab0bf2c00702221429j1a673fa3s31dd0a8c736dd490@mail.gmail.com>

Hi all!

I am currently trying to port PL/SQL 7 antlr v2 grammar downloadable
from antlr site to antlr v3 b6. The grammar has some tree rewrite
rules that are useful to group statements under a tree like:

sql_statement: sql_command (SEMI)?
        { #sql_statement = #([SQL_STATEMENT, "sql_statement"],
#sql_statement); }

If I understant the tree rewrite rules correctly, this grammar rule
states that the (sub) tree that will be assigned to sql_statement is
to be assigned to a child under the SQL_STATEMENT imaginary token with
the name "sql_statement". For me to port those definitions to antlr
v3, should I do it this way:

sql_statement: sql_command (SEMI)? -> ^(SQL_STATEMENT sql_statement);

Because if I do it that way, antlr tool tells me that the
'sql_statement' does not exist on the left side of  the '->' symbol:
error(136): reference to rewrite element sqlStatement without
reference on left of ->
How should I work this out?


There are 2 other errors happening in the generated parser code:

1. The symbol LA27_1 in the following method does not exist:

 public int specialStateTransition(int s) throws NoViableAltException {
        	int _s = s;
            switch ( s ) {
                    case 0 :
                        input.rewind();
                        s = -1;
                        if ( (LA27_1==OPEN_PAREN||LA27_1==DOT) ) {s =
14;} //error here
                        else if ( (synpred7()) ) {s = 9;}
                         (...)

Since this method overrides the one in the DFA, I guess that this must
be a problem with the generator, but I can be wrong...

2. In the rule

variable : ( ( columnSpec ( OPEN_PAREN PLUS CLOSE_PAREN ) )=>
columnSpec ( OPEN_PAREN PLUS CLOSE_PAREN ) | columnSpec );

The parser code for the return tree I guess is in this method, which
has alot of if's and cases:

    public variable_return variable() throws RecognitionException {
     (...)
     int LA29_5 = input.LA(7);
     (...)
The problem is that the variable 'int LA29_5' is being duplicated in
alot of places on this method. Is this because of my rule, or can it
be a antlr bug?

Thanks In advance!

From martin.danjou at neterion.com  Thu Feb 22 15:14:16 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Thu, 22 Feb 2007 18:14:16 -0500 (EST)
Subject: [antlr-interest] v3 lexer cannot tell keyword from identifier
 (very strange)
In-Reply-To: <ab0bf2c00702221506w64393e5bgd2b77d45c68dfcf0@mail.gmail.com>
References: <Pine.LNX.4.63.0702221449350.23757@algonquin>
	<ab0bf2c00702221506w64393e5bgd2b77d45c68dfcf0@mail.gmail.com>
Message-ID: <Pine.LNX.4.63.0702221811160.23757@algonquin>

On Thu, 22 Feb 2007, Miguel Ping wrote:

> Doesn't it has to do with  precedence? My (maybe stupid) guess is that
> antlr is trying to match int before that trying to match int_id..

I tried putting the IDENTIFIER token definition first, and when I do that, 
I get:

       line 1:0 required (...)+ loop did not match anything at input 'int'

So I don't know what's going on. It's like the tokenizer is non-greedy for 
some reason.

As I said, it is very strange.

Martin

> On 2/22/07, Martin d'Anjou <martin.danjou at neterion.com> wrote:
>> Hi,
>> 
>> I have a very strange problem in 3.0b6. Given the input text:
>>
>>      int id;
>>      int int_id;
>> 
>> The error:
>>
>>     line 2:4 mismatched input 'int' expecting IDENTIFIER
>> 
>> It is mistaking "int_id" for "int", treating the underscore as a token
>> separator. The (ridiculous looking) lexer is:
>>
>>     lexer grammar DUMMY_Lexer;
>>     options { filter=true; }
>>
>>     MOD          : 'mod' ;
>>     END          : 'end' ;
>>     DEF          : 'def' ;
>>     INC          : 'inc' ;
>>     PAR          : 'par' ;
>>     INP          : 'inp' ;
>>     OUT          : 'out' ;
>>     INO          : 'ino' ;
>>     INT          : 'int' ;
>>     WER          : 'wer' ;
>>     COMMA        : ',' ;
>>     SEMI         : ';' ;
>>     L_PAREN      : '(' ;
>>     R_PAREN      : ')' ;
>>     ASSIGN       : '=' ;
>>     SHARP        : '#' ;
>>     LSHIFT       : '<<' ;
>>     MULT         : '*' ;
>>     MINUS        : '-' ;
>>     PLUS         : '+' ;
>>     COLON        : ':' ;
>>     LTEQ         : '<=' ;
>>     L_CURLY      : '{' ;
>>     R_CURLY      : '}' ;
>>     OR           : '|' ;
>>     SQUARE       :  '[]' ;
>>     QUOTE        :  '"' ;
>>     DIGIT        :  '0' ;
>>     WS           :  (  ' ' | EOL )+ {$channel=HIDDEN;} ;
>>     EOL          :  ('\r\n'|'\r'|'\n') ;
>>     LetterC      :  'c' |   Nothing ;
>>     Nothing      :   't' ;
>>     SL_COMMENT   :'a';
>>     ML_COMMENT   : '/' ;
>>     BASE         : 'b' ;
>>     BASE_NUM     : DIGIT+ (BASE DIGIT+)? ;
>>
>>     IDENTIFIER   : ('a'..'z'|UNDERSCORE)+ ;
>>
>>     fragment
>>     UNDERSCORE  :  '_' ;
>> 
>> The only token I was able to get out was the QUESTION : '?'; token. When I
>> remove any other token (like MOD or other), the error changes to:
>>
>>      line 1:0 required (...)+ loop did not match anything at input 'int'
>> 
>> Which makes it even weirder...
>> 
>> Now the parser is fairly minimal:
>>
>>     parser grammar DUMMY_Parser;
>>     options {
>>       tokenVocab=DUMMY_Lexer;
>>     }
>>
>>     source_text :
>>       int_defs+
>>       ;
>>
>>     int_defs :
>>       INT            { System.out.print("int "); }
>>       id=IDENTIFIER  { System.out.print($id.text); }
>>       SEMI           { System.out.println(";"); }
>>     ;
>> 
>> Help!!! (and thanks!)
>> Martin
>> 
>

From martin.danjou at neterion.com  Thu Feb 22 15:30:04 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Thu, 22 Feb 2007 18:30:04 -0500 (EST)
Subject: [antlr-interest] Using fuzzy lexer to build AST
Message-ID: <Pine.LNX.4.63.0702221814580.23757@algonquin>

> ANTLRv3b6
>
> Is it possible to build an AST using a fuzzy lexer? Do I need to make
> 3 separate ANTLR source files (one for the lexer, one for the parser,
> and one for the tree parser)?

I have the same problem, except I don't need a tree. I had to have two 
files, one for the lexer and another one for the parser, because I am lazy 
and I wanted to say filter=true in the lexer because then I don't have to 
define every token in the language I am parsing. Since there is no way to 
specify filter=true in a combined grammar, I had to use 2 grammar files: 
lexer and parser.

The idea I have followed is to strategically place a catch all rule in the 
parser that takes every token the lexer passes and simply does nothing 
with them (no tree construction, not printing to screen). The catch all is 
a massive rule OR'ing every non-fragment tokens of the lexer. All 
non-defined language keywords end up being swallowed as IDENTIFIERs (and 
ignored in the catch all parser rule). I am lucky enough that the parser 
knows when to go in catch all mode (simply the parsing context), and when 
to get out (there is a keyword).

Everything works according to plans for me, except that the lexer has 
problems distinguishing between keywords and identifiers... see my earlier 
posting today. I don't know what I'll do with that. Maybe I'll have to ask 
the coders to not hide keywords inside identifiers (like "int_is_nice" 
because the lexer see "int" in it). This would suck though.

Good luck,
Martin

From rmann at latencyzero.com  Thu Feb 22 15:35:13 2007
From: rmann at latencyzero.com (Rick Mann)
Date: Thu, 22 Feb 2007 15:35:13 -0800
Subject: [antlr-interest] Using fuzzy lexer to build AST
In-Reply-To: <Pine.LNX.4.63.0702221814580.23757@algonquin>
References: <Pine.LNX.4.63.0702221814580.23757@algonquin>
Message-ID: <5A9F968C-E153-4531-A57A-922BC9C9D0B6@latencyzero.com>


On Feb 22, 2007, at 15:30 , Martin d'Anjou wrote:

> Everything works according to plans for me, except that the lexer  
> has problems distinguishing between keywords and identifiers... see  
> my earlier posting today. I don't know what I'll do with that.  
> Maybe I'll have to ask the coders to not hide keywords inside  
> identifiers (like "int_is_nice" because the lexer see "int" in it).  
> This would suck though.

I agree, that would suck. At least, for me it would.

I'll try that out when I go back to working on the parser. Thanks for  
the encouragement!

-- 
Rick



From vgusev at graphlogic.com  Thu Feb 22 18:03:46 2007
From: vgusev at graphlogic.com (vgusev at graphlogic.com)
Date: Thu, 22 Feb 2007 21:03:46 -0500 (EST)
Subject: [antlr-interest] Operator overloading?
In-Reply-To: <200702221421.35650.rschulz@sonic.net>
References: <001401c756cd$160f62e0$186fa8c0@graphlogic.com>
	<200702221421.35650.rschulz@sonic.net>
Message-ID: <4773.75.53.71.66.1172196226.squirrel@webmail.graphlogic.com>

> Vladimir,
>
> On Thursday 22 February 2007 14:02, Vladimir Gusev wrote:
>> Hello,
>>
>> Is there a way to implement in my language operator overloading using
>> ANTLR? I would appreciate any thoughts about this.
>
> Operator overloading is really not a syntactic aspect of any given
> programming language (that I know of). It's more a matter of symbol
> table organization and semantic actions to verify that a fragment of
> code that is (purely) syntactically valid is actually grammatical or
> legal in the larger sense of the rules for valid programs of that
> language.
>
> For example, in Java the methods in a (putative) method overload set
> must each be distinct from all others (in that overload set) without
> regard to their return types (i.e., their argument signatures must all
> be distinct). It would probably not make sense (or even be possible) to
> try to encode this rule syntactically.
>
> Instead, the parser would just make sure the parentheses, argument
> type / argument name pairs, commas, etc. were lexically and
> syntactically valid. Then, once a syntactically correct class
> definition was parsed, a later pass of the compiler (or verifier or
> translator, etc.) would verify the aforementioned rule, along with all
> the other non-syntactic rules governing valid Java programs.
>
>
>> Thanks.
>>
>> Vladimir
>
>
> Randall Schulz
>
Dear Randall,

Thank you for your thoughtful response. I was done with the first phase
you outlined and started on the second, and was stricken by the thought
that I might be missing something obvious, which could save me a lot of
hand coding. It seems I am on the right path. Thanks!

Vladimir



From josephg at cse.unsw.edu.au  Thu Feb 22 21:43:07 2007
From: josephg at cse.unsw.edu.au (Joseph Gentle)
Date: Fri, 23 Feb 2007 16:43:07 +1100
Subject: [antlr-interest] Code generation in beta 6
Message-ID: <1F0B4687-B5C5-422F-9F09-65652F3B1EE0@cse.unsw.edu.au>

Trying to compile code with the CSharp target in 3.0 beta 6 gets this  
error for me:

ANTLR Parser Generator  Version 3.0b6 (Jan 31, 2007)  1989-2007
error(10):  internal error: group CSharp does not satisfy interface  
ANTLRCore: missing templates [lexerRulePropertyRef_start,  
lexerRulePropertyRef_stop]

error(10):  internal error: group CSharp does not satisfy interface  
ANTLRCore: mismatched arguments on these templates [outputFile(LEXER,  
PARSER, TREE_PARSER, actionScope, actions, docComment, recognizer,  
name, tokens, tokenNames, rules, cyclicDFAs, bitsets, buildTemplate,  
buildAST, rewrite, profile, backtracking, synpreds, memoize,  
numRules, fileName, ANTLRVersion, generatedTimestamp, trace, scopes,  
superClass, literals), listLabel(label, elem)]

error(10):  internal error: SimpleCalc.g :  
java.util.NoSuchElementException: no such attribute: buildAST in  
template context [outputFile]


It looks like the CSharp code generation hasn't been touched since  
the code generation interface was changed recently....

-J

From kroepke at classdump.org  Fri Feb 23 01:06:32 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Fri, 23 Feb 2007 10:06:32 +0100
Subject: [antlr-interest] Code generation in beta 6
In-Reply-To: <1F0B4687-B5C5-422F-9F09-65652F3B1EE0@cse.unsw.edu.au>
References: <1F0B4687-B5C5-422F-9F09-65652F3B1EE0@cse.unsw.edu.au>
Message-ID: <2A7600D6-D769-4834-B393-D8CD1ED3CBD8@classdump.org>


On Feb 23, 2007, at 6:43 AM, Joseph Gentle wrote:

> It looks like the CSharp code generation hasn't been touched since  
> the code generation interface was changed recently....

Yes, unfortunately that's true for the Objective-C stuff, too :(

Sorry for the inconvenience,

-k
-- 
Kay R?pke
http://classdump.org/





From JeanMarc.Vanel at mathworks.fr  Fri Feb 23 06:52:40 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Fri, 23 Feb 2007 15:52:40 +0100
Subject: [antlr-interest] adding content at end of rule
	withTokenRewriteStream
Message-ID: <632C3E36DCF16649AD770FE2646E9A18014D48EF@message-fr.ad.mathworks.com>



> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Terence Parr
> Sent: Wednesday, February 21, 2007 8:51 PM
> To: ANTLR Interest
> Subject: Re: [antlr-interest] adding content at end of rule
> withTokenRewriteStream
> 
> Hi.  Try using $rule1.stop attribute to get last token.
[Jean-Marc Vanel] With that the generated Java doesn't compile.
If you want a ready to run test, here it is.
It produces this:
Exception in thread "main" java.lang.NullPointerException
	at org.antlr.runtime.TokenRewriteStream.insertAfter(TokenRewriteStream.java:300)
------------------
grammar testAddContentAtEndOfRule;

@parser::members {
	TokenRewriteStream tokens;
}

name_or_pointer
@init {
    tokens = (TokenRewriteStream)input;
}
    	:	NAME (star='*')?
		{ tokens.insertAfter( star.stop, " == after '*' ===" ); }
	;

NAME
    : LETTER LETTER *
    ;

fragment LETTER
    : 'a'..'z'
    | 'A'..'Z'
    ;

WS  : (' '|'\r'|'\t'|'\u000C'|'\n') {$channel=99;}
    ;
----------------------------
import org.antlr.runtime.*;
public class MainTweakTestBug {
	public static void main(String[] args) throws Exception {
		CharStream input = new ANTLRStringStream ( "var" );
		// doesn't crash with "var*"
		testAddContentAtEndOfRuleLexer lex = new testAddContentAtEndOfRuleLexer(input);
		TokenStream tokens = new TokenRewriteStream(lex);
		testAddContentAtEndOfRuleParser parser = new testAddContentAtEndOfRuleParser(tokens);
		parser.name_or_pointer();
		System.out.println(tokens);
	}
}
-------------------------------


> Ter
> On Feb 21, 2007, at 8:32 AM, Jean Marc Vanel wrote:
> 
> > Suppose I have such rules :
> >
> >
> >
> > rule1 : A B* C?
> >
> > rule2 : A BB? C*
> >
> > rule3 : A BBB* C*
> >
> >
> >
> > I'd like to add content after C (when C is present ), using
> > TokenRewriteStream.insertAfter() .
> >
> > When C is not present, calling . insertAfter( C.stop, "my
> > content" ) triggers a NullPointerException.
> >
> >
> >
> > In all the ? tweak ?  example, one only adds content around
> > unconditional items, i.e. ones with cardinality 1 or + .
> >
> >
> >
> > Thanks
> >
> >
> >
> > Jean Marc Vanel
> > Developer
> > Journal: file://///fr-vanelj-dev.mathworks.fr/Aslrtwn/scp_project/
> > perso/jvanel/journal.html
> > The MathWorks      Tel : +33 (0)1 41 14 67 24
> > 20 rue Troyon      Cell: +33 (0)6 89 16 29 52
> > 92316 S?vres       Fax : +33 (0)1 41 14 67 15
> > France             Web : http://www.mathworks.fr
> >
> >
> >


From dave at badgers-in-foil.co.uk  Fri Feb 23 08:02:31 2007
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Fri, 23 Feb 2007 16:02:31 +0000
Subject: [antlr-interest] adding content at end of rule
	withTokenRewriteStream
In-Reply-To: <632C3E36DCF16649AD770FE2646E9A18014D48EF@message-fr.ad.mathworks.com>
References: <632C3E36DCF16649AD770FE2646E9A18014D48EF@message-fr.ad.mathworks.com>
Message-ID: <20070223160231.GA3287@badgers-in-foil.co.uk>

On Fri, Feb 23, 2007 at 03:52:40PM +0100, Jean Marc Vanel wrote:
> Exception in thread "main" java.lang.NullPointerException
> 	at org.antlr.runtime.TokenRewriteStream.insertAfter(TokenRewriteStream.java:300)
> ------------------
> grammar testAddContentAtEndOfRule;
> 
> @parser::members {
> 	TokenRewriteStream tokens;
> }
> 
> name_or_pointer
> @init {
>     tokens = (TokenRewriteStream)input;
> }
>     	:	NAME (star='*')?
> 		{ tokens.insertAfter( star.stop, " == after '*' ===" ); }
> 	;

Maybe put the action inside the (...)? so that it only executes if there
is a star present?


> 		CharStream input = new ANTLRStringStream ( "var" );
> 		// doesn't crash with "var*"
> 		testAddContentAtEndOfRuleLexer lex = new testAddContentAtEndOfRuleLexer(input);
> 		TokenStream tokens = new TokenRewriteStream(lex);
> 		testAddContentAtEndOfRuleParser parser = new testAddContentAtEndOfRuleParser(tokens);
> 		parser.name_or_pointer();


-- 
http://david.holroyd.me.uk/

From ilia at obnovlenie.ru  Fri Feb 23 08:20:42 2007
From: ilia at obnovlenie.ru (Ilia Kantor)
Date: Fri, 23 Feb 2007 19:20:42 +0300
Subject: [antlr-interest] Fwd: Next Beta release of The Definitive ANTLR
	Reference
In-Reply-To: <40E623A8-AA1A-4077-AEF4-9274DD9FF1CB@cs.usfca.edu>
References: <bulk.13788.20070222085343@mike.pragprog.com>
	<40E623A8-AA1A-4077-AEF4-9274DD9FF1CB@cs.usfca.edu>
Message-ID: <200702231920.42333.ilia@obnovlenie.ru>


> Howdy folks,
>
> Very heavily updated b2 of the book available.
>
> http://www.pragmaticprogrammer.com/titles/tpantlr/index.html

The cover decoration (including picture) for such kind of book seems very very 
horribly bad for me.

Couldn't help posting that into discussion.



-------------
Kantor Ilia

From JeanMarc.Vanel at mathworks.fr  Fri Feb 23 08:22:41 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Fri, 23 Feb 2007 17:22:41 +0100
Subject: [antlr-interest] adding content at end of
	rulewithTokenRewriteStream
Message-ID: <632C3E36DCF16649AD770FE2646E9A18014D495E@message-fr.ad.mathworks.com>

....
> > name_or_pointer
> > @init {
> >     tokens = (TokenRewriteStream)input;
> > }
> >     	:	NAME (star='*')?
> > 		{ tokens.insertAfter( star.stop, " == after '*' ===" );
}
> > 	;
> 
> Maybe put the action inside the (...)? so that it only executes if
there
> is a star present?

[Jean-Marc Vanel] Sure that would prevent the NullPointerException.

But my goal here is to add something after the end of the rule
"name_or_pointer", independently of the presence or absence of '*' .

In all the examples and doc. for v. 3.0, I couldn't find a clue for a
reference to the last token matched by the current rule.

JMV

From rschulz at sonic.net  Fri Feb 23 08:33:21 2007
From: rschulz at sonic.net (Randall R Schulz)
Date: Fri, 23 Feb 2007 08:33:21 -0800
Subject: [antlr-interest] Fwd: Next Beta release of The Definitive ANTLR
	Reference
In-Reply-To: <200702231920.42333.ilia@obnovlenie.ru>
References: <bulk.13788.20070222085343@mike.pragprog.com>
	<40E623A8-AA1A-4077-AEF4-9274DD9FF1CB@cs.usfca.edu>
	<200702231920.42333.ilia@obnovlenie.ru>
Message-ID: <200702230833.21781.rschulz@sonic.net>

On Friday 23 February 2007 08:20, Ilia Kantor wrote:
> > Howdy folks,
> >
> > Very heavily updated b2 of the book available.
> >
> > http://www.pragmaticprogrammer.com/titles/tpantlr/index.html
>
> The cover decoration (including picture) for such kind of book seems
> very very horribly bad for me.

Well, if not bad, a bit obvious...

But then, dragons have already been done.


> ...
> Kantor Ilia


Randall Schulz

From hugo.a.garcia at gmail.com  Fri Feb 23 09:27:17 2007
From: hugo.a.garcia at gmail.com (Hugo Garcia)
Date: Fri, 23 Feb 2007 12:27:17 -0500
Subject: [antlr-interest] Fwd: Next Beta release of The Definitive ANTLR
	Reference
In-Reply-To: <200702230833.21781.rschulz@sonic.net>
References: <bulk.13788.20070222085343@mike.pragprog.com>
	<40E623A8-AA1A-4077-AEF4-9274DD9FF1CB@cs.usfca.edu>
	<200702231920.42333.ilia@obnovlenie.ru>
	<200702230833.21781.rschulz@sonic.net>
Message-ID: <f9637ada0702230927p59b3f5f0xcef31965d7787ef8@mail.gmail.com>

I think the book cover should read in nice big red friendly letters
"Don't Panic".

-H

On 2/23/07, Randall R Schulz <rschulz at sonic.net> wrote:
> On Friday 23 February 2007 08:20, Ilia Kantor wrote:
> > > Howdy folks,
> > >
> > > Very heavily updated b2 of the book available.
> > >
> > > http://www.pragmaticprogrammer.com/titles/tpantlr/index.html
> >
> > The cover decoration (including picture) for such kind of book seems
> > very very horribly bad for me.
>
> Well, if not bad, a bit obvious...
>
> But then, dragons have already been done.
>
>
> > ...
> > Kantor Ilia
>
>
> Randall Schulz
>

From dave at badgers-in-foil.co.uk  Fri Feb 23 09:27:51 2007
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Fri, 23 Feb 2007 17:27:51 +0000
Subject: [antlr-interest] adding content at end of
	rulewithTokenRewriteStream
In-Reply-To: <632C3E36DCF16649AD770FE2646E9A18014D495E@message-fr.ad.mathworks.com>
References: <632C3E36DCF16649AD770FE2646E9A18014D495E@message-fr.ad.mathworks.com>
Message-ID: <20070223172751.GA4350@badgers-in-foil.co.uk>

On Fri, Feb 23, 2007 at 05:22:41PM +0100, Jean Marc Vanel wrote:
> ....
> > > name_or_pointer
> > > @init {
> > >     tokens = (TokenRewriteStream)input;
> > > }
> > >     	:	NAME (star='*')?
> > > 		{ tokens.insertAfter( star.stop, " == after '*' ===" );
> }
> > > 	;
> > 
> > Maybe put the action inside the (...)? so that it only executes if
> > there is a star present?
> 
> [Jean-Marc Vanel] Sure that would prevent the NullPointerException.
> 
> But my goal here is to add something after the end of the rule
> "name_or_pointer", independently of the presence or absence of '*' .

Oops, sorry.  So how about this, in the rule that uses name_or_pointer:

  np=name_or_pointer { tokens.insertAfter($np.tree.stop, ...); }

i.e. if there's some chance that bits of syntax will be missing, hoist
the insertion code up high enough in the grammar that there's guaranteed
to be some subtree with real tokens present to work on.

?

ta,
dave

-- 
http://david.holroyd.me.uk/

From JeanMarc.Vanel at mathworks.fr  Fri Feb 23 10:48:48 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Fri, 23 Feb 2007 19:48:48 +0100
Subject: [antlr-interest] adding content at end
	ofrulewithTokenRewriteStream
Message-ID: <632C3E36DCF16649AD770FE2646E9A18014D498B@message-fr.ad.mathworks.com>

Jean Marc Vanel wrote:
> > ....
> > > > name_or_pointer
> > > > @init {
> > > >     tokens = (TokenRewriteStream)input;
> > > > }
> > > >     	:	NAME (star='*')?
> > > > 		{ tokens.insertAfter( star.stop, " == after '*'
===" );
> > }
> > > > 	;
> > >
> > > Maybe put the action inside the (...)? so that it only executes if
> > > there is a star present?
> >
> > [Jean-Marc Vanel] Sure that would prevent the NullPointerException.
> >
> > But my goal here is to add something after the end of the rule
> > "name_or_pointer", independently of the presence or absence of '*' .
> 
> Oops, sorry.  So how about this, in the rule that uses
name_or_pointer:
> 
>   np=name_or_pointer { tokens.insertAfter($np.tree.stop, ...); }
> 
> i.e. if there's some chance that bits of syntax will be missing, hoist
> the insertion code up high enough in the grammar that there's
guaranteed
> to be some subtree with real tokens present to work on.

[Jean-Marc Vanel] But if there are many places where this rule appears,
I don't want to paste the same thing in many places.
Indeed, there are tokens for that rule, it's just that in the action
language I can't get hold on the last token.

There seems to be something missing.
Is that possible in Antlr 2.X ?

JMV

From antlr at mirality.co.nz  Fri Feb 23 12:42:56 2007
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 24 Feb 2007 09:42:56 +1300
Subject: [antlr-interest] adding content at end of
 rulewithTokenRewriteStream
Message-ID: <7.0.1.0.0.20070224093628.0347e710@mirality.co.nz>

At 09:19 24/02/2007, Jean Marc Vanel wrote:
 >> >     	:	NAME (star='*')?
 >> >   { tokens.insertAfter( star.stop, " == after '*' ===" ); }
 >> > 	;
 >>
 >But my goal here is to add something after the end of the rule
 >"name_or_pointer", independently of the presence or absence of
 >'*'.

How about this then:

name_or_pointer
@init {
     tokens = (TokenRewriteStream)input;
}
     : NAME star='*' { tokens.insertAfter(star.stop, "whatever"); 
}
     | name=NAME     { tokens.insertAfter(name.stop, "whatever"); 
}
     ;

Or, since the above may produce an ambiguity warning:

name_or_pointer
@init {
     tokens = (TokenRewriteStream)input;
}
     : name=NAME (star='*')?
     { tokens.insertAfter(((star == null) ? name : star).stop, 
"whatever"); }
     ;

(In C#2, you could use "star ?? name" instead.  I'm not sure if 
Java has an equivalent.)


From ilia at obnovlenie.ru  Fri Feb 23 15:53:32 2007
From: ilia at obnovlenie.ru (Ilia Kantor)
Date: Sat, 24 Feb 2007 02:53:32 +0300
Subject: [antlr-interest] Fwd: Next Beta release of The Definitive ANTLR
	Reference
In-Reply-To: <f9637ada0702230927p59b3f5f0xcef31965d7787ef8@mail.gmail.com>
References: <bulk.13788.20070222085343@mike.pragprog.com>
	<200702230833.21781.rschulz@sonic.net>
	<f9637ada0702230927p59b3f5f0xcef31965d7787ef8@mail.gmail.com>
Message-ID: <200702240253.32942.ilia@obnovlenie.ru>


> I think the book cover should read in nice big red friendly letters
> "Don't Panic".

When I look at that red style and apocalyptic picture...
... I really do await such words and "save your soul" brochure inside.


2ALL:
Again, what are your first impression ? Not sure if it's only me thinking like 
that..


>
> -H
>
> On 2/23/07, Randall R Schulz <rschulz at sonic.net> wrote:
> > On Friday 23 February 2007 08:20, Ilia Kantor wrote:
> > > > Howdy folks,
> > > >
> > > > Very heavily updated b2 of the book available.
> > > >
> > > > http://www.pragmaticprogrammer.com/titles/tpantlr/index.html
> > >
> > > The cover decoration (including picture) for such kind of book seems
> > > very very horribly bad for me.
> >
> > Well, if not bad, a bit obvious...
> >
> > But then, dragons have already been done.
> >
> > > ...
> > > Kantor Ilia
> >
> > Randall Schulz



From NOSPAM at TheSnakePitDev.com  Fri Feb 23 18:31:35 2007
From: NOSPAM at TheSnakePitDev.com (Curtis Clauson)
Date: Fri, 23 Feb 2007 18:31:35 -0800
Subject: [antlr-interest] Lexer escape conversions
Message-ID: <ero829$agq$1@sea.gmane.org>

I've been experimenting with using Antlr to create parsers for escape 
sequences. The test grammar I'm using is composed of words delimited by 
whitespace. A word is composed of upper/lower case letters and escape 
sequences. The escapes are composed of the '@' character followed by 
either 'a', 'b', or 'c' that represent the characters '@', '#', and '$' 
respectively.

This is easy, but clumsy, to accomplish in the parser as follows:
----------
/*
  * Parser Rules
  */

// List the words and drop the whitespace.
content
@init {System.out.println("Words:");}
     :   (
             w1=word             {System.out.println("  " + $w1.text);}
             (Whitespace w2=word {System.out.println("  " + $w2.text);})*
         )?
     ;

// Collect letters and escapes, but not whitespace, into words.
word : (Letters | Escape)+;


/*
  * Lexer Rules
  */

Letters    : Letter+;
Whitespace : (' ' | '\t' | '\u000B' | '\f' | '\r' | '\n')+;
Escape
     :    EscapeFlag (
              'a'  {text = "@";}
          |   'b'  {text = "#";}
          |   'c'  {text = "$";}
          )
     ;

fragment EscapeFlag : '@';
fragment Letter     : 'a'..'z' | 'A'..'Z';
----------

It would be cleaner to use the lexer to combine letters and converted 
escapes into word tokens. Since an Escape sequence cannot be a token, it 
must be a fragment that returns the converted value. The Word token rule 
can then append Letters text and Escape values into a single string. The 
parser just gets Word tokens that already include the converted escape 
values. The following should work:

----------
/*
  * Parser Rules
  */

content
@init {System.out.println("Words:");}
     :   (
             Word  {System.out.println("  " + $Word.text);}
         )*
     ;


/*
  * Lexer Rules
  */

// Gather sequences of letters and escapes between whitespace
// into words.
Word
@init {text = "";}
     :   (
             Letters  {text += $Letters.text;}
         |   Escape   {text += $Escape.value;}
         )+
     ;
Whitespace
     :   (' ' | '\t' | '\u000B' | '\f' | '\r' | '\n')+
         {$channel = HIDDEN;}
     ;

fragment Escape
returns [char value]
     :   EscapeFlag (
             'a'  {$value = '@';}
         |   'b'  {$value = '#';}
         |   'c'  {$value = '$';}
         )
     ;
fragment EscapeFlag : '@';
fragment Letters    : Letter+;
fragment Letter     : 'a'..'z' | 'A'..'Z';
----------

However, the generated lexer code for the Word token does not reference 
the returned $Escape.value character, instead it creates a new invalid 
token for the Escape fragment input substring and appends the token 
itself to the text String. For an input word "ju at bmps", you get 
"ju[@-1,24:25='@b',<0>,0:-1]ps" instead of "ju#mps".

----------
case 2 :
     // C:\\Data\\Projects\\Java\\Antlr\\Examples\\Exp3.g:30:5: Escape
     {
     int Escape2Start = getCharIndex();
     mEscape();
     Token Escape2 = new CommonToken(input, Token.INVALID_TOKEN_TYPE, 
Token.DEFAULT_CHANNEL, Escape2Start, getCharIndex()-1);
     text += Escape2;

     }
     break;
----------

Weird and oogly. Can anyone shed some light on what I'm doing wrong, a 
better way this can be done, or if this is a bug?

-- 
--------------------------------------------------------
"Any sufficiently over-complicated magic is indistinguishable from 
technology." -- Llelan D.


From NOSPAM at TheSnakePitDev.com  Fri Feb 23 20:02:55 2007
From: NOSPAM at TheSnakePitDev.com (Curtis Clauson)
Date: Fri, 23 Feb 2007 20:02:55 -0800
Subject: [antlr-interest] Lexer escape conversions
In-Reply-To: <ero829$agq$1@sea.gmane.org>
References: <ero829$agq$1@sea.gmane.org>
Message-ID: <eroddh$mdj$1@sea.gmane.org>

Why is it I only come up with an answer after I send the question? <chuckle>

Despite no error messages from Antlr, the lexer will not generate return 
values for any rule. There seems to be no way, outside of lexer instance 
variables, to pass information from a sub-rule to a parent rule.

This means I either have to integrate the Escape fragment into the Word 
rule which is clumsy and ugly, or split the Escape sequences into 
individual fragments that the Word rule can associate with text 
appending actions.

Both work, and the latter seems less clumsy, but I would really love to 
know if this Antlr behavior is a bug since it stops me from using a 
cleaner and clearer source.

This is the version that works:
----------
/*
  * Parser Rules
  */

content
@init {System.out.println("Words:");}
     :   (
             Word  {System.out.println("  " + $Word.text);}
         )*
     ;


/*
  * Lexer Rules
  */

// Gather sequences of letters and escapes between whitespace
// into words.
Word
@init {text = "";}
     :   (
             Letters  {text += $Letters.text;}
         |   Escape1  {text += '@';}
         |   Escape2  {text += '#';}
         |   Escape3  {text += '$';}
         )+
     ;
Whitespace
     :   (' ' | '\t' | '\u000B' | '\f' | '\r' | '\n')+
         {$channel = HIDDEN;}
     ;

fragment Escape1    : EscapeFlag 'a';
fragment Escape2    : EscapeFlag 'b';
fragment Escape3    : EscapeFlag 'c';
fragment EscapeFlag : '@';
fragment Letters    : Letter+;
fragment Letter     : 'a'..'z' | 'A'..'Z';
----------

-- 
--------------------------------------------------------
"Any sufficiently over-complicated magic is indistinguishable from 
technology." -- Llelan D.


From kroepke at classdump.org  Sat Feb 24 03:37:20 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Sat, 24 Feb 2007 12:37:20 +0100
Subject: [antlr-interest] Code generation in beta 6
In-Reply-To: <009501c7577a$5decdfe0$1601a8c0@kocher>
References: <1F0B4687-B5C5-422F-9F09-65652F3B1EE0@cse.unsw.edu.au>
	<2A7600D6-D769-4834-B393-D8CD1ED3CBD8@classdump.org>
	<009501c7577a$5decdfe0$1601a8c0@kocher>
Message-ID: <E425D7DB-C60C-4276-B4F3-FC3819AA4C49@classdump.org>


On Feb 23, 2007, at 7:42 PM, Dr. Hartmut Kocher wrote:

> Here are some fixes I made. Put the templates into the CSharp template
> folder and rebuild.

Cool, thanks Hartmut!

> I forwarded these to Terence and the C# team, so they will probably be
> included in the next release.

I think Ter will be back tomorrow, so it should go in :)

cheers,
-k
-- 
Kay R?pke
http://classdump.org/





From nobrow at eircom.net  Sat Feb 24 07:58:40 2007
From: nobrow at eircom.net (Alan Larkin)
Date: Sat, 24 Feb 2007 15:58:40 +0000
Subject: [antlr-interest] Identifying a TNode
Message-ID: <45E060B0.1020104@eircom.net>

b:binaryOperator
{
    TNode e1, e2;
    e1 = (TNode)b.getFirstChild();
    e2 = (TNode)e1.getNextSibling();
    expr(e1);
    print(b);
    expr(e2);
}

You see the above ... It comes from cgram (GnuCEmitter.g). I am taking this as a starting point to
implement some unusual language translation. I have a question.

Is it possible to look into each of the TNodes to see what they expand to?

In this case,

expr ::= binaryExpr | conditionalExpr | castExpr | unaryExpr | ...

I need to be able to identify the case where e1 and/or e2 turn into unaryExpr, and in such cases
avoid doing the processing I would otherwise do.

Any ideas?

Thanks.

From mblp at mega.ist.utl.pt  Sat Feb 24 09:20:10 2007
From: mblp at mega.ist.utl.pt (Miguel Ping)
Date: Sat, 24 Feb 2007 17:20:10 +0000
Subject: [antlr-interest] Tree Rewrite doubt | errors on parser
	generation
In-Reply-To: <ab0bf2c00702221429j1a673fa3s31dd0a8c736dd490@mail.gmail.com>
References: <ab0bf2c00702221429j1a673fa3s31dd0a8c736dd490@mail.gmail.com>
Message-ID: <ab0bf2c00702240920i1bcacc32me94f95796771fcb0@mail.gmail.com>

I figure out how to port those rules to antl3, it is quite simple:

sql_statement: sql_command (SEMI)? -> ^(SQL_STATEMENT $sql_statement);

You use the $rulename syntax. Hope it helped other than myself :)

On 2/22/07, Miguel Ping <mblp at mega.ist.utl.pt> wrote:
> Hi all!
>
> I am currently trying to port PL/SQL 7 antlr v2 grammar downloadable
> from antlr site to antlr v3 b6. The grammar has some tree rewrite
> rules that are useful to group statements under a tree like:
>
> sql_statement: sql_command (SEMI)?
>         { #sql_statement = #([SQL_STATEMENT, "sql_statement"],
> #sql_statement); }
>
> If I understant the tree rewrite rules correctly, this grammar rule
> states that the (sub) tree that will be assigned to sql_statement is
> to be assigned to a child under the SQL_STATEMENT imaginary token with
> the name "sql_statement". For me to port those definitions to antlr
> v3, should I do it this way:
>
> sql_statement: sql_command (SEMI)? -> ^(SQL_STATEMENT sql_statement);
>
> Because if I do it that way, antlr tool tells me that the
> 'sql_statement' does not exist on the left side of  the '->' symbol:
> error(136): reference to rewrite element sqlStatement without
> reference on left of ->
> How should I work this out?
>
>
> There are 2 other errors happening in the generated parser code:
>
> 1. The symbol LA27_1 in the following method does not exist:
>
>  public int specialStateTransition(int s) throws NoViableAltException {
>                 int _s = s;
>             switch ( s ) {
>                     case 0 :
>                         input.rewind();
>                         s = -1;
>                         if ( (LA27_1==OPEN_PAREN||LA27_1==DOT) ) {s =
> 14;} //error here
>                         else if ( (synpred7()) ) {s = 9;}
>                          (...)
>
> Since this method overrides the one in the DFA, I guess that this must
> be a problem with the generator, but I can be wrong...
>
> 2. In the rule
>
> variable : ( ( columnSpec ( OPEN_PAREN PLUS CLOSE_PAREN ) )=>
> columnSpec ( OPEN_PAREN PLUS CLOSE_PAREN ) | columnSpec );
>
> The parser code for the return tree I guess is in this method, which
> has alot of if's and cases:
>
>     public variable_return variable() throws RecognitionException {
>      (...)
>      int LA29_5 = input.LA(7);
>      (...)
> The problem is that the variable 'int LA29_5' is being duplicated in
> alot of places on this method. Is this because of my rule, or can it
> be a antlr bug?
>
> Thanks In advance!
>

From mblp at mega.ist.utl.pt  Sat Feb 24 13:33:48 2007
From: mblp at mega.ist.utl.pt (Miguel Ping)
Date: Sat, 24 Feb 2007 21:33:48 +0000
Subject: [antlr-interest] Tree Rewrite doubt | errors on parser
	generation
In-Reply-To: <ab0bf2c00702240920i1bcacc32me94f95796771fcb0@mail.gmail.com>
References: <ab0bf2c00702221429j1a673fa3s31dd0a8c736dd490@mail.gmail.com>
	<ab0bf2c00702240920i1bcacc32me94f95796771fcb0@mail.gmail.com>
Message-ID: <ab0bf2c00702241333l5f5bba6ft22b2f3bbf0d847c1@mail.gmail.com>

Err, I'm having problems filling the return tree with the tree built
by antlr. If I use the $sql_statement syntax, the corresponding
subtree of the node SQL_STATEMENT comes empty, but if I reference the
right side of the production, it comes ok. What is the proper way of
referencing the LEFT side of the production so antlr can do the tree
building and I can put the result on an imaginary token?

In more complex examples, I have no simple way of solving this without
antlr building the tree for me, it would require me to rewrite all the
rule just to fill the tree.

Thanks in advance,
Miguel Ping

On 2/24/07, Miguel Ping <mblp at mega.ist.utl.pt> wrote:
> I figure out how to port those rules to antl3, it is quite simple:
>
> sql_statement: sql_command (SEMI)? -> ^(SQL_STATEMENT $sql_statement);
>
> You use the $rulename syntax. Hope it helped other than myself :)
>
> On 2/22/07, Miguel Ping <mblp at mega.ist.utl.pt> wrote:
> > Hi all!
> >
> > I am currently trying to port PL/SQL 7 antlr v2 grammar downloadable
> > from antlr site to antlr v3 b6. The grammar has some tree rewrite
> > rules that are useful to group statements under a tree like:
> >
> > sql_statement: sql_command (SEMI)?
> >         { #sql_statement = #([SQL_STATEMENT, "sql_statement"],
> > #sql_statement); }
> >
> > If I understant the tree rewrite rules correctly, this grammar rule
> > states that the (sub) tree that will be assigned to sql_statement is
> > to be assigned to a child under the SQL_STATEMENT imaginary token with
> > the name "sql_statement". For me to port those definitions to antlr
> > v3, should I do it this way:
> >
> > sql_statement: sql_command (SEMI)? -> ^(SQL_STATEMENT sql_statement);
> >
> > Because if I do it that way, antlr tool tells me that the
> > 'sql_statement' does not exist on the left side of  the '->' symbol:
> > error(136): reference to rewrite element sqlStatement without
> > reference on left of ->
> > How should I work this out?
> >
> >
> > There are 2 other errors happening in the generated parser code:
> >
> > 1. The symbol LA27_1 in the following method does not exist:
> >
> >  public int specialStateTransition(int s) throws NoViableAltException {
> >                 int _s = s;
> >             switch ( s ) {
> >                     case 0 :
> >                         input.rewind();
> >                         s = -1;
> >                         if ( (LA27_1==OPEN_PAREN||LA27_1==DOT) ) {s =
> > 14;} //error here
> >                         else if ( (synpred7()) ) {s = 9;}
> >                          (...)
> >
> > Since this method overrides the one in the DFA, I guess that this must
> > be a problem with the generator, but I can be wrong...
> >
> > 2. In the rule
> >
> > variable : ( ( columnSpec ( OPEN_PAREN PLUS CLOSE_PAREN ) )=>
> > columnSpec ( OPEN_PAREN PLUS CLOSE_PAREN ) | columnSpec );
> >
> > The parser code for the return tree I guess is in this method, which
> > has alot of if's and cases:
> >
> >     public variable_return variable() throws RecognitionException {
> >      (...)
> >      int LA29_5 = input.LA(7);
> >      (...)
> > The problem is that the variable 'int LA29_5' is being duplicated in
> > alot of places on this method. Is this because of my rule, or can it
> > be a antlr bug?
> >
> > Thanks In advance!
> >
>

From antlr at jazillian.com  Sat Feb 24 14:29:03 2007
From: antlr at jazillian.com (Andy Tripp)
Date: Sat, 24 Feb 2007 17:29:03 -0500
Subject: [antlr-interest] Operator overloading?
In-Reply-To: <001401c756cd$160f62e0$186fa8c0@graphlogic.com>
References: <632C3E36DCF16649AD770FE2646E9A18014D44C0@message-fr.ad.mathworks.com>	<CF60B2CA-2460-4D5B-90C8-3B9454DBA7A2@cs.usfca.edu>
	<001401c756cd$160f62e0$186fa8c0@graphlogic.com>
Message-ID: <45E0BC2F.4060200@jazillian.com>

Vladimir Gusev wrote:
> Hello,
>
> Is there a way to implement in my language operator overloading using ANTLR?
> I would appreciate any thoughts about this.
>
> Thanks.
>
> Vladimir
>   
Yes, I think this could be done. I replace C++ operator overloading with 
Java
function calls as part of my C++ to Java translator (jazillian.com), 
which is a little different but related.
Say you're creating a binary "+" operator between two Money objects like 
this. You'd
parse the source files into ASTs, search the ASTs for binary "+" 
operators, and then
figure out the types of the left and right ASTs. If they're both type 
Money, then this
is the thing you're looking for, and you could replace the "+" node in 
the AST
by something else, such as some METHOD_CALL type of node.

Print out your modified AST, and you've just used ANTLR as a preprocessor
to convert operator overloading to code without operator overloading. In 
that way,
your "money1 + money2" expressions would become "money1.plus(money2)".

Andy


From raghu at raghukodali.com  Sat Feb 24 20:18:05 2007
From: raghu at raghukodali.com (Raghu Kodali)
Date: Sun, 25 Feb 2007 09:48:05 +0530
Subject: [antlr-interest] Newbie to ANTLR: Child node not found
Message-ID: <1172377085.11041.70.camel@localhost>

Hi All,

   I am a newbie to ANTLR (not to grammars. used flex & bison for more
than a few years).

I am trying to create a AST & I get these warnings on the console (I am
using ANTLRWorks). I am not able to understand what it means. 

I am assuming that a child node is not being put into the AST. This seem
to be coming from my alphanumeric, alphabetic & number (int & float) lex
statements.

Any explanation & possible directions for me to try out can be helpful.


Child node 12848256 not found!
No token info for token index 10

Child node 19608436 not found!
No token info for token index 11

Child node 20920201 not found!
No token info for token index 14

Thanks
Raghu


From antlr-list at arizona-software.ch  Sat Feb 24 20:25:16 2007
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Sat, 24 Feb 2007 20:25:16 -0800
Subject: [antlr-interest] ANTLRworks errors debugging fuzzy grammars
In-Reply-To: <9C6A4250-EA9F-4D33-814D-3786DC2D861A@latencyzero.com>
References: <9C6A4250-EA9F-4D33-814D-3786DC2D861A@latencyzero.com>
Message-ID: <CC473323-E4D1-49E5-B474-2FE7A0944E41@arizona-software.ch>

The debugger should be able to handle that (not the interpreter but  
looking at the trace you're using the debugger). Can you send me the  
grammar file that is causing the issue (at my e-mail  
jean_bovet at mac.com)?

Thanks!

Jean

On Feb 22, 2007, at 10:58 AM, Rick Mann wrote:

> I'm trying to write a fuzzy grammar, but it appears that ANTLRWorks  
> can't debug them. Is this the case? For example, if I attempt to  
> debug the FuzzyJava.g example, I get this:
>
> [10:56:52] java.lang.NullPointerException
> 	at org.antlr.works.generate.CodeGenerate.getGeneratedClassName 
> (Unknown Source)
> 	at org.antlr.works.generate.CodeGenerate.getGeneratedTextFileName 
> (Unknown Source)
> 	at org.antlr.works.debugger.local.DBLocal.prepare(Unknown Source)
> 	at org.antlr.works.debugger.local.DBLocal.run(Unknown Source)
> 	at java.lang.Thread.run(Thread.java:613)
>
>
>
> If I try to "Generate Code", it says it can only generate code for  
> the Java language.
>
> However, if I just run the ANTLR tool on the grammar, it completes  
> without complaint. Am I misunderstanding something?
>
> ANTLRWorks 1.0b9 and ANTLR 3b6
>
> TIA,
>
>
> -- 
> Rick
>
>


From antlr-list at arizona-software.ch  Sat Feb 24 20:26:14 2007
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Sat, 24 Feb 2007 20:26:14 -0800
Subject: [antlr-interest] Newbie to ANTLR: Child node not found
In-Reply-To: <1172377085.11041.70.camel@localhost>
References: <1172377085.11041.70.camel@localhost>
Message-ID: <96CC8FC7-DF04-4536-B0B5-9B1FA30F84C6@arizona-software.ch>

That's because ANTLRWorks does not find some token in the AST. Can be  
either a bug in ANTLRWorks or a problem interacting with ANTLR. Can  
you send me the grammar file and the step needed to reproduce the  
issue (at my e-mail jean_bovet at mac.com)?

Thanks a lot!

Jean

On Feb 24, 2007, at 8:18 PM, Raghu Kodali wrote:

> Hi All,
>
>    I am a newbie to ANTLR (not to grammars. used flex & bison for more
> than a few years).
>
> I am trying to create a AST & I get these warnings on the console  
> (I am
> using ANTLRWorks). I am not able to understand what it means.
>
> I am assuming that a child node is not being put into the AST. This  
> seem
> to be coming from my alphanumeric, alphabetic & number (int &  
> float) lex
> statements.
>
> Any explanation & possible directions for me to try out can be  
> helpful.
>
>
> Child node 12848256 not found!
> No token info for token index 10
>
> Child node 19608436 not found!
> No token info for token index 11
>
> Child node 20920201 not found!
> No token info for token index 14
>
> Thanks
> Raghu
>


From voytechs at yahoo.com  Sun Feb 25 06:24:05 2007
From: voytechs at yahoo.com (Mark Bednarczyk)
Date: Sun, 25 Feb 2007 09:24:05 -0500
Subject: [antlr-interest] Internal error "OrderedHashSet"
Message-ID: <20070225142406.C5E0D190820@www.antlr.org>

Getting this error on a rule. 

[antlr:antlr3] ANTLR Parser Generator  Version 3.0 beta revision 3386
(January 11, 2007) 1989-2007
[antlr:antlr3] error(10):  internal error:
org.antlr.misc.OrderedHashSet.size(OrderedHashSet.java:92): OrderedHashSet:
elements and set size differs; 4!=3
[antlr:antlr3] error(10):  internal error:
org.antlr.misc.OrderedHashSet.size(OrderedHashSet.java:92): OrderedHashSet:
elements and set size differs; 7!=4
... CONTINUES FOR EVER ....

The error is continuesly displayed and never stops. Is this a known issue?
 
The culprit is the "modifiers" subrule:

tableDeclaration
	: modifiers TABLE id tableBody -> ^(TABLE_DEF id tableBody)
	;

modifiers
	:	modifier*	-> ^(MODIFIERS modifier*)
	;
	
modifier
    :   'public'
    |   'protected'
    |   'private'
    |   'static'
    |   'final'
    |   'synchronized'
    |   'transient'
    |   'volatile'
    |   'field'
    ;

The error occures when I add the "modifiers" to teableDeclaration
production. It goes away when I don't include it. The modifiers subrule is
used in other parts of the grammar with success.  Could I be hitting some
kind of size related limit, there are nearly 100 rules in my entire grammar
file?

Cheers,
mark...



From kroepke at classdump.org  Sun Feb 25 09:23:20 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Sun, 25 Feb 2007 18:23:20 +0100
Subject: [antlr-interest] ANTLRworks errors debugging fuzzy grammars
In-Reply-To: <CC473323-E4D1-49E5-B474-2FE7A0944E41@arizona-software.ch>
References: <9C6A4250-EA9F-4D33-814D-3786DC2D861A@latencyzero.com>
	<CC473323-E4D1-49E5-B474-2FE7A0944E41@arizona-software.ch>
Message-ID: <97DE13BF-438C-4044-9C20-BD47F6497662@classdump.org>


On Feb 25, 2007, at 5:25 AM, Jean Bovet wrote:

> The debugger should be able to handle that (not the interpreter but  
> looking at the trace you're using the debugger). Can you send me  
> the grammar file that is causing the issue (at my e-mail  
> jean_bovet at mac.com)?

ouch, I should've read that more closely...sorry.

-k
-- 
Kay R?pke
http://classdump.org/





From dave at badgers-in-foil.co.uk  Sun Feb 25 09:25:23 2007
From: dave at badgers-in-foil.co.uk (David Holroyd)
Date: Sun, 25 Feb 2007 17:25:23 +0000
Subject: [antlr-interest] adding content at end
	ofrulewithTokenRewriteStream
In-Reply-To: <632C3E36DCF16649AD770FE2646E9A18014D498B@message-fr.ad.mathworks.com>
References: <632C3E36DCF16649AD770FE2646E9A18014D498B@message-fr.ad.mathworks.com>
Message-ID: <20070225172523.GA7027@badgers-in-foil.co.uk>

On Fri, Feb 23, 2007 at 07:48:48PM +0100, Jean Marc Vanel wrote:
> Jean Marc Vanel wrote:
> ....
> > > name_or_pointer
> > > @init {
> > >     tokens = (TokenRewriteStream)input;
> > > }
> > >     	:	NAME (star='*')?
> > > 		{ tokens.insertAfter( star.stop, " == after '*' ===" ); }
> > > 	;
[snip]
> [Jean-Marc Vanel] But if there are many places where this rule appears,
> I don't want to paste the same thing in many places.
> Indeed, there are tokens for that rule, it's just that in the action
> language I can't get hold on the last token.

How about abusing the rewrite syntax a bit, just so that you can access
the result tree for the rule,

  name_or_pointer
	:	(NAME STAR? -> NAME STAR?)
		{ tokens.insertAfter( $name_or_pointer.tree.stop, "blah" ); }
	;

I didn't test the code above, but I think I've done something like that
in the past.

The problem is (I think) that ANTLR doesn't normally set the stop-token
for the result tree until *after* the rule and all its actions have
executed, which makes it tricky for the rule itself to get at this
information.

Actually, all ANTLR does to set the stop-token is to assign the value
from input.LT(-1), so maybe you could just use that,

  name_or_pointer
	:	NAME STAR? { tokens.insertAfter(input.LT(-1), "blah"); }
	;

(again, untested code)


ta,
dave

-- 
http://david.holroyd.me.uk/

From wl at dm17.com  Sun Feb 25 16:52:13 2007
From: wl at dm17.com (Werner Lehmann)
Date: Mon, 26 Feb 2007 01:52:13 +0100
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
Message-ID: <45E22F3D.1050500@dm17.com>

for a few hours now I have been trying to get a tree parser out of 
Terence's Java 1.5 grammar. I thought I was doing something wrong being 
not very experienced with ANTLR. Is it true that ASTs are not yet supported?

I need to update my Java 1.4 parser (based on ANTLR 2.7.6) to Java 1.5 
and it seemed to be a good idea to use ANTLR3 and this new grammar but 
maybe not so. By the way, the separate examples download has a more 
recent version of Java.g. The version available from the grammars list 
on the site is older and produces uncompilable code which pushed me off 
track for some time.

If ANTLR3 would not yet provide an AST should I then use the Java 1.5 
grammar created by Michael Studman or Michael Stahl (any experience with 
either)?

FranklinChen at cmu.edu wrote:
> I noticed that output=AST for tree parsers in 3.0b6 isn't working
> yet.  When will this be available?  I have large ANTLR 2 projects that
> make extensive use of multiple passes gradually transforming an AST
> until the final pass generates output, and I would like to convert
> them to ANTLR 3.


From kroepke at classdump.org  Sun Feb 25 17:08:47 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Mon, 26 Feb 2007 02:08:47 +0100
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <45E22F3D.1050500@dm17.com>
References: <45E22F3D.1050500@dm17.com>
Message-ID: <6C8C2DF2-A239-47EF-A895-E4F3837BD1DD@classdump.org>


On Feb 26, 2007, at 1:52 AM, Werner Lehmann wrote:

> for a few hours now I have been trying to get a tree parser out of  
> Terence's Java 1.5 grammar. I thought I was doing something wrong  
> being not very experienced with ANTLR. Is it true that ASTs are not  
> yet supported?

ASTs are supported, the thing that doesn't work is tree rewriting  
(i.e. having a tree parser output another tree by using rewrite rules  
in the tree grammar). There are a couple of examples in the examples- 
v3.tar.gz as well as in the Wiki on how to use tree output.

> I need to update my Java 1.4 parser (based on ANTLR 2.7.6) to Java  
> 1.5 and it seemed to be a good idea to use ANTLR3 and this new  
> grammar but maybe not so. By the way, the separate examples  
> download has a more recent version of Java.g. The version available  
> from the grammars list on the site is older and produces  
> uncompilable code which pushed me off track for some time.
>
> If ANTLR3 would not yet provide an AST should I then use the Java  
> 1.5 grammar created by Michael Studman or Michael Stahl (any  
> experience with either)?

I haven't used any of the Java grammars, but looking at Ter's it  
shows that that grammar simply isn't building trees. You could add  
the tree operators and/or rewrite rules yourself, and then write tree  
grammars to work with your tree. As tree building often depends on  
the thing you want to accomplish, that's probably the best way of  
doing it anyway.

> FranklinChen at cmu.edu wrote:
>> I noticed that output=AST for tree parsers in 3.0b6 isn't working
>> yet.  When will this be available?  I have large ANTLR 2 projects  
>> that
>> make extensive use of multiple passes gradually transforming an AST
>> until the final pass generates output, and I would like to convert
>> them to ANTLR 3.

As mentioned above, this isn't scheduled for 3.0 final, AFAIK. Ter  
wanted to finalize the stuff there is right now before adding new  
features.
I'd think that tree rewriting would come in 3.1 if there is a good  
way of unambiguously defining the process. I vividly remember going  
through the template output stuff with Ter a while ago, and that was  
hard enough to give right semantics to...

HTH,
-k
-- 
Kay R?pke
http://classdump.org/





From rhill03 at eds.com  Sun Feb 25 23:24:19 2007
From: rhill03 at eds.com (Hill, Robert)
Date: Mon, 26 Feb 2007 07:24:19 -0000
Subject: [antlr-interest] Fwd: Next Beta release of The Definitive
	ANTLRReference
In-Reply-To: <200702240253.32942.ilia@obnovlenie.ru>
Message-ID: <2E909902FD3A03419E3A905908AE3DD402EB340D@UKNSM201.emea.corp.eds.com>

Well, you know what they say...
"never judge a book...."
Lol, but sorry guys, who the hell cares what's on the cover? The
contents are what's important :)
It could have circus clowns being ****** by Ron Jeremy himself for all I
care. I just wish it would hurry up and end up on paper, so Amazon can
deliver it.

/2ob

Robert Hill
Information Engineer (C/C++,C#,.NET,Java)
Agile Alliance Member
EDS UKIMEA DWP ACU
Hallamshire Business Park, 100 Napier St, Sheffield. S11 8HD
email:	rhill03 at eds.com
Office:	+44 114 291 1928
Mobile:	+44 7903 185 516

This email contains information which is confidential and may be
privileged. Unless you are the intended addressee (or authorised to
receive for the addressee) you may not use, forward, copy or disclose to
anyone this email or any information contained in this email. If you
have received this email in error, please advise the sender by reply
email immediately and delete this email.

Electronic Data Systems Ltd
Registered Office:, Lansdowne House, Berkeley Square, London  W1J 6ER 
Registered in England no: 53419
VAT number: 432 99 5915


 

>-----Original Message-----
>From: antlr-interest-bounces at antlr.org 
>[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Ilia Kantor
>Sent: 23 February 2007 23:54
>To: antlr-interest at antlr.org
>Subject: Re: [antlr-interest] Fwd: Next Beta release of The 
>Definitive ANTLRReference
>
>
>> I think the book cover should read in nice big red friendly letters 
>> "Don't Panic".
>
>When I look at that red style and apocalyptic picture...
>... I really do await such words and "save your soul" brochure inside.
>
>
>2ALL:
>Again, what are your first impression ? Not sure if it's only 
>me thinking like that..
>
>
>>
>> -H
>>
>> On 2/23/07, Randall R Schulz <rschulz at sonic.net> wrote:
>> > On Friday 23 February 2007 08:20, Ilia Kantor wrote:
>> > > > Howdy folks,
>> > > >
>> > > > Very heavily updated b2 of the book available.
>> > > >
>> > > > http://www.pragmaticprogrammer.com/titles/tpantlr/index.html
>> > >
>> > > The cover decoration (including picture) for such kind 
>of book seems
>> > > very very horribly bad for me.
>> >
>> > Well, if not bad, a bit obvious...
>> >
>> > But then, dragons have already been done.
>> >
>> > > ...
>> > > Kantor Ilia
>> >
>> > Randall Schulz
>
>
>

From mark at slytechs.com  Mon Feb 26 03:27:14 2007
From: mark at slytechs.com (Mark Bednarczyk)
Date: Mon, 26 Feb 2007 06:27:14 -0500
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <6C8C2DF2-A239-47EF-A895-E4F3837BD1DD@classdump.org>
Message-ID: <200702261124.l1QBO4J24427@snvca-bs1-5-e0.astragate.net>

Hi Kay,
	I'm jumping in here a bit late, but tree rewritting is implemented
in b6. I'm using it in my grammar heavily.

I also have the 1.5 grammar compiled and working as well. 

I'm building my own grammar based on 1.5 and using lots of rewrites in the
parser, then in the tree walkers. The output out of normal grammar "grammar
MyGrammar" can be "output=AST" or "output="template". In a Tree walker (i.e.
"tree grammar MyGrammar") can only be "output=template".

Here is proof. First rule rewrites the "typeParameters" production to
produce a new type of tree. It inserts a new type of virtual token,
GENERIC_TYPE as a root to be for all the typeParameters which could be
primitives or an identifier. Then the tableDeclaration rewrites the rule to
another TABLE_DEF rooted tree where the "modifiers" are optionally included,
id and table body which produces a SLIST rooted tree of statements allowed
within my special type of a table I'm writing here. Both GENERIC_TYPE and
TABLE_DEF tokens are only defined in "tokens" section and are not produced
by the lexer. I use them for my own AST so that later compilation stages
using tree walkers can easily match on those roots and virtual tokens to
perform further processing.

grammar Npl;
options {
	k=2;
	backtrack=true;
	memoize=true;
	output=AST;
}

typeParameters
	:	'<' typeParameter (',' typeParameter)* '>'
		-> ^(GENERIC_TYPE typeParameter*)
	;

tableDeclaration
	:	modifiers 'table' id typeParameters? tableBody  
		-> ^(	TABLE_DEF id 
				modifiers 
				typeParameters?
				tableBody)
	;


Here is a dump of the AST it produces based on this input:
	public table abc {
		Option1(1),
		Option2(2) = "option2"
	}

AST:
(TABLE_DEF 
	(ID abc) 
	(MODIFIERS public) 
	(GENERIC_TYPE int)
	(SLIST 
		(TABLE_CONST 
			(ID Option1	( 1 ))
			(TABLE_CONST_DESC)) 
		(TABLE_CONST 
			(ID Option2 ( 2 )) 
			(TABLE_CONST_DESC "option2"))))
Hope this helps,

Cheers,
mark....

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org 
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Kay Roepke
> Sent: Sunday, February 25, 2007 8:09 PM
> To: Werner Lehmann
> Cc: ANTLR Interest; FranklinChen at cmu.edu
> Subject: Re: [antlr-interest] ANTLR 3 output=AST for tree parser?
> 
> 
> On Feb 26, 2007, at 1:52 AM, Werner Lehmann wrote:
> 
> > for a few hours now I have been trying to get a tree parser out of 
> > Terence's Java 1.5 grammar. I thought I was doing something wrong 
> > being not very experienced with ANTLR. Is it true that ASTs are not 
> > yet supported?
> 
> ASTs are supported, the thing that doesn't work is tree 
> rewriting (i.e. having a tree parser output another tree by 
> using rewrite rules in the tree grammar). There are a couple 
> of examples in the examples- v3.tar.gz as well as in the Wiki 
> on how to use tree output.
> 
> > I need to update my Java 1.4 parser (based on ANTLR 2.7.6) to Java
> > 1.5 and it seemed to be a good idea to use ANTLR3 and this 
> new grammar 
> > but maybe not so. By the way, the separate examples download has a 
> > more recent version of Java.g. The version available from 
> the grammars 
> > list on the site is older and produces uncompilable code 
> which pushed 
> > me off track for some time.
> >
> > If ANTLR3 would not yet provide an AST should I then use the Java
> > 1.5 grammar created by Michael Studman or Michael Stahl (any 
> > experience with either)?
> 
> I haven't used any of the Java grammars, but looking at Ter's 
> it shows that that grammar simply isn't building trees. You 
> could add the tree operators and/or rewrite rules yourself, 
> and then write tree grammars to work with your tree. As tree 
> building often depends on the thing you want to accomplish, 
> that's probably the best way of doing it anyway.
> 
> > FranklinChen at cmu.edu wrote:
> >> I noticed that output=AST for tree parsers in 3.0b6 isn't working 
> >> yet.  When will this be available?  I have large ANTLR 2 projects 
> >> that make extensive use of multiple passes gradually 
> transforming an 
> >> AST until the final pass generates output, and I would like to 
> >> convert them to ANTLR 3.
> 
> As mentioned above, this isn't scheduled for 3.0 final, 
> AFAIK. Ter wanted to finalize the stuff there is right now 
> before adding new features.
> I'd think that tree rewriting would come in 3.1 if there is a 
> good way of unambiguously defining the process. I vividly 
> remember going through the template output stuff with Ter a 
> while ago, and that was hard enough to give right semantics to...
> 
> HTH,
> -k
> --
> Kay R?pke
> http://classdump.org/
> 
> 
> 
> 



From kroepke at classdump.org  Mon Feb 26 03:38:11 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Mon, 26 Feb 2007 12:38:11 +0100
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <200702261124.l1QBO4J24427@snvca-bs1-5-e0.astragate.net>
References: <200702261124.l1QBO4J24427@snvca-bs1-5-e0.astragate.net>
Message-ID: <601E43A5-3CBD-4B36-B485-213E6BF38476@classdump.org>


On Feb 26, 2007, at 12:27 PM, Mark Bednarczyk wrote:

> Hi Kay,
> 	I'm jumping in here a bit late, but tree rewritting is implemented
> in b6. I'm using it in my grammar heavily.

Yes, for parsers spitting out ASTs rewriting (from a token stream to  
a tree) is supported.
But it is not supported for *tree* parsers, i.e. having a tree parser  
that modifies trees by using ANTLR's rewrite syntax.
That is what I meant, sorry if I wasn't clear enough in that.

> I also have the 1.5 grammar compiled and working as well.

Cool, then it shouldn't be a problem for OP to get what he wants :)

cheers,

-k
-- 
Kay R?pke
http://classdump.org/





From martin.danjou at neterion.com  Mon Feb 26 04:13:13 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Mon, 26 Feb 2007 07:13:13 -0500 (EST)
Subject: [antlr-interest] bug in 3.0b6: identifier/keyword or underscore
	problem?
Message-ID: <Pine.LNX.4.63.0702260708110.3962@algonquin>

Hi,

I've been strugling with this for several days. It looks like 3.0b6 can't 
tell an identifier from a keyword, or has a problem with underscores. Here 
is how I produce the problem:

1) input text

int id;
int int_id;
int _int_id;

2) Lexer

lexer grammar DUMMY_Lexer;
options { filter=true; }

INT          : 'int' ;
SEMI         : ';' ;
WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
IDENTIFIER   : ('a'..'z'|'A'..'Z'|'_')+;

3) Parser

parser grammar DUMMY_Parser;
options {
   tokenVocab=DUMMY_Lexer;
}

source_text :
   { System.out.println("Weird lexer"); }
   int_defs+
   ;

int_defs :
   INT            { System.out.print("int "); }
   id=IDENTIFIER  { System.out.print($id.text); }
   SEMI           { System.out.println(";"); }
   ;

4) The output and the error I get

Weird lexer
int id;
int line 2:4 mismatched input 'int' expecting IDENTIFIER
int;
int _int_id;


The lexer is not greedy or something is wrong with the underscore, I don't 
know.

Help!!!
Martin

From martin.danjou at neterion.com  Mon Feb 26 05:03:12 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Mon, 26 Feb 2007 08:03:12 -0500 (EST)
Subject: [antlr-interest] bug in 3.0b6: identifier/keyword or underscore
	problem?
In-Reply-To: <Pine.LNX.4.63.0702260708110.3962@algonquin>
References: <Pine.LNX.4.63.0702260708110.3962@algonquin>
Message-ID: <Pine.LNX.4.63.0702260758040.3962@algonquin>

Hello again,

I have found a way to circumvent the lexer problem in antlr 3.0b6 (see my 
previous post). Essentially, I found that by testing for literals by hand 
in the lexer solves the problem of recognizing between "int" (a 
keyword) and "int_something" (an identifier). Here is the lexer with 
literal recognition inside IDENTIFIER:

lexer grammar DUMMY_Lexer;
options { filter=true; }
tokens {
   INT;
}
SEMI         : ';' ;
WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;

IDENTIFIER   : ('int' WS) => 'int' { $type=INT; }
                | ('a'..'z'|'A'..'Z'|'_')+ ;


Using the same parser and input text as in my previous post, this
works as expected. Now the question is: does this scale well?

I am sure there is an easier way that eludes me. I still think there is a 
bug though.

Martin

From e.papegaaij at student.utwente.nl  Mon Feb 26 05:20:29 2007
From: e.papegaaij at student.utwente.nl (Emond Papegaaij)
Date: Mon, 26 Feb 2007 14:20:29 +0100
Subject: [antlr-interest] bug in 3.0b6: identifier/keyword or underscore
	problem?
In-Reply-To: <Pine.LNX.4.63.0702260708110.3962@algonquin>
References: <Pine.LNX.4.63.0702260708110.3962@algonquin>
Message-ID: <200702261420.29865.e.papegaaij@student.utwente.nl>

On Monday 26 February 2007 13:13:13 Martin d'Anjou wrote:
> I've been strugling with this for several days. It looks like 3.0b6 can't
> tell an identifier from a keyword, or has a problem with underscores. Here
> is how I produce the problem:
>
> lexer grammar DUMMY_Lexer;
> options { filter=true; }
>
> INT          : 'int' ;
> SEMI         : ';' ;
> WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
> IDENTIFIER   : ('a'..'z'|'A'..'Z'|'_')+;

Why are you using the filter option? This option causes ANTLR to try the 
tokens one-by-one. It continues at the next token if the current token does 
not match. So on the input 'intt' it will match an INT token first, followed 
by the IDENTIFIER 't'. When you remove the filter option, it should match a 
single IDENTIFIER token.

Best regards,
Emond


From mark at slytechs.com  Mon Feb 26 06:14:19 2007
From: mark at slytechs.com (Mark Bednarczyk)
Date: Mon, 26 Feb 2007 09:14:19 -0500
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <601E43A5-3CBD-4B36-B485-213E6BF38476@classdump.org>
Message-ID: <200702261411.l1QEBBu03327@snvca-bs1-5-e0.astragate.net>

Ok, we're on the same page. I also said that for tree grammars you can only
have "template" output type and of course no tree rewrites with ANTLR
syntax. 

On the other hand, you do have complete access to the AST in action section
for each rule and I have rewritten trees that way but by accessing AST nodes
from the matched AST input. I pull out a symtable, I'm currently working on
"typecasting" walker that rewrites and AST and inserts specific instructions
to change one type to another, etc...

Example from my tree walker:

modifiers returns [List<String> modifiers]
@init { $modifiers = new ArrayList<String>(); }
	:	^(MODIFIERS (m=modifier {$modifiers.add($m.ret);} )* ) 
	;

The rewrite syntax, currently only support "template" output type, so you
can only put template statements after the "->" symbol in tree grammars:

header
	:	^(HEADER_DEF m=modifiers i=id headerBody) {
			System.out.println("We got a header " + $i.id);
			$cu::header.setName($i.id);
			$cu::header.getModifiers().addAll($m.modifiers);
			
			SymHeader h = $cu::sym.getHeader($i.id,
$m.modifiers);
			h.setCu($cu::header);
		}
		->	template(a={$cu::header.toString()}) " HEADER(<a>)"
	;

So in essence, I rely on tree walker rules to do the matching and get me in
the right place of the AST, the action code to do any processing and
rewrites and then rewrite "->" to produce the templates in the last phase of
the processing.

Cheers,
mark...  

> -----Original Message-----
> From: Kay Roepke [mailto:kroepke at classdump.org] 
> Sent: Monday, February 26, 2007 6:38 AM
> To: mark at slytechs.com
> Cc: 'Werner Lehmann'; 'ANTLR Interest'; FranklinChen at cmu.edu
> Subject: Re: [antlr-interest] ANTLR 3 output=AST for tree parser?
> 
> 
> On Feb 26, 2007, at 12:27 PM, Mark Bednarczyk wrote:
> 
> > Hi Kay,
> > 	I'm jumping in here a bit late, but tree rewritting is 
> implemented in 
> > b6. I'm using it in my grammar heavily.
> 
> Yes, for parsers spitting out ASTs rewriting (from a token 
> stream to a tree) is supported.
> But it is not supported for *tree* parsers, i.e. having a 
> tree parser that modifies trees by using ANTLR's rewrite syntax.
> That is what I meant, sorry if I wasn't clear enough in that.
> 
> > I also have the 1.5 grammar compiled and working as well.
> 
> Cool, then it shouldn't be a problem for OP to get what he wants :)
> 
> cheers,
> 
> -k
> --
> Kay R?pke
> http://classdump.org/
> 
> 
> 
> 



From kroepke at classdump.org  Mon Feb 26 06:19:48 2007
From: kroepke at classdump.org (Kay Roepke)
Date: Mon, 26 Feb 2007 15:19:48 +0100
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <200702261411.l1QEBBu03327@snvca-bs1-5-e0.astragate.net>
References: <200702261411.l1QEBBu03327@snvca-bs1-5-e0.astragate.net>
Message-ID: <9173C154-23E8-4A49-B23F-890707811134@classdump.org>


On Feb 26, 2007, at 3:14 PM, Mark Bednarczyk wrote:

> So in essence, I rely on tree walker rules to do the matching and  
> get me in
> the right place of the AST, the action code to do any processing and
> rewrites and then rewrite "->" to produce the templates in the last  
> phase of
> the processing.

Yeah, that's the way to do it right now. In the future it'd be  
awesome to do tree
transformations by having some syntax for it :)

cheers,
-k

-- 
Kay R?pke
http://classdump.org/





From voytechs at yahoo.com  Mon Feb 26 06:31:35 2007
From: voytechs at yahoo.com (Mark Bednarczyk)
Date: Mon, 26 Feb 2007 09:31:35 -0500
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <9173C154-23E8-4A49-B23F-890707811134@classdump.org>
Message-ID: <20070226143140.725741907F2@www.antlr.org>

I'm sure Terrence will come up with something. I am perfectly content with
the way it works now. 

The one thing that really threw me off is when you don't set the
"output=template" in the tree grammar. The return type then changes
depending on what you declare in the rule. Basically 1 change in one rule,
would suddenly create a number of compile errors in the generated Java
walker because return type would change from void, to a single return value,
to a rulename_return structure.

Setting the "output=template" forces all rules to return a consistent
"rulename_return" class that contains the .st field for the template and
aadditional fields for whatever your specific return values are. It may be
less efficient for cases when you don't need anything returned, but its
consistent. Cost me a bit of debugger time to get that pinned down.

Cheers,
mark...

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org 
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Kay Roepke
> Sent: Monday, February 26, 2007 9:20 AM
> To: mark at slytechs.com
> Cc: 'ANTLR Interest'; FranklinChen at cmu.edu
> Subject: Re: [antlr-interest] ANTLR 3 output=AST for tree parser?
> 
> 
> On Feb 26, 2007, at 3:14 PM, Mark Bednarczyk wrote:
> 
> > So in essence, I rely on tree walker rules to do the 
> matching and get 
> > me in the right place of the AST, the action code to do any 
> processing 
> > and rewrites and then rewrite "->" to produce the templates in the 
> > last phase of the processing.
> 
> Yeah, that's the way to do it right now. In the future it'd 
> be awesome to do tree transformations by having some syntax for it :)
> 
> cheers,
> -k
> 
> --
> Kay R?pke
> http://classdump.org/
> 
> 
> 
> 
> 



From martin.danjou at neterion.com  Mon Feb 26 06:46:03 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Mon, 26 Feb 2007 09:46:03 -0500 (EST)
Subject: [antlr-interest] antlr-interest Digest, Vol 27, Issue 48
In-Reply-To: <mailman.1700.1172499275.1974.antlr-interest@antlr.org>
References: <mailman.1700.1172499275.1974.antlr-interest@antlr.org>
Message-ID: <Pine.LNX.4.63.0702260919330.3962@algonquin>

>> lexer grammar DUMMY_Lexer;
>> options { filter=true; }
>>
>> INT          : 'int' ;
>> SEMI         : ';' ;
>> WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
>> IDENTIFIER   : ('a'..'z'|'A'..'Z'|'_')+;
>
>Why are you using the filter option? This option causes ANTLR to try the 
>tokens one-by-one. It continues at the next token if the current token 
>does not match. So on the input 'intt' it will match an INT token first, 
>followed by the IDENTIFIER 't'. When you remove the filter option, it 
>should match a single IDENTIFIER token.

I guess the real reason is I am lazy. I did not want to tokenize 
everything contained in the input (I could have used the skip feature - 
but I was too lazy for that too!).

I still don't understand why the lexer would break the token at a 
character identified in a rule the lexer can match, and what it has to 
do with the filter=true. Perhaps an example would help me get that.

Cheers,
Martin

From e.papegaaij at student.utwente.nl  Mon Feb 26 07:19:52 2007
From: e.papegaaij at student.utwente.nl (Emond Papegaaij)
Date: Mon, 26 Feb 2007 16:19:52 +0100
Subject: [antlr-interest] antlr-interest Digest, Vol 27, Issue 48
In-Reply-To: <Pine.LNX.4.63.0702260919330.3962@algonquin>
References: <mailman.1700.1172499275.1974.antlr-interest@antlr.org>
	<Pine.LNX.4.63.0702260919330.3962@algonquin>
Message-ID: <200702261619.52373.e.papegaaij@student.utwente.nl>

On Monday 26 February 2007 15:46:03 Martin d'Anjou wrote:
> >> lexer grammar DUMMY_Lexer;
> >> options { filter=true; }
> >>
> >> INT          : 'int' ;
> >> SEMI         : ';' ;
> >> WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
> >> IDENTIFIER   : ('a'..'z'|'A'..'Z'|'_')+;
> >
> >Why are you using the filter option? This option causes ANTLR to try the
> >tokens one-by-one. It continues at the next token if the current token
> >does not match. So on the input 'intt' it will match an INT token first,
> >followed by the IDENTIFIER 't'. When you remove the filter option, it
> >should match a single IDENTIFIER token.
>
> I guess the real reason is I am lazy. I did not want to tokenize
> everything contained in the input (I could have used the skip feature -
> but I was too lazy for that too!).
>
> I still don't understand why the lexer would break the token at a
> character identified in a rule the lexer can match, and what it has to
> do with the filter=true. Perhaps an example would help me get that.

Suppose the input is 'id_int int_id'
With filter it first tries to match 'int' against the input, this fails. SEMI 
also fails, as does WS. Finally, with IDENTIFIER there is a match, the 
entire 'id_int' is matched. Now, it continues at the ' '. Again, it first 
tries INT and SEMI, but only WS succeeds. Now, it continues with 'int_id'. 
First, it tries to match INT, which succeeds. The INT token is returned and 
lexing continues with '_id'. This results in an IDENTIFIER.

The filter option is only useful if you want to lex snippets of the input. 
These snippets should have clear delimiters. For more information on the 
filter option:
http://www.antlr.org/wiki/display/ANTLR3/Lexical+filters

Best regards,
Emond

From vgusev at graphlogic.com  Mon Feb 26 07:53:28 2007
From: vgusev at graphlogic.com (Vladimir Gusev)
Date: Mon, 26 Feb 2007 10:53:28 -0500
Subject: [antlr-interest] Operator overloading?
In-Reply-To: <45E0BC2F.4060200@jazillian.com>
References: <632C3E36DCF16649AD770FE2646E9A18014D44C0@message-fr.ad.mathworks.com>	<CF60B2CA-2460-4D5B-90C8-3B9454DBA7A2@cs.usfca.edu>
	<001401c756cd$160f62e0$186fa8c0@graphlogic.com>
	<45E0BC2F.4060200@jazillian.com>
Message-ID: <009101c759be$4208f4d0$186fa8c0@graphlogic.com>

Andy,

Thanks for your comment. This is very similar to how I do it - by manually
overriding the default AST behaviour. I hoped this could be done in the
grammar file somehow. I guess it could not.


Vladimir


This communication, including attachments, is for the exclusive use of
addressee and may contain proprietary, confidential and/or privileged
information. If you are not the intended recipient, any use, copying,
disclosure, dissemination or distribution is strictly prohibited. If you are
not the intended recipient, please notify the sender immediately by return
e-mail, delete this communication and destroy all copies.


-----Original Message-----
From: Andy Tripp [mailto:antlr at jazillian.com] 
Sent: Saturday, February 24, 2007 5:29 PM
To: Vladimir Gusev
Cc: 'ANTLR Interest'
Subject: Re: [antlr-interest] Operator overloading?

Vladimir Gusev wrote:
> Hello,
>
> Is there a way to implement in my language operator overloading using
ANTLR?
> I would appreciate any thoughts about this.
>
> Thanks.
>
> Vladimir
>   
Yes, I think this could be done. I replace C++ operator overloading with
Java function calls as part of my C++ to Java translator (jazillian.com),
which is a little different but related.
Say you're creating a binary "+" operator between two Money objects like
this. You'd parse the source files into ASTs, search the ASTs for binary "+"

operators, and then
figure out the types of the left and right ASTs. If they're both type Money,
then this is the thing you're looking for, and you could replace the "+"
node in the AST by something else, such as some METHOD_CALL type of node.

Print out your modified AST, and you've just used ANTLR as a preprocessor to
convert operator overloading to code without operator overloading. In that
way, your "money1 + money2" expressions would become "money1.plus(money2)".

Andy



From cshogue at gmail.com  Mon Feb 26 08:06:41 2007
From: cshogue at gmail.com (Chris Hogue)
Date: Mon, 26 Feb 2007 09:06:41 -0700
Subject: [antlr-interest] v3 Java 1.5 grammar
Message-ID: <e8de82510702260806o1561b2det58f9cccc302b50eb@mail.gmail.com>

Has there been any more recent work on the v3 Java 1.5 example
grammar?  I found a number of problems with it that I've fixed so that
it now runs through the whole 1.5 JDK as well as a number of other
open source projects.

I'm happy to send in the changes, but won't bother if someone has
already done the work on it (and I just haven't seen it :)).

Thanks.

-Chris

From martin.danjou at neterion.com  Mon Feb 26 10:32:59 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Mon, 26 Feb 2007 13:32:59 -0500 (EST)
Subject: [antlr-interest] bug in 3.0b6: identifier/keyword or underscore
	problem?
Message-ID: <Pine.LNX.4.63.0702261319120.3962@algonquin>

On Monday 26 February 2007 15:46:03 Martin d'Anjou wrote:
>>>> lexer grammar DUMMY_Lexer;
>>>> options { filter=true; }
>>>>
>>>> INT          : 'int' ;
>>>> SEMI         : ';' ;
>>>> WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
>>>> IDENTIFIER   : ('a'..'z'|'A'..'Z'|'_')+;
>>>
>>>Why are you using the filter option? This option causes ANTLR to try
>>>the
>>>tokens one-by-one. It continues at the next token if the current token 
>>>does not match. So on the input 'intt' it will match an INT token
>>>first,
>>>followed by the IDENTIFIER 't'. When you remove the filter option, it
>>>should match a single IDENTIFIER token.
>>
>> I guess the real reason is I am lazy. I did not want to tokenize
>> everything contained in the input (I could have used the skip feature -
>> but I was too lazy for that too!).
>>
>> I still don't understand why the lexer would break the token at a
>> character identified in a rule the lexer can match, and what it has to
>> do with the filter=true. Perhaps an example would help me get that.
>
> Suppose the input is 'id_int int_id' With filter it first tries to match 
> 'int' against the input, this fails. SEMI also fails, as does WS. 
> Finally, with IDENTIFIER there is a match, the entire 'id_int' is 
> matched. Now, it continues at the ' '. Again, it first tries INT and 
> SEMI, but only WS succeeds.
>
> Now, it continues with 'int_id'. First, it tries to match INT, which 
> succeeds.

This is where I do not understand the behavior. I see how it can match 
INT, but my question is: why isn't it trying for the longest match, which 
would be IDENTIFIER. Perhaps this is because some languages do not require 
the use of a separator between tokens (BASIC? FORTRAN? J?) and that's what 
ANTLR wants to support? If so, would it make more sense to have an option 
defining that's the desired behavior rather than lumping it in with 
filter=true, which also happens to mean "ignored unspecified tokens"?

Regards,
Martin

From JeanMarc.Vanel at mathworks.fr  Mon Feb 26 10:42:06 2007
From: JeanMarc.Vanel at mathworks.fr (Jean Marc Vanel)
Date: Mon, 26 Feb 2007 19:42:06 +0100
Subject: [antlr-interest] adding content at
	endofrulewithTokenRewriteStream
Message-ID: <632C3E36DCF16649AD770FE2646E9A18014D4C0D@message-fr.ad.mathworks.com>

> How about abusing the rewrite syntax a bit, just so that you can
access
> the result tree for the rule,
> 
>   name_or_pointer
> 	:	(NAME STAR? -> NAME STAR?)
> 		{ tokens.insertAfter( $name_or_pointer.tree.stop, "blah"
); }
> 	;
> 
> I didn't test the code above, but I think I've done something like
that
> in the past.

[Jean-Marc Vanel] It's smart , but in fact , $name_or_pointer.tree.stop
, or 
name_or_pointer.tree.stop don't compile in the generated Java code.
> 
> The problem is (I think) that ANTLR doesn't normally set the
stop-token
> for the result tree until *after* the rule and all its actions have
> executed, which makes it tricky for the rule itself to get at this
> information.
> 
> Actually, all ANTLR does to set the stop-token is to assign the value
> from input.LT(-1), so maybe you could just use that,
> 
>   name_or_pointer
> 	:	NAME STAR? { tokens.insertAfter(input.LT(-1), "blah"); }
> 	;

[Jean-Marc Vanel] This works !!! Thanks a lot. I should have found it
myself ....

From jimi at intersystems.com  Mon Feb 26 11:29:44 2007
From: jimi at intersystems.com (Jim Idle)
Date: Mon, 26 Feb 2007 14:29:44 -0500
Subject: [antlr-interest] bug in 3.0b6: identifier/keyword or
	underscoreproblem?
In-Reply-To: <Pine.LNX.4.63.0702260708110.3962@algonquin>
References: <Pine.LNX.4.63.0702260708110.3962@algonquin>
Message-ID: <20070226192946.240708B4@mail.intersystems.com>

Why do you wish to have filter lexer though? Why not just have a catch
all rule at the end that matches anything and just assigns the channel
to hidden? It seems you might be using filters for something that
doesn't want to be done with a filter ;-)


THROWAWAY : . {$channel=hidden;}

Then use a normal parser/lexer combination?

Jim

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin d'Anjou
Sent: Monday, February 26, 2007 4:13 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] bug in 3.0b6: identifier/keyword or
underscoreproblem?

Hi,

I've been strugling with this for several days. It looks like 3.0b6
can't 
tell an identifier from a keyword, or has a problem with underscores.
Here 
is how I produce the problem:

1) input text

int id;
int int_id;
int _int_id;

2) Lexer

lexer grammar DUMMY_Lexer;
options { filter=true; }

INT          : 'int' ;
SEMI         : ';' ;
WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
IDENTIFIER   : ('a'..'z'|'A'..'Z'|'_')+;

3) Parser

parser grammar DUMMY_Parser;
options {
   tokenVocab=DUMMY_Lexer;
}

source_text :
   { System.out.println("Weird lexer"); }
   int_defs+
   ;

int_defs :
   INT            { System.out.print("int "); }
   id=IDENTIFIER  { System.out.print($id.text); }
   SEMI           { System.out.println(";"); }
   ;

4) The output and the error I get

Weird lexer
int id;
int line 2:4 mismatched input 'int' expecting IDENTIFIER
int;
int _int_id;


The lexer is not greedy or something is wrong with the underscore, I
don't 
know.

Help!!!
Martin

From FranklinChen at cmu.edu  Mon Feb 26 12:42:43 2007
From: FranklinChen at cmu.edu (FranklinChen at cmu.edu)
Date: Mon, 26 Feb 2007 15:42:43 -0500
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <9173C154-23E8-4A49-B23F-890707811134@classdump.org>
References: <200702261411.l1QEBBu03327@snvca-bs1-5-e0.astragate.net>
	<9173C154-23E8-4A49-B23F-890707811134@classdump.org>
Message-ID: <17891.17987.265104.522190@swan.psy.cmu.edu>

Kay Roepke writes:
> 
> On Feb 26, 2007, at 3:14 PM, Mark Bednarczyk wrote:
> 
> > So in essence, I rely on tree walker rules to do the matching and  
> > get me in
> > the right place of the AST, the action code to do any processing and
> > rewrites and then rewrite "->" to produce the templates in the last  
> > phase of
> > the processing.
> 
> Yeah, that's the way to do it right now. In the future it'd be  
> awesome to do tree
> transformations by having some syntax for it :)
> 
> cheers,
> -k

Yes, that's what I've been having to do also, performing rewrites by
hand.  The reason I really like having ANTLR 2 style tree
transformations is that for various purposes (debugging and
retargeting), it is useful for me to be able to have intermediate
trees.  In ANTLR 3, I am having to do do a lot inside actions, and
also this means that the whole parser has to be recompiled again and
again even though after the parsing itself is done (to the simplest
possible AST without rewrites), all I'm actually changing is the tree
structure I'm outputting.

-- 
Franklin

From martin.danjou at neterion.com  Mon Feb 26 15:48:52 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Mon, 26 Feb 2007 18:48:52 -0500 (EST)
Subject: [antlr-interest] antlr-interest Digest, Vol 27, Issue 49
In-Reply-To: <mailman.1.1172520001.2119.antlr-interest@antlr.org>
References: <mailman.1.1172520001.2119.antlr-interest@antlr.org>
Message-ID: <Pine.LNX.4.63.0702261834290.3962@algonquin>

>Why do you wish to have filter lexer though? Why not just have a catch
>all rule at the end that matches anything and just assigns the channel
>to hidden? It seems you might be using filters for something that
>doesn't want to be done with a filter ;-)

I don't understand why the lexer does not try the longest match before 
declaring the token type when filter=true.

Martin

From parrt at cs.usfca.edu  Mon Feb 26 17:58:54 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 26 Feb 2007 17:58:54 -0800
Subject: [antlr-interest] antlr-interest Digest, Vol 27, Issue 49
In-Reply-To: <Pine.LNX.4.63.0702261834290.3962@algonquin>
References: <mailman.1.1172520001.2119.antlr-interest@antlr.org>
	<Pine.LNX.4.63.0702261834290.3962@algonquin>
Message-ID: <E098DD71-D651-4138-866B-35A5D51ECD23@cs.usfca.edu>


On Feb 26, 2007, at 3:48 PM, Martin d'Anjou wrote:

>> Why do you wish to have filter lexer though? Why not just have a  
>> catch
>> all rule at the end that matches anything and just assigns the  
>> channel
>> to hidden? It seems you might be using filters for something that
>> doesn't want to be done with a filter ;-)
>
> I don't understand why the lexer does not try the longest match  
> before declaring the token type when filter=true.

Hi, [I'm back from my trip but still behind]

filter mode by definition does things in order specified.  The order  
is the precedence.  It uses backtracking when needed.

Ter

From parrt at cs.usfca.edu  Mon Feb 26 17:59:20 2007
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 26 Feb 2007 17:59:20 -0800
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <17891.17987.265104.522190@swan.psy.cmu.edu>
References: <200702261411.l1QEBBu03327@snvca-bs1-5-e0.astragate.net>
	<9173C154-23E8-4A49-B23F-890707811134@classdump.org>
	<17891.17987.265104.522190@swan.psy.cmu.edu>
Message-ID: <DB4A67E0-1E46-4C08-A472-DC4CDBBC70D8@cs.usfca.edu>

Hi. Sorry.  I need to add tree construction to tree parsers.  Will do  
after v3.0 release.  Very handy, I agree.
Ter
On Feb 26, 2007, at 12:42 PM, FranklinChen at cmu.edu wrote:

> Kay Roepke writes:
>>
>> On Feb 26, 2007, at 3:14 PM, Mark Bednarczyk wrote:
>>
>>> So in essence, I rely on tree walker rules to do the matching and
>>> get me in
>>> the right place of the AST, the action code to do any processing and
>>> rewrites and then rewrite "->" to produce the templates in the last
>>> phase of
>>> the processing.
>>
>> Yeah, that's the way to do it right now. In the future it'd be
>> awesome to do tree
>> transformations by having some syntax for it :)
>>
>> cheers,
>> -k
>
> Yes, that's what I've been having to do also, performing rewrites by
> hand.  The reason I really like having ANTLR 2 style tree
> transformations is that for various purposes (debugging and
> retargeting), it is useful for me to be able to have intermediate
> trees.  In ANTLR 3, I am having to do do a lot inside actions, and
> also this means that the whole parser has to be recompiled again and
> again even though after the parsing itself is done (to the simplest
> possible AST without rewrites), all I'm actually changing is the tree
> structure I'm outputting.
>
> -- 
> Franklin


From jan-oliver.hinzmann at dlr.de  Tue Feb 27 01:34:51 2007
From: jan-oliver.hinzmann at dlr.de (Jan Hinzmann)
Date: Tue, 27 Feb 2007 10:34:51 +0100
Subject: [antlr-interest] v3 Java 1.5 grammar
In-Reply-To: <e8de82510702260806o1561b2det58f9cccc302b50eb@mail.gmail.com>
References: <e8de82510702260806o1561b2det58f9cccc302b50eb@mail.gmail.com>
Message-ID: <200702271034.51163.jan-oliver.hinzmann@dlr.de>

Hi Chris,

I'm using the Java5 grammar found at:

http://www.antlr.org/grammar/list
http://www.antlr.org/grammar/1147455993609/Java5.zip

>Java 1.5 + Java preprocessor 
>Luca Colombi Fri May 12, 2006 10:46
>The grammar submitted by Michael Studman and revised by Scott Wisniewski, 
>adapted to compile without error also in eclipse with antlr plugin and jdk 
>1.5, and the java preprocessor ported in Java as a subclass of Reader.


In the Changelog (at the beginning of the file) you find this statements:

> ...
>* Version 1.22.5 (January 03, 2005)
> *    Small change to tree structure
> *    o Flattened classOrInterfaceType tree so IDENT no longer has children. 
>TYPE_ARGUMENTS are now
> *      always siblings of IDENT rather than children. Fully.qualified.names 
>trees now
> *      look a little less clean when TYPE_ARGUMENTS are present though.
> *
> ...

On Monday 26 February 2007 17:06, Chris Hogue wrote:
> Has there been any more recent work on the v3 Java 1.5 example
> grammar?  I found a number of problems with it that I've fixed so that
> it now runs through the whole 1.5 JDK as well as a number of other
> open source projects.
>
> I'm happy to send in the changes, but won't bother if someone has
> already done the work on it (and I just haven't seen it :)).
>
> Thanks.
>
> -Chris

hth, Jan

From antlr at jazillian.com  Tue Feb 27 06:04:19 2007
From: antlr at jazillian.com (Andy Tripp)
Date: Tue, 27 Feb 2007 09:04:19 -0500
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <45E22F3D.1050500@dm17.com>
References: <45E22F3D.1050500@dm17.com>
Message-ID: <45E43A63.6060401@jazillian.com>

Werner Lehmann wrote:
>
> If ANTLR3 would not yet provide an AST should I then use the Java 1.5 
> grammar created by Michael Studman or Michael Stahl (any experience 
> with either)?
>
See here for a full comparison of the two Java1.5 grammars:
http://www.antlr.org/pipermail/antlr-interest/2004-October/009742.html


From martin.danjou at neterion.com  Tue Feb 27 11:26:42 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 27 Feb 2007 14:26:42 -0500 (EST)
Subject: [antlr-interest] fragment: simple (or naive) usage does not work
Message-ID: <Pine.LNX.4.63.0702271420390.3962@algonquin>

Hi,

This is my input:
int id;
int int_id;
int _int_id;
45b32
6h87z

I have to parse those pesky numbers at the botom. So I wrote the following 
lexer:

lexer grammar DUMMY_Lexer;
INT          : 'int' ;
SEMI         : ';' ;
WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;

IDENTIFIER   :
    ('a'..'z'|'A'..'Z'|'_')+ ;

NUMBER : DIGIT+ (BASE ZNUM+)? ;
fragment ZNUM : DIGIT|'z'|'Z' ;
fragment BASE : 'b' | 'h';
fragment DIGIT : '0'..'9';

And of course the parser:

parser grammar DUMMY_Parser;
options {
   tokenVocab=DUMMY_Lexer;
}

source_text :
   { System.out.println("Weird lexer"); }
   int_defs+
   numbers+
   ;

int_defs :
   INT            { System.out.print("int "); }
   id=IDENTIFIER  { System.out.print($id.text); }
   SEMI           { System.out.println(";"); }
   ;

numbers :
   n=NUMBER         { System.out.println($n.text); }
   ;


Alas, I get:
line 4:0 required (...)+ loop did not match anything at input '45b32'

If I move ZNUM inside NUMBER, like this:

NUMBER : DIGIT+ (BASE (DIGIT|'z'|'Z')+)? ;

then it works. What's up with fragment lexer rules?

Thanks,
Martin

From jimi at intersystems.com  Tue Feb 27 11:33:55 2007
From: jimi at intersystems.com (Jim Idle)
Date: Tue, 27 Feb 2007 14:33:55 -0500
Subject: [antlr-interest] fragment: simple (or naive) usage does not work
In-Reply-To: <Pine.LNX.4.63.0702271420390.3962@algonquin>
References: <Pine.LNX.4.63.0702271420390.3962@algonquin>
Message-ID: <20070227193356.DA67368@mail.intersystems.com>

Martin,

I have noticed something similar to this and am trying to distill a
decent example for Ter (maybe this is it). I think that the set handling
is failing when a fragment rule is used like this (I noticed it with
(~(FRAGMENT))* for instance). Hence it is trying to parse something but
it ain't what it should be. The workaround, as you say, is to avoid the
fragment rule in this case.

You might be able to see whether this is doing what you want by putting
this example in ANTLR works and clicking on the lexer rule. It will show
the character sequences it is going to look after and I think you will
see that it gives a different sequence when you use a fragment and that
is what is going wrong.

Jim

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin d'Anjou
Sent: Tuesday, February 27, 2007 11:27 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] fragment: simple (or naive) usage does not
work

Hi,

This is my input:
int id;
int int_id;
int _int_id;
45b32
6h87z

I have to parse those pesky numbers at the botom. So I wrote the
following 
lexer:

lexer grammar DUMMY_Lexer;
INT          : 'int' ;
SEMI         : ';' ;
WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;

IDENTIFIER   :
    ('a'..'z'|'A'..'Z'|'_')+ ;

NUMBER : DIGIT+ (BASE ZNUM+)? ;
fragment ZNUM : DIGIT|'z'|'Z' ;
fragment BASE : 'b' | 'h';
fragment DIGIT : '0'..'9';

And of course the parser:

parser grammar DUMMY_Parser;
options {
   tokenVocab=DUMMY_Lexer;
}

source_text :
   { System.out.println("Weird lexer"); }
   int_defs+
   numbers+
   ;

int_defs :
   INT            { System.out.print("int "); }
   id=IDENTIFIER  { System.out.print($id.text); }
   SEMI           { System.out.println(";"); }
   ;

numbers :
   n=NUMBER         { System.out.println($n.text); }
   ;


Alas, I get:
line 4:0 required (...)+ loop did not match anything at input '45b32'

If I move ZNUM inside NUMBER, like this:

NUMBER : DIGIT+ (BASE (DIGIT|'z'|'Z')+)? ;

then it works. What's up with fragment lexer rules?

Thanks,
Martin

From martin.danjou at neterion.com  Tue Feb 27 11:51:00 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 27 Feb 2007 14:51:00 -0500 (EST)
Subject: [antlr-interest] fragment: simple (or naive) usage does not work
In-Reply-To: <20070227193356.DA67368@mail.intersystems.com>
References: <Pine.LNX.4.63.0702271420390.3962@algonquin>
	<20070227193356.DA67368@mail.intersystems.com>
Message-ID: <Pine.LNX.4.63.0702271437350.3962@algonquin>

> You might be able to see whether this is doing what you want by putting
> this example in ANTLR works and clicking on the lexer rule. It will show

I'd love to but ANTLR works 1.0b8 and 1.0b9 do not work for me. Dialogs 
and pop ups are all blank and I don't know how to fix that. For good or 
for worse, I'm stuck debuging with printf.

BTW, I invoke antlrworks this way:
/work/java/jdk1.5.0_11/bin/java -Xmx512m -jar antlrworks-1.0b9.jar

My CLASSPATH is empty. Maybe I'm missing a jar dependency?

Martin

From martin.danjou at neterion.com  Tue Feb 27 12:06:37 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 27 Feb 2007 15:06:37 -0500 (EST)
Subject: [antlr-interest] Fundamental question on lexer rule ordering
Message-ID: <Pine.LNX.4.63.0702271453220.3962@algonquin>

Hi!

I must be missing something fundamental on lexer rule ordering, because I 
keep running into the same problem over and over: re-ordering rules 
changes the lexer from "working" to "failing", and I don't understand why.

Note, this is not the same question as my previous posting on fragment.

Take this input text, it's got multiline comment in it:

int id;
int int_id;
int _int_id;
/*
  nothing
*/
45b32
6h87z


I have two lexers, one that work and one that fails. This one works:

lexer grammar DUMMY_Lexer;
INT        : 'int' ;
SEMI       : ';' ;
WS         : (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
IDENTIFIER : ('a'..'z'|'A'..'Z'|'_')+;
NUMBER     : DIGIT+ (BASE (DIGIT|'z'|'Z')+)? ;
ML_COMMENT : '/*' ( options {greedy=false;} : .)* '*/' {$channel=HIDDEN;} ;
fragment
BASE       : 'b' | 'h';
fragment
DIGIT      : '0'..'9';


This one does not work:

lexer grammar DUMMY_Lexer;
INT        : 'int' ;
SEMI       : ';' ;
WS         :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
ML_COMMENT : '/*' ( options {greedy=false;} : .)* '*/' {$channel=HIDDEN;} ;
IDENTIFIER : ('a'..'z'|'A'..'Z'|'_')+ ;
NUMBER     : DIGIT+ (BASE (DIGIT|'z'|'Z')+)? ;
fragment
BASE       : 'b' | 'h';
fragment
DIGIT      : '0'..'9';


The only difference is ML_COMMENT is in a different position. I can 
picture a machine consuming characters and trying to match tokens, but all 
these tokens I'm lexing are very different and I don't understand how the 
order could possibly matter in this case.

I'd really like to understand. I appologize if this is in the manual, I 
must have missed it.

Thanks!
Martin

From martin.danjou at neterion.com  Tue Feb 27 12:39:42 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 27 Feb 2007 15:39:42 -0500 (EST)
Subject: [antlr-interest] antlrworks and ratpoison don't work well together
In-Reply-To: <Pine.LNX.4.63.0702271437350.3962@algonquin>
References: <Pine.LNX.4.63.0702271420390.3962@algonquin>
	<20070227193356.DA67368@mail.intersystems.com>
	<Pine.LNX.4.63.0702271437350.3962@algonquin>
Message-ID: <Pine.LNX.4.63.0702271526410.3962@algonquin>

On Tue, 27 Feb 2007, Martin d'Anjou wrote:
>> You might be able to see whether this is doing what you want by putting
>> this example in ANTLR works and clicking on the lexer rule. It will show
>
> I'd love to but ANTLR works 1.0b8 and 1.0b9 do not work for me. Dialogs and 
> pop ups are all blank and I don't know how to fix that. For good or for 
> worse, I'm stuck debuging with printf.
>
> BTW, I invoke antlrworks this way:
> /work/java/jdk1.5.0_11/bin/java -Xmx512m -jar antlrworks-1.0b9.jar
>
> My CLASSPATH is empty. Maybe I'm missing a jar dependency?

Okay, I figured out my antlrworks problem... I use the ratpoison window 
manager. On KDE the pop ups are not blank, and I was able to observe they 
are not pop ups, they are detached windows (like the "input" window), 
though the splash screen was blank on KDE. FYI, this is CentOS on a linux 
machine. I would not bother with it, the probably small audience does not 
justify it.

Martin

From jbb at acm.org  Tue Feb 27 14:32:44 2007
From: jbb at acm.org (John B. Brodie)
Date: Tue, 27 Feb 2007 17:32:44 -0500
Subject: [antlr-interest] Fundamental question on lexer rule ordering
In-Reply-To: <Pine.LNX.4.63.0702271453220.3962@algonquin> (message from Martin
	d'Anjou on Tue, 27 Feb 2007 15:06:37 -0500 (EST))
References: <Pine.LNX.4.63.0702271453220.3962@algonquin>
Message-ID: <E1HMAsG-0008JE-00@gecko>

Greetings!

>I must be missing something fundamental on lexer rule ordering, because I 
>keep running into the same problem over and over: re-ordering rules 
>changes the lexer from "working" to "failing", and I don't understand why.

Is your Lexer in a separate .g file from your Parser (I seem to
remember seeing an importvocab in one of your earlier parser
postings)?

If so, are you sure you are re-building the Parser after each change
to the Lexer. Re-ordering the Lexer rules will change the Token Types
assigned by the Lexer and thus the Parser needs to be rebuilt in order
to adapt to those new assignments.


Hope this helps...
   -jbb

From martin.danjou at neterion.com  Tue Feb 27 14:54:14 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Tue, 27 Feb 2007 17:54:14 -0500 (EST)
Subject: [antlr-interest] Fundamental question on lexer rule ordering
In-Reply-To: <E1HMAsG-0008JE-00@gecko>
References: <Pine.LNX.4.63.0702271453220.3962@algonquin>
	<E1HMAsG-0008JE-00@gecko>
Message-ID: <Pine.LNX.4.63.0702271745310.3962@algonquin>

On Tue, 27 Feb 2007, John B. Brodie wrote:
> Greetings!
>
>> I must be missing something fundamental on lexer rule ordering, because I
>> keep running into the same problem over and over: re-ordering rules
>> changes the lexer from "working" to "failing", and I don't understand why.
>
> Is your Lexer in a separate .g file from your Parser (I seem to
> remember seeing an importvocab in one of your earlier parser
> postings)?
>
> If so, are you sure you are re-building the Parser after each change
> to the Lexer. Re-ordering the Lexer rules will change the Token Types
> assigned by the Lexer and thus the Parser needs to be rebuilt in order
> to adapt to those new assignments.

That was the problem. My makefile did not re-build the parser when the 
lexer changes (I guess the dependency is on the token file changing). I 
added a dependency to my parser rule and it fixed the problem.

Thanks!
Martin

From jimi at intersystems.com  Tue Feb 27 15:43:45 2007
From: jimi at intersystems.com (Jim Idle)
Date: Tue, 27 Feb 2007 18:43:45 -0500
Subject: [antlr-interest] Looking for contract work
Message-ID: <20070227234347.3E7A365B@mail.intersystems.com>

My current contract (for which, I wrote the C runtime for ANTLR3) is
coming to an end. 

 

After begging and pleading with Ter for seconds, he has allowed me a
short post here to see if anyone has anything open at the moment that
involves working with ANTLR - preferably ANTLR3 and even more preferably
with C output (though I will work with any of the outputs except Python,
which is no reflection on the Python code generator; I just don't care
for Python - the language, not comedy by obscure relatives ;-)).

 

If you think you might have something of interest, please feel free to
email me off list.

 

Thanks,

 

Jim Idle

http://www.linkedin.com/in/jimidle <http://www.linkedin.com/in/jimidle> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070227/d790b68b/attachment.html 

From marvin.the.cynical.robot at gmail.com  Tue Feb 27 16:15:16 2007
From: marvin.the.cynical.robot at gmail.com (Kenneth Stephen)
Date: Tue, 27 Feb 2007 18:15:16 -0600
Subject: [antlr-interest] boolean expression with parenthesis parsing
	problems
Message-ID: <808d4e7c0702271615j56dc5853l23731f80ca36fe4f@mail.gmail.com>

Hi,

    I'm trying to write a parser for a trimmed down version of SQL.
Here is the ANTLR file that I've come up with so far:

header {

package com.ibm.aix.internal.parsers.sql;

	//  Generated code. Do not modify directly unless you really really know
	//  what you are doing.
}

class SQLParser extends Parser;

options {
	k = 10;
}

select_statement:
	select_clause from_clause (where_clause)?
	;
	
select_clause:
	SELECT column (COMMA column)*
	;

from_clause:
	FROM table (COMMA table)*
	;
	
where_clause:
	WHERE search_condition
	;

search_condition:
	(LPAREN or_expr RPAREN) | or_expr;
	
or_expr:
	and_expr (OR and_expr)*;
	
and_expr:
	predicate (AND predicate)*;
	
predicate:
	(predicate_side TEST_OPERATOR predicate_side);
	
predicate_side:
	((correlation_name FULLSTOP)? column_name)| STRING | INTEGER;

column:
	(((correlation_name FULLSTOP)? column_name)| STRING) ((AS)? column_alias)?;

column_name:
	i:IDENTIFIER {System.out.println("column_name = " + i.getText());};

column_alias: IDENTIFIER;
	
correlation_name: IDENTIFIER;

table:
	table_name (correlation_name)?
	;

table_name: i:IDENTIFIER {System.out.println("Table name = " + i.getText());};
	
class SQLLexer extends Lexer;

options {
	k = 2;
}

tokens {
	SELECT = "select";
	AS = "as";
	FROM = "from";
	WHERE = "where";
	AND = "and";
	OR = "or";
	NOT = "not";
}

IDENTIFIER
	: (ALPHA)(ALPHA|DIGIT)*
	;

STRING
	: '\'' ('\u0009'|'\u0020' | NONWHITESPACE | ESCAPED_APOS)* '\''
	;
	
INTEGER
	: (DIGIT)+
	;
	
protected
NONWHITESPACE
	: '\u0021'..'\u0026'|'\u002a'|'\u002b'|'\u002d'|'\u002F'|LPAREN |
RPAREN | COMMA | FULLSTOP | DIGIT |
	  '\u003A'..'\u0040'|'\u005b'..'\u0060'| ALPHA
|'\u007b'..'\u007e'|'\u0085'|'\u00e0'..'\u00ff'
	;

protected
DIGIT
	: '\u0030'..'\u0039'
	;

protected
ALPHA
	: '\u0041'..'\u005a' | '\u0061'..'\u007a'
	;
	
WHITESPACE
	: ('\n' {newline();}|"\r\n" {newline();}|' '|'\t')
	{$setType(Token.SKIP);}
	;
	
LPAREN: '\u0028';
RPAREN: '\u0029';

COMMA : '\u002c' {System.out.println("Gotcha!");};

FULLSTOP : '\u002e';

protected
ESCAPED_APOS
	: "''"
	;
	
TEST_OPERATOR
	: '='|'<'|"<="|'>'|">="|"<>"
	;

    My current problems are with trying to get boolean expression
parsed in the where clause. The rules search_condition, or_expr,
and_expr, predicate, and predicate_side are intended to do that. The
following statement is something that should be recognized :

 select blah, test, 'something' from jiminy where (a = b and (c = d or e = f))

....but instead it dies with

Gotcha!
column_name = blah
Gotcha!
column_name = test
Table name = jiminy
column_name = a
column_name = b
line 1:61: unexpected token: (column_name = d
column_name = e
column_name = f

    I understand why the error is happening - its because a
"predicate" should be substitutable by a "search_condition". However,
I dont know how to fix this problem. When I  try something like

predicate:
	(predicate_side TEST_OPERATOR predicate_side) | search_condition;

    ....ANTLR itself seems to go into an infinite loop and dies after
exhausting the JVM stack. This is puzzling to me because the example
for the expression parser that is up at
http://www.cs.usfca.edu/~parrt/course/652/lectures/antlr.html , seems
to be doing with the ATOM production, just what I tried. Can someone
guide me onto the right path please?

Thanks,
Kenneth

From clinton.roy at gmail.com  Tue Feb 27 17:10:52 2007
From: clinton.roy at gmail.com (Clinton Roy)
Date: Wed, 28 Feb 2007 11:10:52 +1000
Subject: [antlr-interest] beta6, alternation produces non compiling code.
Message-ID: <9c0715e40702271710i5bad25c6p1b4bafec325730cd@mail.gmail.com>

Hi guys,

I'm sure someone has come across this before, but I couldn't spot anything.

list.g:
------
grammar list;
list : elem (',' elem)* ;
elem : 'a'..'z'|'A'..'Z' ;
------

generates this for elem:
------
    public void elem() throws RecognitionException {
        try {
            // list.g:3:6: ( ('a'..'z'|'A'..'Z'))
            // list.g:3:8: ('a'..'z'|'A'..'Z')
            {
            if (  ) {
                input.consume();
                errorRecovery=false;
            }
------

In debugging mode the empty if predicate is actually an
<empty-set-expr>. I can seemingly work around this problem with some
redundant bracketing around one of the alternatives.

I feel like I must be doing something silly :)
-- 
Clinton Roy
www.acqao.org - ARC Centre of Excellence for Quantum-Atom Optics
www.humbug.org.au  - Brisbane Unix Group
azure.humbug.org.au/~croy/blog - Blog
www.flickr.com/photos/croy/ - Photos

From jimi at intersystems.com  Tue Feb 27 21:11:29 2007
From: jimi at intersystems.com (Jim Idle)
Date: Wed, 28 Feb 2007 00:11:29 -0500
Subject: [antlr-interest] beta6, alternation produces non compiling code.
In-Reply-To: <9c0715e40702271710i5bad25c6p1b4bafec325730cd@mail.gmail.com>
References: <9c0715e40702271710i5bad25c6p1b4bafec325730cd@mail.gmail.com>
Message-ID: <20070228051316.352DD17E3@mail.intersystems.com>

Clinton,

I will let Ter comment as to whether this SHOULD work, but intuitively
(at least to me ;-), you are trying to do to much in the parser. Of
course, this could be just a simplified example you are using to show
the issue. But, if not the:

Grammar list;

list : ELEM (COMMA ELEM)* ;

COMMA : ',' ;
ELEM : 'a'..'z' | 'A'..'Z'  ;


(There isn't any need to create COMMA really, it is just my own force of
habit). 

Jim

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Clinton Roy
Sent: Tuesday, February 27, 2007 5:11 PM
To: ANTLR List
Subject: [antlr-interest] beta6, alternation produces non compiling
code.

Hi guys,

I'm sure someone has come across this before, but I couldn't spot
anything.

list.g:
------
grammar list;
list : elem (',' elem)* ;
elem : 'a'..'z'|'A'..'Z' ;
------

generates this for elem:
------
    public void elem() throws RecognitionException {
        try {
            // list.g:3:6: ( ('a'..'z'|'A'..'Z'))
            // list.g:3:8: ('a'..'z'|'A'..'Z')
            {
            if (  ) {
                input.consume();
                errorRecovery=false;
            }
------

In debugging mode the empty if predicate is actually an
<empty-set-expr>. I can seemingly work around this problem with some
redundant bracketing around one of the alternatives.

I feel like I must be doing something silly :)
-- 
Clinton Roy
www.acqao.org - ARC Centre of Excellence for Quantum-Atom Optics
www.humbug.org.au  - Brisbane Unix Group
azure.humbug.org.au/~croy/blog - Blog
www.flickr.com/photos/croy/ - Photos

From ssiegel at finjan.com  Wed Feb 28 02:33:17 2007
From: ssiegel at finjan.com (Shmuel Siegel)
Date: Wed, 28 Feb 2007 12:33:17 +0200
Subject: [antlr-interest] fragment: simple (or naive) usage does not work
In-Reply-To: <Pine.LNX.4.63.0702271420390.3962@algonquin>
References: <Pine.LNX.4.63.0702271420390.3962@algonquin>
Message-ID: <E344C433F006AB45A306D422F9C3EB4C01749003@exmail1.finjan.com>

Works for me in the Antlrworks interpreter. Version 1.0b9
It parses all five lines. And produces a parse tree. Zip of the parse
tree is attached.

I used a combined grammar.

grammar boo;

INT          : 'int' ;
SEMI         : ';' ;
WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;

IDENTIFIER   :
    ('a'..'z'|'A'..'Z'|'_')+ ;

NUMBER : DIGIT+ (BASE ZNUM+)? ;
fragment ZNUM : DIGIT|'z'|'Z' ;
fragment BASE : 'b' | 'h';
fragment DIGIT : '0'..'9';


source_text :
   { System.out.println("Weird lexer"); }
   int_defs+
   numbers+
   ;

int_defs :
   INT            { System.out.print("int "); }
   id=IDENTIFIER  { System.out.print($id.text); }
   SEMI           { System.out.println(";"); }
   ;

numbers :
   n=NUMBER         { System.out.println($n.text); }
   ;



-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin d'Anjou
Sent: Tuesday, February 27, 2007 9:27 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] fragment: simple (or naive) usage does not
work

Hi,

This is my input:
int id;
int int_id;
int _int_id;
45b32
6h87z

I have to parse those pesky numbers at the botom. So I wrote the
following 
lexer:

lexer grammar DUMMY_Lexer;
INT          : 'int' ;
SEMI         : ';' ;
WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;

IDENTIFIER   :
    ('a'..'z'|'A'..'Z'|'_')+ ;

NUMBER : DIGIT+ (BASE ZNUM+)? ;
fragment ZNUM : DIGIT|'z'|'Z' ;
fragment BASE : 'b' | 'h';
fragment DIGIT : '0'..'9';

And of course the parser:

parser grammar DUMMY_Parser;
options {
   tokenVocab=DUMMY_Lexer;
}

source_text :
   { System.out.println("Weird lexer"); }
   int_defs+
   numbers+
   ;

int_defs :
   INT            { System.out.print("int "); }
   id=IDENTIFIER  { System.out.print($id.text); }
   SEMI           { System.out.println(";"); }
   ;

numbers :
   n=NUMBER         { System.out.println($n.text); }
   ;


Alas, I get:
line 4:0 required (...)+ loop did not match anything at input '45b32'

If I move ZNUM inside NUMBER, like this:

NUMBER : DIGIT+ (BASE (DIGIT|'z'|'Z')+)? ;

then it works. What's up with fragment lexer rules?

Thanks,
Martin

-------------- next part --------------
A non-text attachment was scrubbed...
Name: boo.zip
Type: application/x-zip-compressed
Size: 6791 bytes
Desc: boo.zip
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20070228/b99b6e39/attachment-0001.bin 

From jaluber at gmx.de  Wed Feb 28 03:06:11 2007
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 28 Feb 2007 12:06:11 +0100
Subject: [antlr-interest] beta6, alternation produces non compiling code.
In-Reply-To: <20070228051316.352DD17E3@mail.intersystems.com>
References: <9c0715e40702271710i5bad25c6p1b4bafec325730cd@mail.gmail.com>
	<20070228051316.352DD17E3@mail.intersystems.com>
Message-ID: <45E56223.70102@gmx.de>

Hello!

I'm wondering myself, if I miss something, but

> Grammar list;
> 
> list : ELEM (COMMA ELEM)* ;
> 
> COMMA : ',' ;
> ELEM : 'a'..'z' | 'A'..'Z'  ;

doesn't look different to me than

> list.g:
> ------
> grammar list;
> list : elem (',' elem)* ;
> elem : 'a'..'z'|'A'..'Z' ;
> ------

(unless you count the COMMA). Why doesn't work the latter?

Best regards,
Johannes Luber


From h.kocher at pharmatechnik.de  Wed Feb 28 03:11:59 2007
From: h.kocher at pharmatechnik.de (Dr. Kocher, Hartmut)
Date: Wed, 28 Feb 2007 12:11:59 +0100
Subject: [antlr-interest] beta6, alternation produces non compiling code.
In-Reply-To: <45E56223.70102@gmx.de>
References: <9c0715e40702271710i5bad25c6p1b4bafec325730cd@mail.gmail.com><20070228051316.352DD17E3@mail.intersystems.com>
	<45E56223.70102@gmx.de>
Message-ID: <D43540A44D3F794787378D8B08E8AE53FA3F9D@staexc01.pharmatechnik.de>

The problem is with lexer vs. parser rules: Lexer rules are upper case. Parser rules are lower case. ELEM must be a lexer rule. Therefore, it must be named starting with an upper case letter. List is a parser rule. Therefore it must be lower case. That's why your first approach doesn't work.

Hope this helps

Dr. Hartmut Kocher
Cortex Brainware

-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Johannes Luber
Gesendet: Mittwoch, 28. Februar 2007 12:06
An: antlr-interest at antlr.org
Betreff: Re: [antlr-interest] beta6, alternation produces non compiling code.

Hello!

I'm wondering myself, if I miss something, but

> Grammar list;
> 
> list : ELEM (COMMA ELEM)* ;
> 
> COMMA : ',' ;
> ELEM : 'a'..'z' | 'A'..'Z'  ;

doesn't look different to me than

> list.g:
> ------
> grammar list;
> list : elem (',' elem)* ;
> elem : 'a'..'z'|'A'..'Z' ;
> ------

(unless you count the COMMA). Why doesn't work the latter?

Best regards,
Johannes Luber



--------------------------------------------------------------------
Pharmatechnik GmbH & Co. KG
M?nchner Stra?e 15
D-82319 Starnberg

Sitz der Gesellschaft: Starnberg
HRA: 64434, HRB: 66369, Amtsgericht M?nchen
Gesch?ftsf?hrer: Dr. Detlef Graessner, Werner Torns, Stephan J?rgens

From jaluber at gmx.de  Wed Feb 28 03:21:52 2007
From: jaluber at gmx.de (Johannes Luber)
Date: Wed, 28 Feb 2007 12:21:52 +0100
Subject: [antlr-interest] beta6, alternation produces non compiling code.
In-Reply-To: <D43540A44D3F794787378D8B08E8AE53FA3F9D@staexc01.pharmatechnik.de>
References: <9c0715e40702271710i5bad25c6p1b4bafec325730cd@mail.gmail.com><20070228051316.352DD17E3@mail.intersystems.com>
	<45E56223.70102@gmx.de>
	<D43540A44D3F794787378D8B08E8AE53FA3F9D@staexc01.pharmatechnik.de>
Message-ID: <45E565D0.7090701@gmx.de>

Dr. Kocher, Hartmut wrote:
> The problem is with lexer vs. parser rules: Lexer rules are upper case. Parser rules are lower case.
> ELEM must be a lexer rule. Therefore, it must be named starting with
an upper case letter.
> List is a parser rule. Therefore it must be lower case. That's why
your first approach doesn't work.
> 
> Hope this helps
> 
> Dr. Hartmut Kocher
> Cortex Brainware

Thanks!

I'm still reading the ANTLR Reference book and the few chapters I've
already read didn't mention this. It explains why an example grammar I
wrote didn't work, too. Maybe Terrence should put that info into the
book somewhat sooner.

Johannes Luber

> -----Urspr?ngliche Nachricht-----
> Von: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] Im Auftrag von Johannes Luber
> Gesendet: Mittwoch, 28. Februar 2007 12:06
> An: antlr-interest at antlr.org
> Betreff: Re: [antlr-interest] beta6, alternation produces non compiling code.
> 
> Hello!
> 
> I'm wondering myself, if I miss something, but
> 
>> Grammar list;
>>
>> list : ELEM (COMMA ELEM)* ;
>>
>> COMMA : ',' ;
>> ELEM : 'a'..'z' | 'A'..'Z'  ;
> 
> doesn't look different to me than
> 
>> list.g:
>> ------
>> grammar list;
>> list : elem (',' elem)* ;
>> elem : 'a'..'z'|'A'..'Z' ;
>> ------
> 
> (unless you count the COMMA). Why doesn't work the latter?
> 
> Best regards,
> Johannes Luber
> 
> 
> 
> --------------------------------------------------------------------
> Pharmatechnik GmbH & Co. KG
> M?nchner Stra?e 15
> D-82319 Starnberg
> 
> Sitz der Gesellschaft: Starnberg
> HRA: 64434, HRB: 66369, Amtsgericht M?nchen
> Gesch?ftsf?hrer: Dr. Detlef Graessner, Werner Torns, Stephan J?rgens
> 



From martin.danjou at neterion.com  Wed Feb 28 06:16:45 2007
From: martin.danjou at neterion.com (Martin d'Anjou)
Date: Wed, 28 Feb 2007 09:16:45 -0500 (EST)
Subject: [antlr-interest] fragment: simple (or naive) usage does not work
In-Reply-To: <Pine.LNX.4.63.0702271420390.3962@algonquin>
References: <Pine.LNX.4.63.0702271420390.3962@algonquin>
Message-ID: <Pine.LNX.4.63.0702280912360.3962@algonquin>

> This is my input:
> int id;
> int int_id;
> int _int_id;
> 45b32
> 6h87z
>
> I have to parse those pesky numbers at the botom. So I wrote the following 
> lexer:
>
> lexer grammar DUMMY_Lexer;
> INT          : 'int' ;
> SEMI         : ';' ;
> WS           :  (  ' '| '\t'| '\r' | '\n' )+ {$channel=HIDDEN;} ;
>
> IDENTIFIER   :
>   ('a'..'z'|'A'..'Z'|'_')+ ;
>
> NUMBER : DIGIT+ (BASE ZNUM+)? ;
> fragment ZNUM : DIGIT|'z'|'Z' ;
> fragment BASE : 'b' | 'h';
> fragment DIGIT : '0'..'9';
>
> And of course the parser:
>
> parser grammar DUMMY_Parser;
> options {
>  tokenVocab=DUMMY_Lexer;
> }
>
> source_text :
>  { System.out.println("Weird lexer"); }
>  int_defs+
>  numbers+
>  ;
>
> int_defs :
>  INT            { System.out.print("int "); }
>  id=IDENTIFIER  { System.out.print($id.text); }
>  SEMI           { System.out.println(";"); }
>  ;
>
> numbers :
>  n=NUMBER         { System.out.println($n.text); }
>  ;
>
>
> Alas, I get:
> line 4:0 required (...)+ loop did not match anything at input '45b32'
>
> If I move ZNUM inside NUMBER, like this:
>
> NUMBER : DIGIT+ (BASE (DIGIT|'z'|'Z')+)? ;
>
> then it works. What's up with fragment lexer rules?

I found the problem. Using tokenVocab in the parser means the parser needs 
to be rebuilt when the Lexer changes, which is something I was missing in 
my Makefile. I'm just not used to work with the Java flow I guess.

Martin

From wl at dm17.com  Wed Feb 28 13:04:03 2007
From: wl at dm17.com (Werner Lehmann)
Date: Wed, 28 Feb 2007 22:04:03 +0100
Subject: [antlr-interest] ANTLR 3 output=AST for tree parser?
In-Reply-To: <45E43A63.6060401@jazillian.com>
References: <45E22F3D.1050500@dm17.com> <45E43A63.6060401@jazillian.com>
Message-ID: <45E5EE43.4010801@dm17.com>

Hi Andy,

On 27.02.2007 15:04, Andy Tripp wrote:
> See here for a full comparison of the two Java1.5 grammars:
> http://www.antlr.org/pipermail/antlr-interest/2004-October/009742.html

thanks for this, quite interesting. Actually I found that Michael 
Studman's grammar works as a seamless upgrade to the 1.3/1.4 grammar I 
was using before (I think it was created by Terence). The AST is 
compatible to the extent I am needing it. I will need comments though 
(at least the method javadoc) because I use this for 3-tier code 
generation - I had modified the 1.3/1.4 grammar to include comments in 
the AST.

Werner

From vadimtro at yahoo.com  Wed Feb 28 14:51:17 2007
From: vadimtro at yahoo.com (Vadim Tropashko)
Date: Wed, 28 Feb 2007 14:51:17 -0800 (PST)
Subject: [antlr-interest] Duplicate nodes on a parse tree?
Message-ID: <20070228225117.25593.qmail@web36804.mail.mud.yahoo.com>

I'm leveraging debugger parse tree generation as
described in
http://www.antlr.org/wiki/pages/viewpage.action?pageId=1760

Everything works as advertised, although I'm getting
duplicate nodes. For example given the rule:

boolean_primary options { backtrack=true; }
:         sim_expr
|
 member_predicate
|                          comparison_predicate
;

I'm getting the tree branch like this

boolean_primary
    sim_expr
        ....
    sim_expr
        ....

Is the duplicate "sim_expr" branch occurrence due to
backtracking?  Then what would be the right way to
filter out those ghost nodes? 


 
____________________________________________________________________________________
8:00? 8:25? 8:40? Find a flick in no time 
with the Yahoo! Search movie showtime shortcut.
http://tools.search.yahoo.com/shortcuts/#news

From hwk.cortex-brainware at t-online.de  Wed Feb 28 15:04:07 2007
From: hwk.cortex-brainware at t-online.de (Dr. Hartmut Kocher)
Date: Thu, 1 Mar 2007 00:04:07 +0100
Subject: [antlr-interest] Code generation bug in tree parser (ANTLRV3b6)
Message-ID: <066101c75b8c$c01529f0$1601a8c0@kocher>

In my tree parser I get several instances of the form:

 

case 45:

       int LA7_4 = input.LA(2);

       if ( (LA7_4 == DOWN) )

       {

 

This doesn?t compile as there is no token constant ?DOWN? defined in the
parser.

 

There are two possible ways to fix this: Either generate    public const int
DOWN = 2; into the file, or generate ?Token.DOWN? wherever it is used.

 

As I don?t know which is the intended behavior, I hacked Target.java for now
to return ?Token.DOWN? instead of ?DOWN?.

 

/** Target must be able to override the labels used for token types */

            public String getTokenTypeAsTargetLabel(CodeGenerator generator,
int ttype) {

                        String name =
generator.grammar.getTokenDisplayName(ttype);

                        // If name is a literal, return the token type
instead

                        if ( name.charAt(0)=='\'' ) {

                                   return String.valueOf(ttype);

                        }

                        // HACK!!!

                        if(name.equals("DOWN")) {

                                   name = "Token.DOWN";

                        }

                        return name;

            }

 

Same might happen with ?UP? as this is also excluded from the token
definition list


 

Please put his in the bug list.

 

Kind regards

 

Dr. Hartmut Kocher

Cortex Brainware Consulting & Training GmbH

Kirchplatz 5
D-82049 Pullach

Tel: +49 (89) 744  850 0
Fax: +49 (89) 744  850 11

 <http://www.cortex-brainware.de/> http://www.cortex-brainware.de

E-Mail: hwk at cortex-brainware.de

Handelsregister:
Registergericht: Amtsgericht M?nchen
HRB-Nr. 120614

Vertretungsberechtigte Gesch?ftsf?hrer:
Dipl.-Inform. Dorothea Burger, Dr.-Ing. Hartmut Kocher, Dr.-Ing. Martin
Lang, Dr. rer. nat. Rolf Peter Wehrum 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070301/be15a46a/attachment.html 

From rocket at heddway.com  Wed Feb 28 19:17:15 2007
From: rocket at heddway.com (jason heddings)
Date: Wed, 28 Feb 2007 20:17:15 -0700
Subject: [antlr-interest] ANTLR for Style Check?
Message-ID: <000a01c75bb0$1d1b2b40$6700a8c0@enterprise>

Hello-
 
I'm trying to develop a style-checking application in Java and as I was
searching around, I ran across ANTLR.  Would this be a suitable use of
ANTLR?  I've been reading the website and feel a bit overwhelemed for
getting started...  Can anyone make a recommendation about where to start
developing this type of application?  Would this involve creating grammars
that represent each style preference, or would it simple walk the resulting
parse tree looking for style?
 
Thanks,
--jah
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20070228/078eb088/attachment.html 

