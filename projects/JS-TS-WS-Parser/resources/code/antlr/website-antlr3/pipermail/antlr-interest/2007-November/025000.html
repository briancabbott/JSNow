<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Line/char positions in C runtime
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Line/char%20positions%20in%20C%20runtime&In-Reply-To=%3C474E894F.BB97.0087.0%40quintiq.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024997.html">
   <LINK REL="Next"  HREF="025001.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Line/char positions in C runtime</H1>
    <B>Ramon Verbruggen</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Line/char%20positions%20in%20C%20runtime&In-Reply-To=%3C474E894F.BB97.0087.0%40quintiq.com%3E"
       TITLE="[antlr-interest] Line/char positions in C runtime">Ramon.Verbruggen at quintiq.com
       </A><BR>
    <I>Thu Nov 29 00:41:36 PST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="024997.html">[antlr-interest] Why the generated parser code tolerates	illegal expression?
</A></li>
        <LI>Next message: <A HREF="025001.html">[antlr-interest] Using semantic predicates with antlr 3 and python	runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25000">[ date ]</a>
              <a href="thread.html#25000">[ thread ]</a>
              <a href="subject.html#25000">[ subject ]</a>
              <a href="author.html#25000">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Stuart,

Sorry for the late reply, I hope someone beat me to it :-)

I'm an ANTLR newbie myself, but I also use the C runtime (thanks Jim!)
to generate ASTs.

Maybe I am misinterpreting (no pun intended) your question, but I just
use the line and position information that is already in the AST nodes:

ANTLR3_UINT64 linenr = treenode-&gt;getLine(treenode); //linenr is one
based
ANTLR3_UINT32 column = treenode-&gt;getCharPositionInLine(treenode);
//column is zero based

If you use imaginary tokens for AST construction, these do not have
their locations set automatically, but you can set those from your
grammar, see 'the book', section 7.5, page 188-189, 'Deriving Imaginary
Nodes from Real Tokens'

I did notice however that if linenr = 1 and column &gt; 0 I have to add 1
to the column to get the correct text location (don't ask me why...)

I hope this helps,

Ramon Verbruggen


&gt;<i> Hiya,
</I>&gt;<i> 
</I>&gt;<i> I'm still in my early days of ANTLRing, but I've dug around the
</I>mailing
&gt;<i> lists and can't find much help on this issue; any suggestions or
</I>pointers
&gt;<i> very welcome.
</I>&gt;<i> 
</I>&gt;<i> Basically, I want to get line/character position information into the
</I>AST
&gt;<i> when using the C runtime - and although I've found stuff on doing
</I>this in
&gt;<i> Java, I'm not as clear about how to extend the C runtime
</I>architecture. I'm
&gt;<i> using C so I can integrate the ANTLR parser into a Perl XS module -
</I>all this
&gt;<i> works fine. I'm using gcc on Windows, MinGW and CDT under Eclipse. 
</I>&gt;<i> 
</I>&gt;<i> The good news is that all this works fine and I can get the AST into
</I>Perl
&gt;<i> and process it there with no problems. The bad news is I have no idea
</I>how to
&gt;<i> map the AST positioning back to the original text, which would be a
</I>big step
&gt;<i> forward.
</I>&gt;<i> 
</I>&gt;<i> Any ideas or suggestions gratefully received
</I>&gt;<i> --Stuart
</I>


This message contains information that may be privileged or confidential
and is the property of Quintiq. It is only intended for the person to
whom it is addressed. If you are not the intended recipient, you are not
authorized to read, print, retain, copy, disseminate, distribute or use
this message or any part thereof. If you have received this message in
error, please notify the sender immediately and delete all copies of
this message. Please note that e-mails are susceptible to change,
therefore they are not binding.
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024997.html">[antlr-interest] Why the generated parser code tolerates	illegal expression?
</A></li>
	<LI>Next message: <A HREF="025001.html">[antlr-interest] Using semantic predicates with antlr 3 and python	runtime
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25000">[ date ]</a>
              <a href="thread.html#25000">[ thread ]</a>
              <a href="subject.html#25000">[ subject ]</a>
              <a href="author.html#25000">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
