<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Clarification on Attribute Reference in Actions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Clarification%20on%20Attribute%20Reference%20in%20Actions&In-Reply-To=%3C200707050648.31811.rschulz%40sonic.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022126.html">
   <LINK REL="Next"  HREF="022137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Clarification on Attribute Reference in Actions</H1>
    <B>Randall R Schulz</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Clarification%20on%20Attribute%20Reference%20in%20Actions&In-Reply-To=%3C200707050648.31811.rschulz%40sonic.net%3E"
       TITLE="[antlr-interest] Clarification on Attribute Reference in Actions">rschulz at sonic.net
       </A><BR>
    <I>Thu Jul  5 06:48:31 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="022126.html">[antlr-interest] Clarification on Attribute Reference in Actions
</A></li>
        <LI>Next message: <A HREF="022137.html">[antlr-interest] Clarification on Attribute Reference in Actions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22128">[ date ]</a>
              <a href="thread.html#22128">[ thread ]</a>
              <a href="subject.html#22128">[ subject ]</a>
              <a href="author.html#22128">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thursday 05 July 2007 06:14, Kay Roepke wrote:
&gt;<i> On Jul 5, 2007, at 1:40 PM, Gavin Lambert wrote:
</I>&gt;<i> &gt; At 11:22 5/07/2007, Kay Roepke wrote:
</I>&gt;<i> &gt; &gt;term returns [Term t]
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;	:	^(ComplexTerm term termSequence)
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;	{
</I>&gt;<i> &gt; &gt;		Object o = asObject($term.t);
</I>&gt;<i> &gt; &gt;	}
</I>&gt;<i> &gt; &gt;	;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [...]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt;Notice how it references retval.t in my version. I think
</I>&gt;<i> &gt; &gt;this is a bug in the actionparser code. It should warn
</I>&gt;<i> &gt; &gt;you that $term.t will refer to the rule's return
</I>&gt;<i> &gt; &gt;value and not the subtree reference's retval object.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't know, the current behaviour makes a certain amount of sense
</I>&gt;<i> &gt; to me.  If the action block was inside the parentheses, though, I'd
</I>&gt;<i> &gt; definitely expect it to refer to the recursive term, and not the
</I>&gt;<i> &gt; parent rule.
</I>
I'm not sure I think that parentheses should alter the interpretation of 
any given element or element label reference.


&gt;<i> Definitely. What I was proposing was that it merely warns you of the
</I>&gt;<i> ambiguity, it should still pick the return value. However, if you
</I>&gt;<i> meant the rule reference `term` ANTLR should tell you what to do.
</I>&gt;<i> It was only about the warning, not about changing the behavior.
</I>
There are a few things that come to mind:

1) Bottom line: When an ambiguity like this exists, which will be in 
most any rule that includes itself directly on its right-hand-side or 
that of one of its alternatives, it must be possible to refer to 
either / any of the possible referents. That currently is the case and 
must remain so, one way or another.

2) As it stands, there are two identical ways to refer to the rule's 
return value, in this case $term.t and $t. That doesn't really seem 
right, and it forces one to invent an element label, which seems 
somewhat sub-optimal.

3) Given the inherent confusion possible, a diagnostic might not be a 
bad idea, but as ever, a chatty compiler is not a friendly thing. If 
heuristic warnings are going to be added, there should be some way of 
controlling whether they're emitted or not.


&gt;<i> cheers,
</I>&gt;<i> -k
</I>

Randall Schulz
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022126.html">[antlr-interest] Clarification on Attribute Reference in Actions
</A></li>
	<LI>Next message: <A HREF="022137.html">[antlr-interest] Clarification on Attribute Reference in Actions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22128">[ date ]</a>
              <a href="thread.html#22128">[ thread ]</a>
              <a href="subject.html#22128">[ subject ]</a>
              <a href="author.html#22128">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
