<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Re: ANTLR Java Code Generation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Re%3A%20ANTLR%20Java%20Code%20Generation&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000195.html">
   <LINK REL="Next"  HREF="000202.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Re: ANTLR Java Code Generation</H1>
    <B>Michael Bouschen</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Re%3A%20ANTLR%20Java%20Code%20Generation&In-Reply-To="
       TITLE="[antlr-interest] Re: ANTLR Java Code Generation">mbo.tech at spree.de
       </A><BR>
    <I>Wed Nov 14 03:00:00 PST 2001</I>
    <P><UL>
        <LI>Previous message: <A HREF="000195.html">[antlr-interest] Re: ANTLR Java Code Generation
</A></li>
        <LI>Next message: <A HREF="000202.html">[antlr-interest] ANTLR Java Code Generation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#196">[ date ]</a>
              <a href="thread.html#196">[ thread ]</a>
              <a href="subject.html#196">[ subject ]</a>
              <a href="author.html#196">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I really appreciate the proposal hanging the Java Code Generation such
that the generated byte code becomes much smaller! This would allow my
compiler to be build in an jdk1.3 environment which is currently not
possible. So I'm less worried about a possible performance drawback. 

I use a large charVocabulary, because I need some UNICODE support in my
compiler. The bitsets in the generated lexer become really big. Using
Sun's jdk1.3, the generated byte code is too big to be loaded into the
VM: 
  Exception in thread &quot;main&quot; java.lang.ClassFormatError:
com/sun/jdori/common/query/jdoqlc/JDOQLLexer (Code of a method longer
than 65535 bytes)
The only workaround I know so far is using the jdk1.2 javac. So the
build environment has to ensure that the lexer is never compiled using
the jdk1.3 javac (even not indirectly).

Regards Michael 

&gt;<i> 
</I>&gt;<i> Will there be a performance gain? There will be a bytecode size
</I>&gt;<i> decrease, which will decrease memory usage on platforms like Unix
</I>&gt;<i> which memory-map classes. But won't there be a performance decrease
</I>&gt;<i> because instead of a nice super clean:
</I>&gt;<i> 1. create Array long _tokenSet_0_data_[] with size n
</I>&gt;<i> 2. put -549755813896L at 0
</I>&gt;<i> 3. put -268435457L at 1
</I>&gt;<i> 4. put -1L at 2
</I>&gt;<i> .....
</I>&gt;<i> n. put -1L at n
</I>&gt;<i> with O[n] time you'll have:
</I>&gt;<i> 1. create Array long _tokenSet_0_data_[] with size n
</I>&gt;<i> 2. put -549755813896L at 0
</I>&gt;<i> .
</I>&gt;<i> .
</I>&gt;<i> .
</I>&gt;<i> 6. put -268435457L at 1
</I>&gt;<i> .
</I>&gt;<i> .
</I>&gt;<i> .
</I>&gt;<i> 10. put -1L at 2
</I>&gt;<i> .....
</I>&gt;<i> n*4. put -1L at n
</I>&gt;<i> With all the extra loop overhead. Thus your time is now O[x*n] (where
</I>&gt;<i> x is number of instructions to do for each entry). Is this actually
</I>&gt;<i> going to be a gain? You still have to add the same number of entries.
</I>&gt;<i> Just trades off class size vs. speed doesn't it. And I would have
</I>&gt;<i> thought for many cases speed was more important than class size. You
</I>&gt;<i> only store\load the class once, you have to do the BitSet creation
</I>&gt;<i> every parse (if you did 2 passes with one init, then you'd double the
</I>&gt;<i> amount of computation (and thus overhead) but same memory overhead).
</I>&gt;<i> 
</I>&gt;<i> And surely the JDK's gonna be better at optimizing the initializer
</I>&gt;<i> cause it knows everything that's going on, where as the second one
</I>&gt;<i> must deal with any side effects.
</I>&gt;<i> 
</I>&gt;<i> Still might be worth offering it as an option, but I would have
</I>&gt;<i> thought it would be best to check performance before using only this
</I>&gt;<i> method.
</I>&gt;<i> 
</I>&gt;<i> It doesn't cut down the intialization does it? Still got to
</I>&gt;<i> initialize every value, in fact makes it worse because it's x times
</I>&gt;<i> more ops. Just cuts down class size.
</I>&gt;<i> 
</I>&gt;<i> Tom.
</I>&gt;<i> --- In <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at y...</A>, Christian Ernst &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">christian.ernst at p...</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; Hy !
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Stdiobe wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Seems to me like a good suggestion. Any drawbacks performance-
</I>&gt;<i> wise?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We didn't do any performance measures.
</I>&gt;<i> &gt; But there should be a performance gain.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; For example for the Java Lexer 1.3.
</I>&gt;<i> &gt; It cuts down the needed initializing of 6 Bitsets
</I>&gt;<i> &gt; with about 11.000 Long Values
</I>&gt;<i> &gt; to only about 4.000 Long Values
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; mfg
</I>&gt;<i> &gt; Christian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Your use of Yahoo! Groups is subject to <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A>
</I>
-- 
Michael Bouschen		<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">Tech at Spree</A> Software Technology GmbH
mailto:<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">mbo.tech at spree.de</A>	<A HREF="http://www.tech.spree.de/">http://www.tech.spree.de/</A>
Tel.:++49/30/235 520-33		Buelowstr. 66			
Fax.:++49/30/2175 2012		D-10783 Berlin

 

Your use of Yahoo! Groups is subject to <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A> 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000195.html">[antlr-interest] Re: ANTLR Java Code Generation
</A></li>
	<LI>Next message: <A HREF="000202.html">[antlr-interest] ANTLR Java Code Generation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#196">[ date ]</a>
              <a href="thread.html#196">[ thread ]</a>
              <a href="subject.html#196">[ subject ]</a>
              <a href="author.html#196">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
