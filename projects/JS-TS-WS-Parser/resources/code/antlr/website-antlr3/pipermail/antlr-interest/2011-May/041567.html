<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Memory requirements of C runtime	when	backtracking
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Memory%20requirements%20of%20C%20runtime%0A%09when%09backtracking&In-Reply-To=%3C20110506171000.qspgtgnbwg00044o%40webmail.kamm.cz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="041546.html">
   <LINK REL="Next"  HREF="041570.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Memory requirements of C runtime	when	backtracking</H1>
    <B>Ivan Brezina</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Memory%20requirements%20of%20C%20runtime%0A%09when%09backtracking&In-Reply-To=%3C20110506171000.qspgtgnbwg00044o%40webmail.kamm.cz%3E"
       TITLE="[antlr-interest] Memory requirements of C runtime	when	backtracking">ibre5041 at ibrezina.net
       </A><BR>
    <I>Fri May  6 08:10:00 PDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="041546.html">[antlr-interest] Memory requirements of C runtime when	backtracking
</A></li>
        <LI>Next message: <A HREF="041570.html">[antlr-interest] Memory requirements of C runtime when	backtracking
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41567">[ date ]</a>
              <a href="thread.html#41567">[ thread ]</a>
              <a href="subject.html#41567">[ subject ]</a>
              <a href="author.html#41567">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You're right the grammar has very large DFAs. That was the second  
problem I'm facing. In
general Oracle's SQL distinguishes reserved words and keywords.

In order to satisfy backward compatibility many newly added words(keywords)
have special meaning and but also can be used as identifiers.
for example such a query is legal:
Select * from join JOIN join using(join);

The uppercase JOIN is a keyword while other &quot;join&quot;s are identifiers.
In my grammar the rule identifier is defined as
identifier
   : ID //(lexer rule for an identifier)
   | 'A' //(1st keyword)
   | 'AS' //(2dn keyword)
   ...
   | '' // (200th keyword)
   ;

I'm afraid that this is one the reasons why the tables are so huge.
Are there any ways how to deal with something like that?

The previous version of this grammar used gated semantic predicates like:

k_join : { LA(1).gettext() == &quot;JOIN&quot; }? =&gt; ID

is that the right way to reduce the size of DFA?

Ivan

Quoting Jim Idle &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">jimi at temporal-wave.com</A>&gt;:

&gt;<i> You should not be using backtrack=true if you are short on memory, but
</I>&gt;<i> without seeing your grammar I cannot comment on the ram usage. It might be
</I>&gt;<i> that your grammar causes the generation of huge DFA tables. Backtracking
</I>&gt;<i> itself does not cost lots of memory though.
</I>&gt;<i>
</I>&gt;<i> jim
</I>&gt;<i>
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A> [mailto:antlr-interest-
</I>&gt;&gt;<i> <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bounces at antlr.org</A>] On Behalf Of Ivan Brezina
</I>&gt;&gt;<i> Sent: Wednesday, May 04, 2011 5:20 AM
</I>&gt;&gt;<i> To: antlr-interest Interest
</I>&gt;&gt;<i> Subject: [antlr-interest] Memory requirements of C runtime when
</I>&gt;&gt;<i> backtracking
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi all
</I>&gt;&gt;<i> doing some unit test of Oracle SQL grammar I'm facing problems with
</I>&gt;&gt;<i> memory requirements when parsing input having many parenthesis.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In general the grammar can have three types of statements which can be
</I>&gt;&gt;<i> enclosed in parens.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. value expression like (A),(1+2).
</I>&gt;&gt;<i> For an sql_expression there is set of rules using numerical operator
</I>&gt;&gt;<i> sql_expression -&gt; expr_add -&gt; expr_mul -&gt; expr_sign -&gt; expr_pow -&gt;
</I>&gt;&gt;<i> expr_paren
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2. logical expression like (A &gt; 2) or (A is null) For an condition
</I>&gt;&gt;<i> expression there is a set of rules using locical operator sql_condition
</I>&gt;&gt;<i> -&gt; condition_or -&gt; condition_and -&gt; condition_not -&gt; condition_paren
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 3. a subquery. It is an sql statement enclosed in parenthesis like
</I>&gt;&gt;<i> (SELECT * FROM dual).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> These 3 types can by combined in many ways.
</I>&gt;&gt;<i> For example ((SELECT count(1) from dual) &gt; 1)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> While testing if found queries - probably generated by some evil sick
</I>&gt;&gt;<i> robot - whose require more than 8B of RAM to parse even they are quite
</I>&gt;&gt;<i> short
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For example:
</I>&gt;&gt;<i> SELECT *
</I>&gt;&gt;<i> FROM TABLE1, TABLE2
</I>&gt;&gt;<i> WHERE
</I>&gt;&gt;<i> (
</I>&gt;&gt;<i>   (
</I>&gt;&gt;<i>    (
</I>&gt;&gt;<i>     (
</I>&gt;&gt;<i>      (
</I>&gt;&gt;<i>       (
</I>&gt;&gt;<i>        (
</I>&gt;&gt;<i>         (
</I>&gt;&gt;<i>          (
</I>&gt;&gt;<i>   	 (
</I>&gt;&gt;<i>   	  (
</I>&gt;&gt;<i>   	   (
</I>&gt;&gt;<i>   	    (
</I>&gt;&gt;<i>   	     (
</I>&gt;&gt;<i>   	      (
</I>&gt;&gt;<i> 	       ( TABLE2.DT = '2' ) OR ( TABLE2.DT = '3' )
</I>&gt;&gt;<i>    	      ) AND ( TABLE2.CODE &lt; 9 )
</I>&gt;&gt;<i>    	     ) AND ( TABLE2.WH = 'XXX' )
</I>&gt;&gt;<i>    	    ) AND ( TABLE1.ID = '0000001' )
</I>&gt;&gt;<i>    	   ) AND ( ( TABLE1.ATTR_1 IS NULL ) OR ( TABLE1._ATTR1 = '*' ) )
</I>&gt;&gt;<i>    	  ) AND ( ( TABLE1.ATTR_2 IS NULL ) OR ( TABLE1._ATTR2 = '*' ) )
</I>&gt;&gt;<i>    	 ) AND ( ( TABLE1.ATTR_3 IS NULL ) OR ( TABLE1._ATTR3 = '*' ) )
</I>&gt;&gt;<i>       	) AND ( ( TABLE1.ATTR_4 IS NULL ) OR ( TABLE1._ATTR4 = '*'
</I>&gt;<i> )
</I>&gt;&gt;<i> )
</I>&gt;&gt;<i>         ) AND ( ( TABLE1.ATTR_5 IS NULL ) OR ( TABLE1._ATTR5 = '*' ) )
</I>&gt;&gt;<i>        ) AND ( ( TABLE2.TYPE IS NULL ) OR ( TABLE2.TYPE = '*' ) )
</I>&gt;&gt;<i>       ) AND ( ( TABLE2.NBR IS NULL ) OR ( TABLE2.NBR = '*' ) )
</I>&gt;&gt;<i>      ) AND ( ( TABLE2.STAT = '01' ) OR ( TABLE2.STAT = '*' ) )
</I>&gt;&gt;<i>     ) AND ( ( TABLE2.ORGN IS NULL ) OR ( TABLE2.ORGN = '*' ) )
</I>&gt;&gt;<i>    ) AND ( TABLE2.NBR = '00000000' )
</I>&gt;&gt;<i>   ) AND ( TABLE2.PO IS NULL )
</I>&gt;&gt;<i> )
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Both value expression and condition expression rules do backtracking.
</I>&gt;&gt;<i> In the example above every parenthesis nesting doubles memory
</I>&gt;&gt;<i> requirements.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Are there any ways how to reduce/monitor memory requirements?
</I>&gt;&gt;<i> What exactly is remembered when backtracking?
</I>&gt;&gt;<i> I tried to add some syntactic predicates into value/conditional
</I>&gt;&gt;<i> expression but it usually led to failure of other tests.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> thx Ivan
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----------------------------------------------------------------
</I>&gt;&gt;<i> This message was sent using IMP, the Internet Messaging Program.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;&gt;<i> Unsubscribe: <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-">http://www.antlr.org/mailman/options/antlr-interest/your-</A>
</I>&gt;&gt;<i> email-address
</I>&gt;<i>
</I>&gt;<i> List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;<i> Unsubscribe:   
</I>&gt;<i> <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-email-address">http://www.antlr.org/mailman/options/antlr-interest/your-email-address</A>
</I>&gt;<i>
</I>


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: OracleSQL.zip
Type: application/zip
Size: 35052 bytes
Desc: not available
Url : <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20110506/af4ae21e/attachment.zip">http://www.antlr.org/pipermail/antlr-interest/attachments/20110506/af4ae21e/attachment.zip</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="041546.html">[antlr-interest] Memory requirements of C runtime when	backtracking
</A></li>
	<LI>Next message: <A HREF="041570.html">[antlr-interest] Memory requirements of C runtime when	backtracking
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41567">[ date ]</a>
              <a href="thread.html#41567">[ thread ]</a>
              <a href="subject.html#41567">[ subject ]</a>
              <a href="author.html#41567">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
