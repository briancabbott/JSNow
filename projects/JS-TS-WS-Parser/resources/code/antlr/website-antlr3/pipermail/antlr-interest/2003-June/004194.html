<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] manual AST construction: what am I doing wrong?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20manual%20AST%20construction%3A%20what%20am%20I%20doing%20wrong%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004193.html">
   <LINK REL="Next"  HREF="004197.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] manual AST construction: what am I doing wrong?</H1>
    <B>Jorge Scandaliaris</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20manual%20AST%20construction%3A%20what%20am%20I%20doing%20wrong%3F&In-Reply-To="
       TITLE="[antlr-interest] manual AST construction: what am I doing wrong?">j_scandaliaris at yahoo.es
       </A><BR>
    <I>Sun Jun 15 04:26:35 PDT 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="004193.html">[antlr-interest] _MSC_VER ATTN Ric Klaren
</A></li>
        <LI>Next message: <A HREF="004197.html">[antlr-interest] manual AST construction: what am I doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4194">[ date ]</a>
              <a href="thread.html#4194">[ thread ]</a>
              <a href="subject.html#4194">[ subject ]</a>
              <a href="author.html#4194">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
	How can I generate for a rule a single AST node, using manual
tree construction? 
	I have created created a custom AST class. I have defined the
option ASTLabelType = &quot;RefMyAST&quot;;	It is sort of working. I say
this 'cause I came over some issues and I am not sure if it is ANTLR'
expected behaviour or I did something wrong.
	I am doing a special use of AST, basically I am not going to
walk my tree, I just use the nodes as &quot;supertokens&quot; that can hold the
information I collect while parsing. 
	In view of this I decided that I don't need to generate all the
nodes corresponding to all sub rules, but that I only need the node
corresponding to the rule.
	I tried using ! at the rule and sub rules levels, but here is
where problems appear. If I use say:
rule!
:<i> .....
</I>{ ## = #[##];
  #-&gt;addSrc(...); // addSrc() is defined for MyAST
}
I have a run-time error in addSrc(). I think this is due to a missing
astFactory-&gt;addChild(...)in the generated code compared to when
automatic AST building is done (what is the purpose of this anyway? And
why it is only there for automatic tree building?). 
I tried also to suffix all sub rules but one, leaving automatic tree
construction on. This works, but it has two bad points: 
1. The node for the rule is created from the sub rule I didn't suffix,
including the information it carries (which I might not want). That
forces me to &quot;reset&quot; the node before putting in it the info I want.
2. In some rules say 
	rule: (sub_rule)* 
or
	rule: (sub_rule)+
I am forced to change the grammar so as to create only one AST node,
adding complexity and loosing the readability that characterizes antlr
grammars.

Please, if someone can enlighten me on this, or point me to some
resources (I didn't find a lot). Maybe I got the semantics of AST
completely wrong?

Thanks,

Jorge




 

Your use of Yahoo! Groups is subject to <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A> 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004193.html">[antlr-interest] _MSC_VER ATTN Ric Klaren
</A></li>
	<LI>Next message: <A HREF="004197.html">[antlr-interest] manual AST construction: what am I doing wrong?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4194">[ date ]</a>
              <a href="thread.html#4194">[ thread ]</a>
              <a href="subject.html#4194">[ subject ]</a>
              <a href="author.html#4194">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
