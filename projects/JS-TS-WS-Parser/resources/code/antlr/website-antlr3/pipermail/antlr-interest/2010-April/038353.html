<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] greedy vs nongreedy lexer rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20greedy%20vs%20nongreedy%20lexer%20rules&In-Reply-To=%3Cx2x1c0448551004181709z9332d773gb253c97087ab46f2%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038352.html">
   <LINK REL="Next"  HREF="038354.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] greedy vs nongreedy lexer rules</H1>
    <B>Cliff Hudson</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20greedy%20vs%20nongreedy%20lexer%20rules&In-Reply-To=%3Cx2x1c0448551004181709z9332d773gb253c97087ab46f2%40mail.gmail.com%3E"
       TITLE="[antlr-interest] greedy vs nongreedy lexer rules">cliff.s.hudson at gmail.com
       </A><BR>
    <I>Sun Apr 18 17:09:45 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="038352.html">[antlr-interest] greedy vs nongreedy lexer rules
</A></li>
        <LI>Next message: <A HREF="038354.html">[antlr-interest] greedy vs nongreedy lexer rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38353">[ date ]</a>
              <a href="thread.html#38353">[ thread ]</a>
              <a href="subject.html#38353">[ subject ]</a>
              <a href="author.html#38353">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sorry, accidentally sent a partial message.  See below for the complete
message.

Ahh, that's what I was getting at.  In my system, the actions would not be
&gt;<i> embedded directly in the matching code as they are now.  Instead, all of the
</I>&gt;<i> actions which were part of an alternative would be executed together against
</I>&gt;<i> the global state.  Consider the following (assuming the C# language target)
</I>&gt;<i> based on the example you gave above.  The implementation of the Lexer
</I>&gt;<i> subclass would look as follows:
</I>&gt;<i>
</I>&gt;<i> public class MyLexer : Lexer
</I>&gt;<i> {
</I>&gt;<i>   int i = 0; // from @members
</I>&gt;<i>
</I>&gt;<i>   ... DFA stuff, token decls, etc...
</I>&gt;<i>   public void ID()
</I>&gt;<i>   {
</I>&gt;<i>      // Implemented as normal, except that where {i++} would be, there
</I>&gt;<i> would be
</I>&gt;<i>      // code which instead saves the action-visible state of the parser
</I>&gt;<i> into a State block.
</I>&gt;<i>      // This visible state means only the values of those variables which
</I>&gt;<i> are generated by the
</I>&gt;<i>      // running the the DFA, not those which might be updated by the
</I>&gt;<i> actions.  This
</I>&gt;<i>      // snapshot is then enqueued.
</I>&gt;<i>
</I>&gt;<i>         // Once ID is definitely matched, ID_alt1 itself is enqueued along
</I>with a the queued states.

&gt;<i>   }
</I>&gt;<i>
</I>&gt;<i> public void ID_alt1(Queue&lt;State&gt; states)
</I>&gt;<i> {
</I>&gt;<i>     State currentState = states.Dequeue();
</I>&gt;<i>     i++; // While state information was enqueued, it turns out we didn't
</I>&gt;<i> use it here.
</I>&gt;<i>            // A language target would have translated any references to
</I>&gt;<i> action-visible
</I>&gt;<i>            // token information such as $text into references into
</I>&gt;<i> currentState.
</I>&gt;<i>
</I>       currentState = states.Dequeue();

&gt;<i>     System.Console.WriteLine(&quot;{0}&quot;, i); // Again, no information is used,
</I>&gt;<i> but if it were, it would be
</I>&gt;<i>
</I>                                                           // from a
reference into currentState.

&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> Once a particular alternative is selected, the action function would be
</I>executed with the enqueued states.
No alternative could be executed if it was below any incomplete alternative
(in otherwords, fragments would
not execute until the alternative referencing them itself was definitively
selected.)

Does that make more sense?

&gt;<i>
</I>&gt;<i> On Sun, Apr 18, 2010 at 4:53 PM, Terence Parr &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">parrt at cs.usfca.edu</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Apr 18, 2010, at 4:50 PM, Cliff Hudson wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; You wrote:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Well, imagine that you are modifying &quot;global&quot; state as you match
</I>&gt;&gt;<i> characters in identifier; this is something done in actions that ANTLR can
</I>&gt;&gt;<i> analyze. There is no way to &quot;roll this back&quot;.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; The 'global' state you are talking about is state the DFA is modifying
</I>&gt;&gt;<i> but which an action in a rule could examine?  Is the amount of state visible
</I>&gt;&gt;<i> to actions too much to store while alternatives are being evaulated?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It's state you set up and modify then ref:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> @members {
</I>&gt;&gt;<i> int i = 0;
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ID : ('a'..'z' {i++;})+ {System.out.println(i);} ;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ANTLR can't save i for you each char iteration.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ter
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;&gt;<i> Unsubscribe:
</I>&gt;&gt;<i> <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-email-address">http://www.antlr.org/mailman/options/antlr-interest/your-email-address</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038352.html">[antlr-interest] greedy vs nongreedy lexer rules
</A></li>
	<LI>Next message: <A HREF="038354.html">[antlr-interest] greedy vs nongreedy lexer rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38353">[ date ]</a>
              <a href="thread.html#38353">[ thread ]</a>
              <a href="subject.html#38353">[ subject ]</a>
              <a href="author.html#38353">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
