<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] C Runtime Multiple Serial Tree Walkers - What can	be freed when?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20C%20Runtime%20Multiple%20Serial%20Tree%20Walkers%20-%20What%20can%0A%09be%20freed%20when%3F&In-Reply-To=%3CAANLkTinx9b4NkqndB6pQReOXfLMk67fh-u_f45EG_HC-%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="040563.html">
   <LINK REL="Next"  HREF="040565.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can	be freed when?</H1>
    <B>Karim Chichakly</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20C%20Runtime%20Multiple%20Serial%20Tree%20Walkers%20-%20What%20can%0A%09be%20freed%20when%3F&In-Reply-To=%3CAANLkTinx9b4NkqndB6pQReOXfLMk67fh-u_f45EG_HC-%40mail.gmail.com%3E"
       TITLE="[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can	be freed when?">kchichakly at iseesystems.com
       </A><BR>
    <I>Tue Jan 18 15:07:28 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="040563.html">[antlr-interest] ANTLR3C Single token stream with sequential parsers
</A></li>
        <LI>Next message: <A HREF="040565.html">[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can be freed when?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40564">[ date ]</a>
              <a href="thread.html#40564">[ thread ]</a>
              <a href="subject.html#40564">[ subject ]</a>
              <a href="author.html#40564">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am using the C runtime.  I have a lexer and a parser.  Then I run a
constant expression reduction tree walker, which rewrites some nodes
(rewrite = false).  Then I run a semantic analysis tree walker, which also
rewrites some nodes (rewrite = false).  Then, at a much later time
determined by the user, I run a code generation tree walker.  I have to keep
the final tree (from the semantic analyzer) around as long as the program is
running, which could be hours.

The C runtime example that does something similar, polydiff, keeps all of
the separate node streams and all of the intermediate trees around until it
no longer needs the final tree.  The Java version keeps overwriting the
nodes variable (which holds the node stream), so presumably that is getting
freed before the start of each tree walker pass.  But also it keeps all the
intermediate trees.

If I try to free the first tree generated by the parser after running the
first tree walker (which gives me a different tree), the program crashes on
the free.  If I try to free the node stream, the tree becomes invalid and I
crash the next time I try to access it.

I don't honestly have to keep all intermediate tree results and node streams
around forever, do I?  What can I safely get rid of and when?

Thanks,

Karim
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="040563.html">[antlr-interest] ANTLR3C Single token stream with sequential parsers
</A></li>
	<LI>Next message: <A HREF="040565.html">[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can be freed when?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40564">[ date ]</a>
              <a href="thread.html#40564">[ thread ]</a>
              <a href="subject.html#40564">[ subject ]</a>
              <a href="author.html#40564">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
