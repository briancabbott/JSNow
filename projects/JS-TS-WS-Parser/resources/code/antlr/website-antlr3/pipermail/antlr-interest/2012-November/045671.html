<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] TestRig: use with package-ized lexer/parser?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20TestRig%3A%20use%20with%20package-ized%20lexer/parser%3F&In-Reply-To=%3C20121112050402.VKTG7477.fed1rmfepo202.cox.net%40fed1rmimpo209%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="045670.html">
   <LINK REL="Next"  HREF="045675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] TestRig: use with package-ized lexer/parser?</H1>
    <B>Graham Wideman</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20TestRig%3A%20use%20with%20package-ized%20lexer/parser%3F&In-Reply-To=%3C20121112050402.VKTG7477.fed1rmfepo202.cox.net%40fed1rmimpo209%3E"
       TITLE="[antlr-interest] TestRig: use with package-ized lexer/parser?">gwlist at grahamwideman.com
       </A><BR>
    <I>Sun Nov 11 21:03:39 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="045670.html">[antlr-interest] Pushdown lexer
</A></li>
        <LI>Next message: <A HREF="045675.html">[antlr-interest] TestRig: use with package-ized lexer/parser?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45671">[ date ]</a>
              <a href="thread.html#45671">[ thread ]</a>
              <a href="subject.html#45671">[ subject ]</a>
              <a href="author.html#45671">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Terr and all,

I've been attempting to use the TestRig (part of the ANTLR 4 tools), and have fallen down a hole that I'm hoping someone just knows the answer to.

The short version is this:

How does one use TestRig with a grammar that specifies a package for the lexer/parser?

Longer version:

In the command line for TestRig we supply the name of the grammar, from which the TestRig class figures out the name of lexer and parser classes to dynamically load (using a ClassLoader).  But TestRig fails to find the lexer/grammar classes if the grammar specifies a package.

Issue 1: How to load package-ized lexer?
-----------------------------------------
TestRig fails if the grammar specifies a package name. Or at least, I've not figured out how to get TestRig to find the lexer and parser classes when a package is specified. Any clues?

Issue 2: Why does TestRig find lexer class in current dir?
-----------------------------------------------------------
I attempted to create my own version of TestRig (with new name TestRig2, and using different package from the original) and though I can get it to compile and run, I can't get it to load even a non-packaged lexer... that is I can't even get my seemingly minimally modified TestRig2 to load a lexer class that the original TestRig is fine with.

Now it seems that in the original TestRig, the ClassLoader (from Thread.currentThread)getContextClassLoader) is able to find the (unpackaged) lexer class in the &quot;current directory&quot;... but I don't understand why it can do this -- how is it that it treats current dir as on the classpath?

Any clues on this?

Issue 3: TestRig exception improvement suggestion
--------------------------------------------------
A note for Terr: The exception handling around the class loading is a bit hosed up -- the second attempt at loading (without Lexer suffix) is in the catch block, but this may fail, in which case execution bails with an unhandled exception, instead of proceeding with lexerClass == null to the intended &quot;Can't handle&quot; message.

Thanks!

-- Graham 

</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="045670.html">[antlr-interest] Pushdown lexer
</A></li>
	<LI>Next message: <A HREF="045675.html">[antlr-interest] TestRig: use with package-ized lexer/parser?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#45671">[ date ]</a>
              <a href="thread.html#45671">[ thread ]</a>
              <a href="subject.html#45671">[ subject ]</a>
              <a href="author.html#45671">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
