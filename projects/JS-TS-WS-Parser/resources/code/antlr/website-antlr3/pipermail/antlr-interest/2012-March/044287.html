<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Extract C Function Definitions Using Parser
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Extract%20C%20Function%20Definitions%20Using%20Parser&In-Reply-To=%3CCAN45N11X3_XKRnpq6nmweP-4%2B3LV5AwAYjYZvtYtHRqPFKYFXg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="044286.html">
   <LINK REL="Next"  HREF="044277.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Extract C Function Definitions Using Parser</H1>
    <B>Eric</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Extract%20C%20Function%20Definitions%20Using%20Parser&In-Reply-To=%3CCAN45N11X3_XKRnpq6nmweP-4%2B3LV5AwAYjYZvtYtHRqPFKYFXg%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Extract C Function Definitions Using Parser">researcher0x00 at gmail.com
       </A><BR>
    <I>Mon Mar 19 17:34:41 PDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="044286.html">[antlr-interest] Extract C Function Definitions Using Parser
</A></li>
        <LI>Next message: <A HREF="044277.html">[antlr-interest] [newbie] AST Rewriting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44287">[ date ]</a>
              <a href="thread.html#44287">[ thread ]</a>
              <a href="subject.html#44287">[ subject ]</a>
              <a href="author.html#44287">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Mar 19, 2012 at 7:10 PM, Joshua Garcia &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">joshuaga at usc.edu</A>&gt; wrote:

&gt;<i> Thanks for the suggestion, Eric!
</I>&gt;<i>
</I>&gt;<i> I've actually been using the text attribute of the function_definition
</I>&gt;<i> rule in order to get the text I need.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>Great, you started in the right direction.


&gt;<i> However, the grammar does not seem to be complete enough. That is why I
</I>&gt;<i> have been expanding it a bit.
</I>

That's how I would do it. Keep breaking down certain grammar rules into
smaller rules until you get the detail you need in the AST.


&gt;<i> Will creating an AST be better than this?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>No, I wouldn't use the AST to break down text into new tree nodes.


&gt;<i> If so, I'm not sure why that is, can you explain?
</I>&gt;<i>
</I>If I can get the grammar to break apart or combine terms (strings and
characters) in preparation for the AST then I do it by modifying the
grammar. I never try to do manipulation of the text in the tokens once they
hit the AST. I then use the AST transformations to rearrange, prune, or
insert imaginary nodes into the tree.

&gt;<i>
</I>&gt;<i> Also, do you or anyone else have any suggestions about dealing with the
</I>&gt;<i> issue I'm experiencing due to pre-processed functions being turned into
</I>&gt;<i> extern declarations? I need to pre-process the code from a version of bash
</I>&gt;<i> in order for the C grammar to process it. However, the pre-processor
</I>&gt;<i> transforms certain functions into extern declarations, which removes the
</I>&gt;<i> text I need.
</I>&gt;<i>
</I> I haven't done C in ages so what you say sounds right, the pieces just
aren't falling into place for me. The only thought I have is to process
both the pre-processed file and the post-processed file and then merge the
results.


&gt;<i>
</I>&gt;<i> I'm thinking I'll have to use a C pre-processor grammar. I've tried this
</I>&gt;<i> one by Youngki KU, which is listed in the grammar list on the ANTLR site:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.antlr.org/grammar/1166665121622/Cpp.tar">http://www.antlr.org/grammar/1166665121622/Cpp.tar</A>
</I>&gt;<i>
</I>&gt;<i> Unfortunately, I've made it as far as having to rename CppTreeTreeParser
</I>&gt;<i> identifiers in the generated code to CppTree. However, at that point,
</I>&gt;<i> certain objects like Token, RuleReturnScope, arg, etc. that are
</I>&gt;<i> instantiated in certain functions of CppParser.java are creating errors
</I>&gt;<i> using ANTLR 3.4. It's even worse than that when I try ANTLR 2.7.7. I tried
</I>&gt;<i> using 2.7.7 because the pre-processor grammar is from 2006. Also, if it
</I>&gt;<i> helps, I'm using Oracle's java version 1.6.0_26 on Ubuntu 11.10.
</I>&gt;<i>
</I>The only thing I can say about that is that I would avoid ANTLR 2.x as I
don't think anybody answers questions on it here anymore. Quite a few of
the advanced people are moving onto ANTLR 4.x with 3.x becoming a memory
and 2.x as a distant memory. I won't even look at anything 2.x so that it
doesn't mess with my brain.

If this is a funded project, you can always get paid support:
<A HREF="http://www.antlr.org/support.html">http://www.antlr.org/support.html</A>


&gt;<i>
</I>&gt;<i> Does anyone know what I have to do to get this old grammar to work, if
</I>&gt;<i> there's no better way to do what I'm trying to do?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Josh
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, Mar 19, 2012 at 5:02 AM, Eric &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">researcher0x00 at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Josh,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Here is what I would try.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The grammar should be creating an AST and the grammar has a
</I>&gt;&gt;<i> function_definition rule. I would use the function_definition rule to find
</I>&gt;&gt;<i> the start and end tokens making up the function and then if the tokens have
</I>&gt;&gt;<i> the start and end line and positions set, I would use those as a quick test
</I>&gt;&gt;<i> to see if I am correctly getting the functions as needed. If so, then do a
</I>&gt;&gt;<i> more advanced version pruning out the parts of the AST that aren't needed
</I>&gt;&gt;<i> in functions and reconstruct the functions from the tokens in the AST.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Some good general advice is:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;A common problem with novices attempting to implement language analysis
</I>&gt;&gt;<i> is to believe that their task is simplified by moving sophisticated tasks
</I>&gt;&gt;<i> to conceptually simple tasks. They will try to simplify semantic analysis
</I>&gt;&gt;<i> by creating a more detailed syntactic analysis and syntactic analysis by
</I>&gt;&gt;<i> creating a more detailed lexical analysis. Almost invariably they discover
</I>&gt;&gt;<i> that this attempt is fruitless and has to be undone, because it results in
</I>&gt;&gt;<i> poor error reporting, runs into conflicts as the implementation becomes
</I>&gt;&gt;<i> more complete, duplicates functionality in the later portions of the
</I>&gt;&gt;<i> analysis, and is hard to maintain.&quot; By William Clodius
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In this case, let the parser do what it is best at, making sure the input
</I>&gt;&gt;<i> is valid and creating an AST. Don't create a pruned AST with the parser,
</I>&gt;&gt;<i> let the full AST pass onto another phase for AST analysis and
</I>&gt;&gt;<i> transformations. Let the AST transformations do the work, don't put an
</I>&gt;&gt;<i> additional burden on the parser of filtering out the functions.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hope that helps, Eric
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Sun, Mar 18, 2012 at 11:55 PM, Joshua Garcia &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">joshuaga at usc.edu</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hi Everyone,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I've been working on modifying an ANTLR C grammar so that it produces a
</I>&gt;&gt;&gt;<i> parser that simply outputs function definitions it recognizes to
</I>&gt;&gt;&gt;<i> different
</I>&gt;&gt;&gt;<i> files. I need to do this in order to apply some information retrieval
</I>&gt;&gt;&gt;<i> techniques to C source code.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Is there a way to get the generated parser to recognize only the function
</I>&gt;&gt;&gt;<i> definitions (including the function body) and comments while ignoring
</I>&gt;&gt;&gt;<i> everything else? I've found it too troublesome to deal with comments so
</I>&gt;&gt;&gt;<i> I've been ignoring them for now.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If not, is there a way to get the generated parser to recognize only the
</I>&gt;&gt;&gt;<i> function definitions (including the function body) and ignore everything
</I>&gt;&gt;&gt;<i> else? I've been able to modify the grammar so that it can recognize a
</I>&gt;&gt;&gt;<i> large
</I>&gt;&gt;&gt;<i> majority of the functions in pre-processed files of a version of bash.
</I>&gt;&gt;&gt;<i> However, the pre-processed files tend to transform some function
</I>&gt;&gt;&gt;<i> definition
</I>&gt;&gt;&gt;<i> text to extern declarations. Therefore, I lose function definition text
</I>&gt;&gt;&gt;<i> that I need. Furthermore, the parser does not ignore everything else
</I>&gt;&gt;&gt;<i> that's
</I>&gt;&gt;&gt;<i> not part of a function definition, but instead, I've added rules to the
</I>&gt;&gt;&gt;<i> grammar in order to recognize as much of the bash version I'm parsing as
</I>&gt;&gt;&gt;<i> possible.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> In particular, I've been trying to use this grammar:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="http://www.antlr.org/grammar/1153358328744/C.g">http://www.antlr.org/grammar/1153358328744/C.g</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks,
</I>&gt;&gt;&gt;<i> Josh
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;&gt;&gt;<i> Unsubscribe:
</I>&gt;&gt;&gt;<i> <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-email-address">http://www.antlr.org/mailman/options/antlr-interest/your-email-address</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I></PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="044286.html">[antlr-interest] Extract C Function Definitions Using Parser
</A></li>
	<LI>Next message: <A HREF="044277.html">[antlr-interest] [newbie] AST Rewriting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44287">[ date ]</a>
              <a href="thread.html#44287">[ thread ]</a>
              <a href="subject.html#44287">[ subject ]</a>
              <a href="author.html#44287">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
