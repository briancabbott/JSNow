From Gordon.Tyler at quest.com  Tue Sep  1 06:20:12 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Tue, 1 Sep 2009 06:20:12 -0700
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <83A722C9-866C-4EA8-A1AE-1A741F15F506@cs.usfca.edu>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
	<95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
	<804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>
	<83A722C9-866C-4EA8-A1AE-1A741F15F506@cs.usfca.edu>
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01BEFEA160@alvxmbw04.prod.quest.corp>

You can use -target 1.4 and -source 1.4 with the JDK 1.5 compiler to make it produce 1.4 compatible class files. The remaining problem is that you're still compiling against the JDK 1.5 runtime library and you have to be careful not to use 1.5-specific APIs.

-----Original Message-----
From: Terence Parr [mailto:parrt at cs.usfca.edu] 
Sent: August 31, 2009 8:48 PM
To: Jim Idle
Cc: antlr-interest at antlr.org; Gordon Tyler
Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4

cool. see you at the conference. I'm pretty sure I used to run -target  
jsr14 on the releases I made earlier. Neil Gafter, the javac guy, told  
me it works

Ter

On Aug 31, 2009, at 5:34 PM, Jim Idle wrote:

> Pretty sure we can't even though genetics are eluded at the byte code
> level. I will look at this definitively next week and we can decide
> what to do at the JVM language conference.
>
> Jim
>
> On Aug 31, 2009, at 7:14 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>
>> Hi. can we do 1.5 javac with -target jsr14?
>> Ter
>> On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:
>>
>>> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have
>>> to stick to Antlr v2 until my project drops the JDK 1.4 requirement.
>>> Messing around with retro-weaver sounds dubious and I need to
>>> restrict my third-party dependencies.
>>>
>>> -----Original Message-----
>>> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On Behalf Of
>>> Steve Ebersole
>>> Sent: August 31, 2009 6:26 PM
>>> To: Gordon Tyler
>>> Cc: antlr-interest at antlr.org
>>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>>
>>> I ran into the same issue when first looking at Antlr3.  I was told
>>> the
>>> intention was to not have the Antlr runtime rely on JDK 1.5; but
>>> unfortunately some JDK 1.5 features ended up getting exposed.
>>>
>>> The outcome of my queries, iirc, was that it would just remain JDK
>>> 1.5
>>> compatible.  You could probably use a retro-weaver though to make it
>>> 1.4
>>> compatible.  Did not try...
>>>
>>>
>>> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>>>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I'm get
>>>> ting
>>>> this error when compiling generated parser code using JDK 1.4,  
>>>> which
>>>> indicates that the runtime is compiled with JDK 1.5:
>>>>
>>>>
>>>>
>>>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>>>
>>>> bad class file: lib
>>>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>>>
>>>> class file has wrong version 49.0, should be 48.0
>>>>
>>>>
>>>>
>>>> Is it just a matter of a recompile of the runtime or does the
>>>> runtime
>>>> use Java 5 features?
>>>>
>>>>
>>>>
>>>> Thanks,
>>>>
>>>> Gordon
>>>>
>>>>
>>>>
>>>> ---
>>>>
>>>> Gordon Tyler (Software Developer)
>>>>
>>>> Quest Software <http://www.quest.com/>
>>>>
>>>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>>>
>>>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>>>
>>>>
>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>> -- 
>>> Steve Ebersole <steve at hibernate.org>
>>> Hibernate.org
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From martijn.reuvers at gmail.com  Tue Sep  1 06:26:25 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Tue, 1 Sep 2009 15:26:25 +0200
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <1FE9A296676737419A8912A6FD22AE1D01BEFEA160@alvxmbw04.prod.quest.corp>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
	<95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
	<804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>
	<83A722C9-866C-4EA8-A1AE-1A741F15F506@cs.usfca.edu>
	<1FE9A296676737419A8912A6FD22AE1D01BEFEA160@alvxmbw04.prod.quest.corp>
Message-ID: <c376e6ec0909010626w64a79902v16168751475e62d9@mail.gmail.com>

I have a project at work which must compile against 1.4 too, but the
IDE runs with 1.5. To prevent using the 1.5 API's I usually change the
JAVA_HOME and PATH before release and set both to use a jdk 1.4
specific one (ant is used for that project). In maven just change the
version of the compiler to 1.4. In either case it is really compiled
against 1.4 and usage of 1.5 specifics is then easily pointed out.


On Tue, Sep 1, 2009 at 3:20 PM, Gordon Tyler<Gordon.Tyler at quest.com> wrote:
> You can use -target 1.4 and -source 1.4 with the JDK 1.5 compiler to make it produce 1.4 compatible class files. The remaining problem is that you're still compiling against the JDK 1.5 runtime library and you have to be careful not to use 1.5-specific APIs.
>
> -----Original Message-----
> From: Terence Parr [mailto:parrt at cs.usfca.edu]
> Sent: August 31, 2009 8:48 PM
> To: Jim Idle
> Cc: antlr-interest at antlr.org; Gordon Tyler
> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>
> cool. see you at the conference. I'm pretty sure I used to run -target
> jsr14 on the releases I made earlier. Neil Gafter, the javac guy, told
> me it works
>
> Ter
>
> On Aug 31, 2009, at 5:34 PM, Jim Idle wrote:
>
>> Pretty sure we can't even though genetics are eluded at the byte code
>> level. I will look at this definitively next week and we can decide
>> what to do at the JVM language conference.
>>
>> Jim
>>
>> On Aug 31, 2009, at 7:14 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>>
>>> Hi. can we do 1.5 javac with -target jsr14?
>>> Ter
>>> On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:
>>>
>>>> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have
>>>> to stick to Antlr v2 until my project drops the JDK 1.4 requirement.
>>>> Messing around with retro-weaver sounds dubious and I need to
>>>> restrict my third-party dependencies.
>>>>
>>>> -----Original Message-----
>>>> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On Behalf Of
>>>> Steve Ebersole
>>>> Sent: August 31, 2009 6:26 PM
>>>> To: Gordon Tyler
>>>> Cc: antlr-interest at antlr.org
>>>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>>>
>>>> I ran into the same issue when first looking at Antlr3. ?I was told
>>>> the
>>>> intention was to not have the Antlr runtime rely on JDK 1.5; but
>>>> unfortunately some JDK 1.5 features ended up getting exposed.
>>>>
>>>> The outcome of my queries, iirc, was that it would just remain JDK
>>>> 1.5
>>>> compatible. ?You could probably use a retro-weaver though to make it
>>>> 1.4
>>>> compatible. ?Did not try...
>>>>
>>>>
>>>> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>>>>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I'm get
>>>>> ting
>>>>> this error when compiling generated parser code using JDK 1.4,
>>>>> which
>>>>> indicates that the runtime is compiled with JDK 1.5:
>>>>>
>>>>>
>>>>>
>>>>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>>>>
>>>>> bad class file: lib
>>>>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>>>>
>>>>> class file has wrong version 49.0, should be 48.0
>>>>>
>>>>>
>>>>>
>>>>> Is it just a matter of a recompile of the runtime or does the
>>>>> runtime
>>>>> use Java 5 features?
>>>>>
>>>>>
>>>>>
>>>>> Thanks,
>>>>>
>>>>> Gordon
>>>>>
>>>>>
>>>>>
>>>>> ---
>>>>>
>>>>> Gordon Tyler (Software Developer)
>>>>>
>>>>> Quest Software <http://www.quest.com/>
>>>>>
>>>>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>>>>
>>>>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>> --
>>>> Steve Ebersole <steve at hibernate.org>
>>>> Hibernate.org
>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jan.sture.nielsen at gmail.com  Tue Sep  1 07:36:59 2009
From: jan.sture.nielsen at gmail.com (Jan Nielsen)
Date: Tue, 1 Sep 2009 08:36:59 -0600
Subject: [antlr-interest] Language Design Patterns Section 12.5 Problem
In-Reply-To: <f79c7d4d0908312224h6eb9ccd6j52c6fb1d16cd9f0a@mail.gmail.com>
References: <f79c7d4d0908312224h6eb9ccd6j52c6fb1d16cd9f0a@mail.gmail.com>
Message-ID: <f79c7d4d0909010736g195d2bb3n1dd910ee82d492ef@mail.gmail.com>

It appears to be this issue:

  http://www.antlr.org/jira/browse/ANTLR-374

This issue is marked as resolved in 3.1.4 - but 3.1.4 has not been
released yet. And, unfortunately, it does not look like a
3.1.4-SNAPSHOT build is available from Hudson:

  http://antlr.org/hudson/

The ANTLR FishEye tar-ball, as of this morning, unfortunately does not
build, either, so it looks like I'm stuck at this point, unless
someone has an idea?


Thanks,

Jan



On Mon, Aug 31, 2009 at 11:24 PM, Jan
Nielsen<jan.sture.nielsen at gmail.com> wrote:
> I'm not sure if this is the right forum to discuss a little problem I
> encountered in section 12.5 of Language Design Patterns (B6.0), but
> I'm sure this is the most likely spot for some help...I got the
> following:
>
> ?java -cp antlr-3.1.3.jar org.antlr.Tool Cymbol.g Gen.g
> ?warning(200): Cymbol.g:94:45: Decision can match input such as
> "'else'" using multiple alternatives: 1, 2
> ?As a result, alternative(s) 2 were disabled for that input
> ?error(100): :1:1: syntax error: antlr: Gen.g:1:1: unexpected token: operator
> ?error(10): ?internal error: Exception java.lang.ClassCastException:
> antlr.CommonToken cannot be cast to
> antlr.TokenWithIndex at antlr.TokenStreamRewriteEngine.next
> ?Token(TokenStreamRewriteEngine.java:161): can't parse template action
>
> ?error(100): Gen.g:0:0: syntax error: codegen: <AST>:0:0: unexpected
> end of subtree
>
> Per the eBook, I'm expecting the warning(200) but the errors end up
> causing the generated Gen.java to break:
>
> ?Gen.java:1851: illegal start of expression
> ? ? ? ? ? ? ?retval.st = ;
> ? ? ? ? ? ? ? ? ? ? ? ? ?^
> ?1 error
>
> Any thoughts from those of you who have paid for the EA eBook (or
> written it :-)?
>
>
> Thanks,
>
> Jan
>

From Gordon.Tyler at quest.com  Tue Sep  1 07:53:36 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Tue, 1 Sep 2009 07:53:36 -0700
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <c376e6ec0909010626w64a79902v16168751475e62d9@mail.gmail.com>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
	<95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
	<804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>
	<83A722C9-866C-4EA8-A1AE-1A741F15F506@cs.usfca.edu>
	<1FE9A296676737419A8912A6FD22AE1D01BEFEA160@alvxmbw04.prod.quest.corp>
	<c376e6ec0909010626w64a79902v16168751475e62d9@mail.gmail.com>
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01BEFEA2C9@alvxmbw04.prod.quest.corp>

So I edited the pom.xml for the Java Runtime module to set it to source and target 1.4, tried compiling and it complained about a few generics being used. I edited the source to remove the generics because they weren't really being used (e.g. FastQueue<T> was being used by CommonTokenStream as FastQueue<Object>). Now it compiles successfully.

Testing my parser...

-----Original Message-----
From: Martijn Reuvers [mailto:martijn.reuvers at gmail.com] 
Sent: September 1, 2009 9:26 AM
To: Gordon Tyler
Cc: Terence Parr; Jim Idle; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4

I have a project at work which must compile against 1.4 too, but the
IDE runs with 1.5. To prevent using the 1.5 API's I usually change the
JAVA_HOME and PATH before release and set both to use a jdk 1.4
specific one (ant is used for that project). In maven just change the
version of the compiler to 1.4. In either case it is really compiled
against 1.4 and usage of 1.5 specifics is then easily pointed out.


On Tue, Sep 1, 2009 at 3:20 PM, Gordon Tyler<Gordon.Tyler at quest.com> wrote:
> You can use -target 1.4 and -source 1.4 with the JDK 1.5 compiler to make it produce 1.4 compatible class files. The remaining problem is that you're still compiling against the JDK 1.5 runtime library and you have to be careful not to use 1.5-specific APIs.
>
> -----Original Message-----
> From: Terence Parr [mailto:parrt at cs.usfca.edu]
> Sent: August 31, 2009 8:48 PM
> To: Jim Idle
> Cc: antlr-interest at antlr.org; Gordon Tyler
> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>
> cool. see you at the conference. I'm pretty sure I used to run -target
> jsr14 on the releases I made earlier. Neil Gafter, the javac guy, told
> me it works
>
> Ter
>
> On Aug 31, 2009, at 5:34 PM, Jim Idle wrote:
>
>> Pretty sure we can't even though genetics are eluded at the byte code
>> level. I will look at this definitively next week and we can decide
>> what to do at the JVM language conference.
>>
>> Jim
>>
>> On Aug 31, 2009, at 7:14 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
>>
>>> Hi. can we do 1.5 javac with -target jsr14?
>>> Ter
>>> On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:
>>>
>>>> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have
>>>> to stick to Antlr v2 until my project drops the JDK 1.4 requirement.
>>>> Messing around with retro-weaver sounds dubious and I need to
>>>> restrict my third-party dependencies.
>>>>
>>>> -----Original Message-----
>>>> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On Behalf Of
>>>> Steve Ebersole
>>>> Sent: August 31, 2009 6:26 PM
>>>> To: Gordon Tyler
>>>> Cc: antlr-interest at antlr.org
>>>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>>>
>>>> I ran into the same issue when first looking at Antlr3. ?I was told
>>>> the
>>>> intention was to not have the Antlr runtime rely on JDK 1.5; but
>>>> unfortunately some JDK 1.5 features ended up getting exposed.
>>>>
>>>> The outcome of my queries, iirc, was that it would just remain JDK
>>>> 1.5
>>>> compatible. ?You could probably use a retro-weaver though to make it
>>>> 1.4
>>>> compatible. ?Did not try...
>>>>
>>>>
>>>> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>>>>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I'm get
>>>>> ting
>>>>> this error when compiling generated parser code using JDK 1.4,
>>>>> which
>>>>> indicates that the runtime is compiled with JDK 1.5:
>>>>>
>>>>>
>>>>>
>>>>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>>>>
>>>>> bad class file: lib
>>>>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>>>>
>>>>> class file has wrong version 49.0, should be 48.0
>>>>>
>>>>>
>>>>>
>>>>> Is it just a matter of a recompile of the runtime or does the
>>>>> runtime
>>>>> use Java 5 features?
>>>>>
>>>>>
>>>>>
>>>>> Thanks,
>>>>>
>>>>> Gordon
>>>>>
>>>>>
>>>>>
>>>>> ---
>>>>>
>>>>> Gordon Tyler (Software Developer)
>>>>>
>>>>> Quest Software <http://www.quest.com/>
>>>>>
>>>>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>>>>
>>>>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>> --
>>>> Steve Ebersole <steve at hibernate.org>
>>>> Hibernate.org
>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jimi at temporal-wave.com  Tue Sep  1 08:27:00 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 1 Sep 2009 10:27:00 -0500
Subject: [antlr-interest] Language Design Patterns Section 12.5 Problem
In-Reply-To: <f79c7d4d0909010736g195d2bb3n1dd910ee82d492ef@mail.gmail.com>
References: <f79c7d4d0908312224h6eb9ccd6j52c6fb1d16cd9f0a@mail.gmail.com>
	<f79c7d4d0909010736g195d2bb3n1dd910ee82d492ef@mail.gmail.com>
Message-ID: <E4320093-B871-40D5-98C3-8BCEF9B82C4D@temporal-wave.com>

Snapshot is on Hudson. But you can also get it from www.antlr.org/download

Look for 3.1.4 master snapshot jar.

Jim

On Sep 1, 2009, at 9:36 AM, Jan Nielsen <jan.sture.nielsen at gmail.com>  
wrote:

> It appears to be this issue:
>
>  http://www.antlr.org/jira/browse/ANTLR-374
>
> This issue is marked as resolved in 3.1.4 - but 3.1.4 has not been
> released yet. And, unfortunately, it does not look like a
> 3.1.4-SNAPSHOT build is available from Hudson:
>
>  http://antlr.org/hudson/
>
> The ANTLR FishEye tar-ball, as of this morning, unfortunately does not
> build, either, so it looks like I'm stuck at this point, unless
> someone has an idea?
>
>
> Thanks,
>
> Jan
>
>
>
> On Mon, Aug 31, 2009 at 11:24 PM, Jan
> Nielsen<jan.sture.nielsen at gmail.com> wrote:
>> I'm not sure if this is the right forum to discuss a little problem I
>> encountered in section 12.5 of Language Design Patterns (B6.0), but
>> I'm sure this is the most likely spot for some help...I got the
>> following:
>>
>>  java -cp antlr-3.1.3.jar org.antlr.Tool Cymbol.g Gen.g
>>  warning(200): Cymbol.g:94:45: Decision can match input such as
>> "'else'" using multiple alternatives: 1, 2
>>  As a result, alternative(s) 2 were disabled for that input
>>  error(100): :1:1: syntax error: antlr: Gen.g:1:1: unexpected  
>> token: operator
>>  error(10):  internal error: Exception java.lang.ClassCastException:
>> antlr.CommonToken cannot be cast to
>> antlr.TokenWithIndex at antlr.TokenStreamRewriteEngine.next
>>  Token(TokenStreamRewriteEngine.java:161): can't parse template  
>> action
>>
>>  error(100): Gen.g:0:0: syntax error: codegen: <AST>:0:0: unexpected
>> end of subtree
>>
>> Per the eBook, I'm expecting the warning(200) but the errors end up
>> causing the generated Gen.java to break:
>>
>>  Gen.java:1851: illegal start of expression
>>              retval.st = ;
>>                          ^
>>  1 error
>>
>> Any thoughts from those of you who have paid for the EA eBook (or
>> written it :-)?
>>
>>
>> Thanks,
>>
>> Jan
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From Gordon.Tyler at quest.com  Tue Sep  1 09:11:02 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Tue, 1 Sep 2009 09:11:02 -0700
Subject: [antlr-interest] Token options in tokens section?
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01BEFEA4BF@alvxmbw04.prod.quest.corp>

Is it possible to use token options in the tokens section of a grammar? I'd like to do something like this:

tokens {
    STUFF<StuffNode>
}

Where StuffNode is a CommonTree subclass.

But I get this error when generating the parser:

error(100): NewTransform.g:27:16: syntax error: antlr: NewTransform.g:27:16: unexpected token: <

Thanks,
Gordon

---
Gordon Tyler (Software Developer)
Quest Software <http://www.quest.com/>
260 King Street East, Toronto, Ontario M5A 4L5, Canada
Voice: (416) 933-5046 | Fax: (416) 933-5001

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090901/5943c992/attachment.html 

From parrt at cs.usfca.edu  Tue Sep  1 10:38:23 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 1 Sep 2009 10:38:23 -0700
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <1FE9A296676737419A8912A6FD22AE1D01BEFEA2C9@alvxmbw04.prod.quest.corp>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
	<95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
	<804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>
	<83A722C9-866C-4EA8-A1AE-1A741F15F506@cs.usfca.edu>
	<1FE9A296676737419A8912A6FD22AE1D01BEFEA160@alvxmbw04.prod.quest.corp>
	<c376e6ec0909010626w64a79902v16168751475e62d9@mail.gmail.com>
	<1FE9A296676737419A8912A6FD22AE1D01BEFEA2C9@alvxmbw04.prod.quest.corp>
Message-ID: <8ACDCFEA-A79F-4D09-B98D-172F39A80400@cs.usfca.edu>

i think that this got messed up when we went to mvn. i wasn't able to  
set source to 1.5 and target to 1.4 i think.
Ter
On Sep 1, 2009, at 7:53 AM, Gordon Tyler wrote:

> So I edited the pom.xml for the Java Runtime module to set it to  
> source and target 1.4, tried compiling and it complained about a few  
> generics being used. I edited the source to remove the generics  
> because they weren't really being used (e.g. FastQueue<T> was being  
> used by CommonTokenStream as FastQueue<Object>). Now it compiles  
> successfully.
>
> Testing my parser...
>
> -----Original Message-----
> From: Martijn Reuvers [mailto:martijn.reuvers at gmail.com]
> Sent: September 1, 2009 9:26 AM
> To: Gordon Tyler
> Cc: Terence Parr; Jim Idle; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>
> I have a project at work which must compile against 1.4 too, but the
> IDE runs with 1.5. To prevent using the 1.5 API's I usually change the
> JAVA_HOME and PATH before release and set both to use a jdk 1.4
> specific one (ant is used for that project). In maven just change the
> version of the compiler to 1.4. In either case it is really compiled
> against 1.4 and usage of 1.5 specifics is then easily pointed out.
>
>
> On Tue, Sep 1, 2009 at 3:20 PM, Gordon Tyler<Gordon.Tyler at quest.com>  
> wrote:
>> You can use -target 1.4 and -source 1.4 with the JDK 1.5 compiler  
>> to make it produce 1.4 compatible class files. The remaining  
>> problem is that you're still compiling against the JDK 1.5 runtime  
>> library and you have to be careful not to use 1.5-specific APIs.
>>
>> -----Original Message-----
>> From: Terence Parr [mailto:parrt at cs.usfca.edu]
>> Sent: August 31, 2009 8:48 PM
>> To: Jim Idle
>> Cc: antlr-interest at antlr.org; Gordon Tyler
>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>
>> cool. see you at the conference. I'm pretty sure I used to run - 
>> target
>> jsr14 on the releases I made earlier. Neil Gafter, the javac guy,  
>> told
>> me it works
>>
>> Ter
>>
>> On Aug 31, 2009, at 5:34 PM, Jim Idle wrote:
>>
>>> Pretty sure we can't even though genetics are eluded at the byte  
>>> code
>>> level. I will look at this definitively next week and we can decide
>>> what to do at the JVM language conference.
>>>
>>> Jim
>>>
>>> On Aug 31, 2009, at 7:14 PM, Terence Parr <parrt at cs.usfca.edu>  
>>> wrote:
>>>
>>>> Hi. can we do 1.5 javac with -target jsr14?
>>>> Ter
>>>> On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:
>>>>
>>>>> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have
>>>>> to stick to Antlr v2 until my project drops the JDK 1.4  
>>>>> requirement.
>>>>> Messing around with retro-weaver sounds dubious and I need to
>>>>> restrict my third-party dependencies.
>>>>>
>>>>> -----Original Message-----
>>>>> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On  
>>>>> Behalf Of
>>>>> Steve Ebersole
>>>>> Sent: August 31, 2009 6:26 PM
>>>>> To: Gordon Tyler
>>>>> Cc: antlr-interest at antlr.org
>>>>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>>>>
>>>>> I ran into the same issue when first looking at Antlr3.  I was  
>>>>> told
>>>>> the
>>>>> intention was to not have the Antlr runtime rely on JDK 1.5; but
>>>>> unfortunately some JDK 1.5 features ended up getting exposed.
>>>>>
>>>>> The outcome of my queries, iirc, was that it would just remain JDK
>>>>> 1.5
>>>>> compatible.  You could probably use a retro-weaver though to  
>>>>> make it
>>>>> 1.4
>>>>> compatible.  Did not try...
>>>>>
>>>>>
>>>>> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>>>>>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I'm get
>>>>>> ting
>>>>>> this error when compiling generated parser code using JDK 1.4,
>>>>>> which
>>>>>> indicates that the runtime is compiled with JDK 1.5:
>>>>>>
>>>>>>
>>>>>>
>>>>>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>>>>>
>>>>>> bad class file: lib
>>>>>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>>>>>
>>>>>> class file has wrong version 49.0, should be 48.0
>>>>>>
>>>>>>
>>>>>>
>>>>>> Is it just a matter of a recompile of the runtime or does the
>>>>>> runtime
>>>>>> use Java 5 features?
>>>>>>
>>>>>>
>>>>>>
>>>>>> Thanks,
>>>>>>
>>>>>> Gordon
>>>>>>
>>>>>>
>>>>>>
>>>>>> ---
>>>>>>
>>>>>> Gordon Tyler (Software Developer)
>>>>>>
>>>>>> Quest Software <http://www.quest.com/>
>>>>>>
>>>>>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>>>>>
>>>>>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>> --
>>>>> Steve Ebersole <steve at hibernate.org>
>>>>> Hibernate.org
>>>>>
>>>>>
>>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From martijn.reuvers at gmail.com  Tue Sep  1 11:25:33 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Tue, 1 Sep 2009 20:25:33 +0200
Subject: [antlr-interest] Using Antlr v3 with JDK 1.4
In-Reply-To: <8ACDCFEA-A79F-4D09-B98D-172F39A80400@cs.usfca.edu>
References: <1FE9A296676737419A8912A6FD22AE1D01BEFE9D43@alvxmbw04.prod.quest.corp>
	<1251757567.29872.67.camel@localhost.localdomain>
	<1FE9A296676737419A8912A6FD22AE1D01BEFE9E73@alvxmbw04.prod.quest.corp>
	<95EB17C8-8E6C-41F7-89A8-8EBEFD438F1D@cs.usfca.edu>
	<804F2E29-4515-4741-9C9E-93AAC434D46D@temporal-wave.com>
	<83A722C9-866C-4EA8-A1AE-1A741F15F506@cs.usfca.edu>
	<1FE9A296676737419A8912A6FD22AE1D01BEFEA160@alvxmbw04.prod.quest.corp>
	<c376e6ec0909010626w64a79902v16168751475e62d9@mail.gmail.com>
	<1FE9A296676737419A8912A6FD22AE1D01BEFEA2C9@alvxmbw04.prod.quest.corp>
	<8ACDCFEA-A79F-4D09-B98D-172F39A80400@cs.usfca.edu>
Message-ID: <c376e6ec0909011125y643bd3camf92de090cc45100b@mail.gmail.com>

This works for maven to compile with JDK 1.4, unfortunately you must
set the jdk property so it will really compile with that JDK (or it
will use the default jdk of your environment), fork is a must as well.
You could also change the JAVA_HOME setting of your environment to
point to the proper JDK version, then your maven build does not need
to change (1.4 for source / target will be enough then).

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.4</source>
          <target>1.4</target>
          <fork>true</fork>
          <executable>${JAVA_HOME_1_4}/bin/javac</executable>
          <compilerVersion>1.4</compilerVersion>
        </configuration>
      </plugin>

On Tue, Sep 1, 2009 at 7:38 PM, Terence Parr<parrt at cs.usfca.edu> wrote:
> i think that this got messed up when we went to mvn. i wasn't able to
> set source to 1.5 and target to 1.4 i think.
> Ter
> On Sep 1, 2009, at 7:53 AM, Gordon Tyler wrote:
>
>> So I edited the pom.xml for the Java Runtime module to set it to
>> source and target 1.4, tried compiling and it complained about a few
>> generics being used. I edited the source to remove the generics
>> because they weren't really being used (e.g. FastQueue<T> was being
>> used by CommonTokenStream as FastQueue<Object>). Now it compiles
>> successfully.
>>
>> Testing my parser...
>>
>> -----Original Message-----
>> From: Martijn Reuvers [mailto:martijn.reuvers at gmail.com]
>> Sent: September 1, 2009 9:26 AM
>> To: Gordon Tyler
>> Cc: Terence Parr; Jim Idle; antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>
>> I have a project at work which must compile against 1.4 too, but the
>> IDE runs with 1.5. To prevent using the 1.5 API's I usually change the
>> JAVA_HOME and PATH before release and set both to use a jdk 1.4
>> specific one (ant is used for that project). In maven just change the
>> version of the compiler to 1.4. In either case it is really compiled
>> against 1.4 and usage of 1.5 specifics is then easily pointed out.
>>
>>
>> On Tue, Sep 1, 2009 at 3:20 PM, Gordon Tyler<Gordon.Tyler at quest.com>
>> wrote:
>>> You can use -target 1.4 and -source 1.4 with the JDK 1.5 compiler
>>> to make it produce 1.4 compatible class files. The remaining
>>> problem is that you're still compiling against the JDK 1.5 runtime
>>> library and you have to be careful not to use 1.5-specific APIs.
>>>
>>> -----Original Message-----
>>> From: Terence Parr [mailto:parrt at cs.usfca.edu]
>>> Sent: August 31, 2009 8:48 PM
>>> To: Jim Idle
>>> Cc: antlr-interest at antlr.org; Gordon Tyler
>>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>>
>>> cool. see you at the conference. I'm pretty sure I used to run -
>>> target
>>> jsr14 on the releases I made earlier. Neil Gafter, the javac guy,
>>> told
>>> me it works
>>>
>>> Ter
>>>
>>> On Aug 31, 2009, at 5:34 PM, Jim Idle wrote:
>>>
>>>> Pretty sure we can't even though genetics are eluded at the byte
>>>> code
>>>> level. I will look at this definitively next week and we can decide
>>>> what to do at the JVM language conference.
>>>>
>>>> Jim
>>>>
>>>> On Aug 31, 2009, at 7:14 PM, Terence Parr <parrt at cs.usfca.edu>
>>>> wrote:
>>>>
>>>>> Hi. can we do 1.5 javac with -target jsr14?
>>>>> Ter
>>>>> On Aug 31, 2009, at 3:30 PM, Gordon Tyler wrote:
>>>>>
>>>>>> Thanks Steve, and Jim Idle who replied off-list. I guess I'll have
>>>>>> to stick to Antlr v2 until my project drops the JDK 1.4
>>>>>> requirement.
>>>>>> Messing around with retro-weaver sounds dubious and I need to
>>>>>> restrict my third-party dependencies.
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: Steve Ebersole [mailto:steven.ebersole at gmail.com] On
>>>>>> Behalf Of
>>>>>> Steve Ebersole
>>>>>> Sent: August 31, 2009 6:26 PM
>>>>>> To: Gordon Tyler
>>>>>> Cc: antlr-interest at antlr.org
>>>>>> Subject: Re: [antlr-interest] Using Antlr v3 with JDK 1.4
>>>>>>
>>>>>> I ran into the same issue when first looking at Antlr3. ?I was
>>>>>> told
>>>>>> the
>>>>>> intention was to not have the Antlr runtime rely on JDK 1.5; but
>>>>>> unfortunately some JDK 1.5 features ended up getting exposed.
>>>>>>
>>>>>> The outcome of my queries, iirc, was that it would just remain JDK
>>>>>> 1.5
>>>>>> compatible. ?You could probably use a retro-weaver though to
>>>>>> make it
>>>>>> 1.4
>>>>>> compatible. ?Did not try...
>>>>>>
>>>>>>
>>>>>> On Mon, 2009-08-31 at 14:25 -0700, Gordon Tyler wrote:
>>>>>>> Is it possible to use the Antlr v3 runtime with JDK 1.4? I'm get
>>>>>>> ting
>>>>>>> this error when compiling generated parser code using JDK 1.4,
>>>>>>> which
>>>>>>> indicates that the runtime is compiled with JDK 1.5:
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> NewTransformLexer.java:11: cannot access org.antlr.runtime.Lexer
>>>>>>>
>>>>>>> bad class file: lib
>>>>>>> \antlr-runtime-3.1.3.jar(org/antlr/runtime/Lexer.class)
>>>>>>>
>>>>>>> class file has wrong version 49.0, should be 48.0
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> Is it just a matter of a recompile of the runtime or does the
>>>>>>> runtime
>>>>>>> use Java 5 features?
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> Thanks,
>>>>>>>
>>>>>>> Gordon
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> ---
>>>>>>>
>>>>>>> Gordon Tyler (Software Developer)
>>>>>>>
>>>>>>> Quest Software <http://www.quest.com/>
>>>>>>>
>>>>>>> 260 King Street East, Toronto, Ontario M5A 4L5, Canada
>>>>>>>
>>>>>>> Voice: (416) 933-5046 | Fax: (416) 933-5001
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>>> --
>>>>>> Steve Ebersole <steve at hibernate.org>
>>>>>> Hibernate.org
>>>>>>
>>>>>>
>>>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>>
>>>>>
>>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>>
>>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From sg at 101tec.com  Tue Sep  1 12:50:26 2009
From: sg at 101tec.com (Stefan Groschupf)
Date: Tue, 1 Sep 2009 21:50:26 +0200
Subject: [antlr-interest] AST as in Antlrwork
Message-ID: <B88911F9-76B1-4F67-9A27-3B26E0C4C5E6@101tec.com>

Hi,
I'm making my first baby with antlr.
Is there any chance to get a AST exactly as antlr work is generating  
without rewriting rules.
Thanks,
Stefan



From parrt at cs.usfca.edu  Tue Sep  1 12:51:56 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 1 Sep 2009 12:51:56 -0700
Subject: [antlr-interest] AST as in Antlrwork
In-Reply-To: <B88911F9-76B1-4F67-9A27-3B26E0C4C5E6@101tec.com>
References: <B88911F9-76B1-4F67-9A27-3B26E0C4C5E6@101tec.com>
Message-ID: <F341D60A-5CD8-4D20-AF6A-2CBEC73BF996@cs.usfca.edu>

you mean a parse tree, not AST, right?  There is a ParseTreeBuilder i  
think.
T
On Sep 1, 2009, at 12:50 PM, Stefan Groschupf wrote:

> Hi,
> I'm making my first baby with antlr.
> Is there any chance to get a AST exactly as antlr work is generating
> without rewriting rules.
> Thanks,
> Stefan
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Tue Sep  1 13:56:01 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 1 Sep 2009 15:56:01 -0500
Subject: [antlr-interest] AST as in Antlrwork
In-Reply-To: <B88911F9-76B1-4F67-9A27-3B26E0C4C5E6@101tec.com>
References: <B88911F9-76B1-4F67-9A27-3B26E0C4C5E6@101tec.com>
Message-ID: <2F8948D0-3027-4F51-9949-8D8917865189@temporal-wave.com>

That is the parse tree and not the AST.  You probably do not want the  
parse tree but there is a wiki article that tells you how to get it by  
listening to the debugger.

Building an AST is not difficult once you get the hang of it though.

Jim

On Sep 1, 2009, at 2:50 PM, Stefan Groschupf <sg at 101tec.com> wrote:

> Hi,
> I'm making my first baby with antlr.
> Is there any chance to get a AST exactly as antlr work is generating
> without rewriting rules.
> Thanks,
> Stefan
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From gabriel_erzse at yahoo.com  Wed Sep  2 07:05:06 2009
From: gabriel_erzse at yahoo.com (Gabriel Erzse)
Date: Wed, 2 Sep 2009 07:05:06 -0700 (PDT)
Subject: [antlr-interest] best approach for macro substitution
Message-ID: <68534.61289.qm@web51311.mail.re2.yahoo.com>

Hi,

What do you think would be the best approach to solve macro substitution with ANTLR?

One option I've seen is to build it in the lexer. I've seen a sample grammar for a C preprocessor on the website, but I didn't go in detail into it. My language is not C, but a custom language that resembles more to Java.

Another option I'm thinking of is to do the macro replacement after the AST is built? Basically walk over the tree, detect macro patterns in the subtrees and do needed replacements. But this one sounds messy, with all the involved node manipulations.

Another one would be to integrate some external framework. For example there is the GNU M4 framework. Don't know if there is something similar that can be easily plugged into ANTLR.

If someone has experience with macro handling, I could use any suggestion.

Thanks,
Gabi.


From troy.daniels at baesystems.com  Wed Sep  2 07:37:57 2009
From: troy.daniels at baesystems.com (Daniels, Troy (US SSA))
Date: Wed, 2 Sep 2009 10:37:57 -0400
Subject: [antlr-interest] best approach for macro substitution
Message-ID: <814i1h$4bj54f@dmzms99801.na.baesystems.com>

If it is a c-style preprocessor, once you've built the AST will be too
late.  Consider this example:

// I like pascal and capitals
#define BEGIN {
#define END }
#define IF if


IF ( x > 0 )
BEGIN
  x = -1;
END

A typical java parser isn't going to be able to recognize most of that,
even though it's a perfectly valid code fragment once the macros are
replaced.

Building it into the lexer is also challenging, assuming full
replacements are allowed:

#define IF_POSITIVE(x, body) if ((x) > 0) { body; }

You would need a lexer rule that, after this statement is encountered,
would recognize this expression and then generate an arbitrarily complex
stream of tokens. 

It's not impossible, but it is rather complicated.  If you have a
separate preprocessor, it may be simpler to try parsing the processed
text. 

Troy

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-
> bounces at antlr.org] On Behalf Of Gabriel Erzse
> Sent: Wednesday, September 02, 2009 10:05 AM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] best approach for macro substitution
> 
> Hi,
> 
> What do you think would be the best approach to solve macro
substitution
> with ANTLR?
> 
> One option I've seen is to build it in the lexer. I've seen a sample
> grammar for a C preprocessor on the website, but I didn't go in detail
> into it. My language is not C, but a custom language that resembles
more
> to Java.
> 
> Another option I'm thinking of is to do the macro replacement after
the
> AST is built? Basically walk over the tree, detect macro patterns in
the
> subtrees and do needed replacements. But this one sounds messy, with
all
> the involved node manipulations.
> 
> Another one would be to integrate some external framework. For example
> there is the GNU M4 framework. Don't know if there is something
similar
> that can be easily plugged into ANTLR.
> 
> If someone has experience with macro handling, I could use any
suggestion.
> 
> Thanks,
> Gabi.
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-
> email-address


From sokorac at gmail.com  Wed Sep  2 07:41:32 2009
From: sokorac at gmail.com (Stanislav Sokorac)
Date: Wed, 2 Sep 2009 10:41:32 -0400
Subject: [antlr-interest] best approach for macro substitution
In-Reply-To: <68534.61289.qm@web51311.mail.re2.yahoo.com>
References: <68534.61289.qm@web51311.mail.re2.yahoo.com>
Message-ID: <f6be20450909020741i3e40da45g5394a491e754bef7@mail.gmail.com>

Two approaches that I think are the most effective are pre-processing and
substitution in the lexer. You could also do it in the parser (see "handling
include files" FAQ), although it makes your AST/walker more complicated.
The advantage of pre-processing is the flexibility of having macros anywhere
in the code, even as parts of tokens. A disadvantage is that you have to
keep track of all macro replacements and then do some post-processing on all
line and character numbers to be able to report correct numbers for the
original file. Also, you have to pass through the file twice.

Doing the replacement in the lexer is probably the most effective solution
for the majority of the cases. As long as your macros are not allowed to
define parts of tokens (or you can modify your lexer to make it so), then
this is a pretty easy solution. Whenever you detect a macro, drop that
token, switch the input stream to the macro value, and then switch back when
it's done. You'll need to detect macro definitions and keep a map of them,
of course.

Stan

On Wed, Sep 2, 2009 at 10:05 AM, Gabriel Erzse <gabriel_erzse at yahoo.com>wrote:

> Hi,
>
> What do you think would be the best approach to solve macro substitution
> with ANTLR?
>
> One option I've seen is to build it in the lexer. I've seen a sample
> grammar for a C preprocessor on the website, but I didn't go in detail into
> it. My language is not C, but a custom language that resembles more to Java.
>
> Another option I'm thinking of is to do the macro replacement after the AST
> is built? Basically walk over the tree, detect macro patterns in the
> subtrees and do needed replacements. But this one sounds messy, with all the
> involved node manipulations.
>
> Another one would be to integrate some external framework. For example
> there is the GNU M4 framework. Don't know if there is something similar that
> can be easily plugged into ANTLR.
>
> If someone has experience with macro handling, I could use any suggestion.
>
> Thanks,
> Gabi.
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090902/b1246490/attachment.html 

From lists at brachttal.net  Wed Sep  2 14:13:54 2009
From: lists at brachttal.net (Andreas Volz)
Date: Wed, 2 Sep 2009 23:13:54 +0200
Subject: [antlr-interest] Get results of multible tokens
Message-ID: <20090902231354.2ee2156c@frodo.mittelerde>

Hello,

I have this grammar file:

grammar VCard;

@members {
    public static void main(String[] args) throws Exception {
        VCardLexer lex = new VCardLexer(new ANTLRFileStream(args[0]));
        CommonTokenStream tokens = new CommonTokenStream(lex);

        VCardParser parser = new VCardParser(tokens);

        try {
            parser.line();
        } catch (RecognitionException e)  {
            e.printStackTrace();
        }
    }
}

line
	: property=TOKEN subtoken=SUBTOKEN* DPOINT attribute=TOKEN
	{
		System.out.println ("Property: " + $property.text);
		System.out.println ("Attribute: " + $attribute.text);
		System.out.println ("Subtoken: " + $subtoken.text);

	}
	;

TOKEN
	: (ALPHA | DIGIT)+
	;
	
SUBTOKEN
	: SEMI TOKEN
	;
	
WS 	
	: ('\n' | ' ' | '\t')* {$channel=HIDDEN;}
	;	

fragment DIGIT  	
	: '0'..'9'
	;
	
fragment ALPHA
	: 'a'..'z' | 'A'..'Z'
	;
	
DPOINT
	: ':'
	;
	
SEMI
	: ';'
	;
	

And this input:

a;b;c;2:3a3bcde

This is the output:

Property: a
Attribute: 3a3bcde
Subtoken: ;2

What I like to get is:

Property: a
Subtoken: b
Subtoken: c
Subtoken: 2
Attribute: 3a3bcde

I couldn't find in the docs how to match multiple tokens that I get
from a * or + parser.

A second question is how to not include the ';' in the match.

I tried it for some time now, but I find no way. Could someone give me
an hint.

regards
Andreas

From hugo.pcd at gmail.com  Wed Sep  2 15:05:30 2009
From: hugo.pcd at gmail.com (Hugo Picado)
Date: Wed, 2 Sep 2009 23:05:30 +0100
Subject: [antlr-interest] Get results of multible tokens
In-Reply-To: <20090902231354.2ee2156c@frodo.mittelerde>
References: <20090902231354.2ee2156c@frodo.mittelerde>
Message-ID: <3c2632090909021505x7a9ec157m36cdd109550b7f59@mail.gmail.com>

Hi,

One fast approach is to divide to conquer:

line
 : property subtokenlist DPOINT attribute
 ;
property
 : TOKEN { System.out.println ("Property: " + $TOKEN.text); }
 ;
subtokenlist
 : (SEMI TOKEN { System.out.println("Subtoken: " + $TOKEN.text); } )*
 ;
attribute
 : TOKEN { System.out.println ("Attribute: " + $TOKEN.text); }
 ;

This also eliminates the need for having the SUBTOKEN rule and solves the
semicolon problem.
 I didn't try this because it is not possible for me right now so I don't
know if it is actually working, but the idea is there :)

Good luck,
Hugo.


On Wed, Sep 2, 2009 at 10:13 PM, Andreas Volz <lists at brachttal.net> wrote:

> Hello,
>
> I have this grammar file:
>
> grammar VCard;
>
> @members {
>    public static void main(String[] args) throws Exception {
>        VCardLexer lex = new VCardLexer(new ANTLRFileStream(args[0]));
>        CommonTokenStream tokens = new CommonTokenStream(lex);
>
>        VCardParser parser = new VCardParser(tokens);
>
>        try {
>            parser.line();
>        } catch (RecognitionException e)  {
>            e.printStackTrace();
>        }
>    }
> }
>
> line
>        : property=TOKEN subtoken=SUBTOKEN* DPOINT attribute=TOKEN
>        {
>                System.out.println ("Property: " + $property.text);
>                System.out.println ("Attribute: " + $attribute.text);
>                System.out.println ("Subtoken: " + $subtoken.text);
>
>        }
>        ;
>
> TOKEN
>        : (ALPHA | DIGIT)+
>        ;
>
> SUBTOKEN
>        : SEMI TOKEN
>        ;
>
> WS
>        : ('\n' | ' ' | '\t')* {$channel=HIDDEN;}
>        ;
>
> fragment DIGIT
>        : '0'..'9'
>        ;
>
> fragment ALPHA
>        : 'a'..'z' | 'A'..'Z'
>        ;
>
> DPOINT
>        : ':'
>        ;
>
> SEMI
>        : ';'
>        ;
>
>
> And this input:
>
> a;b;c;2:3a3bcde
>
> This is the output:
>
> Property: a
> Attribute: 3a3bcde
> Subtoken: ;2
>
> What I like to get is:
>
> Property: a
> Subtoken: b
> Subtoken: c
> Subtoken: 2
> Attribute: 3a3bcde
>
> I couldn't find in the docs how to match multiple tokens that I get
> from a * or + parser.
>
> A second question is how to not include the ';' in the match.
>
> I tried it for some time now, but I find no way. Could someone give me
> an hint.
>
> regards
> Andreas
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090902/cea8f4a6/attachment.html 

From elnur.j at gmail.com  Thu Sep  3 22:09:18 2009
From: elnur.j at gmail.com (Elnur Cabarov)
Date: Fri, 4 Sep 2009 10:09:18 +0500
Subject: [antlr-interest] Dynamic AST node
Message-ID: <cb604c710909032209k62a936fbj4b9396f71aaf4fcf@mail.gmail.com>

Hi,

I've got a rule that is called from multiple other rules. I want dynamically
modify AST node for every invocation.

For example:

variable
    :    type ID -> ^(VARIABLE type ID);

I want VARIABLE node be dynamic, that is it can also be PARAMETER when
called from somewhere else.
My case is not as simple as this, so duplicating rules is not acceptable.
Also I'd prefer use dynamic attribute scopes, because rules are nested into
many levels and rule attributes are not desirable too :)

Thanks

-- 
Elnur Cabarov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090904/977e72f7/attachment.html 

From klausmartinschitz at gmx.at  Fri Sep  4 00:27:25 2009
From: klausmartinschitz at gmx.at (Klaus Martinschitz)
Date: Fri, 04 Sep 2009 09:27:25 +0200
Subject: [antlr-interest] ANTLR debug error
Message-ID: <4AA0C15D.1080706@gmx.at>

Hi!

I already looked around in the internet and do not find any answer to
solve following problem. I downloaded the newest antlr works version
1.2.3 were antlr and antlr works are bundled. I normally start the jar
file. IF I try to debug I get an error message. Everything is set
correctly, classpath etc. Sometimes after a restart the same file works
and sometimes not. I don't know why.

Thanks for help,

Klaus

From indhu.b at s7software.com  Fri Sep  4 00:49:37 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 4 Sep 2009 13:19:37 +0530
Subject: [antlr-interest] ANTLR debug error
In-Reply-To: <4AA0C15D.1080706@gmx.at>
References: <4AA0C15D.1080706@gmx.at>
Message-ID: <8F0BB8C9-CF21-4214-8477-CF303419CFF7@s7software.com>

What exactly is the error message you get?


On Sep 4, 2009, at 12:57 PM, Klaus Martinschitz <klausmartinschitz at gmx.at 
 > wrote:

> Hi!
>
> I already looked around in the internet and do not find any answer to
> solve following problem. I downloaded the newest antlr works version
> 1.2.3 were antlr and antlr works are bundled. I normally start the jar
> file. IF I try to debug I get an error message. Everything is set
> correctly, classpath etc. Sometimes after a restart the same file  
> works
> and sometimes not. I don't know why.
>
> Thanks for help,
>
> Klaus
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jimi at temporal-wave.com  Fri Sep  4 09:36:38 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 4 Sep 2009 11:36:38 -0500
Subject: [antlr-interest] ANTLR debug error
In-Reply-To: <4AA0C15D.1080706@gmx.at>
References: <4AA0C15D.1080706@gmx.at>
Message-ID: <229A36F4-A4AD-476B-8CFE-6878C697EE0C@temporal-wave.com>

Can happen if you have an empty lexer rule that runs forever or if you  
start something that uses the same port. Kill the rogue java process  
if a lexer problem. Teat by running from command line first.

Jim

On Sep 4, 2009, at 2:27 AM, Klaus Martinschitz  
<klausmartinschitz at gmx.at> wrote:

> Hi!
>
> I already looked around in the internet and do not find any answer to
> solve following problem. I downloaded the newest antlr works version
> 1.2.3 were antlr and antlr works are bundled. I normally start the jar
> file. IF I try to debug I get an error message. Everything is set
> correctly, classpath etc. Sometimes after a restart the same file  
> works
> and sometimes not. I don't know why.
>
> Thanks for help,
>
> Klaus
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jimi at temporal-wave.com  Fri Sep  4 09:38:05 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 4 Sep 2009 11:38:05 -0500
Subject: [antlr-interest] Dynamic AST node
In-Reply-To: <cb604c710909032209k62a936fbj4b9396f71aaf4fcf@mail.gmail.com>
References: <cb604c710909032209k62a936fbj4b9396f71aaf4fcf@mail.gmail.com>
Message-ID: <BDC74853-CA43-41EF-924F-3CC3F4FF4E9C@temporal-wave.com>

Pass in the type as a parameter and use conditional rewrites or use  
the parameter as the node type in the rewrite.

Jim

On Sep 4, 2009, at 12:09 AM, Elnur Cabarov <elnur.j at gmail.com> wrote:

> Hi,
>
> I've got a rule that is called from multiple other rules. I want  
> dynamically modify AST node for every invocation.
>
> For example:
>
> variable
>     :    type ID -> ^(VARIABLE type ID);
>
> I want VARIABLE node be dynamic, that is it can also be PARAMETER  
> when called from somewhere else.
> My case is not as simple as this, so duplicating rules is not  
> acceptable.
> Also I'd prefer use dynamic attribute scopes, because rules are  
> nested into many levels and rule attributes are not desirable too :)
>
> Thanks
>
> -- 
> Elnur Cabarov
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From lists at brachttal.net  Fri Sep  4 13:30:49 2009
From: lists at brachttal.net (Andreas Volz)
Date: Fri, 4 Sep 2009 22:30:49 +0200
Subject: [antlr-interest] Get results of multible tokens
In-Reply-To: <3c2632090909021505x7a9ec157m36cdd109550b7f59@mail.gmail.com>
References: <20090902231354.2ee2156c@frodo.mittelerde>
	<3c2632090909021505x7a9ec157m36cdd109550b7f59@mail.gmail.com>
Message-ID: <20090904223049.123406db@frodo.mittelerde>

Am Wed, 2 Sep 2009 23:05:30 +0100 schrieb Hugo Picado:

Hello Hugo,

thanks this works nice.

regards
	Andreas

> Hi,
> 
> One fast approach is to divide to conquer:
> 
> line
>  : property subtokenlist DPOINT attribute
>  ;
> property
>  : TOKEN { System.out.println ("Property: " + $TOKEN.text); }
>  ;
> subtokenlist
>  : (SEMI TOKEN { System.out.println("Subtoken: " + $TOKEN.text); } )*
>  ;
> attribute
>  : TOKEN { System.out.println ("Attribute: " + $TOKEN.text); }
>  ;
> 
> This also eliminates the need for having the SUBTOKEN rule and solves
> the semicolon problem.
>  I didn't try this because it is not possible for me right now so I
> don't know if it is actually working, but the idea is there :)
> 
> Good luck,
> Hugo.
> 
> 
> On Wed, Sep 2, 2009 at 10:13 PM, Andreas Volz <lists at brachttal.net>
> wrote:
> 
> > Hello,
> >
> > I have this grammar file:
> >
> > grammar VCard;
> >
> > @members {
> >    public static void main(String[] args) throws Exception {
> >        VCardLexer lex = new VCardLexer(new
> > ANTLRFileStream(args[0])); CommonTokenStream tokens = new
> > CommonTokenStream(lex);
> >
> >        VCardParser parser = new VCardParser(tokens);
> >
> >        try {
> >            parser.line();
> >        } catch (RecognitionException e)  {
> >            e.printStackTrace();
> >        }
> >    }
> > }
> >
> > line
> >        : property=TOKEN subtoken=SUBTOKEN* DPOINT attribute=TOKEN
> >        {
> >                System.out.println ("Property: " + $property.text);
> >                System.out.println ("Attribute: " + $attribute.text);
> >                System.out.println ("Subtoken: " + $subtoken.text);
> >
> >        }
> >        ;
> >
> > TOKEN
> >        : (ALPHA | DIGIT)+
> >        ;
> >
> > SUBTOKEN
> >        : SEMI TOKEN
> >        ;
> >
> > WS
> >        : ('\n' | ' ' | '\t')* {$channel=HIDDEN;}
> >        ;
> >
> > fragment DIGIT
> >        : '0'..'9'
> >        ;
> >
> > fragment ALPHA
> >        : 'a'..'z' | 'A'..'Z'
> >        ;
> >
> > DPOINT
> >        : ':'
> >        ;
> >
> > SEMI
> >        : ';'
> >        ;
> >
> >
> > And this input:
> >
> > a;b;c;2:3a3bcde
> >
> > This is the output:
> >
> > Property: a
> > Attribute: 3a3bcde
> > Subtoken: ;2
> >
> > What I like to get is:
> >
> > Property: a
> > Subtoken: b
> > Subtoken: c
> > Subtoken: 2
> > Attribute: 3a3bcde
> >
> > I couldn't find in the docs how to match multiple tokens that I get
> > from a * or + parser.
> >
> > A second question is how to not include the ';' in the match.
> >
> > I tried it for some time now, but I find no way. Could someone give
> > me an hint.
> >
> > regards
> > Andreas
> >
> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
> > Unsubscribe:
> > http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> >

From lists at brachttal.net  Sun Sep  6 00:40:44 2009
From: lists at brachttal.net (Andreas Volz)
Date: Sun, 6 Sep 2009 09:40:44 +0200
Subject: [antlr-interest] Problems with the C version of ANTLR
Message-ID: <20090906094044.286696dc@frodo.mittelerde>

Hello,

I tried some Java examples for ANTLR and it worked nice. But I need a
parser for C (for later C++ usage). As easy it was to get a working
Java example as hard is it to get a C example working.

I've read this doc:

http://www.antlr.org/api/C/index.html

-> Generating Code for the C Target 

I'm a little confused about this table:

Suffix 	Grammar should contain...
.g3l 	A lexer grammar specification only.
.g3p 	A parser grammar specification only.
.g3pl 	A combined lexer and parser specification.
.g3t 	A tree grammar specification. 

All examples I've seen contains only grammar.g files. Is this simply a
new handling to split my grammar file?

How ever. I go with my grammar.g file that I've used for the Java
example.

VCard.g:
http://codepad.org/hiVS9kte

First question is if it's also possible to insert the main code for C
in the grammar file like with Java?

Then I installed ANTLR-3.0.1 (Ubuntu) from repository and the C runtime
from ANTLR-3.0.1 from source. This should fit together.

Now I took an C example and modified it to compile for my grammar. At
first I compiled the grammar and got these files:

VCardLexer.c
VCardLexer.h
VCardParser.c
VCardParser.h

I modified them from an example:

VCard.c:
http://codepad.org/uoMWeBW7

VCard.h:
http://codepad.org/ADTKm47X

Makefile.C:
http://codepad.org/YWC4E4ti

This compiles, but I get a "Segmentation fault" as result. I've not yet
debugged into it, because I like to ensure that I did all steps correct.

You could see that I commented out all the "langAST" and "treePsr"
variables, because they didn't compile. Who creates the "pLangDumpDecl"
and "LangParser_decl_return" type? I don't see it generated by the code
generator. Do I need those for my example?

And the last question is why is it so hard to get the C target working
comparing to the Java target? :-)

regards
	Andreas

From dahvid.minor at gmail.com  Sun Sep  6 03:57:00 2009
From: dahvid.minor at gmail.com (David Minor)
Date: Sun, 6 Sep 2009 13:57:00 +0300
Subject: [antlr-interest] saving,
	duplicating and substituting tree nodes in the C API
Message-ID: <a2a61e1e0909060357y3731c4b2v7f7a182afb51f663@mail.gmail.com>

I'm working on a language that allows assignment of functions to variables.
Something like this.
fun = execute(params);

Later in the same scope if I want to do.
another_fun = fun

The most natural way to do this seems to me to save the tree from the first
execute(params) in a symbol table
and then, while generating the AST, when I see that "fun" is defined, to
substitute a duplicate of it's tree for the assignment to another_fun.

The trouble is the symbol table is in C world not Antlr.  It looks like I
could just duplicate the node save
the pointer and then re-use it, but I don't see any examples of how to do
this.

Does anyone have an idea?  Even a Java example would be helpful.

Regards,
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090906/0bad1cf6/attachment.html 

From lists at brachttal.net  Sun Sep  6 04:36:57 2009
From: lists at brachttal.net (Andreas Volz)
Date: Sun, 6 Sep 2009 13:36:57 +0200
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090906094044.286696dc@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>
Message-ID: <20090906133657.374a33f9@frodo.mittelerde>

Am Sun, 6 Sep 2009 09:40:44 +0200 schrieb Andreas Volz:

Hello,

I did an update that now runs without segfault. But it still doen't
print out anything. Any ideas?

regards
Andreas

> Hello,
> 
> I tried some Java examples for ANTLR and it worked nice. But I need a
> parser for C (for later C++ usage). As easy it was to get a working
> Java example as hard is it to get a C example working.
> 
> I've read this doc:
> 
> http://www.antlr.org/api/C/index.html
> 
> -> Generating Code for the C Target 
> 
> I'm a little confused about this table:
> 
> Suffix 	Grammar should contain...
> .g3l 	A lexer grammar specification only.
> .g3p 	A parser grammar specification only.
> .g3pl 	A combined lexer and parser specification.
> .g3t 	A tree grammar specification. 
> 
> All examples I've seen contains only grammar.g files. Is this simply a
> new handling to split my grammar file?
> 
> How ever. I go with my grammar.g file that I've used for the Java
> example.
> 
> VCard.g:
> http://codepad.org/hiVS9kte
> 
> First question is if it's also possible to insert the main code for C
> in the grammar file like with Java?
> 
> Then I installed ANTLR-3.0.1 (Ubuntu) from repository and the C
> runtime from ANTLR-3.0.1 from source. This should fit together.
> 
> Now I took an C example and modified it to compile for my grammar. At
> first I compiled the grammar and got these files:
> 
> VCardLexer.c
> VCardLexer.h
> VCardParser.c
> VCardParser.h
> 
> I modified them from an example:
> 
> VCard.c:
> http://codepad.org/uoMWeBW7
> 
> VCard.h:
> http://codepad.org/ADTKm47X
> 
> Makefile.C:
> http://codepad.org/YWC4E4ti
> 
> This compiles, but I get a "Segmentation fault" as result. I've not
> yet debugged into it, because I like to ensure that I did all steps
> correct.
> 
> You could see that I commented out all the "langAST" and "treePsr"
> variables, because they didn't compile. Who creates the
> "pLangDumpDecl" and "LangParser_decl_return" type? I don't see it
> generated by the code generator. Do I need those for my example?
> 
> And the last question is why is it so hard to get the C target working
> comparing to the Java target? :-)
> 
> regards
> 	Andreas
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 

From lists at brachttal.net  Sun Sep  6 04:47:58 2009
From: lists at brachttal.net (Andreas Volz)
Date: Sun, 6 Sep 2009 13:47:58 +0200
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090906094044.286696dc@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>
Message-ID: <20090906134758.379cf8a6@frodo.mittelerde>

Am Sun, 6 Sep 2009 09:40:44 +0200 schrieb Andreas Volz:

Hello,

I found the problems. The segfault was forced by free the variable that
I have not created for my example. Then after calling the correct
parser entry point it works great.

regards
Andreas



> Hello,
> 
> I tried some Java examples for ANTLR and it worked nice. But I need a
> parser for C (for later C++ usage). As easy it was to get a working
> Java example as hard is it to get a C example working.
> 
> I've read this doc:
> 
> http://www.antlr.org/api/C/index.html
> 
> -> Generating Code for the C Target 
> 
> I'm a little confused about this table:
> 
> Suffix 	Grammar should contain...
> .g3l 	A lexer grammar specification only.
> .g3p 	A parser grammar specification only.
> .g3pl 	A combined lexer and parser specification.
> .g3t 	A tree grammar specification. 
> 
> All examples I've seen contains only grammar.g files. Is this simply a
> new handling to split my grammar file?
> 
> How ever. I go with my grammar.g file that I've used for the Java
> example.
> 
> VCard.g:
> http://codepad.org/hiVS9kte
> 
> First question is if it's also possible to insert the main code for C
> in the grammar file like with Java?
> 
> Then I installed ANTLR-3.0.1 (Ubuntu) from repository and the C
> runtime from ANTLR-3.0.1 from source. This should fit together.
> 
> Now I took an C example and modified it to compile for my grammar. At
> first I compiled the grammar and got these files:
> 
> VCardLexer.c
> VCardLexer.h
> VCardParser.c
> VCardParser.h
> 
> I modified them from an example:
> 
> VCard.c:
> http://codepad.org/uoMWeBW7
> 
> VCard.h:
> http://codepad.org/ADTKm47X
> 
> Makefile.C:
> http://codepad.org/YWC4E4ti
> 
> This compiles, but I get a "Segmentation fault" as result. I've not
> yet debugged into it, because I like to ensure that I did all steps
> correct.
> 
> You could see that I commented out all the "langAST" and "treePsr"
> variables, because they didn't compile. Who creates the
> "pLangDumpDecl" and "LangParser_decl_return" type? I don't see it
> generated by the code generator. Do I need those for my example?
> 
> And the last question is why is it so hard to get the C target working
> comparing to the Java target? :-)
> 
> regards
> 	Andreas
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 

From jimi at temporal-wave.com  Sun Sep  6 07:45:22 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 06 Sep 2009 07:45:22 -0700
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090906094044.286696dc@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>
Message-ID: <4AA3CB02.9030903@temporal-wave.com>

Andreas Volz wrote:
> Hello,
>
> I tried some Java examples for ANTLR and it worked nice. But I need a
> parser for C (for later C++ usage). As easy it was to get a working
> Java example as hard is it to get a C example working.
>   
Well, the examples you are using are written for Java, you need to get 
an example that was written for C to work first, then you will see what 
you need to do to convert it to C.

Download the pre-done examples rather than the donated grammars.
> I've read this doc:
>
> http://www.antlr.org/api/C/index.html
>
> -> Generating Code for the C Target 
>
> I'm a little confused about this table:
>
> Suffix 	Grammar should contain...
> .g3l 	A lexer grammar specification only.
> .g3p 	A parser grammar specification only.
> .g3pl 	A combined lexer and parser specification.
> .g3t 	A tree grammar specification. 
>
> All examples I've seen contains only grammar.g files. Is this simply a
> new handling to split my grammar file?
>   
It is for cases where you need to know what is in the grammar file 
because your build tool isn't able to work it out. For instance GNU make 
can ask antlr what the output files are, others cannot. Hence it accepts 
those suffixes for build rules.
> How ever. I go with my grammar.g file that I've used for the Java
> example.
>
> VCard.g:
> http://codepad.org/hiVS9kte
>
> First question is if it's also possible to insert the main code for C
> in the grammar file like with Java?
>   
Yes, but you have to get everything correct of course and this is not a 
wise move for production code. Better to build a little project.
> Then I installed ANTLR-3.0.1 (Ubuntu) from repository and the C runtime
> from ANTLR-3.0.1 from source. This should fit together.
>   
That is way too old and is why I don't like all these bundled packages - 
nobody ever keeps them up to date and so it is OK for applications and 
so on but not so good for development tools. Download 3.1.3 or 3.1.4 
snapshot from the ANTLR download page.
> Now I took an C example and modified it to compile for my grammar. At
> first I compiled the grammar and got these files:
>
> VCardLexer.c
> VCardLexer.h
> VCardParser.c
> VCardParser.h
>
> I modified them from an example:
>
> VCard.c:
> http://codepad.org/uoMWeBW7
>
> VCard.h:
> http://codepad.org/ADTKm47X
>
> Makefile.C:
> http://codepad.org/YWC4E4ti
>
> This compiles, but I get a "Segmentation fault" as result. I've not yet
> debugged into it, because I like to ensure that I did all steps correct.
>   
It means that you are not invoking it correctly, but is probably because 
you are tying to use 3.0.1.
> You could see that I commented out all the "langAST" and "treePsr"
> variables, because they didn't compile. Who creates the "pLangDumpDecl"
> and "LangParser_decl_return" type? I don't see it generated by the code
> generator. Do I need those for my example?
>   
They are auto generated and are the return types for the rules, but if 
you have Java style declarations, then they are not going to compile as C.
> And the last question is why is it so hard to get the C target working
> comparing to the Java target? :-)
>   
1) Dealing with C is always going to be a little more raw than Java, 
though it is very much faster at runtime;
2) You are starting from the wrong place;
3) You need to read through the whole API doc, where it gives you 
example drivers;
4) You need to use the correct version of the tool;
5) You need to read through the C examples;


Jim

From jimi at temporal-wave.com  Sun Sep  6 07:53:02 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 06 Sep 2009 07:53:02 -0700
Subject: [antlr-interest] saving,
 duplicating and substituting tree nodes in the C API
In-Reply-To: <a2a61e1e0909060357y3731c4b2v7f7a182afb51f663@mail.gmail.com>
References: <a2a61e1e0909060357y3731c4b2v7f7a182afb51f663@mail.gmail.com>
Message-ID: <4AA3CCCE.6030007@temporal-wave.com>

David Minor wrote:
> I'm working on a language that allows assignment of functions to 
> variables.
> Something like this.
> fun = execute(params);
>
> Later in the same scope if I want to do.
> another_fun = fun
>
> The most natural way to do this
> seems to me to save the tree from the first execute(params) in a 
> symbol table
> and then, while generating the AST, when I see that "fun" is defined, 
> to substitute a duplicate of it's tree for the assignment to another_fun.
That doesn't sound like the correct way to do things to be honest, the 
AST is just the parsed elements and you probably need to do a lot more 
with these than just store them? Linguistically, that looks very 
confusing, you shoudl probably use a different operator than = :-)
>
> The trouble is the symbol table is in C world not Antlr.  It looks 
> like I could just duplicate the node save
> the pointer and then re-use it, but I don't see any examples of how to 
> do this.
>
> Does anyone have an idea?  Even a Java example would be helpful.
>
What are you trying to do/build? An interpreter? Basically, you should 
do as little as possible in the parser other than the basics such as 
build the symbol table if that is a a possibility (you know what all the 
types are while you are parsing etc). Generally, you would not want to 
duplicate the sub-tree for a symbol table but you can just reuse the 
pointer anyway as it is returned by the rule that parses your function. 
$rule.tree should do it I think.

Jim

From jimi at temporal-wave.com  Sun Sep  6 07:53:50 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 06 Sep 2009 07:53:50 -0700
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090906133657.374a33f9@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>
	<20090906133657.374a33f9@frodo.mittelerde>
Message-ID: <4AA3CCFE.40508@temporal-wave.com>

Andreas Volz wrote:
> Am Sun, 6 Sep 2009 09:40:44 +0200 schrieb Andreas Volz:
>
> Hello,
>
> I did an update that now runs without segfault. But it still doen't
> print out anything. Any ideas?
>   
Not without seeing what you have changed - start with the actual C examples.

Jim

From jimi at temporal-wave.com  Sun Sep  6 07:55:06 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 06 Sep 2009 07:55:06 -0700
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090906134758.379cf8a6@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>
	<20090906134758.379cf8a6@frodo.mittelerde>
Message-ID: <4AA3CD4A.3070003@temporal-wave.com>

Andreas Volz wrote:
> Am Sun, 6 Sep 2009 09:40:44 +0200 schrieb Andreas Volz:
>
> Hello,
>
> I found the problems. The segfault was forced by free the variable that
> I have not created for my example. Then after calling the correct
> parser entry point it works great.
>
> regards
If using Linux, learn to use valgrind (takes about 20 minutes) and 
kcachegrind.

Jim

From JOHN851 at yandex.ru  Sun Sep  6 09:59:26 2009
From: JOHN851 at yandex.ru (=?UTF-8?B?0J3QtdC/0L7QvdGP0YLQvdCwINCd0LXQuNC30LLQtdGB0YLQvg==?=)
Date: Sun, 06 Sep 2009 20:59:26 +0400
Subject: [antlr-interest] lexer's rule overlapping problem
Message-ID: <407891252256366@webmail85.yandex.ru>

Hello,

I would like to make my own translator but has faced with one problem - lexer's rules overlapping. I want to have two lexer rules like this:

ID 'a'..'z'+;
ENG 'a'..'z';

and

INT '0'..'9'+;
DIG '0'..'9;

I need it because it is necessary to catch input text errors while parsing.

The purpose of these lexer rules is demonstrated below:

word:
	'inputword' ':' (ENG|DIG) 'in' '['axsis']' ';'
	;
axis:  
  	INT (',' INT)*
	;

I have find only one solution of this problem

word:
	'inputword' ':' (ID|INT) 'in' '['axsis']' ';'
	;                 //^ it is important that here was placed only one character

and then find input errors (like this 123 in [1,2,3]) by the tree grammar

Thank you,
John

From s.barnett-cormack at lancaster.ac.uk  Sun Sep  6 10:19:36 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Sun, 06 Sep 2009 18:19:36 +0100
Subject: [antlr-interest] lexer's rule overlapping problem
In-Reply-To: <407891252256366@webmail85.yandex.ru>
References: <407891252256366@webmail85.yandex.ru>
Message-ID: <4AA3EF28.7060300@lancaster.ac.uk>

????????? ????????? wrote:
> Hello,
> 
> I would like to make my own translator but has faced with one problem - lexer's rules overlapping. I want to have two lexer rules like this:
> 
> ID 'a'..'z'+;
> ENG 'a'..'z';
> 
> and
> 
> INT '0'..'9'+;
> DIG '0'..'9;
...
> word:
> 	'inputword' ':' (ID|INT) 'in' '['axsis']' ';'
> 	;                 //^ it is important that here was placed only one character
> 
> and then find input errors (like this 123 in [1,2,3]) by the tree grammar

The problem with your thinking is that the lexing (dividing into tokens) 
all happens before the parser gets to see anything. Thus the lexer has 
no knowledge of the parse context (because there is no parse context 
yet), so when it sees

abcdef

It doesn't know whether it should be 6 ENG tokens or one ID token.

If you have a situation where you want to ensure a token is only one 
character long, you can (using predicates), but if you want to recognise 
123 as an INT in one context and three DIGs in another, you have a 
problem. One solution would be to make INT and ID into parser rules, int 
and id, formed as DIG+ and ENG+ respectively. That would leave a messy 
tree, though.

-- 
Sam Barnett-Cormack

From jimi at temporal-wave.com  Sun Sep  6 10:19:34 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 06 Sep 2009 10:19:34 -0700
Subject: [antlr-interest] lexer's rule overlapping problem
In-Reply-To: <407891252256366@webmail85.yandex.ru>
References: <407891252256366@webmail85.yandex.ru>
Message-ID: <4AA3EF26.4000809@temporal-wave.com>

????????? ????????? wrote:
> Hello,
>
> I would like to make my own translator but has faced with one problem - lexer's rules overlapping. I want to have two lexer rules like this:
>
> ID 'a'..'z'+;
> ENG 'a'..'z';
>
> and
>
> INT '0'..'9'+;
> DIG '0'..'9;
>
> I need it because it is necessary to catch input text errors while parsing.
>
> The purpose of these lexer rules is demonstrated below:
>
> word:
> 	'inputword' ':' (ENG|DIG) 'in' '['axsis']' ';'
> 	;
> axis:  
>   	INT (',' INT)*
> 	;
>
> I have find only one solution of this problem
>
> word:
> 	'inputword' ':' (ID|INT) 'in' '['axsis']' ';'
> 	;                 //^ it is important that here was placed only one character
>
> and then find input errors (like this 123 in [1,2,3]) by the tree grammar
>
> Thank you,
Read the getting started articles on the Wiki and if you can buy a copy 
of the ANTLR book. You cannot do what you are trying to do like that. 
Lexer tokens must be unique and their generation is not controlled by 
the parser. Besides which, the general rule is to delay error messages 
until as late as possible (so generally not the lexer). In this case, 
just accept any number of digits, then check the length of the token 
text matches for each side of your 'in' - if not then you can issue a 
much more useful error message about type mismatching or something similar.

Jim

From bkoprinarov at googlemail.com  Sun Sep  6 10:57:58 2009
From: bkoprinarov at googlemail.com (Boris Koprinarov)
Date: Sun, 6 Sep 2009 19:57:58 +0200
Subject: [antlr-interest] operator precedence and k=1
Message-ID: <403d8f5e0909061057w15911516u31d0ac1ff03601c8@mail.gmail.com>

Hi,

I am writing a tree grammar for Lua. In the language is defended operator
precedence. The table looks like this:

  or

  and

  <     >     <=    >=    ~=    ==

  ..

  +     -

  *     /     %

  not   #     - (unary)

And here are my rules:

exp

                :              logicalOrExpression;





// level 7 - " OR "

logicalOrExpression

                : logicalAndExpression ( 'or' logicalAndExpression )+
->^(BINOP logicalAndExpression( OR logicalAndExpression)+ )

                | logicalAndExpression;

// level 6 - " AND, NOT "



logicalAndExpression

                : likeExpression ( AND likeExpression )+ -> ^(BINOP
likeExpression (AND likeExpression)+)

                | likeExpression;



// level 5 - " <     >     <=    >=    ~=    == "



likeExpression

                :              conExpression (LESS conExpression)+ ->
^(BINOP conExpression (LESS conExpression)+)

                |             conExpression (MORE conExpression)+ -> ^(BINOP
conExpression (MORE conExpression)+)

                |             conExpression (LESSEQ conExpression)+ ->
^(BINOP conExpression (LESSEQ conExpression)+)

                |             conExpression (MOREEQ conExpression)+ ->
^(BINOP conExpression (MOREEQ conExpression)+)

                |             conExpression (NOTBINEQ conExpression)+ ->
^(BINOP conExpression (NOTBINEQ conExpression)+)

                |             conExpression (BINEQ conExpression)+ ->
^(BINOP conExpression (BINEQ conExpression)+)

                |             conExpression;



// level 6 - ".."

conExpression

                :              additiveExpression (BINEQ
additiveExpression)+ -> ^(BINOP additiveExpression (STRCON
additiveExpression)+)

                |             additiveExpression;



// level 7 - " + -"

additiveExpression

                :              multiplyExpression (ADD multiplyExpression)+
-> ^(BINOP_ADD multiplyExpression ( multiplyExpression)+)

                |             multiplyExpression (SUB multiplyExpression)+
-> ^(BINOP multiplyExpression (SUB multiplyExpression)+)

                |             multiplyExpression;

// level 8 - "*     /     % "

multiplyExpression

                :              unaryExpression (MUL unaryExpression)+ ->
^(BINOP unaryExpression (MUL unaryExpression)+)

                |             unaryExpression (DIV unaryExpression)+ ->
^(BINOP unaryExpression (DIV unaryExpression)+)

                |             unaryExpression (ABS unaryExpression)+ ->
^(BINOP unaryExpression (ABS unaryExpression)+)

                |             unaryExpression ;

// level 9 - unary operators "not   #     -"

unaryExpression

                :              ('not' powExpression)+ -> ^(UOP ^(UNOT
powExpression)+)

                |             (USUB powExpression)+ -> ^(UOP ^(UNOT
powExpression)+)

                |             (ULEN powExpression)+ -> ^(UOP ^(UNOT
powExpression)+)

                |             powExpression;

// level 10 - "^"

powExpression

                :              primaryExpression (POW primaryExpression)+ ->
^(BINOP primaryExpression (POW primaryExpression)+)

                |             primaryExpression;



When I build my parser I need the option k = 1 or my PC gets out of memory.
Is there a better and elegant way to solve this problem?

Regards

Boris Koprinarov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090906/dbf52c5f/attachment.html 

From jimi at temporal-wave.com  Sun Sep  6 11:45:18 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 06 Sep 2009 11:45:18 -0700
Subject: [antlr-interest] operator precedence and k=1
In-Reply-To: <403d8f5e0909061057w15911516u31d0ac1ff03601c8@mail.gmail.com>
References: <403d8f5e0909061057w15911516u31d0ac1ff03601c8@mail.gmail.com>
Message-ID: <4AA4033E.3060903@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090906/fbc6a4e5/attachment.html 

From christian.schladetsch at gmail.com  Sun Sep  6 22:10:11 2009
From: christian.schladetsch at gmail.com (Christian Schladetsch)
Date: Mon, 7 Sep 2009 17:10:11 +1200
Subject: [antlr-interest] HLSL ANTLR System
Message-ID: <6442c4ae0909062210o5eff69d5qab4fbda4b268fdaa@mail.gmail.com>

Hi All,

A while ago I asked about an ANTLR grammar for HLSL files. These are for
DirectX shaders.

I didn't get a response then, but I got around to writing one some time ago.
I thought it may be of interest to others, so for the record it is at
http://code.google.com/p/schladetsch/source/browse/trunk/Effects/Tools/EffectTranslator.
This includes the lexer, parser, AST walker and string-templates for
output.

If there is further interest, I can add the C# tool that parses a .fx file
to an AST then produces a .fx file via StringTemplates.

Cheers,
Christian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090907/89a5406d/attachment.html 

From craig at palantir.co.za  Mon Sep  7 01:07:18 2009
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Mon, 07 Sep 2009 10:07:18 +0200
Subject: [antlr-interest] stringtemplate 3.2 source code,
Message-ID: <20090907100718.ktpvim7u8so808kw@webmail.palantir.co.za>

Hi,

I note that an updated version of stringtemplate is available on the web site,
namely stringtemplate 3.2.

There are only binaries available?
Is the source code not currently available for that version, in which case I
must try the 3.1beta source?

Regards
Craig.

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From craig at palantir.co.za  Mon Sep  7 06:30:26 2009
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Mon, 07 Sep 2009 15:30:26 +0200
Subject: [antlr-interest] building 3.1.3.
Message-ID: <20090907153026.tpgf333lgkw048wg@webmail.palantir.co.za>

Hi,

I am trying to build my downloaded source.
I downloaded the antlr-3.1.3 source distribution from the web site.

>From the extracted antlr-3.1.3\tool directory...

Running mvn -N install,

I get the following error:
[INFO] Unable to find resource 'net.java.dev.jna:jna:pom:3.0.5' in repository
central (http://repo1.maven.org/maven2)

Trying other build targets like
mvn -Dmaven.test.skip=true package assembly:assembly gives me the same result.

Is this a problem anyone else has encountered?

Thanks
Regards

Craig.

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From kanaero at gmail.com  Mon Sep  7 08:09:41 2009
From: kanaero at gmail.com (Suresh Kannan)
Date: Mon, 7 Sep 2009 11:09:41 -0400
Subject: [antlr-interest] tree grammar template output using rule return
	object instead of just st
Message-ID: <2fc34dea0909070809p618afad1kf4c83545edcda797@mail.gmail.com>

I have parsed my code, built the AST and done semantic checks. I want
to generate a .h and .cpp file.  I have written a tree grammar that
describes my AST and as I walk it, I want the different rule elements to
generate different snippets of code which will be used by the calling
rule appropriately. This way I just have one grammar and I do not have
to have multiple flags figuring out where I am etc. Just return all
the code snippets and let the calling rule use what it desires.

In the code below the problem appears when collecting items as a list
i.e., classes={$c} when appending to list_c in the generated java code
it uses the default 'st' by way of getTemplate(). In my templates I
want to say something like <c:{<it>.hcode}>. Of course I cannot do
that. I wish the rule return object would be passed to the template
instead of the class_declaration_return.st; that way I can use any of
the rule return attributes such as hcode, ccode or st itself.

Am I wrong in thinking this way ? Should I set various combinations of
flags/scopes to generate the right snippet. Perhaps there is a canonical,
easy way to do this that I do not know about.

regards,
suresh.

tree grammar Gen;
options {
  tokenVocab = r;
  ASTLabelType = rAST;
  output=template;

}

file returns [StringTemplate hcode, StringTemplate ccode]
   :  (c+=class_declaration)+
   {
      $hcode = %h_file(classes={$c});
      $ccode = %c_file(classes={$c});
   }
   ;

class_declaration returns [StringTemplate hcode, StringTemplate ccode]
        :       ^('class' name=ID (^('extends' sup=ID))? ^(MEMBERS m+=member*))
   {
      $hcode = %class_declaration(name={$name.text},sup={$sup.text});
      $ccode = %class_definition(name={$name.text},sup={$sup.text});
   }
;

From misc7 at emerose.org  Mon Sep  7 08:18:07 2009
From: misc7 at emerose.org (Ben)
Date: Mon, 7 Sep 2009 10:18:07 -0500
Subject: [antlr-interest] Quick intro to Python backend
Message-ID: <20090907101807.84b626ea.misc7@emerose.org>

Hi all, I'm trying to use the Python backend.  I wanted to start with something simple and I didn't see an example like this either in Parr's book or on the wiki.

So, suppose I just want to recognize a string with (uppercase) letters and numbers separated by a dot.  The parse function needs to return the letters and numbers separately, or else the value None if the expression doesn't parse.  Below are how it might be done with regular expressions, and how I've tried to do it with ANTLR3 using the AST generator.

============== Regular expression example
import re

def parse(s):
    """Parse string s and return pair [letters, numbers]"""
    m = re.match("([A-Z]+)\\.([0-9]+)$", s)
    return (m.group(1), m.group(2)) if m else None

============== My ANTLR attempt: Example.g
grammar Example;

options {
	language=Python;
	output=AST;
	ASTLabelType=CommonTree;
}

@lexer::members {
def reportError(self, e):
   raise e
}
@members {
def mismatch(self, input, ttype, follow):
    raise MismatchedTokenException(ttype, input)

def recoverFromMismatchedSet(self, input, e, follow):
    raise e
}
@rulecatch {
except RecognitionException, e:
    raise
}

expr	:	LETTERS '.' NUMBERS EOF -> LETTERS NUMBERS;

LETTERS	:	'A'..'Z'+ ;

NUMBERS	:	'0'..'9'+;

============== My ANTLR attempt: example.py

import StringIO
import antlr3
import ExampleLexer, ExampleParser

def parse(s):
    """Parse string s and return pair [letters, numbers]"""
    stringio = StringIO.StringIO(s)
    char_stream = antlr3.ANTLRInputStream(stringio)
    lexer = ExampleLexer.ExampleLexer(char_stream)
    tokens = antlr3.CommonTokenStream(lexer)
    parser = ExampleParser.ExampleParser(tokens)
    try: expr = parser.expr()
    except antlr3.RecognitionException: return None
    return tuple(child.text for child in expr.tree.getChildren())

============== End code

So first, do I have the right basic idea here?  It seems to be getting pretty complicated and already into some undocumented stuff for a simple example.

Second, this example still doesn't really work, because it still matches strings like "3452EOUSNTHO.32423AOE" that it shouldn't.  Also, this solution is hard to package because the modules in the antlr3 runtime refer to other antlr3 modules like "antlr3.streams" instead of just "streams" so I have to start messing with python's module path.  How can I fix this?

Thanks for any advise,
-- 
Ben


From dahvid.minor at gmail.com  Mon Sep  7 10:14:06 2009
From: dahvid.minor at gmail.com (David Minor)
Date: Mon, 7 Sep 2009 20:14:06 +0300
Subject: [antlr-interest] saving,
	duplicating and substituting tree nodes 	in the C API
In-Reply-To: <4AA3CCCE.6030007@temporal-wave.com>
References: <a2a61e1e0909060357y3731c4b2v7f7a182afb51f663@mail.gmail.com>
	<4AA3CCCE.6030007@temporal-wave.com>
Message-ID: <a2a61e1e0909071014r2187f86fo58d08ccbffa9e097@mail.gmail.com>

Hi Jim,
What is the right way to do it?  I can save the $rule.tree but when I
encounter the already bound variable, which will be in another expression,
how do I substitute $rule.tree for it? That's the question, it will
definitely be in a symbol table at any rate.

in semi-psuedo code:

bound_function :


On Sun, Sep 6, 2009 at 5:53 PM, Jim Idle <jimi at temporal-wave.com> wrote:

> David Minor wrote:
> > I'm working on a language that allows assignment of functions to
> > variables.
> > Something like this.
> > fun = execute(params);
> >
> > Later in the same scope if I want to do.
> > another_fun = fun
> >
> > The most natural way to do this
> > seems to me to save the tree from the first execute(params) in a
> > symbol table
> > and then, while generating the AST, when I see that "fun" is defined,
> > to substitute a duplicate of it's tree for the assignment to another_fun.
> That doesn't sound like the correct way to do things to be honest, the
> AST is just the parsed elements and you probably need to do a lot more
> with these than just store them? Linguistically, that looks very
> confusing, you shoudl probably use a different operator than = :-)
> >
> > The trouble is the symbol table is in C world not Antlr.  It looks
> > like I could just duplicate the node save
> > the pointer and then re-use it, but I don't see any examples of how to
> > do this.
> >
> > Does anyone have an idea?  Even a Java example would be helpful.
> >
> What are you trying to do/build? An interpreter? Basically, you should
> do as little as possible in the parser other than the basics such as
> build the symbol table if that is a a possibility (you know what all the
> types are while you are parsing etc). Generally, you would not want to
> duplicate the sub-tree for a symbol table but you can just reuse the
> pointer anyway as it is returned by the rule that parses your function.
> $rule.tree should do it I think.
>
> Jim
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090907/71139352/attachment.html 

From dahvid.minor at gmail.com  Mon Sep  7 10:18:58 2009
From: dahvid.minor at gmail.com (David Minor)
Date: Mon, 7 Sep 2009 20:18:58 +0300
Subject: [antlr-interest] saving,
	duplicating and substituting tree nodes 	in the C API
In-Reply-To: <a2a61e1e0909071014r2187f86fo58d08ccbffa9e097@mail.gmail.com>
References: <a2a61e1e0909060357y3731c4b2v7f7a182afb51f663@mail.gmail.com>
	<4AA3CCCE.6030007@temporal-wave.com>
	<a2a61e1e0909071014r2187f86fo58d08ccbffa9e097@mail.gmail.com>
Message-ID: <a2a61e1e0909071018w749a09e8nf0142a82a3b23323@mail.gmail.com>

Sorry pressed the return at the wrong time,
to resume.


in semi-psuedo code:

bound_function :
     IDENTIFIER
{
      //do look up
     some_tree_type treed = symbol_table[$IDENTIFIER];
     if (treed) {
        ???how do I swallow IDENTIFIER and generate $treed to the AST?
     }

}

On Mon, Sep 7, 2009 at 8:14 PM, David Minor <dahvid.minor at gmail.com> wrote:

> Hi Jim,
> What is the right way to do it?  I can save the $rule.tree but when I
> encounter the already bound variable, which will be in another expression,
> how do I substitute $rule.tree for it? That's the question, it will
> definitely be in a symbol table at any rate.
>
> in semi-psuedo code:
>
> bound_function :
>
>
>
> On Sun, Sep 6, 2009 at 5:53 PM, Jim Idle <jimi at temporal-wave.com> wrote:
>
>> David Minor wrote:
>> > I'm working on a language that allows assignment of functions to
>> > variables.
>> > Something like this.
>> > fun = execute(params);
>> >
>> > Later in the same scope if I want to do.
>> > another_fun = fun
>> >
>> > The most natural way to do this
>> > seems to me to save the tree from the first execute(params) in a
>> > symbol table
>> > and then, while generating the AST, when I see that "fun" is defined,
>> > to substitute a duplicate of it's tree for the assignment to
>> another_fun.
>> That doesn't sound like the correct way to do things to be honest, the
>> AST is just the parsed elements and you probably need to do a lot more
>> with these than just store them? Linguistically, that looks very
>> confusing, you shoudl probably use a different operator than = :-)
>> >
>> > The trouble is the symbol table is in C world not Antlr.  It looks
>> > like I could just duplicate the node save
>> > the pointer and then re-use it, but I don't see any examples of how to
>> > do this.
>> >
>> > Does anyone have an idea?  Even a Java example would be helpful.
>> >
>> What are you trying to do/build? An interpreter? Basically, you should
>> do as little as possible in the parser other than the basics such as
>> build the symbol table if that is a a possibility (you know what all the
>> types are while you are parsing etc). Generally, you would not want to
>> duplicate the sub-tree for a symbol table but you can just reuse the
>> pointer anyway as it is returned by the rule that parses your function.
>> $rule.tree should do it I think.
>>
>> Jim
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090907/3551da51/attachment.html 

From s.barnett-cormack at lancaster.ac.uk  Mon Sep  7 10:31:10 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Mon, 07 Sep 2009 18:31:10 +0100
Subject: [antlr-interest] Matching fragments
Message-ID: <4AA5435E.8070403@lancaster.ac.uk>

Hi all,

Now, I know that there's no difference between the rule one wants to be 
start rule and any other - you can call any of them as a function to 
parse a token stream.

However, it's usual to put EOF at the end of the start rule, so it makes 
sure it matches the whole file. However, I'm doing some delayed parsing 
of certain constructs (as detectable context cannot determine manner of 
parsing, but using ANTLR should be easier than hand-coding a parser for 
these token sequences), and I store a list of tokens and have written a 
wrapper to make them a token stream. However, the rules I'll pass them 
to won't match EOF.

It strikes me that all I need to do is make the token stream wrapper 
*not* return an EOF. However, the docs seem to specify that it *should* 
return an EOF. How, practically or ideally, should I resolve this?

-- 
Sam Barnett-Cormack

From martijn.reuvers at gmail.com  Mon Sep  7 11:46:22 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Mon, 7 Sep 2009 20:46:22 +0200
Subject: [antlr-interest] Quick intro to Python backend
In-Reply-To: <20090907101807.84b626ea.misc7@emerose.org>
References: <20090907101807.84b626ea.misc7@emerose.org>
Message-ID: <c376e6ec0909071146q589a1107k1fcab29b597a49f5@mail.gmail.com>

Hi Ben,

I can't help you with the Python part, but below is a quick & dirty
grammar for Java which more or less does do what you want.

Most likely your errors will come from the lexer, hence I throw the
exception there to show you. So in your python program catching that
should tell you it was wrong. The rest of the grammar fills a list
with text or numbers that are parsed, and prints it in the @after of
begin rule (which is only there so a quick printout was possible).

Martijn


grammar test001;

@lexer::members {

  @Override
	public void reportError(RecognitionException e) {
		throw new RuntimeException(e);
	}

}

@members {

	java.util.List result = new java.util.ArrayList();

	public List getResult() {
		return result;
	}
}

begin
@after {
	System.out.println("RESULT=" + result);
}
	:	expr
	;


expr
	:	what (DOT expr)?
	;
	
what
	:	TEXT
		{
			if($TEXT.text != null) {
				result.add($TEXT.text);
			}		
		}
	| NUMBER
		{
			if($NUMBER.text != null) {
				result.add($NUMBER.text);
			}
		}
	;	

DOT
	:	'.'
	;

TEXT
	: 'A'..'Z'+
  ;

NUMBER
	:	'0'..'9'+
	;

WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        ) {$channel=HIDDEN;}
    ;


On Mon, Sep 7, 2009 at 5:18 PM, Ben<misc7 at emerose.org> wrote:
> Hi all, I'm trying to use the Python backend. ?I wanted to start with something simple and I didn't see an example like this either in Parr's book or on the wiki.
>
> So, suppose I just want to recognize a string with (uppercase) letters and numbers separated by a dot. ?The parse function needs to return the letters and numbers separately, or else the value None if the expression doesn't parse. ?Below are how it might be done with regular expressions, and how I've tried to do it with ANTLR3 using the AST generator.
>
> ============== Regular expression example
> import re
>
> def parse(s):
> ? ?"""Parse string s and return pair [letters, numbers]"""
> ? ?m = re.match("([A-Z]+)\\.([0-9]+)$", s)
> ? ?return (m.group(1), m.group(2)) if m else None
>
> ============== My ANTLR attempt: Example.g
> grammar Example;
>
> options {
> ? ? ? ?language=Python;
> ? ? ? ?output=AST;
> ? ? ? ?ASTLabelType=CommonTree;
> }
>
> @lexer::members {
> def reportError(self, e):
> ? raise e
> }
> @members {
> def mismatch(self, input, ttype, follow):
> ? ?raise MismatchedTokenException(ttype, input)
>
> def recoverFromMismatchedSet(self, input, e, follow):
> ? ?raise e
> }
> @rulecatch {
> except RecognitionException, e:
> ? ?raise
> }
>
> expr ? ?: ? ? ? LETTERS '.' NUMBERS EOF -> LETTERS NUMBERS;
>
> LETTERS : ? ? ? 'A'..'Z'+ ;
>
> NUMBERS : ? ? ? '0'..'9'+;
>
> ============== My ANTLR attempt: example.py
>
> import StringIO
> import antlr3
> import ExampleLexer, ExampleParser
>
> def parse(s):
> ? ?"""Parse string s and return pair [letters, numbers]"""
> ? ?stringio = StringIO.StringIO(s)
> ? ?char_stream = antlr3.ANTLRInputStream(stringio)
> ? ?lexer = ExampleLexer.ExampleLexer(char_stream)
> ? ?tokens = antlr3.CommonTokenStream(lexer)
> ? ?parser = ExampleParser.ExampleParser(tokens)
> ? ?try: expr = parser.expr()
> ? ?except antlr3.RecognitionException: return None
> ? ?return tuple(child.text for child in expr.tree.getChildren())
>
> ============== End code
>
> So first, do I have the right basic idea here? ?It seems to be getting pretty complicated and already into some undocumented stuff for a simple example.
>
> Second, this example still doesn't really work, because it still matches strings like "3452EOUSNTHO.32423AOE" that it shouldn't. ?Also, this solution is hard to package because the modules in the antlr3 runtime refer to other antlr3 modules like "antlr3.streams" instead of just "streams" so I have to start messing with python's module path. ?How can I fix this?
>
> Thanks for any advise,
> --
> Ben
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From antlr at mirality.co.nz  Mon Sep  7 13:18:07 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 08 Sep 2009 08:18:07 +1200
Subject: [antlr-interest] Matching fragments
In-Reply-To: <4AA5435E.8070403@lancaster.ac.uk>
References: <4AA5435E.8070403@lancaster.ac.uk>
Message-ID: <20090907201834.3140C341840C@www.antlr.org>

At 05:31 8/09/2009, Sam Barnett-Cormack wrote:
 >However, the rules I'll pass them to won't match EOF.
 >
 >It strikes me that all I need to do is make the token stream
 >wrapper *not* return an EOF. However, the docs seem to specify
 >that it *should* return an EOF. How, practically or ideally,
 >should I resolve this?

Your custom streams should return an EOF when they run out of 
input.  It doesn't really matter (from this perspective) whether 
or not the rule being invoked is expecting an EOF; by default 
rules are not required to consume all input.  (Adding EOF matching 
to a rule is the main way of requesting that a rule *should* try 
to consume all input.)


From s.barnett-cormack at lancaster.ac.uk  Mon Sep  7 13:45:53 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Mon, 07 Sep 2009 21:45:53 +0100
Subject: [antlr-interest] Matching fragments
In-Reply-To: <4AA5435E.8070403@lancaster.ac.uk> 
References: <4AA5435E.8070403@lancaster.ac.uk> 
Message-ID: <4AA57101.2030201@lancaster.ac.uk>

Gavin Lambert wrote:
> At 05:31 8/09/2009, Sam Barnett-Cormack wrote:
>  >However, the rules I'll pass them to won't match EOF.
>  >
>  >It strikes me that all I need to do is make the token stream
>  >wrapper *not* return an EOF. However, the docs seem to specify
>  >that it *should* return an EOF. How, practically or ideally,
>  >should I resolve this?
> 
> Your custom streams should return an EOF when they run out of input.  It 
> doesn't really matter (from this perspective) whether or not the rule 
> being invoked is expecting an EOF; by default rules are not required to 
> consume all input.  (Adding EOF matching to a rule is the main way of 
> requesting that a rule *should* try to consume all input.)

Huzzah, that's good, I don't need to write anything odd. My custom 
stream currently sends the EOF, as that's what the docs seemed to say to do.

-- 
Sam Barnett-Cormack

From David.Weiler-Thiessen at purina.nestle.com  Mon Sep  7 15:33:40 2009
From: David.Weiler-Thiessen at purina.nestle.com (Weiler-Thiessen, David, SASKATOON,
	Engineering)
Date: Mon, 7 Sep 2009 17:33:40 -0500
Subject: [antlr-interest] How to handle Quoted Strings?
Message-ID: <1350B466C5B0E3488F9354A9DFECF5DB041952DA@USSTLE0004.nestle.com>

> Hi 
> 
> I am having trouble adding Lexer/Parser rules to a grammar that will deal with quoted strings.
> 
> A phrase I would like to parse is:
> 
> create register FAULT_CODE initial value '301'
> 
> I am having trouble with the quoted string '301'.  When I build my AST, I would like to have just the inner value, 301 passed, but when I tried to get the text in my tree grammar, I get the full token with quotes, i.e. '301'.
> 
> This is a portion of my Parser/Lexer grammar where I am trying to define this.
> 
> stringValue
> 	:	SINGLE_QUOTE! (~SINGLE_QUOTE|BACK_SLASH SINGLE_QUOTE)* SINGLE_QUOTE!
> 	;
> 
> SINGLE_QUOTE
> 	:	'\''
> 	;
> 
> BACK_SLASH
> 	:	'\\'
> 	;
> 
> Everything works until I get into my Tree Grammar, and when I request the text of the stringValue rule, I get the leading and trailing quotes, even though there are not passed through to the Tree Grammar.
> 
> What am I doing wrong?  Is there a best practice for dealing with quoted strings, and being able to escaped embedded quotes?
> 
> David Weiler-Thiessen
> Nestl? Purina PetCare
> phone: 306-933-0232
> cell: 306-291-9770
> 
> This e-mail, its electronic document attachments, and the contents of its website linkages may contain confidential information.  This information is intended solely for use by the individual or entity to whom it is addressed.  If you have received this information in error, please notify the sender immediately and promptly destroy the material and any accompanying attachments from your system.
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090907/c49d83ee/attachment.html 

From david-sarah at jacaranda.org  Mon Sep  7 15:43:06 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Mon, 07 Sep 2009 23:43:06 +0100
Subject: [antlr-interest] Matching fragments
In-Reply-To: <4AA5435E.8070403@lancaster.ac.uk>
References: <4AA5435E.8070403@lancaster.ac.uk>
Message-ID: <4AA58C7A.6040602@jacaranda.org>

Sam Barnett-Cormack wrote:
> Hi all,
> 
> Now, I know that there's no difference between the rule one wants to be 
> start rule and any other - you can call any of them as a function to 
> parse a token stream.
> 
> However, it's usual to put EOF at the end of the start rule, so it makes 
> sure it matches the whole file. However, I'm doing some delayed parsing 
> of certain constructs (as detectable context cannot determine manner of 
> parsing, but using ANTLR should be easier than hand-coding a parser for 
> these token sequences), and I store a list of tokens and have written a 
> wrapper to make them a token stream. However, the rules I'll pass them 
> to won't match EOF.

You can match EOF in the code that calls the rule, not the rule itself,
for example:

  parser.myRule();
  parser.eof();

where "eof : EOF;" is a parser rule.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Mon Sep  7 17:28:12 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 07 Sep 2009 17:28:12 -0700
Subject: [antlr-interest] How to handle Quoted Strings?
In-Reply-To: <1350B466C5B0E3488F9354A9DFECF5DB041952DA@USSTLE0004.nestle.com>
References: <1350B466C5B0E3488F9354A9DFECF5DB041952DA@USSTLE0004.nestle.com>
Message-ID: <4AA5A51C.5030702@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090907/48bedb79/attachment.html 

From misc7 at emerose.org  Mon Sep  7 18:31:03 2009
From: misc7 at emerose.org (Ben)
Date: Mon, 7 Sep 2009 20:31:03 -0500
Subject: [antlr-interest] Quick intro to Python backend
In-Reply-To: <c376e6ec0909071146q589a1107k1fcab29b597a49f5@mail.gmail.com>
References: <20090907101807.84b626ea.misc7@emerose.org>
	<c376e6ec0909071146q589a1107k1fcab29b597a49f5@mail.gmail.com>
Message-ID: <20090907203103.c2c2677a.misc7@emerose.org>

Thanks Martijn,

I think I tried to do what you did by overriding lexer::members, and members (and rulecatch) but I think I may be doing it wrong.  Once difference though is that I'm trying to encapsulate the ANTLR code as much as possible---it's not very convenient to write Python inside AntlrWorks, and I've read that the Python runtime is subject to change so I want to use the recommended methods.  So I think this may be more of a Python-specific issue.

-- 
Ben Escoto

----------------- Original message -----------------
From: Martijn Reuvers <martijn.reuvers at gmail.com>
To: Ben <misc7 at emerose.org>
Date: Mon, 7 Sep 2009 20:46:22 +0200
Hi Ben,

I can't help you with the Python part, but below is a quick & dirty
grammar for Java which more or less does do what you want.

Most likely your errors will come from the lexer, hence I throw the
exception there to show you. So in your python program catching that
should tell you it was wrong. The rest of the grammar fills a list
with text or numbers that are parsed, and prints it in the @after of
begin rule (which is only there so a quick printout was possible).

Martijn


grammar test001;

@lexer::members {

  @Override
	public void reportError(RecognitionException e) {
		throw new RuntimeException(e);
	}

}

@members {

	java.util.List result = new java.util.ArrayList();

	public List getResult() {
		return result;
	}
}

begin
@after {
	System.out.println("RESULT=" + result);
}
	:	expr
	;


expr
	:	what (DOT expr)?
	;
	
what
	:	TEXT
		{
			if($TEXT.text != null) {
				result.add($TEXT.text);
			}		
		}
	| NUMBER
		{
			if($NUMBER.text != null) {
				result.add($NUMBER.text);
			}
		}
	;	

DOT
	:	'.'
	;

TEXT
	: 'A'..'Z'+
  ;

NUMBER
	:	'0'..'9'+
	;

WS  :   ( ' '
        | '\t'
        | '\r'
        | '\n'
        ) {$channel=HIDDEN;}
    ;


From christian.schladetsch at gmail.com  Mon Sep  7 21:24:56 2009
From: christian.schladetsch at gmail.com (Christian Schladetsch)
Date: Tue, 8 Sep 2009 16:24:56 +1200
Subject: [antlr-interest]  HLSL Parser
Message-ID: <6442c4ae0909072124m66fa4585u42811b629e29714b@mail.gmail.com>

Hi All,

A while ago I asked about an ANTLR grammar for HLSL files. These are for
DirectX shaders.

I didn't get a response then, and got around to writing one some time ago. I
thought it may be of interest to others, so for the record it is at
http://code.google.com/p/schladetsch/source/browse/trunk/Effects/Tools/EffectTranslator.
This includes the lexer, parser, AST walker and string-templates for
output.

If there is further interest, I can add the C# tool that parses a .fx file
to an AST then produces a .fx file via StringTemplates.

Cheers,
Christian

PS. Apologies if you get this twice.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/20af6b85/attachment.html 

From sylvain_gregory at bah.com  Tue Sep  8 04:49:12 2009
From: sylvain_gregory at bah.com (Sylvain, Gregory [USA])
Date: Tue, 8 Sep 2009 07:49:12 -0400
Subject: [antlr-interest] Q: Matching literals in the parser or Lexer,
	which is better ????
Message-ID: <A529CD893DE9BE4F8C753EA29B97527C0B058186@ASHBMBX03.resource.ds.bah.com>

Hello all,

Looking for information about best practice, performance and reasoning with respect to using literals in the parser verses using tokens in the parser.   For example, if you know you will have a phrase of the language you are trying to parse begin with 'CONTENT/', which is better:

Variation A:

r    : 'CONTENT/' <rest> ;


Variation B:

r    : CONTENT_TOK <rest> ;

CONTENT_TOK    : 'CONTENT/' ;

Matching the literal in the parser rule, or creating a TOKEN in the lexer and matching the token in the parser?


Thanks in advance for you feedback.

Greg

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/343880e5/attachment.html 

From stephanie.balzer at gmail.com  Tue Sep  8 05:33:00 2009
From: stephanie.balzer at gmail.com (Stephanie Balzer)
Date: Tue, 8 Sep 2009 14:33:00 +0200
Subject: [antlr-interest] MismatchedTokenException due to rule reference in
	rewriting rule
Message-ID: <61bdac940909080533y722b991el26bfc139f644cddd@mail.gmail.com>

Hi all,
In my programming language, I support mathematical set operators such as
union, intersection, cartesian product, etc. To conform with mathematics, I
assign the same precedence and associativity to those operators as defined
in mathematics.

The production dealing with sets therefore looks like:

setExpression
: ( arithmeticExpression -> arithmeticExpression )
 (
(  'cartesianProduct' leftRightChild=arithmeticExpression -> ^(
'cartesianProduct' $setExpression $leftRightChild ) )
 (
'cartesianProduct' rightRightChild=arithmeticExpression
-> ^( 'cartesianProduct' $setExpression $rightRightChild )
 )*
| (  'composition' leftRightChild=arithmeticExpression -> ^( 'composition'
$setExpression $leftRightChild ) )
 (
'composition' rightRightChild=arithmeticExpression
-> ^( 'composition' $setExpression $rightRightChild )
 )*
| (  'union' leftRightChild=arithmeticExpression -> ^( 'union'
$setExpression $leftRightChild ) )
 (
'union' rightRightChild=arithmeticExpression
-> ^( 'union' $setExpression $rightRightChild )
 )*
| (  'intersection' leftRightChild=arithmeticExpression -> ^( 'intersection'
$setExpression $leftRightChild ) )
 (
'intersection' rightRightChild=arithmeticExpression
-> ^( 'intersection' $setExpression $rightRightChild )
 )*
( 'difference' rightestChild=arithmeticExpression )?
-> ^( 'difference' $setExpression $rightestChild )
 )?
 ;

arithmeticExpression
: multiplicativeExpression ( ( '+'^ | '-'^ ) multiplicativeExpression )*
 ;
....

primaryExpression
        :       ....
        |       '(' expression ')'


Above rule setExpression seems probably quite complex, but it enforces the
required associativity (and without generating a non-LL(*) decision error).
It guarantees in particular that none of the operators (except for
intersection and difference) can be mixed with each other without using
parentheses (i.e., "(A union B) intersection C" instead "A union B
intersection C") and that cartesianProduct, composition, union, and
intersection are associative (i.e., A union B union C is fine). Note further
that I make use of rule references $setExpression in the rewriting rules to
build the AST in a left-associative manner.

The grammar and tree construction works as intended for expressions like:

A intersection B intersection C difference D

Unfortunately, I get a MissmatchedToken exception as soon as I parenthesize
subsets. I.e., in the example

(A union B) difference C

the exception occurs on seeing 'difference'.

When I run the expression in the ANTLRWorks debugger, I can see that ANTLR
tries to match a parenthesized expression rather than the whole set
expression.

On the other hand, if I drop associativity and request a programmer to
always parenthesize and thus change the rule setExpression to:

setExpression
: arithmeticExpression ( ('cartesianProduct'^ |  'composition'^ |  'union'^
| 'intersection'^ | 'difference' ^) arithmeticExpression)?
;

I can successfully parse the expression (A union B) difference C.

Is there a bug in my rule for setExpression or the rewriting rule? Any ideas
what could be the problem?

Thanks a lot for your help!

Stephanie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/d6256250/attachment.html 

From jimi at temporal-wave.com  Tue Sep  8 09:35:07 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 08 Sep 2009 09:35:07 -0700
Subject: [antlr-interest] Q: Matching literals in the parser or Lexer,
 which is better ????
In-Reply-To: <A529CD893DE9BE4F8C753EA29B97527C0B058186@ASHBMBX03.resource.ds.bah.com>
References: <A529CD893DE9BE4F8C753EA29B97527C0B058186@ASHBMBX03.resource.ds.bah.com>
Message-ID: <4AA687BB.1040602@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/44dae6f4/attachment.html 

From jimi at temporal-wave.com  Tue Sep  8 09:46:03 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 08 Sep 2009 09:46:03 -0700
Subject: [antlr-interest] MismatchedTokenException due to rule reference
 in	rewriting rule
In-Reply-To: <61bdac940909080533y722b991el26bfc139f644cddd@mail.gmail.com>
References: <61bdac940909080533y722b991el26bfc139f644cddd@mail.gmail.com>
Message-ID: <4AA68A4B.3080308@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/e440eac5/attachment.html 

From stephanie.balzer at gmail.com  Tue Sep  8 10:34:24 2009
From: stephanie.balzer at gmail.com (Stephanie Balzer)
Date: Tue, 8 Sep 2009 19:34:24 +0200
Subject: [antlr-interest] MismatchedTokenException due to rule reference
	in rewriting rule
In-Reply-To: <4AA68A4B.3080308@temporal-wave.com>
References: <61bdac940909080533y722b991el26bfc139f644cddd@mail.gmail.com>
	<4AA68A4B.3080308@temporal-wave.com>
Message-ID: <61bdac940909081034v6cc3ca66o2d9beb94dfe8ef66@mail.gmail.com>

Hi Jim!
Thanks a lot for your help!

On Tue, Sep 8, 2009 at 6:46 PM, Jim Idle <jimi at temporal-wave.com> wrote:

>  Stephanie Balzer wrote:
>
> Hi all,
>  In my programming language, I support mathematical set operators such as
> union, intersection, cartesian product, etc. To conform with mathematics, I
> assign the same precedence and associativity to those operators as defined
> in mathematics.
>
>  The production dealing with sets therefore looks like:
>
>  setExpression
>  : ( arithmeticExpression -> arithmeticExpression )
>  (
>  (  'cartesianProduct' leftRightChild=arithmeticExpression -> ^(
> 'cartesianProduct' $setExpression $leftRightChild ) )
>  (
>  'cartesianProduct' rightRightChild=arithmeticExpression
>  -> ^( 'cartesianProduct' $setExpression $rightRightChild )
>  )*
>  | (  'composition' leftRightChild=arithmeticExpression -> ^(
> 'composition' $setExpression $leftRightChild ) )
>  (
>  'composition' rightRightChild=arithmeticExpression
>  -> ^( 'composition' $setExpression $rightRightChild )
>  )*
>  | (  'union' leftRightChild=arithmeticExpression -> ^( 'union'
> $setExpression $leftRightChild ) )
>  (
>  'union' rightRightChild=arithmeticExpression
>  -> ^( 'union' $setExpression $rightRightChild )
>  )*
>  | (  'intersection' leftRightChild=arithmeticExpression -> ^(
> 'intersection' $setExpression $leftRightChild ) )
>  (
>  'intersection' rightRightChild=arithmeticExpression
>  -> ^( 'intersection' $setExpression $rightRightChild )
>  )*
>  ( 'difference' rightestChild=arithmeticExpression )?
>  -> ^( 'difference' $setExpression $rightestChild )
>  )?
>   ;
>
>  arithmeticExpression
>  : multiplicativeExpression ( ( '+'^ | '-'^ ) multiplicativeExpression )*
>  ;
>  ....
>
>  primaryExpression
>         :       ....
>         |       '(' expression ')'
>
>
>  Above rule setExpression seems probably quite complex, but it enforces
> the required associativity (and without generating a non-LL(*) decision
> error). It guarantees in particular that none of the operators (except for
> intersection and difference) can be mixed with each other without using
> parentheses (i.e., "(A union B) intersection C" instead "A union B
> intersection C") and that cartesianProduct, composition, union, and
> intersection are associative (i.e., A union B union C is fine). Note further
> that I make use of rule references $setExpression in the rewriting rules to
> build the AST in a left-associative manner.
>
>  The grammar and tree construction works as intended for expressions like:
>
>  A intersection B intersection C difference D
>
>  Unfortunately, I get a MissmatchedToken exception as soon as I
> parenthesize subsets. I.e., in the example
>
>  (A union B) difference C
>
>  the exception occurs on seeing 'difference'.
>
>  When I run the expression in the ANTLRWorks debugger, I can see that
> ANTLR tries to match a parenthesized expression rather than the whole set
> expression.
>
>  On the other hand, if I drop associativity and request a programmer to
> always parenthesize and thus change the rule setExpression to:
>
>  setExpression
>  : arithmeticExpression ( ('cartesianProduct'^ |  'composition'^ |
>  'union'^ | 'intersection'^ | 'difference' ^) arithmeticExpression)?
>  ;
>
>  I can successfully parse the expression (A union B) difference C.
>
>  Is there a bug in my rule for setExpression or the rewriting rule? Any
> ideas what could be the problem?
>
>
> The bug is in your setExpression if the syntax you show is meant to be
> valid. Upon seeing the '(', the rule will take arithmeticExpression and
> resolve a parenthesized expression. Now your rule can only take the the
> keywords OTHER than 'difference' here and so throws a syntax error. Perhaps
> you meant to have an | operator before the 'difference' keyword? Check the
> syntax drawing in ANTLR works and you will see what I mean - as you have it,
> 'difference' can only follow one or more 'intersections'.
>

Oops, now I can see the problem. I fixed it (i.e., added another alternative
to allow difference to follow a arithmeticExpression) I can now successfully
parse (A union B) difference C.

>
> Some other tips:
>
>  - Do you need such verbose operators as 'difference' ?
>  - Take out these literals and make them lexer tokens - if you change your
> mind, you will only need to change the lexer token definition, not the
> grammar, when you come to add error reporting, you will find it a lot easier
> to deal with an integer called DIFFERENCE than you will T24.
>

Thanks for the hint, I will do that.

Stephanie
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/e7180535/attachment.html 

From martijn.reuvers at gmail.com  Tue Sep  8 11:18:06 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Tue, 8 Sep 2009 20:18:06 +0200
Subject: [antlr-interest] Quick intro to Python backend
In-Reply-To: <20090907203103.c2c2677a.misc7@emerose.org>
References: <20090907101807.84b626ea.misc7@emerose.org>
	<c376e6ec0909071146q589a1107k1fcab29b597a49f5@mail.gmail.com>
	<20090907203103.c2c2677a.misc7@emerose.org>
Message-ID: <c376e6ec0909081118v582b5d6csd0ea5169e8419367@mail.gmail.com>

Yeah you should try to use as less as target-language code as possible
in your grammars to keep them readable and maintainable I think. But
still actions { } are generally needed to drive the code but these
could call to support-type of constructs e.g.. This was only a quick
and dirty example, but it did match your described expressions. =)
getResult() could actually be called on the parser to return the
result instead of printing it.

On Tue, Sep 8, 2009 at 3:31 AM, Ben<misc7 at emerose.org> wrote:
> Thanks Martijn,
>
> I think I tried to do what you did by overriding lexer::members, and members (and rulecatch) but I think I may be doing it wrong. ?Once difference though is that I'm trying to encapsulate the ANTLR code as much as possible---it's not very convenient to write Python inside AntlrWorks, and I've read that the Python runtime is subject to change so I want to use the recommended methods. ?So I think this may be more of a Python-specific issue.
>
> --
> Ben Escoto
>
> ----------------- Original message -----------------
> From: Martijn Reuvers <martijn.reuvers at gmail.com>
> To: Ben <misc7 at emerose.org>
> Date: Mon, 7 Sep 2009 20:46:22 +0200
> Hi Ben,
>
> I can't help you with the Python part, but below is a quick & dirty
> grammar for Java which more or less does do what you want.
>
> Most likely your errors will come from the lexer, hence I throw the
> exception there to show you. So in your python program catching that
> should tell you it was wrong. The rest of the grammar fills a list
> with text or numbers that are parsed, and prints it in the @after of
> begin rule (which is only there so a quick printout was possible).
>
> Martijn
>
>
> grammar test001;
>
> @lexer::members {
>
> ?@Override
> ? ? ? ?public void reportError(RecognitionException e) {
> ? ? ? ? ? ? ? ?throw new RuntimeException(e);
> ? ? ? ?}
>
> }
>
> @members {
>
> ? ? ? ?java.util.List result = new java.util.ArrayList();
>
> ? ? ? ?public List getResult() {
> ? ? ? ? ? ? ? ?return result;
> ? ? ? ?}
> }
>
> begin
> @after {
> ? ? ? ?System.out.println("RESULT=" + result);
> }
> ? ? ? ?: ? ? ? expr
> ? ? ? ?;
>
>
> expr
> ? ? ? ?: ? ? ? what (DOT expr)?
> ? ? ? ?;
>
> what
> ? ? ? ?: ? ? ? TEXT
> ? ? ? ? ? ? ? ?{
> ? ? ? ? ? ? ? ? ? ? ? ?if($TEXT.text != null) {
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?result.add($TEXT.text);
> ? ? ? ? ? ? ? ? ? ? ? ?}
> ? ? ? ? ? ? ? ?}
> ? ? ? ?| NUMBER
> ? ? ? ? ? ? ? ?{
> ? ? ? ? ? ? ? ? ? ? ? ?if($NUMBER.text != null) {
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?result.add($NUMBER.text);
> ? ? ? ? ? ? ? ? ? ? ? ?}
> ? ? ? ? ? ? ? ?}
> ? ? ? ?;
>
> DOT
> ? ? ? ?: ? ? ? '.'
> ? ? ? ?;
>
> TEXT
> ? ? ? ?: 'A'..'Z'+
> ?;
>
> NUMBER
> ? ? ? ?: ? ? ? '0'..'9'+
> ? ? ? ?;
>
> WS ?: ? ( ' '
> ? ? ? ?| '\t'
> ? ? ? ?| '\r'
> ? ? ? ?| '\n'
> ? ? ? ?) {$channel=HIDDEN;}
> ? ?;
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From david-sarah at jacaranda.org  Tue Sep  8 13:00:15 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 08 Sep 2009 21:00:15 +0100
Subject: [antlr-interest] Any way to specify superclasses for the lexer and
 parser in a combined grammar?
In-Reply-To: <4AA687BB.1040602@temporal-wave.com>
References: <A529CD893DE9BE4F8C753EA29B97527C0B058186@ASHBMBX03.resource.ds.bah.com>
	<4AA687BB.1040602@temporal-wave.com>
Message-ID: <4AA6B7CF.7090405@jacaranda.org>

Jim Idle wrote:
> Further than this though I always suggest that in production you use separate 
> lexer and parser grammars and use superclasses for any support methods or 
> overrides such as displayRecognitionError. Keep all the code that you can out of 
> the .g file.

I'd like to put support code in superclasses, but would prefer not to
separate the lexer and parser grammars. Is there any way to do that (without
changing the Java target templates)?
<http://www.antlr.org/jira/browse/ANTLR-375> seems relevant, but it is
shown as not fixed.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Tue Sep  8 13:18:43 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 08 Sep 2009 13:18:43 -0700
Subject: [antlr-interest] Any way to specify superclasses for the lexer
 and parser in a combined grammar?
In-Reply-To: <4AA6B7CF.7090405@jacaranda.org>
References: <A529CD893DE9BE4F8C753EA29B97527C0B058186@ASHBMBX03.resource.ds.bah.com>	<4AA687BB.1040602@temporal-wave.com>
	<4AA6B7CF.7090405@jacaranda.org>
Message-ID: <4AA6BC23.8090004@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/203306d3/attachment.html 

From isabelle.perseil at enst.fr  Tue Sep  8 13:22:03 2009
From: isabelle.perseil at enst.fr (Isabelle Perseil)
Date: Tue, 8 Sep 2009 22:22:03 +0200
Subject: [antlr-interest] =?iso-8859-1?q?_2nd_CALL_FOR_PAPERS_=3A_UML=26FM?=
 =?iso-8859-1?q?=922009?=
Message-ID: <6390cbacead55a61a00caea861f93bab.squirrel@webmail1.telecom-paristech.fr>

**********************************************************************
                    2nd CALL FOR PAPERS :  UML&FM?2009
            2nd INTERNATIONAL WORKSHOP ON UML&FORMAL METHODS
          http://www.artist-embedded.org/artist/UML-FM-2009.html

               Workshop held in conjunction with ICFEM 2009
                   The 11th International Conference on
                      Formal Engineering Methods
                 http://icfem09.inf.puc-rio.br/ICFEM.html
                           December 08, 2009
                        Rio de Janeiro, Brazil
************************************************************************

                     Submission deadline: September 30th, 2009
                     -----------------------------------------


Many interest groups from a research perspective are in favour of the
creation of this workshop.

For more than a decade now, the two communities of UML and formal methods
have been working together to produce a simultaneously practical (via UML)
and rigorous (via formal methods) approach to software engineering.

UML is the de facto standard for modelling various aspects of software
systems in both industry and academia, despite the inconvenience that its
current specification is complex and its syntax imprecise.

The fact that the UML semantics is too informal have led many researchers
to formalize it with all kinds of existing formal languages, like OCL, Z,
B, CSP, VDM, Petri Nets, UPPAAL, HOL, Coq, PVS etc.

This first workshop will be open to various subjects as the main objective
is to encourage new initiatives of building bridges between informal,
semi-formal and formal notations.


Topics:
======

This workshop seeks contributions from researchers and practitioners
interested in all aspects of integrating UML and formal methods. To this
end, we solicit papers (no more than 6 pages long) related to, but not
limited to, the following principal topics:

?        Consistent specifications, model transformations (QVT technologies,
         transformation repositories). Transformations to make models more
         analyzable so as to make them executable.

?        Automation of traceability through transformations

?        Refinement techniques: developing detailed design from a UML
         abstract specification

?        Refinement of OCL specification as well

?        Formal reasoning on models for code generation

?        Technologies for compositional verification of models

?        Specification of a formal semantics for the UML.
         Giving an abstract syntax to UML diagrams

?        Formal validation and verification of software

?        Co-modeling methods formal/informal mapping techniques

?        End-to-end methodologies or software process
         engineering,correct-by-construction design providing and
         supporting tools for safety-critical embedded systems design


Workshop Format
===============
This full-day workshop will consist of an introduction of the topic by the
workshop organizers, presentations of accepted papers, and in depth
discussion of previously identified subjects emerging from the
submissions. A summary of the discussions will be made available.


Submission and Publication
==========================
To contribute, please send a position paper or a technical paper

to agusti[dot]canals[at]c-s[dot]fr with ?ICFEM09 UML&FM Workshop? in the
title.

2 versions of the papers will be requested :

1/ Short versions : papers should not exceed 6 pages. Submitted
manuscripts should be in English and formatted in the style of the IEEE CS
Format. Preferably, submissions should be in PDF format.
First, the selected papers will be published online via in the IEEE Xpress
and distributed during the workshop as a Technical Report between
Pontif?cia Universidade Cat?lica do Rio de Janeiro and Telecom-ParisTech

2/ Then, after the workshop (the deadline is not already fixed), as
post-proceedings, all extended versions of accepted papers will be
published in the ISSE NASA journal (Innovations in Systems and Software
Engineering), first edition of 2010.
These papers should not exceed 8 pages. Submitted manuscripts should be in
English and formatted in the style of the ISSE Format. Preferably,
submissions should be in PDF format.
Please, follow the guidelines at the "For authors and editors" heading in
the ISSE website
(http://www.springer.com/computer/programming/journal/11334)


IMPORTANT DATES
===============
Submission deadline:             September 30th, 2009
All Notification of acceptance:  October 30th, 2009
Final copy for proceedings:      November 15th, 2009
Workshop date :                  December 08th, 2009


Organizers
==========

Organizational sponsors :

OMG        (http://www.omg.org/)
ARTIST   (http://www.artist-embedded.org/artist/)


Organizers and Programme Steering committee:

Jean-Michel Bruel (Liuppa, France)
Agusti Canals (CS, France)
Robert de Simone (INRIA, France)
S?bastien G?rard (CEA-LIST, France)
Elie Najm (Telecom ParisTech, France)
Isabelle Perseil (TELECOM ParisTech, France)

Publicity Chair:
Sun Meng (CWI, The Netherlands)

IEEE CS Coordinator:

Mike Hinchey (NASA GSFC and Loyola College in Maryland, USA)


Program Committee:

    * Nazareno Aguirre (Universidad Nacional de R?o Cuarto, Argentina)
    * Pascal Andr? (LINA, University of Nantes, France)
    * Yamine Ait Ameur (LISI / ENSMA, France)
    * Luciano Baresi (Politecnico di Milano, Italia)
    * Yves Bernard (AIRBUS France, France)
    * Jean-Paul Bodeveix (IRIT, France)
    * Agusti Canals (CS, France) ? General Chair
    * Sebastien Demathieu (THALES, France)
    * Mamoun Filali (IRIT, France)
    * Madeleine Faug?re (THALES, France)
    * Robert France (Colorado State University, USA)
    * S?bastien G?rard (CEA-LIST, France)
    * Martin Gogolla (University of Bremen, Germany)
    * Irfan Hamid (Microsoft Corp, Canada)
    * Wooter Joosen (Catholic University of Leuven, Belgium)
    * Sharon Keidar-Barner (IBM Haifa Research Laboratory, Israel)
    * Kevin Lano (King?s College London, United Kingdom)
    * Tom Maibaum (McMaster University, Canada )
    * Manuel Mazzara (Newcastle University, United Kingdom)
    * Stephen J.Mellor (Accelerated Technologies, Tucson AZ, USA)
    * Sun Meng (CWI, The Netherlands)
    * Dominique Mery (LORIA, France)
    * Alexandre Mota (Universidade Federal de Pernambuco, Brazil)
    * Elie Najm (Telecom ParisTech, France)
    * Kazuhiro Ogata (Japan Advanced Institute of Science and Technology,
      Japan)
    * Richard Paige (University of York, United Kingdom)
    * Dorina Petriu (Carlton University, USA)
    * Pierre-Yves Schobbens (University of Namur, Belgium)
    * Douglas C. Schmidt (Vanderbild University, USA)
    * Fran?oise Simonot Lion (LORIA, France)
    * Oleg Sokolsky (University of Pennsylvania, USA)
    * Jing Sun (University of Auckland, New Zealand)
    * Jun Suzuki (University of Massachusetts, Boston, USA)
    * Martin T?rngren (Royal Institute of Technology, Sweden)
    * Laurence Tratt (Bornmouth University, United Kingdom)
    * Tatsuhiro Tsuchiya (Osaka University, Japan)
    * Naoyasu Ubayashi (Kyushu Institute of Technology, Japan)
    * Stefan Van Baelen (Catholic University of Leuven, Belgium)
    * Tullio Vardanega (University of Padua, Italia)
    * Fran?ois Vernadat (CNRS-LAAS, France)
    * Eugenio Villar (Universidad de Cantabria, Spain)
    * Andr? Windisch (EADS Military Aircraft, Germany)
    * John Whittle (George Mason University, USA)
    * Sergio Yovine (CNRS-Verimag, France)




From lists at brachttal.net  Tue Sep  8 15:00:41 2009
From: lists at brachttal.net (Andreas Volz)
Date: Wed, 9 Sep 2009 00:00:41 +0200
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090906094044.286696dc@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>
Message-ID: <20090909000041.02c9b642@frodo.mittelerde>

Am Sun, 6 Sep 2009 09:40:44 +0200 schrieb Andreas Volz:

> Then I installed ANTLR-3.0.1 (Ubuntu) from repository and the C
> runtime from ANTLR-3.0.1 from source. This should fit together.

After get it working with a C compiler I tried a C++ compiler, but
failed:

In file included from /usr/include/antlr3tokenstream.h:14,
                 from /usr/include/antlr3baserecognizer.h:11,
                 from /usr/include/antlr3cyclicdfa.h:9,
                 from /usr/include/antlr3.h:11,
                 from VCardLexer.h:47,
                 from VCard.h:21,
                 from VCard.c:14:
/usr/include/antlr3bitset.h:51: error: expected unqualified-id before
'||' token /usr/include/antlr3bitset.h:51: error: expected `)' before
'||' token /usr/include/antlr3bitset.h:51: error: expected ';' before
'||' token VCard.c: In function 'int main(int, char**)':
VCard.c:94: warning: unused variable 'nodes'
make: *** [VCard.o] Error 1

I tried:

#ifdef __cplusplus
extern "C"
{
#endif

#include "VCard.h"

#ifdef __cplusplus
}
#endif

without success. Then I found this:

http://www.antlr.org/wiki/display/ANTLR3/Code+Generation+Targets

"C target as of release 3.1 is C++ compatible, compile .c files as C+.
C+ classes will be provided as a separate library later in 2008. "

Could the error message be a problem that 3.0.1 is not yet C++
compatible?

BTW: What is the current status of the C++ target/facade?

regards
	Andreas

From jimi at temporal-wave.com  Tue Sep  8 15:20:14 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 08 Sep 2009 15:20:14 -0700
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090909000041.02c9b642@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>
	<20090909000041.02c9b642@frodo.mittelerde>
Message-ID: <4AA6D89E.10000@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090908/43b22591/attachment.html 

From isabelle.perseil at enst.fr  Tue Sep  8 15:37:48 2009
From: isabelle.perseil at enst.fr (Isabelle Perseil)
Date: Wed, 9 Sep 2009 00:37:48 +0200
Subject: [antlr-interest] =?iso-8859-1?q?_1st_CALL_FOR_PAPERS_=3A_UML=26AA?=
 =?iso-8859-1?q?DL=922010?=
Message-ID: <a019c96be56be581ba0fd614f2492b11.squirrel@webmail1.telecom-paristech.fr>

**********************************************************************
                     CALL FOR PAPERS:  UML&AADL?2010
           http://www.artist-embedded.org/artist/UML-AADL-2010.html

                Workshop held in conjunction with ICECCS 2010
                The fifteenth IEEE International Conference on
                    Engineering of Complex Computer Systems
                    http://web.comlab.ox.ac.uk/ICECCS2010/
                               March 24th, 2010
                           University of Oxford, UK

************************************************************************

                   Submission deadline: October 30th, 2010
                   ---------------------------------------



Topics
======
New real-time systems have increasingly complex architectures because of
the intricacy of the multiple interdependent features they have to manage.
They must meet new requirements of reusability, interoperability,
flexibility and portability. These new dimensions favor the use of an
architecture description language that offers a global vision of the
system, and which is particularly suitable for handling real-time
characteristics.

Due to the even more increased complexity of distributed, real-time and
embedded systems (DRE), the need for a model-driven approach is more
obvious in this domain than in monolithic RT systems. The purpose of this
workshop is to provide an opportunity to gather researchers and industrial
practitioners to survey existing efforts related to behavior modeling and
model-based analysis of DRE systems.

This workshop seeks contributions from researchers and practitioners
interested in all aspects of the representation, analysis, and
implementation of DRE system behavior and/or architecture models. To this
end, we solicit papers (no more than 6 pages long) related to, but not
limited to, the following principal topics:

    - Model-based methodologies
    - Multi-domain specific modeling languages
    - Model-based engineering Process with AADL
    - Architectural analysis domain methods

    - Real-time Software/System development issues

    - Integration of different formalisms (e.g., Simulink/StateFlow,
      StateMate and Scade-drive)
    - Integration of multiple domains of architectural analysis
    - Model transformation and generative approaches

    - Model Checking of architecture specifications
    - ADLs behavioral models simulation, Scheduling analysis and Worst-case
      execution time prediction
    - Assuring implementation correctness to architectural specification and
      analysis

    - Tool chains facilitating architecture centric development


Workshop Format
===============
This full-day workshop will consist of an introduction of the topic by the
workshop organizers, presentations of accepted papers, and in depth
discussion of previously identified subjects emerging from the
submissions. A summary of the discussions will be made available.


Submission and Publication
==========================
To contribute, please send a position paper or a technical paper to
agusti[dot]canals[at]c-s[dot]fr with ?ICECCS 2010 UML&AADL Workshop? in
the title. Papers should not exceed 6 pages. Submitted manuscripts should
be in English and formatted in the style of the IEEE Computer Society
Proceedings Format. Preferably, submissions should be in PDF format.

All selected papers will be published in the IEEE Computer Society Press
Proceedings.


IMPORTANT DATES
===============
Submission deadline:             October  30th, 2009
All Notification of acceptance:  December 18th, 2009
Final version due:               January  22th, 2010
Workshop date:                   March    24th, 2010


Organizational sponsors
=======================
ARTIST NoE
OMG


Organizers and Programme Steering Committee
===========================================

Jean-Michel Bruel (IRIT, France)
Agusti Canals (CS, France)
Robert de Simone (INRIA, France)
S?bastien G?rard (CEA-LIST, France)
Elie Najm (Telecom ParisTech, France)
Isabelle Perseil (Telecom ParisTech / INSERM, France)


Publicity Chair
===============
Sun Meng (CWI, The Netherlands)


IEEE CS TCCX Coordinator
========================
Mike Hinchey (NASA GSFC and Loyola College in Maryland, USA)


Programme Committee
===================

-* Yamine Ait Ameur (LISI / ENSMA, France)
-* Keijiro Araki (Kyushu University, Japan)
-* Grady Booch (IBM Fellow, USA)
-* Agusti Canals (CS, France)
-* DeJiu Chen (KTH, Sweden)
-* Juan Antonio de la Puente (Universidad Polit?cnica de Madrid, Spain)
-* Sebastien Demathieu (THALES, France)
-* Dionisio De Niz Villasenor (SEI, Carnegie Mellon, USA)
-* Vincent Englebert (University of Namur, Belgium)
-* Madeleine Faug?re (THALES, France)
-* Sandra C. P. Ferraz Fabbri (Federal University of S?o Carlos, Brazil)
-* Mamoun Filali (IRIT, France)
-* Robert France (Colorado State University, USA)
-* S?bastien G?rard (CEA-LIST, France)
-* Itana Maria de Souza Gimenes (UEM, Brazil)
-* Patrick Heymans (University of Namur, Belgium)
-* Irfan Hamid (Microsoft Corp, Canada)
-* J.J.M. Hooman (Embedded Systems Institute, The Netherlands)
-* J?r?me Hugues (ISAE, France)
-* Bruce Lewis (US Army AMCOM)
-* Johan Lilius (?bo Akademi University, Finland)
-* Ricardo J. Machado (University of Minho, Portugal)
-* Sun Meng (CWI, The Netherlands)
-* Dominique Mery (LORIA, France)
-* Thierry Millan (IRIT, France)
-* Elie Najm (Telecom ParisTech, France)
-* Laurent Pautet (Telecom ParisTech, France)
-* Alek  Radjenovic (University of York, United Kingdom)
-* Marc Reynolds (University of Western Australia, Australia)
-* Jos? Ra?l Romero Salguero (Universidad de C?rdoba, Spain)
-* Bernhard Rumpe (Braunschweig University of Technology, Germany)
-* Douglas C. Schmidt (Vanderbild University, USA)
-* Fran?oise Simonot Lion (LORIA, France)
-* Oleg Sokolsky (University of Pennsylvania, USA)
-* Roy Sterritt (University of Ulster, United Kingdom)
-* J?rn Guy S?? ( University of Queensland, Australia)
-* Jing Sun (University of Auckland, New Zealand)
-* Bedir Tekinerdo&#287;an (Bilkent University, Turkey)
-* Tullio Vardanega (University of Padua, Italy)
-* Fran?ois Vernadat (CNRS-LAAS, France)
-* Thomas Vergnaud (THALES, France)
-* Eugenio Villar (Universidad de Cantabria, Spain)
-* Andr? Windisch (EADS, Military Air Systems, Germany)
-* Sergio Yovine (CNRS-Verimag, France / Universidad de Buenos Aires)
-* Roberto V. Zicari (Goethe University Frankfurt, Germany)




From martin.potier at gmail.com  Wed Sep  9 01:45:17 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Wed, 09 Sep 2009 10:45:17 +0200
Subject: [antlr-interest] Rule automation
Message-ID: <4AA76B1D.100@gmail.com>

Hi all,

I've got something on my mind that the Definitive ANTLR Reference
couldn't solve (yet, I'm not tottally through it).
Is there a way with ANTLR v3 to automate some rule ?

Id est, while building a small wiki language I wrote this kind of rule :
text
    : (PURETEXT ( inlinenv | PURETEXT )*)
    | (inlinenv (PURETEXT | inlinenv)*)
    ;

In fact, I use the same sort of rule every time  I introduce text in a
inlinenv.

I'd like to know if there's a way to create a generic rule like the
following :
generic altern ((ARG1, ARG2))
    : (ARG1 (ARG2 | ARG1)*)
    | (ARG2 (ARG1 | ARG2)*)
    ;

And then reuse it, like an operator ?


Cheers,
Martin


From s.barnett-cormack at lancaster.ac.uk  Wed Sep  9 02:24:06 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Wed, 09 Sep 2009 10:24:06 +0100
Subject: [antlr-interest] Rule automation
In-Reply-To: <4AA76B1D.100@gmail.com>
References: <4AA76B1D.100@gmail.com>
Message-ID: <4AA77436.3040607@lancaster.ac.uk>

Hi,

Rule templatisation might be a funky feature to be added, but it doesn't 
exist at present, AFAIK.

Sam

Martin Potier wrote:
> Hi all,
> 
> I've got something on my mind that the Definitive ANTLR Reference
> couldn't solve (yet, I'm not tottally through it).
> Is there a way with ANTLR v3 to automate some rule ?
> 
> Id est, while building a small wiki language I wrote this kind of rule :
> text
>     : (PURETEXT ( inlinenv | PURETEXT )*)
>     | (inlinenv (PURETEXT | inlinenv)*)
>     ;
> 
> In fact, I use the same sort of rule every time  I introduce text in a
> inlinenv.
> 
> I'd like to know if there's a way to create a generic rule like the
> following :
> generic altern ((ARG1, ARG2))
>     : (ARG1 (ARG2 | ARG1)*)
>     | (ARG2 (ARG1 | ARG2)*)
>     ;
> 
> And then reuse it, like an operator ?
> 
> 
> Cheers,
> Martin
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


-- 
Sam Barnett-Cormack

From isabelle.perseil at enst.fr  Wed Sep  9 03:06:56 2009
From: isabelle.perseil at enst.fr (Isabelle Perseil)
Date: Wed, 9 Sep 2009 12:06:56 +0200
Subject: [antlr-interest] =?iso-8859-1?q?_1st_CALL_FOR_PAPERS_=3A_UML=26AA?=
 =?iso-8859-1?q?DL=922010?=
Message-ID: <3ddceeccf02b80a7677dd699d822d10d.squirrel@webmail1.telecom-paristech.fr>

Please apologyze for the previous error on the submission deadline
**********************************************************************
                     CALL FOR PAPERS:  UML&AADL?2010
           http://www.artist-embedded.org/artist/UML-AADL-2010.html

                Workshop held in conjunction with ICECCS 2010
                The fifteenth IEEE International Conference on
                    Engineering of Complex Computer Systems
                    http://web.comlab.ox.ac.uk/ICECCS2010/
                               March 24th, 2010
                           University of Oxford, UK

************************************************************************

                   Submission deadline: October 30th, 2009
                   ---------------------------------------



Topics
======
New real-time systems have increasingly complex architectures because of
the intricacy of the multiple interdependent features they have to manage.
They must meet new requirements of reusability, interoperability,
flexibility and portability. These new dimensions favor the use of an
architecture description language that offers a global vision of the
system, and which is particularly suitable for handling real-time
characteristics.

Due to the even more increased complexity of distributed, real-time and
embedded systems (DRE), the need for a model-driven approach is more
obvious in this domain than in monolithic RT systems. The purpose of this
workshop is to provide an opportunity to gather researchers and industrial
practitioners to survey existing efforts related to behavior modeling and
model-based analysis of DRE systems.

This workshop seeks contributions from researchers and practitioners
interested in all aspects of the representation, analysis, and
implementation of DRE system behavior and/or architecture models. To this
end, we solicit papers (no more than 6 pages long) related to, but not
limited to, the following principal topics:

    - Model-based methodologies
    - Multi-domain specific modeling languages
    - Model-based engineering Process with AADL
    - Architectural analysis domain methods

    - Real-time Software/System development issues

    - Integration of different formalisms (e.g., Simulink/StateFlow,
      StateMate and Scade-drive)
    - Integration of multiple domains of architectural analysis
    - Model transformation and generative approaches

    - Model Checking of architecture specifications
    - ADLs behavioral models simulation, Scheduling analysis and Worst-case
      execution time prediction
    - Assuring implementation correctness to architectural specification and
      analysis

    - Tool chains facilitating architecture centric development


Workshop Format
===============
This full-day workshop will consist of an introduction of the topic by the
workshop organizers, presentations of accepted papers, and in depth
discussion of previously identified subjects emerging from the
submissions. A summary of the discussions will be made available.


Submission and Publication
==========================
To contribute, please send a position paper or a technical paper to
agusti[dot]canals[at]c-s[dot]fr with ?ICECCS 2010 UML&AADL Workshop? in
the title. Papers should not exceed 6 pages. Submitted manuscripts should
be in English and formatted in the style of the IEEE Computer Society
Proceedings Format. Preferably, submissions should be in PDF format.

All selected papers will be published in the IEEE Computer Society Press
Proceedings.


IMPORTANT DATES
===============
Submission deadline:             October  30th, 2009
All Notification of acceptance:  December 18th, 2009
Final version due:               January  22th, 2010
Workshop date:                   March    24th, 2010


Organizational sponsors
=======================
ARTIST NoE
OMG


Organizers and Programme Steering Committee
===========================================

Jean-Michel Bruel (IRIT, France)
Agusti Canals (CS, France)
Robert de Simone (INRIA, France)
S?bastien G?rard (CEA-LIST, France)
Elie Najm (Telecom ParisTech, France)
Isabelle Perseil (Telecom ParisTech / INSERM, France)


Publicity Chair
===============
Sun Meng (CWI, The Netherlands)


IEEE CS TCCX Coordinator
========================
Mike Hinchey (NASA GSFC and Loyola College in Maryland, USA)


Programme Committee
===================

-* Yamine Ait Ameur (LISI / ENSMA, France)
-* Keijiro Araki (Kyushu University, Japan)
-* Grady Booch (IBM Fellow, USA)
-* Agusti Canals (CS, France)
-* DeJiu Chen (KTH, Sweden)
-* Juan Antonio de la Puente (Universidad Polit?cnica de Madrid, Spain)
-* Sebastien Demathieu (THALES, France)
-* Dionisio De Niz Villasenor (SEI, Carnegie Mellon, USA)
-* Vincent Englebert (University of Namur, Belgium)
-* Madeleine Faug?re (THALES, France)
-* Sandra C. P. Ferraz Fabbri (Federal University of S?o Carlos, Brazil)
-* Mamoun Filali (IRIT, France)
-* Robert France (Colorado State University, USA)
-* S?bastien G?rard (CEA-LIST, France)
-* Itana Maria de Souza Gimenes (UEM, Brazil)
-* Patrick Heymans (University of Namur, Belgium)
-* Irfan Hamid (Microsoft Corp, Canada)
-* J.J.M. Hooman (Embedded Systems Institute, The Netherlands)
-* J?r?me Hugues (ISAE, France)
-* Bruce Lewis (US Army AMCOM)
-* Johan Lilius (?bo Akademi University, Finland)
-* Ricardo J. Machado (University of Minho, Portugal)
-* Sun Meng (CWI, The Netherlands)
-* Dominique Mery (LORIA, France)
-* Thierry Millan (IRIT, France)
-* Elie Najm (Telecom ParisTech, France)
-* Laurent Pautet (Telecom ParisTech, France)
-* Alek  Radjenovic (University of York, United Kingdom)
-* Marc Reynolds (University of Western Australia, Australia)
-* Jos? Ra?l Romero Salguero (Universidad de C?rdoba, Spain)
-* Bernhard Rumpe (Braunschweig University of Technology, Germany)
-* Douglas C. Schmidt (Vanderbild University, USA)
-* Fran?oise Simonot Lion (LORIA, France)
-* Oleg Sokolsky (University of Pennsylvania, USA)
-* Roy Sterritt (University of Ulster, United Kingdom)
-* J?rn Guy S?? ( University of Queensland, Australia)
-* Jing Sun (University of Auckland, New Zealand)
-* Bedir Tekinerdo&#287;an (Bilkent University, Turkey)
-* Tullio Vardanega (University of Padua, Italy)
-* Fran?ois Vernadat (CNRS-LAAS, France)
-* Thomas Vergnaud (THALES, France)
-* Eugenio Villar (Universidad de Cantabria, Spain)
-* Andr? Windisch (EADS, Military Air Systems, Germany)
-* Sergio Yovine (CNRS-Verimag, France / Universidad de Buenos Aires)
-* Roberto V. Zicari (Goethe University Frankfurt, Germany)






From vbar at comp.cz  Wed Sep  9 05:57:58 2009
From: vbar at comp.cz (Vaclav Barta)
Date: Wed, 9 Sep 2009 14:57:58 +0200
Subject: [antlr-interest] Rule automation
In-Reply-To: <4AA77436.3040607@lancaster.ac.uk>
References: <4AA76B1D.100@gmail.com> <4AA77436.3040607@lancaster.ac.uk>
Message-ID: <200909091457.58464.vbar@comp.cz>

On Wednesday 09 September 2009 11:24:06 Sam Barnett-Cormack wrote:
> Rule templatisation might be a funky feature to be added, but it doesn't
> exist at present, AFAIK.
I suppose most users of such capabilities would want to make their own syntax 
(and semantics) anyway, IOW an ANTLR grammar preprocessor - in ANTLR, of 
course... :-)

	Bye
		Vasek

From martin.potier at gmail.com  Wed Sep  9 06:39:54 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Wed, 09 Sep 2009 15:39:54 +0200
Subject: [antlr-interest] Grammar inclusion
Message-ID: <4AA7B02A.2060905@gmail.com>

Hi again,

I'd be curious to know if ANTLR v3 supports grammar inclusion just as
polyglot does. Otherwise is it a planned feature ?

For instance, I could just start from the java 1.6 grammar and create a
derivated language with added and/or removed rules ...

Martin

From s.barnett-cormack at lancaster.ac.uk  Wed Sep  9 07:23:04 2009
From: s.barnett-cormack at lancaster.ac.uk (Sam Barnett-Cormack)
Date: Wed, 09 Sep 2009 15:23:04 +0100
Subject: [antlr-interest] Rule automation
In-Reply-To: <200909091457.58464.vbar@comp.cz>
References: <4AA76B1D.100@gmail.com> <4AA77436.3040607@lancaster.ac.uk>
	<200909091457.58464.vbar@comp.cz>
Message-ID: <4AA7BA48.4040508@lancaster.ac.uk>

Vaclav Barta wrote:
> On Wednesday 09 September 2009 11:24:06 Sam Barnett-Cormack wrote:
>> Rule templatisation might be a funky feature to be added, but it doesn't
>> exist at present, AFAIK.
> I suppose most users of such capabilities would want to make their own syntax 
> (and semantics) anyway, IOW an ANTLR grammar preprocessor - in ANTLR, of 
> course... :-)

Nah, true built-in templatisation would be more useful, I reckon. Could 
potentially be quite clever (recursion, chaining of templates, etc). 
Even providing a standard set of templates covering common examples. 
Could even allow template libraries.

-- 
Sam Barnett-Cormack

From indhu.b at s7software.com  Wed Sep  9 08:06:57 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Wed, 9 Sep 2009 20:36:57 +0530
Subject: [antlr-interest] Grammar inclusion
In-Reply-To: <4AA7B02A.2060905@gmail.com>
References: <4AA7B02A.2060905@gmail.com>
Message-ID: <000001ca315f$2dd81330$89883990$@b@s7software.com>

I guess you can do it with composite grammars.

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Potier
Sent: Wednesday, September 09, 2009 7:10 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Grammar inclusion

Hi again,

I'd be curious to know if ANTLR v3 supports grammar inclusion just as
polyglot does. Otherwise is it a planned feature ?

For instance, I could just start from the java 1.6 grammar and create a
derivated language with added and/or removed rules ...

Martin

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From martin.potier at gmail.com  Wed Sep  9 08:21:32 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Wed, 09 Sep 2009 17:21:32 +0200
Subject: [antlr-interest] Grammar inclusion
In-Reply-To: <000001ca315f$2dd81330$89883990$@b@s7software.com>
References: <4AA7B02A.2060905@gmail.com>
	<000001ca315f$2dd81330$89883990$@b@s7software.com>
Message-ID: <4AA7C7FC.4030305@gmail.com>

Oh ! Right, I missed this point.
Strangely I found no trace of composite grammars in the book.

Thanks

Indhu Bharathi a ?crit :
> I guess you can do it with composite grammars.
> 
> -----Original Message-----
> From: antlr-interest-bounces at antlr.org
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Martin Potier
> Sent: Wednesday, September 09, 2009 7:10 PM
> To: antlr-interest at antlr.org
> Subject: [antlr-interest] Grammar inclusion
> 
> Hi again,
> 
> I'd be curious to know if ANTLR v3 supports grammar inclusion just as
> polyglot does. Otherwise is it a planned feature ?
> 
> For instance, I could just start from the java 1.6 grammar and create a
> derivated language with added and/or removed rules ...
> 
> Martin
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
> 

From lists at brachttal.net  Wed Sep  9 11:33:55 2009
From: lists at brachttal.net (Andreas Volz)
Date: Wed, 9 Sep 2009 20:33:55 +0200
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <4AA6D89E.10000@temporal-wave.com>
References: <20090906094044.286696dc@frodo.mittelerde>
	<20090909000041.02c9b642@frodo.mittelerde>
	<4AA6D89E.10000@temporal-wave.com>
Message-ID: <20090909203355.3cab1e79@frodo.mittelerde>

Am Tue, 08 Sep 2009 15:20:14 -0700 schrieb Jim Idle:

> Andreas Volz wrote:Am Sun, 6 Sep 2009 09:40:44 +0200 schrieb Andreas
> Volz:
> 
>   Then I installed ANTLR-3.0.1 (Ubuntu) from repository and the C
> runtime from ANTLR-3.0.1 from source. This should fit together.
>     
>   
> As I said, you need to install 3.1.3 or even 3.1.4 snapshot.
> 
> Jim


Sorry, I read over this part...

thanks
	Andreas

From jbb at acm.org  Wed Sep  9 12:50:57 2009
From: jbb at acm.org (John B. Brodie)
Date: Wed, 09 Sep 2009 15:50:57 -0400
Subject: [antlr-interest] Rule automation
In-Reply-To: <4AA76B1D.100@gmail.com>
References: <4AA76B1D.100@gmail.com>
Message-ID: <1252525857.8878.7.camel@gecko.home.org>

Greetings!

On Wed, 2009-09-09 at 10:45 +0200, Martin Potier wrote:
> I've got something on my mind that the Definitive ANTLR Reference
> couldn't solve (yet, I'm not tottally through it).
> Is there a way with ANTLR v3 to automate some rule ?
> 
> Id est, while building a small wiki language I wrote this kind of rule :
> text
>     : (PURETEXT ( inlinenv | PURETEXT )*)
>     | (inlinenv (PURETEXT | inlinenv)*)
>     ;
> 
> In fact, I use the same sort of rule every time  I introduce text in a
> inlinenv.
> 
> I'd like to know if there's a way to create a generic rule like the
> following :
> generic altern ((ARG1, ARG2))
>     : (ARG1 (ARG2 | ARG1)*)
>     | (ARG2 (ARG1 | ARG2)*)
>     ;
> 
> And then reuse it, like an operator ?
> 
> 

As earlier replies have stated ANTLR does not do that (at the moment
anyway).

But I just wanted to point out to you that any rule of the form:

any_rule
    : ( arg1 ( arg2 | arg1 )* )
    | ( arg2 ( arg1 | arg2 )* )
    ;

is the same as:

any_rule : ( arg1 | arg2 )+ ;

might save you some keyboarding in your .g file....

Not much value added, but hope this helps.
   -jbb




From boyer_mr at stsci.edu  Wed Sep  9 12:57:04 2009
From: boyer_mr at stsci.edu (Michael Boyer)
Date: Wed, 9 Sep 2009 15:57:04 -0400
Subject: [antlr-interest] Difficulty Building C runtime on Solaris with
	Configure
Message-ID: <1B5E836E-3FA7-494D-B5C7-05CD675AF072@stsci.edu>

Hi,
	I can't get the system specific include built with configure on a  
Solaris Unix system.
I downloaded the 3.1.3 source distribution.  There wasn't a configure  
script in the C runtime area but there was a configure.ac.  So I ran  
autoconf on it which generated a configure.
Running ./configure gives me this error:
configure: error: cannot find install-sh, install.sh, or shtool in "."  
"./.." "./../.."
Any help is appreciated.
Mike Boyer

Here's where I ran from:
-> pwd
/data/palptine1/antlr-3.1.3/runtime/C
-> ls -l
total 1414
-r--r-----   1 boyer    spss        2034 Mar 17 22:40 AUTHORS
-r--r-----   1 boyer    spss        2768 Mar 17 22:40 C.sln
-r--r-----   1 boyer    spss       22829 Mar 17 22:40 C.vcproj
-r--r-----   1 boyer    spss         441 Mar 17 22:40 C.vcproj.vspscc
-r--r-----   1 boyer    spss         246 Mar 17 22:40 C.vssscc
-r--r-----   1 boyer    spss        1578 Mar 17 22:40 COPYING
-r--r-----   1 boyer    spss       22239 Mar 17 22:40 ChangeLog
-r--r-----   1 boyer    spss        2779 Mar 17 22:40 Cvs2005.sln
-r--r-----   1 boyer    spss       22736 Mar 17 22:40 Cvs2005.vcproj
-r--r-----   1 boyer    spss        9512 Mar 17 22:41 INSTALL
-r--r-----   1 boyer    spss        2480 Mar 17 22:41 Makefile.am
-rw-r-----   1 boyer    spss       60480 Sep  8 10:56 Makefile.in
-r--r-----   1 boyer    spss          93 Mar 17 22:41 NEWS
-r--r-----   1 boyer    spss       65227 Mar 17 22:41 README
-rw-r-----   1 boyer    spss      144805 Sep  8 10:56 aclocal.m4
-rw-r-----   1 boyer    spss        5641 Sep  8 10:56 antlr3config.h.in
drwxr-s--x   2 boyer    spss         512 Sep  8 10:56 autom4te.cache/
-rw-r-----   1 boyer    spss        4842 Sep  9 15:10 config.log
-rwxr-x--x   1 boyer    spss      300946 Sep  9 15:10 configure*
-r--r-----   1 boyer    spss        5571 Mar 17 22:40 configure.ac
drwxr-s--x   2 boyer    spss         512 Mar 17 22:40 dist/
-r--r-----   1 boyer    spss        9778 Mar 17 22:40 doxyfile
drwxr-s--x   2 boyer    spss         512 Mar 17 22:41 doxygen/
drwxr-s--x   2 boyer    spss        1024 Mar 17 22:41 include/
drwxr-s--x   2 boyer    spss        1024 Mar 17 22:41 src/
drwxr-s--x   2 boyer    spss         512 Mar 17 22:41 vsrulefiles/


From jimi at temporal-wave.com  Wed Sep  9 13:15:26 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 09 Sep 2009 13:15:26 -0700
Subject: [antlr-interest] Difficulty Building C runtime on Solaris with
	Configure
In-Reply-To: <1B5E836E-3FA7-494D-B5C7-05CD675AF072@stsci.edu>
References: <1B5E836E-3FA7-494D-B5C7-05CD675AF072@stsci.edu>
Message-ID: <4AA80CDE.30606@temporal-wave.com>

Michael Boyer wrote:
> Hi,
>     I can't get the system specific include built with configure on a 
> Solaris Unix system.
> I downloaded the 3.1.3 source distribution.  There wasn't a configure 
> script in the C runtime area but there was a configure.ac.  So I ran 
> autoconf on it which generated a configure.
> Running ./configure gives me this error:
> configure: error: cannot find install-sh, install.sh, or shtool in "." 
> "./.." "./../.."
> Any help is appreciated.
> Mike Boyer 

Please take some time to read through the online documentation again - 
specifically the instructions on building the source code. Perhaps that 
is what you are trying to follow, but if there is no configure script 
then you have downloaded the wrong version from somewhere. I don't think 
that putting source and binary versions of ANTLR on distributions is 
very useful, it seems to throw people off.

Reading those instructions all the way thorough once will be of enormous 
benefit.

The versions on the download page (linked from main download page on the 
home page) are the ones you want:

http://www.antlr.org/download/C


I just checked these distributions and the configure script is where it 
should be. Otherwise you need to have the autoconf authoring tools 
loaded and run autoreconf -ir - but that is only for maintainers. 
Configure works out that you don't have install and uses a pre-supplied 
script. By the way, you should probably install those kinds of tools 
anyway. I thought that Ubuntu had some "Development" package that loaded 
all that stuff, however I had to give up on Ubuntu as it was too 
unstable and out of date.

The instructions you should be reading if you are not doing so already 
are linked from the ANTLR home page as Runtime API Doc. Select the C 
link and read ANTLR3 C Runtime API and Usage Guide.

Jim

From lists at brachttal.net  Wed Sep  9 13:59:23 2009
From: lists at brachttal.net (Andreas Volz)
Date: Wed, 9 Sep 2009 22:59:23 +0200
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <4AA6D89E.10000@temporal-wave.com>
References: <20090906094044.286696dc@frodo.mittelerde>
	<20090909000041.02c9b642@frodo.mittelerde>
	<4AA6D89E.10000@temporal-wave.com>
Message-ID: <20090909225923.46bc7f61@frodo.mittelerde>

Am Tue, 08 Sep 2009 15:20:14 -0700 schrieb Jim Idle:

> Andreas Volz wrote:Am Sun, 6 Sep 2009 09:40:44 +0200 schrieb Andreas
> Volz:
> 
>   Then I installed ANTLR-3.0.1 (Ubuntu) from repository and the C
> runtime from ANTLR-3.0.1 from source. This should fit together.
>     
>   
> As I said, you need to install 3.1.3 or even 3.1.4 snapshot.

I've installed 3.1.3 and now the next problem with the example:

VCard.c: In function 'main':
VCard.c:154: error: 'struct ANTLR3_LEXER_struct' has no member named 'tokSource'
VCard.c:200: error: 'struct ANTLR3_BASE_RECOGNIZER_struct' has no member named 'errorCount'
VCard.c:202: error: 'struct ANTLR3_BASE_RECOGNIZER_struct' has no member named 'errorCount'
VCard.c:94: warning: unused variable 'nodes'
make: *** [VCard.o] Error 1

Even with a C compiler. Did the API change in this version? I
shortly looked into the API, but see no fast solution.

How should I change my example to get it compiling?

regards
	Andreas

From jimi at temporal-wave.com  Wed Sep  9 14:25:47 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 09 Sep 2009 14:25:47 -0700
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <20090909225923.46bc7f61@frodo.mittelerde>
References: <20090906094044.286696dc@frodo.mittelerde>	<20090909000041.02c9b642@frodo.mittelerde>	<4AA6D89E.10000@temporal-wave.com>
	<20090909225923.46bc7f61@frodo.mittelerde>
Message-ID: <4AA81D5B.6070407@temporal-wave.com>

An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090909/a5caac64/attachment.html 

From christian.schladetsch at gmail.com  Thu Sep 10 02:07:51 2009
From: christian.schladetsch at gmail.com (Christian Schladetsch)
Date: Thu, 10 Sep 2009 21:07:51 +1200
Subject: [antlr-interest] Problems with the C version of ANTLR
In-Reply-To: <4AA81D5B.6070407@temporal-wave.com>
References: <20090906094044.286696dc@frodo.mittelerde>
	<20090909000041.02c9b642@frodo.mittelerde>
	<4AA6D89E.10000@temporal-wave.com>
	<20090909225923.46bc7f61@frodo.mittelerde>
	<4AA81D5B.6070407@temporal-wave.com>
Message-ID: <6442c4ae0909100207t33267cb4g7015adfdfbb6edf0@mail.gmail.com>

Hi All,

A while ago I asked about an ANTLR grammar for HLSL files. These are for
DirectX shaders.

I didn't get a response then, and got around to writing one some time ago. I
thought it may be of interest to others, so for the record it is at
http://code.google.com/p/schladetsch/source/browse/trunk/Effects/Tools/EffectTranslator.
This includes the lexer, parser, AST walker and string-templates for
output.

If there is further interest, I can add the C# tool that parses a .fx file
to an AST then produces a .fx file via StringTemplates.

Cheers,
Christian

PS. Apologies if you get this twice.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/e74f6ea8/attachment.html 

From r.bharath at huawei.com  Thu Sep 10 04:55:16 2009
From: r.bharath at huawei.com (Bharath R)
Date: Thu, 10 Sep 2009 17:25:16 +0530
Subject: [antlr-interest] Optimized code generation
Message-ID: <00a601ca320d$921788e0$2001120a@china.huawei.com>

Hi All , 
 
Pls let me know what are all the option that I could use , to get the
generated code with more performance. ( Need to be fast in parsing ). 
 
I have enabled " backtracking = true " , will this hits the performance ??? 
Without this option some ambiquity is coming. 
 
Pls help me in providing any better performace tuning option that I could
set for code generation. 
 
Thanx in advance
Bharath R 
 
HUAWEI TECHNOLOGIES CO.,LTD. huawei_logo 


Address: Huawei Industrial Base
Bantian Longgang
Shenzhen 518129, P.R.China
www.huawei.com
----------------------------------------------------------------------------
---------------------------------------------------------
This e-mail and its attachments contain confidential information from
HUAWEI, which 
is intended only for the person or entity whose address is listed above. Any
use of the 
information contained herein in any way (including, but not limited to,
total or partial 
disclosure, reproduction, or dissemination) by persons other than the
intended 
recipient(s) is prohibited. If you receive this e-mail in error, please
notify the sender by 
phone or email immediately and delete it!

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/c430d344/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: outlook_huawei_logo_en.jpg
Type: image/jpeg
Size: 6737 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/c430d344/attachment.jpg 

From misc7 at emerose.org  Thu Sep 10 05:22:12 2009
From: misc7 at emerose.org (Ben)
Date: Thu, 10 Sep 2009 07:22:12 -0500
Subject: [antlr-interest] Optimized code generation
In-Reply-To: <00a601ca320d$921788e0$2001120a@china.huawei.com>
References: <00a601ca320d$921788e0$2001120a@china.huawei.com>
Message-ID: <20090910072212.e7b6c7a9.misc7@emerose.org>

I'm just learning Antlr, but I'll give this question a shot :)

Yes, backtracking decreases performance, often by a lot.  There are other ways of avoiding ambiguity, such as using syntatic/semantic predicates.  Parr's book (_The Definitive ANTLR Reference_) has a few chapters on these.

-- 
Ben

----------------- Original message -----------------
From: Bharath R <r.bharath at huawei.com>
To: 'antlr-interest' <antlr-interest at antlr.org>
Date: Thu, 10 Sep 2009 17:25:16 +0530
Hi All , 
 
Pls let me know what are all the option that I could use , to get the
generated code with more performance. ( Need to be fast in parsing ). 
 
I have enabled " backtracking = true " , will this hits the performance ??? 
Without this option some ambiquity is coming. 
 
Pls help me in providing any better performace tuning option that I could
set for code generation. 
 
Thanx in advance
Bharath R 
 
HUAWEI TECHNOLOGIES CO.,LTD. huawei_logo 


Address: Huawei Industrial Base
Bantian Longgang
Shenzhen 518129, P.R.China
www.huawei.com
----------------------------------------------------------------------------
---------------------------------------------------------
This e-mail and its attachments contain confidential information from
HUAWEI, which 
is intended only for the person or entity whose address is listed above. Any
use of the 
information contained herein in any way (including, but not limited to,
total or partial 
disclosure, reproduction, or dissemination) by persons other than the
intended 
recipient(s) is prohibited. If you receive this e-mail in error, please
notify the sender by 
phone or email immediately and delete it!

 


From indhu.b at s7software.com  Thu Sep 10 10:07:21 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Thu, 10 Sep 2009 22:37:21 +0530
Subject: [antlr-interest] Optimized code generation
In-Reply-To: <00a601ca320d$921788e0$2001120a@china.huawei.com>
References: <00a601ca320d$921788e0$2001120a@china.huawei.com>
Message-ID: <012401ca3239$2e112280$8a336780$@b@s7software.com>

Yes, backtracking will affect performance. If you are concerned about
performance, don't use backtrack and try left factoring your grammar
instead. 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Bharath R
Sent: Thursday, September 10, 2009 5:25 PM
To: 'antlr-interest'
Subject: [antlr-interest] Optimized code generation

 

Hi All , 

 

Pls let me know what are all the option that I could use , to get the
generated code with more performance. ( Need to be fast in parsing ). 

 

I have enabled " backtracking = true " , will this hits the performance ??? 

Without this option some ambiquity is coming. 

 

Pls help me in providing any better performace tuning option that I could
set for code generation. 

 

Thanx in advance

Bharath R 

 

HUAWEI TECHNOLOGIES CO.,LTD. huawei_logo


Address: Huawei Industrial Base
Bantian Longgang
Shenzhen 518129, P.R.China
www.huawei.com
----------------------------------------------------------------------------
---------------------------------------------------------
This e-mail and its attachments contain confidential information from
HUAWEI, which 
is intended only for the person or entity whose address is listed above. Any
use of the 
information contained herein in any way (including, but not limited to,
total or partial 
disclosure, reproduction, or dissemination) by persons other than the
intended 
recipient(s) is prohibited. If you receive this e-mail in error, please
notify the sender by 
phone or email immediately and delete it!

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/6df0b392/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 6737 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/6df0b392/attachment.jpe 

From sharwell at pixelminegames.com  Thu Sep 10 10:46:58 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Thu, 10 Sep 2009 12:46:58 -0500
Subject: [antlr-interest] Optimized code generation
In-Reply-To: <00a601ca320d$921788e0$2001120a@china.huawei.com>
References: <00a601ca320d$921788e0$2001120a@china.huawei.com>
Message-ID: <86403CA0939415448BCCB83855EFE09A0123F403@Bloodymary.ironwillgames.com>

In order of their effect, here are the things you'll want to do to
improve speed. And when I say these are ordered, I mean there's a good
chance that changing a lower bullet point without changing the ones
above will have negligible results.

 

*         Left factor your grammar to remove the backtracking=true
option.

*         Remove semantic predicates (these show as {}? In the code).
Sometimes this will force you to build an ambiguous tree with a node
like "SomethingOrSomethingElse" that you can resolve in a tree walker
later by explicitly setting its type to "Something" or "SomethingElse"
once you determine the correct answer.

*         Make your syntactic predicates look as "least ahead" as
absolutely possible. Again, sometimes you can relax the rules of your
AST and resolve those in the tree walker later and greatly decrease the
lookahead requirement.

*         Use a "flat" expression parser like I sent to the list in the
past. The more operators your language has, the bigger difference it
will make.

 

Sam

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Bharath R
Sent: Thursday, September 10, 2009 6:55 AM
To: 'antlr-interest'
Subject: [antlr-interest] Optimized code generation

 

Hi All , 

 

Pls let me know what are all the option that I could use , to get the
generated code with more performance. ( Need to be fast in parsing ). 

 

I have enabled " backtracking = true " , will this hits the performance
??? 

Without this option some ambiquity is coming. 

 

Pls help me in providing any better performace tuning option that I
could set for code generation. 

 

Thanx in advance

Bharath R 

 

HUAWEI TECHNOLOGIES CO.,LTD.  


Address: Huawei Industrial Base
Bantian Longgang
Shenzhen 518129, P.R.China
www.huawei.com
------------------------------------------------------------------------
-------------------------------------------------------------
This e-mail and its attachments contain confidential information from
HUAWEI, which 
is intended only for the person or entity whose address is listed above.
Any use of the 
information contained herein in any way (including, but not limited to,
total or partial 
disclosure, reproduction, or dissemination) by persons other than the
intended 
recipient(s) is prohibited. If you receive this e-mail in error, please
notify the sender by 
phone or email immediately and delete it!

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/a51a25a3/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 6737 bytes
Desc: image001.jpg
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/a51a25a3/attachment.jpe 

From sylvain_gregory at bah.com  Thu Sep 10 11:02:22 2009
From: sylvain_gregory at bah.com (Sylvain, Gregory [USA])
Date: Thu, 10 Sep 2009 14:02:22 -0400
Subject: [antlr-interest] Looking for reference to how ANTLR performs
	Lexing....
Message-ID: <A529CD893DE9BE4F8C753EA29B97527C0B05895F@ASHBMBX03.resource.ds.bah.com>

Hello all,

I have a bunch of questions about how ANTLR (v3) is lexing it's input stream.  I am continually chasing bugs about how ANTLR lexed some text as one token when I was expecting it to Lex it as another token.

I've checked out this list and elsewhere on the ANTLR.org site for references to lexical analysis and how ANTLR is doing it, but I have not found much.

Specifically, I am trying to understand the order of evaluation of the lexer rules and how ANTLR combines them in order complete the analysis of it's given input.

Thanks in advance for any clues or references.
Greg

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/195f8409/attachment.html 

From antlr at mirality.co.nz  Thu Sep 10 12:43:02 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 11 Sep 2009 07:43:02 +1200
Subject: [antlr-interest] Looking for reference to how ANTLR performs
 Lexing....
In-Reply-To: <A529CD893DE9BE4F8C753EA29B97527C0B05895F@ASHBMBX03.resourc
	e.ds.bah.com>
References: <A529CD893DE9BE4F8C753EA29B97527C0B05895F@ASHBMBX03.resource.ds.bah.com>
Message-ID: <20090910194342.4AF513418152@www.antlr.org>

At 06:02 11/09/2009, Sylvain, Gregory [USA] wrote:
>I have a bunch of questions about how ANTLR (v3) is lexing it's 
>input stream.  I am continually chasing bugs about how ANTLR 
>lexed some text as one token when I was expecting it to Lex it as 
>another token.
>
>I've checked out this list and elsewhere on the ANTLR.org site 
>for references to lexical analysis and how ANTLR is doing it, but 
>I have not found much.
>
>Specifically, I am trying to understand the order of evaluation 
>of the lexer rules and how ANTLR combines them in order complete 
>the analysis of it's given input.

The best thing to do is to write a bunch of unit tests for your 
lexer.  Not only is this a good sanity check that you're getting 
the output you want, it's a safety net that will help ensure that 
adding or modifying rules don't break existing examples.

The first thing to realise is that the lexer runs independently, 
without any context from the parser.  So if you have two lexer 
rules that could potentially match the same input, then which ones 
you have used in the parser are not going to help disambiguate 
between them.

The general rule of thumb that ANTLR follows when deciding between 
lexer tokens is that longest-match wins; failing that, whichever 
rule is listed first will win.

Best practice is to ensure that your lexer rules are completely 
unambiguous; stick to generalities and don't try to assign 
semantic meaning until at least the parser stage.  It's also a 
good idea to merge rules that have a common left prefix (and "left 
factor" them) to reduce the amount of lookahead required to 
disambiguate between them, and also to give you more control over 
the disambiguation if you need it.  A classic example of this (on 
the wiki) is INT vs. FLOAT vs. RANGE. 


From lgcraymer at yahoo.com  Thu Sep 10 16:26:37 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Thu, 10 Sep 2009 16:26:37 -0700 (PDT)
Subject: [antlr-interest] Looking for reference to how ANTLR performs
	Lexing....
In-Reply-To: <A529CD893DE9BE4F8C753EA29B97527C0B05895F@ASHBMBX03.resource.ds.bah.com>
References: <A529CD893DE9BE4F8C753EA29B97527C0B05895F@ASHBMBX03.resource.ds.bah.com>
Message-ID: <825895.82344.qm@web55907.mail.re3.yahoo.com>

All of the lexer rules appear as alternatives (in order of definition) in a synthesized top-level Tokens rule; lexers do not use FOLLOW sets, and this sometimes causes problems.

--Loring


>
>From: "Sylvain, Gregory [USA]" <sylvain_gregory at bah.com>
>To: "antlr-interest at antlr.org" <antlr-interest at antlr.org>
>Sent: Thursday, September 10, 2009 11:02:22 AM
>Subject: [antlr-interest] Looking for reference to how ANTLR performs Lexing....
>
>
>Hello 
>all,
> 
>I have a bunch of 
>questions about how ANTLR (v3) is lexing it's input stream.  I am 
>continually chasing bugs about how ANTLR lexed some text as one token when I was 
>expecting it to Lex it as another token.
> 
>I've checked out 
>this list and elsewhere on the ANTLR.org site for references to lexical analysis 
>and how ANTLR is doing it, but I have not found much.  
> 
>Specifically, I am 
>trying to understand the order of evaluation of the lexer rules and how ANTLR 
>combines them in order complete the analysis of it's given 
>input.
> 
>Thanks in advance 
>for any clues or references.
>Greg
> 


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090910/65ca993d/attachment.html 

From indhu.b at s7software.com  Fri Sep 11 00:36:08 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 11 Sep 2009 13:06:08 +0530
Subject: [antlr-interest] Optimized code generation
In-Reply-To: <010001ca32a7$890f77e0$2001120a@china.huawei.com>
References: <00a601ca320d$921788e0$2001120a@china.huawei.com>
	<012401ca3239$2e112280$8a336780$%b@s7software.com>
	<010001ca32a7$890f77e0$2001120a@china.huawei.com>
Message-ID: <009d01ca32b2$87264480$9572cd80$@b@s7software.com>

ABNF is documented here: http://en.wikipedia.org/wiki/Augmented_Backus
<http://en.wikipedia.org/wiki/Augmented_Backus%E2%80%93Naur_Form> -Naur_Form

 

You will first have to understand the differences and convert in to a LL
ANTLR grammar.

 

I'm not sure but ABNF might allow left recursion. In that case you need to
remove left recursions from the grammar. There are standard methods to do
it. Here is the theory behind it :
http://www-und.ida.liu.se/~TDDA89/Notes/left.rec.pdf. And here is an article
from ANTLR wiki:
http://www.antlr.org/wiki/display/ANTLR3/Left-Recursion+Removal+-+Print+Edit
ion

 

Replacing backtracking by Left factoring can also be done very
methodologically. You just have to remove the necessity for infinite
lookahead. Refer
http://www.cse.iitk.ac.in/research/mtech1998/9811115/node29.html to
understand what left factoring is.

 

If you still have doubts, send us a small segment that you are not able to
left factor along with what you have tried. 

 

Regards,

Indhu

 

PS: Please address the mail to the group to get quicker and better replies.

 

 

 

From: Bharath R [mailto:r.bharath at huawei.com] 
Sent: Friday, September 11, 2009 11:47 AM
To: 'Indhu Bharathi'
Subject: RE: [antlr-interest] Optimized code generation

 

Hi , 

 

Thanx a lot for ur reply. 

 

Sorry for asking the question on basic of ANTLR , could you pls tell me how
should I left factor my grammar. 

 

Currently I am working in SIP Protocol , where the RFC 3966 defines the TEL
URI Grammar in ABNF format. 

This format need to be converted into the parser understandable way. 

 

So I have used antlrworks for writing my grammar file.

 

And eventually end up with a complex state where I could not able to compile
the grammar without "backtrack=true". 

 

 

Regards

Bharath R 

HUAWEI TECHNOLOGIES CO.,LTD. huawei_logo


Address: Huawei Industrial Base
Bantian Longgang
Shenzhen 518129, P.R.China
www.huawei.com
----------------------------------------------------------------------------
---------------------------------------------------------
This e-mail and its attachments contain confidential information from
HUAWEI, which 
is intended only for the person or entity whose address is listed above. Any
use of the 
information contained herein in any way (including, but not limited to,
total or partial 
disclosure, reproduction, or dissemination) by persons other than the
intended 
recipient(s) is prohibited. If you receive this e-mail in error, please
notify the sender by 
phone or email immediately and delete it!

 

 

  _____  

From: Indhu Bharathi [mailto:indhu.b at s7software.com] 
Sent: Thursday, September 10, 2009 10:37 PM
To: r.bharath at huawei.com; 'antlr-interest'
Subject: RE: [antlr-interest] Optimized code generation

Yes, backtracking will affect performance. If you are concerned about
performance, don't use backtrack and try left factoring your grammar
instead. 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Bharath R
Sent: Thursday, September 10, 2009 5:25 PM
To: 'antlr-interest'
Subject: [antlr-interest] Optimized code generation

 

Hi All , 

 

Pls let me know what are all the option that I could use , to get the
generated code with more performance. ( Need to be fast in parsing ). 

 

I have enabled " backtracking = true " , will this hits the performance ??? 

Without this option some ambiquity is coming. 

 

Pls help me in providing any better performace tuning option that I could
set for code generation. 

 

Thanx in advance

Bharath R 

 

HUAWEI TECHNOLOGIES CO.,LTD. huawei_logo


Address: Huawei Industrial Base
Bantian Longgang
Shenzhen 518129, P.R.China
www.huawei.com
----------------------------------------------------------------------------
---------------------------------------------------------
This e-mail and its attachments contain confidential information from
HUAWEI, which 
is intended only for the person or entity whose address is listed above. Any
use of the 
information contained herein in any way (including, but not limited to,
total or partial 
disclosure, reproduction, or dissemination) by persons other than the
intended 
recipient(s) is prohibited. If you receive this e-mail in error, please
notify the sender by 
phone or email immediately and delete it!

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090911/e42cc738/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 6737 bytes
Desc: not available
Url : http://www.antlr.org/pipermail/antlr-interest/attachments/20090911/e42cc738/attachment.jpe 

From sylvain_gregory at bah.com  Fri Sep 11 07:20:05 2009
From: sylvain_gregory at bah.com (Sylvain, Gregory [USA])
Date: Fri, 11 Sep 2009 10:20:05 -0400
Subject: [antlr-interest] Looking for reference to how ANTLR performs
 ... special example will not work???
Message-ID: <A529CD893DE9BE4F8C753EA29B97527C0B058B3A@ASHBMBX03.resource.ds.bah.com>

Great replies thank you, I was assumed the longest-match wins rules applied, but I wasn't sure - thanks.

Here is an example of the sort of problems I am trying to figure out.


r            : 'BEGIN/' f1=(number 'T') f2=field EOT EOL
number : INT | FLOAT ;
field      : ALPHANUM_CHAR+;

ALPHANUM_CHAR : ( ALPHA_CHAR  | DIGIT | SPECIAL_CHAR | ' ')+;
INT : DIGIT+ ;
FLOAT : DIGIT+ '.' DIGIT+;
fragment DIGIT : '0' .. '9' ;
fragment ALPHA_CHAR : 'A' .. 'Z' ;
SPECIAL_CHAR: ( ',' | '(' | ')' | '\\' );  // more special chars can be added here....
EOT : '//'
EOL : '\n';


The following will work:

BEGIN/1231T/P//

However, the following will NOT :

BEGIN/1231T/T//

some lexer tests lead me to believe this should work:

'T' is a ALPHA_CHAR
'T' is also an ALPHANUM_CHAR

HOWEVER,
'T' is NOT a field???

Again, I can fix this by making f1 match a field instead of a number followed by a T.  But I would like to understand what is going on here...

Basically, if a field is supposed to have a certain suffix, I would like to put that in the grammar.  Of course, I still want to be able to accept those suffixes as a part of a more general field as well.


Thanks in advance.
Greg

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090911/b53a7c8f/attachment.html 

From jimi at temporal-wave.com  Fri Sep 11 07:38:15 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 11 Sep 2009 07:38:15 -0700
Subject: [antlr-interest] Looking for reference to how ANTLR performs
 ... special example will not work???
In-Reply-To: <A529CD893DE9BE4F8C753EA29B97527C0B058B3A@ASHBMBX03.resource.ds.bah.com>
References: <A529CD893DE9BE4F8C753EA29B97527C0B058B3A@ASHBMBX03.resource.ds.bah.com>
Message-ID: <4AAA60D7.5050508@temporal-wave.com>

On 09/11/2009 07:20 AM, Sylvain, Gregory [USA] wrote:
> Great replies thank you, I was assumed the longest-match wins rules 
> applied, but I wasn't sure - thanks.
> Here is an example of the sort of problems I am trying to figure out.
> r            : 'BEGIN/' f1=(number 'T') f2=field EOT EOL
> number : INT | FLOAT ;
> field      : ALPHANUM_CHAR+;
> ALPHANUM_CHAR : ( ALPHA_CHAR  | DIGIT | SPECIAL_CHAR | ' ')+;
> INT : DIGIT+ ;
> FLOAT : DIGIT+ '.' DIGIT+;
> fragment DIGIT : '0' .. '9' ;
> fragment ALPHA_CHAR : 'A' .. 'Z' ;
> SPECIAL_CHAR: ( ',' | '(' | ')' | '\\' );  // more special chars can 
> be added here....
> EOT : '//'
> EOL : '\n';
>
Here, the three rules ALPHANUM_CHAR, INT and FLOAT can all match a 
DIGIT. This is completely ambiguous and I imagine you are getting 
warnings about this when you build/debug the grammar? The simlest chsnge 
would be to make ALPHANUM_CHAR a parser rule (make it lower case), then 
left factor FLOAT like this:

fragment INT : ; // To provide a token type
FLOAT : DIGIT+ ( ('.' DIGIT)=> '.' DIGIT+  | {$type = INT;} ) ;


Next, remove all the 'LITERALS' from your parser and code them in the 
lexer. As a beginner you will get thrown off if the literals happen to 
clash with any of your lexer rules. With more experience this confusion 
won't happen and you can use 'literals' if you prefer them (but I don't 
generally - see past posts about this topic).

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090911/9754249b/attachment.html 

From admin at specman-verification.com  Fri Sep 11 08:27:39 2009
From: admin at specman-verification.com (avidan efody)
Date: Fri, 11 Sep 2009 08:27:39 -0700 (PDT)
Subject: [antlr-interest] Can I post a translation of your verilog grammer
	to Perl on my website?
Message-ID: <64531.59198.qm@web1005.biz.mail.sp1.yahoo.com>

Hi,
If this is not the right address for questions of this type please accept my sincere apology and point me to the right address if you can...

I have found a Verilog grammer on your site, and since I'm using Perl, have translated it into a grammer that Perl's RecDescent module can understand. After I was done, I thought this might be useful for others as well, and therefore I would like to ask for your permission to place it on my website (www.specman-verification.com), along with the appropriate credit, and an explenation that this grammer was adapted from the grammer on your site. If you find this idea terribly stupid/rude and out of place, please let me know...

Thanks a lot,
Avidan

From alexeagle at google.com  Fri Sep 11 11:12:31 2009
From: alexeagle at google.com (Alex Eagle)
Date: Fri, 11 Sep 2009 11:12:31 -0700
Subject: [antlr-interest] Calling scala methods from ANTLR grammar - lots of
	warnings!
Message-ID: <56455a260909111112t132fe7a6u596b9b2aeb422e97@mail.gmail.com>

Hi Terrance and others,

I'm using ANTLR3, and in my tree grammar I'm assembling an object
model in Scala. When I add elements to a
scala.collection.mutable.Buffer, there's a method in scala "+=" which
is emitted into java bytecode as "$plus$eq".

So my grammar has chunks like this:
importDeclaration
	: ^('import' name=qualifiedType)
	{ $SourceFile::file.imports().$plus$eq($name.text); }
	;

The problem is that antlr gets upset about the "$plus" and "$eq" and
prints errors:
error(114): /Users/alexeagle/IdeaProjects/noop/src/main/antlr/NoopAST.g:72:2:
attribute is not a token, parameter, or return value: eq
error(114): /Users/alexeagle/IdeaProjects/noop/src/main/antlr/NoopAST.g:77:2:
attribute is not a token, parameter, or return value: plus

But, the grammar is still generated and works fine. So it's just annoying.

I've tried to find a way to escape those dollar signs, but no luck. Any ideas?

Thanks!
-Alex

From jbb at acm.org  Fri Sep 11 12:39:42 2009
From: jbb at acm.org (John B. Brodie)
Date: Fri, 11 Sep 2009 15:39:42 -0400
Subject: [antlr-interest] Looking for reference to how ANTLR performs
 ... special example will not work???
In-Reply-To: <A529CD893DE9BE4F8C753EA29B97527C0B058B3A@ASHBMBX03.resource.ds.bah.com>
References: <A529CD893DE9BE4F8C753EA29B97527C0B058B3A@ASHBMBX03.resource.ds.bah.com>
Message-ID: <1252697982.7696.23.camel@gecko.home.org>

Greetings!

On Fri, 2009-09-11 at 10:20 -0400, Sylvain, Gregory [USA] wrote:
> Great replies thank you, I was assumed the longest-match wins rules
> applied, but I wasn't sure - thanks.
>  
> Here is an example of the sort of problems I am trying to figure out.
>  
>  
> r            : 'BEGIN/' f1=(number 'T') f2=field EOT EOL
> number : INT | FLOAT ;
> field      : ALPHANUM_CHAR+;
>  
> ALPHANUM_CHAR : ( ALPHA_CHAR  | DIGIT | SPECIAL_CHAR | ' ')+;
> INT : DIGIT+ ;
> FLOAT : DIGIT+ '.' DIGIT+;
> fragment DIGIT : '0' .. '9' ;
> fragment ALPHA_CHAR : 'A' .. 'Z' ;
> SPECIAL_CHAR: ( ',' | '(' | ')' | '\\' );  // more special chars can
> be added here....
> EOT : '//'
> EOL : '\n';
>  
>  
> The following will work:
>  
> BEGIN/1231T/P//
>  
> However, the following will NOT :
>  
> BEGIN/1231T/T//
>  
> some lexer tests lead me to believe this should work:
>  
> 'T' is a ALPHA_CHAR
> 'T' is also an ALPHANUM_CHAR

No! 'T' is the Keyword: 'T'

a completely separate Token unto itself

>  
> HOWEVER, 
> 'T' is NOT a field???

Correct! 'T' is NOT a field, it is a Keyword (e.g. a Reserved Word).

>  
> Again, I can fix this by making f1 match a field instead of a number
> followed by a T.  But I would like to understand what is going on
> here...  
>  
> Basically, if a field is supposed to have a certain suffix, I would
> like to put that in the grammar.  Of course, I still want to be able
> to accept those suffixes as a part of a more general field as well.
>  

This is the same as the oft discussed "Keywords as Identifiers"
question...




As Jim suggests moving all of your literals out of the Parser and into
the  Lexer by making them explicit Lexer rules (at least for now, until
you get used to ANTLR) might make this clearer.

In any case, the 'T' is still gonna be a separate Token type of its own.
And if there is any parsing context in which 'T' (or any other suffix)
should be permitted then you must mention it in that parsing rule.

So instead of:

field      : ALPHANUM_CHAR+;

try

field      : ALPHANUM_CHAR+ | 'T';

there is also a way to keep the 'T' as an ALPHANUM_CHAR but use a
Predicate in the Parser to test an ALPHANUM_CHAR for the value 'T' and
thereby recognize the 'T' in its special context.

Search the mail archives for "Keywords as Identifiers" or similar
searches for the often re-occurring discussion of this topic. It might
even have a Wiki entry, haven't looked in awhile...

(i would try to post an actual example here but cannot remember the
ANTLR syntax at the moment... sorry)

Hope this helps.
   -jbb






From parrt at cs.usfca.edu  Fri Sep 11 15:34:10 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 11 Sep 2009 15:34:10 -0700
Subject: [antlr-interest] Calling scala methods from ANTLR grammar -
	lots of warnings!
In-Reply-To: <56455a260909111112t132fe7a6u596b9b2aeb422e97@mail.gmail.com>
References: <56455a260909111112t132fe7a6u596b9b2aeb422e97@mail.gmail.com>
Message-ID: <DA6BAE86-D3A2-43D3-BD68-BB879346A834@cs.usfca.edu>

try \$eq :)
Ter
On Sep 11, 2009, at 11:12 AM, Alex Eagle wrote:

> Hi Terrance and others,
>
> I'm using ANTLR3, and in my tree grammar I'm assembling an object
> model in Scala. When I add elements to a
> scala.collection.mutable.Buffer, there's a method in scala "+=" which
> is emitted into java bytecode as "$plus$eq".
>
> So my grammar has chunks like this:
> importDeclaration
> 	: ^('import' name=qualifiedType)
> 	{ $SourceFile::file.imports().$plus$eq($name.text); }
> 	;
>
> The problem is that antlr gets upset about the "$plus" and "$eq" and
> prints errors:
> error(114): /Users/alexeagle/IdeaProjects/noop/src/main/antlr/ 
> NoopAST.g:72:2:
> attribute is not a token, parameter, or return value: eq
> error(114): /Users/alexeagle/IdeaProjects/noop/src/main/antlr/ 
> NoopAST.g:77:2:
> attribute is not a token, parameter, or return value: plus
>
> But, the grammar is still generated and works fine. So it's just  
> annoying.
>
> I've tried to find a way to escape those dollar signs, but no luck.  
> Any ideas?
>
> Thanks!
> -Alex
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From alexeagle at google.com  Fri Sep 11 15:51:09 2009
From: alexeagle at google.com (Alex Eagle)
Date: Fri, 11 Sep 2009 15:51:09 -0700
Subject: [antlr-interest] Calling scala methods from ANTLR grammar -
	lots of warnings!
In-Reply-To: <DA6BAE86-D3A2-43D3-BD68-BB879346A834@cs.usfca.edu>
References: <56455a260909111112t132fe7a6u596b9b2aeb422e97@mail.gmail.com> 
	<DA6BAE86-D3A2-43D3-BD68-BB879346A834@cs.usfca.edu>
Message-ID: <56455a260909111551l167c2b5akef7ff8369b29629f@mail.gmail.com>

Doh... I'm pretty sure I tried that first, but yeah, backslash works fine.

Thanks!
-Alex

On Fri, Sep 11, 2009 at 3:34 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> try \$eq :)
> Ter
> On Sep 11, 2009, at 11:12 AM, Alex Eagle wrote:
>
>> Hi Terrance and others,
>>
>> I'm using ANTLR3, and in my tree grammar I'm assembling an object
>> model in Scala. When I add elements to a
>> scala.collection.mutable.Buffer, there's a method in scala "+=" which
>> is emitted into java bytecode as "$plus$eq".
>>
>> So my grammar has chunks like this:
>> importDeclaration
>> ? ? ? ?: ^('import' name=qualifiedType)
>> ? ? ? ?{ $SourceFile::file.imports().$plus$eq($name.text); }
>> ? ? ? ?;
>>
>> The problem is that antlr gets upset about the "$plus" and "$eq" and
>> prints errors:
>> error(114):
>> /Users/alexeagle/IdeaProjects/noop/src/main/antlr/NoopAST.g:72:2:
>> attribute is not a token, parameter, or return value: eq
>> error(114):
>> /Users/alexeagle/IdeaProjects/noop/src/main/antlr/NoopAST.g:77:2:
>> attribute is not a token, parameter, or return value: plus
>>
>> But, the grammar is still generated and works fine. So it's just annoying.
>>
>> I've tried to find a way to escape those dollar signs, but no luck. Any
>> ideas?
>>
>> Thanks!
>> -Alex
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From parrt at cs.usfca.edu  Fri Sep 11 16:25:35 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 11 Sep 2009 16:25:35 -0700
Subject: [antlr-interest] Univ. of San Francisco looking for CS faculty
Message-ID: <6DCBE9A7-E389-4159-9C07-272A4F96C34B@cs.usfca.edu>

Howdy, USF has a tenure slot open for Fall 2010 :)

http://www.cra.org/ads/adtext/ads4aa7d613eca88.php

Any PhD types out there?

Ter

From gerald at certiv.net  Sat Sep 12 00:06:57 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Sat, 12 Sep 2009 00:06:57 -0700
Subject: [antlr-interest] How to do complex Tree Pattern Matching
Message-ID: <200909120707.n8C77AfT018894@zinc.newtechlaw.com>

Given an existing AST with the two paths:

^( a b? ^(m n) c? d )

and

^( a b? ^(x y? ^(m n)) c? d )

(that is, both paths have the same root node 'a')

Given that 'm' is the interesting node, is there a way to write tree 
pattern matching rules that distinguish the 'm' based on the separate paths?


topdown : ^(m .*)  ; // works nicely, but matches on both paths

topdown : ^(a .* ^(m *.) .*) ; // should this work?  I would expect 
it to still match both paths


// should this work?
topdown : ^(a .* ( ^(x .* ^(m .*) )    { call_1($m); } // on match second path
                  | ^(m .*)             { call_2($m); } // on match first path
                  )
                  .*) ;


As a concrete example, the ANTLR grammar defines identical ^(OPTIONS 
.*) blocks, one that is a subtree of GRAMMAR and another that is a 
subtree of RULE, which in turn is a subtree of GRAMMAR.  Would be 
best to directly distinguish them in the pattern match, rather than 
poking around in the AST to examine parents.

Thanks.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090912/ff07d68d/attachment.html 

From parrt at cs.usfca.edu  Sat Sep 12 14:07:45 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 12 Sep 2009 14:07:45 -0700
Subject: [antlr-interest] How to do complex Tree Pattern Matching
In-Reply-To: <200909120707.n8C77AfT018894@zinc.newtechlaw.com>
References: <200909120707.n8C77AfT018894@zinc.newtechlaw.com>
Message-ID: <32F3727E-E801-4612-9BEB-837C869D7CB9@cs.usfca.edu>


On Sep 12, 2009, at 12:06 AM, Gerald Rosenberg wrote:

> Given an existing AST with the two paths:
>
> ^( a b? ^(m n) c? d )
>
> and
>
> ^( a b? ^(x y? ^(m n)) c? d )
>
> (that is, both paths have the same root node 'a')
>
> Given that 'm' is the interesting node, is there a way to write tree  
> pattern matching rules that distinguish the 'm' based on the  
> separate paths?
>
>
> topdown : ^(m .*)  ; // works nicely, but matches on both paths
>
> topdown : ^(a .* ^(m *.) .*) ; // should this work?  I would expect  
> it to still match both paths

Hiya. i think structure is a bit off. you need ^(m .*) down a level.

> // should this work?
> topdown : ^(a .* ( ^(x .* ^(m .*) )    { call_1($m); } // on match  
> second path
>                  | ^(m .*)             { call_2($m); } // on match  
> first path
>                  )
>                  .*) ;

something like that *should* work but might not due to bug.

> As a concrete example, the ANTLR grammar defines identical  
> ^(OPTIONS .*) blocks, one that is a subtree of GRAMMAR and another  
> that is a subtree of RULE, which in turn is a subtree of GRAMMAR.   
> Would be best to directly distinguish them in the pattern match,  
> rather than poking around in the AST to examine parents.
>

i'd recommend doing ^(m .*) match and a pred in front that says  
hasAncestor(a) or something
Ter

From gerald at certiv.net  Sat Sep 12 15:18:27 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Sat, 12 Sep 2009 15:18:27 -0700
Subject: [antlr-interest] How to do complex Tree Pattern Matching
In-Reply-To: <32F3727E-E801-4612-9BEB-837C869D7CB9@cs.usfca.edu>
References: <200909120707.n8C77AfT018894@zinc.newtechlaw.com>
	<32F3727E-E801-4612-9BEB-837C869D7CB9@cs.usfca.edu>
Message-ID: <200909122219.n8CMIxb0022541@zinc.newtechlaw.com>

At 02:07 PM 9/12/2009, Terence Parr wrote:

>On Sep 12, 2009, at 12:06 AM, Gerald Rosenberg wrote:
>>Given an existing AST with the two paths:
>
>i'd recommend doing ^(m .*) match and a pred in front that says
>hasAncestor(a) or something
>Ter

OK, I completely missed BaseTree#hasAncestor

Regards the "or something,"  TreeParser#inContext would seem to be 
it.  However, that method seems to have gone missing from 3.1.3 (it 
was in 3.1.2, but is still absent in 3.1.4).  Is there a reason that 
method got pulled?

Thanks.





From parrt at cs.usfca.edu  Sat Sep 12 15:21:07 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 12 Sep 2009 15:21:07 -0700
Subject: [antlr-interest] How to do complex Tree Pattern Matching
In-Reply-To: <200909122219.n8CMIxb0022541@zinc.newtechlaw.com>
References: <200909120707.n8C77AfT018894@zinc.newtechlaw.com>
	<32F3727E-E801-4612-9BEB-837C869D7CB9@cs.usfca.edu>
	<200909122219.n8CMIxb0022541@zinc.newtechlaw.com>
Message-ID: <DAE00051-7CF7-4F54-9133-203B83805A52@cs.usfca.edu>

yeah, I realized that I had opened up a huge issue without thinking it  
through. I'd like to have something like inContext but the more I  
added to it, the more I realized that the simplest thing to do would  
be to give the programmer basic tools like hasAncestor and let them  
add whatever logic they need.

Ter
On Sep 12, 2009, at 3:18 PM, Gerald Rosenberg wrote:

> At 02:07 PM 9/12/2009, Terence Parr wrote:
>
>> On Sep 12, 2009, at 12:06 AM, Gerald Rosenberg wrote:
>>> Given an existing AST with the two paths:
>>
>> i'd recommend doing ^(m .*) match and a pred in front that says
>> hasAncestor(a) or something
>> Ter
>
> OK, I completely missed BaseTree#hasAncestor
>
> Regards the "or something,"  TreeParser#inContext would seem to be
> it.  However, that method seems to have gone missing from 3.1.3 (it
> was in 3.1.2, but is still absent in 3.1.4).  Is there a reason that
> method got pulled?
>
> Thanks.
>
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From hilco.wijbenga at gmail.com  Sat Sep 12 23:39:34 2009
From: hilco.wijbenga at gmail.com (Hilco Wijbenga)
Date: Sat, 12 Sep 2009 23:39:34 -0700
Subject: [antlr-interest] Lexer.java output in wrong directory
Message-ID: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>

Hi all,

(I couldn't find an issue tracker so I'm just sending this problem to
the mailing list. I'm not sure whether it is an ANTLR issue or an
antlr3-maven-plugin issue.)

I have the setup below. If I run it I get the following result:

hilco at centaur ~/workspaces/default/JavaParser $ mvn clean compile ; tree
[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Building Unnamed - org.example:x:jar:0.0.1-SNAPSHOT
[INFO]    task-segment: [clean, compile]
[INFO] ------------------------------------------------------------------------
[INFO] [clean:clean]
[INFO] Deleting directory /home/hilco/workspaces/default/JavaParser/target
[INFO] [antlr3:antlr {execution: default}]
[INFO] ANTLR: Processing source directory
/home/hilco/workspaces/default/JavaParser/src/main/antlr3
ANTLR Parser Generator  Version 3.1.3 Mar 17, 2009 19:23:44
x/X.g
[INFO] [resources:resources]
[WARNING] Using platform encoding (UTF-8 actually) to copy filtered
resources, i.e. build is platform dependent!
[INFO] skip non existing resourceDirectory
/home/hilco/workspaces/default/JavaParser/src/main/resources
[INFO] [compiler:compile]
[INFO] Compiling 3 source files to
/home/hilco/workspaces/default/JavaParser/target/classes
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 5 seconds
[INFO] Finished at: Sat Sep 12 23:30:56 PDT 2009
[INFO] Final Memory: 13M/126M
[INFO] ------------------------------------------------------------------------
.
|-- pom.xml
|-- src
|   `-- main
|       `-- antlr3
|           |-- imports
|           |   `-- L.g
|           `-- x
|               `-- X.g
`-- target
    |-- classes
    |   |-- XLexer.class
    |   |-- X_L.class
    |   `-- x
    |       `-- XParser.class
    `-- generated-sources
        `-- antlr3
            |-- L.tokens
            |-- X.tokens
            |-- home
            |   `-- hilco
            |       `-- workspaces
            |           `-- default
            |               `-- JavaParser
            |                   `-- src
            |                       `-- main
            |                           `-- antlr3
            |                               `-- XLexer.java
            `-- x
                |-- XParser.java
                `-- X_L.java

Note the strange location of XLexer.java. If I comment out "import L;"
and uncomment "LETTER : 'X' ;" everything works as expected and
XLexer.java ends up next to XParser.java.

How do I get "import" to work properly?

Cheers,
Hilco

.
|-- pom.xml
`-- src
    `-- main
        `-- antlr3
            |-- imports
            |   `-- L.g
            `-- x
                `-- X.g

X.g:
grammar X;
import L;
@header {
package x;
}
//LETTER : 'X' ;
x : 'x' LETTER ;

L.g:
lexer grammar L;
LETTER : 'X' ;

pom.xml:
<project
  xmlns="http://maven.apache.org/POM/4.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
http://maven.apache.org/maven-v4_0_0.xsd"
>
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.example</groupId>
  <artifactId>x</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <dependencies>
    <dependency>
      <groupId>org.antlr</groupId>
      <artifactId>antlr-runtime</artifactId>
      <version>3.1.3</version>
    </dependency>
  </dependencies>
  <build>
    <plugins>
      <plugin>
        <groupId>org.antlr</groupId>
        <artifactId>antlr3-maven-plugin</artifactId>
        <version>3.1.3-1</version>
        <executions>
          <execution>
            <goals>
              <goal>antlr</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
</project>

My environment:
Apache Maven 2.1.0 (r755702; 2009-03-18 12:10:27-0700)
Java version: 1.5.0_19
Java home: /opt/sun-jdk-1.5.0.19/jre
Default locale: en_CA, platform encoding: UTF-8
OS name: "linux" version: "2.6.30-gentoo-r6" arch: "i386" Family: "unix"

From martijn.reuvers at gmail.com  Sun Sep 13 01:22:17 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Sun, 13 Sep 2009 10:22:17 +0200
Subject: [antlr-interest] Lexer.java output in wrong directory
In-Reply-To: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
References: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
Message-ID: <c376e6ec0909130122l795d33c2pa4f7611374bf010@mail.gmail.com>

Hi Hilco,

Not sure what you want with the import statement in the parser, but I
assume you just want to just use the lexer grammar as input for your
parser grammar, then you should use:

L.g

@header {
  package x;
}


X.g:

options {
    tokenVocab=X;
}

@header {
  package x;
}

This should work with maven.

Martijn

On Sun, Sep 13, 2009 at 8:39 AM, Hilco Wijbenga
<hilco.wijbenga at gmail.com> wrote:
> Hi all,
>
> (I couldn't find an issue tracker so I'm just sending this problem to
> the mailing list. I'm not sure whether it is an ANTLR issue or an
> antlr3-maven-plugin issue.)
>
> I have the setup below. If I run it I get the following result:
>
> hilco at centaur ~/workspaces/default/JavaParser $ mvn clean compile ; tree
> [INFO] Scanning for projects...
> [INFO] ------------------------------------------------------------------------
> [INFO] Building Unnamed - org.example:x:jar:0.0.1-SNAPSHOT
> [INFO] ? ?task-segment: [clean, compile]
> [INFO] ------------------------------------------------------------------------
> [INFO] [clean:clean]
> [INFO] Deleting directory /home/hilco/workspaces/default/JavaParser/target
> [INFO] [antlr3:antlr {execution: default}]
> [INFO] ANTLR: Processing source directory
> /home/hilco/workspaces/default/JavaParser/src/main/antlr3
> ANTLR Parser Generator ?Version 3.1.3 Mar 17, 2009 19:23:44
> x/X.g
> [INFO] [resources:resources]
> [WARNING] Using platform encoding (UTF-8 actually) to copy filtered
> resources, i.e. build is platform dependent!
> [INFO] skip non existing resourceDirectory
> /home/hilco/workspaces/default/JavaParser/src/main/resources
> [INFO] [compiler:compile]
> [INFO] Compiling 3 source files to
> /home/hilco/workspaces/default/JavaParser/target/classes
> [INFO] ------------------------------------------------------------------------
> [INFO] BUILD SUCCESSFUL
> [INFO] ------------------------------------------------------------------------
> [INFO] Total time: 5 seconds
> [INFO] Finished at: Sat Sep 12 23:30:56 PDT 2009
> [INFO] Final Memory: 13M/126M
> [INFO] ------------------------------------------------------------------------
> .
> |-- pom.xml
> |-- src
> | ? `-- main
> | ? ? ? `-- antlr3
> | ? ? ? ? ? |-- imports
> | ? ? ? ? ? | ? `-- L.g
> | ? ? ? ? ? `-- x
> | ? ? ? ? ? ? ? `-- X.g
> `-- target
> ? ?|-- classes
> ? ?| ? |-- XLexer.class
> ? ?| ? |-- X_L.class
> ? ?| ? `-- x
> ? ?| ? ? ? `-- XParser.class
> ? ?`-- generated-sources
> ? ? ? ?`-- antlr3
> ? ? ? ? ? ?|-- L.tokens
> ? ? ? ? ? ?|-- X.tokens
> ? ? ? ? ? ?|-- home
> ? ? ? ? ? ?| ? `-- hilco
> ? ? ? ? ? ?| ? ? ? `-- workspaces
> ? ? ? ? ? ?| ? ? ? ? ? `-- default
> ? ? ? ? ? ?| ? ? ? ? ? ? ? `-- JavaParser
> ? ? ? ? ? ?| ? ? ? ? ? ? ? ? ? `-- src
> ? ? ? ? ? ?| ? ? ? ? ? ? ? ? ? ? ? `-- main
> ? ? ? ? ? ?| ? ? ? ? ? ? ? ? ? ? ? ? ? `-- antlr3
> ? ? ? ? ? ?| ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? `-- XLexer.java
> ? ? ? ? ? ?`-- x
> ? ? ? ? ? ? ? ?|-- XParser.java
> ? ? ? ? ? ? ? ?`-- X_L.java
>
> Note the strange location of XLexer.java. If I comment out "import L;"
> and uncomment "LETTER : 'X' ;" everything works as expected and
> XLexer.java ends up next to XParser.java.
>
> How do I get "import" to work properly?
>
> Cheers,
> Hilco
>
> .
> |-- pom.xml
> `-- src
> ? ?`-- main
> ? ? ? ?`-- antlr3
> ? ? ? ? ? ?|-- imports
> ? ? ? ? ? ?| ? `-- L.g
> ? ? ? ? ? ?`-- x
> ? ? ? ? ? ? ? ?`-- X.g
>
> X.g:
> grammar X;
> import L;
> @header {
> package x;
> }
> //LETTER : 'X' ;
> x : 'x' LETTER ;
>
> L.g:
> lexer grammar L;
> LETTER : 'X' ;
>
> pom.xml:
> <project
> ?xmlns="http://maven.apache.org/POM/4.0.0"
> ?xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
> ?xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
> http://maven.apache.org/maven-v4_0_0.xsd"
>>
> ?<modelVersion>4.0.0</modelVersion>
> ?<groupId>org.example</groupId>
> ?<artifactId>x</artifactId>
> ?<version>0.0.1-SNAPSHOT</version>
> ?<dependencies>
> ? ?<dependency>
> ? ? ?<groupId>org.antlr</groupId>
> ? ? ?<artifactId>antlr-runtime</artifactId>
> ? ? ?<version>3.1.3</version>
> ? ?</dependency>
> ?</dependencies>
> ?<build>
> ? ?<plugins>
> ? ? ?<plugin>
> ? ? ? ?<groupId>org.antlr</groupId>
> ? ? ? ?<artifactId>antlr3-maven-plugin</artifactId>
> ? ? ? ?<version>3.1.3-1</version>
> ? ? ? ?<executions>
> ? ? ? ? ?<execution>
> ? ? ? ? ? ?<goals>
> ? ? ? ? ? ? ?<goal>antlr</goal>
> ? ? ? ? ? ?</goals>
> ? ? ? ? ?</execution>
> ? ? ? ?</executions>
> ? ? ?</plugin>
> ? ?</plugins>
> ?</build>
> </project>
>
> My environment:
> Apache Maven 2.1.0 (r755702; 2009-03-18 12:10:27-0700)
> Java version: 1.5.0_19
> Java home: /opt/sun-jdk-1.5.0.19/jre
> Default locale: en_CA, platform encoding: UTF-8
> OS name: "linux" version: "2.6.30-gentoo-r6" arch: "i386" Family: "unix"
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From eltoder at gmail.com  Sun Sep 13 07:30:08 2009
From: eltoder at gmail.com (Eugene Toder)
Date: Sun, 13 Sep 2009 15:30:08 +0100
Subject: [antlr-interest] ANTLRWorks interpreter issue
In-Reply-To: <de77d2a00909130724q6292f106n4c7d388c706df3f6@mail.gmail.com>
References: <de77d2a00909130724q6292f106n4c7d388c706df3f6@mail.gmail.com>
Message-ID: <de77d2a00909130730u15877781va788fb2a95607b3b@mail.gmail.com>

Hi all,

Apologies if this is already known (I found similar issues in JIRA,
but I'm not sure if this is the same thing).
I've found an issue with interpreter where it doesn't consume the
second alternative in (a | b)* expression. In a simple example this
leads to incomplete parse tree, in more complex cases this leads to
NoViableAltException.
In all cases the grammar works as expected in the debugger.

Examples:

1) simple
grammar test;

brackets ? ? ? ?: ? ? ? expr (call | index)*;

call ? ?: ? ? ? '(' expr ')';

index ? : ? ? ? '[' expr ']';

expr ? ?: ? ? ? IDENT;

IDENT ? : ? ? ? ('a'..'z')+;

2) now adding another rule on top of that
grammar test;

member ?: ? ? ? brackets ('.' brackets)*;

brackets ? ? ? ?: ? ? ? expr (call | index)*;

call ? ?: ? ? ? '(' expr ')';

index ? : ? ? ? '[' expr ']';

expr ? ?: ? ? ? IDENT;

IDENT ? : ? ? ? ('a'..'z')+;


Is this a bug or am I missing something here?

Thanks,
Eugene

From hilco.wijbenga at gmail.com  Sun Sep 13 10:29:53 2009
From: hilco.wijbenga at gmail.com (Hilco Wijbenga)
Date: Sun, 13 Sep 2009 10:29:53 -0700
Subject: [antlr-interest] Lexer.java output in wrong directory
In-Reply-To: <c376e6ec0909130122l795d33c2pa4f7611374bf010@mail.gmail.com>
References: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
	<c376e6ec0909130122l795d33c2pa4f7611374bf010@mail.gmail.com>
Message-ID: <e95b15950909131029q2d78889di6ee04e653d3ad57d@mail.gmail.com>

2009/9/13 Martijn Reuvers <martijn.reuvers at gmail.com>:
> Not sure what you want with the import statement in the parser, but I
> assume you just want to just use the lexer grammar as input for your
> parser grammar, then you should use:

Yep, I'm just trying to break up the grammar into smaller pieces.

> L.g
>
> @header {
> ?package x;
> }
>
>
> X.g:
>
> options {
> ? ?tokenVocab=X;
> }
>
> @header {
> ?package x;
> }

I'm probably not understanding you correctly but I can't get this to
even compile. I've tried some variations of what you listed above
("tokenVocab = L;"; with the import statement and without; with L.g in
x instead of imports) but none of it works. And in the cases where it
does output something, the lexer is still in the wrong directory.

Could you spell it out for me? :-) What should L.g say and where
should it be located? What should X.g say? Did you actually run it?

Cheers,
Hilco

From vasanthi.ak at gmail.com  Sun Sep 13 11:23:31 2009
From: vasanthi.ak at gmail.com (vasanthi a)
Date: Sun, 13 Sep 2009 23:53:31 +0530
Subject: [antlr-interest] need Actionscript 2 grammar
Message-ID: <307cfdc90909131123i52849833h4633e0f5ab909144@mail.gmail.com>

hi

i need actionscript2 grammar, Can anyone please provide it

regards
Vasanthi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090913/137c1e83/attachment.html 

From martijn.reuvers at gmail.com  Sun Sep 13 11:27:59 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Sun, 13 Sep 2009 20:27:59 +0200
Subject: [antlr-interest] Lexer.java output in wrong directory
In-Reply-To: <e95b15950909131029q2d78889di6ee04e653d3ad57d@mail.gmail.com>
References: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
	<c376e6ec0909130122l795d33c2pa4f7611374bf010@mail.gmail.com>
	<e95b15950909131029q2d78889di6ee04e653d3ad57d@mail.gmail.com>
Message-ID: <c376e6ec0909131127q4f8f2677y488b19882f85ae89@mail.gmail.com>

I think a configuration says more than spelling it letter by letter. :)
This isthe structure that outputs in nl/test (both lexer and parser):


?   pom.xml
?
????src
?   ????main
?       ????antlr3
?       ?   ????nl
?       ?       ????test
?       ?               L.g
?       ?               P.g
?       ?
?       ????java
????target
    ?   pom-transformed.xml
    ?   test-1.0-SNAPSHOT.jar
    ?
    ????classes
    ?   ????nl
    ?       ????test
    ?               L.class
    ?               P.class
    ?
    ????generated-sources
    ?   ????antlr3
    ?       ?   L.tokens
    ?       ?   P.tokens
    ?       ?
    ?       ????nl
    ?           ????test
    ?                   L.java
    ?                   P.java
    ?
    ????maven-archiver
            pom.properties

L.g is the lexer and contains:

lexer grammar L;

@header {
  package nl.test;
}

LETTER
  : 'X'
  ;

SMALL_LETTER
  : 'x'
  ;


P.g is the parser and contains:

parser grammar P;

options {
  tokenVocab=L;
}

@header {
  package nl.test;
}

x : SMALL_LETTER LETTER
  ;

Notice the tokenVocab in the parser, that matches the lexer's file
name without extension (in fact its token file name). And both lexer
and parser grammars need to define their package for it to be
generated in the files. The location of the grammar files determines
their output location (you can see in the tree above as I did a maven
run).

Martijn


On Sun, Sep 13, 2009 at 7:29 PM, Hilco Wijbenga
<hilco.wijbenga at gmail.com> wrote:
> 2009/9/13 Martijn Reuvers <martijn.reuvers at gmail.com>:
>> Not sure what you want with the import statement in the parser, but I
>> assume you just want to just use the lexer grammar as input for your
>> parser grammar, then you should use:
>
> Yep, I'm just trying to break up the grammar into smaller pieces.
>
>> L.g
>>
>> @header {
>> ?package x;
>> }
>>
>>
>> X.g:
>>
>> options {
>> ? ?tokenVocab=X;
>> }
>>
>> @header {
>> ?package x;
>> }
>
> I'm probably not understanding you correctly but I can't get this to
> even compile. I've tried some variations of what you listed above
> ("tokenVocab = L;"; with the import statement and without; with L.g in
> x instead of imports) but none of it works. And in the cases where it
> does output something, the lexer is still in the wrong directory.
>
> Could you spell it out for me? :-) What should L.g say and where
> should it be located? What should X.g say? Did you actually run it?
>
> Cheers,
> Hilco
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jimi at temporal-wave.com  Sun Sep 13 11:28:10 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 13 Sep 2009 11:28:10 -0700
Subject: [antlr-interest] Lexer.java output in wrong directory
In-Reply-To: <e95b15950909131029q2d78889di6ee04e653d3ad57d@mail.gmail.com>
References: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>	<c376e6ec0909130122l795d33c2pa4f7611374bf010@mail.gmail.com>
	<e95b15950909131029q2d78889di6ee04e653d3ad57d@mail.gmail.com>
Message-ID: <4AAD39BA.6050407@temporal-wave.com>

On 09/13/2009 10:29 AM, Hilco Wijbenga wrote:
> 2009/9/13 Martijn Reuvers<martijn.reuvers at gmail.com>:
>    
>> Not sure what you want with the import statement in the parser, but I
>> assume you just want to just use the lexer grammar as input for your
>> parser grammar, then you should use:
>>      
> Yep, I'm just trying to break up the grammar into smaller pieces.
>
>    
>> L.g
>>
>> @header {
>>   package x;
>> }
>>
>>
>> X.g:
>>
>> options {
>>     tokenVocab=X;
>> }
>>
>> @header {
>>   package x;
>> }
>>      
> I'm probably not understanding you correctly but I can't get this to
> even compile. I've tried some variations of what you listed above
> ("tokenVocab = L;"; with the import statement and without; with L.g in
> x instead of imports) but none of it works. And in the cases where it
> does output something, the lexer is still in the wrong directory.
>
> Could you spell it out for me? :-) What should L.g say and where
> should it be located? What should X.g say? Did you actually run it?
>    

If your grammar is meant to be in package x, then it should be located 
in sub-directory x under the antlr directory, it will be generated in 
the same directory structure in the target directories. You need all the 
.g files under the x sub directory. Re-read the documentation agian and 
it should be clear.

Jim

From jared.bunting at peachjean.com  Sun Sep 13 11:35:42 2009
From: jared.bunting at peachjean.com (Jared Bunting)
Date: Sun, 13 Sep 2009 13:35:42 -0500
Subject: [antlr-interest] Lexer.java output in wrong directory
In-Reply-To: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
References: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
Message-ID: <4AAD3B7E.7070005@peachjean.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

It's been awhile since I messed with this, and I don't remember the
exact sytnax, but I believe that the "@header" section in X.g only
applies to the parser.  This means that the Lexer is created in the
default package.  Adding something like:

@lexer::header {
  package x;
}

to X.g might get you closer to your solution...

You might also consider putting L in the same package - I always seemed
to have more luck that way.

Hilco Wijbenga wrote:
> Hi all,
> 
> (I couldn't find an issue tracker so I'm just sending this problem to
> the mailing list. I'm not sure whether it is an ANTLR issue or an
> antlr3-maven-plugin issue.)
> 
> I have the setup below. If I run it I get the following result:
> 
> hilco at centaur ~/workspaces/default/JavaParser $ mvn clean compile ; tree
> [INFO] Scanning for projects...
> [INFO] ------------------------------------------------------------------------
> [INFO] Building Unnamed - org.example:x:jar:0.0.1-SNAPSHOT
> [INFO]    task-segment: [clean, compile]
> [INFO] ------------------------------------------------------------------------
> [INFO] [clean:clean]
> [INFO] Deleting directory /home/hilco/workspaces/default/JavaParser/target
> [INFO] [antlr3:antlr {execution: default}]
> [INFO] ANTLR: Processing source directory
> /home/hilco/workspaces/default/JavaParser/src/main/antlr3
> ANTLR Parser Generator  Version 3.1.3 Mar 17, 2009 19:23:44
> x/X.g
> [INFO] [resources:resources]
> [WARNING] Using platform encoding (UTF-8 actually) to copy filtered
> resources, i.e. build is platform dependent!
> [INFO] skip non existing resourceDirectory
> /home/hilco/workspaces/default/JavaParser/src/main/resources
> [INFO] [compiler:compile]
> [INFO] Compiling 3 source files to
> /home/hilco/workspaces/default/JavaParser/target/classes
> [INFO] ------------------------------------------------------------------------
> [INFO] BUILD SUCCESSFUL
> [INFO] ------------------------------------------------------------------------
> [INFO] Total time: 5 seconds
> [INFO] Finished at: Sat Sep 12 23:30:56 PDT 2009
> [INFO] Final Memory: 13M/126M
> [INFO] ------------------------------------------------------------------------
> .
> |-- pom.xml
> |-- src
> |   `-- main
> |       `-- antlr3
> |           |-- imports
> |           |   `-- L.g
> |           `-- x
> |               `-- X.g
> `-- target
>     |-- classes
>     |   |-- XLexer.class
>     |   |-- X_L.class
>     |   `-- x
>     |       `-- XParser.class
>     `-- generated-sources
>         `-- antlr3
>             |-- L.tokens
>             |-- X.tokens
>             |-- home
>             |   `-- hilco
>             |       `-- workspaces
>             |           `-- default
>             |               `-- JavaParser
>             |                   `-- src
>             |                       `-- main
>             |                           `-- antlr3
>             |                               `-- XLexer.java
>             `-- x
>                 |-- XParser.java
>                 `-- X_L.java
> 
> Note the strange location of XLexer.java. If I comment out "import L;"
> and uncomment "LETTER : 'X' ;" everything works as expected and
> XLexer.java ends up next to XParser.java.
> 
> How do I get "import" to work properly?
> 
> Cheers,
> Hilco
> 
> .
> |-- pom.xml
> `-- src
>     `-- main
>         `-- antlr3
>             |-- imports
>             |   `-- L.g
>             `-- x
>                 `-- X.g
> 
> X.g:
> grammar X;
> import L;
> @header {
> package x;
> }
> //LETTER : 'X' ;
> x : 'x' LETTER ;
> 
> L.g:
> lexer grammar L;
> LETTER : 'X' ;
> 
> pom.xml:
> <project
>   xmlns="http://maven.apache.org/POM/4.0.0"
>   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>   xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
> http://maven.apache.org/maven-v4_0_0.xsd"
>   <modelVersion>4.0.0</modelVersion>
>   <groupId>org.example</groupId>
>   <artifactId>x</artifactId>
>   <version>0.0.1-SNAPSHOT</version>
>   <dependencies>
>     <dependency>
>       <groupId>org.antlr</groupId>
>       <artifactId>antlr-runtime</artifactId>
>       <version>3.1.3</version>
>     </dependency>
>   </dependencies>
>   <build>
>     <plugins>
>       <plugin>
>         <groupId>org.antlr</groupId>
>         <artifactId>antlr3-maven-plugin</artifactId>
>         <version>3.1.3-1</version>
>         <executions>
>           <execution>
>             <goals>
>               <goal>antlr</goal>
>             </goals>
>           </execution>
>         </executions>
>       </plugin>
>     </plugins>
>   </build>
> </project>
> 
> My environment:
> Apache Maven 2.1.0 (r755702; 2009-03-18 12:10:27-0700)
> Java version: 1.5.0_19
> Java home: /opt/sun-jdk-1.5.0.19/jre
> Default locale: en_CA, platform encoding: UTF-8
> OS name: "linux" version: "2.6.30-gentoo-r6" arch: "i386" Family: "unix"
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkqtO3oACgkQIEGZQEcPs5gjjgCff8qqItjD41I7sUmWHk/lp1kf
zS4AnilbzDcNSrW6iC02ckQ1B7C4gkpq
=GIiy
-----END PGP SIGNATURE-----

From antlr at mirality.co.nz  Sun Sep 13 13:32:09 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Mon, 14 Sep 2009 08:32:09 +1200
Subject: [antlr-interest] ANTLRWorks interpreter issue
In-Reply-To: <de77d2a00909130730u15877781va788fb2a95607b3b@mail.gmail.co
 m>
References: <de77d2a00909130724q6292f106n4c7d388c706df3f6@mail.gmail.com>
	<de77d2a00909130730u15877781va788fb2a95607b3b@mail.gmail.com>
Message-ID: <20090913203234.11AE03418464@www.antlr.org>

At 02:30 14/09/2009, Eugene Toder wrote:
 >I've found an issue with interpreter where it doesn't consume 
the
 >second alternative in (a | b)* expression. In a simple example
 >this leads to incomplete parse tree, in more complex cases this
 >leads to NoViableAltException.
 >In all cases the grammar works as expected in the debugger.

In my experience the interpreter is generally flaky anyway (and of 
course it doesn't process semantic predicates).  It's usually best 
to just pretend that it doesn't exist and always use the debugger 
instead.


From AndrevdM at pyrogenesis.co.za  Sun Sep 13 14:04:38 2009
From: AndrevdM at pyrogenesis.co.za (=?iso-8859-1?Q?Andr=E9_van_der_Merwe?=)
Date: Sun, 13 Sep 2009 23:04:38 +0200
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?
Message-ID: <E7035321714C624BA01ADCBA6F99CADF01457A2B4167@mercury.pyrogenesis.co.za>

Hi,

Has anyone managed to get an ANTLR generated parser (C#) working on the .net compact framework?

I doubt there are any major issues with the generated code but the references are going to be a problem. Before I go and recompile everything for the CF I wanted to check if there were known issues or perhaps someone has already done this?

As far as I can see I'll need to compile the following

StringTemplate.dll (not sure what ST's dependencies are...)
antlr.runtime.dll  (from the main distro?)
Antlr3.Runtime.dll (from the C# runtime)



Thanks for any advice.

From lists at brachttal.net  Sun Sep 13 14:38:12 2009
From: lists at brachttal.net (Andreas Volz)
Date: Sun, 13 Sep 2009 23:38:12 +0200
Subject: [antlr-interest] Hex or Unicode char definition?
Message-ID: <20090913233812.71d3b8e3@frodo.mittelerde>

Hello,

how is it possible to define chars as hex or unicode chars. e.g.:

fragment ALPHA
	: 'a'..'z' | 'A'..'Z' | '.' | ',' | ' ' | '@'

I have a syntax in rfc2234[1] format and there hex chars are defined.
How should I transfer this to ANTLR? e.g.:

   CHAR         = %x01-7F
        ; Any C0 Controls and Basic Latin, excluding NULL from
        ; Code Charts, pages 7-6 through 7-9 in [UNICODE]

regards
Andreas

[1] http://tools.ietf.org/html/rfc2234

From hilco.wijbenga at gmail.com  Sun Sep 13 15:53:31 2009
From: hilco.wijbenga at gmail.com (Hilco Wijbenga)
Date: Sun, 13 Sep 2009 15:53:31 -0700
Subject: [antlr-interest] Lexer.java output in wrong directory
In-Reply-To: <c376e6ec0909131127q4f8f2677y488b19882f85ae89@mail.gmail.com>
References: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
	<c376e6ec0909130122l795d33c2pa4f7611374bf010@mail.gmail.com>
	<e95b15950909131029q2d78889di6ee04e653d3ad57d@mail.gmail.com>
	<c376e6ec0909131127q4f8f2677y488b19882f85ae89@mail.gmail.com>
Message-ID: <e95b15950909131553o1448bc40t3b7c8854387d0b5a@mail.gmail.com>

2009/9/13 Martijn Reuvers <martijn.reuvers at gmail.com>:
<snip/>
> Notice the tokenVocab in the parser, that matches the lexer's file
> name without extension (in fact its token file name). And both lexer
> and parser grammars need to define their package for it to be
> generated in the files. The location of the grammar files determines
> their output location (you can see in the tree above as I did a maven
> run).

Yep, that works.

So how and when would I use import then?

From hilco.wijbenga at gmail.com  Sun Sep 13 16:04:45 2009
From: hilco.wijbenga at gmail.com (Hilco Wijbenga)
Date: Sun, 13 Sep 2009 16:04:45 -0700
Subject: [antlr-interest] Lexer.java output in wrong directory
In-Reply-To: <4AAD39BA.6050407@temporal-wave.com>
References: <e95b15950909122339l51b22f32nb7919236415e5b04@mail.gmail.com>
	<c376e6ec0909130122l795d33c2pa4f7611374bf010@mail.gmail.com>
	<e95b15950909131029q2d78889di6ee04e653d3ad57d@mail.gmail.com>
	<4AAD39BA.6050407@temporal-wave.com>
Message-ID: <e95b15950909131604p58dc52ccy169ba2ba1ac4ceef@mail.gmail.com>

2009/9/13 Jim Idle <jimi at temporal-wave.com>:
> If your grammar is meant to be in package x, then it should be located
> in sub-directory x under the antlr directory, it will be generated in
> the same directory structure in the target directories. You need all the
> .g files under the x sub directory. Re-read the documentation agian and
> it should be clear.

Yes, I know that but the documentation seemed to indicate that imports
should go in "imports". Are you saying I should have put them in
"imports/x"? I tried it just now but it doesn't seem to work.

From craig at palantir.co.za  Mon Sep 14 02:12:42 2009
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Mon, 14 Sep 2009 11:12:42 +0200
Subject: [antlr-interest] Template best practice type question.
Message-ID: <20090914111242.5a9qkl50084ooskc@webmail.palantir.co.za>

Hi,

I have a tree grammar that is walking a parsed tree and outputting SQL
statements using templates.

At particular points in the tree I need to generate join clauses and where
clauses. The template looks something like this.

sql(tables, paths) ::= <<
<tables>
WHERE
<paths>
>>

or(l, r) ::= <<
<l>
OR
<r>
>>

and(l, r) ::= <<
<l>
AND
<r>
>>

comparison(path, lv, rv, op) ::= <<
<path> {<lv>} <op> {<rv>}
>>

paths generates nested OR/AND sections.
My problem is that tables and paths are essentially the same thing. The
templates need to generate a set of JOIN clauses for the tables part, and the
set of OR/AND where conditions for the paths part. Only these are exactly the
same thing.

There seems to be no general way of saying "generate the template once in mode
'a', and then again in mode 'b'". I hope I am not being too vague. I have the
OR/AND clauses generating perfectly and am in the process of hacking the table
names into a list to generate that part of the template. I feel there must be a
better way.

Thanks
Regards
Craig.

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From sharwell at pixelminegames.com  Mon Sep 14 07:49:16 2009
From: sharwell at pixelminegames.com (Sam Harwell)
Date: Mon, 14 Sep 2009 09:49:16 -0500
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?
In-Reply-To: <E7035321714C624BA01ADCBA6F99CADF01457A2B4167@mercury.pyrogenesis.co.za>
References: <E7035321714C624BA01ADCBA6F99CADF01457A2B4167@mercury.pyrogenesis.co.za>
Message-ID: <86403CA0939415448BCCB83855EFE09A0123F41B@Bloodymary.ironwillgames.com>

Are you trying to run a generated parser, or are you actually trying to run Antlr3.exe on the CF to generate your parser?

If you only want to run the generated parser, then you probably only need to compile Antlr3.Runtime.dll (CSharp3 target) or Antlr.Runtime.dll (CSharp/CSharp2 target).

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andr? van der Merwe
Sent: Sunday, September 13, 2009 4:05 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?

Hi,

Has anyone managed to get an ANTLR generated parser (C#) working on the .net compact framework?

I doubt there are any major issues with the generated code but the references are going to be a problem. Before I go and recompile everything for the CF I wanted to check if there were known issues or perhaps someone has already done this?

As far as I can see I'll need to compile the following

StringTemplate.dll (not sure what ST's dependencies are...)
antlr.runtime.dll  (from the main distro?)
Antlr3.Runtime.dll (from the C# runtime)



Thanks for any advice.

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From David.Biesack at sas.com  Mon Sep 14 08:36:59 2009
From: David.Biesack at sas.com (David J. Biesack)
Date: Mon, 14 Sep 2009 11:36:59 -0400
Subject: [antlr-interest] adding Unicode identifiers confuses grammar
Message-ID: <ytb63blsfl0.fsf@sas.com>


I'm working on a grammar for an AMPL-like language (see an extracted simplified
version below). It works fine (ANTLR 3.1.3) when I use the following token
definition for identifiers:

ID
  :
  ('a'..'z'|'A'..'Z'|'_'|'$') ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
  ;

but when I copy the token fragments for Unicode identifiers from 
http://openjdk.java.net/projects/compiler-grammar/antlrworks/Java.g
and change my ID rule to use them:

ID 
  :
  IdentifierStart IdentifierPart*
  ;

I get many warnings and disabled tokens, and an error. Here are some (full errors listed below):

    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'o'": OR, ORDERED, ID

    As a result, token(s) ORDERED,ID were disabled for that input
    ...
    warning(209): AMPL.g:75:1: Multiple token rules can match input such as "':'": ASSIGN, COLON

    As a result, token(s) COLON were disabled for that input
    ...
    error(208): AMPL.g:852:1: The following token definitions can never be matched because prior tokens match the same input: BINARY,CIRCULAR,CROSS,DEFAULT,DIFF,DIMENSION,ELSE,INT,INTEGER,INTER,INTERVAL,LIST,LONG,MAXIMIZE,MIN,MINIMIZE,ORDERED,PROD,SUBJECT,SYMBOLIC,SYMDIFF,SUM,TO,WHERE,WITHIN,LE,GE,COLON,MultiLineComment

For example, colon ':' is '\u003a' which is not in IdentifierStart, so I don't know how
that causes an ambiguity with ASSIGN or COLON tokens (':=' and ':') 

(not all the tokens in the grammar below are used in this excerpt; they are used
in the longer grammar, though)

I cannot find how to resolve this. Any help?

Here is the initial grammar that works:

grammar AMPL;

tokens {

   AND                       = 'and';
   BY                        = 'by';
   BINARY                    = 'binary';
   CHAR                      = 'char';
   CIRCULAR                  = 'circular';
   CROSS                     = 'cross';
   DATA                      = 'data';
   DEFAULT                   = 'default';
   DIFF                      = 'diff';
   DIMENSION                 = 'dimension';
   END                       = 'end';
   ELSE                      = 'else';
   FLOAT                     = 'float';
   IN                        = 'in';
   INT                       = 'int';
   INTEGER                   = 'integer';
   INTER                     = 'inter';
   INTERVAL                  = 'interval';
   LET                       = 'let';
   LIST                      = 'list';
   LONG                      = 'long';
   MAX                       = 'max';
   MAXIMIZE                  = 'maximize';
   MIN                       = 'min';
   MINIMIZE                  = 'minimize';
   NOT                       = 'not';
   OR                        = 'or';
   ORDERED                   = 'ordered';
   PARAM                     = 'param';
   PROD                      = 'prod';
   REVERSED                  = 'reversed';
   SET                       = 'set';
   SUBJECT                   = 'subject';
   SYMBOLIC                  = 'symbolic';
   SYMDIFF                   = 'symdiff';
   SUM                       = 'sum';
   THEN                      = 'then';
   TO                        = 'to';
   UNION                     = 'union';
   WHEN                      = 'when';
   WHERE                     = 'where';
   WITHIN                    = 'within';
   VAR                       = 'var';
   XOR                       = 'xor';

   LBRACE                    = '{';
   RBRACE                    = '}';
   LPAREN                    = '(';
   RPAREN                    = ')';
   LBRACKET                  = '[';
   RBRACKET                  = ']';
   DQUOTE                    = '\"';
   SQUOTE                    = '\'';
   COMMA                     = ',';
   SEMI                      = ';';
   TIMES                     = '*';
   MDOT                      = '?';
   DIVIDE                    = '/';
   RANGE                     = '..';
   ASSIGN                    = ':=';
   EQ                        = '=';
   NE                        = '!=';
   LT                        = '<';
   GT                        = '>';
   LE                        = '<=';
   GE                        = '>=';
   CONCAT                    = '||';
   PLUS                      = '+';
   MINUS                     = '-';
   COLON                     = ':';

}


@parser::header {
package com.sas.test.antlr;
}

@lexer::header {
package com.sas.test.antlr;
}

formulation
  :
  declaration *
  ;

declaration
  :
  ( set_binding
  | var_binding
  | param_binding
  )
  ;

set_binding
  : SET identifier SEMI
  ;

var_binding
  : VAR identifier var_attributes? SEMI
  ;

var_attributes
  : var_attribute (COMMA var_attributes )?
  ;

var_attribute
  :
  ( INTEGER | BINARY )
  ;

param_binding
  : PARAM identifier param_attributes? SEMI
  ;

param_attributes
  : param_attribute (COMMA param_attributes)?
  ;

param_attribute
  :
  ( INTEGER | BINARY | SYMBOLIC )
  ;

identifier
  :
  ID
  ;

// =============== Lexical Rules ===================

/**
 * A simple identifier such as A or x or stock
 */
ID         // options
  :
  // IdentifierStart IdentifierPart*
  ('a'..'z'|'A'..'Z'|'_'|'$') ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
  ;

// fragment
// IdentifierStart
//     :   .... // see http://openjdk.java.net/projects/compiler-grammar/antlrworks/Java.g
//     ;
//
// fragment
// IdentifierPart
//     :   ... // see http://openjdk.java.net/projects/compiler-grammar/antlrworks/Java.g

/**
 * Whitespace
 */
WS
  :
  ( ' '
  | '\t'
  | '\f'
  | ('\n'|'\r'('\n'))
  )+   { $channel=HIDDEN; }

  ;

SingleLineComment
  : ('//' | '#') (~('\n'|'\r'))* ('\n'|'\r'('\n')?)?   { $channel=HIDDEN; }
  ;

MultiLineComment
 : '/*' ( options {greedy=false;} : . )* '*/'   { $channel=HIDDEN; }
 ;


and here are all the ANTR errors I get from 3.1.3 :

    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'b'": BY, BINARY, ID

    As a result, token(s) BINARY,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'x'": XOR, ID

    As a result, token(s) ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'r'": REVERSED, ID

    As a result, token(s) ID were disabled for that input
    warning(209): AMPL.g:70:1: Multiple token rules can match input such as "'<'": LT, LE

    As a result, token(s) LE were disabled for that input
    warning(209): AMPL.g:852:1: Multiple token rules can match input such as "'/'": DIVIDE, SingleLineComment, MultiLineComment

    As a result, token(s) SingleLineComment,MultiLineComment were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'u'": UNION, ID

    As a result, token(s) ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'l'": LET, LIST, LONG, ID

    As a result, token(s) LIST,LONG,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'i'": IN, INT, INTEGER, INTER, INTERVAL, ID

    As a result, token(s) INT,INTEGER,INTER,INTERVAL,ID were disabled for that input
    warning(209): AMPL.g:71:1: Multiple token rules can match input such as "'>'": GT, GE

    As a result, token(s) GE were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'v'": VAR, ID

    As a result, token(s) ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'d'": DATA, DEFAULT, DIFF, DIMENSION, ID

    As a result, token(s) DEFAULT,DIFF,DIMENSION,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'m'": MAX, MAXIMIZE, MIN, MINIMIZE, ID

    As a result, token(s) MAXIMIZE,MIN,MINIMIZE,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'e'": END, ELSE, ID

    As a result, token(s) ELSE,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'o'": OR, ORDERED, ID

    As a result, token(s) ORDERED,ID were disabled for that input
    warning(209): AMPL.g:75:1: Multiple token rules can match input such as "':'": ASSIGN, COLON

    As a result, token(s) COLON were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'c'": CHAR, CIRCULAR, CROSS, ID

    As a result, token(s) CIRCULAR,CROSS,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'p'": PARAM, PROD, ID

    As a result, token(s) PROD,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'w'": WHEN, WHERE, WITHIN, ID

    As a result, token(s) WHERE,WITHIN,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'a'": AND, ID

    As a result, token(s) ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'n'": NOT, ID

    As a result, token(s) ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'f'": FLOAT, ID

    As a result, token(s) ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'t'": THEN, TO, ID

    As a result, token(s) TO,ID were disabled for that input
    warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'s'": SET, SUBJECT, SYMBOLIC, SYMDIFF, SUM, ID

    As a result, token(s) SUBJECT,SYMBOLIC,SYMDIFF,SUM,ID were disabled for that input
    error(208): AMPL.g:852:1: The following token definitions can never be matched because prior tokens match the same input: BINARY,CIRCULAR,CROSS,DEFAULT,DIFF,DIMENSION,ELSE,INT,INTEGER,INTER,INTERVAL,LIST,LONG,MAXIMIZE,MIN,MINIMIZE,ORDERED,PROD,SUBJECT,SYMBOLIC,SYMDIFF,SUM,TO,WHERE,WITHIN,LE,GE,COLON,MultiLineComment

-- 
David J. Biesack, SAS
SAS Campus Dr. Cary, NC 27513
www.sas.com    (919) 531-7771

From jimi at temporal-wave.com  Mon Sep 14 11:29:52 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 14 Sep 2009 11:29:52 -0700
Subject: [antlr-interest] adding Unicode identifiers confuses grammar
In-Reply-To: <ytb63blsfl0.fsf@sas.com>
References: <ytb63blsfl0.fsf@sas.com>
Message-ID: <4AAE8BA0.5030704@temporal-wave.com>

On 09/14/2009 08:36 AM, David J. Biesack wrote:
> I'm working on a grammar for an AMPL-like language (see an extracted simplified
> version below). It works fine (ANTLR 3.1.3) when I use the following token
> definition for identifiers:
>
> ID
>    :
>    ('a'..'z'|'A'..'Z'|'_'|'$') ('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'$')*
>    ;
>
> but when I copy the token fragments for Unicode identifiers from
> http://openjdk.java.net/projects/compiler-grammar/antlrworks/Java.g
> and change my ID rule to use them:
>
> ID
>    :
>    IdentifierStart IdentifierPart*
>    ;
>
> I get many warnings and disabled tokens, and an error. Here are some (full errors listed below):
>
>      warning(209): AMPL.g:140:1: Multiple token rules can match input such as "'o'": OR, ORDERED, ID
>
>      As a result, token(s) ORDERED,ID were disabled for that input
>      ...
>      warning(209): AMPL.g:75:1: Multiple token rules can match input such as "':'": ASSIGN, COLON
>    
If you are sure that the messages are not correct and the lexer rules 
are not ambiguous, then you probably need to increase the conversion 
timeout:

-Xconversiontimeout 30000

if that does not work, then there is a conflict in your rules.

Jim


From parrt at cs.usfca.edu  Mon Sep 14 12:12:55 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Mon, 14 Sep 2009 12:12:55 -0700
Subject: [antlr-interest] Template best practice type question.
In-Reply-To: <20090914111242.5a9qkl50084ooskc@webmail.palantir.co.za>
References: <20090914111242.5a9qkl50084ooskc@webmail.palantir.co.za>
Message-ID: <BE17AB8A-49B1-453B-82DA-E75E425A4F82@cs.usfca.edu>

[moving to ST interest]

Hi. Are you saying that you want to process the same data with  
multiple templates? or are you saying you want a template to be  
sensitive to the kind of data it's applied to?
Ter
On Sep 14, 2009, at 2:12 AM, craig at palantir.co.za wrote:

> Hi,
>
> I have a tree grammar that is walking a parsed tree and outputting SQL
> statements using templates.
>
> At particular points in the tree I need to generate join clauses and  
> where
> clauses. The template looks something like this.
>
> sql(tables, paths) ::= <<
> <tables>
> WHERE
> <paths>
>>>
>
> or(l, r) ::= <<
> <l>
> OR
> <r>
>>>
>
> and(l, r) ::= <<
> <l>
> AND
> <r>
>>>
>
> comparison(path, lv, rv, op) ::= <<
> <path> {<lv>} <op> {<rv>}
>>>
>
> paths generates nested OR/AND sections.
> My problem is that tables and paths are essentially the same thing.  
> The
> templates need to generate a set of JOIN clauses for the tables  
> part, and the
> set of OR/AND where conditions for the paths part. Only these are  
> exactly the
> same thing.
>
> There seems to be no general way of saying "generate the template  
> once in mode
> 'a', and then again in mode 'b'". I hope I am not being too vague. I  
> have the
> OR/AND clauses generating perfectly and am in the process of hacking  
> the table
> names into a list to generate that part of the template. I feel  
> there must be a
> better way.
>
> Thanks
> Regards
> Craig.
>
> ----------------------------------------------------------------
> This message was sent using IMP, the Internet Messaging Program.
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From david-sarah at jacaranda.org  Mon Sep 14 16:31:22 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 15 Sep 2009 00:31:22 +0100
Subject: [antlr-interest] Conversion timeout and non-reproducible warnings
In-Reply-To: <4AAE8BA0.5030704@temporal-wave.com>
References: <ytb63blsfl0.fsf@sas.com> <4AAE8BA0.5030704@temporal-wave.com>
Message-ID: <4AAED24A.1010803@jacaranda.org>

Jim Idle wrote:
> If you are sure that the messages are not correct and the lexer rules 
> are not ambiguous, then you probably need to increase the conversion 
> timeout:
> 
> -Xconversiontimeout 30000

Ah. I had not realised that this was a wall clock timeout. Perhaps that
explains why I occasionally get non-reproducible warnings when ANTLRWorks
is running slowly due to Windows being low on memory.

Perhaps the "timeout" should be based on some measure of work done rather
than wall clock time. That would at least ensure reproducibility for a
given grammar and ANTLR version.

I assume the units are milliseconds, but
<http://www.antlr.org/wiki/display/ANTLR3/Command+line+options>
does not document that, or what the default is.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Mon Sep 14 16:57:49 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 14 Sep 2009 16:57:49 -0700
Subject: [antlr-interest] Conversion timeout and non-reproducible
	warnings
In-Reply-To: <4AAED24A.1010803@jacaranda.org>
References: <ytb63blsfl0.fsf@sas.com> <4AAE8BA0.5030704@temporal-wave.com>
	<4AAED24A.1010803@jacaranda.org>
Message-ID: <4AAED87D.4020901@temporal-wave.com>

On 09/14/2009 04:31 PM, David-Sarah Hopwood wrote:
> Jim Idle wrote:
>    
>> If you are sure that the messages are not correct and the lexer rules
>> are not ambiguous, then you probably need to increase the conversion
>> timeout:
>>
>> -Xconversiontimeout 30000
>>      
> Ah. I had not realised that this was a wall clock timeout. Perhaps that
> explains why I occasionally get non-reproducible warnings when ANTLRWorks
> is running slowly due to Windows being low on memory.
>
> Perhaps the "timeout" should be based on some measure of work done rather
> than wall clock time. That would at least ensure reproducibility for a
> given grammar and ANTLR version.
>
> I assume the units are milliseconds, but
> <http://www.antlr.org/wiki/display/ANTLR3/Command+line+options>
> does not document that, or what the default is.
>
>    
Yes - milliseconds. It is that way because JVMs did not have the ability 
to report CPU execution times. Perhaps there is a generic way in later 
JVMs - we can look I guess ;-)

Jim

From james.robson at ymail.com  Mon Sep 14 23:04:36 2009
From: james.robson at ymail.com (James Robson)
Date: Mon, 14 Sep 2009 23:04:36 -0700 (PDT)
Subject: [antlr-interest] maven plugin and javascript target
Message-ID: <852244.63206.qm@web43506.mail.sp1.yahoo.com>

I'm having difficulty getting the javascript target working with the maven plugin.


error(10):  internal error: group JavaScript does not satisfy interface ANTLRCore: mismatched arguments on these templates [treeParser(grammar, name, scopes, tokens, tokenNames, globalAction, rules, numRules, bitsets, labelType, ASTLabelType, superClass, members, filterMode)]

This is the same error I get from any version of the libraries, with the exception of antlrworks antlrworks-1.2.3.jar

Can anyone point me in the right direction?



      __________________________________________________________________________________
Find local businesses and services in your area with Yahoo!7 Local.
Get started: http://local.yahoo.com.au
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090914/dc246cb1/attachment.html 

From admin at specman-verification.com  Mon Sep 14 23:07:44 2009
From: admin at specman-verification.com (avidan efody)
Date: Mon, 14 Sep 2009 23:07:44 -0700 (PDT)
Subject: [antlr-interest] Error running Graphviz Dot - CreateProcessError=5
	access is denied
Message-ID: <710248.52854.qm@web1004.biz.mail.sp1.yahoo.com>

Hi,
I'm trying to run Graphviz dot from Antlr on Windows Vista, and I get the following error:

java.io.IOException: Cannot run program ""C:\Program Files\Graphviz2.24\bin"": CreateProcesserror=5, Access is denied

I am able to run dot standalone from the same location (i.e. C:\Program Files\Graphviz2.24\bin), so this seems like something quite stupid...anyone has any idea where to look for the solution? Any help would be appreciated.

Thanks a lot,
Avidan

From james.robson at ymail.com  Mon Sep 14 23:15:06 2009
From: james.robson at ymail.com (James Robson)
Date: Mon, 14 Sep 2009 23:15:06 -0700 (PDT)
Subject: [antlr-interest] maven plugin and javascript target
In-Reply-To: <852244.63206.qm@web43506.mail.sp1.yahoo.com>
References: <852244.63206.qm@web43506.mail.sp1.yahoo.com>
Message-ID: <872223.63568.qm@web43513.mail.sp1.yahoo.com>



I should note that the javascript target only works when you use the
IDE, not if you use the library and call Tool from the command line.

________________________________
From: James Robson <james.robson at ymail.com>
To: antlr-interest at antlr.org
Sent: Tuesday, 15 September, 2009 4:04:36 PM
Subject: [antlr-interest] maven plugin and javascript target


I'm having difficulty getting the javascript target working with the maven plugin.


error(10):  internal error: group JavaScript does not satisfy interface ANTLRCore: mismatched arguments on these templates [treeParser(grammar, name, scopes, tokens, tokenNames, globalAction, rules, numRules, bitsets, labelType, ASTLabelType, superClass, members, filterMode)]

This is the same error I get from any version of the libraries, with the exception of antlrworks antlrworks-1.2.3.jar

Can anyone point me in the right direction?

________________________________
 Get more done like never before with Yahoo!7 Mail. Learn more.


      __________________________________________________________________________________
Get more done like never before with Yahoo!7 Mail.
Learn more: http://au.overview.mail.yahoo.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090914/92deca86/attachment.html 

From AndrevdM at pyrogenesis.co.za  Mon Sep 14 23:43:11 2009
From: AndrevdM at pyrogenesis.co.za (=?iso-8859-1?Q?Andr=E9_van_der_Merwe?=)
Date: Tue, 15 Sep 2009 08:43:11 +0200
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?
In-Reply-To: <86403CA0939415448BCCB83855EFE09A0123F41B@Bloodymary.ironwillgames.com>
References: <E7035321714C624BA01ADCBA6F99CADF01457A2B4167@mercury.pyrogenesis.co.za>
	<86403CA0939415448BCCB83855EFE09A0123F41B@Bloodymary.ironwillgames.com>
Message-ID: <E7035321714C624BA01ADCBA6F99CADF01457A2B41B1@mercury.pyrogenesis.co.za>

I only want to use the generated parser. I'll see if I can compile Antlr3.Runtime.dll without the other references.

Thanks for the help

-----Original Message-----
From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: 14 September 2009 16:49
To: Andr? van der Merwe; antlr-interest at antlr.org
Subject: RE: [antlr-interest] ANTLR on Microsoft's Compact Framework?

Are you trying to run a generated parser, or are you actually trying to run Antlr3.exe on the CF to generate your parser?

If you only want to run the generated parser, then you probably only need to compile Antlr3.Runtime.dll (CSharp3 target) or Antlr.Runtime.dll (CSharp/CSharp2 target).

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andr? van der Merwe
Sent: Sunday, September 13, 2009 4:05 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?

Hi,

Has anyone managed to get an ANTLR generated parser (C#) working on the .net compact framework?

I doubt there are any major issues with the generated code but the references are going to be a problem. Before I go and recompile everything for the CF I wanted to check if there were known issues or perhaps someone has already done this?

As far as I can see I'll need to compile the following

StringTemplate.dll (not sure what ST's dependencies are...)
antlr.runtime.dll  (from the main distro?)
Antlr3.Runtime.dll (from the C# runtime)


From craig at palantir.co.za  Mon Sep 14 23:52:44 2009
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Tue, 15 Sep 2009 08:52:44 +0200
Subject: [antlr-interest] Best Practice type Question.
Message-ID: <20090915085244.m0td04faecw8sogw@webmail.palantir.co.za>

Hi,

I have pasted the grammar.
What I really need is for the sql template to be able to process paths one way
to generate the join clauses, because I can get the table names from
relativePath (the first part of the part) and the field name(s) from other
parts of the relativePath. I need the sql template to call / use the other
templates to generate first joins, and then where clauses.

Because I am using -> or(l={$p1.st}, r={$p2.st}) the templates are expanded in a
particular way. I want to use the paths parameter to the sql template in
different ways.


xpath
		: d+=declaration* p+=path
		-> sql(declarations={$d}, paths={$p})
		;

declaration	: ^('declare' nsName=QNAME ns=STRING)
		-> declaration(name={$nsName}, namespace={$ns})
		;

path		: ^('or' p1=path p2=path) -> or(l={$p1.st}, r={$p2.st})
		| ^('and' p1=path p2=path) -> and(l={$p1.st}, r={$p2.st})
		| ^('relative-path' rn=rangeExpr) { $xpath::tables.AddRange($rn.re); } ->
template(rn={$rn.st}) "RN:[ <rn> ]"
		;

rangeExpr
returns [string[\] re]
scope			{ List<string> path; }
@init			{ $rangeExpr::path = new List<string>(); }
			: rp+=relativePath*
			{ $re = $rangeExpr::path.ToArray(); }
			-> template(rp={$rp}) "RP:[ <rp; separator=\", \"> ]"
			;

relativePath
	: ('//'|'/') (ns=QNAME ':')? nm=QNAME
	{ $rangeExpr::path.Add( Convert.ToString(((XNamespace) (ns == null ?
XNamespace.None : $ns.Text)) + $nm.Text )); }
	| dot='.' -> {%{$dot.text}}
	| STRING -> {%{$STRING.text}}
	| '@' qn=QNAME -> {%{$QNAME.text}}
	| cm=comp -> template(c={$cm.st}) "<c>"
	;

comp	: ^('comparison' (op='=' | op='<' | op='>' | op='like') lv=relativePath
rv=relativePath)
	-> comparison(path={$rangeExpr::path}, lv={$lv.st}, rv={$rv.st}, op={$op})
	;

[moving to ST interest]

Hi. Are you saying that you want to process the same data with multiple
templates? or are you saying you want a template to be sensitive to the kind of
data it's applied to?
Ter
On Sep 14, 2009, at 2:12 AM, craig at palantir.co.za wrote:

> Hi,
>
> I have a tree grammar that is walking a parsed tree and outputting SQL
> statements using templates.
>
> At particular points in the tree I need to generate join clauses and
> where clauses. The template looks something like this.
>
> sql(tables, paths) ::= <<
> <tables>
> WHERE
> <paths>
>>>
>
> or(l, r) ::= <<
> <l>
> OR
> <r>
>>>
>
> and(l, r) ::= <<
> <l>
> AND
> <r>
>>>
>
> comparison(path, lv, rv, op) ::= <<
> <path> {<lv>} <op> {<rv>}
>>>
>
> paths generates nested OR/AND sections.
> My problem is that tables and paths are essentially the same thing.
> The
> templates need to generate a set of JOIN clauses for the tables part,
> and the set of OR/AND where conditions for the paths part. Only these
> are exactly the same thing.
>
> There seems to be no general way of saying "generate the template once
> in mode 'a', and then again in mode 'b'". I hope I am not being too
> vague. I have the OR/AND clauses generating perfectly and am in the
> process of hacking the table names into a list to generate that part
> of the template. I feel there must be a better way.
>
> Thanks
> Regards
> Craig.
>


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From dmarin at sice.com  Tue Sep 15 00:30:02 2009
From: dmarin at sice.com (=?iso-8859-1?Q?David_Mar=EDn_Carre=F1o?=)
Date: Tue, 15 Sep 2009 09:30:02 +0200
Subject: [antlr-interest] How to serialize a AST
Message-ID: <42241A793C1C4705B6205E18454A57FC@PDMCSICALC>

Hello all.

 

I am developing a calculation framework for my firm using ANTLR3 and Java.

 

I want to serialize an AST for reusing it a lot of times, so this way I can
save parsing time for each calculation.

 

I have developed a CommonTree derived class ICalcTree that implements
Serialize, and another class ICalcTreeAdaptor derived from
CommonTreeAdaptor.

 

In parser options, I have:

 

      output = AST;

      ASTLabelType = ICalcTree;

      language = Java;

 

The program uses the parser this way:

 

String formula = "a=1+2";

      

      Reader reader = new CharArrayReader(formula.toCharArray());

      ICalcLexer lexer = new ICalcLexer(new ANTLRReaderStream(reader));

      CommonTokenStream cts = new CommonTokenStream(lexer);

      ICalcParser tokenParser = new ICalcParser(cts);

        

      TreeAdaptor adaptor = new ICalcTreeAdaptor();

      tokenParser.setTreeAdaptor(adaptor);

      

      ICalcParser.formula_return parserResult =

            tokenParser.formula(); // start rule method

        

      reader.close();

      ICalcTree ast = (ICalcTree) parserResult.getTree();

            

      // Serialize

      

      ByteArrayOutputStream bs = new ByteArrayOutputStream();

      ObjectOutputStream os = new ObjectOutputStream(bs);

      os.writeObject(ast);

      os.close();

      

      byte[] buf = bs.toByteArray();

      String serialized = StringUtils.byteArrayToHexString(buf);

            

      

      // Unserialize

      

      byte[] buf_unserialized =
StringUtils.hexStringToByteArray(serialized);

      ByteArrayInputStream bi = new ByteArrayInputStream(buf_unserialized);

      ObjectInputStream ois = new ObjectInputStream(bi);

      try {

            ICalcTree new_ast = new ICalcTree();

            new_ast = (ICalcTree) ois.readObject();

            System.out.println(new_ast.toStringTree());

      } catch (ClassNotFoundException e) {

            e.printStackTrace();

      }

 

It always print nil, for whatever formula string. 

What am I doing wrong? How can I serialize the AST so it can be reused many
times?

 

Thank you for your assistance.

 

 

David Mar?n Carre?o 

S.I.C.E. 

Direcci?n T?cnica. 

Tfno 91 623 22 30

E-mail: dmarin at sice.com

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090915/fd9ef891/attachment.html 

From antlr at mirality.co.nz  Tue Sep 15 02:40:42 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Tue, 15 Sep 2009 21:40:42 +1200
Subject: [antlr-interest] Error running Graphviz Dot -
 CreateProcessError=5 access is denied
In-Reply-To: <710248.52854.qm@web1004.biz.mail.sp1.yahoo.com>
References: <710248.52854.qm@web1004.biz.mail.sp1.yahoo.com>
Message-ID: <20090915094108.4AEFF34183C6@www.antlr.org>

At 18:07 15/09/2009, avidan efody wrote:
 >I'm trying to run Graphviz dot from Antlr on Windows Vista, and 
I
 >get the following error:
 >
 >java.io.IOException: Cannot run program ""C:\Program
 >Files\Graphviz2.24\bin"": CreateProcesserror=5, Access is denied

Have you tried adding dot.exe to the end of the path in the 
ANTLRWorks preferences?  Given the error message, it looks like 
it's wanting the filename, not the path.


From kpt at doc.ic.ac.uk  Tue Sep 15 04:41:39 2009
From: kpt at doc.ic.ac.uk (Kevin Twidle)
Date: Tue, 15 Sep 2009 13:41:39 +0200
Subject: [antlr-interest] Empty AST entry stops parsing
Message-ID: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.com>

I have been using my PonderTalk (Smalltalk like) language for a while now
and I have just noticed that leaving a block empty causes a parser error.
This is with ANTLRWorks 1.2.3. I have refined the grammar to show the point.
The problem line is ^(statements). With that taken out the parsing works.
grammar Trial;

options {
output = AST;
        k = 2;
}

start : sentences EOF
 ;
sentences
: sentence? (DOT sentences)?
 -> sentence? sentences?
;
sentence: WORD | block;
block : '[' sentences ']'
-> ^(sentences)
 ;

WORD : LETTER LETTER+;
LETTER : 'a'..'z';
DOT : '.';

The following input works as expected:
hello. [ block ]. goodbye

The following  just terminates the parser after processing the ']' with no
AST being produced at all:
hello. [ ] . goodbye

There are no errors. However with my PonderTalk parser I get

Exception thrown: rule sentences

org.antlr.runtime.tree.RewriteEmptyStreamException: rule sentences

at org.antlr.runtime.tree.RewriteRuleElementStream._next(
RewriteRuleElementStream.java:158)

at org.antlr.runtime.tree.RewriteRuleElementStream.nextTree(
RewriteRuleElementStream.java:145)

at net.ponder2.parser.PonderTalkParser.block(PonderTalkParser.java:1061)

at net.ponder2.parser.PonderTalkParser.object(PonderTalkParser.java:693)

at net.ponder2.parser.PonderTalkParser.objectMessage(
PonderTalkParser.java:470)

at net.ponder2.parser.PonderTalkParser.sentence(PonderTalkParser.java:323)

at net.ponder2.parser.PonderTalkParser.sentence(PonderTalkParser.java:341)

at net.ponder2.parser.PonderTalkParser.sentences(PonderTalkParser.java:194)

at net.ponder2.parser.PonderTalkParser.start(PonderTalkParser.java:129)

at net.ponder2.parser.P2Compiler.parse(P2Compiler.java:495)

at net.ponder2.parser.P2Compiler.parse(P2Compiler.java:440)

at net.ponder2.ShellInstance.doPonderTalk(ShellInstance.java:211)

at net.ponder2.ShellInstance.run(ShellInstance.java:163)

at java.lang.Thread.run(Thread.java:613)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090915/83300cf2/attachment.html 

From antlr at mirality.co.nz  Tue Sep 15 05:45:19 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 16 Sep 2009 00:45:19 +1200
Subject: [antlr-interest] Empty AST entry stops parsing
In-Reply-To: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.co
 m>
References: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.com>
Message-ID: <20090915124543.024F634183C6@www.antlr.org>

At 23:41 15/09/2009, Kevin Twidle wrote:
>I have been using my PonderTalk (Smalltalk like) language for a 
>while now and I have just noticed that leaving a block empty 
>causes a parser error. This is with ANTLRWorks 1.2.3. I have 
>refined the grammar to show the point. The problem line is 
>^(statements). With that taken out the parsing works.
[...]
>sentence:WORD | block;
>block:'[' sentences ']'
>-> ^(sentences)
>;

You should define an imaginary token to use as the root 
here.  Things go a little strange when you try to use a 
multi-token rule as the root, especially (as you've found) if it's 
optional.

tokens { BLOCK; }

block : '[' sentences ']'
   -> ^(BLOCK sentences)
   ;

Using imaginary tokens to indicate structure like this also helps 
when reading the tree (either via a tree parser or directly). 


From kpt at doc.ic.ac.uk  Tue Sep 15 06:20:14 2009
From: kpt at doc.ic.ac.uk (Kevin Twidle)
Date: Tue, 15 Sep 2009 15:20:14 +0200
Subject: [antlr-interest] Empty AST entry stops parsing
In-Reply-To: <E1MnXPb-0004RW-MJ@mx4.cc.ic.ac.uk>
References: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.com> 
	<E1MnXPb-0004RW-MJ@mx4.cc.ic.ac.uk>
Message-ID: <379fec730909150620k4168758bwf49cbf3bed0d6333@mail.gmail.com>

2009/9/15 Gavin Lambert <antlr at mirality.co.nz>

> At 23:41 15/09/2009, Kevin Twidle wrote:
> >I have been using my PonderTalk (Smalltalk like) language for a
> >while now and I have just noticed that leaving a block empty
> >causes a parser error. This is with ANTLRWorks 1.2.3. I have
>
...
>
> You should define an imaginary token to use as the root
> here.  Things go a little strange when you try to use a
> multi-token rule as the root, especially (as you've found) if it's
> optional.
>
> tokens { BLOCK; }
>
> block : '[' sentences ']'
>   -> ^(BLOCK sentences)
>   ;
>
> Using imaginary tokens to indicate structure like this also helps
> when reading the tree (either via a tree parser or directly).
>
>
Thanks for the fast reply.  Actually in my PonderTalk grammar I do have
those tokens. I have now added the token to my example and it still fails
with:
hello. [ ]. bye

The input of ANTLRWorks shows:
hello.[]

Ah! It does crash I wasn't looking at the output of ANTLRWorks (it's not in
the console):

line 1:6 no viable alternative at character ' '
line 1:8 no viable alternative at character ' '
line 1:11 no viable alternative at character ' '
Exception in thread "main"
org.antlr.runtime.tree.RewriteEmptyStreamException: rule sentences
 at
org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:158)
at
org.antlr.runtime.tree.RewriteRuleElementStream.nextTree(RewriteRuleElementStream.java:145)
 at TrialParser.block(TrialParser.java:504)
at TrialParser.sentence(TrialParser.java:395)
 at TrialParser.sentences(TrialParser.java:211)
at TrialParser.sentences(TrialParser.java:248)
 at TrialParser.start(TrialParser.java:116)
at __Test__.main(__Test__.java:14)


My grammar is now:

grammar Trial;

options {
output = AST;
        k = 2;
}

tokens{
        BLOCK = '_block';
}

start : sentences EOF
 ;
sentences
: sentence? (DOT sentences)?
 -> sentence? sentences?
;
sentence: WORD | block;
block : '[' sentences ']'
-> ^(BLOCK sentences)
 ;

WORD : LETTER LETTER+;
LETTER : 'a'..'z';
DOT : '.';
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090915/9b49c46a/attachment.html 

From jimi at temporal-wave.com  Tue Sep 15 08:17:51 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 15 Sep 2009 08:17:51 -0700
Subject: [antlr-interest] Empty AST entry stops parsing
In-Reply-To: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.com>
References: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.com>
Message-ID: <4AAFB01F.6050202@temporal-wave.com>

On 09/15/2009 04:41 AM, Kevin Twidle wrote:
> I have been using my PonderTalk (Smalltalk like) language for a while 
> now and I have just noticed that leaving a block empty causes a parser 
> error. This is with ANTLRWorks 1.2.3. I have refined the grammar to 
> show the point. The problem line is ^(statements). With that taken out 
> the parsing works.
>
> grammar Trial;
>
> options {
> output = AST;
>         k = 2;
> }
>
> start : sentences EOF
> ;
> sentences
> : sentence? (DOT sentences)?
> -> sentence? sentences?
> ;
> sentence: WORD | block;
> block : '[' sentences ']'
> -> ^(sentences)
> ;
>
You probably want to use an imaginary token as the root node of your 
block. ->^(BLOCK sentences?). Sentences acan be empty and you cannot 
rewrite it as the root node. Also, you probably want tokens for SENTENCE 
and perahps SENTENCES. If BLOCK is empty then deal with it specially in 
the tree grammar:

block : ^(BLOCK sentences)
           | BLOCK // Empty block
           ;


Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090915/77ea3614/attachment.html 

From lists at brachttal.net  Tue Sep 15 09:51:27 2009
From: lists at brachttal.net (Andreas Volz)
Date: Tue, 15 Sep 2009 18:51:27 +0200
Subject: [antlr-interest] Hex or Unicode char definition?
In-Reply-To: <20090913233812.71d3b8e3@frodo.mittelerde>
References: <20090913233812.71d3b8e3@frodo.mittelerde>
Message-ID: <20090915185127.6f763dc7@frodo.mittelerde>

Am Sun, 13 Sep 2009 23:38:12 +0200 schrieb Andreas Volz:

> Hello,
> 
> how is it possible to define chars as hex or unicode chars. e.g.:
> 
> fragment ALPHA
> 	: 'a'..'z' | 'A'..'Z' | '.' | ',' | ' ' | '@'
> 
> I have a syntax in rfc2234[1] format and there hex chars are defined.
> How should I transfer this to ANTLR? e.g.:
> 
>    CHAR         = %x01-7F
>         ; Any C0 Controls and Basic Latin, excluding NULL from
>         ; Code Charts, pages 7-6 through 7-9 in [UNICODE]
> 
> regards
> Andreas
> 
> [1] http://tools.ietf.org/html/rfc2234

Could nobody answer this question? I also asked myself where is defined
which chars are really between 'A'..'Z'. Does this depend on the
locale? For locale char detection I would expect a solution to define
unicode chars for a parser rule.

regards
Andreas

From jimi at temporal-wave.com  Tue Sep 15 11:34:57 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 15 Sep 2009 11:34:57 -0700
Subject: [antlr-interest] Hex or Unicode char definition?
In-Reply-To: <20090915185127.6f763dc7@frodo.mittelerde>
References: <20090913233812.71d3b8e3@frodo.mittelerde>
	<20090915185127.6f763dc7@frodo.mittelerde>
Message-ID: <FD2F4AD1-B407-4FD4-9E6D-C252685CDF2C@temporal-wave.com>

You have to specify the code point ranges explicitly. The range just  
uses the range defined according the standard Unicode code points.  
There is no significance in 'a'..'z' other than the code points for a  
and z. Use '\unnnn' for wierd and wonderful code points.

Jim

On Sep 15, 2009, at 9:51 AM, Andreas Volz <lists at brachttal.net> wrote:

> Am Sun, 13 Sep 2009 23:38:12 +0200 schrieb Andreas Volz:
>
>> Hello,
>>
>> how is it possible to define chars as hex or unicode chars. e.g.:
>>
>> fragment ALPHA
>>    : 'a'..'z' | 'A'..'Z' | '.' | ',' | ' ' | '@'
>>
>> I have a syntax in rfc2234[1] format and there hex chars are defined.
>> How should I transfer this to ANTLR? e.g.:
>>
>>   CHAR         = %x01-7F
>>        ; Any C0 Controls and Basic Latin, excluding NULL from
>>        ; Code Charts, pages 7-6 through 7-9 in [UNICODE]
>>
>> regards
>> Andreas
>>
>> [1] http://tools.ietf.org/html/rfc2234
>
> Could nobody answer this question? I also asked myself where is  
> defined
> which chars are really between 'A'..'Z'. Does this depend on the
> locale? For locale char detection I would expect a solution to define
> unicode chars for a parser rule.
>
> regards
> Andreas
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From juangelos at gmail.com  Tue Sep 15 11:43:57 2009
From: juangelos at gmail.com (=?UTF-8?Q?Juan_Ignacio_Gel=C3=B3s?=)
Date: Tue, 15 Sep 2009 11:43:57 -0700 (PDT)
Subject: [antlr-interest] =?utf-8?q?Invitaci=C3=B3n_a_conectarnos_en_Linke?=
	=?utf-8?q?dIn?=
Message-ID: <1432009663.4772420.1253040237559.JavaMail.app@ech3-cdn05.prod>

LinkedIn
------------

Juan Ignacio Gel?s requested to add you as a connection on LinkedIn:
------------------------------------------

Ian,

Me gustar?a a?adirte a mi red profesional en LinkedIn. 

-Juan Ignacio

Accept invitation from Juan Ignacio Gel?s
http://www.linkedin.com/e/XJ_Jh42eHeYQ_eJ2S5_J_0Ueq9jQFT3yBwA6v-/blk/I1434203521_2/pmpxnSRJrSdvj4R5fnhv9ClRsDgZp6lQs6lzoQ5AomZIpn8_cBYNczkPc38QcPgNiiYQplpGcPlylyYUdPgScjoVcPsLrCBxbOYWrSlI/EML_comm_afe/

View invitation from Juan Ignacio Gel?s
http://www.linkedin.com/e/XJ_Jh42eHeYQ_eJ2S5_J_0Ueq9jQFT3yBwA6v-/blk/I1434203521_2/39vcj8RcP0Od3cQckALqnpPbOYWrSlI/svi/

------------------------------------------

Why might connecting with Juan Ignacio Gel?s be a good idea?

Juan Ignacio Gel?s's connections could be useful to you:
After accepting Juan Ignacio Gel?s's invitation, check Juan Ignacio Gel?s's connections to see who else you may know and who you might want an introduction to. Building these connections can create opportunities in the future.

 
------
(c) 2009, LinkedIn Corporation

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090915/2e98fb9d/attachment.html 

From antlr at mirality.co.nz  Tue Sep 15 12:41:31 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 16 Sep 2009 07:41:31 +1200
Subject: [antlr-interest] Empty AST entry stops parsing
In-Reply-To: <379fec730909150620k4168758bwf49cbf3bed0d6333@mail.gmail.co
 m>
References: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.com>
	<E1MnXPb-0004RW-MJ@mx4.cc.ic.ac.uk>
	<379fec730909150620k4168758bwf49cbf3bed0d6333@mail.gmail.com>
Message-ID: <20090915194201.11AA334184A9@www.antlr.org>

At 01:20 16/09/2009, Kevin Twidle wrote:
>line 1:6 no viable alternative at character ' '
>line 1:8 no viable alternative at character ' '
>line 1:11 no viable alternative at character ' '

Those are because you haven't defined any lexer rules that can 
match whitespace.

>tokens{
>         BLOCK = '_block';
>}

That is *not* an imaginary token.  Remove the '= ...' part or 
it'll actually try to match that in the input.

>Exception in thread "main" 
>org.antlr.runtime.tree.RewriteEmptyStreamException: rule sentences
>at 
>org.antlr.runtime.tree.RewriteRuleElementStream._next(RewriteRuleElementStream.java:158)

This is because your 'sentences' rule may match nothing; in that 
case you need to use 'sentences?' in the rewrite in the block 
rule.

>start:sentences EOF
>;
>sentences
>:sentence? (DOT sentences)?
>-> sentence? sentences?
>;
>sentence:WORD | block;
>block:'[' sentences ']'
>-> ^(BLOCK sentences)
>;

Is it valid to have dots without anything else?  As your grammar 
stands at the moment, it'll accept '.....' in sentences.

If not, then you should express the optionality externally:

start : sentences? EOF ;
sentences : sentence (DOT sentence)* -> sentence+ ;
sentence : WORD | block ;
block : '[' sentences? ']' -> ^(BLOCK sentences?) ;

(I've also changed the sentences rule to use iteration rather than 
recursion, which is more efficient.) 


From AndrevdM at pyrogenesis.co.za  Tue Sep 15 13:46:45 2009
From: AndrevdM at pyrogenesis.co.za (=?iso-8859-1?Q?Andr=E9_van_der_Merwe?=)
Date: Tue, 15 Sep 2009 22:46:45 +0200
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?
In-Reply-To: <86403CA0939415448BCCB83855EFE09A0123F41B@Bloodymary.ironwillgames.com>
References: <E7035321714C624BA01ADCBA6F99CADF01457A2B4167@mercury.pyrogenesis.co.za>
	<86403CA0939415448BCCB83855EFE09A0123F41B@Bloodymary.ironwillgames.com>
Message-ID: <E7035321714C624BA01ADCBA6F99CADF01457A2B41FC@mercury.pyrogenesis.co.za>

Its working. Sam you were right all I needed to compile was Antlr.Runtime.



I needed to make a few changed to get it to compile for the CF. In case someone else wants to do this in the future here is what I did

* Created a new CF project and added all the existing .cs files 

* Add "DOTNET2" to the defines

* In AssemblyInfo.cs: Comment out AllowPartiallyTrustedCallers

* In Stats.cs: Replace call to Environment.GetCurrentPath with Asm.GetExecutingAssembly().GetName().CodeBase

* In ErrorManager.cs: Remove all references to StackTrace and StackFrame. It should be possible to get the required information from looking at the Exception parameter's StackTrace property and parsing the string. However I've just set the location to an empty string for now. (Fortunately for me, error handeling is not too important in my DSL)

* In TokenRewriteStream.cs: Replace call to Array.GetRange with a call to a custom method that does what GetRange does.

* In BaseRecogniser.cs: Throw a NotImplementedException in GetRuleInvocationStack(). Again it should be possible to parse the stack trace string but I'm not using this method so I'm just throwing.


All in all it was pretty simple to get working. 



-----Original Message-----
From: Sam Harwell [mailto:sharwell at pixelminegames.com] 
Sent: 14 September 2009 16:49
To: Andr? van der Merwe; antlr-interest at antlr.org
Subject: RE: [antlr-interest] ANTLR on Microsoft's Compact Framework?

Are you trying to run a generated parser, or are you actually trying to run Antlr3.exe on the CF to generate your parser?

If you only want to run the generated parser, then you probably only need to compile Antlr3.Runtime.dll (CSharp3 target) or Antlr.Runtime.dll (CSharp/CSharp2 target).

Sam

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andr? van der Merwe
Sent: Sunday, September 13, 2009 4:05 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?

Hi,

Has anyone managed to get an ANTLR generated parser (C#) working on the .net compact framework?

I doubt there are any major issues with the generated code but the references are going to be a problem. Before I go and recompile everything for the CF I wanted to check if there were known issues or perhaps someone has already done this?



From antlr at mirality.co.nz  Tue Sep 15 13:56:18 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Wed, 16 Sep 2009 08:56:18 +1200
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?
In-Reply-To: <E7035321714C624BA01ADCBA6F99CADF01457A2B41FC@mercury.pyrog
	enesis.co.za>
References: <E7035321714C624BA01ADCBA6F99CADF01457A2B4167@mercury.pyrogenesis.co.za>
	<86403CA0939415448BCCB83855EFE09A0123F41B@Bloodymary.ironwillgames.com>
	<E7035321714C624BA01ADCBA6F99CADF01457A2B41FC@mercury.pyrogenesis.co.za>
Message-ID: <20090915205644.494A23418464@www.antlr.org>

At 08:46 16/09/2009, Andr? van der Merwe wrote:
 >* In Stats.cs: Replace call to Environment.GetCurrentPath with
 >Asm.GetExecutingAssembly().GetName().CodeBase

Assuming you meant Environment.CurrentDirectory: 
those aren't equivalent.  Have you tried using 
Path.GetFullPath(".") instead?


From nikolay.ognyanov at travelstoremaker.com  Tue Sep 15 16:16:54 2009
From: nikolay.ognyanov at travelstoremaker.com (Nikolay Ognyanov)
Date: Wed, 16 Sep 2009 02:16:54 +0300
Subject: [antlr-interest] ANTLR 3 parser generating algorithm questions
Message-ID: <4AB02066.5030603@travelstoremaker.com>

I read through Terence Parr's book, ANTLR site and archives of this list 
but was not
able to find  answers to some questions related to ANTLR 3 parser generating
algorithm. Can somebody please answer the following?

    * Is there an accessible formal description (other than source code)
      of ANTLR 3 parser
      generating algorithm?
    * Is ANTLR 3 capable (apart from normal space and time limitations)
      of generating
      a parser for every LL(k) grammar? Or for every strong LL(k) grammar?
          o If not then what exactly are the limitations?
          o If yes then how exactly is lookahead beyond next symbol handled?
                + By computing in advance complete lookahead sets
                  wherever needed?
                + By generating DFAs which effectively compute at run
                  time (parts of)
                  lookahead sets needed?
                + Somehow else? How?
    * What exactly are the limitations of ANTLR 3 LL(*) parser
      generating strategy?
      Is it capable of handling wcwey regular lookahead language or are
      there some
      stronger limitations?
    * What exactly are the limitations for use of recursion in lexer
      grammars?


Regards
Nikolay

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090916/979d8e21/attachment.html 

From parrt at cs.usfca.edu  Tue Sep 15 16:44:44 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 15 Sep 2009 16:44:44 -0700
Subject: [antlr-interest] job available for ANTLR developer
Message-ID: <048276C3-3C0B-4620-85FE-1B6637BE1B13@cs.usfca.edu>

Forwarding...

>  ANTLR JOB OPPORTUNITY
> "Only serious inquiries by candidates who meet the minimum skill  
> requirements"
>
> LOCATION:  New York City
> START DATE:  October, 2009
> INTERVIEW PROCESS:  45 minute phone interview, 4 hour face-to-face  
> interview, 45 minute interview with CTO, Job Offer, Start Date 2-3  
> weeks after accepting offer.
>
> JOB TITLE:
> Sr. Java Developer
>
> MINIMUM REQUIRED SKILLS:
> Core Java (5 recent years), Multi-threading (5 recent years), ANTLR  
> (2 recent years), and Regular Expressions (Regex - nice to have).
>
> COMPENSATION:
> Base Salary of $120K-$140K + 20% to 40% Annual Bonus + $25K in STOCK  
> (100% vested after 3 years) + 3 weeks vacation + excellent PPO Plan  
> (Medical, Dental, Vision).
>
> RELOCATION ASSISTANCE:  Yes
>
> FOR MORE INFORMATION, CONTACT:  Tom at ChathamStaffing.com

From AndrevdM at pyrogenesis.co.za  Tue Sep 15 23:57:36 2009
From: AndrevdM at pyrogenesis.co.za (=?iso-8859-1?Q?Andr=E9_van_der_Merwe?=)
Date: Wed, 16 Sep 2009 08:57:36 +0200
Subject: [antlr-interest] ANTLR on Microsoft's Compact Framework?
In-Reply-To: <7c49e3b2-0d93-41cd-9896-dcf93e7d235d@Cockatrice.pgp3edge.local>
References: <E7035321714C624BA01ADCBA6F99CADF01457A2B4167@mercury.pyrogenesis.co.za>
	<86403CA0939415448BCCB83855EFE09A0123F41B@Bloodymary.ironwillgames.com>
	<E7035321714C624BA01ADCBA6F99CADF01457A2B41FC@mercury.pyrogenesis.co.za>
	<7c49e3b2-0d93-41cd-9896-dcf93e7d235d@Cockatrice.pgp3edge.local>
Message-ID: <E7035321714C624BA01ADCBA6F99CADF01457A2B4208@mercury.pyrogenesis.co.za>

>Assuming you meant Environment.CurrentDirectory: 
>those aren't equivalent.  Have you tried using 
>Path.GetFullPath(".") instead?

Woops. Thanks, that was silly of me :)


From gxs213 at case.edu  Wed Sep 16 00:36:44 2009
From: gxs213 at case.edu (Gang Shu)
Date: Wed, 16 Sep 2009 03:36:44 -0400
Subject: [antlr-interest] About API in ANTLRWorks
Message-ID: <005601ca36a0$71484770$53d8d650$@edu>

 

Hey,

Is there any API in ANTLRWorks I can use to directly get the parse tree of a
sample source code?

 

I want to analyze the parse tree generated from Integrated Debugger in
ANTLRWorks. Is there any API in the ANTLRWorks for this goal? Thanks a lot!

 

Best,

Gang 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090916/765860a7/attachment.html 

From craig at palantir.co.za  Wed Sep 16 00:55:06 2009
From: craig at palantir.co.za (craig at palantir.co.za)
Date: Wed, 16 Sep 2009 09:55:06 +0200
Subject: [antlr-interest] template % question.
Message-ID: <20090916095506.z96tfr0c0s80wkws@webmail.palantir.co.za>

Hi,

trying to parse the following:
(The problem is with the template %join)

relativePath
	: ('//'|'/') (ns=QNAME ':')? nm=QNAME
        { $st = %join(table={$QNAME.text}); }
	| dot='.' -> {%{$dot.text}}
	| STRING -> {%{$STRING.text}}
	| '@' qn=QNAME -> {%{$QNAME.text}}
	| cm=comp -> template(c={$cm.st}) "<c>"
	;
I get the following error,

error(100): :1:1: syntax error: antlr: XPathSqlTree.g:1:1: unexpected token:
join
error(10):  internal error:
	Exception java.lang.ClassCastException: Unable to cast object of type
'antlr.CommonToken' to
	 type
'antlr.TokenWithIndex'. at antlr.TokenStreamRewriteEngine.nextToken(TokenStreamRewriteEngine.java:161):
	can't parse template action

what am I doing wrong.


----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From kpt at doc.ic.ac.uk  Wed Sep 16 01:35:39 2009
From: kpt at doc.ic.ac.uk (Kevin Twidle)
Date: Wed, 16 Sep 2009 10:35:39 +0200
Subject: [antlr-interest] Empty AST entry stops parsing
In-Reply-To: <E1MnduO-0005It-OP@mx1.cc.ic.ac.uk>
References: <379fec730909150441w4889bcd5g3d4ca18e8209345e@mail.gmail.com> 
	<E1MnXPb-0004RW-MJ@mx4.cc.ic.ac.uk>
	<379fec730909150620k4168758bwf49cbf3bed0d6333@mail.gmail.com> 
	<E1MnduO-0005It-OP@mx1.cc.ic.ac.uk>
Message-ID: <379fec730909160135t5ec2bca4sdf09aebeafe7d545@mail.gmail.com>

Gavin,
Again, thanks for the fast response.

2009/9/15 Gavin Lambert <antlr at mirality.co.nz>

>
> >tokens{
> >         BLOCK = '_block';
> >}
>
> That is *not* an imaginary token.  Remove the '= ...' part or
> it'll actually try to match that in the input.
>

I didn't understand this at first because it seems to work the same both
ways. However, I just remembered that I used a variable name in my language
that got flagged by the compiler as being the same as one of the virtual
tokens like the one above. I could not understand it at the time and put an
'_' in front of all the virtual tokens so that there would be no clash. In
my language I have many like this because I saw it in an example somewhere.
 I shall strip out all the values, I assume that it will also make the
parsing more efficient.


> If not, then you should express the optionality externally:
>
> start : sentences? EOF ;
> sentences : sentence (DOT sentence)* -> sentence+ ;
> sentence : WORD | block ;
> block : '[' sentences? ']' -> ^(BLOCK sentences?) ;
>
> (I've also changed the sentences rule to use iteration rather than
> recursion, which is more efficient.)
>
> Much better, thanks. I have done the appropriate changes to my language and
can now have an empty block (of course I am now wondering whether that
should be a valid construct but that's another matter!).

You have also indirectly helped me with my lexer include files.

I think ANTLR is an amazing tool. When I think back to my yacc days ...

Cheers,

Kevin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090916/bf81bee9/attachment.html 

From indhu.b at s7software.com  Wed Sep 16 04:33:05 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Wed, 16 Sep 2009 17:03:05 +0530
Subject: [antlr-interest] About API in ANTLRWorks
In-Reply-To: <005601ca36a0$71484770$53d8d650$@edu>
References: <005601ca36a0$71484770$53d8d650$@edu>
Message-ID: <007801ca36c1$7715dcf0$654196d0$@b@s7software.com>

A related mail from archive:

 

 

you mean a parse tree, not AST, right?  There is a ParseTreeBuilder i think.

T

On Sep 1, 2009, at 12:50 PM, Stefan Groschupf wrote:

 

> Hi,

> I'm making my first baby with antlr.

> Is there any chance to get a AST exactly as antlr work is generating 

> without rewriting rules.

> Thanks,

> Stefan

 

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Gang Shu
Sent: Wednesday, September 16, 2009 1:07 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] About API in ANTLRWorks

 

 

Hey,

Is there any API in ANTLRWorks I can use to directly get the parse tree of a
sample source code?

 

I want to analyze the parse tree generated from Integrated Debugger in
ANTLRWorks. Is there any API in the ANTLRWorks for this goal? Thanks a lot!

 

Best,

Gang 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090916/5c5e5157/attachment.html 

From jimi at temporal-wave.com  Wed Sep 16 05:23:42 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 16 Sep 2009 05:23:42 -0700
Subject: [antlr-interest] About API in ANTLRWorks
In-Reply-To: <005601ca36a0$71484770$53d8d650$@edu>
References: <005601ca36a0$71484770$53d8d650$@edu>
Message-ID: <D3F700AA-49F2-44B7-AA9E-EBC1A4C58D3C@temporal-wave.com>

See the wiki article on getting the parse tree rather than an AST.  
Also search prior posts to this list.

Jim

On Sep 16, 2009, at 12:36 AM, "Gang Shu" <gxs213 at case.edu> wrote:

>
>
> Hey,
>
> Is there any API in ANTLRWorks I can use to directly get the parse  
> tree of a sample source code?
>
>
>
> I want to analyze the parse tree generated from Integrated Debugger  
> in ANTLRWorks. Is there any API in the ANTLRWorks for this goal?  
> Thanks a lot!
>
>
>
> Best,
>
> Gang
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090916/e0b5e95e/attachment.html 

From jimi at temporal-wave.com  Wed Sep 16 05:28:13 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 16 Sep 2009 05:28:13 -0700
Subject: [antlr-interest] template % question.
In-Reply-To: <20090916095506.z96tfr0c0s80wkws@webmail.palantir.co.za>
References: <20090916095506.z96tfr0c0s80wkws@webmail.palantir.co.za>
Message-ID: <AE4660D0-C96B-4905-848F-0448904C75C7@temporal-wave.com>

I think that this might be a known bug which is fixed in the 3.1.4  
snapshot. Download and try that.

If not that bug then something in your grammar that I can't see on my  
iphone.

Jim

On Sep 16, 2009, at 12:55 AM, craig at palantir.co.za wrote:

> Hi,
>
> trying to parse the following:
> (The problem is with the template %join)
>
> relativePath
>    : ('//'|'/') (ns=QNAME ':')? nm=QNAME
>        { $st = %join(table={$QNAME.text}); }
>    | dot='.' -> {%{$dot.text}}
>    | STRING -> {%{$STRING.text}}
>    | '@' qn=QNAME -> {%{$QNAME.text}}
>    | cm=comp -> template(c={$cm.st}) "<c>"
>    ;
> I get the following error,
>
> error(100): :1:1: syntax error: antlr: XPathSqlTree.g:1:1:  
> unexpected token:
> join
> error(10):  internal error:
>    Exception java.lang.ClassCastException: Unable to cast object of  
> type
> 'antlr.CommonToken' to
>     type
> 'antlr.TokenWithIndex'. at antlr.TokenStreamRewriteEngine.nextToken 
> (TokenStreamRewriteEngine.java:161):
>    can't parse template action
>
> what am I doing wrong.
>
>
> ----------------------------------------------------------------
> This message was sent using IMP, the Internet Messaging Program.
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From gxs213 at case.edu  Wed Sep 16 11:52:10 2009
From: gxs213 at case.edu (Gang Shu)
Date: Wed, 16 Sep 2009 14:52:10 -0400
Subject: [antlr-interest] About API in ANTLRWorks
In-Reply-To: <D3F700AA-49F2-44B7-AA9E-EBC1A4C58D3C@temporal-wave.com>
References: <005601ca36a0$71484770$53d8d650$@edu>
	<D3F700AA-49F2-44B7-AA9E-EBC1A4C58D3C@temporal-wave.com>
Message-ID: <000001ca36fe$cc80b2e0$658218a0$@edu>

Thanks a lot for your kind information. It is really helpful.

Best,

Gang

 

From: Jim Idle [mailto:jimi at temporal-wave.com] 
Sent: Wednesday, September 16, 2009 8:24 AM
To: Gang Shu
Cc: <antlr-interest at antlr.org>
Subject: Re: [antlr-interest] About API in ANTLRWorks

 

See the wiki article on getting the parse tree rather than an AST. Also
search prior posts to this list. 

 

Jim

On Sep 16, 2009, at 12:36 AM, "Gang Shu" <gxs213 at case.edu> wrote:

 

Hey,

Is there any API in ANTLRWorks I can use to directly get the parse tree of a
sample source code?

 

I want to analyze the parse tree generated from Integrated Debugger in
ANTLRWorks. Is there any API in the ANTLRWorks for this goal? Thanks a lot!

 

Best,

Gang 

 


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090916/be4b40f2/attachment.html 

From paul.m.ramirez at jpl.nasa.gov  Wed Sep 16 12:00:07 2009
From: paul.m.ramirez at jpl.nasa.gov (Ramirez, Paul M (388J))
Date: Wed, 16 Sep 2009 12:00:07 -0700
Subject: [antlr-interest] Grammar EOL or END token
Message-ID: <C6D683C7.92C6%Paul.M.Ramirez@jpl.nasa.gov>

Hi All,

I'm looking for some help with a grammar that has been written to parse a text file which contains some metadata. We are using the grammar to build up an object representation of the metadata file as the grammar is run. This is being done to run higher level validation and allow programmatic access to the metadata. The issue at hand is that the format has nesting mechanisms that when not closed as expected (i.e. EOF or an "END" token) we would like exit gracefully by closing off the nesting statement.

Here is an example of the format:

PDS_VERSION_ID = PDS3
LABEL_REVISION_NOTE = "some text here"

OBJECT = IMAGE
   LINES = 960
   LINE_SAMPLES = 956
   SAMPLE_TYPE = UNSIGNED_INTEGER
   SAMPLE_BITS = 8
   SAMPLE_BIT_MASK = 2#1111111111#
END_OBJECT

END

So what you can tell here is we really have a "key = value" type file with some simple nesting. Below are snippets of the grammar for this file. What we want is to be able to gracefully exit the "OBJECT = IMAGE" statement (rule) if we come upon the EOF or "END" token instead of the expected "END_OBJECT" token. I left in the code that we are using to generate the object model to give context but the real issue is what grammar changes to make.

label[Label label]
@init {this.label = label;}
@after {label.checkLineLengths();}
    : ( s=statement[label] {if (s != null) {label.addStatement(s);}} )*
      (END | EOF)
    ;

statement[Label label] returns [Statement result = null]
    : s=simple_statement[label]
        {result = s;}
    | g=group_statement[label]
        {result = g;}
    | o=object_statement[label]
        {result = o;}
    ;
    catch [RecognitionException re] {
        while(input.LA(1)!= EOL && input.LA(1) != CharStream.EOF) {
            input.consume();
        }
        if(input.LA(1) == EOL) {
            input.consume();
        }
        if (!suppress)
            label.addProblem(re.line, re.charPositionInLine, re.getMessage(), ProblemType.PARSE_ERROR);
    }

object_statement[Label label] returns [ObjectStatement result = null]
    : 'OBJECT' nl '=' nl id=IDENTIFIER (c=COMMENT)? EOL
        {
            result = new ObjectStatement(id.getLine(), id.getText(), label.getFile());
            if (c != null) {
                CommentStatement comment = new CommentStatement(c.getLine(), label.getFile());
                comment.setComment(c.getText());
                result.attachComment(comment);
            }
        }
      (
        s=statement[label] {if (s != null) {result.addStatement(s);}}
      |
        (~ END_OBJECT) => t=.
          {
              if (!suppress) {
                  label.addProblem(t.getLine(),t.getCharPositionInLine(), "Illegal start of statement: '" + t.getText() + "'", ProblemType.PARSE_ERROR);
              }
          }
        (~ EOL)* EOL
      )*
        END_OBJECT ('=' id2=IDENTIFIER)?
        (c2=COMMENT)? EOL
        {
            if (result != null && c2 != null) {
                CommentStatement comment = new CommentStatement(c2.getLine(), label.getFile());
                comment.setComment(c.getText());
                result.attachComment(comment);
            }
        }
    ;


Thanks, in advance for any help you can provide.

Sincerely,
Paul Ramirez
Jet Propulsion Laboratory
pramirez at jpl.nasa.gov

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090916/a609aa2c/attachment.html 

From marco at mtsystems.ch  Thu Sep 17 06:32:42 2009
From: marco at mtsystems.ch (Marco Trudel)
Date: Thu, 17 Sep 2009 15:32:42 +0200
Subject: [antlr-interest] conditional tree rewrite
Message-ID: <4AB23A7A.2000809@mtsystems.ch>

Dear all

I'm trying to adapt the "ANSI C grammar for ANTLR v3" so that it 
generates an AST. So my first step was to change all rules like:

lvalue
	:	unary_expression
	;

to

lvalue : lvalue2 -> ^(ART_LVALUE lvalue2);
lvalue2
	:	unary_expression
	;

This already gives me a nice AST, except for expressions. For instance 
"0" will be represented as:
ART_EXPRESSION
'-ART_ASSIGNMENT_EXPRESSION
   '- ART_CONDITIONAL_EXPRESSION
      '- ART_LOGICAL_AND_EXPRESSION
             .
             .
             .
                '- ART_PRIMARY_EXPRESSION
                   '- ART_CONSTANT
                      '- 0

I assume that the grammar has been build this way for performance 
reasons. The rule for conditional_expression for instance looks like:

conditional_expression
	: logical_or_expression ('?' expression ':' conditional_expression)?
	;

So it's actually not a conditional_expression if the part in parentheses 
isn't there. So my initial rewrite:

conditional_expression : conditional_expression2 -> 
^(ART_CONDITIONAL_EXPRESSION conditional_expression2);
conditional_expression2
	: logical_or_expression ('?' expression ':' conditional_expression)?
	;

creates a "wrong" AST if it's actually not a conditional expression and 
I'm now trying to create the tree conditionally. My first approach was 
to change the rules this way:

conditional_expression
	: conditional_expression2 -> ^(ART_CONDITIONAL_EXPRESSION 
conditional_expression2);
	| logical_or_expression
	;
conditional_expression2
	: logical_or_expression '?' expression ':' conditional_expression
	;

But, since there are 16 rules to adapt, after about 6 I run into 
"internal error: ...: could not even do k=1 for decision 49; reason: 
timed out (>1000ms)". So this creates too much ambiguity and therefore I 
went for syntactic predicates:

conditional_expression
	: ( logical_or_expression '?' expression ':' conditional_expression )
		=> logical_or_expression '?' expression ':' conditional_expression -> 
^(ART_CONDITIONAL_EXPRESSION logical_or_expression '?' expression ':' 
conditional_expression)
		|  logical_or_expression
	;

But the same problem (too ambiguous to compile). So I'm really stuck now 
since I don't know how to do this correct (meaning efficient). I could 
imagine that this can be done with semantic predicates (I don't know 
how) but I'm not sure about the runtime overhead when parsing a C file. 
Or I can go over the created tree myself and clean up the expressions. 
But the tree is already substantial bigger than it should be because of 
the intermediate wrong "foo_expression", so I guess solving the problem 
at the grammar level is better.

Any opinions? Maybe I miss the completely obvious solution...
I think I should add that I'm a complete ANTLR beginner; so everything I 
wrote might make no sense at all.


Thanks and have a nice day
Marco

From holstebroe at gmail.com  Thu Sep 17 07:55:20 2009
From: holstebroe at gmail.com (Soren Holstebroe)
Date: Thu, 17 Sep 2009 09:55:20 -0500
Subject: [antlr-interest] Parsing comments
Message-ID: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>

Hi,

I have this project where C++ templates are being unfolded and wrapped in
.NET. This wrapping is performed by some perl-scripts which over time have
become quite messy, so I wanted to rewrite the wrapper using ANTLR.

The way the current template wrapper works is by parsing simple template
expressions defined in the comments preceding a function definition. This is
similar to documentation frameworks like doxygen, where the documentation is
embedded in the comments above functions, classes, etc.
The simple syntax contains elements like this:
// @TEMPLATE <int, float>
which tells the wrapper to unfold the template using an int for the first
template type and a float for the second.

My problem is that I am already stuck in defining the lexer.
Since all wrapper expressions start with '@' I tried to define a token like:
WRAPPERSTART : SLASHSLASH SPACE* '@'
and some grammar rules based on that token.
However that doesn't work since the lexer will always choose the longest
matching rule, which would always be the normal single line comment rule.

I can imagine that there are many approaches to tackle this problem and some
hints would be greatly appreciated.

Soren
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/4a8bdd79/attachment.html 

From jimi at temporal-wave.com  Thu Sep 17 07:57:35 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Sep 2009 07:57:35 -0700
Subject: [antlr-interest] conditional tree rewrite
In-Reply-To: <4AB23A7A.2000809@mtsystems.ch>
References: <4AB23A7A.2000809@mtsystems.ch>
Message-ID: <72DC5775-83F7-40D6-93DD-4E69B99EC656@temporal-wave.com>

Marco,

You can rewrite inside any alt so only rewrite as conditional if you  
take that alt. Also, avoid imaginary token bloat- you don't need the  
imaginaries in expression trees (generally) and can just use the ^  
operator. The AST is more about being unambiguous and easilly walkable  
than how it looks to you when you print the tree. You probably want to  
lose the 'literals' and make these lexer defined tokens. It will be  
easier when you build the tree walker.

Jim

On Sep 17, 2009, at 6:32 AM, Marco Trudel <marco at mtsystems.ch> wrote:

> Dear all
>
> I'm trying to adapt the "ANSI C grammar for ANTLR v3" so that it
> generates an AST. So my first step was to change all rules like:
>
> lvalue
>    :    unary_expression
>    ;
>
> to
>
> lvalue : lvalue2 -> ^(ART_LVALUE lvalue2);
> lvalue2
>    :    unary_expression
>    ;
>
> This already gives me a nice AST, except for expressions. For instance
> "0" will be represented as:
> ART_EXPRESSION
> '-ART_ASSIGNMENT_EXPRESSION
>   '- ART_CONDITIONAL_EXPRESSION
>      '- ART_LOGICAL_AND_EXPRESSION
>             .
>             .
>             .
>                '- ART_PRIMARY_EXPRESSION
>                   '- ART_CONSTANT
>                      '- 0
>
> I assume that the grammar has been build this way for performance
> reasons. The rule for conditional_expression for instance looks like:
>
> conditional_expression
>    : logical_or_expression ('?' expression ':'  
> conditional_expression)?
>    ;
>
> So it's actually not a conditional_expression if the part in  
> parentheses
> isn't there. So my initial rewrite:
>
> conditional_expression : conditional_expression2 ->
> ^(ART_CONDITIONAL_EXPRESSION conditional_expression2);
> conditional_expression2
>    : logical_or_expression ('?' expression ':'  
> conditional_expression)?
>    ;
>
> creates a "wrong" AST if it's actually not a conditional expression  
> and
> I'm now trying to create the tree conditionally. My first approach was
> to change the rules this way:
>
> conditional_expression
>    : conditional_expression2 -> ^(ART_CONDITIONAL_EXPRESSION
> conditional_expression2);
>    | logical_or_expression
>    ;
> conditional_expression2
>    : logical_or_expression '?' expression ':' conditional_expression
>    ;
>
> But, since there are 16 rules to adapt, after about 6 I run into
> "internal error: ...: could not even do k=1 for decision 49; reason:
> timed out (>1000ms)". So this creates too much ambiguity and  
> therefore I
> went for syntactic predicates:
>
> conditional_expression
>    : ( logical_or_expression '?' expression ':'  
> conditional_expression )
>        => logical_or_expression '?' expression ':'  
> conditional_expression ->
> ^(ART_CONDITIONAL_EXPRESSION logical_or_expression '?' expression ':'
> conditional_expression)
>        |  logical_or_expression
>    ;
>
> But the same problem (too ambiguous to compile). So I'm really stuck  
> now
> since I don't know how to do this correct (meaning efficient). I could
> imagine that this can be done with semantic predicates (I don't know
> how) but I'm not sure about the runtime overhead when parsing a C  
> file.
> Or I can go over the created tree myself and clean up the expressions.
> But the tree is already substantial bigger than it should be because  
> of
> the intermediate wrong "foo_expression", so I guess solving the  
> problem
> at the grammar level is better.
>
> Any opinions? Maybe I miss the completely obvious solution...
> I think I should add that I'm a complete ANTLR beginner; so  
> everything I
> wrote might make no sense at all.
>
>
> Thanks and have a nice day
> Marco
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jimi at temporal-wave.com  Thu Sep 17 08:31:28 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Sep 2009 08:31:28 -0700
Subject: [antlr-interest] Parsing comments
In-Reply-To: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>
References: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>
Message-ID: <CCFCC068-50BF-4280-BE57-804CE0554A37@temporal-wave.com>

fragment WRAPPER : ;
COMMENT : '//' SPACE*
      ( ('@')=> '@' (~WSCHARS)* { $type = WRAPPER; }
         |  ' (~WSCHARS)*
       )
;

Always left factor and change the token type dynamically.

Jim

On Sep 17, 2009, at 7:55 AM, Soren Holstebroe <holstebroe at gmail.com>  
wrote:

> Hi,
>
> I have this project where C++ templates are being unfolded and  
> wrapped in .NET. This wrapping is performed by some perl-scripts  
> which over time have become quite messy, so I wanted to rewrite the  
> wrapper using ANTLR.
>
> The way the current template wrapper works is by parsing simple  
> template expressions defined in the comments preceding a function  
> definition. This is similar to documentation frameworks like  
> doxygen, where the documentation is embedded in the comments above  
> functions, classes, etc.
> The simple syntax contains elements like this:
> // @TEMPLATE <int, float>
> which tells the wrapper to unfold the template using an int for the  
> first template type and a float for the second.
>
> My problem is that I am already stuck in defining the lexer.
> Since all wrapper expressions start with '@' I tried to define a  
> token like:
> WRAPPERSTART : SLASHSLASH SPACE* '@'
> and some grammar rules based on that token.
> However that doesn't work since the lexer will always choose the  
> longest matching rule, which would always be the normal single line  
> comment rule.
>
> I can imagine that there are many approaches to tackle this problem  
> and some hints would be greatly appreciated.
>
> Soren
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From indhu.b at s7software.com  Thu Sep 17 08:33:03 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Thu, 17 Sep 2009 21:03:03 +0530
Subject: [antlr-interest] Parsing comments
In-Reply-To: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>
References: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>
Message-ID: <001e01ca37ac$26455120$72cff360$@b@s7software.com>

Try using semantic predicates to look-ahead and decide whether to emit
SLCOMMENT or TEMPLATE

 

Something like:

 

fragment SLCOMMENT

                :               ;

 

fragment TEMPLATE

                :               ;

 

SLCOMMENT_OR_TEMPLATE

                :               '//' (

                                                { input.LA(1)=='@' }?=> (
options {greedy=false;} : . )* EOL    { $type=TEMPLATE; }

                                |              ( options {greedy=false;} : .
)* EOL    { $type=SLCOMMENT; }

                                )

                ;

 

Cheers, Indhu

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Soren Holstebroe
Sent: Thursday, September 17, 2009 8:25 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Parsing comments

 

Hi,

I have this project where C++ templates are being unfolded and wrapped in
.NET. This wrapping is performed by some perl-scripts which over time have
become quite messy, so I wanted to rewrite the wrapper using ANTLR.

The way the current template wrapper works is by parsing simple template
expressions defined in the comments preceding a function definition. This is
similar to documentation frameworks like doxygen, where the documentation is
embedded in the comments above functions, classes, etc.
The simple syntax contains elements like this:
// @TEMPLATE <int, float>
which tells the wrapper to unfold the template using an int for the first
template type and a float for the second.

My problem is that I am already stuck in defining the lexer. 
Since all wrapper expressions start with '@' I tried to define a token like:
WRAPPERSTART : SLASHSLASH SPACE* '@'
and some grammar rules based on that token. 
However that doesn't work since the lexer will always choose the longest
matching rule, which would always be the normal single line comment rule.

I can imagine that there are many approaches to tackle this problem and some
hints would be greatly appreciated.

Soren

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/0b3b0cec/attachment.html 

From dmarin at sice.com  Thu Sep 17 09:00:31 2009
From: dmarin at sice.com (=?iso-8859-1?Q?David_Mar=EDn_Carre=F1o?=)
Date: Thu, 17 Sep 2009 18:00:31 +0200
Subject: [antlr-interest] (no subject)
Message-ID: <D7E350C5D8CD4354840208FB6040F5B4@PDMCSICALC>

Hi all.

I am developing a tree parser, and I have a problem with the if/then/else
construction.

My AST tree has the following formats for conditional statements:

^(IF condition ^(THEN statements)) |
^(IFELSE condition ^(THEN then_s=statements) ^(ELSE else_s=statements))


I don't know how to skip THEN statements when the condition is false.
I am trying the following:

conditionalifthen: 
  ^(IF expression ( { $expression.value != 0 }? => ^(THEN statements) | .));
     
conditionalifthenelse: 
  ^(IFELSE expression
    ( { $expression.value != 0 }? => ^(THEN statements) . |
                                    . ^(ELSE statements) ));

without success, until now.

Any clue of how can I solve this problem, or which documentation can I
follow?

Thanks a lot.

Greetings,
-- 
David Mar?n Carre?o 
S.I.C.E. 
Direcci?n T?cnica. 
Tfno 91 623 22 30
E-mail: dmarin at sice.com
?




From holstebroe at gmail.com  Thu Sep 17 09:59:50 2009
From: holstebroe at gmail.com (Soren Holstebroe)
Date: Thu, 17 Sep 2009 11:59:50 -0500
Subject: [antlr-interest] Parsing comments
In-Reply-To: <-7810524811448615801@unknownmsgid>
References: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>
	<-7810524811448615801@unknownmsgid>
Message-ID: <94db0a160909170959x1ce61d90qd0bc2f161c8fe752@mail.gmail.com>

Thank you for your answer,

As i understand it, your suggestion considers the whole template line as a
single token, but I don't want the template token to eat up the rest of the
line, since this is where my template wrapping grammar would be.

My grammar will have rules like this:

wrap_option
    : WRAP_OPTION_BEGIN
    (  'WRAP'
    | 'TEMPLATE' '<' type_specifier (',' type_specifier)* '>'
    )
    ;

so I need something to match '//' WS* '@' as my WRAP_OPTION_BEGIN.

Soren

2009/9/17 Indhu Bharathi <indhu.b at s7software.com>

>  Try using semantic predicates to look-ahead and decide whether to emit
> SLCOMMENT or TEMPLATE
>
>
>
> Something like:
>
>
>
> fragment SLCOMMENT
>
>                 :               ;
>
>
>
> fragment TEMPLATE
>
>                 :               ;
>
>
>
> SLCOMMENT_OR_TEMPLATE
>
>                 :               '//' (
>
>                                                 { input.LA(1)=='@' }?=> (
> options {greedy=false;} : . )* EOL    { $type=TEMPLATE; }
>
>                                 |              ( options {greedy=false;} :
> . )* EOL    { $type=SLCOMMENT; }
>
>                                 )
>
>                 ;
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/42f9c3c2/attachment.html 

From gxs213 at case.edu  Thu Sep 17 10:06:17 2009
From: gxs213 at case.edu (Gang Shu)
Date: Thu, 17 Sep 2009 13:06:17 -0400
Subject: [antlr-interest] About API in ANTLRWorks
In-Reply-To: <007801ca36c1$7715dcf0$654196d0$@b@s7software.com>
References: <005601ca36a0$71484770$53d8d650$@edu>
	<007801ca36c1$7715dcf0$654196d0$@b@s7software.com>
Message-ID: <001b01ca37b9$2c5a8e10$850faa30$@edu>

Hi,

Thanks a lot for your suggestion.

I have another question. I am using ParseTreeBuilder to get ParseTree,
however, I cannot get the line location of a token in original source code
by parseTree.getLine().

The results of getLine() in the parseTree and its sub-parseTree are always
zero. How can I figure it out? Thanks!

 

ParseTreeBuilder builder = new ParseTreeBuilder("nil");

Parser parser = new Parser(tokens,builder);

parser.compilationUnit();

TokenStream inputStream = parser.input;

ParseTree parseTree = builder.getTree();

 

parseTree.getLine(); ---------------------? always 0

parseTree.getChild(0).getLine();---------? always 0

 

 

I was used to analyze source code using AST, and I can precisely get the
line location of a certain token by the following codes:

Parser parser = new Parser(tokens);  

parser.setTreeAdaptor(adaptor);  

Parser.compilationUnit_return ret = parser.compilationUnit();  

Asttree = (CommonTree) ret.getTree();  

 

Asttree.getChild(0).getLine();---------------?could give me the correct the
line location of the first token.

 

Best,

Gang

 

From: Indhu Bharathi [mailto:indhu.b at s7software.com] 
Sent: Wednesday, September 16, 2009 7:33 AM
To: 'Gang Shu'; antlr-interest at antlr.org
Subject: RE: [antlr-interest] About API in ANTLRWorks

 

A related mail from archive:

 

 

you mean a parse tree, not AST, right?  There is a ParseTreeBuilder i think.

T

On Sep 1, 2009, at 12:50 PM, Stefan Groschupf wrote:

 

> Hi,

> I'm making my first baby with antlr.

> Is there any chance to get a AST exactly as antlr work is generating 

> without rewriting rules.

> Thanks,

> Stefan

 

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Gang Shu
Sent: Wednesday, September 16, 2009 1:07 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] About API in ANTLRWorks

 

 

Hey,

Is there any API in ANTLRWorks I can use to directly get the parse tree of a
sample source code?

 

I want to analyze the parse tree generated from Integrated Debugger in
ANTLRWorks. Is there any API in the ANTLRWorks for this goal? Thanks a lot!

 

Best,

Gang 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/d8620176/attachment.html 

From david-sarah at jacaranda.org  Thu Sep 17 11:33:57 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 17 Sep 2009 19:33:57 +0100
Subject: [antlr-interest] Parsing comments
In-Reply-To: <94db0a160909170959x1ce61d90qd0bc2f161c8fe752@mail.gmail.com>
References: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>	<-7810524811448615801@unknownmsgid>
	<94db0a160909170959x1ce61d90qd0bc2f161c8fe752@mail.gmail.com>
Message-ID: <4AB28115.5080508@jacaranda.org>

Soren Holstebroe wrote:
> Thank you for your answer,
> 
> As i understand it, your suggestion considers the whole template line as a
> single token, but I don't want the template token to eat up the rest of the
> line, since this is where my template wrapping grammar would be.
> 
> My grammar will have rules like this:
> 
> wrap_option
>     : WRAP_OPTION_BEGIN
>     (  'WRAP'
>     | 'TEMPLATE' '<' type_specifier (',' type_specifier)* '>'
>     )
>     ;
> 
> so I need something to match '//' WS* '@' as my WRAP_OPTION_BEGIN.

The tricky part here is that the parser should ideally report an error
if the template line does not end with a newline, but newline would
normally be a hidden token. Here's a possible solution (untested):


@lexer::members {
  private int newlineChannel = HIDDEN;
}

fragment WRAP_OPTION_BEGIN : ;

SLCOMMENT
  : '//' WS? ( '@' { $type = WRAP_OPTION_BEGIN;
                     newlineChannel = DEFAULT_CHANNEL; }
             | ( ~('@' | '\r' | '\n' | ' ' | '\t') (~('\r' | '\n'))* )? EOL
                   { $channel = HIDDEN; }
             )
  ;

NEWLINE
  : ('\r' '\n'? | '\n')
      { $channel = newlineChannel;
        newlineChannel = HIDDEN; }
  ;

fragment EOL
  : NEWLINE
  // allow single-line comment without newline at end of file
  | { input.LA(1) == EOF }?
  ;

WS : (' ' | '\t')+ { $channel = HIDDEN; } ;

// parser

wrap_option
  : WRAP_OPTION_BEGIN
  ( 'WRAP'
  | 'TEMPLATE' '<' type_specifier (',' type_specifier)* '>'
  )
  NEWLINE
  ;

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Thu Sep 17 11:34:40 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Sep 2009 11:34:40 -0700
Subject: [antlr-interest] Parsing comments
In-Reply-To: <94db0a160909170959x1ce61d90qd0bc2f161c8fe752@mail.gmail.com>
References: <94db0a160909170755q6aea52a6n9e8327548c8b2e97@mail.gmail.com>
	<-7810524811448615801@unknownmsgid>
	<94db0a160909170959x1ce61d90qd0bc2f161c8fe752@mail.gmail.com>
Message-ID: <E553D3C2-C6C5-443B-82A3-081A2E8B3A6C@temporal-wave.com>

You just don't consume after the '@' then and that token will stop  
there.

Jim

On Sep 17, 2009, at 9:59 AM, Soren Holstebroe <holstebroe at gmail.com>  
wrote:

> Thank you for your answer,
>
> As i understand it, your suggestion considers the whole template  
> line as a single token, but I don't want the template token to eat  
> up the rest of the line, since this is where my template wrapping  
> grammar would be.
>
> My grammar will have rules like this:
>
> wrap_option
>     : WRAP_OPTION_BEGIN
>     (  'WRAP'
>     | 'TEMPLATE' '<' type_specifier (',' type_specifier)* '>'
>     )
>     ;
>
> so I need something to match '//' WS* '@' as my WRAP_OPTION_BEGIN.
>
> Soren
>
> 2009/9/17 Indhu Bharathi <indhu.b at s7software.com>
> Try using semantic predicates to look-ahead and decide whether to  
> emit SLCOMMENT or TEMPLATE
>
>
>
> Something like:
>
>
>
> fragment SLCOMMENT
>
>                 :               ;
>
>
>
> fragment TEMPLATE
>
>                 :               ;
>
>
>
> SLCOMMENT_OR_TEMPLATE
>
>                 :               '//' (
>
>                                                 { input.LA(1)=='@' }? 
> => ( options {greedy=false;} : . )* EOL    { $type=TEMPLATE; }
>
>                                 |              ( options  
> {greedy=false;} : . )* EOL    { $type=SLCOMMENT; }
>
>                                 )
>
>                 ;
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/858b2a9f/attachment.html 

From RButterfoss at ea.com  Thu Sep 17 13:27:36 2009
From: RButterfoss at ea.com (Butterfoss, Ryan)
Date: Thu, 17 Sep 2009 13:27:36 -0700
Subject: [antlr-interest] ANTLRWorks & Vista 64bit?
Message-ID: <9AB6EA23FF6F13458DEF94FC6F20C8C92670ED2AB1@NA-MAIL-1-1.rws.ad.ea.com>

I just got a new 64-bit Vista box and was setting up all my dev environments.  I installed JRE6 runtime & Eclipse and tried running ANTLRWorks with no result.

With AntlrWorks 1.2.3 I get a blank see through frame.
With AntlrWorks 1.3b I get a small "New Document" window.

I searched around on the site and saw that people have tested Antlrworks with Vista64, so I'm wondering if there's something I'm missing.

Any help is appreciated.

Thanks
Ryan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/b54c543d/attachment.html 

From antlr at mirality.co.nz  Thu Sep 17 13:58:32 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 18 Sep 2009 08:58:32 +1200
Subject: [antlr-interest] (no subject)
In-Reply-To: <D7E350C5D8CD4354840208FB6040F5B4@PDMCSICALC>
References: <D7E350C5D8CD4354840208FB6040F5B4@PDMCSICALC>
Message-ID: <20090917205859.ED40B3418493@www.antlr.org>

At 04:00 18/09/2009, David Mar?n Carre?o wrote:
 >^(IF condition ^(THEN statements)) |
 >^(IFELSE condition ^(THEN then_s=statements) ^(ELSE
 >else_s=statements))
 >
 >I don't know how to skip THEN statements when the condition is
 >false.  I am trying the following:
 >
 >conditionalifthen:
 >  ^(IF expression ( { $expression.value != 0 }? => ^(THEN
 >statements) | .));
 >
 >conditionalifthenelse:
 >  ^(IFELSE expression
 >    ( { $expression.value != 0 }? => ^(THEN statements) . |
 >                                    . ^(ELSE statements) ));
 >
 >without success, until now.

Match the tree and skip the statements:

conditionalifthen:
   ^(IF expression ( { $expression.value != 0 }? 
=> ^(THEN statements) | ^(THEN .*)));

conditionalifthenelse:
   ^(IFELSE expression
     ( { $expression.value != 0 }? => ^(THEN 
statements) ^(ELSE .*) |
                                     ^(THEN .*) 
^(ELSE statements) ));


From jimi at temporal-wave.com  Thu Sep 17 14:41:12 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 17 Sep 2009 14:41:12 -0700
Subject: [antlr-interest] ANTLRWorks & Vista 64bit?
In-Reply-To: <9AB6EA23FF6F13458DEF94FC6F20C8C92670ED2AB1@NA-MAIL-1-1.rws.ad.ea.com>
References: <9AB6EA23FF6F13458DEF94FC6F20C8C92670ED2AB1@NA-MAIL-1-1.rws.ad.ea.com>
Message-ID: <DC22C541-66C3-4E5A-944F-C05E4DCAC411@temporal-wave.com>

Which JdK did you load?

Jim

On Sep 17, 2009, at 1:27 PM, "Butterfoss, Ryan" <RButterfoss at ea.com>  
wrote:

> I just got a new 64-bit Vista box and was setting up all my dev  
> environments.  I installed JRE6 runtime & Eclipse and tried running  
> ANTLRWorks with no result.
>
> With AntlrWorks 1.2.3 I get a blank see through frame.
> With AntlrWorks 1.3b I get a small ?New Document? window.
>
> I searched around on the site and saw that people have tested  
> Antlrworks with Vista64, so I?m wondering if there?s something  
> I?m missing.
>
> Any help is appreciated.
>
> Thanks
> Ryan
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/c1ee17ec/attachment.html 

From RButterfoss at ea.com  Thu Sep 17 15:01:18 2009
From: RButterfoss at ea.com (Butterfoss, Ryan)
Date: Thu, 17 Sep 2009 15:01:18 -0700
Subject: [antlr-interest] ANTLRWorks & Vista 64bit?
In-Reply-To: <DC22C541-66C3-4E5A-944F-C05E4DCAC411@temporal-wave.com>
References: <9AB6EA23FF6F13458DEF94FC6F20C8C92670ED2AB1@NA-MAIL-1-1.rws.ad.ea.com>
	<DC22C541-66C3-4E5A-944F-C05E4DCAC411@temporal-wave.com>
Message-ID: <9AB6EA23FF6F13458DEF94FC6F20C8C92670ED2B1F@NA-MAIL-1-1.rws.ad.ea.com>

Hi Jim,

I?ve tried the 1.6-16 JRE for 32 & 64 bit, and 1.5-10b for 32bit.  All have the same result.  This is Vista-64 SP1 BTW.

Thanks
Ryan

From: Jim Idle [mailto:jimi at temporal-wave.com]
Sent: Thursday, September 17, 2009 2:41 PM
To: Butterfoss, Ryan
Cc: antlr-interest at antlr.org
Subject: Re: [antlr-interest] ANTLRWorks & Vista 64bit?

Which JdK did you load?

Jim

On Sep 17, 2009, at 1:27 PM, "Butterfoss, Ryan" <RButterfoss at ea.com<mailto:RButterfoss at ea.com>> wrote:
I just got a new 64-bit Vista box and was setting up all my dev environments.  I installed JRE6 runtime & Eclipse and tried running ANTLRWorks with no result.

With AntlrWorks 1.2.3 I get a blank see through frame.
With AntlrWorks 1.3b I get a small ?New Document? window.

I searched around on the site and saw that people have tested Antlrworks with Vista64, so I?m wondering if there?s something I?m missing.

Any help is appreciated.

Thanks
Ryan


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090917/c857ab44/attachment.html 

From dmarin at sice.com  Fri Sep 18 00:28:44 2009
From: dmarin at sice.com (=?iso-8859-1?Q?David_Mar=EDn_Carre=F1o?=)
Date: Fri, 18 Sep 2009 09:28:44 +0200
Subject: [antlr-interest] (no subject)
In-Reply-To: <20090917205850.D5179C09730@AntiSpam.ACSIndustria.com>
References: <D7E350C5D8CD4354840208FB6040F5B4@PDMCSICALC>
	<20090917205850.D5179C09730@AntiSpam.ACSIndustria.com>
Message-ID: <7B9A708D71244E6FB182E2EC1512A3CF@PDMCSICALC>

At 22:59 17/09/2009, Gavin Lambert wrote:
> 
> Match the tree and skip the statements:
> 
> conditionalifthen:
>    ^(IF expression ( { $expression.value != 0 }?
> => ^(THEN statements) | ^(THEN .*)));
> 
> conditionalifthenelse:
>    ^(IFELSE expression
>      ( { $expression.value != 0 }? => ^(THEN
> statements) ^(ELSE .*) |
>                                      ^(THEN .*)
> ^(ELSE statements) ));

OK. I've tried this code, but both ANTLR 3.1.2 and 3.1.3 generate a faulty
tree parser, as they don't declare a "expression" variable in the
corresponding specialStateTransition function. 

I think this is a bug. How can I report it?


But, finally, for the record, I have a functional solution.

First of all, I have defined a new private member for the Tree Parser class.

@members {
	...
	private boolean lastCondExp = false;
	...
}

And I use it for save the last conditional expression:

conditionalifthen:
   ^(IF expression {lastCondExp = ($expression.value!=0);} 
		( {lastCondExp}? => ^(THEN statements) |
^(THEN .*)));
 
conditionalifthenelse:
   ^(IFELSE expression {lastCondExp = ($expression.value!=0);}
     		( { lastCondExp }? => ^(THEN statements) ^(ELSE .*) |
                                      ^(THEN .*) ^(ELSE statements) ));


Thanks all for your help!
--
David Mar?n Carre?o


From antlr at mirality.co.nz  Fri Sep 18 02:46:01 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Fri, 18 Sep 2009 21:46:01 +1200
Subject: [antlr-interest] (no subject)
In-Reply-To: <7B9A708D71244E6FB182E2EC1512A3CF@PDMCSICALC>
References: <D7E350C5D8CD4354840208FB6040F5B4@PDMCSICALC>
	<20090917205850.D5179C09730@AntiSpam.ACSIndustria.com>
	<7B9A708D71244E6FB182E2EC1512A3CF@PDMCSICALC>
Message-ID: <20090918094901.43B30341847C@www.antlr.org>

At 19:28 18/09/2009, David Mar?n Carre?o wrote:
 >OK. I've tried this code, but both ANTLR 3.1.2 
and 3.1.3 generate a
 >faulty tree parser, as they don't declare a 
"expression" variable
 >in the corresponding specialStateTransition function.
 >
 >I think this is a bug. How can I report it?

That sort of problem is fairly well known.  It's 
unfortunate, but at present ANTLR isn't quite 
clever enough to work out that you're using a 
local variable in the predicate and that it'd 
need to pass it along.

 >First of all, I have defined a new private member for the Tree
 >Parser class.
[...]
 >conditionalifthenelse:
 >   ^(IFELSE expression {lastCondExp = ($expression.value!=0);}
 >     		( { lastCondExp }? => ^(THEN statements) ^(ELSE .*) |
 >                                      ^(THEN 
.*) ^(ELSE statements)
 >));

You can also use scopes to do this.  But in 
either case you need to be careful; sometimes the 
predicates can be hoisted to a point before the 
assignment is made.  (It should be ok in this 
context, though; hoisting usually only happens to 
resolve ambiguity.)


From micke.hovmoller at gmail.com  Fri Sep 18 03:58:47 2009
From: micke.hovmoller at gmail.com (=?ISO-8859-1?Q?Micke_Hovm=F6ller?=)
Date: Fri, 18 Sep 2009 12:58:47 +0200
Subject: [antlr-interest] Rule coverage testing
Message-ID: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>

I've written a reasonably large grammar for handling poker hand histories. I
have worked on and off for about a year or so on this. During this time, the
file format has changed slightly. I suspect that I now have a bunch of rules
in my grammar that are no longer used.

What are best practices for establishing rule coverage test cases? Ideally,
I want to have a bunch of infiles, run them through the grammar and have
output displaying which rules were never used. Showing frequency of usage
would be nice, but it is definitely not needed.

This is developed in NetBeans 6.7.1 with the ANTLR plugin, so anything that
runs in that environment is much preferred to any other solution, but I am
prepared to switch IDE if that is required.

/Micke
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090918/ba4ad1af/attachment.html 

From hina.david at live.com  Fri Sep 18 04:45:10 2009
From: hina.david at live.com (Naimal Khan)
Date: Fri, 18 Sep 2009 11:45:10 +0000
Subject: [antlr-interest] java control flow graph from AST
Message-ID: <BLU135-W120AA39F1A7F84D8F1E4B6FDE00@phx.gbl>













Hi,
I'm all new to parsing a language. I need to develop a static analysis tool for my research for source code analysis of java. I'm using ANTLR for parsing and generating AST.  Now I need to  generate a CFG from an AST? I wonder, is there any tool, library or algorithm available that can help me in this. 
thanks,
Hina

check out the rest of the Windows Live?.
More than mail?Windows Live? goes way beyond your inbox.
 More than messages
_________________________________________________________________
With Windows Live, you can organize, edit, and share your photos.
http://www.microsoft.com/middleeast/windows/windowslive/products/photo-gallery-edit.aspx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090918/d63d18ec/attachment.html 

From marco at mtsystems.ch  Fri Sep 18 05:50:49 2009
From: marco at mtsystems.ch (Marco Trudel)
Date: Fri, 18 Sep 2009 14:50:49 +0200
Subject: [antlr-interest] conditional tree rewrite
In-Reply-To: <72DC5775-83F7-40D6-93DD-4E69B99EC656@temporal-wave.com>
References: <4AB23A7A.2000809@mtsystems.ch>
	<72DC5775-83F7-40D6-93DD-4E69B99EC656@temporal-wave.com>
Message-ID: <4AB38229.3070108@mtsystems.ch>

Dear Jim

Jim Idle wrote:
> Marco,
> 
> You can rewrite inside any alt so only rewrite as conditional if you 
> take that alt.

I'm afraid I'm too big an antlr newcomer to understand what you mean. 
Can you maybe give an example? Maybe directly with the rule I made to 
show my problem?

> Also, avoid imaginary token bloat- you don't need the 
> imaginaries in expression trees (generally) and can just use the ^ 
> operator.

Also here, an example would be very helpful. I don't know how else I 
could do without inserting imaginary tokens (or how to insert imaginary 
tokens better).
Or do you only mean in expression trees like the one I mentioned from 
"ART_EXPRESSION -> ART_ASSIGNMENT_EXPRESSION -> ... -> ART_CONSTANT -> 
0" for a constant? If so, than that's exactly my question: how to do the 
tree rewrite to only get "ART_EXPRESSION -> ART_CONSTANT -> 0"? I don't 
see a way to insert the imaginary tokens like e.g. 
"ART_LOGICAL_OR_EXPRESSION" only if it's a logical or expression for 
this rule:

logical_or_expression
	: logical_and_expression ('||' logical_and_expression)*
	;

Because it's not a logical_or_expression if the parenthesis part is not 
found. So, my goal is this:

logical_or_expression
	: logical_or_expression2 -> ^(ART_LOGICAL_OR_EXPRESSION 
logical_or_expression2)
	| logical_and_expression
	;
logical_or_expression2
	: logical_and_expression ('||' logical_and_expression)+
	;

But, as mentioned in my original mail, this leads to too much ambiguity 
to compile the grammar. So, how to do exactly that without adding 
ambiguity (the "|" pipes in case I use the wrong word for it)?

> The AST is more about being unambiguous and easilly walkable 
> than how it looks to you when you print the tree. You probably want to 
> lose the 'literals' and make these lexer defined tokens. It will be 
> easier when you build the tree walker.

I don't need a tree walker. But of course I'm interested in having a 
good grammar. Can you maybe also make an example of what you mean with 
"lose the 'literals' and make these lexer defined tokens"?


Thanks for your time and have a nice day
Marco


> Jim
> 
> On Sep 17, 2009, at 6:32 AM, Marco Trudel <marco at mtsystems.ch> wrote:
> 
>> Dear all
>>
>> I'm trying to adapt the "ANSI C grammar for ANTLR v3" so that it
>> generates an AST. So my first step was to change all rules like:
>>
>> lvalue
>>    :    unary_expression
>>    ;
>>
>> to
>>
>> lvalue : lvalue2 -> ^(ART_LVALUE lvalue2);
>> lvalue2
>>    :    unary_expression
>>    ;
>>
>> This already gives me a nice AST, except for expressions. For instance
>> "0" will be represented as:
>> ART_EXPRESSION
>> '-ART_ASSIGNMENT_EXPRESSION
>>   '- ART_CONDITIONAL_EXPRESSION
>>      '- ART_LOGICAL_AND_EXPRESSION
>>             .
>>             .
>>             .
>>                '- ART_PRIMARY_EXPRESSION
>>                   '- ART_CONSTANT
>>                      '- 0
>>
>> I assume that the grammar has been build this way for performance
>> reasons. The rule for conditional_expression for instance looks like:
>>
>> conditional_expression
>>    : logical_or_expression ('?' expression ':' conditional_expression)?
>>    ;
>>
>> So it's actually not a conditional_expression if the part in parentheses
>> isn't there. So my initial rewrite:
>>
>> conditional_expression : conditional_expression2 ->
>> ^(ART_CONDITIONAL_EXPRESSION conditional_expression2);
>> conditional_expression2
>>    : logical_or_expression ('?' expression ':' conditional_expression)?
>>    ;
>>
>> creates a "wrong" AST if it's actually not a conditional expression and
>> I'm now trying to create the tree conditionally. My first approach was
>> to change the rules this way:
>>
>> conditional_expression
>>    : conditional_expression2 -> ^(ART_CONDITIONAL_EXPRESSION
>> conditional_expression2);
>>    | logical_or_expression
>>    ;
>> conditional_expression2
>>    : logical_or_expression '?' expression ':' conditional_expression
>>    ;
>>
>> But, since there are 16 rules to adapt, after about 6 I run into
>> "internal error: ...: could not even do k=1 for decision 49; reason:
>> timed out (>1000ms)". So this creates too much ambiguity and therefore I
>> went for syntactic predicates:
>>
>> conditional_expression
>>    : ( logical_or_expression '?' expression ':' conditional_expression )
>>        => logical_or_expression '?' expression ':' 
>> conditional_expression ->
>> ^(ART_CONDITIONAL_EXPRESSION logical_or_expression '?' expression ':'
>> conditional_expression)
>>        |  logical_or_expression
>>    ;
>>
>> But the same problem (too ambiguous to compile). So I'm really stuck now
>> since I don't know how to do this correct (meaning efficient). I could
>> imagine that this can be done with semantic predicates (I don't know
>> how) but I'm not sure about the runtime overhead when parsing a C file.
>> Or I can go over the created tree myself and clean up the expressions.
>> But the tree is already substantial bigger than it should be because of
>> the intermediate wrong "foo_expression", so I guess solving the problem
>> at the grammar level is better.
>>
>> Any opinions? Maybe I miss the completely obvious solution...
>> I think I should add that I'm a complete ANTLR beginner; so everything I
>> wrote might make no sense at all.
>>
>>
>> Thanks and have a nice day
>> Marco
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe: 
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Fri Sep 18 06:24:36 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 18 Sep 2009 06:24:36 -0700
Subject: [antlr-interest] Rule coverage testing
In-Reply-To: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>
References: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>
Message-ID: <3CB8EB53-340F-4949-93DF-51AFBE05073F@temporal-wave.com>

Switch to maven, write coverage tests (there are food choices for java  
ones ) to run against the binary parser and see which methods are  
never called . Methods are named after rules.

Jim

On Sep 18, 2009, at 3:58 AM, Micke Hovm?ller  
<micke.hovmoller at gmail.com> wrote:

> I've written a reasonably large grammar for handling poker hand  
> histories. I have worked on and off for about a year or so on this.  
> During this time, the file format has changed slightly. I suspect  
> that I now have a bunch of rules in my grammar that are no longer  
> used.
>
> What are best practices for establishing rule coverage test cases?  
> Ideally, I want to have a bunch of infiles, run them through the  
> grammar and have output displaying which rules were never used.  
> Showing frequency of usage would be nice, but it is definitely not  
> needed.
>
> This is developed in NetBeans 6.7.1 with the ANTLR plugin, so  
> anything that runs in that environment is much preferred to any  
> other solution, but I am prepared to switch IDE if that is required.
>
> /Micke
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From so at deluxe-design.at  Fri Sep 18 07:06:40 2009
From: so at deluxe-design.at (Stefan Oestreicher)
Date: Fri, 18 Sep 2009 16:06:40 +0200
Subject: [antlr-interest] problems with C target and C++ compiler
Message-ID: <4AB393F0.9080505@deluxe-design.at>

Hi,

I recently started playing around with antlr and first of all I have to 
say that it's a really awesome tool. Great work, thanks!
Now that I got a small and simple working grammar I'd like to write a 
small C++ (I need to use LLVM eventually) program that processes an 
input file and just dumps the AST to stdout, so I looked into the C 
examples but unfortunately I ran into a compiler problem, probably due 
to my limited experience with C/C++.
The compiler complains that ISO C++ forbids integer/pointer comparison 
at the NULL pointer check:

fileName = (pANTLR3_UINT8)argv[1];
input = antlr3AsciiFileStreamNew(fileName);

if (input == NULL) { // forbidden integer/pointer comparison - huh?
       printf("Failed to open %s", fileName);
       return -1;
}

If I compile as C it issues more or less the same message but then it's 
only a warning. However when I run the program it segfaults in the lexer 
factory (MyGrammarLexerNew). This also happens when I just remove the 
null pointer check when compiling as C++, however input is most 
certainly not null.

I'm compiling on windows xp using the mingw toolchain (gcc 3.4.5) but I 
verified that the same problem exists on debian etch with gcc 4.1.2. My 
ANTLR and runtime version is 3.1.3.

I'd appreciate any help as I couldn't find any hint on what I'm doing 
wrong.

thanks,

Stefan




From jimi at temporal-wave.com  Fri Sep 18 07:55:51 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 18 Sep 2009 07:55:51 -0700
Subject: [antlr-interest] problems with C target and C++ compiler
In-Reply-To: <4AB393F0.9080505@deluxe-design.at>
References: <4AB393F0.9080505@deluxe-design.at>
Message-ID: <8A6AC5BF-9E0C-4457-BBE1-C0458418DA8A@temporal-wave.com>

Download the examples zip form the download page and copy the driver  
code from the examples in the C subdirectories. You are just setting  
up includes incorrectly I think as the compiler thinks your variable  
is an integer.

Jim

On Sep 18, 2009, at 7:06 AM, Stefan Oestreicher <so at deluxe-design.at>  
wrote:

> Hi,
>
> I recently started playing around with antlr and first of all I have  
> to
> say that it's a really awesome tool. Great work, thanks!
> Now that I got a small and simple working grammar I'd like to write a
> small C++ (I need to use LLVM eventually) program that processes an
> input file and just dumps the AST to stdout, so I looked into the C
> examples but unfortunately I ran into a compiler problem, probably due
> to my limited experience with C/C++.
> The compiler complains that ISO C++ forbids integer/pointer comparison
> at the NULL pointer check:
>
> fileName = (pANTLR3_UINT8)argv[1];
> input = antlr3AsciiFileStreamNew(fileName);
>
> if (input == NULL) { // forbidden integer/pointer comparison - huh?
>       printf("Failed to open %s", fileName);
>       return -1;
> }
>
> If I compile as C it issues more or less the same message but then  
> it's
> only a warning. However when I run the program it segfaults in the  
> lexer
> factory (MyGrammarLexerNew). This also happens when I just remove the
> null pointer check when compiling as C++, however input is most
> certainly not null.
>
> I'm compiling on windows xp using the mingw toolchain (gcc 3.4.5)  
> but I
> verified that the same problem exists on debian etch with gcc 4.1.2.  
> My
> ANTLR and runtime version is 3.1.3.
>
> I'd appreciate any help as I couldn't find any hint on what I'm doing
> wrong.
>
> thanks,
>
> Stefan
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From so at deluxe-design.at  Fri Sep 18 10:42:40 2009
From: so at deluxe-design.at (Stefan Oestreicher)
Date: Fri, 18 Sep 2009 19:42:40 +0200
Subject: [antlr-interest] problems with C target and C++ compiler
In-Reply-To: <8A6AC5BF-9E0C-4457-BBE1-C0458418DA8A@temporal-wave.com>
References: <4AB393F0.9080505@deluxe-design.at>
	<8A6AC5BF-9E0C-4457-BBE1-C0458418DA8A@temporal-wave.com>
Message-ID: <4AB3C690.8000705@deluxe-design.at>

Jim Idle schrieb:
> Download the examples zip form the download page and copy the driver 
> code from the examples in the C subdirectories. You are just setting 
> up includes incorrectly I think as the compiler thinks your variable 
> is an integer.

Hi,

if I compile a simple C program (http://pastebin.com/m1e0f1257) that 
includes the generated antlr sources (using this grammar: 
http://pastebin.com/m31ea9441 - it's very basic and not yet really 
producing an AST but if I understand correctly this shouldn't matter 
anyway) with

gcc -c -I/usr/local/include -I./include *.c

it compiles but I get tons of warnings as you can see here 
http://pastebin.com/m322821c5 (this was compiled on debian etch with gcc 
4.1.2).
If confirmed that the /usr/local/include directory contains the antlr 
header files which were copied
when I built the libantlr3c-3.1.3 source using ./configure && make && 
make install wich worked flawlessly.
I have no idea what the problem is as I believe I have done everything 
neccessary according to the documentation.

Thanks for your help.

Stefan

From parrt at cs.usfca.edu  Fri Sep 18 10:43:02 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 18 Sep 2009 10:43:02 -0700
Subject: [antlr-interest] shutting down wiki/site for upgrade
Message-ID: <1F517394-142B-4886-B867-6E2753569303@cs.usfca.edu>


From jimi at temporal-wave.com  Fri Sep 18 10:49:19 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 18 Sep 2009 10:49:19 -0700
Subject: [antlr-interest] problems with C target and C++ compiler
In-Reply-To: <4AB3C690.8000705@deluxe-design.at>
References: <4AB393F0.9080505@deluxe-design.at>
	<8A6AC5BF-9E0C-4457-BBE1-C0458418DA8A@temporal-wave.com>
	<4AB3C690.8000705@deluxe-design.at>
Message-ID: <79619971-CE74-4347-A0B1-009F8CB2082A@temporal-wave.com>

Check the examples. You should have zero warnings even with -W4

Jim

On Sep 18, 2009, at 10:42 AM, Stefan Oestreicher <so at deluxe-design.at>  
wrote:

> Jim Idle schrieb:
>> Download the examples zip form the download page and copy the driver
>> code from the examples in the C subdirectories. You are just setting
>> up includes incorrectly I think as the compiler thinks your variable
>> is an integer.
>
> Hi,
>
> if I compile a simple C program (http://pastebin.com/m1e0f1257) that
> includes the generated antlr sources (using this grammar:
> http://pastebin.com/m31ea9441 - it's very basic and not yet really
> producing an AST but if I understand correctly this shouldn't matter
> anyway) with
>
> gcc -c -I/usr/local/include -I./include *.c
>
> it compiles but I get tons of warnings as you can see here
> http://pastebin.com/m322821c5 (this was compiled on debian etch with  
> gcc
> 4.1.2).
> If confirmed that the /usr/local/include directory contains the antlr
> header files which were copied
> when I built the libantlr3c-3.1.3 source using ./configure && make &&
> make install wich worked flawlessly.
> I have no idea what the problem is as I believe I have done everything
> neccessary according to the documentation.
>
> Thanks for your help.
>
> Stefan
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From parrt at cs.usfca.edu  Fri Sep 18 11:47:43 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 18 Sep 2009 11:47:43 -0700
Subject: [antlr-interest] shutting down wiki/site for upgrade
In-Reply-To: <1F517394-142B-4886-B867-6E2753569303@cs.usfca.edu>
References: <1F517394-142B-4886-B867-6E2753569303@cs.usfca.edu>
Message-ID: <D9E4137A-0A74-41EC-AEE1-EF351AB1E5B4@cs.usfca.edu>

back up
Ter
On Sep 18, 2009, at 10:43 AM, Terence Parr wrote:

>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From so at deluxe-design.at  Fri Sep 18 12:49:15 2009
From: so at deluxe-design.at (Stefan Oestreicher)
Date: Fri, 18 Sep 2009 21:49:15 +0200
Subject: [antlr-interest] problems with C target and C++ compiler
In-Reply-To: <79619971-CE74-4347-A0B1-009F8CB2082A@temporal-wave.com>
References: <4AB393F0.9080505@deluxe-design.at>
	<8A6AC5BF-9E0C-4457-BBE1-C0458418DA8A@temporal-wave.com>
	<4AB3C690.8000705@deluxe-design.at>
	<79619971-CE74-4347-A0B1-009F8CB2082A@temporal-wave.com>
Message-ID: <4AB3E43B.3020709@deluxe-design.at>

Jim Idle schrieb:
> Check the examples. You should have zero warnings even with -W4
>
> Jim

Hi,

you are correct. The samples compile fine. I also tested it with a very 
simple custom grammar which works as well so I guess my grammar is 
missing something because the problem is definitely caused by the 
generated files. However, I now have something to work with, so I'm sure 
I will soon get to the bottom of this.
Thanks for your help.

Stefan

From antlr at mirality.co.nz  Fri Sep 18 16:32:07 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sat, 19 Sep 2009 11:32:07 +1200
Subject: [antlr-interest] conditional tree rewrite
In-Reply-To: <4AB38229.3070108@mtsystems.ch>
References: <4AB23A7A.2000809@mtsystems.ch>
	<72DC5775-83F7-40D6-93DD-4E69B99EC656@temporal-wave.com>
	<4AB38229.3070108@mtsystems.ch>
Message-ID: <20090918233235.670DD3418458@www.antlr.org>

At 00:50 19/09/2009, Marco Trudel wrote:
 >Or do you only mean in expression trees like the one I mentioned 

 >from "ART_EXPRESSION -> ART_ASSIGNMENT_EXPRESSION -> ... ->
 >ART_CONSTANT -> 0" for a constant? If so, than that's exactly my 

 >question: how to do the tree rewrite to only get "ART_EXPRESSION 

 >-> ART_CONSTANT -> 0"? I don't see a way to insert the imaginary 

 >tokens like e.g. "ART_LOGICAL_OR_EXPRESSION" only if it's a
 >logical or expression for this rule:
 >
 >logical_or_expression
 >	: logical_and_expression ('||' logical_and_expression)*
 >	;
 >
 >Because it's not a logical_or_expression if the parenthesis part 
is
 >not found.

logical_or_expression
   : logical_and_expression ('||'^ logical_and_expression)*
   ;

This is the best option; it will use the operator itself as the 
tree root, and only generate a subtree if the operator is 
present.  And it will generate nested trees appropriately.

It's slightly better if you use a named token rather than a 
literal:

LOGICAL_OR: '||';
logical_or_expression
   : logical_and_expression (LOGICAL_OR^ logical_and_expression)*
   ;

Finally, if you really want to do the rewrite "manually", you can:

logical_or_expression
   : (logical_and_expression -> logical_and_expression)
     ('||' b=logical_and_expression -> ^('||' 
$logical_or_expression $b))*
   ;

You can use this final pattern to use an imaginary token as the 
root rather than using the operator, if you really want to do 
that.  But it seems a bit silly when the operator is usually a 
good enough identifier all by itself.


From parrt at cs.usfca.edu  Fri Sep 18 17:34:08 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 18 Sep 2009 17:34:08 -0700
Subject: [antlr-interest] next antlr release
Message-ID: <0BE8D61E-CFEE-4332-8E0E-C11FBE7B0FF4@cs.usfca.edu>

Hi, I need to release a new version of ANTLR for the book. I'm  
thinking about calling a 3.2 instead of just another point release  
because I've added tree pattern matching and so on. This would be the  
version used by the book so I kind of need to get this version out  
quickly. Just a heads up to users and ANTLR target developers:  I  
might try to get a version out next week.

Ter

From skandula at asu.edu  Fri Sep 18 20:58:43 2009
From: skandula at asu.edu (Sailesh Kandula)
Date: Fri, 18 Sep 2009 20:58:43 -0700
Subject: [antlr-interest] Error: Declared package doesn't match expected
	package
Message-ID: <db282560909182058p6dc9cfadkad449d5d4e3e2049@mail.gmail.com>

While building my first ANTLR project SimpleCalc.g i ran into the error:

The declared package "annexextension.SimpleCalc" does not  match expected
package "".

SimpleCalc.g :

header {
    package annexextension.SimpleCalc;
}
{
        import antlr.TokenStreamRecognitionException;
}

class SimpleCalcParser extends Parser ;


expr    : term ( ( PLUS | MINUS )  term )* ;
term    : factor ( ( MULT | DIV ) factor )* ;
factor    : NUMBER ;

class SimpleLexer extends Lexer;

...


If i remove the package declaration it builds(of course).  I read past
threads and FAQ but couldn't find any pointers. I'm using Eclipse 3.5.1 with
org.antlr.ui (version 4.1.0) plugin. Any hints?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090918/2443ebba/attachment.html 

From indhu.b at s7software.com  Sat Sep 19 01:03:43 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Sat, 19 Sep 2009 13:33:43 +0530
Subject: [antlr-interest] Error: Declared package doesn't match expected
	package
In-Reply-To: <db282560909182058p6dc9cfadkad449d5d4e3e2049@mail.gmail.com>
References: <db282560909182058p6dc9cfadkad449d5d4e3e2049@mail.gmail.com>
Message-ID: <DF947250-11C1-41BF-A5C4-2A4E0382A805@s7software.com>

Check if you are creating the lexer/parser under the right  
directories. Look like the files are getting generated at root level  
in source tree.


On Sep 19, 2009, at 9:28 AM, Sailesh Kandula <skandula at asu.edu> wrote:

> While building my first ANTLR project SimpleCalc.g i ran into the  
> error:
>
> The declared package "annexextension.SimpleCalc" does not  match  
> expected package "".
>
> SimpleCalc.g :
>
> header {
>     package annexextension.SimpleCalc;
> }
> {
>         import antlr.TokenStreamRecognitionException;
> }
>
> class SimpleCalcParser extends Parser ;
>
>
> expr    : term ( ( PLUS | MINUS )  term )* ;
> term    : factor ( ( MULT | DIV ) factor )* ;
> factor    : NUMBER ;
>
> class SimpleLexer extends Lexer;
>
> ...
>
>
> If i remove the package declaration it builds(of course).  I read  
> past threads and FAQ but couldn't find any pointers. I'm using  
> Eclipse 3.5.1 with org.antlr.ui (version 4.1.0) plugin. Any hints?
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From karl.meissner at gmail.com  Sat Sep 19 12:12:55 2009
From: karl.meissner at gmail.com (Karl Meissner)
Date: Sat, 19 Sep 2009 15:12:55 -0400
Subject: [antlr-interest] streaming parser?
Message-ID: <af0196190909191212k5adbca75lc85df633b056ca0b@mail.gmail.com>

Are there any good article about using antlr in the context of a steaming
parser?

I have text files which I need to filter and search as they download, packet
by packet.  The packets may fragment the text tokens so I need some sort of
stateful stream....


It would be really nice if I could arrange for the parse to run
deterministically. I am hoping to use Antlr in a highly optimized, low
latency application.   boost regex was not up to the task...

Thanks
Karl Meissner
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090919/2050c6ad/attachment.html 

From skandula at asu.edu  Sat Sep 19 12:13:40 2009
From: skandula at asu.edu (Sailesh Kandula)
Date: Sat, 19 Sep 2009 12:13:40 -0700
Subject: [antlr-interest] Error: Declared package doesn't match expected
	package
In-Reply-To: <DF947250-11C1-41BF-A5C4-2A4E0382A805@s7software.com>
References: <db282560909182058p6dc9cfadkad449d5d4e3e2049@mail.gmail.com>
	<DF947250-11C1-41BF-A5C4-2A4E0382A805@s7software.com>
Message-ID: <db282560909191213i6ad0fd48xf8e53bc2b9a9640a@mail.gmail.com>

Thanks,i explicitly created "annexextension.simpleCalc" and placed my
grammar file in that package,it worked. I thought ANTLR build creates a
package(if one doesn't exist) for the newly generated Lexer and Paser files
and puts them accordingly.



On Sat, Sep 19, 2009 at 1:03 AM, Indhu Bharathi <indhu.b at s7software.com>wrote:

> Check if you are creating the lexer/parser under the right directories.
> Look like the files are getting generated at root level in source tree.
>
>
>
> On Sep 19, 2009, at 9:28 AM, Sailesh Kandula <skandula at asu.edu> wrote:
>
>  While building my first ANTLR project SimpleCalc.g i ran into the error:
>>
>> The declared package "annexextension.SimpleCalc" does not  match expected
>> package "".
>>
>> SimpleCalc.g :
>>
>> header {
>>    package annexextension.SimpleCalc;
>> }
>> {
>>        import antlr.TokenStreamRecognitionException;
>> }
>>
>> class SimpleCalcParser extends Parser ;
>>
>>
>> expr    : term ( ( PLUS | MINUS )  term )* ;
>> term    : factor ( ( MULT | DIV ) factor )* ;
>> factor    : NUMBER ;
>>
>> class SimpleLexer extends Lexer;
>>
>> ...
>>
>>
>> If i remove the package declaration it builds(of course).  I read past
>> threads and FAQ but couldn't find any pointers. I'm using Eclipse 3.5.1 with
>> org.antlr.ui (version 4.1.0) plugin. Any hints?
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090919/e7c26bb5/attachment.html 

From jimi at temporal-wave.com  Sat Sep 19 16:01:09 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sat, 19 Sep 2009 16:01:09 -0700
Subject: [antlr-interest] streaming parser?
In-Reply-To: <af0196190909191212k5adbca75lc85df633b056ca0b@mail.gmail.com>
References: <af0196190909191212k5adbca75lc85df633b056ca0b@mail.gmail.com>
Message-ID: <4AB562B5.7020301@temporal-wave.com>

On 09/19/2009 12:12 PM, Karl Meissner wrote:
> Are there any good article about using antlr in the context of a 
> steaming parser?
Search the list for prior discussions, but all you really need is to 
write your own input stream that gives EOF back to the caller when a 
complete "unit" is detected, then keep setting up the input stream 
again. Presumably there is something in the incoming packets that 
indicates a safe place to call something a "unit" of work?

>
> I have text files which I need to filter and search as they download, 
> packet by packet.  The packets may fragment the text tokens so I need 
> some sort of stateful stream....
>
>
> It would be really nice if I could arrange for the parse to run 
> deterministically. I am hoping to use Antlr in a highly optimized, low 
> latency application.   boost regex was not up to the task...
Depends what you mean by deterministically? You mean that after nnms of 
cpu or elapsed time that it gives up control to an embedded system 
control loop? Or that it always takes the same time? You will want to 
increase the value of -Xmaxdfaedges to a large number to avoid DFAs 
being generated as tables (inline Ifs are much faster because of branch 
prediction and avoiding memory cache misses).

BTW - I presume that you are using the C target here as you have no 
chance of achieving the kind of performance you seem to be asking for 
from the other targets.

Jim


From gerald at certiv.net  Sat Sep 19 18:11:17 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Sat, 19 Sep 2009 18:11:17 -0700
Subject: [antlr-interest] How to do complex Tree Pattern Matching
In-Reply-To: <DAE00051-7CF7-4F54-9133-203B83805A52@cs.usfca.edu>
References: <200909120707.n8C77AfT018894@zinc.newtechlaw.com>
	<32F3727E-E801-4612-9BEB-837C869D7CB9@cs.usfca.edu>
	<200909122219.n8CMIxb0022541@zinc.newtechlaw.com>
	<DAE00051-7CF7-4F54-9133-203B83805A52@cs.usfca.edu>
Message-ID: <200909200111.n8K1Bm94029211@zinc.newtechlaw.com>

Unless I am missing something, the convenience methods:

inContext(String)
hasAncestor(int)
hasParent(int)

belong in TreeFilter, or at least in the TreeFilter 
heirarchy.  BaseTree#hasAncestor(int) is just plain awkward to code 
in a tree matcher grammar predicate. Also, the inContext method 
really is needed.  Just no other convenient way to discretely 
distinguish a branch in a complex AST.

Attached is the TreeFilter subclass that I am currently using.  The 
inContext method is a rework of your earlier method of the same name 
-- I have not exercised this version greatly.  In a next version, 
would like to get away form the String parameter and use an int list 
instead, maybe with a pre-defined imaginary token representing '.*'.


At 03:21 PM 9/12/2009, Terence Parr wrote:
>yeah, I realized that I had opened up a huge issue without thinking it
>through. I'd like to have something like inContext but the more I
>added to it, the more I realized that the simplest thing to do would
>be to give the programmer basic tools like hasAncestor and let them
>add whatever logic they need.
>
>Ter
>On Sep 12, 2009, at 3:18 PM, Gerald Rosenberg wrote:
>
>>At 02:07 PM 9/12/2009, Terence Parr wrote:
>>
>>>On Sep 12, 2009, at 12:06 AM, Gerald Rosenberg wrote:
>>>>Given an existing AST with the two paths:
>>>
>>>i'd recommend doing ^(m .*) match and a pred in front that says
>>>hasAncestor(a) or something
>>>Ter
>>
>>OK, I completely missed BaseTree#hasAncestor
>>
>>Regards the "or something,"  TreeParser#inContext would seem to be
>>it.  However, that method seems to have gone missing from 3.1.3 (it
>>was in 3.1.2, but is still absent in 3.1.4).  Is there a reason that
>>method got pulled?
>>
>>Thanks.
>>
>>
>>
>>
>>
>>List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>Unsubscribe: 
>>http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From artemkagolubev at gmail.com  Sun Sep 20 03:45:24 2009
From: artemkagolubev at gmail.com (Artem Golubev)
Date: Sun, 20 Sep 2009 03:45:24 -0700
Subject: [antlr-interest] Please help to left-refactor this simple ebnf
	grammar
Message-ID: <9c69eb320909200345u42e19c93qbb1c741f1c390615@mail.gmail.com>

I just can't get how I can left-refactor the following grammar. Please,
help.
Currently I get "(211): ebnf.g:1:8: [fatal] rule Tokens has non-LL(*)
decision due to recursive rule invocations reachable from alts 8,9. Resolve
by left-factoring or using syntactic predicates or using backtrack=true
option." error with it.

grammar ebnf;

options {
output = AST;
language = CSharp2;
}

tokens {
OPENBRACKET = '(';
CLOSEBRACKET = ')';
ONEORMOREKEYWORD= '+';
ANYKEYWORD = '*';
OPTIONALKEYWORD = '?';
ORKEYWORD = '|';
}

/*------------------------------------------------------------------
* PARSER RULES
*------------------------------------------------------------------*/
OrList : List (ORKEYWORD List)*;

List : (Mutliplication)+;

Mutliplication : Atom ( ONEORMOREKEYWORD | OPTIONALKEYWORD | ANYKEYWORD )?;

Atom : IDENTIFIER | Group;

Group : OPENBRACKET OrList CLOSEBRACKET;

/*------------------------------------------------------------------
* LEXER RULES
*------------------------------------------------------------------*/

IDENTIFIER : (DIGIT)+ ;

WHITESPACE : ( '\t' | ' ' | '\r' | '\n' )+ { $channel = HIDDEN; } ;

fragment DIGIT : '0'..'9' ;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090920/aeb54822/attachment.html 

From martijn.reuvers at gmail.com  Sun Sep 20 04:22:02 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Sun, 20 Sep 2009 13:22:02 +0200
Subject: [antlr-interest] Please help to left-refactor this simple ebnf
	grammar
In-Reply-To: <9c69eb320909200345u42e19c93qbb1c741f1c390615@mail.gmail.com>
References: <9c69eb320909200345u42e19c93qbb1c741f1c390615@mail.gmail.com>
Message-ID: <c376e6ec0909200422v5430176rdf1f43462f4d8077@mail.gmail.com>

Hello Artem,

I think the issue is with your tokens defined at top as well as not
starting your rules with a lowercase. Tokens must start with
uppercase, while rules must start with a lowercase letter. I see no
issue in your grammar besides this.
For the rules use things like:

orlist
	: list (ORKEYWORD list)*
	;

list
	: (mutliplication)+
	;
etc.

Define your tokens defined above, as real lexer tokens below:

OPENBRACKET
	:	'('
	;

CLOSEBRACKET
	:	')'
	;

etc.

You can use literals in rules and then refer to them as tokens at top
(you do it in the reverse). I prefer real lexer tokens though in
general.

Martijn

On Sun, Sep 20, 2009 at 12:45 PM, Artem Golubev
<artemkagolubev at gmail.com> wrote:
> I just can't get how I can left-refactor the following grammar. Please,
> help.
> Currently I get "(211): ebnf.g:1:8: [fatal] rule Tokens has non-LL(*)
> decision due to recursive rule invocations reachable from alts 8,9. Resolve
> by left-factoring or using syntactic predicates or using backtrack=true
> option." error with it.
> grammar ebnf;
>
> options {
> output = AST;
> language = CSharp2;
> }
>
> tokens {
> OPENBRACKET = '(';
> CLOSEBRACKET = ')';
> ONEORMOREKEYWORD= '+';
> ANYKEYWORD = '*';
> OPTIONALKEYWORD = '?';
> ORKEYWORD = '|';
> }
>
> /*------------------------------------------------------------------
> * PARSER RULES
> *------------------------------------------------------------------*/
> OrList : List (ORKEYWORD List)*;
>
> List : (Mutliplication)+;
>
> Mutliplication : Atom ( ONEORMOREKEYWORD | OPTIONALKEYWORD | ANYKEYWORD )?;
>
> Atom : IDENTIFIER | Group;
>
> Group : OPENBRACKET OrList CLOSEBRACKET;
>
> /*------------------------------------------------------------------
> * LEXER RULES
> *------------------------------------------------------------------*/
>
> IDENTIFIER : (DIGIT)+ ;
>
> WHITESPACE : ( '\t' | ' ' | '\r' | '\n' )+ { $channel = HIDDEN; } ;
>
> fragment DIGIT : '0'..'9' ;
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From yurushkin at rambler.ru  Sun Sep 20 08:12:37 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 20 Sep 2009 19:12:37 +0400
Subject: [antlr-interest] c target - rhow can i obtain retval values
Message-ID: <op.u0j9vbn2t3jqlu@win-mupvrp0jyrf>

Good day,
I use C target:


> char_selector[FortranDeclarations *decls]
returns [TypeParam *len, TypeParam *kind]

len, kind - return values.
but how can i obtain them vaues in grammar?

i.e.
> len = new TypeParam

is not correct, because result .C file contains only "retval" variable
(not len).


-- 
Best regards,
Michael

From jimi at temporal-wave.com  Sun Sep 20 08:28:44 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 20 Sep 2009 08:28:44 -0700
Subject: [antlr-interest] Please help to left-refactor this simple ebnf
	grammar
In-Reply-To: <9c69eb320909200345u42e19c93qbb1c741f1c390615@mail.gmail.com>
References: <9c69eb320909200345u42e19c93qbb1c741f1c390615@mail.gmail.com>
Message-ID: <ED5B5C9A-FA9F-4F50-85E9-70CCDF791519@temporal-wave.com>

Your pareser rules are all starting with upper case letters and they  
should start with lower case.

Jim

On Sep 20, 2009, at 3:45 AM, Artem Golubev <artemkagolubev at gmail.com>  
wrote:

> I just can't get how I can left-refactor the following grammar.  
> Please, help.
> Currently I get "(211): ebnf.g:1:8: [fatal] rule Tokens has non-LL 
> (*) decision due to recursive rule invocations reachable from alts  
> 8,9. Resolve by left-factoring or using syntactic predicates or  
> using backtrack=true option." error with it.
>
> grammar ebnf;
>
> options {
> output = AST;
> language = CSharp2;
> }
>
> tokens {
> OPENBRACKET =	 '(';
> CLOSEBRACKET	=	 ')';
> ONEORMOREKEYWORD= '+';
> ANYKEYWORD	= '*';
> OPTIONALKEYWORD = '?';
> ORKEYWORD =	 '|';	
> }
>
> /*------------------------------------------------------------------
> * PARSER RULES
> *------------------------------------------------------------------*/
> OrList : List (ORKEYWORD List)*;
>
> List	: (Mutliplication)+;
>
> Mutliplication : Atom ( ONEORMOREKEYWORD | OPTIONALKEYWORD |  
> ANYKEYWORD )?;
>
> Atom	: IDENTIFIER | Group;
>
> Group : OPENBRACKET OrList CLOSEBRACKET;
>
> /*------------------------------------------------------------------
> * LEXER RULES
> *------------------------------------------------------------------*/
>
> IDENTIFIER : (DIGIT)+ ;
>
> WHITESPACE : ( '\t' | ' ' | '\r' | '\n' )+ { $channel = HIDDEN; } ;
>
> fragment DIGIT	: '0'..'9' ;
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From yurushkin at rambler.ru  Sun Sep 20 08:35:36 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 20 Sep 2009 19:35:36 +0400
Subject: [antlr-interest] c target:   "string a = NULL;  " generated
Message-ID: <op.u0kaxmt9t3jqlu@win-mupvrp0jyrf>

There is also one question. I haven't found the answer on this one yet :(

I use C target, but compile it as C++ code. there is a following problem:
all variables are initialized by NULL value. So I get something like that:

> string a = NULL;

How can I exclude such definitions?

-- 
Best regards,
Michael

From jimi at temporal-wave.com  Sun Sep 20 08:36:15 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 20 Sep 2009 08:36:15 -0700
Subject: [antlr-interest] c target - rhow can i obtain retval values
In-Reply-To: <op.u0j9vbn2t3jqlu@win-mupvrp0jyrf>
References: <op.u0j9vbn2t3jqlu@win-mupvrp0jyrf>
Message-ID: <FE9B82E0-E20A-4A00-ACA9-4C307E806526@temporal-wave.com>

Returns and so on must be pointers to things as the return of a rule  
is a struct. You must use $ to access them.

Please search for many past posts about this.

Jim

On Sep 20, 2009, at 8:12 AM, ??????? ??????  
<yurushkin at rambler.ru> wrote:

> Good day,
> I use C target:
>
>
>> char_selector[FortranDeclarations *decls]
> returns [TypeParam *len, TypeParam *kind]
>
> len, kind - return values.
> but how can i obtain them vaues in grammar?
>
> i.e.
>> len = new TypeParam
>
> is not correct, because result .C file contains only "retval" variable
> (not len).
>
>
> -- 
> Best regards,
> Michael
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From hallo at eduard-ralph.de  Sun Sep 20 10:23:42 2009
From: hallo at eduard-ralph.de (Eduard Ralph)
Date: Sun, 20 Sep 2009 19:23:42 +0200
Subject: [antlr-interest] Problems with Pre-processing instructions of C#
Message-ID: <956DC906446463408D4335470F4465C41C4B4D23@winxbede09.exchange.xchg>

Hi community,

I'm fighting with the processing of pre-processing instructions according to C# specs. The BNF is:

Whitespace(opt) '#' Whitespace(opt) 'error' input-characters
Whitespace(opt) '#' Whitespace(opt) 'warning' input-characters
Whitespace(opt) '#' Whitespace(opt) 'line'  ...

where
 Whitespace(opt) can be optionally one or more spaces ('\u0020','\u00A0', and a few more)
 Input-characters is anything except newline ('\n', and a few more)

I wrote in the Lexer, where the other rules are fragments


PP_DIAGNOSTIC      :        (WHITESPACE* HASH WHITESPACE* 'error')=>WHITESPACE* HASH WHITESPACE* ERROR INPUT_CHARACTER*
                            |        (WHITESPACE* HASH WHITESPACE* 'warning')=>WHITESPACE* HASH WHITESPACE* WARNING INPUT_CHARACTER*
                            ;


PP_LINE                 :        (WHITESPACE* HASH WHITESPACE* 'line')=> WHITESPACE* HASH WHITESPACE* LINE PP_LINE_INDICATOR NEWLINE
                            ;

fragment PP_LINE_INDICATOR      :        INTEGER_LITERAL PP_FILE_NAME?
                                               |        IDENTIFIER_OR_KEYWORD
                                               ;

fragment PP_FILE_NAME              :        STRING_LITERAL
                                               ;

fragment HASH                          :        '#';


Unfortunately the DFA in the Lexer doesn't recognize correctly which Lexer rule applies and now I'm wondering why this is so. Some thoughts and help would be greatly appreciated.

Thanks in advance,

Eduard
________________________________
The essential is to excite the spectators. If that means playing Hamlet
on a flying trapeze or in an aquarium, you do it.
- Orson Welles

It is not the strongest of the species that survives, nor the most
intelligent that survives. It is the one that is the most adaptable to change.
- Charles Darwin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090920/1193342e/attachment.html 

From jimi at temporal-wave.com  Sun Sep 20 11:49:15 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 20 Sep 2009 11:49:15 -0700
Subject: [antlr-interest] c target:   "string a = NULL;  " generated
In-Reply-To: <op.u0kaxmt9t3jqlu@win-mupvrp0jyrf>
References: <op.u0kaxmt9t3jqlu@win-mupvrp0jyrf>
Message-ID: <4AB6792B.1010309@temporal-wave.com>

On 09/20/2009 08:35 AM, ??????? ?????? wrote:
> There is also one question. I haven't found the answer on this one yet :(
>
> I use C target, but compile it as C++ code. there is a following problem:
> all variables are initialized by NULL value. So I get something like that:
>
>    
>> string a = NULL;
>>      
> How can I exclude such definitions?
>
>    
Please read past posts about this (markmail search).

It cannot really be done unless I don't initialize any variables and 
such initializations are relied upon. You need to use pointers not objects.

Jim

From jimi at temporal-wave.com  Sun Sep 20 11:55:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 20 Sep 2009 11:55:59 -0700
Subject: [antlr-interest] Problems with Pre-processing instructions of C#
In-Reply-To: <956DC906446463408D4335470F4465C41C4B4D23@winxbede09.exchange.xchg>
References: <956DC906446463408D4335470F4465C41C4B4D23@winxbede09.exchange.xchg>
Message-ID: <4AB67ABF.40804@temporal-wave.com>

On 09/20/2009 10:23 AM, Eduard Ralph wrote:
>
> Hi community,
>
> I'm fighting with the processing of pre-processing instructions 
> according to C# specs. The BNF is:
>
> Whitespace(opt) '#' Whitespace(opt) 'error' input-characters
>
> Whitespace(opt) '#' Whitespace(opt) 'warning' input-characters
>
> Whitespace(opt) '#' Whitespace(opt) 'line'  ...
>
> where
>
>  Whitespace(opt) can be optionally one or more spaces 
> ('\u0020','\u00A0', and a few more)
>
>  Input-characters is anything except newline ('\n', and a few more)
>
> I wrote in the Lexer, where the other rules are fragments
>
> PP_DIAGNOSTIC      :        (WHITESPACE* HASH WHITESPACE* 
> 'error')=>WHITESPACE* HASH WHITESPACE* ERROR INPUT_CHARACTER*
>
>                             |        (WHITESPACE* HASH WHITESPACE* 
> 'warning')=>WHITESPACE* HASH WHITESPACE* WARNING INPUT_CHARACTER*
>
>                             ;
>
> PP_LINE                 :        (WHITESPACE* HASH WHITESPACE* 
> 'line')=> WHITESPACE* HASH WHITESPACE* LINE PP_LINE_INDICATOR NEWLINE
>
>                             ;
>
> fragment PP_LINE_INDICATOR      :        INTEGER_LITERAL PP_FILE_NAME?
>
>                                                |        
> IDENTIFIER_OR_KEYWORD
>
>                                                ;
>
> fragment PP_FILE_NAME              :        STRING_LITERAL
>
>                                                ;
>
> fragment HASH                          :        '#';
>
> Unfortunately the DFA in the Lexer doesn't recognize correctly which 
> Lexer rule applies and now I'm wondering why this is so. Some thoughts 
> and help would be greatly appreciated.
>
>

You cannot do it like this. The pre-processor has to be in the lexer, as 
per the specs, but it is very tricky to get correct. Also you have to 
make it recursive and recognize the difference between the usages of 
'#'. It is more than can be explained in an email or two.

I have a working C# 3.x parser and tree parser, which you can try online 
here: 
http://www.temporal-wave.com/index.php?option=com_psrrun&view=psrrun&Itemid=58 
if you are interested.

It will save you a lot of time and already deals with the pre-processor 
(preserves in own channel) and every example in the spec, as well as 
compiling the mono source and mono regression tests (as a test), LINQ 
and the full spec basically.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090920/f6ca7572/attachment.html 

From edward at batutis.com  Sun Sep 20 15:29:10 2009
From: edward at batutis.com (Edward Batutis)
Date: Sun, 20 Sep 2009 18:29:10 -0400
Subject: [antlr-interest] Debugging help please
Message-ID: <afd2504a0909201529u448c657anada05b600dd97d03@mail.gmail.com>

Hi,

I started using ANTLR yesterday. I created my first grammar file via
ANTLRWorks. Everything was fine for awhile, then after typing about
600 lines of code I noticed that there was an error in the syntax
diagram pane:

"Cannot display rule "xxx" because start state not found"

The syntax highlighting in the editor didn't show any errors. So, I
pressed Ctl-R ('check grammar') which reported "check grammar
succeeded". So, I selected "Generate/Show Parser Code". This
complained about an exception which I have copied from the console
pane:

-----------pane contents-------------
[18:19:42] Checking Grammar...
[18:20:02] error(10):  internal error: Exception SMF.g:410:9:
expecting '>', found
'p'@org.antlr.grammar.v2.ANTLRLexer.nextToken(ANTLRLexer.java:347):
unexpected stream error from parsing SMF.g

[18:20:02] error(150):  grammar file SMF.g has no rules
[18:20:02] error(100): SMF.g:0:0: syntax error: assign.types:
<AST>:0:0: unexpected end of subtree
[18:20:02] error(100): SMF.g:0:0: syntax error: define: <AST>:0:0:
unexpected end of subtree
[18:20:02] error(10):  internal error: Exception SMF.g:410:9:
expecting '>', found
'p'@org.antlr.grammar.v2.ANTLRLexer.nextToken(ANTLRLexer.java:347):
unexpected stream error from parsing SMF.g

[18:20:02] error(150):  grammar file SMF.g has no rules
[18:20:02] error(100): SMF.g:0:0: syntax error: assign.types:
<AST>:0:0: unexpected end of subtree
[18:20:02] error(100): SMF.g:0:0: syntax error: define: <AST>:0:0:
unexpected end of subtree
[18:20:02] error(10):  internal error: Exception C:\SMF.g:410:9:
expecting '>', found
'p'@org.antlr.grammar.v2.ANTLRLexer.nextToken(ANTLRLexer.java:347):
unexpected stream error from parsing C:\Documents and
Settings\ebatutis\My Documents\Contracts\netapp2\SMF.g

[18:20:02] error(150):  grammar file C:\SMF.g has no rules
[18:20:02] error(100): C:\SMF.g:0:0: syntax error: assign.types:
<AST>:0:0: unexpected end of subtree
[18:20:02] error(100): C:\SMF.g:0:0: syntax error: define: <AST>:0:0:
unexpected end of subtree
[18:20:02] error(100): C:\SMF.g:0:0: syntax error: antlr.print:
<AST>:0:0: unexpected end of subtree
-----------pane contents-------------


Note that it is "expecting '>', found 'p'. Well, this syntax error is
inside a quoted string

tableWritePrivilege
	:
	'write-privilege'
	(ATTRIBUTES_PRIVILEGE)
	'{'
		fieldNameList
	'}'
	;

If I remove that line then it complains about syntax errors inside
other literal strings later on in the file. If I forgot a quote
somewhere I can't find it.

My question: how do I debug this? I found a page listing various
switches and I've added them to the switch options in ANTLRWorks but
they don't seem to help.

Suggestions?

Thanks,

=Ed

From david-sarah at jacaranda.org  Sun Sep 20 16:54:25 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Mon, 21 Sep 2009 00:54:25 +0100
Subject: [antlr-interest] Problems with Pre-processing instructions of C#
In-Reply-To: <956DC906446463408D4335470F4465C41C4B4D23@winxbede09.exchange.xchg>
References: <956DC906446463408D4335470F4465C41C4B4D23@winxbede09.exchange.xchg>
Message-ID: <4AB6C0B1.9080901@jacaranda.org>

Eduard Ralph wrote:
> Hi community,
> 
> I'm fighting with the processing of pre-processing instructions according to C# specs. The BNF is:
> 
> Whitespace(opt) '#' Whitespace(opt) 'error' input-characters
> Whitespace(opt) '#' Whitespace(opt) 'warning' input-characters
> Whitespace(opt) '#' Whitespace(opt) 'line'  ...
> 
> where
>  Whitespace(opt) can be optionally one or more spaces ('\u0020','\u00A0', and a few more)
>  Input-characters is anything except newline ('\n', and a few more)
> 
> I wrote in the Lexer, where the other rules are fragments
> 
> 
> PP_DIAGNOSTIC      :        (WHITESPACE* HASH WHITESPACE* 'error')=>WHITESPACE* HASH WHITESPACE* ERROR INPUT_CHARACTER*
>                             |        (WHITESPACE* HASH WHITESPACE* 'warning')=>WHITESPACE* HASH WHITESPACE* WARNING INPUT_CHARACTER*
>                             ;

These probably need NEWLINEs at the end.

> PP_LINE                 :        (WHITESPACE* HASH WHITESPACE* 'line')=> WHITESPACE* HASH WHITESPACE* LINE PP_LINE_INDICATOR NEWLINE
>                             ;

This will not skip whitespace between LINE and PP_LINE_INDICATOR or
between PP_LINE_INDICATOR and NEWLINE.

I think you probably want
  ... => WHITESPACE* HASH WHITESPACE* LINE WHITESPACE* PP_LINE_INDICATOR
           WHITESPACE* NEWLINE

but that is likely independent of your problem with the lexer not
recognising which rule applies.

> fragment PP_LINE_INDICATOR      :        INTEGER_LITERAL PP_FILE_NAME?
>                                                |        IDENTIFIER_OR_KEYWORD
>                                                ;
> 
> fragment PP_FILE_NAME              :        STRING_LITERAL
>                                                ;
> 
> fragment HASH                          :        '#';

I would suggest left-factoring and using actions to change the token type:

  fragment PP_DIAGNOSTIC : ;
  fragment PP_LINE : ;

  PP_UNRECOGNIZED
    : WHITESPACE* HASH WHITESPACE*
      ( (ERROR | WARNING)=> INPUT_CHARACTER* { $type = PP_DIAGNOSTIC; }
      | (LINE)=> LINE WHITESPACE* PP_LINE_INDICATOR WHITESPACE*
                                             { $type = PP_LINE; }
      | INPUT_CHARACTER* // leave as type PP_UNRECOGNIZED [1]
      )? NEWLINE
    ;


[1] omit this line if you want an unrecognized instruction to be a lexer
    mismatch, but I would suggest leaving it for better error recovery.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Sun Sep 20 17:03:06 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 20 Sep 2009 17:03:06 -0700
Subject: [antlr-interest] Problems with Pre-processing instructions of C#
In-Reply-To: <4AB6C0B1.9080901@jacaranda.org>
References: <956DC906446463408D4335470F4465C41C4B4D23@winxbede09.exchange.xchg>
	<4AB6C0B1.9080901@jacaranda.org>
Message-ID: <AE575413-EFEF-4B7A-A651-8DE3E259E397@temporal-wave.com>

Yeah. But the # character is overloaded in the lexer and so you need  
to keepbstate for that and then you must keep on/off state for pass  
through, which you must implement as a stack. You need gated  
predicates for directives etc. It took me good few days of wrangling  
to get this correct. Best approach is to get #if working, them add  
#else and so on.

Jim

On Sep 20, 2009, at 4:54 PM, David-Sarah Hopwood <david-sarah at jacaranda.org 
 > wrote:

> Eduard Ralph wrote:
>> Hi community,
>>
>> I'm fighting with the processing of pre-processing instructions  
>> according to C# specs. The BNF is:
>>
>> Whitespace(opt) '#' Whitespace(opt) 'error' input-characters
>> Whitespace(opt) '#' Whitespace(opt) 'warning' input-characters
>> Whitespace(opt) '#' Whitespace(opt) 'line'  ...
>>
>> where
>> Whitespace(opt) can be optionally one or more spaces  
>> ('\u0020','\u00A0', and a few more)
>> Input-characters is anything except newline ('\n', and a few more)
>>
>> I wrote in the Lexer, where the other rules are fragments
>>
>>
>> PP_DIAGNOSTIC      :        (WHITESPACE* HASH WHITESPACE* 'error') 
>> =>WHITESPACE* HASH WHITESPACE* ERROR INPUT_CHARACTER*
>>                            |        (WHITESPACE* HASH WHITESPACE*  
>> 'warning')=>WHITESPACE* HASH WHITESPACE* WARNING INPUT_CHARACTER*
>>                            ;
>
> These probably need NEWLINEs at the end.
>
>> PP_LINE                 :        (WHITESPACE* HASH WHITESPACE*  
>> 'line')=> WHITESPACE* HASH WHITESPACE* LINE PP_LINE_INDICATOR NEWLINE
>>                            ;
>
> This will not skip whitespace between LINE and PP_LINE_INDICATOR or
> between PP_LINE_INDICATOR and NEWLINE.
>
> I think you probably want
>  ... => WHITESPACE* HASH WHITESPACE* LINE WHITESPACE*  
> PP_LINE_INDICATOR
>           WHITESPACE* NEWLINE
>
> but that is likely independent of your problem with the lexer not
> recognising which rule applies.
>
>> fragment PP_LINE_INDICATOR      :        INTEGER_LITERAL  
>> PP_FILE_NAME?
>>                                               |         
>> IDENTIFIER_OR_KEYWORD
>>                                               ;
>>
>> fragment PP_FILE_NAME              :        STRING_LITERAL
>>                                               ;
>>
>> fragment HASH                          :        '#';
>
> I would suggest left-factoring and using actions to change the token  
> type:
>
>  fragment PP_DIAGNOSTIC : ;
>  fragment PP_LINE : ;
>
>  PP_UNRECOGNIZED
>    : WHITESPACE* HASH WHITESPACE*
>      ( (ERROR | WARNING)=> INPUT_CHARACTER* { $type = PP_DIAGNOSTIC; }
>      | (LINE)=> LINE WHITESPACE* PP_LINE_INDICATOR WHITESPACE*
>                                             { $type = PP_LINE; }
>      | INPUT_CHARACTER* // leave as type PP_UNRECOGNIZED [1]
>      )? NEWLINE
>    ;
>
>
> [1] omit this line if you want an unrecognized instruction to be a  
> lexer
>    mismatch, but I would suggest leaving it for better error recovery.
>
> -- 
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From gerald at certiv.net  Mon Sep 21 00:00:30 2009
From: gerald at certiv.net (Gerald Rosenberg)
Date: Mon, 21 Sep 2009 00:00:30 -0700
Subject: [antlr-interest] AntlrDT v1.1 pre-release
Message-ID: <200909210700.n8L70dcT011373@zinc.newtechlaw.com>

A pre-release version of AntlrDT is available for testing:

www.certiv.net/download/certiv-antlrdt-1.1.0.zip

New feature in this release is a hybrid grammar formatter:
  -- uses a Tree Pattern Matcher-based formatter to format Antlr elements
  -- uses the JDT platform formatter to format Java elements 
(header/member/action code/etc).

The JDT formatter can be disabled -- Antlr element formatting alone 
should still work with other native languages.

Fair number of formatting style options are implemented (default 
configuration is all-off).  Trying to craft wrapping and alignment 
operations to respect manual formatting choices (read: going slow in 
these areas, trying to figure out what makes sense to do).

Use is standard: ctrl-shift-f to format, ctrl-z to undo, changes show 
in standard fashion in the diff-gutter bar.  Any formatting failures 
are reported in the <eclipse_home>/AntlrDT.log file.

Feedback on stability/failures/further style option controls desired 
would be appreciated.

Gerald


From micke.hovmoller at gmail.com  Mon Sep 21 08:21:50 2009
From: micke.hovmoller at gmail.com (=?ISO-8859-1?Q?Micke_Hovm=F6ller?=)
Date: Mon, 21 Sep 2009 17:21:50 +0200
Subject: [antlr-interest] Rule coverage testing
In-Reply-To: <679a2cc0909181027u4a7c126bs994cccf3dd291f81@mail.gmail.com>
References: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>
	<3CB8EB53-340F-4949-93DF-51AFBE05073F@temporal-wave.com>
	<679a2cc0909181027u4a7c126bs994cccf3dd291f81@mail.gmail.com>
Message-ID: <18b4fcc20909210821o57544189ide4cd1be30e97d24@mail.gmail.com>

There is a code coverade plugin in NetBeans, so I tried with that.

It sort of works. My grammar is 656 lines. The resulting parser is 7074
lines, both including whitespace.

The coverage report says that my tests cover 2338 of 2966 lines.
Unfortunately, I can't find out how to break this down by function. The
parser file is color coded per line, but I can't see the difference between
lines counted as whitespace and lines that are not covered but really should
be.

Also, a large amount of the uncovered lines are exception handling, most of
which is automatically generated, and I'm not interested in trying to come
up with test cases for that, if that is even possible in every case.

Finally, some of the stuff doesn't make any sense to me. For instance,
towards the end is this code:
---
    static final String DFA56_eotS =
        "\33\uffff";
    static final String DFA56_eofS =
        "\33\uffff";
    static final String DFA56_minS =
        "\3\4\1\uffff\1\4\23\uffff\1\4\2\uffff";
    static final String DFA56_maxS =
        "\3\u008d\1\uffff\1\u008d\23\uffff\1\u008d\2\uffff";
    static final String DFA56_acceptS =
        "\3\uffff\1\26\1\uffff\1\1\1\2\1\3\1\4\1\5\1\7\1\10\1\11\1\12\1"+
        "\13\1\14\1\15\1\16\1\21\1\22\1\23\1\24\1\25\1\20\1\uffff\1\17\1"+
        "\6";
    static final String DFA56_specialS =
        "\33\uffff}>";
    static final String[] DFA56_transitionS = {
            "\1\3\1\uffff\1\2\2\uffff\1\1\1\15\1\22\2\uffff\1\10\1\4\1\16"+
( This last string goes on for 40 lines)
---

The last static final String line is marked as covered, but not the others.
And it's quite unclear to me if the 40 line string is counted as 1 line, 40
lines (all covered) or 1 covered and 39 uncovered lines. I suspect the
first, but have found no good documentation and no proper reports.

It's possible (no, make that "likely") that I am doing something wrong, and
I would very much appreciate pointers in the right direction.

/Micke

On Fri, Sep 18, 2009 at 7:27 PM, Joshua Ganderson
<joshganderson at gmail.com>wrote:

> Why not just use unit tests that leverage your test files and use a
> coverage plugin to test coverage by class/method when running your tests? I
> don't know about netbeans but eclipse has some nice/free plugins for this.
>
>
> On Fri, Sep 18, 2009 at 6:24 AM, Jim Idle <jimi at temporal-wave.com> wrote:
>
>> Switch to maven, write coverage tests (there are food choices for java
>> ones ) to run against the binary parser and see which methods are
>> never called . Methods are named after rules.
>>
>> Jim
>>
>> On Sep 18, 2009, at 3:58 AM, Micke Hovm?ller
>> <micke.hovmoller at gmail.com> wrote:
>>
>> > I've written a reasonably large grammar for handling poker hand
>> > histories. I have worked on and off for about a year or so on this.
>> > During this time, the file format has changed slightly. I suspect
>> > that I now have a bunch of rules in my grammar that are no longer
>> > used.
>> >
>> > What are best practices for establishing rule coverage test cases?
>> > Ideally, I want to have a bunch of infiles, run them through the
>> > grammar and have output displaying which rules were never used.
>> > Showing frequency of usage would be nice, but it is definitely not
>> > needed.
>> >
>> > This is developed in NetBeans 6.7.1 with the ANTLR plugin, so
>> > anything that runs in that environment is much preferred to any
>> > other solution, but I am prepared to switch IDE if that is required.
>> >
>> > /Micke
>> >
>> >
>> > List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> > Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090921/9fb07e7d/attachment.html 

From jimi at temporal-wave.com  Mon Sep 21 08:43:58 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 21 Sep 2009 08:43:58 -0700
Subject: [antlr-interest] Rule coverage testing
In-Reply-To: <18b4fcc20909210821o57544189ide4cd1be30e97d24@mail.gmail.com>
References: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>	<3CB8EB53-340F-4949-93DF-51AFBE05073F@temporal-wave.com>	<679a2cc0909181027u4a7c126bs994cccf3dd291f81@mail.gmail.com>
	<18b4fcc20909210821o57544189ide4cd1be30e97d24@mail.gmail.com>
Message-ID: <4AB79F3E.4080903@temporal-wave.com>

On 09/21/2009 08:21 AM, Micke Hovm?ller wrote:
> There is a code coverade plugin in NetBeans, so I tried with that.
>
> It sort of works. My grammar is 656 lines. The resulting parser is 
> 7074 lines, both including whitespace.
>
> The coverage report says that my tests cover 2338 of 2966 lines. 
> Unfortunately, I can't find out how to break this down by function. 
Sounds like you need to use a different plugin - the coverage tool for 
netbeans says it is from Netbeans beta. There are quite a number of 
tools but Cobertura seems to be most widely used.

> The parser file is color coded per line, but I can't see the 
> difference between lines counted as whitespace and lines that are not 
> covered but really should be.

No options?
>
> Also, a large amount of the uncovered lines are exception handling, 
> most of which is automatically generated, and I'm not interested in 
> trying to come up with test cases for that, if that is even possible 
> in every case.

Yes, and no. Exceptions for parsing you want to cover right? People 
forget that a good regression test for a parser is also to test what it 
does with incorrect input - good and expected message vs "Null pointer 
exception at...."

>
> Finally, some of the stuff doesn't make any sense to me. For instance, 
> towards the end is this code:
> ---
>     static final String DFA56_eotS =
>         "\33\uffff";
...
>     static final String[] DFA56_transitionS = {
>             
> "\1\3\1\uffff\1\2\2\uffff\1\1\1\15\1\22\2\uffff\1\10\1\4\1\16"+
> ( This last string goes on for 40 lines)
> ---
>
> The last static final String line is marked as covered, but not the 
> others. 
As those strings are static and final, then unless the JVM is trying to 
be clever and only initializing them on use (I am pretty sue it does not 
do this, but generates a set of iload istore), then I think that the 
plugin just isn't very good at highlighting. These are the DFAs with run 
length encoding to save on the massive class that would otherwise be 
generated for DFA initialization.

> And it's quite unclear to me if the 40 line string is counted as 1 
> line, 40 lines (all covered) or 1 covered and 39 uncovered lines. I 
> suspect the first, but have found no good documentation and no proper 
> reports.
>
> It's possible (no, make that "likely") that I am doing something 
> wrong, and I would very much appreciate pointers in the right direction.

I don't think you are. I think you just need a better coverage tool.

http://cobertura.sourceforge.net/

Jim

From martin.potier at gmail.com  Mon Sep 21 08:46:05 2009
From: martin.potier at gmail.com (Martin Potier)
Date: Mon, 21 Sep 2009 17:46:05 +0200
Subject: [antlr-interest] Precedence operator ?
Message-ID: <4AB79FBD.2060706@gmail.com>

Hi there,

I read something about precedence on the web
(http://www.antlr.org/wiki/display/ANTLR3/Operator+precedence+parser)
and I'm very interested about it ><. This document was written in 2008
and this feature was announced for version 3.2, is it still the case ?

Cheers

Martin

From jimi at temporal-wave.com  Mon Sep 21 08:59:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 21 Sep 2009 08:59:59 -0700
Subject: [antlr-interest] Precedence operator ?
In-Reply-To: <4AB79FBD.2060706@gmail.com>
References: <4AB79FBD.2060706@gmail.com>
Message-ID: <4AB7A2FF.2080107@temporal-wave.com>

On 09/21/2009 08:46 AM, Martin Potier wrote:
> Hi there,
>
> I read something about precedence on the web
> (http://www.antlr.org/wiki/display/ANTLR3/Operator+precedence+parser)
> and I'm very interested about it><. This document was written in 2008
> and this feature was announced for version 3.2, is it still the case ?
>
> Cheers
>
> Martin
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>    
Ter has plans to implement this in one form or another but we are going 
to skip what was planned to be 3.1.4 and release 3.2 instead. This is 
mainly because there is a lot of extra tree related stuff in the next 
release (well, in the Java version) that is required for his new book 
and it seemed too much to add for a point release. So, it will be done 
(I can't speak to when), but it won't be the 3.2 release. Ter?

Jim

From so at deluxe-design.at  Mon Sep 21 11:07:08 2009
From: so at deluxe-design.at (Stefan Oestreicher)
Date: Mon, 21 Sep 2009 20:07:08 +0200
Subject: [antlr-interest] parse error because of AST rewrite rules?
Message-ID: <4AB7C0CC.7020507@deluxe-design.at>

Hi,

I'm working on a grammar for a simple programming language and I'd like 
to support variable declarations like that:
int a, b = 3

I started out with the following rule:

variableDeclaration
    :   type ID ( COMMA ID )* ( ASSIGN expression )?
    ;

Now I'd like to generate an AST for the above example that looks like that:
^(VAR_DEF int a)
^(VAR_DEF int b)
^(= a 3)
^(= b a)

So I've tried it with the following rules:

--- grammar snippet ---
variableDeclaration
    :    simpleVariableDeclaration
    |    listVariableDeclaration
    ;
   
simpleVariableDeclaration
    :    type ID ( ASSIGN expression )?
        ->    ^(VAR_DEF ID type)
                ^(ASSIGN ID expression)?
    ;   
   
listVariableDeclaration
    :    type first=ID ( COMMA other+=ID )+ 
listVariableAssignment[$first, $other]?
        ->    ^(VAR_DEF $first type)
                ^(VAR_DEF $other type)
            listVariableAssignment?
    ;
   
listVariableAssignment[pANTLR3_COMMON_TOKEN first, pANTLR3_VECTOR other]
    :    ASSIGN expression
        ->    ^(ASSIGN {$first} expression)
                ^(ASSIGN {$other} {$first})+
    ;
--- /grammar snippet ---

I've also tried this simpler variant for listVariableDeclaration:

--- grammar snippet ---
listVariableDeclaration
    :    (    type first=ID ( COMMA other+=ID )+
            ->    ^(VAR_DEF $first type)
                    ^(VAR_DEF $other type)
         )
         (    ASSIGN expression
             ->   ^(ASSIGN $first expression)
                    ^(ASSIGN $other $first)+
         )?
    ;
--- /grammar snippet ---

The modified rules still produce a correct parse tree in the interpreter 
but the generated code raises a parse error. It either complains about 
the assignment operator after the ID list or about the semicolon the 
terminates the declaration (not shown in the example).
If I remove the rewrite rules there is no problem.

I'd appreciate any hint about what I'm doing wrong. I'm using the C 
target btw, version 3.1.3.

Thanks,

Stefan

From jimi at temporal-wave.com  Mon Sep 21 11:29:14 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Mon, 21 Sep 2009 11:29:14 -0700
Subject: [antlr-interest] parse error because of AST rewrite rules?
In-Reply-To: <4AB7C0CC.7020507@deluxe-design.at>
References: <4AB7C0CC.7020507@deluxe-design.at>
Message-ID: <4AB7C5FA.1080408@temporal-wave.com>

On 09/21/2009 11:07 AM, Stefan Oestreicher wrote:
> Hi,
>
> I'm working on a grammar for a simple programming language and I'd like
> to support variable declarations like that:
> int a, b = 3
>
> I started out with the following rule:
>
> variableDeclaration
>      :   type ID ( COMMA ID )* ( ASSIGN expression )?
>      ;
>    
Do you really mean that, or do you mean:

(type (ASSIGN expression)?) ( COMMA type (ASSIGN expression)?)*


However, it looks like your simpleVariable and listVariable need left 
factoring (bring all the common things in to one rule and branch alts 
where they differ.

Jim
> Now I'd like to generate an AST for the above example that looks like that:
> ^(VAR_DEF int a)
> ^(VAR_DEF int b)
> ^(= a 3)
> ^(= b a)
>
> So I've tried it with the following rules:
>
> --- grammar snippet ---
> variableDeclaration
>      :    simpleVariableDeclaration
>      |    listVariableDeclaration
>      ;
>
> simpleVariableDeclaration
>      :    type ID ( ASSIGN expression )?
>          ->     ^(VAR_DEF ID type)
>                  ^(ASSIGN ID expression)?
>      ;
>
> listVariableDeclaration
>      :    type first=ID ( COMMA other+=ID )+
> listVariableAssignment[$first, $other]?
>          ->     ^(VAR_DEF $first type)
>                  ^(VAR_DEF $other type)
>              listVariableAssignment?
>      ;
>
> listVariableAssignment[pANTLR3_COMMON_TOKEN first, pANTLR3_VECTOR other]
>      :    ASSIGN expression
>          ->     ^(ASSIGN {$first} expression)
>                  ^(ASSIGN {$other} {$first})+
>      ;
> --- /grammar snippet ---
>
> I've also tried this simpler variant for listVariableDeclaration:
>
> --- grammar snippet ---
> listVariableDeclaration
>      :    (    type first=ID ( COMMA other+=ID )+
>              ->     ^(VAR_DEF $first type)
>                      ^(VAR_DEF $other type)
>           )
>           (    ASSIGN expression
>               ->    ^(ASSIGN $first expression)
>                      ^(ASSIGN $other $first)+
>           )?
>      ;
> --- /grammar snippet ---
>
> The modified rules still produce a correct parse tree in the interpreter
> but the generated code raises a parse error. It either complains about
> the assignment operator after the ID list or about the semicolon the
> terminates the declaration (not shown in the example).
> If I remove the rewrite rules there is no problem.
>
> I'd appreciate any hint about what I'm doing wrong. I'm using the C
> target btw, version 3.1.3.
>
> Thanks,
>
> Stefan
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>    


From so at deluxe-design.at  Mon Sep 21 11:51:05 2009
From: so at deluxe-design.at (Stefan Oestreicher)
Date: Mon, 21 Sep 2009 20:51:05 +0200
Subject: [antlr-interest] parse error because of AST rewrite rules?
In-Reply-To: <4AB7C5FA.1080408@temporal-wave.com>
References: <4AB7C0CC.7020507@deluxe-design.at>
	<4AB7C5FA.1080408@temporal-wave.com>
Message-ID: <4AB7CB19.1080600@deluxe-design.at>

Hi,

Jim Idle schrieb:
> Do you really mean that, or do you mean:
>
> (type (ASSIGN expression)?) ( COMMA type (ASSIGN expression)?)*
>   
Well that's even more fancy but I settle for the simpler variant for now :)
> However, it looks like your simpleVariable and listVariable need left 
> factoring (bring all the common things in to one rule and branch alts 
> where they differ.
>   
Yes you're right. Somehow I didn't see the wood for the trees, thank you 
for pointing me into the right direction, the solution is actually quite 
simple:

variableDeclaration
    :    type ID ( ASSIGN expression )?
        ->     ^(VAR_DEF ID type)
            ^(ASSIGN ID expression)?
    |    type first=ID ( COMMA other+=ID )+ ( ASSIGN expression )?
        ->     ^(VAR_DEF ID type)+
            ^(ASSIGN $first expression)?
            ^(ASSIGN $other $first)*
    ;

Thanks,

Stefan


From david-sarah at jacaranda.org  Mon Sep 21 16:41:18 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 22 Sep 2009 00:41:18 +0100
Subject: [antlr-interest] parse error because of AST rewrite rules?
In-Reply-To: <4AB7C0CC.7020507@deluxe-design.at>
References: <4AB7C0CC.7020507@deluxe-design.at>
Message-ID: <4AB80F1E.8090003@jacaranda.org>

Stefan Oestreicher wrote:
> Hi,
> 
> I'm working on a grammar for a simple programming language and I'd like 
> to support variable declarations like that:
> int a, b = 3
> 
> I started out with the following rule:
> 
> variableDeclaration
>     :   type ID ( COMMA ID )* ( ASSIGN expression )?
>     ;
> 
> Now I'd like to generate an AST for the above example that looks like that:
> ^(VAR_DEF int a)
> ^(VAR_DEF int b)
> ^(= a 3)
> ^(= b a)

Is this your own language? Note that in C, C++, Java, C#, and other
languages with C-derived syntax, "int a, b = 3" would not assign anything
to a; it would leave a uninitialized. It's liable to confuse programmers
of these languages if your language has C-like syntax but differs on this
point. [*]

I also think you may be trying too hard to collapse semantic equivalences
while generating the AST. A declaration initialiser is a different
construct from an assignment. It might (in some language) be equivalent
to an uninitialised declaration followed by an assignment, but an AST is
still an abstract *syntax* tree -- it should preserve syntactic distinctions
such as that between "int a; a = 3;" and "int a = 3;".

(Whether to distinguish between "int a, b;" and "int a; int b;" is
slightly less obvious, but my personal preference would be to preserve
that distinction in the AST as well.)


[*] Whether your language allows uninitialized variables to be *used* is
    a separate issue. Here C and C++ are unsafe and there is good reason
    to diverge from them, as Java and C# do by enforcing "definite
    assignment".

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From Heiko.Folkerts at david-bs.de  Tue Sep 22 01:30:53 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Tue, 22 Sep 2009 10:30:53 +0200
Subject: [antlr-interest] Where to hook up for error handling
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF1303011DD9@DC2>

Hi all,
I need a litle help in error handling for a parser:
I am using a grammar that uses syntactic predicates and therefore has backtracking enabled. Every "line" in our grammar has to end with a semikolon. After diagnosing the various errornious inputs and the coresponding error message I want to be reported, I know that I want only one error per line. So, how can I tell antlr to restart parsing at the beginning of the next line? I understand that the resync mechanism recovers until it finds one of the tokens in the followsets, but I don't know where I should hook up to do it right. The backtracking produced multiple error messages in the past, since all paths are checked - but what If I recognize an error where It is useless to continue checking the other paths?

Any hints on how to know the underlying concepts and ideas are welcome.

Regards
Heiko


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From so at deluxe-design.at  Tue Sep 22 04:27:11 2009
From: so at deluxe-design.at (Stefan Oestreicher)
Date: Tue, 22 Sep 2009 13:27:11 +0200
Subject: [antlr-interest] parse error because of AST rewrite rules?
In-Reply-To: <4AB80F1E.8090003@jacaranda.org>
References: <4AB7C0CC.7020507@deluxe-design.at>
	<4AB80F1E.8090003@jacaranda.org>
Message-ID: <4AB8B48F.1090108@deluxe-design.at>

Hi,

> Is this your own language?
Yes, it's a little toy language I'm working on for educational purposes 
and fun of course.
> Note that in C, C++, Java, C#, and other
> languages with C-derived syntax, "int a, b = 3" would not assign anything
> to a; it would leave a uninitialized. It's liable to confuse programmers
> of these languages if your language has C-like syntax but differs on this
> point. [*]
> I also think you may be trying too hard to collapse semantic equivalences
> while generating the AST. A declaration initialiser is a different
> construct from an assignment. It might (in some language) be equivalent
> to an uninitialised declaration followed by an assignment, but an AST is
> still an abstract *syntax* tree -- it should preserve syntactic distinctions
> such as that between "int a; a = 3;" and "int a = 3;". 
> (Whether to distinguish between "int a, b;" and "int a; int b;" is
> slightly less obvious, but my personal preference would be to preserve
> that distinction in the AST as well.
>   
Those a very good points. I will certainly consider them but first I 
have to get some code generated, I have already
defined much more grammar than intended. I guess that's what one gets 
for antlr being such an awesome tool that makes
defining languages so much fun :)

Thank you very much for your feedback, it's much appreciated.

Stefan

From KLPauba at west.com  Tue Sep 22 09:06:25 2009
From: KLPauba at west.com (Pauba, Kevin L)
Date: Tue, 22 Sep 2009 11:06:25 -0500
Subject: [antlr-interest] How can I set the text of a node?
Message-ID: <226316B3E1F749498E28ACA66321D5BA43F3D4F2@oma00cexmbx03.corp.westworlds.com>

I have two rules for assignments to handle an optional LET keyword:

...
    | KW_let				// Rule A
      lhs = var
      op = operator
      rhs = expression
      -> ^(KW_let $lhs $op $rhs)
    | lhs = var				// Rule B
      op = operator
      rhs = expression
      -> ^(KW_let $lhs $op $rhs)
...

Here's two related gunit test cases:

"let $var = 15" -> (let $var = 15)
"$var = 15" -> (let $var = 15)

But when I run it, it fails on the second case:

test10 (assignmentStatement, line22) -
expected: (let $var = 15)
actual: (KW_let $var = 15)

Is there a way to set the text of the root node of the tree constructed with "Rule B" that would allow this test case to pass? 

I tried something similar to what's shown on pg. 183 of TDAR but I couldn't figure out how to add the child nodes for $lhs, $op and $rhs.

Thanks!


From jimi at temporal-wave.com  Tue Sep 22 10:24:26 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 22 Sep 2009 10:24:26 -0700
Subject: [antlr-interest] How can I set the text of a node?
In-Reply-To: <226316B3E1F749498E28ACA66321D5BA43F3D4F2@oma00cexmbx03.corp.westworlds.com>
References: <226316B3E1F749498E28ACA66321D5BA43F3D4F2@oma00cexmbx03.corp.westworlds.com>
Message-ID: <4AB9084A.70707@temporal-wave.com>

On 09/22/2009 09:06 AM, Pauba, Kevin L wrote:
> I have two rules for assignments to handle an optional LET keyword:
>
> ...
>      | KW_let				// Rule A
>        lhs = var
>        op = operator
>        rhs = expression
>        ->  ^(KW_let $lhs $op $rhs)
>      | lhs = var				// Rule B
>        op = operator
>        rhs = expression
>        ->  ^(KW_let $lhs $op $rhs)
>    

Your problem is here I think. try:

->^(KW_let["let"] .....


Jim
> ...
>
> Here's two related gunit test cases:
>
> "let $var = 15" ->  (let $var = 15)
> "$var = 15" ->  (let $var = 15)
>
> But when I run it, it fails on the second case:
>
> test10 (assignmentStatement, line22) -
> expected: (let $var = 15)
> actual: (KW_let $var = 15)
>
> Is there a way to set the text of the root node of the tree constructed with "Rule B" that would allow this test case to pass?
>
> I tried something similar to what's shown on pg. 183 of TDAR but I couldn't figure out how to add the child nodes for $lhs, $op and $rhs.
>
> Thanks!
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>    


From JOHN851 at yandex.ru  Tue Sep 22 11:55:57 2009
From: JOHN851 at yandex.ru (John851)
Date: Tue, 22 Sep 2009 22:55:57 +0400
Subject: [antlr-interest] ANTLRworks
Message-ID: <117361253645757@webmail6.yandex.ru>

Hello,

Is it possible to load my .stg file in ANTLRworks?

From parrt at cs.usfca.edu  Tue Sep 22 13:35:15 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 22 Sep 2009 13:35:15 -0700
Subject: [antlr-interest] ANTLRworks
In-Reply-To: <117361253645757@webmail6.yandex.ru>
References: <117361253645757@webmail6.yandex.ru>
Message-ID: <F4B807EF-47B1-46D5-BBE2-B49336D04273@cs.usfca.edu>

new version 1.3b yetp
T
On Sep 22, 2009, at 11:55 AM, John851 wrote:

> Hello,
>
> Is it possible to load my .stg file in ANTLRworks?
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From parrt at cs.usfca.edu  Tue Sep 22 14:44:51 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Tue, 22 Sep 2009 14:44:51 -0700
Subject: [antlr-interest] StringTemplate (Java version) 3.2.1 released
Message-ID: <964FBDC5-0275-4779-8451-B661906889B0@cs.usfca.edu>

get it while it's hot:

http://www.stringtemplate.org/download.html

here are the release notes (not a huge amount has changed):

http://www.antlr.org/wiki/display/ST/3.2.1+Release+Notes

This is probably the last point release before my complete rebuild,  
4.0 (which I've started on).

Terence

From ITitov at beeline.ru  Wed Sep 23 00:35:29 2009
From: ITitov at beeline.ru (Ivan Yu Titov)
Date: Wed, 23 Sep 2009 11:35:29 +0400
Subject: [antlr-interest] ANTLR book
Message-ID: <OFE87589C0.1A75A573-ONC325763A.0029843A-C325763A.0029B4BA@abn.beeline.ru>


Hello,

I've recently heard about new ANTLR book. Is there any release date for it?
Thanks in advance.

With best wishes,
Ivan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090923/4968a2db/attachment.html 

From michael.bedward at gmail.com  Wed Sep 23 03:25:18 2009
From: michael.bedward at gmail.com (Michael Bedward)
Date: Wed, 23 Sep 2009 20:25:18 +1000
Subject: [antlr-interest] ANTLR book
In-Reply-To: <OFE87589C0.1A75A573-ONC325763A.0029843A-C325763A.0029B4BA@abn.beeline.ru>
References: <OFE87589C0.1A75A573-ONC325763A.0029843A-C325763A.0029B4BA@abn.beeline.ru>
Message-ID: <e24c4c270909230325q73058ac8kb491edbf4351ad50@mail.gmail.com>

Hi Ivan,

Details and advanced draft are here:
http://www.pragprog.com/titles/tpdsl/language-implementation-patterns

Michael

2009/9/23 Ivan Yu Titov <ITitov at beeline.ru>:
> Hello,
>
> I've recently heard about new ANTLR book. Is there any release date for it?
> Thanks in advance.
>
> With best wishes,
> Ivan
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From KLPauba at west.com  Wed Sep 23 06:07:45 2009
From: KLPauba at west.com (Pauba, Kevin L)
Date: Wed, 23 Sep 2009 08:07:45 -0500
Subject: [antlr-interest] antlr-interest Digest, Vol 58, Issue 22
In-Reply-To: <mailman.1.1253646001.15770.antlr-interest@antlr.org>
References: <mailman.1.1253646001.15770.antlr-interest@antlr.org>
Message-ID: <226316B3E1F749498E28ACA66321D5BA43F3D88A@oma00cexmbx03.corp.westworlds.com>

Worked like a charm!

Jim Idle wrote:
>  Your problem is here I think. try:
>
>  ->^(KW_let["let"] .....


From parrt at cs.usfca.edu  Wed Sep 23 11:30:35 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Wed, 23 Sep 2009 11:30:35 -0700
Subject: [antlr-interest] new tree pattern matching facility
Message-ID: <8F65DB84-98E3-4178-B08F-2D9519DD63AE@cs.usfca.edu>

Howdy, Jim Idle and I are pushing out a new version of antlr today to  
match up with the book. It has new functionality for tree pattern  
matching:

http://www.antlr.org/wiki/display/ANTLR3/Tree+pattern+matching

The new version is going to be called 3.2.

The code for the book is freely available:

http://pragprog.com/titles/tpdsl/source_code

But the discussion on the wiki is somewhat terse ;)

Ter

From cmundi at gmail.com  Wed Sep 23 12:01:24 2009
From: cmundi at gmail.com (C. Mundi)
Date: Wed, 23 Sep 2009 12:01:24 -0700
Subject: [antlr-interest] new tree pattern matching facility
In-Reply-To: <8F65DB84-98E3-4178-B08F-2D9519DD63AE@cs.usfca.edu>
References: <8F65DB84-98E3-4178-B08F-2D9519DD63AE@cs.usfca.edu>
Message-ID: <e794390909231201l58fe7aa8h8d536f27a830039c@mail.gmail.com>

So does this mean that the java and C targets are current with ANTLR 3.2?

Thanks!


On 9/23/09, Terence Parr <parrt at cs.usfca.edu> wrote:
> Howdy, Jim Idle and I are pushing out a new version of antlr today to
> match up with the book. It has new functionality for tree pattern
> matching:
>
> http://www.antlr.org/wiki/display/ANTLR3/Tree+pattern+matching
>
> The new version is going to be called 3.2.
>
> The code for the book is freely available:
>
> http://pragprog.com/titles/tpdsl/source_code
>
> But the discussion on the wiki is somewhat terse ;)
>
> Ter
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>

From jimi at temporal-wave.com  Wed Sep 23 12:29:44 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 23 Sep 2009 12:29:44 -0700
Subject: [antlr-interest] new tree pattern matching facility
In-Reply-To: <e794390909231201l58fe7aa8h8d536f27a830039c@mail.gmail.com>
References: <8F65DB84-98E3-4178-B08F-2D9519DD63AE@cs.usfca.edu>
	<e794390909231201l58fe7aa8h8d536f27a830039c@mail.gmail.com>
Message-ID: <4ABA7728.7020305@temporal-wave.com>

On 09/23/2009 12:01 PM, C. Mundi wrote:
> So does this mean that the java and C targets are current with ANTLR 3.2?
>
> Thanks!
>
>    
I will provide and update shortly once I release the jars, but C target 
and Java target will be a real 3.2 release, other targets may not be. 
The C target will not have all the tree matching stuff that is in the 
Java version for the book, but will have bug fixes and improved @after, 
finally, catch handling (though I don't think it is perfect in the case 
of backtracking parsers). Also, a performance improvement for 
complicated parsers in C target.

More later,

Jim

From jimi at temporal-wave.com  Wed Sep 23 14:32:41 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 23 Sep 2009 14:32:41 -0700
Subject: [antlr-interest] ANTLR Release 3.2 now available
Message-ID: <4ABA93F9.5030408@temporal-wave.com>


  ANTLR Release 3.2

This is a base release of the ANTLR tool and runtime, which provides a 
convenient baseline for Terence's new book and som bug fixes and 
improvements for the C target. Users of the book should use this release.

It provides the following Java stuff:

1) The runtime jar is JDK 1.4 compliant (for others that want this, use 
-source 1.5 -target jsr14 with javac of JDK 1.6);
2) Provides StringTemplate 3.2.1 compatibility (also needed for the book);
3) All additional tree processing facilities (see Wiki updates for 
documentation on this);
4) Lots more tweaks, updates and bug fixes to the Java target;

The download links on the download page should now point to release 3.2. 
Although the Maven artifacts have been deployed to the ANTLR release 
directory, maven has yet to sync either StringTemplate or ANTLR 3.2. 
Currently, I think that there is something wrong with maven central 
sync, but I will leave it the requisite 4 hours before complaining.

Changes to the C templates and runtime will be sent in an upcoming email.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090923/0a53717e/attachment.html 

From lists at brachttal.net  Wed Sep 23 14:35:36 2009
From: lists at brachttal.net (Andreas Volz)
Date: Wed, 23 Sep 2009 23:35:36 +0200
Subject: [antlr-interest] Question with greedy
Message-ID: <20090923233536.2b634fff@frodo.mittelerde>

Hello,

I wrote this grammar:

startrule
	: (property comment property)*
	;
comment
	: COMMENT { printf("Comment: \%s\n", $COMMENT.text->chars); }
	;
	
COMMENT
 	:  '/*' ( options {greedy=false;} : . )* '*/'
 	;
	
property
	: TOKEN { printf("Property: \%s\n", $TOKEN.text->chars);}

TOKEN
	: (ALPHA | DIGIT)+

fragment DIGIT  	
	: '0'..'9'
	;
	
fragment ALPHA
	: 'a'..'z' | 'A'..'Z' |'@'|'.'| ' ' 
	;

The input is:

This is a test /* with a comment */ in the middle
This is a test /* with a comment */ in the middle
This is a test /* with a comment */ in the middle

The result looks good, but some errors are print out:

test.txt(1) : lexer error 3 :
	 at offset 49, near char(0XA) :
	
This is a test /* w
test.txt(2) : lexer error 3 :
	 at offset 50, near char(0XA) :
	
This is a test /* w
test.txt(3) : lexer error 3 :
	 at offset 50, near char(0XA) :
	

Property: This is a test 
Comment: /* with a comment */
Property:  in the middle
Property: This is a test 
Comment: /* with a comment */
Property:  in the middle
Property: This is a test 
Comment: /* with a comment */
Property:  in the middle

BTW: The line ending in this file is 0x0A.

Could anyone explain this error and how to prevent it?

Second question: How do I not include the '/*' and '*/' tags in the
comment match?

regards
	Andreas

From jbb at acm.org  Wed Sep 23 15:24:50 2009
From: jbb at acm.org (John B. Brodie)
Date: Wed, 23 Sep 2009 18:24:50 -0400
Subject: [antlr-interest] Question with greedy
In-Reply-To: <20090923233536.2b634fff@frodo.mittelerde>
References: <20090923233536.2b634fff@frodo.mittelerde>
Message-ID: <1253744690.15409.16.camel@gecko.home.org>

Greetings!

On Wed, 2009-09-23 at 23:35 +0200, Andreas Volz wrote:
> Hello,
> 
> I wrote this grammar:
> 
> startrule
> 	: (property comment property)*
> 	;
> comment
> 	: COMMENT { printf("Comment: \%s\n", $COMMENT.text->chars); }
> 	;
> 	
> COMMENT
>  	:  '/*' ( options {greedy=false;} : . )* '*/'
>  	;
> 	
> property
> 	: TOKEN { printf("Property: \%s\n", $TOKEN.text->chars);}
> 
> TOKEN
> 	: (ALPHA | DIGIT)+
> 
> fragment DIGIT  	
> 	: '0'..'9'
> 	;
> 	
> fragment ALPHA
> 	: 'a'..'z' | 'A'..'Z' |'@'|'.'| ' ' 
> 	;
> 
> The input is:
> 
> This is a test /* with a comment */ in the middle
> This is a test /* with a comment */ in the middle
> This is a test /* with a comment */ in the middle
> 
> The result looks good, but some errors are print out:
> 
> test.txt(1) : lexer error 3 :
> 	 at offset 49, near char(0XA) :
> 	
> This is a test /* w
> test.txt(2) : lexer error 3 :
> 	 at offset 50, near char(0XA) :
> 	
> This is a test /* w
> test.txt(3) : lexer error 3 :
> 	 at offset 50, near char(0XA) :
> 	
> 
> Property: This is a test 
> Comment: /* with a comment */
> Property:  in the middle
> Property: This is a test 
> Comment: /* with a comment */
> Property:  in the middle
> Property: This is a test 
> Comment: /* with a comment */
> Property:  in the middle
> 
> BTW: The line ending in this file is 0x0A.
> 
> Could anyone explain this error and how to prevent it?
> 

Your Lexer has no rule that deals with your line ending character. need
to add a rule similar to:

NEWLINE : '\r' '\n'? | '\n' { $channel = HIDDEN; } ;

> Second question: How do I not include the '/*' and '*/' tags in the
> comment match?
> 

There appears to be no non-ambiguous way to remove the need for the '/*'
and '*/' in the syntax of your COMMENT rule.

However if you mean to remove those elements from the print out of the
comment text in the comment parser rule, then simply substring out the
stuff between the first two and last two characters in the `
$COMMENT.text->chars` inside the printf call (my C is very rusty, i
assume you know how to do that). 

Alternatively you should be able to make the COMMENT rule throw away the
bracketing characters by, inside an action, using $getText to obtain the
string of the comment (including the '/*' and '*/'), substring out the
characters that you want and then use $setText to deposit that substring
back into the COMMENT Token.

again, my C is rusty, and my knowledge of the C code generator is
sketchy at best --- so please consider the above advice to be more
conceptual in nature rather than being precise coding advice.


Hope this helps
   -jbb



From jimi at temporal-wave.com  Wed Sep 23 15:29:32 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 23 Sep 2009 15:29:32 -0700
Subject: [antlr-interest] Question with greedy
In-Reply-To: <20090923233536.2b634fff@frodo.mittelerde>
References: <20090923233536.2b634fff@frodo.mittelerde>
Message-ID: <4ABAA14C.8080109@temporal-wave.com>

On 09/23/2009 02:35 PM, Andreas Volz wrote:
> Hello,
>
> I wrote this grammar:
>
> startrule
> 	: (property comment property)*
> 	;
> comment
> 	: COMMENT { printf("Comment: \%s\n", $COMMENT.text->chars); }
> 	;
> 	
> COMMENT
>   	:  '/*' ( options {greedy=false;} : . )* '*/'
>   	;
> 	
> property
> 	: TOKEN { printf("Property: \%s\n", $TOKEN.text->chars);}
>
> TOKEN
> 	: (ALPHA | DIGIT)+
>
> fragment DIGIT  	
> 	: '0'..'9'
> 	;
> 	
> fragment ALPHA
> 	: 'a'..'z' | 'A'..'Z' |'@'|'.'| ' '
> 	;
>
> The input is:
>
> This is a test /* with a comment */ in the middle
> This is a test /* with a comment */ in the middle
> This is a test /* with a comment */ in the middle
>
> The result looks good, but some errors are print out:
>
> test.txt(1) : lexer error 3 :
> 	 at offset 49, near char(0XA) :
> 	
> This is a test /* w
> test.txt(2) : lexer error 3 :
> 	 at offset 50, near char(0XA) :
> 	
> This is a test /* w
> test.txt(3) : lexer error 3 :
> 	 at offset 50, near char(0XA) :
> 	
>
> Property: This is a test
> Comment: /* with a comment */
> Property:  in the middle
> Property: This is a test
> Comment: /* with a comment */
> Property:  in the middle
> Property: This is a test
> Comment: /* with a comment */
> Property:  in the middle
>
> BTW: The line ending in this file is 0x0A.
>
> Could anyone explain this error and how to prevent it?
>    

Well, you have not specified to the lexer what it should do with those 
chars (I assume that this is C from your code above):

NL : ('\r' | '\n')+ { $channel=HIDDEN; } ;
ANY : . { SKIP(); } ; // Always make this the very last lexer rule
> Second question: How do I not include the '/*' and '*/' tags in the
> comment match?
>    
Cheat (from the top of my head):

COMMENT : '/*' { $start = $pos; } ( options {greedy=false;} : .)* { 
EMIT(); } '*/' ;

I think it is $pos, but you might need to use GETCHARPOSTIONINLINE() 
rather than $pos.

Jim





From jimi at temporal-wave.com  Wed Sep 23 15:41:47 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 23 Sep 2009 15:41:47 -0700
Subject: [antlr-interest] Updates for release 3.2 of the C Target
Message-ID: <4ABAA42B.9000300@temporal-wave.com>

The following should be read carefully before upgrading to release 3.2 
of the C target:

Firstly, please note that this is kind of an interim release for targets 
other than the Jav target and we will be releasing a 3.2.1 version that 
gets all the actively maintained targets up to date as soon as possible. 
However, a number of bugs have been fixed for the C target, which you 
may or may not wish to upgrade for:

1) A number of required bug fixes for tree parsing are included in this 
release, notably some situations where an empty tree coudl be produced 
by accident in a parser - I suspect that there is one more instance of 
this in 3.2 but cannot yet trace it. However, I am going to replace the 
tree building parts that are responsible for this in 3.2.1, which will 
drastically reduce memory footprints, reuse discarded objects and 
drastically improve tree building performance ;
2) A number of bug fixes over release 3.1.3, as shown by looking thorugh 
the JIRA reports closed for 3.1.4 (which will change to 3.2 shortly - we 
were going to have 3.1.4, but the changes were too much for a simple 2 
point release);
3) Changes and fixes for the handling of @after, catch and finally. 
There has always been some confusion over what these mean and especially 
in the C target, where the concepts are not easily handled for all 
combinations of rule options. I woudl very much like for some of you to 
test these changes before 3.2.1:

Note, that the definitions now only depart from Java in the fact that 
the sections do not unwind scopes until AFTER the coded sections have 
been run. This is because there is no garbage collection in C, and 
unwinding too early means it is difficult to free memory allocated in 
scopes (although, that is what the freePtr element of all scope entries 
is for really)...

    * @declarations - used to separate rule local variable definitions
      from their initializations.
    * @init - always gets executed, even before backtracking/memoization
      is looked for.
    * @after - gets executed even if memoization determines that the
      rule has already run for this token position. This is so you can
      release anything that you allocated in @init. Note however that
      @after runs ONLY if the parse was successful. If the rule hits a
      parsing error, then @after is no executed.
    * catch[] - Note that any exception type listed between [] is
      ignored. You can check the exception type by switching on
      EXECEPTION->type. These sections of code are ONLY executed if a
      parsing exception is detected while in the rule.
    * finally - this code is executed whether the rule parses
      successfully or not. This is probably where you should free
      allocations, but you should guard against uninitialized elements,
      which may not have been created on a parse error.


CAVEATS:

    * I have not found a way to access finally code when a rule returns
      as part of a backtracking parser that fails the parse. I ran out
      of time and wil look again at this for 3.2.1 - but you shoudl not
      be using backtracking parsers anyway right ;-). This means that
      you should probably not make allocations in @init until I can work
      out a schema for this - the problems is the accessibility of the
      finally code block in tree walkers.. I have to make it available
      in a wider stringtemplate scope.
    * I have not performed too much testing on this arrangement, so
      please be careful to test your parsers before using 3.2 in
      production (though it is otherwise sound I think)
    * Because you can end up executing both @after and finally code, use
      safe programming patterns (you should be anyway ;-, and assign
      NULL to anything after declaring it and immediately before freeing
      it. Also, guard against free(NULL) unless the semantics of your
      system specify that free(NULL) is allowed. Basically you don;t
      want to end up freeing things twice.


Here is an example of how to use the sections:

rule
scope { int a; }
@init
{
  // init code is here
}
@after {
// After code here - runs if parse is successful
}
: a | b
;
catch []
{
  // exception code - runs on parser error detection
}
finally {
  // finally code - always runs, see caveats though
}

If you make a noddy grammar of this with whatever options you are 
using,  and generate the C code, you can see where the code for each 
section resides.

While still not perfect because of the after stuff in backtracking 
parsers, you should now be able to clean up scopes and so on (though I 
would still recommend you add a free function to the scope instance in 
the @init() section as per the C parser example.


4) Changes to default settings controlling switch() vs if() vs tableDFA. 
The C Target now overrides the default settings for these elements to do 
the following:

avoid generating tables at all costs, even though the tables are 
reasonably contiguous and CPU cache hit rates will help, and cache hit 
fail will dog teh performance of your parser. Hence it is preferable to 
use inline if statements over tables because branch prediction kicks in. 
However, modern C compilers are very good at optimizing large switch 
statements and so the defaults are now changed to generate a switch 
directly for any alt selection between 1 and 3000 labels. You can 
increase this further with new -X options (see -X help message from the 
tool for details). In general, this improves performance a lot for 
complicated parsers with lots of keywords that can be identifiers. As 
much as 25% can be gained. [Thanks to Yitzhak Sapir of DCF Tech for 
pointing the way here.]

The defaults for other targets are unchanged, but you may wish to 
experiment with these new -X options:

$ java -jar antlr-3.2.jar -X
ANTLR Parser Generator  Version 3.2 Sep 23, 2009 14:39:33
   -Xgrtree                print the grammar AST
   -Xdfa                   print DFA as text
   -Xnoprune               test lookahead against EBNF block exit branches
   -Xnocollapse            collapse incident edges into DFA states
   -Xdbgconversion         dump lots of info during NFA conversion
   -Xmultithreaded         run the analysis in 2 threads
   -Xnomergestopstates     do not merge stop states
   -Xdfaverbose            generate DFA states in DOT with NFA configs
   -Xwatchconversion       print a message for each NFA before converting
   -XdbgST                 put tags at start/stop of all templates in output
   -Xnfastates             for nondeterminisms, list NFA states for each 
path
   -Xm m                   max number of rule invocations during 
conversion           [4]
   -Xmaxdfaedges m         max "comfortable" number of edges for single 
DFA state     [65534]
   -Xconversiontimeout t   set NFA conversion timeout (ms) for each 
decision          [1000]
*  -Xmaxinlinedfastates m  max DFA states before table used rather than 
inlining      [10]
   -Xmaxswitchcaselabels m don't generate switch() statements for dfas 
bigger  than m [300]
   -Xminswitchalts m       don't generate switch() statements for dfas 
smaller than m [3]*

Note that the API docs are not yet updated. I will do this with 3.2.1, 
which will have greatly expanded documentation.

Jim


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090923/315f42c8/attachment.html 

From david-sarah at jacaranda.org  Wed Sep 23 17:31:49 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 24 Sep 2009 01:31:49 +0100
Subject: [antlr-interest] Updates for release 3.2 of the C Target
In-Reply-To: <4ABAA42B.9000300@temporal-wave.com>
References: <4ABAA42B.9000300@temporal-wave.com>
Message-ID: <4ABABDF5.9060009@jacaranda.org>

Jim Idle wrote:
> The following should be read carefully before upgrading to release 3.2
> of the C target:
[...]
>    * finally - this code is executed whether the rule parses
>      successfully or not. This is probably where you should free
>      allocations, but you should guard against uninitialized elements,
>      which may not have been created on a parse error.

Are such elements (not variables that you declare yourself) guaranteed
to be NULL?

>    * Because you can end up executing both @after and finally code, use
>      safe programming patterns (you should be anyway ;-, and assign
>      NULL to anything after declaring it and immediately before freeing
>      it.

You mean immediately after freeing it :-)
(i.e. "free(foo); foo = NULL;")

>      Also, guard against free(NULL) unless the semantics of your
>      system specify that free(NULL) is allowed.

"free(NULL)" is defined to be a no-op by the C standard. A libc
implementation that got this wrong would be badly broken, and AFAIK all
the commonly used platforms get it right.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From jimi at temporal-wave.com  Wed Sep 23 18:05:26 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 23 Sep 2009 18:05:26 -0700
Subject: [antlr-interest] Updates for release 3.2 of the C Target
In-Reply-To: <4ABABDF5.9060009@jacaranda.org>
References: <4ABAA42B.9000300@temporal-wave.com>
	<4ABABDF5.9060009@jacaranda.org>
Message-ID: <25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>



On Sep 23, 2009, at 5:31 PM, David-Sarah Hopwood <david-sarah at jacaranda.org 
 > wrote:

> Jim Idle wrote:
>> The following should be read carefully before upgrading to release  
>> 3.2
>> of the C target:
> [...]
>>   * finally - this code is executed whether the rule parses
>>     successfully or not. This is probably where you should free
>>     allocations, but you should guard against uninitialized elements,
>>     which may not have been created on a parse error.
>
> Are such elements (not variables that you declare yourself) guaranteed
> to be NULL?

Yes, this is one of the issues of trying to use something other than  
pointers.
>
>>   * Because you can end up executing both @after and finally code,  
>> use
>>     safe programming patterns (you should be anyway ;-, and assign
>>     NULL to anything after declaring it and immediately before  
>> freeing
>>     it.
>
> You mean immediately after freeing it :-)
> (i.e. "free(foo); foo = NULL;")

You know what I mean ;)
>
>>     Also, guard against free(NULL) unless the semantics of your
>>     system specify that free(NULL) is allowed.
>
> "free(NULL)" is defined to be a no-op by the C standard. A libc
> implementation that got this wrong would be badly broken, and AFAIK  
> all
> the commonly used platforms get it right.

Some platforms define this to be undefined though. Remember there are  
lots if embedded systems that use this. Hence the qualification. I  
think it would have been better to define free(NULL) as safe myself  
but early Lib C would crash if you did this and I think it was C++  
that first took a stand?
>
> -- 
> David-Sarah Hopwood  ?  http://davidsarah.livejournal.com
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From Heiko.Folkerts at david-bs.de  Wed Sep 23 22:56:52 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Thu, 24 Sep 2009 07:56:52 +0200
Subject: [antlr-interest] Howto modify token creation?
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF1303011EAE@DC2>

Hi,
I'd like to use a rule that catches all strings e.g. like identifiers and keywords and create specific tokens depending of the contents of the string. Because new keywords can be added to a database coding all keywords in the grammar is not an option. Do I have to override the emit function to create the different tokens or which way should I take?

Regards

Heiko


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

From indhu.b at s7software.com  Wed Sep 23 23:20:27 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Thu, 24 Sep 2009 11:50:27 +0530
Subject: [antlr-interest] Howto modify token creation?
In-Reply-To: <93FCBF72DCE7634481C5DF1654D8FF1303011EAE@DC2>
References: <93FCBF72DCE7634481C5DF1654D8FF1303011EAE@DC2>
Message-ID: <003b01ca3cdf$1c25e6e0$5471b4a0$@b@s7software.com>

You can do something like

ID	: LETTER (LETTER|DIGIT)*
	{
		String text = getText();
		Integer tknType;
		if( (tknType=table.get(text))!=null ) {
			$type = tknType;
		}
	}

The table can be passed to the lexer using some member function. But I don't
know any clean way how to make sure ANTLR lexer doesn't assign the same int
to some other token.

Curious to know where you are using this. If the lexer emits tokens
dynamically, the parser also has to handle it dynamically right? (using
semantic predicats probably) This has to be a peculiar case.

Cheers, Indhu


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Heiko Folkerts
Sent: Thursday, September 24, 2009 11:27 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Howto modify token creation?

Hi,
I'd like to use a rule that catches all strings e.g. like identifiers and
keywords and create specific tokens depending of the contents of the string.
Because new keywords can be added to a database coding all keywords in the
grammar is not an option. Do I have to override the emit function to create
the different tokens or which way should I take?

Regards

Heiko


Mit freundlichem Gru?
Heiko Folkerts
Systementwicklung und -design
--
______________________________________________
DAVID GmbH ? Wendenring 1 ? 38114 Braunschweig
Tel.: +49 531 24379-14
Fax.: +49 531 24379-79
E-Mail: mailto:Heiko.Folkerts at david-bs.de
WWW:   http://www.david-bs.de?
Eintragung: Amtsgericht Braunschweig, HRB 3167
Gesch?ftsf?hrer: Frank Ptok
______________________________________________

 

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From david-sarah at jacaranda.org  Wed Sep 23 23:32:56 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 24 Sep 2009 07:32:56 +0100
Subject: [antlr-interest] Updates for release 3.2 of the C Target
In-Reply-To: <25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>
References: <4ABAA42B.9000300@temporal-wave.com>
	<4ABABDF5.9060009@jacaranda.org>
	<25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>
Message-ID: <4ABB1298.4080908@jacaranda.org>

Jim Idle wrote:
> On Sep 23, 2009, at 5:31 PM, David-Sarah Hopwood
> <david-sarah at jacaranda.org> wrote:
> 
>> "free(NULL)" is defined to be a no-op by the C standard. A libc
>> implementation that got this wrong would be badly broken, and AFAIK all
>> the commonly used platforms get it right.
> 
> Some platforms define this to be undefined though. Remember there are
> lots if embedded systems that use this. Hence the qualification. I think
> it would have been better to define free(NULL) as safe myself but early
> Lib C would crash if you did this and I think it was C++ that first took
> a stand?

Perhaps very early libc's, but it is defined to be a no-op in C89.
Note that in a system with memory protection, if it does crash then it
will do so immediately with a segfault (at which point you should
complain vigorously to the libc provider).

I do realise that not all systems have memory protection -- but at the
end of the day you can't hope to defend against bugs in a C implementation
in application code, and this behaviour for free(NULL) is not an obscure
thing to rely on.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Thu Sep 24 00:09:42 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 24 Sep 2009 08:09:42 +0100
Subject: [antlr-interest] Howto modify token creation?
In-Reply-To: <003b01ca3cdf$1c25e6e0$5471b4a0$@b@s7software.com>
References: <93FCBF72DCE7634481C5DF1654D8FF1303011EAE@DC2>
	<003b01ca3cdf$1c25e6e0$5471b4a0$@b@s7software.com>
Message-ID: <4ABB1B36.6050902@jacaranda.org>

Indhu Bharathi wrote:
> You can do something like
> 
> ID	: LETTER (LETTER|DIGIT)*
> 	{
> 		String text = getText();
> 		Integer tknType;
> 		if( (tknType=table.get(text))!=null ) {
> 			$type = tknType;
> 		}
> 	}
> 
> The table can be passed to the lexer using some member function. But I don't
> know any clean way how to make sure ANTLR lexer doesn't assign the same int
> to some other token.

YourParser.tokenNames.length should be the first unused token number.

(Obviously, this is relying on an implementation detail, but probably a
fairly stable one.)

Note that if you use token numbers >= tokenNames.length, you should override
getErrorMessage in the parser, so that it doesn't throw an
ArrayIndexOutOfBoundsException when constructing an error message involving
one of these tokens. For example:

@parser::members {
  public String getErrorMessage(RecognitionException e, String[] names) {
    String[] dynamicNames = /* array also containing dynamic token names */;
    return super.getErrorMessage(e, dynamicNames);
  }
}

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From antlr at mirality.co.nz  Thu Sep 24 00:59:06 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Thu, 24 Sep 2009 19:59:06 +1200
Subject: [antlr-interest] Updates for release 3.2 of the C Target
In-Reply-To: <25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>
References: <4ABAA42B.9000300@temporal-wave.com>
	<4ABABDF5.9060009@jacaranda.org>
	<25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>
Message-ID: <20090924075934.282AC341847C@www.antlr.org>

At 13:05 24/09/2009, Jim Idle wrote:
 >Some platforms define this to be undefined though. Remember 
there
 >are lots if embedded systems that use this. Hence the 
qualification.
 >I think it would have been better to define free(NULL) as safe
 >myself but early Lib C would crash if you did this and I think 
it
 >was C++ that first took a stand?

I haven't looked at the standards recently, but from what I recall 
"delete NULL;" is guaranteed safe but "free(NULL);" wasn't.

I definitely recall seeing some static testers and malloc 
replacements (some for performance, some for allocation debugging) 
that reacted badly to use of "free(NULL);" (sometimes just a 
failed assertion, sometimes worse).


From bergschloss at ukr.net  Thu Sep 24 02:45:19 2009
From: bergschloss at ukr.net (Sergiy Karpenko)
Date: Thu, 24 Sep 2009 12:45:19 +0300
Subject: [antlr-interest] gUnit build error under Windows
In-Reply-To: <mailman.1.1253732401.5366.antlr-interest@antlr.org>
Message-ID: <E1Mqkt5-000Hbl-FC@ffe1.ukr.net>

Hello, colleagues    
    
I found build error when run gUnit test.?    
    
Environment:    
- OS is Windows, it's important, because there is no problem under Linux;    - project has many dependencies;    
- gUnit pom configuration is typical:    
? <plugin>    
? <groupId>org.codehaus.mojo</groupId>    
? <artifactId>exec-maven-plugin</artifactId>    
? <executions>    
? <execution>    
? <id>gunit-CND</id>    
? <phase>generate-test-sources</phase>    
? <goals>    
? <goal>exec</goal>    
? </goals>    
? <configuration>    
? <classpathScope>test</classpathScope>    
? <executable>java</executable>    
? <testSourceRoot>src/test/gunit/org/mycompany</testSourceRoot>    
? <workingDirectory>src/test/gunit/org/mycomany</workingDirectory>    
? <arguments>    
? <argument>-classpath</argument>    
? <classpath/>    
? <argument>org.antlr.gunit.Interp</argument>    
? <argument>-o</argument>    
? <argument>Cnd.gunit</argument>    
? </arguments>    
? </configuration>    
? </execution>    
? </executions>    
? </plugin>    
    
Result is build error:    
    
[INFO] Result of cmd.exe /X /C "java -classpath "realy huge set of jars" org.antlr.gunit.Interp -o Cnd.gunit" execution is: '1'.    
    
- classpath string take more than 9000 characters;    
    
But there is enough just 6 jars and path to generated clases    
?    
Next configuration works well:    
? <plugin>    
? <groupId>org.codehaus.mojo</groupId>    
? <artifactId>exec-maven-plugin</artifactId>    
? <executions>    
? <execution>    
? <id>gunit-CND</id>    
? <phase>generate-test-sources</phase>    
? <goals>    
? <goal>exec</goal>    
? </goals>    
? <configuration>    
? <classpathScope>test</classpathScope>    
? <executable>java</executable>    
? <testSourceRoot>src/test/gunit/org/mycompany</testSourceRoot>    
? <workingDirectory>src/test/gunit/org/mycompany</workingDirectory>    
? <arguments>    
? <argument>-classpath</argument>    
? <!--classpath /-->    
? <argument>F:\mycompany\project\target\classes\;F:\my-dependencies\repository\antlr\antlr\2.7.7\antlr-2.7.7.jar;F:\my-dependencies\repository\org\antlr\stringtemplate\3.2\stringtemplate-3.2.jar;F:\my-dependencies\repository\org\antlr\antlr-runtime\3.1.3\antlr-runtime-3.1.3.jar;F:\my-dependencies\repository\junit\junit\3.8.2\junit-3.8.2.jar;F:\my-dependencies\repository\org\antlr\antlr\3.1.3\antlr-3.1.3.jar;F:\my-dependencies\repository\org\antlr\gunit\3.1.4-SNAPSHOT\gunit-3.1.4-SNAPSHOT.jar</argument>    
? <argument>org.antlr.gunit.Interp</argument>    
? <argument>-o</argument>    
? <argument>Cnd.gunit</argument>    
? </arguments>    
? </configuration>    
? </execution>    
? </executions>    
? </plugin>    
    
But this is not good way, because I set constant pathes to jars and generated classes;    
    
Is there any another way to cut automaticly generated list of jars?    
    
Thanks    
    
    
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090924/db395004/attachment.html 

From micke.hovmoller at gmail.com  Thu Sep 24 05:10:26 2009
From: micke.hovmoller at gmail.com (=?ISO-8859-1?Q?Micke_Hovm=F6ller?=)
Date: Thu, 24 Sep 2009 14:10:26 +0200
Subject: [antlr-interest] Rule coverage testing
In-Reply-To: <4AB79F3E.4080903@temporal-wave.com>
References: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>
	<3CB8EB53-340F-4949-93DF-51AFBE05073F@temporal-wave.com>
	<679a2cc0909181027u4a7c126bs994cccf3dd291f81@mail.gmail.com>
	<18b4fcc20909210821o57544189ide4cd1be30e97d24@mail.gmail.com>
	<4AB79F3E.4080903@temporal-wave.com>
Message-ID: <18b4fcc20909240510y2d36338co4a3c1aa126478617@mail.gmail.com>

On Mon, Sep 21, 2009 at 5:43 PM, Jim Idle <jimi at temporal-wave.com> wrote:

> On 09/21/2009 08:21 AM, Micke Hovm?ller wrote:
> >
> > The coverage report says that my tests cover 2338 of 2966 lines.
> > Unfortunately, I can't find out how to break this down by function.
> Sounds like you need to use a different plugin - the coverage tool for
> netbeans says it is from Netbeans beta. There are quite a number of
> tools but Cobertura seems to be most widely used.
>

I looked at Cobertura. The best reference I found was
http://wiki.netbeans.org/CoberturaAnt, but as that page indicates at the
top, there are a few errors in the description, and I don't know what to do
about them, so I have not got Cobertura up and running, unfortunately. I
find ant files to be quite incomprehensible, in most cases.

Any better pointers for integrating Cobertura with NetBeans will be much
appreciated, but I do realize that we have strayed from ANTLR here, so this
probably isn't the forum for it.

> The parser file is color coded per line, but I can't see the
> > difference between lines counted as whitespace and lines that are not
> > covered but really should be.
>
> No options?
>

Not that I found, but they may be there. As you pointed out, the plugin is
in beta, so maybe not.


> > Also, a large amount of the uncovered lines are exception handling,
> > most of which is automatically generated, and I'm not interested in
> > trying to come up with test cases for that, if that is even possible
> > in every case.
>
> Yes, and no. Exceptions for parsing you want to cover right? People
> forget that a good regression test for a parser is also to test what it
> does with incorrect input - good and expected message vs "Null pointer
> exception at...."
>

In this particular case, I'm parsing poker hand histories, i.e. text files
generated by the poker client. They are correct by definition, so exceptions
only happen when I have problems with my handling of the files.

/Micke
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090924/e45854d6/attachment.html 

From Gordon.Tyler at quest.com  Thu Sep 24 06:20:38 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Thu, 24 Sep 2009 06:20:38 -0700
Subject: [antlr-interest] Question with greedy
In-Reply-To: <20090923233536.2b634fff@frodo.mittelerde>
References: <20090923233536.2b634fff@frodo.mittelerde>
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01C2048884@alvxmbw04.prod.quest.corp>

To exclude the /* and */ would something like this work?

COMMENT
 	:  '/*'! ( options {greedy=false;} : . )* '*/'!
 	;

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andreas Volz
Sent: September 23, 2009 5:36 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Question with greedy

Hello,

I wrote this grammar:

startrule
	: (property comment property)*
	;
comment
	: COMMENT { printf("Comment: \%s\n", $COMMENT.text->chars); }
	;
	
COMMENT
 	:  '/*' ( options {greedy=false;} : . )* '*/'
 	;
	
property
	: TOKEN { printf("Property: \%s\n", $TOKEN.text->chars);}

TOKEN
	: (ALPHA | DIGIT)+

fragment DIGIT  	
	: '0'..'9'
	;
	
fragment ALPHA
	: 'a'..'z' | 'A'..'Z' |'@'|'.'| ' ' 
	;

The input is:

This is a test /* with a comment */ in the middle
This is a test /* with a comment */ in the middle
This is a test /* with a comment */ in the middle

The result looks good, but some errors are print out:

test.txt(1) : lexer error 3 :
	 at offset 49, near char(0XA) :
	
This is a test /* w
test.txt(2) : lexer error 3 :
	 at offset 50, near char(0XA) :
	
This is a test /* w
test.txt(3) : lexer error 3 :
	 at offset 50, near char(0XA) :
	

Property: This is a test 
Comment: /* with a comment */
Property:  in the middle
Property: This is a test 
Comment: /* with a comment */
Property:  in the middle
Property: This is a test 
Comment: /* with a comment */
Property:  in the middle

BTW: The line ending in this file is 0x0A.

Could anyone explain this error and how to prevent it?

Second question: How do I not include the '/*' and '*/' tags in the
comment match?

regards
	Andreas

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From indhu.b at s7software.com  Thu Sep 24 06:32:41 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Thu, 24 Sep 2009 19:02:41 +0530
Subject: [antlr-interest] Question with greedy
In-Reply-To: <1FE9A296676737419A8912A6FD22AE1D01C2048884@alvxmbw04.prod.quest.corp>
References: <20090923233536.2b634fff@frodo.mittelerde>
	<1FE9A296676737419A8912A6FD22AE1D01C2048884@alvxmbw04.prod.quest.corp>
Message-ID: <00e101ca3d1b$7f1d2bf0$7d5783d0$@b@s7software.com>

'!' is a rewrite operator used in tree construction. Since lexer doesn't
construction a tree, I don't think this will work.


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Gordon Tyler
Sent: Thursday, September 24, 2009 6:51 PM
To: Andreas Volz; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Question with greedy

To exclude the /* and */ would something like this work?

COMMENT
 	:  '/*'! ( options {greedy=false;} : . )* '*/'!
 	;

-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Andreas Volz
Sent: September 23, 2009 5:36 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Question with greedy

Hello,

I wrote this grammar:

startrule
	: (property comment property)*
	;
comment
	: COMMENT { printf("Comment: \%s\n", $COMMENT.text->chars); }
	;
	
COMMENT
 	:  '/*' ( options {greedy=false;} : . )* '*/'
 	;
	
property
	: TOKEN { printf("Property: \%s\n", $TOKEN.text->chars);}

TOKEN
	: (ALPHA | DIGIT)+

fragment DIGIT  	
	: '0'..'9'
	;
	
fragment ALPHA
	: 'a'..'z' | 'A'..'Z' |'@'|'.'| ' ' 
	;

The input is:

This is a test /* with a comment */ in the middle
This is a test /* with a comment */ in the middle
This is a test /* with a comment */ in the middle

The result looks good, but some errors are print out:

test.txt(1) : lexer error 3 :
	 at offset 49, near char(0XA) :
	
This is a test /* w
test.txt(2) : lexer error 3 :
	 at offset 50, near char(0XA) :
	
This is a test /* w
test.txt(3) : lexer error 3 :
	 at offset 50, near char(0XA) :
	

Property: This is a test 
Comment: /* with a comment */
Property:  in the middle
Property: This is a test 
Comment: /* with a comment */
Property:  in the middle
Property: This is a test 
Comment: /* with a comment */
Property:  in the middle

BTW: The line ending in this file is 0x0A.

Could anyone explain this error and how to prevent it?

Second question: How do I not include the '/*' and '*/' tags in the
comment match?

regards
	Andreas

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address

List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jojspieg at gmail.com  Thu Sep 24 09:12:52 2009
From: jojspieg at gmail.com (Josh Spiegel)
Date: Thu, 24 Sep 2009 09:12:52 -0700
Subject: [antlr-interest] Lexing XQuery in antlr 3
Message-ID: <711c355a0909240912g43468afey468eb0b30443b257@mail.gmail.com>

Hi,

I am trying to migrate our XQuery lexer from antlr 2 to antlr 3.

The match for a given token depends on the text before or after it.  For
example, in a certain state the string "declare" should be a keyword token
if it is followed by "namespace" and otherwise it should be a QName token.
We successfully handled this in antlr 2 using syntactic predicates.  Eg:

Keywords :
      ('ancestor-or-self' (C|S1)* '::')=> 'ancestor-or-self'
{
        $type = ANCESTOR_OR_SELF_AXIS;
      }
    | ...
    | ('declare' (C|S1)+ 'namespace' Del)=> 'declare' {
        $type = DECLARE;
      }
    |
    ....
    | QName {
         $type = QNAME;
    }
    ;


Note: C and S1 are fragments that match comments and whitespace
respectively.  We also intermix some gated semantic predicates to disable
certain keywords depending on the state of the lexer (a state that we
maintain).  I have omitted that code for brevity.

The rule is pretty long as there are many keywords in XQuery.
Unfortunately, in antlr3 the method specialStateTransition associated with
this Keywords rule exceeds the 64K limit and I get the Java "code too large"
error.  I have looked at composite grammars and searched many of the "code
too large" postings.  Is there a way to break up this kind of rule?

Thanks,
Josh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090924/414afb17/attachment.html 

From jimi at temporal-wave.com  Thu Sep 24 09:38:04 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 24 Sep 2009 09:38:04 -0700
Subject: [antlr-interest] Rule coverage testing
In-Reply-To: <18b4fcc20909240510y2d36338co4a3c1aa126478617@mail.gmail.com>
References: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>	
	<3CB8EB53-340F-4949-93DF-51AFBE05073F@temporal-wave.com>	
	<679a2cc0909181027u4a7c126bs994cccf3dd291f81@mail.gmail.com>	
	<18b4fcc20909210821o57544189ide4cd1be30e97d24@mail.gmail.com>	
	<4AB79F3E.4080903@temporal-wave.com>
	<18b4fcc20909240510y2d36338co4a3c1aa126478617@mail.gmail.com>
Message-ID: <4ABBA06C.8090903@temporal-wave.com>

On 09/24/2009 05:10 AM, Micke Hovm?ller wrote:
> On Mon, Sep 21, 2009 at 5:43 PM, Jim Idle <jimi at temporal-wave.com 
> <mailto:jimi at temporal-wave.com>> wrote:
>
>     On 09/21/2009 08:21 AM, Micke Hovm?ller wrote:
>     >
>     > The coverage report says that my tests cover 2338 of 2966 lines.
>     > Unfortunately, I can't find out how to break this down by function.
>     Sounds like you need to use a different plugin - the coverage tool for
>     netbeans says it is from Netbeans beta. There are quite a number of
>     tools but Cobertura seems to be most widely used.
>
>
> I looked at Cobertura. The best reference I found was 
> http://wiki.netbeans.org/CoberturaAnt, but as that page indicates at 
> the top, there are a few errors in the description, and I don't know 
> what to do about them, so I have not got Cobertura up and running, 
> unfortunately. I find ant files to be quite incomprehensible, in most 
> cases.
>
> Any better pointers for integrating Cobertura with NetBeans will be 
> much appreciated, but I do realize that we have strayed from ANTLR 
> here, so this probably isn't the forum for it.

Just use Maven.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090924/5ae2f9b0/attachment.html 

From jimi at temporal-wave.com  Thu Sep 24 09:38:38 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 24 Sep 2009 09:38:38 -0700
Subject: [antlr-interest] Question with greedy
In-Reply-To: <1FE9A296676737419A8912A6FD22AE1D01C2048884@alvxmbw04.prod.quest.corp>
References: <20090923233536.2b634fff@frodo.mittelerde>
	<1FE9A296676737419A8912A6FD22AE1D01C2048884@alvxmbw04.prod.quest.corp>
Message-ID: <4ABBA08E.80901@temporal-wave.com>

On 09/24/2009 06:20 AM, Gordon Tyler wrote:
> To exclude the /* and */ would something like this work?
>
> COMMENT
>   	:  '/*'! ( options {greedy=false;} : . )* '*/'!
>    

No :-)


From jimi at temporal-wave.com  Thu Sep 24 09:49:59 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 24 Sep 2009 09:49:59 -0700
Subject: [antlr-interest] Lexing XQuery in antlr 3
In-Reply-To: <711c355a0909240912g43468afey468eb0b30443b257@mail.gmail.com>
References: <711c355a0909240912g43468afey468eb0b30443b257@mail.gmail.com>
Message-ID: <4ABBA337.9070402@temporal-wave.com>

On 09/24/2009 09:12 AM, Josh Spiegel wrote:
> Hi,
>
> I am trying to migrate our XQuery lexer from antlr 2 to antlr 3.
>
> The match for a given token depends on the text before or after it.  
> For example, in a certain state the string "declare" should be a 
> keyword token if it is followed by "namespace" and otherwise it should 
> be a QName token.  We successfully handled this in antlr 2 using 
> syntactic predicates.  Eg:
>
> Keywords :
>       ('ancestor-or-self' (C|S1)* '::')=> 'ancestor-or-self' {
>         $type = ANCESTOR_OR_SELF_AXIS;
>       }
>     | ...
>     | ('declare' (C|S1)+ 'namespace' Del)=> 'declare' {
>         $type = DECLARE;
>       }
>     |
>     ....
>     | QName {
>          $type = QNAME;
>     }
>     ;
>
>
> Note: C and S1 are fragments that match comments and whitespace 
> respectively.  We also intermix some gated semantic predicates to 
> disable certain keywords depending on the state of the lexer (a state 
> that we maintain).  I have omitted that code for brevity.
>
> The rule is pretty long as there are many keywords in XQuery.  
> Unfortunately, in antlr3 the method specialStateTransition associated 
> with this Keywords rule exceeds the 64K limit and I get the Java "code 
> too large" error.  I have looked at composite grammars and searched 
> many of the "code too large" postings.  Is there a way to break up 
> this kind of rule?
Move this in to the parser rather than the lexer and create an id rule 
that allows the keywords as Ids.

However, I think that the complexity of your grammar would be greatly 
reduced if you placed the logic in the id rule and checked yourself in a 
hash table/map:

QName: ('a'..'b'|'_')+ { $type = lookup($text); } ;

Then create a map of the keywords and in your lookup, manually look 
through LA() for the indicators that this is a keyword or not.

XQuery is yet another language designed by people that don't understand 
languages I am afraid. Unless there is a real reason this must be done 
in the lexer, then transfer it to the parser and I think you will have 
better luck.

Jim

From dave at tridecap.com  Thu Sep 24 10:11:24 2009
From: dave at tridecap.com (Dave Dutcher)
Date: Thu, 24 Sep 2009 12:11:24 -0500
Subject: [antlr-interest] Question with greedy
In-Reply-To: <4ABBA08E.80901@temporal-wave.com>
References: <20090923233536.2b634fff@frodo.mittelerde><1FE9A296676737419A8912A6FD22AE1D01C2048884@alvxmbw04.prod.quest.corp>
	<4ABBA08E.80901@temporal-wave.com>
Message-ID: <60873F859CF84B53811F09B337469BEA@tridecap.com>

 
Didn't that used to work in Antlr 2?  I think that would be a very useful
feature to have back.


Dave

> -----Original Message-----
> From: antlr-interest-bounces at antlr.org 
> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
> Sent: Thursday, September 24, 2009 11:39 AM
> Cc: antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Question with greedy
> 
> On 09/24/2009 06:20 AM, Gordon Tyler wrote:
> > To exclude the /* and */ would something like this work?
> >
> > COMMENT
> >   	:  '/*'! ( options {greedy=false;} : . )* '*/'!
> >    
> 
> No :-)
> 
> 
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: 
> http://www.antlr.org/mailman/options/antlr-interest/your-email
> -address


From sam.kuper at uclmail.net  Thu Sep 24 10:38:41 2009
From: sam.kuper at uclmail.net (Sam Kuper)
Date: Thu, 24 Sep 2009 18:38:41 +0100
Subject: [antlr-interest] Baffled using Antlr to parse custom markup language
Message-ID: <4126b3450909241038w6cde5f69r1ee3b38e64e866@mail.gmail.com>

Antlr is stumping me. Perhaps it's because I'm trying to use it to
parse a pretty gnarly markup language, but maybe not...

Between the [BEGIN] and [END] markers below is a sample of the markup
I'm dealing with.

[BEGIN]
.Extract field for no. 16 can be added as the last line of an entry,
in the form: *e 16
FOR NO. 17, ADD 17: NO COMMA. E.G. *e 16 17 or *e 17 (DO NOT USE THE
*v FIELD OR THE *d FIELD)


!!!!!!!!!!!REPEAT, NO COMMA!!!!!!!!!!!!!!


*a \\Albert, John\\ (b. 1912/13). Gardener. George Robert Fox's
gardener at The Vicarage, \circa\ 1941. (Census returns 1841 (Public Record
Office HO137/916/8).)
*b expanded by EL
*c
*v 2, 3
*e 18 19
[END]

I'll use regex notation below to help me describe what the above markup means.

Everything up to the first

^\*a

is a note and needs to be translated such that single newlines are
ignored but two or more newlines are translated to a pair of newlines.

Everything from a

^\*a

to a

(^\*[a-z]|\n{2,})

exclusive, is a STAR_A field. Similarly for STAR_B, STAR_C, STAR_V and
STAR_E fields.

How on earth would I achieve this in Antlr?

NB. Ideally, my target language would be Python; failing that, Java.
But at the moment, I'm having trouble even getting close to parsing
this reliably in Antlrworks, so any help would be appreciated.

Many thanks in advance,

Sam

From jimi at temporal-wave.com  Thu Sep 24 10:43:09 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 24 Sep 2009 10:43:09 -0700
Subject: [antlr-interest] Question with greedy
In-Reply-To: <60873F859CF84B53811F09B337469BEA@tridecap.com>
References: <20090923233536.2b634fff@frodo.mittelerde><1FE9A296676737419A8912A6FD22AE1D01C2048884@alvxmbw04.prod.quest.corp>	<4ABBA08E.80901@temporal-wave.com>
	<60873F859CF84B53811F09B337469BEA@tridecap.com>
Message-ID: <4ABBAFAD.6020507@temporal-wave.com>

On 09/24/2009 10:11 AM, Dave Dutcher wrote:
>
> Didn't that used to work in Antlr 2?  I think that would be a very useful
> feature to have back.
>
>    
We have explained this many times in the past but it is to do with the 
performance gains achieved by not associating text with tokens unless 
you really need it and so do so yourself.

You can also do this:

T1 : '/*' r=FRAGRULE '*/'  { setText($r.text); } ;

So in practice it is only a minor inconvenience, for a simpler and 
faster lexer :-)

Jim
> Dave
>
>    
>> -----Original Message-----
>> From: antlr-interest-bounces at antlr.org
>> [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jim Idle
>> Sent: Thursday, September 24, 2009 11:39 AM
>> Cc: antlr-interest at antlr.org
>> Subject: Re: [antlr-interest] Question with greedy
>>
>> On 09/24/2009 06:20 AM, Gordon Tyler wrote:
>>      
>>> To exclude the /* and */ would something like this work?
>>>
>>> COMMENT
>>>    	:  '/*'! ( options {greedy=false;} : . )* '*/'!
>>>
>>>        
>> No :-)
>>
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email
>> -address
>>      
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>    


From sam.kuper at uclmail.net  Thu Sep 24 10:51:48 2009
From: sam.kuper at uclmail.net (Sam Kuper)
Date: Thu, 24 Sep 2009 18:51:48 +0100
Subject: [antlr-interest] Baffled using Antlr to parse custom markup
	language
In-Reply-To: <4126b3450909241038w6cde5f69r1ee3b38e64e866@mail.gmail.com>
References: <4126b3450909241038w6cde5f69r1ee3b38e64e866@mail.gmail.com>
Message-ID: <4126b3450909241051v2f3a48bay3bf4b6d0fadb9c96@mail.gmail.com>

2009/9/24 Sam Kuper <sam.kuper at uclmail.net>:
> *a \\Albert, John\\ (b. 1912/13). Gardener. George Robert Fox's
> gardener at The Vicarage, \circa\ 1941. (Census returns 1841 (Public Record
> Office HO137/916/8).)
> *b expanded by EL
> *c
> *v 2, 3
> *e 18 19
> [END]

I should add that each set of star fields represents an "entry". There
may be more than one entry following the notes, each entry separated
from the next by one or more blank lines.

All best,

Sam

From david-sarah at jacaranda.org  Thu Sep 24 11:04:26 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Thu, 24 Sep 2009 19:04:26 +0100
Subject: [antlr-interest] Updates for release 3.2 of the C Target
In-Reply-To: <25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>
References: <4ABAA42B.9000300@temporal-wave.com>
	<4ABABDF5.9060009@jacaranda.org>
	<25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>
Message-ID: <4ABBB4AA.9020001@jacaranda.org>

Gavin Lambert wrote:
> At 13:05 24/09/2009, Jim Idle wrote:
>>Some platforms define this to be undefined though. Remember there
>>are lots if embedded systems that use this. Hence the qualification.
>>I think it would have been better to define free(NULL) as safe
>>myself but early Lib C would crash if you did this and I think it
>>was C++ that first took a stand?
> 
> I haven't looked at the standards recently, but from what I recall
> "delete NULL;" is guaranteed safe but "free(NULL);" wasn't.

C89 clause 4.10.3.2:

# The free function causes the space pointed to by ptr to be
# deallocated, that is, made available for further allocation.
# If ptr is a null pointer, no action occurs. [...]

(This is the same in C89 and C99; in the latter it is clause 7.20.3.2.)

> I definitely recall seeing some static testers and malloc replacements
> (some for performance, some for allocation debugging) that reacted badly
> to use of "free(NULL);" (sometimes just a failed assertion, sometimes
> worse).

That would be a bug. C89 is 20 years old; there's really no excuse for
writers of testers and malloc replacements not to have read the sections
of it that directly apply to them.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From parrt at cs.usfca.edu  Thu Sep 24 11:11:34 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Thu, 24 Sep 2009 11:11:34 -0700
Subject: [antlr-interest] Rule coverage testing
In-Reply-To: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>
References: <18b4fcc20909180358h204d4097r7655345cb74bf188@mail.gmail.com>
Message-ID: <6C5BFD5E-D113-4A41-9934-6FBB6D419EDD@cs.usfca.edu>

Have you used antlr's  -profile option?
Ter
On Sep 18, 2009, at 3:58 AM, Micke Hovm?ller wrote:

> I've written a reasonably large grammar for handling poker hand  
> histories. I have worked on and off for about a year or so on this.  
> During this time, the file format has changed slightly. I suspect  
> that I now have a bunch of rules in my grammar that are no longer  
> used.
>
> What are best practices for establishing rule coverage test cases?  
> Ideally, I want to have a bunch of infiles, run them through the  
> grammar and have output displaying which rules were never used.  
> Showing frequency of usage would be nice, but it is definitely not  
> needed.
>
> This is developed in NetBeans 6.7.1 with the ANTLR plugin, so  
> anything that runs in that environment is much preferred to any  
> other solution, but I am prepared to switch IDE if that is required.
>
> /Micke
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From jimi at temporal-wave.com  Thu Sep 24 11:17:24 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Thu, 24 Sep 2009 11:17:24 -0700
Subject: [antlr-interest] Updates for release 3.2 of the C Target
In-Reply-To: <4ABBB4AA.9020001@jacaranda.org>
References: <4ABAA42B.9000300@temporal-wave.com>	<4ABABDF5.9060009@jacaranda.org>	<25176421-5B0F-4B8B-B2AE-8B6ECC24B0F2@temporal-wave.com>
	<4ABBB4AA.9020001@jacaranda.org>
Message-ID: <4ABBB7B4.1070007@temporal-wave.com>

On 09/24/2009 11:04 AM, David-Sarah Hopwood wrote:
> Gavin Lambert wrote:
>    
>> At 13:05 24/09/2009, Jim Idle wrote:
>>      
>>> Some platforms define this to be undefined though. Remember there
>>> are lots if embedded systems that use this. Hence the qualification.
>>> I think it would have been better to define free(NULL) as safe
>>> myself but early Lib C would crash if you did this and I think it
>>> was C++ that first took a stand?
>>>        
>> I haven't looked at the standards recently, but from what I recall
>> "delete NULL;" is guaranteed safe but "free(NULL);" wasn't.
>>      
> C89 clause 4.10.3.2:
>
> # The free function causes the space pointed to by ptr to be
> # deallocated, that is, made available for further allocation.
> # If ptr is a null pointer, no action occurs. [...]
>
> (This is the same in C89 and C99; in the latter it is clause 7.20.3.2.)
>    
However, some of us had been C programmers for quite some time before 
'89 and of course the standards don't kick in automagicaly and 
retroactively on the day of their publication - I wish they did!
>> I definitely recall seeing some static testers and malloc replacements
>> (some for performance, some for allocation debugging) that reacted badly
>> to use of "free(NULL);" (sometimes just a failed assertion, sometimes
>> worse).
>>      
> That would be a bug. C89 is 20 years old; there's really no excuse for
> writers of testers and malloc replacements not to have read the sections
> of it that directly apply to them.
>
>    

Yeah - you are correct of  course, but even now I find implementations 
that will segv if you try this, so realistically, as the gate is going 
to cost you nothing at all, then belt and braces always seems like a 
good idea :-) But regardless, one should always set the pointer to NULL 
/after/ ;-) freeing it.

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090924/9d8a7d45/attachment.html 

From lists at brachttal.net  Thu Sep 24 15:19:11 2009
From: lists at brachttal.net (Andreas Volz)
Date: Fri, 25 Sep 2009 00:19:11 +0200
Subject: [antlr-interest] Question with greedy
In-Reply-To: <4ABAA14C.8080109@temporal-wave.com>
References: <20090923233536.2b634fff@frodo.mittelerde>
	<4ABAA14C.8080109@temporal-wave.com>
Message-ID: <20090925001911.3cc571ec@frodo.mittelerde>

Am Wed, 23 Sep 2009 15:29:32 -0700 schrieb Jim Idle:

> > Could anyone explain this error and how to prevent it?
> >    
> 
> Well, you have not specified to the lexer what it should do with
> those chars (I assume that this is C from your code above):
> 
> NL : ('\r' | '\n')+ { $channel=HIDDEN; } ;
> ANY : . { SKIP(); } ; // Always make this the very last lexer rule

Thanks for your answers. I tried it and it works. Now I've the next
problem that I tried to solve with a greedy=false rule, but failed.

Input Data:

key:value
key:value
key:value
key:value
key:value

For key are all chars allowed until the first ':' arrives. For value
all chars are allowed. Also another ':' which should no be handled
special. My example works, but it fails e.g. is value is an URL
(http://...).

Could you help me again?

regards
	Andreas

From sam.kuper at uclmail.net  Thu Sep 24 18:10:28 2009
From: sam.kuper at uclmail.net (Sam Kuper)
Date: Fri, 25 Sep 2009 02:10:28 +0100
Subject: [antlr-interest] Baffled using Antlr to parse custom markup
	language
In-Reply-To: <4126b3450909241051v2f3a48bay3bf4b6d0fadb9c96@mail.gmail.com>
References: <4126b3450909241038w6cde5f69r1ee3b38e64e866@mail.gmail.com>
	<4126b3450909241051v2f3a48bay3bf4b6d0fadb9c96@mail.gmail.com>
Message-ID: <4126b3450909241810t59b40141mc68c4895a95d7965@mail.gmail.com>

Here's my (grossly incomplete, but better than nothing) progress so far:

[BEGIN]
grammar name_reg;
options {
    language=Java;
}

name_reg    : ( options {greedy=false;} : . )* a_field b_field? c_field?
v_field? e_field? EOF;

a_field        : STAR_A '\\\\' name '\\\\ ' dateblock? description '('
sources ')' .* ;
name        : ( options {greedy=false;} : . )* ;
dateblock    : '(' dates '). ';
dates        : 'b. ' NUM NUM NUM NUM '/' NUM NUM;
description    : ~'(' ( options {greedy=false;} : . )* ;
sources        : ( options {greedy=false;} : . )* ;

b_field        : STAR_B .*;

c_field        : STAR_C .*;

v_field        : STAR_V .*;

e_field        : STAR_E .*;

STAR_A        : '*a ';
STAR_B        : '*b ';
STAR_C        : '*c ';
STAR_V        : '*v ';
STAR_E        : '*e ';
PUNCTUATION    : ' '|'.'|','|':'|'!'|'\n'|'('|')'|'-';
ALPHA        : 'a'..'z'|'A'..'Z';
NUM        : '0'..'9';
[END]

This is generating an error:

name_regParser.java:510: exception org.antlr.runtime.RecognitionException is
never thrown in body of corresponding try statement
        catch (RecognitionException re) {
        ^
1 error

I'd be grateful for help troubleshooting this error, so that I can continue
to work on the grammar above.

Many thanks,

Sam
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090925/c86cf449/attachment.html 

From Heiko.Folkerts at david-bs.de  Thu Sep 24 22:56:16 2009
From: Heiko.Folkerts at david-bs.de (Heiko Folkerts)
Date: Fri, 25 Sep 2009 07:56:16 +0200
Subject: [antlr-interest] modifying token creation
Message-ID: <93FCBF72DCE7634481C5DF1654D8FF1303011F34@DC2>

Hi Indhu and David,
OK, maybe indhu is right and modifying the token creation is the wrong way to solve my error handling problems. When I try to retrieve user friendly error messages from wrong input the recognizer state gives me nothing to help me. The backtracking tries all paths and returns a no viable path exception. E.g. this is an excerpt from the grammar:
statement: 
    actionexpression
    | statecheck;
statecheck: stateobject (stateoption  | ) compoperator selectedstate  -> ^(STATECHECK stateobject ^(COMPERATOR compoperator) selectedstate stateoption) |
    stateobject (stateoption  | ) compoperator paramname-> ^(STATECHECK stateobject ^(COMPERATOR compoperator) ^(PARAMREF paramname) stateoption);
actionexpression: actionobject (actionoption | ) action -> ^(ACTIONEXPRESSION actionobject action actionoption);

The stateobject rules etc. use syntactic predicates to check wether the input is a correct keyword - thant engine is an legal object.

Now if I enter the input "engine;" where engine is an object (stateobject and actionobject have the same meaning) I need to tell the user that we expect either an actionexpression or an statecheck instead of the ';'. 

I am coding in C so until ANTLR 3.2 the catch block in the grammar was not supported. 

So how would i deal best in such situations?

Thx
Heiko

-----Urspr?ngliche Nachricht-----
Von: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] Im Auftrag von David-Sarah Hopwood
Gesendet: Donnerstag, 24. September 2009 09:10
An: antlr-interest at antlr.org
Betreff: Re: [antlr-interest] Howto modify token creation?

Indhu Bharathi wrote:
> You can do something like
> 
> ID	: LETTER (LETTER|DIGIT)*
> 	{
> 		String text = getText();
> 		Integer tknType;
> 		if( (tknType=table.get(text))!=null ) {
> 			$type = tknType;
> 		}
> 	}
> 
> The table can be passed to the lexer using some member function. But I 
> don't know any clean way how to make sure ANTLR lexer doesn't assign 
> the same int to some other token.

YourParser.tokenNames.length should be the first unused token number.

(Obviously, this is relying on an implementation detail, but probably a fairly stable one.)

Note that if you use token numbers >= tokenNames.length, you should override getErrorMessage in the parser, so that it doesn't throw an ArrayIndexOutOfBoundsException when constructing an error message involving one of these tokens. For example:

@parser::members {
  public String getErrorMessage(RecognitionException e, String[] names) {
    String[] dynamicNames = /* array also containing dynamic token names */;
    return super.getErrorMessage(e, dynamicNames);
  }
}

--
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From phungmh at it.uts.edu.au  Fri Sep 25 01:16:39 2009
From: phungmh at it.uts.edu.au (Hoang Phung)
Date: Fri, 25 Sep 2009 18:16:39 +1000
Subject: [antlr-interest] Recover grammar file from generated code?
Message-ID: <4ABC7C67.1090401@it.uts.edu.au>

Hi all,

In my project, I inherited the code (Parser and Lexer) generated with 
ANTLR by someone else but I couldn't retrieve the original grammar file 
from him. Can someone tell me if there is a way to recover the grammar 
file from the generated code and embedded comments? Thanks in advance.

Cheers,
Hoang

-- 
Dr. M. Hoang Phung
School of Computing and Communications
Faculty of Engineering and IT, University of Technology, Sydney (UTS)
Room: B10.4.347  Phone: +61 2 9514 4502  Fax: +61 2 9514 4492


From indhu.b at s7software.com  Fri Sep 25 01:20:57 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Fri, 25 Sep 2009 13:50:57 +0530
Subject: [antlr-interest] Recover grammar file from generated code?
In-Reply-To: <4ABC7C67.1090401@it.uts.edu.au>
References: <4ABC7C67.1090401@it.uts.edu.au>
Message-ID: <007c01ca3db9$1b73f9f0$525bedd0$@b@s7software.com>

I don't think if any tool exists to do it automatically. But the generator
adds the grammar also as comments into the generated lexer/parser. You can
manually go through it and recover the grammar.


-----Original Message-----
From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Hoang Phung
Sent: Friday, September 25, 2009 1:47 PM
To: antlr-interest at antlr.org
Subject: [antlr-interest] Recover grammar file from generated code?

Hi all,

In my project, I inherited the code (Parser and Lexer) generated with 
ANTLR by someone else but I couldn't retrieve the original grammar file 
from him. Can someone tell me if there is a way to recover the grammar 
file from the generated code and embedded comments? Thanks in advance.

Cheers,
Hoang

-- 
Dr. M. Hoang Phung
School of Computing and Communications
Faculty of Engineering and IT, University of Technology, Sydney (UTS)
Room: B10.4.347  Phone: +61 2 9514 4502  Fax: +61 2 9514 4492


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe:
http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From sam.kuper at uclmail.net  Fri Sep 25 04:22:48 2009
From: sam.kuper at uclmail.net (Sam Kuper)
Date: Fri, 25 Sep 2009 12:22:48 +0100
Subject: [antlr-interest] Baffled using Antlr to parse custom markup
	language
In-Reply-To: <4126b3450909241038w6cde5f69r1ee3b38e64e866@mail.gmail.com>
References: <4126b3450909241038w6cde5f69r1ee3b38e64e866@mail.gmail.com>
Message-ID: <4126b3450909250422v59e18462q1465fbcc460fec51@mail.gmail.com>

2009/9/24 Sam Kuper <sam.kuper at uclmail.net>:
> Antlr is stumping me. Perhaps it's because I'm trying to use it to
> parse a pretty gnarly markup language, but maybe not...
>
> Between the [BEGIN] and [END] markers below is a sample of the markup
> I'm dealing with.
>
> [BEGIN]
> .Extract field for no. 16 can be added as the last line of an entry,
> in the form: *e 16
> FOR NO. 17, ADD 17: NO COMMA. E.G. *e 16 17 or *e 17 (DO NOT USE THE
> *v FIELD OR THE *d FIELD)
>
>
> !!!!!!!!!!!REPEAT, NO COMMA!!!!!!!!!!!!!!
>
>
> *a \\Albert, John\\ (b. 1912/13). Gardener. George Robert Fox's
> gardener at The Vicarage, \circa\ 1941. (Census returns 1841 (Public Record
> Office HO137/916/8).)
> *b expanded by EL
> *c
> *v 2, 3
> *e 18 19
> [END]
>
> I'll use regex notation below to help me describe what the above markup means.
>
> Everything up to the first
>
> ^\*a
>
> is a note and needs to be translated such that single newlines are
> ignored but two or more newlines are translated to a pair of newlines.

Even this seems to be incredibly difficult with ANTLR. Essentially, I
want to "stop on match" where the match is (in regex notation): ^\*a

But even leaving aside the apparent impossibility of recognising
start-of-line in ANTLR, various approaches I've tried, such as this:

grammar name_reg;
options {
	language=Java;
}
name_reg	: notes? entry* EOF;
notes		: (~'*a')*;
entry		: '*a';
ASCII		: ' '..'~';

fail to stop on encountering '*a' and instead just strip the '*' and
put the rest into 'notes'.

So please could someone help by telling me how can I make ANTLR
capture everything up to a given sequence of characters?

Many thanks,

Sam

From JOHN851 at yandex.ru  Fri Sep 25 04:32:10 2009
From: JOHN851 at yandex.ru (John851)
Date: Fri, 25 Sep 2009 15:32:10 +0400
Subject: [antlr-interest] StringTemplate
Message-ID: <523301253878330@webmail9.yandex.ru>

Hello,

I try to use StringTemplate to write a simple codegen.

Can I use nested ST templates in my .stg file?
Smth. like this:
//---------------------------------------
group ANTLRLangCodGen;

dictdef()::="dict([<element; separator=",">])"

element()::="<cell; separator=",">"

cell(axis,value)::="(<axis; separator=",">),<value>"
//---------------------------------------

Where "element" and "cell" are nested templates.

And other question:
How to load a .stg file and use templates in my tree grammar in ANTLRworks ?
And how to pass plain string argument's value to template? Is it possible only via labels like in the following example?

rule1: $var1=WORLD -> SayHello(word={$var1.text});

Thank you

From bergschloss at ukr.net  Fri Sep 25 06:23:43 2009
From: bergschloss at ukr.net (Sergiy Karpenko)
Date: Fri, 25 Sep 2009 16:23:43 +0300
Subject: [antlr-interest] gUnit build error under Windows (Sergiy
	Karpenko)
In-Reply-To: <mailman.1.1253818802.29409.antlr-interest@antlr.org>
Message-ID: <E1MrAlz-00011p-Vx@ffe15.ukr.net>

Hello    Problem was fixed simply    Just add dependencies in <classpath/>:    ? <classpath>    
? <dependency>org.antlr:gunit</dependency>    
? <dependency>org.antlr:antlr-runtime</dependency>    
? <dependency>org.antlr:stringtemplate</dependency>    
? <dependency>antlr:antlr</dependency>    
? </classpath>    
    
    Thanks          
      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090925/f3c62ea8/attachment.html 

From jimi at temporal-wave.com  Fri Sep 25 08:50:43 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 25 Sep 2009 08:50:43 -0700
Subject: [antlr-interest] modifying token creation
In-Reply-To: <93FCBF72DCE7634481C5DF1654D8FF1303011F34@DC2>
References: <93FCBF72DCE7634481C5DF1654D8FF1303011F34@DC2>
Message-ID: <4ABCE6D3.3070909@temporal-wave.com>

On 09/24/2009 10:56 PM, Heiko Folkerts wrote:
> Hi Indhu and David,
> OK, maybe indhu is right and modifying the token creation is the wrong way to solve my error handling problems. When I try to retrieve user friendly error messages from wrong input the recognizer state gives me nothing to help me. The backtracking tries all paths and returns a no viable path exception. E.g. this is an excerpt from the grammar:
> statement:
>      actionexpression
>      | statecheck;
> statecheck: stateobject (stateoption  | ) compoperator selectedstate  ->  ^(STATECHECK stateobject ^(COMPERATOR compoperator) selectedstate stateoption) |
>      stateobject (stateoption  | ) compoperator paramname->  ^(STATECHECK stateobject ^(COMPERATOR compoperator) ^(PARAMREF paramname) stateoption);
> actionexpression: actionobject (actionoption | ) action ->  ^(ACTIONEXPRESSION actionobject action actionoption);
>
> The stateobject rules etc. use syntactic predicates to check wether the input is a correct keyword - thant engine is an legal object.
>
> Now if I enter the input "engine;" where engine is an object (stateobject and actionobject have the same meaning) I need to tell the user that we expect either an actionexpression or an statecheck instead of the ';'.
>
> I am coding in C so until ANTLR 3.2 the catch block in the grammar was not supported.
>
> So how would i deal best in such situations?
>
> Thx
>    
This is a side effect of using global backtracking. You won;t be able to 
deal with it effectively unless you left factor your grammar and get rid 
of the backtracking. You should think of backtracking as something to 
use when the input is pretty much guaranteed to be correct and the 
language seems too difficult to parse otherwise. I have only found 
VBScript to be such a language myself as it is interpreted and very 
ambiguous without runtime context.

Jim

From jimi at temporal-wave.com  Fri Sep 25 08:53:00 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 25 Sep 2009 08:53:00 -0700
Subject: [antlr-interest] Recover grammar file from generated code?
In-Reply-To: <4ABC7C67.1090401@it.uts.edu.au>
References: <4ABC7C67.1090401@it.uts.edu.au>
Message-ID: <4ABCE75C.5060803@temporal-wave.com>

On 09/25/2009 01:16 AM, Hoang Phung wrote:
> Hi all,
>
> In my project, I inherited the code (Parser and Lexer) generated with
> ANTLR by someone else but I couldn't retrieve the original grammar file
> from him. Can someone tell me if there is a way to recover the grammar
> file from the generated code and embedded comments? Thanks in advance.
>    
The only practical way is to read the code manually and type in the 
grammar again. I suppose you could construct somethign to do this, but 
you would need a full parser for the target langauge and lots of 
inherent knowledge of ANTLR and so on. It is probably quicker to type up 
a new grammar from scratch.

Jim

From david-sarah at jacaranda.org  Fri Sep 25 11:00:40 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Fri, 25 Sep 2009 19:00:40 +0100
Subject: [antlr-interest] Recover grammar file from generated code?
In-Reply-To: <4ABC7C67.1090401@it.uts.edu.au>
References: <4ABC7C67.1090401@it.uts.edu.au>
Message-ID: <4ABD0548.3020902@jacaranda.org>

Hoang Phung wrote:
> Hi all,
> 
> In my project, I inherited the code (Parser and Lexer) generated with 
> ANTLR by someone else but I couldn't retrieve the original grammar file 
> from him. Can someone tell me if there is a way to recover the grammar 
> file from the generated code and embedded comments? Thanks in advance.

The generated code does include all of the information needed, although
it's likely to be quite tedious to recover it manually (and not worth
automating just for one grammar).

Basically, each generated method of the lexer or parser corresponds to
a rule, and each method includes comments that give the original text
of the rule. If there are no actions or predicates, then it is almost
just a matter of deleting everything but the comments, and then cleaning
up the syntax.

If there are actions, you'll need to be able to distinguish them from
generated code. Depending on the formatting of the original grammar
file, you may be able to tell which lines are actions because they have
different indentation.

If there are predicates (shown by "{...}" in the comments), you'll have
to extract the condition from the generated code -- look for 'if'
statements of the form "if ( !( predicate ) ) {
    throw new FailedPredicateException(...);
}".

There also may be code that is included from a @lexer::members or
@parser::members section. That will be just after the list of
"public static final int" token definitions at the start of the class,
possibly also with different indentation.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From parrt at cs.usfca.edu  Fri Sep 25 12:33:32 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 25 Sep 2009 12:33:32 -0700
Subject: [antlr-interest] StringTemplate
In-Reply-To: <523301253878330@webmail9.yandex.ru>
References: <523301253878330@webmail9.yandex.ru>
Message-ID: <36B35FC5-8406-43B2-957A-13307546AC44@cs.usfca.edu>


On Sep 25, 2009, at 4:32 AM, John851 wrote:

> Hello,
>
> I try to use StringTemplate to write a simple codegen.
>
> Can I use nested ST templates in my .stg file?
> Smth. like this:
> //---------------------------------------
> group ANTLRLangCodGen;
>
> dictdef()::="dict([<element; separator=",">])"
>
> element()::="<cell; separator=",">"
>
> cell(axis,value)::="(<axis; separator=",">),<value>"
> //---------------------------------------
>
> Where "element" and "cell" are nested templates.

  when you reference cell, it looks for attribute called cell not a  
template. cell() does that.

> And other question:
> How to load a .stg file and use templates in my tree grammar in  
> ANTLRworks ?

AW 1.3b I think allows you to specify what the test rig looks like;  
otherwise you can't really tell it how to load the template group. do  
remote debugging instead of trying to launch the debugger directly  
from AW.

> And how to pass plain string argument's value to template? Is it  
> possible only via labels like in the following example?
>
> rule1: $var1=WORLD -> SayHello(word={$var1.text});

-> foo(arg={"blah"}
Ter
>
> Thank you
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From parrt at cs.usfca.edu  Fri Sep 25 12:34:10 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Fri, 25 Sep 2009 12:34:10 -0700
Subject: [antlr-interest] Recover grammar file from generated code?
In-Reply-To: <4ABC7C67.1090401@it.uts.edu.au>
References: <4ABC7C67.1090401@it.uts.edu.au>
Message-ID: <C0B09B0F-3A0D-4DAA-92A4-7EC794E8A9E1@cs.usfca.edu>

I believe you could recover the grammar from the comments generated by  
ANTLR.
Ter
On Sep 25, 2009, at 1:16 AM, Hoang Phung wrote:

> Hi all,
>
> In my project, I inherited the code (Parser and Lexer) generated with
> ANTLR by someone else but I couldn't retrieve the original grammar  
> file
> from him. Can someone tell me if there is a way to recover the grammar
> file from the generated code and embedded comments? Thanks in advance.
>
> Cheers,
> Hoang
>
> -- 
> Dr. M. Hoang Phung
> School of Computing and Communications
> Faculty of Engineering and IT, University of Technology, Sydney (UTS)
> Room: B10.4.347  Phone: +61 2 9514 4502  Fax: +61 2 9514 4492
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From sgubler at gmail.com  Fri Sep 25 12:50:53 2009
From: sgubler at gmail.com (Simon Gubler)
Date: Fri, 25 Sep 2009 21:50:53 +0200
Subject: [antlr-interest] Newby Question: Hello world example with
	ANTLRWorks 1.2.3
Message-ID: <359902890909251250p838d8bdie374e173d3f7ec91@mail.gmail.com>

Hi all

The following grammar compiles with ANTLRWorks 1.2.3 but when I debug it
with "1+2+3" it generates a Parse Tree with the following elements:
root->statement->MissingTokenException.

In the file SimplePlusGrammar.g:
grammar SimplePlusGrammar;
statement : INTEGER (PLUS INTEGER)*;
PLUS    : '+';
DIGIT   : ('0'..'9');
INTEGER : DIGIT+;


   - Can you explain what is missing in the grammar to generate a valid
   Parse Tree out of "1+2+3"
   - In many examples so far I have seen Java Code inside the *.g file. Is
   it possible to have only the grammar definition in the *.g file so that it
   can be used by different programming languages

I'm posting my questions here because I haven't found a forum or something
similar where I can put them.

Kind regards

Simon Gubler
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090925/4c9768a9/attachment.html 

From martijn.reuvers at gmail.com  Fri Sep 25 13:01:11 2009
From: martijn.reuvers at gmail.com (Martijn Reuvers)
Date: Fri, 25 Sep 2009 22:01:11 +0200
Subject: [antlr-interest] Newby Question: Hello world example with
	ANTLRWorks 1.2.3
In-Reply-To: <359902890909251250p838d8bdie374e173d3f7ec91@mail.gmail.com>
References: <359902890909251250p838d8bdie374e173d3f7ec91@mail.gmail.com>
Message-ID: <c376e6ec0909251301i4d479908i8fcbc71faaa1ece9@mail.gmail.com>

Hello Simon,

Nothing is missing, it's just a bit too much. I am not entirely sure
but I think you cannot use TOKEN+ in another token. Maybe someone else
can explain this better? For example this will work:

statement
	:	 DIGIT (PLUS DIGIT)*;

DIGIT   : '0'..'9'+;

PLUS    : '+';

Yeah you're free to choose what to do (to use inline actions) or do
your stuff separately (e.g. using a treewalker). StringTemplate might
be useful if you need code generation for example.

Martijn


On Fri, Sep 25, 2009 at 9:50 PM, Simon Gubler <sgubler at gmail.com> wrote:
> Hi all
>
> The following grammar compiles with ANTLRWorks 1.2.3 but when I debug it
> with "1+2+3" it generates a Parse Tree with the following elements:
> root->statement->MissingTokenException.
>
> In the file SimplePlusGrammar.g:
> grammar SimplePlusGrammar;
> statement : INTEGER (PLUS INTEGER)*;
> PLUS??? : '+';
> DIGIT?? : ('0'..'9');
> INTEGER : DIGIT+;
>
> Can you explain what is missing in the grammar to generate a valid Parse
> Tree out of "1+2+3"
> In many examples so far I have seen Java Code inside the *.g file. Is it
> possible to have only the grammar definition in the *.g file so that it can
> be used by different programming languages
>
> I'm posting my questions here because I haven't found a forum or something
> similar where I can put them.
>
> Kind regards
>
> Simon Gubler
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From jimi at temporal-wave.com  Fri Sep 25 13:19:26 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Fri, 25 Sep 2009 13:19:26 -0700
Subject: [antlr-interest] Newby Question: Hello world example
 with	ANTLRWorks 1.2.3
In-Reply-To: <359902890909251250p838d8bdie374e173d3f7ec91@mail.gmail.com>
References: <359902890909251250p838d8bdie374e173d3f7ec91@mail.gmail.com>
Message-ID: <4ABD25CE.5060104@temporal-wave.com>

On 09/25/2009 12:50 PM, Simon Gubler wrote:
> Hi all
>
> The following grammar compiles with ANTLRWorks 1.2.3 but when I debug 
> it with "1+2+3" it generates a Parse Tree with the following elements: 
> root->statement->MissingTokenException.
>
> In the file SimplePlusGrammar.g:
> grammar SimplePlusGrammar;
> statement : INTEGER (PLUS INTEGER)*;
> PLUS    : '+';
fragment DIGIT   : ('0'..'9');
> INTEGER : DIGIT+;
>

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090925/e0e5330b/attachment.html 

From pskswathy at gmail.com  Fri Sep 25 13:39:39 2009
From: pskswathy at gmail.com (swathy murthy)
Date: Sat, 26 Sep 2009 02:09:39 +0530
Subject: [antlr-interest] Passing values from one rule to another
Message-ID: <fa7ae3a10909251339o7fc95e64x5aabdbc5c8339da7@mail.gmail.com>

Hi

I am creating a translator from one language to another. My tree
grammar is as follows:

specification_root : ^(DECLARATION specification);
specification : ^(INPUT_VARIABLES expr)
expr : ^((',' | ('&'?) | ('|'?)) expr*) | exp;
exp :  ^(('+' | '-' | '>' | '<' | '>=' | '<=' | '=' | '!=') exp*) | term;
term : ^(('*' | '/') term*) | LITERAL;

I want to pass the value of LITERAL to expr so that the output of the
rewrite would be like:
(INPUT_VARIABLES (+ X Y)) -> (INPUT_VARIABLES X Y)

Can anyone please tell me how to solve this problem. Thanks in advance
for the help.

Swathy

From pskswathy at gmail.com  Fri Sep 25 13:54:53 2009
From: pskswathy at gmail.com (swathy murthy)
Date: Sat, 26 Sep 2009 02:24:53 +0530
Subject: [antlr-interest]  Passing values from one rule to another
In-Reply-To: <fa7ae3a10909251339o7fc95e64x5aabdbc5c8339da7@mail.gmail.com>
References: <fa7ae3a10909251339o7fc95e64x5aabdbc5c8339da7@mail.gmail.com>
Message-ID: <fa7ae3a10909251354q654420d3s8e4e4fbfcbde0e16@mail.gmail.com>

Hi

I am creating a translator from one language to another. My tree
grammar is as follows:

specification_root : ^(DECLARATION specification);
specification : ^(INPUT_VARIABLES expr)
expr : ^((',' | ('&'?) | ('|'?)) expr*) | exp;
exp : ?^(('+' | '-' | '>' | '<' | '>=' | '<=' | '=' | '!=') exp*) | term;
term : ^(('*' | '/') term*) | LITERAL;

I want to pass the value of LITERAL to expr so that the output of the
rewrite would be like:
(INPUT_VARIABLES (+ X Y)) -> (INPUT_VARIABLES X Y)

Can anyone please tell me how to solve this problem. Thanks in advance
for the help.

Swathy

From lists at brachttal.net  Fri Sep 25 14:48:42 2009
From: lists at brachttal.net (Andreas Volz)
Date: Fri, 25 Sep 2009 23:48:42 +0200
Subject: [antlr-interest] Again VCard Parser
Message-ID: <20090925234842.4f034a7e@frodo.mittelerde>

Hello,

I still work on my VCard Parser. This is the input data:

BEGIN:VCARD
VERSION:3.0
N:Mustermann;Max
FN:Max Mustermann
ORG:Wikipedia
URL:http://de.wikipedia.org/
EMAIL;TYPE=INTERNET:max.mustermann at example.org
TEL;TYPE=voice,work,pref:+49 1234 56788
ADR;TYPE=intl,work,postal,parcel:;;Musterstra?e 1;Musterstadt;;12345;Germany
END:VCARD

This is my grammar:

vcard
	: 'BEGIN:VCARD' vcardcontent 'END:VCARD' ANY?
	;

vcardcontent
	: (property* attribute)*
	;
	
property
	: TOKEN { printf("Property: \%s\n", $TOKEN.text->chars);}
	;
	
attribute
	: ATTRIBUTE { printf("Attribute: \%s\n", $ATTRIBUTE.text->chars); }
	;
	
TOKEN
	: (ALPHA | DIGIT)+
	;

ATTRIBUTE
	: ':' ( options {greedy=false;} : . )* NEWLINE
	;

fragment DIGIT  	
	: '0'..'9'
	;
	
fragment ALPHA
	: 'a'..'z' | 'A'..'Z' |'@'|'.'| ' ' | '='| ','
	;

fragment NEWLINE
	: '\r' '\n'? | '\n' //{ $channel = HIDDEN; }
	;
// Always make this the very last lexer rule
ANY	
	: . { SKIP(); }
	;

This is the output;

Property: VERSION
Attribute: :3.0

Property: N
Attribute: :Mustermann;Max

Property: FN
Attribute: :Max Mustermann

Property: ORG
Attribute: :Wikipedia

Property: URL
Attribute: :http://de.wikipedia.org/

Property: EMAIL
Property: TYPE=INTERNET
Attribute: :max.mustermann at example.org

Property: TEL
Property: TYPE=voice,work,pref
Attribute: :+49 1234 56788

Property: ADR
Property: TYPE=intl,work,postal,parcel
Attribute: :;;Musterstra?e 1;Musterstadt;;12345;Germany


This is yet really good. But I like to split also the Attribute with ';'

All what I've tried leads to errors while parsing. Is it maybe possible to 
take the return of the greedy=false ATTRIBUTE and split it again with another
parser?

Any ideas to get this done?

regards
	Andreas

From boylan.mark at gmail.com  Fri Sep 25 20:27:17 2009
From: boylan.mark at gmail.com (Mark Boylan)
Date: Fri, 25 Sep 2009 23:27:17 -0400
Subject: [antlr-interest] Time-out waiting to connect to the remote parser
Message-ID: <f4426c3f0909252027v424431f9qaf51b8aa3b59eea6@mail.gmail.com>

I've been struggling with a grammar problem for about three day, but
now I'm really stuck. The AntlrWorks debugger has completely stopped
working for me.

I tried swapping ports, but it didn't help. I figured that maybe
something in my amateur grammar was causing it to get hung up and
leave the port open. So I rebooted and copied a short example from
"The Definitive Antlr Reference" into a fresh file. Same thing:
"Time-out waiting to connect to the remote parser."

I shut down AntlrWorks, did a netstat -ano and killed the offending
process. I did a netstat -ano again and the port was clear. I
restarted AntlrWorks -- the port was still clear. I hit debug on the
sample grammar and got the same error.

I've been rebooting and killing processes for an hour or two now, and
I can't see a solution. Does anyone know how to solve this?

Here's the grammar I'm using to try to fix this:

r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
ID: 'a'..'z' + ;
WS: (' ' |'\n' |'\r' )+ {$channel=HIDDEN;} ; // ignore whitespace

Thanks.

From thierry.uso at wanadoo.fr  Sat Sep 26 06:51:46 2009
From: thierry.uso at wanadoo.fr (Thierry USO)
Date: Sat, 26 Sep 2009 15:51:46 +0200
Subject: [antlr-interest] how to get the value of an identifier
Message-ID: <20090926135047.523FD80000A1@mwinf2e02.orange.fr>

Hello,

I am trying to write a grammar for the procedural language of a dead L4G (Rally). The goal is to translate some L4G procedures into a modern programming language, using the lexer/parser generated by antlr.

I am confronted with the following problem:

--- Extract of the grammar ---

heading
: PROCEDURE (SPACE)* procedure_name (SPACE)* parameter_declaration ';'
;

procedure_name
: IDENTIFIER
;

IDENTIFIER
: LETTER (LETTER|_|DIGIT)+
;

-----

How can I get the value of procedure_name and print it (screen or file) ? Adding {System.out.print($IDENTIFIER.text);} in the procedure_name rule does not work.

Thanks for your help.




From antlr at mirality.co.nz  Sat Sep 26 14:38:54 2009
From: antlr at mirality.co.nz (Gavin Lambert)
Date: Sun, 27 Sep 2009 10:38:54 +1300
Subject: [antlr-interest] how to get the value of an identifier
In-Reply-To: <20090926135047.523FD80000A1@mwinf2e02.orange.fr>
References: <20090926135047.523FD80000A1@mwinf2e02.orange.fr>
Message-ID: <20090926213925.2CA19341840D@www.antlr.org>

At 03:51 27/09/2009, Thierry USO wrote:
 >procedure_name
 >: IDENTIFIER
 >;
 >
 >IDENTIFIER
 >: LETTER (LETTER|_|DIGIT)+
 >;
 >
 >-----
 >
 >How can I get the value of procedure_name and print it (screen 
or
 >file) ? Adding {System.out.print($IDENTIFIER.text);} in the
 >procedure_name rule does not work.

Define "does not work".

Also, it's difficult to try to solve problems (especially vague 
ones) without a complete grammar.  Please either make your full 
grammar available or post a minimal but complete grammar that 
reproduces the problem.


From parrt at cs.usfca.edu  Sat Sep 26 16:31:02 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sat, 26 Sep 2009 16:31:02 -0700
Subject: [antlr-interest] Time-out waiting to connect to the remote
	parser
In-Reply-To: <f4426c3f0909252027v424431f9qaf51b8aa3b59eea6@mail.gmail.com>
References: <f4426c3f0909252027v424431f9qaf51b8aa3b59eea6@mail.gmail.com>
Message-ID: <D5C660D1-D48D-43DB-9693-1FEC312D9A8F@cs.usfca.edu>

make sure the port numbers are correct.  what version of AW?
Ter
On Sep 25, 2009, at 8:27 PM, Mark Boylan wrote:

> I've been struggling with a grammar problem for about three day, but
> now I'm really stuck. The AntlrWorks debugger has completely stopped
> working for me.
>
> I tried swapping ports, but it didn't help. I figured that maybe
> something in my amateur grammar was causing it to get hung up and
> leave the port open. So I rebooted and copied a short example from
> "The Definitive Antlr Reference" into a fresh file. Same thing:
> "Time-out waiting to connect to the remote parser."
>
> I shut down AntlrWorks, did a netstat -ano and killed the offending
> process. I did a netstat -ano again and the port was clear. I
> restarted AntlrWorks -- the port was still clear. I hit debug on the
> sample grammar and got the same error.
>
> I've been rebooting and killing processes for an hour or two now, and
> I can't see a solution. Does anyone know how to solve this?
>
> Here's the grammar I'm using to try to fix this:
>
> r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
> ID: 'a'..'z' + ;
> WS: (' ' |'\n' |'\r' )+ {$channel=HIDDEN;} ; // ignore whitespace
>
> Thanks.
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From antlr-list at arizona-software.ch  Sat Sep 26 16:44:04 2009
From: antlr-list at arizona-software.ch (Jean Bovet)
Date: Sat, 26 Sep 2009 16:44:04 -0700
Subject: [antlr-interest] ANTLRWorks 1.3 released
Message-ID: <805E5E4E-E2DB-4B14-970A-E1D759E88950@arizona-software.ch>

Hi,

ANTLRWorks 1.3 is now available. It includes ANTLR 3.2 and  
StringTemplate 3.2.1. It can be downloaded from here:
http://www.antlr.org/works/index.html

The changes are:

New Features:
     [AW-235] - New Grammar Wizard
     [AW-236] - StringTemplate editor
     [AW-237] - Custom test rig
     [AW-238] - Run input on a grammar

Bug fix:
     [AW-223] - NullPointerException when closing ANTLRWorks
     [AW-230] - cast exception with left recursive grammar
     [AW-244] - syntax error causes AW to crash
     [AW-228] - Generated classes are not placed into directories  
according to package declarations

Regards,

Jean


From coderplay at gmail.com  Sat Sep 26 22:14:53 2009
From: coderplay at gmail.com (Min Zhou)
Date: Sun, 27 Sep 2009 13:14:53 +0800
Subject: [antlr-interest] sql keyword issue
Message-ID: <bcaf338a0909262214k774c0a2bg6b329fca999954c2@mail.gmail.com>

Hi all,
I am a newbie, using antlr to parse sql language.  we have a statement
CREATE USER, where USER is not a keyword, so that
CREATE TABLE TBL(USER int) is acceptable. But my parser came across a
problem:
mydb> create table tbl(user int);
FAILED: Parse Error: line 1:17 mismatched input 'user' expecting Identifier
in column specification

here is grammar snippets

createUserStatement
@init { msgs.push("create user statement"); }
@after { msgs.pop(); }
    : KW_CREATE USER userItem (COMMA userItem)*
    -> ^(TOK_CREATEUSER userItem+)
    ;

userItem
@init { msgs.push("user item"); }
@after { msgs.pop(); }
    : (Identifier (KW_IDENTIFIED KW_BY StringLiteral)?)
    -> ^(TOK_USER Identifier StringLiteral?)
    ;


USER: 'USER'

Identifier
    :
    (Letter | Digit) (Letter | Digit | '_')*
    | '`' RegexComponent+ '`'
    ;

anyone help me on this?
Thanks in advance!


Min
-- 
My research interests are distributed systems, parallel computing and
bytecode based virtual machine.

My profile:
http://www.linkedin.com/in/coderplay
My blog:
http://coderplay.javaeye.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090927/a434f920/attachment.html 

From pskswathy at gmail.com  Sat Sep 26 22:34:39 2009
From: pskswathy at gmail.com (swathy murthy)
Date: Sun, 27 Sep 2009 11:04:39 +0530
Subject: [antlr-interest]  language conversion
Message-ID: <fa7ae3a10909262234yffc0e0cw9785d007aefa9e1f@mail.gmail.com>

Hi

I am trying to convert from one language to another using tree
grammar. I have built a parser and am in the process of writing a tree
grammar. I am facing problem in accessing the variable name. My tree
grammar is as follows:

specification_root : ^(SPECIFICATION specification) ->
^(INPUT_VARIABLES specification);
specification : ^('=' KEYWORD_f expr);
expr : ^((',' | ('&'?) | ('|'?)) expr*) | exp;
exp :  ^(('+' | '-' | '>' | '<' | '>=' | '<=' | '=' | '!=') exp*) | term;
term : ^(('*' | '/') term*) | LITERAL;

I want to access the name of the LITERAL which appears in the parser
AST in place of expr in specification rule. So that the rewrite would
be looking like:
('=' f (+ x y)) -> (x y)
I just want to retain the name of the variables in the rule. Can
anyone please tell me how to go about it.

Thanks
Swathy

From gwlist at grahamwideman.com  Sun Sep 27 00:57:03 2009
From: gwlist at grahamwideman.com (Graham Wideman)
Date: Sun, 27 Sep 2009 00:57:03 -0700
Subject: [antlr-interest] sql keyword issue
In-Reply-To: <bcaf338a0909262214k774c0a2bg6b329fca999954c2@mail.gmail.co
 m>
Message-ID: <4.1.20090927005623.0589f768@grahamwideman.com>

Hi Min,

I'm a little puzzled at your example, but I'll take a crack at it.

1. "we have a statement CREATE USER, where USER is not a keyword,"

... except that you have made a separate USER token. So likely the error results from this: where the parser is looking for an Identifier in rule userItem, instead the next token returned by the lexer is a USER token.

There are solutions to the problem of keyword-as-identifier here:

http://www.antlr.org/wiki/pages/viewpage.action?pageId=1741

2. That said, I'm not clear on how uppercase 'USER' is matching your input which includes lower case 'user'.  Perhaps you are using some case-insensitive strategy here (not shown)?

-- Graham 


At 9/27/2009 01:14 PM, Min Zhou wrote: 
Hi all, 
I am a newbie, using antlr to parse sql language.  we have a statement CREATE USER, where USER is not a keyword, so that 
CREATE TABLE TBL(USER int) is acceptable. But my parser came across a problem:
mydb> create table tbl(user int);
FAILED: Parse Error: line 1:17 mismatched input 'user' expecting Identifier in column specification

here is grammar snippets

createUserStatement
@init { msgs.push("create user statement"); }
@after { msgs.pop(); }
    : KW_CREATE USER userItem (COMMA userItem)*
    -> ^(TOK_CREATEUSER userItem+)
    ;

userItem
@init { msgs.push("user item"); }
@after { msgs.pop(); }
    : (Identifier (KW_IDENTIFIED KW_BY StringLiteral)?) 
    -> ^(TOK_USER Identifier StringLiteral?)
    ;


USER: 'USER'

Identifier
    :
    (Letter | Digit) (Letter | Digit | '_')*
    | '`' RegexComponent+ '`'
    ;  

anyone help me on this?
Thanks in advance!


From yurushkin at rambler.ru  Sun Sep 27 07:22:15 2009
From: yurushkin at rambler.ru (=?koi8-r?B?4NLV28vJziDtycjBycw=?=)
Date: Sun, 27 Sep 2009 18:22:15 +0400
Subject: [antlr-interest] [c target] some questions about errors catching
Message-ID: <op.u0w57dret3jqlu@win-mupvrp0jyrf>

good day.
I have some questions about an errors-processing alogirthm in Antlr:

1) Antlr generates strange code. If no alternatives are right, it does the  
following:

	    ...
             default:
                 CONSTRUCTEX();
                 EXCEPTION->type         = ANTLR3_NO_VIABLE_ALT_EXCEPTION;
                 EXCEPTION->message      = (void *)"";
                 EXCEPTION->decisionNum  = 34;
                 EXCEPTION->state        = 0;


                 goto ruleattr_specEx;
             }


- initializes exception... and CLEANS some information. Why?

2) after the finishing of processing nonterminal
rec->state->errors_count = 0 Why?? It has detected an error already.

-- 
Best regards,
Michael

From boylan.mark at gmail.com  Sun Sep 27 07:44:43 2009
From: boylan.mark at gmail.com (Mark Boylan)
Date: Sun, 27 Sep 2009 10:44:43 -0400
Subject: [antlr-interest] Time-out waiting to connect to the remote
	parser
In-Reply-To: <D5C660D1-D48D-43DB-9693-1FEC312D9A8F@cs.usfca.edu>
References: <f4426c3f0909252027v424431f9qaf51b8aa3b59eea6@mail.gmail.com>
	<D5C660D1-D48D-43DB-9693-1FEC312D9A8F@cs.usfca.edu>
Message-ID: <f4426c3f0909270744l740d0c84n1a968114e8cd48b@mail.gmail.com>

Hi Ter!

I'm using the latest automatic install of the IntelliJ IDEA plugin.

At first, I tried changing the ports. After a few attempts, I set it
back to 49100 and just concentrated on trying to get it to work by
killing the process that was holding that port open each time. So, I'm
99% sure that I didn't have them mixed up.

I just started using the interpreter instead. But, few hours later, I
discovered that the debugger was working again, and it's been fine
ever since.



On Sat, Sep 26, 2009 at 7:31 PM, Terence Parr <parrt at cs.usfca.edu> wrote:
> make sure the port numbers are correct. ?what version of AW?
> Ter
> On Sep 25, 2009, at 8:27 PM, Mark Boylan wrote:
>
>> I've been struggling with a grammar problem for about three day, but
>> now I'm really stuck. The AntlrWorks debugger has completely stopped
>> working for me.
>>
>> I tried swapping ports, but it didn't help. I figured that maybe
>> something in my amateur grammar was causing it to get hung up and
>> leave the port open. So I rebooted and copied a short example from
>> "The Definitive Antlr Reference" into a fresh file. Same thing:
>> "Time-out waiting to connect to the remote parser."
>>
>> I shut down AntlrWorks, did a netstat -ano and killed the offending
>> process. I did a netstat -ano again and the port was clear. I
>> restarted AntlrWorks -- the port was still clear. I hit debug on the
>> sample grammar and got the same error.
>>
>> I've been rebooting and killing processes for an hour or two now, and
>> I can't see a solution. Does anyone know how to solve this?
>>
>> Here's the grammar I'm using to try to fix this:
>>
>> r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
>> ID: 'a'..'z' + ;
>> WS: (' ' |'\n' |'\r' )+ {$channel=HIDDEN;} ; // ignore whitespace
>>
>> Thanks.
>>
>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>> Unsubscribe:
>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

From jimi at temporal-wave.com  Sun Sep 27 10:41:20 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Sun, 27 Sep 2009 10:41:20 -0700
Subject: [antlr-interest] [c target] some questions about errors catching
In-Reply-To: <op.u0w57dret3jqlu@win-mupvrp0jyrf>
References: <op.u0w57dret3jqlu@win-mupvrp0jyrf>
Message-ID: <4ABFA3C0.9090600@temporal-wave.com>

On 09/27/2009 07:22 AM, ??????? ?????? wrote:
> good day.
> I have some questions about an errors-processing alogirthm in Antlr:
>
> 1) Antlr generates strange code. If no alternatives are right, it does the
> following:
>
> 	    ...
>               default:
>                   CONSTRUCTEX();
>                   EXCEPTION->type         = ANTLR3_NO_VIABLE_ALT_EXCEPTION;
>                   EXCEPTION->message      = (void *)"";
>                   EXCEPTION->decisionNum  = 34;
>                   EXCEPTION->state        = 0;
>
>
>                   goto ruleattr_specEx;
>               }
>
>
> - initializes exception... and CLEANS some information. Why?
>    

Error recovery. Read the docs for the exception handling and error 
recovery logic if you want to know more, but for error reporting and so 
on, you don't really need to know much - just use the pre-supplied error 
message display routine as a guide - I tried to make it access 
everything that one woudl need so you can see what to do. See 
displayRecognitionError.

In release 3.2.1 I am going to fold that code into an internal function 
to reduce the line count of the output code and possibly the object code 
size.

> 2) after the finishing of processing nonterminal
> rec->state->errors_count = 0 Why?? It has detected an error already.
>
>    
I presume you mean errorCount? Is this from the lexer? I fixed a bug 
whereby the lexer would not count errors - fixed in release 3.2. 
However, lexers should really be written so they don't throw recognition 
errors, but detect anomalies and report them more directly (such as 
missing terminating quotes and illegal characters. FInally don;t use 
intenrals directly, use the api calls: getNumberOfSyntaxErrors

Jim






From paul.m.ramirez at jpl.nasa.gov  Sun Sep 27 11:48:03 2009
From: paul.m.ramirez at jpl.nasa.gov (Ramirez, Paul M (388J))
Date: Sun, 27 Sep 2009 11:48:03 -0700
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
Message-ID: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>

Hi All,

I'm having an issue when generating java sources in Maven versus with AntlrWorks. AntlrWorks seems to generate a perfectly fine size parser and lexer but in Maven the source code gets bloated to the point that it won't compile. We are using a helper plugin to compile other source files with the generated sources. Below is the applicable portions of the pom file. I'm hoping it's just a configuration I can change. If there is anything else I could provide to help resolve this issue please let me know.

                        <plugin>
                                <groupId>org.codehaus.mojo</groupId>
                                <artifactId>build-helper-maven-plugin</artifactId>
                                <version>1.0</version>
                                <executions>
                                        <execution>
                                                <id>add-source</id>
                                                <phase>generate-sources</phase>
                                                <goals>
                                                        <goal>add-source</goal>
                                                </goals>
                                                <configuration>
                                                        <sources>
                                                                <source>target/generated-sources/antlr3</source>
                                                        </sources>
                                                </configuration>
                                        </execution>
                                </executions>
                        </plugin>

                        <plugin>
                                <groupId>org.antlr</groupId>
                                <artifactId>antlr3-maven-plugin</artifactId>
                                <version>3.1.3-1</version>

                                <executions>
                                        <execution>
                                                <phase>generate-sources</phase>
                                                <goals>
                                                        <goal>antlr</goal>
                                                </goals>
                                        </execution>
                                </executions>

                        </plugin>

                <dependency>
                        <groupId>org.antlr</groupId>
                        <artifactId>antlr-runtime</artifactId>
                        <version>3.1.3</version>
                </dependency>
                <dependency>
                        <groupId>org.antlr</groupId>
                        <artifactId>stringtemplate</artifactId>
                        <version>3.2</version>
                </dependency>



Thanks,
Paul Ramirez
Senior Computer Scientist
Jet Propulsion Laboratory
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090927/69a19e15/attachment.html 

From paul.m.ramirez at jpl.nasa.gov  Sun Sep 27 13:05:02 2009
From: paul.m.ramirez at jpl.nasa.gov (Ramirez, Paul M (388J))
Date: Sun, 27 Sep 2009 13:05:02 -0700
Subject: [antlr-interest] Maven Plugin Configuration
Message-ID: <C6E5137E.98DF%Paul.M.Ramirez@jpl.nasa.gov>

Hi All,

I noticed that if I wanted to configure the plugin the website description http://antlr.org/antlr3-maven-plugin/usage.html seemed to have the configuration tag in the wrong place.  I'm not sure if this is universally true for everyone but if I configuration tag in the other place the plugin would not work.

Here is what is on the site:

<plugin>
    <groupId>org.antlr</groupId>
    <artifactId>antlr3-maven-plugin</artifactId>
    <version>3.1.3-1</version>

    <executions>

        <execution>
            <configuration>
                <goals>
                    <goal>antlr</goal>
                </goals>
                <conversionTimeout>10000</conversionTimeout>
                <debug>false</debug>
                <dfa>false</dfa>
                <nfa>false</nfa>
                <excludes><exclude/></excludes>
                <includes><include/></includes>
                <libDirectory>src/main/antlr3/imports</libDirectory>
                <messageFormat>antlr</messageFormat>
                <outputDirectory>target/generated-sources/antlr3</outputDirectory>
                <printGrammar>false</printGrammar>
                <profile>false</profile>
                <report>false</report>
                <sourceDirectory>src/main/antlr3</sourceDirectory>
                <trace>false</trace>
                <verbose>true</verbose>
            </configuration>
        </execution>
    </executions>

</plugin>

Here is what I found actually worked for configuration:

<plugin>
    <groupId>org.antlr</groupId>
    <artifactId>antlr3-maven-plugin</artifactId>
    <version>3.1.3-1</version>

    <executions>
        <execution>
            <goals>
                <goal>antlr</goal>
             </goals>
            <configuration>                     <!--- CONFIGURATION TAG AFTER GOAL -->
                <conversionTimeout>10000</conversionTimeout>
                <debug>false</debug>
                <dfa>false</dfa>
                <nfa>false</nfa>
                <excludes><exclude/></excludes>
                <includes><include/></includes>
                <libDirectory>src/main/antlr3/imports</libDirectory>
                <messageFormat>antlr</messageFormat>
                <outputDirectory>target/generated-sources/antlr3</outputDirectory>
                <printGrammar>false</printGrammar>
                <profile>false</profile>
                <report>false</report>
                <sourceDirectory>src/main/antlr3</sourceDirectory>
                <trace>false</trace>
                <verbose>true</verbose>
            </configuration>
        </execution>
    </executions>

</plugin>

Thanks,
Paul Ramirez
Senior Computer Scientist
Jet Propulsion Laboratory
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090927/4679f3ef/attachment.html 

From parrt at cs.usfca.edu  Sun Sep 27 14:34:53 2009
From: parrt at cs.usfca.edu (Terence Parr)
Date: Sun, 27 Sep 2009 14:34:53 -0700
Subject: [antlr-interest] Time-out waiting to connect to the remote
	parser
In-Reply-To: <f4426c3f0909270744l740d0c84n1a968114e8cd48b@mail.gmail.com>
References: <f4426c3f0909252027v424431f9qaf51b8aa3b59eea6@mail.gmail.com>
	<D5C660D1-D48D-43DB-9693-1FEC312D9A8F@cs.usfca.edu>
	<f4426c3f0909270744l740d0c84n1a968114e8cd48b@mail.gmail.com>
Message-ID: <44266DC8-5631-453F-B0B9-4B8CA91BB64A@cs.usfca.edu>

weird. yeah, could've been some old preference or something.
Ter
On Sep 27, 2009, at 7:44 AM, Mark Boylan wrote:

> Hi Ter!
>
> I'm using the latest automatic install of the IntelliJ IDEA plugin.
>
> At first, I tried changing the ports. After a few attempts, I set it
> back to 49100 and just concentrated on trying to get it to work by
> killing the process that was holding that port open each time. So, I'm
> 99% sure that I didn't have them mixed up.
>
> I just started using the interpreter instead. But, few hours later, I
> discovered that the debugger was working again, and it's been fine
> ever since.
>
>
>
> On Sat, Sep 26, 2009 at 7:31 PM, Terence Parr <parrt at cs.usfca.edu>  
> wrote:
>> make sure the port numbers are correct.  what version of AW?
>> Ter
>> On Sep 25, 2009, at 8:27 PM, Mark Boylan wrote:
>>
>>> I've been struggling with a grammar problem for about three day, but
>>> now I'm really stuck. The AntlrWorks debugger has completely stopped
>>> working for me.
>>>
>>> I tried swapping ports, but it didn't help. I figured that maybe
>>> something in my amateur grammar was causing it to get hung up and
>>> leave the port open. So I rebooted and copied a short example from
>>> "The Definitive Antlr Reference" into a fresh file. Same thing:
>>> "Time-out waiting to connect to the remote parser."
>>>
>>> I shut down AntlrWorks, did a netstat -ano and killed the offending
>>> process. I did a netstat -ano again and the port was clear. I
>>> restarted AntlrWorks -- the port was still clear. I hit debug on the
>>> sample grammar and got the same error.
>>>
>>> I've been rebooting and killing processes for an hour or two now,  
>>> and
>>> I can't see a solution. Does anyone know how to solve this?
>>>
>>> Here's the grammar I'm using to try to fix this:
>>>
>>> r : 'call' ID ';' {System.out.println("invoke "+$ID.text);} ;
>>> ID: 'a'..'z' + ;
>>> WS: (' ' |'\n' |'\r' )+ {$channel=HIDDEN;} ; // ignore whitespace
>>>
>>> Thanks.
>>>
>>> List: http://www.antlr.org/mailman/listinfo/antlr-interest
>>> Unsubscribe:
>>> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>>
>>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address


From david-sarah at jacaranda.org  Sun Sep 27 15:05:42 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sun, 27 Sep 2009 23:05:42 +0100
Subject: [antlr-interest] ANTLRWorks automatic update niggle
Message-ID: <4ABFE1B6.8080907@jacaranda.org>

(There doesn't seem to be any place to report ANTLRWorks bugs besides
this list, as far as I can see.)

The automatic update-download functionality of ANTLRWorks fails if the
download directory that was previously used, no longer exists.

That would be OK if the error message indicated more clearly what the
problem was, but it doesn't (if I remember correctly, the message just
says that it cannot find the file that was supposed to be downloaded).
Ideally, the message would also point out that the download path is set
in the 'Updates' tab of the ANTLRWorks Preferences.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From david-sarah at jacaranda.org  Sun Sep 27 15:28:14 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Sun, 27 Sep 2009 23:28:14 +0100
Subject: [antlr-interest] Regression in ANTLRWorks 1.3 tree view pane
Message-ID: <4ABFE6FE.6090105@jacaranda.org>

On upgrading to ANTLRWorks 1.3, there is a regression in the display
of the tree view of the grammar in the left-hand pane:

 - all productions are shown under the same label, which is the first
   label that has any productions.
 - the last character of each label up to that point is truncated.

This can be reproduced with a very simple grammar file:

lexer grammar Test;

// $< One
// $< Two
A : 'a';
// $< Three
B : 'b';
// $>
C : 'c';
// $>
D : 'd';
// $>

resulting in the tree

- On
  - Tw
    + A
    + B
    + C
    + D

rather than the expected

- One
  - Two
    + A
    - Three
      + B
    + C
  + D

This is on Vista SP2, in case it matters.

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From Richard.Lewis at razor-risk.com  Sun Sep 27 18:32:19 2009
From: Richard.Lewis at razor-risk.com (Richard Lewis)
Date: Mon, 28 Sep 2009 11:32:19 +1000
Subject: [antlr-interest] Parsing Lisp into C++
Message-ID: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>

I've started looking into translating a large amount of legacy Lisp code
into C++ using Antlr. I put together a simple grammar that generates an
AST. My question is: Where is the best place to attach semantic
information? It seems to me that I should have a 2 pass parser, starting
with the AST as shown below and then making  an additional pass to
generate another AST that contains semantics. Unfortunately I'm not that
familiar with Lisp but it seems to be difficult to parse in a single
pass without resorting to an ugly grammar definition since everything in
Lisp seems to be an expression of some sort.  This is ironic since Lisp
already seems to be "parsed". 

 

Input:

 

(defun foo (x y) (progn (+ x 1) (+ y 1)))

 

Grammar:

 

program: (sexpr)* -> ^(PROGRAM sexpr*);

sexpr: QT?(list|atom) ;

list:      '(' ')'   | '(' members ')'  -> ^(LIST members);

members: (sexpr)+;

atom: OPERATOR | ID | num | STRING ;

num       : (n=INT|n=FLOAT) -> ^(NUM $n);

 

AST Output:

 

PROGRAM

     LIST

           defun

           foo

           LIST

                x

                y

           LIST

                progn

                LIST

                     +

                     x

                     1

                LIST

                     +

                     y

                     1

 

Desired Output:

 

PROGRAM

     FUNCTION

           foo

           ARGS

                x

                y

           BLOCK

                +

                     x

                     1

                + 

                     y

                     1

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090928/b82d3e5a/attachment.html 

From iank at bearcave.com  Sun Sep 27 22:03:14 2009
From: iank at bearcave.com (Ian Kaplan)
Date: Sun, 27 Sep 2009 22:03:14 -0700
Subject: [antlr-interest] Parsing Lisp into C++
In-Reply-To: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>
References: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>
Message-ID: <7f8924df0909272203h5b1a2971vd818d03e3c2c6001@mail.gmail.com>

  The writer and Professor Umberto Eco points out that translation between
languages is translation between cultures.  The challenge in translation is
to produce a result that is understandable, useful and maybe even elegant.
To translate you must not only translate the words, but the ideas.

  Assuming that you had a magic black box that translated between Lisp and
C++, would such a translation produce something that is useful and
understandable.  You could do the translation and come up with something
that is not maintainable or understandable.  In fact, this is, I suspect,
exactly what you would get as the output from the black box.

  We know that Lisp can be compiled, so it is possible to translate Lisp
into C++ that will statically execute.  But the end result may be as useful
as reading assembly code.

  The issue with Lisp translation is not the language, but the run time,
since Lisp is by its nature a dynamic, typeless (or polymorphic) language.
There are things that you can say in Lisp that cannot be expressed directly
in C++.

  As unappealing as the idea is, it might be better to work through the
algorithms and translate them to C++ (or better, in my view, Java).

  Ian


On Sun, Sep 27, 2009 at 6:32 PM, Richard Lewis <Richard.Lewis at razor-risk.com
> wrote:

>  I've started looking into translating a large amount of legacy Lisp code
> into C++ using Antlr. I put together a simple grammar that generates an AST.
> My question is: Where is the best place to attach semantic  information? It
> seems to me that I should have a 2 pass parser, starting with the AST as
> shown below and then making  an additional pass to generate another AST that
> contains semantics. Unfortunately I'm not that familiar with Lisp but it
> seems to be difficult to parse in a single pass without resorting to an ugly
> grammar definition since everything in Lisp seems to be an expression of
> some sort.  This is ironic since Lisp already seems to be "parsed".
>
>
>
> Input:
>
>
>
> (defun foo (x y) (progn (+ x 1) (+ y 1)))
>
>
>
> Grammar:
>
>
>
> program: (sexpr)* -> ^(PROGRAM sexpr*);
>
> sexpr: QT?(list|atom) ;
>
> list:      '(' ')'   | '(' members ')'  -> ^(LIST members);
>
> members: (sexpr)+;
>
> atom: OPERATOR | ID | num | STRING ;
>
> num       : (n=INT|n=FLOAT) -> ^(NUM $n);
>
>
>
> AST Output:
>
>
>
> PROGRAM
>
>      LIST
>
>            defun
>
>            foo
>
>            LIST
>
>                 x
>
>                 y
>
>            LIST
>
>                 progn
>
>                 LIST
>
>                      +
>
>                      x
>
>                      1
>
>                 LIST
>
>                      +
>
>                      y
>
>                      1
>
>
>
> Desired Output:
>
>
>
> PROGRAM
>
>      FUNCTION
>
>            foo
>
>            ARGS
>
>                 x
>
>                 y
>
>            BLOCK
>
>                 +
>
>                      x
>
>                      1
>
>                 +
>
>                      y
>
>                      1
>
>
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090927/836d6e87/attachment.html 

From lgcraymer at yahoo.com  Sun Sep 27 22:49:45 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Sun, 27 Sep 2009 22:49:45 -0700 (PDT)
Subject: [antlr-interest] Parsing Lisp into C++
In-Reply-To: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>
References: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>
Message-ID: <952805.93132.qm@web55906.mail.re3.yahoo.com>

This is a case where I have to ask "why".  The typical Lisp compiler (not interpreter) is a Lisp to C translator with some additional glue.  You can probably even find support for translating CLOS to C++ if you look around.

--Loring



>
>From: Richard Lewis <Richard.Lewis at razor-risk.com>
>To: antlr-interest at antlr.org
>Sent: Sunday, September 27, 2009 6:32:19 PM
>Subject: [antlr-interest] Parsing Lisp into C++
>
> >
>
>
>>
>I've started looking into translating a large amount of
>legacy Lisp code into C++ using Antlr. I put together a simple grammar that
>generates an AST. My question is: Where is the best place to attach semantic  information?
>It seems to me that I should have a 2 pass parser, starting with the AST as
>shown below and then making  an additional pass to generate another AST
>that contains semantics. Unfortunately I'm not that familiar with Lisp but it
>seems to be difficult to parse in a single pass without resorting to an ugly
>grammar definition since everything in Lisp seems to be an expression of some
>sort.  This is ironic since Lisp already seems to be "parsed". 
> 
>Input:
> 
>(defun foo (x y) (progn (+ x 1) (+ y 1)))
> 
>Grammar:
> 
>program: (sexpr)* -> ^(PROGRAM sexpr*);
>sexpr: QT?(list|atom) ;
>list:      '(' ')'   |
>'(' members ')'  -> ^(LIST members);
>members: (sexpr)+;
>atom: OPERATOR | ID | num | STRING ;
>num       : (n=INT|n=FLOAT)
>-> ^(NUM $n);
> 
>AST Output:
> 
>PROGRAM
>     LIST
>           defun
>           foo
>           LIST
>                x
>                y
>           LIST
>                progn
>                LIST
>                     +
>                     x
>                     1
>                LIST
>                     +
>                     y
>                     1
> 
>Desired Output:
> 
>PROGRAM
>     FUNCTION
>           foo
>           ARGS
>                x
>                y
>           BLOCK
>                +
>                     x
>                     1
>                +
>
>                     y
>                     1
> 


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090927/39afb3ff/attachment.html 

From Richard.Lewis at razor-risk.com  Mon Sep 28 01:53:41 2009
From: Richard.Lewis at razor-risk.com (Richard Lewis)
Date: Mon, 28 Sep 2009 18:53:41 +1000
Subject: [antlr-interest] Parsing Lisp into C++
References: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>
	<952805.93132.qm@web55906.mail.re3.yahoo.com>
Message-ID: <1633C11AAD5C1C47A79C673A32A64FBA2EBA52@webmail.ite.com.au>


This is not  an intellectual exercise or a homework assignment. The Lisp in question is a peculiar dialect of CLOS developed for our clients to be able to embed scripting behavior in our application suite. The interpreter has been tweaked to the point of which we can no longer squeeze out any more performance gains. There are 10's of thousands of lines of code distributed amongst many clients so changing the language in any way is not an option. 

So the next step is to have it compiled natively. 

The requirements  are:

1. Lexical analyser and parser needs to support our dialect of lisp
2. The runtime library needs to be multithreaded and flexible (thinking native LLVM or OpenCL)
3. Has to be compiled into native machine code (i.e. can't run in a virtual machine)

My question was one of style with using Antlr... Is it better to muddy the parser grammar with a single pass or split the AST creation into 2 passes?

-Richard

-----Original Message-----
From: Loring Craymer [mailto:lgcraymer at yahoo.com]
Sent: Mon 9/28/2009 3:49 PM
To: Richard Lewis; antlr-interest at antlr.org
Subject: Re: [antlr-interest] Parsing Lisp into C++
 
This is a case where I have to ask "why".  The typical Lisp compiler (not interpreter) is a Lisp to C translator with some additional glue.  You can probably even find support for translating CLOS to C++ if you look around.

--Loring



>
>From: Richard Lewis <Richard.Lewis at razor-risk.com>
>To: antlr-interest at antlr.org
>Sent: Sunday, September 27, 2009 6:32:19 PM
>Subject: [antlr-interest] Parsing Lisp into C++
>
> >
>
>
>>
>I've started looking into translating a large amount of
>legacy Lisp code into C++ using Antlr. I put together a simple grammar that
>generates an AST. My question is: Where is the best place to attach semantic  information?
>It seems to me that I should have a 2 pass parser, starting with the AST as
>shown below and then making  an additional pass to generate another AST
>that contains semantics. Unfortunately I'm not that familiar with Lisp but it
>seems to be difficult to parse in a single pass without resorting to an ugly
>grammar definition since everything in Lisp seems to be an expression of some
>sort.  This is ironic since Lisp already seems to be "parsed". 
> 
>Input:
> 
>(defun foo (x y) (progn (+ x 1) (+ y 1)))
> 
>Grammar:
> 
>program: (sexpr)* -> ^(PROGRAM sexpr*);
>sexpr: QT?(list|atom) ;
>list:      '(' ')'   |
>'(' members ')'  -> ^(LIST members);
>members: (sexpr)+;
>atom: OPERATOR | ID | num | STRING ;
>num       : (n=INT|n=FLOAT)
>-> ^(NUM $n);
> 
>AST Output:
> 
>PROGRAM
>     LIST
>           defun
>           foo
>           LIST
>                x
>                y
>           LIST
>                progn
>                LIST
>                     +
>                     x
>                     1
>                LIST
>                     +
>                     y
>                     1
> 
>Desired Output:
> 
>PROGRAM
>     FUNCTION
>           foo
>           ARGS
>                x
>                y
>           BLOCK
>                +
>                     x
>                     1
>                +
>
>                     y
>                     1
> 


      


From lgcraymer at yahoo.com  Mon Sep 28 02:54:09 2009
From: lgcraymer at yahoo.com (Loring Craymer)
Date: Mon, 28 Sep 2009 02:54:09 -0700 (PDT)
Subject: [antlr-interest] Parsing Lisp into C++
In-Reply-To: <1633C11AAD5C1C47A79C673A32A64FBA2EBA52@webmail.ite.com.au>
References: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>
	<952805.93132.qm@web55906.mail.re3.yahoo.com>
	<1633C11AAD5C1C47A79C673A32A64FBA2EBA52@webmail.ite.com.au>
Message-ID: <269273.36567.qm@web55902.mail.re3.yahoo.com>

If you really want to re-invent the wheel, that's your business.  Given that Lisp is a prefix functional language (minimal syntax) and that all extensions (and the interpreter itself) are written in Lisp, it is unlikely to be difficult to get your code to compile with a commercial Lisp compiler capable of generating standalone executables.  There has been quite a bit of research on optimizing compilers for functional languages (particularly Lisp), and very little likelihood that you can write a more efficient translator than you can buy.

--Loring





----- Original Message ----
> From: Richard Lewis <Richard.Lewis at razor-risk.com>
> To: Loring Craymer <lgcraymer at yahoo.com>; antlr-interest at antlr.org
> Sent: Monday, September 28, 2009 1:53:41 AM
> Subject: RE: [antlr-interest] Parsing Lisp into C++
> 
> 
> This is not  an intellectual exercise or a homework assignment. The Lisp in 
> question is a peculiar dialect of CLOS developed for our clients to be able to 
> embed scripting behavior in our application suite. The interpreter has been 
> tweaked to the point of which we can no longer squeeze out any more performance 
> gains. There are 10's of thousands of lines of code distributed amongst many 
> clients so changing the language in any way is not an option. 
> 
> So the next step is to have it compiled natively. 
> 
> The requirements  are:
> 
> 1. Lexical analyser and parser needs to support our dialect of lisp
> 2. The runtime library needs to be multithreaded and flexible (thinking native 
> LLVM or OpenCL)
> 3. Has to be compiled into native machine code (i.e. can't run in a virtual 
> machine)
> 
> My question was one of style with using Antlr... Is it better to muddy the 
> parser grammar with a single pass or split the AST creation into 2 passes?
> 
> -Richard
> 
> -----Original Message-----
> From: Loring Craymer [mailto:lgcraymer at yahoo.com]
> Sent: Mon 9/28/2009 3:49 PM
> To: Richard Lewis; antlr-interest at antlr.org
> Subject: Re: [antlr-interest] Parsing Lisp into C++
> 
> This is a case where I have to ask "why".  The typical Lisp compiler (not 
> interpreter) is a Lisp to C translator with some additional glue.  You can 
> probably even find support for translating CLOS to C++ if you look around.
> 
> --Loring
> 
> 
> 
> >
> >From: Richard Lewis 
> >To: antlr-interest at antlr.org
> >Sent: Sunday, September 27, 2009 6:32:19 PM
> >Subject: [antlr-interest] Parsing Lisp into C++
> >
> > >
> >
> >
> >>
> >I've started looking into translating a large amount of
> >legacy Lisp code into C++ using Antlr. I put together a simple grammar that
> >generates an AST. My question is: Where is the best place to attach semantic  
> information?
> >It seems to me that I should have a 2 pass parser, starting with the AST as
> >shown below and then making  an additional pass to generate another AST
> >that contains semantics. Unfortunately I'm not that familiar with Lisp but it
> >seems to be difficult to parse in a single pass without resorting to an ugly
> >grammar definition since everything in Lisp seems to be an expression of some
> >sort.  This is ironic since Lisp already seems to be "parsed". 
> > 
> >Input:
> > 
> >(defun foo (x y) (progn (+ x 1) (+ y 1)))
> > 
> >Grammar:
> > 
> >program: (sexpr)* -> ^(PROGRAM sexpr*);
> >sexpr: QT?(list|atom) ;
> >list:      '(' ')'   |
> >'(' members ')'  -> ^(LIST members);
> >members: (sexpr)+;
> >atom: OPERATOR | ID | num | STRING ;
> >num       : (n=INT|n=FLOAT)
> >-> ^(NUM $n);
> > 
> >AST Output:
> > 
> >PROGRAM
> >     LIST
> >           defun
> >           foo
> >           LIST
> >                x
> >                y
> >           LIST
> >                progn
> >                LIST
> >                     +
> >                     x
> >                     1
> >                LIST
> >                     +
> >                     y
> >                     1
> > 
> >Desired Output:
> > 
> >PROGRAM
> >     FUNCTION
> >           foo
> >           ARGS
> >                x
> >                y
> >           BLOCK
> >                +
> >                     x
> >                     1
> >                +
> >
> >                     y
> >                     1
> > 



      

From andrew at plumb.org  Mon Sep 28 13:01:07 2009
From: andrew at plumb.org (Andrew Plumb)
Date: Mon, 28 Sep 2009 16:01:07 -0400
Subject: [antlr-interest] Referencing/Using antlr3 python runtime directly
	instead of via python setup.py install?
Message-ID: <87D90C05-292C-440B-976E-F8F5E35AF1D8@plumb.org>

Hi Everyone,

Does anyone have any examples of how to reference the antlr3 python  
runtime code directly from a python script calling an antlr-generated  
parser?

It doesn't have to be complex (setting an environment variable will do  
if there's a way), I'm just looking for something that works so I can  
exercise my own antlr parser dabblings.  I want to avoid touching  
system python defaults so I don't disrupt others, run on systems I  
don't necessarily have sudo/root access to, and be able to quickly  
test across multiple platforms (Linux, Solaris and Mac OS X).

This is for a little pet project of mine called xmleda; see http://xmleda.svn.sourceforge.net/viewvc/xmleda/trunk/antlr/

Thanks!

Andrew.

--

"The future is already here.  It's just not very evenly distributed"  
-- William Gibson




From paul.m.ramirez at jpl.nasa.gov  Mon Sep 28 15:02:11 2009
From: paul.m.ramirez at jpl.nasa.gov (Ramirez, Paul M (388J))
Date: Mon, 28 Sep 2009 15:02:11 -0700
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>
Message-ID: <C6E68073.99BC%Paul.M.Ramirez@jpl.nasa.gov>

Hi All,

So I added into my configuration the ability to set the options available to me in the maven plugin but this has still lead me nowhere. Antlrworks is still able to build me a parser and lexer that compile but maven isn't. Are there settings that AntlrWorks defaults to in its generating sources different from that of the maven plugin? In addition, the version of java set in the pom seems to have no effect on whether or not the sources are generated. Here is a bigger listing of my pom in case I'm missing some other setting. Sorry for such a long email but I really feel like there is something conflicting in my pom. Thanks in advance for any pointers anyone may have.

<project>
        <modelVersion>4.0.0</modelVersion>
        <parent>
                <groupId>gov.nasa.pds</groupId>
                <artifactId>pds</artifactId>
                <version>0.0.0</version>
        </parent>

        <groupId>gov.nasa.pds</groupId>
        <artifactId>product-tools</artifactId>
        <version>2.0.2</version>
        <packaging>jar</packaging>

        <name>Product Tools Library</name>
        <description>Label Validation Library</description>
        <url>http://pds-cm.jpl.nasa.gov/product-tools/</url>


        <build>
                <sourceDirectory>src/main/java</sourceDirectory>
                <testSourceDirectory>src/test</testSourceDirectory>
                <outputDirectory>target/classes</outputDirectory>
                <resources>
                        <resource>
                                <directory>${basedir}/src/main/resources</directory>
                        </resource>
                        <resource>
                                <directory>${basedir}/target/generated-sources/antlr3</directory>
                        </resource>
                        <resource>
                                <directory>${basedir}/src/main/java</directory>
                        </resource>
                </resources>
                <plugins>
                        <plugin>
                                <groupId>org.apache.maven.plugins</groupId>
                                <artifactId>maven-compiler-plugin</artifactId>
                                <configuration>
                                        <source>6</source>
                                        <target>6</target>
                                </configuration>
                        </plugin>
                        <plugin>
                                <groupId>org.apache.maven.plugins</groupId>
                                <artifactId>maven-jar-plugin</artifactId>
                                <configuration />
                        </plugin>
                        <plugin>
                                <groupId>org.codehaus.mojo</groupId>
                                <artifactId>maven-buildnumber-plugin
                                </artifactId>
                                <executions>
                                        <execution>
                                                <phase>validate</phase>
                                                <goals>
                                                        <goal>create</goal>
                                                </goals>
                                        </execution>
                                </executions>
                                <configuration>
                                        <format>{0,date,yyyy-MM-dd HH:mm:ss}</format>
                                        <items>
                                                <item>timestamp</item>
                                        </items>
                                        <doCheck>false</doCheck>
                                        <doUpdate>false</doUpdate>
                                </configuration>
                        </plugin>
                        <plugin>
                                <groupId>org.codehaus.mojo</groupId>
                                <artifactId>build-helper-maven-plugin</artifactId>
                                <version>1.0</version>
                                <executions>
                                        <execution>
                                                <id>add-source</id>
                                                <phase>generate-sources</phase>
                                                <goals>
                                                        <goal>add-source</goal>
                                                </goals>
                                                <configuration>
                                                        <sources>
                                                                <source>target/generated-sources/antlr3</source>
                                                        </sources>
                                                </configuration>
                                        </execution>
                                </executions>
                        </plugin>
                        <plugin>
                                <groupId>org.antlr</groupId>
                                <artifactId>antlr3-maven-plugin</artifactId>
                                <version>3.1.3-1</version>

                                <executions>
                                        <execution>
                                                <phase>generate-sources</phase>
                                                <goals>
                                                        <goal>antlr</goal>
                                                </goals>
                                                <configuration>
                                                        <conversionTimeout>10000</conversionTimeout>
                                                        <debug>false</debug>
                                                        <dfa>false</dfa>
                                                        <nfa>false</nfa>
                                                        <!--<excludes><exclude/></excludes>-->
                                                        <!--<includes><include/></includes>-->
                                                        <libDirectory>src/main/antlr3/imports</libDirectory>
                                                        <messageFormat>antlr</messageFormat>
                                                        <outputDirectory>target/generated-sources/antlr3</outputDirectory>
                                                        <printGrammar>false</printGrammar>
                                                        <profile>false</profile>
                                                        <report>false</report>
                                                        <sourceDirectory>src/main/antlr3</sourceDirectory>
                                                        <trace>true</trace>
                                                        <verbose>true</verbose>
                                                 </configuration>
                                        </execution>
                                </executions>

                        </plugin>
                </plugins>
        </build>
        <pluginRepositories>
                <pluginRepository>
                        <id>tlc</id>
                        <name>TLC Repository</name>
                        <url>http://commons.ucalgary.ca/pub/m2</url>
                </pluginRepository>
        </pluginRepositories>

        <repositories>
                <repository>
                        <id>pds-repo</id>
                        <name>PDS Repository</name>
                        <layout>default</layout>
                        <url>http://pds-cm.jpl.nasa.gov/maven2</url>
                        <releases>
                                <enabled>true</enabled>
                                <updatePolicy>always</updatePolicy>
                                <checksumPolicy>warn</checksumPolicy>
                        </releases>
                        <snapshots>
                                <enabled>false</enabled>
                        </snapshots>
                </repository>
                <repository>
                        <id>ognl-repo</id>
                        <name>OGNL Repository</name>
                        <layout>default</layout>
                        <url>http://mirrors.ibiblio.org/pub/mirrors/maven2</url>
                        <releases>
                                <enabled>true</enabled>
                                <updatePolicy>always</updatePolicy>
                                <checksumPolicy>warn</checksumPolicy>
                        </releases>
                        <snapshots>
                                <enabled>false</enabled>
                        </snapshots>
                </repository>
        </repositories>
        <dependencies>
                <dependency>
                        <groupId>commons-cli</groupId>
                        <artifactId>commons-cli</artifactId>
                        <version>1.2</version>
                        <scope>compile</scope>
                </dependency>
                <dependency>
                        <groupId>commons-io</groupId>
                        <artifactId>commons-io</artifactId>
                        <version>1.4</version>
                        <scope>compile</scope>
                </dependency>
                <dependency>
                        <groupId>commons-lang</groupId>
                        <artifactId>commons-lang</artifactId>
                        <version>2.4</version>
                        <scope>compile</scope>
                </dependency>
                <dependency>
                        <groupId>org.incava</groupId>
                        <artifactId>java-diff</artifactId>
                        <version>1.1.0</version>
                        <scope>compile</scope>
                </dependency>
                <dependency>
                        <groupId>org.antlr</groupId>
                        <artifactId>antlr-runtime</artifactId>
                        <version>3.1.3</version>
                </dependency>
                <dependency>
                        <groupId>org.antlr</groupId>
                        <artifactId>stringtemplate</artifactId>
                        <version>3.2</version>
                </dependency>
                <dependency>
                        <groupId>log4j</groupId>
                        <artifactId>log4j</artifactId>
                        <version>1.2.12</version>
                        <scope>compile</scope>
                </dependency>
                <dependency>
                        <groupId>junit</groupId>
                        <artifactId>junit</artifactId>
                        <version>4.0</version>
                        <type>jar</type>
                        <scope>test</scope>
                        <optional>true</optional>
                </dependency>
                <dependency>
                        <groupId>ognl</groupId>
                        <artifactId>ognl</artifactId>
                        <version>2.7.3</version>
                        <type>jar</type>
                        <scope>compile</scope>
                        <optional>false</optional>
                </dependency>
        </dependencies>
</project>


On 9/27/09 11:48 AM, "Ramirez, Paul M (388J)" <paul.m.ramirez at jpl.nasa.gov> wrote:

Hi All,

I'm having an issue when generating java sources in Maven versus with AntlrWorks. AntlrWorks seems to generate a perfectly fine size parser and lexer but in Maven the source code gets bloated to the point that it won't compile. We are using a helper plugin to compile other source files with the generated sources. Below is the applicable portions of the pom file. I'm hoping it's just a configuration I can change. If there is anything else I could provide to help resolve this issue please let me know.

                        <plugin>
                                <groupId>org.codehaus.mojo</groupId>
                                <artifactId>build-helper-maven-plugin</artifactId>
                                <version>1.0</version>
                                <executions>
                                        <execution>
                                                <id>add-source</id>
                                                <phase>generate-sources</phase>
                                                <goals>
                                                        <goal>add-source</goal>
                                                </goals>
                                                <configuration>
                                                        <sources>
                                                                <source>target/generated-sources/antlr3</source>
                                                        </sources>
                                                </configuration>
                                        </execution>
                                </executions>
                        </plugin>

                        <plugin>
                                <groupId>org.antlr</groupId>
                                <artifactId>antlr3-maven-plugin</artifactId>
                                <version>3.1.3-1</version>

                                <executions>
                                        <execution>
                                                <phase>generate-sources</phase>
                                                <goals>
                                                        <goal>antlr</goal>
                                                </goals>
                                        </execution>
                                </executions>

                        </plugin>

                <dependency>
                        <groupId>org.antlr</groupId>
                        <artifactId>antlr-runtime</artifactId>
                        <version>3.1.3</version>
                </dependency>
                <dependency>
                        <groupId>org.antlr</groupId>
                        <artifactId>stringtemplate</artifactId>
                        <version>3.2</version>
                </dependency>



Thanks,
Paul Ramirez
Senior Computer Scientist
Jet Propulsion Laboratory

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090928/caaf3759/attachment.html 

From jonathan at claggett.org  Mon Sep 28 15:10:37 2009
From: jonathan at claggett.org (Jonathan Claggett)
Date: Mon, 28 Sep 2009 18:10:37 -0400
Subject: [antlr-interest] StringTemplate to generate Grammar docs?
Message-ID: <abf361130909281510v5e0103f6r1a92899fa137ac8e@mail.gmail.com>

Hello,

Would there exist a StringTemplate that works with the ANTLRv3.g file to
generate HTML (or at least plain text) documentation from a grammar file?
Ideally, it would print just the EBNF rules and tokens (i.e., it would NOT
print the actions, labels, imaginary tokens or rewrites).

I'm brand new to the world of ANTLR which will be my official reason for why
I missed the link to this tool on the website ;-)

Regards,

Jonathan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090928/a4c2bd76/attachment.html 

From david-sarah at jacaranda.org  Mon Sep 28 16:16:33 2009
From: david-sarah at jacaranda.org (David-Sarah Hopwood)
Date: Tue, 29 Sep 2009 00:16:33 +0100
Subject: [antlr-interest] Parsing Lisp into C++
In-Reply-To: <1633C11AAD5C1C47A79C673A32A64FBA2EBA52@webmail.ite.com.au>
References: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>	<952805.93132.qm@web55906.mail.re3.yahoo.com>
	<1633C11AAD5C1C47A79C673A32A64FBA2EBA52@webmail.ite.com.au>
Message-ID: <4AC143D1.6060805@jacaranda.org>

Richard Lewis wrote:
> This is not an intellectual exercise or a homework assignment. The Lisp
> in question is a peculiar dialect of CLOS developed for our clients to be
> able to embed scripting behavior in our application suite. The interpreter
> has been tweaked to the point of which we can no longer squeeze out any
> more performance gains. There are 10's of thousands of lines of code
> distributed amongst many clients so changing the language in any way is
> not an option. 
> 
> So the next step is to have it compiled natively.

Hire a Lisp expert. Seriously.

The quality of this language implementation will be crucial to the future
success of your application suite, so the best approach is almost certainly
to choose an existing high-performance, multithreaded Common Lisp
implementation that is suited to embedding, and that can be modified or
extended to support the peculiarities of your existing dialect. Na?ve
compilation to C++ is unlikely to provide the performance, functionality,
or robustness that you would get from using a mature language implementation
(*especially* if you want it to be multithreaded). Your company needs an
experienced Lisp hacker who will help you to choose a suitable CL
implementation and modify it as needed.

(I have no personal interest in giving this advice; I don't have nearly
enough Lisp experience.)

-- 
David-Sarah Hopwood  ?  http://davidsarah.livejournal.com


From kaleb.pederson at gmail.com  Mon Sep 28 16:18:47 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Mon, 28 Sep 2009 16:18:47 -0700
Subject: [antlr-interest] How to generate JUnit sources using
	maven-gunit-plugin?
Message-ID: <f14c01620909281618w26c7db42qea078a4eecae023a@mail.gmail.com>

I currently have the maven-gunit-plugin configured to run in interpreter mode:

  <plugin>
    <groupId>org.antlr</groupId>
    <artifactId>maven-gunit-plugin</artifactId>
    <version>3.1.3</version>
    <executions>
        <execution>
            <id>maven-gunit-plugin</id>
            <phase>test</phase>
            <goals>
                <goal>gunit</goal>
            </goals>
        </execution>
    </executions>
  </plugin>

Is a different directive present that I can use to run gunit in JUnit
generation mode instead?

Thanks.

--Kaleb

From james.robson at ymail.com  Mon Sep 28 20:35:08 2009
From: james.robson at ymail.com (James Robson)
Date: Mon, 28 Sep 2009 20:35:08 -0700 (PDT)
Subject: [antlr-interest] Fix for JavaScript Target Broken in 3.1.4,
	3.2 and antlrworks 1.3
Message-ID: <943949.9832.qm@web43505.mail.sp1.yahoo.com>

Hi,

The latest released versions of ANTLR and ANTLRWorks have a broken javascript target.

Prior to version 1.3 antlworks did work.

The problem is the treeParser template in JavaScritp.stg

I've attached a diff of the fix. Can someone see about getting the code base patched?


Thanks in advance,
James Robson


      __________________________________________________________________________________
Get more done like never before with Yahoo!7 Mail.
Learn more: http://au.overview.mail.yahoo.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090928/691fe9e4/attachment.html 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: diff.txt
Url: http://www.antlr.org/pipermail/antlr-interest/attachments/20090928/691fe9e4/attachment.txt 

From dave at tridecap.com  Tue Sep 29 05:45:30 2009
From: dave at tridecap.com (Dave Dutcher)
Date: Tue, 29 Sep 2009 07:45:30 -0500
Subject: [antlr-interest] Referencing/Using antlr3 python runtime
	directlyinstead of via python setup.py install?
In-Reply-To: <87D90C05-292C-440B-976E-F8F5E35AF1D8@plumb.org>
References: <87D90C05-292C-440B-976E-F8F5E35AF1D8@plumb.org>
Message-ID: <2C71D558503C435EBD41C84D22DFB05A@tridecap.com>

> -----Original Message-----
> From: Andrew Plumb
> Subject: [antlr-interest] Referencing/Using antlr3 python 
> runtime directlyinstead of via python setup.py install?
> 
> Hi Everyone,
> 
> Does anyone have any examples of how to reference the antlr3 
> python runtime code directly from a python script calling an 
> antlr-generated parser?
> 
> It doesn't have to be complex (setting an environment 
> variable will do if there's a way), I'm just looking for 
> something that works so I can exercise my own antlr parser 
> dabblings.  I want to avoid touching system python defaults 
> so I don't disrupt others, run on systems I don't necessarily 
> have sudo/root access to, and be able to quickly test across 
> multiple platforms (Linux, Solaris and Mac OS X).

You don't actually have to run python setup.py install to use the rutime.
You can just take the antlr3 file out of the runtime egg and put it in your
local directory or anywhere on your python path. 

Dave

 


From andrew at plumb.org  Tue Sep 29 06:08:47 2009
From: andrew at plumb.org (Andrew Plumb)
Date: Tue, 29 Sep 2009 09:08:47 -0400
Subject: [antlr-interest] Referencing/Using antlr3 python runtime
	directlyinstead of via python setup.py install?
In-Reply-To: <2C71D558503C435EBD41C84D22DFB05A@tridecap.com>
References: <87D90C05-292C-440B-976E-F8F5E35AF1D8@plumb.org>
	<2C71D558503C435EBD41C84D22DFB05A@tridecap.com>
Message-ID: <8DFEB787-2A3F-4ED0-9FE6-32C0D714BF15@plumb.org>

Hi Dave,

Excellent!  Just the sort of thing I was looking for.

The approach I'll probably take then is to download runtime, unpack,  
and 'ln -s' to the runtime egg file.

Thanks!

Andrew.

On 29-Sep-09, at 8:45 AM, Dave Dutcher wrote:

>> -----Original Message-----
>> From: Andrew Plumb
>> Subject: [antlr-interest] Referencing/Using antlr3 python
>> runtime directlyinstead of via python setup.py install?
>>
>> Hi Everyone,
>>
>> Does anyone have any examples of how to reference the antlr3
>> python runtime code directly from a python script calling an
>> antlr-generated parser?
>>
>> It doesn't have to be complex (setting an environment
>> variable will do if there's a way), I'm just looking for
>> something that works so I can exercise my own antlr parser
>> dabblings.  I want to avoid touching system python defaults
>> so I don't disrupt others, run on systems I don't necessarily
>> have sudo/root access to, and be able to quickly test across
>> multiple platforms (Linux, Solaris and Mac OS X).
>
> You don't actually have to run python setup.py install to use the  
> rutime.
> You can just take the antlr3 file out of the runtime egg and put it  
> in your
> local directory or anywhere on your python path.
>
> Dave
>
>
>

--

"The future is already here.  It's just not very evenly distributed"  
-- William Gibson




From thierry.uso at wanadoo.fr  Tue Sep 29 07:54:06 2009
From: thierry.uso at wanadoo.fr (Thierry USO)
Date: Tue, 29 Sep 2009 16:54:06 +0200
Subject: [antlr-interest] how to get the value of an identifier
Message-ID: <20090929145358.7A15780000B0@mwinf2f04.orange.fr>

A complete example which shows my problem.

--- ADL.g ---

grammar ADL; // Rally Application Development Language

constant_definition
: ConstDef
;

ConstDef
: {System.out.println("");} CONST 
(
(' '|'\t')* Identifier {System.out.print($Identifier.text + " ");} 
(' '|'\t')* EQUAL 
(' '|'\t')* CharString {System.out.print($CharString.text + " ");}
(' '|'\t')* SEMICOLON
)+
;

CharString
: '"' (LETTER)+ '"'
;

CONST
: 'CONST' {System.out.print("CONST ");}
;

LETTER
: ('a'..'z'|'A'..'Z')
;

DIGIT
: ('0'..'9')
;

SEMICOLON
: ';' {System.out.println(";");}
;

EQUAL
: '=' {System.out.print("= ");}
;

Identifier
: LETTER (LETTER|'_'|DIGIT)+
;

----

--- ADL.java ---

import java.io.*;
import org.antlr.runtime.*;
import org.antlr.runtime.debug.DebugEventSocketProxy;

public class ADL {

    public static void main(String args[]) throws Exception {
        ADLLexer lex = new ADLLexer(new ANTLRFileStream("/home/thierry/antlr/output/tid.txt"));
        CommonTokenStream tokens = new CommonTokenStream(lex);
        
        ADLParser g = new ADLParser(tokens);
        try {
          g.constant_definition();
        } catch (RecognitionException e)  {
            e.printStackTrace();
        }       
    }
}

----

--- tid.txt ---

CONST  str1 = "ok" ;
	str2="ko";
       str3 = "end";

----

$ java ADL

CONST str1 = "ok" ;
= ;
= ;

Only the first values (Identifier, CharString) are printed and not the following ;-(
I used antlrworks-1.2.3.

Thierry.




From indhu.b at s7software.com  Tue Sep 29 08:02:15 2009
From: indhu.b at s7software.com (Indhu Bharathi)
Date: Tue, 29 Sep 2009 20:32:15 +0530
Subject: [antlr-interest] StringTemplate to generate Grammar docs?
In-Reply-To: <abf361130909281510v5e0103f6r1a92899fa137ac8e@mail.gmail.com>
References: <abf361130909281510v5e0103f6r1a92899fa137ac8e@mail.gmail.com>
Message-ID: <00d201ca4115$d5084c90$7f18e5b0$@b@s7software.com>

Try the tool 'strip'. It comes with ANTLR.

 

 

From: antlr-interest-bounces at antlr.org
[mailto:antlr-interest-bounces at antlr.org] On Behalf Of Jonathan Claggett
Sent: Tuesday, September 29, 2009 3:41 AM
To: antlr-interest at antlr.org
Subject: [antlr-interest] StringTemplate to generate Grammar docs?

 

Hello,

Would there exist a StringTemplate that works with the ANTLRv3.g file to
generate HTML (or at least plain text) documentation from a grammar file?
Ideally, it would print just the EBNF rules and tokens (i.e., it would NOT
print the actions, labels, imaginary tokens or rewrites).

I'm brand new to the world of ANTLR which will be my official reason for why
I missed the link to this tool on the website ;-)

Regards,

Jonathan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090929/64d6d9e9/attachment.html 

From jimi at temporal-wave.com  Tue Sep 29 08:29:00 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 29 Sep 2009 08:29:00 -0700
Subject: [antlr-interest] how to get the value of an identifier
In-Reply-To: <20090929145358.7A15780000B0@mwinf2f04.orange.fr>
References: <20090929145358.7A15780000B0@mwinf2f04.orange.fr>
Message-ID: <4AC227BC.3060007@temporal-wave.com>

On 09/29/2009 07:54 AM, Thierry USO wrote:
> A complete example which shows my problem.
>
> --- ADL.g ---
>
> grammar ADL; // Rally Application Development Language
>
> constant_definition
> : ConstDef
> ;
>
> ConstDef
> : {System.out.println("");} CONST
> (
> (' '|'\t')* Identifier {System.out.print($Identifier.text + " ");}
> (' '|'\t')* EQUAL
> (' '|'\t')* CharString {System.out.print($CharString.text + " ");}
> (' '|'\t')* SEMICOLON
> )+
> ;
>
> CharString
> : '"' (LETTER)+ '"'
> ;
>
> CONST
> : 'CONST' {System.out.print("CONST ");}
> ;
>
>    

You need:

fragment
LETTER ....
> LETTER
> : ('a'..'z'|'A'..'Z')
> ;
>    

Jim

From Gordon.Tyler at quest.com  Tue Sep 29 08:30:16 2009
From: Gordon.Tyler at quest.com (Gordon Tyler)
Date: Tue, 29 Sep 2009 08:30:16 -0700
Subject: [antlr-interest] how to get the value of an identifier
In-Reply-To: <20090929145358.7A15780000B0@mwinf2f04.orange.fr>
References: <20090929145358.7A15780000B0@mwinf2f04.orange.fr>
Message-ID: <1FE9A296676737419A8912A6FD22AE1D01C21F08D6@alvxmbw04.prod.quest.corp>

Try changing "ConstDef" to "constDef". You're declaring it as a lexer token (by using an uppercase first letter), when really it should be a parser rule.

-----Original Message-----
From: antlr-interest-bounces at antlr.org [mailto:antlr-interest-bounces at antlr.org] On Behalf Of Thierry USO
Sent: September 29, 2009 10:54 AM
To: antlr-interest
Subject: Re: [antlr-interest] how to get the value of an identifier

A complete example which shows my problem.

--- ADL.g ---

grammar ADL; // Rally Application Development Language

constant_definition
: ConstDef
;

ConstDef
: {System.out.println("");} CONST 
(
(' '|'\t')* Identifier {System.out.print($Identifier.text + " ");} 
(' '|'\t')* EQUAL 
(' '|'\t')* CharString {System.out.print($CharString.text + " ");}
(' '|'\t')* SEMICOLON
)+
;

CharString
: '"' (LETTER)+ '"'
;

CONST
: 'CONST' {System.out.print("CONST ");}
;

LETTER
: ('a'..'z'|'A'..'Z')
;

DIGIT
: ('0'..'9')
;

SEMICOLON
: ';' {System.out.println(";");}
;

EQUAL
: '=' {System.out.print("= ");}
;

Identifier
: LETTER (LETTER|'_'|DIGIT)+
;

----

--- ADL.java ---

import java.io.*;
import org.antlr.runtime.*;
import org.antlr.runtime.debug.DebugEventSocketProxy;

public class ADL {

    public static void main(String args[]) throws Exception {
        ADLLexer lex = new ADLLexer(new ANTLRFileStream("/home/thierry/antlr/output/tid.txt"));
        CommonTokenStream tokens = new CommonTokenStream(lex);
        
        ADLParser g = new ADLParser(tokens);
        try {
          g.constant_definition();
        } catch (RecognitionException e)  {
            e.printStackTrace();
        }       
    }
}

----

--- tid.txt ---

CONST  str1 = "ok" ;
	str2="ko";
       str3 = "end";

----

$ java ADL

CONST str1 = "ok" ;
= ;
= ;

Only the first values (Identifier, CharString) are printed and not the following ;-(
I used antlrworks-1.2.3.

Thierry.




List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address

From jbb at acm.org  Tue Sep 29 08:51:09 2009
From: jbb at acm.org (John B. Brodie)
Date: Tue, 29 Sep 2009 11:51:09 -0400
Subject: [antlr-interest] how to get the value of an identifier
In-Reply-To: <20090929145358.7A15780000B0@mwinf2f04.orange.fr>
References: <20090929145358.7A15780000B0@mwinf2f04.orange.fr>
Message-ID: <1254239469.7700.10.camel@gecko.home.org>

Greetings!


On Tue, 2009-09-29 at 16:54 +0200, Thierry USO wrote: 
> A complete example which shows my problem.
> 
....remainder snipped....

Your grammar does not handle New-Line characters ('\n' and possibly
'\r'). You should have received many "no viable alternative at ..."
error messages....

As others have stated you should:

1) make LETTER and DIGIT fragement rules.
2) make ConstDef be a parser rule
3) when you do 2) you should add a WHITESPACE lexer rule, perhaps
putting the WHITESPACE (including new-lines) on the HIDDEN channel (e.g.
{ $channel = HIDDEN; } )

attached is a complete example with the above suggestions applied. Oh by
the way.... in my example I construct an AST during the parse and then
print the AST at the end; rather than doing the System.out stuff during
the parse....

Hope this helps...
   -jbb


-------------- next part --------------
grammar ADL; // Rally Application Development Language

options {
    output = AST;
    ASTLabelType = CommonTree;
}

@members {
    private static final String [] x = new String[]{
       "\nCONST str1 = \"ok\" ;\n       str2=\"ko\";\n      str3 = \"end\";"
    };

    public static void main(String [] args) {
        for( int i = 0; i < x.length; ++i ) {
            try {
                System.out.println("about to parse:`"+x[i]+"`");
                ADLLexer lexer = new ADLLexer(new ANTLRStringStream(x[i]));
                CommonTokenStream tokens = new CommonTokenStream(lexer);

                ADLParser parser = new ADLParser(tokens);
                ADLParser.start_return p_result = parser.start();

                CommonTree ast = p_result.tree;
                if( ast == null ) {
                   System.out.println("resultant tree: is NULL");
                } else {
                   System.out.println("resultant tree: " + ast.toStringTree());
                }
                System.out.println();
            } catch(Exception e) {
                e.printStackTrace();
            }
        }
    }
}

start : constant_definition EOF!;

constant_definition : constDef ;

constDef : CONST ( Identifier EQUAL CharString SEMICOLON )+ ;

CharString : '"' (LETTER)+ '"' ;

CONST : 'CONST' ;

fragment LETTER : ('a'..'z'|'A'..'Z') ;

fragment DIGIT : ('0'..'9') ;

SEMICOLON : ';' ;

EQUAL : '=' ;

Identifier : LETTER (LETTER|'_'|DIGIT)+ ;

WHITESPACE : (' '|'\t')+ { $channel = HIDDEN; } ;
NEWLINE : ('\r'|'\n')+ { $channel = HIDDEN; } ;



From luca.ligreci at gmail.com  Tue Sep 29 12:35:04 2009
From: luca.ligreci at gmail.com (Luca Li Greci)
Date: Tue, 29 Sep 2009 20:35:04 +0100
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>
References: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>
Message-ID: <7ca0370d0909291235s65a5cb8co26dfc0683167f49b@mail.gmail.com>

2009/9/27 Ramirez, Paul M (388J) <paul.m.ramirez at jpl.nasa.gov>

>  Hi All,
>
> I?m having an issue when generating java sources in Maven versus with
> AntlrWorks. AntlrWorks seems to generate a perfectly fine size parser and
> lexer but in Maven the source code gets bloated to the point that it won?t
> compile. We are using a helper plugin to compile other source files with the
> generated sources. Below is the applicable portions of the pom file. I?m
> hoping it?s just a configuration I can change. If there is anything else I
> could provide to help resolve this issue please let me know.
>
>                         <plugin>
>                                 <groupId>org.codehaus.mojo</groupId>
>
>                                 <artifactId>build-helper-maven-plugin</artifactId>
>                                 <version>1.0</version>
>                                 <executions>
>                                         <execution>
>                                                 <id>add-source</id>
>
>                                                 <phase>generate-sources</phase>
>                                                 <goals>
>
>                                                         <goal>add-source</goal>
>                                                 </goals>
>                                                 <configuration>
>                                                         <sources>
>
>                                                                 <source>target/generated-sources/antlr3</source>
>                                                         </sources>
>                                                 </configuration>
>                                         </execution>
>                                 </executions>
>                         </plugin>
>
>                         <plugin>
>                                 <groupId>org.antlr</groupId>
>
>                                 <artifactId>antlr3-maven-plugin</artifactId>
>                                 <version>3.1.3-1</version>
>
>                                 <executions>
>                                         <execution>
>
>                                                 <phase>generate-sources</phase>
>                                                 <goals>
>                                                         <goal>antlr</goal>
>                                                 </goals>
>                                         </execution>
>                                 </executions>
>
>                         </plugin>
>
>                 <dependency>
>                         <groupId>org.antlr</groupId>
>                         <artifactId>antlr-runtime</artifactId>
>                         <version>3.1.3</version>
>                 </dependency>
>                 <dependency>
>                         <groupId>org.antlr</groupId>
>                         <artifactId>stringtemplate</artifactId>
>                         <version>3.2</version>
>                 </dependency>
>
>
>
> Thanks,
> Paul Ramirez
> Senior Computer Scientist
> Jet Propulsion Laboratory
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>
Hi Paul,

I don't understand what exactly happened with your pom file. Here is what I
defined in mine

In the dependecies section

            <dependency>
                <groupId>org.antlr</groupId>
                <artifactId>antlr3-maven-plugin</artifactId>
                <version>3.1.3-1</version>
            </dependency>
            <dependency>
                <groupId>org.antlr</groupId>
                <artifactId>antlr</artifactId>
                <version>3.1.3</version>
            </dependency>
            <dependency>
                <groupId>org.antlr</groupId>
                <artifactId>stringtemplate</artifactId>
                <version>3.2</version>
                <exclusions>
                    <exclusion>
                        <artifactId>antlr</artifactId>
                        <groupId>antlr</groupId>
                    </exclusion>
                </exclusions>
            </dependency>

For the compiler plugin, source and target are set to 1.6 instead of 6

           <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.0.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>

and then

<plugin>
                <groupId>org.antlr</groupId>
                <artifactId>antlr3-maven-plugin</artifactId>
                <version>3.1.3-1</version>
                <executions>
                    <execution>
                        <id>parser</id>
                        <phase>generate-sources</phase>
                        <goals>
                            <goal>antlr</goal>
                        </goals>
                        <configuration>

<sourceDirectory>src/main/resources/antlr3</sourceDirectory>
                            <libDirectory>src/main/resources/antlr3*
/org/mycompany/myproduct*</libDirectory>

<outputDirectory>target/generated-sources/antlr3</outputDirectory>
                            <includes>
                                <include>***/myGrammar*.g*</include>
                            </includes>
                        </configuration>
                    </execution>
                </executions>
            </plugin>

As you can see under src/main/resources/antlr3 I created a "package
structure" of subfolder and inside myproduct I put all my grammars.

In this way I keep in synch what is generated as subdirectories with what I
declared inside the grammar file, for instance

@parser::header {package org.mycompany.myproduct;}

If you don't do that you have a weird situation where the code is generate
in the default package (top level), and in the code there's the package
definition.... it doesn't compile.

Best regards

Luca

-- 
Victor Hugo wrote, ?The future has many names: For the weak, it means the
unattainable. For the fearful, it means the unknown. For the courageous, it
means opportunity.?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090929/e7f6c8fe/attachment.html 

From luca.ligreci at gmail.com  Tue Sep 29 12:40:28 2009
From: luca.ligreci at gmail.com (Luca Li Greci)
Date: Tue, 29 Sep 2009 20:40:28 +0100
Subject: [antlr-interest] Maven Plugin Configuration
In-Reply-To: <C6E5137E.98DF%Paul.M.Ramirez@jpl.nasa.gov>
References: <C6E5137E.98DF%Paul.M.Ramirez@jpl.nasa.gov>
Message-ID: <7ca0370d0909291240x5ca28268jdbfb96b771d62567@mail.gmail.com>

2009/9/27 Ramirez, Paul M (388J) <paul.m.ramirez at jpl.nasa.gov>

>  Hi All,
>
> I noticed that if I wanted to configure the plugin the website description
> http://antlr.org/antlr3-maven-plugin/usage.html seemed to have the
> configuration tag in the wrong place.  I?m not sure if this is universally
> true for everyone but if I configuration tag in the other place the plugin
> would not work.
>
> Here is what is on the site:
>
> <plugin>
>     <groupId>org.antlr</groupId>
>     <artifactId>antlr3-maven-plugin</artifactId>
>     <version>3.1.3-1</version>
>
>     <executions>
>
>         <execution>
>             <configuration>
>                 <goals>
>                     <goal>antlr</goal>
>                 </goals>
>                 <conversionTimeout>10000</conversionTimeout>
>                 <debug>false</debug>
>                 <dfa>false</dfa>
>                 <nfa>false</nfa>
>                 <excludes><exclude/></excludes>
>                 <includes><include/></includes>
>                 <libDirectory>src/main/antlr3/imports</libDirectory>
>                 <messageFormat>antlr</messageFormat>
>
>                 <outputDirectory>target/generated-sources/antlr3</outputDirectory>
>                 <printGrammar>false</printGrammar>
>                 <profile>false</profile>
>                 <report>false</report>
>                 <sourceDirectory>src/main/antlr3</sourceDirectory>
>                 <trace>false</trace>
>                 <verbose>true</verbose>
>             </configuration>
>         </execution>
>     </executions>
>
> </plugin>
>
> Here is what I found actually worked for configuration:
>
> <plugin>
>     <groupId>org.antlr</groupId>
>     <artifactId>antlr3-maven-plugin</artifactId>
>     <version>3.1.3-1</version>
>
>     <executions>
>         <execution>
>             <goals>
>                 <goal>antlr</goal>
>              </goals>
>             <configuration>                     <!--- CONFIGURATION TAG
> AFTER GOAL -->
>                 <conversionTimeout>10000</conversionTimeout>
>                 <debug>false</debug>
>                 <dfa>false</dfa>
>                 <nfa>false</nfa>
>                 <excludes><exclude/></excludes>
>                 <includes><include/></includes>
>                 <libDirectory>src/main/antlr3/imports</libDirectory>
>                 <messageFormat>antlr</messageFormat>
>
>                 <outputDirectory>target/generated-sources/antlr3</outputDirectory>
>                 <printGrammar>false</printGrammar>
>                 <profile>false</profile>
>                 <report>false</report>
>                 <sourceDirectory>src/main/antlr3</sourceDirectory>
>                 <trace>false</trace>
>                 <verbose>true</verbose>
>             </configuration>
>         </execution>
>     </executions>
>
> </plugin>
>
> Thanks,
> Paul Ramirez
> Senior Computer Scientist
> Jet Propulsion Laboratory
>
>
Hi Paul,

Actually you're right, it's very odd to have the goal defined inside the
goal. General speaking it should be as you wrote: the goals and
configuration are 2 separates section.


>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

-- 
Victor Hugo wrote, ?The future has many names: For the weak, it means the
unattainable. For the fearful, it means the unknown. For the courageous, it
means opportunity.?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090929/aceee2e2/attachment.html 

From kaleb.pederson at gmail.com  Tue Sep 29 12:42:25 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Tue, 29 Sep 2009 12:42:25 -0700
Subject: [antlr-interest] How to generate JUnit sources using
	maven-gunit-plugin?
In-Reply-To: <f14c01620909281618w26c7db42qea078a4eecae023a@mail.gmail.com>
References: <f14c01620909281618w26c7db42qea078a4eecae023a@mail.gmail.com>
Message-ID: <f14c01620909291242g34408d6bg77f8b02b258789a5@mail.gmail.com>

Since I didn't get an answer, I pulled up the maven-gunit-plugin
source code to see if there was such an option, and there is not.

It's not currently possible to use this plugin to generate JUnit
sources.  The gunit goal is hard coded and there's no reference to the
JUnitGenerator class.

--Kaleb

On Mon, Sep 28, 2009 at 4:18 PM, Kaleb Pederson
<kaleb.pederson at gmail.com> wrote:
> I currently have the maven-gunit-plugin configured to run in interpreter mode:
>
> ?<plugin>
> ? ?<groupId>org.antlr</groupId>
> ? ?<artifactId>maven-gunit-plugin</artifactId>
> ? ?<version>3.1.3</version>
> ? ?<executions>
> ? ? ? ?<execution>
> ? ? ? ? ? ?<id>maven-gunit-plugin</id>
> ? ? ? ? ? ?<phase>test</phase>
> ? ? ? ? ? ?<goals>
> ? ? ? ? ? ? ? ?<goal>gunit</goal>
> ? ? ? ? ? ?</goals>
> ? ? ? ?</execution>
> ? ?</executions>
> ?</plugin>
>
> Is a different directive present that I can use to run gunit in JUnit
> generation mode instead?
>
> Thanks.
>
> --Kaleb
>

From jimi at temporal-wave.com  Tue Sep 29 12:42:49 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Tue, 29 Sep 2009 12:42:49 -0700
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <7ca0370d0909291235s65a5cb8co26dfc0683167f49b@mail.gmail.com>
References: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>
	<7ca0370d0909291235s65a5cb8co26dfc0683167f49b@mail.gmail.com>
Message-ID: <4AC26339.5040708@temporal-wave.com>

On 09/29/2009 12:35 PM, Luca Li Greci wrote:
>
> <plugin>
> <groupId>org.antlr</groupId>
> <artifactId>antlr3-maven-plugin</artifactId>
> <version>3.1.3-1</version>
> <executions>
> <execution>
> <id>parser</id>
> <phase>generate-sources</phase>
> <goals>
> <goal>antlr</goal>
> </goals>
> <configuration>
> <sourceDirectory>src/main/resources/antlr3</sourceDirectory>
> <libDirectory>src/main/resources/antlr3*/org/mycompany/myproduct*</libDirectory>
> <outputDirectory>target/generated-sources/antlr3</outputDirectory>
> <includes>
> <include>***/myGrammar*.g*</include>
> </includes>
> </configuration>
> </execution>
> </executions>
> </plugin>
>
> As you can see under src/main/resources/antlr3 I created a "package 
> structure" of subfolder and inside myproduct I put all my grammars.
>
> In this way I keep in synch what is generated as subdirectories with 
> what I declared inside the grammar file, for instance
>
> @parser::header {package org.mycompany.myproduct;}
>
> If you don't do that you have a weird situation where the code is 
> generate in the default package (top level), and in the code there's 
> the package definition.... it doesn't compile.

Hi - you should avoid setting up your own structure under source and use 
the pre-known locations of the .g files. Read the docs at 
www.antlr.org/antlr3-maven-plugin. The .g files should go under the 
antlr directory and they should be in sub directories of this directory 
that reflect the package structure you want for the generated files. 
Include and lib, as well as import is then calculated automatically.

Also note that we are at ANTLR 3.2 and plugin 3.2 now, though I think 
that Maven central is not syncing our repository right now and I have no 
time to try and work out why.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090929/b46dee87/attachment.html 

From ger.hobbelt at bermuda-holding.com  Tue Sep 29 17:16:02 2009
From: ger.hobbelt at bermuda-holding.com (Ger Hobbelt)
Date: Wed, 30 Sep 2009 02:16:02 +0200
Subject: [antlr-interest]  Parsing Lisp into C++
In-Reply-To: <561cc61d0909291659o7932423dic82bd9c4163f5ca1@mail.gmail.com>
References: <1633C11AAD5C1C47A79C673A32A64FBA0130750F@webmail.ite.com.au>
	<952805.93132.qm@web55906.mail.re3.yahoo.com>
	<1633C11AAD5C1C47A79C673A32A64FBA2EBA52@webmail.ite.com.au>
	<4AC143D1.6060805@jacaranda.org>
	<561cc61d0909291659o7932423dic82bd9c4163f5ca1@mail.gmail.com>
Message-ID: <561cc61d0909291716l73a84e02uad1322c2eaca928@mail.gmail.com>

> Richard Lewis wrote:
>> This is not an intellectual exercise or a homework assignment. The Lisp
>> in question is a peculiar dialect of CLOS developed for our clients to be
>> able to embed scripting behavior in our application suite. The interpreter
>> has been tweaked to the point of which we can no longer squeeze out any
>> more performance gains. There are 10's of thousands of lines of code
>> distributed amongst many clients so changing the language in any way is
>> not an option.
>>
>> So the next step is to have it compiled natively.

Oh boy...

When I first read this, the very first thought was 'you should see
what Autodesk did and take that as a [strong] hint' and the more I see
appear in this thread, the stronger the feeling.

For those who say 'Auto-who?!?!' think the number one vendor of CAD
solutions worldwide (AFAIK). They've offered LISP 'scripting' since
about the stone age and they've hit this (and other) barriers over the
years. FYI:

http://en.wikipedia.org/wiki/AutoLISP

or google 'autoLISP' or 'Visual LISP'


You mention your bottleneck is *performance*, and this is me reading
between your lines, but my impression is it's such an important
bottleneck that you're willing to spend the effort to change from the
existing interpreter to something entirely different, e.g. a [JIT?]
compiler / other scripting language even? That means the number of
passes of the compiler/translator to be is not the most important
issue here.


Since it's SPEED what you need, let me be very clear: if you have no
extensive readily available knowledge and experience with constructing
optimizing compilers and/or language translators, you're at the start
of a unfathomable battle.
And assuming you have those abilities aplenty, then there's still the
issue of 'maintenance' which splits two ways:

a) when your 'translated' code will ever (if only 'just once') hit
human retinae, you've just chosen to walk the path to utter damnation,
because machine-translated code is /never/ maintainable in the long
run; any of that sort gets rewritten as quickly as possibly, dialing
up maintenance cost as it's basically smeared out dual translation
efforts, once machine, once manual, where the latter is at a
additional disadvantage then, so TCO goes through the roof (but smart
accountants know where to hide that long term result. What's the
average lifetime of a board level occupation after all)

b) when your 'translated' result is strictly for machine eyes only,
which means you're not translating but /compiling/ your sourcecode,
you can either do it all from scratch or buy [half]product. In this
case, one can argue it's a technology-only issue (budgets allowing),
where your need for speed (there's that again) implies your major
effort will /not/ end up creating the parser (i.e. the ANTLR work) but
the optimizer part of your compiler, i.e. adding the smart AST
rewriter(s), etc. In other words: ANTLR will only be the start of it,
when you wish to build your own translator. (A human expert
interpreting and re-implementing the 'original intent' by hand can be
quite competitive here.)

Alternatively, you can seek an already available [partial] solution
for choice (b). A solution which you pick because it's generated
output is extremely fast already, then spend your remaining budget and
time on integrating and tweaking that engine. Run-time speed of
generated output would win over parser generator tools used, I'd say.
When your company decides to take the (b) route, I suggest you take
this latter choice: acquire an existing translator/compiler engine and
tweak and embed that one. When it happens to use ANTLR, more power to
it and you, but ANTLR, in this particular case, is part of the easy
20%, not the backbreaking 80%.



Please backpedal, and your board of directors should (re)convene on
this a well, as it's /them/ who must make the /strategic/ choice where
your money (& time) will be spent:

1) building a compiler/translator from scratch (and state very
explicitly whether output if for humans or 'strictly machine only';
others will need to phrase this as 'output is editable (yes/no)' to be
able to discover the significant consequences of such a decision.
Building or purchasing is only a secondary choice here.

2) take the route Autodesk effectively did: If it's not fast enough
for 'you' (for any user value of 'you'), there's an alternative
user-scriptable ABI/API here for you. Autodesk offers native C++
interfaces for those folks that need near-bare metal speed. Note that
in 20+ years they have switched their LISP interpreter only once,
replacing the old one with a new development environment, but it has
remained an interpreter all the same. The major /strategic/ choice
/they/ made was adding other extensibility options: their modern C++
and .NET interfaces.

3) phase out your LISP support and substitute it with something else;
while in the transition phase your company can offer translation
services for those users who need those. (I wouldn't advise this right
away, because LISP is a quite different animal, and once you get used
to it... When Autodesk would announce a choice like this, you'd get
spontaneous lynching parties. If the flame wars in their discussion
boards over the years about whether to lisp or not to lisp is any
indication, oy oy oy!)


I like ANTLR very much, and for what it does I consider it the best
tool around by a very large margin, but this way lies lunacy as well
if you're not mindful of the consequences of taking this road. Context
is everything, some times.




Reread the messages by Mr. Kaplan twice for good measure, also reread
the messages by the other posters.




Then when you wish to persevere, I'd say to

"My question was one of style with using Antlr... Is it better to
muddy the parser grammar with a single pass or split the AST creation
into 2 passes?"
or rather: "Where is the best place to attach semantic ?information?"

that the 'right' answer is one of taste. My answer is: "Spread the
wealth. Do both".

Elaboration:
I've done both, single- and multipass, and I've even considered it a
particularly enticing challenge to roll it all into a strictly single
pass (and that challenge I've put to myself twice, just to prove to
myself I could do it. Sigh. The male species.... The point here:
single-pass sounds nice, but taking it to the extreme will make it a
maintenance/readability headache.
In actual practice, the engines which I still like to 'grok' today,
even when I wrote them a long time ago, are the ones that use a
single, fast, pass to turn text into an AST, add the semantics as far
as was /easily/ doable during that phase, then update/extend those
semantic attributes in subsequent 'passes', i.e. AST
traversals/rewrites. Not too amazingly, those 'both passes' solutions
happen to be the fastest, also when compared to my
oh-so-mentally-challenging single pass compilers/interpreters. So:
'add what you can, when and where it feels right'. No 'best' there; it
quickly becomes similar to the question 'which programming language is
best?' -- too little context to remain truely meaningful.


And here's a thought about that single- versus double-pass doodah: all
compilers, even the single-pass ones, are multipass. It just depends
on what you define as 'a pass'. The only really 'one pass compilers'
(and the 'one pass interpreter' I once created using bison/yacc) are
non-optimizing straight translators/interpreters/compilers.
Since LISP and C/C++ are culturally (to borrow Mr. Kaplan's / Prof.
Eco's phrasing) very far apart, I'm willing to bet you'll need
multipass anyway to get anywhere near a viable translation.
And then... what is an optimizer than another couple of passes --
where 'pass' == 'current code representation traversal' --> AST
traversal, once you're past the lexer+scanner (ANTLR) and arrived at
the 'backend'. That are multiple passes, or at /least/ one more with a
bit of extra hither-and-yon, which is mandatory when you wish to
rewrite (== optimize) your AST after all.

The number of passes might seem to matter at first, but in the end I
find it's not so important. There are more O(N) factors than just the
number of passes.
What I try to do myself is one fast pass lexing+scanning the human
readable stuff into some form of AST (FAST as this pass will cut down
multichar 'slow' access to 'fast' single ID/integer-based token
access), do it fast and easy (ANTLR can be quite useful there, while I
confess I tend to handcode almost all my lexers), then do the complex
voodoo in the AST traversal, try to cut down on the number of
traversals, or rather, number of nodes visited -- and when you can,
cut down on heap dynamics (malloc/free/new/delete), both the explicit
and implicit ones, as those can eat an inordinate amount of time when
you're not careful.

And that's enough for now. It's high time for some shuteye here.

--
Met vriendelijke groeten / Best regards,

Ger Hobbelt

--------------------------------------------------
web: ? ?http://www.hobbelt.com/
? ? ? ?http://www.hebbut.net/
mail: ? ger at hobbelt.com
mobile: +31-6-11 120 978
--------------------------------------------------

From jonathan at claggett.org  Tue Sep 29 20:11:35 2009
From: jonathan at claggett.org (Jonathan Claggett)
Date: Tue, 29 Sep 2009 23:11:35 -0400
Subject: [antlr-interest] StringTemplate to generate Grammar docs?
In-Reply-To: <-6987615320209212367@unknownmsgid>
References: <abf361130909281510v5e0103f6r1a92899fa137ac8e@mail.gmail.com> 
	<-6987615320209212367@unknownmsgid>
Message-ID: <abf361130909292011t352aaf80g9fa2a119284741f5@mail.gmail.com>

Thank you! That looks like it'll do the job (I've been using Fedora's
package which is still 3.1.1 so I haven't tried it yet). Off to build from
the sources.

Thanks again,
Jonathan

On Tue, Sep 29, 2009 at 11:02 AM, Indhu Bharathi <indhu.b at s7software.com>wrote:

>  Try the tool ?strip?. It comes with ANTLR.
>
>
>
>
>
> *From:* antlr-interest-bounces at antlr.org [mailto:
> antlr-interest-bounces at antlr.org] *On Behalf Of *Jonathan Claggett
> *Sent:* Tuesday, September 29, 2009 3:41 AM
> *To:* antlr-interest at antlr.org
> *Subject:* [antlr-interest] StringTemplate to generate Grammar docs?
>
>
>
> Hello,
>
> Would there exist a StringTemplate that works with the ANTLRv3.g file to
> generate HTML (or at least plain text) documentation from a grammar file?
> Ideally, it would print just the EBNF rules and tokens (i.e., it would NOT
> print the actions, labels, imaginary tokens or rewrites).
>
> I'm brand new to the world of ANTLR which will be my official reason for
> why I missed the link to this tool on the website ;-)
>
> Regards,
>
> Jonathan
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090929/a133ea27/attachment.html 

From luca.ligreci at gmail.com  Wed Sep 30 02:47:45 2009
From: luca.ligreci at gmail.com (Luca Li Greci)
Date: Wed, 30 Sep 2009 10:47:45 +0100
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <4AC26339.5040708@temporal-wave.com>
References: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>
	<7ca0370d0909291235s65a5cb8co26dfc0683167f49b@mail.gmail.com>
	<4AC26339.5040708@temporal-wave.com>
Message-ID: <7ca0370d0909300247x44f91e06laee20e2142ea0635@mail.gmail.com>

2009/9/29 Jim Idle <jimi at temporal-wave.com>

>  On 09/29/2009 12:35 PM, Luca Li Greci wrote:
>
>
> <plugin>
>                 <groupId>org.antlr</groupId>
>                 <artifactId>antlr3-maven-plugin</artifactId>
>                 <version>3.1.3-1</version>
>                 <executions>
>                     <execution>
>                         <id>parser</id>
>                         <phase>generate-sources</phase>
>                         <goals>
>                             <goal>antlr</goal>
>                         </goals>
>                         <configuration>
>
> <sourceDirectory>src/main/resources/antlr3</sourceDirectory>
>                             <libDirectory>src/main/resources/antlr3*
> /org/mycompany/myproduct*</libDirectory>
>
> <outputDirectory>target/generated-sources/antlr3</outputDirectory>
>                             <includes>
>                                 <include>***/myGrammar*.g*</include>
>                             </includes>
>                         </configuration>
>                     </execution>
>                 </executions>
>             </plugin>
>
> As you can see under src/main/resources/antlr3 I created a "package
> structure" of subfolder and inside myproduct I put all my grammars.
>
> In this way I keep in synch what is generated as subdirectories with what I
> declared inside the grammar file, for instance
>
> @parser::header {package org.mycompany.myproduct;}
>
> If you don't do that you have a weird situation where the code is generate
> in the default package (top level), and in the code there's the package
> definition.... it doesn't compile.
>
>
> Hi - you should avoid setting up your own structure under source and use
> the pre-known locations of the .g files. Read the docs at
> www.antlr.org/antlr3-maven-plugin. The .g files should go under the antlr
> directory and they should be in sub directories of this directory that
> reflect the package structure you want for the generated files. Include and
> lib, as well as import is then calculated automatically.
>
> Also note that we are at ANTLR 3.2 and plugin 3.2 now, though I think that
> Maven central is not syncing our repository right now and I have no time to
> try and work out why.
>
> Jim
>
>
> List: http://www.antlr.org/mailman/listinfo/antlr-interest
> Unsubscribe:
> http://www.antlr.org/mailman/options/antlr-interest/your-email-address
>
>

Hi Jim,

Let me see if my understanding is correct.

You said that when the grammar is under src/main/antlr3* *the maven plugin
automatically picks up all grammar defined under any subdirectories (such
as org/mycompany/myproduct) so that the maven parameters include, lib, and
the @parser::header {package org.mycompany.myproduct;} are useless. Is it my
understanding correct ?

Thanks Jim for your clarification

-- 
Victor Hugo wrote, ?The future has many names: For the weak, it means the
unattainable. For the fearful, it means the unknown. For the courageous, it
means opportunity.?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090930/4bbbf1d5/attachment.html 

From viridium at gmail.com  Wed Sep 30 06:12:53 2009
From: viridium at gmail.com (Mihai Danila)
Date: Wed, 30 Sep 2009 09:12:53 -0400
Subject: [antlr-interest] Greedy Lexer
Message-ID: <b00576380909300612t648299e3n798322bccf367a0c@mail.gmail.com>

I have this simple grammar:

expr: token+;
token: And | Number | String;

And: '.AND.';
Number: Digit ;
String: '"' (~('"')*) '"';
fragment Digit: ('0'..'9');


My question: though ANTLR parses "123".AND."45" correctly, it doesn't parse
expressions of the form 123.AND.45 correctly. What is the remedy for this?
(Other than adding spaces in between the tokens.)


Thanks,
Mihai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090930/f754046a/attachment.html 

From paul.m.ramirez at jpl.nasa.gov  Wed Sep 30 06:27:37 2009
From: paul.m.ramirez at jpl.nasa.gov (Ramirez, Paul M (388J))
Date: Wed, 30 Sep 2009 06:27:37 -0700
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <7ca0370d0909300247x44f91e06laee20e2142ea0635@mail.gmail.com>
Message-ID: <C6E8AAD9.9AEF%Paul.M.Ramirez@jpl.nasa.gov>

Hey All,

Just wanted to bring this topic back around to the original question I had. If set up correctly, what would cause the maven plugin to generate different source then antlrworks (50k lines vs 8k for the parser)? I have left the configuration to the defaults for the maven plugin. Right now I have to generate sources with antlrworks because the compiler won't work on the (50k line java file).

Thanks,
Paul Ramirez


On 9/30/09 2:47 AM, "Luca Li Greci" <luca.ligreci at gmail.com> wrote:



2009/9/29 Jim Idle <jimi at temporal-wave.com>

On 09/29/2009 12:35 PM, Luca Li Greci wrote:

<plugin>
                <groupId>org.antlr</groupId>
                <artifactId>antlr3-maven-plugin</artifactId>
                <version>3.1.3-1</version>
                <executions>
                    <execution>
                        <id>parser</id>
                        <phase>generate-sources</phase>
                        <goals>
                            <goal>antlr</goal>
                        </goals>
                        <configuration>
                            <sourceDirectory>src/main/resources/antlr3</sourceDirectory>
                            <libDirectory>src/main/resources/antlr3/org/mycompany/myproduct</libDirectory>
                            <outputDirectory>target/generated-sources/antlr3</outputDirectory>
                            <includes>
                                <include>**/myGrammar*.g</include>
                            </includes>
                        </configuration>
                    </execution>
                </executions>
            </plugin>

As you can see under src/main/resources/antlr3 I created a "package structure" of subfolder and inside myproduct I put all my grammars.

In this way I keep in synch what is generated as subdirectories with what I declared inside the grammar file, for instance

@parser::header {package org.mycompany.myproduct;}

If you don't do that you have a weird situation where the code is generate in the default package (top level), and in the code there's the package definition.... it doesn't compile.

Hi - you should avoid setting up your own structure under source and use the pre-known locations of the .g files. Read the docs at www.antlr.org/antlr3-maven-plugin <http://www.antlr.org/antlr3-maven-plugin> . The .g files should go under the antlr directory and they should be in sub directories of this directory that reflect the package structure you want for the generated files. Include and lib, as well as import is then calculated automatically.

Also note that we are at ANTLR 3.2 and plugin 3.2 now, though I think that Maven central is not syncing our repository right now and I have no time to try and work out why.

Jim


List: http://www.antlr.org/mailman/listinfo/antlr-interest
Unsubscribe: http://www.antlr.org/mailman/options/antlr-interest/your-email-address



Hi Jim,

Let me see if my understanding is correct.

You said that when the grammar is under src/main/antlr3 the maven plugin automatically picks up all grammar defined under any subdirectories (such as org/mycompany/myproduct) so that the maven parameters include, lib, and the @parser::header {package org.mycompany.myproduct;} are useless. Is it my understanding correct ?

Thanks Jim for your clarification
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090930/e13eb6ba/attachment.html 

From Nicola.Musatti at objectway.it  Wed Sep 30 06:29:16 2009
From: Nicola.Musatti at objectway.it (Nicola Musatti)
Date: Wed, 30 Sep 2009 15:29:16 +0200
Subject: [antlr-interest] Greedy Lexer
In-Reply-To: <4779_1254316449_4AC359A0_4779_154250_1_b00576380909300612t648299e3n798322bccf367a0c@mail.gmail.com>
References: <4779_1254316449_4AC359A0_4779_154250_1_b00576380909300612t648299e3n798322bccf367a0c@mail.gmail.com>
Message-ID: <18514_1254317363_n8UDTGAl030480_4AC35D2C.2040906@ObjectWay.it>

Mihai Danila wrote:
> 
> I have this simple grammar:
> 
> expr: token+;
> token: And | Number | String;
> 
> And: '.AND.';
> Number: Digit ;

Aren't you just missing a form of repetition here, like:

Number: Digit+ ;

> String: '"' (~('"')*) '"';
> fragment Digit: ('0'..'9');
> 
> My question: though ANTLR parses "123".AND."45" correctly, it doesn't 
> parse expressions of the form 123.AND.45 correctly. What is the remedy 
> for this? (Other than adding spaces in between the tokens.)
> 
> Thanks,
> Mihai

Cheers,
Nicola Musatti

-- 
La presente comunicazione potrebbe contenere informazioni riservate e/o protette
da segreto professionale ed e' indirizzata esclusivamente ai destinatari della
medesima qui indicati. Se avete ricevuto per errore la presente comunicazione,
siete invitati a segnalarcelo, rispondendo a questo stesso indirizzo di e-mail,
e a cancellare il presente messaggio dal Vostro sistema. E' strettamente proibito
e potrebbe essere fonte di violazione di legge qualsiasi uso, comunicazione, copia
o diffusione dei contenuti di questa comunicazione da parte di chi la abbia
ricevuta per errore o in violazione degli scopi della presente.
Il messaggio e' stato analizzato alla ricerca di virus o contenuti pericolosi
ed e' risultato NON infetto.


From antlr at walkback.co.uk  Wed Sep 30 07:03:34 2009
From: antlr at walkback.co.uk (antlr at walkback.co.uk)
Date: Wed, 30 Sep 2009 09:03:34 -0500 (CDT)
Subject: [antlr-interest] ANTLR & StringTemplate Support
Message-ID: <54961.84.9.221.40.1254319414.squirrel@65.60.36.114>

Apologies for this entre, but I have drawn a blank on our other enquires,
hence I have posted this entre.

We are currently in the process of project planning an ANTLR based
application.  Should this project get the go ahead I must demonstrate to
management that there is support to fill in the holes of our knowledge and
to keep the project flowing.

Therefore, I would like to ask members of this forum their availability
for commercial ANTLR  support.  You must be based in the UK and
demonstrate a high level of understanding of the latest versions of ANTLR
3.2, StringTemplates 3.2 and Java.  You will need to prove that you have
an ANTLR based application working.

The role will be a short term one, whereby we would need a number of days
in our office to perform intensive training, consulting and development. 
There after WebEx, email or telephone support when we require it. 
Selected individual will be required to agree to sign a Non-Discloser
Agreement.

Interested parties please replay back to this email address:
antlr at walkback.co.uk

Jay


From jimi at temporal-wave.com  Wed Sep 30 07:56:45 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Sep 2009 07:56:45 -0700
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <7ca0370d0909300246n2b9bb1ffh63ceb883f9fa7678@mail.gmail.com>
References: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>	
	<7ca0370d0909291235s65a5cb8co26dfc0683167f49b@mail.gmail.com>	
	<4AC26339.5040708@temporal-wave.com>
	<7ca0370d0909300246n2b9bb1ffh63ceb883f9fa7678@mail.gmail.com>
Message-ID: <4AC371AD.8070603@temporal-wave.com>

On 09/30/2009 02:46 AM, Luca Li Greci wrote:
>
>
> 2009/9/29 Jim Idle <jimi at temporal-wave.com 
> <mailto:jimi at temporal-wave.com>>
>
>     On 09/29/2009 12:35 PM, Luca Li Greci wrote:
>>
>>     <plugin>
>>
...
>
>
>     Hi - you should avoid setting up your own structure under source
>     and use the pre-known locations of the .g files. Read the docs at
>     www.antlr.org/antlr3-maven-plugin
>     <http://www.antlr.org/antlr3-maven-plugin>. The .g files should go
>     under the antlr directory and they should be in sub directories of
>     this directory that reflect the package structure you want for the
>     generated files. Include and lib, as well as import is then
>     calculated automatically.
>
>     Also note that we are at ANTLR 3.2 and plugin 3.2 now, though I
>     think that Maven central is not syncing our repository right now
>     and I have no time to try and work out why.
>
>     Jim
>
>
>
> Hi Jim,
>
> Let me see if my understanding is correct.
>
> You said that when the grammar is under src/main/antlr3* *the maven 
> plugin automatically picks up all grammar defined under any 
> subdirectories (such as org/mycompany/myproduct) so that the maven 
> parameters include, lib, and the @parser::header {package 
> org.mycompany.myproduct;} are useless. Is it my understanding correct ?
Not useless, but redundant. The plugin assumes that if it is in 
src/main/antlr3/org/x/y  then it has a package set to that and will 
produce the java code in the same pacakge structure. Lib is then 
redundant as the tokens files are taken care of.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090930/5ac43ce1/attachment.html 

From jimi at temporal-wave.com  Wed Sep 30 07:57:48 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Sep 2009 07:57:48 -0700
Subject: [antlr-interest] Maven vs AntlrWorks Generated Sources
In-Reply-To: <7ca0370d0909300247x44f91e06laee20e2142ea0635@mail.gmail.com>
References: <C6E50173.98C8%Paul.M.Ramirez@jpl.nasa.gov>	<7ca0370d0909291235s65a5cb8co26dfc0683167f49b@mail.gmail.com>	<4AC26339.5040708@temporal-wave.com>
	<7ca0370d0909300247x44f91e06laee20e2142ea0635@mail.gmail.com>
Message-ID: <4AC371EC.7060006@temporal-wave.com>

On 09/30/2009 02:47 AM, Luca Li Greci wrote:
>
> You said that when the grammar is under src/main/antlr3* *the maven 
> plugin automatically picks up all grammar defined under any 
> subdirectories (such as org/mycompany/myproduct) so that the maven 
> parameters include, lib, and the @parser::header {package 
> org.mycompany.myproduct;}

You still need the package in the @headers for each .g file.

Jim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090930/8063bb49/attachment.html 

From jimi at temporal-wave.com  Wed Sep 30 07:58:41 2009
From: jimi at temporal-wave.com (Jim Idle)
Date: Wed, 30 Sep 2009 07:58:41 -0700
Subject: [antlr-interest] [c target] how to change "#include <antlr3.h>"
 in generated .h parser file?
In-Reply-To: <op.u01d6oyyt3jqlu@win-mupvrp0jyrf>
References: <op.u0w57dret3jqlu@win-mupvrp0jyrf>
	<4ABFA3C0.9090600@temporal-wave.com>
	<op.u01d6oyyt3jqlu@win-mupvrp0jyrf>
Message-ID: <4AC37221.1030405@temporal-wave.com>

On 09/30/2009 06:03 AM, ??????? ?????? wrote:
> How to change "#include <antlr3.h>"  in generated .h parser file?
> can i change this path in grammar options?
>
>
You don't - just use teh correct -I option on the compile line.

Jim

From mulhern at gmail.com  Wed Sep 30 10:49:32 2009
From: mulhern at gmail.com (mulhern)
Date: Wed, 30 Sep 2009 12:49:32 -0500
Subject: [antlr-interest] decision DFA calculation algorithm
Message-ID: <54f15b6e0909301049r63fbccd3p8c9e5b70934070f5@mail.gmail.com>

Hi!

I'm curious if there is any documentation about how decision DFAs are
calculated by ANTLR. The Definitive Reference states the conditions under
which a grammar is LL(*) but not how this is decided.

Thanks!

- mulhern
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.antlr.org/pipermail/antlr-interest/attachments/20090930/0e9a5119/attachment.html 

From thierry.uso at wanadoo.fr  Wed Sep 30 13:20:36 2009
From: thierry.uso at wanadoo.fr (Thierry USO)
Date: Wed, 30 Sep 2009 22:20:36 +0200
Subject: [antlr-interest] how to get the value of an identifier
Message-ID: <20090930202034.9DE8480000F6@mwinf2b26.orange.fr>

It works!

LETTER and DIGIT fragment rules and EOL were needed. See below.

grammar ADL; // Rally Application Development Language

constant_definition
: CONST {System.out.print("CONST ");}
(
(' '|'\t')* Identifier {System.out.print($Identifier.text + " ");} (' '|'\t')* 
'=' {System.out.print("= ");} (' '|'\t')* 
CharString {System.out.print($CharString.text + " ");}  
(' '|'\t')* ';' {System.out.println(";");} (' '|'\t')* EOL
)+
;

CONST
: 'CONST'
;

Identifier
: LETTER (LETTER|'_'|DIGIT)+
;

CharString
: '"' (LETTER)+ '"'
;

EOL
: '\r'? '\n'
;

fragment
LETTER
: ('a'..'z'|'A'..'Z')
;

fragment
DIGIT
: ('0'..'9')
;

Thanks again. antlr-interest is great !

>
>Your grammar does not handle New-Line characters ('\n' and possibly
>'\r'). You should have received many "no viable alternative at ..."
>error messages....
>
>As others have stated you should:
>
>1) make LETTER and DIGIT fragement rules.
>2) make ConstDef be a parser rule
>3) when you do 2) you should add a WHITESPACE lexer rule, perhaps
>putting the WHITESPACE (including new-lines) on the HIDDEN channel (e.g.
>{ $channel = HIDDEN; } )
>
>attached is a complete example with the above suggestions applied. Oh by
>the way.... in my example I construct an AST during the parse and then
>print the AST at the end; rather than doing the System.out stuff during
>the parse....
>
>Hope this helps...
>   -jbb
>





From isabelle.perseil at enst.fr  Wed Sep 30 14:31:50 2009
From: isabelle.perseil at enst.fr (Isabelle Perseil)
Date: Wed, 30 Sep 2009 23:31:50 +0200
Subject: [antlr-interest] =?iso-8859-1?q?_EXTENDED_DEADLINE=3A_UML=26FM=92?=
 =?iso-8859-1?q?2009?=
Message-ID: <f55e68e5d232b28c6dd468adf79c78d1.squirrel@webmail1.telecom-paristech.fr>

**********************************************************************
                    2nd CALL FOR PAPERS :  UML&FM?2009
            2nd INTERNATIONAL WORKSHOP ON UML&FORMAL METHODS
          http://www.artist-embedded.org/artist/UML-FM-2009.html

               Workshop held in conjunction with ICFEM 2009
                   The 11th International Conference on
                      Formal Engineering Methods
                 http://icfem09.inf.puc-rio.br/ICFEM.html
                           December 08, 2009
                        Rio de Janeiro, Brazil
************************************************************************

                     Submission deadline: October 12th, 2009
                     -----------------------------------------


Many interest groups from a research perspective are in favour of the
creation of this workshop.

For more than a decade now, the two communities of UML and formal methods
have been working together to produce a simultaneously practical (via UML)
and rigorous (via formal methods) approach to software engineering.

UML is the de facto standard for modelling various aspects of software
systems in both industry and academia, despite the inconvenience that its
current specification is complex and its syntax imprecise.

The fact that the UML semantics is too informal have led many researchers
to formalize it with all kinds of existing formal languages, like OCL, Z,
B, CSP, VDM, Petri Nets, UPPAAL, HOL, Coq, PVS etc.

This second workshop will be open to various subjects as the main
objective is to encourage new initiatives of building bridges between
informal, semi-formal and formal notations.


Topics:
======

This workshop seeks contributions from researchers and practitioners
interested in all aspects of integrating UML and formal methods. To this
end, we solicit papers (no more than 6 pages long) related to, but not
limited to, the following principal topics:

?        Consistent specifications, model transformations (QVT technologies,
         transformation repositories). Transformations to make models more
         analyzable so as to make them executable.

?        Automation of traceability through transformations

?        Refinement techniques: developing detailed design from a UML
         abstract specification

?        Refinement of OCL specification as well

?        Formal reasoning on models for code generation

?        Technologies for compositional verification of models

?        Specification of a formal semantics for the UML.
         Giving an abstract syntax to UML diagrams

?        Formal validation and verification of software

?        Co-modeling methods formal/informal mapping techniques

?        End-to-end methodologies or software process
         engineering,correct-by-construction design providing and
         supporting tools for safety-critical embedded systems design


Workshop Format
===============
This full-day workshop will consist of an introduction of the topic by the
workshop organizers, presentations of accepted papers, and in depth
discussion of previously identified subjects emerging from the
submissions. A summary of the discussions will be made available.


Submission and Publication
==========================
To contribute, please send a position paper or a technical paper

to agusti[dot]canals[at]c-s[dot]fr with ?ICFEM09 UML&FM Workshop? in the
title.

2 versions of the papers will be requested :

1/ Short versions : papers should not exceed 6 pages. Submitted
manuscripts should be in English and formatted in the style of the IEEE CS
Format. Preferably, submissions should be in PDF format.
First, the selected papers will be published online via in the IEEE Xpress
and distributed during the workshop as a Technical Report between
Pontif?cia Universidade Cat?lica do Rio de Janeiro and Telecom-ParisTech

2/ Then, after the workshop (the deadline is not already fixed), as
post-proceedings, all extended versions of accepted papers will be
published in the ISSE NASA journal (Innovations in Systems and Software
Engineering), first edition of 2010.
These papers should not exceed 8 pages. Submitted manuscripts should be in
English and formatted in the style of the ISSE Format. Preferably,
submissions should be in PDF format.
Please, follow the guidelines at the "For authors and editors" heading in
the ISSE website
(http://www.springer.com/computer/programming/journal/11334)


IMPORTANT DATES
===============
Submission deadline:             October 12th, 2009
All Notification of acceptance:  October 30th, 2009
Final copy for proceedings:      November 15th, 2009
Workshop date :                  December 08th, 2009


Organizers
==========

Organizational sponsors :

OMG        (http://www.omg.org/)
ARTIST   (http://www.artist-embedded.org/artist/)


Organizers and Programme Steering committee:

Jean-Michel Bruel (Liuppa, France)
Agusti Canals (CS, France)
Robert de Simone (INRIA, France)
S?bastien G?rard (CEA-LIST, France)
Elie Najm (Telecom ParisTech, France)
Isabelle Perseil (TELECOM ParisTech, France)

Publicity Chair:
Sun Meng (CWI, The Netherlands)

IEEE CS Coordinator:

Mike Hinchey (NASA GSFC and Loyola College in Maryland, USA)


Program Committee:

    * Nazareno Aguirre (Universidad Nacional de R?o Cuarto, Argentina)
    * Pascal Andr? (LINA, University of Nantes, France)
    * Yamine Ait Ameur (LISI / ENSMA, France)
    * Luciano Baresi (Politecnico di Milano, Italia)
    * Yves Bernard (AIRBUS France, France)
    * Jean-Paul Bodeveix (IRIT, France)
    * Agusti Canals (CS, France) ? General Chair
    * Sebastien Demathieu (THALES, France)
    * Mamoun Filali (IRIT, France)
    * Madeleine Faug?re (THALES, France)
    * Robert France (Colorado State University, USA)
    * S?bastien G?rard (CEA-LIST, France)
    * Martin Gogolla (University of Bremen, Germany)
    * Irfan Hamid (Microsoft Corp, Canada)
    * Wooter Joosen (Catholic University of Leuven, Belgium)
    * Sharon Keidar-Barner (IBM Haifa Research Laboratory, Israel)
    * Kevin Lano (King?s College London, United Kingdom)
    * Tom Maibaum (McMaster University, Canada )
    * Manuel Mazzara (Newcastle University, United Kingdom)
    * Stephen J.Mellor (Accelerated Technologies, Tucson AZ, USA)
    * Sun Meng (CWI, The Netherlands)
    * Dominique Mery (LORIA, France)
    * Alexandre Mota (Universidade Federal de Pernambuco, Brazil)
    * Elie Najm (Telecom ParisTech, France)
    * Kazuhiro Ogata (Japan Advanced Institute of Science and Technology,
      Japan)
    * Richard Paige (University of York, United Kingdom)
    * Dorina Petriu (Carlton University, USA)
    * Pierre-Yves Schobbens (University of Namur, Belgium)
    * Douglas C. Schmidt (Vanderbild University, USA)
    * Fran?oise Simonot Lion (LORIA, France)
    * Oleg Sokolsky (University of Pennsylvania, USA)
    * Jing Sun (University of Auckland, New Zealand)
    * Jun Suzuki (University of Massachusetts, Boston, USA)
    * Martin T?rngren (Royal Institute of Technology, Sweden)
    * Laurence Tratt (Bornmouth University, United Kingdom)
    * Tatsuhiro Tsuchiya (Osaka University, Japan)
    * Naoyasu Ubayashi (Kyushu Institute of Technology, Japan)
    * Stefan Van Baelen (Catholic University of Leuven, Belgium)
    * Tullio Vardanega (University of Padua, Italia)
    * Fran?ois Vernadat (CNRS-LAAS, France)
    * Eugenio Villar (Universidad de Cantabria, Spain)
    * Andr? Windisch (EADS Military Aircraft, Germany)
    * John Whittle (George Mason University, USA)
    * Sergio Yovine (CNRS-Verimag, France)






From kaleb.pederson at gmail.com  Wed Sep 30 15:24:49 2009
From: kaleb.pederson at gmail.com (Kaleb Pederson)
Date: Wed, 30 Sep 2009 15:24:49 -0700
Subject: [antlr-interest] maven-gunit-plugin not working correctly with
	cobertura
Message-ID: <f14c01620909301524o783e61f6iade6a9b23feaa8c3@mail.gmail.com>

I have maven-gunit-plugin setup and running gunit tests for my
grammar.  The tests run successfully and well, covering most of the
grammar. The coverage resulting from the tests, however, does not show
up in Cobertura and I'm not sure why.

Here's some details from my cobertura:cobertura run


#
# grammar is compiled first
#
[INFO] Preparing cobertura:cobertura
[INFO] [antlr3:antlr {execution: antlr3-maven-plugin}]
[INFO] ANTLR: Processing source directory
/home/kibab/workspace/compiler/src/main/antlr3
ANTLR Parser Generator  Version 3.1.3 Mar 17, 2009 19:23:44
com/sophware/.../AccessLanguage.g


#
# correct classes are instrumented per include/exclude statements
#
[INFO] [cobertura:instrument {execution: default-instrument}]
[INFO] Cobertura 1.9.2 - GNU GPL License (NO WARRANTY) - See COPYRIGHT file
Instrumenting 4 files to
/home/kibab/workspace/compiler/target/generated-classes/cobertura
Cobertura: Saved information on 4 classes.
Instrument time: 156ms
[INFO] Instrumentation was successful.


#
# JUnit tests are compiled
#
[INFO] [compiler:testCompile {execution: default-testCompile}]
[INFO] Compiling 4 source files to
/home/kibab/workspace/compiler/target/test-classes


#
# JUnit tests run successfully
#
Running com.sophware...ModelTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.029 sec
...
Tests run: 3, Failures: 0, Errors: 0, Skipped: 1


#
# GUnit tests run successfully and use the instrumented classes
#
[INFO] [gunit:gunit {execution: maven-gunit-plugin}]
[INFO] Adding Antlr artifact : org.antlr:antlr:jar:3.1.3
[INFO] Adding project compile classpath element :
/home/kibab/workspace/compiler/target/test-classes
[INFO] Adding project compile classpath element :
/home/kibab/workspace/compiler/target/generated-classes/cobertura
-----------------------------------------------------------
 G U N I T   R E S U L T S
-----------------------------------------------------------
Executing script
/home/kibab/workspace/compiler/src/test/gunit/AccessLanguage.testsuite
Tests run: 42,  Failures: 0,  Invalid: 0


#
# Cobertura report is generated
#
[INFO] [cobertura:cobertura {execution: default-cli}]
[INFO] Cobertura 1.9.2 - GNU GPL License (NO WARRANTY) - See COPYRIGHT file
Cobertura: Loaded information on 4 classes.
Report time: 530ms
[INFO] Cobertura Report generation was successful.

Coverage from my JUnit tests shows up, but not from GUnit.  They run
in sequence using the instrumented classes.  Any thoughts?  Is GUnit
using a separate classloader or something else that might affect it?

Thanks.

--Kaleb

