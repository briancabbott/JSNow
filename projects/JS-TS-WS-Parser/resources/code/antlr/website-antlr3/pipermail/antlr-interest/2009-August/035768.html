<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Tokens that span across char streams
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Tokens%20that%20span%20across%20char%20streams&In-Reply-To=%3Cf6be20450908261257p3d2bc252s5e222517a153cb60%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="035778.html">
   <LINK REL="Next"  HREF="035771.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Tokens that span across char streams</H1>
    <B>Stanislav Sokorac</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Tokens%20that%20span%20across%20char%20streams&In-Reply-To=%3Cf6be20450908261257p3d2bc252s5e222517a153cb60%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Tokens that span across char streams">sokorac at gmail.com
       </A><BR>
    <I>Wed Aug 26 12:57:36 PDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="035778.html">[antlr-interest] Recognizing 5-th hex digit [correction]
</A></li>
        <LI>Next message: <A HREF="035771.html">[antlr-interest] Tokens that span across char streams
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35768">[ date ]</a>
              <a href="thread.html#35768">[ thread ]</a>
              <a href="subject.html#35768">[ subject ]</a>
              <a href="author.html#35768">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I have a language that allows macros to be used just about anywhere, which
makes things a bit difficult. For example, a macro could define half a
string, and something like this is legal:

#define FOO &quot;start of a string
String a = FOO end of a string&quot;;

If I do on-the-fly substitution of macros by switching char streams (using
the include file technique from the FAQ), lexer cannot recognize the string
in the second line: it parses the macro text, encounters EOF of that stream,
throws an exception (&quot;couldn't match anything&quot;), and then start over at the
second half of the string, again not matching anything.

What's a good way to &quot;smooth over&quot; the EOF bump, and merge the streams into
one from lexer's point of view? Do I need to implement a custom CharStream
to do something like this?

Of course, I could have a pre-process run that replaces all the macros, and
then run through the resulting code, but I'd like to avoid that because (1)
it's slow to go through the file twice, and (2) the character/line numbers
in tokens will be messed up in the second run and it'll take a bit of work
to bring them back to the original locations.

Thanks,
Stan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/1e9ab462/attachment.html">http://www.antlr.org/pipermail/antlr-interest/attachments/20090826/1e9ab462/attachment.html</A> 
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="035778.html">[antlr-interest] Recognizing 5-th hex digit [correction]
</A></li>
	<LI>Next message: <A HREF="035771.html">[antlr-interest] Tokens that span across char streams
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35768">[ date ]</a>
              <a href="thread.html#35768">[ thread ]</a>
              <a href="subject.html#35768">[ subject ]</a>
              <a href="author.html#35768">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
