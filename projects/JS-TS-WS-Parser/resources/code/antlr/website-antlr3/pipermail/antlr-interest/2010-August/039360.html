<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] &quot;Return via Exception Technique&quot; and VS2010
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20%22Return%20via%20Exception%20Technique%22%20and%20VS2010&In-Reply-To=%3C80A5CDD2686EA042AE41C526324D44558EF2CC3B2F%40EXCHANGE2007.signmgmt.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="039364.html">
   <LINK REL="Next"  HREF="039366.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] &quot;Return via Exception Technique&quot; and VS2010</H1>
    <B>Kevin Carroll</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20%22Return%20via%20Exception%20Technique%22%20and%20VS2010&In-Reply-To=%3C80A5CDD2686EA042AE41C526324D44558EF2CC3B2F%40EXCHANGE2007.signmgmt.local%3E"
       TITLE="[antlr-interest] &quot;Return via Exception Technique&quot; and VS2010">kcarroll at signmgmt.com
       </A><BR>
    <I>Sun Aug  8 08:10:03 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="039364.html">[antlr-interest] Building a tree grammar expression to recognize arithmetic expressions
</A></li>
        <LI>Next message: <A HREF="039366.html">[antlr-interest] &quot;Return via Exception Technique&quot; and VS2010
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39360">[ date ]</a>
              <a href="thread.html#39360">[ thread ]</a>
              <a href="subject.html#39360">[ subject ]</a>
              <a href="author.html#39360">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm having a problem that hopefully someone on this list can shed some light on.

I've implemented a tree-based interpreter in C# on .Net for a DSL using ANTLR.  I've used Terrence Parr's &quot;Language Implementation Patterns&quot; book for guidance.  In his chapter on tree-based interpreters, he used a technique for returning from a method call which involved wrapping the code that calls the method in a try-catch block, throwing an exception that contains the return value as the return mechanism, and catching the exception to retrieve the return value.  He states that &quot;This mechanism isn't slow if we share the same exception object.  Only creating exceptions is expensive; throwing them is no big deal.&quot;  I implemented the technique for my return mechanism.

This technique seems to work great, and it runs acceptably fast if NOT running inside the VS2010 debugger.  However, if the same DSL script is run IN the debugger, the performance drags to a crawl.  The same script can literally run 100-1000 times slower in the debugger vs. out of the debugger.

I'm only going on a hunch (and another programmer who works with me agrees), but things seem to be pointing to the exception throw-catch situation as the culprit.

Another variable involved is that my interpreter makes extensive use of .Net 4.0's new DynamicObject.  I'm not using ExpressionTree's for my AST (yet), but some of the AST node execution methods use the DLR.

Does anyone have any insight into what might be going on, or any suggestions on ways to check what might be causing the problems?

I would appreciate any and all input.

Thanks,
Kevin Carroll
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="039364.html">[antlr-interest] Building a tree grammar expression to recognize arithmetic expressions
</A></li>
	<LI>Next message: <A HREF="039366.html">[antlr-interest] &quot;Return via Exception Technique&quot; and VS2010
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39360">[ date ]</a>
              <a href="thread.html#39360">[ thread ]</a>
              <a href="subject.html#39360">[ subject ]</a>
              <a href="author.html#39360">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
