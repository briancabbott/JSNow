<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] C Runtime Multiple Serial Tree Walkers - What can be freed when?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20C%20Runtime%20Multiple%20Serial%20Tree%20Walkers%20-%20What%0A%20can%20be%20freed%20when%3F&In-Reply-To=%3Cc5f2edfe8f3f536c87ad9b29b4899a04%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="040564.html">
   <LINK REL="Next"  HREF="040567.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can be freed when?</H1>
    <B>Jim Idle</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20C%20Runtime%20Multiple%20Serial%20Tree%20Walkers%20-%20What%0A%20can%20be%20freed%20when%3F&In-Reply-To=%3Cc5f2edfe8f3f536c87ad9b29b4899a04%40mail.gmail.com%3E"
       TITLE="[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can be freed when?">jimi at temporal-wave.com
       </A><BR>
    <I>Tue Jan 18 15:15:15 PST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="040564.html">[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can	be freed when?
</A></li>
        <LI>Next message: <A HREF="040567.html">[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can be freed when?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40565">[ date ]</a>
              <a href="thread.html#40565">[ thread ]</a>
              <a href="subject.html#40565">[ subject ]</a>
              <a href="author.html#40565">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The rewrites do not [always] duplicate the nodes, they change the pointers
and so on. Hence you need to keep all the stuff around. It is not as
inefficient as you think and it is keeping pointers to the input source
and so on too, so you must keep it all around until you have finished
using it. Just tear it all down and rerun it when ready to do the codegen.
It won't take anytime at all to do that.

Jim

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest-bounces at antlr.org</A> [mailto:antlr-interest-
</I>&gt;<i> <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">bounces at antlr.org</A>] On Behalf Of Karim Chichakly
</I>&gt;<i> Sent: Tuesday, January 18, 2011 3:07 PM
</I>&gt;<i> To: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">antlr-interest at antlr.org</A> interest
</I>&gt;<i> Subject: [antlr-interest] C Runtime Multiple Serial Tree Walkers - What
</I>&gt;<i> can be freed when?
</I>&gt;<i>
</I>&gt;<i> I am using the C runtime.  I have a lexer and a parser.  Then I run a
</I>&gt;<i> constant expression reduction tree walker, which rewrites some nodes
</I>&gt;<i> (rewrite = false).  Then I run a semantic analysis tree walker, which
</I>&gt;<i> also rewrites some nodes (rewrite = false).  Then, at a much later time
</I>&gt;<i> determined by the user, I run a code generation tree walker.  I have to
</I>&gt;<i> keep the final tree (from the semantic analyzer) around as long as the
</I>&gt;<i> program is running, which could be hours.
</I>&gt;<i>
</I>&gt;<i> The C runtime example that does something similar, polydiff, keeps all
</I>&gt;<i> of the separate node streams and all of the intermediate trees around
</I>&gt;<i> until it no longer needs the final tree.  The Java version keeps
</I>&gt;<i> overwriting the nodes variable (which holds the node stream), so
</I>&gt;<i> presumably that is getting freed before the start of each tree walker
</I>&gt;<i> pass.  But also it keeps all the intermediate trees.
</I>&gt;<i>
</I>&gt;<i> If I try to free the first tree generated by the parser after running
</I>&gt;<i> the first tree walker (which gives me a different tree), the program
</I>&gt;<i> crashes on the free.  If I try to free the node stream, the tree
</I>&gt;<i> becomes invalid and I crash the next time I try to access it.
</I>&gt;<i>
</I>&gt;<i> I don't honestly have to keep all intermediate tree results and node
</I>&gt;<i> streams around forever, do I?  What can I safely get rid of and when?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Karim
</I>&gt;<i>
</I>&gt;<i> List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
</I>&gt;<i> Unsubscribe: <A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-">http://www.antlr.org/mailman/options/antlr-interest/your-</A>
</I>&gt;<i> email-address
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="040564.html">[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can	be freed when?
</A></li>
	<LI>Next message: <A HREF="040567.html">[antlr-interest] C Runtime Multiple Serial Tree Walkers - What can be freed when?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#40565">[ date ]</a>
              <a href="thread.html#40565">[ thread ]</a>
              <a href="subject.html#40565">[ subject ]</a>
              <a href="author.html#40565">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
