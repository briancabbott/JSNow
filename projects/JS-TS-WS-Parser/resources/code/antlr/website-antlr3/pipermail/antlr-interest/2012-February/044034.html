<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Tree Grammars,	Complex Data and StringTemplateGroups
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Tree%20Grammars%2C%0A%09Complex%20Data%20and%20StringTemplateGroups&In-Reply-To=%3C20120207120820.256360%40gmx.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="044033.html">
   <LINK REL="Next"  HREF="044041.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Tree Grammars,	Complex Data and StringTemplateGroups</H1>
    <B>Roland Braito</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Tree%20Grammars%2C%0A%09Complex%20Data%20and%20StringTemplateGroups&In-Reply-To=%3C20120207120820.256360%40gmx.net%3E"
       TITLE="[antlr-interest] Tree Grammars,	Complex Data and StringTemplateGroups">r.b.lists at gmx.net
       </A><BR>
    <I>Tue Feb  7 04:08:20 PST 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="044033.html">[antlr-interest] Tree grammar rule attributes
</A></li>
        <LI>Next message: <A HREF="044041.html">[antlr-interest] Not Matching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44034">[ date ]</a>
              <a href="thread.html#44034">[ thread ]</a>
              <a href="subject.html#44034">[ subject ]</a>
              <a href="author.html#44034">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello all,

Sorry if this was answered before, but i didn't find an answer yet...

Short version:

am using antlr 3.3.jar and the packaged version of ST

i want to build a retargetable code generator.

using the pattern of  DSL to AST to output via StringTemplate

i am having severe problems getting the AST to StringTemplate mapping to 

work

Is there a way to build such a thing with more than one level of nesting in lists without traversing the AST by hand?

Long version:

I follow the usual pattern of parsing a DSL into an AST and am now 

trying to feed that AST to a tree grammar.

Since i have to create multiple very diverse output files form the 

single input tree, i was planning to create a StringTemplateGroup file 

for every output language needed.

The AST is deeply nested and has repeating elements at various levels 

(think Object hierarchy)

I have one &quot;interface&quot; template called all(a1,a2,a3,a4) which takes 

several lists of objects and then calls the various templates needed for 

the language from the group files.

(e.g. sql.stg, java.stg,...)

I do not want to have any template definitions in the tree walker.

The problem is with grammar constructs like:

list_of_list 
	:	^( LIST1 list2+ ) 
	;

list2	:	^( L2 another_list+ element+)
	;

another_list
	:	^( AL bla)
	;

bla	:	ID
	;

element	:	ID
	; 

i want to give the list_of_lists to the StringTemplateGroup, since the 

hierarchy encodes valuable information, which i want to map to something like

header ::=&lt;&lt;
&lt;list_of_lists:process_l2()&gt;
&gt;&gt;<i>
</I>
process_l2() ::=&lt;&lt;
&lt;another_list:etc()&gt; &lt;element; separator=&quot;, &quot;&gt;
&gt;&gt;<i>
</I>
and so on.

how do i map the repeating elements to the templates in the group file?

Things i tried:

^( LIST1 l+=list2+ ) -&gt; template(list={l})&quot;&quot;

gives emtpy results ( empty template because i dont want to have any 

definitions in the grammar, but probably the &quot;&quot; interferes with the stg)


defining a return value and setting it via 

^( LIST1 l+=list2+ ) {$list=$l}

antlr generates code like

	if (list_p==null) list_p=new ArrayList();
    	list_p.add(p.getTemplate());

but the template would itself be a list of templates or at least objects

I tried to define the templates manually in {} and in -&gt;{} and assign 

them attributes manually, but i cant seem to access those in the stg 

file.

The only thing which almost worked was to define helper classes in the 

grammar, fill them up via {} code in the rules and pass those object 

trees to the StringTemplateGroup. 

But this failed at populating the object lists, since the code to add 
another instance was generated by antlr to be out of the loop traversing the tree nodes and thus only got the last element of repeating sub-trees ( another_list+).

Is there a way to build such a thing with more than one level of nesting in lists without traversing the AST by hand?

Thanks for any help!
</PRE>




















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="044033.html">[antlr-interest] Tree grammar rule attributes
</A></li>
	<LI>Next message: <A HREF="044041.html">[antlr-interest] Not Matching
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#44034">[ date ]</a>
              <a href="thread.html#44034">[ thread ]</a>
              <a href="subject.html#44034">[ subject ]</a>
              <a href="author.html#44034">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
