<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Re: Line numbers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Re%3A%20Line%20numbers&In-Reply-To=C8B0B2010780F1439E5DAB4FF7DFFFD9010D915C%40za-exchange.za.mosaicsoftware.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002667.html">
   <LINK REL="Next"  HREF="002673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Re: Line numbers</H1>
    <B>micheal_jor &lt;open.zone at virgin.net&gt;</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20Re%3A%20Line%20numbers&In-Reply-To=C8B0B2010780F1439E5DAB4FF7DFFFD9010D915C%40za-exchange.za.mosaicsoftware.net"
       TITLE="[antlr-interest] Re: Line numbers">open.zone at virgin.net
       </A><BR>
    <I>Mon Jan 20 01:44:13 PST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="002667.html">[antlr-interest] Line numbers
</A></li>
        <LI>Next message: <A HREF="002673.html">[antlr-interest] Line numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2668">[ date ]</a>
              <a href="thread.html#2668">[ thread ]</a>
              <a href="subject.html#2668">[ subject ]</a>
              <a href="author.html#2668">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
&gt;<i> The AST generated by the parser however do not include the line and 
</I>column number for the token it represents. I need that information to 
customize run-time error messages, i.e. include line numbers.
&gt;<i> 
</I>&gt;<i> Has anybody got an (simple) example of how I could do that - extend 
</I>the .g file to make it include line numbers in the AST class? I 
believe I'll have to extend the AST class, which is fine.

With the latest version of ANTLR, generated Lexers already track line 
and column information and they are preserved in Token objects. They 
can be accessible via getColumn() and getLine() in Token objects.

The Lexers also track File information intenally but that info isn't 
transferred to Tokens automatically. If you want to track line, 
column and file information and transfer them to your AST, you will 
need to:

- subclass the appropriate xxxToken class
  a. add a string member for filename (or add File/FileInfo fields)
  b. add accessor/mutator for the field (or use a C# property)

- override nextToken()/makeToken() in yourLexer using code like 
(example is for C#):
     protected internal override Token makeToken(int t)
     {
        YourToken newToken = (YourToken) base.makeToken(t);
        if (newToken != Token.batToken)
           newToken.setFilename(getFilename());
     }
  This could be added to your *.g grammar file.
- subclass the appropriate xxxAST class
  a. add fields (and related accessors/mutators) for line, column and 
file info
  b. override initialize(Token tok) to transfer the tracked info from 
the Token to your AST

I have literally just type this from memory but I think it does 
outline what needs to be done. Other ANTLR veterans would be able to 
advice you on which of nextToken() or makeToken() should be 
overridden in this instance - my gut feeling says nextToken().

Cheers,

Micheal


 

Your use of Yahoo! Groups is subject to <A HREF="http://docs.yahoo.com/info/terms/">http://docs.yahoo.com/info/terms/</A> 

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002667.html">[antlr-interest] Line numbers
</A></li>
	<LI>Next message: <A HREF="002673.html">[antlr-interest] Line numbers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2668">[ date ]</a>
              <a href="thread.html#2668">[ thread ]</a>
              <a href="subject.html#2668">[ subject ]</a>
              <a href="author.html#2668">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
