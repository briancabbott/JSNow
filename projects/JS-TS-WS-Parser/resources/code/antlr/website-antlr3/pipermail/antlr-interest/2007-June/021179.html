<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Why doesn't this work?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Why%20doesn%27t%20this%20work%3F&In-Reply-To=%3Cebc876d70706062104n7f02ed63t75e410e44df3d1db%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021178.html">
   <LINK REL="Next"  HREF="021192.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Why doesn't this work?</H1>
    <B>Thomas Brandon</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Why%20doesn%27t%20this%20work%3F&In-Reply-To=%3Cebc876d70706062104n7f02ed63t75e410e44df3d1db%40mail.gmail.com%3E"
       TITLE="[antlr-interest] Why doesn't this work?">tbrandonau at gmail.com
       </A><BR>
    <I>Wed Jun  6 21:04:23 PDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="021178.html">[antlr-interest] Why doesn't this work?
</A></li>
        <LI>Next message: <A HREF="021192.html">[antlr-interest] Why doesn't this work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21179">[ date ]</a>
              <a href="thread.html#21179">[ thread ]</a>
              <a href="subject.html#21179">[ subject ]</a>
              <a href="author.html#21179">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>All lexing occurs before parsing. &quot;UW&quot; is being matched by the IDENTIFIER
rule rather than the 'U' and 'W' rules generated by the parser literals. I
think because Antlr will prefer a longer match this cannot be fixed with
precedence (putting the 'U' and 'W' rules above IDENTIFIER, which I think
they already should be), &quot;100.W&quot; will correctly parse as then the higher
precedence of the 'W' rule allows it to win out over the IDENTIFIER rule
(meaning according to this grammar &quot;U&quot;, &quot;W&quot; etc cannot be used as
identifiers).  Assuming that &quot;UW&quot; is a valid identifier (and so can't be
excluded from IDENTIFIER) you might need to make your size_qualifier rule
deal with IDENTIFIERs and use predicates to test the text. Something like:
size_qualifier:
    '.' {LT(1).text == &quot;UW&quot; || LT(1).text == &quot;W&quot;}? IDENTIFIER -&gt; SIZE_16
;
Though I'm not sure of the exact syntax there.
Or you could exclude the size quantifiers from IDENTIFIER and then have a
rule including them in you parser. Something like:
size_qualifier:
'.' ('U'|'UW') -&gt; SIZE_16
;
identifier:
    (IDENTIFIER|'U'|'UW')
    ;
Now 'UW' should win out over IDENTIFIER and in your parser you can use
identifier rather than IDENTIFIER to also match &quot;U&quot; and &quot;UW&quot;.

Tom.

On 6/7/07, Cameron Esfahani &lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">dirty at apple.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> I've spent a few hours trying to figure out why this test grammar doesn't
</I>&gt;<i> work.  If I use ANTLRWorks to debug it, starting at rule &quot;number_size&quot;, with
</I>&gt;<i> an input of 100.UW, I end up getting a NoViableAltException error.
</I>&gt;<i> If I remove the IDENTIFIER rule, it seems to work.
</I>&gt;<i>
</I>&gt;<i> And, if I add a space to the input (100.U W), then it seems to work as
</I>&gt;<i> well.  Obviously I don't want that to work, 100.U W shouldn't be legal.
</I>&gt;<i> Why is it allowing it?
</I>&gt;<i>
</I>&gt;<i> I can't wrap my head around it, but it seems like the UW portion of the
</I>&gt;<i> input isn't matching to size_qualifier, it's matching to IDENTIFIER?  That
</I>&gt;<i> can't be right, as IDENTIFIER doesn't contain a period character.
</I>&gt;<i>
</I>&gt;<i> grammar Test;
</I>&gt;<i>
</I>&gt;<i> options {
</I>&gt;<i> output = AST;
</I>&gt;<i> ASTLabelType = CommonTree;
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> tokens {
</I>&gt;<i> SIZE_DEFAULT;
</I>&gt;<i> SIZE_8;
</I>&gt;<i> SIZE_16;
</I>&gt;<i> SIZE_32;
</I>&gt;<i> SIZE_64;
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i> size_qualifier
</I>&gt;<i> : '.' ('U')? ('B') -&gt; SIZE_8
</I>&gt;<i> | '.' ('U')? ('W') -&gt; SIZE_16
</I>&gt;<i> | '.' ('U')? ('L') -&gt; SIZE_32
</I>&gt;<i> | '.' ('U')? ('Q') -&gt; SIZE_64
</I>&gt;<i> ;
</I>&gt;<i>
</I>&gt;<i> number_size
</I>&gt;<i> : NUMBER size_qualifier -&gt; size_qualifier NUMBER
</I>&gt;<i> | NUMBER -&gt; SIZE_DEFAULT NUMBER
</I>&gt;<i> ;
</I>&gt;<i>
</I>&gt;<i> NUMBER
</I>&gt;<i> : '-'? ( '0' | '1'..'9' '0'..'9'*)
</I>&gt;<i> ;
</I>&gt;<i>
</I>&gt;<i> fragment LETTER
</I>&gt;<i> : 'a'..'z'
</I>&gt;<i> | 'A'..'Z'
</I>&gt;<i> ;
</I>&gt;<i>
</I>&gt;<i> IDENTIFIER
</I>&gt;<i> : LETTER ( LETTER | '-' | '_' | '0'..'9' )*
</I>&gt;<i> ;
</I>&gt;<i>
</I>&gt;<i> Cameron Esfahani
</I>&gt;<i> <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">dirty at apple.com</A>
</I>&gt;<i>
</I>&gt;<i> &quot;In the elder days of Art, Builders wrought with greatest care each minute
</I>&gt;<i> and unseen part; For the gods see everywhere.&quot;
</I>&gt;<i>
</I>&gt;<i> &quot;The Builders&quot;, H. W. Longfellow
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://www.antlr.org/pipermail/antlr-interest/attachments/20070607/ed259815/attachment-0001.html">http://www.antlr.org/pipermail/antlr-interest/attachments/20070607/ed259815/attachment-0001.html</A> 
</PRE>


























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021178.html">[antlr-interest] Why doesn't this work?
</A></li>
	<LI>Next message: <A HREF="021192.html">[antlr-interest] Why doesn't this work?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21179">[ date ]</a>
              <a href="thread.html#21179">[ thread ]</a>
              <a href="subject.html#21179">[ subject ]</a>
              <a href="author.html#21179">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
