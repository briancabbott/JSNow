<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] FEATURE REQUEST: continued and memory/speed
	issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20FEATURE%20REQUEST%3A%20continued%20and%20memory/speed%0A%09issues&In-Reply-To=20041230075419.77667.qmail%40web54707.mail.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="010821.html">
   <LINK REL="Next"  HREF="010833.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] FEATURE REQUEST: continued and memory/speed
	issues</H1>
    <B>Ric Klaren</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=%5Bantlr-interest%5D%20FEATURE%20REQUEST%3A%20continued%20and%20memory/speed%0A%09issues&In-Reply-To=20041230075419.77667.qmail%40web54707.mail.yahoo.com"
       TITLE="[antlr-interest] FEATURE REQUEST: continued and memory/speed
	issues">ric.klaren at gmail.com
       </A><BR>
    <I>Thu Dec 30 07:04:46 PST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="010821.html">[antlr-interest] FEATURE REQUEST: continued and memory/speed
	issues
</A></li>
        <LI>Next message: <A HREF="010833.html">[antlr-interest] FEATURE REQUEST: continued and memory/speedissues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10827">[ date ]</a>
              <a href="thread.html#10827">[ thread ]</a>
              <a href="subject.html#10827">[ subject ]</a>
              <a href="author.html#10827">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 29 Dec 2004 23:54:19 -0800 (PST), Akhilesh Mritunjai
&lt;<A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">virtualaspirin at yahoo.com</A>&gt; wrote:
&gt;<i> Infact a lot of methods will need to be made virtual.
</I>&gt;<i> For our project we needed a custom AST class with
</I>&gt;<i> parent pointer. The standard method of making a custom
</I>&gt;<i> factory class failed due to lack of virtual functions
</I>&gt;<i> and now we are doing special dirty work in
</I>&gt;<i> setNextSibling(), setFirstChild() functions of the
</I>&gt;<i> custom AST class.
</I>
Being a bit more specific might be helpfull. The ASTFacotry does a lot
of non factory stuff like tree building basically I can make
everything virtual and provide all the rope to potentially hang
yourself ;) I guess I'll do that when I'm back at my  home...

&gt;<i> Additionally, I'd request you to make tokenNames and
</I>&gt;<i> getTokenName variable/method in generated parser file
</I>&gt;<i> as static (like in java code). Right now there is no
</I>&gt;<i> way to access these methods without instantiating the
</I>&gt;<i> parser (and lexer and zillion things), which seems a
</I>&gt;<i> little painful for printing out just a token name in a
</I>&gt;<i> debug statements.
</I>
Ack good you remind me. Had this request before but forgot about it.
Bit of a hectic time at the moment for me so I don't have too much
'antlr-time'. I'll see if I can change that for 2.7.5 if changes are
too big I'll probably make the changes for 2.7.6 in that case keep an
eye on snapshot releases to see when it's added (and remind me if
necessary)

&gt;<i> I'd second the request for moving most functions in
</I>&gt;<i> header files for better inlining. We have made a good
</I>&gt;<i> big grammar file and generated both Java and C++
</I>&gt;<i> parser from it. On an 8 MB input file, the Java parser
</I>&gt;<i> consumed about __33%__LESS__ memory (Java 217 MB / C++
</I>&gt;<i>  372 MB, figures include JVM size, taken straight from
</I>&gt;<i> /proc/&lt;PID&gt;/status/VmSize) and is TWICE as fast (Java
</I>&gt;<i> 33.4 sec, C++ 68 sec). Compilers used were :
</I>&gt;<i> * Java : Sun JDK 1.5 for RH linux 9.0
</I>&gt;<i> * C++ : GNU gcc 3.4.3 for RH linux 9.0.
</I>&gt;<i>   Flags used : -O3 -fexceptions -ffast-math
</I>&gt;<i> -march=pentium4 -fexpensive-optimizations
</I>
Using more inlining might probably increase the memory footprint.
Results in the past have shown that it really depends on the grammar
wether Java/C++ performs better (at least in the past it was like
that) The C++ version has performace issues (but so has the java one)
It would take really structural changes to improve things. Inlining
changes usually are usually low priority for me. If you can tell me
which specific ones are the main problems I'll change them. (I'm low
on time so the more specific you are the easier and faster I can make
changes. I don't go on 'random' change sprees short before a release)

Tinkering with optimization options might give some gain (-O3
-fexpensive-optimiaztions etc. might not be optimal for your case)
Real gains for C++ can be gotten by using flex as lexer but that also
depends on your grammar.

Cheers,

Ric
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="010821.html">[antlr-interest] FEATURE REQUEST: continued and memory/speed
	issues
</A></li>
	<LI>Next message: <A HREF="010833.html">[antlr-interest] FEATURE REQUEST: continued and memory/speedissues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10827">[ date ]</a>
              <a href="thread.html#10827">[ thread ]</a>
              <a href="subject.html#10827">[ subject ]</a>
              <a href="author.html#10827">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
