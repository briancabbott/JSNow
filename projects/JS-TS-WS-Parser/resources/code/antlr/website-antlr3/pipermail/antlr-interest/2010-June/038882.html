<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [antlr-interest] Comments, EOF, and Debugger
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Comments%2C%20EOF%2C%20and%20Debugger&In-Reply-To=%3C4C0560A9.5020209%40junkwallah.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="038881.html">
   <LINK REL="Next"  HREF="038879.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[antlr-interest] Comments, EOF, and Debugger</H1>
    <B>Junkman</B> 
    <A HREF="mailto:antlr-interest%40antlr.org?Subject=Re:%20%5Bantlr-interest%5D%20Comments%2C%20EOF%2C%20and%20Debugger&In-Reply-To=%3C4C0560A9.5020209%40junkwallah.org%3E"
       TITLE="[antlr-interest] Comments, EOF, and Debugger">j at junkwallah.org
       </A><BR>
    <I>Tue Jun  1 12:34:01 PDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="038881.html">[antlr-interest] Comments, EOF, and Debugger
</A></li>
        <LI>Next message: <A HREF="038879.html">[antlr-interest] Comments, EOF, and Debugger
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38882">[ date ]</a>
              <a href="thread.html#38882">[ thread ]</a>
              <a href="subject.html#38882">[ subject ]</a>
              <a href="author.html#38882">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Disclaimer:  I'm a noob.  :)

Taking the newline out of comment seems to work, like this:

COMMENT	: '#' (~( '\r' | '\n' ))* ;
NEWLINE : '\r'? '\n'
          {
	      // kick it off to the hidden channel
              // $channel=HIDDEN;

              // or skip it altogether
              // skip();

          }
          ;

Last line comment terminating in EOF presents no problem.

I've seen this pattern for comment in other examples.

Don't know how/why debuggerLexer changes the outcome, but I assume you
can always trace the generated lexers to see how the different outcomes
result.

J

Nathan Eloe wrote:
&gt;<i> 
</I>&gt;<i> On Jun 1, 2010, at 1:33 PM, <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">anteusz at freemail.hu</A> wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> 6/1/2010 3:33 PM keltez&#233;ssel, Nathan Eloe &#237;rta:
</I>&gt;&gt;&gt;<i> -----BEGIN PGP SIGNED MESSAGE-----
</I>&gt;&gt;&gt;<i> Hash: SHA1
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hello all,
</I>&gt;&gt;&gt;<i> I'm working on an AST parser for the Bash language and I've come across the following strange behavior:
</I>&gt;&gt;&gt;<i> I'm trying to handle comments, so I used the comments token you can get when you start a new grammar in ANTLRworks.  It works.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> COMMENT
</I>&gt;&gt;&gt;<i>     :   '#' ~('\n'|'\r')* '\r'? '\n' {$channel=HIDDEN;}
</I>&gt;&gt;&gt;<i>     ;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The problem arises when the comment is the last thing from the input (i.e, no new line before EOF).  Removing the '\n' from the token causes it to freak out when I run the tests, but I can't get it to match comments at the end of file.  Leaving that '\n' in lets the code compile, but I still can't match that last case.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Here's where the interesting part happens.  When I run it through the debugger with the same test case that I use in gunit, the debugger allows the input and parses it correctly (meaning, it ignores it as it should) and correctly generates the expected AST.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Does the debugger allow the code to be more robust in its decision making abilities?  Or does it do something to the input to allow it to be matched to a token.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks for the help!
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Nathan
</I>&gt;&gt;&gt;<i> 
</I>

List: <A HREF="http://www.antlr.org/mailman/listinfo/antlr-interest">http://www.antlr.org/mailman/listinfo/antlr-interest</A>
Unsubscribe:
<A HREF="http://www.antlr.org/mailman/options/antlr-interest/your-email-address">http://www.antlr.org/mailman/options/antlr-interest/your-email-address</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="038881.html">[antlr-interest] Comments, EOF, and Debugger
</A></li>
	<LI>Next message: <A HREF="038879.html">[antlr-interest] Comments, EOF, and Debugger
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#38882">[ date ]</a>
              <a href="thread.html#38882">[ thread ]</a>
              <a href="subject.html#38882">[ subject ]</a>
              <a href="author.html#38882">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://www.antlr.org/mailman/listinfo/antlr-interest">More information about the antlr-interest
mailing list</a><br>
</body></html>
