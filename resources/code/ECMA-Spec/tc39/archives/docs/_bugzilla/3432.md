---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3432,"creation_ts":"2014-12-10 04:54:00 -0800","short_desc":"Accessing `RegExp.prototype.global` etc. directly must not throw to match existing implementations","delta_ts":"2015-07-10 08:35:03 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 29: December 06, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"INVALID","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"mathias","name":"Mathias Bynens"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["andrebargull","dslomov","erik.arvidsson","mathias"],"long_desc":[{"commentid":10980,"comment_count":0,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2014-12-10 04:54:36 -0800","thetext":"The `RegExp.prototype.global` getter algorithm in 21.2.5.4 contains:\n\n    3. If R does not have an [[OriginalFlags]] internal slot throw a TypeError exception.\n\nThis means that the following code should throw, since `R = RegExp.prototype` in that case, and `RegExp.prototype` does not have [[OriginalFlags]] internal slot:\n\n    RegExp.prototype.global\n\nHowever, none of the existing major ECMAScript engines seem to implement this, and instead return `false`.\n\nThe same goes for the following other getters on `RegExp.prototype`: `ignoreCase`, `multiline`, `sticky`, and `unicode` (although that last one is not implemented anywhere yet).\n\nPlease consider removing this step from those algorithms to match existing implementations."},{"commentid":10981,"comment_count":1,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2014-12-10 04:56:25 -0800","thetext":"Note that this also (indirectly) affects whether accessing `RegExp.prototype.flags` directly throws or returns `''`."},{"commentid":10983,"comment_count":2,"who":{"uid":"andrebargull","name":"AndrÃ© Bargull"},"bug_when":"2014-12-10 07:28:40 -0800","thetext":"I don't see how this is any different from `RegExp.prototype.exec()` throwing a TypeError in ES6, whereas in ES5 (= major ECMAScript engines) it returns `[\"\"]`. Adding special case code in everyplace to handle this breaking change is non-constructive (IMHO), simply going back to specify that RegExp.prototype is RegExp object almost seems to be the better choice... \n\nThe same issue applies to Date.prototype, Array.prototype, String.prototype etc."},{"commentid":10984,"comment_count":3,"who":{"uid":"arv","name":"Erik Arvidsson"},"bug_when":"2014-12-10 07:59:59 -0800","thetext":"When we decided to make RegExp.prototype a non RegExp instance we talked about these edge cases and IIRC then these new exceptions are what we want."},{"commentid":10987,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-10 16:12:44 -0800","thetext":"(In reply to Erik Arvidsson from comment #3)\n> When we decided to make RegExp.prototype a non RegExp instance we talked\n> about these edge cases and IIRC then these new exceptions are what we want.\n\nRight, the only places we have reverted from this approach has been situations where we could actually identify code in the wild that depended upon the prototypes of legacy built-ins behaving as actual instances.\n\nMathias are you aware of any such situations WRT RegExp.prototype?"},{"commentid":11004,"comment_count":5,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2014-12-10 23:14:50 -0800","thetext":"(In reply to Allen Wirfs-Brock from comment #4)\n> (In reply to Erik Arvidsson from comment #3)\n> > When we decided to make RegExp.prototype a non RegExp instance we talked\n> > about these edge cases and IIRC then these new exceptions are what we want.\n> \n> Right, the only places we have reverted from this approach has been\n> situations where we could actually identify code in the wild that depended\n> upon the prototypes of legacy built-ins behaving as actual instances.\n> \n> Mathias are you aware of any such situations WRT RegExp.prototype?\n\nNo."},{"commentid":12203,"comment_count":6,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-06 17:58:48 -0800","thetext":"closing as invalid\n\nThe current spec. reflects what TC39 discussed"}]}}
---
