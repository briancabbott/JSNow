---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3689,"creation_ts":"2015-01-29 16:48:00 -0800","short_desc":"ArraySetLength step 17.c should be strengthened to an assertion.","delta_ts":"2015-02-02 18:38:49 -0800","product":"Draft for 6th Edition","component":"editorial issue","version":"Rev 31: January 15, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"jorendorff","name":"Jason Orendorff"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"andrebargull","long_desc":[{"commentid":11754,"comment_count":0,"who":{"uid":"jorendorff","name":"Jason Orendorff"},"bug_when":"2015-01-29 16:48:48 -0800","thetext":"Step 17 is the loop that deletes elements from the array if the \"length\" property is being decreased.\n\n    17. While newLen < oldLen repeat,\n        a.  Set oldLen to oldLen – 1.\n        b.  Let deleteSucceeded be the result of calling the [[Delete]]\n            internal method of A passing ToString(oldLen).\n        c.  ReturnIfAbrupt(succeeded).\n        d.  If deleteSucceeded is false, then \n            i.-v. (...cleanup steps...)\n\nIt would be bad if we actually bailed out on step 17.c., because the cleanup steps would be skipped. The array could be left in violation of the array length invariant.\n\nFortunately, that can't happen: [[Delete]] on an Array object never terminates abruptly.\n\nAsserting that fact would be clearer than silently relying on it."},{"commentid":11755,"comment_count":1,"who":{"uid":"jorendorff","name":"Jason Orendorff"},"bug_when":"2015-01-29 16:57:33 -0800","thetext":"I think 17.d.iv. is also infallible and we can even assert that the return value is true."},{"commentid":11792,"comment_count":2,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-01-31 08:27:52 -0800","thetext":"Steps 7 and 15 are also infallible."},{"commentid":11808,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-01-31 13:50:03 -0800","thetext":"fixed in rev32 editor's draft"},{"commentid":11927,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-02 18:38:49 -0800","thetext":"fixed in rev32 draft"}]}}
---
