---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":2019,"creation_ts":"2013-10-01 02:32:00 -0700","short_desc":"19.1.2.1: Symbol type not handled in Object constructor","delta_ts":"2013-10-29 09:45:28 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 19: September 27, 2013 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":5754,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-10-01 02:32:45 -0700","thetext":"Same as bug 1546.\n\n19.1.2.1 new Object ( [ value ] )\n\nSymbol primitive type not handled in step 1.\n\nMaybe just update 19.1.2.1 to call OrdinaryConstruct() to use the proper realm, currently `var foreignObject = otherRealm.Object; new foreignObject()` creates an object of the current execution context's realm instead of otherRealm."},{"commentid":5811,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-02 16:17:31 -0700","thetext":"Why do you say that about the real of the new object?\n\nAll object creations done by a built-in function are supposed to be in the same realm as the built-in unless the spec. explicitly says otherwise."},{"commentid":5813,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-02 16:19:12 -0700","thetext":"fixed in Rev20 editor's draft\n\nnew Object(aSymbol) now does ToObject(aSymbol)"},{"commentid":5830,"comment_count":3,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-10-03 01:03:09 -0700","thetext":"This is my current understanding:\n- ToObject() creates an object based on the current realm\n- The current realm is determined by the top frame element of the ExecutionContext stack\n- [[Call]] for ordinary functions push a new frame on the ExecutionContext stack\n- So does [[Call]] for built-in functions (already spec'ed or TBD?)\n- [[Construct]] does not push a new element on the execution stack\n- But [[Construct]] may call [[Call]] which will create a new ExecutionContext\n- [[Construct]] for \"19.1 Object\" is not updated to the new scheme where [[Construct]] just calls OrdinaryConstruct()\n\n=> That means `new foreignObject()` does not push a new frame on the ExecutionContext stack, so the new object will be of the current execution context's realm instead of otherRealm."},{"commentid":5838,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-03 20:09:19 -0700","thetext":"(In reply to comment #3)\n> This is my current understanding:\n> - ToObject() creates an object based on the current realm\n> - The current realm is determined by the top frame element of the\n> ExecutionContext stack\n> - [[Call]] for ordinary functions push a new frame on the ExecutionContext\n> stack\n> - So does [[Call]] for built-in functions (already spec'ed or TBD?)\n\nThis is my intent, although I think there is some additional spec. work that is need to make this clear.\n\n> - [[Construct]] does not push a new element on the execution stack\n> - But [[Construct]] may call [[Call]] which will create a new ExecutionContext\n> - [[Construct]] for \"19.1 Object\" is not updated to the new scheme where\n> [[Construct]] just calls OrdinaryConstruct()\n\nAh, I see.  Yes, that still needs to be cleaned up. \n\n> \n> => That means `new foreignObject()` does not push a new frame on the\n> ExecutionContext stack, so the new object will be of the current execution\n> context's realm instead of otherRealm.\n\nyes, it shouldn't do that."},{"commentid":6074,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-29 09:45:28 -0700","thetext":"fixed in rev20 draft, Oct. 28, 2013"}]}}
---
