---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3577,"creation_ts":"2015-01-20 04:35:00 -0800","short_desc":"7.3.19 SpeciesConstructor, 9.4.2.3 ArraySpeciesCreate: inconsistency in the handling of originalObj.constructor === null","delta_ts":"2015-02-12 12:17:39 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 31: January 15, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"claude.pache","name":"Claude Pache"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":11559,"comment_count":0,"who":{"uid":"claude.pache","name":"Claude Pache"},"bug_when":"2015-01-20 04:35:43 -0800","thetext":"7.3.19 SpeciesConstructor\nReturns the default constructor in the following cases:\n(a) originalObj.constructor is undefined,\n(c) originalObj.constructor[@@species] is undefined or null.\n\n9.4.2.3 ArraySpeciesCreate\nUses the default constructor in the following cases:\n(a) originalObj.constructor is undefined or null,\n(b) originalObj.constructor is a constructor from a different realm,\n(c) originalObj.constructor[@@species] is undefined or null.\n\nThere is an inconsistency between the two abstract operations in item (a) above.\n\nAccording to Bug 3524, the editor didn't want to add `null` in the case of SpeciesConstructor. In that case, we should consider removing `null` in the case of ArraySpeciesCreate.\n\nProposed patch: In the algorithm of ArraySpeciesCreate:\n* Add step 4.d.iii: If C is null, let C be undefined.\n* Change step 5: If C is undefined, return ArrayCreate(length)."},{"commentid":11562,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-01-20 10:07:25 -0800","thetext":"fixed in rev32 editor's draft"},{"commentid":11974,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-02 18:38:55 -0800","thetext":"fixed in rev32 draft"},{"commentid":12087,"comment_count":3,"who":{"uid":"claude.pache","name":"Claude Pache"},"bug_when":"2015-02-03 23:19:58 -0800","thetext":"Only partially fixed: Now, in 9.4.2.3 ArraySpeciesCreate, when originalObj.constructor[@@species] is null, a TypeError will be thrown (contrarily to 7.3.19 SpeciesConstructor). [I guess I should've made explicit the implicit \"and\" between the two bullets at the end of Comment 0.]\n\n* In 9.4.2.3 ArraySpeciesCreate, add step 4.d.iii: If C is null, let C be undefined.\n\n(Alternatively, see Bug 3725 for the opposite change in 7.3.19 SpeciesConstructor.)"},{"commentid":12291,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-10 13:22:54 -0800","thetext":"fixed in rev33 editor's draft"},{"commentid":12434,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-12 12:17:39 -0800","thetext":"fixed in rev33"}]}}
---
