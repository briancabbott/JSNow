---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4342,"creation_ts":"2015-04-29 09:55:00 -0700","short_desc":"20.3.4.35 Date.prototype.toDateString, 20.3.4.42 Date.prototype.toTimeString: Handle [[DateValue]] = NaN  ?","delta_ts":"2015-05-19 10:21:00 -0700","product":"Draft for 7th Edition","component":"Deferred from 6th edition","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"CONFIRMED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":14343,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-04-29 09:55:51 -0700","thetext":"20.3.4.35 Date.prototype.toDateString ( )\n20.3.4.42 Date.prototype.toTimeString ( )\n\n20.3.4.41.1 Runtime Semantics: ToDateString(tv) returns \"Invalid Date\" for NaN values, but 20.3.4.35 and 20.3.4.42 don't handle this case."},{"commentid":14366,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-04-29 18:02:08 -0700","thetext":"I think this is one we can let go until ES7.\n\nTC39 explicitly decided to specify \"Invalid Date\" for toString.  But I don't recall whether we also explicitly  talked about toDateString and toTimeString.  I suspect we didn't and that is the reason they weren't updated.\n\nBecause their result is implementation defined, an implementation can do this if it wants to.\n\nHave you test the behavior on the major browsers?"},{"commentid":14367,"comment_count":2,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-04-30 07:58:12 -0700","thetext":"new Date(NaN).toDateString() and new Date(NaN).toTimeString() return \"Invalid Date\" in:\n- IE11, Win7-de-DE\n- Edge, Win10-en-US-build10074\n- V8 (see below for source info)\n- JavaScriptCode (see below for source info)\n- Nashorn (see below for source info)\n- SpiderMonkey (see below for source info)\n\n\nI've also tested 20.3.4.43 Date.prototype.toUTCString ( ):\nnew Date(NaN).toUTCString() returns \"Invalid Date\" in all tested engines, except for Nashorn. Nashorn throws a RangeError.\n\n\n\nV8\ntoDateString: https://github.com/v8/v8-git-mirror/blob/cf420ec337e47bed2c754d4ebdc87e8d1bb3cfe5/src/date.js#L304\n\ntoTimeString: https://github.com/v8/v8-git-mirror/blob/cf420ec337e47bed2c754d4ebdc87e8d1bb3cfe5/src/date.js#L312\n\ntoUTCString: https://github.com/v8/v8-git-mirror/blob/cf420ec337e47bed2c754d4ebdc87e8d1bb3cfe5/src/date.js#L634\n\nConstant \"kInvalidDate\": https://github.com/v8/v8-git-mirror/blob/cf420ec337e47bed2c754d4ebdc87e8d1bb3cfe5/src/macros.py#L57\n\n\n\nJavaScriptCode\ntoDateString: https://github.com/WebKit/webkit/blob/0f0b75cd1fe1c64499b65e64b4ee15d015b733f4/Source/JavaScriptCore/runtime/DatePrototype.cpp#L549\n\ntoTimeString: https://github.com/WebKit/webkit/blob/0f0b75cd1fe1c64499b65e64b4ee15d015b733f4/Source/JavaScriptCore/runtime/DatePrototype.cpp#L555\n\ntoUTCString: https://github.com/WebKit/webkit/blob/0f0b75cd1fe1c64499b65e64b4ee15d015b733f4/Source/JavaScriptCore/runtime/DatePrototype.cpp#L509\n\nFormat function \"formateDateInstance\": https://github.com/WebKit/webkit/blob/0f0b75cd1fe1c64499b65e64b4ee15d015b733f4/Source/JavaScriptCore/runtime/DatePrototype.cpp#L332\n\n\n\nNashorn\ntoDateString: http://hg.openjdk.java.net/jdk9/dev/nashorn/file/b275aac76cdd/src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/objects/NativeDate.java#l281\n\ntoTimeString: http://hg.openjdk.java.net/jdk9/dev/nashorn/file/b275aac76cdd/src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/objects/NativeDate.java#l292\n\ntoUTCString: http://hg.openjdk.java.net/jdk9/dev/nashorn/file/b275aac76cdd/src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/objects/NativeDate.java#l819\nhttp://hg.openjdk.java.net/jdk9/dev/nashorn/file/b275aac76cdd/src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/objects/NativeDate.java#l1015\n\nFormat function \"toStringImpl\": http://hg.openjdk.java.net/jdk9/dev/nashorn/file/b275aac76cdd/src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/objects/NativeDate.java#l988\n\nConstant \"INVALID_DATE\": http://hg.openjdk.java.net/jdk9/dev/nashorn/file/b275aac76cdd/src/jdk.scripting.nashorn/share/classes/jdk/nashorn/internal/objects/NativeDate.java#l59\n\n\n\nSpiderMonkey\ntoDateString: http://hg.mozilla.org/mozilla-central/file/4b9b12c248dc/js/src/jsdate.cpp#l2824\n\ntoTimeString: http://hg.mozilla.org/mozilla-central/file/4b9b12c248dc/js/src/jsdate.cpp#l2811\n\ntoUTCString: http://hg.mozilla.org/mozilla-central/file/4b9b12c248dc/js/src/jsdate.cpp#l2402\n\nFormat function \"format_date\": http://hg.mozilla.org/mozilla-central/file/4b9b12c248dc/js/src/jsdate.cpp#l2534\n\nConstant \"js_NAN_date_str\": http://hg.mozilla.org/mozilla-central/file/4b9b12c248dc/js/src/jsdate.cpp#l2345"},{"commentid":14419,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-05-19 10:21:00 -0700","thetext":"defer to ES7"}]}}
---
