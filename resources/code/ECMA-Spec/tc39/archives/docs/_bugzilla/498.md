---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":498,"creation_ts":"2012-07-11 12:35:00 -0700","short_desc":"String.endsWith and String.startsWith will have unexpected behavior when used with a regular expression","delta_ts":"2013-12-23 00:29:00 -0800","product":"Draft for 6th Edition","component":"new feature","version":"Rev 9: July 8, 2012 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"ianb","name":"Ian Bicking"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["jorendorff","mathias","steves_list"],"long_desc":[{"commentid":1271,"comment_count":0,"who":{"uid":"ianb","name":"Ian Bicking"},"bug_when":"2012-07-11 12:35:32 -0700","thetext":"Regular expressions can be used in place of strings for many string methods.  But consider startsWith/endsWith:\n\n  \"foo\".startsWith(/f/)    // => false\n  \"/a/b/c\".startsWith(/a/) // => true\n\nA developer who is confused about these methods won't get any real feedback.  No type error, and though it will not match as they intended it will largely appear to work.\n\nOne option would be:\n\n  String.prototype.startsWith = function (pattern) {\n    if (typeof pattern == \"object\" && pattern.constructor == RegExp) {\n      return this.search(pattern == 0)\n    }\n    return this.indexOf(pattern) == 0;\n  };\n\nbut endsWith is harder:\n\n  String.prototype.endsWith = function (pattern) {\n    if (typeof pattern == \"object\" && pattern.constructor == RegExp) {\n      var newReg = new RegExp(pattern.source + '$');\n      return newReg.test(this);\n    }\n    ...\n  }\n\nNot sure if mucking about with the regex is kosher.\n\nString.prototype.contains has the same issue I suppose."},{"commentid":1273,"comment_count":1,"who":{"uid":"jorendorff","name":"Jason Orendorff"},"bug_when":"2012-07-11 16:38:44 -0700","thetext":">      var newReg = new RegExp(pattern.source + '$');\n\nNit: This wouldn't work if pattern is a disjunction, like /a|b/.\n\nI'm not sure, but maybe\n    new RegExp('(?:' + pattern.source + ')$')\nwould be correct.\n\nI think supporting regexps here is an excellent idea."},{"commentid":1306,"comment_count":2,"who":{"uid":"steves_list","name":"Steven Levithan"},"bug_when":"2012-07-13 11:23:02 -0700","thetext":"Agree that supporting regular expressions would be nice. But, as already highlighted, endsWith might be a concern. Mainly I'm commenting to point out that Jason's modification of Ian's code still wouldn't work, since it doesn't account for RegExp flags. You can't simply add the flags and make it work, either, because /m changes the meaning of the $ anchor."},{"commentid":5995,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-26 18:05:43 -0700","thetext":"fixed in rev20 editor's draft\n\nDefined endWidth and startsWith as throwing if first argument is a RegExp.  This allows for a adding RegExp support in a future editions."},{"commentid":6118,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-29 09:45:59 -0700","thetext":"fixed in rev20 draft, Oct. 28, 2013"},{"commentid":6956,"comment_count":5,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2013-12-23 00:29:00 -0800","thetext":"Seems `String.prototype.contains` was forgotten about during the fix. See bug 2407."}]}}
---
