---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":342,"creation_ts":"2012-05-09 17:33:00 -0700","short_desc":"ES5.1 should not require incorrect daylight savings treatment","delta_ts":"2015-10-03 14:41:59 -0700","product":"ECMA-262, Editions 5 and 5.1","component":"technical content","version":"Edition 5.1","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"lukeh","name":"Luke Hoban"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"brterlso","long_desc":[{"commentid":914,"comment_count":0,"who":{"uid":"lukeh","name":"Luke Hoban"},"bug_when":"2012-05-09 17:33:02 -0700","thetext":"** Request **\nInstead of constraining timezone offset behaviour as in 15.9.1.8, the spec should leave DaylightSavingsTA implementation dependent.\n\n\n** Issue **\nThe current spec text in 15.9.1.8 allows implementations to be as wrong as they'd like about daylight savings adjustments, but constrains how correct they should try to be.  This is somewhat counterintuitive, and in practice, has not succeeded in producing consensus between browsers.\n\nFor example - here are browser results for a few dates in the US Pacific timezone:\n\nnew Date(\"4/1/2000\").getTimezoneOffset()\n\n\t\tWindows\t\t\t\t\tDebian\tMac\n\t\tIE\tCH\tFF\tOP\tSF\tNode\tNode\tCH\tFF\tSF\n4/1/2000\t420\t420\t420\t420\t420\t420\t480\t480\t480\t420\nNote that on this date Chrome, FireFox and Node are inconsistent between OSes.  Almost everyone is actually wrong though, the actual DST adjustment was 480.\n\n4/1/2028\t420\t420\t420\t420\t420\t420\t420\t420\t420\t420\nNote that on this date, everyone is consistent, and correct, but Chrome on Mac and Firefox on Mac are violating the ES5.1 spec (both 2000 and 2028 are leap years starting on a Saturday)\n\n3/10/2011\t480\t480\t480\t480\t480\t480\t480\t480\t480\t480\t\n3/10/2109\t480\t480\t480\t480\t420\t480\t480\t480\t420\t420\nNote that on this date, a few environments are again violating ES5.1 rules (these two years both start on Tuesday and are not leap years), but here there are disagreements even on a single OS (both on Windows and Mac).\n\nIn IE10, we are expecting to change our behaviour for 4/1/2000 above to be historically correct, match Chrome and Firefox on Mac and Node on Debian,  and violate the current ES5.1 spec text constraints.\n\nThe second issue is with host APIs that provide Date objects to JavaScript code.  For example - the File.lastModifiedDate from the W3C File API [1].  If the OS reports in its file browser that a file was modified on 3/31/2000 at 11PM, JavaScript will report that the file was modified on 4/1/2000 at 12AM when run on the same system.  With an increasing number of host APIs exposing access to host OS resources like filesystems, and opportunities to round trip Date objects between host APIs and JavaScript, both in browser hosts and server hosts, this disconnect will get increasingly serious for JavaScript application reliability.\n\n** Recommendation **\nI would love to be able to solve this by specifying DaylightSavingsTA more fully and requiring implementations to be more correct, but this is not a realistic option as there is no oracle of truth on timezone adjustments.  Given that browsers are already inconsistent on timezone adjustment behaviour, there is limited value in trying to prevent implementations from at least being historically correct when they can.  \n\nInstead of constraining timezone offset behaviour as in 15.9.1.8, the spec should leave DaylightSavingsTA implementation dependent.\n\n[0] http://www.w3.org/International/wiki/JavaScriptInternationalization\n[1] http://www.w3.org/TR/FileAPI/#dfn-lastModifiedDate"},{"commentid":915,"comment_count":1,"who":{"uid":"lukeh","name":"Luke Hoban"},"bug_when":"2012-05-09 17:34:02 -0700","thetext":"See also Norbert's mail response about how this relates to text in the Internationalization spec.\n\nhttps://mail.mozilla.org/pipermail/es-discuss/2012-March/020832.html"},{"commentid":14761,"comment_count":2,"who":{"uid":"brterlso","name":"Brian Terlson"},"bug_when":"2015-10-03 14:41:59 -0700","thetext":"ES2015 contains language allowing DaylightSavingsTA to be implementation dependent."}]}}
---
