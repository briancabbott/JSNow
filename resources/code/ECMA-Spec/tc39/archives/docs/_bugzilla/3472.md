---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3472,"creation_ts":"2014-12-17 13:59:00 -0800","short_desc":"19.1.3.6  Object.prototype.toString: Possible to detect proxied array objects","delta_ts":"2014-12-23 20:23:31 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 29: December 06, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["erights","erights","tomvc.be"],"long_desc":[{"commentid":11075,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-12-17 13:59:17 -0800","thetext":"19.1.3.6  Object.prototype.toString ( )  \n\nObject.prototype.toString possibly needs to use IsArray, otherwise it can be (ab-)used to detect proxied array objects, because it's not possible for proxied array objects to use the tag \"Array\".\n\n\n\n\n---\njs> p = new Proxy([], {\n get(t,pk,r){\n  if(pk === Symbol.toStringTag) return \"Array\";\n  return Reflect.get(t,pk,r)\n}})\n{}\njs> Array.isArray(p)\ntrue\njs> Object.prototype.toString.call(p)\n\"[object ~Array]\"\n---"},{"commentid":11079,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-17 16:34:32 -0800","thetext":"Mark/Tom are you ok if we make this change?  I don't really like it, as it allows a Proxy that expose no array behavior to still claim to be a built-in Array. But give that we agreed to make Array.isArray work in this manner I don't see why we wouldn't also do it for O.p.toString."},{"commentid":11091,"comment_count":2,"who":{"uid":"erights","name":"Mark Miller"},"bug_when":"2014-12-17 20:11:03 -0800","thetext":"Yes, I think that is the most consistent thing to do."},{"commentid":11106,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-18 09:06:41 -0800","thetext":"fixed in rev30 editor's draft"},{"commentid":11127,"comment_count":4,"who":{"uid":"tomvc.be","name":"Tom Van Cutsem"},"bug_when":"2014-12-21 11:13:25 -0800","thetext":"+1"},{"commentid":11197,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-23 20:23:31 -0800","thetext":"fixed in rev30"}]}}
---
