---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3507,"creation_ts":"2015-01-02 07:38:00 -0800","short_desc":"21.1.3.* GetMethod usage","delta_ts":"2015-01-02 10:20:24 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 30: December 24, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"INVALID","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"toshok","name":"Chris Toshok"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"andrebargull","long_desc":[{"commentid":11293,"comment_count":0,"who":{"uid":"toshok","name":"Chris Toshok"},"bug_when":"2015-01-02 07:38:49 -0800","thetext":"While implementing the new versions of the String.prototype methods, I found I had to diverge from the specified algorithm slightly.\n\nAll of these methods use the following opening (but using String.p.replace as an example):\n\nString.prototype.replace (searchValue, replaceValue )\n 1. Let O be RequireObjectCoercible(this value).\n 2. Let string be ToString(O).\n 3. ReturnIfAbrupt(string).\n 4. Let replacer be GetMethod(searchValue, @@replace).\n 5. ReturnIfAbrupt(replacer).\n 6. If replacer is not undefined, then\n    a. Return Call(replacer, searchValue, «string, replaceValue»).\n\n\nGetMethod is being called on searchValue without first checking if searchValue is Type Object.  This fails (crash on ejs) when the first arg to .replace is a primitive string.\n\nWorking backward from my code yields this algorithm fragment:\n\nString.prototype.replace (searchValue, replaceValue )\n 1. Let O be RequireObjectCoercible(this value).\n 2. Let string be ToString(O).\n 3. ReturnIfAbrupt(string).\n 4. Let replacer be undefined\n 5. if Type(searchValue) is Object\n    a. Let replacer be GetMethod(searchValue, @@replace).\n    b. ReturnIfAbrupt(replacer).\n 6. If replacer is not undefined, then\n    a. Return Call(replacer, searchValue, «string, replaceValue»).\n\nAm I missing some behavior of GetMethod (or something it calls?)"},{"commentid":11294,"comment_count":1,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-01-02 08:03:15 -0800","thetext":"GetMethod was changed in rev30, it's now using GetV instead of Get."},{"commentid":11295,"comment_count":2,"who":{"uid":"toshok","name":"Chris Toshok"},"bug_when":"2015-01-02 10:20:24 -0800","thetext":"(In reply to André Bargull from comment #1)\n> GetMethod was changed in rev30, it's now using GetV instead of Get.\n\nAhhh, Thanks André.  Missed that change in GetMethod."}]}}
---
