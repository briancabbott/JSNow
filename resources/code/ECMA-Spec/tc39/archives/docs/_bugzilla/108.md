---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":108,"creation_ts":"2011-06-09 11:07:00 -0700","short_desc":"Missing coverage? http://code.google.com/p/google-caja/issues/detail?id=1362","delta_ts":"2012-02-29 09:08:35 -0800","product":"Test262","component":"ECMA-262 Tests","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"dfugate","name":"Dave Fugate"},"assigned_to":{"uid":"dfugate","name":"Dave Fugate"},"long_desc":[{"commentid":231,"comment_count":0,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2011-06-09 11:07:14 -0700","thetext":"<Thanks>Mark Miller</Thanks>\n\nWe might be missing coverage for the following test scenario.  Add test case(s)\nassuming this scenario can be mapped to ES5.1 somewhere\n--------------------------------------------------------------------------\n*See\nhttp://codereview.appspot.com/4547070/diff/6003/src/com/google/caja/ses/es5shim.js?context=10&column_width=80\nfor the original*\n\n/**\n\n\n191 * Workaround for http://code.google.com/p/google-caja/issues/detail?id=1362\n\n192 *\n\n193 * <p>This is an unfortunate oversight in the ES5 spec: Even if\n\n194 * Date.prototype is frozen, it is still defined to be a Date, and\n\n195 * so has mutable state in internal properties that can be mutated\n\n196 * by the primordial mutation methods on Date.prototype, such as\n\n197 * {@code Date.prototype.setFullYear}.\n\n198 *\n\n199 * <p>This kludge is safety preserving.\n\n\n\n200 */\n\n201 function test_MUTABLE_DATE_PROTO() {\n\n202 try {\n\n203 Date.prototype.setFullYear(1957);\n\n204 } catch (err) {\n\n205 if (err instanceof TypeError) { return false; }\n\n206 log('New symptom: Mutating Date.prototype failed with ' + err);\n\n207 return true;\n\n208 }\n\n209 var v = Date.prototype.getFullYear();\n\n210 if (v !== v && typeof v === 'number') {\n\n211 // NaN indicates we're probably ok.\n\n212 return false;\n\n213 }\n\n214 if (v === 1957) {\n\n215 log('Date.prototype is a global communication channel. ' +\n\n216 'See http://code.google.com/p/google-caja/issues/detail?id=1362');\n\n217 } else {\n\n218 log('New symptom: Mutating Date.prototype did not throw');\n\n219 }\n\n220 return true;\n\n221 }\n\n222 //var TOLERATE_MUTABLE_DATE_PROTO = false;\n\n223 var TOLERATE_MUTABLE_DATE_PROTO = test_MUTABLE_DATE_PROTO();\n\n224"},{"commentid":554,"comment_count":1,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-01-10 10:33:14 -0800","thetext":"IETC has some very limited testing for this in the form of Date.prototype.toISOString:\n  E:\\262\\test262\\test\\suite\\ch15\\15.9\\15.9.5\\15.9.5.43\\15.9.5.43-0-16.js(23): * @description Date.prototype.toISOString - when this is a String object that value format is 'YYYY-MM-DDTHH:mm:ss.sssZ' Date.prototype.toISOString throw the TypeError\n  E:\\262\\test262\\test\\suite\\ch15\\15.9\\15.9.5\\15.9.5.43\\15.9.5.43-0-16.js(34):            return ex instanceof TypeError;\n  E:\\262\\test262\\test\\suite\\ch15\\15.9\\15.9.5\\15.9.5.43\\15.9.5.43-0-6.js(23): * @description Date.prototype.toISOString - TypeError is thrown when this is any other objects instead of Date object\n  E:\\262\\test262\\test\\suite\\ch15\\15.9\\15.9.5\\15.9.5.43\\15.9.5.43-0-6.js(33):            return ex instanceof TypeError;\n  E:\\262\\test262\\test\\suite\\ch15\\15.9\\15.9.5\\15.9.5.43\\15.9.5.43-0-7.js(23): * @description Date.prototype.toISOString - TypeError is thrown when this is any primitive values\n  E:\\262\\test262\\test\\suite\\ch15\\15.9\\15.9.5\\15.9.5.43\\15.9.5.43-0-7.js(33):            return ex instanceof TypeError;\n\nI think we can do a bit better than this though, and will extend the coverage shortly."},{"commentid":555,"comment_count":2,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-01-10 12:11:12 -0800","thetext":"*will add test files under TestCases\\ch15\\15.9\\15.9.5\\15.9.5.40*"},{"commentid":710,"comment_count":3,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-02-29 09:08:35 -0800","thetext":"Tests are now live on test262.ecmascript.org."}]}}
---
