---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3696,"creation_ts":"2015-01-30 16:37:00 -0800","short_desc":"22.2.3.22.2%TypedArray%.prototype.set: Add constructor parameter to CloneArrayBuffer ?","delta_ts":"2015-02-02 18:39:06 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 31: January 15, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":11766,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-01-30 16:37:31 -0800","thetext":"22.2.3.22.2%TypedArray%.prototype.set(typedArray [, offset ] )\n\nThe temporary buffer allocation in 24.a can trigger possible side-effects. Since the temporary buffer is only required to properly explain the intended semantics, unnecessary side-effects should be minimized. (The temporary buffer isn't even always necessary, for example when overlapping regions of the same buffer are used. But it's easier to explain the algorithm using a copy - implementations can figure out when it's safe to omit that copy.) \n\nProposal: Add an optional `bufferConstructor` parameter to 24.1.1.4 CloneArrayBuffer and set that optional parameter to %ArrayBuffer% in 22.2.3.22.2%TypedArray%.prototype.set. \n\n\n22.2.3.22.2%TypedArray%.prototype.set(typedArray [, offset ] )\n---\n24.a  Let srcBuffer be CloneArrayBuffer(srcBuffer, srcByteOffset, %ArrayBuffer%).\n---\n\n\n24.1.1.4 CloneArrayBuffer( srcBuffer, srcByteOffset )\n---\n1.  Assert: ...\n2.  If bufferConstructor is not present, then\n  a.  Let bufferConstructor be SpeciesConstructor(srcBuffer, %ArrayBuffer%).\n  b.  ReturnIfAbrupt(bufferConstructor).\n  c.  If IsDetachedBuffer(srcBuffer) is true, throw a TypeError exception.\n3.  Else,\n  a.  Assert: IsConstructor(bufferConstructor) is true.\n---"},{"commentid":11881,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-02 11:18:44 -0800","thetext":"fixed in rev32 editor's draft"},{"commentid":12048,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-02 18:39:06 -0800","thetext":"fixed in rev32 draft"}]}}
---
