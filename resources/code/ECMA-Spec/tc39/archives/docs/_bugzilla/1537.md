---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1537,"creation_ts":"2013-05-31 03:16:00 -0700","short_desc":"8.3.15.6: FunctionInitialize should set internal properties after user-modifiable properties","delta_ts":"2013-07-15 17:03:55 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 15: May 14, 2013 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":4116,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-05-31 03:16:54 -0700","thetext":"FunctionInitialize does not take into account that \"length\", \"caller\" or \"arguments\" may be already present on the function object. To avoid undefined behaviour or for example strict-mode functions without poisoned \"caller\" properties etc., I'd suggest to:\n\n(1) Make steps 12-13 the initial steps of FunctionInitialize\n(2) Change [[DefineOwnProperty]] to DefinePropertyOrThrow()\n\nThis is similar to the String constructor which sets internal properties after user-modifiable properties. \n\n\n\nTest case for strict-mode function object without poisoned \"caller\" property:\n\n$ ./src/main/bin/repl.sh --strict\njs> class Fn extends Function{ constructor(){} }\njs> f = new Fn(), Object.defineProperty(f, \"caller\", {value: null})\nfunction F() { /* source not available */ }\njs> Function.call(f, \"'use strict'\")\nfunction anonymous () {\n'use strict'\n}\njs> Object.getOwnPropertyDescriptor(f, \"caller\")\n{value:null,writable:false,enumerable:false,configurable:false}"},{"commentid":4274,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-06-21 13:59:46 -0700","thetext":"fixed in rev 16 editor's draft"},{"commentid":4459,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-07-15 17:03:55 -0700","thetext":"fixed in rev16 draft.  July 15, 2013"}]}}
---
