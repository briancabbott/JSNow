---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3378,"creation_ts":"2014-11-13 08:54:00 -0800","short_desc":"25.4.1.6 NewPromiseCapability: Missing steps and parameters","delta_ts":"2014-12-07 14:35:08 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 28: October 14, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"d","long_desc":[{"commentid":10627,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-11-13 08:54:38 -0800","thetext":"25.4.1.6 NewPromiseCapability ( C )\n\n- step 3: CreateFromConstructor requires two arguments, add empty List ().\n- step 5: Change to \"If promise is undefined, then let promise be AllocatePromise(C).\"\n  This change is required for the \"all.js\" and \"simple.js\" tests in [1].\n\n[1] https://github.com/domenic/promises-unwrapping/tree/master/reference-implementation/test"},{"commentid":10707,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-03 15:04:21 -0800","thetext":"fixed step 3\n\nAlso changed CreateFromConstructor so it does an OrdinaryCreateFromConstructor if a [[CreateAction]] is not found.  This means that NewPromiseCapability will create an ordinary object from the constructorif it is passed a non-native promise constructor.\n\nThat seems correct and consistent with the note.  Doing an AllocatePromise does not seem correct as it would create an object with the internal slots of a built-in promise object when the constructor apparently doesn't derive from built-in Promise.\n\nI'm not sure exactly what those tests are depending upon, but hopefully this fixes it."},{"commentid":10708,"comment_count":2,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2014-12-03 15:14:48 -0800","thetext":"The tests (and the reference implementation they test) are from a @@create era, FYI."},{"commentid":10728,"comment_count":3,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-12-04 13:07:03 -0800","thetext":"(In reply to Domenic Denicola from comment #2)\n> The tests (and the reference implementation they test) are from a @@create\n> era, FYI.\n\nAh, of course! Sorry for misleading everyone when I said AllocatePromise is necessary.\n\n(In reply to Allen Wirfs-Brock from comment #1)\n> I'm not sure exactly what those tests are depending upon, but hopefully this\n> fixes it.\n\nYes, using OrdinaryCreateFromConstructor fixes it."},{"commentid":10915,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-07 14:35:08 -0800","thetext":"fixed in rev29"}]}}
---
