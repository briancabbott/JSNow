---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4005,"creation_ts":"2015-02-18 15:11:00 -0800","short_desc":"24.2.2.1 DataView: Remove length integer validation and use ToLength ?","delta_ts":"2015-02-19 19:11:04 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 33: February 12, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":12934,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-02-18 15:11:42 -0800","thetext":"24.2.2.1 DataView (buffer [ , byteOffset [ , byteLength ] ] )\n\nSteps 12.a-d\n\nMaybe change to:\n---\nLet viewLength be ToLength(byteLength).\nReturnIfAbrupt(viewLength).\n---\n\nfor consistency with 22.2.1.4 %TypedArray% ( buffer [ , byteOffset [ , length ] ] ) steps 14.a-b ."},{"commentid":12937,"comment_count":1,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-02-18 15:16:01 -0800","thetext":"OTOH DataView performs in general more offset and length validation (cf. GetViewValue, SetViewValue, byteOffset parameter in 24.2.2.1 DataView )."},{"commentid":12945,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-18 15:41:37 -0800","thetext":"that would miss the length must be an integer test in step d"},{"commentid":12946,"comment_count":3,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-02-18 15:57:07 -0800","thetext":"I meant replacing all four steps 12.a-d with ToLength, similar to 22.2.1.4 %TypedArray% steps 14.a-b."},{"commentid":12950,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-18 16:27:16 -0800","thetext":"yes, but the RangeError checks in 12.d are a legacy requirement\n\nand it actually appears that 20.2.1.4 also requires that same error check.\n\nor maybe it doesn't.  I think what I'm observing when I test these in  browsers are the WebIDL argument validation rules being applied. And, that when we moved the typed arrays in to the ES6 spec. we decided that we would not bring along all of those checks (where aren't normally performed by other ES built-ins)\n\nRemoving an exception isn't normally considered a breaking change, so maybe the length usage is ok. I"},{"commentid":12978,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-19 11:53:05 -0800","thetext":"It looks like existing browsers are inconsistent enought here that we probably can safely change to ToLength\n\nfixed in rev34 editor's draft"},{"commentid":13110,"comment_count":6,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-19 19:11:04 -0800","thetext":"fixed in rev34"}]}}
---
