---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4368,"creation_ts":"2015-05-18 15:35:00 -0700","short_desc":"Minor cleanups for Array.prototype.indexOf","delta_ts":"2015-05-21 08:33:04 -0700","product":"Draft for 7th Edition","component":"Deferred from 6th edition","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"CONFIRMED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"d","name":"Domenic Denicola"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":14413,"comment_count":0,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2015-05-18 15:35:38 -0700","thetext":"While doing Array.prototype.includes review with implementers, the initial spec (which copied Array.prototype.indexOf) came under fire for a few redundant steps. We should make those fixes to Array.prototype.indexOf as well. Namely:\n\n> 8. If n ≥ len, return −1.\n\nThis step is redundant.\n\n> 10.a. Let k be len - abs(n).\n\nThis could be more clearly written as len + n, since n < 0 is the precondition in step 10."},{"commentid":14414,"comment_count":1,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2015-05-18 15:38:14 -0700","thetext":"Also:\n\n> 6. If argument fromIndex was passed let n be ToInteger(fromIndex); else let n be 0.\n\nThis could be written more simply (in terms of easier to translate to implementations) as\n\n> 6. Let n be ToInteger(fromIndex). (If fromIndex is undefined, this step produces the value 0).\n\nwhich is what is done in String.prototype.includes and several other places in the spec."},{"commentid":14435,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-05-21 08:33:04 -0700","thetext":"deferring for ES7 consideration.\n\nInternal spec. consistency is important. \n\nalso, it isn't obvious to me that \"len + n\" with a remote guard on the sign of n is clearer than a redundant abs in  \"len - abs(n)\""}]}}
---
