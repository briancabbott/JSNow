---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3781,"creation_ts":"2015-02-05 14:37:00 -0800","short_desc":"13.6.4.13 ForIn/OfBodyEvaluation: Perform IteratorClose in 5.a - 5.g ?","delta_ts":"2015-02-12 12:17:35 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 32: February 2, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"marc.nieper+bugzilla","long_desc":[{"commentid":12152,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-02-05 14:37:36 -0800","thetext":"13.6.4.13 Runtime Semantics: ForIn/OfBodyEvaluation\n\nThe newly added IteratorClose calls in destructuring forms, collections etc. call IteratorClose even if the iterator itself throws an exception. Contrary to that 13.6.4.13 only calls IteratorClose when an abrupt completion occurs in step 5.h-i or in 5.k.\n\nAre these differences in the semantics intentional?"},{"commentid":12284,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-10 12:01:00 -0800","thetext":"fixed in rev33 editor's draft\n\nI was being overly aggressive in classing IteratorClose.\n\nIteratorClose should not be called if the iterator has normally reached its end or for exceptions that originated from the iterator.\n\nIn particular we shouldn't call the IteratorClose for exceptions that are received via IteratorStep IteratorNext, IteratorConplete, IteratorValue\n\nI fixed Array destructuring and the built-ins to conform to this rule."},{"commentid":12395,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-12 12:17:35 -0800","thetext":"fixed in rev33"}]}}
---
