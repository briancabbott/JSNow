---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":2662,"creation_ts":"2014-04-16 10:01:00 -0700","short_desc":"21.2.5.10 Significant issues with RegExp.prototype.split","delta_ts":"2014-12-07 14:35:06 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 23: April 5, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","see_also":"https://bugs.ecmascript.org/show_bug.cgi?id=3149","priority":"Normal","bug_severity":"major","everconfirmed":true,"reporter":{"uid":"allen","name":"Allen Wirfs-Brock"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"claude.pache","long_desc":[{"commentid":7750,"comment_count":0,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-04-16 10:01:38 -0700","thetext":"The algorithm  as currently written does not correctly deal with full unicode regular expressions.  In particular it needs to translate endIndex values from from code point offsets to code units offsets as is done by RegExpBuiltinExec (RegExpExec in rev23).\n\nMore generally, the algorithm is not usable by subclass that over-ride exec to change the matching semantics. This algorithm is the last place that the RegExp matcher is directly used without going through exec."},{"commentid":9861,"comment_count":1,"who":{"uid":"claude.pache","name":"Claude Pache"},"bug_when":"2014-08-25 05:51:34 -0700","thetext":"> More generally, the algorithm is not usable by subclass that over-ride exec\n> to change the matching semantics. This algorithm is the last place that the\n> RegExp matcher is directly used without going through exec.\n\nAn issue I see here is, if one want to use `exec`, one should run it as if the global flag is set to true, and the sticky flag is set to false.\n\nIn order to work around the state of the global flag, one can run the `exec` method against a substring of the original string. That is, whenever it is said:\n\n    Let z be the result of calling the matcher with arguments S and q.\n\none can say, approximatively:\n\n    Let T = S.substring(q).\n    Let rx.lastIndex = 0.\n    Let result = rx.exec(T).\n\nMoreover, if the sticky flag is on, one can add additional logic in order to try to match at positions q+1, q+2, etc. in case of failure."},{"commentid":9863,"comment_count":2,"who":{"uid":"claude.pache","name":"Claude Pache"},"bug_when":"2014-08-25 06:17:44 -0700","thetext":"(In reply to Claude Pache from comment #1)\nI've just realised that RegExpBuiltinExec (Section 21.2.5.2.2) uses Get(..) in order to obtain the value of the global and sticky flags, instead of taking the original values stored in [[OriginalFlags]]. Instead of the workaround of Comment #1, one could try to play with the values of these properties. However there is currently no natural manner to do it."},{"commentid":10641,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-11-16 10:39:59 -0800","thetext":"fixed in rev29 editor's draft.\n\nThe algorithm now uses 'exec' instead of directly calling the matcher procedure. However, to preserve the legacy observable side-effects (of lack of) on the this RegExp a 'exec' is applied to a clone of this value."},{"commentid":10899,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-07 14:35:06 -0800","thetext":"fixed in rev29"}]}}
---
