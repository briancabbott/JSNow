---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4332,"creation_ts":"2015-04-22 15:14:00 -0700","short_desc":"Problem with string padding algorithm","delta_ts":"2015-10-02 14:36:13 -0700","product":"Harmony","component":"strawmen","version":"Initial draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"INVALID","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"ecmascript","name":"Richard"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["dherman","ecmascript","kgrandon","waldron.rick"],"long_desc":[{"commentid":14319,"comment_count":0,"who":{"uid":"ecmascript","name":"Richard"},"bug_when":"2015-04-22 15:14:01 -0700","thetext":"The current specification for lpad/rpad at http://wiki.ecmascript.org/doku.php?id=strawman:string_padding have problems. I'm assuming the algorithm is untested.\n\n(for this post I'm going to just be referring to lpad, but the same issues exist for rpad)\n\nAn example implementation: https://jsfiddle.net/e3ceyupt/1/\n\nThere are at least two issues with the current specification. \n\n1) The operators for step 5 are switched:\nFor the lpad function to even be used, the length of the string must be less than the \"minimum length\". Thus, `S.length` will always be smaller than `intMinLength`, so at step 5 `fillLen = S.length - intMinLength` will always yield a value less than 0, which will then fail on step 6.\n\n2) The specification assumes that the string for which lpad is call will always need to be padded. (That is: it assumes S.length < minLength)\nA counter usage example: if I have a variable length string variable, and I want to guarantee that it's at least N characters, I should be able use `strVar.lpad(N)`. If the variable length is already >= N, then the lpad should be a no-op. Currently, the specification will throw a RangeError.\nThere is precedent for allowing lpad to be a no-op: python's \"\".ljust will return the original string in this case.\n\nI propose the following changes be made:\n- After step 4, add a step: \"If intMinLength < 0, then throw a RangeError exception\"\n- Change step 5 to be \"Let fillLen be intMinLength minus the number of characters in S\"\n- Change step 6 to be \"if fillLen <= 0, then return S\""},{"commentid":14320,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-04-22 15:42:45 -0700","thetext":"added champions to CC list"},{"commentid":14321,"comment_count":2,"who":{"uid":"waldron.rick","name":"Rick Waldron"},"bug_when":"2015-04-22 17:06:11 -0700","thetext":"Seems good, thanks for the report!"},{"commentid":14738,"comment_count":3,"who":{"uid":"brterlso","name":"Brian Terlson"},"bug_when":"2015-10-02 14:36:13 -0700","thetext":"Bulk closing all Harmony bugs. Proposals should be tracked on GitHub. The ES wiki is completely defunct at this point."}]}}
---
