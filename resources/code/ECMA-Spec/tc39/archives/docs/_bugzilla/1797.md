---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1797,"creation_ts":"2013-08-22 02:40:00 -0700","short_desc":"8.3.16.10: Attach [[Construct]] when allocating function objects?","delta_ts":"2014-07-19 18:43:59 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 16: July 15, 2013 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":4998,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-08-22 02:40:23 -0700","thetext":"The way 8.3.16.10 MakeConstructor() currently works makes it possible to access uninitialised function objects before [[Construct]] was attached. This seems quite unfortunate, maybe it's possible to refactor that part of the specification to ensure no user code runs before [[Construct]] is added. \n\n\nHere's a simple test case to demonstrate this issue:\n\nclass F extends Function {\n  constructor(...args){\n    this.boundNoConstruct = this.bind(null);\n    super(...args);\n    this.boundConstruct = this.bind(null);\n  }\n}\n\nf = new F(\"return []\");\nnew f; // works, [[Construct]] present\nnew f.boundConstruct; // works, [[Construct]] present\nnew f.boundNoConstruct; // throws TypeError: object is not a constructor"},{"commentid":9230,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-07-16 18:32:09 -0700","thetext":"fixed in rev26 editor's draft.\n\nConstructor functions now get their [[Construct]] internal method when they are allocated."},{"commentid":9394,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-07-19 18:43:59 -0700","thetext":"fixed in rev26"}]}}
---
