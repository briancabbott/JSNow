---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":415,"creation_ts":"2012-06-24 08:06:00 -0700","short_desc":"ArrayCreate should use the default [[DefineOwnProperty]] internal method instead of Array's","delta_ts":"2012-09-28 12:57:17 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 8: June 15, 2012 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"utatane.tea","name":"Yusuke Suzuki"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"waldron.rick","long_desc":[{"commentid":1056,"comment_count":0,"who":{"uid":"utatane.tea","name":"Yusuke Suzuki"},"bug_when":"2012-06-24 08:06:21 -0700","thetext":"See https://mail.mozilla.org/pipermail/es-discuss/2012-June/023694.html\n\n\nIn 15.4 ArrayCreate algorithm step 7, we use [[DefineOwnProperty]] of A.\n\n> Call the [[DefineOwnProperty]] internal method of A with arguments\n> \"length\", Property Desciptor {[[Value]]: length, [[Writable]]: true,\n> [[Enumerable]]: false, [[Configurable]]: false}, and false.\n\n\nArrayCreate set A's [[DefineOwnProperty]] to 15.4.5.1 method in step 4, so\nstep 7 calls 15.4.5.1 Array's [[DefineOwnProperty]].\n\nArray's [[DefineOwnProperty]] assumes that 'length' property is always set.\nSeeing 15.4.5.1 step 1\n\n> Let oldLenDesc be the result of calling the [[GetOwnProperty]] internal\n> method of A passing \"length\" as the argument. The result will never be\n> undefined or an accessor descriptor because Array objects are created with\n> a length data property that cannot be deleted or reconfigured.\n\n\nBut, in ArrayCreate phase (step 7), A's 'length' property is not set yet.\nThen assertion in 15.4.5.1 step 1 always fails.\n\nSo we should use the default [[DefineOwnProperty]] internal method instead\nof Array's.\nI suggest modifying ArrayCreate step 7,\n\nCall the default [[DefineOwnProperty]] internal method (8.12.9) on A with\narguments \"length\", Property Desciptor {[[Value]]: length, [[Writable]]:\ntrue, [[Enumerable]]: false, [[Configurable]]: false}, and false."},{"commentid":1182,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2012-07-08 15:45:26 -0700","thetext":"fixed in editor's draft"},{"commentid":1776,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2012-09-28 12:57:17 -0700","thetext":"fixed in rev10, Sept. 27 2012 draft"}]}}
---
