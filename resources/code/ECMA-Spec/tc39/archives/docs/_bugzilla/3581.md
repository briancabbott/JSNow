---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3581,"creation_ts":"2015-01-21 01:13:00 -0800","short_desc":"7.1.4 ToInteger(-0.2) does not clearly produce -0 according to the algorithm","delta_ts":"2015-02-02 18:38:56 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 31: January 15, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","blocked":3582,"everconfirmed":true,"reporter":{"uid":"claude.pache","name":"Claude Pache"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":11571,"comment_count":0,"who":{"uid":"claude.pache","name":"Claude Pache"},"bug_when":"2015-01-21 01:13:43 -0800","thetext":"Step 5 of the ToInteger abstract operation reads:\n\n5. Return the result of computing sign(number) × floor(abs(number)).\n\n--\n\nFirst interpretation: × is a mathematical operator:\n\nsign, floor, and abs, as well as the multiplication, operate on mathematical finite real number (according to 5.2 Algorithm Conventions), where +0 = -0 = 0. Thus, when number = -0.2, the output of the mathematical expression is simply 0. \n\nThen, there is an implicit operation in this step, which is \"taking the Number value of the result\"; and for 0, it is +0.\n\n--\n\nSecond interpretation: × is part of the representation of a Number value as\ns × m × 2^e:\n\nIn that interpretation the result is correct; but the fact that the m × 2^e part is expressed as a result of a mathematical expression and the use of \"computing\" in that step don't favor that interpretation.\n\n--\n\nIt should be made clear both the fact we return a Number value (rather than a mathematical number), and (more importantly) that the sign is preserved even if the result is zero. For example:\n\n5. Return the Number value of same sign as number and of magnitude floor(abs(number)).\n\n--\n\n(There is a similar issues for ToInt32, etc.; I'm opening another bug for those.)"},{"commentid":11601,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-01-22 16:01:43 -0800","thetext":"Oh, this is very old text, probably going all the way back to ES1\n\nIt actually isn't obvious to me that that the intent was to return -0 for ToInteger(-0.2) as I think your first interpretation is quite plausable .\n\nAlso, based upon a quick can of all usages to ToInteger (especially the ones that date to ES3 or earlier) it isn't clear that anything in the spec. is actually sensitive to whether 0 or -1 is returned for the this case.\n\nHowever, given that it is clearly returning number values (including -0) in other cases, I think it is probably correct to assume that ToInteger(-0.2) should return -0 \n\nso, fixed in rev32 editor's draft"},{"commentid":11986,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-02 18:38:56 -0800","thetext":"fixed in rev32 draft"}]}}
---
