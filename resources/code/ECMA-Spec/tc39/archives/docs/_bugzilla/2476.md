---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":2476,"creation_ts":"2014-01-28 07:38:00 -0800","short_desc":"9.2.13 CloneMethod: CloneMethod should also copy properties to the new function","delta_ts":"2014-04-06 11:29:58 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 22: January 20, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":7141,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-01-28 07:38:47 -0800","thetext":"9.2.13  CloneMethod(function, newHome, newName):\n\nStep 4 only copies the internal slots and internal methods to the new function object, but properties are currently not defined as an internal slot, so it should be made more explicit that the new function also receives the properties from the original function. \n\nOr alternatively 9.1 needs to be changed to define properties as an internal slot."},{"commentid":7149,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-01-28 08:24:15 -0800","thetext":"toMethod intentionally does not copy properties.  It is intended to be a primitive building block and that an additional function layer would deal with copying properties.\n\nThe main concern is that properties may themselves be functions with super bindings and hence the cloning/copying needs to be recursively applied.\n\nWe'll discuss this further at the Jan. 2014 TC39 meeting."},{"commentid":7150,"comment_count":2,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-01-28 08:27:19 -0800","thetext":"If properties should not copied, there still needs to be some additional code to call 9.2.8 AddRestrictedFunctionProperties() to prevent .caller and .arguments access for strict functions. And most importantly the value of the [[Extensible]] internal slot must not be copied over the new function object."},{"commentid":7305,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-02-14 12:21:20 -0800","thetext":"fixed in rev23 editor's draft\n\nSpecified that it must work for exotic built-in functions\nset [[Extensible]] true\nAdds restricted properties for Strict functions."},{"commentid":7539,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-04-06 11:29:58 -0700","thetext":"fixed in rev23 draft"}]}}
---
