---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3142,"creation_ts":"2014-08-19 05:38:00 -0700","short_desc":"22.1.3.24 Array.prototype.sort: Missing \"implementation defined\" exceptions","delta_ts":"2014-08-25 08:29:26 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 26: July 18, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":9807,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-08-19 05:38:03 -0700","thetext":"22.1.3.24 Array.prototype.sort (comparefn)\n\nThere are still some missing exceptions to trigger \"implementation defined\" behaviour (but see also bug 3089 why the term \"implementation defined\" is considered to be too broad).\n\n\n(1) consistent comparison function\n> Calling comparefn(a,b) does not modify obj.\n\nThis exception needs to be changed to \"Does neither modify obj nor any object in obj's prototype chain\". \n\nReason:\nThe initial list of exceptions when implementation defined behaviour is acceptable (before \"Otherwise, the following steps are taken\") checks for indexed properties on obj's prototype chain (\"The result of HasProperty(proto, ToString(j )) is true\"). But this check is only performed once in the beginning. So it's still necessary to handle the case needs when comparefn invalidates this assumption. \n\n\n(2) Side-effects when invoking ToString in SortCompare\n\nThe two ToString calls in steps 18 and 20 may modify obj or an object in obj' prototype chain. If that happens, implementation defined behaviour needs to be accepted.\n\n\n(3) Dynamic results for ToString in SortCompare\n\nThe two ToString calls in step 18 and 20 are currently not required to produce consistent results. This makes the built-in lexicographical order less restrictive compared to when an explicit comparator function is supplied.\n\n\n(4) Sort on proxy objects\n\nFor the same reason that currently accessor or non-writable/non-configurable properties trigger implementation defined behaviour, applying Array.prototype.sort on a proxy object (or if a proxy object is present in the prototype chain) should allow implementation defined behaviour."},{"commentid":9837,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-08-21 13:12:59 -0700","thetext":"fixed in rev27 editor's draft"},{"commentid":9927,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-08-25 08:29:26 -0700","thetext":"fixed in rev27 draft"}]}}
---
