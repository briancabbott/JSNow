---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4351,"creation_ts":"2015-05-01 13:54:00 -0700","short_desc":"12.14.5.2 DestructuringAssignmentEvaluation, 13.3.3.5 BindingInitialization: Different null/undefined checks","delta_ts":"2015-10-02 13:14:00 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 38: April 14, 2015 Final Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"jwalden+beo","long_desc":[{"commentid":14370,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-05-01 13:54:55 -0700","thetext":"12.14.5.2 Runtime Semantics: DestructuringAssignmentEvaluation\n13.3.3.5 Runtime Semantics: BindingInitialization\n\n13.3.3.5 BindingInitialization starts with calling RequireObjectCoercible, cf. step 1 for `BindingPattern : ObjectBindingPattern`.\n\nCompared to that, 12.14.5.2 DestructuringAssignmentEvaluation does not call RequireObjectCoercible for non-empty object destructuring. The null/undefined checks are executed implicitly when calling GetV in 12.14.5.4 KeyedDestructuringAssignmentEvaluation.\n\n\nTest case:\n---\nwith (new Proxy({}, {\n  has(t, p) {\n    print(`has:${p}`);\n    return Reflect.has(t,p);\n  }\n})) {\n  var {a} = null; // has:a is not printed\n}\n---\n\n---\nvar a;\nwith (new Proxy({}, {\n  has(t, p) {\n    print(`has:${p}`);\n    return Reflect.has(t,p);\n  }\n})) {\n  ({a} = null); // has:a is printed !\n}\n---"},{"commentid":14373,"comment_count":1,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-05-02 01:38:40 -0700","thetext":"Smaller tests without with+Proxy:\n---\nvar a;\n({[print(\"hello\")]: a} = null); // Prints \"hello\"\n\n\nvar {[print(\"hello\")]: a} = null; // Does not print \"hello\"\n---"},{"commentid":14375,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-05-04 17:13:08 -0700","thetext":"fixed in rev39 publication draft\n\nadded to 12.14.5.2\n\nObjectAssignmentPattern :\n\t{ AssignmentPropertyList }\n\t{ AssignmentPropertyList , }\n\n1.\tLet valid be RequireObjectCoercible(value).\n2.\tReturnIfAbrupt(valid).\n3.\tReturn the result of performing DestructuringAssignmentEvaluation for AssignmentPropertyList using value as the argument."}]}}
---
