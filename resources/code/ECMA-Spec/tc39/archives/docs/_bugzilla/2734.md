---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":2734,"creation_ts":"2014-04-24 15:59:00 -0700","short_desc":"%ArrayIteratorPrototype%.next(): swap steps 13 and 14","delta_ts":"2014-07-15 11:24:10 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 23: April 5, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","see_also":"https://bugs.ecmascript.org/show_bug.cgi?id=2736","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"thespooniest","name":"Beecher Greenman"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":7911,"comment_count":0,"who":{"uid":"thespooniest","name":"Beecher Greenman"},"bug_when":"2014-04-24 15:59:35 -0700","thetext":"Step 13 of %ArrayIteratorPrototype%.next() checks if itemKind has the substring \"value\", and ultimately returns if it does. Step 14 checks if itemKind has the substring \"key+value\", and returns a different result based on that.\n\nHowever, because \"value\" is itself a substring of \"key+value\", an ArrayIterator of kind \"key+value\" (intended to trip Step 14) will never reach the right step, because it will trip Step 13 and return before that can happen.\n\nThis can be fixed simply by swapping the two steps. Then kind \"key+value\" will trip the appropriate step, but other kinds of iterators will pass through to the other checks."},{"commentid":7914,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-04-24 18:39:58 -0700","thetext":"I don't think so, step 13c only returns if step 13b throws an exception, otherwise it just continues with step 14 (no else in front of step 14)\n\nStep 13 is doing the elementValue fetch for both the \"value\" and \"key+value\" cases"},{"commentid":9207,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-07-15 11:24:10 -0700","thetext":"substring testing eliminated as part of fix for Bug 2736 \n\nIn rev25"}]}}
---
