---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4097,"creation_ts":"2015-02-27 09:51:00 -0800","short_desc":"Editorial issues in 12.1.1 Static Semantics: Early Errors","delta_ts":"2015-03-04 18:58:16 -0800","product":"Draft for 6th Edition","component":"editorial issue","version":"Rev 34: February 20, 2015 Release Candidate 1","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"ikarienator","name":"Bei Zhang"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"bugs.ecmascript","long_desc":[{"commentid":13418,"comment_count":0,"who":{"uid":"ikarienator","name":"Bei Zhang"},"bug_when":"2015-02-27 09:51:08 -0800","thetext":"1. The first item in second paragraph:\n\nIdentifierReference[Yield] : yield\nBindingIdentifier[Yield] : yield\nLabelIdentifier[Yield] : yield\n\n  It is a Syntax Error if this production has a [Yield] parameter.\n\nis redundant because yield is not a production when a [Yield] parameter is present.\n\n\n2. The third paragraph:\n\nIdentifierReference[Yield] : Identifier\nBindingIdentifier[Yield] : Identifier\nLabelIdentifier[Yield] : Identifier\n  It is a Syntax Error if this production has a [Yield] parameter and StringValue of Identifier is \"yield\".\n\nis redundant because Identifier's StringValue cannot be \"yield\".\n\nThe NOTE below states:\n\n> StringValue of IdentifierName normalizes any Unicode escape sequences in IdentifierName hence such escapes cannot be used to write an Identifier whose code point sequence is the same as a ReservedWord.\n\nThis two implies that \"although Identifier can have the same code point sequence as a ReservedWord, but it cannot be achieved through Unicode escape\", which is not true."},{"commentid":13420,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-27 11:13:32 -0800","thetext":"(In reply to Bei Zhang from comment #0)\n> 1. The first item in second paragraph:\n> \n> IdentifierReference[Yield] : yield\n> BindingIdentifier[Yield] : yield\n> LabelIdentifier[Yield] : yield\n> \n>   It is a Syntax Error if this production has a [Yield] parameter.\n> \n> is redundant because yield is not a production when a [Yield] parameter is\n> present.\n\nagreed\n\n\n> \n> \n> 2. The third paragraph:\n> \n> IdentifierReference[Yield] : Identifier\n> BindingIdentifier[Yield] : Identifier\n> LabelIdentifier[Yield] : Identifier\n>   It is a Syntax Error if this production has a [Yield] parameter and\n> StringValue of Identifier is \"yield\".\n> \n> is redundant because Identifier's StringValue cannot be \"yield\".\n\nIt can, in non-strict code, if the IdentifierName that Identifier derives contains Unicode escape sequences. Note that the 2nd bullet item of the following rules for Identifier explicitly permit that. this is because prior to ES6 'yield' was not a reserved word so valid identifiers could have been 'yield' written with escape sequences.\n\n\n> \n> The NOTE below states:\n> \n> > StringValue of IdentifierName normalizes any Unicode escape sequences in IdentifierName hence such escapes cannot be used to write an Identifier whose code point sequence is the same as a ReservedWord.\n> \n> This two implies that \"although Identifier can have the same code point\n> sequence as a ReservedWord, but it cannot be achieved through Unicode\n> escape\", which is not true.\n\nHow do you arrive at that conclusion?  What the note says is exactly what the two early error rules for Identifier is enforcing."},{"commentid":13424,"comment_count":2,"who":{"uid":"ikarienator","name":"Bei Zhang"},"bug_when":"2015-02-27 13:42:06 -0800","thetext":"It conflicts with 11.6:\n\n> All interpretations of IdentifierName within this specification are based upon \n> their actual code points regardless of whether or not an escape sequence was used \n> to contribute any particular code point."},{"commentid":13429,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-27 15:45:40 -0800","thetext":"(In reply to Bei Zhang from comment #2)\n> It conflicts with 11.6:\n> \n> > All interpretations of IdentifierName within this specification are based upon \n> > their actual code points regardless of whether or not an escape sequence was used \n> > to contribute any particular code point.\n\nThe definition of StringValue for Identifier name is the normative specification language that makes the 11.6 statement operative.\n\nStringValue for IdentifierName replaces Unicode escape sequences with the equivalent code points (actually code unit sequences). The use of Unicode escapes does not effect IdentifierName  Stringvalue comparisons.\n\nThe grammar rule\n   Identifer : IdentifierName but not ReservedWrod\n\ndoes a lexical match of of the source code of IdentifierName against the ReservedWord's, not a StringValue comparison. So v\\u0061r is first parsed as an Identifier.  \n\nThe 2nd Identifier early error rule in 12.1.1 then use a StringValue comparison to determine that v\\u0061r has the same StringValue as \"var\" triggering a syntax error.\n\n'yield' is a special case which is why it is excluded from the 2nd Identifier early error rule.  In non-strict code that is outside of a generator function 'yield' is a valid identifier.  The early error rule for IdentifierReference : Identifier (etc.) make sure that 'yield' containing Unicode escapes doesn't pass as an Identifier in those generator function contexts."},{"commentid":13430,"comment_count":4,"who":{"uid":"ikarienator","name":"Bei Zhang"},"bug_when":"2015-02-27 17:14:12 -0800","thetext":"If I understand correctly, is this the case that \n\nvar var\n\nis a grammar error and \n\nvar v\\u0061r\n\nis an early error?\n\nfunction* a() {\n  yield\n}\n\nis a generator declaration with a yield expression and\n\nfunction* a() {\n  \\u0079ield\n}\n\nis an early error?"},{"commentid":13431,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-27 20:43:11 -0800","thetext":"(In reply to Bei Zhang from comment #4)\n> If I understand correctly, is this the case that \n> \n>\n\nyes, those all look correct."},{"commentid":13432,"comment_count":6,"who":{"uid":"ikarienator","name":"Bei Zhang"},"bug_when":"2015-02-28 15:30:46 -0800","thetext":"When I read section 11.6, I would assume that any two IdentifierNames are the same in every way in syntactic rules of the the spec. I'm under-informed that there are \"exceptions\" to this rule later on in section 12.1.1.\n\nWe shall state in section 11.6 that the rule:\n\n> All interpretations of IdentifierName within this specification are based upon their actual code points regardless of whether or not an escape sequence was used to contribute any particular code point.\n\ncan be overruled by section 12.1.1. As a spec reader, when reading 11.6, I was not informed that rules in 11.6 exists and, in fact, discriminate the interpretation of IdentifierNames."},{"commentid":13439,"comment_count":7,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-02 11:28:41 -0800","thetext":"fixed in rev35 editor's draft\n\n\nThe paragraph in 11.6 that is giving you trouble is actually about Unicode canonical equivalence rather than the use of escape sequences. I eliminated the parenthetical phrase and upate the result of that paragraph so it now reads:\n\nTwo /IdentifierName/ that are canonically equivalent according to the Unicode standard are /not/ equal unless, after replacement of each /UnicodeEscapeSequence/, they are represented by the exact same sequence of code points."},{"commentid":13506,"comment_count":8,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-04 18:58:16 -0800","thetext":"fixed in rev35"}]}}
---
