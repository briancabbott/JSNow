---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3596,"creation_ts":"2015-01-23 10:13:00 -0800","short_desc":"Function Environment Records: The dual role of [[thisValue]] and its relation with [[thisInitializationState]] render the situation somewhat confusing: suggesting to use [[thisBindingStatus]] and [[thisValue]] instead with redistributed roles","delta_ts":"2015-02-19 19:10:57 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 31: January 15, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"claude.pache","name":"Claude Pache"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":11606,"comment_count":0,"who":{"uid":"claude.pache","name":"Claude Pache"},"bug_when":"2015-01-23 10:13:52 -0800","thetext":"For function environment records, one has to record the following informations regarding its this-binding:\n\n(a) whether the environment record has a local this-value;\n(b) if yes, whether the this-value is initialised;\n(c) if yes, the value of the this-value.\n\nThese informations are stored in two components:\n\n(1) [[thisValue]] stores informations (a) and (c);\n(2) [[thisInitializationState]] stores (b).\n\nThat situation is mildly confusing, for the HasThisBinding() method of the environment record has to make the distinction between: \n* \"[[thisValue]] has the value empty\" (arrow-function), returning `false`; and:\n* \"[[thisValue]] has no value\" (derived constructor with non-initialised this-binding), returning `true`.\n\n--\n\nI suggest to use the following fields instead.\n\n(1) [[thisBindingStatus]], encodes informations (a) and (b). It has three possible values:\n  *  Absent:  there is no local this-binding (arrow-function);\n  *  Uninitilized:  there is a local, but uninitialized, this-binding;\n  *  Initialized:  the this-binding is initialised and its value is recorded in [[thisValue]].\n\n(2) [[thisValue]] encodes information (c) only. It contains the this-value when it is present and initialised; but it is not explicitly set to empty in case of arrow-functions."},{"commentid":12744,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-15 15:39:33 -0800","thetext":"fixed in rev34 editor's draft"},{"commentid":13064,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-19 19:10:57 -0800","thetext":"fixed in rev34"}]}}
---
