---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1283,"creation_ts":"2013-03-11 08:16:00 -0700","short_desc":"13.4: Static Semantics Early Errors too strict","delta_ts":"2013-07-15 17:03:22 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 15: May 14, 2013 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"minor","everconfirmed":true,"reporter":{"uid":"wingo","name":"Andy Wingo"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["rossberg","usrbincc"],"long_desc":[{"commentid":3418,"comment_count":0,"who":{"uid":"wingo","name":"Andy Wingo"},"bug_when":"2013-03-11 08:16:23 -0700","thetext":"Hi\n\nSection 13.4 of the new draft specifies two early errors that are needlessly restrictive:\n\n  * It is a Syntax Error if FunctionBody Contains YieldExpression is false.\n\n\"function* () {}\" is well-defined, and might come about through use of eval code.\n\n  * It is a Syntax Error if AssignmentExpression Contains YieldExpression.\n\n\"yield yield 3\" is also perfectly well-defined.\n\nIn both of these cases, an implementation would have to do more work to implement the restrictions than it would to not implement them."},{"commentid":4017,"comment_count":1,"who":{"uid":"wingo","name":"Andy Wingo"},"bug_when":"2013-05-15 06:48:50 -0700","thetext":"This bug is still present in revision 15."},{"commentid":4022,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-05-15 09:06:43 -0700","thetext":"Do you have a real use case for a generator function body without a yield other than a by-product of a degenerate case of mechanical code generation?\n\nIf not, it's a trade-off between early diagnostics for human written code and a slight simplification of a code generator."},{"commentid":4023,"comment_count":3,"who":{"uid":"rossberg","name":"Andreas Rossberg"},"bug_when":"2013-05-15 09:22:02 -0700","thetext":"One important use case is prototyping with a dummy generator. Or the case where you comment out a yield for debugging. That shouldn't render the program illegal.\n\nA zero iterator/generator could also be a perfectly sensible part of a generic iterator library. There is no reason to believe that you don't occasionally need an empty generator in the same manner you sometimes need empty functions.\n\nAlso, I don't think it simplifies code generators. If anything, it's more work to diagnose this case."},{"commentid":4168,"comment_count":4,"who":{"uid":"usrbincc","name":"Ben Chan"},"bug_when":"2013-06-11 14:14:39 -0700","thetext":"The fixed issue looks to be handled already in bug 1551.\n\nIn the interest of not filing duplicate bugs, I'll just add my +1 to\nthe remaining issue:\n\n* It is a Syntax Error if AssignmentExpression Contains YieldExpression.\n\nI don't really know what else to add aside from what Andy Wingo has\nalready said. At the very least, it would be useful to be able to know\nwhat the rationale behind this limitation is.\n\nOkay, maybe I will add something.\n\n----\n\nOn the implementation side:\n\nOnce you have the capability to do something like:\n\n  function* G() {\n    f(yield a(), (yield b) + (yield c), 42 + yield d);\n    return yield e;\n  }\n\nthen you have almost certainly already implemented\n\n  function* G() {\n    yield f(yield a(), (yield b) + (yield c), 42 + yield d);\n    yield yield e;\n  }\n\nGoing back and disabling that particular case is almost certainly\ngoing to be more work.\n\n----\n\nOn the language-design side, having this limitation means that\nprogrammers have to remember one more special-case rule. Normally you\nwould expect expressions to be freely nestable (modulo the use of\nparens to handle precedence and parsing issues). If there are to be\nexceptions, there should a clear reason for them.\n\nSo at the very least, there should be some rationale for this\nexception in the spec.\n\nNote that some people may prefer to have their lint tools disallow\nnested yield expressions, but this should probably be a separate issue\nfrom what is allowed in the language itself.\n\n----\n\nP.S. I have no experience with the conventions of bugzilla, much less\necmascript.org's particular usage of bugzilla. Does the \"CONFIRMED\"\nbug status mean that this is going to be fixed in the next revision of\nthe spec? If so, sorry for the extra noise."},{"commentid":4244,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-06-18 10:35:05 -0700","thetext":"fixed (both items) in rev 16 editor's draft"},{"commentid":4404,"comment_count":6,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-07-15 17:03:22 -0700","thetext":"fixed in rev16 draft.  July 15, 2013"}]}}
---
