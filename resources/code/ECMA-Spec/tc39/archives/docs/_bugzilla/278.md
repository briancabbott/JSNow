---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":278,"creation_ts":"2012-02-24 05:06:00 -0800","short_desc":"Coverage: Test for 7.6, keywords with unicode escapes.","delta_ts":"2013-07-27 01:10:56 -0700","product":"Test262","component":"ECMA-262 Tests","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"CONFIRMED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"rossberg","name":"Andreas Rossberg"},"assigned_to":{"uid":"dfugate","name":"Dave Fugate"},"cc":["mathias","muratsu"],"long_desc":[{"commentid":661,"comment_count":0,"who":{"uid":"rossberg","name":"Andreas Rossberg"},"bug_when":"2012-02-24 05:06:08 -0800","thetext":"There is no test checking the correct treatment of keywords with identifier names, and Section 7.6 of the spec isn't particularly clear on the subject either (see bug 277).\n\nImplementations differ. For example,\n\nv\\u0061r x = 0\neval(\"v\\\\u0061r y = 1\")\n\nIs accepted by FF 10, rejected by V8 3.8, and JSC seems to reject the former\nbut accepts the latter. Conversely,\n\nvar v\\u0061r = 1\neval(\"var v\\\\u0061r = 2\")\n\nis rejected by FF but accepted by V8 (actually introducing a variable named\n\"var\").\n\nNote that test262 contains several tests of the form\n\neval(\"var v\\u0061r = 2\")\n\nwhich is rejected by all implementations. However, here the escape sequence is decoded as part of string parsing in the meta program, not as part of identifier parsing in the object program."},{"commentid":664,"comment_count":1,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-02-24 08:37:48 -0800","thetext":"Related from Mathias Byens:\nI recently did some research on valid JavaScript identifiers (http://mathiasbynens.be/notes/javascript-identifiers) and found some interesting implementation bugs.\n\nE.g. `a\\u200c\\u200d` is a valid identifier as per ES5.1 (http://mothereff.in/js-variables#a%5Cu200c%5Cu200d), yet a lot of JavaScript engines claiming full ES5 support fail to support it. Out of all stable browser versions, Firefox 10 and IE9 are the only two that handle it correctly.\n\nFor this reason, I propose a new test is added to the suite. Something like:\n\n    var supportsZeroWidthInIdentifierPart = (function() {\n      try {\n        return eval('var a\\u200c\\u200d = true');\n      } catch(e) { }\n    }());\n```\n\n`supportsZeroWidthInIdentifierPart` will be `true` if ZWJ and ZWNJ characters are supported in `IdentifierPart`, else `undefined` (which is falsy)."},{"commentid":4547,"comment_count":2,"who":{"uid":"muratsu","name":"Murat Sutunc"},"bug_when":"2013-07-17 13:48:03 -0700","thetext":"Along with 7.6, there are other places that need unicode escape tests. ES5 spec section 11.1.2 explains that identifiers can be used as expressions. Test cases targeting expressions should also be included.\n\n// Invalid use of a reserved keyword in an expression. Should throw a syntax error\nvar c = var;\nvar c = v\\\\u0061r;\nvar c = else;\nvar c = els\\\\u0065;\n\n// valid uses\nvar a = fals\\\\u0065;\nvar b = tru\\\\u0065;\n\n// Also unicode escape tests should include properties and function names\nvar x2={};\nx2.els\\\\u0065 = 10\n\nvar x2={};\nx2.doubl\\\\u0065 = 10;\n\nfunction else\\\\u0065() {};\n\nfunction doubl\\\\u0065() {};"},{"commentid":4571,"comment_count":3,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2013-07-27 01:10:56 -0700","thetext":"I’ll just link to my old (but still relevant) tests on the subject: http://mathias.html5.org/tests/javascript/identifiers/\n\nThe tests expect the non-standard `var v\\u0061r;` behavior (where keywords are allowed as identifiers as long as at least one character is escaped) to throw an error, as browser vendors seemed to agree that this behavior isn’t required for Web compatibility. (For this reason, it has been removed from http://javascript.spec.whatwg.org/ as well.)"}]}}
---
