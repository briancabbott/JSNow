---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1264,"creation_ts":"2013-03-08 10:33:00 -0800","short_desc":"15.3.4.2 Function.prototype.toString: should callable proxies should have special toString behavior","delta_ts":"2015-10-15 17:14:44 -0700","product":"Draft for 7th Edition","component":"New feature suggestons","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"INVALID","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"allen","name":"Allen Wirfs-Brock"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["brterlso","mathias","tomvc.be"],"long_desc":[{"commentid":3306,"comment_count":0,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-03-08 10:33:47 -0800","thetext":"from tomvc.be@gmail.com:\n\n15.3.4.2 Function.prototype.toString\n\nPerhaps this is still on your TODO list, but I would advise to specify what this method should do on a Proxy. My suggested semantics:\n\n\"When called on a Proxy that is callable (i.e. whose [[ProxyTarget]] has a [[Call]] internal method), return the result of applying the built-in Function.prototype.toString on the Proxyâ€™s [[ProxyTarget]]. Otherwise, throw a TypeError. When applied to a revoked proxy, throw a TypeError.\""},{"commentid":3307,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-03-08 10:36:21 -0800","thetext":"I guess I don't see why.\n\ntoString is just a method and it is going to be automatically forwarded unless the handler does something explicitly otherwise. \n\nSimilarly, for a revoked proxy it would be handled like any other property access.\n\nWhy is special handling needed?"},{"commentid":3417,"comment_count":2,"who":{"uid":"tomvc.be","name":"Tom Van Cutsem"},"bug_when":"2013-03-11 04:54:25 -0700","thetext":"Of course, `aProxy.toString()` will just be forwarded (or intercepted by the get trap).\n\nI'm particularly thinking about:\n\nFunction.prototype.toString.call(aProxy)\n\nFor this, if we don't specify anything, it'll be up to the implementation. For proxies, I think forwarding to the target if the target is a function is the logical choice. But AFAICT, we need to specify this explicitly."},{"commentid":3419,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-03-11 08:55:28 -0700","thetext":"Isn't this a general issue for any (non-generic) method that is explicitly invoked via call/apply?\n\nFor example:\n\nArray.prototype.slice.call(aProxyArray,5)\n\n(slice would actually work because it is generic, but anything that actually need something that was a real array would have the problem)\n\nIn one sense this is similar to the problem with using discrete [[Get]] and [[Call]] steps to do method invocation. Without visibility of the [[Get]], the [[Call]] doesn't know whether a proxy to target translation need to take place.\n\nDo we need to elevate this to esdiscuss?"},{"commentid":3421,"comment_count":4,"who":{"uid":"tomvc.be","name":"Tom Van Cutsem"},"bug_when":"2013-03-11 13:28:44 -0700","thetext":"I'm happy to take this to the list.\n\nFor most built-in methods, there is indeed no need to specify any special behavior for proxies, as those internal methods (especially those of Array.prototype) just use the MOP (i.e. calls to [[Get]] etc.), so can work with proxies as well.\n\nFunction.prototype.toString is special in that its definition falls outside of the scope of the MOP. In particular, it is explicitly marked as a \"non-generic\" method. As its behavior is already mostly implementation-dependent, we could leave it at that, but I think prescribing the behavior for proxies is non-problematic and would avoid unnecessary incompatibilities."},{"commentid":14812,"comment_count":5,"who":{"uid":"brterlso","name":"Brian Terlson"},"bug_when":"2015-10-15 17:14:44 -0700","thetext":"Proposals should use the proposal process documented here: https://github.com/tc39/ecma262/blob/master/CONTRIBUTING.md."}]}}
---
