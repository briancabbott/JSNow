---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":104,"creation_ts":"2011-06-09 10:52:00 -0700","short_desc":"Missing coverage?  https://bugzilla.mozilla.org/show_bug.cgi?id=637994","delta_ts":"2012-02-29 09:06:46 -0800","product":"Test262","component":"ECMA-262 Tests","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"dfugate","name":"Dave Fugate"},"assigned_to":{"uid":"dfugate","name":"Dave Fugate"},"long_desc":[{"commentid":227,"comment_count":0,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2011-06-09 10:52:13 -0700","thetext":"<Thanks>Mark Miller</Thanks>\n\nWe might be missing coverage for the following test scenario.  Add test case(s) assuming this scenario can be mapped to ES5.1 somewhere\n--------------------------------------------------------------------------\n*See http://codereview.appspot.com/4547070/diff/6003/src/com/google/caja/ses/es5shim.js?context=10&column_width=80 for the original*\n\n310 * Work arond for https://bugzilla.mozilla.org/show_bug.cgi?id=637994\n\n311 *\n\n312 * <p>On Firefoxes at least 4 through 7.0a1, an inherited\n\n313 * non-configurable accessor property appears to be an own property\n\n314 * of all objects which inherit this accessor property.\n\n315 *\n\n316 * <p>Our workaround wraps hasOwnProperty, getOwnPropertyNames, and\n\n317 * getOwnPropertyDescriptor to heuristically decide when an accessor\n\n318 * property looks like it is apparently own because of this bug, and\n\n319 * suppress reporting its existence.\n\n320 *\n\n321 * <p>However, it is not feasible to likewise wrap JSON.stringify,\n\n322 * and this bug will cause JSON.stringify to be misled by inherited\n\n323 * enumerable non-configurable accessor properties. To prevent this,\n\n324 * we wrap defineProperty, freeze, and seal to prevent the creation\n\n325 * of <i>enumerable</i> non-configurable accessor properties on\n\n326 * those platforms with this bug.\n\n327 *\n\n328 * <p>A little known fast about JavaScript is that\n\n329 * Object.prototype.propertyIsEnumerable actually tests whether a\n\n330 * property is both own and enumerable. Assuming that our wrapping\n\n331 * of defineProperty, freeze, and seal prevents the occurrence of an\n\n332 * enumerable non-configurable accessor property, it should also\n\n333 * prevent the occurrence of this bug for any enumerable property,\n\n334 * and so we do not need to wrap propertyIsEnumerable.\n\n335 *\n\n336 * <p>This kludge seems to be safety preserving, but the issues are\n\n337 * delicate and not well understood.\n\n338 */\n\n339 function test_ACCESSORS_INHERIT_AS_OWN() {\n\n340 var base = {};\n\n341 var derived = Object.create(base);\n\n342 function getter() { return 'gotten'; }\n\n343 Object.defineProperty(base, 'foo', {get: getter});\n\n344 if (!derived.hasOwnProperty('foo') &&\n\n345 Object.getOwnPropertyDescriptor(derived, 'foo') === undefined &&\n\n346 Object.getOwnPropertyNames(derived).indexOf('foo') < 0) {\n\n347 return false;\n\n348 }\n\n349 if (derived.hasOwnProperty('foo') &&\n\n350 Object.getOwnPropertyDescriptor(derived, 'foo').get === getter &&\n\n351 Object.getOwnPropertyNames(derived).indexOf('foo') >= 0) {\n\n352 log('Accessor properties inherit as own properties. ' +\n\n353 'See https://bugzilla.mozilla.org/show_bug.cgi?id=637994');\n\n354 } else {\n\n355 log('New symptom: ' +\n\n356 'Accessor properties partially inherit as own properties.');\n\n357 }\n\n358 Object.defineProperty(base, 'bar', {get: getter, configurable: true});\n\n359 if (!derived.hasOwnProperty('bar') &&\n\n360 Object.getOwnPropertyDescriptor(derived, 'bar') === undefined &&\n\n361 Object.getOwnPropertyNames(derived).indexOf('bar') < 0) {\n\n362 return true;\n\n363 }\n\n364 log('New symptom: ' +\n\n365 'Accessor properties inherit as own even if configurable.');\n\n366 return true;\n\n367 }\n\n368 //var TOLERATE_ACCESSORS_INHERIT_AS_OWN = false;\n\n369 var TOLERATE_ACCESSORS_INHERIT_AS_OWN = test_ACCESSORS_INHERIT_AS_OWN();"},{"commentid":544,"comment_count":1,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-01-09 09:39:45 -0800","thetext":"I can find very little coverage for Object.hasOwnProperty (none for this scenario) and no targeted coverage for [[GetOwnProperty]]."},{"commentid":545,"comment_count":2,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-01-09 14:28:33 -0800","thetext":"About 50 new tests for 8.12.1 have been written.  These will be distributed to test262 with the next set of test contributions from Microsoft."},{"commentid":709,"comment_count":3,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-02-29 09:06:46 -0800","thetext":"Tests are now live on test262.ecmascript.org."}]}}
---
