---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4002,"creation_ts":"2015-02-18 12:26:00 -0800","short_desc":"a parsing context with no always-correct lexical goal symbol for getting the next token","delta_ts":"2015-02-19 19:10:57 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 33: February 12, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"jmdyck","name":"Michael Dyck"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":12920,"comment_count":0,"who":{"uid":"jmdyck","name":"Michael Dyck"},"bug_when":"2015-02-18 12:26:25 -0800","thetext":"This bug is not against rev33 as published, but as modified according to\nBug 635 comment 9. (I could wait for rev34, but I don't think I should.)\nSpecifically, \"[Lexical goal]\" annotations have been removed from the grammar, and clause 11 has been modified to say something like:\n\n    If the context allows RegularExpressionLiteral,\n        use InputElementRegExp.\n    If the context allows TemplateMiddle or TemplateTail,\n        use InputElementTemplateTail.\n    Otherwise, use InputElementDiv.\n\nIn Bug 635 comment 3, I added:\n    (And you can note that the first two possibilities are [or should be]\n    mutually exclusive.)\n\nIn this bug, I show that they *aren't* mutually exclusive.\n\nConsider these two GeneratorDeclarations:\n\n    function * gen() { `pre${yield /.*/}post`; }\n    function * gen() { `pre${yield     }post`; }\n\n(I don't know why anyone would write that, but I believe they're both syntactically valid.)\n\nAnd now consider the state that a parser is in having consumed just\n\n    function * gen() { `pre${yield\n\nAs shown above, the set of valid next-tokens include both RegularExpressionLiteral and TemplateTail. Thus, the contexts in which lexical goal symbols InputElementRegExp and InputElementTemplateTail are appropriate are *not* mutually exclusive.\n\nIn fact, there's no goal symbol of the lexical grammar that derives both RegularExpressionLiteral and TemplateTail. So, given this left-context, there is no always-correct choice for the lexical goal symbol to use to get the next token.\n\n(A real-world parser would maybe sniff the next character [after skipping WhiteSpace etc] and then make the necessary choice of lexical goal symbol. But that seems like a kludgey kind of thing for the spec to say.)"},{"commentid":12931,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-18 14:54:34 -0800","thetext":"I guess I need to add\n\nInputElementRegExpOrTemplateTail ::\n  WhiteSpace\n  LineTerminator\n  Comment\n  Token\n  DivPunctuator\n  TemplateSubstitutionTail\n\nand probably a note with the yield grammar"},{"commentid":12933,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-18 15:09:35 -0800","thetext":"(In reply to Allen Wirfs-Brock from comment #1)\n\nI meant:\n\n> \n> InputElementRegExpOrTemplateTail ::\n>   WhiteSpace\n>   LineTerminator\n>   Comment\n>   Token\n    RegularExpressionLiteral    \n>   TemplateSubstitutionTail"},{"commentid":12938,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-18 15:16:14 -0800","thetext":"fixed in rev34 editor's draft"},{"commentid":12943,"comment_count":4,"who":{"uid":"jmdyck","name":"Michael Dyck"},"bug_when":"2015-02-18 15:33:13 -0800","thetext":"Hm, yeah, I think that might work.\n\nSo then the rule could be:\n\n    If the context allows both RegularExpressionLiteral and TemplateTail,\n        use InputElementRegExpOrTemplateTail\n\n    If the context allows RegularExpressionLiteral but not TemplateTail,\n        use InputElementRegExp.\n\n    If the context allows TemplateTail but not RegularExpressionLiteral,\n        use InputElementTemplateTail.\n\n    Otherwise, use InputElementDiv.\n\n(I'm assuming you can leave out mention of TemplateMiddle because the contexts in which it's allowed are the same as for TemplateTail.)"},{"commentid":12957,"comment_count":5,"who":{"uid":"jmdyck","name":"Michael Dyck"},"bug_when":"2015-02-18 19:58:54 -0800","thetext":">     Otherwise, use InputElementDiv.\n\nOr, for more parallelism,\n      If the context allows neither TemplateTail nor RegularExpressionLiteral,\n          use InputElementDiv.\n\n\nOr use a table like this:\n                                                 TemplateTail\n                                   ... is allowed           ... is not allowed\nRegularExpressionLiteral\n          ... is allowed  InputElementRegExpOrTemplateTail  InputElementRegExp\n\n      ... is not allowed  InputElementTemplateTail          InputElementDiv"},{"commentid":13067,"comment_count":6,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-19 19:10:57 -0800","thetext":"fixed in rev34"}]}}
---
