---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":654,"creation_ts":"2012-09-26 00:15:00 -0700","short_desc":"The meanings of \"absent\"/\"present\" are unclear throughout the specification.","delta_ts":"2012-09-26 09:49:55 -0700","product":"ECMA-262, Editions 5 and 5.1","component":"technical content","version":"Edition 5.1","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"INVALID","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"sukyoung.ryu","name":"Sukyoung Ryu"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"sukyoung.ryu","long_desc":[{"commentid":1609,"comment_count":0,"who":{"uid":"sukyoung.ryu","name":"Sukyoung Ryu"},"bug_when":"2012-09-26 00:15:17 -0700","thetext":"As \"8.6.1 Property Attributes\" says, a named accessor property may have four attributes: [[Get]], [[Set]], [[Enumerable]], and [[Configurable]].\n\nAs \"8.10 The Property Descriptor and Property Identifier Specification Types\" says, \"Values of the Property Descriptor type are records composed of named fields where each field's name is an attribute name and its value is a corresponding attribute value as specified in 8.6.1.  In addition, any field may be present or absent.\"\n\nHowever, in \"8.10.4 FromPropertyDescriptor(Desc)\", the steps 4-a and 4-b do not check whether [[Get]] and [[Set]] are \"present\" in \"Desc\" but just access them.  Is it an oversight of the specification or are we missing something here?\n\nWe tried the following code:\n\n  var o = { get abc() {} }\n  x = Object.getOwnPropertyDescriptor(o, \"abc\")\n  for (y in x) { document.writeln(y); }\n\nwhere \"15.2.3.3 Object.getOwnPropertyDescriptor\" calls FromPropertyDescriptor, and an online JavaScript interpreter prints the following:\n\n  get set enumerable configurable\n\nwhich suggests that [[Set]] is \"present\" even though we didn't define a setter.  Calling the setter as follows:\n\n  x.abc(3)\n\nresults in the following error:\n\n  TypeError at line NaN: 'undefined' is not a function\n\nwhich suggests that [[Set]] is \"present\" and its value is \"undefined\".\n\nSo, they are inconsisent.  When 8.10 says that \"any field may be present or absent\", does the word \"absent\" mean that the field exists but its value is \"undefined\"?  A similar question is when the step 12 of \"8.12.9 [[DefineOwnProperty]](P, Desc, Throw)\" says \"For each attribute field of Desc that is present, ...\" does the word \"present\" mean that the field exists and its value is not \"undefined\"? Yet another similar question is the step 2 of \"8.10.1 IsAccessorDescriptor(Desc)\": \"If both Desc.[[Get]] and Desc.[[Set]] are absent, ...\"\n\nFinally, when the step 2 of \"8.10.2 IsDataDescriptor(Desc)\" says \"If both Desc.[[Value]] and Desc.[[Writable]] are absent, then return false.\" we might be able to say that Desc.[[Value]] is absent if its value is undefined, but how about Desc.[[Writable]]?  Its type is Boolean and its default value is false.  Does the specification say that Desc.[[Writable]] is absent if its value is false?"},{"commentid":1614,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2012-09-26 09:49:55 -0700","thetext":"(In reply to comment #0)\n> As \"8.6.1 Property Attributes\" says, a named accessor property may have four\n> attributes: [[Get]], [[Set]], [[Enumerable]], and [[Configurable]].\n> \n> As \"8.10 The Property Descriptor and Property Identifier Specification Types\"\n> says, \"Values of the Property Descriptor type are records composed of named\n> fields where each field's name is an attribute name and its value is a\n> corresponding attribute value as specified in 8.6.1.  In addition, any field\n> may be present or absent.\"\n> \n> However, in \"8.10.4 FromPropertyDescriptor(Desc)\", the steps 4-a and 4-b do not\n> check whether [[Get]] and [[Set]] are \"present\" in \"Desc\" but just access them.\n>  Is it an oversight of the specification or are we missing something here?\n\nIn 8.10.4 the prose paragraph immediate before step 1 says \"...ssumes that Desc is a fully populated Property Desceriptor...\"\n\n\nSo in step, which is predicated by an IsAccessorDescriptor test we can depend upon the [[Get]] and [[Set]] fields both being present.\n\n> \n> We tried the following code:\n> \n>   var o = { get abc() {} }\n>   x = Object.getOwnPropertyDescriptor(o, \"abc\")\n>   for (y in x) { document.writeln(y); }\n> \n> where \"15.2.3.3 Object.getOwnPropertyDescriptor\" calls FromPropertyDescriptor,\n> and an online JavaScript interpreter prints the following:\n> \n>   get set enumerable configurable\n> \n> which suggests that [[Set]] is \"present\" even though we didn't define a setter.\n>  Calling the setter as follows:\n> \n>   x.abc(3)\n> \n> results in the following error:\n> \n>   TypeError at line NaN: 'undefined' is not a function\n> \n> which suggests that [[Set]] is \"present\" and its value is \"undefined\".\n\nThat is correct.  When creating a new accessor property 8.12.9, step 4.b.i attributes are set to their \"default values\" if they are absent (ie, not present) from Desc. The default values for [[Get]] and [[Set]] is undefined (Table 7).\n\n> \n> So, they are inconsisent.  When 8.10 says that \"any field may be present or\n> absent\", does the word \"absent\" mean that the field exists but its value is\n> \"undefined\"? \n\n8.10 is talking about Property Descriptor Record, in general.  \"Absent\" simply means not there.  The semantics of \"absent\" is contextually dependent upon other factors, particularly within 8.12.9\n\n\n> A similar question is when the step 12 of \"8.12.9\n> [[DefineOwnProperty]](P, Desc, Throw)\" says \"For each attribute field of Desc\n> that is present, ...\" does the word \"present\" mean that the field exists and\n> its value is not \"undefined\"? Yet another similar question is the step 2 of\n> \"8.10.1 IsAccessorDescriptor(Desc)\": \"If both Desc.[[Get]] and Desc.[[Set]] are\n> absent, ...\"\n\n\"Present\" means actually there with an explicit value.  \"Absent\" means not there.\n\n> \n> Finally, when the step 2 of \"8.10.2 IsDataDescriptor(Desc)\" says \"If both\n> Desc.[[Value]] and Desc.[[Writable]] are absent, then return false.\" we might\n> be able to say that Desc.[[Value]] is absent if its value is undefined, but how\n> about Desc.[[Writable]]?  Its type is Boolean and its default value is false. \n> Does the specification say that Desc.[[Writable]] is absent if its value is\n> false?"}]}}
---
