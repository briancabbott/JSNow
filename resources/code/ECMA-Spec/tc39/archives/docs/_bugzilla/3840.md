---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3840,"creation_ts":"2015-02-11 17:48:00 -0800","short_desc":"IsArray, IsCallable, IsConstructor, IsRegExp should all throw when used on a revoked proxy, just like Object.isExtensible does","delta_ts":"2015-02-12 12:17:35 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 32: February 2, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"jwalden+beo","name":"Jeff Walden (remove +beo to mail)"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"evilpies","long_desc":[{"commentid":12338,"comment_count":0,"who":{"uid":"jwalden+beo","name":"Jeff Walden (remove +beo to mail)"},"bug_when":"2015-02-11 17:48:44 -0800","thetext":"Revoked proxies throw on attempts to examine them, touch them, &c.  This should include yes-or-no queries about their internal natures, including all the ones in the summary.  Currently they're inconsistent: IsRegExp throws, IsArray returns false, IsCallable and IsConstructor return the nature of the original target of the proxy.\n\nIt's also worth noting that Object.isExtensible throws on a revoked proxy.  It seems pretty clear that if the other predicates noted consulted traps (as only IsRegExp does right now), they would throw for that reason.  Seems like everything should throw.  (And for what it's worth, SpiderMonkey's dead-object/membrane precedent is for these things to throw, too, as I recall.)"},{"commentid":12373,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-12 08:42:21 -0800","thetext":"fixed in rev33 editor's draft\n\nFixed IsArray, GetFunctionRealm to throw when applied to a revoked proxy. Also made ProxyCreate throw if either the handler or target object is a direct proxy.\n\nAs far as I can see, those are the only remaining places that drill through a proxy and didn't either explicitly or implicitly (via internal method calls check for revocation.\n\nI don't want to make IsCallable and IsConstructor throw because they are used too many places within the spec. as direct predicates of an if and hence don't have  a subsequent ReturnIfAbrupt check.  It looks to me, that those uses will generally detect revoked proxies because they ultimately do something that invokes an internal method. Let me know if you see any that don't"},{"commentid":12399,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-12 12:17:35 -0800","thetext":"fixed in rev33"}]}}
---
