---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":32,"creation_ts":"2011-02-26 03:34:00 -0800","short_desc":"Disabling 15.2.3.4-4-1 Object.getOwnPropertyNames returns array of property names (Global)","delta_ts":"2011-02-28 14:05:50 -0800","product":"Test262","component":"ECMA-262 Tests","version":"unspecified","rep_platform":"PC","op_sys":"Linux","bug_status":"RESOLVED","resolution":"INVALID","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"bruant.d","name":"David Bruant"},"assigned_to":{"uid":"dfugate","name":"Dave Fugate"},"long_desc":[{"commentid":63,"comment_count":0,"who":{"uid":"bruant.d","name":"David Bruant"},"bug_when":"2011-02-26 03:34:32 -0800","thetext":"This tests assumes a finite set of properties of the global objects. This is in contradiction with Section 16:\n\"An implementation may provide additional types, values, objects, properties,\nand functions beyond those described in this specification.\"\n\nAs a matter of fact, web browsers for which the global object is also the 'window' object, there are plenty of other global object own properties. This test would be expected to fail in all web browsers.\n\nFor the record, in the IE test center (http://samples.msdn.microsoft.com/ietestcenter/), the '100%' next the the JavaScript tests seems to mean that IE9RC passes this test. Is it really the case or is the '100%' an approximation?"},{"commentid":67,"comment_count":1,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2011-02-28 09:39:34 -0800","thetext":"Hi David, I agree that this test case should not fail if extra types, values, etc. have been provided and will remove this assertion shortly.  I would not necessarily expect this test to fail in all web browsers though - if vendor provided types such as 'document'/'screen'/etc. are not enumerable the test will pass. \n\nAs for IE Test Center, just double-checked and the test passes on my machine (32-bit Windows 7 RTM, English language OS, IE9 RC1):  \"15.2.3.4-4-1 Object.getOwnPropertyNames returns array of property names (Global): pass [Source]\".  I also just verified the following returns a 'true' alert outside of IE Test Center's harness:\n    <html><body><script type=\"text/javascript\">\n    document.write(\"This is my first JavaScript!\");\n    function fnGlobalObject() {return this};\n    \n    function testcase() {\n            var result = Object.getOwnPropertyNames(fnGlobalObject());\n            var expResult = [\"NaN\", \"Infinity\", \"undefined\", \"eval\", \"parseInt\", \"parseFloat\", \"isNaN\", \"isFinite\", \"decodeURI\", \"decodeURIComponent\", \"encodeURI\", \"encodeURIComponent\", \"Object\", \"Function\", \"Array\", \"String\", \"Boolean\", \"Number\", \"Date\", \"Date\", \"RegExp\", \"Error\", \"EvalError\", \"RangeError\", \"ReferenceError\", \"SyntaxError\", \"TypeError\", \"URIError\", \"Math\", \"JSON\"];\n    \n            var result1 = {};\n            for (var p in result) {\n                result1[result[p]] = true;\n            }\n    \n            for (var p1 in expResult) {\n                if (!result1[expResult[p]]) {\n                    return false;\n                }\n            }\n            return true;\n        }\n    alert(testcase());\n    </script></body></html>\n\n\nHave you tried running this from IE9 RC1, and if so how does your machine setup differ from mine (e.g., I could imagine potential localization problems with this one)?\n\nThanks again for reporting this!\n\nDave"},{"commentid":69,"comment_count":2,"who":{"uid":"bruant.d","name":"David Bruant"},"bug_when":"2011-02-28 10:21:21 -0800","thetext":"(In reply to comment #1)\n> Hi David, I agree that this test case should not fail if extra types, values,\n> etc. have been provided and will remove this assertion shortly.  I would not\n> necessarily expect this test to fail in all web browsers though - if vendor\n> provided types such as 'document'/'screen'/etc. are not enumerable the test\n> will pass.\nObject.getOwnPropertyNames returns an array with ALL own properties, not only enumerable (15.2.3.4 step 4).\n\n\n> As for IE Test Center, just double-checked and the test passes on my machine\n> (32-bit Windows 7 RTM, English language OS, IE9 RC1):  \"15.2.3.4-4-1\n> Object.getOwnPropertyNames returns array of property names (Global): pass\n> [Source]\".  I also just verified the following returns a 'true' alert outside\n> of IE Test Center's harness:\n>     <html><body><script type=\"text/javascript\">\n>     document.write(\"This is my first JavaScript!\");\n>     function fnGlobalObject() {return this};\n> \n>     function testcase() {\n>             var result = Object.getOwnPropertyNames(fnGlobalObject());\n>             var expResult = [\"NaN\", \"Infinity\", \"undefined\", \"eval\",\n> \"parseInt\", \"parseFloat\", \"isNaN\", \"isFinite\", \"decodeURI\",\n> \"decodeURIComponent\", \"encodeURI\", \"encodeURIComponent\", \"Object\", \"Function\",\n> \"Array\", \"String\", \"Boolean\", \"Number\", \"Date\", \"Date\", \"RegExp\", \"Error\",\n> \"EvalError\", \"RangeError\", \"ReferenceError\", \"SyntaxError\", \"TypeError\",\n> \"URIError\", \"Math\", \"JSON\"];\n> \n>             var result1 = {};\n>             for (var p in result) {\n>                 result1[result[p]] = true;\n>             }\n> \n>             for (var p1 in expResult) {\n>                 if (!result1[expResult[p]]) {\n>                     return false;\n>                 }\n>             }\n>             return true;\n>         }\n>     alert(testcase());\n>     </script></body></html>\n> \n> \n> Have you tried running this from IE9 RC1, and if so how does your machine setup\n> differ from mine (e.g., I could imagine potential localization problems with\n> this one)?\nUnfortunately, on my machine I have a double-boot Windows XP/Ubuntu, so I can't run IE9 for the moment. \n\nI have found a weird thing. On the harness, the test fails on FF4b12. However, on the web console, your code snippet passes.\n\nI think I have figured why... There is a typo:\nfor (var p1 in expResult) {\n    if (!result1[expResult[p]]) {\n        return false;\n    }\n}\nshould be:\nfor (var p1 in expResult) {\n    if (!result1[expResult[p1]]) {\n        return false;\n    }\n}\nIn the \"if\" test, \"p\" should be \"p1\". Basically, depending on the last value of p, if it is in expResult, test passes and it doesn't if p isn't. I think that FF4b12 WebConsole adds things to global object, so it may change the global object properties order.\n\n\nActually, I think I misunderstood the test. Just to make sure. Is the test testing that expResult is included in Object.getOwnPropertyNames(fnGlobalObject())?\n\nIf it's the case, then, the test is actually fine (without the typo) and there is no need to worry about implementation-specific values. I thought it was checking for equality of the two sets.\n\n\n\nFor the record, once again, Object.getOwnPropertyNames() returns an array and since ES5, arrays have amazing methods to deal with them. On the other hand, for..in loops loop through all enumerable properties of the object (on the prototype chain too).\n\nTo test array inclusion in our case, I would go for:\n----------------------\nfunction testcase() {\n    var result = Object.getOwnPropertyNames(fnGlobalObject());\n    var expResult = [...];\n\n    // Make sure that every element in expResult can be found in result\n    return expResult.every(function(e){return result.indexOf(e) !== -1;});\n}\n----------------------"},{"commentid":72,"comment_count":3,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2011-02-28 13:21:03 -0800","thetext":"> Actually, I think I misunderstood the test. Just to make sure. Is the test\n> testing that expResult is included in\n> Object.getOwnPropertyNames(fnGlobalObject())?\n> If it's the case, then, the test is actually fine (without the typo) and there\n> is no need to worry about implementation-specific values. I thought it was\n> checking for equality of the two sets.\nYes, the intent of the test is to ensure expResult is in Object.getOwnPropertyNames(fnGlobalObject()).  Closing this as By Design."},{"commentid":74,"comment_count":4,"who":{"uid":"bruant.d","name":"David Bruant"},"bug_when":"2011-02-28 13:32:44 -0800","thetext":"(In reply to comment #3)\n> > Actually, I think I misunderstood the test. Just to make sure. Is the test\n> > testing that expResult is included in\n> > Object.getOwnPropertyNames(fnGlobalObject())?\n> > If it's the case, then, the test is actually fine (without the typo) and there\n> > is no need to worry about implementation-specific values. I thought it was\n> > checking for equality of the two sets.\n> Yes, the intent of the test is to ensure expResult is in\n> Object.getOwnPropertyNames(fnGlobalObject()).  Closing this as By Design.\n\noh but and what about the typo?"},{"commentid":76,"comment_count":5,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2011-02-28 14:05:50 -0800","thetext":"Typo is fixed in all source control repositories, but not yet live on the website."}]}}
---
