---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3386,"creation_ts":"2014-11-15 18:18:00 -0800","short_desc":"Clarify parsing of function bodies when rest parameter is used","delta_ts":"2014-12-03 12:16:13 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 28: October 14, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"INVALID","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"caitpotter88","name":"Caitlin Potter [:caitp]"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"caitpotter88","long_desc":[{"commentid":10639,"comment_count":0,"who":{"uid":"caitpotter88","name":"Caitlin Potter [:caitp]"},"bug_when":"2014-11-15 18:18:45 -0800","thetext":"The implementation of rest parameters in SpiderMonkey explicitly forbids a reference to the \"arguments\" binding within the body of a function literal with a rest parameter. As such,  the script `function fn(a, b, ...rest) { arguments; }` yields a SyntaxError.\n\nI am not seeing where this is supported by the specification, as I mention in https://bugzilla.mozilla.org/show_bug.cgi?id=574132.\n\nI would like the appropriate behaviour to be clarified so that the SpiderMonkey implementation can be made spec-compliant (either by fixing the spec, or fixing SM), and so that a spec-correct version can be implemented in V8.\n\nI am not positive if treating this as a static error is necessarily the best approach to take, but if that is the intent then it should be spelled out explicitly.\n\nThis is not strictly a technical issue, but an inconsistency between implementation reality and the text of the draft, which may require new language for incorporating the behaviour of the implementation, or otherwise strengthening the position of the current draft."},{"commentid":10640,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-11-16 09:37:36 -0800","thetext":"(In reply to Caitlin Potter (:caitp) from comment #0)\n> The implementation of rest parameters in SpiderMonkey explicitly forbids a\n> reference to the \"arguments\" binding within the body of a function literal\n> with a rest parameter. As such,  the script `function fn(a, b, ...rest) {\n> arguments; }` yields a SyntaxError.\n\nThat's not correct according the current ES6 drafts.  See http://people.mozilla.org/~jorendorff/es6-draft.html#sec-functiondeclarationinstantiation which defines exactly when a 'arguments' binding is created.\n\n> \n> I am not seeing where this is supported by the specification, as I mention\n> in https://bugzilla.mozilla.org/show_bug.cgi?id=574132.\n> \n> I would like the appropriate behaviour to be clarified so that the\n> SpiderMonkey implementation can be made spec-compliant (either by fixing the\n> spec, or fixing SM), and so that a spec-correct version can be implemented\n> in V8.\n> \nDo you see anything unclear about the specification text referenced above? I believe it accurately reflects TC39's intended semantics.\n\n> I am not positive if treating this as a static error is necessarily the best\n> approach to take, but if that is the intent then it should be spelled out\n> explicitly.\n\nIt's not supposed to be an error. \n> \n> This is not strictly a technical issue, but an inconsistency between\n> implementation reality and the text of the draft, which may require new\n> language for incorporating the behaviour of the implementation, or otherwise\n> strengthening the position of the current draft.\n\nThe spec has evolves over various drafts and early implementations need to follow the revisions and be prepared to update them has the spec. evolved.  Function declaration instantiation, in particular, has changed several times but is now quite stable.  All implementations should review their conformance to the current specification."},{"commentid":10642,"comment_count":2,"who":{"uid":"caitpotter88","name":"Caitlin Potter [:caitp]"},"bug_when":"2014-11-16 10:46:28 -0800","thetext":"Thanks for the clarification of intent. I was thinking it might not hurt to add another \"**NOTE: Rest parameters do not preclude Arguments objects\" somewhere in this case, just to help explicitly state this.\n\nI appreciate that this should not be a static error, because it seems easier to implement this way."}]}}
---
