---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3279,"creation_ts":"2014-10-14 06:03:00 -0700","short_desc":"8.1.1.4.14, 8.1.1.4.15, 8.1.1.4.16: Change HasBinding to HasOwnProperty","delta_ts":"2015-02-19 19:11:07 -0800","product":"Draft for 6th Edition","component":"normative change from ES5.x","version":"Rev 27: August 24, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":10349,"comment_count":0,"attachid":"71","who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-10-14 06:03:55 -0700","thetext":"Created attachment 71\nGlobalDeclarationInstantiation tests\n\n8.1.1.4.14 CanDeclareGlobalVar (N)\n8.1.1.4.15 CanDeclareGlobalFunction (N)\n8.1.1.4.16 CreateGlobalVarBinding (N, D)\n\nThe HasBinding(N) calls should probably be changed to use HasOwnProperty(globalObject, N) instead. Strictly speaking this is a change from ES5, but all implementations tested (*) don't actually follow the ES5 definitions for global declaration instantiation, so I'd say this is a safe change. Well, with the exception of JavaScriptCore which does follow the rules for \"var\" declarations, but not the rules for \"function\". More details below. \n\n(*) IE11, SpiderMonkey (latest), V8 (bleeding-edge latest), JavaScriptCore (latest), Nashorn (latest)\n\n\nResults when executing the attached test case.\n\nExpected results (with HasBinding):\n---\nStart tests...\n... done!\n---\n\nExpected results (with HasOwnProperty):\n---\nStart tests...\ntestNonConfigDataProtoVar - assertion failed: got 0, expected -1\ntestConfigAccProtoVar - assertion failed: got undefined, expected set 'configAccProtoVar' to: 0\ntestConfigAccProtoVar - assertion failed: got undefined, expected get 'configAccProtoVar'\n... done!\n---\n\nIE11:\n---\nStart tests...\ntestNonConfigDataFun - assertion failed: got false, expected true\ntestNonConfigDataFun - assertion failed: got function nonConfigDataFun(){}, expected -1\ntestNonConfigDataProtoVar - assertion failed: got 0, expected -1\nunexpected set 'configAccFun' to: function configAccFun(){}\nunexpected set 'configAccFun' to: function configAccFun(){}\nunexpected get 'configAccFun'\ntestConfigAccFun - assertion failed: got undefined, expected function\ntestConfigAccProtoVar - assertion failed: got undefined, expected set 'configAccProtoVar' to: 0\ntestConfigAccProtoVar - assertion failed: got undefined, expected get 'configAccProtoVar'\n... done!\n---\n\nSpiderMonkey:\n---\nStart tests...\ntestNonConfigDataProtoVar - assertion failed: got 0, expected -1\ntestConfigAccProtoVar - assertion failed: got undefined, expected set 'configAccProtoVar' to: 0\ntestConfigAccProtoVar - assertion failed: got undefined, expected get 'configAccProtoVar'\n... done!\n---\n\nV8:\n---\nStart tests...\ntestNonConfigDataProtoVar - assertion failed: got 0, expected -1\ntestConfigAccProtoVar - assertion failed: got undefined, expected set 'configAccProtoVar' to: 0\ntestConfigAccProtoVar - assertion failed: got undefined, expected get 'configAccProtoVar'\n... done!\n---\n\nJSC:\n---\nStart tests...\ntestNonConfigDataFun - assertion failed: got false, expected true\ntestNonConfigDataProtoFun - assertion failed: got number, expected function\nunexpected set 'configAccFun' to: function configAccFun() {}\nunexpected get 'configAccFun'\ntestConfigAccFun - assertion failed: got undefined, expected function\nunexpected set 'configAccProtoFun' to: function configAccProtoFun() {}\nunexpected get 'configAccProtoFun'\ntestConfigAccProtoFun - assertion failed: got undefined, expected function\n... done!\n---\n\nNashorn:\n---\nStart tests...\ntestNonConfigDataProtoVar - assertion failed: got 0, expected -1\nunexpected set 'configAccFun' to: function configAccFun(){}\nunexpected get 'configAccFun'\nunexpected get 'configAccFun'\ntestConfigAccFun - assertion failed: got undefined, expected function\ntestConfigAccProtoVar - assertion failed: got undefined, expected set 'configAccProtoVar' to: 0\ntestConfigAccProtoVar - assertion failed: got undefined, expected get 'configAccProtoVar'\n... done!\n---"},{"commentid":12565,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-13 12:10:00 -0800","thetext":"fixed in rev34 editor's draft"},{"commentid":13136,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-19 19:11:07 -0800","thetext":"fixed in rev34"}],"attachment":[{"_attributes":{"isobsolete":"0","ispatch":"0"},"attachid":"71","date":"2014-10-14 06:03:00 -0700","delta_ts":"2014-10-14 06:03:55 -0700","desc":"GlobalDeclarationInstantiation tests","filename":"globaldecl.js","type":"application/x-javascript","size":"4929","attacher":{"_attributes":{"name":"André Bargull"},"_text":"andrebargull"},"data":{"_attributes":{"encoding":"base64"},"_text":"KGZ1bmN0aW9uIFRlc3RHbG9iYWxJbnN0YW50YXRpb24oKSB7DQp2YXIgaW5kaXJlY3RFdmFsID0g\nZXZhbDsNCnZhciBnbG9iYWwgPSBpbmRpcmVjdEV2YWwoInRoaXMiKTsNCg0KLy8gV2UgYXNzdW1l\nIE9iamVjdC5wcm90b3R5cGUgaXMgcGFydCBvZiB0aGUgcHJvdG90eXBlIGNoYWluIG9mIHRoZSBn\nbG9iYWwgb2JqZWN0DQppZiAoIU9iamVjdC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihnbG9iYWwp\nKSB7DQogIHRocm93IG5ldyBFcnJvcigidW5zdXBwb3J0ZWQgcGxhdGZvcm0iKTsNCn0NCg0KZnVu\nY3Rpb24gbG9nKCkgew0KICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICJ1bmRlZmluZWQiKSB7DQog\nICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTsNCiAgfSBlbHNlIHsNCiAg\nICBwcmludC5hcHBseShudWxsLCBhcmd1bWVudHMpOw0KICB9DQp9DQoNCmZ1bmN0aW9uIHRlc3RD\nYXNlKHRlc3QpIHsNCiAgdmFyIHRlc3ROYW1lID0gdGVzdC5uYW1lICE9PSB2b2lkIDAgPyB0ZXN0\nLm5hbWUgOiB0ZXN0LnRvU3RyaW5nKCkubWF0Y2goL15ccypmdW5jdGlvblxzKihcUyopXHMqXCgv\nKVsxXTsNCiAgcmV0dXJuIHsNCiAgICBhc3NlcnQ6IGZ1bmN0aW9uKGFjdHVhbCwgZXhwZWN0ZWQp\nIHsNCiAgICAgIGlmIChhY3R1YWwgIT09IGV4cGVjdGVkKSB7DQogICAgICAgICAgbG9nKHRlc3RO\nYW1lICsgIiAtIGFzc2VydGlvbiBmYWlsZWQ6IGdvdCAiICsgYWN0dWFsICsgIiwgZXhwZWN0ZWQg\nIiArIGV4cGVjdGVkKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGxvZ2dpbmdBY2Nlc3NvcjogZnVu\nY3Rpb24obmFtZSwgYXJyYXkpIHsNCiAgICAgIGZ1bmN0aW9uIGdldEFjY2Vzc29yKCkgew0KICAg\nICAgICBhcnJheS5wdXNoKCJnZXQgJyIgKyBuYW1lICsgIiciKTsNCiAgICAgIH0NCiAgICAgIGZ1\nbmN0aW9uIHNldEFjY2Vzc29yKHZhbHVlKSB7DQogICAgICAgIGFycmF5LnB1c2goInNldCAnIiAr\nIG5hbWUgKyAiJyB0bzogIiArIHZhbHVlKTsNCiAgICAgIH0NCiAgICAgIHJldHVybiB7Y29uZmln\ndXJhYmxlOiB0cnVlLCBnZXQ6IGdldEFjY2Vzc29yLCBzZXQ6IHNldEFjY2Vzc29yfTsNCiAgICB9\nLA0KICAgIHBvaXNvbmVkQWNjZXNzb3I6IGZ1bmN0aW9uKG5hbWUpIHsNCiAgICAgIGZ1bmN0aW9u\nIGdldEFjY2Vzc29yKCkgew0KICAgICAgICBsb2coInVuZXhwZWN0ZWQgZ2V0ICciICsgbmFtZSAr\nICInIik7DQogICAgICB9DQogICAgICBmdW5jdGlvbiBzZXRBY2Nlc3Nvcih2YWx1ZSkgew0KICAg\nICAgICBsb2coInVuZXhwZWN0ZWQgc2V0ICciICsgbmFtZSArICInIHRvOiAiICsgdmFsdWUpOw0K\nICAgICAgfQ0KICAgICAgcmV0dXJuIHtjb25maWd1cmFibGU6IHRydWUsIGdldDogZ2V0QWNjZXNz\nb3IsIHNldDogc2V0QWNjZXNzb3J9Ow0KICAgIH0sDQogIH07DQp9DQoNCi8vIFRlc3QgMWE6IG5v\nbi1jb25maWd1cmFibGUgZGF0YSBwcm9wZXJ0eSBvbiBnbG9iYWwsIHRyeSB2YXIgZGVjbGFyYXRp\nb24NCmZ1bmN0aW9uIHRlc3ROb25Db25maWdEYXRhVmFyKCkgew0KICB2YXIgdGVzdCA9IHRlc3RD\nYXNlKGFyZ3VtZW50cy5jYWxsZWUpOw0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZ2xvYmFsLCAi\nbm9uQ29uZmlnRGF0YVZhciIsIHtjb25maWd1cmFibGU6IGZhbHNlLCB2YWx1ZTogLTF9KTsNCiAg\naW5kaXJlY3RFdmFsKCJ2YXIgbm9uQ29uZmlnRGF0YVZhciA9IDAiKTsNCiAgdGVzdC5hc3NlcnQo\naW5kaXJlY3RFdmFsKCJub25Db25maWdEYXRhVmFyIiksIC0xKTsNCn0NCg0KLy8gVGVzdCAxYjog\nbm9uLWNvbmZpZ3VyYWJsZSBkYXRhIHByb3BlcnR5IG9uIGdsb2JhbCwgdHJ5IGZ1bmN0aW9uIGRl\nY2xhcmF0aW9uDQpmdW5jdGlvbiB0ZXN0Tm9uQ29uZmlnRGF0YUZ1bigpIHsNCiAgdmFyIHRlc3Qg\nPSB0ZXN0Q2FzZShhcmd1bWVudHMuY2FsbGVlKTsNCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGds\nb2JhbCwgIm5vbkNvbmZpZ0RhdGFGdW4iLCB7Y29uZmlndXJhYmxlOiBmYWxzZSwgdmFsdWU6IC0x\nfSk7DQogIHZhciBjYXVnaHQ7DQogIHRyeSB7IGluZGlyZWN0RXZhbCgiZnVuY3Rpb24gbm9uQ29u\nZmlnRGF0YUZ1bigpe30iKTsgfSBjYXRjaChlKSB7IGNhdWdodCA9IGU7IH0NCiAgdGVzdC5hc3Nl\ncnQoY2F1Z2h0IGluc3RhbmNlb2YgVHlwZUVycm9yLCB0cnVlKTsNCiAgdGVzdC5hc3NlcnQoaW5k\naXJlY3RFdmFsKCJub25Db25maWdEYXRhRnVuIiksIC0xKTsNCn0NCg0KLy8gVGVzdCAyYTogbm9u\nLWNvbmZpZ3VyYWJsZSBkYXRhIHByb3BlcnR5IG9uIHByb3RvdHlwZSwgdHJ5IHZhciBkZWNsYXJh\ndGlvbg0KZnVuY3Rpb24gdGVzdE5vbkNvbmZpZ0RhdGFQcm90b1ZhcigpIHsNCiAgdmFyIHRlc3Qg\nPSB0ZXN0Q2FzZShhcmd1bWVudHMuY2FsbGVlKTsNCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9i\namVjdC5wcm90b3R5cGUsICJub25Db25maWdEYXRhUHJvdG9WYXIiLCB7Y29uZmlndXJhYmxlOiBm\nYWxzZSwgdmFsdWU6IC0xfSk7DQogIGluZGlyZWN0RXZhbCgidmFyIG5vbkNvbmZpZ0RhdGFQcm90\nb1ZhciA9IDAiKTsNCiAgdGVzdC5hc3NlcnQoaW5kaXJlY3RFdmFsKCJub25Db25maWdEYXRhUHJv\ndG9WYXIiKSwgLTEpOw0KfQ0KDQovLyBUZXN0IDJiOiBub24tY29uZmlndXJhYmxlIGRhdGEgcHJv\ncGVydHkgb24gcHJvdG90eXBlLCB0cnkgZnVuY3Rpb24gZGVjbGFyYXRpb24NCmZ1bmN0aW9uIHRl\nc3ROb25Db25maWdEYXRhUHJvdG9GdW4oKSB7DQogIHZhciB0ZXN0ID0gdGVzdENhc2UoYXJndW1l\nbnRzLmNhbGxlZSk7DQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPYmplY3QucHJvdG90eXBlLCAi\nbm9uQ29uZmlnRGF0YVByb3RvRnVuIiwge2NvbmZpZ3VyYWJsZTogZmFsc2UsIHZhbHVlOiAtMX0p\nOw0KICBpbmRpcmVjdEV2YWwoImZ1bmN0aW9uIG5vbkNvbmZpZ0RhdGFQcm90b0Z1bigpe30iKTsN\nCiAgdGVzdC5hc3NlcnQodHlwZW9mIGluZGlyZWN0RXZhbCgibm9uQ29uZmlnRGF0YVByb3RvRnVu\nIiksICJmdW5jdGlvbiIpOw0KfQ0KDQovLyBUZXN0IDNhOiBjb25maWd1cmFibGUgYWNjZXNzb3Ig\ncHJvcGVydHkgb24gZ2xvYmFsLCB0cnkgdmFyIGRlY2xhcmF0aW9uDQpmdW5jdGlvbiB0ZXN0Q29u\nZmlnQWNjVmFyKCkgew0KICB2YXIgdGVzdCA9IHRlc3RDYXNlKGFyZ3VtZW50cy5jYWxsZWUpOw0K\nICB2YXIgYXJyYXkgPSBbXTsNCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgImNvbmZp\nZ0FjY1ZhciIsIHRlc3QubG9nZ2luZ0FjY2Vzc29yKCJjb25maWdBY2NWYXIiLCBhcnJheSkpOw0K\nICBpbmRpcmVjdEV2YWwoInZhciBjb25maWdBY2NWYXIgPSAwIik7DQogIGluZGlyZWN0RXZhbCgi\nY29uZmlnQWNjVmFyIik7DQogIHRlc3QuYXNzZXJ0KGFycmF5WzBdLCAic2V0ICdjb25maWdBY2NW\nYXInIHRvOiAwIik7DQogIHRlc3QuYXNzZXJ0KGFycmF5WzFdLCAiZ2V0ICdjb25maWdBY2NWYXIn\nIik7DQp9DQoNCi8vIFRlc3QgM2I6IG5vbi1jb25maWd1cmFibGUgZGF0YSBwcm9wZXJ0eSBvbiBn\nbG9iYWwsIHRyeSBmdW5jdGlvbiBkZWNsYXJhdGlvbg0KZnVuY3Rpb24gdGVzdENvbmZpZ0FjY0Z1\nbigpIHsNCiAgdmFyIHRlc3QgPSB0ZXN0Q2FzZShhcmd1bWVudHMuY2FsbGVlKTsNCiAgT2JqZWN0\nLmRlZmluZVByb3BlcnR5KGdsb2JhbCwgImNvbmZpZ0FjY0Z1biIsIHRlc3QucG9pc29uZWRBY2Nl\nc3NvcigiY29uZmlnQWNjRnVuIikpOw0KICBpbmRpcmVjdEV2YWwoImZ1bmN0aW9uIGNvbmZpZ0Fj\nY0Z1bigpe30iKTsNCiAgdGVzdC5hc3NlcnQodHlwZW9mIGluZGlyZWN0RXZhbCgiY29uZmlnQWNj\nRnVuIiksICJmdW5jdGlvbiIpOw0KfQ0KDQovLyBUZXN0IDRhOiBub24tY29uZmlndXJhYmxlIGRh\ndGEgcHJvcGVydHkgb24gcHJvdG90eXBlLCB0cnkgdmFyIGRlY2xhcmF0aW9uDQpmdW5jdGlvbiB0\nZXN0Q29uZmlnQWNjUHJvdG9WYXIoKSB7DQogIHZhciB0ZXN0ID0gdGVzdENhc2UoYXJndW1lbnRz\nLmNhbGxlZSk7DQogIHZhciBhcnJheSA9IFtdOw0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT2Jq\nZWN0LnByb3RvdHlwZSwgImNvbmZpZ0FjY1Byb3RvVmFyIiwgdGVzdC5sb2dnaW5nQWNjZXNzb3Io\nImNvbmZpZ0FjY1Byb3RvVmFyIiwgYXJyYXkpKTsNCiAgaW5kaXJlY3RFdmFsKCJ2YXIgY29uZmln\nQWNjUHJvdG9WYXIgPSAwIik7DQogIGluZGlyZWN0RXZhbCgiY29uZmlnQWNjUHJvdG9WYXIiKTsN\nCiAgdGVzdC5hc3NlcnQoYXJyYXlbMF0sICJzZXQgJ2NvbmZpZ0FjY1Byb3RvVmFyJyB0bzogMCIp\nOw0KICB0ZXN0LmFzc2VydChhcnJheVsxXSwgImdldCAnY29uZmlnQWNjUHJvdG9WYXInIik7DQp9\nDQoNCi8vIFRlc3QgNGI6IG5vbi1jb25maWd1cmFibGUgZGF0YSBwcm9wZXJ0eSBvbiBwcm90b3R5\ncGUsIHRyeSBmdW5jdGlvbiBkZWNsYXJhdGlvbg0KZnVuY3Rpb24gdGVzdENvbmZpZ0FjY1Byb3Rv\nRnVuKCkgew0KICB2YXIgdGVzdCA9IHRlc3RDYXNlKGFyZ3VtZW50cy5jYWxsZWUpOw0KICBPYmpl\nY3QuZGVmaW5lUHJvcGVydHkoT2JqZWN0LnByb3RvdHlwZSwgImNvbmZpZ0FjY1Byb3RvRnVuIiwg\ndGVzdC5wb2lzb25lZEFjY2Vzc29yKCJjb25maWdBY2NQcm90b0Z1biIpKTsNCiAgaW5kaXJlY3RF\ndmFsKCJmdW5jdGlvbiBjb25maWdBY2NQcm90b0Z1bigpe30iKTsNCiAgdGVzdC5hc3NlcnQodHlw\nZW9mIGluZGlyZWN0RXZhbCgiY29uZmlnQWNjUHJvdG9GdW4iKSwgImZ1bmN0aW9uIik7DQp9DQoN\nCmxvZygiU3RhcnQgdGVzdHMuLi4iKTsNCnRlc3ROb25Db25maWdEYXRhVmFyKCk7DQp0ZXN0Tm9u\nQ29uZmlnRGF0YUZ1bigpOw0KdGVzdE5vbkNvbmZpZ0RhdGFQcm90b1ZhcigpOw0KdGVzdE5vbkNv\nbmZpZ0RhdGFQcm90b0Z1bigpOw0KdGVzdENvbmZpZ0FjY1ZhcigpOw0KdGVzdENvbmZpZ0FjY0Z1\nbigpOw0KdGVzdENvbmZpZ0FjY1Byb3RvVmFyKCk7DQp0ZXN0Q29uZmlnQWNjUHJvdG9GdW4oKTsN\nCmxvZygiLi4uIGRvbmUhIik7DQoNCn0pKCk7\n"}}]}}
---
