---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4276,"creation_ts":"2015-04-15 12:52:00 -0700","short_desc":"Abrupt completions not handled for HasProperty?","delta_ts":"2015-10-02 13:14:01 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 37: April 3, 2015 Release Candidate 4","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"d","name":"Domenic Denicola"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"andrebargull","long_desc":[{"commentid":14184,"comment_count":0,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2015-04-15 12:52:26 -0700","thetext":"This is almost certainly me not understanding the spec notation and conventions, but guidance appreciated...\n\nIn e.g. ToPropertyDescriptor, there are steps like\n\n> If HasProperty(Obj, \"enumerable\") is true, then \n\nHasProperty(O, P) is defined to return O.[[HasProperty]](P). Since O could e.g. be a proxy, this seems like it could return an abrupt completion.\n\nIf that happens, is the error implicitly rethrown, or is it ignored, or...? The \"is true\" phrasing seems a bit imprecise, whereas for rethrow I would expect something like\n\n1. Let hasPropResult be HasProperty(Obj, \"enumerable\")\n2. ReturnIfAbrupt(hasPropResult)\n3. If hasPropResult is true, then..."},{"commentid":14186,"comment_count":1,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-04-15 14:49:21 -0700","thetext":"(In reply to Domenic Denicola from comment #0)\n> This is almost certainly me not understanding the spec notation and\n> conventions, but guidance appreciated...\n\nNo, you're correct. ReturnIfAbrupt is missing after all HasProperty calls in ToPropertyDescriptor."},{"commentid":14188,"comment_count":2,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2015-04-15 15:08:59 -0700","thetext":"Hmm ok. I suspect it's a more widespread problem then. It'd be good to audit all \"is true\" and \"is false\" occurrences."},{"commentid":14189,"comment_count":3,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-04-15 15:37:05 -0700","thetext":"(In reply to Domenic Denicola from comment #2)\n> Hmm ok. I suspect it's a more widespread problem then. It'd be good to audit\n> all \"is true\" and \"is false\" occurrences.\n\nI've found only two missing ReturnIfAbrupt calls. (It's unlikely to be a widespread problem, I've tried to be quite strict about missing ReturnIfAbrupt calls in the past, e.g. bug 1778 and several others. So I think we're safe. :-)\n\n\n15.1.8 Runtime Semantics: GlobalDeclarationInstantiation (script, env)\n- step 5.c: HasRestrictedGlobalProperty is fallible\n\n18.2.1.2 Runtime Semantics: EvalDeclarationInstantiation( body, varEnv, lexEnv, strict)\n- step 9.a.iv.1.a: CanDeclareGlobalFunction is fallible"},{"commentid":14315,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-04-22 09:48:20 -0700","thetext":"fixed in rev39 publication draft"}]}}
---
