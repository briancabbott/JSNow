---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1571,"creation_ts":"2013-07-01 16:23:00 -0700","short_desc":"15.10.2.5 look-ahead assertion followed by quantifier acceptable","delta_ts":"2015-02-13 10:08:03 -0800","product":"Draft for 7th Edition","component":"Deferred from 6th edition","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"CONFIRMED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":"pruiz9999","assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["lukeh","mathias","pruiz9999"],"long_desc":[{"commentid":4345,"comment_count":0,"who":"pruiz9999","bug_when":"2013-07-01 16:23:52 -0700","thetext":"As has been documented elsewhere (e.g. http://wiki.ecmascript.org/doku.php?id=harmony:regexp_match_web_reality) there is a mismatch between the ES5 spec and what browsers really do. This is another such difference.\n\n/(?=a)*/.test('a') returns true on all main browsers, but it is a syntax error according to the spec (or at least, that is my reading). The browser behavior is in line with Perl. All browsers do report a syntax error for the related /^*/.test('a').\n\nThe spec has the following definition for Term:\nTerm :: Assertion\nTerm :: Atom\nTerm :: Atom Quantifier\nHence, the input \"Assertion Quantifier\" is invalid syntax.\n\nThe simplest, but ugly solution would be to extend Term:\nTerm :: (?= Disjunction ) Quantifier\nTerm :: (?! Disjunction ) Quantifier\n\nAnother solution could be to define look ahead assertions as Atoms. The presence of Note 2 and 3 to section 15.10.2.8 (instead of being notes to section 15.10.2.6) suggests that this may have been the case in some old draft version of the spec. Making look ahead assertions Atoms matches with the \"web reality\" semantics for this idiom, i.e. /(?=a)*/.test('b') returns true, /(?=a)+/.test('b') returns false."},{"commentid":4347,"comment_count":1,"who":"pruiz9999","bug_when":"2013-07-02 08:41:53 -0700","thetext":"Had a look at the ES3 spec and indeed in that version (?=) and (?!) are zero-width atoms, not assertions. The change is not highlighted in the ES3->ES5 changes sections, so the reasoning behind the change in the ES5 spec remains unclear to me."},{"commentid":4349,"comment_count":2,"who":"pruiz9999","bug_when":"2013-07-03 14:25:44 -0700","thetext":"This issue seems to have already been flagged by Luke Hoban in May 2011:\nhttp://wiki.ecmascript.org/doku.php?id=strawman:match_web_reality_spec\n\nHis strawman proposes extending the definition of Term, similar to my 'simple' solution."},{"commentid":6182,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-29 12:54:23 -0700","thetext":"This is the only record I can find of the motivation for the change https://mail.mozilla.org/pipermail/es-discuss/2009-February/008719.html \n\nUnfortunately, the bug database that was being use at that time has been lost.\n\nThe changes first showed up in the Feb 23, 2009 ES5 draft http://wiki.ecmascript.org/lib/exe/fetch.php?id=es3.1%3Aes3.1_proposal_working_draft&cache=cache&media=es3.1:tc39-es31-draft_23feb09.pdf \n\nIt's possible that that the change was not correctly motivated and should be rolled-back or that a different fix is need for the root problem.\n\nIt would probably make sense  to open a more visible discussion of this on es-discuss."},{"commentid":12552,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-13 10:08:03 -0800","thetext":"Deferred to ES7"}]}}
---
