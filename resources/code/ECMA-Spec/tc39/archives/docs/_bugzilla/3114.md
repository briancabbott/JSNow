---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3114,"creation_ts":"2014-08-08 14:39:00 -0700","short_desc":"Mathematical operations on infinities","delta_ts":"2015-02-19 19:10:52 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 25: May 22, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"minor","everconfirmed":true,"reporter":{"uid":"d","name":"Domenic Denicola"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"mathias","long_desc":[{"commentid":9736,"comment_count":0,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2014-08-08 14:39:02 -0700","thetext":"For example, String.prototype.indexOf.\n\n\"aa\".indexOf(\"a\", +Infinity) will result in a _position_ argument of +Infinity. Then, \"Let pos be ToInteger(position)\" just means that pos = +Infinity as well, since ToInteger passes through those values. But step 9 then does max(pos, 0), and the clause on algorithm conventions says:\n\n> Mathematical operations such as addition, subtraction, negation, multiplication, division, and the mathematical functions defined later in this clause should always be understood as computing exact mathematical results on mathematical real numbers, which do not include infinities and do not include a negative zero that is distinguished from positive zero.\n\nSo max() is not defined for handling a pos of +Infinity.\n\nA similar problem occurs with Array.prototype.indexOf, which passes through infinities to abs().\n\nThis bug also appears in the ES5 spec."},{"commentid":9737,"comment_count":1,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2014-08-08 14:53:21 -0700","thetext":"This ties into the confusion where IsInteger(+∞) is false, but ToInteger(+∞) returns +∞."},{"commentid":9738,"comment_count":2,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2014-08-08 15:19:18 -0700","thetext":"It's also unclear whether you can say \"if k > 0\" without first separately handling the case where k is an infinity. Since > is a mathematical operation.\n\nAnother data point: V8 handles this much as you would expect, with its min(), max(), and abs() functions able to handle infinities, and its relational operators able to compare them. The path of least resistance here may indeed be to fix the math operations to handle infinities."},{"commentid":9739,"comment_count":3,"who":{"uid":"d","name":"Domenic Denicola"},"bug_when":"2014-08-08 16:43:42 -0700","thetext":"ToLength also has this problem: ToLength(+∞) passes the +∞ to min(len, 2^{53}-1).\n\nI am increasingly convinced that the right thing to do is allow min/max/abs/etc. to work on infinities."},{"commentid":12956,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-18 18:26:54 -0800","thetext":"fixed in rev34 editor's draft\n\nI made ToLength explicitly deal with +Infinity\n\nalso updated clause 5 to say that min/max accept +-Infinity\n\nIt's not clear that any other clause 5 functions need to."},{"commentid":13015,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-02-19 19:10:52 -0800","thetext":"fixed in rev34"}]}}
---
