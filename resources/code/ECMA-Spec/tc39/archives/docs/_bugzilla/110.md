---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":110,"creation_ts":"2011-06-18 16:16:00 -0700","short_desc":"Tests stop or slow down when tab is in background on Firefox 5 and Chrome 11","delta_ts":"2011-06-22 14:17:51 -0700","product":"Test262","component":"Test262 website","version":"unspecified","rep_platform":"PC","op_sys":"Linux","bug_status":"CONFIRMED","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"bruant.d","name":"David Bruant"},"assigned_to":{"uid":"dfugate","name":"Dave Fugate"},"long_desc":[{"commentid":233,"comment_count":0,"who":{"uid":"bruant.d","name":"David Bruant"},"bug_when":"2011-06-18 16:16:50 -0700","thetext":"I'm currently running the tests, on Firefox 5. When the tab is active, CPU goes up to 50% (I have two cores). When I switch tabs, CPU goes down. Up back when I switch back to the test tab. Same behavior on Chrome 11.\n\nI think that this is due to the recent change on Firefox 5.\nOn https://developer.mozilla.org/en/DOM/window.setTimeout, it can be read that \"timeouts are clamped to firing no more often than once per second (1000ms) in inactive tabs\".\nAnd indeed, the test loader uses setTimeout: http://hg.ecmascript.org/tests/test262/file/0e72e08e46b1/test/harness/sth.js#l293\nBy the way, is there a reason why 10 is the setTimeout value?\n\nModern browsers can implement the equivalent of a 0sec timeout using postMessage (http://caniuse.com/#feat=x-doc-messaging):\nhttp://dbaron.org/log/20100309-faster-timeouts\nhttp://www.nonblocking.io/2011/06/windownexttick.html\n\nBased on http://jsperf.com/postmessage :\nvar nextTick = (function() {\n  return function(cb) {\n    window.onmessage = cb;\n    window.postMessage('', '*');\n  };\n})();"},{"commentid":239,"comment_count":1,"who":{"uid":"bruant.d","name":"David Bruant"},"bug_when":"2011-06-22 14:17:51 -0700","thetext":"As a short term workaround, tabs can be extracted both on Firefox and Chrome to become independent windows. Leaving the test suite tab being the active tab of this new window make tests run fast."}]}}
---
