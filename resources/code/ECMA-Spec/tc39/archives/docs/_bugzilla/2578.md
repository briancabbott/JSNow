---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":2578,"creation_ts":"2014-03-11 06:20:00 -0700","short_desc":"14.5.15 ClassDefinitionEvaluation, 9.2.11 SetFunctionName: Move binding initialisation after step 18 / Invalid assertion in step 1","delta_ts":"2014-04-06 11:29:50 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 22: January 20, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":7432,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-03-11 06:20:39 -0700","thetext":"Computed property names in class definitions can access the class definition during initialisation, this can be used to trigger an assertion in 9.2.11 SetFunctionName.\n\nMaybe 14.5.15 ClassDefinitionEvaluation should perform the binding initialisation after step 18, so computed property names cannot access the not quite initialised class definition. Or 9.2.11 SetFunctionName need to handle non-extensible objects resp. 14.5.16 Runtime Semantics: Evaluation need to check the [[Extensible]] internal data slot before calling SetFunctionName. \n\n\nTest case:\n---\nclass X {\n  [(Object.preventExtensions(X), \"\")](){}\n}\n---"},{"commentid":7433,"comment_count":1,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-03-11 06:26:53 -0700","thetext":"All callers of 9.2.11 SetFunctionName need to perform the [[Extensible]] check not only 14.5.16 Runtime Semantics: Evaluation."},{"commentid":7434,"comment_count":2,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-03-11 06:43:40 -0700","thetext":"Okay, once again: It's only 14.5.16 Runtime Semantics: Evaluation, not all callers of SetFunctionName. The other callers cannot gain access to the class definition during initialisation, because they all occur in anonymous function definition contexts."},{"commentid":7439,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-03-18 10:55:18 -0700","thetext":"fixed in rev23 editor's draft\n\nmoved binding initialization after step 18"},{"commentid":7533,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-04-06 11:29:50 -0700","thetext":"fixed in rev23 draft"}]}}
---
