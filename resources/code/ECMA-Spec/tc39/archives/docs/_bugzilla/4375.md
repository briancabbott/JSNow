---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4375,"creation_ts":"2015-05-21 14:16:00 -0700","short_desc":"Treating !IsValidSimpleAssignmentTarget target as early ReferenceError for assignments/incops inconsistent with implementations","delta_ts":"2015-05-26 08:38:12 -0700","product":"Draft for 7th Edition","component":"Deferred from 6th edition","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"CONFIRMED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"jwalden+beo","name":"Jeff Walden (remove +beo to mail)"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":"andrebargull","long_desc":[{"commentid":14445,"comment_count":0,"who":{"uid":"jwalden+beo","name":"Jeff Walden (remove +beo to mail)"},"bug_when":"2015-05-21 14:16:04 -0700","thetext":"function f() { 'use strict'; eval = 5; }\nfunction g() { 'use strict'; eval++; }\n\nIn all the implementations I can test, these are early SyntaxErrors.  But the spec says that nodes that are not IsValidSimpleAssignmentTarget should be early ReferenceErrors.\n\nI saw bug 3992 attempted to make this (or at least deliberately preserved it) for ES5 compatibility wrt things like\n\nfunction h() { [3] = 5; }\n\nwhich is kinda sorta fine, I guess.  But with this wrinkle pointed out -- that this one case of not-a-valid-simple-assignment-target is uniformly implemented with other semantics in engines -- I'm not convinced uniform ReferenceError behavior is good.\n\nFrankly, I suspect you can get away with making all these early SyntaxErrors, and I would try that first.  But if not, you'll have to suss out arguments/eval for special behavior here."},{"commentid":14448,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-05-25 10:29:12 -0700","thetext":"deferred for Es7 consideration\n\nI like them to all become syntax errors.  There has been some discussion of this in the past but it has been held back by uncertainty about possible breakage. \n\n(Seems unlikely, but somebody evaling code might be checking for  the ReferenceError)"},{"commentid":14449,"comment_count":2,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-05-25 11:28:10 -0700","thetext":"(In reply to Allen Wirfs-Brock from comment #1)\n> I like them to all become syntax errors.  There has been some discussion of\n> this in the past but it has been held back by uncertainty about possible\n> breakage. \n> \n> (Seems unlikely, but somebody evaling code might be checking for  the\n> ReferenceError)\n\nI think there's a misunderstanding here. The example code in comment #0 throws a SyntaxError in ES5, but ES6 changed it to a ReferenceError. That means to avoid a possible breakage, ES6 needs to restore the SyntaxError for assignments to \"eval\" and \"arguments\" in strict mode code.\n\nHere are the early error rules from ES5 and ES6 for the postfix increment operator, ES5 11.3.1 specifies to throw a SyntaxError, whereas ES6 12.4.1 specifies to throw a ReferenceError. Similar issues are present for the prefix increment operator and the assignment operator.\n\nES5:\n---\n11.3.1 Postfix Increment Operator\n\n2. Throw a SyntaxError exception if the following conditions are all true:\n  - Type(lhs) is Reference is true\n  - IsStrictReference(lhs) is true\n  - Type(GetBase(lhs)) is Environment Record\n  - GetReferencedName(lhs) is either \"eval\" or \" arguments\"\n---\n\nES6:\n---\n12.4 Postfix Expressions\n12.4.1 Static Semantics: Early Errors\n  - It is an early Reference Error if IsValidSimpleAssignmentTarget of LeftHandSideExpression is false.\n\n\n12.1 Identifiers\n12.1.3 Static Semantics: IsValidSimpleAssignmentTarget\nIdentifierReference : Identifier\n  1. If this IdentifierReference is contained in strict mode code and StringValue of Identifier is \"eval\" or \"arguments\" , return false.\n  2. Return true.\n---"},{"commentid":14450,"comment_count":3,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-05-26 08:38:12 -0700","thetext":"The following test262 test files explicitly check for SyntaxError when assigning to eval/arguments.\n---\ntest/language/arguments-object/10.5-1-s.js\ntest/language/arguments-object/10.5-1gs.js\ntest/language/arguments-object/10.5-7-b-1-s.js\ntest/language/directive-prologue/14.1-4gs.js\ntest/language/directive-prologue/14.1-5gs.js\ntest/language/expressions/assignment/11.13.1-4-30-s.js\ntest/language/expressions/assignment/11.13.1-4-31-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-1-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-1gs.js\ntest/language/expressions/compound-assignment/11.13.2-6-2-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-3-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-4-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-5-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-6-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-7-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-8-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-9-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-10-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-11-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-12-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-13-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-14-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-15-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-16-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-17-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-18-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-19-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-20-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-21-s.js\ntest/language/expressions/compound-assignment/11.13.2-6-22-s.js\ntest/language/expressions/postfix-decrement/11.3.2-2-1-s.js\ntest/language/expressions/postfix-decrement/11.3.2-2-2-s.js\ntest/language/expressions/postfix-increment/11.3.1-2-1-s.js\ntest/language/expressions/postfix-increment/11.3.1-2-1gs.js\ntest/language/expressions/postfix-increment/11.3.1-2-2-s.js\ntest/language/expressions/prefix-decrement/11.4.5-2-1-s.js\ntest/language/expressions/prefix-decrement/11.4.5-2-2-s.js\ntest/language/expressions/prefix-decrement/11.4.5-2-2gs.js\ntest/language/expressions/prefix-increment/11.4.4-2-1-s.js\ntest/language/expressions/prefix-increment/11.4.4-2-2-s.js\ntest/language/statements/function/13.0-7-s.js\ntest/language/statements/function/13.0-8-s.js\ntest/language/statements/function/13.0-9-s.js\ntest/language/statements/function/13.0-10-s.js\ntest/language/statements/function/13.0-11-s.js\ntest/language/statements/function/13.0-13-s.js\ntest/language/statements/function/13.0-14-s.js\ntest/language/statements/function/13.0-15-s.js\ntest/language/statements/function/13.0-16-s.js\ntest/language/statements/function/13.0_4-5gs.js\ntest/language/statements/variable/12.2.1-2-s.js\ntest/language/statements/variable/12.2.1-4-s.js\ntest/language/statements/variable/12.2.1-8-s.js\ntest/language/statements/variable/12.2.1-13-s.js\ntest/language/statements/variable/12.2.1-15-s.js\ntest/language/statements/variable/12.2.1-19-s.js\n---"}]}}
---
