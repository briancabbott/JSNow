---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":2980,"creation_ts":"2014-06-08 20:34:00 -0700","short_desc":"Promise.race behavior with empty Iterable is surprising","delta_ts":"2014-07-19 18:48:02 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 25: May 22, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"sam.mikes","name":"Sam Mikes"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":8871,"comment_count":0,"who":{"uid":"sam.mikes","name":"Sam Mikes"},"bug_when":"2014-06-08 20:34:13 -0700","thetext":"I discovered this behavior as I was writing a test suite for ES6 promises.\n\nPromise.race([]) returns a Promise which is pending and will reliably never settle.\n\nFurthermore, Promise.race(iterable) is legal, where iterable is some object which satisfies the Iterable interface.  The risk I am concerned about is that at runtime, the iterator will be empty, and neither the onFulfilled nor onRejected functions will ever be called, and that this behavior will be difficult for the programmer to identify.\n\nMy initial suggestion would have been to make Promise.race() behave as if TypeError had been thrown, and cause the steps in IfAbruptRejectPromise to be followed, leaving the resulting promise in a rejected state.\n\nHowever, I note that @domenic writes \"Regarding Promise.race([]), this has been discussed extensively. It is required for consistency and is not a bug.\"\nsee https://github.com/getify/native-promise-only/pull/20#issuecomment-45457923\n\nTherefore my suggestion is merely to modify the ES6 spec to explicitly note that Promise.race([]) creates a pending promise that will never settle, and that this behavior is by design.\n\nThanks to @rwaldron for asking me to file this issue, see https://github.com/getify/native-promise-only/pull/20#issuecomment-45457586"},{"commentid":9147,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-07-10 13:38:27 -0700","thetext":"fixed in rev26 editor's draft\n\nadded a note"},{"commentid":9398,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-07-19 18:48:02 -0700","thetext":"fixed in rev26"}]}}
---
