---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":387,"creation_ts":"2012-06-13 23:09:00 -0700","short_desc":"[[Get]] and GetValue can return Reference Type","delta_ts":"2013-05-14 19:14:52 -0700","product":"ECMA-262, Editions 5 and 5.1","component":"technical content","version":"Edition 5.1","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"utatane.tea","name":"Yusuke Suzuki"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":978,"comment_count":0,"who":{"uid":"utatane.tea","name":"Yusuke Suzuki"},"bug_when":"2012-06-13 23:09:42 -0700","thetext":"derived from https://mail.mozilla.org/pipermail/es-discuss/2012-June/023343.html\n\nAccording to the ECMA262 5.1th, [[Call]] of host object may return Reference Type.\nSo, all values using raw [[Call]] result may be Reference Type.\n\nFor example, [[Get]] may return Reference Type if getter is a host object that [[Call]] returns Reference Type.\nhttp://ecma-international.org/ecma-262/5.1/#sec-8.12.3\nAs the result, GetValue may return Reference Type because that use result value of [[Get]]\nhttp://ecma-international.org/ecma-262/5.1/#sec-8.7.1\n\nAnd, for example, if we define getter of object, getter function is host object that [[Call]] return Reference Type,\n\n    (10, obj.getter)\n\nreturns Reference type, so,\n\n    (10, obj.getter) = 10;\n\nis valid because GetValue is performed, but GetValue result is also Reference Type.\n\nIn the ECMA262 5.1th, GetValue is assumed that doesn't return Reference Type, for exmaple,\n\n    var obj = {\n        get v() {\n           // this v function is host object and returns Reference;\n           // we can define this v using host object and defineProperty\n           return Reference;\n        }\n    };\n\nAnd,\n\n    typeof obj.v\n\nThen, typeof should treat Reference Type also, but in 11.4.3, Reference Type is not considered.\nhttp://ecma-international.org/ecma-262/5.1/#sec-11.4.3\n\nI think this is a bug of spec and GetValue and [[Get]] should not return Reference type, is it right?\n\nTo fix this, I think following 3 ways are good.\n\n  1. perform GetValue on [[Call]] result in the spec\n  2. re-define [[Get]] and GetValue can return Reference Type. This needs to re-define all the spec part using [[Get]], GetValue and others\n  3. remove feature that [[Call]] can return Reference Type\n\nBecause all modern engines don't consider that [[Call]] result is Reference and this feature makes big performance-regression, personally I think 3 is better."},{"commentid":4005,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-05-14 19:14:52 -0700","thetext":"[[Call]] can no longer return a Reference.\n\nFixed in rev 15 draft"}]}}
---
