---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3618,"creation_ts":"2015-01-23 13:57:00 -0800","short_desc":"9.4.3.2 [[HasProperty]]: Don't traverse prototype chain for string indices","delta_ts":"2015-03-17 16:57:04 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 31: January 15, 2015 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":11629,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-01-23 13:57:42 -0800","thetext":"9.4.3.2 [[HasProperty]](P)\n\nCall StringGetIndexProperty before OrdinaryHasProperty to avoid performing a prototype traversal for own string indices."},{"commentid":11706,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-01-23 17:28:38 -0800","thetext":"I  think to avoid a breaking change from ES5 the first step has to be an OrdinaryGetOwnProperty and then [[HasProperty]] on the prototype.\n\nI'd actually like to take your suggestion and the breaking change.  Do you know if any browsers don't conform to the ES5 behavior?"},{"commentid":11710,"comment_count":2,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-01-24 05:16:38 -0800","thetext":"(In reply to Allen Wirfs-Brock from comment #1)\n> I  think to avoid a breaking change from ES5 the first step has to be an\n> OrdinaryGetOwnProperty and then [[HasProperty]] on the prototype.\n \nIs there any observable difference between the two alternatives? Exotic string objects will never have an own property named `p` where `p` is in an integer indexed property the range `[0, [[StringData]].length[`. \n\n\n> I'd actually like to take your suggestion and the breaking change.  Do you\n> know if any browsers don't conform to the ES5 behavior?\n\nI don't quite understand the question. Do you want to know if there is an implementation which does not implement 15.5.5.2 [[GetOwnProperty]] from ES5.1 by first calling the default [[GetOwnProperty]] internal method and then checking string indices?\n\n\nNashorn and JSC first check string indices and then call the default [[GetOwnProperty]] method:\n\nNashorn\nhttp://hg.openjdk.java.net/nashorn/jdk9/nashorn/file/4e97628f17be/src/jdk/nashorn/internal/objects/NativeString.java#l381\n\nJSC\nhttps://github.com/WebKit/webkit/blob/f6ee57e0a00262f5cf0a0c86a89600dfb288db4e/Source/JavaScriptCore/runtime/StringObject.cpp#L47\n\n\n\nSpiderMonkey and V8 first call [[GetOwnProperty]] and then check string indices:\n\nSpiderMonkey\nhttps://dxr.mozilla.org/mozilla-central/source/js/src/vm/NativeObject-inl.h#489\nhttps://dxr.mozilla.org/mozilla-central/source/js/src/jsstr.cpp#400\n\nV8\nhttps://chromium.googlesource.com/v8/v8.git/+/43fa6bd41853e53d21cccbea66508c1f9b0f9ac2/src/objects.cc#4092"},{"commentid":13745,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-16 11:24:06 -0700","thetext":"fixed in rev36 editor's draft\n\nin Comment #1 I was thinking about [[GetOwnProperty]] rather than [[HasProperty]]"},{"commentid":13810,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-17 16:57:04 -0700","thetext":"in rev36"}]}}
---
