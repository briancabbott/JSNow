---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3006,"creation_ts":"2014-07-10 15:12:00 -0700","short_desc":"eval/function constructor and tagged template call sites.","delta_ts":"2014-12-09 12:06:28 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 25: May 22, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"allen","name":"Allen Wirfs-Brock"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["erights","erights","jorendorff"],"long_desc":[{"commentid":9149,"comment_count":0,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-07-10 15:12:32 -0700","thetext":"let t = \"tag`hello, ${world}.`\";\neval(t);\neval(t);\n\nor\nnew Function(t)();\nnew Function(t)();\n\nDo each of these pairs compile into different call sites or are they the same call site? I'm inclined to say different.  That each parse of an input string whether via eval, the function constructor, or module/script loading represent a logically distinct input into the ES environment.\n\nNeeds to be explicitly clarified in the spec."},{"commentid":9153,"comment_count":1,"who":{"uid":"erights","name":"Mark Miller"},"bug_when":"2014-07-10 17:42:30 -0700","thetext":"I think they must be different. I don't see how any other answer is possible without very surprising sharing of object-identity."},{"commentid":9195,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-07-14 18:19:54 -0700","thetext":"(In reply to comment #1)\n\nI generally agree with you, but is two new function calls on the same string really that different from two closures created from the same source code?"},{"commentid":9197,"comment_count":3,"who":{"uid":"erights","name":"Mark Miller"},"bug_when":"2014-07-14 18:34:26 -0700","thetext":"Hi Allen, I didn't understand your response. Can you expand? Thanks."},{"commentid":9851,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-08-23 17:50:23 -0700","thetext":"(In reply to Mark Miller from comment #3)\n> Hi Allen, I didn't understand your response. Can you expand? Thanks.\n\nWhat  meant is that that there is really not very much difference (ignoring scoping issues) between:\n\nfunction makeFunction() {return function inner() {return tag`hello, ${world}.`}};\nvar c1 = makeFunction();\nvar c2 = makeFunction();\n//c1 and c2 are different function objects derived from the same source code //definition,\n// there is a single template string call site shared by both of them.\n\nand this:\n\nlet t = \"tag`hello, ${world}.`\";\nvar c3 = new Function(t);\nvar c4 = new Function(t);\n//c3 and c4 are different function objects derived from the same source code //definition,\n//There is a different template string call site for each of them.\n\nexcept that in the second case isn't very different from the first case, except we are arbitrarily saying two call sites are created instead of one."},{"commentid":10976,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-09 12:06:28 -0800","thetext":"fixed in rev29 draft\n\ntemplate caching is now per realm and based upon string equality of list of raw template segments."}]}}
---
