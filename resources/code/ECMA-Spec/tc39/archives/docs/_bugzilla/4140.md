---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4140,"creation_ts":"2015-03-07 18:21:00 -0800","short_desc":"class definitions: computed property name can be \"constructor\"","delta_ts":"2015-07-10 08:35:01 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 35: March 4, 2015 Release Candidate 2","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"WONTFIX","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"allen","name":"Allen Wirfs-Brock"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["erik.arvidsson","leonarnott"],"long_desc":[{"commentid":13638,"comment_count":0,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-07 18:21:23 -0800","thetext":"Should this be a runtime error during class definition evaluation?\n\ncurrently it just over-writes the constructor property."},{"commentid":13654,"comment_count":1,"who":{"uid":"leonarnott","name":"Leon Arnott"},"bug_when":"2015-03-09 00:30:05 -0700","thetext":"One computed name that should definitely be forbidden is `static ['prototype'](){}`."},{"commentid":13655,"comment_count":2,"who":{"uid":"arv","name":"Erik Arvidsson"},"bug_when":"2015-03-09 06:24:02 -0700","thetext":"['constructor'] should be allowed.\n\nAs is, we should not special case this one. The prototype property 'constructor' is not read only so disallowing it would require that every computed property name would need to be compared with the string 'constructor'.\n\nIf we made the prototype 'constructor' property read only (like the constructor property 'prototype') then we would get the type error for free."},{"commentid":13657,"comment_count":3,"who":{"uid":"arv","name":"Erik Arvidsson"},"bug_when":"2015-03-09 07:06:42 -0700","thetext":"(In reply to Leon Arnott from comment #1)\n> One computed name that should definitely be forbidden is `static\n> ['prototype'](){}`.\n\nThat is already the case since the property is non-configurable and non-writable."},{"commentid":13666,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-09 10:03:48 -0700","thetext":"(In reply to Erik Arvidsson from comment #2)\n> ['constructor'] should be allowed.\n\nI think either alternative is plausale.\n\n> \n> As is, we should not special case this one. The prototype property\n> 'constructor' is not read only so disallowing it would require that every\n> computed property name would need to be compared with the string\n> 'constructor'.\n\nbut only as part of ClassDefinitionEvaluation\n\n> \n> If we made the prototype 'constructor' property read only (like the\n> constructor property 'prototype') then we would get the type error for free.\n\nwould have to also be non-configurable because [[DefineOwnProperty]] is used to install methods during ClassDefinitionEvaluation"},{"commentid":13670,"comment_count":5,"who":{"uid":"arv","name":"Erik Arvidsson"},"bug_when":"2015-03-09 10:52:22 -0700","thetext":"(In reply to Allen Wirfs-Brock from comment #4)\n> would have to also be non-configurable because [[DefineOwnProperty]] is used\n> to install methods during ClassDefinitionEvaluation\n\nYup. read only is not a spec term, it is my way of saying non-configurable, non-writable.\n\nI think it is too late to make the constructor read only and therefore I don't think we should add this restriction to computed property names in ClassDefinitionEvaluation."},{"commentid":13686,"comment_count":6,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-10 13:48:03 -0700","thetext":"ok, won't change anything\n\nI mainly opened this to see what people thought about it."},{"commentid":13690,"comment_count":7,"who":{"uid":"leonarnott","name":"Leon Arnott"},"bug_when":"2015-03-10 19:20:56 -0700","thetext":"(In reply to Erik Arvidsson from comment #3)\n> (In reply to Leon Arnott from comment #1)\n> > One computed name that should definitely be forbidden is `static\n> > ['prototype'](){}`.\n> \n> That is already the case since the property is non-configurable and\n> non-writable.\n\nAh, OK. I'd gotten confused because 14.5.1 has an early error for `static prototype`, as a bare name, which, if what you say is true, is technically unnecessary except to catch the bug earlier.\n\nSpeaking of which: it's also an error if more than one `constructor` bare name is present, which was one of my motivations for mentioning this topic. Given that similar limits on duplicate properties were removed for object literals due to computed properties daunting them, maybe that 14.5.1 restriction should be relaxed too? Hmm."},{"commentid":13693,"comment_count":8,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-03-11 09:06:38 -0700","thetext":"(In reply to Leon Arnott from comment #7)\n> \n> Speaking of which: it's also an error if more than one `constructor` bare\n> name is present, which was one of my motivations for mentioning this topic.\n> Given that similar limits on duplicate properties were removed for object\n> literals due to computed properties daunting them, maybe that 14.5.1\n> restriction should be relaxed too? Hmm.\n\nthis was considered but rejected when the restriction of duplicate properties was relax.\n\nThe constructor property is really a special form that is part of a ClassBody.  It does define  just another property.  Rather, it is how the actual body of the constructor is provided.  Clearly only one such such body is possible. \n\n[\"constructor\"]() {}\non the otherhand is is evaluated after the constructor is already created so it has no effect upon the constructor body. It just over-writes the prototype.constructor property value."}]}}
---
