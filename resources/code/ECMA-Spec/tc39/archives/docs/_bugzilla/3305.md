---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":3305,"creation_ts":"2014-11-04 04:28:00 -0800","short_desc":"Unclear semantics of call site object caching (12.2.8.2.2)","delta_ts":"2015-07-10 08:35:04 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 23: April 5, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"rossberg","name":"Andreas Rossberg"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["caitpotter88","dslomov","erights","erik.arvidsson"],"long_desc":[{"commentid":10549,"comment_count":0,"who":{"uid":"rossberg","name":"Andreas Rossberg"},"bug_when":"2014-11-04 04:28:09 -0800","thetext":"Section 12.2.8.2.2 makes the identity of call site objects dependent on the equivalence of \"source code\", but it is not clear what this equivalence is. Is this a structural equivalence or an identity relation?\n\nIn particular, with\n\n  let sites = [];\n  function g(o) { sites.push(o) }\n  function f() {\n    eval(\"g`bla`\");\n  }\n  f();\n  f();\n  eval(\"g`bla`\");\n\nwould the two template literals share the same call site object? The two calls to f? That is which ones of the three objects in sites are supposed to be the same?"},{"commentid":10550,"comment_count":1,"who":{"uid":"arv","name":"Erik Arvidsson"},"bug_when":"2014-11-04 06:37:16 -0800","thetext":"https://mail.mozilla.org/pipermail/es-discuss/2014-July/038343.html\n\n> Allen wrote:\n\nBTW, eval brings up an interesting question:\n\nlet t = \"tag`hello, ${world}.`\";\neval(t);\neval(t);\n\nor\nnew Function(t)();\nnew Function(t)();\n\nDo each of these pairs compile into different call sites or are they the same call site? I'm inclined to say different.  That each parse of an input string whither via eval, the function constructor, or module/script loading represent a logically distinct input into the ES environment.\n\n<"},{"commentid":10681,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-11-24 16:00:32 -0800","thetext":"fixed in rev29 editor's draft as per Nov 2014 TC29 meeting decisions.\n\ntemplates are canonicalized by their raw string element sequence."},{"commentid":10904,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-12-07 14:35:06 -0800","thetext":"fixed in rev29"}]}}
---
