---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4373,"creation_ts":"2015-05-20 19:57:00 -0700","short_desc":"12.3.4.1: dynamic definition of direct eval","delta_ts":"2015-10-02 13:14:02 -0700","product":"Draft for 6th Edition","component":"editorial issue","version":"Rev 38: April 14, 2015 Final Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"jmdyck","name":"Michael Dyck"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":14430,"comment_count":0,"who":{"uid":"jmdyck","name":"Michael Dyck"},"bug_when":"2015-05-20 19:57:39 -0700","thetext":"12.3.4.1 \"Runtime Semantics: Evaluation\"\nsays:\n     A CallExpression whose evaluation executes step 4.a.vii is a direct eval.\n\nTwo things:\n\n(1) For a given CallExpression, whether its evaluation executes that step can vary between evaluations. (ArgumentListEvaluation might return an abrupt completion, or it might not.) So does this mean that the CallExpression is sometimes a direct eval and sometimes not?\n\n(2) Some early error conditions (which must be enforced before code is evaluated) rely on detecting direct evals. But given the above, direct evals cannot be statically detected.\n\n\nIf you change \"4.a.vii\" to \"4.a.i\", that might make some of this go away, but you'd still be left with a definition of direct eval that is not actually usable for early error detection."},{"commentid":14432,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-05-21 07:58:57 -0700","thetext":"Whether or not a call expression is a direct eval cannot be statically determined.  Unfortunate, but that is a design decision made in the Es5 days.\n\nI can't find any early errors that depend upon static identification of a direct eval. The rules in 15.1.1 are referring to an eval invocation that has already passed through 4.a.vii (or not).   It is the direct (or indirect) eval it self that is applying that rule, so it knows whether or not it is a direct eval."},{"commentid":14442,"comment_count":2,"who":{"uid":"jmdyck","name":"Michael Dyck"},"bug_when":"2015-05-21 10:33:40 -0700","thetext":"(In reply to Allen Wirfs-Brock from comment #1)\n> Whether or not a call expression is a direct eval cannot be statically\n> determined.  Unfortunate, but that is a design decision made in the Es5 days.\n\nOkay. Then it might be clearer for 12.3.4.1 to say:\n     An evaluation of a CallExpression that executes step 4.a.vii\n     is a direct eval.\nI.e., being (or not being) a direct eval is a property of an evaluation, not of the static CallExpression.\n\n\n> The rules in 15.1.1 are referring to an eval invocation that\n> has already passed through 4.a.vii (or not).   It is the direct (or\n> indirect) eval it self that is applying that rule, so it knows whether or\n> not it is a direct eval.\n\nAh, got it."},{"commentid":14446,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-05-25 10:17:05 -0700","thetext":"fixed in rev39 publication draft"}]}}
---
