---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1934,"creation_ts":"2013-09-27 07:16:00 -0700","short_desc":"22.2.3.*, 23.*, 24.*: Replace ToObject calls with type checks in non-generic functions","delta_ts":"2013-09-27 14:47:49 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 18: September 5, 2013 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":5460,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-09-27 07:16:23 -0700","thetext":"The following functions should perform a type check instead of calling ToObject(). The ToObject coercion is somewhat useless because the functions are all non-generic, i.e. they require certain internal data properties to be present on the input value. And wrapped primitives don't provide these internal data properties. Removing the ToObject calls also saves at least on additional step in the algorithms. For example:\n\n1. Let obj be the result of ToObject(arg).\n2. ReturnIfAbrupt(obj).\n\nCan be reduced to:\n\n1. If Type(arg) is not Object, then throw a TypeError exception.\n\n\n22.2.3.1  get %TypedArray%.prototype.buffer\n22.2.3.2  get %TypedArray%.prototype.byteLength\n22.2.3.3  get %TypedArray%.prototype.byteOffset\n22.2.3.17  get %TypedArray%.prototype.length\n22.2.3.22  %TypedArray%.prototype.set(array, offset = 0)\n22.2.3.23  %TypedArray%.prototype.set(typedArray, offset = 0)\n22.2.3.27  %TypedArray%.prototype.subarray(begin = 0, end = this.length)\n22.2.3.32  get %TypedArray%.prototype [ @@toStringTag ]\n\n23.1.5.1  CreateMapIterator Abstract Operation\n23.2.5.1  CreateSetIterator Abstract Operation\n\n24.1.4.1  get ArrayBuffer.prototype.byteLength\n24.1.4.3  ArrayBuffer.prototype.slice ( start , end)\n\n24.2.1.1  GetViewValue(view, requestIndex, isLittleEndian, type)\n24.2.1.2  SetViewValue(view, requestIndex, isLittleEndian, type, value)\n24.2.4.1  get DataView.prototype.buffer\n24.2.4.2  get DataView.prototype.byteLength\n24.2.4.3  get DataView.prototype.byteOffset"},{"commentid":5461,"comment_count":1,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-09-27 07:17:25 -0700","thetext":"And the \"If Type(arg) is not Object, ...\" form is already used in the specification for other non-generic functions."},{"commentid":5492,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-09-27 12:14:30 -0700","thetext":"fixed in rev19 editor's draft"},{"commentid":5577,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-09-27 14:47:49 -0700","thetext":"fixed in rev19"}]}}
---
