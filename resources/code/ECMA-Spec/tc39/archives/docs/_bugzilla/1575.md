---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1575,"creation_ts":"2013-07-04 08:51:00 -0700","short_desc":"15.10.6.2 (RegExpExec): Access to [[RegExpMatcher]] in step 2 is visible by non-standard RegExp.p.compile","delta_ts":"2014-02-03 05:25:34 -0800","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 15: May 14, 2013 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","blocked":2492,"everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":4351,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-07-04 08:51:27 -0700","thetext":"The [[Match]] property was accessed in step 9 in ES5.1 (cf. 15.10.6.2  RegExp.prototype.exec), but has been changed to step 2 (cf. [[RegExpMatcher]] in RegExpExec abstract operation). This change is potentially user due to the non-standard RegExp.prototype.compile function.\n\nExample:\n---\nvar r = /a/;\nr.lastIndex = {valueOf: function(){ print(\"compile\"); r.compile(\"b\",\"g\") }}; r.exec(\"b\")\n---\n\nV8 and Opera(12.15 - not V8 based) both return `[\"b\"]`, whereas SpiderMonkey returns `null`. (JSC and IE10 don't even execute the valueOf function.)\n\nPer the current ES6 draft, the expected result is `null`."},{"commentid":4995,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-08-21 14:29:32 -0700","thetext":"In ES6 compile is defined in annex B\n\nmoved capture of [[RegExpMatcher]] beyond the initial side-effects.  A put access for \"lastIndex\" could still cause side effects within the  match loop, but I don't think they should be allowed to change the matcher used within the loop.\n\nFixed in rev17 editor's draft"},{"commentid":5197,"comment_count":2,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-08-23 08:23:42 -0700","thetext":"fixed in rev17, August 23, 2013 draft"}]}}
---
