---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":4338,"creation_ts":"2015-04-29 09:39:00 -0700","short_desc":"13.13.14 LabelledEvaluation: Completion value for break completions","delta_ts":"2015-10-02 13:14:02 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 38: April 14, 2015 Final Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":14337,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2015-04-29 09:39:16 -0700","thetext":"13.13.14 Runtime Semantics: LabelledEvaluation\n\n---\nLabelledStatement : LabelIdentifier : LabelledItem\n1. Let label be the StringValue of LabelIdentifier.\n2. Append label as an element of labelSet.\n3. Let stmtResult be LabelledEvaluation of LabelledItem with argument labelSet.\n4. If stmtResult.[[type]] is break and SameValue(stmtResult.[[target]], label), then\n  a. If stmtResult.[[value]] is empty, let stmtResult be NormalCompletion(undefined).\n  b. Else, let stmtResult be NormalCompletion(stmtResult.[[value]]).\n5. Return Completion(stmtResult).\n---\n\nSteps 4.a-b should be changed to:\n---\na. Let stmtResult be NormalCompletion(stmtResult.[[value]]).\n---\n\nThat means empty break normal completions are not changed to normal completions with value=undefined. \n\nReasons: Steps 4.a-b were changed in bug 4126 when other parts of the completion reform were still missing (cf. completion value for breakable statements). This is no longer necessary and the current specification is somewhat a pain to implement (it's not difficult, but nonetheless it requires some extra efforts which I don't consider to be justified).\n\nReplacing steps 4.a-b also ensures these two statements will return the same completion value\n---\nL: ;  // current completion value = {type=normal, value=empty}\n---\n\nAnd:\n---\nL: break L;  // current completion value = {type=normal, value=undefined}\n---\n\nWDYT?"},{"commentid":14422,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2015-05-19 14:14:09 -0700","thetext":"fixed in rev29 publication draft"}]}}
---
