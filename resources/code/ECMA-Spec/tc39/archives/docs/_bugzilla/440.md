---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":440,"creation_ts":"2012-07-04 07:48:00 -0700","short_desc":"Creation of the arguments object shouldn’t take variable declarations into account","delta_ts":"2015-10-02 14:33:04 -0700","product":"ECMA-262, Editions 5 and 5.1","component":"technical content","version":"Edition 5.1","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"mathias","name":"Mathias Bynens"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["allen","brendan","mathias"],"long_desc":[{"commentid":1091,"comment_count":0,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2012-07-04 07:48:35 -0700","thetext":"http://ecma-international.org/ecma-262/5.1/#sec-10.6 says:\n\n> When control enters an execution context for function code, an arguments\n> object is created unless (as specified in 10.5) the identifier arguments\n> occurs as an Identifier in the function’s FormalParameterList or occurs as\n> the Identifier of a VariableDeclaration or FunctionDeclaration contained in\n> the function code.\n\nFollowing that logic, I would expect the following code to return `\"undefined\"`:\n\n    function fn() {\n      var arguments;\n      return typeof arguments;\n    };\n    fn();\n\nHowever, the order of steps in the normative part of the spec (http://ecma-international.org/ecma-262/5.1/#sec-10.5, especially step 6) makes clear that variable declarations are not taken into account (although parameters and function declarations are). So, the example above should in fact return `\"object\"`.\n\nAs Brendan Eich noted, this looks like a regression in the spec from ES3 to ES5."},{"commentid":1092,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2012-07-04 08:44:56 -0700","thetext":"As noted, the actual normative algorithm  is correct.\n\nThe error is in the non-normative introduction to 10.6.  For the next edition, we are generally either eliminating such text or explicitly marking it as non-normative."},{"commentid":1093,"comment_count":2,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2012-07-04 09:04:22 -0700","thetext":"To further explain my confusion: `var arguments = undefined;` is equivalent to `var arguments; arguments = undefined;`. But then there’s http://ecma-international.org/ecma-262/5.1/#sec-12.2, which says:\n\n> Variables are initialised to `undefined` when created.\n\nConsider the following example. I’ve added comments explaining what gets alerted in all the engines I tested in.\n\nfunction fn() {\n  alert(typeof arguments); // alerts \"object\"\n  var arguments; // not initialised to `undefined`?\n  alert(typeof arguments); // alerts \"object\"\n  arguments = undefined;\n  alert(typeof arguments); // alerts \"undefined\"\n};\nfn();\n\nWhy doesn’t `var arguments;` initialize to `undefined`, as it says in the spec? Is that another error in non-normative text?"},{"commentid":1094,"comment_count":3,"who":{"uid":"mathias","name":"Mathias Bynens"},"bug_when":"2012-07-04 09:18:33 -0700","thetext":"(In reply to comment #2)\n> Why doesn’t `var arguments;` initialize to `undefined`, as it says in the spec?\n> Is that another error in non-normative text?\n\nI see now — step 8c in http://ecma-international.org/ecma-262/5.1/#sec-10.5. `varAlreadyDeclared` is `true` because the `arguments` object has already been created at that point. So, only when `[var] arguments = undefined;` is executed, it gets overwritten.\n\nSo I guess it’s only comment #0 that’s an error."},{"commentid":14736,"comment_count":4,"who":{"uid":"brterlso","name":"Brian Terlson"},"bug_when":"2015-10-02 14:33:04 -0700","thetext":"Bulk resolving ES5.1 errata issues as a sampling suggests these are all fixed. If this is in error, please open a new issue on GitHub."}]}}
---
