---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":61,"creation_ts":"2011-03-11 08:36:00 -0800","short_desc":"Some split tests are invalid according to ES5","delta_ts":"2012-01-16 11:18:01 -0800","product":"Test262","component":"ECMA-262 Tests","version":"unspecified","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"jandemooij","name":"Jan de Mooij"},"assigned_to":{"uid":"erights","name":"Mark S. Miller"},"cc":["dfugate","jwalden+beo"],"long_desc":[{"commentid":140,"comment_count":0,"who":{"uid":"jandemooij","name":"Jan de Mooij"},"bug_when":"2011-03-11 08:36:09 -0800","thetext":"We rewrote SpiderMonkey's split implementation to be more ES5 compliant. This introduced some new test failures which I believe are invalid.\n\nSome tests assume an |undefined| separator should be treated as the string \"undefined\". This is invalid per ES5 15.5.4.14 step 10.\n\n- S15.5.4.14_A2_T7 \n- S15.5.4.14_A1_T8\n- S15.5.4.14_A1_T6 \n- S15.5.4.14_A1_T7\n- S15.5.4.14_A1_T9 \n\nAnother test calls split with |undefined| this value. This is invalid per ES5 15.5.4.14 step 1 (CheckObjectCoercible throws a TypeError if |this| is undefined)\n\n- S15.5.4.14_A1_T3"},{"commentid":208,"comment_count":1,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2011-05-12 14:02:05 -0700","thetext":"Agreed on S15.5.4.14_A1_T6 through S15.5.4.14_A1_T8.  According to ES5.1 (15.5.4.14 prologue):\n    If separator is undefined, then the result array contains just one String, which is the this value (converted to a String).\nStep 10 implements this behavior.\n\nThere does seem to be a minor spec issue though:  Step 8 of 15.5.4.14 does weakly indicate that the 'R' used in the algorithm will in fact be the string \"undefined\" though.\n\n\nAs for S15.5.4.14_A1_T9, could you offer an explanation as to why this is invalid?  Step 10 definitely doesn't apply and it should sail through Step 1.\n\n\nFinally, I completely agree on S15.5.4.14_A1_T3.  Will be disabling everything except S15.5.4.14_A1_T9 in Hg shortly.  If you can provide a justification for this as well, I'll disable it too."},{"commentid":210,"comment_count":2,"who":{"uid":"jandemooij","name":"Jan de Mooij"},"bug_when":"2011-05-12 14:37:34 -0700","thetext":"Thanks for looking at this.\n\nThe result of step 8 is assigned to R and step 10 looks at the original, unmodified |separator| argument, but I agree that it would've been clearer if step 10 came before step 8.\n\nS15.5.4.14_A1_T9 check 3 does something like this:\n\nassert(new String(some_object).split(function(){}()).length === 2);\n\nAs far as I see this does go through step 10 because separator is undefined?"},{"commentid":254,"comment_count":3,"who":{"uid":"jwalden+beo","name":"Jeff Walden (remove +beo to mail)"},"bug_when":"2011-07-05 15:03:21 -0700","thetext":"I've been looking at the individual test262 tests to figure out what's up with all of them, and these three, mentioned in this bug, are still apparently-buggy tests:\n\nS15.5.4.14_A1_T6\tArgument is x, and instance is new String. x is undefined variable\tfail\nS15.5.4.14_A1_T9\tArgument is function(){}(), and instance is String(object), object have overrided toString and valueOf functions\tfail\nS15.5.4.14_A2_T7\tCall split(void 0), instance is \"thisundefinedisundefinedaundefinedstringundefinedobject\"\tfail\n\nAny chance of disabling them soon, or of modifying them to be correct?"},{"commentid":257,"comment_count":4,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2011-07-05 15:41:18 -0700","thetext":"Sorry for the delay. There were two typos that prevented S15.5.4.14_A1_T6 and S15.5.4.14_A2_T7 from being disabled, and I just hadn't gotten back to S15.5.4.14_A1_T9 yet. Disabled all three in Hg now, and these will make it to the live website with the next minor update (sometime this week?)."},{"commentid":261,"comment_count":5,"who":{"uid":"jwalden+beo","name":"Jeff Walden (remove +beo to mail)"},"bug_when":"2011-07-05 16:11:10 -0700","thetext":"Sounds good, thanks."},{"commentid":604,"comment_count":6,"who":{"uid":"dfugate","name":"Dave Fugate"},"bug_when":"2012-01-16 11:18:01 -0800","thetext":"I've fixed the assertions in:\n- S15.5.4.14_A1_T6 \n- S15.5.4.14_A1_T7\n- S15.5.4.14_A1_T8\n- S15.5.4.14_A2_T7\n\nFor, S15.5.4.14_A1_T3, I bound the 'split' function to the global object and did something similar for 'toString' => this is now valid as well.\n\nYour explanation on S15.5.4.14_A1_T9 makes sense (didn't notice the second '()' in 'function(){}()' when I commented on this previously.  Fixed."}]}}
---
