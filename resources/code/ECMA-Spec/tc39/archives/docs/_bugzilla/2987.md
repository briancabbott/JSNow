---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":2987,"creation_ts":"2014-06-15 20:22:00 -0700","short_desc":"Destructuring Pattern as For-In Target:  Early Error?","delta_ts":"2015-07-10 08:35:05 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 25: May 22, 2014 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"WONTFIX","priority":"Normal","bug_severity":"normal","everconfirmed":true,"reporter":{"uid":"zenparsing","name":"Kevin Smith"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"cc":["andrebargull","erik.arvidsson"],"long_desc":[{"commentid":8939,"comment_count":0,"who":{"uid":"zenparsing","name":"Kevin Smith"},"bug_when":"2014-06-15 20:22:14 -0700","thetext":"Currently, a destructuring pattern can appear to the left of \"in\" in a for-in statement head:\n\n    for ([a, b] in c);\n\nHowever, since [[Enumerate]] will always return an iterator over strings, such a binding will always fail. (The destructuring source will always be a string.)\n\nShould a destructuring pattern to the left of \"in\" result in an early error instead?"},{"commentid":8940,"comment_count":1,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2014-06-16 02:18:04 -0700","thetext":"Proxies are not restricted to this limitation.\n\nfor ([a, b] in new Proxy({}, {*enumerate(){ yield [1,2]; }})) {\n  print(`${a}:${b}`); // prints \"1:2\"\n}"},{"commentid":8943,"comment_count":2,"who":{"uid":"arv","name":"Erik Arvidsson"},"bug_when":"2014-06-16 07:39:09 -0700","thetext":"It used to make sense to allow this since destructuring used to work on non objects.\n\nI agree that this should be a syntax error.\n\nAndré: We should not optimize for Proxies. In this case it would even be a non behaving Proxy."},{"commentid":8944,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-06-16 09:32:04 -0700","thetext":"I agree with Kevin and Erik.  This probably should be a syntax error, now that string values can not be destructured.\n\nNote that the description of [[Enumerate]] in 6.1.7.2 says it produces an \"iterator object over the string values...\" so your proxy does not provide a conforming definition for it."},{"commentid":8946,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-06-16 12:40:14 -0700","thetext":"However, now that I looked at it, it's going to considerably complicate the BNF and/or early error rules to make this be a static error.\n\nI'm not sure it is really worthy the added spec. complexity."},{"commentid":9853,"comment_count":5,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2014-08-24 09:57:39 -0700","thetext":"We've reverted to allowing destructuring of string values.  That means somebody might plausibly code: \n\n  for ([firstChar, ...rest] in c) ...\n\netc. \n\nGiven this (admittedly minor) utility and the complexity of disallowing it, I'm going to close this as WONTFIX."}]}}
---
