---
{"_attributes":{"version":"4.4.4+","urlbase":"https://bugs.ecmascript.org/","maintainer":"dherman@mozilla.com"},"bug":{"bug_id":1973,"creation_ts":"2013-09-29 05:06:00 -0700","short_desc":"25.4.3.9: IteratorStep should use IteratorComplete","delta_ts":"2013-10-29 09:44:32 -0700","product":"Draft for 6th Edition","component":"technical issue","version":"Rev 19: September 27, 2013 Draft","rep_platform":"All","op_sys":"All","bug_status":"RESOLVED","resolution":"FIXED","priority":"Normal","bug_severity":"enhancement","everconfirmed":true,"reporter":{"uid":"andrebargull","name":"André Bargull"},"assigned_to":{"uid":"allen","name":"Allen Wirfs-Brock"},"long_desc":[{"commentid":5647,"comment_count":0,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-09-29 05:06:17 -0700","thetext":"IteratorStep 25.4.3.9, step 4 should be replaced with a call to IteratorComplete. The ToBoolean call in step 6 can then be removed. Justification: Using IteratorNext to retrieve the iteration result, but not using IteratorComplete to check the iteration status looks inconsequent. And IteratorComplete provides better separation of concerns than the manual Get()."},{"commentid":5739,"comment_count":1,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-09-30 17:56:19 -0700","thetext":"The reason IteratorComplete wasn't used is because IteratorStep inverts the meaning of the Boolean result, relative to IteratorComplete.\n\nYou might argue that this is confusing, but it seemed to be more natural in the places where IteratorStep is used."},{"commentid":5834,"comment_count":2,"who":{"uid":"andrebargull","name":"André Bargull"},"bug_when":"2013-10-03 01:45:58 -0700","thetext":"The `Get(result, \"done\")` and `ToBoolean(done)` parts in IteratorStep() are exactly the same in IteratorComplete(). Specifically I was thinking of the following change.\n\nFrom:\n---\n4.  Let done be the result of Get(result, \"done\").\n5.  ReturnIfAbrupt(done).\n6.  If ToBoolean(done) is true, then return false.\n7.  Return result.\n---\n\nTo:\n---\n4.  Let done be the result of IteratorComplete(result).\n5.  ReturnIfAbrupt(done).\n6.  If done is true, then return false.\n7.  Return result.\n---"},{"commentid":5968,"comment_count":3,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-24 14:07:58 -0700","thetext":"ok\n\nfixed in rev20 editor's draft"},{"commentid":6020,"comment_count":4,"who":{"uid":"allen","name":"Allen Wirfs-Brock"},"bug_when":"2013-10-29 09:44:32 -0700","thetext":"fixed in rev20 draft, Oct. 28, 2013"}]}}
---
